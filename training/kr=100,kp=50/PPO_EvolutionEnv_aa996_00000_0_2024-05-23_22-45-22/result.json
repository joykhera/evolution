{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5290681799149678, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.701602785033794, "policy_loss": -0.016152338511399782, "vf_loss": 2.7153592580550523, "vf_explained_var": 0.00019185382464188483, "kl": 0.011979342046630332, "entropy": 1.595915990706069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 4695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 45.0, "episode_reward_min": -1090.0, "episode_reward_mean": -401.6666666666667, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3618, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -40.166666666666664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, -780.0, -780.0, -255.0, -200.0, -130.0, -875.0, -365.0, -580.0, -265.0, -40.0, -120.0, -65.0, -1090.0, -610.0, -620.0, -70.0, -430.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 10.0, 0.0, -25.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, -235.0, -130.0, 10.0, -155.0, -35.0, 0.0, 10.0, 0.0, -245.0, -55.0, 0.0, 0.0, -255.0, 0.0, -195.0, -225.0, 0.0, 0.0, -50.0, -70.0, 20.0, 10.0, -225.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -210.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -140.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -365.0, -50.0, 10.0, 10.0, -85.0, -330.0, -75.0, 10.0, 0.0, -120.0, -105.0, 0.0, -50.0, 0.0, 0.0, 0.0, -100.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -305.0, 0.0, -150.0, -155.0, 0.0, -105.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -100.0, 20.0, -25.0, 30.0, 0.0, 0.0, -45.0, 10.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 0.0, -215.0, -255.0, 0.0, 0.0, -370.0, 10.0, -240.0, -20.0, 0.0, 0.0, -50.0, -65.0, -135.0, -10.0, 20.0, 0.0, -215.0, -120.0, -35.0, 0.0, -120.0, 0.0, 10.0, -235.0, 10.0, -5.0, 30.0, -280.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, -135.0, -265.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0397404018461534, "mean_inference_ms": 1.5760556607591754, "mean_action_processing_ms": 0.5111620482411356, "mean_env_wait_ms": 1.6920597971045952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02035962210761176, "StateBufferConnector_ms": 0.011837482452392578, "ViewRequirementAgentConnector_ms": 0.4989822705586751}, "num_episodes": 18, "episode_return_max": 45.0, "episode_return_min": -1090.0, "episode_return_mean": -401.6666666666667}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.012609771745698, "num_env_steps_trained_throughput_per_sec": 19.012609771745698, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 210386.696, "restore_workers_time_ms": 0.016, "training_step_time_ms": 210386.651, "sample_time_ms": 3832.301, "learn_time_ms": 206535.66, "learn_throughput": 19.367, "synch_weights_time_ms": 12.591}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "aa996_00000", "date": "2024-05-23_22-49-02", "timestamp": 1716518942, "time_this_iter_s": 210.40485906600952, "time_total_s": 210.40485906600952, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x330875160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.40485906600952, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.243000000000002, "ram_util_percent": 82.15833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7136624838073794, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8844172527741827, "policy_loss": -0.015031643858213171, "vf_loss": 0.8981855424273764, "vf_explained_var": 0.008480886186654575, "kl": 0.006316769058539414, "entropy": 1.5895629084783114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 14085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 45.0, "episode_reward_min": -1090.0, "episode_reward_mean": -231.94444444444446, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7236, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -23.194444444444443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, -780.0, -780.0, -255.0, -200.0, -130.0, -875.0, -365.0, -580.0, -265.0, -40.0, -120.0, -65.0, -1090.0, -610.0, -620.0, -70.0, -430.0, -200.0, 20.0, -285.0, -30.0, -200.0, -10.0, -115.0, 10.0, -55.0, 35.0, -40.0, 30.0, -100.0, 10.0, -130.0, 20.0, -35.0, -45.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 10.0, 0.0, -25.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, -235.0, -130.0, 10.0, -155.0, -35.0, 0.0, 10.0, 0.0, -245.0, -55.0, 0.0, 0.0, -255.0, 0.0, -195.0, -225.0, 0.0, 0.0, -50.0, -70.0, 20.0, 10.0, -225.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -210.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -140.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -365.0, -50.0, 10.0, 10.0, -85.0, -330.0, -75.0, 10.0, 0.0, -120.0, -105.0, 0.0, -50.0, 0.0, 0.0, 0.0, -100.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -305.0, 0.0, -150.0, -155.0, 0.0, -105.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -100.0, 20.0, -25.0, 30.0, 0.0, 0.0, -45.0, 10.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 0.0, -215.0, -255.0, 0.0, 0.0, -370.0, 10.0, -240.0, -20.0, 0.0, 0.0, -50.0, -65.0, -135.0, -10.0, 20.0, 0.0, -215.0, -120.0, -35.0, 0.0, -120.0, 0.0, 10.0, -235.0, 10.0, -5.0, 30.0, -280.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, -135.0, -265.0, 0.0, 0.0, 0.0, -25.0, -15.0, 0.0, -30.0, -130.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -315.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, -20.0, -45.0, 10.0, 0.0, 10.0, 0.0, -40.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 20.0, 0.0, -50.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, -60.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, -35.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.005897751888748, "mean_inference_ms": 1.5183907332885966, "mean_action_processing_ms": 0.4944199259688514, "mean_env_wait_ms": 1.6343645342595534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01609325408935547, "StateBufferConnector_ms": 0.010573863983154297, "ViewRequirementAgentConnector_ms": 0.4481600390540229}, "num_episodes": 18, "episode_return_max": 45.0, "episode_return_min": -1090.0, "episode_return_mean": -231.94444444444446}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.703056020557376, "num_env_steps_trained_throughput_per_sec": 19.703056020557376, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 206700.448, "restore_workers_time_ms": 0.015, "training_step_time_ms": 206700.406, "sample_time_ms": 3375.745, "learn_time_ms": 203306.731, "learn_throughput": 19.675, "synch_weights_time_ms": 11.196}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "aa996_00000", "date": "2024-05-23_22-52-25", "timestamp": 1716519145, "time_this_iter_s": 203.03080487251282, "time_total_s": 413.43566393852234, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x33098ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 413.43566393852234, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.81076388888889, "ram_util_percent": 80.01319444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9748349956826915, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7010763704411773, "policy_loss": -0.009123820217903525, "vf_loss": 0.7090654771068828, "vf_explained_var": 0.00825079200239862, "kl": 0.005673564442119591, "entropy": 1.5870582821270147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 23475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 70.0, "episode_reward_min": -1090.0, "episode_reward_mean": -147.96296296296296, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10854, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -14.796296296296296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, -780.0, -780.0, -255.0, -200.0, -130.0, -875.0, -365.0, -580.0, -265.0, -40.0, -120.0, -65.0, -1090.0, -610.0, -620.0, -70.0, -430.0, -200.0, 20.0, -285.0, -30.0, -200.0, -10.0, -115.0, 10.0, -55.0, 35.0, -40.0, 30.0, -100.0, 10.0, -130.0, 20.0, -35.0, -45.0, -10.0, 20.0, -25.0, 0.0, 20.0, 50.0, 30.0, 20.0, 70.0, 10.0, 20.0, 50.0, -20.0, 20.0, 30.0, 40.0, 0.0, 35.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 10.0, 0.0, -25.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, -235.0, -130.0, 10.0, -155.0, -35.0, 0.0, 10.0, 0.0, -245.0, -55.0, 0.0, 0.0, -255.0, 0.0, -195.0, -225.0, 0.0, 0.0, -50.0, -70.0, 20.0, 10.0, -225.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -210.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -140.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -365.0, -50.0, 10.0, 10.0, -85.0, -330.0, -75.0, 10.0, 0.0, -120.0, -105.0, 0.0, -50.0, 0.0, 0.0, 0.0, -100.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -305.0, 0.0, -150.0, -155.0, 0.0, -105.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -100.0, 20.0, -25.0, 30.0, 0.0, 0.0, -45.0, 10.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 0.0, -215.0, -255.0, 0.0, 0.0, -370.0, 10.0, -240.0, -20.0, 0.0, 0.0, -50.0, -65.0, -135.0, -10.0, 20.0, 0.0, -215.0, -120.0, -35.0, 0.0, -120.0, 0.0, 10.0, -235.0, 10.0, -5.0, 30.0, -280.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, -135.0, -265.0, 0.0, 0.0, 0.0, -25.0, -15.0, 0.0, -30.0, -130.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -315.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, -20.0, -45.0, 10.0, 0.0, 10.0, 0.0, -40.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 20.0, 0.0, -50.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, -60.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, -35.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -65.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 20.0, 0.0, 10.0, -10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.963639466919425, "mean_inference_ms": 1.4672688646665957, "mean_action_processing_ms": 0.48032581679340314, "mean_env_wait_ms": 1.586648728932763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015034057475902416, "StateBufferConnector_ms": 0.010530595426206235, "ViewRequirementAgentConnector_ms": 0.44882562425401473}, "num_episodes": 18, "episode_return_max": 70.0, "episode_return_min": -1090.0, "episode_return_mean": -147.96296296296296}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.83945387919323, "num_env_steps_trained_throughput_per_sec": 19.83945387919323, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 205006.452, "restore_workers_time_ms": 0.014, "training_step_time_ms": 205006.411, "sample_time_ms": 3191.503, "learn_time_ms": 201796.032, "learn_throughput": 19.822, "synch_weights_time_ms": 11.521}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "aa996_00000", "date": "2024-05-23_22-55-47", "timestamp": 1716519347, "time_this_iter_s": 201.627277135849, "time_total_s": 615.0629410743713, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x33098b280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 615.0629410743713, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.29122807017544, "ram_util_percent": 78.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9681465149877932, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4365890713926321, "policy_loss": -0.009788438328988135, "vf_loss": 1.4448778123964772, "vf_explained_var": 0.03009054262163286, "kl": 0.007498481003389779, "entropy": 1.5736490825113778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 32865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 70.0, "episode_reward_min": -1090.0, "episode_reward_mean": -105.625, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 14472, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -10.5625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, -780.0, -780.0, -255.0, -200.0, -130.0, -875.0, -365.0, -580.0, -265.0, -40.0, -120.0, -65.0, -1090.0, -610.0, -620.0, -70.0, -430.0, -200.0, 20.0, -285.0, -30.0, -200.0, -10.0, -115.0, 10.0, -55.0, 35.0, -40.0, 30.0, -100.0, 10.0, -130.0, 20.0, -35.0, -45.0, -10.0, 20.0, -25.0, 0.0, 20.0, 50.0, 30.0, 20.0, 70.0, 10.0, 20.0, 50.0, -20.0, 20.0, 30.0, 40.0, 0.0, 35.0, -35.0, 30.0, 10.0, 70.0, -15.0, 40.0, -15.0, 40.0, 10.0, 5.0, 0.0, 55.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 10.0, 0.0, -25.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, -235.0, -130.0, 10.0, -155.0, -35.0, 0.0, 10.0, 0.0, -245.0, -55.0, 0.0, 0.0, -255.0, 0.0, -195.0, -225.0, 0.0, 0.0, -50.0, -70.0, 20.0, 10.0, -225.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -210.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -140.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -365.0, -50.0, 10.0, 10.0, -85.0, -330.0, -75.0, 10.0, 0.0, -120.0, -105.0, 0.0, -50.0, 0.0, 0.0, 0.0, -100.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -305.0, 0.0, -150.0, -155.0, 0.0, -105.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -100.0, 20.0, -25.0, 30.0, 0.0, 0.0, -45.0, 10.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 0.0, -215.0, -255.0, 0.0, 0.0, -370.0, 10.0, -240.0, -20.0, 0.0, 0.0, -50.0, -65.0, -135.0, -10.0, 20.0, 0.0, -215.0, -120.0, -35.0, 0.0, -120.0, 0.0, 10.0, -235.0, 10.0, -5.0, 30.0, -280.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, -135.0, -265.0, 0.0, 0.0, 0.0, -25.0, -15.0, 0.0, -30.0, -130.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -315.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, -20.0, -45.0, 10.0, 0.0, 10.0, 0.0, -40.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 20.0, 0.0, -50.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, -60.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, -35.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -65.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 20.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -35.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 5.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9310064368656077, "mean_inference_ms": 1.4313171007374257, "mean_action_processing_ms": 0.4706611536362847, "mean_env_wait_ms": 1.5534429140934742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015097194247775607, "StateBufferConnector_ms": 0.011658999654981825, "ViewRequirementAgentConnector_ms": 0.49070119857788086}, "num_episodes": 18, "episode_return_max": 70.0, "episode_return_min": -1090.0, "episode_return_mean": -105.625}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.569367161875043, "num_env_steps_trained_throughput_per_sec": 19.569367161875043, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 204855.114, "restore_workers_time_ms": 0.013, "training_step_time_ms": 204855.073, "sample_time_ms": 3054.718, "learn_time_ms": 201781.516, "learn_throughput": 19.823, "synch_weights_time_ms": 11.092}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "aa996_00000", "date": "2024-05-23_22-59-11", "timestamp": 1716519551, "time_this_iter_s": 204.4097249507904, "time_total_s": 819.4726660251617, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x33098cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 819.4726660251617, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.735986159169553, "ram_util_percent": 80.68166089965398}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.352955246485841, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.147384432342233, "policy_loss": -0.011998152912691577, "vf_loss": 2.1578831145875115, "vf_explained_var": 0.023407774205151964, "kl": 0.0074973525792375465, "entropy": 1.5552433498497333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 42255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 170.0, "episode_reward_min": -1090.0, "episode_reward_mean": -57.72727272727273, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 19899, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 50.0}, "policy_reward_mean": {"policy_0": -5.7727272727272725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, -780.0, -780.0, -255.0, -200.0, -130.0, -875.0, -365.0, -580.0, -265.0, -40.0, -120.0, -65.0, -1090.0, -610.0, -620.0, -70.0, -430.0, -200.0, 20.0, -285.0, -30.0, -200.0, -10.0, -115.0, 10.0, -55.0, 35.0, -40.0, 30.0, -100.0, 10.0, -130.0, 20.0, -35.0, -45.0, -10.0, 20.0, -25.0, 0.0, 20.0, 50.0, 30.0, 20.0, 70.0, 10.0, 20.0, 50.0, -20.0, 20.0, 30.0, 40.0, 0.0, 35.0, -35.0, 30.0, 10.0, 70.0, -15.0, 40.0, -15.0, 40.0, 10.0, 5.0, 0.0, 55.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 20.0, 170.0, 80.0, 50.0, 40.0, 110.0, 90.0, 40.0, 60.0, 70.0, 100.0, 75.0, 60.0, 100.0, 50.0, 20.0, 40.0, 70.0, 40.0, 150.0, 5.0, 90.0, 120.0, 60.0, 50.0, 30.0, 100.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 10.0, 0.0, -25.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, -235.0, -130.0, 10.0, -155.0, -35.0, 0.0, 10.0, 0.0, -245.0, -55.0, 0.0, 0.0, -255.0, 0.0, -195.0, -225.0, 0.0, 0.0, -50.0, -70.0, 20.0, 10.0, -225.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -210.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -140.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -365.0, -50.0, 10.0, 10.0, -85.0, -330.0, -75.0, 10.0, 0.0, -120.0, -105.0, 0.0, -50.0, 0.0, 0.0, 0.0, -100.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -305.0, 0.0, -150.0, -155.0, 0.0, -105.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, -100.0, 20.0, -25.0, 30.0, 0.0, 0.0, -45.0, 10.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 0.0, -215.0, -255.0, 0.0, 0.0, -370.0, 10.0, -240.0, -20.0, 0.0, 0.0, -50.0, -65.0, -135.0, -10.0, 20.0, 0.0, -215.0, -120.0, -35.0, 0.0, -120.0, 0.0, 10.0, -235.0, 10.0, -5.0, 30.0, -280.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, -135.0, -265.0, 0.0, 0.0, 0.0, -25.0, -15.0, 0.0, -30.0, -130.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -315.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, -20.0, -45.0, 10.0, 0.0, 10.0, 0.0, -40.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 20.0, 0.0, -50.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, -60.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, -35.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -65.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 20.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -35.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 5.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -20.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, -15.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, -15.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9075921613945073, "mean_inference_ms": 1.3925460048994884, "mean_action_processing_ms": 0.46042931898931266, "mean_env_wait_ms": 1.51922143915047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01477882115527837, "StateBufferConnector_ms": 0.011432772935038865, "ViewRequirementAgentConnector_ms": 0.4820553943364307}, "num_episodes": 27, "episode_return_max": 170.0, "episode_return_min": -1090.0, "episode_return_mean": -57.72727272727273}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.77581807369901, "num_env_steps_trained_throughput_per_sec": 19.77581807369901, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 204337.54, "restore_workers_time_ms": 0.013, "training_step_time_ms": 204337.499, "sample_time_ms": 3008.969, "learn_time_ms": 201307.966, "learn_throughput": 19.87, "synch_weights_time_ms": 11.111}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "aa996_00000", "date": "2024-05-23_23-02-33", "timestamp": 1716519753, "time_this_iter_s": 202.2951638698578, "time_total_s": 1021.7678298950195, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x330906700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1021.7678298950195, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.331118881118883, "ram_util_percent": 80.01503496503496}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.596421970993566, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9182016036761835, "policy_loss": -0.010026978900759254, "vf_loss": 2.92671248681756, "vf_explained_var": 0.008835569973063038, "kl": 0.00758046341817216, "entropy": 1.5352565432255008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 51645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -430.0, "episode_reward_mean": 32.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -315.0}, "policy_reward_max": {"policy_0": 60.0}, "policy_reward_mean": {"policy_0": 3.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.0, -200.0, 20.0, -285.0, -30.0, -200.0, -10.0, -115.0, 10.0, -55.0, 35.0, -40.0, 30.0, -100.0, 10.0, -130.0, 20.0, -35.0, -45.0, -10.0, 20.0, -25.0, 0.0, 20.0, 50.0, 30.0, 20.0, 70.0, 10.0, 20.0, 50.0, -20.0, 20.0, 30.0, 40.0, 0.0, 35.0, -35.0, 30.0, 10.0, 70.0, -15.0, 40.0, -15.0, 40.0, 10.0, 5.0, 0.0, 55.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 20.0, 170.0, 80.0, 50.0, 40.0, 110.0, 90.0, 40.0, 60.0, 70.0, 100.0, 75.0, 60.0, 100.0, 50.0, 20.0, 40.0, 70.0, 40.0, 150.0, 5.0, 90.0, 120.0, 60.0, 50.0, 30.0, 100.0, 120.0, 140.0, 90.0, 170.0, 120.0, 90.0, 105.0, 80.0, 80.0, 200.0, 100.0, 80.0, 125.0, 150.0, 50.0, 170.0, 200.0, 80.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-40.0, 0.0, 0.0, 0.0, 0.0, 10.0, -135.0, -265.0, 0.0, 0.0, 0.0, -25.0, -15.0, 0.0, -30.0, -130.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -315.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, -20.0, -45.0, 10.0, 0.0, 10.0, 0.0, -40.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 20.0, 0.0, -50.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, -60.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, -35.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -65.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 20.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -35.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 5.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -20.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, -15.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, -15.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 15.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 0.0, 60.0, 10.0, 20.0, 10.0, 50.0, 40.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 20.0, 0.0, 10.0, 15.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8676572301388756, "mean_inference_ms": 1.3388857741316025, "mean_action_processing_ms": 0.4461661141719662, "mean_env_wait_ms": 1.4715156529103328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013278484344482422, "StateBufferConnector_ms": 0.011179208755493164, "ViewRequirementAgentConnector_ms": 0.46569180488586426}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -430.0, "episode_return_mean": 32.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.897345794777266, "num_env_steps_trained_throughput_per_sec": 19.897345794777266, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 203786.591, "restore_workers_time_ms": 0.013, "training_step_time_ms": 203786.549, "sample_time_ms": 2957.878, "learn_time_ms": 200808.614, "learn_throughput": 19.919, "synch_weights_time_ms": 10.94}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "aa996_00000", "date": "2024-05-23_23-05-54", "timestamp": 1716519954, "time_this_iter_s": 201.0398120880127, "time_total_s": 1222.8076419830322, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309848b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1222.8076419830322, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.96280701754386, "ram_util_percent": 79.03263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1633155423167922, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.866800831643918, "policy_loss": -0.012308021526981077, "vf_loss": 2.8773732536770917, "vf_explained_var": 0.0040838903322006565, "kl": 0.008678019295630496, "entropy": 1.5107620698702349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 61035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -45.0, "episode_reward_mean": 70.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 80.0}, "policy_reward_mean": {"policy_0": 7.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.0, -10.0, 20.0, -25.0, 0.0, 20.0, 50.0, 30.0, 20.0, 70.0, 10.0, 20.0, 50.0, -20.0, 20.0, 30.0, 40.0, 0.0, 35.0, -35.0, 30.0, 10.0, 70.0, -15.0, 40.0, -15.0, 40.0, 10.0, 5.0, 0.0, 55.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 20.0, 170.0, 80.0, 50.0, 40.0, 110.0, 90.0, 40.0, 60.0, 70.0, 100.0, 75.0, 60.0, 100.0, 50.0, 20.0, 40.0, 70.0, 40.0, 150.0, 5.0, 90.0, 120.0, 60.0, 50.0, 30.0, 100.0, 120.0, 140.0, 90.0, 170.0, 120.0, 90.0, 105.0, 80.0, 80.0, 200.0, 100.0, 80.0, 125.0, 150.0, 50.0, 170.0, 200.0, 80.0, 65.0, 80.0, 110.0, 145.0, 130.0, 100.0, 110.0, 75.0, 90.0, 155.0, 140.0, 160.0, 150.0, 170.0, 180.0, 170.0, 160.0, 80.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -65.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 20.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -35.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 5.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -20.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, -15.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, -15.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 15.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 0.0, 60.0, 10.0, 20.0, 10.0, 50.0, 40.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 20.0, 0.0, 10.0, 15.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 5.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, -10.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 5.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 15.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 15.0, 30.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 80.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 10.0, 30.0, 10.0, 10.0, 80.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 50.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.833616268860361, "mean_inference_ms": 1.3008342634212695, "mean_action_processing_ms": 0.43626839491973596, "mean_env_wait_ms": 1.4379543683076077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013360023498535156, "StateBufferConnector_ms": 0.011361360549926758, "ViewRequirementAgentConnector_ms": 0.46689343452453613}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -45.0, "episode_return_mean": 70.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.182194272173806, "num_env_steps_trained_throughput_per_sec": 19.182194272173806, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 204463.753, "restore_workers_time_ms": 0.013, "training_step_time_ms": 204463.711, "sample_time_ms": 2900.477, "learn_time_ms": 201543.095, "learn_throughput": 19.847, "synch_weights_time_ms": 11.21}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "aa996_00000", "date": "2024-05-23_23-09-23", "timestamp": 1716520163, "time_this_iter_s": 208.54520893096924, "time_total_s": 1431.3528509140015, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x33098c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1431.3528509140015, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.410884353741498, "ram_util_percent": 81.47891156462585}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.062814004257464, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5267989500642964, "policy_loss": -0.01136950447255819, "vf_loss": 3.5363709206271348, "vf_explained_var": 0.00610467697611759, "kl": 0.008987641889923612, "entropy": 1.4870034300354216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 70425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 260.0, "episode_reward_min": -35.0, "episode_reward_mean": 96.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -55.0}, "policy_reward_max": {"policy_0": 80.0}, "policy_reward_mean": {"policy_0": 9.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, -35.0, 30.0, 10.0, 70.0, -15.0, 40.0, -15.0, 40.0, 10.0, 5.0, 0.0, 55.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 20.0, 170.0, 80.0, 50.0, 40.0, 110.0, 90.0, 40.0, 60.0, 70.0, 100.0, 75.0, 60.0, 100.0, 50.0, 20.0, 40.0, 70.0, 40.0, 150.0, 5.0, 90.0, 120.0, 60.0, 50.0, 30.0, 100.0, 120.0, 140.0, 90.0, 170.0, 120.0, 90.0, 105.0, 80.0, 80.0, 200.0, 100.0, 80.0, 125.0, 150.0, 50.0, 170.0, 200.0, 80.0, 65.0, 80.0, 110.0, 145.0, 130.0, 100.0, 110.0, 75.0, 90.0, 155.0, 140.0, 160.0, 150.0, 170.0, 180.0, 170.0, 160.0, 80.0, 150.0, 160.0, 140.0, 260.0, 250.0, 240.0, 170.0, 150.0, 105.0, 110.0, 170.0, 140.0, 110.0, 220.0, 115.0, 140.0, 150.0, 120.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, -5.0, 10.0, 20.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -35.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 5.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -20.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, -15.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, -15.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 15.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 0.0, 60.0, 10.0, 20.0, 10.0, 50.0, 40.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 20.0, 0.0, 10.0, 15.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 5.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, -10.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 5.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 15.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 15.0, 30.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 80.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 10.0, 30.0, 10.0, 10.0, 80.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 50.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 30.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 20.0, 0.0, 30.0, 10.0, 30.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 50.0, 50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 0.0, 0.0, 0.0, -5.0, 30.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 0.0, 15.0, 10.0, 0.0, 50.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8115999096701336, "mean_inference_ms": 1.2856964988951773, "mean_action_processing_ms": 0.43061279875947905, "mean_env_wait_ms": 1.4182880928248216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013211488723754883, "StateBufferConnector_ms": 0.011266231536865234, "ViewRequirementAgentConnector_ms": 0.45638465881347656}, "num_episodes": 18, "episode_return_max": 260.0, "episode_return_min": -35.0, "episode_return_mean": 96.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.335198066650758, "num_env_steps_trained_throughput_per_sec": 19.335198066650758, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 204765.36, "restore_workers_time_ms": 0.013, "training_step_time_ms": 204765.318, "sample_time_ms": 2855.732, "learn_time_ms": 201889.371, "learn_throughput": 19.813, "synch_weights_time_ms": 11.219}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "aa996_00000", "date": "2024-05-23_23-12-50", "timestamp": 1716520370, "time_this_iter_s": 206.88610410690308, "time_total_s": 1638.2389550209045, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x330984820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1638.2389550209045, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.928668941979524, "ram_util_percent": 79.49590443686007}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.155375000209219, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9734558256289447, "policy_loss": -0.009170963000992157, "vf_loss": 3.9812166097953803, "vf_explained_var": 0.0031238051712576447, "kl": 0.007050898610558343, "entropy": 1.4669623606629012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 79815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 630.0, "episode_reward_min": 5.0, "episode_reward_mean": 134.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -20.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 13.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 20.0, 170.0, 80.0, 50.0, 40.0, 110.0, 90.0, 40.0, 60.0, 70.0, 100.0, 75.0, 60.0, 100.0, 50.0, 20.0, 40.0, 70.0, 40.0, 150.0, 5.0, 90.0, 120.0, 60.0, 50.0, 30.0, 100.0, 120.0, 140.0, 90.0, 170.0, 120.0, 90.0, 105.0, 80.0, 80.0, 200.0, 100.0, 80.0, 125.0, 150.0, 50.0, 170.0, 200.0, 80.0, 65.0, 80.0, 110.0, 145.0, 130.0, 100.0, 110.0, 75.0, 90.0, 155.0, 140.0, 160.0, 150.0, 170.0, 180.0, 170.0, 160.0, 80.0, 150.0, 160.0, 140.0, 260.0, 250.0, 240.0, 170.0, 150.0, 105.0, 110.0, 170.0, 140.0, 110.0, 220.0, 115.0, 140.0, 150.0, 120.0, 90.0, 630.0, 230.0, 150.0, 160.0, 240.0, 350.0, 240.0, 160.0, 180.0, 140.0, 210.0, 270.0, 90.0, 140.0, 460.0, 290.0, 190.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -20.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, -15.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, -15.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 15.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 0.0, 60.0, 10.0, 20.0, 10.0, 50.0, 40.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 20.0, 0.0, 10.0, 15.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 5.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, -10.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 5.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 15.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 15.0, 30.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 80.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 10.0, 30.0, 10.0, 10.0, 80.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 50.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 30.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 20.0, 0.0, 30.0, 10.0, 30.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 50.0, 50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 0.0, 0.0, 0.0, -5.0, 30.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 0.0, 15.0, 10.0, 0.0, 50.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 160.0, 10.0, 30.0, 20.0, 250.0, 10.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 30.0, 0.0, 20.0, -10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 190.0, 20.0, 10.0, 30.0, 20.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 20.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 10.0, 40.0, 40.0, 10.0, 0.0, -20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 50.0, 20.0, 10.0, 50.0, 50.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 70.0, 40.0, 10.0, 30.0, 30.0, 170.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 60.0, 20.0, 10.0, 60.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7979560024259995, "mean_inference_ms": 1.283602410197248, "mean_action_processing_ms": 0.42683016325769, "mean_env_wait_ms": 1.405833542867015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013417720794677734, "StateBufferConnector_ms": 0.010645151138305664, "ViewRequirementAgentConnector_ms": 0.4433310031890869}, "num_episodes": 18, "episode_return_max": 630.0, "episode_return_min": 5.0, "episode_return_mean": 134.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.358013730395324, "num_env_steps_trained_throughput_per_sec": 19.358013730395324, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 204972.851, "restore_workers_time_ms": 0.013, "training_step_time_ms": 204972.809, "sample_time_ms": 2858.007, "learn_time_ms": 202094.596, "learn_throughput": 19.793, "synch_weights_time_ms": 11.152}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "aa996_00000", "date": "2024-05-23_23-16-16", "timestamp": 1716520576, "time_this_iter_s": 206.63982582092285, "time_total_s": 1844.8787808418274, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x330906700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1844.8787808418274, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.212627986348124, "ram_util_percent": 79.6962457337884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1857177770556735, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.358864925311396, "policy_loss": -0.010295384389948878, "vf_loss": 4.367488293576672, "vf_explained_var": 0.002827112502056443, "kl": 0.008360059012284636, "entropy": 1.4417925176402124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 89205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 630.0, "episode_reward_min": 50.0, "episode_reward_mean": 179.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 17.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.0, 120.0, 140.0, 90.0, 170.0, 120.0, 90.0, 105.0, 80.0, 80.0, 200.0, 100.0, 80.0, 125.0, 150.0, 50.0, 170.0, 200.0, 80.0, 65.0, 80.0, 110.0, 145.0, 130.0, 100.0, 110.0, 75.0, 90.0, 155.0, 140.0, 160.0, 150.0, 170.0, 180.0, 170.0, 160.0, 80.0, 150.0, 160.0, 140.0, 260.0, 250.0, 240.0, 170.0, 150.0, 105.0, 110.0, 170.0, 140.0, 110.0, 220.0, 115.0, 140.0, 150.0, 120.0, 90.0, 630.0, 230.0, 150.0, 160.0, 240.0, 350.0, 240.0, 160.0, 180.0, 140.0, 210.0, 270.0, 90.0, 140.0, 460.0, 290.0, 190.0, 65.0, 290.0, 270.0, 100.0, 560.0, 180.0, 230.0, 200.0, 140.0, 170.0, 110.0, 110.0, 245.0, 240.0, 180.0, 250.0, 230.0, 260.0, 230.0, 370.0, 380.0, 180.0, 180.0, 320.0, 190.0, 350.0, 320.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 15.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 0.0, 60.0, 10.0, 20.0, 10.0, 50.0, 40.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 20.0, 0.0, 10.0, 15.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 5.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, -10.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 5.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 15.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 15.0, 30.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 80.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 10.0, 30.0, 10.0, 10.0, 80.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 50.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 30.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 20.0, 0.0, 30.0, 10.0, 30.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 50.0, 50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 0.0, 0.0, 0.0, -5.0, 30.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 0.0, 15.0, 10.0, 0.0, 50.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 160.0, 10.0, 30.0, 20.0, 250.0, 10.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 30.0, 0.0, 20.0, -10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 190.0, 20.0, 10.0, 30.0, 20.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 20.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 10.0, 40.0, 40.0, 10.0, 0.0, -20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 50.0, 20.0, 10.0, 50.0, 50.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 70.0, 40.0, 10.0, 30.0, 30.0, 170.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 60.0, 20.0, 10.0, 60.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, -15.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 100.0, 10.0, 0.0, 90.0, 10.0, 60.0, 0.0, 170.0, -40.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 30.0, 10.0, 160.0, 50.0, 20.0, 40.0, 160.0, 30.0, 30.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 20.0, 50.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 40.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 50.0, 5.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, -140.0, 30.0, 0.0, 150.0, 60.0, 20.0, 20.0, 0.0, 10.0, 40.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 60.0, 0.0, 70.0, 10.0, 50.0, 0.0, 0.0, 10.0, 50.0, 40.0, 20.0, 10.0, 70.0, -90.0, 80.0, 30.0, 40.0, 0.0, 30.0, 20.0, 10.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 40.0, 80.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 50.0, 40.0, 10.0, 150.0, -20.0, 80.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 50.0, -50.0, -30.0, 0.0, 0.0, -10.0, 50.0, 10.0, 360.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 30.0, 10.0, 40.0, 0.0, 70.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 80.0, 40.0, 80.0, 20.0, 10.0, 30.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 0.0, 150.0, 40.0, 60.0, 20.0, 20.0, 50.0, 30.0, 0.0, 30.0, 60.0, 40.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7726855402664987, "mean_inference_ms": 1.297249071310026, "mean_action_processing_ms": 0.4233371522486462, "mean_env_wait_ms": 1.3934215169325903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013644695281982422, "StateBufferConnector_ms": 0.010240554809570312, "ViewRequirementAgentConnector_ms": 0.42384934425354004}, "num_episodes": 27, "episode_return_max": 630.0, "episode_return_min": 50.0, "episode_return_mean": 179.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.374104543811892, "num_env_steps_trained_throughput_per_sec": 19.374104543811892, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 205121.683, "restore_workers_time_ms": 0.013, "training_step_time_ms": 205121.64, "sample_time_ms": 2852.509, "learn_time_ms": 202248.907, "learn_throughput": 19.778, "synch_weights_time_ms": 11.269}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 10, "trial_id": "aa996_00000", "date": "2024-05-23_23-19-43", "timestamp": 1716520783, "time_this_iter_s": 206.46898293495178, "time_total_s": 2051.347763776779, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309bfaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2051.347763776779, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.45, "ram_util_percent": 79.08527397260275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1873588164330036, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.711038252974724, "policy_loss": -0.009536483631587336, "vf_loss": 4.719102581164327, "vf_explained_var": 0.0018941544115352936, "kl": 0.007360756245096212, "entropy": 1.4215894129583504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 98595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 630.0, "episode_reward_min": 65.0, "episode_reward_mean": 210.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 21.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.0, 65.0, 80.0, 110.0, 145.0, 130.0, 100.0, 110.0, 75.0, 90.0, 155.0, 140.0, 160.0, 150.0, 170.0, 180.0, 170.0, 160.0, 80.0, 150.0, 160.0, 140.0, 260.0, 250.0, 240.0, 170.0, 150.0, 105.0, 110.0, 170.0, 140.0, 110.0, 220.0, 115.0, 140.0, 150.0, 120.0, 90.0, 630.0, 230.0, 150.0, 160.0, 240.0, 350.0, 240.0, 160.0, 180.0, 140.0, 210.0, 270.0, 90.0, 140.0, 460.0, 290.0, 190.0, 65.0, 290.0, 270.0, 100.0, 560.0, 180.0, 230.0, 200.0, 140.0, 170.0, 110.0, 110.0, 245.0, 240.0, 180.0, 250.0, 230.0, 260.0, 230.0, 370.0, 380.0, 180.0, 180.0, 320.0, 190.0, 350.0, 320.0, 200.0, 510.0, 320.0, 220.0, 180.0, 250.0, 330.0, 260.0, 380.0, 570.0, 280.0, 230.0, 165.0, 210.0, 280.0, 260.0, 240.0, 330.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 5.0, 10.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, -10.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 5.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 15.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 15.0, 30.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 80.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 10.0, 30.0, 10.0, 10.0, 80.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 50.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 30.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 20.0, 0.0, 30.0, 10.0, 30.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 50.0, 50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 0.0, 0.0, 0.0, -5.0, 30.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 0.0, 15.0, 10.0, 0.0, 50.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 160.0, 10.0, 30.0, 20.0, 250.0, 10.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 30.0, 0.0, 20.0, -10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 190.0, 20.0, 10.0, 30.0, 20.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 20.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 10.0, 40.0, 40.0, 10.0, 0.0, -20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 50.0, 20.0, 10.0, 50.0, 50.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 70.0, 40.0, 10.0, 30.0, 30.0, 170.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 60.0, 20.0, 10.0, 60.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, -15.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 100.0, 10.0, 0.0, 90.0, 10.0, 60.0, 0.0, 170.0, -40.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 30.0, 10.0, 160.0, 50.0, 20.0, 40.0, 160.0, 30.0, 30.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 20.0, 50.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 40.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 50.0, 5.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, -140.0, 30.0, 0.0, 150.0, 60.0, 20.0, 20.0, 0.0, 10.0, 40.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 60.0, 0.0, 70.0, 10.0, 50.0, 0.0, 0.0, 10.0, 50.0, 40.0, 20.0, 10.0, 70.0, -90.0, 80.0, 30.0, 40.0, 0.0, 30.0, 20.0, 10.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 40.0, 80.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 50.0, 40.0, 10.0, 150.0, -20.0, 80.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 50.0, -50.0, -30.0, 0.0, 0.0, -10.0, 50.0, 10.0, 360.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 30.0, 10.0, 40.0, 0.0, 70.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 80.0, 40.0, 80.0, 20.0, 10.0, 30.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 0.0, 150.0, 40.0, 60.0, 20.0, 20.0, 50.0, 30.0, 0.0, 30.0, 60.0, 40.0, 10.0, 0.0, 150.0, 90.0, 0.0, -50.0, -20.0, 20.0, 10.0, 0.0, 0.0, 40.0, -80.0, 50.0, 20.0, 160.0, -40.0, 30.0, 260.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 10.0, 30.0, 60.0, 90.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 0.0, 90.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 0.0, 160.0, 10.0, 30.0, 40.0, 10.0, 30.0, 20.0, -10.0, 30.0, 10.0, 10.0, 30.0, 160.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 170.0, 10.0, 20.0, 20.0, 30.0, 10.0, 20.0, 30.0, 50.0, 20.0, 30.0, -30.0, 0.0, 10.0, 40.0, -10.0, 160.0, 40.0, 350.0, -20.0, 20.0, 20.0, 10.0, 90.0, 0.0, 20.0, 40.0, 30.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 30.0, 0.0, 10.0, 5.0, 10.0, 30.0, 30.0, 20.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 40.0, 60.0, 50.0, 10.0, 30.0, 10.0, 30.0, 20.0, 40.0, 50.0, 30.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 30.0, 10.0, 30.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 60.0, 0.0, 10.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7610259997779714, "mean_inference_ms": 1.31338092654824, "mean_action_processing_ms": 0.4219813776894617, "mean_env_wait_ms": 1.3878017296429022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013551950454711914, "StateBufferConnector_ms": 0.010004758834838867, "ViewRequirementAgentConnector_ms": 0.41884899139404297}, "num_episodes": 18, "episode_return_max": 630.0, "episode_return_min": 65.0, "episode_return_mean": 210.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.39014060161572, "num_env_steps_trained_throughput_per_sec": 19.39014060161572, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 204712.054, "restore_workers_time_ms": 0.012, "training_step_time_ms": 204712.012, "sample_time_ms": 2741.829, "learn_time_ms": 201949.379, "learn_throughput": 19.807, "synch_weights_time_ms": 11.138}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 11, "trial_id": "aa996_00000", "date": "2024-05-23_23-23-09", "timestamp": 1716520989, "time_this_iter_s": 206.30970001220703, "time_total_s": 2257.657463788986, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2257.657463788986, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.061855670103093, "ram_util_percent": 79.68041237113403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5479590520500754, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.1514593567965, "policy_loss": -0.010065810454794115, "vf_loss": 5.159881124912867, "vf_explained_var": 0.00017880409543379682, "kl": 0.008220193627438952, "entropy": 1.4024325794686143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 107985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 630.0, "episode_reward_min": 65.0, "episode_reward_mean": 245.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 24.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.0, 150.0, 160.0, 140.0, 260.0, 250.0, 240.0, 170.0, 150.0, 105.0, 110.0, 170.0, 140.0, 110.0, 220.0, 115.0, 140.0, 150.0, 120.0, 90.0, 630.0, 230.0, 150.0, 160.0, 240.0, 350.0, 240.0, 160.0, 180.0, 140.0, 210.0, 270.0, 90.0, 140.0, 460.0, 290.0, 190.0, 65.0, 290.0, 270.0, 100.0, 560.0, 180.0, 230.0, 200.0, 140.0, 170.0, 110.0, 110.0, 245.0, 240.0, 180.0, 250.0, 230.0, 260.0, 230.0, 370.0, 380.0, 180.0, 180.0, 320.0, 190.0, 350.0, 320.0, 200.0, 510.0, 320.0, 220.0, 180.0, 250.0, 330.0, 260.0, 380.0, 570.0, 280.0, 230.0, 165.0, 210.0, 280.0, 260.0, 240.0, 330.0, 370.0, 420.0, 370.0, 440.0, 310.0, 100.0, 200.0, 450.0, 300.0, 390.0, 250.0, 430.0, 160.0, 180.0, 410.0, 500.0, 185.0, 300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 30.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 20.0, 0.0, 30.0, 10.0, 30.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 50.0, 50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 0.0, 0.0, 0.0, -5.0, 30.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 0.0, 15.0, 10.0, 0.0, 50.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 160.0, 10.0, 30.0, 20.0, 250.0, 10.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 30.0, 0.0, 20.0, -10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 190.0, 20.0, 10.0, 30.0, 20.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 20.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 10.0, 40.0, 40.0, 10.0, 0.0, -20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 50.0, 20.0, 10.0, 50.0, 50.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 70.0, 40.0, 10.0, 30.0, 30.0, 170.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 60.0, 20.0, 10.0, 60.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, -15.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 100.0, 10.0, 0.0, 90.0, 10.0, 60.0, 0.0, 170.0, -40.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 30.0, 10.0, 160.0, 50.0, 20.0, 40.0, 160.0, 30.0, 30.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 20.0, 50.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 40.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 50.0, 5.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, -140.0, 30.0, 0.0, 150.0, 60.0, 20.0, 20.0, 0.0, 10.0, 40.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 60.0, 0.0, 70.0, 10.0, 50.0, 0.0, 0.0, 10.0, 50.0, 40.0, 20.0, 10.0, 70.0, -90.0, 80.0, 30.0, 40.0, 0.0, 30.0, 20.0, 10.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 40.0, 80.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 50.0, 40.0, 10.0, 150.0, -20.0, 80.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 50.0, -50.0, -30.0, 0.0, 0.0, -10.0, 50.0, 10.0, 360.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 30.0, 10.0, 40.0, 0.0, 70.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 80.0, 40.0, 80.0, 20.0, 10.0, 30.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 0.0, 150.0, 40.0, 60.0, 20.0, 20.0, 50.0, 30.0, 0.0, 30.0, 60.0, 40.0, 10.0, 0.0, 150.0, 90.0, 0.0, -50.0, -20.0, 20.0, 10.0, 0.0, 0.0, 40.0, -80.0, 50.0, 20.0, 160.0, -40.0, 30.0, 260.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 10.0, 30.0, 60.0, 90.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 0.0, 90.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 0.0, 160.0, 10.0, 30.0, 40.0, 10.0, 30.0, 20.0, -10.0, 30.0, 10.0, 10.0, 30.0, 160.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 170.0, 10.0, 20.0, 20.0, 30.0, 10.0, 20.0, 30.0, 50.0, 20.0, 30.0, -30.0, 0.0, 10.0, 40.0, -10.0, 160.0, 40.0, 350.0, -20.0, 20.0, 20.0, 10.0, 90.0, 0.0, 20.0, 40.0, 30.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 30.0, 0.0, 10.0, 5.0, 10.0, 30.0, 30.0, 20.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 40.0, 60.0, 50.0, 10.0, 30.0, 10.0, 30.0, 20.0, 40.0, 50.0, 30.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 30.0, 10.0, 30.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 60.0, 0.0, 10.0, 150.0, 90.0, 50.0, 0.0, 30.0, 40.0, 0.0, 30.0, 80.0, 20.0, 30.0, 60.0, 10.0, 10.0, 160.0, 5.0, 70.0, 15.0, 40.0, 50.0, 0.0, 40.0, 40.0, 30.0, 10.0, 70.0, 40.0, 0.0, 40.0, 60.0, 40.0, 180.0, 20.0, 70.0, 170.0, 30.0, 50.0, 10.0, 0.0, -120.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 50.0, 20.0, 0.0, 0.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 30.0, 270.0, 0.0, 30.0, 30.0, 70.0, 0.0, 40.0, 30.0, 40.0, 10.0, 40.0, 0.0, 40.0, 50.0, 20.0, 40.0, 30.0, 0.0, 60.0, 60.0, 70.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 50.0, 20.0, 60.0, 20.0, 10.0, 20.0, 170.0, 10.0, 0.0, 0.0, 260.0, 10.0, 10.0, -50.0, 0.0, 50.0, 50.0, 10.0, 20.0, 0.0, 10.0, 20.0, -40.0, 20.0, 20.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 70.0, 160.0, 10.0, 30.0, 20.0, 20.0, 0.0, 40.0, 60.0, 120.0, 0.0, 70.0, 30.0, 40.0, 50.0, 40.0, 50.0, 40.0, 30.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, -5.0, 10.0, 60.0, 10.0, 10.0, 20.0, 70.0, 20.0, 30.0, 50.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7509780370482537, "mean_inference_ms": 1.3347611232214849, "mean_action_processing_ms": 0.4210540474559618, "mean_env_wait_ms": 1.3842516415971777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01397395133972168, "StateBufferConnector_ms": 0.010016202926635742, "ViewRequirementAgentConnector_ms": 0.43760061264038086}, "num_episodes": 18, "episode_return_max": 630.0, "episode_return_min": 65.0, "episode_return_mean": 245.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.44330520566372, "num_env_steps_trained_throughput_per_sec": 19.44330520566372, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 204983.27, "restore_workers_time_ms": 0.012, "training_step_time_ms": 204983.227, "sample_time_ms": 2740.518, "learn_time_ms": 202221.536, "learn_throughput": 19.78, "synch_weights_time_ms": 11.493}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 12, "trial_id": "aa996_00000", "date": "2024-05-23_23-26-35", "timestamp": 1716521195, "time_this_iter_s": 205.7332580089569, "time_total_s": 2463.390721797943, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309d4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2463.390721797943, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 20.342268041237112, "ram_util_percent": 79.05326460481099}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4318722917629887, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.003727458942685, "policy_loss": -0.010417453415855007, "vf_loss": 4.012584316997102, "vf_explained_var": 0.003364459337136997, "kl": 0.0078029644561939514, "entropy": 1.3897326579616982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 117375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 630.0, "episode_reward_min": 65.0, "episode_reward_mean": 263.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 26.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 90.0, 630.0, 230.0, 150.0, 160.0, 240.0, 350.0, 240.0, 160.0, 180.0, 140.0, 210.0, 270.0, 90.0, 140.0, 460.0, 290.0, 190.0, 65.0, 290.0, 270.0, 100.0, 560.0, 180.0, 230.0, 200.0, 140.0, 170.0, 110.0, 110.0, 245.0, 240.0, 180.0, 250.0, 230.0, 260.0, 230.0, 370.0, 380.0, 180.0, 180.0, 320.0, 190.0, 350.0, 320.0, 200.0, 510.0, 320.0, 220.0, 180.0, 250.0, 330.0, 260.0, 380.0, 570.0, 280.0, 230.0, 165.0, 210.0, 280.0, 260.0, 240.0, 330.0, 370.0, 420.0, 370.0, 440.0, 310.0, 100.0, 200.0, 450.0, 300.0, 390.0, 250.0, 430.0, 160.0, 180.0, 410.0, 500.0, 185.0, 300.0, 400.0, 180.0, 290.0, 220.0, 310.0, 230.0, 345.0, 150.0, 310.0, 340.0, 150.0, 235.0, 250.0, 300.0, 320.0, 230.0, 180.0, 250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 160.0, 10.0, 30.0, 20.0, 250.0, 10.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 60.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 30.0, 0.0, 20.0, -10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 190.0, 20.0, 10.0, 30.0, 20.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 20.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 10.0, 40.0, 40.0, 10.0, 0.0, -20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 50.0, 20.0, 10.0, 50.0, 50.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 70.0, 40.0, 10.0, 30.0, 30.0, 170.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 60.0, 20.0, 10.0, 60.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, -15.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 100.0, 10.0, 0.0, 90.0, 10.0, 60.0, 0.0, 170.0, -40.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 30.0, 10.0, 160.0, 50.0, 20.0, 40.0, 160.0, 30.0, 30.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 20.0, 50.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 40.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 50.0, 5.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, -140.0, 30.0, 0.0, 150.0, 60.0, 20.0, 20.0, 0.0, 10.0, 40.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 60.0, 0.0, 70.0, 10.0, 50.0, 0.0, 0.0, 10.0, 50.0, 40.0, 20.0, 10.0, 70.0, -90.0, 80.0, 30.0, 40.0, 0.0, 30.0, 20.0, 10.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 40.0, 80.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 50.0, 40.0, 10.0, 150.0, -20.0, 80.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 50.0, -50.0, -30.0, 0.0, 0.0, -10.0, 50.0, 10.0, 360.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 30.0, 10.0, 40.0, 0.0, 70.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 80.0, 40.0, 80.0, 20.0, 10.0, 30.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 0.0, 150.0, 40.0, 60.0, 20.0, 20.0, 50.0, 30.0, 0.0, 30.0, 60.0, 40.0, 10.0, 0.0, 150.0, 90.0, 0.0, -50.0, -20.0, 20.0, 10.0, 0.0, 0.0, 40.0, -80.0, 50.0, 20.0, 160.0, -40.0, 30.0, 260.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 10.0, 30.0, 60.0, 90.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 0.0, 90.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 0.0, 160.0, 10.0, 30.0, 40.0, 10.0, 30.0, 20.0, -10.0, 30.0, 10.0, 10.0, 30.0, 160.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 170.0, 10.0, 20.0, 20.0, 30.0, 10.0, 20.0, 30.0, 50.0, 20.0, 30.0, -30.0, 0.0, 10.0, 40.0, -10.0, 160.0, 40.0, 350.0, -20.0, 20.0, 20.0, 10.0, 90.0, 0.0, 20.0, 40.0, 30.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 30.0, 0.0, 10.0, 5.0, 10.0, 30.0, 30.0, 20.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 40.0, 60.0, 50.0, 10.0, 30.0, 10.0, 30.0, 20.0, 40.0, 50.0, 30.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 30.0, 10.0, 30.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 60.0, 0.0, 10.0, 150.0, 90.0, 50.0, 0.0, 30.0, 40.0, 0.0, 30.0, 80.0, 20.0, 30.0, 60.0, 10.0, 10.0, 160.0, 5.0, 70.0, 15.0, 40.0, 50.0, 0.0, 40.0, 40.0, 30.0, 10.0, 70.0, 40.0, 0.0, 40.0, 60.0, 40.0, 180.0, 20.0, 70.0, 170.0, 30.0, 50.0, 10.0, 0.0, -120.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 50.0, 20.0, 0.0, 0.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 30.0, 270.0, 0.0, 30.0, 30.0, 70.0, 0.0, 40.0, 30.0, 40.0, 10.0, 40.0, 0.0, 40.0, 50.0, 20.0, 40.0, 30.0, 0.0, 60.0, 60.0, 70.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 50.0, 20.0, 60.0, 20.0, 10.0, 20.0, 170.0, 10.0, 0.0, 0.0, 260.0, 10.0, 10.0, -50.0, 0.0, 50.0, 50.0, 10.0, 20.0, 0.0, 10.0, 20.0, -40.0, 20.0, 20.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 70.0, 160.0, 10.0, 30.0, 20.0, 20.0, 0.0, 40.0, 60.0, 120.0, 0.0, 70.0, 30.0, 40.0, 50.0, 40.0, 50.0, 40.0, 30.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, -5.0, 10.0, 60.0, 10.0, 10.0, 20.0, 70.0, 20.0, 30.0, 50.0, 10.0, 20.0, 30.0, 90.0, 20.0, 70.0, 40.0, -30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 0.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, -10.0, 30.0, 10.0, 10.0, 80.0, 10.0, 60.0, 10.0, 60.0, 20.0, 0.0, 50.0, 0.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 60.0, 40.0, 10.0, 40.0, 40.0, 50.0, 70.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 50.0, 20.0, 10.0, 30.0, 170.0, 20.0, 15.0, 20.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 180.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 40.0, 40.0, 170.0, 20.0, 0.0, 0.0, 50.0, 0.0, 50.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 35.0, 20.0, 30.0, 0.0, 10.0, 30.0, 70.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 10.0, 50.0, 0.0, 20.0, 50.0, 10.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 10.0, 20.0, 10.0, 150.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 20.0, 30.0, 50.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 50.0, 90.0, 30.0, 20.0, 20.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7456878849313369, "mean_inference_ms": 1.3521777263441197, "mean_action_processing_ms": 0.42040156407602636, "mean_env_wait_ms": 1.381610844482028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013990640640258789, "StateBufferConnector_ms": 0.009935855865478516, "ViewRequirementAgentConnector_ms": 0.44136738777160645}, "num_episodes": 18, "episode_return_max": 630.0, "episode_return_min": 65.0, "episode_return_mean": 263.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.395596732527377, "num_env_steps_trained_throughput_per_sec": 19.395596732527377, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 205444.662, "restore_workers_time_ms": 0.012, "training_step_time_ms": 205444.619, "sample_time_ms": 2758.046, "learn_time_ms": 202665.432, "learn_throughput": 19.737, "synch_weights_time_ms": 11.58}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 13, "trial_id": "aa996_00000", "date": "2024-05-23_23-30-01", "timestamp": 1716521401, "time_this_iter_s": 206.24184608459473, "time_total_s": 2669.632567882538, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x330906700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2669.632567882538, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.847945205479455, "ram_util_percent": 78.77808219178083}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3622782935730564, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.160165698713642, "policy_loss": -0.01181946550910009, "vf_loss": 5.170401302592569, "vf_explained_var": 0.005362076265489458, "kl": 0.007919314067248034, "entropy": 1.3603212976100219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 126765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 670.0, "episode_reward_min": 65.0, "episode_reward_mean": 282.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 28.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 65.0, 290.0, 270.0, 100.0, 560.0, 180.0, 230.0, 200.0, 140.0, 170.0, 110.0, 110.0, 245.0, 240.0, 180.0, 250.0, 230.0, 260.0, 230.0, 370.0, 380.0, 180.0, 180.0, 320.0, 190.0, 350.0, 320.0, 200.0, 510.0, 320.0, 220.0, 180.0, 250.0, 330.0, 260.0, 380.0, 570.0, 280.0, 230.0, 165.0, 210.0, 280.0, 260.0, 240.0, 330.0, 370.0, 420.0, 370.0, 440.0, 310.0, 100.0, 200.0, 450.0, 300.0, 390.0, 250.0, 430.0, 160.0, 180.0, 410.0, 500.0, 185.0, 300.0, 400.0, 180.0, 290.0, 220.0, 310.0, 230.0, 345.0, 150.0, 310.0, 340.0, 150.0, 235.0, 250.0, 300.0, 320.0, 230.0, 180.0, 250.0, 170.0, 165.0, 500.0, 200.0, 250.0, 375.0, 300.0, 270.0, 390.0, 545.0, 160.0, 420.0, 560.0, 270.0, 200.0, 150.0, 400.0, 670.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, -15.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 100.0, 10.0, 0.0, 90.0, 10.0, 60.0, 0.0, 170.0, -40.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 30.0, 10.0, 160.0, 50.0, 20.0, 40.0, 160.0, 30.0, 30.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 20.0, 50.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 40.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 50.0, 5.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, -140.0, 30.0, 0.0, 150.0, 60.0, 20.0, 20.0, 0.0, 10.0, 40.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 0.0, 60.0, 0.0, 70.0, 10.0, 50.0, 0.0, 0.0, 10.0, 50.0, 40.0, 20.0, 10.0, 70.0, -90.0, 80.0, 30.0, 40.0, 0.0, 30.0, 20.0, 10.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 40.0, 80.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 40.0, 20.0, 0.0, 50.0, 40.0, 10.0, 150.0, -20.0, 80.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 50.0, -50.0, -30.0, 0.0, 0.0, -10.0, 50.0, 10.0, 360.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 30.0, 10.0, 40.0, 0.0, 70.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 50.0, 10.0, 0.0, 80.0, 40.0, 80.0, 20.0, 10.0, 30.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 0.0, 150.0, 40.0, 60.0, 20.0, 20.0, 50.0, 30.0, 0.0, 30.0, 60.0, 40.0, 10.0, 0.0, 150.0, 90.0, 0.0, -50.0, -20.0, 20.0, 10.0, 0.0, 0.0, 40.0, -80.0, 50.0, 20.0, 160.0, -40.0, 30.0, 260.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 10.0, 30.0, 60.0, 90.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 0.0, 90.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 0.0, 160.0, 10.0, 30.0, 40.0, 10.0, 30.0, 20.0, -10.0, 30.0, 10.0, 10.0, 30.0, 160.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 170.0, 10.0, 20.0, 20.0, 30.0, 10.0, 20.0, 30.0, 50.0, 20.0, 30.0, -30.0, 0.0, 10.0, 40.0, -10.0, 160.0, 40.0, 350.0, -20.0, 20.0, 20.0, 10.0, 90.0, 0.0, 20.0, 40.0, 30.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 30.0, 0.0, 10.0, 5.0, 10.0, 30.0, 30.0, 20.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 40.0, 60.0, 50.0, 10.0, 30.0, 10.0, 30.0, 20.0, 40.0, 50.0, 30.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 30.0, 10.0, 30.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 60.0, 0.0, 10.0, 150.0, 90.0, 50.0, 0.0, 30.0, 40.0, 0.0, 30.0, 80.0, 20.0, 30.0, 60.0, 10.0, 10.0, 160.0, 5.0, 70.0, 15.0, 40.0, 50.0, 0.0, 40.0, 40.0, 30.0, 10.0, 70.0, 40.0, 0.0, 40.0, 60.0, 40.0, 180.0, 20.0, 70.0, 170.0, 30.0, 50.0, 10.0, 0.0, -120.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 50.0, 20.0, 0.0, 0.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 30.0, 270.0, 0.0, 30.0, 30.0, 70.0, 0.0, 40.0, 30.0, 40.0, 10.0, 40.0, 0.0, 40.0, 50.0, 20.0, 40.0, 30.0, 0.0, 60.0, 60.0, 70.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 50.0, 20.0, 60.0, 20.0, 10.0, 20.0, 170.0, 10.0, 0.0, 0.0, 260.0, 10.0, 10.0, -50.0, 0.0, 50.0, 50.0, 10.0, 20.0, 0.0, 10.0, 20.0, -40.0, 20.0, 20.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 70.0, 160.0, 10.0, 30.0, 20.0, 20.0, 0.0, 40.0, 60.0, 120.0, 0.0, 70.0, 30.0, 40.0, 50.0, 40.0, 50.0, 40.0, 30.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, -5.0, 10.0, 60.0, 10.0, 10.0, 20.0, 70.0, 20.0, 30.0, 50.0, 10.0, 20.0, 30.0, 90.0, 20.0, 70.0, 40.0, -30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 0.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, -10.0, 30.0, 10.0, 10.0, 80.0, 10.0, 60.0, 10.0, 60.0, 20.0, 0.0, 50.0, 0.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 60.0, 40.0, 10.0, 40.0, 40.0, 50.0, 70.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 50.0, 20.0, 10.0, 30.0, 170.0, 20.0, 15.0, 20.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 180.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 40.0, 40.0, 170.0, 20.0, 0.0, 0.0, 50.0, 0.0, 50.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 35.0, 20.0, 30.0, 0.0, 10.0, 30.0, 70.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 10.0, 50.0, 0.0, 20.0, 50.0, 10.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 10.0, 20.0, 10.0, 150.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 20.0, 30.0, 50.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 50.0, 90.0, 30.0, 20.0, 20.0, 20.0, 0.0, 20.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 40.0, 10.0, 5.0, 0.0, 0.0, 20.0, 250.0, 40.0, 40.0, 10.0, -10.0, 30.0, 30.0, 50.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 20.0, 40.0, 5.0, 30.0, -100.0, 10.0, 20.0, 40.0, 60.0, 260.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 30.0, 0.0, -40.0, 10.0, 160.0, 20.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 40.0, 0.0, 40.0, 20.0, 40.0, 60.0, 20.0, 50.0, 70.0, 0.0, 20.0, 70.0, 0.0, 50.0, 60.0, 40.0, 70.0, 180.0, 60.0, 10.0, 25.0, 50.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 80.0, 0.0, 10.0, 30.0, 30.0, 50.0, 190.0, 40.0, 10.0, 0.0, 10.0, 20.0, 20.0, 50.0, 50.0, 50.0, 40.0, 40.0, 10.0, 180.0, -10.0, 180.0, 0.0, 20.0, 70.0, 0.0, 10.0, 10.0, 30.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 60.0, 40.0, 10.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 0.0, 170.0, 40.0, 10.0, 10.0, 70.0, 30.0, 0.0, 40.0, 30.0, 70.0, 60.0, 150.0, 40.0, 40.0, 30.0, 150.0, 20.0, 100.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7399959628511714, "mean_inference_ms": 1.367116557624924, "mean_action_processing_ms": 0.4199710422135071, "mean_env_wait_ms": 1.379091016384184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01391911506652832, "StateBufferConnector_ms": 0.010413885116577148, "ViewRequirementAgentConnector_ms": 0.42647767066955566}, "num_episodes": 18, "episode_return_max": 670.0, "episode_return_min": 65.0, "episode_return_mean": 282.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.39017708517814, "num_env_steps_trained_throughput_per_sec": 19.39017708517814, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 205633.555, "restore_workers_time_ms": 0.012, "training_step_time_ms": 205633.512, "sample_time_ms": 2767.039, "learn_time_ms": 202844.872, "learn_throughput": 19.72, "synch_weights_time_ms": 11.558}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 14, "trial_id": "aa996_00000", "date": "2024-05-23_23-33-28", "timestamp": 1716521608, "time_this_iter_s": 206.3073959350586, "time_total_s": 2875.9399638175964, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309d4b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2875.9399638175964, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.117123287671234, "ram_util_percent": 79.15787671232876}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8506138296934744, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.758297426657428, "policy_loss": -0.011349058534634618, "vf_loss": 4.767865594304281, "vf_explained_var": 0.00679516288926934, "kl": 0.0089044424920661, "entropy": 1.344194393239209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 136155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 670.0, "episode_reward_min": 90.0, "episode_reward_mean": 298.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 350.0}, "policy_reward_mean": {"policy_0": 29.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.0, 200.0, 510.0, 320.0, 220.0, 180.0, 250.0, 330.0, 260.0, 380.0, 570.0, 280.0, 230.0, 165.0, 210.0, 280.0, 260.0, 240.0, 330.0, 370.0, 420.0, 370.0, 440.0, 310.0, 100.0, 200.0, 450.0, 300.0, 390.0, 250.0, 430.0, 160.0, 180.0, 410.0, 500.0, 185.0, 300.0, 400.0, 180.0, 290.0, 220.0, 310.0, 230.0, 345.0, 150.0, 310.0, 340.0, 150.0, 235.0, 250.0, 300.0, 320.0, 230.0, 180.0, 250.0, 170.0, 165.0, 500.0, 200.0, 250.0, 375.0, 300.0, 270.0, 390.0, 545.0, 160.0, 420.0, 560.0, 270.0, 200.0, 150.0, 400.0, 670.0, 320.0, 300.0, 370.0, 105.0, 300.0, 310.0, 400.0, 305.0, 90.0, 300.0, 360.0, 180.0, 380.0, 450.0, 245.0, 350.0, 280.0, 300.0, 280.0, 360.0, 270.0, 330.0, 155.0, 280.0, 280.0, 310.0, 270.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 20.0, 20.0, 50.0, 30.0, 0.0, 30.0, 60.0, 40.0, 10.0, 0.0, 150.0, 90.0, 0.0, -50.0, -20.0, 20.0, 10.0, 0.0, 0.0, 40.0, -80.0, 50.0, 20.0, 160.0, -40.0, 30.0, 260.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 10.0, 30.0, 60.0, 90.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 0.0, 90.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 0.0, 160.0, 10.0, 30.0, 40.0, 10.0, 30.0, 20.0, -10.0, 30.0, 10.0, 10.0, 30.0, 160.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 170.0, 10.0, 20.0, 20.0, 30.0, 10.0, 20.0, 30.0, 50.0, 20.0, 30.0, -30.0, 0.0, 10.0, 40.0, -10.0, 160.0, 40.0, 350.0, -20.0, 20.0, 20.0, 10.0, 90.0, 0.0, 20.0, 40.0, 30.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 30.0, 30.0, 30.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 30.0, 0.0, 10.0, 5.0, 10.0, 30.0, 30.0, 20.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 40.0, 60.0, 50.0, 10.0, 30.0, 10.0, 30.0, 20.0, 40.0, 50.0, 30.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 30.0, 10.0, 30.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 60.0, 0.0, 10.0, 150.0, 90.0, 50.0, 0.0, 30.0, 40.0, 0.0, 30.0, 80.0, 20.0, 30.0, 60.0, 10.0, 10.0, 160.0, 5.0, 70.0, 15.0, 40.0, 50.0, 0.0, 40.0, 40.0, 30.0, 10.0, 70.0, 40.0, 0.0, 40.0, 60.0, 40.0, 180.0, 20.0, 70.0, 170.0, 30.0, 50.0, 10.0, 0.0, -120.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 50.0, 20.0, 0.0, 0.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 30.0, 270.0, 0.0, 30.0, 30.0, 70.0, 0.0, 40.0, 30.0, 40.0, 10.0, 40.0, 0.0, 40.0, 50.0, 20.0, 40.0, 30.0, 0.0, 60.0, 60.0, 70.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 50.0, 20.0, 60.0, 20.0, 10.0, 20.0, 170.0, 10.0, 0.0, 0.0, 260.0, 10.0, 10.0, -50.0, 0.0, 50.0, 50.0, 10.0, 20.0, 0.0, 10.0, 20.0, -40.0, 20.0, 20.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 70.0, 160.0, 10.0, 30.0, 20.0, 20.0, 0.0, 40.0, 60.0, 120.0, 0.0, 70.0, 30.0, 40.0, 50.0, 40.0, 50.0, 40.0, 30.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, -5.0, 10.0, 60.0, 10.0, 10.0, 20.0, 70.0, 20.0, 30.0, 50.0, 10.0, 20.0, 30.0, 90.0, 20.0, 70.0, 40.0, -30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 0.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, -10.0, 30.0, 10.0, 10.0, 80.0, 10.0, 60.0, 10.0, 60.0, 20.0, 0.0, 50.0, 0.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 60.0, 40.0, 10.0, 40.0, 40.0, 50.0, 70.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 50.0, 20.0, 10.0, 30.0, 170.0, 20.0, 15.0, 20.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 180.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 40.0, 40.0, 170.0, 20.0, 0.0, 0.0, 50.0, 0.0, 50.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 35.0, 20.0, 30.0, 0.0, 10.0, 30.0, 70.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 10.0, 50.0, 0.0, 20.0, 50.0, 10.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 10.0, 20.0, 10.0, 150.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 20.0, 30.0, 50.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 50.0, 90.0, 30.0, 20.0, 20.0, 20.0, 0.0, 20.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 40.0, 10.0, 5.0, 0.0, 0.0, 20.0, 250.0, 40.0, 40.0, 10.0, -10.0, 30.0, 30.0, 50.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 20.0, 40.0, 5.0, 30.0, -100.0, 10.0, 20.0, 40.0, 60.0, 260.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 30.0, 0.0, -40.0, 10.0, 160.0, 20.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 40.0, 0.0, 40.0, 20.0, 40.0, 60.0, 20.0, 50.0, 70.0, 0.0, 20.0, 70.0, 0.0, 50.0, 60.0, 40.0, 70.0, 180.0, 60.0, 10.0, 25.0, 50.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 80.0, 0.0, 10.0, 30.0, 30.0, 50.0, 190.0, 40.0, 10.0, 0.0, 10.0, 20.0, 20.0, 50.0, 50.0, 50.0, 40.0, 40.0, 10.0, 180.0, -10.0, 180.0, 0.0, 20.0, 70.0, 0.0, 10.0, 10.0, 30.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 60.0, 40.0, 10.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 0.0, 170.0, 40.0, 10.0, 10.0, 70.0, 30.0, 0.0, 40.0, 30.0, 70.0, 60.0, 150.0, 40.0, 40.0, 30.0, 150.0, 20.0, 100.0, 10.0, 20.0, 0.0, 40.0, 10.0, 70.0, 10.0, 40.0, 10.0, 110.0, 10.0, 10.0, 0.0, 10.0, 180.0, 10.0, 20.0, 40.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 100.0, 150.0, 40.0, 20.0, 0.0, 5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 50.0, 100.0, 60.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 90.0, 10.0, 20.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 80.0, 30.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 25.0, 30.0, 70.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 60.0, 50.0, 40.0, 60.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 30.0, 20.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 30.0, -80.0, 180.0, 50.0, 60.0, 40.0, 60.0, 10.0, 150.0, 60.0, 20.0, 20.0, 30.0, 0.0, 90.0, 10.0, 20.0, 15.0, 10.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 0.0, 10.0, 60.0, 40.0, 50.0, 20.0, 50.0, 40.0, 60.0, 10.0, 30.0, 10.0, 20.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 80.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 130.0, 20.0, 20.0, 60.0, 80.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 10.0, 10.0, 50.0, 40.0, 10.0, 160.0, 0.0, 20.0, -20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 10.0, 70.0, 0.0, 20.0, 50.0, 20.0, 170.0, 10.0, 0.0, 10.0, 40.0, 10.0, 30.0, 20.0, 50.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 40.0, 20.0, 20.0, 160.0, 0.0, 10.0, 20.0, -40.0, 30.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 60.0, 40.0, 20.0, 0.0, 70.0, 30.0, 40.0, 0.0, 20.0, 30.0, 20.0, 60.0, 20.0, 70.0, 10.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7343685121260404, "mean_inference_ms": 1.389791717693139, "mean_action_processing_ms": 0.42007062028905645, "mean_env_wait_ms": 1.37718973128897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01419520378112793, "StateBufferConnector_ms": 0.010927677154541016, "ViewRequirementAgentConnector_ms": 0.4522221088409424}, "num_episodes": 27, "episode_return_max": 670.0, "episode_return_min": 90.0, "episode_return_mean": 298.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.289993961804875, "num_env_steps_trained_throughput_per_sec": 19.289993961804875, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 206142.971, "restore_workers_time_ms": 0.012, "training_step_time_ms": 206142.928, "sample_time_ms": 2773.569, "learn_time_ms": 203348.817, "learn_throughput": 19.671, "synch_weights_time_ms": 11.505}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 15, "trial_id": "aa996_00000", "date": "2024-05-23_23-36-55", "timestamp": 1716521815, "time_this_iter_s": 207.37632608413696, "time_total_s": 3083.3162899017334, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ff8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3083.3162899017334, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 20.077815699658704, "ram_util_percent": 79.73139931740614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0946725931347876, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5477686029907485, "policy_loss": -0.011311877531810793, "vf_loss": 5.557375493471107, "vf_explained_var": 0.0023353338558960773, "kl": 0.00852494493306481, "entropy": 1.2780689663272569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 910.0, "episode_reward_min": 90.0, "episode_reward_mean": 331.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 370.0}, "policy_reward_mean": {"policy_0": 33.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.0, 370.0, 420.0, 370.0, 440.0, 310.0, 100.0, 200.0, 450.0, 300.0, 390.0, 250.0, 430.0, 160.0, 180.0, 410.0, 500.0, 185.0, 300.0, 400.0, 180.0, 290.0, 220.0, 310.0, 230.0, 345.0, 150.0, 310.0, 340.0, 150.0, 235.0, 250.0, 300.0, 320.0, 230.0, 180.0, 250.0, 170.0, 165.0, 500.0, 200.0, 250.0, 375.0, 300.0, 270.0, 390.0, 545.0, 160.0, 420.0, 560.0, 270.0, 200.0, 150.0, 400.0, 670.0, 320.0, 300.0, 370.0, 105.0, 300.0, 310.0, 400.0, 305.0, 90.0, 300.0, 360.0, 180.0, 380.0, 450.0, 245.0, 350.0, 280.0, 300.0, 280.0, 360.0, 270.0, 330.0, 155.0, 280.0, 280.0, 310.0, 270.0, 210.0, 310.0, 910.0, 475.0, 290.0, 360.0, 400.0, 770.0, 380.0, 590.0, 325.0, 610.0, 570.0, 650.0, 180.0, 680.0, 420.0, 360.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 60.0, 0.0, 10.0, 150.0, 90.0, 50.0, 0.0, 30.0, 40.0, 0.0, 30.0, 80.0, 20.0, 30.0, 60.0, 10.0, 10.0, 160.0, 5.0, 70.0, 15.0, 40.0, 50.0, 0.0, 40.0, 40.0, 30.0, 10.0, 70.0, 40.0, 0.0, 40.0, 60.0, 40.0, 180.0, 20.0, 70.0, 170.0, 30.0, 50.0, 10.0, 0.0, -120.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 50.0, 20.0, 0.0, 0.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 30.0, 270.0, 0.0, 30.0, 30.0, 70.0, 0.0, 40.0, 30.0, 40.0, 10.0, 40.0, 0.0, 40.0, 50.0, 20.0, 40.0, 30.0, 0.0, 60.0, 60.0, 70.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 50.0, 20.0, 60.0, 20.0, 10.0, 20.0, 170.0, 10.0, 0.0, 0.0, 260.0, 10.0, 10.0, -50.0, 0.0, 50.0, 50.0, 10.0, 20.0, 0.0, 10.0, 20.0, -40.0, 20.0, 20.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 70.0, 160.0, 10.0, 30.0, 20.0, 20.0, 0.0, 40.0, 60.0, 120.0, 0.0, 70.0, 30.0, 40.0, 50.0, 40.0, 50.0, 40.0, 30.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, -5.0, 10.0, 60.0, 10.0, 10.0, 20.0, 70.0, 20.0, 30.0, 50.0, 10.0, 20.0, 30.0, 90.0, 20.0, 70.0, 40.0, -30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 0.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, -10.0, 30.0, 10.0, 10.0, 80.0, 10.0, 60.0, 10.0, 60.0, 20.0, 0.0, 50.0, 0.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 60.0, 40.0, 10.0, 40.0, 40.0, 50.0, 70.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 50.0, 20.0, 10.0, 30.0, 170.0, 20.0, 15.0, 20.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 180.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 40.0, 40.0, 170.0, 20.0, 0.0, 0.0, 50.0, 0.0, 50.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 35.0, 20.0, 30.0, 0.0, 10.0, 30.0, 70.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 10.0, 50.0, 0.0, 20.0, 50.0, 10.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 10.0, 20.0, 10.0, 150.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 20.0, 30.0, 50.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 50.0, 90.0, 30.0, 20.0, 20.0, 20.0, 0.0, 20.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 40.0, 10.0, 5.0, 0.0, 0.0, 20.0, 250.0, 40.0, 40.0, 10.0, -10.0, 30.0, 30.0, 50.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 20.0, 40.0, 5.0, 30.0, -100.0, 10.0, 20.0, 40.0, 60.0, 260.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 30.0, 0.0, -40.0, 10.0, 160.0, 20.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 40.0, 0.0, 40.0, 20.0, 40.0, 60.0, 20.0, 50.0, 70.0, 0.0, 20.0, 70.0, 0.0, 50.0, 60.0, 40.0, 70.0, 180.0, 60.0, 10.0, 25.0, 50.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 80.0, 0.0, 10.0, 30.0, 30.0, 50.0, 190.0, 40.0, 10.0, 0.0, 10.0, 20.0, 20.0, 50.0, 50.0, 50.0, 40.0, 40.0, 10.0, 180.0, -10.0, 180.0, 0.0, 20.0, 70.0, 0.0, 10.0, 10.0, 30.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 60.0, 40.0, 10.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 0.0, 170.0, 40.0, 10.0, 10.0, 70.0, 30.0, 0.0, 40.0, 30.0, 70.0, 60.0, 150.0, 40.0, 40.0, 30.0, 150.0, 20.0, 100.0, 10.0, 20.0, 0.0, 40.0, 10.0, 70.0, 10.0, 40.0, 10.0, 110.0, 10.0, 10.0, 0.0, 10.0, 180.0, 10.0, 20.0, 40.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 100.0, 150.0, 40.0, 20.0, 0.0, 5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 50.0, 100.0, 60.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 90.0, 10.0, 20.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 80.0, 30.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 25.0, 30.0, 70.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 60.0, 50.0, 40.0, 60.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 30.0, 20.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 30.0, -80.0, 180.0, 50.0, 60.0, 40.0, 60.0, 10.0, 150.0, 60.0, 20.0, 20.0, 30.0, 0.0, 90.0, 10.0, 20.0, 15.0, 10.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 0.0, 10.0, 60.0, 40.0, 50.0, 20.0, 50.0, 40.0, 60.0, 10.0, 30.0, 10.0, 20.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 80.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 130.0, 20.0, 20.0, 60.0, 80.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 10.0, 10.0, 50.0, 40.0, 10.0, 160.0, 0.0, 20.0, -20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 10.0, 70.0, 0.0, 20.0, 50.0, 20.0, 170.0, 10.0, 0.0, 10.0, 40.0, 10.0, 30.0, 20.0, 50.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 40.0, 20.0, 20.0, 160.0, 0.0, 10.0, 20.0, -40.0, 30.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 60.0, 40.0, 20.0, 0.0, 70.0, 30.0, 40.0, 0.0, 20.0, 30.0, 20.0, 60.0, 20.0, 70.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 40.0, 90.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 370.0, 20.0, 140.0, 170.0, 40.0, 80.0, 10.0, 0.0, 30.0, 170.0, 80.0, 15.0, 50.0, 10.0, 30.0, 40.0, 30.0, 30.0, 50.0, 30.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 0.0, 20.0, 60.0, 20.0, 40.0, 110.0, 20.0, 130.0, 70.0, 0.0, 30.0, 100.0, 30.0, 10.0, 10.0, 0.0, 20.0, 210.0, 0.0, 40.0, 170.0, 160.0, 50.0, -10.0, 50.0, 80.0, 60.0, 20.0, 10.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 50.0, 20.0, 190.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 200.0, 30.0, -5.0, 40.0, 30.0, 80.0, 60.0, 10.0, 40.0, 60.0, 10.0, 0.0, 80.0, 170.0, 60.0, 60.0, 70.0, 60.0, 20.0, 0.0, 80.0, 10.0, 60.0, 60.0, 40.0, 50.0, 0.0, 50.0, 30.0, 10.0, 190.0, 80.0, 80.0, 30.0, 80.0, 10.0, 150.0, 30.0, 40.0, 170.0, 40.0, 20.0, 30.0, 10.0, 30.0, 60.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 30.0, 50.0, 70.0, 300.0, 70.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 20.0, 60.0, 50.0, 30.0, 30.0, 160.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 30.0, 30.0, 0.0, 100.0, 30.0, 30.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7299327464308343, "mean_inference_ms": 1.4027349676177072, "mean_action_processing_ms": 0.4200409547446619, "mean_env_wait_ms": 1.3763059811430332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014374732971191406, "StateBufferConnector_ms": 0.011009931564331055, "ViewRequirementAgentConnector_ms": 0.4529304504394531}, "num_episodes": 18, "episode_return_max": 910.0, "episode_return_min": 90.0, "episode_return_mean": 331.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.956774118388843, "num_env_steps_trained_throughput_per_sec": 18.956774118388843, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 207140.423, "restore_workers_time_ms": 0.012, "training_step_time_ms": 207140.381, "sample_time_ms": 2765.426, "learn_time_ms": 204353.161, "learn_throughput": 19.574, "synch_weights_time_ms": 11.836}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 16, "trial_id": "aa996_00000", "date": "2024-05-23_23-40-26", "timestamp": 1716522026, "time_this_iter_s": 211.01746582984924, "time_total_s": 3294.3337557315826, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309d48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3294.3337557315826, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 21.06421404682274, "ram_util_percent": 80.35217391304347}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.025516252084789, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.415542358534531, "policy_loss": -0.009918386051783397, "vf_loss": 5.423922426301958, "vf_explained_var": 0.0008762913834426604, "kl": 0.007691557318779942, "entropy": 1.2569266784051483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 154935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 910.0, "episode_reward_min": 90.0, "episode_reward_mean": 353.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 370.0}, "policy_reward_mean": {"policy_0": 35.395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 400.0, 180.0, 290.0, 220.0, 310.0, 230.0, 345.0, 150.0, 310.0, 340.0, 150.0, 235.0, 250.0, 300.0, 320.0, 230.0, 180.0, 250.0, 170.0, 165.0, 500.0, 200.0, 250.0, 375.0, 300.0, 270.0, 390.0, 545.0, 160.0, 420.0, 560.0, 270.0, 200.0, 150.0, 400.0, 670.0, 320.0, 300.0, 370.0, 105.0, 300.0, 310.0, 400.0, 305.0, 90.0, 300.0, 360.0, 180.0, 380.0, 450.0, 245.0, 350.0, 280.0, 300.0, 280.0, 360.0, 270.0, 330.0, 155.0, 280.0, 280.0, 310.0, 270.0, 210.0, 310.0, 910.0, 475.0, 290.0, 360.0, 400.0, 770.0, 380.0, 590.0, 325.0, 610.0, 570.0, 650.0, 180.0, 680.0, 420.0, 360.0, 260.0, 380.0, 520.0, 530.0, 470.0, 150.0, 310.0, 235.0, 540.0, 420.0, 490.0, 360.0, 670.0, 610.0, 450.0, 390.0, 645.0, 610.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 10.0, 10.0, 20.0, 70.0, 20.0, 30.0, 50.0, 10.0, 20.0, 30.0, 90.0, 20.0, 70.0, 40.0, -30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 0.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, -10.0, 30.0, 10.0, 10.0, 80.0, 10.0, 60.0, 10.0, 60.0, 20.0, 0.0, 50.0, 0.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 60.0, 40.0, 10.0, 40.0, 40.0, 50.0, 70.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 50.0, 20.0, 10.0, 30.0, 170.0, 20.0, 15.0, 20.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 180.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 40.0, 40.0, 170.0, 20.0, 0.0, 0.0, 50.0, 0.0, 50.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 35.0, 20.0, 30.0, 0.0, 10.0, 30.0, 70.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 10.0, 50.0, 0.0, 20.0, 50.0, 10.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 10.0, 20.0, 10.0, 150.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 20.0, 30.0, 50.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 50.0, 90.0, 30.0, 20.0, 20.0, 20.0, 0.0, 20.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 40.0, 10.0, 5.0, 0.0, 0.0, 20.0, 250.0, 40.0, 40.0, 10.0, -10.0, 30.0, 30.0, 50.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 20.0, 40.0, 5.0, 30.0, -100.0, 10.0, 20.0, 40.0, 60.0, 260.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 30.0, 0.0, -40.0, 10.0, 160.0, 20.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 40.0, 0.0, 40.0, 20.0, 40.0, 60.0, 20.0, 50.0, 70.0, 0.0, 20.0, 70.0, 0.0, 50.0, 60.0, 40.0, 70.0, 180.0, 60.0, 10.0, 25.0, 50.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 80.0, 0.0, 10.0, 30.0, 30.0, 50.0, 190.0, 40.0, 10.0, 0.0, 10.0, 20.0, 20.0, 50.0, 50.0, 50.0, 40.0, 40.0, 10.0, 180.0, -10.0, 180.0, 0.0, 20.0, 70.0, 0.0, 10.0, 10.0, 30.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 60.0, 40.0, 10.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 0.0, 170.0, 40.0, 10.0, 10.0, 70.0, 30.0, 0.0, 40.0, 30.0, 70.0, 60.0, 150.0, 40.0, 40.0, 30.0, 150.0, 20.0, 100.0, 10.0, 20.0, 0.0, 40.0, 10.0, 70.0, 10.0, 40.0, 10.0, 110.0, 10.0, 10.0, 0.0, 10.0, 180.0, 10.0, 20.0, 40.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 100.0, 150.0, 40.0, 20.0, 0.0, 5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 50.0, 100.0, 60.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 90.0, 10.0, 20.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 80.0, 30.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 25.0, 30.0, 70.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 60.0, 50.0, 40.0, 60.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 30.0, 20.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 30.0, -80.0, 180.0, 50.0, 60.0, 40.0, 60.0, 10.0, 150.0, 60.0, 20.0, 20.0, 30.0, 0.0, 90.0, 10.0, 20.0, 15.0, 10.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 0.0, 10.0, 60.0, 40.0, 50.0, 20.0, 50.0, 40.0, 60.0, 10.0, 30.0, 10.0, 20.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 80.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 130.0, 20.0, 20.0, 60.0, 80.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 10.0, 10.0, 50.0, 40.0, 10.0, 160.0, 0.0, 20.0, -20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 10.0, 70.0, 0.0, 20.0, 50.0, 20.0, 170.0, 10.0, 0.0, 10.0, 40.0, 10.0, 30.0, 20.0, 50.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 40.0, 20.0, 20.0, 160.0, 0.0, 10.0, 20.0, -40.0, 30.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 60.0, 40.0, 20.0, 0.0, 70.0, 30.0, 40.0, 0.0, 20.0, 30.0, 20.0, 60.0, 20.0, 70.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 40.0, 90.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 370.0, 20.0, 140.0, 170.0, 40.0, 80.0, 10.0, 0.0, 30.0, 170.0, 80.0, 15.0, 50.0, 10.0, 30.0, 40.0, 30.0, 30.0, 50.0, 30.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 0.0, 20.0, 60.0, 20.0, 40.0, 110.0, 20.0, 130.0, 70.0, 0.0, 30.0, 100.0, 30.0, 10.0, 10.0, 0.0, 20.0, 210.0, 0.0, 40.0, 170.0, 160.0, 50.0, -10.0, 50.0, 80.0, 60.0, 20.0, 10.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 50.0, 20.0, 190.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 200.0, 30.0, -5.0, 40.0, 30.0, 80.0, 60.0, 10.0, 40.0, 60.0, 10.0, 0.0, 80.0, 170.0, 60.0, 60.0, 70.0, 60.0, 20.0, 0.0, 80.0, 10.0, 60.0, 60.0, 40.0, 50.0, 0.0, 50.0, 30.0, 10.0, 190.0, 80.0, 80.0, 30.0, 80.0, 10.0, 150.0, 30.0, 40.0, 170.0, 40.0, 20.0, 30.0, 10.0, 30.0, 60.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 30.0, 50.0, 70.0, 300.0, 70.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 20.0, 60.0, 50.0, 30.0, 30.0, 160.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 30.0, 30.0, 0.0, 100.0, 30.0, 30.0, 10.0, 40.0, 0.0, 10.0, 0.0, 170.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 60.0, 50.0, -30.0, 10.0, 20.0, 40.0, 150.0, 10.0, 20.0, 70.0, 10.0, 30.0, 260.0, 0.0, 20.0, 30.0, 50.0, 30.0, 80.0, 40.0, 180.0, 0.0, 0.0, 20.0, 60.0, 10.0, 90.0, 50.0, 20.0, 50.0, 30.0, 30.0, 50.0, 40.0, 60.0, 30.0, 150.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 60.0, 10.0, 100.0, 10.0, 60.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 5.0, 80.0, 0.0, 0.0, 40.0, 70.0, 40.0, 170.0, 20.0, 0.0, 30.0, 80.0, 30.0, 40.0, 60.0, 40.0, 10.0, 30.0, 200.0, 0.0, 30.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 40.0, 50.0, 140.0, 50.0, 60.0, 0.0, 40.0, 30.0, 70.0, 40.0, 30.0, 70.0, 40.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 10.0, 90.0, 40.0, 50.0, 170.0, 50.0, 40.0, 80.0, 70.0, 50.0, 10.0, 320.0, 10.0, 30.0, 0.0, 50.0, 20.0, 30.0, 90.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 20.0, 10.0, 50.0, 170.0, 170.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 90.0, 5.0, 40.0, 30.0, 10.0, 10.0, 90.0, 300.0, 30.0, 40.0, 110.0, 20.0, 30.0, 0.0, 0.0, 180.0, 30.0, 160.0, 40.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.726449134771122, "mean_inference_ms": 1.413235182216382, "mean_action_processing_ms": 0.42003305776625594, "mean_env_wait_ms": 1.375380173902612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014615535736083984, "StateBufferConnector_ms": 0.010930061340332031, "ViewRequirementAgentConnector_ms": 0.4384729862213135}, "num_episodes": 18, "episode_return_max": 910.0, "episode_return_min": 90.0, "episode_return_mean": 353.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.17982238697962, "num_env_steps_trained_throughput_per_sec": 19.17982238697962, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 207143.002, "restore_workers_time_ms": 0.012, "training_step_time_ms": 207142.96, "sample_time_ms": 2799.193, "learn_time_ms": 204321.87, "learn_throughput": 19.577, "synch_weights_time_ms": 11.734}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 17, "trial_id": "aa996_00000", "date": "2024-05-23_23-43-55", "timestamp": 1716522235, "time_this_iter_s": 208.55955982208252, "time_total_s": 3502.893315553665, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ff550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3502.893315553665, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.045762711864406, "ram_util_percent": 78.78474576271188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9165796796734722, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.814065409747683, "policy_loss": -0.010823278083179356, "vf_loss": 4.8232905516609215, "vf_explained_var": 0.0026335110235265013, "kl": 0.007990695868301794, "entropy": 1.2380597151506443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 164325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 910.0, "episode_reward_min": 90.0, "episode_reward_mean": 380.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 38.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 170.0, 165.0, 500.0, 200.0, 250.0, 375.0, 300.0, 270.0, 390.0, 545.0, 160.0, 420.0, 560.0, 270.0, 200.0, 150.0, 400.0, 670.0, 320.0, 300.0, 370.0, 105.0, 300.0, 310.0, 400.0, 305.0, 90.0, 300.0, 360.0, 180.0, 380.0, 450.0, 245.0, 350.0, 280.0, 300.0, 280.0, 360.0, 270.0, 330.0, 155.0, 280.0, 280.0, 310.0, 270.0, 210.0, 310.0, 910.0, 475.0, 290.0, 360.0, 400.0, 770.0, 380.0, 590.0, 325.0, 610.0, 570.0, 650.0, 180.0, 680.0, 420.0, 360.0, 260.0, 380.0, 520.0, 530.0, 470.0, 150.0, 310.0, 235.0, 540.0, 420.0, 490.0, 360.0, 670.0, 610.0, 450.0, 390.0, 645.0, 610.0, 340.0, 410.0, 525.0, 260.0, 320.0, 780.0, 400.0, 270.0, 240.0, 270.0, 530.0, 330.0, 740.0, 280.0, 420.0, 410.0, 530.0, 300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 10.0, 50.0, 90.0, 30.0, 20.0, 20.0, 20.0, 0.0, 20.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 40.0, 10.0, 5.0, 0.0, 0.0, 20.0, 250.0, 40.0, 40.0, 10.0, -10.0, 30.0, 30.0, 50.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 20.0, 40.0, 5.0, 30.0, -100.0, 10.0, 20.0, 40.0, 60.0, 260.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 30.0, 0.0, -40.0, 10.0, 160.0, 20.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 40.0, 0.0, 40.0, 20.0, 40.0, 60.0, 20.0, 50.0, 70.0, 0.0, 20.0, 70.0, 0.0, 50.0, 60.0, 40.0, 70.0, 180.0, 60.0, 10.0, 25.0, 50.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 80.0, 0.0, 10.0, 30.0, 30.0, 50.0, 190.0, 40.0, 10.0, 0.0, 10.0, 20.0, 20.0, 50.0, 50.0, 50.0, 40.0, 40.0, 10.0, 180.0, -10.0, 180.0, 0.0, 20.0, 70.0, 0.0, 10.0, 10.0, 30.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 60.0, 40.0, 10.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 0.0, 170.0, 40.0, 10.0, 10.0, 70.0, 30.0, 0.0, 40.0, 30.0, 70.0, 60.0, 150.0, 40.0, 40.0, 30.0, 150.0, 20.0, 100.0, 10.0, 20.0, 0.0, 40.0, 10.0, 70.0, 10.0, 40.0, 10.0, 110.0, 10.0, 10.0, 0.0, 10.0, 180.0, 10.0, 20.0, 40.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 100.0, 150.0, 40.0, 20.0, 0.0, 5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 50.0, 100.0, 60.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 90.0, 10.0, 20.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 80.0, 30.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 25.0, 30.0, 70.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 60.0, 50.0, 40.0, 60.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 30.0, 20.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 30.0, -80.0, 180.0, 50.0, 60.0, 40.0, 60.0, 10.0, 150.0, 60.0, 20.0, 20.0, 30.0, 0.0, 90.0, 10.0, 20.0, 15.0, 10.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 0.0, 10.0, 60.0, 40.0, 50.0, 20.0, 50.0, 40.0, 60.0, 10.0, 30.0, 10.0, 20.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 80.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 130.0, 20.0, 20.0, 60.0, 80.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 10.0, 10.0, 50.0, 40.0, 10.0, 160.0, 0.0, 20.0, -20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 10.0, 70.0, 0.0, 20.0, 50.0, 20.0, 170.0, 10.0, 0.0, 10.0, 40.0, 10.0, 30.0, 20.0, 50.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 40.0, 20.0, 20.0, 160.0, 0.0, 10.0, 20.0, -40.0, 30.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 60.0, 40.0, 20.0, 0.0, 70.0, 30.0, 40.0, 0.0, 20.0, 30.0, 20.0, 60.0, 20.0, 70.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 40.0, 90.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 370.0, 20.0, 140.0, 170.0, 40.0, 80.0, 10.0, 0.0, 30.0, 170.0, 80.0, 15.0, 50.0, 10.0, 30.0, 40.0, 30.0, 30.0, 50.0, 30.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 0.0, 20.0, 60.0, 20.0, 40.0, 110.0, 20.0, 130.0, 70.0, 0.0, 30.0, 100.0, 30.0, 10.0, 10.0, 0.0, 20.0, 210.0, 0.0, 40.0, 170.0, 160.0, 50.0, -10.0, 50.0, 80.0, 60.0, 20.0, 10.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 50.0, 20.0, 190.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 200.0, 30.0, -5.0, 40.0, 30.0, 80.0, 60.0, 10.0, 40.0, 60.0, 10.0, 0.0, 80.0, 170.0, 60.0, 60.0, 70.0, 60.0, 20.0, 0.0, 80.0, 10.0, 60.0, 60.0, 40.0, 50.0, 0.0, 50.0, 30.0, 10.0, 190.0, 80.0, 80.0, 30.0, 80.0, 10.0, 150.0, 30.0, 40.0, 170.0, 40.0, 20.0, 30.0, 10.0, 30.0, 60.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 30.0, 50.0, 70.0, 300.0, 70.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 20.0, 60.0, 50.0, 30.0, 30.0, 160.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 30.0, 30.0, 0.0, 100.0, 30.0, 30.0, 10.0, 40.0, 0.0, 10.0, 0.0, 170.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 60.0, 50.0, -30.0, 10.0, 20.0, 40.0, 150.0, 10.0, 20.0, 70.0, 10.0, 30.0, 260.0, 0.0, 20.0, 30.0, 50.0, 30.0, 80.0, 40.0, 180.0, 0.0, 0.0, 20.0, 60.0, 10.0, 90.0, 50.0, 20.0, 50.0, 30.0, 30.0, 50.0, 40.0, 60.0, 30.0, 150.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 60.0, 10.0, 100.0, 10.0, 60.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 5.0, 80.0, 0.0, 0.0, 40.0, 70.0, 40.0, 170.0, 20.0, 0.0, 30.0, 80.0, 30.0, 40.0, 60.0, 40.0, 10.0, 30.0, 200.0, 0.0, 30.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 40.0, 50.0, 140.0, 50.0, 60.0, 0.0, 40.0, 30.0, 70.0, 40.0, 30.0, 70.0, 40.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 10.0, 90.0, 40.0, 50.0, 170.0, 50.0, 40.0, 80.0, 70.0, 50.0, 10.0, 320.0, 10.0, 30.0, 0.0, 50.0, 20.0, 30.0, 90.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 20.0, 10.0, 50.0, 170.0, 170.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 90.0, 5.0, 40.0, 30.0, 10.0, 10.0, 90.0, 300.0, 30.0, 40.0, 110.0, 20.0, 30.0, 0.0, 0.0, 180.0, 30.0, 160.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 40.0, 190.0, 10.0, 10.0, 10.0, 70.0, 30.0, 120.0, 80.0, 10.0, 10.0, 30.0, 50.0, 0.0, 180.0, 35.0, 90.0, 60.0, 80.0, 30.0, 60.0, -20.0, -30.0, 40.0, 30.0, 50.0, 50.0, 0.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 10.0, 10.0, 0.0, 20.0, 40.0, 40.0, 160.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 520.0, 20.0, 40.0, 50.0, 160.0, 10.0, 30.0, 0.0, 10.0, 50.0, 20.0, 20.0, 40.0, 60.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 20.0, 170.0, 10.0, 20.0, 60.0, 0.0, 30.0, 0.0, 20.0, 60.0, 10.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 50.0, 120.0, 70.0, 40.0, 40.0, 20.0, 50.0, 190.0, 70.0, 10.0, 20.0, 20.0, 20.0, 180.0, 10.0, 40.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 50.0, 30.0, 0.0, 680.0, -20.0, 0.0, 10.0, 20.0, 70.0, 30.0, 20.0, 50.0, 20.0, 60.0, 0.0, 10.0, 50.0, 30.0, 30.0, 30.0, 20.0, 110.0, 40.0, 80.0, 20.0, 40.0, 10.0, 50.0, 40.0, 40.0, 40.0, 40.0, 100.0, 10.0, 40.0, 40.0, 10.0, 40.0, -90.0, 160.0, 60.0, 60.0, 180.0, 10.0, 60.0, 0.0, -40.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 0.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7227331627016402, "mean_inference_ms": 1.4216571278685697, "mean_action_processing_ms": 0.4198435505284245, "mean_env_wait_ms": 1.3739965045970512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014804601669311523, "StateBufferConnector_ms": 0.010912656784057617, "ViewRequirementAgentConnector_ms": 0.4391744136810303}, "num_episodes": 18, "episode_return_max": 910.0, "episode_return_min": 90.0, "episode_return_mean": 380.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.02780386249397, "num_env_steps_trained_throughput_per_sec": 19.02780386249397, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 207477.212, "restore_workers_time_ms": 0.012, "training_step_time_ms": 207477.17, "sample_time_ms": 2836.148, "learn_time_ms": 204618.961, "learn_throughput": 19.549, "synch_weights_time_ms": 11.811}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 18, "trial_id": "aa996_00000", "date": "2024-05-23_23-47-25", "timestamp": 1716522445, "time_this_iter_s": 210.25552988052368, "time_total_s": 3713.148845434189, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ffc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3713.148845434189, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.537373737373738, "ram_util_percent": 80.37845117845119}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.916538887981155, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.275600924100866, "policy_loss": -0.010201538718901615, "vf_loss": 5.284202938998977, "vf_explained_var": 0.00011292726467973508, "kl": 0.00799761774562721, "entropy": 1.2080174836233908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 173715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 910.0, "episode_reward_min": 90.0, "episode_reward_mean": 402.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 40.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.0, 300.0, 310.0, 400.0, 305.0, 90.0, 300.0, 360.0, 180.0, 380.0, 450.0, 245.0, 350.0, 280.0, 300.0, 280.0, 360.0, 270.0, 330.0, 155.0, 280.0, 280.0, 310.0, 270.0, 210.0, 310.0, 910.0, 475.0, 290.0, 360.0, 400.0, 770.0, 380.0, 590.0, 325.0, 610.0, 570.0, 650.0, 180.0, 680.0, 420.0, 360.0, 260.0, 380.0, 520.0, 530.0, 470.0, 150.0, 310.0, 235.0, 540.0, 420.0, 490.0, 360.0, 670.0, 610.0, 450.0, 390.0, 645.0, 610.0, 340.0, 410.0, 525.0, 260.0, 320.0, 780.0, 400.0, 270.0, 240.0, 270.0, 530.0, 330.0, 740.0, 280.0, 420.0, 410.0, 530.0, 300.0, 730.0, 235.0, 745.0, 520.0, 710.0, 320.0, 100.0, 350.0, 365.0, 340.0, 665.0, 580.0, 350.0, 490.0, 720.0, 320.0, 260.0, 230.0, 310.0, 515.0, 200.0, 430.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 50.0, 100.0, 60.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 90.0, 10.0, 20.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 80.0, 30.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 25.0, 30.0, 70.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 60.0, 50.0, 40.0, 60.0, 50.0, 40.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 30.0, 20.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 30.0, -80.0, 180.0, 50.0, 60.0, 40.0, 60.0, 10.0, 150.0, 60.0, 20.0, 20.0, 30.0, 0.0, 90.0, 10.0, 20.0, 15.0, 10.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 0.0, 10.0, 60.0, 40.0, 50.0, 20.0, 50.0, 40.0, 60.0, 10.0, 30.0, 10.0, 20.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 80.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 130.0, 20.0, 20.0, 60.0, 80.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 10.0, 10.0, 50.0, 40.0, 10.0, 160.0, 0.0, 20.0, -20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 10.0, 70.0, 0.0, 20.0, 50.0, 20.0, 170.0, 10.0, 0.0, 10.0, 40.0, 10.0, 30.0, 20.0, 50.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 40.0, 20.0, 20.0, 160.0, 0.0, 10.0, 20.0, -40.0, 30.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 60.0, 40.0, 20.0, 0.0, 70.0, 30.0, 40.0, 0.0, 20.0, 30.0, 20.0, 60.0, 20.0, 70.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 40.0, 90.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 370.0, 20.0, 140.0, 170.0, 40.0, 80.0, 10.0, 0.0, 30.0, 170.0, 80.0, 15.0, 50.0, 10.0, 30.0, 40.0, 30.0, 30.0, 50.0, 30.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 0.0, 20.0, 60.0, 20.0, 40.0, 110.0, 20.0, 130.0, 70.0, 0.0, 30.0, 100.0, 30.0, 10.0, 10.0, 0.0, 20.0, 210.0, 0.0, 40.0, 170.0, 160.0, 50.0, -10.0, 50.0, 80.0, 60.0, 20.0, 10.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 50.0, 20.0, 190.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 200.0, 30.0, -5.0, 40.0, 30.0, 80.0, 60.0, 10.0, 40.0, 60.0, 10.0, 0.0, 80.0, 170.0, 60.0, 60.0, 70.0, 60.0, 20.0, 0.0, 80.0, 10.0, 60.0, 60.0, 40.0, 50.0, 0.0, 50.0, 30.0, 10.0, 190.0, 80.0, 80.0, 30.0, 80.0, 10.0, 150.0, 30.0, 40.0, 170.0, 40.0, 20.0, 30.0, 10.0, 30.0, 60.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 30.0, 50.0, 70.0, 300.0, 70.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 20.0, 60.0, 50.0, 30.0, 30.0, 160.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 30.0, 30.0, 0.0, 100.0, 30.0, 30.0, 10.0, 40.0, 0.0, 10.0, 0.0, 170.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 60.0, 50.0, -30.0, 10.0, 20.0, 40.0, 150.0, 10.0, 20.0, 70.0, 10.0, 30.0, 260.0, 0.0, 20.0, 30.0, 50.0, 30.0, 80.0, 40.0, 180.0, 0.0, 0.0, 20.0, 60.0, 10.0, 90.0, 50.0, 20.0, 50.0, 30.0, 30.0, 50.0, 40.0, 60.0, 30.0, 150.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 60.0, 10.0, 100.0, 10.0, 60.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 5.0, 80.0, 0.0, 0.0, 40.0, 70.0, 40.0, 170.0, 20.0, 0.0, 30.0, 80.0, 30.0, 40.0, 60.0, 40.0, 10.0, 30.0, 200.0, 0.0, 30.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 40.0, 50.0, 140.0, 50.0, 60.0, 0.0, 40.0, 30.0, 70.0, 40.0, 30.0, 70.0, 40.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 10.0, 90.0, 40.0, 50.0, 170.0, 50.0, 40.0, 80.0, 70.0, 50.0, 10.0, 320.0, 10.0, 30.0, 0.0, 50.0, 20.0, 30.0, 90.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 20.0, 10.0, 50.0, 170.0, 170.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 90.0, 5.0, 40.0, 30.0, 10.0, 10.0, 90.0, 300.0, 30.0, 40.0, 110.0, 20.0, 30.0, 0.0, 0.0, 180.0, 30.0, 160.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 40.0, 190.0, 10.0, 10.0, 10.0, 70.0, 30.0, 120.0, 80.0, 10.0, 10.0, 30.0, 50.0, 0.0, 180.0, 35.0, 90.0, 60.0, 80.0, 30.0, 60.0, -20.0, -30.0, 40.0, 30.0, 50.0, 50.0, 0.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 10.0, 10.0, 0.0, 20.0, 40.0, 40.0, 160.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 520.0, 20.0, 40.0, 50.0, 160.0, 10.0, 30.0, 0.0, 10.0, 50.0, 20.0, 20.0, 40.0, 60.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 20.0, 170.0, 10.0, 20.0, 60.0, 0.0, 30.0, 0.0, 20.0, 60.0, 10.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 50.0, 120.0, 70.0, 40.0, 40.0, 20.0, 50.0, 190.0, 70.0, 10.0, 20.0, 20.0, 20.0, 180.0, 10.0, 40.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 50.0, 30.0, 0.0, 680.0, -20.0, 0.0, 10.0, 20.0, 70.0, 30.0, 20.0, 50.0, 20.0, 60.0, 0.0, 10.0, 50.0, 30.0, 30.0, 30.0, 20.0, 110.0, 40.0, 80.0, 20.0, 40.0, 10.0, 50.0, 40.0, 40.0, 40.0, 40.0, 100.0, 10.0, 40.0, 40.0, 10.0, 40.0, -90.0, 160.0, 60.0, 60.0, 180.0, 10.0, 60.0, 0.0, -40.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 0.0, 170.0, 50.0, 40.0, 70.0, 180.0, 100.0, 170.0, 40.0, 30.0, 10.0, 40.0, 60.0, 10.0, -10.0, 30.0, 20.0, 70.0, 20.0, 0.0, 10.0, 25.0, 40.0, 40.0, 310.0, 35.0, 110.0, 50.0, 30.0, 0.0, 90.0, 40.0, 0.0, 50.0, 0.0, 50.0, 20.0, -40.0, 80.0, 240.0, 70.0, 50.0, 0.0, 0.0, 70.0, 80.0, 150.0, 20.0, 40.0, 180.0, 0.0, 170.0, 10.0, 60.0, 30.0, 30.0, 30.0, 50.0, 40.0, 0.0, 70.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, -110.0, 40.0, 180.0, 20.0, 50.0, 90.0, 20.0, 40.0, 10.0, 10.0, 0.0, 110.0, -5.0, 70.0, 50.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 40.0, 40.0, 90.0, 20.0, 30.0, 0.0, 50.0, 0.0, 40.0, 20.0, 310.0, -15.0, 20.0, 30.0, 80.0, 20.0, 30.0, 70.0, 100.0, 70.0, 60.0, 20.0, 100.0, 160.0, 40.0, 20.0, 30.0, 40.0, 40.0, 30.0, 10.0, 0.0, 60.0, 90.0, 40.0, 30.0, 10.0, 50.0, 30.0, 70.0, 60.0, 10.0, 50.0, 30.0, 10.0, 40.0, 20.0, 30.0, 170.0, 60.0, 30.0, 110.0, 80.0, 180.0, 60.0, 80.0, 20.0, 60.0, 40.0, 90.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 40.0, 50.0, 10.0, 30.0, 0.0, 10.0, 10.0, -40.0, 190.0, 70.0, 30.0, 0.0, 30.0, 130.0, 20.0, 50.0, 25.0, 0.0, 0.0, 40.0, 180.0, 40.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, 50.0, 40.0, 20.0, 70.0, 20.0, 40.0, 40.0, 60.0, 80.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7211720955715757, "mean_inference_ms": 1.4309587570120224, "mean_action_processing_ms": 0.41954235715877103, "mean_env_wait_ms": 1.371805346758988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014794111251831055, "StateBufferConnector_ms": 0.01150059700012207, "ViewRequirementAgentConnector_ms": 0.4356224536895752}, "num_episodes": 22, "episode_return_max": 910.0, "episode_return_min": 90.0, "episode_return_mean": 402.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.31458709763097, "num_env_steps_trained_throughput_per_sec": 19.31458709763097, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 207523.671, "restore_workers_time_ms": 0.012, "training_step_time_ms": 207523.624, "sample_time_ms": 2831.537, "learn_time_ms": 204669.871, "learn_throughput": 19.544, "synch_weights_time_ms": 11.807}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 19, "trial_id": "aa996_00000", "date": "2024-05-23_23-50-52", "timestamp": 1716522652, "time_this_iter_s": 207.1051058769226, "time_total_s": 3920.2539513111115, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309d4af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3920.2539513111115, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.38156996587031, "ram_util_percent": 79.38703071672356}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8119050680956266, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.761528020367201, "policy_loss": -0.00972304802020482, "vf_loss": 5.769659616238774, "vf_explained_var": 0.001043849567762706, "kl": 0.007957242545973346, "entropy": 1.1647982555710343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 183105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 910.0, "episode_reward_min": 100.0, "episode_reward_mean": 455.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 45.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.0, 210.0, 310.0, 910.0, 475.0, 290.0, 360.0, 400.0, 770.0, 380.0, 590.0, 325.0, 610.0, 570.0, 650.0, 180.0, 680.0, 420.0, 360.0, 260.0, 380.0, 520.0, 530.0, 470.0, 150.0, 310.0, 235.0, 540.0, 420.0, 490.0, 360.0, 670.0, 610.0, 450.0, 390.0, 645.0, 610.0, 340.0, 410.0, 525.0, 260.0, 320.0, 780.0, 400.0, 270.0, 240.0, 270.0, 530.0, 330.0, 740.0, 280.0, 420.0, 410.0, 530.0, 300.0, 730.0, 235.0, 745.0, 520.0, 710.0, 320.0, 100.0, 350.0, 365.0, 340.0, 665.0, 580.0, 350.0, 490.0, 720.0, 320.0, 260.0, 230.0, 310.0, 515.0, 200.0, 430.0, 520.0, 390.0, 605.0, 460.0, 500.0, 450.0, 850.0, 415.0, 415.0, 660.0, 520.0, 380.0, 840.0, 340.0, 530.0, 250.0, 430.0, 660.0, 610.0, 190.0, 550.0, 640.0, 680.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 30.0, 20.0, 60.0, 20.0, 70.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 40.0, 90.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 370.0, 20.0, 140.0, 170.0, 40.0, 80.0, 10.0, 0.0, 30.0, 170.0, 80.0, 15.0, 50.0, 10.0, 30.0, 40.0, 30.0, 30.0, 50.0, 30.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 0.0, 20.0, 60.0, 20.0, 40.0, 110.0, 20.0, 130.0, 70.0, 0.0, 30.0, 100.0, 30.0, 10.0, 10.0, 0.0, 20.0, 210.0, 0.0, 40.0, 170.0, 160.0, 50.0, -10.0, 50.0, 80.0, 60.0, 20.0, 10.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 50.0, 20.0, 190.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 200.0, 30.0, -5.0, 40.0, 30.0, 80.0, 60.0, 10.0, 40.0, 60.0, 10.0, 0.0, 80.0, 170.0, 60.0, 60.0, 70.0, 60.0, 20.0, 0.0, 80.0, 10.0, 60.0, 60.0, 40.0, 50.0, 0.0, 50.0, 30.0, 10.0, 190.0, 80.0, 80.0, 30.0, 80.0, 10.0, 150.0, 30.0, 40.0, 170.0, 40.0, 20.0, 30.0, 10.0, 30.0, 60.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 30.0, 50.0, 70.0, 300.0, 70.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 20.0, 60.0, 50.0, 30.0, 30.0, 160.0, 10.0, 20.0, 0.0, 20.0, 40.0, 70.0, 30.0, 30.0, 0.0, 100.0, 30.0, 30.0, 10.0, 40.0, 0.0, 10.0, 0.0, 170.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 60.0, 50.0, -30.0, 10.0, 20.0, 40.0, 150.0, 10.0, 20.0, 70.0, 10.0, 30.0, 260.0, 0.0, 20.0, 30.0, 50.0, 30.0, 80.0, 40.0, 180.0, 0.0, 0.0, 20.0, 60.0, 10.0, 90.0, 50.0, 20.0, 50.0, 30.0, 30.0, 50.0, 40.0, 60.0, 30.0, 150.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 60.0, 10.0, 100.0, 10.0, 60.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 5.0, 80.0, 0.0, 0.0, 40.0, 70.0, 40.0, 170.0, 20.0, 0.0, 30.0, 80.0, 30.0, 40.0, 60.0, 40.0, 10.0, 30.0, 200.0, 0.0, 30.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 40.0, 50.0, 140.0, 50.0, 60.0, 0.0, 40.0, 30.0, 70.0, 40.0, 30.0, 70.0, 40.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 10.0, 90.0, 40.0, 50.0, 170.0, 50.0, 40.0, 80.0, 70.0, 50.0, 10.0, 320.0, 10.0, 30.0, 0.0, 50.0, 20.0, 30.0, 90.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 20.0, 10.0, 50.0, 170.0, 170.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 90.0, 5.0, 40.0, 30.0, 10.0, 10.0, 90.0, 300.0, 30.0, 40.0, 110.0, 20.0, 30.0, 0.0, 0.0, 180.0, 30.0, 160.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 40.0, 190.0, 10.0, 10.0, 10.0, 70.0, 30.0, 120.0, 80.0, 10.0, 10.0, 30.0, 50.0, 0.0, 180.0, 35.0, 90.0, 60.0, 80.0, 30.0, 60.0, -20.0, -30.0, 40.0, 30.0, 50.0, 50.0, 0.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 10.0, 10.0, 0.0, 20.0, 40.0, 40.0, 160.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 520.0, 20.0, 40.0, 50.0, 160.0, 10.0, 30.0, 0.0, 10.0, 50.0, 20.0, 20.0, 40.0, 60.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 20.0, 170.0, 10.0, 20.0, 60.0, 0.0, 30.0, 0.0, 20.0, 60.0, 10.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 50.0, 120.0, 70.0, 40.0, 40.0, 20.0, 50.0, 190.0, 70.0, 10.0, 20.0, 20.0, 20.0, 180.0, 10.0, 40.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 50.0, 30.0, 0.0, 680.0, -20.0, 0.0, 10.0, 20.0, 70.0, 30.0, 20.0, 50.0, 20.0, 60.0, 0.0, 10.0, 50.0, 30.0, 30.0, 30.0, 20.0, 110.0, 40.0, 80.0, 20.0, 40.0, 10.0, 50.0, 40.0, 40.0, 40.0, 40.0, 100.0, 10.0, 40.0, 40.0, 10.0, 40.0, -90.0, 160.0, 60.0, 60.0, 180.0, 10.0, 60.0, 0.0, -40.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 0.0, 170.0, 50.0, 40.0, 70.0, 180.0, 100.0, 170.0, 40.0, 30.0, 10.0, 40.0, 60.0, 10.0, -10.0, 30.0, 20.0, 70.0, 20.0, 0.0, 10.0, 25.0, 40.0, 40.0, 310.0, 35.0, 110.0, 50.0, 30.0, 0.0, 90.0, 40.0, 0.0, 50.0, 0.0, 50.0, 20.0, -40.0, 80.0, 240.0, 70.0, 50.0, 0.0, 0.0, 70.0, 80.0, 150.0, 20.0, 40.0, 180.0, 0.0, 170.0, 10.0, 60.0, 30.0, 30.0, 30.0, 50.0, 40.0, 0.0, 70.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, -110.0, 40.0, 180.0, 20.0, 50.0, 90.0, 20.0, 40.0, 10.0, 10.0, 0.0, 110.0, -5.0, 70.0, 50.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 40.0, 40.0, 90.0, 20.0, 30.0, 0.0, 50.0, 0.0, 40.0, 20.0, 310.0, -15.0, 20.0, 30.0, 80.0, 20.0, 30.0, 70.0, 100.0, 70.0, 60.0, 20.0, 100.0, 160.0, 40.0, 20.0, 30.0, 40.0, 40.0, 30.0, 10.0, 0.0, 60.0, 90.0, 40.0, 30.0, 10.0, 50.0, 30.0, 70.0, 60.0, 10.0, 50.0, 30.0, 10.0, 40.0, 20.0, 30.0, 170.0, 60.0, 30.0, 110.0, 80.0, 180.0, 60.0, 80.0, 20.0, 60.0, 40.0, 90.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 40.0, 50.0, 10.0, 30.0, 0.0, 10.0, 10.0, -40.0, 190.0, 70.0, 30.0, 0.0, 30.0, 130.0, 20.0, 50.0, 25.0, 0.0, 0.0, 40.0, 180.0, 40.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, 50.0, 40.0, 20.0, 70.0, 20.0, 40.0, 40.0, 60.0, 80.0, 10.0, 40.0, 40.0, 0.0, 160.0, 30.0, 180.0, 20.0, 30.0, 10.0, 10.0, 30.0, 40.0, 60.0, 50.0, 30.0, 50.0, 50.0, 70.0, 10.0, 0.0, 180.0, 20.0, 50.0, -5.0, 50.0, 50.0, 80.0, 30.0, 60.0, 90.0, 40.0, 60.0, 30.0, 10.0, 10.0, 100.0, 60.0, 60.0, 30.0, 60.0, 30.0, 70.0, 0.0, 60.0, 40.0, -5.0, 250.0, 20.0, 30.0, 5.0, 110.0, 30.0, 60.0, 40.0, 90.0, 60.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 20.0, 0.0, 20.0, 50.0, 50.0, 90.0, 40.0, 560.0, 70.0, 40.0, 50.0, 50.0, 10.0, 10.0, 5.0, 30.0, 10.0, 140.0, 10.0, 40.0, 90.0, 5.0, 60.0, 20.0, 40.0, 50.0, 100.0, 0.0, 60.0, 90.0, 70.0, 50.0, 30.0, -30.0, 0.0, 260.0, 40.0, 90.0, 0.0, 90.0, 20.0, 80.0, 20.0, 50.0, 110.0, 0.0, 80.0, 70.0, 30.0, 170.0, 30.0, 30.0, 0.0, 0.0, 40.0, 20.0, 50.0, 10.0, 160.0, 170.0, 20.0, 100.0, 20.0, 10.0, 270.0, 20.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 100.0, 110.0, 30.0, 10.0, 0.0, 10.0, 10.0, 70.0, 50.0, 260.0, 50.0, 20.0, 50.0, 20.0, 0.0, 10.0, 10.0, 70.0, 10.0, 50.0, 30.0, 30.0, 20.0, 30.0, 10.0, 60.0, 90.0, 40.0, 30.0, 20.0, 10.0, 130.0, 10.0, 30.0, 180.0, 30.0, 0.0, 90.0, 60.0, 160.0, 30.0, 70.0, 10.0, 60.0, 70.0, 70.0, 60.0, 70.0, 110.0, 30.0, 90.0, 20.0, 30.0, 0.0, 60.0, 30.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 40.0, 20.0, 40.0, 100.0, 70.0, 60.0, 20.0, 150.0, 30.0, 70.0, 70.0, 40.0, 110.0, 30.0, 40.0, 30.0, 20.0, 200.0, 60.0, 70.0, 150.0, 0.0, 0.0, 30.0, 70.0, 60.0, 90.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7130661988063571, "mean_inference_ms": 1.4330201702665415, "mean_action_processing_ms": 0.41862146402643546, "mean_env_wait_ms": 1.370158011776331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014793634414672852, "StateBufferConnector_ms": 0.01150655746459961, "ViewRequirementAgentConnector_ms": 0.42386960983276367}, "num_episodes": 23, "episode_return_max": 910.0, "episode_return_min": 100.0, "episode_return_mean": 455.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.166226113986966, "num_env_steps_trained_throughput_per_sec": 19.166226113986966, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 207747.6, "restore_workers_time_ms": 0.012, "training_step_time_ms": 207747.554, "sample_time_ms": 2809.36, "learn_time_ms": 204916.378, "learn_throughput": 19.52, "synch_weights_time_ms": 11.49}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 20, "trial_id": "aa996_00000", "date": "2024-05-23_23-54-21", "timestamp": 1716522861, "time_this_iter_s": 208.7113070487976, "time_total_s": 4128.965258359909, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x33098ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4128.965258359909, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.02542372881356, "ram_util_percent": 79.65322033898305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8134836891080879, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.068864225706481, "policy_loss": -0.00944231892715251, "vf_loss": 6.076795207755888, "vf_explained_var": 0.0012285248476603288, "kl": 0.007556679519604866, "entropy": 1.124682800254375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 192495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 1010.0, "episode_reward_min": 100.0, "episode_reward_mean": 482.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 48.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.0, 260.0, 380.0, 520.0, 530.0, 470.0, 150.0, 310.0, 235.0, 540.0, 420.0, 490.0, 360.0, 670.0, 610.0, 450.0, 390.0, 645.0, 610.0, 340.0, 410.0, 525.0, 260.0, 320.0, 780.0, 400.0, 270.0, 240.0, 270.0, 530.0, 330.0, 740.0, 280.0, 420.0, 410.0, 530.0, 300.0, 730.0, 235.0, 745.0, 520.0, 710.0, 320.0, 100.0, 350.0, 365.0, 340.0, 665.0, 580.0, 350.0, 490.0, 720.0, 320.0, 260.0, 230.0, 310.0, 515.0, 200.0, 430.0, 520.0, 390.0, 605.0, 460.0, 500.0, 450.0, 850.0, 415.0, 415.0, 660.0, 520.0, 380.0, 840.0, 340.0, 530.0, 250.0, 430.0, 660.0, 610.0, 190.0, 550.0, 640.0, 680.0, 270.0, 690.0, 940.0, 730.0, 570.0, 285.0, 580.0, 665.0, 370.0, 680.0, 640.0, 330.0, 580.0, 330.0, 940.0, 990.0, 1010.0, 500.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 40.0, 70.0, 30.0, 30.0, 0.0, 100.0, 30.0, 30.0, 10.0, 40.0, 0.0, 10.0, 0.0, 170.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 60.0, 50.0, -30.0, 10.0, 20.0, 40.0, 150.0, 10.0, 20.0, 70.0, 10.0, 30.0, 260.0, 0.0, 20.0, 30.0, 50.0, 30.0, 80.0, 40.0, 180.0, 0.0, 0.0, 20.0, 60.0, 10.0, 90.0, 50.0, 20.0, 50.0, 30.0, 30.0, 50.0, 40.0, 60.0, 30.0, 150.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 60.0, 10.0, 100.0, 10.0, 60.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 5.0, 80.0, 0.0, 0.0, 40.0, 70.0, 40.0, 170.0, 20.0, 0.0, 30.0, 80.0, 30.0, 40.0, 60.0, 40.0, 10.0, 30.0, 200.0, 0.0, 30.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 40.0, 50.0, 140.0, 50.0, 60.0, 0.0, 40.0, 30.0, 70.0, 40.0, 30.0, 70.0, 40.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 10.0, 90.0, 40.0, 50.0, 170.0, 50.0, 40.0, 80.0, 70.0, 50.0, 10.0, 320.0, 10.0, 30.0, 0.0, 50.0, 20.0, 30.0, 90.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 20.0, 10.0, 50.0, 170.0, 170.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 90.0, 5.0, 40.0, 30.0, 10.0, 10.0, 90.0, 300.0, 30.0, 40.0, 110.0, 20.0, 30.0, 0.0, 0.0, 180.0, 30.0, 160.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 40.0, 190.0, 10.0, 10.0, 10.0, 70.0, 30.0, 120.0, 80.0, 10.0, 10.0, 30.0, 50.0, 0.0, 180.0, 35.0, 90.0, 60.0, 80.0, 30.0, 60.0, -20.0, -30.0, 40.0, 30.0, 50.0, 50.0, 0.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 10.0, 10.0, 0.0, 20.0, 40.0, 40.0, 160.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 520.0, 20.0, 40.0, 50.0, 160.0, 10.0, 30.0, 0.0, 10.0, 50.0, 20.0, 20.0, 40.0, 60.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 20.0, 170.0, 10.0, 20.0, 60.0, 0.0, 30.0, 0.0, 20.0, 60.0, 10.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 50.0, 120.0, 70.0, 40.0, 40.0, 20.0, 50.0, 190.0, 70.0, 10.0, 20.0, 20.0, 20.0, 180.0, 10.0, 40.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 50.0, 30.0, 0.0, 680.0, -20.0, 0.0, 10.0, 20.0, 70.0, 30.0, 20.0, 50.0, 20.0, 60.0, 0.0, 10.0, 50.0, 30.0, 30.0, 30.0, 20.0, 110.0, 40.0, 80.0, 20.0, 40.0, 10.0, 50.0, 40.0, 40.0, 40.0, 40.0, 100.0, 10.0, 40.0, 40.0, 10.0, 40.0, -90.0, 160.0, 60.0, 60.0, 180.0, 10.0, 60.0, 0.0, -40.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 0.0, 170.0, 50.0, 40.0, 70.0, 180.0, 100.0, 170.0, 40.0, 30.0, 10.0, 40.0, 60.0, 10.0, -10.0, 30.0, 20.0, 70.0, 20.0, 0.0, 10.0, 25.0, 40.0, 40.0, 310.0, 35.0, 110.0, 50.0, 30.0, 0.0, 90.0, 40.0, 0.0, 50.0, 0.0, 50.0, 20.0, -40.0, 80.0, 240.0, 70.0, 50.0, 0.0, 0.0, 70.0, 80.0, 150.0, 20.0, 40.0, 180.0, 0.0, 170.0, 10.0, 60.0, 30.0, 30.0, 30.0, 50.0, 40.0, 0.0, 70.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, -110.0, 40.0, 180.0, 20.0, 50.0, 90.0, 20.0, 40.0, 10.0, 10.0, 0.0, 110.0, -5.0, 70.0, 50.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 40.0, 40.0, 90.0, 20.0, 30.0, 0.0, 50.0, 0.0, 40.0, 20.0, 310.0, -15.0, 20.0, 30.0, 80.0, 20.0, 30.0, 70.0, 100.0, 70.0, 60.0, 20.0, 100.0, 160.0, 40.0, 20.0, 30.0, 40.0, 40.0, 30.0, 10.0, 0.0, 60.0, 90.0, 40.0, 30.0, 10.0, 50.0, 30.0, 70.0, 60.0, 10.0, 50.0, 30.0, 10.0, 40.0, 20.0, 30.0, 170.0, 60.0, 30.0, 110.0, 80.0, 180.0, 60.0, 80.0, 20.0, 60.0, 40.0, 90.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 40.0, 50.0, 10.0, 30.0, 0.0, 10.0, 10.0, -40.0, 190.0, 70.0, 30.0, 0.0, 30.0, 130.0, 20.0, 50.0, 25.0, 0.0, 0.0, 40.0, 180.0, 40.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, 50.0, 40.0, 20.0, 70.0, 20.0, 40.0, 40.0, 60.0, 80.0, 10.0, 40.0, 40.0, 0.0, 160.0, 30.0, 180.0, 20.0, 30.0, 10.0, 10.0, 30.0, 40.0, 60.0, 50.0, 30.0, 50.0, 50.0, 70.0, 10.0, 0.0, 180.0, 20.0, 50.0, -5.0, 50.0, 50.0, 80.0, 30.0, 60.0, 90.0, 40.0, 60.0, 30.0, 10.0, 10.0, 100.0, 60.0, 60.0, 30.0, 60.0, 30.0, 70.0, 0.0, 60.0, 40.0, -5.0, 250.0, 20.0, 30.0, 5.0, 110.0, 30.0, 60.0, 40.0, 90.0, 60.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 20.0, 0.0, 20.0, 50.0, 50.0, 90.0, 40.0, 560.0, 70.0, 40.0, 50.0, 50.0, 10.0, 10.0, 5.0, 30.0, 10.0, 140.0, 10.0, 40.0, 90.0, 5.0, 60.0, 20.0, 40.0, 50.0, 100.0, 0.0, 60.0, 90.0, 70.0, 50.0, 30.0, -30.0, 0.0, 260.0, 40.0, 90.0, 0.0, 90.0, 20.0, 80.0, 20.0, 50.0, 110.0, 0.0, 80.0, 70.0, 30.0, 170.0, 30.0, 30.0, 0.0, 0.0, 40.0, 20.0, 50.0, 10.0, 160.0, 170.0, 20.0, 100.0, 20.0, 10.0, 270.0, 20.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 100.0, 110.0, 30.0, 10.0, 0.0, 10.0, 10.0, 70.0, 50.0, 260.0, 50.0, 20.0, 50.0, 20.0, 0.0, 10.0, 10.0, 70.0, 10.0, 50.0, 30.0, 30.0, 20.0, 30.0, 10.0, 60.0, 90.0, 40.0, 30.0, 20.0, 10.0, 130.0, 10.0, 30.0, 180.0, 30.0, 0.0, 90.0, 60.0, 160.0, 30.0, 70.0, 10.0, 60.0, 70.0, 70.0, 60.0, 70.0, 110.0, 30.0, 90.0, 20.0, 30.0, 0.0, 60.0, 30.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 40.0, 20.0, 40.0, 100.0, 70.0, 60.0, 20.0, 150.0, 30.0, 70.0, 70.0, 40.0, 110.0, 30.0, 40.0, 30.0, 20.0, 200.0, 60.0, 70.0, 150.0, 0.0, 0.0, 30.0, 70.0, 60.0, 90.0, 150.0, 40.0, 30.0, 10.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 10.0, 90.0, 10.0, 0.0, 40.0, 40.0, 70.0, 90.0, 50.0, 200.0, 100.0, 60.0, 100.0, 260.0, 90.0, 20.0, 50.0, 180.0, 30.0, 80.0, 70.0, 20.0, 70.0, 260.0, 110.0, 10.0, 40.0, 50.0, 60.0, 30.0, 80.0, 70.0, 30.0, 60.0, 100.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 0.0, 45.0, 0.0, 0.0, -20.0, 10.0, 80.0, 20.0, 50.0, 100.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 90.0, 220.0, 150.0, 0.0, 15.0, 180.0, 50.0, 10.0, 30.0, 40.0, 70.0, 80.0, 170.0, 20.0, 30.0, 10.0, 60.0, 20.0, 60.0, 70.0, 30.0, 30.0, 40.0, 20.0, 30.0, 120.0, 60.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 30.0, 70.0, 70.0, 40.0, 40.0, 50.0, 60.0, 70.0, 30.0, 40.0, 170.0, 10.0, 50.0, 40.0, 60.0, 20.0, 0.0, 80.0, 40.0, 0.0, 30.0, 60.0, 150.0, 210.0, 80.0, 10.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 40.0, 30.0, 50.0, 480.0, 30.0, 200.0, 10.0, 30.0, 30.0, 50.0, 50.0, 60.0, 0.0, 440.0, 40.0, 110.0, 40.0, 50.0, 30.0, 100.0, 30.0, 70.0, 80.0, 70.0, 30.0, 50.0, 40.0, 80.0, 660.0, 20.0, 30.0, 30.0, 0.0, 180.0, 100.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 20.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7094117662757116, "mean_inference_ms": 1.435374961629684, "mean_action_processing_ms": 0.4180014056557504, "mean_env_wait_ms": 1.3681981385972046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016068696975708008, "StateBufferConnector_ms": 0.011568069458007812, "ViewRequirementAgentConnector_ms": 0.43004393577575684}, "num_episodes": 18, "episode_return_max": 1010.0, "episode_return_min": 100.0, "episode_return_mean": 482.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.214827941637125, "num_env_steps_trained_throughput_per_sec": 19.214827941637125, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 207935.817, "restore_workers_time_ms": 0.013, "training_step_time_ms": 207935.768, "sample_time_ms": 2797.856, "learn_time_ms": 205116.428, "learn_throughput": 19.501, "synch_weights_time_ms": 11.739}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 21, "trial_id": "aa996_00000", "date": "2024-05-23_23-57-49", "timestamp": 1716523069, "time_this_iter_s": 208.18065524101257, "time_total_s": 4337.145913600922, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309bff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4337.145913600922, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.939322033898307, "ram_util_percent": 79.27559322033896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8812986745938451, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.641803494352883, "policy_loss": -0.010439050935319882, "vf_loss": 5.650611248767921, "vf_explained_var": 0.000694345253598068, "kl": 0.008156463098388134, "entropy": 1.093180051969644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 201885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 1010.0, "episode_reward_min": 100.0, "episode_reward_mean": 504.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 50.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [610.0, 340.0, 410.0, 525.0, 260.0, 320.0, 780.0, 400.0, 270.0, 240.0, 270.0, 530.0, 330.0, 740.0, 280.0, 420.0, 410.0, 530.0, 300.0, 730.0, 235.0, 745.0, 520.0, 710.0, 320.0, 100.0, 350.0, 365.0, 340.0, 665.0, 580.0, 350.0, 490.0, 720.0, 320.0, 260.0, 230.0, 310.0, 515.0, 200.0, 430.0, 520.0, 390.0, 605.0, 460.0, 500.0, 450.0, 850.0, 415.0, 415.0, 660.0, 520.0, 380.0, 840.0, 340.0, 530.0, 250.0, 430.0, 660.0, 610.0, 190.0, 550.0, 640.0, 680.0, 270.0, 690.0, 940.0, 730.0, 570.0, 285.0, 580.0, 665.0, 370.0, 680.0, 640.0, 330.0, 580.0, 330.0, 940.0, 990.0, 1010.0, 500.0, 850.0, 565.0, 440.0, 900.0, 510.0, 680.0, 360.0, 505.0, 400.0, 635.0, 270.0, 785.0, 195.0, 700.0, 490.0, 620.0, 710.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 20.0, 30.0, 0.0, 0.0, 180.0, 30.0, 160.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 40.0, 190.0, 10.0, 10.0, 10.0, 70.0, 30.0, 120.0, 80.0, 10.0, 10.0, 30.0, 50.0, 0.0, 180.0, 35.0, 90.0, 60.0, 80.0, 30.0, 60.0, -20.0, -30.0, 40.0, 30.0, 50.0, 50.0, 0.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 10.0, 10.0, 0.0, 20.0, 40.0, 40.0, 160.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 520.0, 20.0, 40.0, 50.0, 160.0, 10.0, 30.0, 0.0, 10.0, 50.0, 20.0, 20.0, 40.0, 60.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 20.0, 170.0, 10.0, 20.0, 60.0, 0.0, 30.0, 0.0, 20.0, 60.0, 10.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 50.0, 120.0, 70.0, 40.0, 40.0, 20.0, 50.0, 190.0, 70.0, 10.0, 20.0, 20.0, 20.0, 180.0, 10.0, 40.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 50.0, 30.0, 0.0, 680.0, -20.0, 0.0, 10.0, 20.0, 70.0, 30.0, 20.0, 50.0, 20.0, 60.0, 0.0, 10.0, 50.0, 30.0, 30.0, 30.0, 20.0, 110.0, 40.0, 80.0, 20.0, 40.0, 10.0, 50.0, 40.0, 40.0, 40.0, 40.0, 100.0, 10.0, 40.0, 40.0, 10.0, 40.0, -90.0, 160.0, 60.0, 60.0, 180.0, 10.0, 60.0, 0.0, -40.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 0.0, 170.0, 50.0, 40.0, 70.0, 180.0, 100.0, 170.0, 40.0, 30.0, 10.0, 40.0, 60.0, 10.0, -10.0, 30.0, 20.0, 70.0, 20.0, 0.0, 10.0, 25.0, 40.0, 40.0, 310.0, 35.0, 110.0, 50.0, 30.0, 0.0, 90.0, 40.0, 0.0, 50.0, 0.0, 50.0, 20.0, -40.0, 80.0, 240.0, 70.0, 50.0, 0.0, 0.0, 70.0, 80.0, 150.0, 20.0, 40.0, 180.0, 0.0, 170.0, 10.0, 60.0, 30.0, 30.0, 30.0, 50.0, 40.0, 0.0, 70.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, -110.0, 40.0, 180.0, 20.0, 50.0, 90.0, 20.0, 40.0, 10.0, 10.0, 0.0, 110.0, -5.0, 70.0, 50.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 40.0, 40.0, 90.0, 20.0, 30.0, 0.0, 50.0, 0.0, 40.0, 20.0, 310.0, -15.0, 20.0, 30.0, 80.0, 20.0, 30.0, 70.0, 100.0, 70.0, 60.0, 20.0, 100.0, 160.0, 40.0, 20.0, 30.0, 40.0, 40.0, 30.0, 10.0, 0.0, 60.0, 90.0, 40.0, 30.0, 10.0, 50.0, 30.0, 70.0, 60.0, 10.0, 50.0, 30.0, 10.0, 40.0, 20.0, 30.0, 170.0, 60.0, 30.0, 110.0, 80.0, 180.0, 60.0, 80.0, 20.0, 60.0, 40.0, 90.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 40.0, 50.0, 10.0, 30.0, 0.0, 10.0, 10.0, -40.0, 190.0, 70.0, 30.0, 0.0, 30.0, 130.0, 20.0, 50.0, 25.0, 0.0, 0.0, 40.0, 180.0, 40.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, 50.0, 40.0, 20.0, 70.0, 20.0, 40.0, 40.0, 60.0, 80.0, 10.0, 40.0, 40.0, 0.0, 160.0, 30.0, 180.0, 20.0, 30.0, 10.0, 10.0, 30.0, 40.0, 60.0, 50.0, 30.0, 50.0, 50.0, 70.0, 10.0, 0.0, 180.0, 20.0, 50.0, -5.0, 50.0, 50.0, 80.0, 30.0, 60.0, 90.0, 40.0, 60.0, 30.0, 10.0, 10.0, 100.0, 60.0, 60.0, 30.0, 60.0, 30.0, 70.0, 0.0, 60.0, 40.0, -5.0, 250.0, 20.0, 30.0, 5.0, 110.0, 30.0, 60.0, 40.0, 90.0, 60.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 20.0, 0.0, 20.0, 50.0, 50.0, 90.0, 40.0, 560.0, 70.0, 40.0, 50.0, 50.0, 10.0, 10.0, 5.0, 30.0, 10.0, 140.0, 10.0, 40.0, 90.0, 5.0, 60.0, 20.0, 40.0, 50.0, 100.0, 0.0, 60.0, 90.0, 70.0, 50.0, 30.0, -30.0, 0.0, 260.0, 40.0, 90.0, 0.0, 90.0, 20.0, 80.0, 20.0, 50.0, 110.0, 0.0, 80.0, 70.0, 30.0, 170.0, 30.0, 30.0, 0.0, 0.0, 40.0, 20.0, 50.0, 10.0, 160.0, 170.0, 20.0, 100.0, 20.0, 10.0, 270.0, 20.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 100.0, 110.0, 30.0, 10.0, 0.0, 10.0, 10.0, 70.0, 50.0, 260.0, 50.0, 20.0, 50.0, 20.0, 0.0, 10.0, 10.0, 70.0, 10.0, 50.0, 30.0, 30.0, 20.0, 30.0, 10.0, 60.0, 90.0, 40.0, 30.0, 20.0, 10.0, 130.0, 10.0, 30.0, 180.0, 30.0, 0.0, 90.0, 60.0, 160.0, 30.0, 70.0, 10.0, 60.0, 70.0, 70.0, 60.0, 70.0, 110.0, 30.0, 90.0, 20.0, 30.0, 0.0, 60.0, 30.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 40.0, 20.0, 40.0, 100.0, 70.0, 60.0, 20.0, 150.0, 30.0, 70.0, 70.0, 40.0, 110.0, 30.0, 40.0, 30.0, 20.0, 200.0, 60.0, 70.0, 150.0, 0.0, 0.0, 30.0, 70.0, 60.0, 90.0, 150.0, 40.0, 30.0, 10.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 10.0, 90.0, 10.0, 0.0, 40.0, 40.0, 70.0, 90.0, 50.0, 200.0, 100.0, 60.0, 100.0, 260.0, 90.0, 20.0, 50.0, 180.0, 30.0, 80.0, 70.0, 20.0, 70.0, 260.0, 110.0, 10.0, 40.0, 50.0, 60.0, 30.0, 80.0, 70.0, 30.0, 60.0, 100.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 0.0, 45.0, 0.0, 0.0, -20.0, 10.0, 80.0, 20.0, 50.0, 100.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 90.0, 220.0, 150.0, 0.0, 15.0, 180.0, 50.0, 10.0, 30.0, 40.0, 70.0, 80.0, 170.0, 20.0, 30.0, 10.0, 60.0, 20.0, 60.0, 70.0, 30.0, 30.0, 40.0, 20.0, 30.0, 120.0, 60.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 30.0, 70.0, 70.0, 40.0, 40.0, 50.0, 60.0, 70.0, 30.0, 40.0, 170.0, 10.0, 50.0, 40.0, 60.0, 20.0, 0.0, 80.0, 40.0, 0.0, 30.0, 60.0, 150.0, 210.0, 80.0, 10.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 40.0, 30.0, 50.0, 480.0, 30.0, 200.0, 10.0, 30.0, 30.0, 50.0, 50.0, 60.0, 0.0, 440.0, 40.0, 110.0, 40.0, 50.0, 30.0, 100.0, 30.0, 70.0, 80.0, 70.0, 30.0, 50.0, 40.0, 80.0, 660.0, 20.0, 30.0, 30.0, 0.0, 180.0, 100.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 20.0, 90.0, 90.0, 60.0, -40.0, 80.0, 0.0, 270.0, 60.0, 270.0, 20.0, 40.0, 20.0, 200.0, 40.0, 40.0, 5.0, 0.0, 40.0, 20.0, 90.0, 110.0, 150.0, 0.0, 10.0, 65.0, -15.0, 0.0, 10.0, 40.0, 30.0, 150.0, 10.0, 360.0, 40.0, 40.0, 120.0, 20.0, 30.0, 70.0, 60.0, 150.0, 20.0, 0.0, 20.0, 30.0, 50.0, 60.0, 50.0, 190.0, 30.0, 60.0, 50.0, 80.0, 30.0, -5.0, 160.0, 50.0, 100.0, 60.0, -15.0, 170.0, 0.0, 110.0, 20.0, 80.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 70.0, 0.0, 20.0, 110.0, -5.0, 120.0, 30.0, 50.0, 80.0, 30.0, 40.0, -50.0, -30.0, 0.0, 20.0, 360.0, 0.0, 10.0, 20.0, 20.0, 10.0, 290.0, 10.0, 190.0, 10.0, 35.0, 30.0, 20.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 0.0, 30.0, 40.0, 50.0, 50.0, 40.0, 20.0, -50.0, 0.0, 280.0, -5.0, 0.0, 40.0, 190.0, 270.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 15.0, 20.0, 40.0, 20.0, 30.0, 20.0, 0.0, 0.0, 160.0, 200.0, 160.0, 70.0, 40.0, 10.0, 40.0, 60.0, 0.0, 70.0, 90.0, 20.0, 30.0, 60.0, 110.0, 50.0, -80.0, 90.0, 70.0, 150.0, 70.0, 170.0, 20.0, 30.0, 50.0, 30.0, 140.0, 40.0, 180.0, 190.0, 30.0, 50.0, 20.0, 0.0, 30.0, 20.0, 160.0, 25.0, 70.0, 25.0, 0.0, 40.0, 20.0, 10.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7066683164560994, "mean_inference_ms": 1.4382168448161594, "mean_action_processing_ms": 0.417823724293762, "mean_env_wait_ms": 1.3672887956801358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015926361083984375, "StateBufferConnector_ms": 0.011602401733398438, "ViewRequirementAgentConnector_ms": 0.43034934997558594}, "num_episodes": 18, "episode_return_max": 1010.0, "episode_return_min": 100.0, "episode_return_mean": 504.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.21007582194994, "num_env_steps_trained_throughput_per_sec": 19.21007582194994, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 208185.589, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208185.54, "sample_time_ms": 2804.171, "learn_time_ms": 205359.83, "learn_throughput": 19.478, "synch_weights_time_ms": 11.572}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 22, "trial_id": "aa996_00000", "date": "2024-05-24_00-01-17", "timestamp": 1716523277, "time_this_iter_s": 208.2305610179901, "time_total_s": 4545.376474618912, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309e6670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4545.376474618912, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.056462585034016, "ram_util_percent": 78.85170068027212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.106390695469067, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.034218992694371, "policy_loss": -0.01032484033052275, "vf_loss": 6.043159004674552, "vf_explained_var": 0.005034396620477223, "kl": 0.006924161286649354, "entropy": 1.0843647844240434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 211275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 1030.0, "episode_reward_min": 100.0, "episode_reward_mean": 530.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 53.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 730.0, 235.0, 745.0, 520.0, 710.0, 320.0, 100.0, 350.0, 365.0, 340.0, 665.0, 580.0, 350.0, 490.0, 720.0, 320.0, 260.0, 230.0, 310.0, 515.0, 200.0, 430.0, 520.0, 390.0, 605.0, 460.0, 500.0, 450.0, 850.0, 415.0, 415.0, 660.0, 520.0, 380.0, 840.0, 340.0, 530.0, 250.0, 430.0, 660.0, 610.0, 190.0, 550.0, 640.0, 680.0, 270.0, 690.0, 940.0, 730.0, 570.0, 285.0, 580.0, 665.0, 370.0, 680.0, 640.0, 330.0, 580.0, 330.0, 940.0, 990.0, 1010.0, 500.0, 850.0, 565.0, 440.0, 900.0, 510.0, 680.0, 360.0, 505.0, 400.0, 635.0, 270.0, 785.0, 195.0, 700.0, 490.0, 620.0, 710.0, 420.0, 430.0, 780.0, 1030.0, 895.0, 450.0, 375.0, 735.0, 990.0, 250.0, 360.0, 450.0, 350.0, 590.0, 380.0, 605.0, 360.0, 830.0, 350.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -40.0, 30.0, 40.0, 30.0, 0.0, 30.0, 40.0, 0.0, 170.0, 50.0, 40.0, 70.0, 180.0, 100.0, 170.0, 40.0, 30.0, 10.0, 40.0, 60.0, 10.0, -10.0, 30.0, 20.0, 70.0, 20.0, 0.0, 10.0, 25.0, 40.0, 40.0, 310.0, 35.0, 110.0, 50.0, 30.0, 0.0, 90.0, 40.0, 0.0, 50.0, 0.0, 50.0, 20.0, -40.0, 80.0, 240.0, 70.0, 50.0, 0.0, 0.0, 70.0, 80.0, 150.0, 20.0, 40.0, 180.0, 0.0, 170.0, 10.0, 60.0, 30.0, 30.0, 30.0, 50.0, 40.0, 0.0, 70.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, -110.0, 40.0, 180.0, 20.0, 50.0, 90.0, 20.0, 40.0, 10.0, 10.0, 0.0, 110.0, -5.0, 70.0, 50.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 40.0, 40.0, 90.0, 20.0, 30.0, 0.0, 50.0, 0.0, 40.0, 20.0, 310.0, -15.0, 20.0, 30.0, 80.0, 20.0, 30.0, 70.0, 100.0, 70.0, 60.0, 20.0, 100.0, 160.0, 40.0, 20.0, 30.0, 40.0, 40.0, 30.0, 10.0, 0.0, 60.0, 90.0, 40.0, 30.0, 10.0, 50.0, 30.0, 70.0, 60.0, 10.0, 50.0, 30.0, 10.0, 40.0, 20.0, 30.0, 170.0, 60.0, 30.0, 110.0, 80.0, 180.0, 60.0, 80.0, 20.0, 60.0, 40.0, 90.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 40.0, 50.0, 10.0, 30.0, 0.0, 10.0, 10.0, -40.0, 190.0, 70.0, 30.0, 0.0, 30.0, 130.0, 20.0, 50.0, 25.0, 0.0, 0.0, 40.0, 180.0, 40.0, 30.0, 50.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 30.0, 30.0, 50.0, 40.0, 20.0, 70.0, 20.0, 40.0, 40.0, 60.0, 80.0, 10.0, 40.0, 40.0, 0.0, 160.0, 30.0, 180.0, 20.0, 30.0, 10.0, 10.0, 30.0, 40.0, 60.0, 50.0, 30.0, 50.0, 50.0, 70.0, 10.0, 0.0, 180.0, 20.0, 50.0, -5.0, 50.0, 50.0, 80.0, 30.0, 60.0, 90.0, 40.0, 60.0, 30.0, 10.0, 10.0, 100.0, 60.0, 60.0, 30.0, 60.0, 30.0, 70.0, 0.0, 60.0, 40.0, -5.0, 250.0, 20.0, 30.0, 5.0, 110.0, 30.0, 60.0, 40.0, 90.0, 60.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 20.0, 0.0, 20.0, 50.0, 50.0, 90.0, 40.0, 560.0, 70.0, 40.0, 50.0, 50.0, 10.0, 10.0, 5.0, 30.0, 10.0, 140.0, 10.0, 40.0, 90.0, 5.0, 60.0, 20.0, 40.0, 50.0, 100.0, 0.0, 60.0, 90.0, 70.0, 50.0, 30.0, -30.0, 0.0, 260.0, 40.0, 90.0, 0.0, 90.0, 20.0, 80.0, 20.0, 50.0, 110.0, 0.0, 80.0, 70.0, 30.0, 170.0, 30.0, 30.0, 0.0, 0.0, 40.0, 20.0, 50.0, 10.0, 160.0, 170.0, 20.0, 100.0, 20.0, 10.0, 270.0, 20.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 100.0, 110.0, 30.0, 10.0, 0.0, 10.0, 10.0, 70.0, 50.0, 260.0, 50.0, 20.0, 50.0, 20.0, 0.0, 10.0, 10.0, 70.0, 10.0, 50.0, 30.0, 30.0, 20.0, 30.0, 10.0, 60.0, 90.0, 40.0, 30.0, 20.0, 10.0, 130.0, 10.0, 30.0, 180.0, 30.0, 0.0, 90.0, 60.0, 160.0, 30.0, 70.0, 10.0, 60.0, 70.0, 70.0, 60.0, 70.0, 110.0, 30.0, 90.0, 20.0, 30.0, 0.0, 60.0, 30.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 40.0, 20.0, 40.0, 100.0, 70.0, 60.0, 20.0, 150.0, 30.0, 70.0, 70.0, 40.0, 110.0, 30.0, 40.0, 30.0, 20.0, 200.0, 60.0, 70.0, 150.0, 0.0, 0.0, 30.0, 70.0, 60.0, 90.0, 150.0, 40.0, 30.0, 10.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 10.0, 90.0, 10.0, 0.0, 40.0, 40.0, 70.0, 90.0, 50.0, 200.0, 100.0, 60.0, 100.0, 260.0, 90.0, 20.0, 50.0, 180.0, 30.0, 80.0, 70.0, 20.0, 70.0, 260.0, 110.0, 10.0, 40.0, 50.0, 60.0, 30.0, 80.0, 70.0, 30.0, 60.0, 100.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 0.0, 45.0, 0.0, 0.0, -20.0, 10.0, 80.0, 20.0, 50.0, 100.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 90.0, 220.0, 150.0, 0.0, 15.0, 180.0, 50.0, 10.0, 30.0, 40.0, 70.0, 80.0, 170.0, 20.0, 30.0, 10.0, 60.0, 20.0, 60.0, 70.0, 30.0, 30.0, 40.0, 20.0, 30.0, 120.0, 60.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 30.0, 70.0, 70.0, 40.0, 40.0, 50.0, 60.0, 70.0, 30.0, 40.0, 170.0, 10.0, 50.0, 40.0, 60.0, 20.0, 0.0, 80.0, 40.0, 0.0, 30.0, 60.0, 150.0, 210.0, 80.0, 10.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 40.0, 30.0, 50.0, 480.0, 30.0, 200.0, 10.0, 30.0, 30.0, 50.0, 50.0, 60.0, 0.0, 440.0, 40.0, 110.0, 40.0, 50.0, 30.0, 100.0, 30.0, 70.0, 80.0, 70.0, 30.0, 50.0, 40.0, 80.0, 660.0, 20.0, 30.0, 30.0, 0.0, 180.0, 100.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 20.0, 90.0, 90.0, 60.0, -40.0, 80.0, 0.0, 270.0, 60.0, 270.0, 20.0, 40.0, 20.0, 200.0, 40.0, 40.0, 5.0, 0.0, 40.0, 20.0, 90.0, 110.0, 150.0, 0.0, 10.0, 65.0, -15.0, 0.0, 10.0, 40.0, 30.0, 150.0, 10.0, 360.0, 40.0, 40.0, 120.0, 20.0, 30.0, 70.0, 60.0, 150.0, 20.0, 0.0, 20.0, 30.0, 50.0, 60.0, 50.0, 190.0, 30.0, 60.0, 50.0, 80.0, 30.0, -5.0, 160.0, 50.0, 100.0, 60.0, -15.0, 170.0, 0.0, 110.0, 20.0, 80.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 70.0, 0.0, 20.0, 110.0, -5.0, 120.0, 30.0, 50.0, 80.0, 30.0, 40.0, -50.0, -30.0, 0.0, 20.0, 360.0, 0.0, 10.0, 20.0, 20.0, 10.0, 290.0, 10.0, 190.0, 10.0, 35.0, 30.0, 20.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 0.0, 30.0, 40.0, 50.0, 50.0, 40.0, 20.0, -50.0, 0.0, 280.0, -5.0, 0.0, 40.0, 190.0, 270.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 15.0, 20.0, 40.0, 20.0, 30.0, 20.0, 0.0, 0.0, 160.0, 200.0, 160.0, 70.0, 40.0, 10.0, 40.0, 60.0, 0.0, 70.0, 90.0, 20.0, 30.0, 60.0, 110.0, 50.0, -80.0, 90.0, 70.0, 150.0, 70.0, 170.0, 20.0, 30.0, 50.0, 30.0, 140.0, 40.0, 180.0, 190.0, 30.0, 50.0, 20.0, 0.0, 30.0, 20.0, 160.0, 25.0, 70.0, 25.0, 0.0, 40.0, 20.0, 10.0, 50.0, 0.0, 0.0, 40.0, 50.0, 0.0, 10.0, 70.0, 50.0, 180.0, 30.0, 10.0, 20.0, 60.0, 20.0, 70.0, 280.0, -40.0, 10.0, 90.0, 260.0, 40.0, 40.0, 170.0, 410.0, 30.0, 100.0, 80.0, 60.0, 20.0, 80.0, 250.0, 30.0, 90.0, -30.0, 170.0, 10.0, 15.0, 150.0, 60.0, 150.0, 30.0, 40.0, 10.0, 60.0, 160.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 30.0, 15.0, 10.0, 160.0, 30.0, 10.0, 30.0, 30.0, 40.0, 10.0, 80.0, 180.0, 60.0, 0.0, 80.0, 20.0, 330.0, 0.0, -25.0, 40.0, 70.0, 90.0, 80.0, 130.0, 50.0, 30.0, 80.0, 60.0, 360.0, 30.0, 60.0, 110.0, 20.0, 10.0, 50.0, 20.0, 180.0, -240.0, 10.0, 60.0, 150.0, 20.0, 50.0, 20.0, -40.0, 30.0, 40.0, 20.0, 10.0, 40.0, 100.0, 20.0, 90.0, 30.0, 70.0, -5.0, 60.0, 15.0, 30.0, 0.0, 10.0, 30.0, 30.0, 60.0, 40.0, 80.0, 40.0, 30.0, 30.0, 20.0, 110.0, 70.0, 20.0, 40.0, 40.0, 60.0, 30.0, 180.0, 20.0, 150.0, 10.0, 40.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 245.0, 0.0, 80.0, 50.0, 80.0, 70.0, 10.0, 30.0, 50.0, 150.0, -90.0, 10.0, 0.0, 90.0, 60.0, 60.0, 30.0, 0.0, 60.0, 120.0, 250.0, 0.0, 40.0, 10.0, 100.0, 170.0, 60.0, 20.0, 90.0, 30.0, 40.0, 0.0, 20.0, 80.0, 10.0, 70.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7035739242734584, "mean_inference_ms": 1.4419681055097577, "mean_action_processing_ms": 0.4177196131558793, "mean_env_wait_ms": 1.3667274836158418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015657901763916016, "StateBufferConnector_ms": 0.011735677719116211, "ViewRequirementAgentConnector_ms": 0.4216909408569336}, "num_episodes": 18, "episode_return_max": 1030.0, "episode_return_min": 100.0, "episode_return_mean": 530.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.154231868112525, "num_env_steps_trained_throughput_per_sec": 19.154231868112525, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 208445.465, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208445.412, "sample_time_ms": 2768.423, "learn_time_ms": 205655.596, "learn_throughput": 19.45, "synch_weights_time_ms": 11.306}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 23, "trial_id": "aa996_00000", "date": "2024-05-24_00-04-46", "timestamp": 1716523486, "time_this_iter_s": 208.83966302871704, "time_total_s": 4754.216137647629, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x330984820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4754.216137647629, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.19662162162162, "ram_util_percent": 79.45135135135135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4105689176164877, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.299529393158528, "policy_loss": -0.011807428520317641, "vf_loss": 6.309613511204339, "vf_explained_var": 0.0008980425148091504, "kl": 0.008616549977161452, "entropy": 1.057988443161352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 220665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 1150.0, "episode_reward_min": 190.0, "episode_reward_mean": 590.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 59.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 450.0, 850.0, 415.0, 415.0, 660.0, 520.0, 380.0, 840.0, 340.0, 530.0, 250.0, 430.0, 660.0, 610.0, 190.0, 550.0, 640.0, 680.0, 270.0, 690.0, 940.0, 730.0, 570.0, 285.0, 580.0, 665.0, 370.0, 680.0, 640.0, 330.0, 580.0, 330.0, 940.0, 990.0, 1010.0, 500.0, 850.0, 565.0, 440.0, 900.0, 510.0, 680.0, 360.0, 505.0, 400.0, 635.0, 270.0, 785.0, 195.0, 700.0, 490.0, 620.0, 710.0, 420.0, 430.0, 780.0, 1030.0, 895.0, 450.0, 375.0, 735.0, 990.0, 250.0, 360.0, 450.0, 350.0, 590.0, 380.0, 605.0, 360.0, 830.0, 350.0, 895.0, 1150.0, 920.0, 900.0, 400.0, 440.0, 390.0, 500.0, 500.0, 490.0, 670.0, 720.0, 1050.0, 530.0, 870.0, 650.0, 790.0, 525.0, 565.0, 675.0, 660.0, 620.0, 655.0, 720.0, 245.0, 985.0, 280.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 70.0, 0.0, 60.0, 40.0, -5.0, 250.0, 20.0, 30.0, 5.0, 110.0, 30.0, 60.0, 40.0, 90.0, 60.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 20.0, 0.0, 20.0, 50.0, 50.0, 90.0, 40.0, 560.0, 70.0, 40.0, 50.0, 50.0, 10.0, 10.0, 5.0, 30.0, 10.0, 140.0, 10.0, 40.0, 90.0, 5.0, 60.0, 20.0, 40.0, 50.0, 100.0, 0.0, 60.0, 90.0, 70.0, 50.0, 30.0, -30.0, 0.0, 260.0, 40.0, 90.0, 0.0, 90.0, 20.0, 80.0, 20.0, 50.0, 110.0, 0.0, 80.0, 70.0, 30.0, 170.0, 30.0, 30.0, 0.0, 0.0, 40.0, 20.0, 50.0, 10.0, 160.0, 170.0, 20.0, 100.0, 20.0, 10.0, 270.0, 20.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 100.0, 110.0, 30.0, 10.0, 0.0, 10.0, 10.0, 70.0, 50.0, 260.0, 50.0, 20.0, 50.0, 20.0, 0.0, 10.0, 10.0, 70.0, 10.0, 50.0, 30.0, 30.0, 20.0, 30.0, 10.0, 60.0, 90.0, 40.0, 30.0, 20.0, 10.0, 130.0, 10.0, 30.0, 180.0, 30.0, 0.0, 90.0, 60.0, 160.0, 30.0, 70.0, 10.0, 60.0, 70.0, 70.0, 60.0, 70.0, 110.0, 30.0, 90.0, 20.0, 30.0, 0.0, 60.0, 30.0, 20.0, 20.0, 20.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 40.0, 20.0, 40.0, 100.0, 70.0, 60.0, 20.0, 150.0, 30.0, 70.0, 70.0, 40.0, 110.0, 30.0, 40.0, 30.0, 20.0, 200.0, 60.0, 70.0, 150.0, 0.0, 0.0, 30.0, 70.0, 60.0, 90.0, 150.0, 40.0, 30.0, 10.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 10.0, 90.0, 10.0, 0.0, 40.0, 40.0, 70.0, 90.0, 50.0, 200.0, 100.0, 60.0, 100.0, 260.0, 90.0, 20.0, 50.0, 180.0, 30.0, 80.0, 70.0, 20.0, 70.0, 260.0, 110.0, 10.0, 40.0, 50.0, 60.0, 30.0, 80.0, 70.0, 30.0, 60.0, 100.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 0.0, 45.0, 0.0, 0.0, -20.0, 10.0, 80.0, 20.0, 50.0, 100.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 90.0, 220.0, 150.0, 0.0, 15.0, 180.0, 50.0, 10.0, 30.0, 40.0, 70.0, 80.0, 170.0, 20.0, 30.0, 10.0, 60.0, 20.0, 60.0, 70.0, 30.0, 30.0, 40.0, 20.0, 30.0, 120.0, 60.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 30.0, 70.0, 70.0, 40.0, 40.0, 50.0, 60.0, 70.0, 30.0, 40.0, 170.0, 10.0, 50.0, 40.0, 60.0, 20.0, 0.0, 80.0, 40.0, 0.0, 30.0, 60.0, 150.0, 210.0, 80.0, 10.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 40.0, 30.0, 50.0, 480.0, 30.0, 200.0, 10.0, 30.0, 30.0, 50.0, 50.0, 60.0, 0.0, 440.0, 40.0, 110.0, 40.0, 50.0, 30.0, 100.0, 30.0, 70.0, 80.0, 70.0, 30.0, 50.0, 40.0, 80.0, 660.0, 20.0, 30.0, 30.0, 0.0, 180.0, 100.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 20.0, 90.0, 90.0, 60.0, -40.0, 80.0, 0.0, 270.0, 60.0, 270.0, 20.0, 40.0, 20.0, 200.0, 40.0, 40.0, 5.0, 0.0, 40.0, 20.0, 90.0, 110.0, 150.0, 0.0, 10.0, 65.0, -15.0, 0.0, 10.0, 40.0, 30.0, 150.0, 10.0, 360.0, 40.0, 40.0, 120.0, 20.0, 30.0, 70.0, 60.0, 150.0, 20.0, 0.0, 20.0, 30.0, 50.0, 60.0, 50.0, 190.0, 30.0, 60.0, 50.0, 80.0, 30.0, -5.0, 160.0, 50.0, 100.0, 60.0, -15.0, 170.0, 0.0, 110.0, 20.0, 80.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 70.0, 0.0, 20.0, 110.0, -5.0, 120.0, 30.0, 50.0, 80.0, 30.0, 40.0, -50.0, -30.0, 0.0, 20.0, 360.0, 0.0, 10.0, 20.0, 20.0, 10.0, 290.0, 10.0, 190.0, 10.0, 35.0, 30.0, 20.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 0.0, 30.0, 40.0, 50.0, 50.0, 40.0, 20.0, -50.0, 0.0, 280.0, -5.0, 0.0, 40.0, 190.0, 270.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 15.0, 20.0, 40.0, 20.0, 30.0, 20.0, 0.0, 0.0, 160.0, 200.0, 160.0, 70.0, 40.0, 10.0, 40.0, 60.0, 0.0, 70.0, 90.0, 20.0, 30.0, 60.0, 110.0, 50.0, -80.0, 90.0, 70.0, 150.0, 70.0, 170.0, 20.0, 30.0, 50.0, 30.0, 140.0, 40.0, 180.0, 190.0, 30.0, 50.0, 20.0, 0.0, 30.0, 20.0, 160.0, 25.0, 70.0, 25.0, 0.0, 40.0, 20.0, 10.0, 50.0, 0.0, 0.0, 40.0, 50.0, 0.0, 10.0, 70.0, 50.0, 180.0, 30.0, 10.0, 20.0, 60.0, 20.0, 70.0, 280.0, -40.0, 10.0, 90.0, 260.0, 40.0, 40.0, 170.0, 410.0, 30.0, 100.0, 80.0, 60.0, 20.0, 80.0, 250.0, 30.0, 90.0, -30.0, 170.0, 10.0, 15.0, 150.0, 60.0, 150.0, 30.0, 40.0, 10.0, 60.0, 160.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 30.0, 15.0, 10.0, 160.0, 30.0, 10.0, 30.0, 30.0, 40.0, 10.0, 80.0, 180.0, 60.0, 0.0, 80.0, 20.0, 330.0, 0.0, -25.0, 40.0, 70.0, 90.0, 80.0, 130.0, 50.0, 30.0, 80.0, 60.0, 360.0, 30.0, 60.0, 110.0, 20.0, 10.0, 50.0, 20.0, 180.0, -240.0, 10.0, 60.0, 150.0, 20.0, 50.0, 20.0, -40.0, 30.0, 40.0, 20.0, 10.0, 40.0, 100.0, 20.0, 90.0, 30.0, 70.0, -5.0, 60.0, 15.0, 30.0, 0.0, 10.0, 30.0, 30.0, 60.0, 40.0, 80.0, 40.0, 30.0, 30.0, 20.0, 110.0, 70.0, 20.0, 40.0, 40.0, 60.0, 30.0, 180.0, 20.0, 150.0, 10.0, 40.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 245.0, 0.0, 80.0, 50.0, 80.0, 70.0, 10.0, 30.0, 50.0, 150.0, -90.0, 10.0, 0.0, 90.0, 60.0, 60.0, 30.0, 0.0, 60.0, 120.0, 250.0, 0.0, 40.0, 10.0, 100.0, 170.0, 60.0, 20.0, 90.0, 30.0, 40.0, 0.0, 20.0, 80.0, 10.0, 70.0, 10.0, 0.0, -5.0, 170.0, 400.0, 0.0, 20.0, 50.0, 180.0, 30.0, 10.0, 40.0, -30.0, 40.0, 100.0, 30.0, 70.0, 480.0, 100.0, 80.0, 210.0, 70.0, 100.0, 400.0, 110.0, 40.0, 80.0, -130.0, 50.0, 80.0, 40.0, 150.0, 110.0, 10.0, 260.0, 0.0, 40.0, 40.0, 140.0, 80.0, 30.0, 190.0, 10.0, -10.0, 10.0, 0.0, 270.0, 70.0, -30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 120.0, 0.0, 0.0, 10.0, 200.0, 60.0, 30.0, -20.0, 90.0, 20.0, -10.0, 30.0, 70.0, 40.0, 20.0, 130.0, 10.0, -10.0, 10.0, 60.0, 60.0, 10.0, 90.0, 30.0, 0.0, 110.0, 40.0, 90.0, 0.0, 80.0, 180.0, 0.0, 10.0, 100.0, 20.0, 20.0, 10.0, 80.0, 40.0, 30.0, 50.0, 190.0, -20.0, 60.0, 70.0, 50.0, 10.0, 10.0, 0.0, -40.0, 10.0, 0.0, 20.0, 50.0, 40.0, 70.0, 160.0, 360.0, 80.0, 70.0, 60.0, 20.0, 60.0, 240.0, 5.0, 130.0, 25.0, 30.0, 90.0, 60.0, 180.0, 130.0, 50.0, 250.0, 140.0, 40.0, 20.0, 90.0, 0.0, 10.0, 20.0, 100.0, 180.0, 80.0, 15.0, 80.0, 20.0, 25.0, 100.0, 40.0, 390.0, -10.0, 70.0, 50.0, 80.0, 90.0, 80.0, -20.0, 30.0, 0.0, 170.0, 90.0, 20.0, 100.0, 180.0, 60.0, 0.0, 0.0, 20.0, 70.0, 30.0, 260.0, 160.0, 30.0, 160.0, 10.0, 30.0, 20.0, 60.0, 60.0, 40.0, 20.0, 90.0, 25.0, 50.0, 160.0, 0.0, 20.0, 110.0, 30.0, 380.0, 30.0, 25.0, -40.0, 10.0, 0.0, -30.0, 50.0, 40.0, -15.0, 90.0, 90.0, 170.0, 30.0, 20.0, 30.0, 60.0, 160.0, 80.0, 40.0, 20.0, 60.0, 30.0, 180.0, 0.0, 50.0, 160.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 40.0, 20.0, 90.0, 220.0, 160.0, 170.0, -70.0, 260.0, -10.0, 50.0, 60.0, 60.0, -55.0, 30.0, 150.0, -130.0, 390.0, 10.0, 10.0, 10.0, 30.0, 30.0, 160.0, 60.0, 60.0, 20.0, 5.0, 70.0, 10.0, 0.0, -10.0, 30.0, 50.0, 10.0, 150.0, 85.0, 10.0, 160.0, 100.0, 60.0, 170.0, 60.0, 150.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 5.0, 0.0, 5.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7024338465375386, "mean_inference_ms": 1.4461750221085248, "mean_action_processing_ms": 0.4182047925227516, "mean_env_wait_ms": 1.3680282168438995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01595473289489746, "StateBufferConnector_ms": 0.010750055313110352, "ViewRequirementAgentConnector_ms": 0.4257497787475586}, "num_episodes": 27, "episode_return_max": 1150.0, "episode_return_min": 190.0, "episode_return_mean": 590.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.972230993529077, "num_env_steps_trained_throughput_per_sec": 18.972230993529077, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 208899.909, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208899.856, "sample_time_ms": 2767.521, "learn_time_ms": 206111.413, "learn_throughput": 19.407, "synch_weights_time_ms": 11.538}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 24, "trial_id": "aa996_00000", "date": "2024-05-24_00-08-17", "timestamp": 1716523697, "time_this_iter_s": 210.85704803466797, "time_total_s": 4965.073185682297, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ffee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4965.073185682297, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 21.394630872483223, "ram_util_percent": 79.8748322147651}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1520212397725182, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.313508582292908, "policy_loss": -0.010725991866755656, "vf_loss": 6.322690222794002, "vf_explained_var": 0.0010675742984198914, "kl": 0.007721783400145672, "entropy": 1.0376052863173846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 230055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 1200.0, "episode_reward_min": 185.0, "episode_reward_mean": 613.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 61.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [680.0, 270.0, 690.0, 940.0, 730.0, 570.0, 285.0, 580.0, 665.0, 370.0, 680.0, 640.0, 330.0, 580.0, 330.0, 940.0, 990.0, 1010.0, 500.0, 850.0, 565.0, 440.0, 900.0, 510.0, 680.0, 360.0, 505.0, 400.0, 635.0, 270.0, 785.0, 195.0, 700.0, 490.0, 620.0, 710.0, 420.0, 430.0, 780.0, 1030.0, 895.0, 450.0, 375.0, 735.0, 990.0, 250.0, 360.0, 450.0, 350.0, 590.0, 380.0, 605.0, 360.0, 830.0, 350.0, 895.0, 1150.0, 920.0, 900.0, 400.0, 440.0, 390.0, 500.0, 500.0, 490.0, 670.0, 720.0, 1050.0, 530.0, 870.0, 650.0, 790.0, 525.0, 565.0, 675.0, 660.0, 620.0, 655.0, 720.0, 245.0, 985.0, 280.0, 570.0, 920.0, 395.0, 900.0, 400.0, 1200.0, 620.0, 380.0, 685.0, 930.0, 295.0, 980.0, 445.0, 225.0, 185.0, 540.0, 790.0, 1060.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 70.0, 150.0, 0.0, 0.0, 30.0, 70.0, 60.0, 90.0, 150.0, 40.0, 30.0, 10.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 10.0, 90.0, 10.0, 0.0, 40.0, 40.0, 70.0, 90.0, 50.0, 200.0, 100.0, 60.0, 100.0, 260.0, 90.0, 20.0, 50.0, 180.0, 30.0, 80.0, 70.0, 20.0, 70.0, 260.0, 110.0, 10.0, 40.0, 50.0, 60.0, 30.0, 80.0, 70.0, 30.0, 60.0, 100.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 0.0, 45.0, 0.0, 0.0, -20.0, 10.0, 80.0, 20.0, 50.0, 100.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 90.0, 220.0, 150.0, 0.0, 15.0, 180.0, 50.0, 10.0, 30.0, 40.0, 70.0, 80.0, 170.0, 20.0, 30.0, 10.0, 60.0, 20.0, 60.0, 70.0, 30.0, 30.0, 40.0, 20.0, 30.0, 120.0, 60.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 30.0, 70.0, 70.0, 40.0, 40.0, 50.0, 60.0, 70.0, 30.0, 40.0, 170.0, 10.0, 50.0, 40.0, 60.0, 20.0, 0.0, 80.0, 40.0, 0.0, 30.0, 60.0, 150.0, 210.0, 80.0, 10.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 30.0, 40.0, 30.0, 50.0, 480.0, 30.0, 200.0, 10.0, 30.0, 30.0, 50.0, 50.0, 60.0, 0.0, 440.0, 40.0, 110.0, 40.0, 50.0, 30.0, 100.0, 30.0, 70.0, 80.0, 70.0, 30.0, 50.0, 40.0, 80.0, 660.0, 20.0, 30.0, 30.0, 0.0, 180.0, 100.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 20.0, 90.0, 90.0, 60.0, -40.0, 80.0, 0.0, 270.0, 60.0, 270.0, 20.0, 40.0, 20.0, 200.0, 40.0, 40.0, 5.0, 0.0, 40.0, 20.0, 90.0, 110.0, 150.0, 0.0, 10.0, 65.0, -15.0, 0.0, 10.0, 40.0, 30.0, 150.0, 10.0, 360.0, 40.0, 40.0, 120.0, 20.0, 30.0, 70.0, 60.0, 150.0, 20.0, 0.0, 20.0, 30.0, 50.0, 60.0, 50.0, 190.0, 30.0, 60.0, 50.0, 80.0, 30.0, -5.0, 160.0, 50.0, 100.0, 60.0, -15.0, 170.0, 0.0, 110.0, 20.0, 80.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 70.0, 0.0, 20.0, 110.0, -5.0, 120.0, 30.0, 50.0, 80.0, 30.0, 40.0, -50.0, -30.0, 0.0, 20.0, 360.0, 0.0, 10.0, 20.0, 20.0, 10.0, 290.0, 10.0, 190.0, 10.0, 35.0, 30.0, 20.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 0.0, 30.0, 40.0, 50.0, 50.0, 40.0, 20.0, -50.0, 0.0, 280.0, -5.0, 0.0, 40.0, 190.0, 270.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 15.0, 20.0, 40.0, 20.0, 30.0, 20.0, 0.0, 0.0, 160.0, 200.0, 160.0, 70.0, 40.0, 10.0, 40.0, 60.0, 0.0, 70.0, 90.0, 20.0, 30.0, 60.0, 110.0, 50.0, -80.0, 90.0, 70.0, 150.0, 70.0, 170.0, 20.0, 30.0, 50.0, 30.0, 140.0, 40.0, 180.0, 190.0, 30.0, 50.0, 20.0, 0.0, 30.0, 20.0, 160.0, 25.0, 70.0, 25.0, 0.0, 40.0, 20.0, 10.0, 50.0, 0.0, 0.0, 40.0, 50.0, 0.0, 10.0, 70.0, 50.0, 180.0, 30.0, 10.0, 20.0, 60.0, 20.0, 70.0, 280.0, -40.0, 10.0, 90.0, 260.0, 40.0, 40.0, 170.0, 410.0, 30.0, 100.0, 80.0, 60.0, 20.0, 80.0, 250.0, 30.0, 90.0, -30.0, 170.0, 10.0, 15.0, 150.0, 60.0, 150.0, 30.0, 40.0, 10.0, 60.0, 160.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 30.0, 15.0, 10.0, 160.0, 30.0, 10.0, 30.0, 30.0, 40.0, 10.0, 80.0, 180.0, 60.0, 0.0, 80.0, 20.0, 330.0, 0.0, -25.0, 40.0, 70.0, 90.0, 80.0, 130.0, 50.0, 30.0, 80.0, 60.0, 360.0, 30.0, 60.0, 110.0, 20.0, 10.0, 50.0, 20.0, 180.0, -240.0, 10.0, 60.0, 150.0, 20.0, 50.0, 20.0, -40.0, 30.0, 40.0, 20.0, 10.0, 40.0, 100.0, 20.0, 90.0, 30.0, 70.0, -5.0, 60.0, 15.0, 30.0, 0.0, 10.0, 30.0, 30.0, 60.0, 40.0, 80.0, 40.0, 30.0, 30.0, 20.0, 110.0, 70.0, 20.0, 40.0, 40.0, 60.0, 30.0, 180.0, 20.0, 150.0, 10.0, 40.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 245.0, 0.0, 80.0, 50.0, 80.0, 70.0, 10.0, 30.0, 50.0, 150.0, -90.0, 10.0, 0.0, 90.0, 60.0, 60.0, 30.0, 0.0, 60.0, 120.0, 250.0, 0.0, 40.0, 10.0, 100.0, 170.0, 60.0, 20.0, 90.0, 30.0, 40.0, 0.0, 20.0, 80.0, 10.0, 70.0, 10.0, 0.0, -5.0, 170.0, 400.0, 0.0, 20.0, 50.0, 180.0, 30.0, 10.0, 40.0, -30.0, 40.0, 100.0, 30.0, 70.0, 480.0, 100.0, 80.0, 210.0, 70.0, 100.0, 400.0, 110.0, 40.0, 80.0, -130.0, 50.0, 80.0, 40.0, 150.0, 110.0, 10.0, 260.0, 0.0, 40.0, 40.0, 140.0, 80.0, 30.0, 190.0, 10.0, -10.0, 10.0, 0.0, 270.0, 70.0, -30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 120.0, 0.0, 0.0, 10.0, 200.0, 60.0, 30.0, -20.0, 90.0, 20.0, -10.0, 30.0, 70.0, 40.0, 20.0, 130.0, 10.0, -10.0, 10.0, 60.0, 60.0, 10.0, 90.0, 30.0, 0.0, 110.0, 40.0, 90.0, 0.0, 80.0, 180.0, 0.0, 10.0, 100.0, 20.0, 20.0, 10.0, 80.0, 40.0, 30.0, 50.0, 190.0, -20.0, 60.0, 70.0, 50.0, 10.0, 10.0, 0.0, -40.0, 10.0, 0.0, 20.0, 50.0, 40.0, 70.0, 160.0, 360.0, 80.0, 70.0, 60.0, 20.0, 60.0, 240.0, 5.0, 130.0, 25.0, 30.0, 90.0, 60.0, 180.0, 130.0, 50.0, 250.0, 140.0, 40.0, 20.0, 90.0, 0.0, 10.0, 20.0, 100.0, 180.0, 80.0, 15.0, 80.0, 20.0, 25.0, 100.0, 40.0, 390.0, -10.0, 70.0, 50.0, 80.0, 90.0, 80.0, -20.0, 30.0, 0.0, 170.0, 90.0, 20.0, 100.0, 180.0, 60.0, 0.0, 0.0, 20.0, 70.0, 30.0, 260.0, 160.0, 30.0, 160.0, 10.0, 30.0, 20.0, 60.0, 60.0, 40.0, 20.0, 90.0, 25.0, 50.0, 160.0, 0.0, 20.0, 110.0, 30.0, 380.0, 30.0, 25.0, -40.0, 10.0, 0.0, -30.0, 50.0, 40.0, -15.0, 90.0, 90.0, 170.0, 30.0, 20.0, 30.0, 60.0, 160.0, 80.0, 40.0, 20.0, 60.0, 30.0, 180.0, 0.0, 50.0, 160.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 40.0, 20.0, 90.0, 220.0, 160.0, 170.0, -70.0, 260.0, -10.0, 50.0, 60.0, 60.0, -55.0, 30.0, 150.0, -130.0, 390.0, 10.0, 10.0, 10.0, 30.0, 30.0, 160.0, 60.0, 60.0, 20.0, 5.0, 70.0, 10.0, 0.0, -10.0, 30.0, 50.0, 10.0, 150.0, 85.0, 10.0, 160.0, 100.0, 60.0, 170.0, 60.0, 150.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 5.0, 0.0, 5.0, 20.0, 20.0, 10.0, 60.0, 50.0, 30.0, 80.0, 180.0, 10.0, 100.0, 0.0, 50.0, 0.0, 40.0, 100.0, 270.0, 50.0, 170.0, 30.0, 10.0, 210.0, 40.0, 30.0, 50.0, 10.0, -5.0, 50.0, 30.0, 50.0, 40.0, 60.0, 80.0, 110.0, 0.0, 40.0, 30.0, 30.0, 310.0, 40.0, 0.0, 60.0, 280.0, 70.0, 90.0, 5.0, 50.0, -5.0, 40.0, -10.0, 60.0, 30.0, 70.0, 70.0, 0.0, 40.0, 520.0, 0.0, 30.0, 160.0, 200.0, 180.0, 0.0, 40.0, 30.0, 70.0, 40.0, 40.0, 280.0, 0.0, 30.0, 50.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 180.0, 10.0, 60.0, 40.0, 40.0, 70.0, 35.0, 40.0, 30.0, 50.0, 50.0, 270.0, 20.0, 70.0, 50.0, 110.0, 100.0, 230.0, 190.0, 90.0, 60.0, -20.0, 50.0, 60.0, 60.0, 10.0, 10.0, 0.0, -115.0, 60.0, -30.0, 60.0, 20.0, 180.0, 100.0, 180.0, 170.0, 0.0, 90.0, 160.0, 260.0, 30.0, 30.0, 40.0, 20.0, 40.0, 40.0, 20.0, 50.0, 10.0, 210.0, 20.0, 40.0, 25.0, -10.0, 10.0, -20.0, 20.0, 40.0, 15.0, 20.0, 10.0, 80.0, 30.0, 20.0, 50.0, 0.0, 30.0, 10.0, 90.0, -5.0, 0.0, -10.0, 10.0, 10.0, 10.0, 40.0, -30.0, 0.0, 20.0, 110.0, 50.0, 20.0, 50.0, 270.0, 130.0, 80.0, 40.0, 180.0, 5.0, 60.0, 160.0, 50.0, 25.0, 60.0, 120.0, 290.0, -20.0, 30.0, 90.0, 90.0, 170.0, 40.0, 130.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6987250081913245, "mean_inference_ms": 1.4499420571628912, "mean_action_processing_ms": 0.4182019332383467, "mean_env_wait_ms": 1.3662702306006764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01518702507019043, "StateBufferConnector_ms": 0.01038813591003418, "ViewRequirementAgentConnector_ms": 0.42017674446105957}, "num_episodes": 18, "episode_return_max": 1200.0, "episode_return_min": 185.0, "episode_return_mean": 613.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.165595874990856, "num_env_steps_trained_throughput_per_sec": 19.165595874990856, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 209034.5, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209034.448, "sample_time_ms": 2743.742, "learn_time_ms": 206269.414, "learn_throughput": 19.392, "synch_weights_time_ms": 11.839}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 25, "trial_id": "aa996_00000", "date": "2024-05-24_00-11-46", "timestamp": 1716523906, "time_this_iter_s": 208.7170181274414, "time_total_s": 5173.790203809738, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d6fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5173.790203809738, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.178305084745762, "ram_util_percent": 79.53457627118645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8506681394018432, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6325972090894805, "policy_loss": -0.01020646295911921, "vf_loss": 5.6413002407208035, "vf_explained_var": -0.00029519238411047206, "kl": 0.007517164415563143, "entropy": 1.02383898089742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 239445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 1200.0, "episode_reward_min": 185.0, "episode_reward_mean": 602.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 520.0}, "policy_reward_mean": {"policy_0": 60.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 850.0, 565.0, 440.0, 900.0, 510.0, 680.0, 360.0, 505.0, 400.0, 635.0, 270.0, 785.0, 195.0, 700.0, 490.0, 620.0, 710.0, 420.0, 430.0, 780.0, 1030.0, 895.0, 450.0, 375.0, 735.0, 990.0, 250.0, 360.0, 450.0, 350.0, 590.0, 380.0, 605.0, 360.0, 830.0, 350.0, 895.0, 1150.0, 920.0, 900.0, 400.0, 440.0, 390.0, 500.0, 500.0, 490.0, 670.0, 720.0, 1050.0, 530.0, 870.0, 650.0, 790.0, 525.0, 565.0, 675.0, 660.0, 620.0, 655.0, 720.0, 245.0, 985.0, 280.0, 570.0, 920.0, 395.0, 900.0, 400.0, 1200.0, 620.0, 380.0, 685.0, 930.0, 295.0, 980.0, 445.0, 225.0, 185.0, 540.0, 790.0, 1060.0, 380.0, 365.0, 760.0, 800.0, 455.0, 495.0, 530.0, 650.0, 910.0, 930.0, 645.0, 485.0, 515.0, 270.0, 340.0, 580.0, 560.0, 480.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 100.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 20.0, 90.0, 90.0, 60.0, -40.0, 80.0, 0.0, 270.0, 60.0, 270.0, 20.0, 40.0, 20.0, 200.0, 40.0, 40.0, 5.0, 0.0, 40.0, 20.0, 90.0, 110.0, 150.0, 0.0, 10.0, 65.0, -15.0, 0.0, 10.0, 40.0, 30.0, 150.0, 10.0, 360.0, 40.0, 40.0, 120.0, 20.0, 30.0, 70.0, 60.0, 150.0, 20.0, 0.0, 20.0, 30.0, 50.0, 60.0, 50.0, 190.0, 30.0, 60.0, 50.0, 80.0, 30.0, -5.0, 160.0, 50.0, 100.0, 60.0, -15.0, 170.0, 0.0, 110.0, 20.0, 80.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 70.0, 0.0, 20.0, 110.0, -5.0, 120.0, 30.0, 50.0, 80.0, 30.0, 40.0, -50.0, -30.0, 0.0, 20.0, 360.0, 0.0, 10.0, 20.0, 20.0, 10.0, 290.0, 10.0, 190.0, 10.0, 35.0, 30.0, 20.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 0.0, 30.0, 40.0, 50.0, 50.0, 40.0, 20.0, -50.0, 0.0, 280.0, -5.0, 0.0, 40.0, 190.0, 270.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 15.0, 20.0, 40.0, 20.0, 30.0, 20.0, 0.0, 0.0, 160.0, 200.0, 160.0, 70.0, 40.0, 10.0, 40.0, 60.0, 0.0, 70.0, 90.0, 20.0, 30.0, 60.0, 110.0, 50.0, -80.0, 90.0, 70.0, 150.0, 70.0, 170.0, 20.0, 30.0, 50.0, 30.0, 140.0, 40.0, 180.0, 190.0, 30.0, 50.0, 20.0, 0.0, 30.0, 20.0, 160.0, 25.0, 70.0, 25.0, 0.0, 40.0, 20.0, 10.0, 50.0, 0.0, 0.0, 40.0, 50.0, 0.0, 10.0, 70.0, 50.0, 180.0, 30.0, 10.0, 20.0, 60.0, 20.0, 70.0, 280.0, -40.0, 10.0, 90.0, 260.0, 40.0, 40.0, 170.0, 410.0, 30.0, 100.0, 80.0, 60.0, 20.0, 80.0, 250.0, 30.0, 90.0, -30.0, 170.0, 10.0, 15.0, 150.0, 60.0, 150.0, 30.0, 40.0, 10.0, 60.0, 160.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 30.0, 15.0, 10.0, 160.0, 30.0, 10.0, 30.0, 30.0, 40.0, 10.0, 80.0, 180.0, 60.0, 0.0, 80.0, 20.0, 330.0, 0.0, -25.0, 40.0, 70.0, 90.0, 80.0, 130.0, 50.0, 30.0, 80.0, 60.0, 360.0, 30.0, 60.0, 110.0, 20.0, 10.0, 50.0, 20.0, 180.0, -240.0, 10.0, 60.0, 150.0, 20.0, 50.0, 20.0, -40.0, 30.0, 40.0, 20.0, 10.0, 40.0, 100.0, 20.0, 90.0, 30.0, 70.0, -5.0, 60.0, 15.0, 30.0, 0.0, 10.0, 30.0, 30.0, 60.0, 40.0, 80.0, 40.0, 30.0, 30.0, 20.0, 110.0, 70.0, 20.0, 40.0, 40.0, 60.0, 30.0, 180.0, 20.0, 150.0, 10.0, 40.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 245.0, 0.0, 80.0, 50.0, 80.0, 70.0, 10.0, 30.0, 50.0, 150.0, -90.0, 10.0, 0.0, 90.0, 60.0, 60.0, 30.0, 0.0, 60.0, 120.0, 250.0, 0.0, 40.0, 10.0, 100.0, 170.0, 60.0, 20.0, 90.0, 30.0, 40.0, 0.0, 20.0, 80.0, 10.0, 70.0, 10.0, 0.0, -5.0, 170.0, 400.0, 0.0, 20.0, 50.0, 180.0, 30.0, 10.0, 40.0, -30.0, 40.0, 100.0, 30.0, 70.0, 480.0, 100.0, 80.0, 210.0, 70.0, 100.0, 400.0, 110.0, 40.0, 80.0, -130.0, 50.0, 80.0, 40.0, 150.0, 110.0, 10.0, 260.0, 0.0, 40.0, 40.0, 140.0, 80.0, 30.0, 190.0, 10.0, -10.0, 10.0, 0.0, 270.0, 70.0, -30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 120.0, 0.0, 0.0, 10.0, 200.0, 60.0, 30.0, -20.0, 90.0, 20.0, -10.0, 30.0, 70.0, 40.0, 20.0, 130.0, 10.0, -10.0, 10.0, 60.0, 60.0, 10.0, 90.0, 30.0, 0.0, 110.0, 40.0, 90.0, 0.0, 80.0, 180.0, 0.0, 10.0, 100.0, 20.0, 20.0, 10.0, 80.0, 40.0, 30.0, 50.0, 190.0, -20.0, 60.0, 70.0, 50.0, 10.0, 10.0, 0.0, -40.0, 10.0, 0.0, 20.0, 50.0, 40.0, 70.0, 160.0, 360.0, 80.0, 70.0, 60.0, 20.0, 60.0, 240.0, 5.0, 130.0, 25.0, 30.0, 90.0, 60.0, 180.0, 130.0, 50.0, 250.0, 140.0, 40.0, 20.0, 90.0, 0.0, 10.0, 20.0, 100.0, 180.0, 80.0, 15.0, 80.0, 20.0, 25.0, 100.0, 40.0, 390.0, -10.0, 70.0, 50.0, 80.0, 90.0, 80.0, -20.0, 30.0, 0.0, 170.0, 90.0, 20.0, 100.0, 180.0, 60.0, 0.0, 0.0, 20.0, 70.0, 30.0, 260.0, 160.0, 30.0, 160.0, 10.0, 30.0, 20.0, 60.0, 60.0, 40.0, 20.0, 90.0, 25.0, 50.0, 160.0, 0.0, 20.0, 110.0, 30.0, 380.0, 30.0, 25.0, -40.0, 10.0, 0.0, -30.0, 50.0, 40.0, -15.0, 90.0, 90.0, 170.0, 30.0, 20.0, 30.0, 60.0, 160.0, 80.0, 40.0, 20.0, 60.0, 30.0, 180.0, 0.0, 50.0, 160.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 40.0, 20.0, 90.0, 220.0, 160.0, 170.0, -70.0, 260.0, -10.0, 50.0, 60.0, 60.0, -55.0, 30.0, 150.0, -130.0, 390.0, 10.0, 10.0, 10.0, 30.0, 30.0, 160.0, 60.0, 60.0, 20.0, 5.0, 70.0, 10.0, 0.0, -10.0, 30.0, 50.0, 10.0, 150.0, 85.0, 10.0, 160.0, 100.0, 60.0, 170.0, 60.0, 150.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 5.0, 0.0, 5.0, 20.0, 20.0, 10.0, 60.0, 50.0, 30.0, 80.0, 180.0, 10.0, 100.0, 0.0, 50.0, 0.0, 40.0, 100.0, 270.0, 50.0, 170.0, 30.0, 10.0, 210.0, 40.0, 30.0, 50.0, 10.0, -5.0, 50.0, 30.0, 50.0, 40.0, 60.0, 80.0, 110.0, 0.0, 40.0, 30.0, 30.0, 310.0, 40.0, 0.0, 60.0, 280.0, 70.0, 90.0, 5.0, 50.0, -5.0, 40.0, -10.0, 60.0, 30.0, 70.0, 70.0, 0.0, 40.0, 520.0, 0.0, 30.0, 160.0, 200.0, 180.0, 0.0, 40.0, 30.0, 70.0, 40.0, 40.0, 280.0, 0.0, 30.0, 50.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 180.0, 10.0, 60.0, 40.0, 40.0, 70.0, 35.0, 40.0, 30.0, 50.0, 50.0, 270.0, 20.0, 70.0, 50.0, 110.0, 100.0, 230.0, 190.0, 90.0, 60.0, -20.0, 50.0, 60.0, 60.0, 10.0, 10.0, 0.0, -115.0, 60.0, -30.0, 60.0, 20.0, 180.0, 100.0, 180.0, 170.0, 0.0, 90.0, 160.0, 260.0, 30.0, 30.0, 40.0, 20.0, 40.0, 40.0, 20.0, 50.0, 10.0, 210.0, 20.0, 40.0, 25.0, -10.0, 10.0, -20.0, 20.0, 40.0, 15.0, 20.0, 10.0, 80.0, 30.0, 20.0, 50.0, 0.0, 30.0, 10.0, 90.0, -5.0, 0.0, -10.0, 10.0, 10.0, 10.0, 40.0, -30.0, 0.0, 20.0, 110.0, 50.0, 20.0, 50.0, 270.0, 130.0, 80.0, 40.0, 180.0, 5.0, 60.0, 160.0, 50.0, 25.0, 60.0, 120.0, 290.0, -20.0, 30.0, 90.0, 90.0, 170.0, 40.0, 130.0, 120.0, 60.0, 80.0, 20.0, 20.0, 30.0, 70.0, 70.0, -90.0, 90.0, 30.0, 40.0, 10.0, 40.0, 20.0, 15.0, 30.0, 160.0, 0.0, 40.0, 10.0, 70.0, 20.0, 130.0, 100.0, 150.0, 40.0, 180.0, 0.0, 40.0, 30.0, 170.0, 110.0, 30.0, 170.0, 60.0, 70.0, 70.0, 50.0, 30.0, 40.0, 95.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 100.0, 20.0, 30.0, 100.0, 20.0, 80.0, 15.0, 90.0, 0.0, 40.0, 70.0, 70.0, 10.0, 70.0, 80.0, 70.0, 0.0, 0.0, 0.0, 90.0, 80.0, 40.0, 100.0, 0.0, 20.0, 70.0, 0.0, 40.0, 10.0, 150.0, 100.0, 30.0, 230.0, 380.0, 30.0, 120.0, 20.0, 70.0, 200.0, 40.0, 20.0, 30.0, 0.0, 90.0, 50.0, 40.0, 20.0, 90.0, 40.0, 80.0, 30.0, 460.0, 30.0, 30.0, 120.0, 20.0, 50.0, 90.0, 25.0, 110.0, 60.0, 30.0, 110.0, 70.0, 170.0, 40.0, 10.0, 5.0, 10.0, 20.0, 40.0, 70.0, 50.0, 160.0, 160.0, 30.0, 70.0, 60.0, 30.0, 50.0, -65.0, 10.0, 10.0, 30.0, 10.0, 50.0, 0.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 140.0, 40.0, 60.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, -30.0, 0.0, 250.0, 10.0, 70.0, 160.0, 30.0, 0.0, 10.0, 40.0, 110.0, 30.0, 190.0, 110.0, 0.0, 40.0, 90.0, 30.0, 30.0, 40.0, 30.0, -40.0, 20.0, 20.0, 210.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.697819876070076, "mean_inference_ms": 1.4526559466771756, "mean_action_processing_ms": 0.42670683874845894, "mean_env_wait_ms": 1.3663206586155452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014112472534179688, "StateBufferConnector_ms": 0.010655879974365234, "ViewRequirementAgentConnector_ms": 0.4237070083618164}, "num_episodes": 18, "episode_return_max": 1200.0, "episode_return_min": 185.0, "episode_return_mean": 602.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.08000500538614, "num_env_steps_trained_throughput_per_sec": 19.08000500538614, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 208898.219, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208898.166, "sample_time_ms": 2792.735, "learn_time_ms": 206085.153, "learn_throughput": 19.409, "synch_weights_time_ms": 11.438}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 26, "trial_id": "aa996_00000", "date": "2024-05-24_00-15-15", "timestamp": 1716524115, "time_this_iter_s": 209.65230178833008, "time_total_s": 5383.442505598068, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x33098b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5383.442505598068, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 19.67138047138047, "ram_util_percent": 79.7026936026936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.808787149438462, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.153627246764267, "policy_loss": -0.010420621484885026, "vf_loss": 5.162440785000753, "vf_explained_var": 0.0011342737621392687, "kl": 0.008035428136798896, "entropy": 1.0200178083520346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 248835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 1200.0, "episode_reward_min": 165.0, "episode_reward_mean": 602.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 520.0}, "policy_reward_mean": {"policy_0": 60.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 430.0, 780.0, 1030.0, 895.0, 450.0, 375.0, 735.0, 990.0, 250.0, 360.0, 450.0, 350.0, 590.0, 380.0, 605.0, 360.0, 830.0, 350.0, 895.0, 1150.0, 920.0, 900.0, 400.0, 440.0, 390.0, 500.0, 500.0, 490.0, 670.0, 720.0, 1050.0, 530.0, 870.0, 650.0, 790.0, 525.0, 565.0, 675.0, 660.0, 620.0, 655.0, 720.0, 245.0, 985.0, 280.0, 570.0, 920.0, 395.0, 900.0, 400.0, 1200.0, 620.0, 380.0, 685.0, 930.0, 295.0, 980.0, 445.0, 225.0, 185.0, 540.0, 790.0, 1060.0, 380.0, 365.0, 760.0, 800.0, 455.0, 495.0, 530.0, 650.0, 910.0, 930.0, 645.0, 485.0, 515.0, 270.0, 340.0, 580.0, 560.0, 480.0, 900.0, 710.0, 175.0, 320.0, 420.0, 370.0, 750.0, 810.0, 540.0, 165.0, 460.0, 945.0, 600.0, 515.0, 1040.0, 460.0, 515.0, 480.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 160.0, 25.0, 70.0, 25.0, 0.0, 40.0, 20.0, 10.0, 50.0, 0.0, 0.0, 40.0, 50.0, 0.0, 10.0, 70.0, 50.0, 180.0, 30.0, 10.0, 20.0, 60.0, 20.0, 70.0, 280.0, -40.0, 10.0, 90.0, 260.0, 40.0, 40.0, 170.0, 410.0, 30.0, 100.0, 80.0, 60.0, 20.0, 80.0, 250.0, 30.0, 90.0, -30.0, 170.0, 10.0, 15.0, 150.0, 60.0, 150.0, 30.0, 40.0, 10.0, 60.0, 160.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 30.0, 15.0, 10.0, 160.0, 30.0, 10.0, 30.0, 30.0, 40.0, 10.0, 80.0, 180.0, 60.0, 0.0, 80.0, 20.0, 330.0, 0.0, -25.0, 40.0, 70.0, 90.0, 80.0, 130.0, 50.0, 30.0, 80.0, 60.0, 360.0, 30.0, 60.0, 110.0, 20.0, 10.0, 50.0, 20.0, 180.0, -240.0, 10.0, 60.0, 150.0, 20.0, 50.0, 20.0, -40.0, 30.0, 40.0, 20.0, 10.0, 40.0, 100.0, 20.0, 90.0, 30.0, 70.0, -5.0, 60.0, 15.0, 30.0, 0.0, 10.0, 30.0, 30.0, 60.0, 40.0, 80.0, 40.0, 30.0, 30.0, 20.0, 110.0, 70.0, 20.0, 40.0, 40.0, 60.0, 30.0, 180.0, 20.0, 150.0, 10.0, 40.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 40.0, 10.0, 30.0, 245.0, 0.0, 80.0, 50.0, 80.0, 70.0, 10.0, 30.0, 50.0, 150.0, -90.0, 10.0, 0.0, 90.0, 60.0, 60.0, 30.0, 0.0, 60.0, 120.0, 250.0, 0.0, 40.0, 10.0, 100.0, 170.0, 60.0, 20.0, 90.0, 30.0, 40.0, 0.0, 20.0, 80.0, 10.0, 70.0, 10.0, 0.0, -5.0, 170.0, 400.0, 0.0, 20.0, 50.0, 180.0, 30.0, 10.0, 40.0, -30.0, 40.0, 100.0, 30.0, 70.0, 480.0, 100.0, 80.0, 210.0, 70.0, 100.0, 400.0, 110.0, 40.0, 80.0, -130.0, 50.0, 80.0, 40.0, 150.0, 110.0, 10.0, 260.0, 0.0, 40.0, 40.0, 140.0, 80.0, 30.0, 190.0, 10.0, -10.0, 10.0, 0.0, 270.0, 70.0, -30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 120.0, 0.0, 0.0, 10.0, 200.0, 60.0, 30.0, -20.0, 90.0, 20.0, -10.0, 30.0, 70.0, 40.0, 20.0, 130.0, 10.0, -10.0, 10.0, 60.0, 60.0, 10.0, 90.0, 30.0, 0.0, 110.0, 40.0, 90.0, 0.0, 80.0, 180.0, 0.0, 10.0, 100.0, 20.0, 20.0, 10.0, 80.0, 40.0, 30.0, 50.0, 190.0, -20.0, 60.0, 70.0, 50.0, 10.0, 10.0, 0.0, -40.0, 10.0, 0.0, 20.0, 50.0, 40.0, 70.0, 160.0, 360.0, 80.0, 70.0, 60.0, 20.0, 60.0, 240.0, 5.0, 130.0, 25.0, 30.0, 90.0, 60.0, 180.0, 130.0, 50.0, 250.0, 140.0, 40.0, 20.0, 90.0, 0.0, 10.0, 20.0, 100.0, 180.0, 80.0, 15.0, 80.0, 20.0, 25.0, 100.0, 40.0, 390.0, -10.0, 70.0, 50.0, 80.0, 90.0, 80.0, -20.0, 30.0, 0.0, 170.0, 90.0, 20.0, 100.0, 180.0, 60.0, 0.0, 0.0, 20.0, 70.0, 30.0, 260.0, 160.0, 30.0, 160.0, 10.0, 30.0, 20.0, 60.0, 60.0, 40.0, 20.0, 90.0, 25.0, 50.0, 160.0, 0.0, 20.0, 110.0, 30.0, 380.0, 30.0, 25.0, -40.0, 10.0, 0.0, -30.0, 50.0, 40.0, -15.0, 90.0, 90.0, 170.0, 30.0, 20.0, 30.0, 60.0, 160.0, 80.0, 40.0, 20.0, 60.0, 30.0, 180.0, 0.0, 50.0, 160.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 40.0, 20.0, 90.0, 220.0, 160.0, 170.0, -70.0, 260.0, -10.0, 50.0, 60.0, 60.0, -55.0, 30.0, 150.0, -130.0, 390.0, 10.0, 10.0, 10.0, 30.0, 30.0, 160.0, 60.0, 60.0, 20.0, 5.0, 70.0, 10.0, 0.0, -10.0, 30.0, 50.0, 10.0, 150.0, 85.0, 10.0, 160.0, 100.0, 60.0, 170.0, 60.0, 150.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 5.0, 0.0, 5.0, 20.0, 20.0, 10.0, 60.0, 50.0, 30.0, 80.0, 180.0, 10.0, 100.0, 0.0, 50.0, 0.0, 40.0, 100.0, 270.0, 50.0, 170.0, 30.0, 10.0, 210.0, 40.0, 30.0, 50.0, 10.0, -5.0, 50.0, 30.0, 50.0, 40.0, 60.0, 80.0, 110.0, 0.0, 40.0, 30.0, 30.0, 310.0, 40.0, 0.0, 60.0, 280.0, 70.0, 90.0, 5.0, 50.0, -5.0, 40.0, -10.0, 60.0, 30.0, 70.0, 70.0, 0.0, 40.0, 520.0, 0.0, 30.0, 160.0, 200.0, 180.0, 0.0, 40.0, 30.0, 70.0, 40.0, 40.0, 280.0, 0.0, 30.0, 50.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 180.0, 10.0, 60.0, 40.0, 40.0, 70.0, 35.0, 40.0, 30.0, 50.0, 50.0, 270.0, 20.0, 70.0, 50.0, 110.0, 100.0, 230.0, 190.0, 90.0, 60.0, -20.0, 50.0, 60.0, 60.0, 10.0, 10.0, 0.0, -115.0, 60.0, -30.0, 60.0, 20.0, 180.0, 100.0, 180.0, 170.0, 0.0, 90.0, 160.0, 260.0, 30.0, 30.0, 40.0, 20.0, 40.0, 40.0, 20.0, 50.0, 10.0, 210.0, 20.0, 40.0, 25.0, -10.0, 10.0, -20.0, 20.0, 40.0, 15.0, 20.0, 10.0, 80.0, 30.0, 20.0, 50.0, 0.0, 30.0, 10.0, 90.0, -5.0, 0.0, -10.0, 10.0, 10.0, 10.0, 40.0, -30.0, 0.0, 20.0, 110.0, 50.0, 20.0, 50.0, 270.0, 130.0, 80.0, 40.0, 180.0, 5.0, 60.0, 160.0, 50.0, 25.0, 60.0, 120.0, 290.0, -20.0, 30.0, 90.0, 90.0, 170.0, 40.0, 130.0, 120.0, 60.0, 80.0, 20.0, 20.0, 30.0, 70.0, 70.0, -90.0, 90.0, 30.0, 40.0, 10.0, 40.0, 20.0, 15.0, 30.0, 160.0, 0.0, 40.0, 10.0, 70.0, 20.0, 130.0, 100.0, 150.0, 40.0, 180.0, 0.0, 40.0, 30.0, 170.0, 110.0, 30.0, 170.0, 60.0, 70.0, 70.0, 50.0, 30.0, 40.0, 95.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 100.0, 20.0, 30.0, 100.0, 20.0, 80.0, 15.0, 90.0, 0.0, 40.0, 70.0, 70.0, 10.0, 70.0, 80.0, 70.0, 0.0, 0.0, 0.0, 90.0, 80.0, 40.0, 100.0, 0.0, 20.0, 70.0, 0.0, 40.0, 10.0, 150.0, 100.0, 30.0, 230.0, 380.0, 30.0, 120.0, 20.0, 70.0, 200.0, 40.0, 20.0, 30.0, 0.0, 90.0, 50.0, 40.0, 20.0, 90.0, 40.0, 80.0, 30.0, 460.0, 30.0, 30.0, 120.0, 20.0, 50.0, 90.0, 25.0, 110.0, 60.0, 30.0, 110.0, 70.0, 170.0, 40.0, 10.0, 5.0, 10.0, 20.0, 40.0, 70.0, 50.0, 160.0, 160.0, 30.0, 70.0, 60.0, 30.0, 50.0, -65.0, 10.0, 10.0, 30.0, 10.0, 50.0, 0.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 140.0, 40.0, 60.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, -30.0, 0.0, 250.0, 10.0, 70.0, 160.0, 30.0, 0.0, 10.0, 40.0, 110.0, 30.0, 190.0, 110.0, 0.0, 40.0, 90.0, 30.0, 30.0, 40.0, 30.0, -40.0, 20.0, 20.0, 210.0, 50.0, 80.0, 180.0, 40.0, 90.0, 80.0, 10.0, 70.0, 60.0, 220.0, 70.0, 80.0, 40.0, 20.0, 40.0, 180.0, 80.0, 20.0, 40.0, 30.0, 180.0, 10.0, 20.0, 40.0, 40.0, 10.0, 20.0, 5.0, 0.0, 0.0, 30.0, 30.0, 150.0, 40.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 60.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 10.0, 60.0, 30.0, 60.0, 0.0, 30.0, 10.0, 100.0, 40.0, 10.0, 0.0, 90.0, 190.0, 260.0, 40.0, 30.0, 40.0, 10.0, 40.0, 110.0, 0.0, 30.0, 20.0, 100.0, 10.0, 120.0, 110.0, 100.0, 190.0, 40.0, 80.0, 40.0, 0.0, 30.0, 100.0, 50.0, 110.0, 30.0, 40.0, 80.0, 70.0, 30.0, 40.0, 10.0, 0.0, 10.0, 20.0, 5.0, 0.0, 40.0, 0.0, 40.0, 30.0, 60.0, 90.0, 30.0, 10.0, 70.0, 70.0, 40.0, 40.0, 20.0, 90.0, 170.0, 40.0, 95.0, 30.0, 130.0, 180.0, 60.0, 50.0, 100.0, 10.0, 30.0, 170.0, 10.0, 40.0, 60.0, 50.0, 190.0, 30.0, 10.0, 40.0, 60.0, 170.0, 20.0, 50.0, 85.0, 10.0, 0.0, 10.0, 70.0, 10.0, 70.0, 160.0, 60.0, 50.0, 10.0, 250.0, 70.0, 130.0, 230.0, 20.0, 80.0, 10.0, 50.0, 0.0, 20.0, 70.0, 50.0, -20.0, 180.0, 160.0, -5.0, 50.0, 40.0, -140.0, 100.0, 10.0, 60.0, 190.0, 50.0, 80.0, 30.0, 40.0, 0.0, 40.0, 80.0, 80.0, 10.0, 90.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6955460919930045, "mean_inference_ms": 1.4543280826468021, "mean_action_processing_ms": 0.4344039019889564, "mean_env_wait_ms": 1.3654569306205588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013684511184692383, "StateBufferConnector_ms": 0.011284828186035156, "ViewRequirementAgentConnector_ms": 0.423145055770874}, "num_episodes": 18, "episode_return_max": 1200.0, "episode_return_min": 165.0, "episode_return_mean": 602.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.97511376933961, "num_env_steps_trained_throughput_per_sec": 18.97511376933961, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 209123.211, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209123.158, "sample_time_ms": 2758.651, "learn_time_ms": 206343.436, "learn_throughput": 19.385, "synch_weights_time_ms": 11.607}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 27, "trial_id": "aa996_00000", "date": "2024-05-24_00-18-46", "timestamp": 1716524326, "time_this_iter_s": 210.82301902770996, "time_total_s": 5594.265524625778, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x29e7675e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5594.265524625778, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 19.72121212121212, "ram_util_percent": 80.53164983164983}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8551438675203515, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5640705464620055, "policy_loss": -0.010221591326075826, "vf_loss": 5.572901840433399, "vf_explained_var": 0.0009679110222858108, "kl": 0.0069515150768606135, "entropy": 0.9987984854700213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 258225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1200.0, "episode_reward_min": 115.0, "episode_reward_mean": 590.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 520.0}, "policy_reward_mean": {"policy_0": 59.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0, 895.0, 1150.0, 920.0, 900.0, 400.0, 440.0, 390.0, 500.0, 500.0, 490.0, 670.0, 720.0, 1050.0, 530.0, 870.0, 650.0, 790.0, 525.0, 565.0, 675.0, 660.0, 620.0, 655.0, 720.0, 245.0, 985.0, 280.0, 570.0, 920.0, 395.0, 900.0, 400.0, 1200.0, 620.0, 380.0, 685.0, 930.0, 295.0, 980.0, 445.0, 225.0, 185.0, 540.0, 790.0, 1060.0, 380.0, 365.0, 760.0, 800.0, 455.0, 495.0, 530.0, 650.0, 910.0, 930.0, 645.0, 485.0, 515.0, 270.0, 340.0, 580.0, 560.0, 480.0, 900.0, 710.0, 175.0, 320.0, 420.0, 370.0, 750.0, 810.0, 540.0, 165.0, 460.0, 945.0, 600.0, 515.0, 1040.0, 460.0, 515.0, 480.0, 630.0, 500.0, 500.0, 450.0, 460.0, 470.0, 280.0, 650.0, 525.0, 350.0, 280.0, 340.0, 810.0, 810.0, 770.0, 355.0, 780.0, 115.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 30.0, 40.0, 0.0, 20.0, 80.0, 10.0, 70.0, 10.0, 0.0, -5.0, 170.0, 400.0, 0.0, 20.0, 50.0, 180.0, 30.0, 10.0, 40.0, -30.0, 40.0, 100.0, 30.0, 70.0, 480.0, 100.0, 80.0, 210.0, 70.0, 100.0, 400.0, 110.0, 40.0, 80.0, -130.0, 50.0, 80.0, 40.0, 150.0, 110.0, 10.0, 260.0, 0.0, 40.0, 40.0, 140.0, 80.0, 30.0, 190.0, 10.0, -10.0, 10.0, 0.0, 270.0, 70.0, -30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 120.0, 0.0, 0.0, 10.0, 200.0, 60.0, 30.0, -20.0, 90.0, 20.0, -10.0, 30.0, 70.0, 40.0, 20.0, 130.0, 10.0, -10.0, 10.0, 60.0, 60.0, 10.0, 90.0, 30.0, 0.0, 110.0, 40.0, 90.0, 0.0, 80.0, 180.0, 0.0, 10.0, 100.0, 20.0, 20.0, 10.0, 80.0, 40.0, 30.0, 50.0, 190.0, -20.0, 60.0, 70.0, 50.0, 10.0, 10.0, 0.0, -40.0, 10.0, 0.0, 20.0, 50.0, 40.0, 70.0, 160.0, 360.0, 80.0, 70.0, 60.0, 20.0, 60.0, 240.0, 5.0, 130.0, 25.0, 30.0, 90.0, 60.0, 180.0, 130.0, 50.0, 250.0, 140.0, 40.0, 20.0, 90.0, 0.0, 10.0, 20.0, 100.0, 180.0, 80.0, 15.0, 80.0, 20.0, 25.0, 100.0, 40.0, 390.0, -10.0, 70.0, 50.0, 80.0, 90.0, 80.0, -20.0, 30.0, 0.0, 170.0, 90.0, 20.0, 100.0, 180.0, 60.0, 0.0, 0.0, 20.0, 70.0, 30.0, 260.0, 160.0, 30.0, 160.0, 10.0, 30.0, 20.0, 60.0, 60.0, 40.0, 20.0, 90.0, 25.0, 50.0, 160.0, 0.0, 20.0, 110.0, 30.0, 380.0, 30.0, 25.0, -40.0, 10.0, 0.0, -30.0, 50.0, 40.0, -15.0, 90.0, 90.0, 170.0, 30.0, 20.0, 30.0, 60.0, 160.0, 80.0, 40.0, 20.0, 60.0, 30.0, 180.0, 0.0, 50.0, 160.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 40.0, 20.0, 90.0, 220.0, 160.0, 170.0, -70.0, 260.0, -10.0, 50.0, 60.0, 60.0, -55.0, 30.0, 150.0, -130.0, 390.0, 10.0, 10.0, 10.0, 30.0, 30.0, 160.0, 60.0, 60.0, 20.0, 5.0, 70.0, 10.0, 0.0, -10.0, 30.0, 50.0, 10.0, 150.0, 85.0, 10.0, 160.0, 100.0, 60.0, 170.0, 60.0, 150.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 5.0, 0.0, 5.0, 20.0, 20.0, 10.0, 60.0, 50.0, 30.0, 80.0, 180.0, 10.0, 100.0, 0.0, 50.0, 0.0, 40.0, 100.0, 270.0, 50.0, 170.0, 30.0, 10.0, 210.0, 40.0, 30.0, 50.0, 10.0, -5.0, 50.0, 30.0, 50.0, 40.0, 60.0, 80.0, 110.0, 0.0, 40.0, 30.0, 30.0, 310.0, 40.0, 0.0, 60.0, 280.0, 70.0, 90.0, 5.0, 50.0, -5.0, 40.0, -10.0, 60.0, 30.0, 70.0, 70.0, 0.0, 40.0, 520.0, 0.0, 30.0, 160.0, 200.0, 180.0, 0.0, 40.0, 30.0, 70.0, 40.0, 40.0, 280.0, 0.0, 30.0, 50.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 180.0, 10.0, 60.0, 40.0, 40.0, 70.0, 35.0, 40.0, 30.0, 50.0, 50.0, 270.0, 20.0, 70.0, 50.0, 110.0, 100.0, 230.0, 190.0, 90.0, 60.0, -20.0, 50.0, 60.0, 60.0, 10.0, 10.0, 0.0, -115.0, 60.0, -30.0, 60.0, 20.0, 180.0, 100.0, 180.0, 170.0, 0.0, 90.0, 160.0, 260.0, 30.0, 30.0, 40.0, 20.0, 40.0, 40.0, 20.0, 50.0, 10.0, 210.0, 20.0, 40.0, 25.0, -10.0, 10.0, -20.0, 20.0, 40.0, 15.0, 20.0, 10.0, 80.0, 30.0, 20.0, 50.0, 0.0, 30.0, 10.0, 90.0, -5.0, 0.0, -10.0, 10.0, 10.0, 10.0, 40.0, -30.0, 0.0, 20.0, 110.0, 50.0, 20.0, 50.0, 270.0, 130.0, 80.0, 40.0, 180.0, 5.0, 60.0, 160.0, 50.0, 25.0, 60.0, 120.0, 290.0, -20.0, 30.0, 90.0, 90.0, 170.0, 40.0, 130.0, 120.0, 60.0, 80.0, 20.0, 20.0, 30.0, 70.0, 70.0, -90.0, 90.0, 30.0, 40.0, 10.0, 40.0, 20.0, 15.0, 30.0, 160.0, 0.0, 40.0, 10.0, 70.0, 20.0, 130.0, 100.0, 150.0, 40.0, 180.0, 0.0, 40.0, 30.0, 170.0, 110.0, 30.0, 170.0, 60.0, 70.0, 70.0, 50.0, 30.0, 40.0, 95.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 100.0, 20.0, 30.0, 100.0, 20.0, 80.0, 15.0, 90.0, 0.0, 40.0, 70.0, 70.0, 10.0, 70.0, 80.0, 70.0, 0.0, 0.0, 0.0, 90.0, 80.0, 40.0, 100.0, 0.0, 20.0, 70.0, 0.0, 40.0, 10.0, 150.0, 100.0, 30.0, 230.0, 380.0, 30.0, 120.0, 20.0, 70.0, 200.0, 40.0, 20.0, 30.0, 0.0, 90.0, 50.0, 40.0, 20.0, 90.0, 40.0, 80.0, 30.0, 460.0, 30.0, 30.0, 120.0, 20.0, 50.0, 90.0, 25.0, 110.0, 60.0, 30.0, 110.0, 70.0, 170.0, 40.0, 10.0, 5.0, 10.0, 20.0, 40.0, 70.0, 50.0, 160.0, 160.0, 30.0, 70.0, 60.0, 30.0, 50.0, -65.0, 10.0, 10.0, 30.0, 10.0, 50.0, 0.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 140.0, 40.0, 60.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, -30.0, 0.0, 250.0, 10.0, 70.0, 160.0, 30.0, 0.0, 10.0, 40.0, 110.0, 30.0, 190.0, 110.0, 0.0, 40.0, 90.0, 30.0, 30.0, 40.0, 30.0, -40.0, 20.0, 20.0, 210.0, 50.0, 80.0, 180.0, 40.0, 90.0, 80.0, 10.0, 70.0, 60.0, 220.0, 70.0, 80.0, 40.0, 20.0, 40.0, 180.0, 80.0, 20.0, 40.0, 30.0, 180.0, 10.0, 20.0, 40.0, 40.0, 10.0, 20.0, 5.0, 0.0, 0.0, 30.0, 30.0, 150.0, 40.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 60.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 10.0, 60.0, 30.0, 60.0, 0.0, 30.0, 10.0, 100.0, 40.0, 10.0, 0.0, 90.0, 190.0, 260.0, 40.0, 30.0, 40.0, 10.0, 40.0, 110.0, 0.0, 30.0, 20.0, 100.0, 10.0, 120.0, 110.0, 100.0, 190.0, 40.0, 80.0, 40.0, 0.0, 30.0, 100.0, 50.0, 110.0, 30.0, 40.0, 80.0, 70.0, 30.0, 40.0, 10.0, 0.0, 10.0, 20.0, 5.0, 0.0, 40.0, 0.0, 40.0, 30.0, 60.0, 90.0, 30.0, 10.0, 70.0, 70.0, 40.0, 40.0, 20.0, 90.0, 170.0, 40.0, 95.0, 30.0, 130.0, 180.0, 60.0, 50.0, 100.0, 10.0, 30.0, 170.0, 10.0, 40.0, 60.0, 50.0, 190.0, 30.0, 10.0, 40.0, 60.0, 170.0, 20.0, 50.0, 85.0, 10.0, 0.0, 10.0, 70.0, 10.0, 70.0, 160.0, 60.0, 50.0, 10.0, 250.0, 70.0, 130.0, 230.0, 20.0, 80.0, 10.0, 50.0, 0.0, 20.0, 70.0, 50.0, -20.0, 180.0, 160.0, -5.0, 50.0, 40.0, -140.0, 100.0, 10.0, 60.0, 190.0, 50.0, 80.0, 30.0, 40.0, 0.0, 40.0, 80.0, 80.0, 10.0, 90.0, 30.0, 170.0, 200.0, 50.0, 20.0, -20.0, 20.0, 100.0, 30.0, 10.0, 50.0, 10.0, 150.0, 70.0, 30.0, 0.0, 20.0, 10.0, 180.0, 10.0, 20.0, 150.0, 160.0, 10.0, 10.0, 100.0, 10.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 70.0, 10.0, 90.0, 50.0, 40.0, 20.0, 80.0, 30.0, 40.0, 40.0, 90.0, 40.0, 40.0, 60.0, 20.0, 80.0, 0.0, 50.0, 40.0, 70.0, 120.0, 20.0, 20.0, 90.0, 30.0, 30.0, 40.0, 10.0, 90.0, 20.0, 10.0, 0.0, 90.0, 20.0, 10.0, 10.0, 10.0, 20.0, 110.0, 120.0, 20.0, 60.0, 220.0, 70.0, -20.0, 30.0, 30.0, 10.0, 160.0, 30.0, 60.0, 15.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 80.0, 40.0, 90.0, 50.0, 30.0, 0.0, 30.0, 0.0, 20.0, 10.0, 80.0, 40.0, 10.0, 35.0, 20.0, 20.0, 20.0, 30.0, 5.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 40.0, 10.0, 20.0, 170.0, 20.0, 10.0, 50.0, 150.0, 110.0, 20.0, 10.0, 370.0, 30.0, 40.0, -70.0, 80.0, 70.0, 50.0, 60.0, 130.0, 170.0, 220.0, 40.0, 60.0, 20.0, 10.0, 470.0, 10.0, 30.0, 20.0, -40.0, 10.0, 10.0, 230.0, -100.0, 80.0, 20.0, 160.0, 60.0, -5.0, 80.0, 10.0, 40.0, 10.0, 40.0, 90.0, 160.0, 30.0, 210.0, 20.0, 30.0, 70.0, 30.0, 100.0, 20.0, 5.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6942597157577632, "mean_inference_ms": 1.455928496862174, "mean_action_processing_ms": 0.44191008419416844, "mean_env_wait_ms": 1.3648314696151953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013808250427246094, "StateBufferConnector_ms": 0.011187076568603516, "ViewRequirementAgentConnector_ms": 0.42203545570373535}, "num_episodes": 18, "episode_return_max": 1200.0, "episode_return_min": 115.0, "episode_return_mean": 590.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.418641237744946, "num_env_steps_trained_throughput_per_sec": 19.418641237744946, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 208700.106, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208700.052, "sample_time_ms": 2749.503, "learn_time_ms": 205929.418, "learn_throughput": 19.424, "synch_weights_time_ms": 11.599}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 28, "trial_id": "aa996_00000", "date": "2024-05-24_00-22-12", "timestamp": 1716524532, "time_this_iter_s": 205.9961609840393, "time_total_s": 5800.2616856098175, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5800.2616856098175, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.614041095890407, "ram_util_percent": 78.44383561643835}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8606517080427867, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.551501432648355, "policy_loss": -0.01113424800781194, "vf_loss": 5.560855115488314, "vf_explained_var": 0.00047970395118664626, "kl": 0.008902821713680877, "entropy": 0.9363597315784714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 267615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 65.0, "episode_reward_mean": 585.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 520.0}, "policy_reward_mean": {"policy_0": 58.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 570.0, 920.0, 395.0, 900.0, 400.0, 1200.0, 620.0, 380.0, 685.0, 930.0, 295.0, 980.0, 445.0, 225.0, 185.0, 540.0, 790.0, 1060.0, 380.0, 365.0, 760.0, 800.0, 455.0, 495.0, 530.0, 650.0, 910.0, 930.0, 645.0, 485.0, 515.0, 270.0, 340.0, 580.0, 560.0, 480.0, 900.0, 710.0, 175.0, 320.0, 420.0, 370.0, 750.0, 810.0, 540.0, 165.0, 460.0, 945.0, 600.0, 515.0, 1040.0, 460.0, 515.0, 480.0, 630.0, 500.0, 500.0, 450.0, 460.0, 470.0, 280.0, 650.0, 525.0, 350.0, 280.0, 340.0, 810.0, 810.0, 770.0, 355.0, 780.0, 115.0, 860.0, 230.0, 660.0, 65.0, 400.0, 580.0, 880.0, 840.0, 810.0, 905.0, 1105.0, 605.0, 300.0, 470.0, 280.0, 510.0, 650.0, 590.0, 920.0, 470.0, 260.0, 360.0, 745.0, 800.0, 980.0, 720.0, 1395.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 10.0, 160.0, 30.0, 5.0, 0.0, 5.0, 20.0, 20.0, 10.0, 60.0, 50.0, 30.0, 80.0, 180.0, 10.0, 100.0, 0.0, 50.0, 0.0, 40.0, 100.0, 270.0, 50.0, 170.0, 30.0, 10.0, 210.0, 40.0, 30.0, 50.0, 10.0, -5.0, 50.0, 30.0, 50.0, 40.0, 60.0, 80.0, 110.0, 0.0, 40.0, 30.0, 30.0, 310.0, 40.0, 0.0, 60.0, 280.0, 70.0, 90.0, 5.0, 50.0, -5.0, 40.0, -10.0, 60.0, 30.0, 70.0, 70.0, 0.0, 40.0, 520.0, 0.0, 30.0, 160.0, 200.0, 180.0, 0.0, 40.0, 30.0, 70.0, 40.0, 40.0, 280.0, 0.0, 30.0, 50.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 180.0, 10.0, 60.0, 40.0, 40.0, 70.0, 35.0, 40.0, 30.0, 50.0, 50.0, 270.0, 20.0, 70.0, 50.0, 110.0, 100.0, 230.0, 190.0, 90.0, 60.0, -20.0, 50.0, 60.0, 60.0, 10.0, 10.0, 0.0, -115.0, 60.0, -30.0, 60.0, 20.0, 180.0, 100.0, 180.0, 170.0, 0.0, 90.0, 160.0, 260.0, 30.0, 30.0, 40.0, 20.0, 40.0, 40.0, 20.0, 50.0, 10.0, 210.0, 20.0, 40.0, 25.0, -10.0, 10.0, -20.0, 20.0, 40.0, 15.0, 20.0, 10.0, 80.0, 30.0, 20.0, 50.0, 0.0, 30.0, 10.0, 90.0, -5.0, 0.0, -10.0, 10.0, 10.0, 10.0, 40.0, -30.0, 0.0, 20.0, 110.0, 50.0, 20.0, 50.0, 270.0, 130.0, 80.0, 40.0, 180.0, 5.0, 60.0, 160.0, 50.0, 25.0, 60.0, 120.0, 290.0, -20.0, 30.0, 90.0, 90.0, 170.0, 40.0, 130.0, 120.0, 60.0, 80.0, 20.0, 20.0, 30.0, 70.0, 70.0, -90.0, 90.0, 30.0, 40.0, 10.0, 40.0, 20.0, 15.0, 30.0, 160.0, 0.0, 40.0, 10.0, 70.0, 20.0, 130.0, 100.0, 150.0, 40.0, 180.0, 0.0, 40.0, 30.0, 170.0, 110.0, 30.0, 170.0, 60.0, 70.0, 70.0, 50.0, 30.0, 40.0, 95.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 100.0, 20.0, 30.0, 100.0, 20.0, 80.0, 15.0, 90.0, 0.0, 40.0, 70.0, 70.0, 10.0, 70.0, 80.0, 70.0, 0.0, 0.0, 0.0, 90.0, 80.0, 40.0, 100.0, 0.0, 20.0, 70.0, 0.0, 40.0, 10.0, 150.0, 100.0, 30.0, 230.0, 380.0, 30.0, 120.0, 20.0, 70.0, 200.0, 40.0, 20.0, 30.0, 0.0, 90.0, 50.0, 40.0, 20.0, 90.0, 40.0, 80.0, 30.0, 460.0, 30.0, 30.0, 120.0, 20.0, 50.0, 90.0, 25.0, 110.0, 60.0, 30.0, 110.0, 70.0, 170.0, 40.0, 10.0, 5.0, 10.0, 20.0, 40.0, 70.0, 50.0, 160.0, 160.0, 30.0, 70.0, 60.0, 30.0, 50.0, -65.0, 10.0, 10.0, 30.0, 10.0, 50.0, 0.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 140.0, 40.0, 60.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, -30.0, 0.0, 250.0, 10.0, 70.0, 160.0, 30.0, 0.0, 10.0, 40.0, 110.0, 30.0, 190.0, 110.0, 0.0, 40.0, 90.0, 30.0, 30.0, 40.0, 30.0, -40.0, 20.0, 20.0, 210.0, 50.0, 80.0, 180.0, 40.0, 90.0, 80.0, 10.0, 70.0, 60.0, 220.0, 70.0, 80.0, 40.0, 20.0, 40.0, 180.0, 80.0, 20.0, 40.0, 30.0, 180.0, 10.0, 20.0, 40.0, 40.0, 10.0, 20.0, 5.0, 0.0, 0.0, 30.0, 30.0, 150.0, 40.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 60.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 10.0, 60.0, 30.0, 60.0, 0.0, 30.0, 10.0, 100.0, 40.0, 10.0, 0.0, 90.0, 190.0, 260.0, 40.0, 30.0, 40.0, 10.0, 40.0, 110.0, 0.0, 30.0, 20.0, 100.0, 10.0, 120.0, 110.0, 100.0, 190.0, 40.0, 80.0, 40.0, 0.0, 30.0, 100.0, 50.0, 110.0, 30.0, 40.0, 80.0, 70.0, 30.0, 40.0, 10.0, 0.0, 10.0, 20.0, 5.0, 0.0, 40.0, 0.0, 40.0, 30.0, 60.0, 90.0, 30.0, 10.0, 70.0, 70.0, 40.0, 40.0, 20.0, 90.0, 170.0, 40.0, 95.0, 30.0, 130.0, 180.0, 60.0, 50.0, 100.0, 10.0, 30.0, 170.0, 10.0, 40.0, 60.0, 50.0, 190.0, 30.0, 10.0, 40.0, 60.0, 170.0, 20.0, 50.0, 85.0, 10.0, 0.0, 10.0, 70.0, 10.0, 70.0, 160.0, 60.0, 50.0, 10.0, 250.0, 70.0, 130.0, 230.0, 20.0, 80.0, 10.0, 50.0, 0.0, 20.0, 70.0, 50.0, -20.0, 180.0, 160.0, -5.0, 50.0, 40.0, -140.0, 100.0, 10.0, 60.0, 190.0, 50.0, 80.0, 30.0, 40.0, 0.0, 40.0, 80.0, 80.0, 10.0, 90.0, 30.0, 170.0, 200.0, 50.0, 20.0, -20.0, 20.0, 100.0, 30.0, 10.0, 50.0, 10.0, 150.0, 70.0, 30.0, 0.0, 20.0, 10.0, 180.0, 10.0, 20.0, 150.0, 160.0, 10.0, 10.0, 100.0, 10.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 70.0, 10.0, 90.0, 50.0, 40.0, 20.0, 80.0, 30.0, 40.0, 40.0, 90.0, 40.0, 40.0, 60.0, 20.0, 80.0, 0.0, 50.0, 40.0, 70.0, 120.0, 20.0, 20.0, 90.0, 30.0, 30.0, 40.0, 10.0, 90.0, 20.0, 10.0, 0.0, 90.0, 20.0, 10.0, 10.0, 10.0, 20.0, 110.0, 120.0, 20.0, 60.0, 220.0, 70.0, -20.0, 30.0, 30.0, 10.0, 160.0, 30.0, 60.0, 15.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 80.0, 40.0, 90.0, 50.0, 30.0, 0.0, 30.0, 0.0, 20.0, 10.0, 80.0, 40.0, 10.0, 35.0, 20.0, 20.0, 20.0, 30.0, 5.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 40.0, 10.0, 20.0, 170.0, 20.0, 10.0, 50.0, 150.0, 110.0, 20.0, 10.0, 370.0, 30.0, 40.0, -70.0, 80.0, 70.0, 50.0, 60.0, 130.0, 170.0, 220.0, 40.0, 60.0, 20.0, 10.0, 470.0, 10.0, 30.0, 20.0, -40.0, 10.0, 10.0, 230.0, -100.0, 80.0, 20.0, 160.0, 60.0, -5.0, 80.0, 10.0, 40.0, 10.0, 40.0, 90.0, 160.0, 30.0, 210.0, 20.0, 30.0, 70.0, 30.0, 100.0, 20.0, 5.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 70.0, 60.0, 60.0, 320.0, 160.0, 30.0, 10.0, 40.0, 80.0, 40.0, 0.0, 30.0, 60.0, 40.0, 20.0, 10.0, 30.0, 0.0, 0.0, 50.0, 80.0, 10.0, 30.0, 170.0, 170.0, 50.0, 20.0, 20.0, 60.0, 20.0, 30.0, 0.0, -60.0, -45.0, 30.0, 40.0, 30.0, 0.0, 20.0, 0.0, 150.0, 20.0, 80.0, 40.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 50.0, 80.0, 80.0, 20.0, 0.0, 30.0, 0.0, 50.0, 230.0, 40.0, 40.0, 0.0, 10.0, 270.0, 40.0, 30.0, 70.0, 0.0, 380.0, 60.0, 40.0, 370.0, 30.0, 40.0, 100.0, 80.0, 0.0, 30.0, 90.0, 60.0, 180.0, 270.0, 40.0, 70.0, 60.0, 20.0, 0.0, 200.0, -90.0, 290.0, 30.0, 180.0, 20.0, 15.0, 160.0, 70.0, 60.0, 40.0, 40.0, 50.0, 35.0, 170.0, 80.0, 310.0, 90.0, 30.0, 0.0, 150.0, 190.0, 190.0, 50.0, 20.0, 10.0, 60.0, 30.0, 0.0, 35.0, 180.0, 30.0, 20.0, 0.0, 20.0, 30.0, 20.0, 50.0, 80.0, 10.0, 50.0, 20.0, 150.0, 60.0, 0.0, 20.0, 40.0, 20.0, 30.0, 20.0, 90.0, 40.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 60.0, 80.0, 0.0, 120.0, 50.0, 30.0, 60.0, 20.0, -10.0, 40.0, 130.0, 170.0, 60.0, 170.0, 20.0, 10.0, 40.0, 100.0, 90.0, 20.0, 80.0, 0.0, 70.0, 100.0, 70.0, 40.0, 20.0, 160.0, 90.0, 110.0, 20.0, 290.0, 30.0, 160.0, 20.0, 0.0, 40.0, 160.0, 50.0, -10.0, 20.0, 30.0, 10.0, 30.0, 0.0, 30.0, 150.0, 10.0, 10.0, 20.0, 100.0, 0.0, 20.0, 10.0, 70.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 20.0, 40.0, 20.0, 110.0, 10.0, 50.0, 90.0, 40.0, 20.0, 5.0, 10.0, 20.0, 40.0, 250.0, 60.0, 210.0, 0.0, 90.0, 30.0, 350.0, 20.0, 70.0, 40.0, 60.0, 70.0, 70.0, 50.0, 100.0, 20.0, 220.0, 120.0, -30.0, 330.0, 90.0, 30.0, 50.0, 10.0, 20.0, 170.0, 170.0, 30.0, 20.0, 150.0, 10.0, 110.0, 30.0, 270.0, 90.0, 370.0, 50.0, 100.0, 25.0, 80.0, 220.0, 150.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6920087694155268, "mean_inference_ms": 1.4569953399383067, "mean_action_processing_ms": 0.45233415191713644, "mean_env_wait_ms": 1.362872328614693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013202905654907227, "StateBufferConnector_ms": 0.010910749435424805, "ViewRequirementAgentConnector_ms": 0.4173915386199951}, "num_episodes": 27, "episode_return_max": 1395.0, "episode_return_min": 65.0, "episode_return_mean": 585.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.045908815497405, "num_env_steps_trained_throughput_per_sec": 19.045908815497405, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 208992.255, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208992.206, "sample_time_ms": 2747.886, "learn_time_ms": 206222.844, "learn_throughput": 19.396, "synch_weights_time_ms": 11.738}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 29, "trial_id": "aa996_00000", "date": "2024-05-24_00-25-42", "timestamp": 1716524742, "time_this_iter_s": 210.0448989868164, "time_total_s": 6010.306584596634, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309845e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6010.306584596634, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 19.604377104377104, "ram_util_percent": 78.92525252525252}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0611011394296592, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.132866631427639, "policy_loss": -0.010730429578754015, "vf_loss": 6.141999079955145, "vf_explained_var": 6.048962458000142e-05, "kl": 0.007989919128238755, "entropy": 0.8997500696502174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 277005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 65.0, "episode_reward_mean": 607.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 470.0}, "policy_reward_mean": {"policy_0": 60.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1060.0, 380.0, 365.0, 760.0, 800.0, 455.0, 495.0, 530.0, 650.0, 910.0, 930.0, 645.0, 485.0, 515.0, 270.0, 340.0, 580.0, 560.0, 480.0, 900.0, 710.0, 175.0, 320.0, 420.0, 370.0, 750.0, 810.0, 540.0, 165.0, 460.0, 945.0, 600.0, 515.0, 1040.0, 460.0, 515.0, 480.0, 630.0, 500.0, 500.0, 450.0, 460.0, 470.0, 280.0, 650.0, 525.0, 350.0, 280.0, 340.0, 810.0, 810.0, 770.0, 355.0, 780.0, 115.0, 860.0, 230.0, 660.0, 65.0, 400.0, 580.0, 880.0, 840.0, 810.0, 905.0, 1105.0, 605.0, 300.0, 470.0, 280.0, 510.0, 650.0, 590.0, 920.0, 470.0, 260.0, 360.0, 745.0, 800.0, 980.0, 720.0, 1395.0, 475.0, 1095.0, 550.0, 850.0, 770.0, 1240.0, 590.0, 710.0, 365.0, 1000.0, 400.0, 620.0, 730.0, 910.0, 220.0, 1030.0, 840.0, 470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 290.0, -20.0, 30.0, 90.0, 90.0, 170.0, 40.0, 130.0, 120.0, 60.0, 80.0, 20.0, 20.0, 30.0, 70.0, 70.0, -90.0, 90.0, 30.0, 40.0, 10.0, 40.0, 20.0, 15.0, 30.0, 160.0, 0.0, 40.0, 10.0, 70.0, 20.0, 130.0, 100.0, 150.0, 40.0, 180.0, 0.0, 40.0, 30.0, 170.0, 110.0, 30.0, 170.0, 60.0, 70.0, 70.0, 50.0, 30.0, 40.0, 95.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 100.0, 20.0, 30.0, 100.0, 20.0, 80.0, 15.0, 90.0, 0.0, 40.0, 70.0, 70.0, 10.0, 70.0, 80.0, 70.0, 0.0, 0.0, 0.0, 90.0, 80.0, 40.0, 100.0, 0.0, 20.0, 70.0, 0.0, 40.0, 10.0, 150.0, 100.0, 30.0, 230.0, 380.0, 30.0, 120.0, 20.0, 70.0, 200.0, 40.0, 20.0, 30.0, 0.0, 90.0, 50.0, 40.0, 20.0, 90.0, 40.0, 80.0, 30.0, 460.0, 30.0, 30.0, 120.0, 20.0, 50.0, 90.0, 25.0, 110.0, 60.0, 30.0, 110.0, 70.0, 170.0, 40.0, 10.0, 5.0, 10.0, 20.0, 40.0, 70.0, 50.0, 160.0, 160.0, 30.0, 70.0, 60.0, 30.0, 50.0, -65.0, 10.0, 10.0, 30.0, 10.0, 50.0, 0.0, 10.0, 40.0, 10.0, 40.0, 30.0, 50.0, 140.0, 40.0, 60.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, -30.0, 0.0, 250.0, 10.0, 70.0, 160.0, 30.0, 0.0, 10.0, 40.0, 110.0, 30.0, 190.0, 110.0, 0.0, 40.0, 90.0, 30.0, 30.0, 40.0, 30.0, -40.0, 20.0, 20.0, 210.0, 50.0, 80.0, 180.0, 40.0, 90.0, 80.0, 10.0, 70.0, 60.0, 220.0, 70.0, 80.0, 40.0, 20.0, 40.0, 180.0, 80.0, 20.0, 40.0, 30.0, 180.0, 10.0, 20.0, 40.0, 40.0, 10.0, 20.0, 5.0, 0.0, 0.0, 30.0, 30.0, 150.0, 40.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 60.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 10.0, 60.0, 30.0, 60.0, 0.0, 30.0, 10.0, 100.0, 40.0, 10.0, 0.0, 90.0, 190.0, 260.0, 40.0, 30.0, 40.0, 10.0, 40.0, 110.0, 0.0, 30.0, 20.0, 100.0, 10.0, 120.0, 110.0, 100.0, 190.0, 40.0, 80.0, 40.0, 0.0, 30.0, 100.0, 50.0, 110.0, 30.0, 40.0, 80.0, 70.0, 30.0, 40.0, 10.0, 0.0, 10.0, 20.0, 5.0, 0.0, 40.0, 0.0, 40.0, 30.0, 60.0, 90.0, 30.0, 10.0, 70.0, 70.0, 40.0, 40.0, 20.0, 90.0, 170.0, 40.0, 95.0, 30.0, 130.0, 180.0, 60.0, 50.0, 100.0, 10.0, 30.0, 170.0, 10.0, 40.0, 60.0, 50.0, 190.0, 30.0, 10.0, 40.0, 60.0, 170.0, 20.0, 50.0, 85.0, 10.0, 0.0, 10.0, 70.0, 10.0, 70.0, 160.0, 60.0, 50.0, 10.0, 250.0, 70.0, 130.0, 230.0, 20.0, 80.0, 10.0, 50.0, 0.0, 20.0, 70.0, 50.0, -20.0, 180.0, 160.0, -5.0, 50.0, 40.0, -140.0, 100.0, 10.0, 60.0, 190.0, 50.0, 80.0, 30.0, 40.0, 0.0, 40.0, 80.0, 80.0, 10.0, 90.0, 30.0, 170.0, 200.0, 50.0, 20.0, -20.0, 20.0, 100.0, 30.0, 10.0, 50.0, 10.0, 150.0, 70.0, 30.0, 0.0, 20.0, 10.0, 180.0, 10.0, 20.0, 150.0, 160.0, 10.0, 10.0, 100.0, 10.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 70.0, 10.0, 90.0, 50.0, 40.0, 20.0, 80.0, 30.0, 40.0, 40.0, 90.0, 40.0, 40.0, 60.0, 20.0, 80.0, 0.0, 50.0, 40.0, 70.0, 120.0, 20.0, 20.0, 90.0, 30.0, 30.0, 40.0, 10.0, 90.0, 20.0, 10.0, 0.0, 90.0, 20.0, 10.0, 10.0, 10.0, 20.0, 110.0, 120.0, 20.0, 60.0, 220.0, 70.0, -20.0, 30.0, 30.0, 10.0, 160.0, 30.0, 60.0, 15.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 80.0, 40.0, 90.0, 50.0, 30.0, 0.0, 30.0, 0.0, 20.0, 10.0, 80.0, 40.0, 10.0, 35.0, 20.0, 20.0, 20.0, 30.0, 5.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 40.0, 10.0, 20.0, 170.0, 20.0, 10.0, 50.0, 150.0, 110.0, 20.0, 10.0, 370.0, 30.0, 40.0, -70.0, 80.0, 70.0, 50.0, 60.0, 130.0, 170.0, 220.0, 40.0, 60.0, 20.0, 10.0, 470.0, 10.0, 30.0, 20.0, -40.0, 10.0, 10.0, 230.0, -100.0, 80.0, 20.0, 160.0, 60.0, -5.0, 80.0, 10.0, 40.0, 10.0, 40.0, 90.0, 160.0, 30.0, 210.0, 20.0, 30.0, 70.0, 30.0, 100.0, 20.0, 5.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 70.0, 60.0, 60.0, 320.0, 160.0, 30.0, 10.0, 40.0, 80.0, 40.0, 0.0, 30.0, 60.0, 40.0, 20.0, 10.0, 30.0, 0.0, 0.0, 50.0, 80.0, 10.0, 30.0, 170.0, 170.0, 50.0, 20.0, 20.0, 60.0, 20.0, 30.0, 0.0, -60.0, -45.0, 30.0, 40.0, 30.0, 0.0, 20.0, 0.0, 150.0, 20.0, 80.0, 40.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 50.0, 80.0, 80.0, 20.0, 0.0, 30.0, 0.0, 50.0, 230.0, 40.0, 40.0, 0.0, 10.0, 270.0, 40.0, 30.0, 70.0, 0.0, 380.0, 60.0, 40.0, 370.0, 30.0, 40.0, 100.0, 80.0, 0.0, 30.0, 90.0, 60.0, 180.0, 270.0, 40.0, 70.0, 60.0, 20.0, 0.0, 200.0, -90.0, 290.0, 30.0, 180.0, 20.0, 15.0, 160.0, 70.0, 60.0, 40.0, 40.0, 50.0, 35.0, 170.0, 80.0, 310.0, 90.0, 30.0, 0.0, 150.0, 190.0, 190.0, 50.0, 20.0, 10.0, 60.0, 30.0, 0.0, 35.0, 180.0, 30.0, 20.0, 0.0, 20.0, 30.0, 20.0, 50.0, 80.0, 10.0, 50.0, 20.0, 150.0, 60.0, 0.0, 20.0, 40.0, 20.0, 30.0, 20.0, 90.0, 40.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 60.0, 80.0, 0.0, 120.0, 50.0, 30.0, 60.0, 20.0, -10.0, 40.0, 130.0, 170.0, 60.0, 170.0, 20.0, 10.0, 40.0, 100.0, 90.0, 20.0, 80.0, 0.0, 70.0, 100.0, 70.0, 40.0, 20.0, 160.0, 90.0, 110.0, 20.0, 290.0, 30.0, 160.0, 20.0, 0.0, 40.0, 160.0, 50.0, -10.0, 20.0, 30.0, 10.0, 30.0, 0.0, 30.0, 150.0, 10.0, 10.0, 20.0, 100.0, 0.0, 20.0, 10.0, 70.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 20.0, 40.0, 20.0, 110.0, 10.0, 50.0, 90.0, 40.0, 20.0, 5.0, 10.0, 20.0, 40.0, 250.0, 60.0, 210.0, 0.0, 90.0, 30.0, 350.0, 20.0, 70.0, 40.0, 60.0, 70.0, 70.0, 50.0, 100.0, 20.0, 220.0, 120.0, -30.0, 330.0, 90.0, 30.0, 50.0, 10.0, 20.0, 170.0, 170.0, 30.0, 20.0, 150.0, 10.0, 110.0, 30.0, 270.0, 90.0, 370.0, 50.0, 100.0, 25.0, 80.0, 220.0, 150.0, 40.0, 35.0, 30.0, 20.0, 150.0, 130.0, 30.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 60.0, 110.0, 135.0, 80.0, 350.0, -10.0, 30.0, 60.0, 90.0, -5.0, 60.0, 10.0, 80.0, 150.0, 70.0, 20.0, -15.0, 90.0, 300.0, 50.0, 0.0, 120.0, 50.0, 70.0, -30.0, 90.0, 100.0, 100.0, 170.0, 300.0, 40.0, 30.0, 50.0, 70.0, 30.0, 50.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 30.0, 240.0, 290.0, 320.0, 70.0, 100.0, 30.0, 20.0, 130.0, -50.0, 90.0, 40.0, 190.0, 30.0, 20.0, 90.0, 70.0, 360.0, 10.0, 170.0, 40.0, 100.0, -160.0, 20.0, 80.0, 20.0, 130.0, 30.0, 30.0, 40.0, 5.0, 60.0, 20.0, 40.0, 0.0, 10.0, 250.0, 160.0, 70.0, 60.0, 40.0, 90.0, 20.0, 60.0, 70.0, 180.0, 0.0, -10.0, 10.0, 60.0, 0.0, 150.0, 40.0, 60.0, 90.0, 0.0, 80.0, 90.0, 70.0, 90.0, 0.0, 30.0, 50.0, 80.0, 70.0, 60.0, 40.0, 20.0, 70.0, 70.0, 160.0, 100.0, 20.0, 40.0, 170.0, 40.0, -5.0, 30.0, 340.0, 20.0, 180.0, 35.0, 50.0, 80.0, 60.0, 120.0, 0.0, 20.0, 40.0, 50.0, 0.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 30.0, 180.0, 190.0, 300.0, 40.0, 10.0, 220.0, 20.0, 20.0, 80.0, 90.0, 0.0, 30.0, 100.0, 130.0, 40.0, 170.0, 190.0, 10.0, 20.0, 20.0, 20.0, 90.0, 80.0, 110.0, 30.0, 70.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6901824961618885, "mean_inference_ms": 1.4576334910881599, "mean_action_processing_ms": 0.4590220221024422, "mean_env_wait_ms": 1.361541723533099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013042926788330078, "StateBufferConnector_ms": 0.010748147964477539, "ViewRequirementAgentConnector_ms": 0.40772104263305664}, "num_episodes": 18, "episode_return_max": 1395.0, "episode_return_min": 65.0, "episode_return_mean": 607.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.26355319886438, "num_env_steps_trained_throughput_per_sec": 19.26355319886438, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 208886.812, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208886.762, "sample_time_ms": 2750.528, "learn_time_ms": 206114.321, "learn_throughput": 19.407, "synch_weights_time_ms": 12.078}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 30, "trial_id": "aa996_00000", "date": "2024-05-24_00-29-10", "timestamp": 1716524950, "time_this_iter_s": 207.65339303016663, "time_total_s": 6217.9599776268005, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d6f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6217.9599776268005, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.624489795918368, "ram_util_percent": 78.9904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2319270587005553, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.530731036640204, "policy_loss": -0.010550352881307474, "vf_loss": 6.539700119589337, "vf_explained_var": 0.0010270533089439709, "kl": 0.007906364442864008, "entropy": 0.8646443981205185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 286395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 65.0, "episode_reward_mean": 640.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 520.0}, "policy_reward_mean": {"policy_0": 64.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.0, 900.0, 710.0, 175.0, 320.0, 420.0, 370.0, 750.0, 810.0, 540.0, 165.0, 460.0, 945.0, 600.0, 515.0, 1040.0, 460.0, 515.0, 480.0, 630.0, 500.0, 500.0, 450.0, 460.0, 470.0, 280.0, 650.0, 525.0, 350.0, 280.0, 340.0, 810.0, 810.0, 770.0, 355.0, 780.0, 115.0, 860.0, 230.0, 660.0, 65.0, 400.0, 580.0, 880.0, 840.0, 810.0, 905.0, 1105.0, 605.0, 300.0, 470.0, 280.0, 510.0, 650.0, 590.0, 920.0, 470.0, 260.0, 360.0, 745.0, 800.0, 980.0, 720.0, 1395.0, 475.0, 1095.0, 550.0, 850.0, 770.0, 1240.0, 590.0, 710.0, 365.0, 1000.0, 400.0, 620.0, 730.0, 910.0, 220.0, 1030.0, 840.0, 470.0, 670.0, 740.0, 190.0, 980.0, 910.0, 790.0, 490.0, 740.0, 690.0, 760.0, 630.0, 805.0, 680.0, 800.0, 890.0, 1160.0, 1360.0, 730.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 30.0, 30.0, 40.0, 30.0, -40.0, 20.0, 20.0, 210.0, 50.0, 80.0, 180.0, 40.0, 90.0, 80.0, 10.0, 70.0, 60.0, 220.0, 70.0, 80.0, 40.0, 20.0, 40.0, 180.0, 80.0, 20.0, 40.0, 30.0, 180.0, 10.0, 20.0, 40.0, 40.0, 10.0, 20.0, 5.0, 0.0, 0.0, 30.0, 30.0, 150.0, 40.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 60.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 10.0, 60.0, 30.0, 60.0, 0.0, 30.0, 10.0, 100.0, 40.0, 10.0, 0.0, 90.0, 190.0, 260.0, 40.0, 30.0, 40.0, 10.0, 40.0, 110.0, 0.0, 30.0, 20.0, 100.0, 10.0, 120.0, 110.0, 100.0, 190.0, 40.0, 80.0, 40.0, 0.0, 30.0, 100.0, 50.0, 110.0, 30.0, 40.0, 80.0, 70.0, 30.0, 40.0, 10.0, 0.0, 10.0, 20.0, 5.0, 0.0, 40.0, 0.0, 40.0, 30.0, 60.0, 90.0, 30.0, 10.0, 70.0, 70.0, 40.0, 40.0, 20.0, 90.0, 170.0, 40.0, 95.0, 30.0, 130.0, 180.0, 60.0, 50.0, 100.0, 10.0, 30.0, 170.0, 10.0, 40.0, 60.0, 50.0, 190.0, 30.0, 10.0, 40.0, 60.0, 170.0, 20.0, 50.0, 85.0, 10.0, 0.0, 10.0, 70.0, 10.0, 70.0, 160.0, 60.0, 50.0, 10.0, 250.0, 70.0, 130.0, 230.0, 20.0, 80.0, 10.0, 50.0, 0.0, 20.0, 70.0, 50.0, -20.0, 180.0, 160.0, -5.0, 50.0, 40.0, -140.0, 100.0, 10.0, 60.0, 190.0, 50.0, 80.0, 30.0, 40.0, 0.0, 40.0, 80.0, 80.0, 10.0, 90.0, 30.0, 170.0, 200.0, 50.0, 20.0, -20.0, 20.0, 100.0, 30.0, 10.0, 50.0, 10.0, 150.0, 70.0, 30.0, 0.0, 20.0, 10.0, 180.0, 10.0, 20.0, 150.0, 160.0, 10.0, 10.0, 100.0, 10.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 70.0, 10.0, 90.0, 50.0, 40.0, 20.0, 80.0, 30.0, 40.0, 40.0, 90.0, 40.0, 40.0, 60.0, 20.0, 80.0, 0.0, 50.0, 40.0, 70.0, 120.0, 20.0, 20.0, 90.0, 30.0, 30.0, 40.0, 10.0, 90.0, 20.0, 10.0, 0.0, 90.0, 20.0, 10.0, 10.0, 10.0, 20.0, 110.0, 120.0, 20.0, 60.0, 220.0, 70.0, -20.0, 30.0, 30.0, 10.0, 160.0, 30.0, 60.0, 15.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 80.0, 40.0, 90.0, 50.0, 30.0, 0.0, 30.0, 0.0, 20.0, 10.0, 80.0, 40.0, 10.0, 35.0, 20.0, 20.0, 20.0, 30.0, 5.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 40.0, 10.0, 20.0, 170.0, 20.0, 10.0, 50.0, 150.0, 110.0, 20.0, 10.0, 370.0, 30.0, 40.0, -70.0, 80.0, 70.0, 50.0, 60.0, 130.0, 170.0, 220.0, 40.0, 60.0, 20.0, 10.0, 470.0, 10.0, 30.0, 20.0, -40.0, 10.0, 10.0, 230.0, -100.0, 80.0, 20.0, 160.0, 60.0, -5.0, 80.0, 10.0, 40.0, 10.0, 40.0, 90.0, 160.0, 30.0, 210.0, 20.0, 30.0, 70.0, 30.0, 100.0, 20.0, 5.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 70.0, 60.0, 60.0, 320.0, 160.0, 30.0, 10.0, 40.0, 80.0, 40.0, 0.0, 30.0, 60.0, 40.0, 20.0, 10.0, 30.0, 0.0, 0.0, 50.0, 80.0, 10.0, 30.0, 170.0, 170.0, 50.0, 20.0, 20.0, 60.0, 20.0, 30.0, 0.0, -60.0, -45.0, 30.0, 40.0, 30.0, 0.0, 20.0, 0.0, 150.0, 20.0, 80.0, 40.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 50.0, 80.0, 80.0, 20.0, 0.0, 30.0, 0.0, 50.0, 230.0, 40.0, 40.0, 0.0, 10.0, 270.0, 40.0, 30.0, 70.0, 0.0, 380.0, 60.0, 40.0, 370.0, 30.0, 40.0, 100.0, 80.0, 0.0, 30.0, 90.0, 60.0, 180.0, 270.0, 40.0, 70.0, 60.0, 20.0, 0.0, 200.0, -90.0, 290.0, 30.0, 180.0, 20.0, 15.0, 160.0, 70.0, 60.0, 40.0, 40.0, 50.0, 35.0, 170.0, 80.0, 310.0, 90.0, 30.0, 0.0, 150.0, 190.0, 190.0, 50.0, 20.0, 10.0, 60.0, 30.0, 0.0, 35.0, 180.0, 30.0, 20.0, 0.0, 20.0, 30.0, 20.0, 50.0, 80.0, 10.0, 50.0, 20.0, 150.0, 60.0, 0.0, 20.0, 40.0, 20.0, 30.0, 20.0, 90.0, 40.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 60.0, 80.0, 0.0, 120.0, 50.0, 30.0, 60.0, 20.0, -10.0, 40.0, 130.0, 170.0, 60.0, 170.0, 20.0, 10.0, 40.0, 100.0, 90.0, 20.0, 80.0, 0.0, 70.0, 100.0, 70.0, 40.0, 20.0, 160.0, 90.0, 110.0, 20.0, 290.0, 30.0, 160.0, 20.0, 0.0, 40.0, 160.0, 50.0, -10.0, 20.0, 30.0, 10.0, 30.0, 0.0, 30.0, 150.0, 10.0, 10.0, 20.0, 100.0, 0.0, 20.0, 10.0, 70.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 20.0, 40.0, 20.0, 110.0, 10.0, 50.0, 90.0, 40.0, 20.0, 5.0, 10.0, 20.0, 40.0, 250.0, 60.0, 210.0, 0.0, 90.0, 30.0, 350.0, 20.0, 70.0, 40.0, 60.0, 70.0, 70.0, 50.0, 100.0, 20.0, 220.0, 120.0, -30.0, 330.0, 90.0, 30.0, 50.0, 10.0, 20.0, 170.0, 170.0, 30.0, 20.0, 150.0, 10.0, 110.0, 30.0, 270.0, 90.0, 370.0, 50.0, 100.0, 25.0, 80.0, 220.0, 150.0, 40.0, 35.0, 30.0, 20.0, 150.0, 130.0, 30.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 60.0, 110.0, 135.0, 80.0, 350.0, -10.0, 30.0, 60.0, 90.0, -5.0, 60.0, 10.0, 80.0, 150.0, 70.0, 20.0, -15.0, 90.0, 300.0, 50.0, 0.0, 120.0, 50.0, 70.0, -30.0, 90.0, 100.0, 100.0, 170.0, 300.0, 40.0, 30.0, 50.0, 70.0, 30.0, 50.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 30.0, 240.0, 290.0, 320.0, 70.0, 100.0, 30.0, 20.0, 130.0, -50.0, 90.0, 40.0, 190.0, 30.0, 20.0, 90.0, 70.0, 360.0, 10.0, 170.0, 40.0, 100.0, -160.0, 20.0, 80.0, 20.0, 130.0, 30.0, 30.0, 40.0, 5.0, 60.0, 20.0, 40.0, 0.0, 10.0, 250.0, 160.0, 70.0, 60.0, 40.0, 90.0, 20.0, 60.0, 70.0, 180.0, 0.0, -10.0, 10.0, 60.0, 0.0, 150.0, 40.0, 60.0, 90.0, 0.0, 80.0, 90.0, 70.0, 90.0, 0.0, 30.0, 50.0, 80.0, 70.0, 60.0, 40.0, 20.0, 70.0, 70.0, 160.0, 100.0, 20.0, 40.0, 170.0, 40.0, -5.0, 30.0, 340.0, 20.0, 180.0, 35.0, 50.0, 80.0, 60.0, 120.0, 0.0, 20.0, 40.0, 50.0, 0.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 30.0, 180.0, 190.0, 300.0, 40.0, 10.0, 220.0, 20.0, 20.0, 80.0, 90.0, 0.0, 30.0, 100.0, 130.0, 40.0, 170.0, 190.0, 10.0, 20.0, 20.0, 20.0, 90.0, 80.0, 110.0, 30.0, 70.0, 10.0, 20.0, 0.0, 30.0, 40.0, 80.0, 80.0, 300.0, 20.0, 40.0, 40.0, 40.0, 300.0, 10.0, 220.0, 40.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 50.0, 0.0, 40.0, 10.0, 30.0, 60.0, 120.0, -10.0, 30.0, 160.0, 100.0, 180.0, 60.0, 50.0, 230.0, 10.0, 80.0, 170.0, 270.0, 140.0, 40.0, 50.0, 60.0, 0.0, 90.0, 70.0, 80.0, 30.0, 30.0, 0.0, 50.0, 190.0, 300.0, 30.0, 10.0, 40.0, 50.0, 30.0, 20.0, 270.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 250.0, 30.0, 80.0, 10.0, 160.0, 80.0, 50.0, 30.0, 20.0, 20.0, 370.0, 70.0, 20.0, 30.0, 20.0, 100.0, 30.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 100.0, 310.0, 80.0, 80.0, 50.0, 10.0, 110.0, 0.0, 210.0, 30.0, 50.0, 40.0, 60.0, 60.0, 30.0, 40.0, 0.0, 25.0, 70.0, 60.0, 110.0, 150.0, 220.0, -10.0, 150.0, 30.0, 60.0, 170.0, 10.0, 0.0, 50.0, 30.0, 70.0, 280.0, 10.0, 0.0, 200.0, 10.0, 40.0, 220.0, 40.0, 30.0, 70.0, 90.0, 40.0, 60.0, 50.0, 140.0, 320.0, 30.0, 170.0, 40.0, 70.0, 40.0, 20.0, 10.0, 40.0, 150.0, 10.0, 100.0, 120.0, 30.0, 50.0, 300.0, 40.0, 320.0, 20.0, 60.0, 170.0, 100.0, 80.0, 170.0, 70.0, 50.0, 520.0, 120.0, 10.0, 70.0, 180.0, 80.0, 60.0, 210.0, 0.0, 20.0, 10.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6894029311677587, "mean_inference_ms": 1.4586473657627992, "mean_action_processing_ms": 0.45768204189824047, "mean_env_wait_ms": 1.3605819770072167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012816667556762695, "StateBufferConnector_ms": 0.010489463806152344, "ViewRequirementAgentConnector_ms": 0.4023261070251465}, "num_episodes": 18, "episode_return_max": 1395.0, "episode_return_min": 65.0, "episode_return_mean": 640.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.263634019686233, "num_env_steps_trained_throughput_per_sec": 19.263634019686233, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 208834.069, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208834.022, "sample_time_ms": 2793.945, "learn_time_ms": 206018.317, "learn_throughput": 19.416, "synch_weights_time_ms": 12.021}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 31, "trial_id": "aa996_00000", "date": "2024-05-24_00-32-38", "timestamp": 1716525158, "time_this_iter_s": 207.65514183044434, "time_total_s": 6425.615119457245, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x330984d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6425.615119457245, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.335836177474402, "ram_util_percent": 78.80784982935153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.245362603975434, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.676889715001733, "policy_loss": -0.009639499195047016, "vf_loss": 5.685095595094723, "vf_explained_var": 0.00334739632372912, "kl": 0.007168089483465094, "entropy": 0.8707507384788241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 65.0, "episode_reward_mean": 660.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 520.0}, "policy_reward_mean": {"policy_0": 66.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.0, 630.0, 500.0, 500.0, 450.0, 460.0, 470.0, 280.0, 650.0, 525.0, 350.0, 280.0, 340.0, 810.0, 810.0, 770.0, 355.0, 780.0, 115.0, 860.0, 230.0, 660.0, 65.0, 400.0, 580.0, 880.0, 840.0, 810.0, 905.0, 1105.0, 605.0, 300.0, 470.0, 280.0, 510.0, 650.0, 590.0, 920.0, 470.0, 260.0, 360.0, 745.0, 800.0, 980.0, 720.0, 1395.0, 475.0, 1095.0, 550.0, 850.0, 770.0, 1240.0, 590.0, 710.0, 365.0, 1000.0, 400.0, 620.0, 730.0, 910.0, 220.0, 1030.0, 840.0, 470.0, 670.0, 740.0, 190.0, 980.0, 910.0, 790.0, 490.0, 740.0, 690.0, 760.0, 630.0, 805.0, 680.0, 800.0, 890.0, 1160.0, 1360.0, 730.0, 700.0, 780.0, 730.0, 1370.0, 560.0, 795.0, 450.0, 495.0, 640.0, 510.0, 960.0, 820.0, 540.0, 815.0, 525.0, 345.0, 325.0, 885.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 30.0, 40.0, 0.0, 40.0, 80.0, 80.0, 10.0, 90.0, 30.0, 170.0, 200.0, 50.0, 20.0, -20.0, 20.0, 100.0, 30.0, 10.0, 50.0, 10.0, 150.0, 70.0, 30.0, 0.0, 20.0, 10.0, 180.0, 10.0, 20.0, 150.0, 160.0, 10.0, 10.0, 100.0, 10.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 70.0, 10.0, 90.0, 50.0, 40.0, 20.0, 80.0, 30.0, 40.0, 40.0, 90.0, 40.0, 40.0, 60.0, 20.0, 80.0, 0.0, 50.0, 40.0, 70.0, 120.0, 20.0, 20.0, 90.0, 30.0, 30.0, 40.0, 10.0, 90.0, 20.0, 10.0, 0.0, 90.0, 20.0, 10.0, 10.0, 10.0, 20.0, 110.0, 120.0, 20.0, 60.0, 220.0, 70.0, -20.0, 30.0, 30.0, 10.0, 160.0, 30.0, 60.0, 15.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 80.0, 40.0, 90.0, 50.0, 30.0, 0.0, 30.0, 0.0, 20.0, 10.0, 80.0, 40.0, 10.0, 35.0, 20.0, 20.0, 20.0, 30.0, 5.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 40.0, 10.0, 20.0, 170.0, 20.0, 10.0, 50.0, 150.0, 110.0, 20.0, 10.0, 370.0, 30.0, 40.0, -70.0, 80.0, 70.0, 50.0, 60.0, 130.0, 170.0, 220.0, 40.0, 60.0, 20.0, 10.0, 470.0, 10.0, 30.0, 20.0, -40.0, 10.0, 10.0, 230.0, -100.0, 80.0, 20.0, 160.0, 60.0, -5.0, 80.0, 10.0, 40.0, 10.0, 40.0, 90.0, 160.0, 30.0, 210.0, 20.0, 30.0, 70.0, 30.0, 100.0, 20.0, 5.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 70.0, 60.0, 60.0, 320.0, 160.0, 30.0, 10.0, 40.0, 80.0, 40.0, 0.0, 30.0, 60.0, 40.0, 20.0, 10.0, 30.0, 0.0, 0.0, 50.0, 80.0, 10.0, 30.0, 170.0, 170.0, 50.0, 20.0, 20.0, 60.0, 20.0, 30.0, 0.0, -60.0, -45.0, 30.0, 40.0, 30.0, 0.0, 20.0, 0.0, 150.0, 20.0, 80.0, 40.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 50.0, 80.0, 80.0, 20.0, 0.0, 30.0, 0.0, 50.0, 230.0, 40.0, 40.0, 0.0, 10.0, 270.0, 40.0, 30.0, 70.0, 0.0, 380.0, 60.0, 40.0, 370.0, 30.0, 40.0, 100.0, 80.0, 0.0, 30.0, 90.0, 60.0, 180.0, 270.0, 40.0, 70.0, 60.0, 20.0, 0.0, 200.0, -90.0, 290.0, 30.0, 180.0, 20.0, 15.0, 160.0, 70.0, 60.0, 40.0, 40.0, 50.0, 35.0, 170.0, 80.0, 310.0, 90.0, 30.0, 0.0, 150.0, 190.0, 190.0, 50.0, 20.0, 10.0, 60.0, 30.0, 0.0, 35.0, 180.0, 30.0, 20.0, 0.0, 20.0, 30.0, 20.0, 50.0, 80.0, 10.0, 50.0, 20.0, 150.0, 60.0, 0.0, 20.0, 40.0, 20.0, 30.0, 20.0, 90.0, 40.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 60.0, 80.0, 0.0, 120.0, 50.0, 30.0, 60.0, 20.0, -10.0, 40.0, 130.0, 170.0, 60.0, 170.0, 20.0, 10.0, 40.0, 100.0, 90.0, 20.0, 80.0, 0.0, 70.0, 100.0, 70.0, 40.0, 20.0, 160.0, 90.0, 110.0, 20.0, 290.0, 30.0, 160.0, 20.0, 0.0, 40.0, 160.0, 50.0, -10.0, 20.0, 30.0, 10.0, 30.0, 0.0, 30.0, 150.0, 10.0, 10.0, 20.0, 100.0, 0.0, 20.0, 10.0, 70.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 20.0, 40.0, 20.0, 110.0, 10.0, 50.0, 90.0, 40.0, 20.0, 5.0, 10.0, 20.0, 40.0, 250.0, 60.0, 210.0, 0.0, 90.0, 30.0, 350.0, 20.0, 70.0, 40.0, 60.0, 70.0, 70.0, 50.0, 100.0, 20.0, 220.0, 120.0, -30.0, 330.0, 90.0, 30.0, 50.0, 10.0, 20.0, 170.0, 170.0, 30.0, 20.0, 150.0, 10.0, 110.0, 30.0, 270.0, 90.0, 370.0, 50.0, 100.0, 25.0, 80.0, 220.0, 150.0, 40.0, 35.0, 30.0, 20.0, 150.0, 130.0, 30.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 60.0, 110.0, 135.0, 80.0, 350.0, -10.0, 30.0, 60.0, 90.0, -5.0, 60.0, 10.0, 80.0, 150.0, 70.0, 20.0, -15.0, 90.0, 300.0, 50.0, 0.0, 120.0, 50.0, 70.0, -30.0, 90.0, 100.0, 100.0, 170.0, 300.0, 40.0, 30.0, 50.0, 70.0, 30.0, 50.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 30.0, 240.0, 290.0, 320.0, 70.0, 100.0, 30.0, 20.0, 130.0, -50.0, 90.0, 40.0, 190.0, 30.0, 20.0, 90.0, 70.0, 360.0, 10.0, 170.0, 40.0, 100.0, -160.0, 20.0, 80.0, 20.0, 130.0, 30.0, 30.0, 40.0, 5.0, 60.0, 20.0, 40.0, 0.0, 10.0, 250.0, 160.0, 70.0, 60.0, 40.0, 90.0, 20.0, 60.0, 70.0, 180.0, 0.0, -10.0, 10.0, 60.0, 0.0, 150.0, 40.0, 60.0, 90.0, 0.0, 80.0, 90.0, 70.0, 90.0, 0.0, 30.0, 50.0, 80.0, 70.0, 60.0, 40.0, 20.0, 70.0, 70.0, 160.0, 100.0, 20.0, 40.0, 170.0, 40.0, -5.0, 30.0, 340.0, 20.0, 180.0, 35.0, 50.0, 80.0, 60.0, 120.0, 0.0, 20.0, 40.0, 50.0, 0.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 30.0, 180.0, 190.0, 300.0, 40.0, 10.0, 220.0, 20.0, 20.0, 80.0, 90.0, 0.0, 30.0, 100.0, 130.0, 40.0, 170.0, 190.0, 10.0, 20.0, 20.0, 20.0, 90.0, 80.0, 110.0, 30.0, 70.0, 10.0, 20.0, 0.0, 30.0, 40.0, 80.0, 80.0, 300.0, 20.0, 40.0, 40.0, 40.0, 300.0, 10.0, 220.0, 40.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 50.0, 0.0, 40.0, 10.0, 30.0, 60.0, 120.0, -10.0, 30.0, 160.0, 100.0, 180.0, 60.0, 50.0, 230.0, 10.0, 80.0, 170.0, 270.0, 140.0, 40.0, 50.0, 60.0, 0.0, 90.0, 70.0, 80.0, 30.0, 30.0, 0.0, 50.0, 190.0, 300.0, 30.0, 10.0, 40.0, 50.0, 30.0, 20.0, 270.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 250.0, 30.0, 80.0, 10.0, 160.0, 80.0, 50.0, 30.0, 20.0, 20.0, 370.0, 70.0, 20.0, 30.0, 20.0, 100.0, 30.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 100.0, 310.0, 80.0, 80.0, 50.0, 10.0, 110.0, 0.0, 210.0, 30.0, 50.0, 40.0, 60.0, 60.0, 30.0, 40.0, 0.0, 25.0, 70.0, 60.0, 110.0, 150.0, 220.0, -10.0, 150.0, 30.0, 60.0, 170.0, 10.0, 0.0, 50.0, 30.0, 70.0, 280.0, 10.0, 0.0, 200.0, 10.0, 40.0, 220.0, 40.0, 30.0, 70.0, 90.0, 40.0, 60.0, 50.0, 140.0, 320.0, 30.0, 170.0, 40.0, 70.0, 40.0, 20.0, 10.0, 40.0, 150.0, 10.0, 100.0, 120.0, 30.0, 50.0, 300.0, 40.0, 320.0, 20.0, 60.0, 170.0, 100.0, 80.0, 170.0, 70.0, 50.0, 520.0, 120.0, 10.0, 70.0, 180.0, 80.0, 60.0, 210.0, 0.0, 20.0, 10.0, 90.0, 290.0, 20.0, 40.0, 40.0, 0.0, 170.0, 60.0, 10.0, 30.0, 40.0, 70.0, 20.0, 70.0, 40.0, 180.0, 190.0, 30.0, 150.0, 0.0, 30.0, 70.0, 50.0, 180.0, 170.0, 50.0, 30.0, 0.0, 100.0, 60.0, 20.0, 130.0, 370.0, 120.0, 20.0, 30.0, 230.0, 240.0, 80.0, 90.0, 60.0, 10.0, 250.0, 40.0, 10.0, 0.0, 70.0, 100.0, 30.0, 10.0, 40.0, 50.0, 10.0, 390.0, 60.0, 30.0, 30.0, 50.0, 80.0, 25.0, 70.0, 60.0, 20.0, 100.0, 30.0, 10.0, 100.0, 30.0, -10.0, 80.0, 30.0, 0.0, 10.0, 150.0, 90.0, 20.0, 40.0, 25.0, 30.0, 10.0, 120.0, 10.0, 210.0, 0.0, 20.0, 40.0, 50.0, 70.0, 30.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 90.0, 260.0, 30.0, 10.0, 30.0, 20.0, 70.0, 240.0, 70.0, 20.0, 190.0, 80.0, 160.0, 100.0, 20.0, 10.0, 50.0, 90.0, 90.0, 30.0, 120.0, 30.0, 180.0, 0.0, 60.0, 170.0, 30.0, 50.0, 80.0, 70.0, 70.0, 10.0, 170.0, 10.0, 40.0, 10.0, 30.0, 50.0, 40.0, 20.0, 270.0, 20.0, 45.0, 0.0, 190.0, 150.0, 30.0, 20.0, 10.0, 15.0, 40.0, 60.0, 180.0, 80.0, 20.0, 70.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 10.0, 70.0, 165.0, 30.0, 50.0, 30.0, 40.0, -40.0, 10.0, -75.0, 50.0, 140.0, 160.0, -40.0, 60.0, 70.0, 60.0, 180.0, 160.0, 110.0, -5.0, 80.0, 150.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6905654819735978, "mean_inference_ms": 1.4603663997422074, "mean_action_processing_ms": 0.45615375367925665, "mean_env_wait_ms": 1.3598970068993004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012840509414672852, "StateBufferConnector_ms": 0.010005712509155273, "ViewRequirementAgentConnector_ms": 0.4067075252532959}, "num_episodes": 18, "episode_return_max": 1395.0, "episode_return_min": 65.0, "episode_return_mean": 660.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.12749501432876, "num_env_steps_trained_throughput_per_sec": 19.12749501432876, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 208923.967, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208923.92, "sample_time_ms": 2788.578, "learn_time_ms": 206113.716, "learn_throughput": 19.407, "synch_weights_time_ms": 11.975}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 32, "trial_id": "aa996_00000", "date": "2024-05-24_00-36-07", "timestamp": 1716525367, "time_this_iter_s": 209.13943815231323, "time_total_s": 6634.754557609558, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ff160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6634.754557609558, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 19.23006756756757, "ram_util_percent": 78.60270270270271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.365643175938132, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6006089625901945, "policy_loss": -0.010256626952540713, "vf_loss": 6.609283275370654, "vf_explained_var": 0.0006288285643909686, "kl": 0.007911610547088166, "entropy": 0.796503325703299, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 305175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 65.0, "episode_reward_mean": 715.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 520.0}, "policy_reward_mean": {"policy_0": 71.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 400.0, 580.0, 880.0, 840.0, 810.0, 905.0, 1105.0, 605.0, 300.0, 470.0, 280.0, 510.0, 650.0, 590.0, 920.0, 470.0, 260.0, 360.0, 745.0, 800.0, 980.0, 720.0, 1395.0, 475.0, 1095.0, 550.0, 850.0, 770.0, 1240.0, 590.0, 710.0, 365.0, 1000.0, 400.0, 620.0, 730.0, 910.0, 220.0, 1030.0, 840.0, 470.0, 670.0, 740.0, 190.0, 980.0, 910.0, 790.0, 490.0, 740.0, 690.0, 760.0, 630.0, 805.0, 680.0, 800.0, 890.0, 1160.0, 1360.0, 730.0, 700.0, 780.0, 730.0, 1370.0, 560.0, 795.0, 450.0, 495.0, 640.0, 510.0, 960.0, 820.0, 540.0, 815.0, 525.0, 345.0, 325.0, 885.0, 495.0, 930.0, 1200.0, 285.0, 1390.0, 1015.0, 135.0, 1000.0, 1145.0, 810.0, 460.0, 360.0, 220.0, 860.0, 1110.0, 370.0, 630.0, 780.0, 770.0, 880.0, 915.0, 1070.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 0.0, -60.0, -45.0, 30.0, 40.0, 30.0, 0.0, 20.0, 0.0, 150.0, 20.0, 80.0, 40.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 50.0, 80.0, 80.0, 20.0, 0.0, 30.0, 0.0, 50.0, 230.0, 40.0, 40.0, 0.0, 10.0, 270.0, 40.0, 30.0, 70.0, 0.0, 380.0, 60.0, 40.0, 370.0, 30.0, 40.0, 100.0, 80.0, 0.0, 30.0, 90.0, 60.0, 180.0, 270.0, 40.0, 70.0, 60.0, 20.0, 0.0, 200.0, -90.0, 290.0, 30.0, 180.0, 20.0, 15.0, 160.0, 70.0, 60.0, 40.0, 40.0, 50.0, 35.0, 170.0, 80.0, 310.0, 90.0, 30.0, 0.0, 150.0, 190.0, 190.0, 50.0, 20.0, 10.0, 60.0, 30.0, 0.0, 35.0, 180.0, 30.0, 20.0, 0.0, 20.0, 30.0, 20.0, 50.0, 80.0, 10.0, 50.0, 20.0, 150.0, 60.0, 0.0, 20.0, 40.0, 20.0, 30.0, 20.0, 90.0, 40.0, 10.0, 40.0, 40.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 60.0, 80.0, 0.0, 120.0, 50.0, 30.0, 60.0, 20.0, -10.0, 40.0, 130.0, 170.0, 60.0, 170.0, 20.0, 10.0, 40.0, 100.0, 90.0, 20.0, 80.0, 0.0, 70.0, 100.0, 70.0, 40.0, 20.0, 160.0, 90.0, 110.0, 20.0, 290.0, 30.0, 160.0, 20.0, 0.0, 40.0, 160.0, 50.0, -10.0, 20.0, 30.0, 10.0, 30.0, 0.0, 30.0, 150.0, 10.0, 10.0, 20.0, 100.0, 0.0, 20.0, 10.0, 70.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 20.0, 40.0, 20.0, 110.0, 10.0, 50.0, 90.0, 40.0, 20.0, 5.0, 10.0, 20.0, 40.0, 250.0, 60.0, 210.0, 0.0, 90.0, 30.0, 350.0, 20.0, 70.0, 40.0, 60.0, 70.0, 70.0, 50.0, 100.0, 20.0, 220.0, 120.0, -30.0, 330.0, 90.0, 30.0, 50.0, 10.0, 20.0, 170.0, 170.0, 30.0, 20.0, 150.0, 10.0, 110.0, 30.0, 270.0, 90.0, 370.0, 50.0, 100.0, 25.0, 80.0, 220.0, 150.0, 40.0, 35.0, 30.0, 20.0, 150.0, 130.0, 30.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 60.0, 110.0, 135.0, 80.0, 350.0, -10.0, 30.0, 60.0, 90.0, -5.0, 60.0, 10.0, 80.0, 150.0, 70.0, 20.0, -15.0, 90.0, 300.0, 50.0, 0.0, 120.0, 50.0, 70.0, -30.0, 90.0, 100.0, 100.0, 170.0, 300.0, 40.0, 30.0, 50.0, 70.0, 30.0, 50.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 30.0, 240.0, 290.0, 320.0, 70.0, 100.0, 30.0, 20.0, 130.0, -50.0, 90.0, 40.0, 190.0, 30.0, 20.0, 90.0, 70.0, 360.0, 10.0, 170.0, 40.0, 100.0, -160.0, 20.0, 80.0, 20.0, 130.0, 30.0, 30.0, 40.0, 5.0, 60.0, 20.0, 40.0, 0.0, 10.0, 250.0, 160.0, 70.0, 60.0, 40.0, 90.0, 20.0, 60.0, 70.0, 180.0, 0.0, -10.0, 10.0, 60.0, 0.0, 150.0, 40.0, 60.0, 90.0, 0.0, 80.0, 90.0, 70.0, 90.0, 0.0, 30.0, 50.0, 80.0, 70.0, 60.0, 40.0, 20.0, 70.0, 70.0, 160.0, 100.0, 20.0, 40.0, 170.0, 40.0, -5.0, 30.0, 340.0, 20.0, 180.0, 35.0, 50.0, 80.0, 60.0, 120.0, 0.0, 20.0, 40.0, 50.0, 0.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 30.0, 180.0, 190.0, 300.0, 40.0, 10.0, 220.0, 20.0, 20.0, 80.0, 90.0, 0.0, 30.0, 100.0, 130.0, 40.0, 170.0, 190.0, 10.0, 20.0, 20.0, 20.0, 90.0, 80.0, 110.0, 30.0, 70.0, 10.0, 20.0, 0.0, 30.0, 40.0, 80.0, 80.0, 300.0, 20.0, 40.0, 40.0, 40.0, 300.0, 10.0, 220.0, 40.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 50.0, 0.0, 40.0, 10.0, 30.0, 60.0, 120.0, -10.0, 30.0, 160.0, 100.0, 180.0, 60.0, 50.0, 230.0, 10.0, 80.0, 170.0, 270.0, 140.0, 40.0, 50.0, 60.0, 0.0, 90.0, 70.0, 80.0, 30.0, 30.0, 0.0, 50.0, 190.0, 300.0, 30.0, 10.0, 40.0, 50.0, 30.0, 20.0, 270.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 250.0, 30.0, 80.0, 10.0, 160.0, 80.0, 50.0, 30.0, 20.0, 20.0, 370.0, 70.0, 20.0, 30.0, 20.0, 100.0, 30.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 100.0, 310.0, 80.0, 80.0, 50.0, 10.0, 110.0, 0.0, 210.0, 30.0, 50.0, 40.0, 60.0, 60.0, 30.0, 40.0, 0.0, 25.0, 70.0, 60.0, 110.0, 150.0, 220.0, -10.0, 150.0, 30.0, 60.0, 170.0, 10.0, 0.0, 50.0, 30.0, 70.0, 280.0, 10.0, 0.0, 200.0, 10.0, 40.0, 220.0, 40.0, 30.0, 70.0, 90.0, 40.0, 60.0, 50.0, 140.0, 320.0, 30.0, 170.0, 40.0, 70.0, 40.0, 20.0, 10.0, 40.0, 150.0, 10.0, 100.0, 120.0, 30.0, 50.0, 300.0, 40.0, 320.0, 20.0, 60.0, 170.0, 100.0, 80.0, 170.0, 70.0, 50.0, 520.0, 120.0, 10.0, 70.0, 180.0, 80.0, 60.0, 210.0, 0.0, 20.0, 10.0, 90.0, 290.0, 20.0, 40.0, 40.0, 0.0, 170.0, 60.0, 10.0, 30.0, 40.0, 70.0, 20.0, 70.0, 40.0, 180.0, 190.0, 30.0, 150.0, 0.0, 30.0, 70.0, 50.0, 180.0, 170.0, 50.0, 30.0, 0.0, 100.0, 60.0, 20.0, 130.0, 370.0, 120.0, 20.0, 30.0, 230.0, 240.0, 80.0, 90.0, 60.0, 10.0, 250.0, 40.0, 10.0, 0.0, 70.0, 100.0, 30.0, 10.0, 40.0, 50.0, 10.0, 390.0, 60.0, 30.0, 30.0, 50.0, 80.0, 25.0, 70.0, 60.0, 20.0, 100.0, 30.0, 10.0, 100.0, 30.0, -10.0, 80.0, 30.0, 0.0, 10.0, 150.0, 90.0, 20.0, 40.0, 25.0, 30.0, 10.0, 120.0, 10.0, 210.0, 0.0, 20.0, 40.0, 50.0, 70.0, 30.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 90.0, 260.0, 30.0, 10.0, 30.0, 20.0, 70.0, 240.0, 70.0, 20.0, 190.0, 80.0, 160.0, 100.0, 20.0, 10.0, 50.0, 90.0, 90.0, 30.0, 120.0, 30.0, 180.0, 0.0, 60.0, 170.0, 30.0, 50.0, 80.0, 70.0, 70.0, 10.0, 170.0, 10.0, 40.0, 10.0, 30.0, 50.0, 40.0, 20.0, 270.0, 20.0, 45.0, 0.0, 190.0, 150.0, 30.0, 20.0, 10.0, 15.0, 40.0, 60.0, 180.0, 80.0, 20.0, 70.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 10.0, 70.0, 165.0, 30.0, 50.0, 30.0, 40.0, -40.0, 10.0, -75.0, 50.0, 140.0, 160.0, -40.0, 60.0, 70.0, 60.0, 180.0, 160.0, 110.0, -5.0, 80.0, 150.0, 20.0, 200.0, 0.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 30.0, 90.0, 180.0, 80.0, 160.0, 70.0, 10.0, 60.0, 150.0, 80.0, 70.0, 70.0, 130.0, 70.0, 140.0, 90.0, 60.0, 180.0, 30.0, 80.0, 110.0, 310.0, 40.0, 70.0, 0.0, 30.0, 180.0, 5.0, 70.0, 100.0, -270.0, 60.0, 70.0, 340.0, 130.0, 220.0, 60.0, 100.0, 50.0, 80.0, 250.0, 90.0, 190.0, 0.0, 505.0, 0.0, 20.0, 50.0, 20.0, 110.0, 20.0, 100.0, 10.0, 30.0, -30.0, 0.0, 5.0, 10.0, 50.0, 20.0, 40.0, 0.0, 100.0, -30.0, 40.0, 30.0, 20.0, 190.0, 0.0, 110.0, 460.0, 80.0, 120.0, 190.0, 40.0, 10.0, 120.0, 60.0, 350.0, 70.0, 120.0, 65.0, 10.0, 30.0, 170.0, 40.0, 260.0, 90.0, 50.0, 40.0, 60.0, 60.0, 100.0, 20.0, 40.0, 30.0, 100.0, 50.0, 60.0, 10.0, 30.0, 20.0, 30.0, 130.0, 0.0, 40.0, 20.0, 20.0, 30.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 60.0, 20.0, 40.0, 20.0, 0.0, 0.0, 90.0, 20.0, 30.0, 190.0, 40.0, 280.0, 100.0, 30.0, 50.0, 30.0, 60.0, 140.0, 130.0, 200.0, 250.0, 30.0, 30.0, 130.0, 50.0, 90.0, 60.0, 60.0, 30.0, 30.0, 0.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 0.0, 70.0, 70.0, 300.0, 50.0, 20.0, 30.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 380.0, 120.0, 20.0, 30.0, 20.0, 10.0, 120.0, 40.0, 10.0, 510.0, 10.0, 20.0, 30.0, 0.0, 60.0, -30.0, -20.0, 10.0, 100.0, 90.0, 90.0, 470.0, -30.0, 10.0, 80.0, 80.0, 100.0, 10.0, 110.0, 170.0, 170.0, 160.0, 85.0, 60.0, 30.0, 20.0, 80.0, 40.0, 30.0, 140.0, 90.0, 170.0, 110.0, 200.0, 90.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6930493497539294, "mean_inference_ms": 1.4639401599962105, "mean_action_processing_ms": 0.4547287746319854, "mean_env_wait_ms": 1.3581191732697175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013098716735839844, "StateBufferConnector_ms": 0.010024785995483398, "ViewRequirementAgentConnector_ms": 0.41371655464172363}, "num_episodes": 22, "episode_return_max": 1395.0, "episode_return_min": 65.0, "episode_return_mean": 715.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.909174289661195, "num_env_steps_trained_throughput_per_sec": 18.909174289661195, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 209194.606, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209194.563, "sample_time_ms": 2779.44, "learn_time_ms": 206393.421, "learn_throughput": 19.38, "synch_weights_time_ms": 12.088}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 33, "trial_id": "aa996_00000", "date": "2024-05-24_00-39-38", "timestamp": 1716525578, "time_this_iter_s": 211.5480351448059, "time_total_s": 6846.302592754364, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x33098c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6846.302592754364, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 22.229765886287627, "ram_util_percent": 79.34581939799331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0676951568347577, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.541834969413928, "policy_loss": -0.01027745019496469, "vf_loss": 6.550641036922305, "vf_explained_var": 0.0004992235582857468, "kl": 0.007356930344869535, "entropy": 0.7649259059319988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 314565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 135.0, "episode_reward_mean": 758.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 75.885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1395.0, 475.0, 1095.0, 550.0, 850.0, 770.0, 1240.0, 590.0, 710.0, 365.0, 1000.0, 400.0, 620.0, 730.0, 910.0, 220.0, 1030.0, 840.0, 470.0, 670.0, 740.0, 190.0, 980.0, 910.0, 790.0, 490.0, 740.0, 690.0, 760.0, 630.0, 805.0, 680.0, 800.0, 890.0, 1160.0, 1360.0, 730.0, 700.0, 780.0, 730.0, 1370.0, 560.0, 795.0, 450.0, 495.0, 640.0, 510.0, 960.0, 820.0, 540.0, 815.0, 525.0, 345.0, 325.0, 885.0, 495.0, 930.0, 1200.0, 285.0, 1390.0, 1015.0, 135.0, 1000.0, 1145.0, 810.0, 460.0, 360.0, 220.0, 860.0, 1110.0, 370.0, 630.0, 780.0, 770.0, 880.0, 915.0, 1070.0, 315.0, 1015.0, 590.0, 1160.0, 720.0, 870.0, 960.0, 1310.0, 740.0, 760.0, 1015.0, 830.0, 490.0, 920.0, 860.0, 345.0, 490.0, 1110.0, 695.0, 460.0, 750.0, 800.0, 1330.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [270.0, 90.0, 370.0, 50.0, 100.0, 25.0, 80.0, 220.0, 150.0, 40.0, 35.0, 30.0, 20.0, 150.0, 130.0, 30.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 60.0, 110.0, 135.0, 80.0, 350.0, -10.0, 30.0, 60.0, 90.0, -5.0, 60.0, 10.0, 80.0, 150.0, 70.0, 20.0, -15.0, 90.0, 300.0, 50.0, 0.0, 120.0, 50.0, 70.0, -30.0, 90.0, 100.0, 100.0, 170.0, 300.0, 40.0, 30.0, 50.0, 70.0, 30.0, 50.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 30.0, 240.0, 290.0, 320.0, 70.0, 100.0, 30.0, 20.0, 130.0, -50.0, 90.0, 40.0, 190.0, 30.0, 20.0, 90.0, 70.0, 360.0, 10.0, 170.0, 40.0, 100.0, -160.0, 20.0, 80.0, 20.0, 130.0, 30.0, 30.0, 40.0, 5.0, 60.0, 20.0, 40.0, 0.0, 10.0, 250.0, 160.0, 70.0, 60.0, 40.0, 90.0, 20.0, 60.0, 70.0, 180.0, 0.0, -10.0, 10.0, 60.0, 0.0, 150.0, 40.0, 60.0, 90.0, 0.0, 80.0, 90.0, 70.0, 90.0, 0.0, 30.0, 50.0, 80.0, 70.0, 60.0, 40.0, 20.0, 70.0, 70.0, 160.0, 100.0, 20.0, 40.0, 170.0, 40.0, -5.0, 30.0, 340.0, 20.0, 180.0, 35.0, 50.0, 80.0, 60.0, 120.0, 0.0, 20.0, 40.0, 50.0, 0.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 30.0, 180.0, 190.0, 300.0, 40.0, 10.0, 220.0, 20.0, 20.0, 80.0, 90.0, 0.0, 30.0, 100.0, 130.0, 40.0, 170.0, 190.0, 10.0, 20.0, 20.0, 20.0, 90.0, 80.0, 110.0, 30.0, 70.0, 10.0, 20.0, 0.0, 30.0, 40.0, 80.0, 80.0, 300.0, 20.0, 40.0, 40.0, 40.0, 300.0, 10.0, 220.0, 40.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 50.0, 0.0, 40.0, 10.0, 30.0, 60.0, 120.0, -10.0, 30.0, 160.0, 100.0, 180.0, 60.0, 50.0, 230.0, 10.0, 80.0, 170.0, 270.0, 140.0, 40.0, 50.0, 60.0, 0.0, 90.0, 70.0, 80.0, 30.0, 30.0, 0.0, 50.0, 190.0, 300.0, 30.0, 10.0, 40.0, 50.0, 30.0, 20.0, 270.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 250.0, 30.0, 80.0, 10.0, 160.0, 80.0, 50.0, 30.0, 20.0, 20.0, 370.0, 70.0, 20.0, 30.0, 20.0, 100.0, 30.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 100.0, 310.0, 80.0, 80.0, 50.0, 10.0, 110.0, 0.0, 210.0, 30.0, 50.0, 40.0, 60.0, 60.0, 30.0, 40.0, 0.0, 25.0, 70.0, 60.0, 110.0, 150.0, 220.0, -10.0, 150.0, 30.0, 60.0, 170.0, 10.0, 0.0, 50.0, 30.0, 70.0, 280.0, 10.0, 0.0, 200.0, 10.0, 40.0, 220.0, 40.0, 30.0, 70.0, 90.0, 40.0, 60.0, 50.0, 140.0, 320.0, 30.0, 170.0, 40.0, 70.0, 40.0, 20.0, 10.0, 40.0, 150.0, 10.0, 100.0, 120.0, 30.0, 50.0, 300.0, 40.0, 320.0, 20.0, 60.0, 170.0, 100.0, 80.0, 170.0, 70.0, 50.0, 520.0, 120.0, 10.0, 70.0, 180.0, 80.0, 60.0, 210.0, 0.0, 20.0, 10.0, 90.0, 290.0, 20.0, 40.0, 40.0, 0.0, 170.0, 60.0, 10.0, 30.0, 40.0, 70.0, 20.0, 70.0, 40.0, 180.0, 190.0, 30.0, 150.0, 0.0, 30.0, 70.0, 50.0, 180.0, 170.0, 50.0, 30.0, 0.0, 100.0, 60.0, 20.0, 130.0, 370.0, 120.0, 20.0, 30.0, 230.0, 240.0, 80.0, 90.0, 60.0, 10.0, 250.0, 40.0, 10.0, 0.0, 70.0, 100.0, 30.0, 10.0, 40.0, 50.0, 10.0, 390.0, 60.0, 30.0, 30.0, 50.0, 80.0, 25.0, 70.0, 60.0, 20.0, 100.0, 30.0, 10.0, 100.0, 30.0, -10.0, 80.0, 30.0, 0.0, 10.0, 150.0, 90.0, 20.0, 40.0, 25.0, 30.0, 10.0, 120.0, 10.0, 210.0, 0.0, 20.0, 40.0, 50.0, 70.0, 30.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 90.0, 260.0, 30.0, 10.0, 30.0, 20.0, 70.0, 240.0, 70.0, 20.0, 190.0, 80.0, 160.0, 100.0, 20.0, 10.0, 50.0, 90.0, 90.0, 30.0, 120.0, 30.0, 180.0, 0.0, 60.0, 170.0, 30.0, 50.0, 80.0, 70.0, 70.0, 10.0, 170.0, 10.0, 40.0, 10.0, 30.0, 50.0, 40.0, 20.0, 270.0, 20.0, 45.0, 0.0, 190.0, 150.0, 30.0, 20.0, 10.0, 15.0, 40.0, 60.0, 180.0, 80.0, 20.0, 70.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 10.0, 70.0, 165.0, 30.0, 50.0, 30.0, 40.0, -40.0, 10.0, -75.0, 50.0, 140.0, 160.0, -40.0, 60.0, 70.0, 60.0, 180.0, 160.0, 110.0, -5.0, 80.0, 150.0, 20.0, 200.0, 0.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 30.0, 90.0, 180.0, 80.0, 160.0, 70.0, 10.0, 60.0, 150.0, 80.0, 70.0, 70.0, 130.0, 70.0, 140.0, 90.0, 60.0, 180.0, 30.0, 80.0, 110.0, 310.0, 40.0, 70.0, 0.0, 30.0, 180.0, 5.0, 70.0, 100.0, -270.0, 60.0, 70.0, 340.0, 130.0, 220.0, 60.0, 100.0, 50.0, 80.0, 250.0, 90.0, 190.0, 0.0, 505.0, 0.0, 20.0, 50.0, 20.0, 110.0, 20.0, 100.0, 10.0, 30.0, -30.0, 0.0, 5.0, 10.0, 50.0, 20.0, 40.0, 0.0, 100.0, -30.0, 40.0, 30.0, 20.0, 190.0, 0.0, 110.0, 460.0, 80.0, 120.0, 190.0, 40.0, 10.0, 120.0, 60.0, 350.0, 70.0, 120.0, 65.0, 10.0, 30.0, 170.0, 40.0, 260.0, 90.0, 50.0, 40.0, 60.0, 60.0, 100.0, 20.0, 40.0, 30.0, 100.0, 50.0, 60.0, 10.0, 30.0, 20.0, 30.0, 130.0, 0.0, 40.0, 20.0, 20.0, 30.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 60.0, 20.0, 40.0, 20.0, 0.0, 0.0, 90.0, 20.0, 30.0, 190.0, 40.0, 280.0, 100.0, 30.0, 50.0, 30.0, 60.0, 140.0, 130.0, 200.0, 250.0, 30.0, 30.0, 130.0, 50.0, 90.0, 60.0, 60.0, 30.0, 30.0, 0.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 0.0, 70.0, 70.0, 300.0, 50.0, 20.0, 30.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 380.0, 120.0, 20.0, 30.0, 20.0, 10.0, 120.0, 40.0, 10.0, 510.0, 10.0, 20.0, 30.0, 0.0, 60.0, -30.0, -20.0, 10.0, 100.0, 90.0, 90.0, 470.0, -30.0, 10.0, 80.0, 80.0, 100.0, 10.0, 110.0, 170.0, 170.0, 160.0, 85.0, 60.0, 30.0, 20.0, 80.0, 40.0, 30.0, 140.0, 90.0, 170.0, 110.0, 200.0, 90.0, 120.0, 20.0, 120.0, 40.0, -15.0, 30.0, 0.0, 40.0, 50.0, 0.0, 30.0, 75.0, 10.0, 60.0, 80.0, 30.0, 70.0, 170.0, 60.0, 250.0, 210.0, 70.0, 20.0, 20.0, 180.0, 340.0, 30.0, 20.0, 10.0, 20.0, -120.0, 0.0, 110.0, 180.0, 20.0, 210.0, 60.0, 130.0, 80.0, 360.0, 10.0, 60.0, 0.0, 10.0, 200.0, 80.0, 100.0, 60.0, 40.0, 80.0, 90.0, 40.0, -30.0, 110.0, 80.0, 60.0, 30.0, 230.0, 60.0, 40.0, 250.0, 290.0, 80.0, 30.0, 60.0, 90.0, 80.0, 100.0, 50.0, 60.0, 120.0, 0.0, 630.0, 160.0, 20.0, 240.0, 190.0, 10.0, 10.0, 30.0, 20.0, 160.0, 20.0, 170.0, -30.0, 40.0, 130.0, 0.0, 130.0, 90.0, 30.0, 30.0, 50.0, -30.0, 160.0, 60.0, 200.0, 40.0, 180.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 130.0, 60.0, 110.0, 60.0, 170.0, 360.0, 80.0, 10.0, 450.0, 20.0, 20.0, 40.0, 60.0, 30.0, 90.0, 30.0, 40.0, 10.0, 50.0, 30.0, 0.0, 20.0, 100.0, 190.0, 30.0, 20.0, 100.0, 70.0, 80.0, 90.0, 260.0, -10.0, 100.0, 130.0, 90.0, 10.0, 70.0, 340.0, 0.0, 0.0, 30.0, 270.0, 10.0, 10.0, 30.0, 100.0, 0.0, 150.0, 10.0, 15.0, 10.0, 20.0, 20.0, 20.0, 70.0, 30.0, 30.0, -10.0, 20.0, 10.0, 100.0, 180.0, 80.0, 10.0, 50.0, 20.0, 40.0, 50.0, 160.0, 30.0, 40.0, 90.0, 410.0, 40.0, 100.0, 150.0, 320.0, 145.0, -370.0, 160.0, 10.0, 50.0, 80.0, 30.0, 170.0, 100.0, 30.0, 20.0, -40.0, 10.0, 180.0, 40.0, 30.0, 40.0, 80.0, 70.0, 160.0, 10.0, 40.0, 100.0, 150.0, 180.0, 20.0, 20.0, 40.0, 30.0, 90.0, 20.0, 70.0, 100.0, 160.0, 80.0, 50.0, 20.0, 180.0, 30.0, -20.0, 50.0, 50.0, 100.0, 370.0, 320.0, 30.0, 70.0, 20.0, 340.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6920874111532473, "mean_inference_ms": 1.4649464586848884, "mean_action_processing_ms": 0.4528748473962544, "mean_env_wait_ms": 1.358637730936943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01277613639831543, "StateBufferConnector_ms": 0.009965181350708008, "ViewRequirementAgentConnector_ms": 0.414813756942749}, "num_episodes": 23, "episode_return_max": 1395.0, "episode_return_min": 135.0, "episode_return_mean": 758.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.224661342533416, "num_env_steps_trained_throughput_per_sec": 19.224661342533416, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 208917.769, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208917.724, "sample_time_ms": 2816.438, "learn_time_ms": 206079.235, "learn_throughput": 19.41, "synch_weights_time_ms": 12.126}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 34, "trial_id": "aa996_00000", "date": "2024-05-24_00-43-06", "timestamp": 1716525786, "time_this_iter_s": 208.07547283172607, "time_total_s": 7054.37806558609, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332db5e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7054.37806558609, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 19.215986394557824, "ram_util_percent": 79.0547619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.033099624758965, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4049096002873265, "policy_loss": -0.009280450233105567, "vf_loss": 5.412773223349842, "vf_explained_var": 0.0027632467853375515, "kl": 0.0070841641037742474, "entropy": 0.7712362098490723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 323955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": 135.0, "episode_reward_mean": 742.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 74.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [470.0, 670.0, 740.0, 190.0, 980.0, 910.0, 790.0, 490.0, 740.0, 690.0, 760.0, 630.0, 805.0, 680.0, 800.0, 890.0, 1160.0, 1360.0, 730.0, 700.0, 780.0, 730.0, 1370.0, 560.0, 795.0, 450.0, 495.0, 640.0, 510.0, 960.0, 820.0, 540.0, 815.0, 525.0, 345.0, 325.0, 885.0, 495.0, 930.0, 1200.0, 285.0, 1390.0, 1015.0, 135.0, 1000.0, 1145.0, 810.0, 460.0, 360.0, 220.0, 860.0, 1110.0, 370.0, 630.0, 780.0, 770.0, 880.0, 915.0, 1070.0, 315.0, 1015.0, 590.0, 1160.0, 720.0, 870.0, 960.0, 1310.0, 740.0, 760.0, 1015.0, 830.0, 490.0, 920.0, 860.0, 345.0, 490.0, 1110.0, 695.0, 460.0, 750.0, 800.0, 1330.0, 520.0, 1030.0, 1270.0, 800.0, 200.0, 965.0, 440.0, 750.0, 360.0, 540.0, 980.0, 640.0, 565.0, 135.0, 805.0, 730.0, 735.0, 660.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 20.0, 20.0, 90.0, 80.0, 110.0, 30.0, 70.0, 10.0, 20.0, 0.0, 30.0, 40.0, 80.0, 80.0, 300.0, 20.0, 40.0, 40.0, 40.0, 300.0, 10.0, 220.0, 40.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 50.0, 0.0, 40.0, 10.0, 30.0, 60.0, 120.0, -10.0, 30.0, 160.0, 100.0, 180.0, 60.0, 50.0, 230.0, 10.0, 80.0, 170.0, 270.0, 140.0, 40.0, 50.0, 60.0, 0.0, 90.0, 70.0, 80.0, 30.0, 30.0, 0.0, 50.0, 190.0, 300.0, 30.0, 10.0, 40.0, 50.0, 30.0, 20.0, 270.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 250.0, 30.0, 80.0, 10.0, 160.0, 80.0, 50.0, 30.0, 20.0, 20.0, 370.0, 70.0, 20.0, 30.0, 20.0, 100.0, 30.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 100.0, 310.0, 80.0, 80.0, 50.0, 10.0, 110.0, 0.0, 210.0, 30.0, 50.0, 40.0, 60.0, 60.0, 30.0, 40.0, 0.0, 25.0, 70.0, 60.0, 110.0, 150.0, 220.0, -10.0, 150.0, 30.0, 60.0, 170.0, 10.0, 0.0, 50.0, 30.0, 70.0, 280.0, 10.0, 0.0, 200.0, 10.0, 40.0, 220.0, 40.0, 30.0, 70.0, 90.0, 40.0, 60.0, 50.0, 140.0, 320.0, 30.0, 170.0, 40.0, 70.0, 40.0, 20.0, 10.0, 40.0, 150.0, 10.0, 100.0, 120.0, 30.0, 50.0, 300.0, 40.0, 320.0, 20.0, 60.0, 170.0, 100.0, 80.0, 170.0, 70.0, 50.0, 520.0, 120.0, 10.0, 70.0, 180.0, 80.0, 60.0, 210.0, 0.0, 20.0, 10.0, 90.0, 290.0, 20.0, 40.0, 40.0, 0.0, 170.0, 60.0, 10.0, 30.0, 40.0, 70.0, 20.0, 70.0, 40.0, 180.0, 190.0, 30.0, 150.0, 0.0, 30.0, 70.0, 50.0, 180.0, 170.0, 50.0, 30.0, 0.0, 100.0, 60.0, 20.0, 130.0, 370.0, 120.0, 20.0, 30.0, 230.0, 240.0, 80.0, 90.0, 60.0, 10.0, 250.0, 40.0, 10.0, 0.0, 70.0, 100.0, 30.0, 10.0, 40.0, 50.0, 10.0, 390.0, 60.0, 30.0, 30.0, 50.0, 80.0, 25.0, 70.0, 60.0, 20.0, 100.0, 30.0, 10.0, 100.0, 30.0, -10.0, 80.0, 30.0, 0.0, 10.0, 150.0, 90.0, 20.0, 40.0, 25.0, 30.0, 10.0, 120.0, 10.0, 210.0, 0.0, 20.0, 40.0, 50.0, 70.0, 30.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 90.0, 260.0, 30.0, 10.0, 30.0, 20.0, 70.0, 240.0, 70.0, 20.0, 190.0, 80.0, 160.0, 100.0, 20.0, 10.0, 50.0, 90.0, 90.0, 30.0, 120.0, 30.0, 180.0, 0.0, 60.0, 170.0, 30.0, 50.0, 80.0, 70.0, 70.0, 10.0, 170.0, 10.0, 40.0, 10.0, 30.0, 50.0, 40.0, 20.0, 270.0, 20.0, 45.0, 0.0, 190.0, 150.0, 30.0, 20.0, 10.0, 15.0, 40.0, 60.0, 180.0, 80.0, 20.0, 70.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 10.0, 70.0, 165.0, 30.0, 50.0, 30.0, 40.0, -40.0, 10.0, -75.0, 50.0, 140.0, 160.0, -40.0, 60.0, 70.0, 60.0, 180.0, 160.0, 110.0, -5.0, 80.0, 150.0, 20.0, 200.0, 0.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 30.0, 90.0, 180.0, 80.0, 160.0, 70.0, 10.0, 60.0, 150.0, 80.0, 70.0, 70.0, 130.0, 70.0, 140.0, 90.0, 60.0, 180.0, 30.0, 80.0, 110.0, 310.0, 40.0, 70.0, 0.0, 30.0, 180.0, 5.0, 70.0, 100.0, -270.0, 60.0, 70.0, 340.0, 130.0, 220.0, 60.0, 100.0, 50.0, 80.0, 250.0, 90.0, 190.0, 0.0, 505.0, 0.0, 20.0, 50.0, 20.0, 110.0, 20.0, 100.0, 10.0, 30.0, -30.0, 0.0, 5.0, 10.0, 50.0, 20.0, 40.0, 0.0, 100.0, -30.0, 40.0, 30.0, 20.0, 190.0, 0.0, 110.0, 460.0, 80.0, 120.0, 190.0, 40.0, 10.0, 120.0, 60.0, 350.0, 70.0, 120.0, 65.0, 10.0, 30.0, 170.0, 40.0, 260.0, 90.0, 50.0, 40.0, 60.0, 60.0, 100.0, 20.0, 40.0, 30.0, 100.0, 50.0, 60.0, 10.0, 30.0, 20.0, 30.0, 130.0, 0.0, 40.0, 20.0, 20.0, 30.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 60.0, 20.0, 40.0, 20.0, 0.0, 0.0, 90.0, 20.0, 30.0, 190.0, 40.0, 280.0, 100.0, 30.0, 50.0, 30.0, 60.0, 140.0, 130.0, 200.0, 250.0, 30.0, 30.0, 130.0, 50.0, 90.0, 60.0, 60.0, 30.0, 30.0, 0.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 0.0, 70.0, 70.0, 300.0, 50.0, 20.0, 30.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 380.0, 120.0, 20.0, 30.0, 20.0, 10.0, 120.0, 40.0, 10.0, 510.0, 10.0, 20.0, 30.0, 0.0, 60.0, -30.0, -20.0, 10.0, 100.0, 90.0, 90.0, 470.0, -30.0, 10.0, 80.0, 80.0, 100.0, 10.0, 110.0, 170.0, 170.0, 160.0, 85.0, 60.0, 30.0, 20.0, 80.0, 40.0, 30.0, 140.0, 90.0, 170.0, 110.0, 200.0, 90.0, 120.0, 20.0, 120.0, 40.0, -15.0, 30.0, 0.0, 40.0, 50.0, 0.0, 30.0, 75.0, 10.0, 60.0, 80.0, 30.0, 70.0, 170.0, 60.0, 250.0, 210.0, 70.0, 20.0, 20.0, 180.0, 340.0, 30.0, 20.0, 10.0, 20.0, -120.0, 0.0, 110.0, 180.0, 20.0, 210.0, 60.0, 130.0, 80.0, 360.0, 10.0, 60.0, 0.0, 10.0, 200.0, 80.0, 100.0, 60.0, 40.0, 80.0, 90.0, 40.0, -30.0, 110.0, 80.0, 60.0, 30.0, 230.0, 60.0, 40.0, 250.0, 290.0, 80.0, 30.0, 60.0, 90.0, 80.0, 100.0, 50.0, 60.0, 120.0, 0.0, 630.0, 160.0, 20.0, 240.0, 190.0, 10.0, 10.0, 30.0, 20.0, 160.0, 20.0, 170.0, -30.0, 40.0, 130.0, 0.0, 130.0, 90.0, 30.0, 30.0, 50.0, -30.0, 160.0, 60.0, 200.0, 40.0, 180.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 130.0, 60.0, 110.0, 60.0, 170.0, 360.0, 80.0, 10.0, 450.0, 20.0, 20.0, 40.0, 60.0, 30.0, 90.0, 30.0, 40.0, 10.0, 50.0, 30.0, 0.0, 20.0, 100.0, 190.0, 30.0, 20.0, 100.0, 70.0, 80.0, 90.0, 260.0, -10.0, 100.0, 130.0, 90.0, 10.0, 70.0, 340.0, 0.0, 0.0, 30.0, 270.0, 10.0, 10.0, 30.0, 100.0, 0.0, 150.0, 10.0, 15.0, 10.0, 20.0, 20.0, 20.0, 70.0, 30.0, 30.0, -10.0, 20.0, 10.0, 100.0, 180.0, 80.0, 10.0, 50.0, 20.0, 40.0, 50.0, 160.0, 30.0, 40.0, 90.0, 410.0, 40.0, 100.0, 150.0, 320.0, 145.0, -370.0, 160.0, 10.0, 50.0, 80.0, 30.0, 170.0, 100.0, 30.0, 20.0, -40.0, 10.0, 180.0, 40.0, 30.0, 40.0, 80.0, 70.0, 160.0, 10.0, 40.0, 100.0, 150.0, 180.0, 20.0, 20.0, 40.0, 30.0, 90.0, 20.0, 70.0, 100.0, 160.0, 80.0, 50.0, 20.0, 180.0, 30.0, -20.0, 50.0, 50.0, 100.0, 370.0, 320.0, 30.0, 70.0, 20.0, 340.0, 0.0, 20.0, 40.0, 0.0, 190.0, 0.0, 30.0, 20.0, 210.0, 10.0, 60.0, 120.0, 170.0, 160.0, 80.0, 40.0, 100.0, 100.0, 70.0, 130.0, 40.0, 10.0, 210.0, 170.0, 100.0, 20.0, 290.0, 230.0, 110.0, 90.0, 60.0, 30.0, 110.0, 20.0, 260.0, 50.0, 200.0, 50.0, 10.0, 10.0, 60.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 320.0, 110.0, 220.0, 15.0, 90.0, 10.0, 70.0, 70.0, 20.0, 40.0, 20.0, 30.0, 10.0, 150.0, 40.0, 20.0, 20.0, 110.0, 40.0, 0.0, 110.0, 20.0, 180.0, 90.0, 40.0, 40.0, 0.0, 30.0, 60.0, 180.0, 170.0, 40.0, 10.0, 10.0, 0.0, 40.0, 0.0, 60.0, 0.0, 30.0, 0.0, 50.0, 60.0, 180.0, 0.0, 10.0, 20.0, 140.0, 20.0, 60.0, 10.0, 0.0, 210.0, 40.0, 420.0, 190.0, 30.0, 50.0, 10.0, 20.0, 10.0, 40.0, 60.0, 180.0, 0.0, 160.0, 50.0, 80.0, 40.0, 20.0, 5.0, 30.0, 40.0, 80.0, 0.0, 110.0, 40.0, 40.0, 180.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 15.0, 20.0, 25.0, 0.0, 390.0, 30.0, 130.0, 10.0, 10.0, 40.0, 70.0, 100.0, 20.0, 70.0, 280.0, 10.0, 40.0, 50.0, 40.0, 30.0, 180.0, 10.0, 20.0, 45.0, 40.0, 410.0, 10.0, 70.0, 0.0, 50.0, 50.0, 40.0, 250.0, 80.0, 30.0, 10.0, 10.0, 10.0, 50.0, 40.0, 170.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6956463260371577, "mean_inference_ms": 1.4687172316433692, "mean_action_processing_ms": 0.45213345934336174, "mean_env_wait_ms": 1.3598582437160442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017134666442871094, "StateBufferConnector_ms": 0.011013031005859375, "ViewRequirementAgentConnector_ms": 0.4453744888305664}, "num_episodes": 18, "episode_return_max": 1390.0, "episode_return_min": 135.0, "episode_return_mean": 742.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.150085691449533, "num_env_steps_trained_throughput_per_sec": 19.150085691449533, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 208934.673, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208934.628, "sample_time_ms": 2876.724, "learn_time_ms": 206035.79, "learn_throughput": 19.414, "synch_weights_time_ms": 11.983}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 35, "trial_id": "aa996_00000", "date": "2024-05-24_00-46-35", "timestamp": 1716525995, "time_this_iter_s": 208.88418197631836, "time_total_s": 7263.262247562408, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7263.262247562408, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 19.357094594594596, "ram_util_percent": 78.80945945945946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.301364341146522, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.99959454683704, "policy_loss": -0.008716259359124715, "vf_loss": 6.006985497043028, "vf_explained_var": 0.00044194662405913886, "kl": 0.006626531208916657, "entropy": 0.783688536733865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 333345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": 135.0, "episode_reward_mean": 753.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 75.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [730.0, 700.0, 780.0, 730.0, 1370.0, 560.0, 795.0, 450.0, 495.0, 640.0, 510.0, 960.0, 820.0, 540.0, 815.0, 525.0, 345.0, 325.0, 885.0, 495.0, 930.0, 1200.0, 285.0, 1390.0, 1015.0, 135.0, 1000.0, 1145.0, 810.0, 460.0, 360.0, 220.0, 860.0, 1110.0, 370.0, 630.0, 780.0, 770.0, 880.0, 915.0, 1070.0, 315.0, 1015.0, 590.0, 1160.0, 720.0, 870.0, 960.0, 1310.0, 740.0, 760.0, 1015.0, 830.0, 490.0, 920.0, 860.0, 345.0, 490.0, 1110.0, 695.0, 460.0, 750.0, 800.0, 1330.0, 520.0, 1030.0, 1270.0, 800.0, 200.0, 965.0, 440.0, 750.0, 360.0, 540.0, 980.0, 640.0, 565.0, 135.0, 805.0, 730.0, 735.0, 660.0, 1260.0, 1220.0, 780.0, 680.0, 690.0, 845.0, 730.0, 670.0, 820.0, 420.0, 970.0, 815.0, 1175.0, 1030.0, 1010.0, 360.0, 1095.0, 280.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 70.0, 180.0, 80.0, 60.0, 210.0, 0.0, 20.0, 10.0, 90.0, 290.0, 20.0, 40.0, 40.0, 0.0, 170.0, 60.0, 10.0, 30.0, 40.0, 70.0, 20.0, 70.0, 40.0, 180.0, 190.0, 30.0, 150.0, 0.0, 30.0, 70.0, 50.0, 180.0, 170.0, 50.0, 30.0, 0.0, 100.0, 60.0, 20.0, 130.0, 370.0, 120.0, 20.0, 30.0, 230.0, 240.0, 80.0, 90.0, 60.0, 10.0, 250.0, 40.0, 10.0, 0.0, 70.0, 100.0, 30.0, 10.0, 40.0, 50.0, 10.0, 390.0, 60.0, 30.0, 30.0, 50.0, 80.0, 25.0, 70.0, 60.0, 20.0, 100.0, 30.0, 10.0, 100.0, 30.0, -10.0, 80.0, 30.0, 0.0, 10.0, 150.0, 90.0, 20.0, 40.0, 25.0, 30.0, 10.0, 120.0, 10.0, 210.0, 0.0, 20.0, 40.0, 50.0, 70.0, 30.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 90.0, 260.0, 30.0, 10.0, 30.0, 20.0, 70.0, 240.0, 70.0, 20.0, 190.0, 80.0, 160.0, 100.0, 20.0, 10.0, 50.0, 90.0, 90.0, 30.0, 120.0, 30.0, 180.0, 0.0, 60.0, 170.0, 30.0, 50.0, 80.0, 70.0, 70.0, 10.0, 170.0, 10.0, 40.0, 10.0, 30.0, 50.0, 40.0, 20.0, 270.0, 20.0, 45.0, 0.0, 190.0, 150.0, 30.0, 20.0, 10.0, 15.0, 40.0, 60.0, 180.0, 80.0, 20.0, 70.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 10.0, 70.0, 165.0, 30.0, 50.0, 30.0, 40.0, -40.0, 10.0, -75.0, 50.0, 140.0, 160.0, -40.0, 60.0, 70.0, 60.0, 180.0, 160.0, 110.0, -5.0, 80.0, 150.0, 20.0, 200.0, 0.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 30.0, 90.0, 180.0, 80.0, 160.0, 70.0, 10.0, 60.0, 150.0, 80.0, 70.0, 70.0, 130.0, 70.0, 140.0, 90.0, 60.0, 180.0, 30.0, 80.0, 110.0, 310.0, 40.0, 70.0, 0.0, 30.0, 180.0, 5.0, 70.0, 100.0, -270.0, 60.0, 70.0, 340.0, 130.0, 220.0, 60.0, 100.0, 50.0, 80.0, 250.0, 90.0, 190.0, 0.0, 505.0, 0.0, 20.0, 50.0, 20.0, 110.0, 20.0, 100.0, 10.0, 30.0, -30.0, 0.0, 5.0, 10.0, 50.0, 20.0, 40.0, 0.0, 100.0, -30.0, 40.0, 30.0, 20.0, 190.0, 0.0, 110.0, 460.0, 80.0, 120.0, 190.0, 40.0, 10.0, 120.0, 60.0, 350.0, 70.0, 120.0, 65.0, 10.0, 30.0, 170.0, 40.0, 260.0, 90.0, 50.0, 40.0, 60.0, 60.0, 100.0, 20.0, 40.0, 30.0, 100.0, 50.0, 60.0, 10.0, 30.0, 20.0, 30.0, 130.0, 0.0, 40.0, 20.0, 20.0, 30.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 60.0, 20.0, 40.0, 20.0, 0.0, 0.0, 90.0, 20.0, 30.0, 190.0, 40.0, 280.0, 100.0, 30.0, 50.0, 30.0, 60.0, 140.0, 130.0, 200.0, 250.0, 30.0, 30.0, 130.0, 50.0, 90.0, 60.0, 60.0, 30.0, 30.0, 0.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 0.0, 70.0, 70.0, 300.0, 50.0, 20.0, 30.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 380.0, 120.0, 20.0, 30.0, 20.0, 10.0, 120.0, 40.0, 10.0, 510.0, 10.0, 20.0, 30.0, 0.0, 60.0, -30.0, -20.0, 10.0, 100.0, 90.0, 90.0, 470.0, -30.0, 10.0, 80.0, 80.0, 100.0, 10.0, 110.0, 170.0, 170.0, 160.0, 85.0, 60.0, 30.0, 20.0, 80.0, 40.0, 30.0, 140.0, 90.0, 170.0, 110.0, 200.0, 90.0, 120.0, 20.0, 120.0, 40.0, -15.0, 30.0, 0.0, 40.0, 50.0, 0.0, 30.0, 75.0, 10.0, 60.0, 80.0, 30.0, 70.0, 170.0, 60.0, 250.0, 210.0, 70.0, 20.0, 20.0, 180.0, 340.0, 30.0, 20.0, 10.0, 20.0, -120.0, 0.0, 110.0, 180.0, 20.0, 210.0, 60.0, 130.0, 80.0, 360.0, 10.0, 60.0, 0.0, 10.0, 200.0, 80.0, 100.0, 60.0, 40.0, 80.0, 90.0, 40.0, -30.0, 110.0, 80.0, 60.0, 30.0, 230.0, 60.0, 40.0, 250.0, 290.0, 80.0, 30.0, 60.0, 90.0, 80.0, 100.0, 50.0, 60.0, 120.0, 0.0, 630.0, 160.0, 20.0, 240.0, 190.0, 10.0, 10.0, 30.0, 20.0, 160.0, 20.0, 170.0, -30.0, 40.0, 130.0, 0.0, 130.0, 90.0, 30.0, 30.0, 50.0, -30.0, 160.0, 60.0, 200.0, 40.0, 180.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 130.0, 60.0, 110.0, 60.0, 170.0, 360.0, 80.0, 10.0, 450.0, 20.0, 20.0, 40.0, 60.0, 30.0, 90.0, 30.0, 40.0, 10.0, 50.0, 30.0, 0.0, 20.0, 100.0, 190.0, 30.0, 20.0, 100.0, 70.0, 80.0, 90.0, 260.0, -10.0, 100.0, 130.0, 90.0, 10.0, 70.0, 340.0, 0.0, 0.0, 30.0, 270.0, 10.0, 10.0, 30.0, 100.0, 0.0, 150.0, 10.0, 15.0, 10.0, 20.0, 20.0, 20.0, 70.0, 30.0, 30.0, -10.0, 20.0, 10.0, 100.0, 180.0, 80.0, 10.0, 50.0, 20.0, 40.0, 50.0, 160.0, 30.0, 40.0, 90.0, 410.0, 40.0, 100.0, 150.0, 320.0, 145.0, -370.0, 160.0, 10.0, 50.0, 80.0, 30.0, 170.0, 100.0, 30.0, 20.0, -40.0, 10.0, 180.0, 40.0, 30.0, 40.0, 80.0, 70.0, 160.0, 10.0, 40.0, 100.0, 150.0, 180.0, 20.0, 20.0, 40.0, 30.0, 90.0, 20.0, 70.0, 100.0, 160.0, 80.0, 50.0, 20.0, 180.0, 30.0, -20.0, 50.0, 50.0, 100.0, 370.0, 320.0, 30.0, 70.0, 20.0, 340.0, 0.0, 20.0, 40.0, 0.0, 190.0, 0.0, 30.0, 20.0, 210.0, 10.0, 60.0, 120.0, 170.0, 160.0, 80.0, 40.0, 100.0, 100.0, 70.0, 130.0, 40.0, 10.0, 210.0, 170.0, 100.0, 20.0, 290.0, 230.0, 110.0, 90.0, 60.0, 30.0, 110.0, 20.0, 260.0, 50.0, 200.0, 50.0, 10.0, 10.0, 60.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 320.0, 110.0, 220.0, 15.0, 90.0, 10.0, 70.0, 70.0, 20.0, 40.0, 20.0, 30.0, 10.0, 150.0, 40.0, 20.0, 20.0, 110.0, 40.0, 0.0, 110.0, 20.0, 180.0, 90.0, 40.0, 40.0, 0.0, 30.0, 60.0, 180.0, 170.0, 40.0, 10.0, 10.0, 0.0, 40.0, 0.0, 60.0, 0.0, 30.0, 0.0, 50.0, 60.0, 180.0, 0.0, 10.0, 20.0, 140.0, 20.0, 60.0, 10.0, 0.0, 210.0, 40.0, 420.0, 190.0, 30.0, 50.0, 10.0, 20.0, 10.0, 40.0, 60.0, 180.0, 0.0, 160.0, 50.0, 80.0, 40.0, 20.0, 5.0, 30.0, 40.0, 80.0, 0.0, 110.0, 40.0, 40.0, 180.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 15.0, 20.0, 25.0, 0.0, 390.0, 30.0, 130.0, 10.0, 10.0, 40.0, 70.0, 100.0, 20.0, 70.0, 280.0, 10.0, 40.0, 50.0, 40.0, 30.0, 180.0, 10.0, 20.0, 45.0, 40.0, 410.0, 10.0, 70.0, 0.0, 50.0, 50.0, 40.0, 250.0, 80.0, 30.0, 10.0, 10.0, 10.0, 50.0, 40.0, 170.0, 10.0, 230.0, 190.0, 10.0, 100.0, 360.0, 10.0, 70.0, 120.0, 90.0, 80.0, 110.0, 170.0, 110.0, 180.0, 70.0, 100.0, -50.0, 350.0, 110.0, 70.0, 10.0, 20.0, 40.0, 30.0, 20.0, 90.0, 180.0, 50.0, 50.0, 290.0, 50.0, 60.0, 180.0, 20.0, 50.0, 10.0, 20.0, 0.0, 220.0, 70.0, 40.0, 40.0, 210.0, 40.0, 40.0, 40.0, 40.0, 30.0, 30.0, 180.0, 40.0, 20.0, -5.0, 30.0, 60.0, 230.0, 200.0, 70.0, 190.0, 10.0, 150.0, 40.0, 80.0, 150.0, -40.0, -5.0, 10.0, 35.0, 30.0, 280.0, 80.0, 70.0, 60.0, 20.0, 250.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 70.0, 150.0, 180.0, 30.0, 0.0, 0.0, 310.0, 50.0, 20.0, 170.0, 30.0, 5.0, 30.0, 70.0, 90.0, 5.0, 20.0, 0.0, 0.0, 190.0, 160.0, -80.0, 280.0, 230.0, -10.0, 40.0, 30.0, 80.0, 50.0, 230.0, 90.0, 60.0, 60.0, 10.0, 290.0, 20.0, 30.0, 15.0, 10.0, 50.0, 40.0, 310.0, 70.0, 210.0, 80.0, 260.0, 10.0, 60.0, 85.0, 220.0, 30.0, 40.0, 100.0, 10.0, 20.0, 190.0, 10.0, 140.0, 270.0, 130.0, 160.0, 0.0, 80.0, 60.0, 80.0, 370.0, 40.0, 30.0, 60.0, 40.0, 10.0, 10.0, 60.0, 60.0, 0.0, 0.0, 80.0, 40.0, 60.0, 0.0, 140.0, 210.0, 200.0, 10.0, 20.0, 130.0, 25.0, 230.0, 130.0, 0.0, 30.0, 40.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7001533768782064, "mean_inference_ms": 1.4719152221552576, "mean_action_processing_ms": 0.4514539192577212, "mean_env_wait_ms": 1.3608534669704255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017162084579467773, "StateBufferConnector_ms": 0.01091766357421875, "ViewRequirementAgentConnector_ms": 0.44541311264038086}, "num_episodes": 18, "episode_return_max": 1390.0, "episode_return_min": 135.0, "episode_return_mean": 753.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.067164342835593, "num_env_steps_trained_throughput_per_sec": 19.067164342835593, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 208948.791, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208948.746, "sample_time_ms": 2870.252, "learn_time_ms": 206056.375, "learn_throughput": 19.412, "synch_weights_time_ms": 12.119}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 36, "trial_id": "aa996_00000", "date": "2024-05-24_00-50-05", "timestamp": 1716526205, "time_this_iter_s": 209.79469799995422, "time_total_s": 7473.056945562363, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd21f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7473.056945562363, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 19.30337837837838, "ram_util_percent": 79.38141891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.192739188925019, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.2402857626081145, "policy_loss": -0.009788100470660336, "vf_loss": 6.248724050643726, "vf_explained_var": 0.001684339149310566, "kl": 0.006749035246229881, "entropy": 0.7674211136068398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 342735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": 135.0, "episode_reward_mean": 763.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 76.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [885.0, 495.0, 930.0, 1200.0, 285.0, 1390.0, 1015.0, 135.0, 1000.0, 1145.0, 810.0, 460.0, 360.0, 220.0, 860.0, 1110.0, 370.0, 630.0, 780.0, 770.0, 880.0, 915.0, 1070.0, 315.0, 1015.0, 590.0, 1160.0, 720.0, 870.0, 960.0, 1310.0, 740.0, 760.0, 1015.0, 830.0, 490.0, 920.0, 860.0, 345.0, 490.0, 1110.0, 695.0, 460.0, 750.0, 800.0, 1330.0, 520.0, 1030.0, 1270.0, 800.0, 200.0, 965.0, 440.0, 750.0, 360.0, 540.0, 980.0, 640.0, 565.0, 135.0, 805.0, 730.0, 735.0, 660.0, 1260.0, 1220.0, 780.0, 680.0, 690.0, 845.0, 730.0, 670.0, 820.0, 420.0, 970.0, 815.0, 1175.0, 1030.0, 1010.0, 360.0, 1095.0, 280.0, 965.0, 945.0, 670.0, 390.0, 640.0, 460.0, 1040.0, 820.0, 530.0, 1130.0, 230.0, 890.0, 360.0, 1300.0, 850.0, 520.0, 455.0, 910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 70.0, 60.0, 180.0, 160.0, 110.0, -5.0, 80.0, 150.0, 20.0, 200.0, 0.0, 15.0, 0.0, 0.0, 60.0, 70.0, 30.0, 30.0, 90.0, 180.0, 80.0, 160.0, 70.0, 10.0, 60.0, 150.0, 80.0, 70.0, 70.0, 130.0, 70.0, 140.0, 90.0, 60.0, 180.0, 30.0, 80.0, 110.0, 310.0, 40.0, 70.0, 0.0, 30.0, 180.0, 5.0, 70.0, 100.0, -270.0, 60.0, 70.0, 340.0, 130.0, 220.0, 60.0, 100.0, 50.0, 80.0, 250.0, 90.0, 190.0, 0.0, 505.0, 0.0, 20.0, 50.0, 20.0, 110.0, 20.0, 100.0, 10.0, 30.0, -30.0, 0.0, 5.0, 10.0, 50.0, 20.0, 40.0, 0.0, 100.0, -30.0, 40.0, 30.0, 20.0, 190.0, 0.0, 110.0, 460.0, 80.0, 120.0, 190.0, 40.0, 10.0, 120.0, 60.0, 350.0, 70.0, 120.0, 65.0, 10.0, 30.0, 170.0, 40.0, 260.0, 90.0, 50.0, 40.0, 60.0, 60.0, 100.0, 20.0, 40.0, 30.0, 100.0, 50.0, 60.0, 10.0, 30.0, 20.0, 30.0, 130.0, 0.0, 40.0, 20.0, 20.0, 30.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 60.0, 20.0, 40.0, 20.0, 0.0, 0.0, 90.0, 20.0, 30.0, 190.0, 40.0, 280.0, 100.0, 30.0, 50.0, 30.0, 60.0, 140.0, 130.0, 200.0, 250.0, 30.0, 30.0, 130.0, 50.0, 90.0, 60.0, 60.0, 30.0, 30.0, 0.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 0.0, 70.0, 70.0, 300.0, 50.0, 20.0, 30.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 380.0, 120.0, 20.0, 30.0, 20.0, 10.0, 120.0, 40.0, 10.0, 510.0, 10.0, 20.0, 30.0, 0.0, 60.0, -30.0, -20.0, 10.0, 100.0, 90.0, 90.0, 470.0, -30.0, 10.0, 80.0, 80.0, 100.0, 10.0, 110.0, 170.0, 170.0, 160.0, 85.0, 60.0, 30.0, 20.0, 80.0, 40.0, 30.0, 140.0, 90.0, 170.0, 110.0, 200.0, 90.0, 120.0, 20.0, 120.0, 40.0, -15.0, 30.0, 0.0, 40.0, 50.0, 0.0, 30.0, 75.0, 10.0, 60.0, 80.0, 30.0, 70.0, 170.0, 60.0, 250.0, 210.0, 70.0, 20.0, 20.0, 180.0, 340.0, 30.0, 20.0, 10.0, 20.0, -120.0, 0.0, 110.0, 180.0, 20.0, 210.0, 60.0, 130.0, 80.0, 360.0, 10.0, 60.0, 0.0, 10.0, 200.0, 80.0, 100.0, 60.0, 40.0, 80.0, 90.0, 40.0, -30.0, 110.0, 80.0, 60.0, 30.0, 230.0, 60.0, 40.0, 250.0, 290.0, 80.0, 30.0, 60.0, 90.0, 80.0, 100.0, 50.0, 60.0, 120.0, 0.0, 630.0, 160.0, 20.0, 240.0, 190.0, 10.0, 10.0, 30.0, 20.0, 160.0, 20.0, 170.0, -30.0, 40.0, 130.0, 0.0, 130.0, 90.0, 30.0, 30.0, 50.0, -30.0, 160.0, 60.0, 200.0, 40.0, 180.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 130.0, 60.0, 110.0, 60.0, 170.0, 360.0, 80.0, 10.0, 450.0, 20.0, 20.0, 40.0, 60.0, 30.0, 90.0, 30.0, 40.0, 10.0, 50.0, 30.0, 0.0, 20.0, 100.0, 190.0, 30.0, 20.0, 100.0, 70.0, 80.0, 90.0, 260.0, -10.0, 100.0, 130.0, 90.0, 10.0, 70.0, 340.0, 0.0, 0.0, 30.0, 270.0, 10.0, 10.0, 30.0, 100.0, 0.0, 150.0, 10.0, 15.0, 10.0, 20.0, 20.0, 20.0, 70.0, 30.0, 30.0, -10.0, 20.0, 10.0, 100.0, 180.0, 80.0, 10.0, 50.0, 20.0, 40.0, 50.0, 160.0, 30.0, 40.0, 90.0, 410.0, 40.0, 100.0, 150.0, 320.0, 145.0, -370.0, 160.0, 10.0, 50.0, 80.0, 30.0, 170.0, 100.0, 30.0, 20.0, -40.0, 10.0, 180.0, 40.0, 30.0, 40.0, 80.0, 70.0, 160.0, 10.0, 40.0, 100.0, 150.0, 180.0, 20.0, 20.0, 40.0, 30.0, 90.0, 20.0, 70.0, 100.0, 160.0, 80.0, 50.0, 20.0, 180.0, 30.0, -20.0, 50.0, 50.0, 100.0, 370.0, 320.0, 30.0, 70.0, 20.0, 340.0, 0.0, 20.0, 40.0, 0.0, 190.0, 0.0, 30.0, 20.0, 210.0, 10.0, 60.0, 120.0, 170.0, 160.0, 80.0, 40.0, 100.0, 100.0, 70.0, 130.0, 40.0, 10.0, 210.0, 170.0, 100.0, 20.0, 290.0, 230.0, 110.0, 90.0, 60.0, 30.0, 110.0, 20.0, 260.0, 50.0, 200.0, 50.0, 10.0, 10.0, 60.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 320.0, 110.0, 220.0, 15.0, 90.0, 10.0, 70.0, 70.0, 20.0, 40.0, 20.0, 30.0, 10.0, 150.0, 40.0, 20.0, 20.0, 110.0, 40.0, 0.0, 110.0, 20.0, 180.0, 90.0, 40.0, 40.0, 0.0, 30.0, 60.0, 180.0, 170.0, 40.0, 10.0, 10.0, 0.0, 40.0, 0.0, 60.0, 0.0, 30.0, 0.0, 50.0, 60.0, 180.0, 0.0, 10.0, 20.0, 140.0, 20.0, 60.0, 10.0, 0.0, 210.0, 40.0, 420.0, 190.0, 30.0, 50.0, 10.0, 20.0, 10.0, 40.0, 60.0, 180.0, 0.0, 160.0, 50.0, 80.0, 40.0, 20.0, 5.0, 30.0, 40.0, 80.0, 0.0, 110.0, 40.0, 40.0, 180.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 15.0, 20.0, 25.0, 0.0, 390.0, 30.0, 130.0, 10.0, 10.0, 40.0, 70.0, 100.0, 20.0, 70.0, 280.0, 10.0, 40.0, 50.0, 40.0, 30.0, 180.0, 10.0, 20.0, 45.0, 40.0, 410.0, 10.0, 70.0, 0.0, 50.0, 50.0, 40.0, 250.0, 80.0, 30.0, 10.0, 10.0, 10.0, 50.0, 40.0, 170.0, 10.0, 230.0, 190.0, 10.0, 100.0, 360.0, 10.0, 70.0, 120.0, 90.0, 80.0, 110.0, 170.0, 110.0, 180.0, 70.0, 100.0, -50.0, 350.0, 110.0, 70.0, 10.0, 20.0, 40.0, 30.0, 20.0, 90.0, 180.0, 50.0, 50.0, 290.0, 50.0, 60.0, 180.0, 20.0, 50.0, 10.0, 20.0, 0.0, 220.0, 70.0, 40.0, 40.0, 210.0, 40.0, 40.0, 40.0, 40.0, 30.0, 30.0, 180.0, 40.0, 20.0, -5.0, 30.0, 60.0, 230.0, 200.0, 70.0, 190.0, 10.0, 150.0, 40.0, 80.0, 150.0, -40.0, -5.0, 10.0, 35.0, 30.0, 280.0, 80.0, 70.0, 60.0, 20.0, 250.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 70.0, 150.0, 180.0, 30.0, 0.0, 0.0, 310.0, 50.0, 20.0, 170.0, 30.0, 5.0, 30.0, 70.0, 90.0, 5.0, 20.0, 0.0, 0.0, 190.0, 160.0, -80.0, 280.0, 230.0, -10.0, 40.0, 30.0, 80.0, 50.0, 230.0, 90.0, 60.0, 60.0, 10.0, 290.0, 20.0, 30.0, 15.0, 10.0, 50.0, 40.0, 310.0, 70.0, 210.0, 80.0, 260.0, 10.0, 60.0, 85.0, 220.0, 30.0, 40.0, 100.0, 10.0, 20.0, 190.0, 10.0, 140.0, 270.0, 130.0, 160.0, 0.0, 80.0, 60.0, 80.0, 370.0, 40.0, 30.0, 60.0, 40.0, 10.0, 10.0, 60.0, 60.0, 0.0, 0.0, 80.0, 40.0, 60.0, 0.0, 140.0, 210.0, 200.0, 10.0, 20.0, 130.0, 25.0, 230.0, 130.0, 0.0, 30.0, 40.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 260.0, 30.0, 60.0, 0.0, 70.0, 35.0, 30.0, 300.0, 150.0, 30.0, 5.0, 80.0, 170.0, 230.0, 110.0, 20.0, 30.0, 40.0, 240.0, 20.0, -40.0, 0.0, 30.0, 20.0, 600.0, 50.0, -20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 0.0, 70.0, 40.0, 0.0, 40.0, 110.0, 90.0, 10.0, 20.0, 20.0, 120.0, 310.0, 0.0, -20.0, 40.0, 30.0, 110.0, 20.0, 30.0, 40.0, 30.0, 40.0, 80.0, 0.0, 20.0, 100.0, 100.0, 80.0, 90.0, 380.0, 70.0, 210.0, 30.0, 80.0, 50.0, 20.0, 30.0, 40.0, 90.0, 90.0, 90.0, 10.0, 170.0, 60.0, 90.0, 90.0, 90.0, 30.0, 0.0, 10.0, 10.0, 30.0, 30.0, 160.0, 90.0, 10.0, 160.0, 80.0, 50.0, 80.0, 120.0, 120.0, 70.0, 80.0, 60.0, 200.0, 270.0, 20.0, 20.0, 60.0, 10.0, 30.0, 30.0, 50.0, 0.0, 10.0, 0.0, 40.0, 210.0, 0.0, -10.0, 280.0, 270.0, 90.0, 20.0, -20.0, 10.0, 35.0, 10.0, 110.0, 50.0, 0.0, 10.0, 10.0, 30.0, 90.0, 15.0, 250.0, 110.0, 170.0, 160.0, 60.0, 270.0, 40.0, 110.0, 60.0, 70.0, 10.0, 200.0, 80.0, 40.0, 200.0, 140.0, 40.0, 90.0, 20.0, 30.0, 50.0, 0.0, 90.0, 40.0, 0.0, 120.0, 0.0, 110.0, 80.0, 30.0, 15.0, 90.0, 20.0, 40.0, 110.0, 10.0, 60.0, 20.0, 60.0, 30.0, 40.0, 80.0, 200.0, 110.0, 270.0, 50.0, 70.0, -40.0, 120.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7035519928028777, "mean_inference_ms": 1.4744223607070535, "mean_action_processing_ms": 0.45083261629029253, "mean_env_wait_ms": 1.3617806841883362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017313003540039062, "StateBufferConnector_ms": 0.011043548583984375, "ViewRequirementAgentConnector_ms": 0.44171810150146484}, "num_episodes": 18, "episode_return_max": 1390.0, "episode_return_min": 135.0, "episode_return_mean": 763.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.10912257960471, "num_env_steps_trained_throughput_per_sec": 19.10912257960471, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 208800.959, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208800.914, "sample_time_ms": 2886.553, "learn_time_ms": 205892.664, "learn_throughput": 19.428, "synch_weights_time_ms": 11.95}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 37, "trial_id": "aa996_00000", "date": "2024-05-24_00-53-34", "timestamp": 1716526414, "time_this_iter_s": 209.33915901184082, "time_total_s": 7682.3961045742035, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x33098c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7682.3961045742035, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 19.06351351351351, "ram_util_percent": 79.63614864864866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3079277577491615, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.169218312944975, "policy_loss": -0.009735623987894198, "vf_loss": 7.177525710348631, "vf_explained_var": -0.0005276896321354583, "kl": 0.007141067872629964, "entropy": 0.7131520728270213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 352125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 1330.0, "episode_reward_min": 135.0, "episode_reward_mean": 786.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 78.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1070.0, 315.0, 1015.0, 590.0, 1160.0, 720.0, 870.0, 960.0, 1310.0, 740.0, 760.0, 1015.0, 830.0, 490.0, 920.0, 860.0, 345.0, 490.0, 1110.0, 695.0, 460.0, 750.0, 800.0, 1330.0, 520.0, 1030.0, 1270.0, 800.0, 200.0, 965.0, 440.0, 750.0, 360.0, 540.0, 980.0, 640.0, 565.0, 135.0, 805.0, 730.0, 735.0, 660.0, 1260.0, 1220.0, 780.0, 680.0, 690.0, 845.0, 730.0, 670.0, 820.0, 420.0, 970.0, 815.0, 1175.0, 1030.0, 1010.0, 360.0, 1095.0, 280.0, 965.0, 945.0, 670.0, 390.0, 640.0, 460.0, 1040.0, 820.0, 530.0, 1130.0, 230.0, 890.0, 360.0, 1300.0, 850.0, 520.0, 455.0, 910.0, 870.0, 490.0, 895.0, 660.0, 1050.0, 1140.0, 455.0, 1315.0, 1330.0, 1060.0, 860.0, 1200.0, 795.0, 975.0, 625.0, 1030.0, 520.0, 885.0, 760.0, 1040.0, 270.0, 745.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 40.0, 30.0, 140.0, 90.0, 170.0, 110.0, 200.0, 90.0, 120.0, 20.0, 120.0, 40.0, -15.0, 30.0, 0.0, 40.0, 50.0, 0.0, 30.0, 75.0, 10.0, 60.0, 80.0, 30.0, 70.0, 170.0, 60.0, 250.0, 210.0, 70.0, 20.0, 20.0, 180.0, 340.0, 30.0, 20.0, 10.0, 20.0, -120.0, 0.0, 110.0, 180.0, 20.0, 210.0, 60.0, 130.0, 80.0, 360.0, 10.0, 60.0, 0.0, 10.0, 200.0, 80.0, 100.0, 60.0, 40.0, 80.0, 90.0, 40.0, -30.0, 110.0, 80.0, 60.0, 30.0, 230.0, 60.0, 40.0, 250.0, 290.0, 80.0, 30.0, 60.0, 90.0, 80.0, 100.0, 50.0, 60.0, 120.0, 0.0, 630.0, 160.0, 20.0, 240.0, 190.0, 10.0, 10.0, 30.0, 20.0, 160.0, 20.0, 170.0, -30.0, 40.0, 130.0, 0.0, 130.0, 90.0, 30.0, 30.0, 50.0, -30.0, 160.0, 60.0, 200.0, 40.0, 180.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 130.0, 60.0, 110.0, 60.0, 170.0, 360.0, 80.0, 10.0, 450.0, 20.0, 20.0, 40.0, 60.0, 30.0, 90.0, 30.0, 40.0, 10.0, 50.0, 30.0, 0.0, 20.0, 100.0, 190.0, 30.0, 20.0, 100.0, 70.0, 80.0, 90.0, 260.0, -10.0, 100.0, 130.0, 90.0, 10.0, 70.0, 340.0, 0.0, 0.0, 30.0, 270.0, 10.0, 10.0, 30.0, 100.0, 0.0, 150.0, 10.0, 15.0, 10.0, 20.0, 20.0, 20.0, 70.0, 30.0, 30.0, -10.0, 20.0, 10.0, 100.0, 180.0, 80.0, 10.0, 50.0, 20.0, 40.0, 50.0, 160.0, 30.0, 40.0, 90.0, 410.0, 40.0, 100.0, 150.0, 320.0, 145.0, -370.0, 160.0, 10.0, 50.0, 80.0, 30.0, 170.0, 100.0, 30.0, 20.0, -40.0, 10.0, 180.0, 40.0, 30.0, 40.0, 80.0, 70.0, 160.0, 10.0, 40.0, 100.0, 150.0, 180.0, 20.0, 20.0, 40.0, 30.0, 90.0, 20.0, 70.0, 100.0, 160.0, 80.0, 50.0, 20.0, 180.0, 30.0, -20.0, 50.0, 50.0, 100.0, 370.0, 320.0, 30.0, 70.0, 20.0, 340.0, 0.0, 20.0, 40.0, 0.0, 190.0, 0.0, 30.0, 20.0, 210.0, 10.0, 60.0, 120.0, 170.0, 160.0, 80.0, 40.0, 100.0, 100.0, 70.0, 130.0, 40.0, 10.0, 210.0, 170.0, 100.0, 20.0, 290.0, 230.0, 110.0, 90.0, 60.0, 30.0, 110.0, 20.0, 260.0, 50.0, 200.0, 50.0, 10.0, 10.0, 60.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 320.0, 110.0, 220.0, 15.0, 90.0, 10.0, 70.0, 70.0, 20.0, 40.0, 20.0, 30.0, 10.0, 150.0, 40.0, 20.0, 20.0, 110.0, 40.0, 0.0, 110.0, 20.0, 180.0, 90.0, 40.0, 40.0, 0.0, 30.0, 60.0, 180.0, 170.0, 40.0, 10.0, 10.0, 0.0, 40.0, 0.0, 60.0, 0.0, 30.0, 0.0, 50.0, 60.0, 180.0, 0.0, 10.0, 20.0, 140.0, 20.0, 60.0, 10.0, 0.0, 210.0, 40.0, 420.0, 190.0, 30.0, 50.0, 10.0, 20.0, 10.0, 40.0, 60.0, 180.0, 0.0, 160.0, 50.0, 80.0, 40.0, 20.0, 5.0, 30.0, 40.0, 80.0, 0.0, 110.0, 40.0, 40.0, 180.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 15.0, 20.0, 25.0, 0.0, 390.0, 30.0, 130.0, 10.0, 10.0, 40.0, 70.0, 100.0, 20.0, 70.0, 280.0, 10.0, 40.0, 50.0, 40.0, 30.0, 180.0, 10.0, 20.0, 45.0, 40.0, 410.0, 10.0, 70.0, 0.0, 50.0, 50.0, 40.0, 250.0, 80.0, 30.0, 10.0, 10.0, 10.0, 50.0, 40.0, 170.0, 10.0, 230.0, 190.0, 10.0, 100.0, 360.0, 10.0, 70.0, 120.0, 90.0, 80.0, 110.0, 170.0, 110.0, 180.0, 70.0, 100.0, -50.0, 350.0, 110.0, 70.0, 10.0, 20.0, 40.0, 30.0, 20.0, 90.0, 180.0, 50.0, 50.0, 290.0, 50.0, 60.0, 180.0, 20.0, 50.0, 10.0, 20.0, 0.0, 220.0, 70.0, 40.0, 40.0, 210.0, 40.0, 40.0, 40.0, 40.0, 30.0, 30.0, 180.0, 40.0, 20.0, -5.0, 30.0, 60.0, 230.0, 200.0, 70.0, 190.0, 10.0, 150.0, 40.0, 80.0, 150.0, -40.0, -5.0, 10.0, 35.0, 30.0, 280.0, 80.0, 70.0, 60.0, 20.0, 250.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 70.0, 150.0, 180.0, 30.0, 0.0, 0.0, 310.0, 50.0, 20.0, 170.0, 30.0, 5.0, 30.0, 70.0, 90.0, 5.0, 20.0, 0.0, 0.0, 190.0, 160.0, -80.0, 280.0, 230.0, -10.0, 40.0, 30.0, 80.0, 50.0, 230.0, 90.0, 60.0, 60.0, 10.0, 290.0, 20.0, 30.0, 15.0, 10.0, 50.0, 40.0, 310.0, 70.0, 210.0, 80.0, 260.0, 10.0, 60.0, 85.0, 220.0, 30.0, 40.0, 100.0, 10.0, 20.0, 190.0, 10.0, 140.0, 270.0, 130.0, 160.0, 0.0, 80.0, 60.0, 80.0, 370.0, 40.0, 30.0, 60.0, 40.0, 10.0, 10.0, 60.0, 60.0, 0.0, 0.0, 80.0, 40.0, 60.0, 0.0, 140.0, 210.0, 200.0, 10.0, 20.0, 130.0, 25.0, 230.0, 130.0, 0.0, 30.0, 40.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 260.0, 30.0, 60.0, 0.0, 70.0, 35.0, 30.0, 300.0, 150.0, 30.0, 5.0, 80.0, 170.0, 230.0, 110.0, 20.0, 30.0, 40.0, 240.0, 20.0, -40.0, 0.0, 30.0, 20.0, 600.0, 50.0, -20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 0.0, 70.0, 40.0, 0.0, 40.0, 110.0, 90.0, 10.0, 20.0, 20.0, 120.0, 310.0, 0.0, -20.0, 40.0, 30.0, 110.0, 20.0, 30.0, 40.0, 30.0, 40.0, 80.0, 0.0, 20.0, 100.0, 100.0, 80.0, 90.0, 380.0, 70.0, 210.0, 30.0, 80.0, 50.0, 20.0, 30.0, 40.0, 90.0, 90.0, 90.0, 10.0, 170.0, 60.0, 90.0, 90.0, 90.0, 30.0, 0.0, 10.0, 10.0, 30.0, 30.0, 160.0, 90.0, 10.0, 160.0, 80.0, 50.0, 80.0, 120.0, 120.0, 70.0, 80.0, 60.0, 200.0, 270.0, 20.0, 20.0, 60.0, 10.0, 30.0, 30.0, 50.0, 0.0, 10.0, 0.0, 40.0, 210.0, 0.0, -10.0, 280.0, 270.0, 90.0, 20.0, -20.0, 10.0, 35.0, 10.0, 110.0, 50.0, 0.0, 10.0, 10.0, 30.0, 90.0, 15.0, 250.0, 110.0, 170.0, 160.0, 60.0, 270.0, 40.0, 110.0, 60.0, 70.0, 10.0, 200.0, 80.0, 40.0, 200.0, 140.0, 40.0, 90.0, 20.0, 30.0, 50.0, 0.0, 90.0, 40.0, 0.0, 120.0, 0.0, 110.0, 80.0, 30.0, 15.0, 90.0, 20.0, 40.0, 110.0, 10.0, 60.0, 20.0, 60.0, 30.0, 40.0, 80.0, 200.0, 110.0, 270.0, 50.0, 70.0, -40.0, 120.0, 10.0, 10.0, 70.0, 260.0, 30.0, 20.0, 100.0, 10.0, 100.0, -50.0, 320.0, 20.0, 10.0, 40.0, 20.0, 30.0, 160.0, 110.0, 30.0, 20.0, 50.0, 140.0, 90.0, 260.0, 45.0, 30.0, 40.0, 70.0, 70.0, 70.0, 80.0, 120.0, 40.0, 90.0, 5.0, 20.0, 60.0, 5.0, 250.0, 20.0, 50.0, 120.0, 40.0, 0.0, 620.0, 40.0, 60.0, 20.0, 20.0, 10.0, 120.0, -20.0, 60.0, 60.0, 120.0, 60.0, 20.0, 10.0, 310.0, 460.0, 60.0, 30.0, 40.0, 20.0, 10.0, 80.0, 40.0, 50.0, 15.0, 30.0, 140.0, 50.0, 120.0, 50.0, 300.0, 160.0, 390.0, 60.0, 80.0, 25.0, 80.0, 200.0, 150.0, 310.0, 40.0, 170.0, 0.0, 80.0, 60.0, 190.0, 130.0, 50.0, 80.0, 160.0, 30.0, 100.0, 120.0, 360.0, 50.0, 10.0, 100.0, 50.0, 110.0, 50.0, 100.0, 20.0, 20.0, 90.0, 180.0, 200.0, 40.0, 210.0, -60.0, 590.0, -10.0, 220.0, 60.0, 100.0, -30.0, 30.0, 90.0, 20.0, 190.0, 40.0, 165.0, 70.0, 110.0, 70.0, 30.0, 40.0, 60.0, 70.0, 30.0, 20.0, 290.0, 0.0, 80.0, 130.0, 135.0, 70.0, 150.0, 200.0, 0.0, 0.0, 50.0, 20.0, -35.0, 100.0, 30.0, 90.0, 170.0, 200.0, 120.0, 120.0, 80.0, 300.0, 10.0, 100.0, 70.0, 50.0, -20.0, 10.0, 0.0, 20.0, 70.0, 30.0, 150.0, 10.0, 0.0, 40.0, 190.0, 110.0, 35.0, 380.0, 20.0, 40.0, 20.0, 150.0, 50.0, 20.0, 60.0, 70.0, 30.0, 70.0, 80.0, 50.0, 60.0, -50.0, 240.0, 310.0, -100.0, 130.0, 120.0, 100.0, 50.0, 170.0, 50.0, 180.0, 130.0, 40.0, 70.0, 70.0, 30.0, 40.0, 0.0, 0.0, 25.0, 30.0, 20.0, 20.0, 35.0, 40.0, 100.0, 90.0, 25.0, 10.0, 20.0, 60.0, 70.0, 320.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7077084867627819, "mean_inference_ms": 1.4788249414725365, "mean_action_processing_ms": 0.4502761618296347, "mean_env_wait_ms": 1.363440264008573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017205238342285156, "StateBufferConnector_ms": 0.011090278625488281, "ViewRequirementAgentConnector_ms": 0.44631218910217285}, "num_episodes": 22, "episode_return_max": 1330.0, "episode_return_min": 135.0, "episode_return_mean": 786.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.10730024885637, "num_env_steps_trained_throughput_per_sec": 19.10730024885637, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 209136.603, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209136.557, "sample_time_ms": 2903.011, "learn_time_ms": 206212.209, "learn_throughput": 19.397, "synch_weights_time_ms": 11.836}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 38, "trial_id": "aa996_00000", "date": "2024-05-24_00-57-04", "timestamp": 1716526624, "time_this_iter_s": 209.3536341190338, "time_total_s": 7891.749738693237, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332db53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7891.749738693237, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 19.153378378378378, "ram_util_percent": 79.68547297297297}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.28251929408826, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.262607654748252, "policy_loss": -0.00900318003271997, "vf_loss": 6.270219507207251, "vf_explained_var": 0.00018679332682372917, "kl": 0.006956658750564579, "entropy": 0.7190385055300781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 361515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 135.0, "episode_reward_mean": 783.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 620.0}, "policy_reward_mean": {"policy_0": 78.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1330.0, 520.0, 1030.0, 1270.0, 800.0, 200.0, 965.0, 440.0, 750.0, 360.0, 540.0, 980.0, 640.0, 565.0, 135.0, 805.0, 730.0, 735.0, 660.0, 1260.0, 1220.0, 780.0, 680.0, 690.0, 845.0, 730.0, 670.0, 820.0, 420.0, 970.0, 815.0, 1175.0, 1030.0, 1010.0, 360.0, 1095.0, 280.0, 965.0, 945.0, 670.0, 390.0, 640.0, 460.0, 1040.0, 820.0, 530.0, 1130.0, 230.0, 890.0, 360.0, 1300.0, 850.0, 520.0, 455.0, 910.0, 870.0, 490.0, 895.0, 660.0, 1050.0, 1140.0, 455.0, 1315.0, 1330.0, 1060.0, 860.0, 1200.0, 795.0, 975.0, 625.0, 1030.0, 520.0, 885.0, 760.0, 1040.0, 270.0, 745.0, 590.0, 790.0, 600.0, 1040.0, 1150.0, 910.0, 460.0, 815.0, 865.0, 640.0, 1060.0, 385.0, 380.0, 1020.0, 1310.0, 335.0, 580.0, 475.0, 970.0, 1015.0, 1430.0, 530.0, 600.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-20.0, 50.0, 50.0, 100.0, 370.0, 320.0, 30.0, 70.0, 20.0, 340.0, 0.0, 20.0, 40.0, 0.0, 190.0, 0.0, 30.0, 20.0, 210.0, 10.0, 60.0, 120.0, 170.0, 160.0, 80.0, 40.0, 100.0, 100.0, 70.0, 130.0, 40.0, 10.0, 210.0, 170.0, 100.0, 20.0, 290.0, 230.0, 110.0, 90.0, 60.0, 30.0, 110.0, 20.0, 260.0, 50.0, 200.0, 50.0, 10.0, 10.0, 60.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 320.0, 110.0, 220.0, 15.0, 90.0, 10.0, 70.0, 70.0, 20.0, 40.0, 20.0, 30.0, 10.0, 150.0, 40.0, 20.0, 20.0, 110.0, 40.0, 0.0, 110.0, 20.0, 180.0, 90.0, 40.0, 40.0, 0.0, 30.0, 60.0, 180.0, 170.0, 40.0, 10.0, 10.0, 0.0, 40.0, 0.0, 60.0, 0.0, 30.0, 0.0, 50.0, 60.0, 180.0, 0.0, 10.0, 20.0, 140.0, 20.0, 60.0, 10.0, 0.0, 210.0, 40.0, 420.0, 190.0, 30.0, 50.0, 10.0, 20.0, 10.0, 40.0, 60.0, 180.0, 0.0, 160.0, 50.0, 80.0, 40.0, 20.0, 5.0, 30.0, 40.0, 80.0, 0.0, 110.0, 40.0, 40.0, 180.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 15.0, 20.0, 25.0, 0.0, 390.0, 30.0, 130.0, 10.0, 10.0, 40.0, 70.0, 100.0, 20.0, 70.0, 280.0, 10.0, 40.0, 50.0, 40.0, 30.0, 180.0, 10.0, 20.0, 45.0, 40.0, 410.0, 10.0, 70.0, 0.0, 50.0, 50.0, 40.0, 250.0, 80.0, 30.0, 10.0, 10.0, 10.0, 50.0, 40.0, 170.0, 10.0, 230.0, 190.0, 10.0, 100.0, 360.0, 10.0, 70.0, 120.0, 90.0, 80.0, 110.0, 170.0, 110.0, 180.0, 70.0, 100.0, -50.0, 350.0, 110.0, 70.0, 10.0, 20.0, 40.0, 30.0, 20.0, 90.0, 180.0, 50.0, 50.0, 290.0, 50.0, 60.0, 180.0, 20.0, 50.0, 10.0, 20.0, 0.0, 220.0, 70.0, 40.0, 40.0, 210.0, 40.0, 40.0, 40.0, 40.0, 30.0, 30.0, 180.0, 40.0, 20.0, -5.0, 30.0, 60.0, 230.0, 200.0, 70.0, 190.0, 10.0, 150.0, 40.0, 80.0, 150.0, -40.0, -5.0, 10.0, 35.0, 30.0, 280.0, 80.0, 70.0, 60.0, 20.0, 250.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 70.0, 150.0, 180.0, 30.0, 0.0, 0.0, 310.0, 50.0, 20.0, 170.0, 30.0, 5.0, 30.0, 70.0, 90.0, 5.0, 20.0, 0.0, 0.0, 190.0, 160.0, -80.0, 280.0, 230.0, -10.0, 40.0, 30.0, 80.0, 50.0, 230.0, 90.0, 60.0, 60.0, 10.0, 290.0, 20.0, 30.0, 15.0, 10.0, 50.0, 40.0, 310.0, 70.0, 210.0, 80.0, 260.0, 10.0, 60.0, 85.0, 220.0, 30.0, 40.0, 100.0, 10.0, 20.0, 190.0, 10.0, 140.0, 270.0, 130.0, 160.0, 0.0, 80.0, 60.0, 80.0, 370.0, 40.0, 30.0, 60.0, 40.0, 10.0, 10.0, 60.0, 60.0, 0.0, 0.0, 80.0, 40.0, 60.0, 0.0, 140.0, 210.0, 200.0, 10.0, 20.0, 130.0, 25.0, 230.0, 130.0, 0.0, 30.0, 40.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 260.0, 30.0, 60.0, 0.0, 70.0, 35.0, 30.0, 300.0, 150.0, 30.0, 5.0, 80.0, 170.0, 230.0, 110.0, 20.0, 30.0, 40.0, 240.0, 20.0, -40.0, 0.0, 30.0, 20.0, 600.0, 50.0, -20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 0.0, 70.0, 40.0, 0.0, 40.0, 110.0, 90.0, 10.0, 20.0, 20.0, 120.0, 310.0, 0.0, -20.0, 40.0, 30.0, 110.0, 20.0, 30.0, 40.0, 30.0, 40.0, 80.0, 0.0, 20.0, 100.0, 100.0, 80.0, 90.0, 380.0, 70.0, 210.0, 30.0, 80.0, 50.0, 20.0, 30.0, 40.0, 90.0, 90.0, 90.0, 10.0, 170.0, 60.0, 90.0, 90.0, 90.0, 30.0, 0.0, 10.0, 10.0, 30.0, 30.0, 160.0, 90.0, 10.0, 160.0, 80.0, 50.0, 80.0, 120.0, 120.0, 70.0, 80.0, 60.0, 200.0, 270.0, 20.0, 20.0, 60.0, 10.0, 30.0, 30.0, 50.0, 0.0, 10.0, 0.0, 40.0, 210.0, 0.0, -10.0, 280.0, 270.0, 90.0, 20.0, -20.0, 10.0, 35.0, 10.0, 110.0, 50.0, 0.0, 10.0, 10.0, 30.0, 90.0, 15.0, 250.0, 110.0, 170.0, 160.0, 60.0, 270.0, 40.0, 110.0, 60.0, 70.0, 10.0, 200.0, 80.0, 40.0, 200.0, 140.0, 40.0, 90.0, 20.0, 30.0, 50.0, 0.0, 90.0, 40.0, 0.0, 120.0, 0.0, 110.0, 80.0, 30.0, 15.0, 90.0, 20.0, 40.0, 110.0, 10.0, 60.0, 20.0, 60.0, 30.0, 40.0, 80.0, 200.0, 110.0, 270.0, 50.0, 70.0, -40.0, 120.0, 10.0, 10.0, 70.0, 260.0, 30.0, 20.0, 100.0, 10.0, 100.0, -50.0, 320.0, 20.0, 10.0, 40.0, 20.0, 30.0, 160.0, 110.0, 30.0, 20.0, 50.0, 140.0, 90.0, 260.0, 45.0, 30.0, 40.0, 70.0, 70.0, 70.0, 80.0, 120.0, 40.0, 90.0, 5.0, 20.0, 60.0, 5.0, 250.0, 20.0, 50.0, 120.0, 40.0, 0.0, 620.0, 40.0, 60.0, 20.0, 20.0, 10.0, 120.0, -20.0, 60.0, 60.0, 120.0, 60.0, 20.0, 10.0, 310.0, 460.0, 60.0, 30.0, 40.0, 20.0, 10.0, 80.0, 40.0, 50.0, 15.0, 30.0, 140.0, 50.0, 120.0, 50.0, 300.0, 160.0, 390.0, 60.0, 80.0, 25.0, 80.0, 200.0, 150.0, 310.0, 40.0, 170.0, 0.0, 80.0, 60.0, 190.0, 130.0, 50.0, 80.0, 160.0, 30.0, 100.0, 120.0, 360.0, 50.0, 10.0, 100.0, 50.0, 110.0, 50.0, 100.0, 20.0, 20.0, 90.0, 180.0, 200.0, 40.0, 210.0, -60.0, 590.0, -10.0, 220.0, 60.0, 100.0, -30.0, 30.0, 90.0, 20.0, 190.0, 40.0, 165.0, 70.0, 110.0, 70.0, 30.0, 40.0, 60.0, 70.0, 30.0, 20.0, 290.0, 0.0, 80.0, 130.0, 135.0, 70.0, 150.0, 200.0, 0.0, 0.0, 50.0, 20.0, -35.0, 100.0, 30.0, 90.0, 170.0, 200.0, 120.0, 120.0, 80.0, 300.0, 10.0, 100.0, 70.0, 50.0, -20.0, 10.0, 0.0, 20.0, 70.0, 30.0, 150.0, 10.0, 0.0, 40.0, 190.0, 110.0, 35.0, 380.0, 20.0, 40.0, 20.0, 150.0, 50.0, 20.0, 60.0, 70.0, 30.0, 70.0, 80.0, 50.0, 60.0, -50.0, 240.0, 310.0, -100.0, 130.0, 120.0, 100.0, 50.0, 170.0, 50.0, 180.0, 130.0, 40.0, 70.0, 70.0, 30.0, 40.0, 0.0, 0.0, 25.0, 30.0, 20.0, 20.0, 35.0, 40.0, 100.0, 90.0, 25.0, 10.0, 20.0, 60.0, 70.0, 320.0, 10.0, 10.0, 70.0, 50.0, 70.0, 40.0, 40.0, 110.0, 90.0, 40.0, 70.0, 90.0, 60.0, 110.0, 80.0, 80.0, 70.0, 50.0, 80.0, 120.0, 50.0, 110.0, 30.0, 10.0, 160.0, 40.0, 10.0, 40.0, 180.0, 10.0, 10.0, 60.0, 50.0, 350.0, 30.0, 180.0, 20.0, 40.0, 200.0, 60.0, 50.0, 180.0, 230.0, 250.0, 40.0, 60.0, 120.0, 90.0, 10.0, 80.0, 90.0, 30.0, 220.0, 110.0, 50.0, 90.0, 320.0, 0.0, 30.0, 60.0, 0.0, 10.0, 90.0, 0.0, 20.0, 60.0, 20.0, 230.0, 0.0, 30.0, 0.0, 30.0, 90.0, 340.0, 0.0, 25.0, 60.0, 50.0, 130.0, 60.0, 30.0, 10.0, 130.0, -35.0, 470.0, 60.0, 20.0, 20.0, 60.0, 160.0, -30.0, 40.0, 260.0, -30.0, 40.0, 30.0, 100.0, 30.0, 10.0, 110.0, 50.0, 500.0, 150.0, 20.0, 50.0, 230.0, 0.0, 40.0, 0.0, 10.0, 60.0, 0.0, 5.0, 20.0, 0.0, 110.0, 240.0, 5.0, -5.0, 10.0, 0.0, 170.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 60.0, 10.0, 80.0, 160.0, 160.0, 100.0, 70.0, 80.0, 60.0, 220.0, 80.0, 110.0, 160.0, 90.0, 220.0, 20.0, 330.0, 170.0, 20.0, 130.0, 60.0, 10.0, 20.0, 10.0, 50.0, 60.0, 20.0, 110.0, 70.0, 30.0, -45.0, 170.0, 250.0, 45.0, -10.0, 10.0, 50.0, 20.0, 40.0, 0.0, 5.0, 50.0, 15.0, 10.0, 70.0, -10.0, 20.0, 90.0, 50.0, 90.0, 90.0, 40.0, 30.0, 380.0, 50.0, 70.0, 50.0, 70.0, 240.0, 40.0, 0.0, -80.0, 50.0, 260.0, 60.0, 50.0, -55.0, 190.0, 100.0, 40.0, 400.0, 20.0, 10.0, 450.0, 20.0, 90.0, 100.0, 270.0, 210.0, 130.0, 130.0, 40.0, 10.0, 10.0, 20.0, 50.0, 50.0, 20.0, 80.0, 190.0, 60.0, 150.0, 30.0, 40.0, 50.0, 40.0, 30.0, 60.0, 10.0, 20.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7111816926289642, "mean_inference_ms": 1.4827958885538555, "mean_action_processing_ms": 0.4497138914061529, "mean_env_wait_ms": 1.3648607920895457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01751852035522461, "StateBufferConnector_ms": 0.011194467544555664, "ViewRequirementAgentConnector_ms": 0.44116687774658203}, "num_episodes": 23, "episode_return_max": 1430.0, "episode_return_min": 135.0, "episode_return_mean": 783.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.06499742696871, "num_env_steps_trained_throughput_per_sec": 19.06499742696871, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 209115.575, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209115.529, "sample_time_ms": 2909.632, "learn_time_ms": 206184.814, "learn_throughput": 19.4, "synch_weights_time_ms": 12.064}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 39, "trial_id": "aa996_00000", "date": "2024-05-24_01-00-34", "timestamp": 1716526834, "time_this_iter_s": 209.81731295585632, "time_total_s": 8101.567051649094, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309d4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8101.567051649094, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 19.289225589225587, "ram_util_percent": 79.27542087542089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.049583121185232, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.732585369867766, "policy_loss": -0.008612798518155076, "vf_loss": 6.739910525127976, "vf_explained_var": -0.0002634145390873138, "kl": 0.0064382293382163275, "entropy": 0.6481571448242829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 370905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 1440.0, "episode_reward_min": 230.0, "episode_reward_mean": 818.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 620.0}, "policy_reward_mean": {"policy_0": 81.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [660.0, 1260.0, 1220.0, 780.0, 680.0, 690.0, 845.0, 730.0, 670.0, 820.0, 420.0, 970.0, 815.0, 1175.0, 1030.0, 1010.0, 360.0, 1095.0, 280.0, 965.0, 945.0, 670.0, 390.0, 640.0, 460.0, 1040.0, 820.0, 530.0, 1130.0, 230.0, 890.0, 360.0, 1300.0, 850.0, 520.0, 455.0, 910.0, 870.0, 490.0, 895.0, 660.0, 1050.0, 1140.0, 455.0, 1315.0, 1330.0, 1060.0, 860.0, 1200.0, 795.0, 975.0, 625.0, 1030.0, 520.0, 885.0, 760.0, 1040.0, 270.0, 745.0, 590.0, 790.0, 600.0, 1040.0, 1150.0, 910.0, 460.0, 815.0, 865.0, 640.0, 1060.0, 385.0, 380.0, 1020.0, 1310.0, 335.0, 580.0, 475.0, 970.0, 1015.0, 1430.0, 530.0, 600.0, 490.0, 1240.0, 1005.0, 910.0, 290.0, 730.0, 855.0, 1240.0, 1030.0, 920.0, 1240.0, 870.0, 600.0, 670.0, 1065.0, 880.0, 1440.0, 860.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [250.0, 80.0, 30.0, 10.0, 10.0, 10.0, 50.0, 40.0, 170.0, 10.0, 230.0, 190.0, 10.0, 100.0, 360.0, 10.0, 70.0, 120.0, 90.0, 80.0, 110.0, 170.0, 110.0, 180.0, 70.0, 100.0, -50.0, 350.0, 110.0, 70.0, 10.0, 20.0, 40.0, 30.0, 20.0, 90.0, 180.0, 50.0, 50.0, 290.0, 50.0, 60.0, 180.0, 20.0, 50.0, 10.0, 20.0, 0.0, 220.0, 70.0, 40.0, 40.0, 210.0, 40.0, 40.0, 40.0, 40.0, 30.0, 30.0, 180.0, 40.0, 20.0, -5.0, 30.0, 60.0, 230.0, 200.0, 70.0, 190.0, 10.0, 150.0, 40.0, 80.0, 150.0, -40.0, -5.0, 10.0, 35.0, 30.0, 280.0, 80.0, 70.0, 60.0, 20.0, 250.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 70.0, 150.0, 180.0, 30.0, 0.0, 0.0, 310.0, 50.0, 20.0, 170.0, 30.0, 5.0, 30.0, 70.0, 90.0, 5.0, 20.0, 0.0, 0.0, 190.0, 160.0, -80.0, 280.0, 230.0, -10.0, 40.0, 30.0, 80.0, 50.0, 230.0, 90.0, 60.0, 60.0, 10.0, 290.0, 20.0, 30.0, 15.0, 10.0, 50.0, 40.0, 310.0, 70.0, 210.0, 80.0, 260.0, 10.0, 60.0, 85.0, 220.0, 30.0, 40.0, 100.0, 10.0, 20.0, 190.0, 10.0, 140.0, 270.0, 130.0, 160.0, 0.0, 80.0, 60.0, 80.0, 370.0, 40.0, 30.0, 60.0, 40.0, 10.0, 10.0, 60.0, 60.0, 0.0, 0.0, 80.0, 40.0, 60.0, 0.0, 140.0, 210.0, 200.0, 10.0, 20.0, 130.0, 25.0, 230.0, 130.0, 0.0, 30.0, 40.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 260.0, 30.0, 60.0, 0.0, 70.0, 35.0, 30.0, 300.0, 150.0, 30.0, 5.0, 80.0, 170.0, 230.0, 110.0, 20.0, 30.0, 40.0, 240.0, 20.0, -40.0, 0.0, 30.0, 20.0, 600.0, 50.0, -20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 0.0, 70.0, 40.0, 0.0, 40.0, 110.0, 90.0, 10.0, 20.0, 20.0, 120.0, 310.0, 0.0, -20.0, 40.0, 30.0, 110.0, 20.0, 30.0, 40.0, 30.0, 40.0, 80.0, 0.0, 20.0, 100.0, 100.0, 80.0, 90.0, 380.0, 70.0, 210.0, 30.0, 80.0, 50.0, 20.0, 30.0, 40.0, 90.0, 90.0, 90.0, 10.0, 170.0, 60.0, 90.0, 90.0, 90.0, 30.0, 0.0, 10.0, 10.0, 30.0, 30.0, 160.0, 90.0, 10.0, 160.0, 80.0, 50.0, 80.0, 120.0, 120.0, 70.0, 80.0, 60.0, 200.0, 270.0, 20.0, 20.0, 60.0, 10.0, 30.0, 30.0, 50.0, 0.0, 10.0, 0.0, 40.0, 210.0, 0.0, -10.0, 280.0, 270.0, 90.0, 20.0, -20.0, 10.0, 35.0, 10.0, 110.0, 50.0, 0.0, 10.0, 10.0, 30.0, 90.0, 15.0, 250.0, 110.0, 170.0, 160.0, 60.0, 270.0, 40.0, 110.0, 60.0, 70.0, 10.0, 200.0, 80.0, 40.0, 200.0, 140.0, 40.0, 90.0, 20.0, 30.0, 50.0, 0.0, 90.0, 40.0, 0.0, 120.0, 0.0, 110.0, 80.0, 30.0, 15.0, 90.0, 20.0, 40.0, 110.0, 10.0, 60.0, 20.0, 60.0, 30.0, 40.0, 80.0, 200.0, 110.0, 270.0, 50.0, 70.0, -40.0, 120.0, 10.0, 10.0, 70.0, 260.0, 30.0, 20.0, 100.0, 10.0, 100.0, -50.0, 320.0, 20.0, 10.0, 40.0, 20.0, 30.0, 160.0, 110.0, 30.0, 20.0, 50.0, 140.0, 90.0, 260.0, 45.0, 30.0, 40.0, 70.0, 70.0, 70.0, 80.0, 120.0, 40.0, 90.0, 5.0, 20.0, 60.0, 5.0, 250.0, 20.0, 50.0, 120.0, 40.0, 0.0, 620.0, 40.0, 60.0, 20.0, 20.0, 10.0, 120.0, -20.0, 60.0, 60.0, 120.0, 60.0, 20.0, 10.0, 310.0, 460.0, 60.0, 30.0, 40.0, 20.0, 10.0, 80.0, 40.0, 50.0, 15.0, 30.0, 140.0, 50.0, 120.0, 50.0, 300.0, 160.0, 390.0, 60.0, 80.0, 25.0, 80.0, 200.0, 150.0, 310.0, 40.0, 170.0, 0.0, 80.0, 60.0, 190.0, 130.0, 50.0, 80.0, 160.0, 30.0, 100.0, 120.0, 360.0, 50.0, 10.0, 100.0, 50.0, 110.0, 50.0, 100.0, 20.0, 20.0, 90.0, 180.0, 200.0, 40.0, 210.0, -60.0, 590.0, -10.0, 220.0, 60.0, 100.0, -30.0, 30.0, 90.0, 20.0, 190.0, 40.0, 165.0, 70.0, 110.0, 70.0, 30.0, 40.0, 60.0, 70.0, 30.0, 20.0, 290.0, 0.0, 80.0, 130.0, 135.0, 70.0, 150.0, 200.0, 0.0, 0.0, 50.0, 20.0, -35.0, 100.0, 30.0, 90.0, 170.0, 200.0, 120.0, 120.0, 80.0, 300.0, 10.0, 100.0, 70.0, 50.0, -20.0, 10.0, 0.0, 20.0, 70.0, 30.0, 150.0, 10.0, 0.0, 40.0, 190.0, 110.0, 35.0, 380.0, 20.0, 40.0, 20.0, 150.0, 50.0, 20.0, 60.0, 70.0, 30.0, 70.0, 80.0, 50.0, 60.0, -50.0, 240.0, 310.0, -100.0, 130.0, 120.0, 100.0, 50.0, 170.0, 50.0, 180.0, 130.0, 40.0, 70.0, 70.0, 30.0, 40.0, 0.0, 0.0, 25.0, 30.0, 20.0, 20.0, 35.0, 40.0, 100.0, 90.0, 25.0, 10.0, 20.0, 60.0, 70.0, 320.0, 10.0, 10.0, 70.0, 50.0, 70.0, 40.0, 40.0, 110.0, 90.0, 40.0, 70.0, 90.0, 60.0, 110.0, 80.0, 80.0, 70.0, 50.0, 80.0, 120.0, 50.0, 110.0, 30.0, 10.0, 160.0, 40.0, 10.0, 40.0, 180.0, 10.0, 10.0, 60.0, 50.0, 350.0, 30.0, 180.0, 20.0, 40.0, 200.0, 60.0, 50.0, 180.0, 230.0, 250.0, 40.0, 60.0, 120.0, 90.0, 10.0, 80.0, 90.0, 30.0, 220.0, 110.0, 50.0, 90.0, 320.0, 0.0, 30.0, 60.0, 0.0, 10.0, 90.0, 0.0, 20.0, 60.0, 20.0, 230.0, 0.0, 30.0, 0.0, 30.0, 90.0, 340.0, 0.0, 25.0, 60.0, 50.0, 130.0, 60.0, 30.0, 10.0, 130.0, -35.0, 470.0, 60.0, 20.0, 20.0, 60.0, 160.0, -30.0, 40.0, 260.0, -30.0, 40.0, 30.0, 100.0, 30.0, 10.0, 110.0, 50.0, 500.0, 150.0, 20.0, 50.0, 230.0, 0.0, 40.0, 0.0, 10.0, 60.0, 0.0, 5.0, 20.0, 0.0, 110.0, 240.0, 5.0, -5.0, 10.0, 0.0, 170.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 60.0, 10.0, 80.0, 160.0, 160.0, 100.0, 70.0, 80.0, 60.0, 220.0, 80.0, 110.0, 160.0, 90.0, 220.0, 20.0, 330.0, 170.0, 20.0, 130.0, 60.0, 10.0, 20.0, 10.0, 50.0, 60.0, 20.0, 110.0, 70.0, 30.0, -45.0, 170.0, 250.0, 45.0, -10.0, 10.0, 50.0, 20.0, 40.0, 0.0, 5.0, 50.0, 15.0, 10.0, 70.0, -10.0, 20.0, 90.0, 50.0, 90.0, 90.0, 40.0, 30.0, 380.0, 50.0, 70.0, 50.0, 70.0, 240.0, 40.0, 0.0, -80.0, 50.0, 260.0, 60.0, 50.0, -55.0, 190.0, 100.0, 40.0, 400.0, 20.0, 10.0, 450.0, 20.0, 90.0, 100.0, 270.0, 210.0, 130.0, 130.0, 40.0, 10.0, 10.0, 20.0, 50.0, 50.0, 20.0, 80.0, 190.0, 60.0, 150.0, 30.0, 40.0, 50.0, 40.0, 30.0, 60.0, 10.0, 20.0, 170.0, 10.0, 80.0, 20.0, 90.0, 90.0, 20.0, 140.0, 80.0, -70.0, 30.0, 290.0, 60.0, 100.0, 30.0, 150.0, 70.0, 60.0, 110.0, 70.0, 300.0, 220.0, 280.0, 25.0, -10.0, 90.0, 170.0, 70.0, 90.0, 30.0, 40.0, 80.0, 100.0, 160.0, 80.0, 100.0, 110.0, 250.0, 0.0, -10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 5.0, 20.0, 30.0, 60.0, 20.0, 125.0, 50.0, 0.0, 170.0, 30.0, 370.0, 0.0, 0.0, 140.0, -30.0, 0.0, 30.0, 20.0, 60.0, 80.0, 55.0, 80.0, 80.0, 290.0, 120.0, 40.0, 30.0, 50.0, 300.0, 20.0, 40.0, 110.0, 520.0, 60.0, 70.0, 40.0, 90.0, 80.0, 70.0, 310.0, 250.0, 80.0, 50.0, 130.0, 70.0, -100.0, 160.0, 170.0, 40.0, 10.0, 130.0, 90.0, 20.0, 30.0, 60.0, 210.0, 10.0, 450.0, 200.0, 0.0, 290.0, 40.0, 40.0, 80.0, 80.0, 50.0, -40.0, 110.0, 20.0, -40.0, 20.0, 170.0, 30.0, 440.0, 130.0, 30.0, 210.0, 10.0, 20.0, 40.0, 40.0, 20.0, 40.0, 150.0, 40.0, 30.0, 10.0, 380.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 30.0, 160.0, 70.0, 30.0, 90.0, 90.0, 90.0, 20.0, 30.0, 5.0, 40.0, 600.0, 70.0, 270.0, 30.0, 20.0, 10.0, 80.0, 70.0, 50.0, 180.0, 100.0, 290.0, 10.0, 210.0, 50.0, 250.0, 110.0, 180.0, 260.0, 40.0, 40.0, 130.0, 230.0, 40.0, 260.0, 30.0, -30.0, 10.0, 50.0, 80.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7114703224144585, "mean_inference_ms": 1.4837919184751065, "mean_action_processing_ms": 0.4488513701568796, "mean_env_wait_ms": 1.3644938121227712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013229131698608398, "StateBufferConnector_ms": 0.01033782958984375, "ViewRequirementAgentConnector_ms": 0.4210984706878662}, "num_episodes": 18, "episode_return_max": 1440.0, "episode_return_min": 230.0, "episode_return_mean": 818.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.071450180096136, "num_env_steps_trained_throughput_per_sec": 19.071450180096136, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 209324.732, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209324.687, "sample_time_ms": 2908.924, "learn_time_ms": 206394.844, "learn_throughput": 19.38, "synch_weights_time_ms": 11.94}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 40, "trial_id": "aa996_00000", "date": "2024-05-24_01-04-03", "timestamp": 1716527043, "time_this_iter_s": 209.74745512008667, "time_total_s": 8311.31450676918, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d6fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8311.31450676918, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 19.24915824915825, "ram_util_percent": 79.0020202020202}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3123494003083125, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.466355333643092, "policy_loss": -0.008734379931406591, "vf_loss": 6.47370647825499, "vf_explained_var": -0.00043763166037611307, "kl": 0.006916164017660393, "entropy": 0.7046839096485236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 380295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "env_runners": {"episode_reward_max": 1440.0, "episode_reward_min": 230.0, "episode_reward_mean": 815.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -280.0}, "policy_reward_max": {"policy_0": 620.0}, "policy_reward_mean": {"policy_0": 81.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 965.0, 945.0, 670.0, 390.0, 640.0, 460.0, 1040.0, 820.0, 530.0, 1130.0, 230.0, 890.0, 360.0, 1300.0, 850.0, 520.0, 455.0, 910.0, 870.0, 490.0, 895.0, 660.0, 1050.0, 1140.0, 455.0, 1315.0, 1330.0, 1060.0, 860.0, 1200.0, 795.0, 975.0, 625.0, 1030.0, 520.0, 885.0, 760.0, 1040.0, 270.0, 745.0, 590.0, 790.0, 600.0, 1040.0, 1150.0, 910.0, 460.0, 815.0, 865.0, 640.0, 1060.0, 385.0, 380.0, 1020.0, 1310.0, 335.0, 580.0, 475.0, 970.0, 1015.0, 1430.0, 530.0, 600.0, 490.0, 1240.0, 1005.0, 910.0, 290.0, 730.0, 855.0, 1240.0, 1030.0, 920.0, 1240.0, 870.0, 600.0, 670.0, 1065.0, 880.0, 1440.0, 860.0, 940.0, 1320.0, 990.0, 810.0, 680.0, 680.0, 880.0, 1085.0, 875.0, 520.0, 380.0, 700.0, 1120.0, 710.0, 1320.0, 480.0, 780.0, 610.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 30.0, 40.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 260.0, 30.0, 60.0, 0.0, 70.0, 35.0, 30.0, 300.0, 150.0, 30.0, 5.0, 80.0, 170.0, 230.0, 110.0, 20.0, 30.0, 40.0, 240.0, 20.0, -40.0, 0.0, 30.0, 20.0, 600.0, 50.0, -20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 0.0, 70.0, 40.0, 0.0, 40.0, 110.0, 90.0, 10.0, 20.0, 20.0, 120.0, 310.0, 0.0, -20.0, 40.0, 30.0, 110.0, 20.0, 30.0, 40.0, 30.0, 40.0, 80.0, 0.0, 20.0, 100.0, 100.0, 80.0, 90.0, 380.0, 70.0, 210.0, 30.0, 80.0, 50.0, 20.0, 30.0, 40.0, 90.0, 90.0, 90.0, 10.0, 170.0, 60.0, 90.0, 90.0, 90.0, 30.0, 0.0, 10.0, 10.0, 30.0, 30.0, 160.0, 90.0, 10.0, 160.0, 80.0, 50.0, 80.0, 120.0, 120.0, 70.0, 80.0, 60.0, 200.0, 270.0, 20.0, 20.0, 60.0, 10.0, 30.0, 30.0, 50.0, 0.0, 10.0, 0.0, 40.0, 210.0, 0.0, -10.0, 280.0, 270.0, 90.0, 20.0, -20.0, 10.0, 35.0, 10.0, 110.0, 50.0, 0.0, 10.0, 10.0, 30.0, 90.0, 15.0, 250.0, 110.0, 170.0, 160.0, 60.0, 270.0, 40.0, 110.0, 60.0, 70.0, 10.0, 200.0, 80.0, 40.0, 200.0, 140.0, 40.0, 90.0, 20.0, 30.0, 50.0, 0.0, 90.0, 40.0, 0.0, 120.0, 0.0, 110.0, 80.0, 30.0, 15.0, 90.0, 20.0, 40.0, 110.0, 10.0, 60.0, 20.0, 60.0, 30.0, 40.0, 80.0, 200.0, 110.0, 270.0, 50.0, 70.0, -40.0, 120.0, 10.0, 10.0, 70.0, 260.0, 30.0, 20.0, 100.0, 10.0, 100.0, -50.0, 320.0, 20.0, 10.0, 40.0, 20.0, 30.0, 160.0, 110.0, 30.0, 20.0, 50.0, 140.0, 90.0, 260.0, 45.0, 30.0, 40.0, 70.0, 70.0, 70.0, 80.0, 120.0, 40.0, 90.0, 5.0, 20.0, 60.0, 5.0, 250.0, 20.0, 50.0, 120.0, 40.0, 0.0, 620.0, 40.0, 60.0, 20.0, 20.0, 10.0, 120.0, -20.0, 60.0, 60.0, 120.0, 60.0, 20.0, 10.0, 310.0, 460.0, 60.0, 30.0, 40.0, 20.0, 10.0, 80.0, 40.0, 50.0, 15.0, 30.0, 140.0, 50.0, 120.0, 50.0, 300.0, 160.0, 390.0, 60.0, 80.0, 25.0, 80.0, 200.0, 150.0, 310.0, 40.0, 170.0, 0.0, 80.0, 60.0, 190.0, 130.0, 50.0, 80.0, 160.0, 30.0, 100.0, 120.0, 360.0, 50.0, 10.0, 100.0, 50.0, 110.0, 50.0, 100.0, 20.0, 20.0, 90.0, 180.0, 200.0, 40.0, 210.0, -60.0, 590.0, -10.0, 220.0, 60.0, 100.0, -30.0, 30.0, 90.0, 20.0, 190.0, 40.0, 165.0, 70.0, 110.0, 70.0, 30.0, 40.0, 60.0, 70.0, 30.0, 20.0, 290.0, 0.0, 80.0, 130.0, 135.0, 70.0, 150.0, 200.0, 0.0, 0.0, 50.0, 20.0, -35.0, 100.0, 30.0, 90.0, 170.0, 200.0, 120.0, 120.0, 80.0, 300.0, 10.0, 100.0, 70.0, 50.0, -20.0, 10.0, 0.0, 20.0, 70.0, 30.0, 150.0, 10.0, 0.0, 40.0, 190.0, 110.0, 35.0, 380.0, 20.0, 40.0, 20.0, 150.0, 50.0, 20.0, 60.0, 70.0, 30.0, 70.0, 80.0, 50.0, 60.0, -50.0, 240.0, 310.0, -100.0, 130.0, 120.0, 100.0, 50.0, 170.0, 50.0, 180.0, 130.0, 40.0, 70.0, 70.0, 30.0, 40.0, 0.0, 0.0, 25.0, 30.0, 20.0, 20.0, 35.0, 40.0, 100.0, 90.0, 25.0, 10.0, 20.0, 60.0, 70.0, 320.0, 10.0, 10.0, 70.0, 50.0, 70.0, 40.0, 40.0, 110.0, 90.0, 40.0, 70.0, 90.0, 60.0, 110.0, 80.0, 80.0, 70.0, 50.0, 80.0, 120.0, 50.0, 110.0, 30.0, 10.0, 160.0, 40.0, 10.0, 40.0, 180.0, 10.0, 10.0, 60.0, 50.0, 350.0, 30.0, 180.0, 20.0, 40.0, 200.0, 60.0, 50.0, 180.0, 230.0, 250.0, 40.0, 60.0, 120.0, 90.0, 10.0, 80.0, 90.0, 30.0, 220.0, 110.0, 50.0, 90.0, 320.0, 0.0, 30.0, 60.0, 0.0, 10.0, 90.0, 0.0, 20.0, 60.0, 20.0, 230.0, 0.0, 30.0, 0.0, 30.0, 90.0, 340.0, 0.0, 25.0, 60.0, 50.0, 130.0, 60.0, 30.0, 10.0, 130.0, -35.0, 470.0, 60.0, 20.0, 20.0, 60.0, 160.0, -30.0, 40.0, 260.0, -30.0, 40.0, 30.0, 100.0, 30.0, 10.0, 110.0, 50.0, 500.0, 150.0, 20.0, 50.0, 230.0, 0.0, 40.0, 0.0, 10.0, 60.0, 0.0, 5.0, 20.0, 0.0, 110.0, 240.0, 5.0, -5.0, 10.0, 0.0, 170.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 60.0, 10.0, 80.0, 160.0, 160.0, 100.0, 70.0, 80.0, 60.0, 220.0, 80.0, 110.0, 160.0, 90.0, 220.0, 20.0, 330.0, 170.0, 20.0, 130.0, 60.0, 10.0, 20.0, 10.0, 50.0, 60.0, 20.0, 110.0, 70.0, 30.0, -45.0, 170.0, 250.0, 45.0, -10.0, 10.0, 50.0, 20.0, 40.0, 0.0, 5.0, 50.0, 15.0, 10.0, 70.0, -10.0, 20.0, 90.0, 50.0, 90.0, 90.0, 40.0, 30.0, 380.0, 50.0, 70.0, 50.0, 70.0, 240.0, 40.0, 0.0, -80.0, 50.0, 260.0, 60.0, 50.0, -55.0, 190.0, 100.0, 40.0, 400.0, 20.0, 10.0, 450.0, 20.0, 90.0, 100.0, 270.0, 210.0, 130.0, 130.0, 40.0, 10.0, 10.0, 20.0, 50.0, 50.0, 20.0, 80.0, 190.0, 60.0, 150.0, 30.0, 40.0, 50.0, 40.0, 30.0, 60.0, 10.0, 20.0, 170.0, 10.0, 80.0, 20.0, 90.0, 90.0, 20.0, 140.0, 80.0, -70.0, 30.0, 290.0, 60.0, 100.0, 30.0, 150.0, 70.0, 60.0, 110.0, 70.0, 300.0, 220.0, 280.0, 25.0, -10.0, 90.0, 170.0, 70.0, 90.0, 30.0, 40.0, 80.0, 100.0, 160.0, 80.0, 100.0, 110.0, 250.0, 0.0, -10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 5.0, 20.0, 30.0, 60.0, 20.0, 125.0, 50.0, 0.0, 170.0, 30.0, 370.0, 0.0, 0.0, 140.0, -30.0, 0.0, 30.0, 20.0, 60.0, 80.0, 55.0, 80.0, 80.0, 290.0, 120.0, 40.0, 30.0, 50.0, 300.0, 20.0, 40.0, 110.0, 520.0, 60.0, 70.0, 40.0, 90.0, 80.0, 70.0, 310.0, 250.0, 80.0, 50.0, 130.0, 70.0, -100.0, 160.0, 170.0, 40.0, 10.0, 130.0, 90.0, 20.0, 30.0, 60.0, 210.0, 10.0, 450.0, 200.0, 0.0, 290.0, 40.0, 40.0, 80.0, 80.0, 50.0, -40.0, 110.0, 20.0, -40.0, 20.0, 170.0, 30.0, 440.0, 130.0, 30.0, 210.0, 10.0, 20.0, 40.0, 40.0, 20.0, 40.0, 150.0, 40.0, 30.0, 10.0, 380.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 30.0, 160.0, 70.0, 30.0, 90.0, 90.0, 90.0, 20.0, 30.0, 5.0, 40.0, 600.0, 70.0, 270.0, 30.0, 20.0, 10.0, 80.0, 70.0, 50.0, 180.0, 100.0, 290.0, 10.0, 210.0, 50.0, 250.0, 110.0, 180.0, 260.0, 40.0, 40.0, 130.0, 230.0, 40.0, 260.0, 30.0, -30.0, 10.0, 50.0, 80.0, 60.0, 220.0, 20.0, 70.0, 40.0, 60.0, 10.0, 70.0, 10.0, 370.0, 70.0, 70.0, 60.0, 30.0, 110.0, 190.0, 100.0, 100.0, 540.0, 70.0, 50.0, 120.0, 10.0, 120.0, 60.0, 70.0, 150.0, 80.0, 80.0, 230.0, 70.0, 80.0, 130.0, 20.0, 40.0, 50.0, 90.0, 170.0, 100.0, 30.0, 100.0, 80.0, 20.0, 220.0, 50.0, 0.0, -10.0, 200.0, -40.0, -20.0, 180.0, 110.0, 0.0, 30.0, 10.0, 20.0, 90.0, 80.0, 20.0, 150.0, 170.0, 130.0, 180.0, 20.0, -20.0, 0.0, 20.0, 160.0, 320.0, -10.0, 80.0, 30.0, 210.0, 270.0, 0.0, 100.0, 70.0, 160.0, 120.0, 50.0, 75.0, 30.0, 40.0, 370.0, 150.0, 20.0, 30.0, 200.0, 80.0, -25.0, -20.0, 70.0, 70.0, 0.0, 20.0, 40.0, 50.0, 20.0, 90.0, 20.0, 140.0, 30.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 90.0, 40.0, 90.0, 110.0, 0.0, 0.0, 10.0, 270.0, 50.0, 30.0, 190.0, 0.0, 40.0, 30.0, 190.0, 190.0, 10.0, 90.0, 170.0, 80.0, 110.0, 40.0, 210.0, 0.0, 50.0, 270.0, 10.0, 290.0, 40.0, 50.0, 0.0, -20.0, 20.0, 240.0, 30.0, 20.0, 60.0, 60.0, 450.0, 10.0, 110.0, 30.0, 310.0, 170.0, -280.0, 120.0, 30.0, 60.0, 90.0, 180.0, 20.0, 40.0, 50.0, 70.0, 30.0, 210.0, 110.0, 60.0, 140.0, 50.0, 60.0, 40.0, 10.0, 10.0, 250.0, 10.0, 10.0, 70.0, 80.0, 60.0, 50.0, 30.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7100983311813565, "mean_inference_ms": 1.4841495540255218, "mean_action_processing_ms": 0.4478593161508021, "mean_env_wait_ms": 1.3636190592892767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013064861297607422, "StateBufferConnector_ms": 0.01034092903137207, "ViewRequirementAgentConnector_ms": 0.4167792797088623}, "num_episodes": 18, "episode_return_max": 1440.0, "episode_return_min": 230.0, "episode_return_mean": 815.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.926690763274145, "num_env_steps_trained_throughput_per_sec": 18.926690763274145, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 1640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1640000, "timers": {"training_iteration_time_ms": 209694.394, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209694.346, "sample_time_ms": 2868.334, "learn_time_ms": 206804.856, "learn_throughput": 19.342, "synch_weights_time_ms": 11.609}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "done": false, "training_iteration": 41, "trial_id": "aa996_00000", "date": "2024-05-24_01-07-35", "timestamp": 1716527255, "time_this_iter_s": 211.3720588684082, "time_total_s": 8522.686565637589, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ff550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8522.686565637589, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 21.48160535117057, "ram_util_percent": 79.62441471571906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.420640101930458, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.316385510173468, "policy_loss": -0.009485964852070814, "vf_loss": 6.324490622945995, "vf_explained_var": 0.0007167618305157549, "kl": 0.006904283679379574, "entropy": 0.7070447363982947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 389685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 1440.0, "episode_reward_min": 270.0, "episode_reward_mean": 839.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 620.0}, "policy_reward_mean": {"policy_0": 83.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [910.0, 870.0, 490.0, 895.0, 660.0, 1050.0, 1140.0, 455.0, 1315.0, 1330.0, 1060.0, 860.0, 1200.0, 795.0, 975.0, 625.0, 1030.0, 520.0, 885.0, 760.0, 1040.0, 270.0, 745.0, 590.0, 790.0, 600.0, 1040.0, 1150.0, 910.0, 460.0, 815.0, 865.0, 640.0, 1060.0, 385.0, 380.0, 1020.0, 1310.0, 335.0, 580.0, 475.0, 970.0, 1015.0, 1430.0, 530.0, 600.0, 490.0, 1240.0, 1005.0, 910.0, 290.0, 730.0, 855.0, 1240.0, 1030.0, 920.0, 1240.0, 870.0, 600.0, 670.0, 1065.0, 880.0, 1440.0, 860.0, 940.0, 1320.0, 990.0, 810.0, 680.0, 680.0, 880.0, 1085.0, 875.0, 520.0, 380.0, 700.0, 1120.0, 710.0, 1320.0, 480.0, 780.0, 610.0, 330.0, 335.0, 710.0, 1430.0, 970.0, 520.0, 1340.0, 595.0, 1080.0, 1070.0, 910.0, 725.0, 1150.0, 330.0, 1180.0, 1030.0, 310.0, 930.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 80.0, 200.0, 110.0, 270.0, 50.0, 70.0, -40.0, 120.0, 10.0, 10.0, 70.0, 260.0, 30.0, 20.0, 100.0, 10.0, 100.0, -50.0, 320.0, 20.0, 10.0, 40.0, 20.0, 30.0, 160.0, 110.0, 30.0, 20.0, 50.0, 140.0, 90.0, 260.0, 45.0, 30.0, 40.0, 70.0, 70.0, 70.0, 80.0, 120.0, 40.0, 90.0, 5.0, 20.0, 60.0, 5.0, 250.0, 20.0, 50.0, 120.0, 40.0, 0.0, 620.0, 40.0, 60.0, 20.0, 20.0, 10.0, 120.0, -20.0, 60.0, 60.0, 120.0, 60.0, 20.0, 10.0, 310.0, 460.0, 60.0, 30.0, 40.0, 20.0, 10.0, 80.0, 40.0, 50.0, 15.0, 30.0, 140.0, 50.0, 120.0, 50.0, 300.0, 160.0, 390.0, 60.0, 80.0, 25.0, 80.0, 200.0, 150.0, 310.0, 40.0, 170.0, 0.0, 80.0, 60.0, 190.0, 130.0, 50.0, 80.0, 160.0, 30.0, 100.0, 120.0, 360.0, 50.0, 10.0, 100.0, 50.0, 110.0, 50.0, 100.0, 20.0, 20.0, 90.0, 180.0, 200.0, 40.0, 210.0, -60.0, 590.0, -10.0, 220.0, 60.0, 100.0, -30.0, 30.0, 90.0, 20.0, 190.0, 40.0, 165.0, 70.0, 110.0, 70.0, 30.0, 40.0, 60.0, 70.0, 30.0, 20.0, 290.0, 0.0, 80.0, 130.0, 135.0, 70.0, 150.0, 200.0, 0.0, 0.0, 50.0, 20.0, -35.0, 100.0, 30.0, 90.0, 170.0, 200.0, 120.0, 120.0, 80.0, 300.0, 10.0, 100.0, 70.0, 50.0, -20.0, 10.0, 0.0, 20.0, 70.0, 30.0, 150.0, 10.0, 0.0, 40.0, 190.0, 110.0, 35.0, 380.0, 20.0, 40.0, 20.0, 150.0, 50.0, 20.0, 60.0, 70.0, 30.0, 70.0, 80.0, 50.0, 60.0, -50.0, 240.0, 310.0, -100.0, 130.0, 120.0, 100.0, 50.0, 170.0, 50.0, 180.0, 130.0, 40.0, 70.0, 70.0, 30.0, 40.0, 0.0, 0.0, 25.0, 30.0, 20.0, 20.0, 35.0, 40.0, 100.0, 90.0, 25.0, 10.0, 20.0, 60.0, 70.0, 320.0, 10.0, 10.0, 70.0, 50.0, 70.0, 40.0, 40.0, 110.0, 90.0, 40.0, 70.0, 90.0, 60.0, 110.0, 80.0, 80.0, 70.0, 50.0, 80.0, 120.0, 50.0, 110.0, 30.0, 10.0, 160.0, 40.0, 10.0, 40.0, 180.0, 10.0, 10.0, 60.0, 50.0, 350.0, 30.0, 180.0, 20.0, 40.0, 200.0, 60.0, 50.0, 180.0, 230.0, 250.0, 40.0, 60.0, 120.0, 90.0, 10.0, 80.0, 90.0, 30.0, 220.0, 110.0, 50.0, 90.0, 320.0, 0.0, 30.0, 60.0, 0.0, 10.0, 90.0, 0.0, 20.0, 60.0, 20.0, 230.0, 0.0, 30.0, 0.0, 30.0, 90.0, 340.0, 0.0, 25.0, 60.0, 50.0, 130.0, 60.0, 30.0, 10.0, 130.0, -35.0, 470.0, 60.0, 20.0, 20.0, 60.0, 160.0, -30.0, 40.0, 260.0, -30.0, 40.0, 30.0, 100.0, 30.0, 10.0, 110.0, 50.0, 500.0, 150.0, 20.0, 50.0, 230.0, 0.0, 40.0, 0.0, 10.0, 60.0, 0.0, 5.0, 20.0, 0.0, 110.0, 240.0, 5.0, -5.0, 10.0, 0.0, 170.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 60.0, 10.0, 80.0, 160.0, 160.0, 100.0, 70.0, 80.0, 60.0, 220.0, 80.0, 110.0, 160.0, 90.0, 220.0, 20.0, 330.0, 170.0, 20.0, 130.0, 60.0, 10.0, 20.0, 10.0, 50.0, 60.0, 20.0, 110.0, 70.0, 30.0, -45.0, 170.0, 250.0, 45.0, -10.0, 10.0, 50.0, 20.0, 40.0, 0.0, 5.0, 50.0, 15.0, 10.0, 70.0, -10.0, 20.0, 90.0, 50.0, 90.0, 90.0, 40.0, 30.0, 380.0, 50.0, 70.0, 50.0, 70.0, 240.0, 40.0, 0.0, -80.0, 50.0, 260.0, 60.0, 50.0, -55.0, 190.0, 100.0, 40.0, 400.0, 20.0, 10.0, 450.0, 20.0, 90.0, 100.0, 270.0, 210.0, 130.0, 130.0, 40.0, 10.0, 10.0, 20.0, 50.0, 50.0, 20.0, 80.0, 190.0, 60.0, 150.0, 30.0, 40.0, 50.0, 40.0, 30.0, 60.0, 10.0, 20.0, 170.0, 10.0, 80.0, 20.0, 90.0, 90.0, 20.0, 140.0, 80.0, -70.0, 30.0, 290.0, 60.0, 100.0, 30.0, 150.0, 70.0, 60.0, 110.0, 70.0, 300.0, 220.0, 280.0, 25.0, -10.0, 90.0, 170.0, 70.0, 90.0, 30.0, 40.0, 80.0, 100.0, 160.0, 80.0, 100.0, 110.0, 250.0, 0.0, -10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 5.0, 20.0, 30.0, 60.0, 20.0, 125.0, 50.0, 0.0, 170.0, 30.0, 370.0, 0.0, 0.0, 140.0, -30.0, 0.0, 30.0, 20.0, 60.0, 80.0, 55.0, 80.0, 80.0, 290.0, 120.0, 40.0, 30.0, 50.0, 300.0, 20.0, 40.0, 110.0, 520.0, 60.0, 70.0, 40.0, 90.0, 80.0, 70.0, 310.0, 250.0, 80.0, 50.0, 130.0, 70.0, -100.0, 160.0, 170.0, 40.0, 10.0, 130.0, 90.0, 20.0, 30.0, 60.0, 210.0, 10.0, 450.0, 200.0, 0.0, 290.0, 40.0, 40.0, 80.0, 80.0, 50.0, -40.0, 110.0, 20.0, -40.0, 20.0, 170.0, 30.0, 440.0, 130.0, 30.0, 210.0, 10.0, 20.0, 40.0, 40.0, 20.0, 40.0, 150.0, 40.0, 30.0, 10.0, 380.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 30.0, 160.0, 70.0, 30.0, 90.0, 90.0, 90.0, 20.0, 30.0, 5.0, 40.0, 600.0, 70.0, 270.0, 30.0, 20.0, 10.0, 80.0, 70.0, 50.0, 180.0, 100.0, 290.0, 10.0, 210.0, 50.0, 250.0, 110.0, 180.0, 260.0, 40.0, 40.0, 130.0, 230.0, 40.0, 260.0, 30.0, -30.0, 10.0, 50.0, 80.0, 60.0, 220.0, 20.0, 70.0, 40.0, 60.0, 10.0, 70.0, 10.0, 370.0, 70.0, 70.0, 60.0, 30.0, 110.0, 190.0, 100.0, 100.0, 540.0, 70.0, 50.0, 120.0, 10.0, 120.0, 60.0, 70.0, 150.0, 80.0, 80.0, 230.0, 70.0, 80.0, 130.0, 20.0, 40.0, 50.0, 90.0, 170.0, 100.0, 30.0, 100.0, 80.0, 20.0, 220.0, 50.0, 0.0, -10.0, 200.0, -40.0, -20.0, 180.0, 110.0, 0.0, 30.0, 10.0, 20.0, 90.0, 80.0, 20.0, 150.0, 170.0, 130.0, 180.0, 20.0, -20.0, 0.0, 20.0, 160.0, 320.0, -10.0, 80.0, 30.0, 210.0, 270.0, 0.0, 100.0, 70.0, 160.0, 120.0, 50.0, 75.0, 30.0, 40.0, 370.0, 150.0, 20.0, 30.0, 200.0, 80.0, -25.0, -20.0, 70.0, 70.0, 0.0, 20.0, 40.0, 50.0, 20.0, 90.0, 20.0, 140.0, 30.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 90.0, 40.0, 90.0, 110.0, 0.0, 0.0, 10.0, 270.0, 50.0, 30.0, 190.0, 0.0, 40.0, 30.0, 190.0, 190.0, 10.0, 90.0, 170.0, 80.0, 110.0, 40.0, 210.0, 0.0, 50.0, 270.0, 10.0, 290.0, 40.0, 50.0, 0.0, -20.0, 20.0, 240.0, 30.0, 20.0, 60.0, 60.0, 450.0, 10.0, 110.0, 30.0, 310.0, 170.0, -280.0, 120.0, 30.0, 60.0, 90.0, 180.0, 20.0, 40.0, 50.0, 70.0, 30.0, 210.0, 110.0, 60.0, 140.0, 50.0, 60.0, 40.0, 10.0, 10.0, 250.0, 10.0, 10.0, 70.0, 80.0, 60.0, 50.0, 30.0, 40.0, 0.0, 30.0, 160.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 150.0, 10.0, 20.0, 80.0, 0.0, 30.0, 10.0, 20.0, -5.0, 20.0, 80.0, 50.0, 90.0, 50.0, 110.0, 110.0, 20.0, 120.0, 20.0, 60.0, 140.0, 70.0, 30.0, 210.0, 100.0, 360.0, 50.0, 140.0, 280.0, 50.0, 140.0, 20.0, 130.0, 40.0, 70.0, 210.0, 40.0, 70.0, 180.0, 70.0, 40.0, 40.0, 60.0, 50.0, 20.0, 10.0, 390.0, -95.0, 50.0, -45.0, 310.0, 80.0, 50.0, 80.0, 30.0, 390.0, 60.0, 70.0, 190.0, 80.0, 40.0, 80.0, 15.0, 70.0, 140.0, 40.0, 90.0, 0.0, 110.0, 10.0, 40.0, -10.0, 120.0, 60.0, 50.0, 120.0, 10.0, 320.0, 110.0, 260.0, 180.0, 140.0, 100.0, 20.0, 100.0, 20.0, 30.0, 70.0, 330.0, 80.0, 0.0, 30.0, 370.0, 80.0, 130.0, 0.0, 10.0, 70.0, 60.0, 160.0, 30.0, 110.0, 10.0, 40.0, 25.0, 390.0, 80.0, 10.0, 20.0, 10.0, 20.0, 100.0, 380.0, 10.0, 160.0, 500.0, 40.0, -290.0, 190.0, 40.0, 30.0, 180.0, 20.0, 70.0, 60.0, -80.0, 130.0, 70.0, -50.0, -100.0, 170.0, 260.0, 30.0, 110.0, 70.0, -20.0, 20.0, 150.0, 120.0, 270.0, 160.0, 200.0, 30.0, 370.0, 50.0, 50.0, 60.0, 40.0, 20.0, 50.0, 0.0, 10.0, 180.0, 10.0, 80.0, 0.0, 0.0, -30.0, 40.0, 20.0, 80.0, 10.0, 10.0, 20.0, 350.0, 130.0, 70.0, 110.0, 90.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7088697915042723, "mean_inference_ms": 1.4852156383502129, "mean_action_processing_ms": 0.4469630078486281, "mean_env_wait_ms": 1.3630411154976836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013012886047363281, "StateBufferConnector_ms": 0.010520696640014648, "ViewRequirementAgentConnector_ms": 0.42381763458251953}, "num_episodes": 18, "episode_return_max": 1440.0, "episode_return_min": 270.0, "episode_return_mean": 839.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.04197918301159, "num_env_steps_trained_throughput_per_sec": 19.04197918301159, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 209788.309, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209788.261, "sample_time_ms": 2899.224, "learn_time_ms": 206867.645, "learn_throughput": 19.336, "synch_weights_time_ms": 11.716}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 42, "trial_id": "aa996_00000", "date": "2024-05-24_01-11-05", "timestamp": 1716527465, "time_this_iter_s": 210.07244300842285, "time_total_s": 8732.759008646011, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309bf310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8732.759008646011, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 19.816161616161615, "ram_util_percent": 79.59898989898988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4045959295429236, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.98488182305528, "policy_loss": -0.010156746982575491, "vf_loss": 6.99363149652085, "vf_explained_var": 0.0005097386745599132, "kl": 0.007035376216920169, "entropy": 0.6358118771046749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 399075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "env_runners": {"episode_reward_max": 1440.0, "episode_reward_min": 270.0, "episode_reward_mean": 829.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 82.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [745.0, 590.0, 790.0, 600.0, 1040.0, 1150.0, 910.0, 460.0, 815.0, 865.0, 640.0, 1060.0, 385.0, 380.0, 1020.0, 1310.0, 335.0, 580.0, 475.0, 970.0, 1015.0, 1430.0, 530.0, 600.0, 490.0, 1240.0, 1005.0, 910.0, 290.0, 730.0, 855.0, 1240.0, 1030.0, 920.0, 1240.0, 870.0, 600.0, 670.0, 1065.0, 880.0, 1440.0, 860.0, 940.0, 1320.0, 990.0, 810.0, 680.0, 680.0, 880.0, 1085.0, 875.0, 520.0, 380.0, 700.0, 1120.0, 710.0, 1320.0, 480.0, 780.0, 610.0, 330.0, 335.0, 710.0, 1430.0, 970.0, 520.0, 1340.0, 595.0, 1080.0, 1070.0, 910.0, 725.0, 1150.0, 330.0, 1180.0, 1030.0, 310.0, 930.0, 780.0, 325.0, 1205.0, 380.0, 1020.0, 930.0, 270.0, 1160.0, 640.0, 1020.0, 880.0, 635.0, 930.0, 1130.0, 820.0, 780.0, 1090.0, 790.0, 585.0, 1020.0, 780.0, 965.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 100.0, 90.0, 25.0, 10.0, 20.0, 60.0, 70.0, 320.0, 10.0, 10.0, 70.0, 50.0, 70.0, 40.0, 40.0, 110.0, 90.0, 40.0, 70.0, 90.0, 60.0, 110.0, 80.0, 80.0, 70.0, 50.0, 80.0, 120.0, 50.0, 110.0, 30.0, 10.0, 160.0, 40.0, 10.0, 40.0, 180.0, 10.0, 10.0, 60.0, 50.0, 350.0, 30.0, 180.0, 20.0, 40.0, 200.0, 60.0, 50.0, 180.0, 230.0, 250.0, 40.0, 60.0, 120.0, 90.0, 10.0, 80.0, 90.0, 30.0, 220.0, 110.0, 50.0, 90.0, 320.0, 0.0, 30.0, 60.0, 0.0, 10.0, 90.0, 0.0, 20.0, 60.0, 20.0, 230.0, 0.0, 30.0, 0.0, 30.0, 90.0, 340.0, 0.0, 25.0, 60.0, 50.0, 130.0, 60.0, 30.0, 10.0, 130.0, -35.0, 470.0, 60.0, 20.0, 20.0, 60.0, 160.0, -30.0, 40.0, 260.0, -30.0, 40.0, 30.0, 100.0, 30.0, 10.0, 110.0, 50.0, 500.0, 150.0, 20.0, 50.0, 230.0, 0.0, 40.0, 0.0, 10.0, 60.0, 0.0, 5.0, 20.0, 0.0, 110.0, 240.0, 5.0, -5.0, 10.0, 0.0, 170.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 60.0, 10.0, 80.0, 160.0, 160.0, 100.0, 70.0, 80.0, 60.0, 220.0, 80.0, 110.0, 160.0, 90.0, 220.0, 20.0, 330.0, 170.0, 20.0, 130.0, 60.0, 10.0, 20.0, 10.0, 50.0, 60.0, 20.0, 110.0, 70.0, 30.0, -45.0, 170.0, 250.0, 45.0, -10.0, 10.0, 50.0, 20.0, 40.0, 0.0, 5.0, 50.0, 15.0, 10.0, 70.0, -10.0, 20.0, 90.0, 50.0, 90.0, 90.0, 40.0, 30.0, 380.0, 50.0, 70.0, 50.0, 70.0, 240.0, 40.0, 0.0, -80.0, 50.0, 260.0, 60.0, 50.0, -55.0, 190.0, 100.0, 40.0, 400.0, 20.0, 10.0, 450.0, 20.0, 90.0, 100.0, 270.0, 210.0, 130.0, 130.0, 40.0, 10.0, 10.0, 20.0, 50.0, 50.0, 20.0, 80.0, 190.0, 60.0, 150.0, 30.0, 40.0, 50.0, 40.0, 30.0, 60.0, 10.0, 20.0, 170.0, 10.0, 80.0, 20.0, 90.0, 90.0, 20.0, 140.0, 80.0, -70.0, 30.0, 290.0, 60.0, 100.0, 30.0, 150.0, 70.0, 60.0, 110.0, 70.0, 300.0, 220.0, 280.0, 25.0, -10.0, 90.0, 170.0, 70.0, 90.0, 30.0, 40.0, 80.0, 100.0, 160.0, 80.0, 100.0, 110.0, 250.0, 0.0, -10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 5.0, 20.0, 30.0, 60.0, 20.0, 125.0, 50.0, 0.0, 170.0, 30.0, 370.0, 0.0, 0.0, 140.0, -30.0, 0.0, 30.0, 20.0, 60.0, 80.0, 55.0, 80.0, 80.0, 290.0, 120.0, 40.0, 30.0, 50.0, 300.0, 20.0, 40.0, 110.0, 520.0, 60.0, 70.0, 40.0, 90.0, 80.0, 70.0, 310.0, 250.0, 80.0, 50.0, 130.0, 70.0, -100.0, 160.0, 170.0, 40.0, 10.0, 130.0, 90.0, 20.0, 30.0, 60.0, 210.0, 10.0, 450.0, 200.0, 0.0, 290.0, 40.0, 40.0, 80.0, 80.0, 50.0, -40.0, 110.0, 20.0, -40.0, 20.0, 170.0, 30.0, 440.0, 130.0, 30.0, 210.0, 10.0, 20.0, 40.0, 40.0, 20.0, 40.0, 150.0, 40.0, 30.0, 10.0, 380.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 30.0, 160.0, 70.0, 30.0, 90.0, 90.0, 90.0, 20.0, 30.0, 5.0, 40.0, 600.0, 70.0, 270.0, 30.0, 20.0, 10.0, 80.0, 70.0, 50.0, 180.0, 100.0, 290.0, 10.0, 210.0, 50.0, 250.0, 110.0, 180.0, 260.0, 40.0, 40.0, 130.0, 230.0, 40.0, 260.0, 30.0, -30.0, 10.0, 50.0, 80.0, 60.0, 220.0, 20.0, 70.0, 40.0, 60.0, 10.0, 70.0, 10.0, 370.0, 70.0, 70.0, 60.0, 30.0, 110.0, 190.0, 100.0, 100.0, 540.0, 70.0, 50.0, 120.0, 10.0, 120.0, 60.0, 70.0, 150.0, 80.0, 80.0, 230.0, 70.0, 80.0, 130.0, 20.0, 40.0, 50.0, 90.0, 170.0, 100.0, 30.0, 100.0, 80.0, 20.0, 220.0, 50.0, 0.0, -10.0, 200.0, -40.0, -20.0, 180.0, 110.0, 0.0, 30.0, 10.0, 20.0, 90.0, 80.0, 20.0, 150.0, 170.0, 130.0, 180.0, 20.0, -20.0, 0.0, 20.0, 160.0, 320.0, -10.0, 80.0, 30.0, 210.0, 270.0, 0.0, 100.0, 70.0, 160.0, 120.0, 50.0, 75.0, 30.0, 40.0, 370.0, 150.0, 20.0, 30.0, 200.0, 80.0, -25.0, -20.0, 70.0, 70.0, 0.0, 20.0, 40.0, 50.0, 20.0, 90.0, 20.0, 140.0, 30.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 90.0, 40.0, 90.0, 110.0, 0.0, 0.0, 10.0, 270.0, 50.0, 30.0, 190.0, 0.0, 40.0, 30.0, 190.0, 190.0, 10.0, 90.0, 170.0, 80.0, 110.0, 40.0, 210.0, 0.0, 50.0, 270.0, 10.0, 290.0, 40.0, 50.0, 0.0, -20.0, 20.0, 240.0, 30.0, 20.0, 60.0, 60.0, 450.0, 10.0, 110.0, 30.0, 310.0, 170.0, -280.0, 120.0, 30.0, 60.0, 90.0, 180.0, 20.0, 40.0, 50.0, 70.0, 30.0, 210.0, 110.0, 60.0, 140.0, 50.0, 60.0, 40.0, 10.0, 10.0, 250.0, 10.0, 10.0, 70.0, 80.0, 60.0, 50.0, 30.0, 40.0, 0.0, 30.0, 160.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 150.0, 10.0, 20.0, 80.0, 0.0, 30.0, 10.0, 20.0, -5.0, 20.0, 80.0, 50.0, 90.0, 50.0, 110.0, 110.0, 20.0, 120.0, 20.0, 60.0, 140.0, 70.0, 30.0, 210.0, 100.0, 360.0, 50.0, 140.0, 280.0, 50.0, 140.0, 20.0, 130.0, 40.0, 70.0, 210.0, 40.0, 70.0, 180.0, 70.0, 40.0, 40.0, 60.0, 50.0, 20.0, 10.0, 390.0, -95.0, 50.0, -45.0, 310.0, 80.0, 50.0, 80.0, 30.0, 390.0, 60.0, 70.0, 190.0, 80.0, 40.0, 80.0, 15.0, 70.0, 140.0, 40.0, 90.0, 0.0, 110.0, 10.0, 40.0, -10.0, 120.0, 60.0, 50.0, 120.0, 10.0, 320.0, 110.0, 260.0, 180.0, 140.0, 100.0, 20.0, 100.0, 20.0, 30.0, 70.0, 330.0, 80.0, 0.0, 30.0, 370.0, 80.0, 130.0, 0.0, 10.0, 70.0, 60.0, 160.0, 30.0, 110.0, 10.0, 40.0, 25.0, 390.0, 80.0, 10.0, 20.0, 10.0, 20.0, 100.0, 380.0, 10.0, 160.0, 500.0, 40.0, -290.0, 190.0, 40.0, 30.0, 180.0, 20.0, 70.0, 60.0, -80.0, 130.0, 70.0, -50.0, -100.0, 170.0, 260.0, 30.0, 110.0, 70.0, -20.0, 20.0, 150.0, 120.0, 270.0, 160.0, 200.0, 30.0, 370.0, 50.0, 50.0, 60.0, 40.0, 20.0, 50.0, 0.0, 10.0, 180.0, 10.0, 80.0, 0.0, 0.0, -30.0, 40.0, 20.0, 80.0, 10.0, 10.0, 20.0, 350.0, 130.0, 70.0, 110.0, 90.0, 60.0, 130.0, 10.0, 120.0, 30.0, 60.0, 30.0, 60.0, -30.0, 70.0, 300.0, -5.0, 30.0, 100.0, 0.0, 10.0, 0.0, 20.0, 110.0, 20.0, 40.0, 25.0, 110.0, 20.0, 60.0, 10.0, 370.0, 280.0, 290.0, 40.0, 0.0, 10.0, 0.0, 70.0, 30.0, 40.0, 120.0, 40.0, 50.0, 20.0, 0.0, 30.0, 30.0, 110.0, -20.0, 40.0, 40.0, 80.0, -40.0, 340.0, 410.0, 120.0, 110.0, 70.0, 60.0, 90.0, 50.0, 90.0, 180.0, 130.0, 30.0, 80.0, 30.0, 50.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 60.0, 50.0, 200.0, 60.0, 270.0, 10.0, 180.0, 270.0, 60.0, 0.0, 30.0, 190.0, 150.0, -20.0, 30.0, 0.0, 60.0, 50.0, 110.0, 40.0, 70.0, 80.0, 80.0, 400.0, 180.0, 10.0, 150.0, 20.0, -40.0, 70.0, 0.0, 80.0, 30.0, 70.0, 20.0, 50.0, 80.0, 310.0, 90.0, 150.0, 70.0, 40.0, 40.0, 0.0, 180.0, 100.0, 55.0, 70.0, 80.0, 0.0, 40.0, -20.0, 260.0, 20.0, 330.0, 65.0, 40.0, 120.0, 5.0, 70.0, 40.0, 30.0, 30.0, 70.0, 450.0, 180.0, 80.0, 50.0, 160.0, 40.0, 0.0, -40.0, 160.0, 30.0, 150.0, 40.0, 120.0, 160.0, 10.0, 190.0, 130.0, 70.0, 0.0, 140.0, 40.0, 20.0, 20.0, 60.0, 50.0, 250.0, 130.0, 10.0, 180.0, 40.0, 260.0, 280.0, 50.0, 70.0, 80.0, -10.0, 60.0, -40.0, 190.0, 80.0, 30.0, 20.0, 90.0, 110.0, 210.0, 40.0, 80.0, 190.0, 0.0, 20.0, 170.0, 10.0, 30.0, -130.0, 200.0, 15.0, 60.0, 50.0, 90.0, 20.0, 380.0, 180.0, 80.0, 40.0, 80.0, 40.0, 160.0, 150.0, 130.0, 30.0, 80.0, 100.0, 20.0, 10.0, 70.0, 30.0, 90.0, 195.0, 30.0, 240.0, 40.0, 70.0, 70.0, 90.0, 80.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7068763237074343, "mean_inference_ms": 1.4849324397765877, "mean_action_processing_ms": 0.4457977208704885, "mean_env_wait_ms": 1.36191240929086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013775825500488281, "StateBufferConnector_ms": 0.010599136352539062, "ViewRequirementAgentConnector_ms": 0.42145824432373047}, "num_episodes": 22, "episode_return_max": 1440.0, "episode_return_min": 270.0, "episode_return_mean": 829.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.164941880277585, "num_env_steps_trained_throughput_per_sec": 19.164941880277585, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 1720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1720000, "timers": {"training_iteration_time_ms": 209505.999, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209505.952, "sample_time_ms": 2917.004, "learn_time_ms": 206567.368, "learn_throughput": 19.364, "synch_weights_time_ms": 11.817}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "done": false, "training_iteration": 43, "trial_id": "aa996_00000", "date": "2024-05-24_01-14-34", "timestamp": 1716527674, "time_this_iter_s": 208.72291088104248, "time_total_s": 8941.481919527054, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309bfc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8941.481919527054, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 19.14915254237288, "ram_util_percent": 78.54271186440678}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.195261412878006, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4335204992812285, "policy_loss": -0.008552657647000842, "vf_loss": 6.440781501459237, "vf_explained_var": -0.00042920889564977287, "kl": 0.006458266010877054, "entropy": 0.6238800404297785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 408465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 1560.0, "episode_reward_min": 270.0, "episode_reward_mean": 833.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 83.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.0, 490.0, 1240.0, 1005.0, 910.0, 290.0, 730.0, 855.0, 1240.0, 1030.0, 920.0, 1240.0, 870.0, 600.0, 670.0, 1065.0, 880.0, 1440.0, 860.0, 940.0, 1320.0, 990.0, 810.0, 680.0, 680.0, 880.0, 1085.0, 875.0, 520.0, 380.0, 700.0, 1120.0, 710.0, 1320.0, 480.0, 780.0, 610.0, 330.0, 335.0, 710.0, 1430.0, 970.0, 520.0, 1340.0, 595.0, 1080.0, 1070.0, 910.0, 725.0, 1150.0, 330.0, 1180.0, 1030.0, 310.0, 930.0, 780.0, 325.0, 1205.0, 380.0, 1020.0, 930.0, 270.0, 1160.0, 640.0, 1020.0, 880.0, 635.0, 930.0, 1130.0, 820.0, 780.0, 1090.0, 790.0, 585.0, 1020.0, 780.0, 965.0, 930.0, 1460.0, 630.0, 680.0, 1130.0, 830.0, 1560.0, 945.0, 640.0, 325.0, 290.0, 520.0, 570.0, 1110.0, 910.0, 560.0, 720.0, 995.0, 595.0, 370.0, 1290.0, 560.0, 795.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 30.0, 40.0, 50.0, 40.0, 30.0, 60.0, 10.0, 20.0, 170.0, 10.0, 80.0, 20.0, 90.0, 90.0, 20.0, 140.0, 80.0, -70.0, 30.0, 290.0, 60.0, 100.0, 30.0, 150.0, 70.0, 60.0, 110.0, 70.0, 300.0, 220.0, 280.0, 25.0, -10.0, 90.0, 170.0, 70.0, 90.0, 30.0, 40.0, 80.0, 100.0, 160.0, 80.0, 100.0, 110.0, 250.0, 0.0, -10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 5.0, 20.0, 30.0, 60.0, 20.0, 125.0, 50.0, 0.0, 170.0, 30.0, 370.0, 0.0, 0.0, 140.0, -30.0, 0.0, 30.0, 20.0, 60.0, 80.0, 55.0, 80.0, 80.0, 290.0, 120.0, 40.0, 30.0, 50.0, 300.0, 20.0, 40.0, 110.0, 520.0, 60.0, 70.0, 40.0, 90.0, 80.0, 70.0, 310.0, 250.0, 80.0, 50.0, 130.0, 70.0, -100.0, 160.0, 170.0, 40.0, 10.0, 130.0, 90.0, 20.0, 30.0, 60.0, 210.0, 10.0, 450.0, 200.0, 0.0, 290.0, 40.0, 40.0, 80.0, 80.0, 50.0, -40.0, 110.0, 20.0, -40.0, 20.0, 170.0, 30.0, 440.0, 130.0, 30.0, 210.0, 10.0, 20.0, 40.0, 40.0, 20.0, 40.0, 150.0, 40.0, 30.0, 10.0, 380.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 30.0, 160.0, 70.0, 30.0, 90.0, 90.0, 90.0, 20.0, 30.0, 5.0, 40.0, 600.0, 70.0, 270.0, 30.0, 20.0, 10.0, 80.0, 70.0, 50.0, 180.0, 100.0, 290.0, 10.0, 210.0, 50.0, 250.0, 110.0, 180.0, 260.0, 40.0, 40.0, 130.0, 230.0, 40.0, 260.0, 30.0, -30.0, 10.0, 50.0, 80.0, 60.0, 220.0, 20.0, 70.0, 40.0, 60.0, 10.0, 70.0, 10.0, 370.0, 70.0, 70.0, 60.0, 30.0, 110.0, 190.0, 100.0, 100.0, 540.0, 70.0, 50.0, 120.0, 10.0, 120.0, 60.0, 70.0, 150.0, 80.0, 80.0, 230.0, 70.0, 80.0, 130.0, 20.0, 40.0, 50.0, 90.0, 170.0, 100.0, 30.0, 100.0, 80.0, 20.0, 220.0, 50.0, 0.0, -10.0, 200.0, -40.0, -20.0, 180.0, 110.0, 0.0, 30.0, 10.0, 20.0, 90.0, 80.0, 20.0, 150.0, 170.0, 130.0, 180.0, 20.0, -20.0, 0.0, 20.0, 160.0, 320.0, -10.0, 80.0, 30.0, 210.0, 270.0, 0.0, 100.0, 70.0, 160.0, 120.0, 50.0, 75.0, 30.0, 40.0, 370.0, 150.0, 20.0, 30.0, 200.0, 80.0, -25.0, -20.0, 70.0, 70.0, 0.0, 20.0, 40.0, 50.0, 20.0, 90.0, 20.0, 140.0, 30.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 90.0, 40.0, 90.0, 110.0, 0.0, 0.0, 10.0, 270.0, 50.0, 30.0, 190.0, 0.0, 40.0, 30.0, 190.0, 190.0, 10.0, 90.0, 170.0, 80.0, 110.0, 40.0, 210.0, 0.0, 50.0, 270.0, 10.0, 290.0, 40.0, 50.0, 0.0, -20.0, 20.0, 240.0, 30.0, 20.0, 60.0, 60.0, 450.0, 10.0, 110.0, 30.0, 310.0, 170.0, -280.0, 120.0, 30.0, 60.0, 90.0, 180.0, 20.0, 40.0, 50.0, 70.0, 30.0, 210.0, 110.0, 60.0, 140.0, 50.0, 60.0, 40.0, 10.0, 10.0, 250.0, 10.0, 10.0, 70.0, 80.0, 60.0, 50.0, 30.0, 40.0, 0.0, 30.0, 160.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 150.0, 10.0, 20.0, 80.0, 0.0, 30.0, 10.0, 20.0, -5.0, 20.0, 80.0, 50.0, 90.0, 50.0, 110.0, 110.0, 20.0, 120.0, 20.0, 60.0, 140.0, 70.0, 30.0, 210.0, 100.0, 360.0, 50.0, 140.0, 280.0, 50.0, 140.0, 20.0, 130.0, 40.0, 70.0, 210.0, 40.0, 70.0, 180.0, 70.0, 40.0, 40.0, 60.0, 50.0, 20.0, 10.0, 390.0, -95.0, 50.0, -45.0, 310.0, 80.0, 50.0, 80.0, 30.0, 390.0, 60.0, 70.0, 190.0, 80.0, 40.0, 80.0, 15.0, 70.0, 140.0, 40.0, 90.0, 0.0, 110.0, 10.0, 40.0, -10.0, 120.0, 60.0, 50.0, 120.0, 10.0, 320.0, 110.0, 260.0, 180.0, 140.0, 100.0, 20.0, 100.0, 20.0, 30.0, 70.0, 330.0, 80.0, 0.0, 30.0, 370.0, 80.0, 130.0, 0.0, 10.0, 70.0, 60.0, 160.0, 30.0, 110.0, 10.0, 40.0, 25.0, 390.0, 80.0, 10.0, 20.0, 10.0, 20.0, 100.0, 380.0, 10.0, 160.0, 500.0, 40.0, -290.0, 190.0, 40.0, 30.0, 180.0, 20.0, 70.0, 60.0, -80.0, 130.0, 70.0, -50.0, -100.0, 170.0, 260.0, 30.0, 110.0, 70.0, -20.0, 20.0, 150.0, 120.0, 270.0, 160.0, 200.0, 30.0, 370.0, 50.0, 50.0, 60.0, 40.0, 20.0, 50.0, 0.0, 10.0, 180.0, 10.0, 80.0, 0.0, 0.0, -30.0, 40.0, 20.0, 80.0, 10.0, 10.0, 20.0, 350.0, 130.0, 70.0, 110.0, 90.0, 60.0, 130.0, 10.0, 120.0, 30.0, 60.0, 30.0, 60.0, -30.0, 70.0, 300.0, -5.0, 30.0, 100.0, 0.0, 10.0, 0.0, 20.0, 110.0, 20.0, 40.0, 25.0, 110.0, 20.0, 60.0, 10.0, 370.0, 280.0, 290.0, 40.0, 0.0, 10.0, 0.0, 70.0, 30.0, 40.0, 120.0, 40.0, 50.0, 20.0, 0.0, 30.0, 30.0, 110.0, -20.0, 40.0, 40.0, 80.0, -40.0, 340.0, 410.0, 120.0, 110.0, 70.0, 60.0, 90.0, 50.0, 90.0, 180.0, 130.0, 30.0, 80.0, 30.0, 50.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 60.0, 50.0, 200.0, 60.0, 270.0, 10.0, 180.0, 270.0, 60.0, 0.0, 30.0, 190.0, 150.0, -20.0, 30.0, 0.0, 60.0, 50.0, 110.0, 40.0, 70.0, 80.0, 80.0, 400.0, 180.0, 10.0, 150.0, 20.0, -40.0, 70.0, 0.0, 80.0, 30.0, 70.0, 20.0, 50.0, 80.0, 310.0, 90.0, 150.0, 70.0, 40.0, 40.0, 0.0, 180.0, 100.0, 55.0, 70.0, 80.0, 0.0, 40.0, -20.0, 260.0, 20.0, 330.0, 65.0, 40.0, 120.0, 5.0, 70.0, 40.0, 30.0, 30.0, 70.0, 450.0, 180.0, 80.0, 50.0, 160.0, 40.0, 0.0, -40.0, 160.0, 30.0, 150.0, 40.0, 120.0, 160.0, 10.0, 190.0, 130.0, 70.0, 0.0, 140.0, 40.0, 20.0, 20.0, 60.0, 50.0, 250.0, 130.0, 10.0, 180.0, 40.0, 260.0, 280.0, 50.0, 70.0, 80.0, -10.0, 60.0, -40.0, 190.0, 80.0, 30.0, 20.0, 90.0, 110.0, 210.0, 40.0, 80.0, 190.0, 0.0, 20.0, 170.0, 10.0, 30.0, -130.0, 200.0, 15.0, 60.0, 50.0, 90.0, 20.0, 380.0, 180.0, 80.0, 40.0, 80.0, 40.0, 160.0, 150.0, 130.0, 30.0, 80.0, 100.0, 20.0, 10.0, 70.0, 30.0, 90.0, 195.0, 30.0, 240.0, 40.0, 70.0, 70.0, 90.0, 80.0, 60.0, 90.0, 220.0, 60.0, 60.0, 20.0, 190.0, 150.0, 100.0, 20.0, 20.0, 210.0, 70.0, 90.0, -40.0, 50.0, 210.0, 460.0, 120.0, 20.0, 270.0, 70.0, 20.0, 10.0, 10.0, 40.0, 50.0, 30.0, 230.0, 170.0, 0.0, 10.0, 20.0, 110.0, 50.0, 10.0, 50.0, 110.0, 50.0, 100.0, 170.0, 180.0, -40.0, 80.0, 30.0, 90.0, 300.0, 70.0, 280.0, 90.0, 50.0, 40.0, 130.0, 30.0, 10.0, 290.0, 70.0, 160.0, -30.0, 60.0, 70.0, 60.0, 130.0, 300.0, 70.0, 250.0, 280.0, 90.0, 30.0, 210.0, 140.0, 360.0, 270.0, 110.0, 30.0, 40.0, 40.0, 15.0, 0.0, 60.0, 20.0, 40.0, 20.0, 40.0, 60.0, 0.0, 10.0, 130.0, 170.0, 170.0, 0.0, 20.0, 100.0, 30.0, 60.0, 10.0, 90.0, 20.0, -5.0, 0.0, 0.0, -530.0, 90.0, 30.0, 30.0, 20.0, 460.0, 10.0, 50.0, 90.0, 40.0, 200.0, 20.0, 70.0, 10.0, 0.0, 150.0, 0.0, 0.0, 60.0, 10.0, 60.0, 110.0, 0.0, 40.0, 70.0, 0.0, 10.0, 200.0, 40.0, 40.0, 30.0, 30.0, 160.0, 180.0, 40.0, 70.0, 170.0, 80.0, 160.0, 190.0, 90.0, 20.0, 40.0, 20.0, 50.0, 140.0, 0.0, 360.0, 0.0, 190.0, 30.0, 10.0, 240.0, 200.0, -200.0, -30.0, 10.0, 160.0, 110.0, 30.0, 40.0, 10.0, 10.0, 10.0, 50.0, 10.0, 70.0, 390.0, 10.0, 120.0, 240.0, -15.0, 30.0, 200.0, 80.0, 40.0, 80.0, 150.0, 80.0, 110.0, 30.0, 30.0, 0.0, 80.0, -25.0, 130.0, 90.0, 70.0, 150.0, 40.0, 60.0, 60.0, 0.0, 80.0, 30.0, 30.0, 20.0, 30.0, 0.0, 60.0, 180.0, 10.0, 30.0, 360.0, 260.0, 30.0, 100.0, 60.0, 50.0, 210.0, 30.0, 0.0, 0.0, 260.0, 0.0, 10.0, 110.0, 100.0, 10.0, 40.0, -30.0, 30.0, 230.0, -110.0, 35.0, 130.0, 230.0, 30.0, 110.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7050567982495284, "mean_inference_ms": 1.4844290909752842, "mean_action_processing_ms": 0.4446650619979588, "mean_env_wait_ms": 1.3606560228650366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013965845108032227, "StateBufferConnector_ms": 0.010860681533813477, "ViewRequirementAgentConnector_ms": 0.4260261058807373}, "num_episodes": 23, "episode_return_max": 1560.0, "episode_return_min": 270.0, "episode_return_mean": 833.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.3137391094339, "num_env_steps_trained_throughput_per_sec": 19.3137391094339, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 209410.036, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209409.991, "sample_time_ms": 2868.673, "learn_time_ms": 206519.844, "learn_throughput": 19.369, "synch_weights_time_ms": 11.738}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 44, "trial_id": "aa996_00000", "date": "2024-05-24_01-18-01", "timestamp": 1716527881, "time_this_iter_s": 207.11495566368103, "time_total_s": 9148.596875190735, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd2a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9148.596875190735, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.827986348122867, "ram_util_percent": 78.7023890784983}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.122690912557486, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.808668736731028, "policy_loss": -0.008951601209550405, "vf_loss": 6.8163238586328285, "vf_explained_var": -0.0003589153480225097, "kl": 0.006482396011185496, "entropy": 0.6244662943866434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 417855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 1560.0, "episode_reward_min": 270.0, "episode_reward_mean": 834.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 540.0}, "policy_reward_mean": {"policy_0": 83.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [860.0, 940.0, 1320.0, 990.0, 810.0, 680.0, 680.0, 880.0, 1085.0, 875.0, 520.0, 380.0, 700.0, 1120.0, 710.0, 1320.0, 480.0, 780.0, 610.0, 330.0, 335.0, 710.0, 1430.0, 970.0, 520.0, 1340.0, 595.0, 1080.0, 1070.0, 910.0, 725.0, 1150.0, 330.0, 1180.0, 1030.0, 310.0, 930.0, 780.0, 325.0, 1205.0, 380.0, 1020.0, 930.0, 270.0, 1160.0, 640.0, 1020.0, 880.0, 635.0, 930.0, 1130.0, 820.0, 780.0, 1090.0, 790.0, 585.0, 1020.0, 780.0, 965.0, 930.0, 1460.0, 630.0, 680.0, 1130.0, 830.0, 1560.0, 945.0, 640.0, 325.0, 290.0, 520.0, 570.0, 1110.0, 910.0, 560.0, 720.0, 995.0, 595.0, 370.0, 1290.0, 560.0, 795.0, 660.0, 790.0, 450.0, 570.0, 575.0, 970.0, 760.0, 930.0, 1520.0, 960.0, 990.0, 950.0, 1355.0, 970.0, 860.0, 720.0, 1075.0, 1100.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 230.0, 40.0, 260.0, 30.0, -30.0, 10.0, 50.0, 80.0, 60.0, 220.0, 20.0, 70.0, 40.0, 60.0, 10.0, 70.0, 10.0, 370.0, 70.0, 70.0, 60.0, 30.0, 110.0, 190.0, 100.0, 100.0, 540.0, 70.0, 50.0, 120.0, 10.0, 120.0, 60.0, 70.0, 150.0, 80.0, 80.0, 230.0, 70.0, 80.0, 130.0, 20.0, 40.0, 50.0, 90.0, 170.0, 100.0, 30.0, 100.0, 80.0, 20.0, 220.0, 50.0, 0.0, -10.0, 200.0, -40.0, -20.0, 180.0, 110.0, 0.0, 30.0, 10.0, 20.0, 90.0, 80.0, 20.0, 150.0, 170.0, 130.0, 180.0, 20.0, -20.0, 0.0, 20.0, 160.0, 320.0, -10.0, 80.0, 30.0, 210.0, 270.0, 0.0, 100.0, 70.0, 160.0, 120.0, 50.0, 75.0, 30.0, 40.0, 370.0, 150.0, 20.0, 30.0, 200.0, 80.0, -25.0, -20.0, 70.0, 70.0, 0.0, 20.0, 40.0, 50.0, 20.0, 90.0, 20.0, 140.0, 30.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 90.0, 40.0, 90.0, 110.0, 0.0, 0.0, 10.0, 270.0, 50.0, 30.0, 190.0, 0.0, 40.0, 30.0, 190.0, 190.0, 10.0, 90.0, 170.0, 80.0, 110.0, 40.0, 210.0, 0.0, 50.0, 270.0, 10.0, 290.0, 40.0, 50.0, 0.0, -20.0, 20.0, 240.0, 30.0, 20.0, 60.0, 60.0, 450.0, 10.0, 110.0, 30.0, 310.0, 170.0, -280.0, 120.0, 30.0, 60.0, 90.0, 180.0, 20.0, 40.0, 50.0, 70.0, 30.0, 210.0, 110.0, 60.0, 140.0, 50.0, 60.0, 40.0, 10.0, 10.0, 250.0, 10.0, 10.0, 70.0, 80.0, 60.0, 50.0, 30.0, 40.0, 0.0, 30.0, 160.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 150.0, 10.0, 20.0, 80.0, 0.0, 30.0, 10.0, 20.0, -5.0, 20.0, 80.0, 50.0, 90.0, 50.0, 110.0, 110.0, 20.0, 120.0, 20.0, 60.0, 140.0, 70.0, 30.0, 210.0, 100.0, 360.0, 50.0, 140.0, 280.0, 50.0, 140.0, 20.0, 130.0, 40.0, 70.0, 210.0, 40.0, 70.0, 180.0, 70.0, 40.0, 40.0, 60.0, 50.0, 20.0, 10.0, 390.0, -95.0, 50.0, -45.0, 310.0, 80.0, 50.0, 80.0, 30.0, 390.0, 60.0, 70.0, 190.0, 80.0, 40.0, 80.0, 15.0, 70.0, 140.0, 40.0, 90.0, 0.0, 110.0, 10.0, 40.0, -10.0, 120.0, 60.0, 50.0, 120.0, 10.0, 320.0, 110.0, 260.0, 180.0, 140.0, 100.0, 20.0, 100.0, 20.0, 30.0, 70.0, 330.0, 80.0, 0.0, 30.0, 370.0, 80.0, 130.0, 0.0, 10.0, 70.0, 60.0, 160.0, 30.0, 110.0, 10.0, 40.0, 25.0, 390.0, 80.0, 10.0, 20.0, 10.0, 20.0, 100.0, 380.0, 10.0, 160.0, 500.0, 40.0, -290.0, 190.0, 40.0, 30.0, 180.0, 20.0, 70.0, 60.0, -80.0, 130.0, 70.0, -50.0, -100.0, 170.0, 260.0, 30.0, 110.0, 70.0, -20.0, 20.0, 150.0, 120.0, 270.0, 160.0, 200.0, 30.0, 370.0, 50.0, 50.0, 60.0, 40.0, 20.0, 50.0, 0.0, 10.0, 180.0, 10.0, 80.0, 0.0, 0.0, -30.0, 40.0, 20.0, 80.0, 10.0, 10.0, 20.0, 350.0, 130.0, 70.0, 110.0, 90.0, 60.0, 130.0, 10.0, 120.0, 30.0, 60.0, 30.0, 60.0, -30.0, 70.0, 300.0, -5.0, 30.0, 100.0, 0.0, 10.0, 0.0, 20.0, 110.0, 20.0, 40.0, 25.0, 110.0, 20.0, 60.0, 10.0, 370.0, 280.0, 290.0, 40.0, 0.0, 10.0, 0.0, 70.0, 30.0, 40.0, 120.0, 40.0, 50.0, 20.0, 0.0, 30.0, 30.0, 110.0, -20.0, 40.0, 40.0, 80.0, -40.0, 340.0, 410.0, 120.0, 110.0, 70.0, 60.0, 90.0, 50.0, 90.0, 180.0, 130.0, 30.0, 80.0, 30.0, 50.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 60.0, 50.0, 200.0, 60.0, 270.0, 10.0, 180.0, 270.0, 60.0, 0.0, 30.0, 190.0, 150.0, -20.0, 30.0, 0.0, 60.0, 50.0, 110.0, 40.0, 70.0, 80.0, 80.0, 400.0, 180.0, 10.0, 150.0, 20.0, -40.0, 70.0, 0.0, 80.0, 30.0, 70.0, 20.0, 50.0, 80.0, 310.0, 90.0, 150.0, 70.0, 40.0, 40.0, 0.0, 180.0, 100.0, 55.0, 70.0, 80.0, 0.0, 40.0, -20.0, 260.0, 20.0, 330.0, 65.0, 40.0, 120.0, 5.0, 70.0, 40.0, 30.0, 30.0, 70.0, 450.0, 180.0, 80.0, 50.0, 160.0, 40.0, 0.0, -40.0, 160.0, 30.0, 150.0, 40.0, 120.0, 160.0, 10.0, 190.0, 130.0, 70.0, 0.0, 140.0, 40.0, 20.0, 20.0, 60.0, 50.0, 250.0, 130.0, 10.0, 180.0, 40.0, 260.0, 280.0, 50.0, 70.0, 80.0, -10.0, 60.0, -40.0, 190.0, 80.0, 30.0, 20.0, 90.0, 110.0, 210.0, 40.0, 80.0, 190.0, 0.0, 20.0, 170.0, 10.0, 30.0, -130.0, 200.0, 15.0, 60.0, 50.0, 90.0, 20.0, 380.0, 180.0, 80.0, 40.0, 80.0, 40.0, 160.0, 150.0, 130.0, 30.0, 80.0, 100.0, 20.0, 10.0, 70.0, 30.0, 90.0, 195.0, 30.0, 240.0, 40.0, 70.0, 70.0, 90.0, 80.0, 60.0, 90.0, 220.0, 60.0, 60.0, 20.0, 190.0, 150.0, 100.0, 20.0, 20.0, 210.0, 70.0, 90.0, -40.0, 50.0, 210.0, 460.0, 120.0, 20.0, 270.0, 70.0, 20.0, 10.0, 10.0, 40.0, 50.0, 30.0, 230.0, 170.0, 0.0, 10.0, 20.0, 110.0, 50.0, 10.0, 50.0, 110.0, 50.0, 100.0, 170.0, 180.0, -40.0, 80.0, 30.0, 90.0, 300.0, 70.0, 280.0, 90.0, 50.0, 40.0, 130.0, 30.0, 10.0, 290.0, 70.0, 160.0, -30.0, 60.0, 70.0, 60.0, 130.0, 300.0, 70.0, 250.0, 280.0, 90.0, 30.0, 210.0, 140.0, 360.0, 270.0, 110.0, 30.0, 40.0, 40.0, 15.0, 0.0, 60.0, 20.0, 40.0, 20.0, 40.0, 60.0, 0.0, 10.0, 130.0, 170.0, 170.0, 0.0, 20.0, 100.0, 30.0, 60.0, 10.0, 90.0, 20.0, -5.0, 0.0, 0.0, -530.0, 90.0, 30.0, 30.0, 20.0, 460.0, 10.0, 50.0, 90.0, 40.0, 200.0, 20.0, 70.0, 10.0, 0.0, 150.0, 0.0, 0.0, 60.0, 10.0, 60.0, 110.0, 0.0, 40.0, 70.0, 0.0, 10.0, 200.0, 40.0, 40.0, 30.0, 30.0, 160.0, 180.0, 40.0, 70.0, 170.0, 80.0, 160.0, 190.0, 90.0, 20.0, 40.0, 20.0, 50.0, 140.0, 0.0, 360.0, 0.0, 190.0, 30.0, 10.0, 240.0, 200.0, -200.0, -30.0, 10.0, 160.0, 110.0, 30.0, 40.0, 10.0, 10.0, 10.0, 50.0, 10.0, 70.0, 390.0, 10.0, 120.0, 240.0, -15.0, 30.0, 200.0, 80.0, 40.0, 80.0, 150.0, 80.0, 110.0, 30.0, 30.0, 0.0, 80.0, -25.0, 130.0, 90.0, 70.0, 150.0, 40.0, 60.0, 60.0, 0.0, 80.0, 30.0, 30.0, 20.0, 30.0, 0.0, 60.0, 180.0, 10.0, 30.0, 360.0, 260.0, 30.0, 100.0, 60.0, 50.0, 210.0, 30.0, 0.0, 0.0, 260.0, 0.0, 10.0, 110.0, 100.0, 10.0, 40.0, -30.0, 30.0, 230.0, -110.0, 35.0, 130.0, 230.0, 30.0, 110.0, 140.0, 60.0, 40.0, 40.0, 100.0, 150.0, -20.0, 170.0, 20.0, 70.0, 30.0, 120.0, 0.0, 0.0, 70.0, 160.0, 50.0, 270.0, 10.0, 20.0, 90.0, 10.0, 10.0, 70.0, 160.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 50.0, 10.0, 40.0, 30.0, 30.0, 30.0, 230.0, 0.0, 120.0, 30.0, 10.0, 70.0, 70.0, 160.0, 20.0, 0.0, 50.0, 35.0, 40.0, 120.0, 130.0, 150.0, 80.0, 160.0, 120.0, 10.0, 50.0, 10.0, 210.0, 50.0, 50.0, 20.0, 50.0, 70.0, 50.0, 20.0, 20.0, 80.0, 370.0, 30.0, 130.0, 160.0, 40.0, 200.0, 190.0, 0.0, 10.0, 10.0, 190.0, 0.0, -30.0, -90.0, 170.0, 120.0, 30.0, 260.0, 220.0, 270.0, 150.0, 420.0, 120.0, 170.0, 60.0, 0.0, 200.0, 100.0, 30.0, 20.0, 230.0, 30.0, 60.0, 40.0, 100.0, 180.0, 60.0, 60.0, 140.0, 170.0, 60.0, 120.0, 40.0, 540.0, 25.0, 120.0, 50.0, 100.0, 100.0, -105.0, 10.0, 70.0, 100.0, 170.0, 40.0, 110.0, 100.0, 120.0, 180.0, 300.0, 85.0, 150.0, 0.0, 80.0, 230.0, 40.0, 60.0, 490.0, 120.0, -50.0, -20.0, 20.0, 70.0, 350.0, 110.0, 90.0, 40.0, 60.0, 80.0, 20.0, 70.0, -30.0, 200.0, 180.0, 90.0, 10.0, 0.0, 30.0, 110.0, 50.0, 30.0, 20.0, 130.0, -30.0, 290.0, 170.0, 60.0, 5.0, -30.0, 80.0, 60.0, 340.0, 130.0, 90.0, 30.0, 20.0, 30.0, 380.0, -20.0, 250.0, 160.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7039428255701614, "mean_inference_ms": 1.4838690849510663, "mean_action_processing_ms": 0.4438087932949933, "mean_env_wait_ms": 1.3597359946325485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013821601867675781, "StateBufferConnector_ms": 0.01067209243774414, "ViewRequirementAgentConnector_ms": 0.41609859466552734}, "num_episodes": 18, "episode_return_max": 1560.0, "episode_return_min": 270.0, "episode_return_mean": 834.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.140607398528843, "num_env_steps_trained_throughput_per_sec": 19.140607398528843, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 209420.38, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209420.334, "sample_time_ms": 2803.161, "learn_time_ms": 206595.674, "learn_throughput": 19.361, "synch_weights_time_ms": 11.468}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 45, "trial_id": "aa996_00000", "date": "2024-05-24_01-21-30", "timestamp": 1716528090, "time_this_iter_s": 208.98662304878235, "time_total_s": 9357.583498239517, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332db51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9357.583498239517, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 19.460472972972973, "ram_util_percent": 79.46013513513513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.168650813891103, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.157277024972934, "policy_loss": -0.008281620044863254, "vf_loss": 6.164278345443189, "vf_explained_var": -0.0006540566968460815, "kl": 0.0064015247442051875, "entropy": 0.6609008809057668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 427245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 1560.0, "episode_reward_min": 90.0, "episode_reward_mean": 814.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 540.0}, "policy_reward_mean": {"policy_0": 81.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [610.0, 330.0, 335.0, 710.0, 1430.0, 970.0, 520.0, 1340.0, 595.0, 1080.0, 1070.0, 910.0, 725.0, 1150.0, 330.0, 1180.0, 1030.0, 310.0, 930.0, 780.0, 325.0, 1205.0, 380.0, 1020.0, 930.0, 270.0, 1160.0, 640.0, 1020.0, 880.0, 635.0, 930.0, 1130.0, 820.0, 780.0, 1090.0, 790.0, 585.0, 1020.0, 780.0, 965.0, 930.0, 1460.0, 630.0, 680.0, 1130.0, 830.0, 1560.0, 945.0, 640.0, 325.0, 290.0, 520.0, 570.0, 1110.0, 910.0, 560.0, 720.0, 995.0, 595.0, 370.0, 1290.0, 560.0, 795.0, 660.0, 790.0, 450.0, 570.0, 575.0, 970.0, 760.0, 930.0, 1520.0, 960.0, 990.0, 950.0, 1355.0, 970.0, 860.0, 720.0, 1075.0, 1100.0, 1020.0, 680.0, 940.0, 470.0, 880.0, 1000.0, 480.0, 90.0, 410.0, 790.0, 280.0, 1085.0, 770.0, 890.0, 720.0, 1105.0, 470.0, 1070.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 250.0, 10.0, 10.0, 70.0, 80.0, 60.0, 50.0, 30.0, 40.0, 0.0, 30.0, 160.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 150.0, 10.0, 20.0, 80.0, 0.0, 30.0, 10.0, 20.0, -5.0, 20.0, 80.0, 50.0, 90.0, 50.0, 110.0, 110.0, 20.0, 120.0, 20.0, 60.0, 140.0, 70.0, 30.0, 210.0, 100.0, 360.0, 50.0, 140.0, 280.0, 50.0, 140.0, 20.0, 130.0, 40.0, 70.0, 210.0, 40.0, 70.0, 180.0, 70.0, 40.0, 40.0, 60.0, 50.0, 20.0, 10.0, 390.0, -95.0, 50.0, -45.0, 310.0, 80.0, 50.0, 80.0, 30.0, 390.0, 60.0, 70.0, 190.0, 80.0, 40.0, 80.0, 15.0, 70.0, 140.0, 40.0, 90.0, 0.0, 110.0, 10.0, 40.0, -10.0, 120.0, 60.0, 50.0, 120.0, 10.0, 320.0, 110.0, 260.0, 180.0, 140.0, 100.0, 20.0, 100.0, 20.0, 30.0, 70.0, 330.0, 80.0, 0.0, 30.0, 370.0, 80.0, 130.0, 0.0, 10.0, 70.0, 60.0, 160.0, 30.0, 110.0, 10.0, 40.0, 25.0, 390.0, 80.0, 10.0, 20.0, 10.0, 20.0, 100.0, 380.0, 10.0, 160.0, 500.0, 40.0, -290.0, 190.0, 40.0, 30.0, 180.0, 20.0, 70.0, 60.0, -80.0, 130.0, 70.0, -50.0, -100.0, 170.0, 260.0, 30.0, 110.0, 70.0, -20.0, 20.0, 150.0, 120.0, 270.0, 160.0, 200.0, 30.0, 370.0, 50.0, 50.0, 60.0, 40.0, 20.0, 50.0, 0.0, 10.0, 180.0, 10.0, 80.0, 0.0, 0.0, -30.0, 40.0, 20.0, 80.0, 10.0, 10.0, 20.0, 350.0, 130.0, 70.0, 110.0, 90.0, 60.0, 130.0, 10.0, 120.0, 30.0, 60.0, 30.0, 60.0, -30.0, 70.0, 300.0, -5.0, 30.0, 100.0, 0.0, 10.0, 0.0, 20.0, 110.0, 20.0, 40.0, 25.0, 110.0, 20.0, 60.0, 10.0, 370.0, 280.0, 290.0, 40.0, 0.0, 10.0, 0.0, 70.0, 30.0, 40.0, 120.0, 40.0, 50.0, 20.0, 0.0, 30.0, 30.0, 110.0, -20.0, 40.0, 40.0, 80.0, -40.0, 340.0, 410.0, 120.0, 110.0, 70.0, 60.0, 90.0, 50.0, 90.0, 180.0, 130.0, 30.0, 80.0, 30.0, 50.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 60.0, 50.0, 200.0, 60.0, 270.0, 10.0, 180.0, 270.0, 60.0, 0.0, 30.0, 190.0, 150.0, -20.0, 30.0, 0.0, 60.0, 50.0, 110.0, 40.0, 70.0, 80.0, 80.0, 400.0, 180.0, 10.0, 150.0, 20.0, -40.0, 70.0, 0.0, 80.0, 30.0, 70.0, 20.0, 50.0, 80.0, 310.0, 90.0, 150.0, 70.0, 40.0, 40.0, 0.0, 180.0, 100.0, 55.0, 70.0, 80.0, 0.0, 40.0, -20.0, 260.0, 20.0, 330.0, 65.0, 40.0, 120.0, 5.0, 70.0, 40.0, 30.0, 30.0, 70.0, 450.0, 180.0, 80.0, 50.0, 160.0, 40.0, 0.0, -40.0, 160.0, 30.0, 150.0, 40.0, 120.0, 160.0, 10.0, 190.0, 130.0, 70.0, 0.0, 140.0, 40.0, 20.0, 20.0, 60.0, 50.0, 250.0, 130.0, 10.0, 180.0, 40.0, 260.0, 280.0, 50.0, 70.0, 80.0, -10.0, 60.0, -40.0, 190.0, 80.0, 30.0, 20.0, 90.0, 110.0, 210.0, 40.0, 80.0, 190.0, 0.0, 20.0, 170.0, 10.0, 30.0, -130.0, 200.0, 15.0, 60.0, 50.0, 90.0, 20.0, 380.0, 180.0, 80.0, 40.0, 80.0, 40.0, 160.0, 150.0, 130.0, 30.0, 80.0, 100.0, 20.0, 10.0, 70.0, 30.0, 90.0, 195.0, 30.0, 240.0, 40.0, 70.0, 70.0, 90.0, 80.0, 60.0, 90.0, 220.0, 60.0, 60.0, 20.0, 190.0, 150.0, 100.0, 20.0, 20.0, 210.0, 70.0, 90.0, -40.0, 50.0, 210.0, 460.0, 120.0, 20.0, 270.0, 70.0, 20.0, 10.0, 10.0, 40.0, 50.0, 30.0, 230.0, 170.0, 0.0, 10.0, 20.0, 110.0, 50.0, 10.0, 50.0, 110.0, 50.0, 100.0, 170.0, 180.0, -40.0, 80.0, 30.0, 90.0, 300.0, 70.0, 280.0, 90.0, 50.0, 40.0, 130.0, 30.0, 10.0, 290.0, 70.0, 160.0, -30.0, 60.0, 70.0, 60.0, 130.0, 300.0, 70.0, 250.0, 280.0, 90.0, 30.0, 210.0, 140.0, 360.0, 270.0, 110.0, 30.0, 40.0, 40.0, 15.0, 0.0, 60.0, 20.0, 40.0, 20.0, 40.0, 60.0, 0.0, 10.0, 130.0, 170.0, 170.0, 0.0, 20.0, 100.0, 30.0, 60.0, 10.0, 90.0, 20.0, -5.0, 0.0, 0.0, -530.0, 90.0, 30.0, 30.0, 20.0, 460.0, 10.0, 50.0, 90.0, 40.0, 200.0, 20.0, 70.0, 10.0, 0.0, 150.0, 0.0, 0.0, 60.0, 10.0, 60.0, 110.0, 0.0, 40.0, 70.0, 0.0, 10.0, 200.0, 40.0, 40.0, 30.0, 30.0, 160.0, 180.0, 40.0, 70.0, 170.0, 80.0, 160.0, 190.0, 90.0, 20.0, 40.0, 20.0, 50.0, 140.0, 0.0, 360.0, 0.0, 190.0, 30.0, 10.0, 240.0, 200.0, -200.0, -30.0, 10.0, 160.0, 110.0, 30.0, 40.0, 10.0, 10.0, 10.0, 50.0, 10.0, 70.0, 390.0, 10.0, 120.0, 240.0, -15.0, 30.0, 200.0, 80.0, 40.0, 80.0, 150.0, 80.0, 110.0, 30.0, 30.0, 0.0, 80.0, -25.0, 130.0, 90.0, 70.0, 150.0, 40.0, 60.0, 60.0, 0.0, 80.0, 30.0, 30.0, 20.0, 30.0, 0.0, 60.0, 180.0, 10.0, 30.0, 360.0, 260.0, 30.0, 100.0, 60.0, 50.0, 210.0, 30.0, 0.0, 0.0, 260.0, 0.0, 10.0, 110.0, 100.0, 10.0, 40.0, -30.0, 30.0, 230.0, -110.0, 35.0, 130.0, 230.0, 30.0, 110.0, 140.0, 60.0, 40.0, 40.0, 100.0, 150.0, -20.0, 170.0, 20.0, 70.0, 30.0, 120.0, 0.0, 0.0, 70.0, 160.0, 50.0, 270.0, 10.0, 20.0, 90.0, 10.0, 10.0, 70.0, 160.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 50.0, 10.0, 40.0, 30.0, 30.0, 30.0, 230.0, 0.0, 120.0, 30.0, 10.0, 70.0, 70.0, 160.0, 20.0, 0.0, 50.0, 35.0, 40.0, 120.0, 130.0, 150.0, 80.0, 160.0, 120.0, 10.0, 50.0, 10.0, 210.0, 50.0, 50.0, 20.0, 50.0, 70.0, 50.0, 20.0, 20.0, 80.0, 370.0, 30.0, 130.0, 160.0, 40.0, 200.0, 190.0, 0.0, 10.0, 10.0, 190.0, 0.0, -30.0, -90.0, 170.0, 120.0, 30.0, 260.0, 220.0, 270.0, 150.0, 420.0, 120.0, 170.0, 60.0, 0.0, 200.0, 100.0, 30.0, 20.0, 230.0, 30.0, 60.0, 40.0, 100.0, 180.0, 60.0, 60.0, 140.0, 170.0, 60.0, 120.0, 40.0, 540.0, 25.0, 120.0, 50.0, 100.0, 100.0, -105.0, 10.0, 70.0, 100.0, 170.0, 40.0, 110.0, 100.0, 120.0, 180.0, 300.0, 85.0, 150.0, 0.0, 80.0, 230.0, 40.0, 60.0, 490.0, 120.0, -50.0, -20.0, 20.0, 70.0, 350.0, 110.0, 90.0, 40.0, 60.0, 80.0, 20.0, 70.0, -30.0, 200.0, 180.0, 90.0, 10.0, 0.0, 30.0, 110.0, 50.0, 30.0, 20.0, 130.0, -30.0, 290.0, 170.0, 60.0, 5.0, -30.0, 80.0, 60.0, 340.0, 130.0, 90.0, 30.0, 20.0, 30.0, 380.0, -20.0, 250.0, 160.0, 30.0, 180.0, 40.0, 140.0, 0.0, 50.0, 160.0, 90.0, 110.0, 180.0, 70.0, 50.0, 70.0, 70.0, 60.0, 60.0, 70.0, 50.0, 150.0, 60.0, 40.0, 70.0, 370.0, 10.0, 170.0, 10.0, 20.0, 50.0, 30.0, 180.0, 30.0, 150.0, 0.0, 0.0, 40.0, 0.0, 30.0, 0.0, 80.0, 20.0, 150.0, 170.0, 65.0, 50.0, -20.0, 80.0, -10.0, 35.0, 20.0, 480.0, 10.0, 200.0, 80.0, -10.0, 30.0, 0.0, 170.0, 350.0, 20.0, 90.0, 70.0, 170.0, 50.0, 80.0, 40.0, 0.0, 50.0, 10.0, -90.0, 60.0, 110.0, -10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 90.0, 70.0, 0.0, 40.0, 10.0, 10.0, 0.0, 80.0, 90.0, 100.0, 150.0, 50.0, 30.0, -10.0, 130.0, 180.0, 70.0, 50.0, 40.0, 0.0, 20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 20.0, 30.0, 20.0, 35.0, 20.0, 360.0, 0.0, 80.0, 60.0, 420.0, -30.0, 40.0, 100.0, 190.0, 160.0, 20.0, 20.0, 40.0, 100.0, 15.0, -15.0, 60.0, 180.0, 230.0, 10.0, 70.0, 170.0, 40.0, 40.0, 40.0, 130.0, 30.0, 130.0, 180.0, 30.0, 220.0, 10.0, 140.0, 20.0, 30.0, 0.0, 70.0, 20.0, 60.0, 160.0, 120.0, 410.0, -5.0, 40.0, 10.0, 180.0, 130.0, 0.0, 200.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 70.0, 40.0, 10.0, 60.0, 120.0, 0.0, 150.0, -20.0, -40.0, 120.0, 500.0, 50.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7027826851419077, "mean_inference_ms": 1.4835754761964624, "mean_action_processing_ms": 0.44302125697120476, "mean_env_wait_ms": 1.3589813737887988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0141143798828125, "StateBufferConnector_ms": 0.010821342468261719, "ViewRequirementAgentConnector_ms": 0.42226529121398926}, "num_episodes": 18, "episode_return_max": 1560.0, "episode_return_min": 90.0, "episode_return_mean": 814.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.250383890878485, "num_env_steps_trained_throughput_per_sec": 19.250383890878485, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 209220.713, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209220.668, "sample_time_ms": 2777.541, "learn_time_ms": 206421.604, "learn_throughput": 19.378, "synch_weights_time_ms": 11.595}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 46, "trial_id": "aa996_00000", "date": "2024-05-24_01-24-58", "timestamp": 1716528298, "time_this_iter_s": 207.79711365699768, "time_total_s": 9565.380611896515, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dba0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9565.380611896515, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 19.122108843537415, "ram_util_percent": 78.77891156462584}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.209498173182511, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.478848461500499, "policy_loss": -0.009539557937919475, "vf_loss": 6.487001853146619, "vf_explained_var": 5.380796929137014e-05, "kl": 0.006930831351123414, "entropy": 0.6336175180281313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 436635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "env_runners": {"episode_reward_max": 1560.0, "episode_reward_min": 90.0, "episode_reward_mean": 814.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 81.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 1020.0, 930.0, 270.0, 1160.0, 640.0, 1020.0, 880.0, 635.0, 930.0, 1130.0, 820.0, 780.0, 1090.0, 790.0, 585.0, 1020.0, 780.0, 965.0, 930.0, 1460.0, 630.0, 680.0, 1130.0, 830.0, 1560.0, 945.0, 640.0, 325.0, 290.0, 520.0, 570.0, 1110.0, 910.0, 560.0, 720.0, 995.0, 595.0, 370.0, 1290.0, 560.0, 795.0, 660.0, 790.0, 450.0, 570.0, 575.0, 970.0, 760.0, 930.0, 1520.0, 960.0, 990.0, 950.0, 1355.0, 970.0, 860.0, 720.0, 1075.0, 1100.0, 1020.0, 680.0, 940.0, 470.0, 880.0, 1000.0, 480.0, 90.0, 410.0, 790.0, 280.0, 1085.0, 770.0, 890.0, 720.0, 1105.0, 470.0, 1070.0, 850.0, 340.0, 365.0, 1050.0, 1250.0, 1150.0, 650.0, 510.0, 1110.0, 850.0, 1080.0, 1050.0, 765.0, 495.0, 940.0, 1410.0, 910.0, 540.0, 200.0, 1120.0, 735.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 70.0, 30.0, 40.0, 120.0, 40.0, 50.0, 20.0, 0.0, 30.0, 30.0, 110.0, -20.0, 40.0, 40.0, 80.0, -40.0, 340.0, 410.0, 120.0, 110.0, 70.0, 60.0, 90.0, 50.0, 90.0, 180.0, 130.0, 30.0, 80.0, 30.0, 50.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 60.0, 50.0, 200.0, 60.0, 270.0, 10.0, 180.0, 270.0, 60.0, 0.0, 30.0, 190.0, 150.0, -20.0, 30.0, 0.0, 60.0, 50.0, 110.0, 40.0, 70.0, 80.0, 80.0, 400.0, 180.0, 10.0, 150.0, 20.0, -40.0, 70.0, 0.0, 80.0, 30.0, 70.0, 20.0, 50.0, 80.0, 310.0, 90.0, 150.0, 70.0, 40.0, 40.0, 0.0, 180.0, 100.0, 55.0, 70.0, 80.0, 0.0, 40.0, -20.0, 260.0, 20.0, 330.0, 65.0, 40.0, 120.0, 5.0, 70.0, 40.0, 30.0, 30.0, 70.0, 450.0, 180.0, 80.0, 50.0, 160.0, 40.0, 0.0, -40.0, 160.0, 30.0, 150.0, 40.0, 120.0, 160.0, 10.0, 190.0, 130.0, 70.0, 0.0, 140.0, 40.0, 20.0, 20.0, 60.0, 50.0, 250.0, 130.0, 10.0, 180.0, 40.0, 260.0, 280.0, 50.0, 70.0, 80.0, -10.0, 60.0, -40.0, 190.0, 80.0, 30.0, 20.0, 90.0, 110.0, 210.0, 40.0, 80.0, 190.0, 0.0, 20.0, 170.0, 10.0, 30.0, -130.0, 200.0, 15.0, 60.0, 50.0, 90.0, 20.0, 380.0, 180.0, 80.0, 40.0, 80.0, 40.0, 160.0, 150.0, 130.0, 30.0, 80.0, 100.0, 20.0, 10.0, 70.0, 30.0, 90.0, 195.0, 30.0, 240.0, 40.0, 70.0, 70.0, 90.0, 80.0, 60.0, 90.0, 220.0, 60.0, 60.0, 20.0, 190.0, 150.0, 100.0, 20.0, 20.0, 210.0, 70.0, 90.0, -40.0, 50.0, 210.0, 460.0, 120.0, 20.0, 270.0, 70.0, 20.0, 10.0, 10.0, 40.0, 50.0, 30.0, 230.0, 170.0, 0.0, 10.0, 20.0, 110.0, 50.0, 10.0, 50.0, 110.0, 50.0, 100.0, 170.0, 180.0, -40.0, 80.0, 30.0, 90.0, 300.0, 70.0, 280.0, 90.0, 50.0, 40.0, 130.0, 30.0, 10.0, 290.0, 70.0, 160.0, -30.0, 60.0, 70.0, 60.0, 130.0, 300.0, 70.0, 250.0, 280.0, 90.0, 30.0, 210.0, 140.0, 360.0, 270.0, 110.0, 30.0, 40.0, 40.0, 15.0, 0.0, 60.0, 20.0, 40.0, 20.0, 40.0, 60.0, 0.0, 10.0, 130.0, 170.0, 170.0, 0.0, 20.0, 100.0, 30.0, 60.0, 10.0, 90.0, 20.0, -5.0, 0.0, 0.0, -530.0, 90.0, 30.0, 30.0, 20.0, 460.0, 10.0, 50.0, 90.0, 40.0, 200.0, 20.0, 70.0, 10.0, 0.0, 150.0, 0.0, 0.0, 60.0, 10.0, 60.0, 110.0, 0.0, 40.0, 70.0, 0.0, 10.0, 200.0, 40.0, 40.0, 30.0, 30.0, 160.0, 180.0, 40.0, 70.0, 170.0, 80.0, 160.0, 190.0, 90.0, 20.0, 40.0, 20.0, 50.0, 140.0, 0.0, 360.0, 0.0, 190.0, 30.0, 10.0, 240.0, 200.0, -200.0, -30.0, 10.0, 160.0, 110.0, 30.0, 40.0, 10.0, 10.0, 10.0, 50.0, 10.0, 70.0, 390.0, 10.0, 120.0, 240.0, -15.0, 30.0, 200.0, 80.0, 40.0, 80.0, 150.0, 80.0, 110.0, 30.0, 30.0, 0.0, 80.0, -25.0, 130.0, 90.0, 70.0, 150.0, 40.0, 60.0, 60.0, 0.0, 80.0, 30.0, 30.0, 20.0, 30.0, 0.0, 60.0, 180.0, 10.0, 30.0, 360.0, 260.0, 30.0, 100.0, 60.0, 50.0, 210.0, 30.0, 0.0, 0.0, 260.0, 0.0, 10.0, 110.0, 100.0, 10.0, 40.0, -30.0, 30.0, 230.0, -110.0, 35.0, 130.0, 230.0, 30.0, 110.0, 140.0, 60.0, 40.0, 40.0, 100.0, 150.0, -20.0, 170.0, 20.0, 70.0, 30.0, 120.0, 0.0, 0.0, 70.0, 160.0, 50.0, 270.0, 10.0, 20.0, 90.0, 10.0, 10.0, 70.0, 160.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 50.0, 10.0, 40.0, 30.0, 30.0, 30.0, 230.0, 0.0, 120.0, 30.0, 10.0, 70.0, 70.0, 160.0, 20.0, 0.0, 50.0, 35.0, 40.0, 120.0, 130.0, 150.0, 80.0, 160.0, 120.0, 10.0, 50.0, 10.0, 210.0, 50.0, 50.0, 20.0, 50.0, 70.0, 50.0, 20.0, 20.0, 80.0, 370.0, 30.0, 130.0, 160.0, 40.0, 200.0, 190.0, 0.0, 10.0, 10.0, 190.0, 0.0, -30.0, -90.0, 170.0, 120.0, 30.0, 260.0, 220.0, 270.0, 150.0, 420.0, 120.0, 170.0, 60.0, 0.0, 200.0, 100.0, 30.0, 20.0, 230.0, 30.0, 60.0, 40.0, 100.0, 180.0, 60.0, 60.0, 140.0, 170.0, 60.0, 120.0, 40.0, 540.0, 25.0, 120.0, 50.0, 100.0, 100.0, -105.0, 10.0, 70.0, 100.0, 170.0, 40.0, 110.0, 100.0, 120.0, 180.0, 300.0, 85.0, 150.0, 0.0, 80.0, 230.0, 40.0, 60.0, 490.0, 120.0, -50.0, -20.0, 20.0, 70.0, 350.0, 110.0, 90.0, 40.0, 60.0, 80.0, 20.0, 70.0, -30.0, 200.0, 180.0, 90.0, 10.0, 0.0, 30.0, 110.0, 50.0, 30.0, 20.0, 130.0, -30.0, 290.0, 170.0, 60.0, 5.0, -30.0, 80.0, 60.0, 340.0, 130.0, 90.0, 30.0, 20.0, 30.0, 380.0, -20.0, 250.0, 160.0, 30.0, 180.0, 40.0, 140.0, 0.0, 50.0, 160.0, 90.0, 110.0, 180.0, 70.0, 50.0, 70.0, 70.0, 60.0, 60.0, 70.0, 50.0, 150.0, 60.0, 40.0, 70.0, 370.0, 10.0, 170.0, 10.0, 20.0, 50.0, 30.0, 180.0, 30.0, 150.0, 0.0, 0.0, 40.0, 0.0, 30.0, 0.0, 80.0, 20.0, 150.0, 170.0, 65.0, 50.0, -20.0, 80.0, -10.0, 35.0, 20.0, 480.0, 10.0, 200.0, 80.0, -10.0, 30.0, 0.0, 170.0, 350.0, 20.0, 90.0, 70.0, 170.0, 50.0, 80.0, 40.0, 0.0, 50.0, 10.0, -90.0, 60.0, 110.0, -10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 90.0, 70.0, 0.0, 40.0, 10.0, 10.0, 0.0, 80.0, 90.0, 100.0, 150.0, 50.0, 30.0, -10.0, 130.0, 180.0, 70.0, 50.0, 40.0, 0.0, 20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 20.0, 30.0, 20.0, 35.0, 20.0, 360.0, 0.0, 80.0, 60.0, 420.0, -30.0, 40.0, 100.0, 190.0, 160.0, 20.0, 20.0, 40.0, 100.0, 15.0, -15.0, 60.0, 180.0, 230.0, 10.0, 70.0, 170.0, 40.0, 40.0, 40.0, 130.0, 30.0, 130.0, 180.0, 30.0, 220.0, 10.0, 140.0, 20.0, 30.0, 0.0, 70.0, 20.0, 60.0, 160.0, 120.0, 410.0, -5.0, 40.0, 10.0, 180.0, 130.0, 0.0, 200.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 70.0, 40.0, 10.0, 60.0, 120.0, 0.0, 150.0, -20.0, -40.0, 120.0, 500.0, 50.0, 130.0, 180.0, 30.0, 320.0, 50.0, 170.0, -30.0, 30.0, 50.0, 0.0, 50.0, 0.0, 40.0, 10.0, 0.0, 20.0, 10.0, 60.0, 70.0, 100.0, 30.0, 100.0, 70.0, 160.0, -5.0, 30.0, -5.0, 0.0, -25.0, 0.0, 40.0, 40.0, 0.0, 330.0, 50.0, 80.0, -40.0, 240.0, 50.0, 160.0, 140.0, 200.0, 50.0, 60.0, 90.0, 100.0, 320.0, 220.0, 20.0, 50.0, 140.0, 30.0, 80.0, 20.0, 330.0, 320.0, 100.0, 20.0, 60.0, 170.0, 20.0, 10.0, 50.0, 30.0, 190.0, -30.0, 70.0, 40.0, 190.0, 90.0, 10.0, 20.0, 20.0, 0.0, 30.0, 100.0, 100.0, 200.0, -40.0, 40.0, 40.0, 60.0, 0.0, 70.0, -20.0, 30.0, 520.0, 0.0, 110.0, 350.0, -10.0, 170.0, -50.0, 40.0, 30.0, 90.0, 60.0, 160.0, 110.0, 80.0, 160.0, -10.0, 70.0, 40.0, -30.0, 80.0, 200.0, 210.0, 410.0, 40.0, 70.0, 30.0, 250.0, 80.0, 50.0, 100.0, 370.0, 30.0, 80.0, -10.0, 70.0, 30.0, 40.0, 80.0, -155.0, 190.0, 60.0, 60.0, 20.0, 100.0, 340.0, 30.0, -5.0, 10.0, 110.0, 170.0, 30.0, 0.0, 30.0, 40.0, 80.0, 40.0, 30.0, 60.0, 30.0, 20.0, 50.0, 40.0, 630.0, -50.0, 90.0, 50.0, 240.0, 20.0, 180.0, 120.0, 40.0, 100.0, 430.0, 180.0, 50.0, 70.0, 60.0, 30.0, 50.0, 290.0, 190.0, 90.0, 120.0, 30.0, -20.0, 10.0, 140.0, 40.0, 0.0, 50.0, 50.0, 40.0, 80.0, 80.0, 50.0, 30.0, -40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 20.0, 50.0, 60.0, 50.0, 360.0, 70.0, 50.0, 90.0, 80.0, 70.0, 50.0, 10.0, 290.0, -5.0, 110.0, 90.0, 25.0, 20.0, 160.0, 60.0, 40.0, 55.0, 180.0, 390.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 10.0, 20.0, -10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7027930843363601, "mean_inference_ms": 1.484088420779368, "mean_action_processing_ms": 0.44237338706288026, "mean_env_wait_ms": 1.3568252732299049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014056921005249023, "StateBufferConnector_ms": 0.010672330856323242, "ViewRequirementAgentConnector_ms": 0.42209553718566895}, "num_episodes": 22, "episode_return_max": 1560.0, "episode_return_min": 90.0, "episode_return_mean": 814.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.19500162872246, "num_env_steps_trained_throughput_per_sec": 19.19500162872246, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 1880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1880000, "timers": {"training_iteration_time_ms": 209127.061, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209127.016, "sample_time_ms": 2775.844, "learn_time_ms": 206330.118, "learn_throughput": 19.386, "synch_weights_time_ms": 11.521}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "done": false, "training_iteration": 47, "trial_id": "aa996_00000", "date": "2024-05-24_01-28-26", "timestamp": 1716528506, "time_this_iter_s": 208.39429807662964, "time_total_s": 9773.774909973145, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9773.774909973145, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.913559322033898, "ram_util_percent": 79.04813559322032}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3471169133346304, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.191045708854358, "policy_loss": -0.010905283425004282, "vf_loss": 6.200597573342288, "vf_explained_var": -0.00023839374065906985, "kl": 0.006767118659301038, "entropy": 0.625210300491006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 446025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 1560.0, "episode_reward_min": 90.0, "episode_reward_mean": 798.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 79.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1130.0, 830.0, 1560.0, 945.0, 640.0, 325.0, 290.0, 520.0, 570.0, 1110.0, 910.0, 560.0, 720.0, 995.0, 595.0, 370.0, 1290.0, 560.0, 795.0, 660.0, 790.0, 450.0, 570.0, 575.0, 970.0, 760.0, 930.0, 1520.0, 960.0, 990.0, 950.0, 1355.0, 970.0, 860.0, 720.0, 1075.0, 1100.0, 1020.0, 680.0, 940.0, 470.0, 880.0, 1000.0, 480.0, 90.0, 410.0, 790.0, 280.0, 1085.0, 770.0, 890.0, 720.0, 1105.0, 470.0, 1070.0, 850.0, 340.0, 365.0, 1050.0, 1250.0, 1150.0, 650.0, 510.0, 1110.0, 850.0, 1080.0, 1050.0, 765.0, 495.0, 940.0, 1410.0, 910.0, 540.0, 200.0, 1120.0, 735.0, 520.0, 475.0, 1030.0, 780.0, 305.0, 820.0, 1340.0, 530.0, 1030.0, 435.0, 510.0, 890.0, 790.0, 410.0, 210.0, 1120.0, 785.0, 1100.0, 940.0, 810.0, 590.0, 1070.0, 1430.0, 480.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, -40.0, 80.0, 30.0, 90.0, 300.0, 70.0, 280.0, 90.0, 50.0, 40.0, 130.0, 30.0, 10.0, 290.0, 70.0, 160.0, -30.0, 60.0, 70.0, 60.0, 130.0, 300.0, 70.0, 250.0, 280.0, 90.0, 30.0, 210.0, 140.0, 360.0, 270.0, 110.0, 30.0, 40.0, 40.0, 15.0, 0.0, 60.0, 20.0, 40.0, 20.0, 40.0, 60.0, 0.0, 10.0, 130.0, 170.0, 170.0, 0.0, 20.0, 100.0, 30.0, 60.0, 10.0, 90.0, 20.0, -5.0, 0.0, 0.0, -530.0, 90.0, 30.0, 30.0, 20.0, 460.0, 10.0, 50.0, 90.0, 40.0, 200.0, 20.0, 70.0, 10.0, 0.0, 150.0, 0.0, 0.0, 60.0, 10.0, 60.0, 110.0, 0.0, 40.0, 70.0, 0.0, 10.0, 200.0, 40.0, 40.0, 30.0, 30.0, 160.0, 180.0, 40.0, 70.0, 170.0, 80.0, 160.0, 190.0, 90.0, 20.0, 40.0, 20.0, 50.0, 140.0, 0.0, 360.0, 0.0, 190.0, 30.0, 10.0, 240.0, 200.0, -200.0, -30.0, 10.0, 160.0, 110.0, 30.0, 40.0, 10.0, 10.0, 10.0, 50.0, 10.0, 70.0, 390.0, 10.0, 120.0, 240.0, -15.0, 30.0, 200.0, 80.0, 40.0, 80.0, 150.0, 80.0, 110.0, 30.0, 30.0, 0.0, 80.0, -25.0, 130.0, 90.0, 70.0, 150.0, 40.0, 60.0, 60.0, 0.0, 80.0, 30.0, 30.0, 20.0, 30.0, 0.0, 60.0, 180.0, 10.0, 30.0, 360.0, 260.0, 30.0, 100.0, 60.0, 50.0, 210.0, 30.0, 0.0, 0.0, 260.0, 0.0, 10.0, 110.0, 100.0, 10.0, 40.0, -30.0, 30.0, 230.0, -110.0, 35.0, 130.0, 230.0, 30.0, 110.0, 140.0, 60.0, 40.0, 40.0, 100.0, 150.0, -20.0, 170.0, 20.0, 70.0, 30.0, 120.0, 0.0, 0.0, 70.0, 160.0, 50.0, 270.0, 10.0, 20.0, 90.0, 10.0, 10.0, 70.0, 160.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 50.0, 10.0, 40.0, 30.0, 30.0, 30.0, 230.0, 0.0, 120.0, 30.0, 10.0, 70.0, 70.0, 160.0, 20.0, 0.0, 50.0, 35.0, 40.0, 120.0, 130.0, 150.0, 80.0, 160.0, 120.0, 10.0, 50.0, 10.0, 210.0, 50.0, 50.0, 20.0, 50.0, 70.0, 50.0, 20.0, 20.0, 80.0, 370.0, 30.0, 130.0, 160.0, 40.0, 200.0, 190.0, 0.0, 10.0, 10.0, 190.0, 0.0, -30.0, -90.0, 170.0, 120.0, 30.0, 260.0, 220.0, 270.0, 150.0, 420.0, 120.0, 170.0, 60.0, 0.0, 200.0, 100.0, 30.0, 20.0, 230.0, 30.0, 60.0, 40.0, 100.0, 180.0, 60.0, 60.0, 140.0, 170.0, 60.0, 120.0, 40.0, 540.0, 25.0, 120.0, 50.0, 100.0, 100.0, -105.0, 10.0, 70.0, 100.0, 170.0, 40.0, 110.0, 100.0, 120.0, 180.0, 300.0, 85.0, 150.0, 0.0, 80.0, 230.0, 40.0, 60.0, 490.0, 120.0, -50.0, -20.0, 20.0, 70.0, 350.0, 110.0, 90.0, 40.0, 60.0, 80.0, 20.0, 70.0, -30.0, 200.0, 180.0, 90.0, 10.0, 0.0, 30.0, 110.0, 50.0, 30.0, 20.0, 130.0, -30.0, 290.0, 170.0, 60.0, 5.0, -30.0, 80.0, 60.0, 340.0, 130.0, 90.0, 30.0, 20.0, 30.0, 380.0, -20.0, 250.0, 160.0, 30.0, 180.0, 40.0, 140.0, 0.0, 50.0, 160.0, 90.0, 110.0, 180.0, 70.0, 50.0, 70.0, 70.0, 60.0, 60.0, 70.0, 50.0, 150.0, 60.0, 40.0, 70.0, 370.0, 10.0, 170.0, 10.0, 20.0, 50.0, 30.0, 180.0, 30.0, 150.0, 0.0, 0.0, 40.0, 0.0, 30.0, 0.0, 80.0, 20.0, 150.0, 170.0, 65.0, 50.0, -20.0, 80.0, -10.0, 35.0, 20.0, 480.0, 10.0, 200.0, 80.0, -10.0, 30.0, 0.0, 170.0, 350.0, 20.0, 90.0, 70.0, 170.0, 50.0, 80.0, 40.0, 0.0, 50.0, 10.0, -90.0, 60.0, 110.0, -10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 90.0, 70.0, 0.0, 40.0, 10.0, 10.0, 0.0, 80.0, 90.0, 100.0, 150.0, 50.0, 30.0, -10.0, 130.0, 180.0, 70.0, 50.0, 40.0, 0.0, 20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 20.0, 30.0, 20.0, 35.0, 20.0, 360.0, 0.0, 80.0, 60.0, 420.0, -30.0, 40.0, 100.0, 190.0, 160.0, 20.0, 20.0, 40.0, 100.0, 15.0, -15.0, 60.0, 180.0, 230.0, 10.0, 70.0, 170.0, 40.0, 40.0, 40.0, 130.0, 30.0, 130.0, 180.0, 30.0, 220.0, 10.0, 140.0, 20.0, 30.0, 0.0, 70.0, 20.0, 60.0, 160.0, 120.0, 410.0, -5.0, 40.0, 10.0, 180.0, 130.0, 0.0, 200.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 70.0, 40.0, 10.0, 60.0, 120.0, 0.0, 150.0, -20.0, -40.0, 120.0, 500.0, 50.0, 130.0, 180.0, 30.0, 320.0, 50.0, 170.0, -30.0, 30.0, 50.0, 0.0, 50.0, 0.0, 40.0, 10.0, 0.0, 20.0, 10.0, 60.0, 70.0, 100.0, 30.0, 100.0, 70.0, 160.0, -5.0, 30.0, -5.0, 0.0, -25.0, 0.0, 40.0, 40.0, 0.0, 330.0, 50.0, 80.0, -40.0, 240.0, 50.0, 160.0, 140.0, 200.0, 50.0, 60.0, 90.0, 100.0, 320.0, 220.0, 20.0, 50.0, 140.0, 30.0, 80.0, 20.0, 330.0, 320.0, 100.0, 20.0, 60.0, 170.0, 20.0, 10.0, 50.0, 30.0, 190.0, -30.0, 70.0, 40.0, 190.0, 90.0, 10.0, 20.0, 20.0, 0.0, 30.0, 100.0, 100.0, 200.0, -40.0, 40.0, 40.0, 60.0, 0.0, 70.0, -20.0, 30.0, 520.0, 0.0, 110.0, 350.0, -10.0, 170.0, -50.0, 40.0, 30.0, 90.0, 60.0, 160.0, 110.0, 80.0, 160.0, -10.0, 70.0, 40.0, -30.0, 80.0, 200.0, 210.0, 410.0, 40.0, 70.0, 30.0, 250.0, 80.0, 50.0, 100.0, 370.0, 30.0, 80.0, -10.0, 70.0, 30.0, 40.0, 80.0, -155.0, 190.0, 60.0, 60.0, 20.0, 100.0, 340.0, 30.0, -5.0, 10.0, 110.0, 170.0, 30.0, 0.0, 30.0, 40.0, 80.0, 40.0, 30.0, 60.0, 30.0, 20.0, 50.0, 40.0, 630.0, -50.0, 90.0, 50.0, 240.0, 20.0, 180.0, 120.0, 40.0, 100.0, 430.0, 180.0, 50.0, 70.0, 60.0, 30.0, 50.0, 290.0, 190.0, 90.0, 120.0, 30.0, -20.0, 10.0, 140.0, 40.0, 0.0, 50.0, 50.0, 40.0, 80.0, 80.0, 50.0, 30.0, -40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 20.0, 50.0, 60.0, 50.0, 360.0, 70.0, 50.0, 90.0, 80.0, 70.0, 50.0, 10.0, 290.0, -5.0, 110.0, 90.0, 25.0, 20.0, 160.0, 60.0, 40.0, 55.0, 180.0, 390.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 10.0, 20.0, -10.0, 20.0, 90.0, -35.0, 80.0, 50.0, 30.0, 10.0, 170.0, 0.0, 60.0, 60.0, 120.0, 110.0, 150.0, 20.0, 60.0, 260.0, 120.0, 100.0, 30.0, 10.0, 60.0, -30.0, -20.0, 60.0, 10.0, 70.0, -30.0, 40.0, 610.0, 30.0, 20.0, 0.0, 50.0, 10.0, 150.0, 50.0, 0.0, -5.0, 0.0, 20.0, 70.0, 30.0, 110.0, 40.0, 10.0, 200.0, 100.0, 40.0, 200.0, 90.0, 30.0, 120.0, 70.0, 180.0, 40.0, 510.0, 80.0, 30.0, 190.0, 30.0, 30.0, 30.0, 50.0, 100.0, 20.0, 120.0, 50.0, 100.0, 0.0, 370.0, 60.0, 170.0, 40.0, 170.0, 60.0, 90.0, 30.0, 10.0, 30.0, 130.0, 90.0, 10.0, 0.0, 30.0, 50.0, 30.0, 25.0, 40.0, 30.0, 0.0, 60.0, 90.0, 40.0, 0.0, 60.0, 10.0, 0.0, 0.0, 250.0, 100.0, 180.0, 170.0, -65.0, 40.0, 80.0, 55.0, 30.0, 280.0, 20.0, 40.0, 15.0, 50.0, 35.0, 40.0, 420.0, 50.0, 100.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 30.0, 280.0, 0.0, 20.0, 10.0, 0.0, 20.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 220.0, 80.0, 120.0, 50.0, 90.0, 80.0, 80.0, 50.0, 300.0, 50.0, 80.0, 50.0, 190.0, 120.0, 180.0, 0.0, 80.0, 25.0, 40.0, 20.0, 50.0, 30.0, 50.0, 120.0, 260.0, 180.0, 160.0, -40.0, 220.0, 70.0, 100.0, 50.0, 80.0, 170.0, 70.0, 100.0, 0.0, 170.0, 150.0, 50.0, 160.0, 100.0, 130.0, 0.0, -30.0, 30.0, 230.0, 120.0, 30.0, 40.0, 110.0, 110.0, 60.0, 110.0, 40.0, 60.0, 50.0, 10.0, 20.0, 20.0, -30.0, 290.0, 20.0, 30.0, 40.0, 150.0, 40.0, 170.0, 40.0, 320.0, 80.0, 20.0, 110.0, 150.0, 310.0, 180.0, 250.0, 70.0, 150.0, 110.0, 20.0, 60.0, 100.0, 30.0, 20.0, 70.0, 30.0, 20.0, 70.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6996659476754514, "mean_inference_ms": 1.4802273536562416, "mean_action_processing_ms": 0.4412882641471738, "mean_env_wait_ms": 1.3584023660343112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013304471969604492, "StateBufferConnector_ms": 0.010519742965698242, "ViewRequirementAgentConnector_ms": 0.425900936126709}, "num_episodes": 23, "episode_return_max": 1560.0, "episode_return_min": 90.0, "episode_return_mean": 798.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.147661468759615, "num_env_steps_trained_throughput_per_sec": 19.147661468759615, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 209082.934, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209082.887, "sample_time_ms": 2755.756, "learn_time_ms": 206305.366, "learn_throughput": 19.389, "synch_weights_time_ms": 11.522}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 48, "trial_id": "aa996_00000", "date": "2024-05-24_01-31-55", "timestamp": 1716528715, "time_this_iter_s": 208.9152159690857, "time_total_s": 9982.69012594223, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ff940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9982.69012594223, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 19.29084745762712, "ram_util_percent": 79.28813559322033}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.387876741986432, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.620142118313823, "policy_loss": -0.008387613776489533, "vf_loss": 6.627264333050599, "vf_explained_var": 0.002045130171080113, "kl": 0.006326963273909824, "entropy": 0.5764180304809882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 455415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "env_runners": {"episode_reward_max": 1670.0, "episode_reward_min": 90.0, "episode_reward_mean": 808.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -155.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 80.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [795.0, 660.0, 790.0, 450.0, 570.0, 575.0, 970.0, 760.0, 930.0, 1520.0, 960.0, 990.0, 950.0, 1355.0, 970.0, 860.0, 720.0, 1075.0, 1100.0, 1020.0, 680.0, 940.0, 470.0, 880.0, 1000.0, 480.0, 90.0, 410.0, 790.0, 280.0, 1085.0, 770.0, 890.0, 720.0, 1105.0, 470.0, 1070.0, 850.0, 340.0, 365.0, 1050.0, 1250.0, 1150.0, 650.0, 510.0, 1110.0, 850.0, 1080.0, 1050.0, 765.0, 495.0, 940.0, 1410.0, 910.0, 540.0, 200.0, 1120.0, 735.0, 520.0, 475.0, 1030.0, 780.0, 305.0, 820.0, 1340.0, 530.0, 1030.0, 435.0, 510.0, 890.0, 790.0, 410.0, 210.0, 1120.0, 785.0, 1100.0, 940.0, 810.0, 590.0, 1070.0, 1430.0, 480.0, 1200.0, 330.0, 495.0, 940.0, 790.0, 670.0, 1190.0, 410.0, 790.0, 1080.0, 460.0, 865.0, 1080.0, 1020.0, 740.0, 780.0, 1670.0, 375.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-30.0, 30.0, 230.0, -110.0, 35.0, 130.0, 230.0, 30.0, 110.0, 140.0, 60.0, 40.0, 40.0, 100.0, 150.0, -20.0, 170.0, 20.0, 70.0, 30.0, 120.0, 0.0, 0.0, 70.0, 160.0, 50.0, 270.0, 10.0, 20.0, 90.0, 10.0, 10.0, 70.0, 160.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 50.0, 10.0, 40.0, 30.0, 30.0, 30.0, 230.0, 0.0, 120.0, 30.0, 10.0, 70.0, 70.0, 160.0, 20.0, 0.0, 50.0, 35.0, 40.0, 120.0, 130.0, 150.0, 80.0, 160.0, 120.0, 10.0, 50.0, 10.0, 210.0, 50.0, 50.0, 20.0, 50.0, 70.0, 50.0, 20.0, 20.0, 80.0, 370.0, 30.0, 130.0, 160.0, 40.0, 200.0, 190.0, 0.0, 10.0, 10.0, 190.0, 0.0, -30.0, -90.0, 170.0, 120.0, 30.0, 260.0, 220.0, 270.0, 150.0, 420.0, 120.0, 170.0, 60.0, 0.0, 200.0, 100.0, 30.0, 20.0, 230.0, 30.0, 60.0, 40.0, 100.0, 180.0, 60.0, 60.0, 140.0, 170.0, 60.0, 120.0, 40.0, 540.0, 25.0, 120.0, 50.0, 100.0, 100.0, -105.0, 10.0, 70.0, 100.0, 170.0, 40.0, 110.0, 100.0, 120.0, 180.0, 300.0, 85.0, 150.0, 0.0, 80.0, 230.0, 40.0, 60.0, 490.0, 120.0, -50.0, -20.0, 20.0, 70.0, 350.0, 110.0, 90.0, 40.0, 60.0, 80.0, 20.0, 70.0, -30.0, 200.0, 180.0, 90.0, 10.0, 0.0, 30.0, 110.0, 50.0, 30.0, 20.0, 130.0, -30.0, 290.0, 170.0, 60.0, 5.0, -30.0, 80.0, 60.0, 340.0, 130.0, 90.0, 30.0, 20.0, 30.0, 380.0, -20.0, 250.0, 160.0, 30.0, 180.0, 40.0, 140.0, 0.0, 50.0, 160.0, 90.0, 110.0, 180.0, 70.0, 50.0, 70.0, 70.0, 60.0, 60.0, 70.0, 50.0, 150.0, 60.0, 40.0, 70.0, 370.0, 10.0, 170.0, 10.0, 20.0, 50.0, 30.0, 180.0, 30.0, 150.0, 0.0, 0.0, 40.0, 0.0, 30.0, 0.0, 80.0, 20.0, 150.0, 170.0, 65.0, 50.0, -20.0, 80.0, -10.0, 35.0, 20.0, 480.0, 10.0, 200.0, 80.0, -10.0, 30.0, 0.0, 170.0, 350.0, 20.0, 90.0, 70.0, 170.0, 50.0, 80.0, 40.0, 0.0, 50.0, 10.0, -90.0, 60.0, 110.0, -10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 90.0, 70.0, 0.0, 40.0, 10.0, 10.0, 0.0, 80.0, 90.0, 100.0, 150.0, 50.0, 30.0, -10.0, 130.0, 180.0, 70.0, 50.0, 40.0, 0.0, 20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 20.0, 30.0, 20.0, 35.0, 20.0, 360.0, 0.0, 80.0, 60.0, 420.0, -30.0, 40.0, 100.0, 190.0, 160.0, 20.0, 20.0, 40.0, 100.0, 15.0, -15.0, 60.0, 180.0, 230.0, 10.0, 70.0, 170.0, 40.0, 40.0, 40.0, 130.0, 30.0, 130.0, 180.0, 30.0, 220.0, 10.0, 140.0, 20.0, 30.0, 0.0, 70.0, 20.0, 60.0, 160.0, 120.0, 410.0, -5.0, 40.0, 10.0, 180.0, 130.0, 0.0, 200.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 70.0, 40.0, 10.0, 60.0, 120.0, 0.0, 150.0, -20.0, -40.0, 120.0, 500.0, 50.0, 130.0, 180.0, 30.0, 320.0, 50.0, 170.0, -30.0, 30.0, 50.0, 0.0, 50.0, 0.0, 40.0, 10.0, 0.0, 20.0, 10.0, 60.0, 70.0, 100.0, 30.0, 100.0, 70.0, 160.0, -5.0, 30.0, -5.0, 0.0, -25.0, 0.0, 40.0, 40.0, 0.0, 330.0, 50.0, 80.0, -40.0, 240.0, 50.0, 160.0, 140.0, 200.0, 50.0, 60.0, 90.0, 100.0, 320.0, 220.0, 20.0, 50.0, 140.0, 30.0, 80.0, 20.0, 330.0, 320.0, 100.0, 20.0, 60.0, 170.0, 20.0, 10.0, 50.0, 30.0, 190.0, -30.0, 70.0, 40.0, 190.0, 90.0, 10.0, 20.0, 20.0, 0.0, 30.0, 100.0, 100.0, 200.0, -40.0, 40.0, 40.0, 60.0, 0.0, 70.0, -20.0, 30.0, 520.0, 0.0, 110.0, 350.0, -10.0, 170.0, -50.0, 40.0, 30.0, 90.0, 60.0, 160.0, 110.0, 80.0, 160.0, -10.0, 70.0, 40.0, -30.0, 80.0, 200.0, 210.0, 410.0, 40.0, 70.0, 30.0, 250.0, 80.0, 50.0, 100.0, 370.0, 30.0, 80.0, -10.0, 70.0, 30.0, 40.0, 80.0, -155.0, 190.0, 60.0, 60.0, 20.0, 100.0, 340.0, 30.0, -5.0, 10.0, 110.0, 170.0, 30.0, 0.0, 30.0, 40.0, 80.0, 40.0, 30.0, 60.0, 30.0, 20.0, 50.0, 40.0, 630.0, -50.0, 90.0, 50.0, 240.0, 20.0, 180.0, 120.0, 40.0, 100.0, 430.0, 180.0, 50.0, 70.0, 60.0, 30.0, 50.0, 290.0, 190.0, 90.0, 120.0, 30.0, -20.0, 10.0, 140.0, 40.0, 0.0, 50.0, 50.0, 40.0, 80.0, 80.0, 50.0, 30.0, -40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 20.0, 50.0, 60.0, 50.0, 360.0, 70.0, 50.0, 90.0, 80.0, 70.0, 50.0, 10.0, 290.0, -5.0, 110.0, 90.0, 25.0, 20.0, 160.0, 60.0, 40.0, 55.0, 180.0, 390.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 10.0, 20.0, -10.0, 20.0, 90.0, -35.0, 80.0, 50.0, 30.0, 10.0, 170.0, 0.0, 60.0, 60.0, 120.0, 110.0, 150.0, 20.0, 60.0, 260.0, 120.0, 100.0, 30.0, 10.0, 60.0, -30.0, -20.0, 60.0, 10.0, 70.0, -30.0, 40.0, 610.0, 30.0, 20.0, 0.0, 50.0, 10.0, 150.0, 50.0, 0.0, -5.0, 0.0, 20.0, 70.0, 30.0, 110.0, 40.0, 10.0, 200.0, 100.0, 40.0, 200.0, 90.0, 30.0, 120.0, 70.0, 180.0, 40.0, 510.0, 80.0, 30.0, 190.0, 30.0, 30.0, 30.0, 50.0, 100.0, 20.0, 120.0, 50.0, 100.0, 0.0, 370.0, 60.0, 170.0, 40.0, 170.0, 60.0, 90.0, 30.0, 10.0, 30.0, 130.0, 90.0, 10.0, 0.0, 30.0, 50.0, 30.0, 25.0, 40.0, 30.0, 0.0, 60.0, 90.0, 40.0, 0.0, 60.0, 10.0, 0.0, 0.0, 250.0, 100.0, 180.0, 170.0, -65.0, 40.0, 80.0, 55.0, 30.0, 280.0, 20.0, 40.0, 15.0, 50.0, 35.0, 40.0, 420.0, 50.0, 100.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 30.0, 280.0, 0.0, 20.0, 10.0, 0.0, 20.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 220.0, 80.0, 120.0, 50.0, 90.0, 80.0, 80.0, 50.0, 300.0, 50.0, 80.0, 50.0, 190.0, 120.0, 180.0, 0.0, 80.0, 25.0, 40.0, 20.0, 50.0, 30.0, 50.0, 120.0, 260.0, 180.0, 160.0, -40.0, 220.0, 70.0, 100.0, 50.0, 80.0, 170.0, 70.0, 100.0, 0.0, 170.0, 150.0, 50.0, 160.0, 100.0, 130.0, 0.0, -30.0, 30.0, 230.0, 120.0, 30.0, 40.0, 110.0, 110.0, 60.0, 110.0, 40.0, 60.0, 50.0, 10.0, 20.0, 20.0, -30.0, 290.0, 20.0, 30.0, 40.0, 150.0, 40.0, 170.0, 40.0, 320.0, 80.0, 20.0, 110.0, 150.0, 310.0, 180.0, 250.0, 70.0, 150.0, 110.0, 20.0, 60.0, 100.0, 30.0, 20.0, 70.0, 30.0, 20.0, 70.0, 60.0, 220.0, 200.0, 30.0, 230.0, -30.0, 80.0, 20.0, 50.0, 180.0, 220.0, 160.0, 10.0, 0.0, 10.0, 60.0, 5.0, 20.0, 20.0, 40.0, 5.0, 40.0, 150.0, 80.0, 0.0, 100.0, 50.0, 20.0, 10.0, 10.0, 35.0, 70.0, 60.0, 0.0, 80.0, 280.0, 60.0, -30.0, 100.0, 160.0, 160.0, 10.0, 30.0, 50.0, 50.0, 190.0, 50.0, 160.0, 30.0, 60.0, 160.0, 50.0, 150.0, -25.0, 5.0, 80.0, 0.0, 150.0, 20.0, 40.0, 200.0, 10.0, 60.0, 240.0, 350.0, 90.0, 100.0, 120.0, 80.0, 50.0, 90.0, 60.0, 20.0, 10.0, 20.0, 60.0, 30.0, 10.0, 40.0, 70.0, 90.0, 400.0, 20.0, 60.0, 70.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 110.0, 20.0, 20.0, 70.0, 70.0, 460.0, 70.0, 170.0, 10.0, 80.0, 140.0, 20.0, 10.0, 30.0, 70.0, 0.0, 40.0, 0.0, 100.0, 50.0, 70.0, 190.0, 180.0, 50.0, -30.0, 0.0, 380.0, 40.0, 20.0, -35.0, 30.0, 260.0, 80.0, 100.0, 20.0, 50.0, 110.0, 170.0, 230.0, 30.0, 170.0, 170.0, 40.0, 300.0, 60.0, 40.0, 40.0, 50.0, 80.0, 70.0, 90.0, 0.0, 30.0, 20.0, 10.0, 40.0, 390.0, 70.0, 30.0, 60.0, 60.0, -10.0, 70.0, 40.0, 70.0, 20.0, 40.0, 430.0, 40.0, 20.0, 340.0, 230.0, 170.0, 110.0, 290.0, 80.0, 80.0, 170.0, 170.0, 30.0, 70.0, 0.0, 30.0, 10.0, -10.0, 50.0, 180.0, 5.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6998600725168467, "mean_inference_ms": 1.4826482453443344, "mean_action_processing_ms": 0.44070589519984465, "mean_env_wait_ms": 1.3565854692954644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012802839279174805, "StateBufferConnector_ms": 0.010101318359375, "ViewRequirementAgentConnector_ms": 0.4161865711212158}, "num_episodes": 18, "episode_return_max": 1670.0, "episode_return_min": 90.0, "episode_return_mean": 808.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.030326739561442, "num_env_steps_trained_throughput_per_sec": 19.030326739561442, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 1960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1960000, "timers": {"training_iteration_time_ms": 209121.159, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209121.111, "sample_time_ms": 2739.371, "learn_time_ms": 206360.285, "learn_throughput": 19.384, "synch_weights_time_ms": 11.264}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "done": false, "training_iteration": 49, "trial_id": "aa996_00000", "date": "2024-05-24_01-35-25", "timestamp": 1716528925, "time_this_iter_s": 210.19749879837036, "time_total_s": 10192.8876247406, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dbaf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10192.8876247406, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.71750841750842, "ram_util_percent": 79.6976430976431}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.065819969763771, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.665085647814571, "policy_loss": -0.009811408297234156, "vf_loss": 6.673491338419076, "vf_explained_var": 0.000791925477524535, "kl": 0.007028551642584448, "entropy": 0.5722060128205374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 464805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 1670.0, "episode_reward_min": 90.0, "episode_reward_mean": 811.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -155.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 81.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1100.0, 1020.0, 680.0, 940.0, 470.0, 880.0, 1000.0, 480.0, 90.0, 410.0, 790.0, 280.0, 1085.0, 770.0, 890.0, 720.0, 1105.0, 470.0, 1070.0, 850.0, 340.0, 365.0, 1050.0, 1250.0, 1150.0, 650.0, 510.0, 1110.0, 850.0, 1080.0, 1050.0, 765.0, 495.0, 940.0, 1410.0, 910.0, 540.0, 200.0, 1120.0, 735.0, 520.0, 475.0, 1030.0, 780.0, 305.0, 820.0, 1340.0, 530.0, 1030.0, 435.0, 510.0, 890.0, 790.0, 410.0, 210.0, 1120.0, 785.0, 1100.0, 940.0, 810.0, 590.0, 1070.0, 1430.0, 480.0, 1200.0, 330.0, 495.0, 940.0, 790.0, 670.0, 1190.0, 410.0, 790.0, 1080.0, 460.0, 865.0, 1080.0, 1020.0, 740.0, 780.0, 1670.0, 375.0, 810.0, 615.0, 1070.0, 590.0, 1160.0, 870.0, 1250.0, 690.0, 1110.0, 1330.0, 590.0, 830.0, 610.0, 270.0, 900.0, 1165.0, 1600.0, 820.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 90.0, 30.0, 20.0, 30.0, 380.0, -20.0, 250.0, 160.0, 30.0, 180.0, 40.0, 140.0, 0.0, 50.0, 160.0, 90.0, 110.0, 180.0, 70.0, 50.0, 70.0, 70.0, 60.0, 60.0, 70.0, 50.0, 150.0, 60.0, 40.0, 70.0, 370.0, 10.0, 170.0, 10.0, 20.0, 50.0, 30.0, 180.0, 30.0, 150.0, 0.0, 0.0, 40.0, 0.0, 30.0, 0.0, 80.0, 20.0, 150.0, 170.0, 65.0, 50.0, -20.0, 80.0, -10.0, 35.0, 20.0, 480.0, 10.0, 200.0, 80.0, -10.0, 30.0, 0.0, 170.0, 350.0, 20.0, 90.0, 70.0, 170.0, 50.0, 80.0, 40.0, 0.0, 50.0, 10.0, -90.0, 60.0, 110.0, -10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 90.0, 70.0, 0.0, 40.0, 10.0, 10.0, 0.0, 80.0, 90.0, 100.0, 150.0, 50.0, 30.0, -10.0, 130.0, 180.0, 70.0, 50.0, 40.0, 0.0, 20.0, 50.0, 40.0, 50.0, 30.0, 20.0, 20.0, 30.0, 20.0, 35.0, 20.0, 360.0, 0.0, 80.0, 60.0, 420.0, -30.0, 40.0, 100.0, 190.0, 160.0, 20.0, 20.0, 40.0, 100.0, 15.0, -15.0, 60.0, 180.0, 230.0, 10.0, 70.0, 170.0, 40.0, 40.0, 40.0, 130.0, 30.0, 130.0, 180.0, 30.0, 220.0, 10.0, 140.0, 20.0, 30.0, 0.0, 70.0, 20.0, 60.0, 160.0, 120.0, 410.0, -5.0, 40.0, 10.0, 180.0, 130.0, 0.0, 200.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 70.0, 40.0, 10.0, 60.0, 120.0, 0.0, 150.0, -20.0, -40.0, 120.0, 500.0, 50.0, 130.0, 180.0, 30.0, 320.0, 50.0, 170.0, -30.0, 30.0, 50.0, 0.0, 50.0, 0.0, 40.0, 10.0, 0.0, 20.0, 10.0, 60.0, 70.0, 100.0, 30.0, 100.0, 70.0, 160.0, -5.0, 30.0, -5.0, 0.0, -25.0, 0.0, 40.0, 40.0, 0.0, 330.0, 50.0, 80.0, -40.0, 240.0, 50.0, 160.0, 140.0, 200.0, 50.0, 60.0, 90.0, 100.0, 320.0, 220.0, 20.0, 50.0, 140.0, 30.0, 80.0, 20.0, 330.0, 320.0, 100.0, 20.0, 60.0, 170.0, 20.0, 10.0, 50.0, 30.0, 190.0, -30.0, 70.0, 40.0, 190.0, 90.0, 10.0, 20.0, 20.0, 0.0, 30.0, 100.0, 100.0, 200.0, -40.0, 40.0, 40.0, 60.0, 0.0, 70.0, -20.0, 30.0, 520.0, 0.0, 110.0, 350.0, -10.0, 170.0, -50.0, 40.0, 30.0, 90.0, 60.0, 160.0, 110.0, 80.0, 160.0, -10.0, 70.0, 40.0, -30.0, 80.0, 200.0, 210.0, 410.0, 40.0, 70.0, 30.0, 250.0, 80.0, 50.0, 100.0, 370.0, 30.0, 80.0, -10.0, 70.0, 30.0, 40.0, 80.0, -155.0, 190.0, 60.0, 60.0, 20.0, 100.0, 340.0, 30.0, -5.0, 10.0, 110.0, 170.0, 30.0, 0.0, 30.0, 40.0, 80.0, 40.0, 30.0, 60.0, 30.0, 20.0, 50.0, 40.0, 630.0, -50.0, 90.0, 50.0, 240.0, 20.0, 180.0, 120.0, 40.0, 100.0, 430.0, 180.0, 50.0, 70.0, 60.0, 30.0, 50.0, 290.0, 190.0, 90.0, 120.0, 30.0, -20.0, 10.0, 140.0, 40.0, 0.0, 50.0, 50.0, 40.0, 80.0, 80.0, 50.0, 30.0, -40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 20.0, 50.0, 60.0, 50.0, 360.0, 70.0, 50.0, 90.0, 80.0, 70.0, 50.0, 10.0, 290.0, -5.0, 110.0, 90.0, 25.0, 20.0, 160.0, 60.0, 40.0, 55.0, 180.0, 390.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 10.0, 20.0, -10.0, 20.0, 90.0, -35.0, 80.0, 50.0, 30.0, 10.0, 170.0, 0.0, 60.0, 60.0, 120.0, 110.0, 150.0, 20.0, 60.0, 260.0, 120.0, 100.0, 30.0, 10.0, 60.0, -30.0, -20.0, 60.0, 10.0, 70.0, -30.0, 40.0, 610.0, 30.0, 20.0, 0.0, 50.0, 10.0, 150.0, 50.0, 0.0, -5.0, 0.0, 20.0, 70.0, 30.0, 110.0, 40.0, 10.0, 200.0, 100.0, 40.0, 200.0, 90.0, 30.0, 120.0, 70.0, 180.0, 40.0, 510.0, 80.0, 30.0, 190.0, 30.0, 30.0, 30.0, 50.0, 100.0, 20.0, 120.0, 50.0, 100.0, 0.0, 370.0, 60.0, 170.0, 40.0, 170.0, 60.0, 90.0, 30.0, 10.0, 30.0, 130.0, 90.0, 10.0, 0.0, 30.0, 50.0, 30.0, 25.0, 40.0, 30.0, 0.0, 60.0, 90.0, 40.0, 0.0, 60.0, 10.0, 0.0, 0.0, 250.0, 100.0, 180.0, 170.0, -65.0, 40.0, 80.0, 55.0, 30.0, 280.0, 20.0, 40.0, 15.0, 50.0, 35.0, 40.0, 420.0, 50.0, 100.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 30.0, 280.0, 0.0, 20.0, 10.0, 0.0, 20.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 220.0, 80.0, 120.0, 50.0, 90.0, 80.0, 80.0, 50.0, 300.0, 50.0, 80.0, 50.0, 190.0, 120.0, 180.0, 0.0, 80.0, 25.0, 40.0, 20.0, 50.0, 30.0, 50.0, 120.0, 260.0, 180.0, 160.0, -40.0, 220.0, 70.0, 100.0, 50.0, 80.0, 170.0, 70.0, 100.0, 0.0, 170.0, 150.0, 50.0, 160.0, 100.0, 130.0, 0.0, -30.0, 30.0, 230.0, 120.0, 30.0, 40.0, 110.0, 110.0, 60.0, 110.0, 40.0, 60.0, 50.0, 10.0, 20.0, 20.0, -30.0, 290.0, 20.0, 30.0, 40.0, 150.0, 40.0, 170.0, 40.0, 320.0, 80.0, 20.0, 110.0, 150.0, 310.0, 180.0, 250.0, 70.0, 150.0, 110.0, 20.0, 60.0, 100.0, 30.0, 20.0, 70.0, 30.0, 20.0, 70.0, 60.0, 220.0, 200.0, 30.0, 230.0, -30.0, 80.0, 20.0, 50.0, 180.0, 220.0, 160.0, 10.0, 0.0, 10.0, 60.0, 5.0, 20.0, 20.0, 40.0, 5.0, 40.0, 150.0, 80.0, 0.0, 100.0, 50.0, 20.0, 10.0, 10.0, 35.0, 70.0, 60.0, 0.0, 80.0, 280.0, 60.0, -30.0, 100.0, 160.0, 160.0, 10.0, 30.0, 50.0, 50.0, 190.0, 50.0, 160.0, 30.0, 60.0, 160.0, 50.0, 150.0, -25.0, 5.0, 80.0, 0.0, 150.0, 20.0, 40.0, 200.0, 10.0, 60.0, 240.0, 350.0, 90.0, 100.0, 120.0, 80.0, 50.0, 90.0, 60.0, 20.0, 10.0, 20.0, 60.0, 30.0, 10.0, 40.0, 70.0, 90.0, 400.0, 20.0, 60.0, 70.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 110.0, 20.0, 20.0, 70.0, 70.0, 460.0, 70.0, 170.0, 10.0, 80.0, 140.0, 20.0, 10.0, 30.0, 70.0, 0.0, 40.0, 0.0, 100.0, 50.0, 70.0, 190.0, 180.0, 50.0, -30.0, 0.0, 380.0, 40.0, 20.0, -35.0, 30.0, 260.0, 80.0, 100.0, 20.0, 50.0, 110.0, 170.0, 230.0, 30.0, 170.0, 170.0, 40.0, 300.0, 60.0, 40.0, 40.0, 50.0, 80.0, 70.0, 90.0, 0.0, 30.0, 20.0, 10.0, 40.0, 390.0, 70.0, 30.0, 60.0, 60.0, -10.0, 70.0, 40.0, 70.0, 20.0, 40.0, 430.0, 40.0, 20.0, 340.0, 230.0, 170.0, 110.0, 290.0, 80.0, 80.0, 170.0, 170.0, 30.0, 70.0, 0.0, 30.0, 10.0, -10.0, 50.0, 180.0, 5.0, 0.0, 40.0, 160.0, 20.0, 0.0, 60.0, 260.0, 40.0, 130.0, 10.0, 10.0, 120.0, 10.0, 90.0, 40.0, 130.0, 70.0, 30.0, 5.0, 160.0, 30.0, 50.0, 70.0, 60.0, 60.0, 30.0, 100.0, 20.0, 110.0, 40.0, 250.0, 330.0, 20.0, 10.0, 270.0, 20.0, 0.0, 0.0, 20.0, 190.0, 60.0, 0.0, 0.0, 60.0, 170.0, 110.0, 0.0, 350.0, 60.0, 90.0, 50.0, 270.0, 110.0, 60.0, 50.0, 140.0, 70.0, 50.0, 150.0, 30.0, 40.0, 170.0, 130.0, 70.0, 580.0, 240.0, -10.0, 80.0, 0.0, -30.0, 170.0, 20.0, 90.0, 20.0, 10.0, 80.0, 90.0, 100.0, 80.0, 60.0, 70.0, 90.0, 240.0, 110.0, 110.0, 90.0, 100.0, 200.0, 160.0, 20.0, 20.0, 60.0, 430.0, 270.0, 80.0, 100.0, 180.0, 50.0, 160.0, 50.0, -140.0, 150.0, 60.0, 50.0, 40.0, 70.0, 30.0, 30.0, 70.0, 10.0, 160.0, 70.0, -20.0, 270.0, 50.0, 70.0, 100.0, 60.0, 90.0, 150.0, 40.0, 20.0, 30.0, 30.0, 30.0, 60.0, 50.0, 130.0, 160.0, 50.0, 20.0, 50.0, 30.0, 10.0, 40.0, 20.0, 0.0, 130.0, 30.0, 10.0, 0.0, 0.0, 80.0, 70.0, 70.0, 200.0, 90.0, 90.0, 70.0, 180.0, 20.0, 30.0, 50.0, -155.0, 10.0, 200.0, 310.0, 540.0, 130.0, 90.0, 20.0, -30.0, 70.0, 60.0, 70.0, 600.0, 90.0, 210.0, 150.0, 80.0, 200.0, 70.0, 40.0, -70.0, 90.0, 20.0, 20.0, 80.0, 110.0, 160.0, 180.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.699415178918948, "mean_inference_ms": 1.4827814491101485, "mean_action_processing_ms": 0.44012620660836915, "mean_env_wait_ms": 1.3561071205469672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012961149215698242, "StateBufferConnector_ms": 0.010073184967041016, "ViewRequirementAgentConnector_ms": 0.41496729850769043}, "num_episodes": 18, "episode_return_max": 1670.0, "episode_return_min": 90.0, "episode_return_mean": 811.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.550811464154812, "num_env_steps_trained_throughput_per_sec": 18.550811464154812, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 209709.799, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209709.751, "sample_time_ms": 2772.613, "learn_time_ms": 206914.605, "learn_throughput": 19.332, "synch_weights_time_ms": 12.396}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 50, "trial_id": "aa996_00000", "date": "2024-05-24_01-39-01", "timestamp": 1716529141, "time_this_iter_s": 215.64368987083435, "time_total_s": 10408.531314611435, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd2d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10408.531314611435, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 26.64065573770492, "ram_util_percent": 80.19475409836066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.111356759985415, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.714329298362691, "policy_loss": -0.008604798745512725, "vf_loss": 6.721569916082267, "vf_explained_var": 0.0003028582460202348, "kl": 0.006820923868710355, "entropy": 0.5622816508570418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 474195.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 1670.0, "episode_reward_min": 200.0, "episode_reward_mean": 845.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -460.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 84.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1070.0, 850.0, 340.0, 365.0, 1050.0, 1250.0, 1150.0, 650.0, 510.0, 1110.0, 850.0, 1080.0, 1050.0, 765.0, 495.0, 940.0, 1410.0, 910.0, 540.0, 200.0, 1120.0, 735.0, 520.0, 475.0, 1030.0, 780.0, 305.0, 820.0, 1340.0, 530.0, 1030.0, 435.0, 510.0, 890.0, 790.0, 410.0, 210.0, 1120.0, 785.0, 1100.0, 940.0, 810.0, 590.0, 1070.0, 1430.0, 480.0, 1200.0, 330.0, 495.0, 940.0, 790.0, 670.0, 1190.0, 410.0, 790.0, 1080.0, 460.0, 865.0, 1080.0, 1020.0, 740.0, 780.0, 1670.0, 375.0, 810.0, 615.0, 1070.0, 590.0, 1160.0, 870.0, 1250.0, 690.0, 1110.0, 1330.0, 590.0, 830.0, 610.0, 270.0, 900.0, 1165.0, 1600.0, 820.0, 1380.0, 1000.0, 490.0, 670.0, 810.0, 670.0, 540.0, 1300.0, 1360.0, 1060.0, 670.0, 810.0, 560.0, 1510.0, 1430.0, 980.0, 830.0, 500.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 120.0, 0.0, 150.0, -20.0, -40.0, 120.0, 500.0, 50.0, 130.0, 180.0, 30.0, 320.0, 50.0, 170.0, -30.0, 30.0, 50.0, 0.0, 50.0, 0.0, 40.0, 10.0, 0.0, 20.0, 10.0, 60.0, 70.0, 100.0, 30.0, 100.0, 70.0, 160.0, -5.0, 30.0, -5.0, 0.0, -25.0, 0.0, 40.0, 40.0, 0.0, 330.0, 50.0, 80.0, -40.0, 240.0, 50.0, 160.0, 140.0, 200.0, 50.0, 60.0, 90.0, 100.0, 320.0, 220.0, 20.0, 50.0, 140.0, 30.0, 80.0, 20.0, 330.0, 320.0, 100.0, 20.0, 60.0, 170.0, 20.0, 10.0, 50.0, 30.0, 190.0, -30.0, 70.0, 40.0, 190.0, 90.0, 10.0, 20.0, 20.0, 0.0, 30.0, 100.0, 100.0, 200.0, -40.0, 40.0, 40.0, 60.0, 0.0, 70.0, -20.0, 30.0, 520.0, 0.0, 110.0, 350.0, -10.0, 170.0, -50.0, 40.0, 30.0, 90.0, 60.0, 160.0, 110.0, 80.0, 160.0, -10.0, 70.0, 40.0, -30.0, 80.0, 200.0, 210.0, 410.0, 40.0, 70.0, 30.0, 250.0, 80.0, 50.0, 100.0, 370.0, 30.0, 80.0, -10.0, 70.0, 30.0, 40.0, 80.0, -155.0, 190.0, 60.0, 60.0, 20.0, 100.0, 340.0, 30.0, -5.0, 10.0, 110.0, 170.0, 30.0, 0.0, 30.0, 40.0, 80.0, 40.0, 30.0, 60.0, 30.0, 20.0, 50.0, 40.0, 630.0, -50.0, 90.0, 50.0, 240.0, 20.0, 180.0, 120.0, 40.0, 100.0, 430.0, 180.0, 50.0, 70.0, 60.0, 30.0, 50.0, 290.0, 190.0, 90.0, 120.0, 30.0, -20.0, 10.0, 140.0, 40.0, 0.0, 50.0, 50.0, 40.0, 80.0, 80.0, 50.0, 30.0, -40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 20.0, 50.0, 60.0, 50.0, 360.0, 70.0, 50.0, 90.0, 80.0, 70.0, 50.0, 10.0, 290.0, -5.0, 110.0, 90.0, 25.0, 20.0, 160.0, 60.0, 40.0, 55.0, 180.0, 390.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 10.0, 20.0, -10.0, 20.0, 90.0, -35.0, 80.0, 50.0, 30.0, 10.0, 170.0, 0.0, 60.0, 60.0, 120.0, 110.0, 150.0, 20.0, 60.0, 260.0, 120.0, 100.0, 30.0, 10.0, 60.0, -30.0, -20.0, 60.0, 10.0, 70.0, -30.0, 40.0, 610.0, 30.0, 20.0, 0.0, 50.0, 10.0, 150.0, 50.0, 0.0, -5.0, 0.0, 20.0, 70.0, 30.0, 110.0, 40.0, 10.0, 200.0, 100.0, 40.0, 200.0, 90.0, 30.0, 120.0, 70.0, 180.0, 40.0, 510.0, 80.0, 30.0, 190.0, 30.0, 30.0, 30.0, 50.0, 100.0, 20.0, 120.0, 50.0, 100.0, 0.0, 370.0, 60.0, 170.0, 40.0, 170.0, 60.0, 90.0, 30.0, 10.0, 30.0, 130.0, 90.0, 10.0, 0.0, 30.0, 50.0, 30.0, 25.0, 40.0, 30.0, 0.0, 60.0, 90.0, 40.0, 0.0, 60.0, 10.0, 0.0, 0.0, 250.0, 100.0, 180.0, 170.0, -65.0, 40.0, 80.0, 55.0, 30.0, 280.0, 20.0, 40.0, 15.0, 50.0, 35.0, 40.0, 420.0, 50.0, 100.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 30.0, 280.0, 0.0, 20.0, 10.0, 0.0, 20.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 220.0, 80.0, 120.0, 50.0, 90.0, 80.0, 80.0, 50.0, 300.0, 50.0, 80.0, 50.0, 190.0, 120.0, 180.0, 0.0, 80.0, 25.0, 40.0, 20.0, 50.0, 30.0, 50.0, 120.0, 260.0, 180.0, 160.0, -40.0, 220.0, 70.0, 100.0, 50.0, 80.0, 170.0, 70.0, 100.0, 0.0, 170.0, 150.0, 50.0, 160.0, 100.0, 130.0, 0.0, -30.0, 30.0, 230.0, 120.0, 30.0, 40.0, 110.0, 110.0, 60.0, 110.0, 40.0, 60.0, 50.0, 10.0, 20.0, 20.0, -30.0, 290.0, 20.0, 30.0, 40.0, 150.0, 40.0, 170.0, 40.0, 320.0, 80.0, 20.0, 110.0, 150.0, 310.0, 180.0, 250.0, 70.0, 150.0, 110.0, 20.0, 60.0, 100.0, 30.0, 20.0, 70.0, 30.0, 20.0, 70.0, 60.0, 220.0, 200.0, 30.0, 230.0, -30.0, 80.0, 20.0, 50.0, 180.0, 220.0, 160.0, 10.0, 0.0, 10.0, 60.0, 5.0, 20.0, 20.0, 40.0, 5.0, 40.0, 150.0, 80.0, 0.0, 100.0, 50.0, 20.0, 10.0, 10.0, 35.0, 70.0, 60.0, 0.0, 80.0, 280.0, 60.0, -30.0, 100.0, 160.0, 160.0, 10.0, 30.0, 50.0, 50.0, 190.0, 50.0, 160.0, 30.0, 60.0, 160.0, 50.0, 150.0, -25.0, 5.0, 80.0, 0.0, 150.0, 20.0, 40.0, 200.0, 10.0, 60.0, 240.0, 350.0, 90.0, 100.0, 120.0, 80.0, 50.0, 90.0, 60.0, 20.0, 10.0, 20.0, 60.0, 30.0, 10.0, 40.0, 70.0, 90.0, 400.0, 20.0, 60.0, 70.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 110.0, 20.0, 20.0, 70.0, 70.0, 460.0, 70.0, 170.0, 10.0, 80.0, 140.0, 20.0, 10.0, 30.0, 70.0, 0.0, 40.0, 0.0, 100.0, 50.0, 70.0, 190.0, 180.0, 50.0, -30.0, 0.0, 380.0, 40.0, 20.0, -35.0, 30.0, 260.0, 80.0, 100.0, 20.0, 50.0, 110.0, 170.0, 230.0, 30.0, 170.0, 170.0, 40.0, 300.0, 60.0, 40.0, 40.0, 50.0, 80.0, 70.0, 90.0, 0.0, 30.0, 20.0, 10.0, 40.0, 390.0, 70.0, 30.0, 60.0, 60.0, -10.0, 70.0, 40.0, 70.0, 20.0, 40.0, 430.0, 40.0, 20.0, 340.0, 230.0, 170.0, 110.0, 290.0, 80.0, 80.0, 170.0, 170.0, 30.0, 70.0, 0.0, 30.0, 10.0, -10.0, 50.0, 180.0, 5.0, 0.0, 40.0, 160.0, 20.0, 0.0, 60.0, 260.0, 40.0, 130.0, 10.0, 10.0, 120.0, 10.0, 90.0, 40.0, 130.0, 70.0, 30.0, 5.0, 160.0, 30.0, 50.0, 70.0, 60.0, 60.0, 30.0, 100.0, 20.0, 110.0, 40.0, 250.0, 330.0, 20.0, 10.0, 270.0, 20.0, 0.0, 0.0, 20.0, 190.0, 60.0, 0.0, 0.0, 60.0, 170.0, 110.0, 0.0, 350.0, 60.0, 90.0, 50.0, 270.0, 110.0, 60.0, 50.0, 140.0, 70.0, 50.0, 150.0, 30.0, 40.0, 170.0, 130.0, 70.0, 580.0, 240.0, -10.0, 80.0, 0.0, -30.0, 170.0, 20.0, 90.0, 20.0, 10.0, 80.0, 90.0, 100.0, 80.0, 60.0, 70.0, 90.0, 240.0, 110.0, 110.0, 90.0, 100.0, 200.0, 160.0, 20.0, 20.0, 60.0, 430.0, 270.0, 80.0, 100.0, 180.0, 50.0, 160.0, 50.0, -140.0, 150.0, 60.0, 50.0, 40.0, 70.0, 30.0, 30.0, 70.0, 10.0, 160.0, 70.0, -20.0, 270.0, 50.0, 70.0, 100.0, 60.0, 90.0, 150.0, 40.0, 20.0, 30.0, 30.0, 30.0, 60.0, 50.0, 130.0, 160.0, 50.0, 20.0, 50.0, 30.0, 10.0, 40.0, 20.0, 0.0, 130.0, 30.0, 10.0, 0.0, 0.0, 80.0, 70.0, 70.0, 200.0, 90.0, 90.0, 70.0, 180.0, 20.0, 30.0, 50.0, -155.0, 10.0, 200.0, 310.0, 540.0, 130.0, 90.0, 20.0, -30.0, 70.0, 60.0, 70.0, 600.0, 90.0, 210.0, 150.0, 80.0, 200.0, 70.0, 40.0, -70.0, 90.0, 20.0, 20.0, 80.0, 110.0, 160.0, 180.0, 190.0, 130.0, 90.0, 30.0, 230.0, 310.0, 80.0, 390.0, 20.0, 50.0, 50.0, 60.0, 40.0, 10.0, 30.0, 220.0, 30.0, 200.0, 130.0, 190.0, 90.0, 20.0, 80.0, 30.0, 30.0, -10.0, 210.0, 10.0, 50.0, 0.0, 70.0, 40.0, 20.0, 20.0, 200.0, 20.0, 40.0, 140.0, 130.0, 20.0, 40.0, 330.0, 50.0, 20.0, 0.0, 160.0, 100.0, 70.0, 10.0, 30.0, 40.0, 10.0, 90.0, 100.0, 90.0, 70.0, 50.0, 40.0, 110.0, 70.0, 40.0, -460.0, 100.0, 30.0, 80.0, 90.0, 0.0, 150.0, 50.0, 320.0, 180.0, 190.0, 30.0, 60.0, 150.0, 210.0, 50.0, 240.0, 60.0, 120.0, 190.0, 150.0, 270.0, 170.0, 30.0, 30.0, 50.0, 90.0, 170.0, 40.0, 360.0, 360.0, 80.0, 40.0, 20.0, 280.0, 150.0, 50.0, 10.0, 10.0, 60.0, 70.0, 10.0, 190.0, 30.0, 20.0, 80.0, 70.0, 10.0, 10.0, 180.0, 110.0, 150.0, 70.0, 120.0, 50.0, 40.0, 20.0, 90.0, 30.0, 130.0, 60.0, 50.0, 35.0, 200.0, 110.0, 0.0, -5.0, 20.0, 30.0, 60.0, 460.0, 80.0, 250.0, 10.0, 70.0, 50.0, 20.0, 320.0, 100.0, 150.0, 180.0, 0.0, 140.0, 70.0, 120.0, 150.0, 90.0, 80.0, 510.0, 90.0, 200.0, 110.0, 120.0, 110.0, 200.0, 20.0, 100.0, 150.0, 130.0, -160.0, 40.0, 10.0, 60.0, 170.0, 40.0, 70.0, 10.0, 50.0, 210.0, 170.0, 40.0, 10.0, 40.0, 280.0, 30.0, 20.0, 10.0, 10.0, 50.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.699422497129861, "mean_inference_ms": 1.4830757897567701, "mean_action_processing_ms": 0.43963309787692423, "mean_env_wait_ms": 1.3558300091803326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013014793395996094, "StateBufferConnector_ms": 0.010297775268554688, "ViewRequirementAgentConnector_ms": 0.4153766632080078}, "num_episodes": 18, "episode_return_max": 1670.0, "episode_return_min": 200.0, "episode_return_mean": 845.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.00945266600776, "num_env_steps_trained_throughput_per_sec": 19.00945266600776, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 209617.787, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209617.741, "sample_time_ms": 2845.449, "learn_time_ms": 206749.909, "learn_throughput": 19.347, "synch_weights_time_ms": 12.684}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 51, "trial_id": "aa996_00000", "date": "2024-05-24_01-42-31", "timestamp": 1716529351, "time_this_iter_s": 210.4328010082245, "time_total_s": 10618.96411561966, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dc3550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10618.96411561966, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 19.721812080536914, "ram_util_percent": 80.14429530201342}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3541406044246544, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.930363443992135, "policy_loss": -0.008895021883886868, "vf_loss": 6.937981409361314, "vf_explained_var": 0.000638434579705024, "kl": 0.006385269631955597, "entropy": 0.54141756467545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 483585.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 1670.0, "episode_reward_min": 210.0, "episode_reward_mean": 883.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -460.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 88.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0, 475.0, 1030.0, 780.0, 305.0, 820.0, 1340.0, 530.0, 1030.0, 435.0, 510.0, 890.0, 790.0, 410.0, 210.0, 1120.0, 785.0, 1100.0, 940.0, 810.0, 590.0, 1070.0, 1430.0, 480.0, 1200.0, 330.0, 495.0, 940.0, 790.0, 670.0, 1190.0, 410.0, 790.0, 1080.0, 460.0, 865.0, 1080.0, 1020.0, 740.0, 780.0, 1670.0, 375.0, 810.0, 615.0, 1070.0, 590.0, 1160.0, 870.0, 1250.0, 690.0, 1110.0, 1330.0, 590.0, 830.0, 610.0, 270.0, 900.0, 1165.0, 1600.0, 820.0, 1380.0, 1000.0, 490.0, 670.0, 810.0, 670.0, 540.0, 1300.0, 1360.0, 1060.0, 670.0, 810.0, 560.0, 1510.0, 1430.0, 980.0, 830.0, 500.0, 1300.0, 1230.0, 1350.0, 650.0, 690.0, 1470.0, 690.0, 1300.0, 470.0, 330.0, 510.0, 1590.0, 1585.0, 1320.0, 990.0, 560.0, 670.0, 820.0, 1100.0, 1140.0, 1290.0, 1190.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [390.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 10.0, 20.0, -10.0, 20.0, 90.0, -35.0, 80.0, 50.0, 30.0, 10.0, 170.0, 0.0, 60.0, 60.0, 120.0, 110.0, 150.0, 20.0, 60.0, 260.0, 120.0, 100.0, 30.0, 10.0, 60.0, -30.0, -20.0, 60.0, 10.0, 70.0, -30.0, 40.0, 610.0, 30.0, 20.0, 0.0, 50.0, 10.0, 150.0, 50.0, 0.0, -5.0, 0.0, 20.0, 70.0, 30.0, 110.0, 40.0, 10.0, 200.0, 100.0, 40.0, 200.0, 90.0, 30.0, 120.0, 70.0, 180.0, 40.0, 510.0, 80.0, 30.0, 190.0, 30.0, 30.0, 30.0, 50.0, 100.0, 20.0, 120.0, 50.0, 100.0, 0.0, 370.0, 60.0, 170.0, 40.0, 170.0, 60.0, 90.0, 30.0, 10.0, 30.0, 130.0, 90.0, 10.0, 0.0, 30.0, 50.0, 30.0, 25.0, 40.0, 30.0, 0.0, 60.0, 90.0, 40.0, 0.0, 60.0, 10.0, 0.0, 0.0, 250.0, 100.0, 180.0, 170.0, -65.0, 40.0, 80.0, 55.0, 30.0, 280.0, 20.0, 40.0, 15.0, 50.0, 35.0, 40.0, 420.0, 50.0, 100.0, 40.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 30.0, 280.0, 0.0, 20.0, 10.0, 0.0, 20.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 220.0, 80.0, 120.0, 50.0, 90.0, 80.0, 80.0, 50.0, 300.0, 50.0, 80.0, 50.0, 190.0, 120.0, 180.0, 0.0, 80.0, 25.0, 40.0, 20.0, 50.0, 30.0, 50.0, 120.0, 260.0, 180.0, 160.0, -40.0, 220.0, 70.0, 100.0, 50.0, 80.0, 170.0, 70.0, 100.0, 0.0, 170.0, 150.0, 50.0, 160.0, 100.0, 130.0, 0.0, -30.0, 30.0, 230.0, 120.0, 30.0, 40.0, 110.0, 110.0, 60.0, 110.0, 40.0, 60.0, 50.0, 10.0, 20.0, 20.0, -30.0, 290.0, 20.0, 30.0, 40.0, 150.0, 40.0, 170.0, 40.0, 320.0, 80.0, 20.0, 110.0, 150.0, 310.0, 180.0, 250.0, 70.0, 150.0, 110.0, 20.0, 60.0, 100.0, 30.0, 20.0, 70.0, 30.0, 20.0, 70.0, 60.0, 220.0, 200.0, 30.0, 230.0, -30.0, 80.0, 20.0, 50.0, 180.0, 220.0, 160.0, 10.0, 0.0, 10.0, 60.0, 5.0, 20.0, 20.0, 40.0, 5.0, 40.0, 150.0, 80.0, 0.0, 100.0, 50.0, 20.0, 10.0, 10.0, 35.0, 70.0, 60.0, 0.0, 80.0, 280.0, 60.0, -30.0, 100.0, 160.0, 160.0, 10.0, 30.0, 50.0, 50.0, 190.0, 50.0, 160.0, 30.0, 60.0, 160.0, 50.0, 150.0, -25.0, 5.0, 80.0, 0.0, 150.0, 20.0, 40.0, 200.0, 10.0, 60.0, 240.0, 350.0, 90.0, 100.0, 120.0, 80.0, 50.0, 90.0, 60.0, 20.0, 10.0, 20.0, 60.0, 30.0, 10.0, 40.0, 70.0, 90.0, 400.0, 20.0, 60.0, 70.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 110.0, 20.0, 20.0, 70.0, 70.0, 460.0, 70.0, 170.0, 10.0, 80.0, 140.0, 20.0, 10.0, 30.0, 70.0, 0.0, 40.0, 0.0, 100.0, 50.0, 70.0, 190.0, 180.0, 50.0, -30.0, 0.0, 380.0, 40.0, 20.0, -35.0, 30.0, 260.0, 80.0, 100.0, 20.0, 50.0, 110.0, 170.0, 230.0, 30.0, 170.0, 170.0, 40.0, 300.0, 60.0, 40.0, 40.0, 50.0, 80.0, 70.0, 90.0, 0.0, 30.0, 20.0, 10.0, 40.0, 390.0, 70.0, 30.0, 60.0, 60.0, -10.0, 70.0, 40.0, 70.0, 20.0, 40.0, 430.0, 40.0, 20.0, 340.0, 230.0, 170.0, 110.0, 290.0, 80.0, 80.0, 170.0, 170.0, 30.0, 70.0, 0.0, 30.0, 10.0, -10.0, 50.0, 180.0, 5.0, 0.0, 40.0, 160.0, 20.0, 0.0, 60.0, 260.0, 40.0, 130.0, 10.0, 10.0, 120.0, 10.0, 90.0, 40.0, 130.0, 70.0, 30.0, 5.0, 160.0, 30.0, 50.0, 70.0, 60.0, 60.0, 30.0, 100.0, 20.0, 110.0, 40.0, 250.0, 330.0, 20.0, 10.0, 270.0, 20.0, 0.0, 0.0, 20.0, 190.0, 60.0, 0.0, 0.0, 60.0, 170.0, 110.0, 0.0, 350.0, 60.0, 90.0, 50.0, 270.0, 110.0, 60.0, 50.0, 140.0, 70.0, 50.0, 150.0, 30.0, 40.0, 170.0, 130.0, 70.0, 580.0, 240.0, -10.0, 80.0, 0.0, -30.0, 170.0, 20.0, 90.0, 20.0, 10.0, 80.0, 90.0, 100.0, 80.0, 60.0, 70.0, 90.0, 240.0, 110.0, 110.0, 90.0, 100.0, 200.0, 160.0, 20.0, 20.0, 60.0, 430.0, 270.0, 80.0, 100.0, 180.0, 50.0, 160.0, 50.0, -140.0, 150.0, 60.0, 50.0, 40.0, 70.0, 30.0, 30.0, 70.0, 10.0, 160.0, 70.0, -20.0, 270.0, 50.0, 70.0, 100.0, 60.0, 90.0, 150.0, 40.0, 20.0, 30.0, 30.0, 30.0, 60.0, 50.0, 130.0, 160.0, 50.0, 20.0, 50.0, 30.0, 10.0, 40.0, 20.0, 0.0, 130.0, 30.0, 10.0, 0.0, 0.0, 80.0, 70.0, 70.0, 200.0, 90.0, 90.0, 70.0, 180.0, 20.0, 30.0, 50.0, -155.0, 10.0, 200.0, 310.0, 540.0, 130.0, 90.0, 20.0, -30.0, 70.0, 60.0, 70.0, 600.0, 90.0, 210.0, 150.0, 80.0, 200.0, 70.0, 40.0, -70.0, 90.0, 20.0, 20.0, 80.0, 110.0, 160.0, 180.0, 190.0, 130.0, 90.0, 30.0, 230.0, 310.0, 80.0, 390.0, 20.0, 50.0, 50.0, 60.0, 40.0, 10.0, 30.0, 220.0, 30.0, 200.0, 130.0, 190.0, 90.0, 20.0, 80.0, 30.0, 30.0, -10.0, 210.0, 10.0, 50.0, 0.0, 70.0, 40.0, 20.0, 20.0, 200.0, 20.0, 40.0, 140.0, 130.0, 20.0, 40.0, 330.0, 50.0, 20.0, 0.0, 160.0, 100.0, 70.0, 10.0, 30.0, 40.0, 10.0, 90.0, 100.0, 90.0, 70.0, 50.0, 40.0, 110.0, 70.0, 40.0, -460.0, 100.0, 30.0, 80.0, 90.0, 0.0, 150.0, 50.0, 320.0, 180.0, 190.0, 30.0, 60.0, 150.0, 210.0, 50.0, 240.0, 60.0, 120.0, 190.0, 150.0, 270.0, 170.0, 30.0, 30.0, 50.0, 90.0, 170.0, 40.0, 360.0, 360.0, 80.0, 40.0, 20.0, 280.0, 150.0, 50.0, 10.0, 10.0, 60.0, 70.0, 10.0, 190.0, 30.0, 20.0, 80.0, 70.0, 10.0, 10.0, 180.0, 110.0, 150.0, 70.0, 120.0, 50.0, 40.0, 20.0, 90.0, 30.0, 130.0, 60.0, 50.0, 35.0, 200.0, 110.0, 0.0, -5.0, 20.0, 30.0, 60.0, 460.0, 80.0, 250.0, 10.0, 70.0, 50.0, 20.0, 320.0, 100.0, 150.0, 180.0, 0.0, 140.0, 70.0, 120.0, 150.0, 90.0, 80.0, 510.0, 90.0, 200.0, 110.0, 120.0, 110.0, 200.0, 20.0, 100.0, 150.0, 130.0, -160.0, 40.0, 10.0, 60.0, 170.0, 40.0, 70.0, 10.0, 50.0, 210.0, 170.0, 40.0, 10.0, 40.0, 280.0, 30.0, 20.0, 10.0, 10.0, 50.0, 10.0, 10.0, 80.0, 110.0, 40.0, 60.0, 100.0, 0.0, 280.0, 600.0, 20.0, 30.0, 70.0, 240.0, 210.0, 50.0, 130.0, 10.0, 40.0, 400.0, 50.0, 40.0, 210.0, 200.0, 80.0, 420.0, 170.0, 160.0, 90.0, -30.0, 10.0, 10.0, -10.0, 60.0, 0.0, 40.0, 80.0, 160.0, 20.0, 250.0, 40.0, 120.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 70.0, 50.0, 0.0, 0.0, 550.0, 150.0, 170.0, 80.0, 260.0, 110.0, 60.0, 40.0, 50.0, 180.0, 0.0, -5.0, 30.0, 120.0, 40.0, 20.0, 90.0, 5.0, 210.0, 80.0, 530.0, 20.0, 260.0, 90.0, 160.0, 30.0, 20.0, 80.0, 30.0, 20.0, 10.0, 80.0, 260.0, 0.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, -10.0, 0.0, 10.0, 180.0, -10.0, 40.0, 90.0, 5.0, 110.0, -20.0, 300.0, 80.0, 15.0, 20.0, 10.0, 80.0, -90.0, 10.0, 110.0, 30.0, 60.0, 40.0, 100.0, 40.0, 300.0, 500.0, 400.0, 30.0, 1050.0, 50.0, 5.0, 300.0, 30.0, -30.0, 60.0, 70.0, 20.0, 170.0, 170.0, 210.0, 20.0, 390.0, 100.0, 170.0, 0.0, 50.0, 40.0, 360.0, 0.0, 20.0, 130.0, 210.0, 90.0, 60.0, 50.0, 50.0, 20.0, 20.0, 30.0, 20.0, 90.0, 20.0, 30.0, 290.0, 40.0, 10.0, 10.0, 40.0, 190.0, 30.0, 20.0, -10.0, 60.0, 10.0, 20.0, 0.0, 310.0, 160.0, 0.0, 190.0, 10.0, 60.0, 270.0, 40.0, -10.0, 60.0, 40.0, 40.0, 90.0, 170.0, 70.0, 100.0, 60.0, 240.0, 100.0, 60.0, 170.0, 180.0, 40.0, 20.0, 120.0, 100.0, 160.0, 100.0, 200.0, 90.0, 130.0, 100.0, 200.0, 40.0, 60.0, 160.0, 80.0, 220.0, 290.0, 80.0, 60.0, 350.0, 60.0, 380.0, 50.0, 40.0, 60.0, 40.0, 40.0, 80.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6999556918107654, "mean_inference_ms": 1.4841736391289664, "mean_action_processing_ms": 0.4391287637639683, "mean_env_wait_ms": 1.355990806173856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012969017028808594, "StateBufferConnector_ms": 0.010475635528564453, "ViewRequirementAgentConnector_ms": 0.41959261894226074}, "num_episodes": 22, "episode_return_max": 1670.0, "episode_return_min": 210.0, "episode_return_mean": 883.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.143041346230234, "num_env_steps_trained_throughput_per_sec": 19.143041346230234, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 209506.889, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209506.843, "sample_time_ms": 2884.391, "learn_time_ms": 206600.504, "learn_throughput": 19.361, "synch_weights_time_ms": 12.413}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 52, "trial_id": "aa996_00000", "date": "2024-05-24_01-46-00", "timestamp": 1716529560, "time_this_iter_s": 208.96166491508484, "time_total_s": 10827.925780534744, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309e6160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10827.925780534744, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 19.455593220338983, "ram_util_percent": 79.0013559322034}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4860255459373115, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.720517449384046, "policy_loss": -0.009974759052452037, "vf_loss": 6.729051667204299, "vf_explained_var": 0.002508694231827546, "kl": 0.007202685521280713, "entropy": 0.5475343596821014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 492975.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 270.0, "episode_reward_mean": 916.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -460.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 91.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.0, 1200.0, 330.0, 495.0, 940.0, 790.0, 670.0, 1190.0, 410.0, 790.0, 1080.0, 460.0, 865.0, 1080.0, 1020.0, 740.0, 780.0, 1670.0, 375.0, 810.0, 615.0, 1070.0, 590.0, 1160.0, 870.0, 1250.0, 690.0, 1110.0, 1330.0, 590.0, 830.0, 610.0, 270.0, 900.0, 1165.0, 1600.0, 820.0, 1380.0, 1000.0, 490.0, 670.0, 810.0, 670.0, 540.0, 1300.0, 1360.0, 1060.0, 670.0, 810.0, 560.0, 1510.0, 1430.0, 980.0, 830.0, 500.0, 1300.0, 1230.0, 1350.0, 650.0, 690.0, 1470.0, 690.0, 1300.0, 470.0, 330.0, 510.0, 1590.0, 1585.0, 1320.0, 990.0, 560.0, 670.0, 820.0, 1100.0, 1140.0, 1290.0, 1190.0, 805.0, 1270.0, 1575.0, 330.0, 830.0, 610.0, 1010.0, 1405.0, 380.0, 715.0, 475.0, 940.0, 1030.0, 1900.0, 290.0, 820.0, 730.0, 1570.0, 780.0, 820.0, 760.0, 1330.0, 790.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 60.0, 100.0, 30.0, 20.0, 70.0, 30.0, 20.0, 70.0, 60.0, 220.0, 200.0, 30.0, 230.0, -30.0, 80.0, 20.0, 50.0, 180.0, 220.0, 160.0, 10.0, 0.0, 10.0, 60.0, 5.0, 20.0, 20.0, 40.0, 5.0, 40.0, 150.0, 80.0, 0.0, 100.0, 50.0, 20.0, 10.0, 10.0, 35.0, 70.0, 60.0, 0.0, 80.0, 280.0, 60.0, -30.0, 100.0, 160.0, 160.0, 10.0, 30.0, 50.0, 50.0, 190.0, 50.0, 160.0, 30.0, 60.0, 160.0, 50.0, 150.0, -25.0, 5.0, 80.0, 0.0, 150.0, 20.0, 40.0, 200.0, 10.0, 60.0, 240.0, 350.0, 90.0, 100.0, 120.0, 80.0, 50.0, 90.0, 60.0, 20.0, 10.0, 20.0, 60.0, 30.0, 10.0, 40.0, 70.0, 90.0, 400.0, 20.0, 60.0, 70.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 110.0, 20.0, 20.0, 70.0, 70.0, 460.0, 70.0, 170.0, 10.0, 80.0, 140.0, 20.0, 10.0, 30.0, 70.0, 0.0, 40.0, 0.0, 100.0, 50.0, 70.0, 190.0, 180.0, 50.0, -30.0, 0.0, 380.0, 40.0, 20.0, -35.0, 30.0, 260.0, 80.0, 100.0, 20.0, 50.0, 110.0, 170.0, 230.0, 30.0, 170.0, 170.0, 40.0, 300.0, 60.0, 40.0, 40.0, 50.0, 80.0, 70.0, 90.0, 0.0, 30.0, 20.0, 10.0, 40.0, 390.0, 70.0, 30.0, 60.0, 60.0, -10.0, 70.0, 40.0, 70.0, 20.0, 40.0, 430.0, 40.0, 20.0, 340.0, 230.0, 170.0, 110.0, 290.0, 80.0, 80.0, 170.0, 170.0, 30.0, 70.0, 0.0, 30.0, 10.0, -10.0, 50.0, 180.0, 5.0, 0.0, 40.0, 160.0, 20.0, 0.0, 60.0, 260.0, 40.0, 130.0, 10.0, 10.0, 120.0, 10.0, 90.0, 40.0, 130.0, 70.0, 30.0, 5.0, 160.0, 30.0, 50.0, 70.0, 60.0, 60.0, 30.0, 100.0, 20.0, 110.0, 40.0, 250.0, 330.0, 20.0, 10.0, 270.0, 20.0, 0.0, 0.0, 20.0, 190.0, 60.0, 0.0, 0.0, 60.0, 170.0, 110.0, 0.0, 350.0, 60.0, 90.0, 50.0, 270.0, 110.0, 60.0, 50.0, 140.0, 70.0, 50.0, 150.0, 30.0, 40.0, 170.0, 130.0, 70.0, 580.0, 240.0, -10.0, 80.0, 0.0, -30.0, 170.0, 20.0, 90.0, 20.0, 10.0, 80.0, 90.0, 100.0, 80.0, 60.0, 70.0, 90.0, 240.0, 110.0, 110.0, 90.0, 100.0, 200.0, 160.0, 20.0, 20.0, 60.0, 430.0, 270.0, 80.0, 100.0, 180.0, 50.0, 160.0, 50.0, -140.0, 150.0, 60.0, 50.0, 40.0, 70.0, 30.0, 30.0, 70.0, 10.0, 160.0, 70.0, -20.0, 270.0, 50.0, 70.0, 100.0, 60.0, 90.0, 150.0, 40.0, 20.0, 30.0, 30.0, 30.0, 60.0, 50.0, 130.0, 160.0, 50.0, 20.0, 50.0, 30.0, 10.0, 40.0, 20.0, 0.0, 130.0, 30.0, 10.0, 0.0, 0.0, 80.0, 70.0, 70.0, 200.0, 90.0, 90.0, 70.0, 180.0, 20.0, 30.0, 50.0, -155.0, 10.0, 200.0, 310.0, 540.0, 130.0, 90.0, 20.0, -30.0, 70.0, 60.0, 70.0, 600.0, 90.0, 210.0, 150.0, 80.0, 200.0, 70.0, 40.0, -70.0, 90.0, 20.0, 20.0, 80.0, 110.0, 160.0, 180.0, 190.0, 130.0, 90.0, 30.0, 230.0, 310.0, 80.0, 390.0, 20.0, 50.0, 50.0, 60.0, 40.0, 10.0, 30.0, 220.0, 30.0, 200.0, 130.0, 190.0, 90.0, 20.0, 80.0, 30.0, 30.0, -10.0, 210.0, 10.0, 50.0, 0.0, 70.0, 40.0, 20.0, 20.0, 200.0, 20.0, 40.0, 140.0, 130.0, 20.0, 40.0, 330.0, 50.0, 20.0, 0.0, 160.0, 100.0, 70.0, 10.0, 30.0, 40.0, 10.0, 90.0, 100.0, 90.0, 70.0, 50.0, 40.0, 110.0, 70.0, 40.0, -460.0, 100.0, 30.0, 80.0, 90.0, 0.0, 150.0, 50.0, 320.0, 180.0, 190.0, 30.0, 60.0, 150.0, 210.0, 50.0, 240.0, 60.0, 120.0, 190.0, 150.0, 270.0, 170.0, 30.0, 30.0, 50.0, 90.0, 170.0, 40.0, 360.0, 360.0, 80.0, 40.0, 20.0, 280.0, 150.0, 50.0, 10.0, 10.0, 60.0, 70.0, 10.0, 190.0, 30.0, 20.0, 80.0, 70.0, 10.0, 10.0, 180.0, 110.0, 150.0, 70.0, 120.0, 50.0, 40.0, 20.0, 90.0, 30.0, 130.0, 60.0, 50.0, 35.0, 200.0, 110.0, 0.0, -5.0, 20.0, 30.0, 60.0, 460.0, 80.0, 250.0, 10.0, 70.0, 50.0, 20.0, 320.0, 100.0, 150.0, 180.0, 0.0, 140.0, 70.0, 120.0, 150.0, 90.0, 80.0, 510.0, 90.0, 200.0, 110.0, 120.0, 110.0, 200.0, 20.0, 100.0, 150.0, 130.0, -160.0, 40.0, 10.0, 60.0, 170.0, 40.0, 70.0, 10.0, 50.0, 210.0, 170.0, 40.0, 10.0, 40.0, 280.0, 30.0, 20.0, 10.0, 10.0, 50.0, 10.0, 10.0, 80.0, 110.0, 40.0, 60.0, 100.0, 0.0, 280.0, 600.0, 20.0, 30.0, 70.0, 240.0, 210.0, 50.0, 130.0, 10.0, 40.0, 400.0, 50.0, 40.0, 210.0, 200.0, 80.0, 420.0, 170.0, 160.0, 90.0, -30.0, 10.0, 10.0, -10.0, 60.0, 0.0, 40.0, 80.0, 160.0, 20.0, 250.0, 40.0, 120.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 70.0, 50.0, 0.0, 0.0, 550.0, 150.0, 170.0, 80.0, 260.0, 110.0, 60.0, 40.0, 50.0, 180.0, 0.0, -5.0, 30.0, 120.0, 40.0, 20.0, 90.0, 5.0, 210.0, 80.0, 530.0, 20.0, 260.0, 90.0, 160.0, 30.0, 20.0, 80.0, 30.0, 20.0, 10.0, 80.0, 260.0, 0.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, -10.0, 0.0, 10.0, 180.0, -10.0, 40.0, 90.0, 5.0, 110.0, -20.0, 300.0, 80.0, 15.0, 20.0, 10.0, 80.0, -90.0, 10.0, 110.0, 30.0, 60.0, 40.0, 100.0, 40.0, 300.0, 500.0, 400.0, 30.0, 1050.0, 50.0, 5.0, 300.0, 30.0, -30.0, 60.0, 70.0, 20.0, 170.0, 170.0, 210.0, 20.0, 390.0, 100.0, 170.0, 0.0, 50.0, 40.0, 360.0, 0.0, 20.0, 130.0, 210.0, 90.0, 60.0, 50.0, 50.0, 20.0, 20.0, 30.0, 20.0, 90.0, 20.0, 30.0, 290.0, 40.0, 10.0, 10.0, 40.0, 190.0, 30.0, 20.0, -10.0, 60.0, 10.0, 20.0, 0.0, 310.0, 160.0, 0.0, 190.0, 10.0, 60.0, 270.0, 40.0, -10.0, 60.0, 40.0, 40.0, 90.0, 170.0, 70.0, 100.0, 60.0, 240.0, 100.0, 60.0, 170.0, 180.0, 40.0, 20.0, 120.0, 100.0, 160.0, 100.0, 200.0, 90.0, 130.0, 100.0, 200.0, 40.0, 60.0, 160.0, 80.0, 220.0, 290.0, 80.0, 60.0, 350.0, 60.0, 380.0, 50.0, 40.0, 60.0, 40.0, 40.0, 80.0, 90.0, 70.0, 180.0, 230.0, 40.0, 60.0, 180.0, -40.0, 60.0, 80.0, -55.0, 50.0, 50.0, -50.0, 80.0, 80.0, 370.0, 160.0, 210.0, 310.0, 10.0, 170.0, 260.0, 140.0, 50.0, 230.0, 60.0, 80.0, 30.0, 55.0, 500.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 60.0, 40.0, 40.0, 170.0, 70.0, 50.0, 40.0, -70.0, 90.0, 20.0, 120.0, 220.0, 120.0, 370.0, 0.0, 110.0, 10.0, -40.0, 80.0, 30.0, 10.0, 40.0, 0.0, 70.0, 50.0, 300.0, 60.0, 80.0, 50.0, 180.0, 100.0, 30.0, 90.0, 80.0, 50.0, 100.0, 190.0, 10.0, 120.0, 40.0, 70.0, 140.0, 605.0, 10.0, 20.0, 40.0, 20.0, 100.0, 20.0, 30.0, 10.0, 90.0, 40.0, 20.0, 190.0, 35.0, 70.0, 60.0, 20.0, 190.0, 50.0, 60.0, 20.0, 60.0, 40.0, 40.0, 5.0, 10.0, 10.0, 30.0, 40.0, 180.0, 60.0, 270.0, 140.0, 0.0, 40.0, 250.0, -20.0, 130.0, 20.0, 0.0, 110.0, -30.0, 90.0, 20.0, 400.0, 380.0, 150.0, 20.0, 10.0, 70.0, -80.0, 80.0, 30.0, 70.0, 590.0, 300.0, 100.0, 120.0, 260.0, 110.0, 240.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 200.0, 30.0, 0.0, 0.0, 180.0, 90.0, 30.0, 0.0, 10.0, 170.0, 10.0, 50.0, 220.0, 60.0, 140.0, 90.0, -5.0, 25.0, 5.0, 70.0, 320.0, 25.0, 50.0, 10.0, 260.0, 60.0, 100.0, 330.0, 200.0, 160.0, 190.0, 50.0, 140.0, 80.0, 20.0, 200.0, 0.0, 50.0, 100.0, -10.0, 30.0, 260.0, 20.0, 110.0, 90.0, 360.0, 100.0, 0.0, 30.0, 50.0, 0.0, 170.0, 10.0, 10.0, 40.0, 220.0, 10.0, 60.0, 30.0, 80.0, 190.0, 30.0, 80.0, 20.0, 110.0, 180.0, 30.0, 180.0, 110.0, 20.0, 70.0, 180.0, 30.0, 420.0, 20.0, 60.0, 50.0, 50.0, 200.0, 40.0, 260.0, 50.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.700121551732098, "mean_inference_ms": 1.4858566975359937, "mean_action_processing_ms": 0.4387071665751353, "mean_env_wait_ms": 1.3562363392379266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01297760009765625, "StateBufferConnector_ms": 0.010484933853149414, "ViewRequirementAgentConnector_ms": 0.4091064929962158}, "num_episodes": 23, "episode_return_max": 1900.0, "episode_return_min": 270.0, "episode_return_mean": 916.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.085378376718744, "num_env_steps_trained_throughput_per_sec": 19.085378376718744, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 2120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2120000, "timers": {"training_iteration_time_ms": 209593.898, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209593.851, "sample_time_ms": 2884.05, "learn_time_ms": 206687.174, "learn_throughput": 19.353, "synch_weights_time_ms": 12.084}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "done": false, "training_iteration": 53, "trial_id": "aa996_00000", "date": "2024-05-24_01-49-30", "timestamp": 1716529770, "time_this_iter_s": 209.59460592269897, "time_total_s": 11037.520386457443, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dc3b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11037.520386457443, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 19.39090909090909, "ram_util_percent": 79.64478114478115}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.378030683755621, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.483646636522108, "policy_loss": -0.00858222106414628, "vf_loss": 6.490901721196687, "vf_explained_var": 0.0005795530554331657, "kl": 0.00663566920880379, "entropy": 0.55950400643011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 502365.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 270.0, "episode_reward_mean": 923.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -460.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 92.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.0, 810.0, 615.0, 1070.0, 590.0, 1160.0, 870.0, 1250.0, 690.0, 1110.0, 1330.0, 590.0, 830.0, 610.0, 270.0, 900.0, 1165.0, 1600.0, 820.0, 1380.0, 1000.0, 490.0, 670.0, 810.0, 670.0, 540.0, 1300.0, 1360.0, 1060.0, 670.0, 810.0, 560.0, 1510.0, 1430.0, 980.0, 830.0, 500.0, 1300.0, 1230.0, 1350.0, 650.0, 690.0, 1470.0, 690.0, 1300.0, 470.0, 330.0, 510.0, 1590.0, 1585.0, 1320.0, 990.0, 560.0, 670.0, 820.0, 1100.0, 1140.0, 1290.0, 1190.0, 805.0, 1270.0, 1575.0, 330.0, 830.0, 610.0, 1010.0, 1405.0, 380.0, 715.0, 475.0, 940.0, 1030.0, 1900.0, 290.0, 820.0, 730.0, 1570.0, 780.0, 820.0, 760.0, 1330.0, 790.0, 1050.0, 500.0, 540.0, 1090.0, 1120.0, 440.0, 630.0, 1160.0, 555.0, 610.0, 865.0, 1160.0, 1725.0, 720.0, 530.0, 1310.0, 655.0, 1085.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 0.0, 30.0, 10.0, -10.0, 50.0, 180.0, 5.0, 0.0, 40.0, 160.0, 20.0, 0.0, 60.0, 260.0, 40.0, 130.0, 10.0, 10.0, 120.0, 10.0, 90.0, 40.0, 130.0, 70.0, 30.0, 5.0, 160.0, 30.0, 50.0, 70.0, 60.0, 60.0, 30.0, 100.0, 20.0, 110.0, 40.0, 250.0, 330.0, 20.0, 10.0, 270.0, 20.0, 0.0, 0.0, 20.0, 190.0, 60.0, 0.0, 0.0, 60.0, 170.0, 110.0, 0.0, 350.0, 60.0, 90.0, 50.0, 270.0, 110.0, 60.0, 50.0, 140.0, 70.0, 50.0, 150.0, 30.0, 40.0, 170.0, 130.0, 70.0, 580.0, 240.0, -10.0, 80.0, 0.0, -30.0, 170.0, 20.0, 90.0, 20.0, 10.0, 80.0, 90.0, 100.0, 80.0, 60.0, 70.0, 90.0, 240.0, 110.0, 110.0, 90.0, 100.0, 200.0, 160.0, 20.0, 20.0, 60.0, 430.0, 270.0, 80.0, 100.0, 180.0, 50.0, 160.0, 50.0, -140.0, 150.0, 60.0, 50.0, 40.0, 70.0, 30.0, 30.0, 70.0, 10.0, 160.0, 70.0, -20.0, 270.0, 50.0, 70.0, 100.0, 60.0, 90.0, 150.0, 40.0, 20.0, 30.0, 30.0, 30.0, 60.0, 50.0, 130.0, 160.0, 50.0, 20.0, 50.0, 30.0, 10.0, 40.0, 20.0, 0.0, 130.0, 30.0, 10.0, 0.0, 0.0, 80.0, 70.0, 70.0, 200.0, 90.0, 90.0, 70.0, 180.0, 20.0, 30.0, 50.0, -155.0, 10.0, 200.0, 310.0, 540.0, 130.0, 90.0, 20.0, -30.0, 70.0, 60.0, 70.0, 600.0, 90.0, 210.0, 150.0, 80.0, 200.0, 70.0, 40.0, -70.0, 90.0, 20.0, 20.0, 80.0, 110.0, 160.0, 180.0, 190.0, 130.0, 90.0, 30.0, 230.0, 310.0, 80.0, 390.0, 20.0, 50.0, 50.0, 60.0, 40.0, 10.0, 30.0, 220.0, 30.0, 200.0, 130.0, 190.0, 90.0, 20.0, 80.0, 30.0, 30.0, -10.0, 210.0, 10.0, 50.0, 0.0, 70.0, 40.0, 20.0, 20.0, 200.0, 20.0, 40.0, 140.0, 130.0, 20.0, 40.0, 330.0, 50.0, 20.0, 0.0, 160.0, 100.0, 70.0, 10.0, 30.0, 40.0, 10.0, 90.0, 100.0, 90.0, 70.0, 50.0, 40.0, 110.0, 70.0, 40.0, -460.0, 100.0, 30.0, 80.0, 90.0, 0.0, 150.0, 50.0, 320.0, 180.0, 190.0, 30.0, 60.0, 150.0, 210.0, 50.0, 240.0, 60.0, 120.0, 190.0, 150.0, 270.0, 170.0, 30.0, 30.0, 50.0, 90.0, 170.0, 40.0, 360.0, 360.0, 80.0, 40.0, 20.0, 280.0, 150.0, 50.0, 10.0, 10.0, 60.0, 70.0, 10.0, 190.0, 30.0, 20.0, 80.0, 70.0, 10.0, 10.0, 180.0, 110.0, 150.0, 70.0, 120.0, 50.0, 40.0, 20.0, 90.0, 30.0, 130.0, 60.0, 50.0, 35.0, 200.0, 110.0, 0.0, -5.0, 20.0, 30.0, 60.0, 460.0, 80.0, 250.0, 10.0, 70.0, 50.0, 20.0, 320.0, 100.0, 150.0, 180.0, 0.0, 140.0, 70.0, 120.0, 150.0, 90.0, 80.0, 510.0, 90.0, 200.0, 110.0, 120.0, 110.0, 200.0, 20.0, 100.0, 150.0, 130.0, -160.0, 40.0, 10.0, 60.0, 170.0, 40.0, 70.0, 10.0, 50.0, 210.0, 170.0, 40.0, 10.0, 40.0, 280.0, 30.0, 20.0, 10.0, 10.0, 50.0, 10.0, 10.0, 80.0, 110.0, 40.0, 60.0, 100.0, 0.0, 280.0, 600.0, 20.0, 30.0, 70.0, 240.0, 210.0, 50.0, 130.0, 10.0, 40.0, 400.0, 50.0, 40.0, 210.0, 200.0, 80.0, 420.0, 170.0, 160.0, 90.0, -30.0, 10.0, 10.0, -10.0, 60.0, 0.0, 40.0, 80.0, 160.0, 20.0, 250.0, 40.0, 120.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 70.0, 50.0, 0.0, 0.0, 550.0, 150.0, 170.0, 80.0, 260.0, 110.0, 60.0, 40.0, 50.0, 180.0, 0.0, -5.0, 30.0, 120.0, 40.0, 20.0, 90.0, 5.0, 210.0, 80.0, 530.0, 20.0, 260.0, 90.0, 160.0, 30.0, 20.0, 80.0, 30.0, 20.0, 10.0, 80.0, 260.0, 0.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, -10.0, 0.0, 10.0, 180.0, -10.0, 40.0, 90.0, 5.0, 110.0, -20.0, 300.0, 80.0, 15.0, 20.0, 10.0, 80.0, -90.0, 10.0, 110.0, 30.0, 60.0, 40.0, 100.0, 40.0, 300.0, 500.0, 400.0, 30.0, 1050.0, 50.0, 5.0, 300.0, 30.0, -30.0, 60.0, 70.0, 20.0, 170.0, 170.0, 210.0, 20.0, 390.0, 100.0, 170.0, 0.0, 50.0, 40.0, 360.0, 0.0, 20.0, 130.0, 210.0, 90.0, 60.0, 50.0, 50.0, 20.0, 20.0, 30.0, 20.0, 90.0, 20.0, 30.0, 290.0, 40.0, 10.0, 10.0, 40.0, 190.0, 30.0, 20.0, -10.0, 60.0, 10.0, 20.0, 0.0, 310.0, 160.0, 0.0, 190.0, 10.0, 60.0, 270.0, 40.0, -10.0, 60.0, 40.0, 40.0, 90.0, 170.0, 70.0, 100.0, 60.0, 240.0, 100.0, 60.0, 170.0, 180.0, 40.0, 20.0, 120.0, 100.0, 160.0, 100.0, 200.0, 90.0, 130.0, 100.0, 200.0, 40.0, 60.0, 160.0, 80.0, 220.0, 290.0, 80.0, 60.0, 350.0, 60.0, 380.0, 50.0, 40.0, 60.0, 40.0, 40.0, 80.0, 90.0, 70.0, 180.0, 230.0, 40.0, 60.0, 180.0, -40.0, 60.0, 80.0, -55.0, 50.0, 50.0, -50.0, 80.0, 80.0, 370.0, 160.0, 210.0, 310.0, 10.0, 170.0, 260.0, 140.0, 50.0, 230.0, 60.0, 80.0, 30.0, 55.0, 500.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 60.0, 40.0, 40.0, 170.0, 70.0, 50.0, 40.0, -70.0, 90.0, 20.0, 120.0, 220.0, 120.0, 370.0, 0.0, 110.0, 10.0, -40.0, 80.0, 30.0, 10.0, 40.0, 0.0, 70.0, 50.0, 300.0, 60.0, 80.0, 50.0, 180.0, 100.0, 30.0, 90.0, 80.0, 50.0, 100.0, 190.0, 10.0, 120.0, 40.0, 70.0, 140.0, 605.0, 10.0, 20.0, 40.0, 20.0, 100.0, 20.0, 30.0, 10.0, 90.0, 40.0, 20.0, 190.0, 35.0, 70.0, 60.0, 20.0, 190.0, 50.0, 60.0, 20.0, 60.0, 40.0, 40.0, 5.0, 10.0, 10.0, 30.0, 40.0, 180.0, 60.0, 270.0, 140.0, 0.0, 40.0, 250.0, -20.0, 130.0, 20.0, 0.0, 110.0, -30.0, 90.0, 20.0, 400.0, 380.0, 150.0, 20.0, 10.0, 70.0, -80.0, 80.0, 30.0, 70.0, 590.0, 300.0, 100.0, 120.0, 260.0, 110.0, 240.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 200.0, 30.0, 0.0, 0.0, 180.0, 90.0, 30.0, 0.0, 10.0, 170.0, 10.0, 50.0, 220.0, 60.0, 140.0, 90.0, -5.0, 25.0, 5.0, 70.0, 320.0, 25.0, 50.0, 10.0, 260.0, 60.0, 100.0, 330.0, 200.0, 160.0, 190.0, 50.0, 140.0, 80.0, 20.0, 200.0, 0.0, 50.0, 100.0, -10.0, 30.0, 260.0, 20.0, 110.0, 90.0, 360.0, 100.0, 0.0, 30.0, 50.0, 0.0, 170.0, 10.0, 10.0, 40.0, 220.0, 10.0, 60.0, 30.0, 80.0, 190.0, 30.0, 80.0, 20.0, 110.0, 180.0, 30.0, 180.0, 110.0, 20.0, 70.0, 180.0, 30.0, 420.0, 20.0, 60.0, 50.0, 50.0, 200.0, 40.0, 260.0, 50.0, 20.0, 40.0, 90.0, 40.0, 90.0, 170.0, 220.0, 20.0, 40.0, 40.0, 100.0, 240.0, 20.0, 60.0, 40.0, 0.0, 30.0, 30.0, 50.0, 220.0, 30.0, 20.0, 160.0, 40.0, 40.0, 0.0, 20.0, 40.0, 0.0, 180.0, 40.0, 20.0, 70.0, 30.0, -30.0, 0.0, 10.0, 380.0, 390.0, 0.0, 70.0, 170.0, 160.0, 110.0, 150.0, 40.0, 40.0, 80.0, 120.0, 260.0, 80.0, 80.0, 40.0, 30.0, 10.0, 10.0, 190.0, 70.0, 20.0, 30.0, 10.0, 30.0, 150.0, 0.0, 50.0, 10.0, 30.0, 40.0, 140.0, 30.0, 0.0, 180.0, 70.0, 10.0, 0.0, 170.0, 430.0, 60.0, 10.0, 180.0, 180.0, 50.0, 20.0, 170.0, 40.0, 30.0, 120.0, 60.0, 20.0, 15.0, 20.0, 60.0, 20.0, 10.0, 60.0, 160.0, 60.0, 90.0, 20.0, 120.0, 20.0, 50.0, 30.0, 40.0, 10.0, 160.0, 280.0, -5.0, 90.0, 110.0, 90.0, 60.0, 290.0, 150.0, 20.0, 20.0, 20.0, 30.0, 290.0, 60.0, 180.0, 100.0, 100.0, 15.0, 290.0, 70.0, 100.0, 720.0, 20.0, 90.0, 40.0, 280.0, 110.0, 40.0, 0.0, 30.0, 30.0, 170.0, 230.0, 0.0, 40.0, 70.0, 40.0, 20.0, 0.0, 50.0, 250.0, 30.0, 70.0, 40.0, 0.0, 30.0, 40.0, -40.0, 20.0, 120.0, 200.0, 300.0, 60.0, 360.0, 250.0, 0.0, 190.0, 250.0, -5.0, 15.0, -30.0, 30.0, 120.0, 35.0, 20.0, 30.0, 10.0, 0.0, 110.0, 50.0, 70.0, 75.0, 20.0, 260.0, 90.0, 400.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7007316835210942, "mean_inference_ms": 1.4876672935407367, "mean_action_processing_ms": 0.4384824301691203, "mean_env_wait_ms": 1.3567125385238632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01299142837524414, "StateBufferConnector_ms": 0.010473012924194336, "ViewRequirementAgentConnector_ms": 0.4116663932800293}, "num_episodes": 18, "episode_return_max": 1900.0, "episode_return_min": 270.0, "episode_return_mean": 923.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.233893647721143, "num_env_steps_trained_throughput_per_sec": 19.233893647721143, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 209679.874, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209679.827, "sample_time_ms": 2913.832, "learn_time_ms": 206743.385, "learn_throughput": 19.348, "synch_weights_time_ms": 12.277}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 54, "trial_id": "aa996_00000", "date": "2024-05-24_01-52-58", "timestamp": 1716529978, "time_this_iter_s": 207.97702407836914, "time_total_s": 11245.497410535812, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309844c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11245.497410535812, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 19.059183673469388, "ram_util_percent": 78.79251700680273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.215118470746742, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.904106748751558, "policy_loss": -0.008880096998019095, "vf_loss": 6.911650959142862, "vf_explained_var": 0.00014302420159117483, "kl": 0.006679380628753088, "entropy": 0.530369088060051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 511755.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 270.0, "episode_reward_mean": 948.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -460.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 94.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [820.0, 1380.0, 1000.0, 490.0, 670.0, 810.0, 670.0, 540.0, 1300.0, 1360.0, 1060.0, 670.0, 810.0, 560.0, 1510.0, 1430.0, 980.0, 830.0, 500.0, 1300.0, 1230.0, 1350.0, 650.0, 690.0, 1470.0, 690.0, 1300.0, 470.0, 330.0, 510.0, 1590.0, 1585.0, 1320.0, 990.0, 560.0, 670.0, 820.0, 1100.0, 1140.0, 1290.0, 1190.0, 805.0, 1270.0, 1575.0, 330.0, 830.0, 610.0, 1010.0, 1405.0, 380.0, 715.0, 475.0, 940.0, 1030.0, 1900.0, 290.0, 820.0, 730.0, 1570.0, 780.0, 820.0, 760.0, 1330.0, 790.0, 1050.0, 500.0, 540.0, 1090.0, 1120.0, 440.0, 630.0, 1160.0, 555.0, 610.0, 865.0, 1160.0, 1725.0, 720.0, 530.0, 1310.0, 655.0, 1085.0, 970.0, 870.0, 1105.0, 830.0, 860.0, 740.0, 1160.0, 850.0, 1330.0, 1510.0, 975.0, 1190.0, 1010.0, 900.0, 270.0, 1330.0, 960.0, 1410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, -70.0, 90.0, 20.0, 20.0, 80.0, 110.0, 160.0, 180.0, 190.0, 130.0, 90.0, 30.0, 230.0, 310.0, 80.0, 390.0, 20.0, 50.0, 50.0, 60.0, 40.0, 10.0, 30.0, 220.0, 30.0, 200.0, 130.0, 190.0, 90.0, 20.0, 80.0, 30.0, 30.0, -10.0, 210.0, 10.0, 50.0, 0.0, 70.0, 40.0, 20.0, 20.0, 200.0, 20.0, 40.0, 140.0, 130.0, 20.0, 40.0, 330.0, 50.0, 20.0, 0.0, 160.0, 100.0, 70.0, 10.0, 30.0, 40.0, 10.0, 90.0, 100.0, 90.0, 70.0, 50.0, 40.0, 110.0, 70.0, 40.0, -460.0, 100.0, 30.0, 80.0, 90.0, 0.0, 150.0, 50.0, 320.0, 180.0, 190.0, 30.0, 60.0, 150.0, 210.0, 50.0, 240.0, 60.0, 120.0, 190.0, 150.0, 270.0, 170.0, 30.0, 30.0, 50.0, 90.0, 170.0, 40.0, 360.0, 360.0, 80.0, 40.0, 20.0, 280.0, 150.0, 50.0, 10.0, 10.0, 60.0, 70.0, 10.0, 190.0, 30.0, 20.0, 80.0, 70.0, 10.0, 10.0, 180.0, 110.0, 150.0, 70.0, 120.0, 50.0, 40.0, 20.0, 90.0, 30.0, 130.0, 60.0, 50.0, 35.0, 200.0, 110.0, 0.0, -5.0, 20.0, 30.0, 60.0, 460.0, 80.0, 250.0, 10.0, 70.0, 50.0, 20.0, 320.0, 100.0, 150.0, 180.0, 0.0, 140.0, 70.0, 120.0, 150.0, 90.0, 80.0, 510.0, 90.0, 200.0, 110.0, 120.0, 110.0, 200.0, 20.0, 100.0, 150.0, 130.0, -160.0, 40.0, 10.0, 60.0, 170.0, 40.0, 70.0, 10.0, 50.0, 210.0, 170.0, 40.0, 10.0, 40.0, 280.0, 30.0, 20.0, 10.0, 10.0, 50.0, 10.0, 10.0, 80.0, 110.0, 40.0, 60.0, 100.0, 0.0, 280.0, 600.0, 20.0, 30.0, 70.0, 240.0, 210.0, 50.0, 130.0, 10.0, 40.0, 400.0, 50.0, 40.0, 210.0, 200.0, 80.0, 420.0, 170.0, 160.0, 90.0, -30.0, 10.0, 10.0, -10.0, 60.0, 0.0, 40.0, 80.0, 160.0, 20.0, 250.0, 40.0, 120.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 70.0, 50.0, 0.0, 0.0, 550.0, 150.0, 170.0, 80.0, 260.0, 110.0, 60.0, 40.0, 50.0, 180.0, 0.0, -5.0, 30.0, 120.0, 40.0, 20.0, 90.0, 5.0, 210.0, 80.0, 530.0, 20.0, 260.0, 90.0, 160.0, 30.0, 20.0, 80.0, 30.0, 20.0, 10.0, 80.0, 260.0, 0.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, -10.0, 0.0, 10.0, 180.0, -10.0, 40.0, 90.0, 5.0, 110.0, -20.0, 300.0, 80.0, 15.0, 20.0, 10.0, 80.0, -90.0, 10.0, 110.0, 30.0, 60.0, 40.0, 100.0, 40.0, 300.0, 500.0, 400.0, 30.0, 1050.0, 50.0, 5.0, 300.0, 30.0, -30.0, 60.0, 70.0, 20.0, 170.0, 170.0, 210.0, 20.0, 390.0, 100.0, 170.0, 0.0, 50.0, 40.0, 360.0, 0.0, 20.0, 130.0, 210.0, 90.0, 60.0, 50.0, 50.0, 20.0, 20.0, 30.0, 20.0, 90.0, 20.0, 30.0, 290.0, 40.0, 10.0, 10.0, 40.0, 190.0, 30.0, 20.0, -10.0, 60.0, 10.0, 20.0, 0.0, 310.0, 160.0, 0.0, 190.0, 10.0, 60.0, 270.0, 40.0, -10.0, 60.0, 40.0, 40.0, 90.0, 170.0, 70.0, 100.0, 60.0, 240.0, 100.0, 60.0, 170.0, 180.0, 40.0, 20.0, 120.0, 100.0, 160.0, 100.0, 200.0, 90.0, 130.0, 100.0, 200.0, 40.0, 60.0, 160.0, 80.0, 220.0, 290.0, 80.0, 60.0, 350.0, 60.0, 380.0, 50.0, 40.0, 60.0, 40.0, 40.0, 80.0, 90.0, 70.0, 180.0, 230.0, 40.0, 60.0, 180.0, -40.0, 60.0, 80.0, -55.0, 50.0, 50.0, -50.0, 80.0, 80.0, 370.0, 160.0, 210.0, 310.0, 10.0, 170.0, 260.0, 140.0, 50.0, 230.0, 60.0, 80.0, 30.0, 55.0, 500.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 60.0, 40.0, 40.0, 170.0, 70.0, 50.0, 40.0, -70.0, 90.0, 20.0, 120.0, 220.0, 120.0, 370.0, 0.0, 110.0, 10.0, -40.0, 80.0, 30.0, 10.0, 40.0, 0.0, 70.0, 50.0, 300.0, 60.0, 80.0, 50.0, 180.0, 100.0, 30.0, 90.0, 80.0, 50.0, 100.0, 190.0, 10.0, 120.0, 40.0, 70.0, 140.0, 605.0, 10.0, 20.0, 40.0, 20.0, 100.0, 20.0, 30.0, 10.0, 90.0, 40.0, 20.0, 190.0, 35.0, 70.0, 60.0, 20.0, 190.0, 50.0, 60.0, 20.0, 60.0, 40.0, 40.0, 5.0, 10.0, 10.0, 30.0, 40.0, 180.0, 60.0, 270.0, 140.0, 0.0, 40.0, 250.0, -20.0, 130.0, 20.0, 0.0, 110.0, -30.0, 90.0, 20.0, 400.0, 380.0, 150.0, 20.0, 10.0, 70.0, -80.0, 80.0, 30.0, 70.0, 590.0, 300.0, 100.0, 120.0, 260.0, 110.0, 240.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 200.0, 30.0, 0.0, 0.0, 180.0, 90.0, 30.0, 0.0, 10.0, 170.0, 10.0, 50.0, 220.0, 60.0, 140.0, 90.0, -5.0, 25.0, 5.0, 70.0, 320.0, 25.0, 50.0, 10.0, 260.0, 60.0, 100.0, 330.0, 200.0, 160.0, 190.0, 50.0, 140.0, 80.0, 20.0, 200.0, 0.0, 50.0, 100.0, -10.0, 30.0, 260.0, 20.0, 110.0, 90.0, 360.0, 100.0, 0.0, 30.0, 50.0, 0.0, 170.0, 10.0, 10.0, 40.0, 220.0, 10.0, 60.0, 30.0, 80.0, 190.0, 30.0, 80.0, 20.0, 110.0, 180.0, 30.0, 180.0, 110.0, 20.0, 70.0, 180.0, 30.0, 420.0, 20.0, 60.0, 50.0, 50.0, 200.0, 40.0, 260.0, 50.0, 20.0, 40.0, 90.0, 40.0, 90.0, 170.0, 220.0, 20.0, 40.0, 40.0, 100.0, 240.0, 20.0, 60.0, 40.0, 0.0, 30.0, 30.0, 50.0, 220.0, 30.0, 20.0, 160.0, 40.0, 40.0, 0.0, 20.0, 40.0, 0.0, 180.0, 40.0, 20.0, 70.0, 30.0, -30.0, 0.0, 10.0, 380.0, 390.0, 0.0, 70.0, 170.0, 160.0, 110.0, 150.0, 40.0, 40.0, 80.0, 120.0, 260.0, 80.0, 80.0, 40.0, 30.0, 10.0, 10.0, 190.0, 70.0, 20.0, 30.0, 10.0, 30.0, 150.0, 0.0, 50.0, 10.0, 30.0, 40.0, 140.0, 30.0, 0.0, 180.0, 70.0, 10.0, 0.0, 170.0, 430.0, 60.0, 10.0, 180.0, 180.0, 50.0, 20.0, 170.0, 40.0, 30.0, 120.0, 60.0, 20.0, 15.0, 20.0, 60.0, 20.0, 10.0, 60.0, 160.0, 60.0, 90.0, 20.0, 120.0, 20.0, 50.0, 30.0, 40.0, 10.0, 160.0, 280.0, -5.0, 90.0, 110.0, 90.0, 60.0, 290.0, 150.0, 20.0, 20.0, 20.0, 30.0, 290.0, 60.0, 180.0, 100.0, 100.0, 15.0, 290.0, 70.0, 100.0, 720.0, 20.0, 90.0, 40.0, 280.0, 110.0, 40.0, 0.0, 30.0, 30.0, 170.0, 230.0, 0.0, 40.0, 70.0, 40.0, 20.0, 0.0, 50.0, 250.0, 30.0, 70.0, 40.0, 0.0, 30.0, 40.0, -40.0, 20.0, 120.0, 200.0, 300.0, 60.0, 360.0, 250.0, 0.0, 190.0, 250.0, -5.0, 15.0, -30.0, 30.0, 120.0, 35.0, 20.0, 30.0, 10.0, 0.0, 110.0, 50.0, 70.0, 75.0, 20.0, 260.0, 90.0, 400.0, 70.0, -30.0, 250.0, 170.0, 70.0, 90.0, 230.0, 110.0, -30.0, 40.0, 170.0, 70.0, 90.0, 160.0, 120.0, 40.0, 100.0, 70.0, 30.0, 20.0, 110.0, -85.0, 90.0, 130.0, 400.0, 150.0, 110.0, 30.0, 80.0, 90.0, 40.0, 200.0, 10.0, 220.0, 100.0, 70.0, 30.0, 120.0, 0.0, 40.0, 380.0, 100.0, 10.0, 180.0, -10.0, 0.0, 40.0, 0.0, 90.0, 70.0, 20.0, 80.0, 80.0, 0.0, 140.0, 130.0, 140.0, 30.0, 80.0, 40.0, 310.0, 150.0, 10.0, 40.0, 50.0, 70.0, 50.0, 90.0, 310.0, 80.0, 40.0, 70.0, 90.0, 10.0, 210.0, 60.0, 120.0, 40.0, 40.0, 170.0, -220.0, 260.0, 30.0, 10.0, -30.0, 250.0, 510.0, 290.0, 190.0, 40.0, 100.0, 40.0, 60.0, 50.0, 190.0, 550.0, 130.0, 240.0, 60.0, 90.0, 270.0, 0.0, 20.0, 200.0, -105.0, 30.0, 40.0, 390.0, 100.0, 30.0, 150.0, 40.0, 20.0, 190.0, 170.0, 30.0, 180.0, 100.0, 270.0, 40.0, -30.0, 60.0, 60.0, 80.0, 90.0, 190.0, 300.0, 70.0, 100.0, 90.0, 90.0, 40.0, 50.0, 10.0, 70.0, 550.0, 20.0, 10.0, 0.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 110.0, 30.0, 20.0, 340.0, 130.0, 230.0, 240.0, 30.0, 80.0, 20.0, 20.0, 190.0, 50.0, 70.0, 60.0, 60.0, 10.0, 80.0, 250.0, 80.0, 40.0, 120.0, 190.0, 0.0, 140.0, 810.0, 70.0, 40.0, -20.0, 70.0, 110.0, 120.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7015556006296697, "mean_inference_ms": 1.4896135146512177, "mean_action_processing_ms": 0.43825691595816496, "mean_env_wait_ms": 1.3571502368176116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013004779815673828, "StateBufferConnector_ms": 0.01058816909790039, "ViewRequirementAgentConnector_ms": 0.4134185314178467}, "num_episodes": 18, "episode_return_max": 1900.0, "episode_return_min": 270.0, "episode_return_mean": 948.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.177341154714902, "num_env_steps_trained_throughput_per_sec": 19.177341154714902, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 2200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2200000, "timers": {"training_iteration_time_ms": 209639.844, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209639.798, "sample_time_ms": 2925.363, "learn_time_ms": 206692.185, "learn_throughput": 19.352, "synch_weights_time_ms": 12.304}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "done": false, "training_iteration": 55, "trial_id": "aa996_00000", "date": "2024-05-24_01-56-27", "timestamp": 1716530187, "time_this_iter_s": 208.58680081367493, "time_total_s": 11454.084211349487, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd44c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11454.084211349487, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 19.279661016949152, "ram_util_percent": 79.2813559322034}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7966151024586856, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.194575046807432, "policy_loss": -0.008639854341978455, "vf_loss": 7.201861025756413, "vf_explained_var": 0.0009472267251933853, "kl": 0.006769379299167244, "entropy": 0.5334748498516215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 521145.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 270.0, "episode_reward_mean": 946.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -220.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 94.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 1300.0, 1230.0, 1350.0, 650.0, 690.0, 1470.0, 690.0, 1300.0, 470.0, 330.0, 510.0, 1590.0, 1585.0, 1320.0, 990.0, 560.0, 670.0, 820.0, 1100.0, 1140.0, 1290.0, 1190.0, 805.0, 1270.0, 1575.0, 330.0, 830.0, 610.0, 1010.0, 1405.0, 380.0, 715.0, 475.0, 940.0, 1030.0, 1900.0, 290.0, 820.0, 730.0, 1570.0, 780.0, 820.0, 760.0, 1330.0, 790.0, 1050.0, 500.0, 540.0, 1090.0, 1120.0, 440.0, 630.0, 1160.0, 555.0, 610.0, 865.0, 1160.0, 1725.0, 720.0, 530.0, 1310.0, 655.0, 1085.0, 970.0, 870.0, 1105.0, 830.0, 860.0, 740.0, 1160.0, 850.0, 1330.0, 1510.0, 975.0, 1190.0, 1010.0, 900.0, 270.0, 1330.0, 960.0, 1410.0, 800.0, 910.0, 1060.0, 1730.0, 1010.0, 650.0, 450.0, 1015.0, 280.0, 620.0, 970.0, 755.0, 740.0, 1490.0, 1100.0, 1300.0, 950.0, 870.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 40.0, 280.0, 30.0, 20.0, 10.0, 10.0, 50.0, 10.0, 10.0, 80.0, 110.0, 40.0, 60.0, 100.0, 0.0, 280.0, 600.0, 20.0, 30.0, 70.0, 240.0, 210.0, 50.0, 130.0, 10.0, 40.0, 400.0, 50.0, 40.0, 210.0, 200.0, 80.0, 420.0, 170.0, 160.0, 90.0, -30.0, 10.0, 10.0, -10.0, 60.0, 0.0, 40.0, 80.0, 160.0, 20.0, 250.0, 40.0, 120.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 70.0, 50.0, 0.0, 0.0, 550.0, 150.0, 170.0, 80.0, 260.0, 110.0, 60.0, 40.0, 50.0, 180.0, 0.0, -5.0, 30.0, 120.0, 40.0, 20.0, 90.0, 5.0, 210.0, 80.0, 530.0, 20.0, 260.0, 90.0, 160.0, 30.0, 20.0, 80.0, 30.0, 20.0, 10.0, 80.0, 260.0, 0.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, -10.0, 0.0, 10.0, 180.0, -10.0, 40.0, 90.0, 5.0, 110.0, -20.0, 300.0, 80.0, 15.0, 20.0, 10.0, 80.0, -90.0, 10.0, 110.0, 30.0, 60.0, 40.0, 100.0, 40.0, 300.0, 500.0, 400.0, 30.0, 1050.0, 50.0, 5.0, 300.0, 30.0, -30.0, 60.0, 70.0, 20.0, 170.0, 170.0, 210.0, 20.0, 390.0, 100.0, 170.0, 0.0, 50.0, 40.0, 360.0, 0.0, 20.0, 130.0, 210.0, 90.0, 60.0, 50.0, 50.0, 20.0, 20.0, 30.0, 20.0, 90.0, 20.0, 30.0, 290.0, 40.0, 10.0, 10.0, 40.0, 190.0, 30.0, 20.0, -10.0, 60.0, 10.0, 20.0, 0.0, 310.0, 160.0, 0.0, 190.0, 10.0, 60.0, 270.0, 40.0, -10.0, 60.0, 40.0, 40.0, 90.0, 170.0, 70.0, 100.0, 60.0, 240.0, 100.0, 60.0, 170.0, 180.0, 40.0, 20.0, 120.0, 100.0, 160.0, 100.0, 200.0, 90.0, 130.0, 100.0, 200.0, 40.0, 60.0, 160.0, 80.0, 220.0, 290.0, 80.0, 60.0, 350.0, 60.0, 380.0, 50.0, 40.0, 60.0, 40.0, 40.0, 80.0, 90.0, 70.0, 180.0, 230.0, 40.0, 60.0, 180.0, -40.0, 60.0, 80.0, -55.0, 50.0, 50.0, -50.0, 80.0, 80.0, 370.0, 160.0, 210.0, 310.0, 10.0, 170.0, 260.0, 140.0, 50.0, 230.0, 60.0, 80.0, 30.0, 55.0, 500.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 60.0, 40.0, 40.0, 170.0, 70.0, 50.0, 40.0, -70.0, 90.0, 20.0, 120.0, 220.0, 120.0, 370.0, 0.0, 110.0, 10.0, -40.0, 80.0, 30.0, 10.0, 40.0, 0.0, 70.0, 50.0, 300.0, 60.0, 80.0, 50.0, 180.0, 100.0, 30.0, 90.0, 80.0, 50.0, 100.0, 190.0, 10.0, 120.0, 40.0, 70.0, 140.0, 605.0, 10.0, 20.0, 40.0, 20.0, 100.0, 20.0, 30.0, 10.0, 90.0, 40.0, 20.0, 190.0, 35.0, 70.0, 60.0, 20.0, 190.0, 50.0, 60.0, 20.0, 60.0, 40.0, 40.0, 5.0, 10.0, 10.0, 30.0, 40.0, 180.0, 60.0, 270.0, 140.0, 0.0, 40.0, 250.0, -20.0, 130.0, 20.0, 0.0, 110.0, -30.0, 90.0, 20.0, 400.0, 380.0, 150.0, 20.0, 10.0, 70.0, -80.0, 80.0, 30.0, 70.0, 590.0, 300.0, 100.0, 120.0, 260.0, 110.0, 240.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 200.0, 30.0, 0.0, 0.0, 180.0, 90.0, 30.0, 0.0, 10.0, 170.0, 10.0, 50.0, 220.0, 60.0, 140.0, 90.0, -5.0, 25.0, 5.0, 70.0, 320.0, 25.0, 50.0, 10.0, 260.0, 60.0, 100.0, 330.0, 200.0, 160.0, 190.0, 50.0, 140.0, 80.0, 20.0, 200.0, 0.0, 50.0, 100.0, -10.0, 30.0, 260.0, 20.0, 110.0, 90.0, 360.0, 100.0, 0.0, 30.0, 50.0, 0.0, 170.0, 10.0, 10.0, 40.0, 220.0, 10.0, 60.0, 30.0, 80.0, 190.0, 30.0, 80.0, 20.0, 110.0, 180.0, 30.0, 180.0, 110.0, 20.0, 70.0, 180.0, 30.0, 420.0, 20.0, 60.0, 50.0, 50.0, 200.0, 40.0, 260.0, 50.0, 20.0, 40.0, 90.0, 40.0, 90.0, 170.0, 220.0, 20.0, 40.0, 40.0, 100.0, 240.0, 20.0, 60.0, 40.0, 0.0, 30.0, 30.0, 50.0, 220.0, 30.0, 20.0, 160.0, 40.0, 40.0, 0.0, 20.0, 40.0, 0.0, 180.0, 40.0, 20.0, 70.0, 30.0, -30.0, 0.0, 10.0, 380.0, 390.0, 0.0, 70.0, 170.0, 160.0, 110.0, 150.0, 40.0, 40.0, 80.0, 120.0, 260.0, 80.0, 80.0, 40.0, 30.0, 10.0, 10.0, 190.0, 70.0, 20.0, 30.0, 10.0, 30.0, 150.0, 0.0, 50.0, 10.0, 30.0, 40.0, 140.0, 30.0, 0.0, 180.0, 70.0, 10.0, 0.0, 170.0, 430.0, 60.0, 10.0, 180.0, 180.0, 50.0, 20.0, 170.0, 40.0, 30.0, 120.0, 60.0, 20.0, 15.0, 20.0, 60.0, 20.0, 10.0, 60.0, 160.0, 60.0, 90.0, 20.0, 120.0, 20.0, 50.0, 30.0, 40.0, 10.0, 160.0, 280.0, -5.0, 90.0, 110.0, 90.0, 60.0, 290.0, 150.0, 20.0, 20.0, 20.0, 30.0, 290.0, 60.0, 180.0, 100.0, 100.0, 15.0, 290.0, 70.0, 100.0, 720.0, 20.0, 90.0, 40.0, 280.0, 110.0, 40.0, 0.0, 30.0, 30.0, 170.0, 230.0, 0.0, 40.0, 70.0, 40.0, 20.0, 0.0, 50.0, 250.0, 30.0, 70.0, 40.0, 0.0, 30.0, 40.0, -40.0, 20.0, 120.0, 200.0, 300.0, 60.0, 360.0, 250.0, 0.0, 190.0, 250.0, -5.0, 15.0, -30.0, 30.0, 120.0, 35.0, 20.0, 30.0, 10.0, 0.0, 110.0, 50.0, 70.0, 75.0, 20.0, 260.0, 90.0, 400.0, 70.0, -30.0, 250.0, 170.0, 70.0, 90.0, 230.0, 110.0, -30.0, 40.0, 170.0, 70.0, 90.0, 160.0, 120.0, 40.0, 100.0, 70.0, 30.0, 20.0, 110.0, -85.0, 90.0, 130.0, 400.0, 150.0, 110.0, 30.0, 80.0, 90.0, 40.0, 200.0, 10.0, 220.0, 100.0, 70.0, 30.0, 120.0, 0.0, 40.0, 380.0, 100.0, 10.0, 180.0, -10.0, 0.0, 40.0, 0.0, 90.0, 70.0, 20.0, 80.0, 80.0, 0.0, 140.0, 130.0, 140.0, 30.0, 80.0, 40.0, 310.0, 150.0, 10.0, 40.0, 50.0, 70.0, 50.0, 90.0, 310.0, 80.0, 40.0, 70.0, 90.0, 10.0, 210.0, 60.0, 120.0, 40.0, 40.0, 170.0, -220.0, 260.0, 30.0, 10.0, -30.0, 250.0, 510.0, 290.0, 190.0, 40.0, 100.0, 40.0, 60.0, 50.0, 190.0, 550.0, 130.0, 240.0, 60.0, 90.0, 270.0, 0.0, 20.0, 200.0, -105.0, 30.0, 40.0, 390.0, 100.0, 30.0, 150.0, 40.0, 20.0, 190.0, 170.0, 30.0, 180.0, 100.0, 270.0, 40.0, -30.0, 60.0, 60.0, 80.0, 90.0, 190.0, 300.0, 70.0, 100.0, 90.0, 90.0, 40.0, 50.0, 10.0, 70.0, 550.0, 20.0, 10.0, 0.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 110.0, 30.0, 20.0, 340.0, 130.0, 230.0, 240.0, 30.0, 80.0, 20.0, 20.0, 190.0, 50.0, 70.0, 60.0, 60.0, 10.0, 80.0, 250.0, 80.0, 40.0, 120.0, 190.0, 0.0, 140.0, 810.0, 70.0, 40.0, -20.0, 70.0, 110.0, 120.0, 70.0, 480.0, 60.0, 30.0, 40.0, 30.0, 100.0, 25.0, -5.0, -10.0, 50.0, 90.0, 30.0, 90.0, 250.0, -10.0, 230.0, 20.0, 100.0, 100.0, 10.0, 60.0, 50.0, 330.0, 90.0, 220.0, 140.0, -110.0, 50.0, 90.0, 140.0, 60.0, 80.0, 140.0, 120.0, 250.0, 210.0, 80.0, 550.0, 80.0, 160.0, 160.0, 10.0, -100.0, 100.0, 160.0, 40.0, 130.0, 400.0, 110.0, 0.0, 160.0, 0.0, 110.0, 40.0, 50.0, 10.0, 40.0, 60.0, 140.0, 40.0, 50.0, 110.0, 60.0, 0.0, 30.0, 60.0, 90.0, 0.0, -50.0, 100.0, 50.0, 5.0, 60.0, 290.0, 160.0, 100.0, 60.0, 20.0, 20.0, 250.0, 10.0, 20.0, 40.0, 0.0, 40.0, 50.0, 80.0, 0.0, 40.0, 0.0, 0.0, 40.0, 20.0, 30.0, 180.0, 160.0, 100.0, 30.0, 40.0, 20.0, 10.0, 40.0, 70.0, 330.0, 30.0, 20.0, 370.0, 10.0, -30.0, 120.0, 15.0, 10.0, 220.0, 20.0, 70.0, 110.0, 80.0, 100.0, 90.0, 40.0, 140.0, 30.0, 30.0, 150.0, 270.0, 10.0, 60.0, 10.0, 10.0, 30.0, 100.0, 40.0, 30.0, 80.0, 220.0, 180.0, 10.0, 130.0, 260.0, 440.0, 50.0, 20.0, 270.0, 150.0, 50.0, 90.0, 70.0, 210.0, 130.0, 60.0, 160.0, 70.0, 120.0, 160.0, 80.0, 120.0, 210.0, 130.0, 150.0, 100.0, 200.0, 60.0, 90.0, 0.0, 200.0, 50.0, 10.0, 90.0, 210.0, 40.0, -10.0, 30.0, 20.0, 170.0, 50.0, 40.0, 50.0, 30.0, 500.0, -10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7017124954545393, "mean_inference_ms": 1.4912641984948452, "mean_action_processing_ms": 0.43797529493712534, "mean_env_wait_ms": 1.3573315399861001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013123035430908203, "StateBufferConnector_ms": 0.010633230209350586, "ViewRequirementAgentConnector_ms": 0.40613651275634766}, "num_episodes": 18, "episode_return_max": 1900.0, "episode_return_min": 270.0, "episode_return_mean": 946.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.141262223042297, "num_env_steps_trained_throughput_per_sec": 19.141262223042297, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 209758.301, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209758.255, "sample_time_ms": 2903.491, "learn_time_ms": 206832.38, "learn_throughput": 19.339, "synch_weights_time_ms": 12.378}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 56, "trial_id": "aa996_00000", "date": "2024-05-24_01-59-56", "timestamp": 1716530396, "time_this_iter_s": 208.9848473072052, "time_total_s": 11663.069058656693, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dc3430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11663.069058656693, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 19.37559322033898, "ram_util_percent": 79.65593220338982}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.727256175536063, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.315722416917356, "policy_loss": -0.008769651659326956, "vf_loss": 6.323190440308934, "vf_explained_var": 0.001437146588763236, "kl": 0.006508111107642988, "entropy": 0.5063557071585498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 530535.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 270.0, "episode_reward_mean": 935.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -220.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 93.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1190.0, 805.0, 1270.0, 1575.0, 330.0, 830.0, 610.0, 1010.0, 1405.0, 380.0, 715.0, 475.0, 940.0, 1030.0, 1900.0, 290.0, 820.0, 730.0, 1570.0, 780.0, 820.0, 760.0, 1330.0, 790.0, 1050.0, 500.0, 540.0, 1090.0, 1120.0, 440.0, 630.0, 1160.0, 555.0, 610.0, 865.0, 1160.0, 1725.0, 720.0, 530.0, 1310.0, 655.0, 1085.0, 970.0, 870.0, 1105.0, 830.0, 860.0, 740.0, 1160.0, 850.0, 1330.0, 1510.0, 975.0, 1190.0, 1010.0, 900.0, 270.0, 1330.0, 960.0, 1410.0, 800.0, 910.0, 1060.0, 1730.0, 1010.0, 650.0, 450.0, 1015.0, 280.0, 620.0, 970.0, 755.0, 740.0, 1490.0, 1100.0, 1300.0, 950.0, 870.0, 710.0, 1290.0, 790.0, 1160.0, 1340.0, 1140.0, 910.0, 1480.0, 360.0, 1255.0, 1270.0, 440.0, 780.0, 400.0, 860.0, 490.0, 895.0, 540.0, 1090.0, 950.0, 1300.0, 1010.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [350.0, 60.0, 380.0, 50.0, 40.0, 60.0, 40.0, 40.0, 80.0, 90.0, 70.0, 180.0, 230.0, 40.0, 60.0, 180.0, -40.0, 60.0, 80.0, -55.0, 50.0, 50.0, -50.0, 80.0, 80.0, 370.0, 160.0, 210.0, 310.0, 10.0, 170.0, 260.0, 140.0, 50.0, 230.0, 60.0, 80.0, 30.0, 55.0, 500.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 60.0, 40.0, 40.0, 170.0, 70.0, 50.0, 40.0, -70.0, 90.0, 20.0, 120.0, 220.0, 120.0, 370.0, 0.0, 110.0, 10.0, -40.0, 80.0, 30.0, 10.0, 40.0, 0.0, 70.0, 50.0, 300.0, 60.0, 80.0, 50.0, 180.0, 100.0, 30.0, 90.0, 80.0, 50.0, 100.0, 190.0, 10.0, 120.0, 40.0, 70.0, 140.0, 605.0, 10.0, 20.0, 40.0, 20.0, 100.0, 20.0, 30.0, 10.0, 90.0, 40.0, 20.0, 190.0, 35.0, 70.0, 60.0, 20.0, 190.0, 50.0, 60.0, 20.0, 60.0, 40.0, 40.0, 5.0, 10.0, 10.0, 30.0, 40.0, 180.0, 60.0, 270.0, 140.0, 0.0, 40.0, 250.0, -20.0, 130.0, 20.0, 0.0, 110.0, -30.0, 90.0, 20.0, 400.0, 380.0, 150.0, 20.0, 10.0, 70.0, -80.0, 80.0, 30.0, 70.0, 590.0, 300.0, 100.0, 120.0, 260.0, 110.0, 240.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 200.0, 30.0, 0.0, 0.0, 180.0, 90.0, 30.0, 0.0, 10.0, 170.0, 10.0, 50.0, 220.0, 60.0, 140.0, 90.0, -5.0, 25.0, 5.0, 70.0, 320.0, 25.0, 50.0, 10.0, 260.0, 60.0, 100.0, 330.0, 200.0, 160.0, 190.0, 50.0, 140.0, 80.0, 20.0, 200.0, 0.0, 50.0, 100.0, -10.0, 30.0, 260.0, 20.0, 110.0, 90.0, 360.0, 100.0, 0.0, 30.0, 50.0, 0.0, 170.0, 10.0, 10.0, 40.0, 220.0, 10.0, 60.0, 30.0, 80.0, 190.0, 30.0, 80.0, 20.0, 110.0, 180.0, 30.0, 180.0, 110.0, 20.0, 70.0, 180.0, 30.0, 420.0, 20.0, 60.0, 50.0, 50.0, 200.0, 40.0, 260.0, 50.0, 20.0, 40.0, 90.0, 40.0, 90.0, 170.0, 220.0, 20.0, 40.0, 40.0, 100.0, 240.0, 20.0, 60.0, 40.0, 0.0, 30.0, 30.0, 50.0, 220.0, 30.0, 20.0, 160.0, 40.0, 40.0, 0.0, 20.0, 40.0, 0.0, 180.0, 40.0, 20.0, 70.0, 30.0, -30.0, 0.0, 10.0, 380.0, 390.0, 0.0, 70.0, 170.0, 160.0, 110.0, 150.0, 40.0, 40.0, 80.0, 120.0, 260.0, 80.0, 80.0, 40.0, 30.0, 10.0, 10.0, 190.0, 70.0, 20.0, 30.0, 10.0, 30.0, 150.0, 0.0, 50.0, 10.0, 30.0, 40.0, 140.0, 30.0, 0.0, 180.0, 70.0, 10.0, 0.0, 170.0, 430.0, 60.0, 10.0, 180.0, 180.0, 50.0, 20.0, 170.0, 40.0, 30.0, 120.0, 60.0, 20.0, 15.0, 20.0, 60.0, 20.0, 10.0, 60.0, 160.0, 60.0, 90.0, 20.0, 120.0, 20.0, 50.0, 30.0, 40.0, 10.0, 160.0, 280.0, -5.0, 90.0, 110.0, 90.0, 60.0, 290.0, 150.0, 20.0, 20.0, 20.0, 30.0, 290.0, 60.0, 180.0, 100.0, 100.0, 15.0, 290.0, 70.0, 100.0, 720.0, 20.0, 90.0, 40.0, 280.0, 110.0, 40.0, 0.0, 30.0, 30.0, 170.0, 230.0, 0.0, 40.0, 70.0, 40.0, 20.0, 0.0, 50.0, 250.0, 30.0, 70.0, 40.0, 0.0, 30.0, 40.0, -40.0, 20.0, 120.0, 200.0, 300.0, 60.0, 360.0, 250.0, 0.0, 190.0, 250.0, -5.0, 15.0, -30.0, 30.0, 120.0, 35.0, 20.0, 30.0, 10.0, 0.0, 110.0, 50.0, 70.0, 75.0, 20.0, 260.0, 90.0, 400.0, 70.0, -30.0, 250.0, 170.0, 70.0, 90.0, 230.0, 110.0, -30.0, 40.0, 170.0, 70.0, 90.0, 160.0, 120.0, 40.0, 100.0, 70.0, 30.0, 20.0, 110.0, -85.0, 90.0, 130.0, 400.0, 150.0, 110.0, 30.0, 80.0, 90.0, 40.0, 200.0, 10.0, 220.0, 100.0, 70.0, 30.0, 120.0, 0.0, 40.0, 380.0, 100.0, 10.0, 180.0, -10.0, 0.0, 40.0, 0.0, 90.0, 70.0, 20.0, 80.0, 80.0, 0.0, 140.0, 130.0, 140.0, 30.0, 80.0, 40.0, 310.0, 150.0, 10.0, 40.0, 50.0, 70.0, 50.0, 90.0, 310.0, 80.0, 40.0, 70.0, 90.0, 10.0, 210.0, 60.0, 120.0, 40.0, 40.0, 170.0, -220.0, 260.0, 30.0, 10.0, -30.0, 250.0, 510.0, 290.0, 190.0, 40.0, 100.0, 40.0, 60.0, 50.0, 190.0, 550.0, 130.0, 240.0, 60.0, 90.0, 270.0, 0.0, 20.0, 200.0, -105.0, 30.0, 40.0, 390.0, 100.0, 30.0, 150.0, 40.0, 20.0, 190.0, 170.0, 30.0, 180.0, 100.0, 270.0, 40.0, -30.0, 60.0, 60.0, 80.0, 90.0, 190.0, 300.0, 70.0, 100.0, 90.0, 90.0, 40.0, 50.0, 10.0, 70.0, 550.0, 20.0, 10.0, 0.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 110.0, 30.0, 20.0, 340.0, 130.0, 230.0, 240.0, 30.0, 80.0, 20.0, 20.0, 190.0, 50.0, 70.0, 60.0, 60.0, 10.0, 80.0, 250.0, 80.0, 40.0, 120.0, 190.0, 0.0, 140.0, 810.0, 70.0, 40.0, -20.0, 70.0, 110.0, 120.0, 70.0, 480.0, 60.0, 30.0, 40.0, 30.0, 100.0, 25.0, -5.0, -10.0, 50.0, 90.0, 30.0, 90.0, 250.0, -10.0, 230.0, 20.0, 100.0, 100.0, 10.0, 60.0, 50.0, 330.0, 90.0, 220.0, 140.0, -110.0, 50.0, 90.0, 140.0, 60.0, 80.0, 140.0, 120.0, 250.0, 210.0, 80.0, 550.0, 80.0, 160.0, 160.0, 10.0, -100.0, 100.0, 160.0, 40.0, 130.0, 400.0, 110.0, 0.0, 160.0, 0.0, 110.0, 40.0, 50.0, 10.0, 40.0, 60.0, 140.0, 40.0, 50.0, 110.0, 60.0, 0.0, 30.0, 60.0, 90.0, 0.0, -50.0, 100.0, 50.0, 5.0, 60.0, 290.0, 160.0, 100.0, 60.0, 20.0, 20.0, 250.0, 10.0, 20.0, 40.0, 0.0, 40.0, 50.0, 80.0, 0.0, 40.0, 0.0, 0.0, 40.0, 20.0, 30.0, 180.0, 160.0, 100.0, 30.0, 40.0, 20.0, 10.0, 40.0, 70.0, 330.0, 30.0, 20.0, 370.0, 10.0, -30.0, 120.0, 15.0, 10.0, 220.0, 20.0, 70.0, 110.0, 80.0, 100.0, 90.0, 40.0, 140.0, 30.0, 30.0, 150.0, 270.0, 10.0, 60.0, 10.0, 10.0, 30.0, 100.0, 40.0, 30.0, 80.0, 220.0, 180.0, 10.0, 130.0, 260.0, 440.0, 50.0, 20.0, 270.0, 150.0, 50.0, 90.0, 70.0, 210.0, 130.0, 60.0, 160.0, 70.0, 120.0, 160.0, 80.0, 120.0, 210.0, 130.0, 150.0, 100.0, 200.0, 60.0, 90.0, 0.0, 200.0, 50.0, 10.0, 90.0, 210.0, 40.0, -10.0, 30.0, 20.0, 170.0, 50.0, 40.0, 50.0, 30.0, 500.0, -10.0, 60.0, 20.0, 20.0, 60.0, 30.0, 180.0, 70.0, 20.0, 50.0, 200.0, 390.0, 50.0, 0.0, 90.0, 60.0, 50.0, 160.0, 0.0, 390.0, 100.0, 20.0, -10.0, 150.0, 170.0, 280.0, 10.0, 30.0, 40.0, 80.0, 20.0, 0.0, 80.0, 180.0, 70.0, 260.0, 290.0, 90.0, 100.0, 20.0, 70.0, 310.0, 220.0, 50.0, 190.0, 70.0, 100.0, 160.0, 140.0, 60.0, 40.0, 320.0, 80.0, 30.0, 70.0, 280.0, 20.0, 40.0, 170.0, 50.0, 80.0, 90.0, 310.0, 20.0, 50.0, 90.0, 30.0, 100.0, 90.0, -10.0, 140.0, 420.0, 220.0, 60.0, 90.0, 230.0, 30.0, 10.0, 370.0, 20.0, 30.0, 20.0, -20.0, 30.0, 0.0, 10.0, 100.0, 20.0, 80.0, 0.0, 120.0, 120.0, 170.0, 10.0, 100.0, 90.0, 220.0, 200.0, 70.0, 240.0, 35.0, -10.0, 190.0, 30.0, 60.0, 60.0, 300.0, 20.0, 530.0, 60.0, 30.0, 80.0, -10.0, 10.0, 30.0, 110.0, 80.0, 50.0, 20.0, 60.0, 10.0, 10.0, 130.0, 40.0, 40.0, 200.0, 110.0, 60.0, 50.0, 140.0, 0.0, 40.0, 50.0, 10.0, 20.0, 70.0, 20.0, 50.0, 90.0, 40.0, 10.0, 40.0, 20.0, 30.0, 50.0, 40.0, 60.0, 330.0, 190.0, 30.0, 70.0, 90.0, 70.0, 30.0, 0.0, 10.0, 30.0, 0.0, 150.0, 100.0, 10.0, 50.0, 90.0, 30.0, 25.0, 200.0, 40.0, 30.0, 170.0, 10.0, 250.0, 70.0, 80.0, 90.0, 0.0, 30.0, 50.0, 30.0, 80.0, 30.0, 80.0, 30.0, 70.0, 420.0, 130.0, 110.0, 90.0, 70.0, 30.0, 140.0, 0.0, 20.0, 0.0, 80.0, 270.0, 30.0, 270.0, 170.0, 0.0, 30.0, 80.0, 80.0, 320.0, 80.0, 20.0, 70.0, 30.0, 60.0, 410.0, 180.0, 50.0, 70.0, 20.0, 270.0, 80.0, 30.0, 10.0, 210.0, 50.0, 230.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.701084746331374, "mean_inference_ms": 1.4924870557587127, "mean_action_processing_ms": 0.43755448578542305, "mean_env_wait_ms": 1.3571619630482143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01381373405456543, "StateBufferConnector_ms": 0.011052131652832031, "ViewRequirementAgentConnector_ms": 0.4308319091796875}, "num_episodes": 22, "episode_return_max": 1900.0, "episode_return_min": 270.0, "episode_return_mean": 935.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.284719457813594, "num_env_steps_trained_throughput_per_sec": 19.284719457813594, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 209661.353, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209661.284, "sample_time_ms": 2916.415, "learn_time_ms": 206722.671, "learn_throughput": 19.35, "synch_weights_time_ms": 12.393}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 57, "trial_id": "aa996_00000", "date": "2024-05-24_02-03-23", "timestamp": 1716530603, "time_this_iter_s": 207.4276101589203, "time_total_s": 11870.496668815613, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11870.496668815613, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.016666666666666, "ram_util_percent": 78.6986394557823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7919848315949385, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.252859240776687, "policy_loss": -0.008056059209168695, "vf_loss": 6.259609759526765, "vf_explained_var": 0.0007259820914243103, "kl": 0.006527685677273869, "entropy": 0.5076337672587528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 539925.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 1730.0, "episode_reward_min": 260.0, "episode_reward_mean": 918.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -220.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 91.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [790.0, 1050.0, 500.0, 540.0, 1090.0, 1120.0, 440.0, 630.0, 1160.0, 555.0, 610.0, 865.0, 1160.0, 1725.0, 720.0, 530.0, 1310.0, 655.0, 1085.0, 970.0, 870.0, 1105.0, 830.0, 860.0, 740.0, 1160.0, 850.0, 1330.0, 1510.0, 975.0, 1190.0, 1010.0, 900.0, 270.0, 1330.0, 960.0, 1410.0, 800.0, 910.0, 1060.0, 1730.0, 1010.0, 650.0, 450.0, 1015.0, 280.0, 620.0, 970.0, 755.0, 740.0, 1490.0, 1100.0, 1300.0, 950.0, 870.0, 710.0, 1290.0, 790.0, 1160.0, 1340.0, 1140.0, 910.0, 1480.0, 360.0, 1255.0, 1270.0, 440.0, 780.0, 400.0, 860.0, 490.0, 895.0, 540.0, 1090.0, 950.0, 1300.0, 1010.0, 970.0, 570.0, 955.0, 1530.0, 830.0, 980.0, 530.0, 620.0, 860.0, 460.0, 840.0, 1570.0, 820.0, 1660.0, 950.0, 800.0, 555.0, 720.0, 1200.0, 410.0, 260.0, 970.0, 855.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 60.0, 50.0, 50.0, 200.0, 40.0, 260.0, 50.0, 20.0, 40.0, 90.0, 40.0, 90.0, 170.0, 220.0, 20.0, 40.0, 40.0, 100.0, 240.0, 20.0, 60.0, 40.0, 0.0, 30.0, 30.0, 50.0, 220.0, 30.0, 20.0, 160.0, 40.0, 40.0, 0.0, 20.0, 40.0, 0.0, 180.0, 40.0, 20.0, 70.0, 30.0, -30.0, 0.0, 10.0, 380.0, 390.0, 0.0, 70.0, 170.0, 160.0, 110.0, 150.0, 40.0, 40.0, 80.0, 120.0, 260.0, 80.0, 80.0, 40.0, 30.0, 10.0, 10.0, 190.0, 70.0, 20.0, 30.0, 10.0, 30.0, 150.0, 0.0, 50.0, 10.0, 30.0, 40.0, 140.0, 30.0, 0.0, 180.0, 70.0, 10.0, 0.0, 170.0, 430.0, 60.0, 10.0, 180.0, 180.0, 50.0, 20.0, 170.0, 40.0, 30.0, 120.0, 60.0, 20.0, 15.0, 20.0, 60.0, 20.0, 10.0, 60.0, 160.0, 60.0, 90.0, 20.0, 120.0, 20.0, 50.0, 30.0, 40.0, 10.0, 160.0, 280.0, -5.0, 90.0, 110.0, 90.0, 60.0, 290.0, 150.0, 20.0, 20.0, 20.0, 30.0, 290.0, 60.0, 180.0, 100.0, 100.0, 15.0, 290.0, 70.0, 100.0, 720.0, 20.0, 90.0, 40.0, 280.0, 110.0, 40.0, 0.0, 30.0, 30.0, 170.0, 230.0, 0.0, 40.0, 70.0, 40.0, 20.0, 0.0, 50.0, 250.0, 30.0, 70.0, 40.0, 0.0, 30.0, 40.0, -40.0, 20.0, 120.0, 200.0, 300.0, 60.0, 360.0, 250.0, 0.0, 190.0, 250.0, -5.0, 15.0, -30.0, 30.0, 120.0, 35.0, 20.0, 30.0, 10.0, 0.0, 110.0, 50.0, 70.0, 75.0, 20.0, 260.0, 90.0, 400.0, 70.0, -30.0, 250.0, 170.0, 70.0, 90.0, 230.0, 110.0, -30.0, 40.0, 170.0, 70.0, 90.0, 160.0, 120.0, 40.0, 100.0, 70.0, 30.0, 20.0, 110.0, -85.0, 90.0, 130.0, 400.0, 150.0, 110.0, 30.0, 80.0, 90.0, 40.0, 200.0, 10.0, 220.0, 100.0, 70.0, 30.0, 120.0, 0.0, 40.0, 380.0, 100.0, 10.0, 180.0, -10.0, 0.0, 40.0, 0.0, 90.0, 70.0, 20.0, 80.0, 80.0, 0.0, 140.0, 130.0, 140.0, 30.0, 80.0, 40.0, 310.0, 150.0, 10.0, 40.0, 50.0, 70.0, 50.0, 90.0, 310.0, 80.0, 40.0, 70.0, 90.0, 10.0, 210.0, 60.0, 120.0, 40.0, 40.0, 170.0, -220.0, 260.0, 30.0, 10.0, -30.0, 250.0, 510.0, 290.0, 190.0, 40.0, 100.0, 40.0, 60.0, 50.0, 190.0, 550.0, 130.0, 240.0, 60.0, 90.0, 270.0, 0.0, 20.0, 200.0, -105.0, 30.0, 40.0, 390.0, 100.0, 30.0, 150.0, 40.0, 20.0, 190.0, 170.0, 30.0, 180.0, 100.0, 270.0, 40.0, -30.0, 60.0, 60.0, 80.0, 90.0, 190.0, 300.0, 70.0, 100.0, 90.0, 90.0, 40.0, 50.0, 10.0, 70.0, 550.0, 20.0, 10.0, 0.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 110.0, 30.0, 20.0, 340.0, 130.0, 230.0, 240.0, 30.0, 80.0, 20.0, 20.0, 190.0, 50.0, 70.0, 60.0, 60.0, 10.0, 80.0, 250.0, 80.0, 40.0, 120.0, 190.0, 0.0, 140.0, 810.0, 70.0, 40.0, -20.0, 70.0, 110.0, 120.0, 70.0, 480.0, 60.0, 30.0, 40.0, 30.0, 100.0, 25.0, -5.0, -10.0, 50.0, 90.0, 30.0, 90.0, 250.0, -10.0, 230.0, 20.0, 100.0, 100.0, 10.0, 60.0, 50.0, 330.0, 90.0, 220.0, 140.0, -110.0, 50.0, 90.0, 140.0, 60.0, 80.0, 140.0, 120.0, 250.0, 210.0, 80.0, 550.0, 80.0, 160.0, 160.0, 10.0, -100.0, 100.0, 160.0, 40.0, 130.0, 400.0, 110.0, 0.0, 160.0, 0.0, 110.0, 40.0, 50.0, 10.0, 40.0, 60.0, 140.0, 40.0, 50.0, 110.0, 60.0, 0.0, 30.0, 60.0, 90.0, 0.0, -50.0, 100.0, 50.0, 5.0, 60.0, 290.0, 160.0, 100.0, 60.0, 20.0, 20.0, 250.0, 10.0, 20.0, 40.0, 0.0, 40.0, 50.0, 80.0, 0.0, 40.0, 0.0, 0.0, 40.0, 20.0, 30.0, 180.0, 160.0, 100.0, 30.0, 40.0, 20.0, 10.0, 40.0, 70.0, 330.0, 30.0, 20.0, 370.0, 10.0, -30.0, 120.0, 15.0, 10.0, 220.0, 20.0, 70.0, 110.0, 80.0, 100.0, 90.0, 40.0, 140.0, 30.0, 30.0, 150.0, 270.0, 10.0, 60.0, 10.0, 10.0, 30.0, 100.0, 40.0, 30.0, 80.0, 220.0, 180.0, 10.0, 130.0, 260.0, 440.0, 50.0, 20.0, 270.0, 150.0, 50.0, 90.0, 70.0, 210.0, 130.0, 60.0, 160.0, 70.0, 120.0, 160.0, 80.0, 120.0, 210.0, 130.0, 150.0, 100.0, 200.0, 60.0, 90.0, 0.0, 200.0, 50.0, 10.0, 90.0, 210.0, 40.0, -10.0, 30.0, 20.0, 170.0, 50.0, 40.0, 50.0, 30.0, 500.0, -10.0, 60.0, 20.0, 20.0, 60.0, 30.0, 180.0, 70.0, 20.0, 50.0, 200.0, 390.0, 50.0, 0.0, 90.0, 60.0, 50.0, 160.0, 0.0, 390.0, 100.0, 20.0, -10.0, 150.0, 170.0, 280.0, 10.0, 30.0, 40.0, 80.0, 20.0, 0.0, 80.0, 180.0, 70.0, 260.0, 290.0, 90.0, 100.0, 20.0, 70.0, 310.0, 220.0, 50.0, 190.0, 70.0, 100.0, 160.0, 140.0, 60.0, 40.0, 320.0, 80.0, 30.0, 70.0, 280.0, 20.0, 40.0, 170.0, 50.0, 80.0, 90.0, 310.0, 20.0, 50.0, 90.0, 30.0, 100.0, 90.0, -10.0, 140.0, 420.0, 220.0, 60.0, 90.0, 230.0, 30.0, 10.0, 370.0, 20.0, 30.0, 20.0, -20.0, 30.0, 0.0, 10.0, 100.0, 20.0, 80.0, 0.0, 120.0, 120.0, 170.0, 10.0, 100.0, 90.0, 220.0, 200.0, 70.0, 240.0, 35.0, -10.0, 190.0, 30.0, 60.0, 60.0, 300.0, 20.0, 530.0, 60.0, 30.0, 80.0, -10.0, 10.0, 30.0, 110.0, 80.0, 50.0, 20.0, 60.0, 10.0, 10.0, 130.0, 40.0, 40.0, 200.0, 110.0, 60.0, 50.0, 140.0, 0.0, 40.0, 50.0, 10.0, 20.0, 70.0, 20.0, 50.0, 90.0, 40.0, 10.0, 40.0, 20.0, 30.0, 50.0, 40.0, 60.0, 330.0, 190.0, 30.0, 70.0, 90.0, 70.0, 30.0, 0.0, 10.0, 30.0, 0.0, 150.0, 100.0, 10.0, 50.0, 90.0, 30.0, 25.0, 200.0, 40.0, 30.0, 170.0, 10.0, 250.0, 70.0, 80.0, 90.0, 0.0, 30.0, 50.0, 30.0, 80.0, 30.0, 80.0, 30.0, 70.0, 420.0, 130.0, 110.0, 90.0, 70.0, 30.0, 140.0, 0.0, 20.0, 0.0, 80.0, 270.0, 30.0, 270.0, 170.0, 0.0, 30.0, 80.0, 80.0, 320.0, 80.0, 20.0, 70.0, 30.0, 60.0, 410.0, 180.0, 50.0, 70.0, 20.0, 270.0, 80.0, 30.0, 10.0, 210.0, 50.0, 230.0, 40.0, 230.0, 10.0, 40.0, 170.0, 90.0, 120.0, 40.0, 60.0, 100.0, 110.0, 110.0, 20.0, 30.0, 80.0, 70.0, 60.0, 10.0, 60.0, 130.0, 0.0, 20.0, 180.0, 80.0, 80.0, -5.0, 420.0, 0.0, 100.0, 40.0, 40.0, 170.0, 240.0, 60.0, 150.0, 230.0, 60.0, 50.0, 80.0, 90.0, 400.0, 10.0, 0.0, 120.0, 200.0, 180.0, 80.0, 80.0, 80.0, 40.0, 40.0, 0.0, 40.0, 50.0, 40.0, 140.0, 80.0, 180.0, 270.0, 70.0, 110.0, 0.0, 10.0, 90.0, 30.0, 30.0, 130.0, 30.0, 0.0, 160.0, 50.0, 30.0, 0.0, 30.0, 100.0, 70.0, 40.0, 40.0, 260.0, 40.0, 10.0, 0.0, 160.0, 50.0, 40.0, 350.0, 20.0, 50.0, 0.0, 120.0, 70.0, 0.0, 30.0, 180.0, 30.0, 10.0, 0.0, 10.0, 40.0, 20.0, 140.0, 20.0, 0.0, 110.0, 290.0, 70.0, 10.0, 180.0, 30.0, 70.0, 60.0, 140.0, 70.0, 0.0, 250.0, 600.0, 230.0, 35.0, 120.0, 110.0, 15.0, 70.0, 70.0, 30.0, 0.0, 190.0, 210.0, 30.0, -10.0, 0.0, 230.0, 130.0, 40.0, 40.0, 120.0, 520.0, 320.0, 130.0, 90.0, 80.0, 190.0, 210.0, 10.0, 10.0, 0.0, 30.0, 130.0, 0.0, 50.0, 50.0, 460.0, 20.0, 0.0, 310.0, 40.0, 90.0, 50.0, 80.0, 20.0, 80.0, 110.0, -5.0, 70.0, 40.0, 60.0, 10.0, 20.0, 90.0, 170.0, 50.0, 50.0, 20.0, 190.0, 170.0, 20.0, 10.0, 30.0, 90.0, 0.0, 10.0, 180.0, 80.0, 50.0, 10.0, 90.0, 100.0, 90.0, 310.0, 50.0, 200.0, 220.0, 0.0, 0.0, 180.0, 0.0, 50.0, 40.0, 60.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 90.0, 0.0, 190.0, 60.0, 180.0, 70.0, 150.0, 40.0, 10.0, 180.0, 60.0, 70.0, 260.0, 40.0, 60.0, 80.0, 90.0, 50.0, 160.0, -15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7004943747410517, "mean_inference_ms": 1.4928915095995654, "mean_action_processing_ms": 0.4369651822059022, "mean_env_wait_ms": 1.3564431228952203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013654232025146484, "StateBufferConnector_ms": 0.010792255401611328, "ViewRequirementAgentConnector_ms": 0.42223501205444336}, "num_episodes": 23, "episode_return_max": 1730.0, "episode_return_min": 260.0, "episode_return_mean": 918.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.09169924371842, "num_env_steps_trained_throughput_per_sec": 19.09169924371842, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 209722.586, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209722.52, "sample_time_ms": 2890.84, "learn_time_ms": 206808.707, "learn_throughput": 19.342, "synch_weights_time_ms": 12.582}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 58, "trial_id": "aa996_00000", "date": "2024-05-24_02-06-53", "timestamp": 1716530813, "time_this_iter_s": 209.54010701179504, "time_total_s": 12080.036775827408, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12080.036775827408, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.05878378378378, "ram_util_percent": 78.75067567567567}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6764526201957586, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.957989057869957, "policy_loss": -0.008623423582638184, "vf_loss": 6.965251085171684, "vf_explained_var": 0.0017623600360557549, "kl": 0.006807020534955927, "entropy": 0.4697110627278987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 549315.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "env_runners": {"episode_reward_max": 1730.0, "episode_reward_min": 260.0, "episode_reward_mean": 943.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -220.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 94.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1085.0, 970.0, 870.0, 1105.0, 830.0, 860.0, 740.0, 1160.0, 850.0, 1330.0, 1510.0, 975.0, 1190.0, 1010.0, 900.0, 270.0, 1330.0, 960.0, 1410.0, 800.0, 910.0, 1060.0, 1730.0, 1010.0, 650.0, 450.0, 1015.0, 280.0, 620.0, 970.0, 755.0, 740.0, 1490.0, 1100.0, 1300.0, 950.0, 870.0, 710.0, 1290.0, 790.0, 1160.0, 1340.0, 1140.0, 910.0, 1480.0, 360.0, 1255.0, 1270.0, 440.0, 780.0, 400.0, 860.0, 490.0, 895.0, 540.0, 1090.0, 950.0, 1300.0, 1010.0, 970.0, 570.0, 955.0, 1530.0, 830.0, 980.0, 530.0, 620.0, 860.0, 460.0, 840.0, 1570.0, 820.0, 1660.0, 950.0, 800.0, 555.0, 720.0, 1200.0, 410.0, 260.0, 970.0, 855.0, 460.0, 800.0, 1110.0, 1080.0, 850.0, 1150.0, 290.0, 1230.0, 1200.0, 1140.0, 1630.0, 1120.0, 790.0, 860.0, 675.0, 750.0, 1270.0, 1550.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 110.0, 50.0, 70.0, 75.0, 20.0, 260.0, 90.0, 400.0, 70.0, -30.0, 250.0, 170.0, 70.0, 90.0, 230.0, 110.0, -30.0, 40.0, 170.0, 70.0, 90.0, 160.0, 120.0, 40.0, 100.0, 70.0, 30.0, 20.0, 110.0, -85.0, 90.0, 130.0, 400.0, 150.0, 110.0, 30.0, 80.0, 90.0, 40.0, 200.0, 10.0, 220.0, 100.0, 70.0, 30.0, 120.0, 0.0, 40.0, 380.0, 100.0, 10.0, 180.0, -10.0, 0.0, 40.0, 0.0, 90.0, 70.0, 20.0, 80.0, 80.0, 0.0, 140.0, 130.0, 140.0, 30.0, 80.0, 40.0, 310.0, 150.0, 10.0, 40.0, 50.0, 70.0, 50.0, 90.0, 310.0, 80.0, 40.0, 70.0, 90.0, 10.0, 210.0, 60.0, 120.0, 40.0, 40.0, 170.0, -220.0, 260.0, 30.0, 10.0, -30.0, 250.0, 510.0, 290.0, 190.0, 40.0, 100.0, 40.0, 60.0, 50.0, 190.0, 550.0, 130.0, 240.0, 60.0, 90.0, 270.0, 0.0, 20.0, 200.0, -105.0, 30.0, 40.0, 390.0, 100.0, 30.0, 150.0, 40.0, 20.0, 190.0, 170.0, 30.0, 180.0, 100.0, 270.0, 40.0, -30.0, 60.0, 60.0, 80.0, 90.0, 190.0, 300.0, 70.0, 100.0, 90.0, 90.0, 40.0, 50.0, 10.0, 70.0, 550.0, 20.0, 10.0, 0.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 110.0, 30.0, 20.0, 340.0, 130.0, 230.0, 240.0, 30.0, 80.0, 20.0, 20.0, 190.0, 50.0, 70.0, 60.0, 60.0, 10.0, 80.0, 250.0, 80.0, 40.0, 120.0, 190.0, 0.0, 140.0, 810.0, 70.0, 40.0, -20.0, 70.0, 110.0, 120.0, 70.0, 480.0, 60.0, 30.0, 40.0, 30.0, 100.0, 25.0, -5.0, -10.0, 50.0, 90.0, 30.0, 90.0, 250.0, -10.0, 230.0, 20.0, 100.0, 100.0, 10.0, 60.0, 50.0, 330.0, 90.0, 220.0, 140.0, -110.0, 50.0, 90.0, 140.0, 60.0, 80.0, 140.0, 120.0, 250.0, 210.0, 80.0, 550.0, 80.0, 160.0, 160.0, 10.0, -100.0, 100.0, 160.0, 40.0, 130.0, 400.0, 110.0, 0.0, 160.0, 0.0, 110.0, 40.0, 50.0, 10.0, 40.0, 60.0, 140.0, 40.0, 50.0, 110.0, 60.0, 0.0, 30.0, 60.0, 90.0, 0.0, -50.0, 100.0, 50.0, 5.0, 60.0, 290.0, 160.0, 100.0, 60.0, 20.0, 20.0, 250.0, 10.0, 20.0, 40.0, 0.0, 40.0, 50.0, 80.0, 0.0, 40.0, 0.0, 0.0, 40.0, 20.0, 30.0, 180.0, 160.0, 100.0, 30.0, 40.0, 20.0, 10.0, 40.0, 70.0, 330.0, 30.0, 20.0, 370.0, 10.0, -30.0, 120.0, 15.0, 10.0, 220.0, 20.0, 70.0, 110.0, 80.0, 100.0, 90.0, 40.0, 140.0, 30.0, 30.0, 150.0, 270.0, 10.0, 60.0, 10.0, 10.0, 30.0, 100.0, 40.0, 30.0, 80.0, 220.0, 180.0, 10.0, 130.0, 260.0, 440.0, 50.0, 20.0, 270.0, 150.0, 50.0, 90.0, 70.0, 210.0, 130.0, 60.0, 160.0, 70.0, 120.0, 160.0, 80.0, 120.0, 210.0, 130.0, 150.0, 100.0, 200.0, 60.0, 90.0, 0.0, 200.0, 50.0, 10.0, 90.0, 210.0, 40.0, -10.0, 30.0, 20.0, 170.0, 50.0, 40.0, 50.0, 30.0, 500.0, -10.0, 60.0, 20.0, 20.0, 60.0, 30.0, 180.0, 70.0, 20.0, 50.0, 200.0, 390.0, 50.0, 0.0, 90.0, 60.0, 50.0, 160.0, 0.0, 390.0, 100.0, 20.0, -10.0, 150.0, 170.0, 280.0, 10.0, 30.0, 40.0, 80.0, 20.0, 0.0, 80.0, 180.0, 70.0, 260.0, 290.0, 90.0, 100.0, 20.0, 70.0, 310.0, 220.0, 50.0, 190.0, 70.0, 100.0, 160.0, 140.0, 60.0, 40.0, 320.0, 80.0, 30.0, 70.0, 280.0, 20.0, 40.0, 170.0, 50.0, 80.0, 90.0, 310.0, 20.0, 50.0, 90.0, 30.0, 100.0, 90.0, -10.0, 140.0, 420.0, 220.0, 60.0, 90.0, 230.0, 30.0, 10.0, 370.0, 20.0, 30.0, 20.0, -20.0, 30.0, 0.0, 10.0, 100.0, 20.0, 80.0, 0.0, 120.0, 120.0, 170.0, 10.0, 100.0, 90.0, 220.0, 200.0, 70.0, 240.0, 35.0, -10.0, 190.0, 30.0, 60.0, 60.0, 300.0, 20.0, 530.0, 60.0, 30.0, 80.0, -10.0, 10.0, 30.0, 110.0, 80.0, 50.0, 20.0, 60.0, 10.0, 10.0, 130.0, 40.0, 40.0, 200.0, 110.0, 60.0, 50.0, 140.0, 0.0, 40.0, 50.0, 10.0, 20.0, 70.0, 20.0, 50.0, 90.0, 40.0, 10.0, 40.0, 20.0, 30.0, 50.0, 40.0, 60.0, 330.0, 190.0, 30.0, 70.0, 90.0, 70.0, 30.0, 0.0, 10.0, 30.0, 0.0, 150.0, 100.0, 10.0, 50.0, 90.0, 30.0, 25.0, 200.0, 40.0, 30.0, 170.0, 10.0, 250.0, 70.0, 80.0, 90.0, 0.0, 30.0, 50.0, 30.0, 80.0, 30.0, 80.0, 30.0, 70.0, 420.0, 130.0, 110.0, 90.0, 70.0, 30.0, 140.0, 0.0, 20.0, 0.0, 80.0, 270.0, 30.0, 270.0, 170.0, 0.0, 30.0, 80.0, 80.0, 320.0, 80.0, 20.0, 70.0, 30.0, 60.0, 410.0, 180.0, 50.0, 70.0, 20.0, 270.0, 80.0, 30.0, 10.0, 210.0, 50.0, 230.0, 40.0, 230.0, 10.0, 40.0, 170.0, 90.0, 120.0, 40.0, 60.0, 100.0, 110.0, 110.0, 20.0, 30.0, 80.0, 70.0, 60.0, 10.0, 60.0, 130.0, 0.0, 20.0, 180.0, 80.0, 80.0, -5.0, 420.0, 0.0, 100.0, 40.0, 40.0, 170.0, 240.0, 60.0, 150.0, 230.0, 60.0, 50.0, 80.0, 90.0, 400.0, 10.0, 0.0, 120.0, 200.0, 180.0, 80.0, 80.0, 80.0, 40.0, 40.0, 0.0, 40.0, 50.0, 40.0, 140.0, 80.0, 180.0, 270.0, 70.0, 110.0, 0.0, 10.0, 90.0, 30.0, 30.0, 130.0, 30.0, 0.0, 160.0, 50.0, 30.0, 0.0, 30.0, 100.0, 70.0, 40.0, 40.0, 260.0, 40.0, 10.0, 0.0, 160.0, 50.0, 40.0, 350.0, 20.0, 50.0, 0.0, 120.0, 70.0, 0.0, 30.0, 180.0, 30.0, 10.0, 0.0, 10.0, 40.0, 20.0, 140.0, 20.0, 0.0, 110.0, 290.0, 70.0, 10.0, 180.0, 30.0, 70.0, 60.0, 140.0, 70.0, 0.0, 250.0, 600.0, 230.0, 35.0, 120.0, 110.0, 15.0, 70.0, 70.0, 30.0, 0.0, 190.0, 210.0, 30.0, -10.0, 0.0, 230.0, 130.0, 40.0, 40.0, 120.0, 520.0, 320.0, 130.0, 90.0, 80.0, 190.0, 210.0, 10.0, 10.0, 0.0, 30.0, 130.0, 0.0, 50.0, 50.0, 460.0, 20.0, 0.0, 310.0, 40.0, 90.0, 50.0, 80.0, 20.0, 80.0, 110.0, -5.0, 70.0, 40.0, 60.0, 10.0, 20.0, 90.0, 170.0, 50.0, 50.0, 20.0, 190.0, 170.0, 20.0, 10.0, 30.0, 90.0, 0.0, 10.0, 180.0, 80.0, 50.0, 10.0, 90.0, 100.0, 90.0, 310.0, 50.0, 200.0, 220.0, 0.0, 0.0, 180.0, 0.0, 50.0, 40.0, 60.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 90.0, 0.0, 190.0, 60.0, 180.0, 70.0, 150.0, 40.0, 10.0, 180.0, 60.0, 70.0, 260.0, 40.0, 60.0, 80.0, 90.0, 50.0, 160.0, -15.0, 110.0, 190.0, 30.0, 0.0, -40.0, 20.0, 80.0, 100.0, -5.0, -25.0, 40.0, 60.0, 90.0, 20.0, 210.0, 60.0, 50.0, 70.0, 80.0, 120.0, 130.0, 260.0, 380.0, 50.0, 30.0, 70.0, -40.0, 40.0, 20.0, 170.0, 90.0, 20.0, 140.0, 200.0, 15.0, 110.0, 170.0, 70.0, 190.0, 75.0, 50.0, 10.0, 250.0, 170.0, 30.0, 0.0, -40.0, 260.0, 170.0, -50.0, 40.0, 180.0, 30.0, 170.0, 150.0, 40.0, -50.0, 370.0, 90.0, 130.0, 80.0, 10.0, 60.0, 30.0, 10.0, 60.0, 10.0, 20.0, 0.0, 10.0, 130.0, -40.0, 130.0, 130.0, 60.0, 20.0, 60.0, 130.0, 500.0, 110.0, 60.0, 70.0, 170.0, 360.0, 110.0, 80.0, 170.0, 60.0, 60.0, 60.0, 30.0, 110.0, 370.0, 170.0, 110.0, 90.0, 20.0, 40.0, 120.0, 80.0, 150.0, 10.0, 10.0, 530.0, 70.0, 60.0, 400.0, 160.0, 170.0, 70.0, 40.0, 150.0, 40.0, 40.0, 200.0, 450.0, 0.0, 150.0, 10.0, 40.0, 70.0, 30.0, 10.0, 10.0, 220.0, 30.0, 0.0, 150.0, 250.0, 20.0, 150.0, 50.0, 170.0, 10.0, 100.0, 40.0, 10.0, 200.0, 70.0, 60.0, 70.0, 30.0, 80.0, 60.0, 30.0, 190.0, 70.0, 110.0, 35.0, 0.0, 260.0, 10.0, 30.0, 30.0, 270.0, 20.0, 80.0, 30.0, 20.0, 0.0, 170.0, 170.0, -40.0, -10.0, 30.0, 100.0, 60.0, 460.0, 80.0, 250.0, 300.0, 50.0, 90.0, 110.0, 90.0, 110.0, 200.0, -20.0, 500.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6994523502308754, "mean_inference_ms": 1.4925096946514356, "mean_action_processing_ms": 0.4364494278518521, "mean_env_wait_ms": 1.3556660343311422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01329493522644043, "StateBufferConnector_ms": 0.010623455047607422, "ViewRequirementAgentConnector_ms": 0.41562485694885254}, "num_episodes": 18, "episode_return_max": 1730.0, "episode_return_min": 260.0, "episode_return_mean": 943.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.02216023884378, "num_env_steps_trained_throughput_per_sec": 19.02216023884378, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 2360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2360000, "timers": {"training_iteration_time_ms": 209731.61, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209731.544, "sample_time_ms": 2898.746, "learn_time_ms": 206809.626, "learn_throughput": 19.341, "synch_weights_time_ms": 12.625}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "done": false, "training_iteration": 59, "trial_id": "aa996_00000", "date": "2024-05-24_02-10-23", "timestamp": 1716531023, "time_this_iter_s": 210.2888581752777, "time_total_s": 12290.325634002686, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ff430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12290.325634002686, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.90402684563758, "ram_util_percent": 78.90067114093961}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.560256404262254, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.494491350003325, "policy_loss": -0.0088528788861044, "vf_loss": 6.5019258270121485, "vf_explained_var": 0.001075053183288493, "kl": 0.007091971747675045, "entropy": 0.46478321211723983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 558705.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 1730.0, "episode_reward_min": 260.0, "episode_reward_mean": 928.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 92.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1410.0, 800.0, 910.0, 1060.0, 1730.0, 1010.0, 650.0, 450.0, 1015.0, 280.0, 620.0, 970.0, 755.0, 740.0, 1490.0, 1100.0, 1300.0, 950.0, 870.0, 710.0, 1290.0, 790.0, 1160.0, 1340.0, 1140.0, 910.0, 1480.0, 360.0, 1255.0, 1270.0, 440.0, 780.0, 400.0, 860.0, 490.0, 895.0, 540.0, 1090.0, 950.0, 1300.0, 1010.0, 970.0, 570.0, 955.0, 1530.0, 830.0, 980.0, 530.0, 620.0, 860.0, 460.0, 840.0, 1570.0, 820.0, 1660.0, 950.0, 800.0, 555.0, 720.0, 1200.0, 410.0, 260.0, 970.0, 855.0, 460.0, 800.0, 1110.0, 1080.0, 850.0, 1150.0, 290.0, 1230.0, 1200.0, 1140.0, 1630.0, 1120.0, 790.0, 860.0, 675.0, 750.0, 1270.0, 1550.0, 470.0, 1265.0, 1400.0, 810.0, 1115.0, 970.0, 990.0, 1270.0, 1050.0, 830.0, 680.0, 1420.0, 1220.0, 370.0, 1070.0, 475.0, 295.0, 710.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 140.0, 810.0, 70.0, 40.0, -20.0, 70.0, 110.0, 120.0, 70.0, 480.0, 60.0, 30.0, 40.0, 30.0, 100.0, 25.0, -5.0, -10.0, 50.0, 90.0, 30.0, 90.0, 250.0, -10.0, 230.0, 20.0, 100.0, 100.0, 10.0, 60.0, 50.0, 330.0, 90.0, 220.0, 140.0, -110.0, 50.0, 90.0, 140.0, 60.0, 80.0, 140.0, 120.0, 250.0, 210.0, 80.0, 550.0, 80.0, 160.0, 160.0, 10.0, -100.0, 100.0, 160.0, 40.0, 130.0, 400.0, 110.0, 0.0, 160.0, 0.0, 110.0, 40.0, 50.0, 10.0, 40.0, 60.0, 140.0, 40.0, 50.0, 110.0, 60.0, 0.0, 30.0, 60.0, 90.0, 0.0, -50.0, 100.0, 50.0, 5.0, 60.0, 290.0, 160.0, 100.0, 60.0, 20.0, 20.0, 250.0, 10.0, 20.0, 40.0, 0.0, 40.0, 50.0, 80.0, 0.0, 40.0, 0.0, 0.0, 40.0, 20.0, 30.0, 180.0, 160.0, 100.0, 30.0, 40.0, 20.0, 10.0, 40.0, 70.0, 330.0, 30.0, 20.0, 370.0, 10.0, -30.0, 120.0, 15.0, 10.0, 220.0, 20.0, 70.0, 110.0, 80.0, 100.0, 90.0, 40.0, 140.0, 30.0, 30.0, 150.0, 270.0, 10.0, 60.0, 10.0, 10.0, 30.0, 100.0, 40.0, 30.0, 80.0, 220.0, 180.0, 10.0, 130.0, 260.0, 440.0, 50.0, 20.0, 270.0, 150.0, 50.0, 90.0, 70.0, 210.0, 130.0, 60.0, 160.0, 70.0, 120.0, 160.0, 80.0, 120.0, 210.0, 130.0, 150.0, 100.0, 200.0, 60.0, 90.0, 0.0, 200.0, 50.0, 10.0, 90.0, 210.0, 40.0, -10.0, 30.0, 20.0, 170.0, 50.0, 40.0, 50.0, 30.0, 500.0, -10.0, 60.0, 20.0, 20.0, 60.0, 30.0, 180.0, 70.0, 20.0, 50.0, 200.0, 390.0, 50.0, 0.0, 90.0, 60.0, 50.0, 160.0, 0.0, 390.0, 100.0, 20.0, -10.0, 150.0, 170.0, 280.0, 10.0, 30.0, 40.0, 80.0, 20.0, 0.0, 80.0, 180.0, 70.0, 260.0, 290.0, 90.0, 100.0, 20.0, 70.0, 310.0, 220.0, 50.0, 190.0, 70.0, 100.0, 160.0, 140.0, 60.0, 40.0, 320.0, 80.0, 30.0, 70.0, 280.0, 20.0, 40.0, 170.0, 50.0, 80.0, 90.0, 310.0, 20.0, 50.0, 90.0, 30.0, 100.0, 90.0, -10.0, 140.0, 420.0, 220.0, 60.0, 90.0, 230.0, 30.0, 10.0, 370.0, 20.0, 30.0, 20.0, -20.0, 30.0, 0.0, 10.0, 100.0, 20.0, 80.0, 0.0, 120.0, 120.0, 170.0, 10.0, 100.0, 90.0, 220.0, 200.0, 70.0, 240.0, 35.0, -10.0, 190.0, 30.0, 60.0, 60.0, 300.0, 20.0, 530.0, 60.0, 30.0, 80.0, -10.0, 10.0, 30.0, 110.0, 80.0, 50.0, 20.0, 60.0, 10.0, 10.0, 130.0, 40.0, 40.0, 200.0, 110.0, 60.0, 50.0, 140.0, 0.0, 40.0, 50.0, 10.0, 20.0, 70.0, 20.0, 50.0, 90.0, 40.0, 10.0, 40.0, 20.0, 30.0, 50.0, 40.0, 60.0, 330.0, 190.0, 30.0, 70.0, 90.0, 70.0, 30.0, 0.0, 10.0, 30.0, 0.0, 150.0, 100.0, 10.0, 50.0, 90.0, 30.0, 25.0, 200.0, 40.0, 30.0, 170.0, 10.0, 250.0, 70.0, 80.0, 90.0, 0.0, 30.0, 50.0, 30.0, 80.0, 30.0, 80.0, 30.0, 70.0, 420.0, 130.0, 110.0, 90.0, 70.0, 30.0, 140.0, 0.0, 20.0, 0.0, 80.0, 270.0, 30.0, 270.0, 170.0, 0.0, 30.0, 80.0, 80.0, 320.0, 80.0, 20.0, 70.0, 30.0, 60.0, 410.0, 180.0, 50.0, 70.0, 20.0, 270.0, 80.0, 30.0, 10.0, 210.0, 50.0, 230.0, 40.0, 230.0, 10.0, 40.0, 170.0, 90.0, 120.0, 40.0, 60.0, 100.0, 110.0, 110.0, 20.0, 30.0, 80.0, 70.0, 60.0, 10.0, 60.0, 130.0, 0.0, 20.0, 180.0, 80.0, 80.0, -5.0, 420.0, 0.0, 100.0, 40.0, 40.0, 170.0, 240.0, 60.0, 150.0, 230.0, 60.0, 50.0, 80.0, 90.0, 400.0, 10.0, 0.0, 120.0, 200.0, 180.0, 80.0, 80.0, 80.0, 40.0, 40.0, 0.0, 40.0, 50.0, 40.0, 140.0, 80.0, 180.0, 270.0, 70.0, 110.0, 0.0, 10.0, 90.0, 30.0, 30.0, 130.0, 30.0, 0.0, 160.0, 50.0, 30.0, 0.0, 30.0, 100.0, 70.0, 40.0, 40.0, 260.0, 40.0, 10.0, 0.0, 160.0, 50.0, 40.0, 350.0, 20.0, 50.0, 0.0, 120.0, 70.0, 0.0, 30.0, 180.0, 30.0, 10.0, 0.0, 10.0, 40.0, 20.0, 140.0, 20.0, 0.0, 110.0, 290.0, 70.0, 10.0, 180.0, 30.0, 70.0, 60.0, 140.0, 70.0, 0.0, 250.0, 600.0, 230.0, 35.0, 120.0, 110.0, 15.0, 70.0, 70.0, 30.0, 0.0, 190.0, 210.0, 30.0, -10.0, 0.0, 230.0, 130.0, 40.0, 40.0, 120.0, 520.0, 320.0, 130.0, 90.0, 80.0, 190.0, 210.0, 10.0, 10.0, 0.0, 30.0, 130.0, 0.0, 50.0, 50.0, 460.0, 20.0, 0.0, 310.0, 40.0, 90.0, 50.0, 80.0, 20.0, 80.0, 110.0, -5.0, 70.0, 40.0, 60.0, 10.0, 20.0, 90.0, 170.0, 50.0, 50.0, 20.0, 190.0, 170.0, 20.0, 10.0, 30.0, 90.0, 0.0, 10.0, 180.0, 80.0, 50.0, 10.0, 90.0, 100.0, 90.0, 310.0, 50.0, 200.0, 220.0, 0.0, 0.0, 180.0, 0.0, 50.0, 40.0, 60.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 90.0, 0.0, 190.0, 60.0, 180.0, 70.0, 150.0, 40.0, 10.0, 180.0, 60.0, 70.0, 260.0, 40.0, 60.0, 80.0, 90.0, 50.0, 160.0, -15.0, 110.0, 190.0, 30.0, 0.0, -40.0, 20.0, 80.0, 100.0, -5.0, -25.0, 40.0, 60.0, 90.0, 20.0, 210.0, 60.0, 50.0, 70.0, 80.0, 120.0, 130.0, 260.0, 380.0, 50.0, 30.0, 70.0, -40.0, 40.0, 20.0, 170.0, 90.0, 20.0, 140.0, 200.0, 15.0, 110.0, 170.0, 70.0, 190.0, 75.0, 50.0, 10.0, 250.0, 170.0, 30.0, 0.0, -40.0, 260.0, 170.0, -50.0, 40.0, 180.0, 30.0, 170.0, 150.0, 40.0, -50.0, 370.0, 90.0, 130.0, 80.0, 10.0, 60.0, 30.0, 10.0, 60.0, 10.0, 20.0, 0.0, 10.0, 130.0, -40.0, 130.0, 130.0, 60.0, 20.0, 60.0, 130.0, 500.0, 110.0, 60.0, 70.0, 170.0, 360.0, 110.0, 80.0, 170.0, 60.0, 60.0, 60.0, 30.0, 110.0, 370.0, 170.0, 110.0, 90.0, 20.0, 40.0, 120.0, 80.0, 150.0, 10.0, 10.0, 530.0, 70.0, 60.0, 400.0, 160.0, 170.0, 70.0, 40.0, 150.0, 40.0, 40.0, 200.0, 450.0, 0.0, 150.0, 10.0, 40.0, 70.0, 30.0, 10.0, 10.0, 220.0, 30.0, 0.0, 150.0, 250.0, 20.0, 150.0, 50.0, 170.0, 10.0, 100.0, 40.0, 10.0, 200.0, 70.0, 60.0, 70.0, 30.0, 80.0, 60.0, 30.0, 190.0, 70.0, 110.0, 35.0, 0.0, 260.0, 10.0, 30.0, 30.0, 270.0, 20.0, 80.0, 30.0, 20.0, 0.0, 170.0, 170.0, -40.0, -10.0, 30.0, 100.0, 60.0, 460.0, 80.0, 250.0, 300.0, 50.0, 90.0, 110.0, 90.0, 110.0, 200.0, -20.0, 500.0, 120.0, 0.0, 20.0, 40.0, 90.0, 10.0, 90.0, 40.0, 70.0, 70.0, 40.0, 50.0, 165.0, 10.0, 80.0, 60.0, 110.0, 30.0, 330.0, 360.0, 70.0, 170.0, 380.0, 100.0, 10.0, 0.0, 230.0, 80.0, 50.0, 360.0, 20.0, -60.0, 260.0, 80.0, 0.0, 160.0, 120.0, 0.0, 140.0, 60.0, 50.0, 170.0, -85.0, 190.0, -10.0, 110.0, 80.0, 230.0, 80.0, 70.0, 280.0, 210.0, 80.0, 50.0, 10.0, 170.0, 70.0, 100.0, 30.0, 80.0, 170.0, 140.0, 40.0, 310.0, 190.0, 70.0, 40.0, 30.0, 30.0, 80.0, 60.0, 120.0, 60.0, 150.0, 260.0, 330.0, 80.0, 60.0, 130.0, -80.0, 160.0, 160.0, 210.0, 210.0, 20.0, 90.0, 0.0, 10.0, 210.0, 80.0, 60.0, 10.0, 30.0, 130.0, 210.0, -40.0, 100.0, 50.0, 310.0, 20.0, 10.0, 30.0, 20.0, 10.0, 40.0, -10.0, 0.0, 130.0, 0.0, 60.0, 400.0, 190.0, 340.0, 50.0, 120.0, 330.0, 70.0, 60.0, -10.0, 190.0, 80.0, 40.0, 150.0, 150.0, 60.0, 100.0, 390.0, -20.0, 20.0, 160.0, 170.0, 70.0, 10.0, 0.0, 80.0, 20.0, 80.0, 20.0, 30.0, 30.0, 30.0, 40.0, 40.0, 150.0, 180.0, 150.0, 90.0, 90.0, 170.0, 40.0, 120.0, 100.0, 20.0, 70.0, 0.0, 15.0, 60.0, 80.0, 40.0, 60.0, 30.0, 50.0, 25.0, 30.0, 0.0, 20.0, 10.0, 0.0, 90.0, 20.0, 50.0, 170.0, -80.0, 70.0, 80.0, 100.0, 40.0, 10.0, 100.0, 200.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6978554178391363, "mean_inference_ms": 1.49179788831613, "mean_action_processing_ms": 0.4359125386988001, "mean_env_wait_ms": 1.3548337192871946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013424873352050781, "StateBufferConnector_ms": 0.010712862014770508, "ViewRequirementAgentConnector_ms": 0.41829562187194824}, "num_episodes": 18, "episode_return_max": 1730.0, "episode_return_min": 260.0, "episode_return_mean": 928.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.162776016648905, "num_env_steps_trained_throughput_per_sec": 19.162776016648905, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 209043.013, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209042.947, "sample_time_ms": 2856.238, "learn_time_ms": 206164.675, "learn_throughput": 19.402, "synch_weights_time_ms": 11.61}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 60, "trial_id": "aa996_00000", "date": "2024-05-24_02-13-52", "timestamp": 1716531232, "time_this_iter_s": 208.7563979625702, "time_total_s": 12499.082031965256, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dba9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12499.082031965256, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 19.376610169491524, "ram_util_percent": 79.14033898305085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.605196978197819, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.38184533022717, "policy_loss": -0.0076407080441584395, "vf_loss": 6.388154652172004, "vf_explained_var": 0.0010217901489859064, "kl": 0.006656946225754693, "entropy": 0.48603348358751486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 568095.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 260.0, "episode_reward_mean": 888.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 88.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1160.0, 1340.0, 1140.0, 910.0, 1480.0, 360.0, 1255.0, 1270.0, 440.0, 780.0, 400.0, 860.0, 490.0, 895.0, 540.0, 1090.0, 950.0, 1300.0, 1010.0, 970.0, 570.0, 955.0, 1530.0, 830.0, 980.0, 530.0, 620.0, 860.0, 460.0, 840.0, 1570.0, 820.0, 1660.0, 950.0, 800.0, 555.0, 720.0, 1200.0, 410.0, 260.0, 970.0, 855.0, 460.0, 800.0, 1110.0, 1080.0, 850.0, 1150.0, 290.0, 1230.0, 1200.0, 1140.0, 1630.0, 1120.0, 790.0, 860.0, 675.0, 750.0, 1270.0, 1550.0, 470.0, 1265.0, 1400.0, 810.0, 1115.0, 970.0, 990.0, 1270.0, 1050.0, 830.0, 680.0, 1420.0, 1220.0, 370.0, 1070.0, 475.0, 295.0, 710.0, 925.0, 720.0, 730.0, 910.0, 550.0, 310.0, 430.0, 870.0, 830.0, 640.0, 680.0, 970.0, 880.0, 980.0, 730.0, 370.0, 800.0, 1240.0, 720.0, 1070.0, 960.0, 630.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 80.0, 180.0, 70.0, 260.0, 290.0, 90.0, 100.0, 20.0, 70.0, 310.0, 220.0, 50.0, 190.0, 70.0, 100.0, 160.0, 140.0, 60.0, 40.0, 320.0, 80.0, 30.0, 70.0, 280.0, 20.0, 40.0, 170.0, 50.0, 80.0, 90.0, 310.0, 20.0, 50.0, 90.0, 30.0, 100.0, 90.0, -10.0, 140.0, 420.0, 220.0, 60.0, 90.0, 230.0, 30.0, 10.0, 370.0, 20.0, 30.0, 20.0, -20.0, 30.0, 0.0, 10.0, 100.0, 20.0, 80.0, 0.0, 120.0, 120.0, 170.0, 10.0, 100.0, 90.0, 220.0, 200.0, 70.0, 240.0, 35.0, -10.0, 190.0, 30.0, 60.0, 60.0, 300.0, 20.0, 530.0, 60.0, 30.0, 80.0, -10.0, 10.0, 30.0, 110.0, 80.0, 50.0, 20.0, 60.0, 10.0, 10.0, 130.0, 40.0, 40.0, 200.0, 110.0, 60.0, 50.0, 140.0, 0.0, 40.0, 50.0, 10.0, 20.0, 70.0, 20.0, 50.0, 90.0, 40.0, 10.0, 40.0, 20.0, 30.0, 50.0, 40.0, 60.0, 330.0, 190.0, 30.0, 70.0, 90.0, 70.0, 30.0, 0.0, 10.0, 30.0, 0.0, 150.0, 100.0, 10.0, 50.0, 90.0, 30.0, 25.0, 200.0, 40.0, 30.0, 170.0, 10.0, 250.0, 70.0, 80.0, 90.0, 0.0, 30.0, 50.0, 30.0, 80.0, 30.0, 80.0, 30.0, 70.0, 420.0, 130.0, 110.0, 90.0, 70.0, 30.0, 140.0, 0.0, 20.0, 0.0, 80.0, 270.0, 30.0, 270.0, 170.0, 0.0, 30.0, 80.0, 80.0, 320.0, 80.0, 20.0, 70.0, 30.0, 60.0, 410.0, 180.0, 50.0, 70.0, 20.0, 270.0, 80.0, 30.0, 10.0, 210.0, 50.0, 230.0, 40.0, 230.0, 10.0, 40.0, 170.0, 90.0, 120.0, 40.0, 60.0, 100.0, 110.0, 110.0, 20.0, 30.0, 80.0, 70.0, 60.0, 10.0, 60.0, 130.0, 0.0, 20.0, 180.0, 80.0, 80.0, -5.0, 420.0, 0.0, 100.0, 40.0, 40.0, 170.0, 240.0, 60.0, 150.0, 230.0, 60.0, 50.0, 80.0, 90.0, 400.0, 10.0, 0.0, 120.0, 200.0, 180.0, 80.0, 80.0, 80.0, 40.0, 40.0, 0.0, 40.0, 50.0, 40.0, 140.0, 80.0, 180.0, 270.0, 70.0, 110.0, 0.0, 10.0, 90.0, 30.0, 30.0, 130.0, 30.0, 0.0, 160.0, 50.0, 30.0, 0.0, 30.0, 100.0, 70.0, 40.0, 40.0, 260.0, 40.0, 10.0, 0.0, 160.0, 50.0, 40.0, 350.0, 20.0, 50.0, 0.0, 120.0, 70.0, 0.0, 30.0, 180.0, 30.0, 10.0, 0.0, 10.0, 40.0, 20.0, 140.0, 20.0, 0.0, 110.0, 290.0, 70.0, 10.0, 180.0, 30.0, 70.0, 60.0, 140.0, 70.0, 0.0, 250.0, 600.0, 230.0, 35.0, 120.0, 110.0, 15.0, 70.0, 70.0, 30.0, 0.0, 190.0, 210.0, 30.0, -10.0, 0.0, 230.0, 130.0, 40.0, 40.0, 120.0, 520.0, 320.0, 130.0, 90.0, 80.0, 190.0, 210.0, 10.0, 10.0, 0.0, 30.0, 130.0, 0.0, 50.0, 50.0, 460.0, 20.0, 0.0, 310.0, 40.0, 90.0, 50.0, 80.0, 20.0, 80.0, 110.0, -5.0, 70.0, 40.0, 60.0, 10.0, 20.0, 90.0, 170.0, 50.0, 50.0, 20.0, 190.0, 170.0, 20.0, 10.0, 30.0, 90.0, 0.0, 10.0, 180.0, 80.0, 50.0, 10.0, 90.0, 100.0, 90.0, 310.0, 50.0, 200.0, 220.0, 0.0, 0.0, 180.0, 0.0, 50.0, 40.0, 60.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 90.0, 0.0, 190.0, 60.0, 180.0, 70.0, 150.0, 40.0, 10.0, 180.0, 60.0, 70.0, 260.0, 40.0, 60.0, 80.0, 90.0, 50.0, 160.0, -15.0, 110.0, 190.0, 30.0, 0.0, -40.0, 20.0, 80.0, 100.0, -5.0, -25.0, 40.0, 60.0, 90.0, 20.0, 210.0, 60.0, 50.0, 70.0, 80.0, 120.0, 130.0, 260.0, 380.0, 50.0, 30.0, 70.0, -40.0, 40.0, 20.0, 170.0, 90.0, 20.0, 140.0, 200.0, 15.0, 110.0, 170.0, 70.0, 190.0, 75.0, 50.0, 10.0, 250.0, 170.0, 30.0, 0.0, -40.0, 260.0, 170.0, -50.0, 40.0, 180.0, 30.0, 170.0, 150.0, 40.0, -50.0, 370.0, 90.0, 130.0, 80.0, 10.0, 60.0, 30.0, 10.0, 60.0, 10.0, 20.0, 0.0, 10.0, 130.0, -40.0, 130.0, 130.0, 60.0, 20.0, 60.0, 130.0, 500.0, 110.0, 60.0, 70.0, 170.0, 360.0, 110.0, 80.0, 170.0, 60.0, 60.0, 60.0, 30.0, 110.0, 370.0, 170.0, 110.0, 90.0, 20.0, 40.0, 120.0, 80.0, 150.0, 10.0, 10.0, 530.0, 70.0, 60.0, 400.0, 160.0, 170.0, 70.0, 40.0, 150.0, 40.0, 40.0, 200.0, 450.0, 0.0, 150.0, 10.0, 40.0, 70.0, 30.0, 10.0, 10.0, 220.0, 30.0, 0.0, 150.0, 250.0, 20.0, 150.0, 50.0, 170.0, 10.0, 100.0, 40.0, 10.0, 200.0, 70.0, 60.0, 70.0, 30.0, 80.0, 60.0, 30.0, 190.0, 70.0, 110.0, 35.0, 0.0, 260.0, 10.0, 30.0, 30.0, 270.0, 20.0, 80.0, 30.0, 20.0, 0.0, 170.0, 170.0, -40.0, -10.0, 30.0, 100.0, 60.0, 460.0, 80.0, 250.0, 300.0, 50.0, 90.0, 110.0, 90.0, 110.0, 200.0, -20.0, 500.0, 120.0, 0.0, 20.0, 40.0, 90.0, 10.0, 90.0, 40.0, 70.0, 70.0, 40.0, 50.0, 165.0, 10.0, 80.0, 60.0, 110.0, 30.0, 330.0, 360.0, 70.0, 170.0, 380.0, 100.0, 10.0, 0.0, 230.0, 80.0, 50.0, 360.0, 20.0, -60.0, 260.0, 80.0, 0.0, 160.0, 120.0, 0.0, 140.0, 60.0, 50.0, 170.0, -85.0, 190.0, -10.0, 110.0, 80.0, 230.0, 80.0, 70.0, 280.0, 210.0, 80.0, 50.0, 10.0, 170.0, 70.0, 100.0, 30.0, 80.0, 170.0, 140.0, 40.0, 310.0, 190.0, 70.0, 40.0, 30.0, 30.0, 80.0, 60.0, 120.0, 60.0, 150.0, 260.0, 330.0, 80.0, 60.0, 130.0, -80.0, 160.0, 160.0, 210.0, 210.0, 20.0, 90.0, 0.0, 10.0, 210.0, 80.0, 60.0, 10.0, 30.0, 130.0, 210.0, -40.0, 100.0, 50.0, 310.0, 20.0, 10.0, 30.0, 20.0, 10.0, 40.0, -10.0, 0.0, 130.0, 0.0, 60.0, 400.0, 190.0, 340.0, 50.0, 120.0, 330.0, 70.0, 60.0, -10.0, 190.0, 80.0, 40.0, 150.0, 150.0, 60.0, 100.0, 390.0, -20.0, 20.0, 160.0, 170.0, 70.0, 10.0, 0.0, 80.0, 20.0, 80.0, 20.0, 30.0, 30.0, 30.0, 40.0, 40.0, 150.0, 180.0, 150.0, 90.0, 90.0, 170.0, 40.0, 120.0, 100.0, 20.0, 70.0, 0.0, 15.0, 60.0, 80.0, 40.0, 60.0, 30.0, 50.0, 25.0, 30.0, 0.0, 20.0, 10.0, 0.0, 90.0, 20.0, 50.0, 170.0, -80.0, 70.0, 80.0, 100.0, 40.0, 10.0, 100.0, 200.0, 20.0, 70.0, 40.0, 90.0, 195.0, 0.0, 30.0, 260.0, 10.0, 30.0, 200.0, 140.0, 190.0, 30.0, 90.0, 40.0, 30.0, 20.0, 40.0, 10.0, 130.0, 10.0, 0.0, 70.0, 160.0, 170.0, 150.0, 50.0, -10.0, 60.0, 70.0, 70.0, 40.0, 80.0, 130.0, 150.0, 30.0, 40.0, 230.0, 70.0, 70.0, 80.0, 40.0, 110.0, 60.0, 60.0, 50.0, 60.0, 0.0, 70.0, 20.0, 20.0, 20.0, 0.0, 10.0, 10.0, 50.0, 30.0, 0.0, 140.0, 30.0, 0.0, 10.0, 10.0, 10.0, 40.0, 40.0, 30.0, 240.0, 50.0, 0.0, 70.0, 140.0, 120.0, 90.0, 100.0, 80.0, 90.0, 50.0, 60.0, 70.0, 130.0, 150.0, 90.0, 90.0, 20.0, 0.0, 140.0, 40.0, 90.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 90.0, 150.0, 180.0, 80.0, 20.0, 100.0, 160.0, 30.0, 30.0, 20.0, 40.0, 30.0, 70.0, 200.0, 0.0, 420.0, 40.0, 0.0, 60.0, 150.0, 160.0, 40.0, 90.0, 20.0, -10.0, 20.0, 80.0, 180.0, 300.0, 40.0, 10.0, 90.0, 0.0, 120.0, 40.0, -30.0, 250.0, 360.0, -10.0, 30.0, 160.0, -40.0, 130.0, 110.0, 20.0, 30.0, 0.0, 70.0, 150.0, 80.0, 90.0, 90.0, 40.0, 30.0, 150.0, 20.0, 20.0, 190.0, 0.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 80.0, 30.0, 20.0, 30.0, 10.0, 420.0, 40.0, 90.0, 30.0, 140.0, 60.0, 120.0, 40.0, 30.0, 190.0, 60.0, 200.0, 260.0, 140.0, 30.0, 20.0, 40.0, 20.0, 20.0, 30.0, 370.0, 170.0, -20.0, 40.0, 410.0, 80.0, 60.0, 40.0, 90.0, 20.0, 50.0, 140.0, 100.0, 80.0, 70.0, 130.0, 0.0, -30.0, 190.0, 40.0, 100.0, 60.0, 20.0, 380.0, 90.0, 30.0, 210.0, 130.0, 0.0, -60.0, 270.0, 40.0, -80.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.697313705958727, "mean_inference_ms": 1.4922950112798292, "mean_action_processing_ms": 0.43551197952131787, "mean_env_wait_ms": 1.3530179270677383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013438224792480469, "StateBufferConnector_ms": 0.010338544845581055, "ViewRequirementAgentConnector_ms": 0.4209601879119873}, "num_episodes": 22, "episode_return_max": 1660.0, "episode_return_min": 260.0, "episode_return_mean": 888.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.263951381788473, "num_env_steps_trained_throughput_per_sec": 19.263951381788473, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 2440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2440000, "timers": {"training_iteration_time_ms": 208765.022, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208764.956, "sample_time_ms": 2791.222, "learn_time_ms": 205951.61, "learn_throughput": 19.422, "synch_weights_time_ms": 11.659}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "done": false, "training_iteration": 61, "trial_id": "aa996_00000", "date": "2024-05-24_02-17-19", "timestamp": 1716531439, "time_this_iter_s": 207.64859580993652, "time_total_s": 12706.730627775192, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ff160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12706.730627775192, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 19.132423208191128, "ram_util_percent": 78.99829351535836}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3933853950998145, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.169445900972913, "policy_loss": -0.008270474149648663, "vf_loss": 7.176486367945727, "vf_explained_var": 0.000756610436434436, "kl": 0.006150026906038205, "entropy": 0.4448650691932002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 577485.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 260.0, "episode_reward_mean": 911.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 620.0}, "policy_reward_mean": {"policy_0": 91.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1010.0, 970.0, 570.0, 955.0, 1530.0, 830.0, 980.0, 530.0, 620.0, 860.0, 460.0, 840.0, 1570.0, 820.0, 1660.0, 950.0, 800.0, 555.0, 720.0, 1200.0, 410.0, 260.0, 970.0, 855.0, 460.0, 800.0, 1110.0, 1080.0, 850.0, 1150.0, 290.0, 1230.0, 1200.0, 1140.0, 1630.0, 1120.0, 790.0, 860.0, 675.0, 750.0, 1270.0, 1550.0, 470.0, 1265.0, 1400.0, 810.0, 1115.0, 970.0, 990.0, 1270.0, 1050.0, 830.0, 680.0, 1420.0, 1220.0, 370.0, 1070.0, 475.0, 295.0, 710.0, 925.0, 720.0, 730.0, 910.0, 550.0, 310.0, 430.0, 870.0, 830.0, 640.0, 680.0, 970.0, 880.0, 980.0, 730.0, 370.0, 800.0, 1240.0, 720.0, 1070.0, 960.0, 630.0, 510.0, 1240.0, 1210.0, 720.0, 1150.0, 1640.0, 1220.0, 1790.0, 1040.0, 1010.0, 720.0, 940.0, 1080.0, 1180.0, 1150.0, 645.0, 1010.0, 630.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 20.0, 270.0, 80.0, 30.0, 10.0, 210.0, 50.0, 230.0, 40.0, 230.0, 10.0, 40.0, 170.0, 90.0, 120.0, 40.0, 60.0, 100.0, 110.0, 110.0, 20.0, 30.0, 80.0, 70.0, 60.0, 10.0, 60.0, 130.0, 0.0, 20.0, 180.0, 80.0, 80.0, -5.0, 420.0, 0.0, 100.0, 40.0, 40.0, 170.0, 240.0, 60.0, 150.0, 230.0, 60.0, 50.0, 80.0, 90.0, 400.0, 10.0, 0.0, 120.0, 200.0, 180.0, 80.0, 80.0, 80.0, 40.0, 40.0, 0.0, 40.0, 50.0, 40.0, 140.0, 80.0, 180.0, 270.0, 70.0, 110.0, 0.0, 10.0, 90.0, 30.0, 30.0, 130.0, 30.0, 0.0, 160.0, 50.0, 30.0, 0.0, 30.0, 100.0, 70.0, 40.0, 40.0, 260.0, 40.0, 10.0, 0.0, 160.0, 50.0, 40.0, 350.0, 20.0, 50.0, 0.0, 120.0, 70.0, 0.0, 30.0, 180.0, 30.0, 10.0, 0.0, 10.0, 40.0, 20.0, 140.0, 20.0, 0.0, 110.0, 290.0, 70.0, 10.0, 180.0, 30.0, 70.0, 60.0, 140.0, 70.0, 0.0, 250.0, 600.0, 230.0, 35.0, 120.0, 110.0, 15.0, 70.0, 70.0, 30.0, 0.0, 190.0, 210.0, 30.0, -10.0, 0.0, 230.0, 130.0, 40.0, 40.0, 120.0, 520.0, 320.0, 130.0, 90.0, 80.0, 190.0, 210.0, 10.0, 10.0, 0.0, 30.0, 130.0, 0.0, 50.0, 50.0, 460.0, 20.0, 0.0, 310.0, 40.0, 90.0, 50.0, 80.0, 20.0, 80.0, 110.0, -5.0, 70.0, 40.0, 60.0, 10.0, 20.0, 90.0, 170.0, 50.0, 50.0, 20.0, 190.0, 170.0, 20.0, 10.0, 30.0, 90.0, 0.0, 10.0, 180.0, 80.0, 50.0, 10.0, 90.0, 100.0, 90.0, 310.0, 50.0, 200.0, 220.0, 0.0, 0.0, 180.0, 0.0, 50.0, 40.0, 60.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 90.0, 0.0, 190.0, 60.0, 180.0, 70.0, 150.0, 40.0, 10.0, 180.0, 60.0, 70.0, 260.0, 40.0, 60.0, 80.0, 90.0, 50.0, 160.0, -15.0, 110.0, 190.0, 30.0, 0.0, -40.0, 20.0, 80.0, 100.0, -5.0, -25.0, 40.0, 60.0, 90.0, 20.0, 210.0, 60.0, 50.0, 70.0, 80.0, 120.0, 130.0, 260.0, 380.0, 50.0, 30.0, 70.0, -40.0, 40.0, 20.0, 170.0, 90.0, 20.0, 140.0, 200.0, 15.0, 110.0, 170.0, 70.0, 190.0, 75.0, 50.0, 10.0, 250.0, 170.0, 30.0, 0.0, -40.0, 260.0, 170.0, -50.0, 40.0, 180.0, 30.0, 170.0, 150.0, 40.0, -50.0, 370.0, 90.0, 130.0, 80.0, 10.0, 60.0, 30.0, 10.0, 60.0, 10.0, 20.0, 0.0, 10.0, 130.0, -40.0, 130.0, 130.0, 60.0, 20.0, 60.0, 130.0, 500.0, 110.0, 60.0, 70.0, 170.0, 360.0, 110.0, 80.0, 170.0, 60.0, 60.0, 60.0, 30.0, 110.0, 370.0, 170.0, 110.0, 90.0, 20.0, 40.0, 120.0, 80.0, 150.0, 10.0, 10.0, 530.0, 70.0, 60.0, 400.0, 160.0, 170.0, 70.0, 40.0, 150.0, 40.0, 40.0, 200.0, 450.0, 0.0, 150.0, 10.0, 40.0, 70.0, 30.0, 10.0, 10.0, 220.0, 30.0, 0.0, 150.0, 250.0, 20.0, 150.0, 50.0, 170.0, 10.0, 100.0, 40.0, 10.0, 200.0, 70.0, 60.0, 70.0, 30.0, 80.0, 60.0, 30.0, 190.0, 70.0, 110.0, 35.0, 0.0, 260.0, 10.0, 30.0, 30.0, 270.0, 20.0, 80.0, 30.0, 20.0, 0.0, 170.0, 170.0, -40.0, -10.0, 30.0, 100.0, 60.0, 460.0, 80.0, 250.0, 300.0, 50.0, 90.0, 110.0, 90.0, 110.0, 200.0, -20.0, 500.0, 120.0, 0.0, 20.0, 40.0, 90.0, 10.0, 90.0, 40.0, 70.0, 70.0, 40.0, 50.0, 165.0, 10.0, 80.0, 60.0, 110.0, 30.0, 330.0, 360.0, 70.0, 170.0, 380.0, 100.0, 10.0, 0.0, 230.0, 80.0, 50.0, 360.0, 20.0, -60.0, 260.0, 80.0, 0.0, 160.0, 120.0, 0.0, 140.0, 60.0, 50.0, 170.0, -85.0, 190.0, -10.0, 110.0, 80.0, 230.0, 80.0, 70.0, 280.0, 210.0, 80.0, 50.0, 10.0, 170.0, 70.0, 100.0, 30.0, 80.0, 170.0, 140.0, 40.0, 310.0, 190.0, 70.0, 40.0, 30.0, 30.0, 80.0, 60.0, 120.0, 60.0, 150.0, 260.0, 330.0, 80.0, 60.0, 130.0, -80.0, 160.0, 160.0, 210.0, 210.0, 20.0, 90.0, 0.0, 10.0, 210.0, 80.0, 60.0, 10.0, 30.0, 130.0, 210.0, -40.0, 100.0, 50.0, 310.0, 20.0, 10.0, 30.0, 20.0, 10.0, 40.0, -10.0, 0.0, 130.0, 0.0, 60.0, 400.0, 190.0, 340.0, 50.0, 120.0, 330.0, 70.0, 60.0, -10.0, 190.0, 80.0, 40.0, 150.0, 150.0, 60.0, 100.0, 390.0, -20.0, 20.0, 160.0, 170.0, 70.0, 10.0, 0.0, 80.0, 20.0, 80.0, 20.0, 30.0, 30.0, 30.0, 40.0, 40.0, 150.0, 180.0, 150.0, 90.0, 90.0, 170.0, 40.0, 120.0, 100.0, 20.0, 70.0, 0.0, 15.0, 60.0, 80.0, 40.0, 60.0, 30.0, 50.0, 25.0, 30.0, 0.0, 20.0, 10.0, 0.0, 90.0, 20.0, 50.0, 170.0, -80.0, 70.0, 80.0, 100.0, 40.0, 10.0, 100.0, 200.0, 20.0, 70.0, 40.0, 90.0, 195.0, 0.0, 30.0, 260.0, 10.0, 30.0, 200.0, 140.0, 190.0, 30.0, 90.0, 40.0, 30.0, 20.0, 40.0, 10.0, 130.0, 10.0, 0.0, 70.0, 160.0, 170.0, 150.0, 50.0, -10.0, 60.0, 70.0, 70.0, 40.0, 80.0, 130.0, 150.0, 30.0, 40.0, 230.0, 70.0, 70.0, 80.0, 40.0, 110.0, 60.0, 60.0, 50.0, 60.0, 0.0, 70.0, 20.0, 20.0, 20.0, 0.0, 10.0, 10.0, 50.0, 30.0, 0.0, 140.0, 30.0, 0.0, 10.0, 10.0, 10.0, 40.0, 40.0, 30.0, 240.0, 50.0, 0.0, 70.0, 140.0, 120.0, 90.0, 100.0, 80.0, 90.0, 50.0, 60.0, 70.0, 130.0, 150.0, 90.0, 90.0, 20.0, 0.0, 140.0, 40.0, 90.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 90.0, 150.0, 180.0, 80.0, 20.0, 100.0, 160.0, 30.0, 30.0, 20.0, 40.0, 30.0, 70.0, 200.0, 0.0, 420.0, 40.0, 0.0, 60.0, 150.0, 160.0, 40.0, 90.0, 20.0, -10.0, 20.0, 80.0, 180.0, 300.0, 40.0, 10.0, 90.0, 0.0, 120.0, 40.0, -30.0, 250.0, 360.0, -10.0, 30.0, 160.0, -40.0, 130.0, 110.0, 20.0, 30.0, 0.0, 70.0, 150.0, 80.0, 90.0, 90.0, 40.0, 30.0, 150.0, 20.0, 20.0, 190.0, 0.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 80.0, 30.0, 20.0, 30.0, 10.0, 420.0, 40.0, 90.0, 30.0, 140.0, 60.0, 120.0, 40.0, 30.0, 190.0, 60.0, 200.0, 260.0, 140.0, 30.0, 20.0, 40.0, 20.0, 20.0, 30.0, 370.0, 170.0, -20.0, 40.0, 410.0, 80.0, 60.0, 40.0, 90.0, 20.0, 50.0, 140.0, 100.0, 80.0, 70.0, 130.0, 0.0, -30.0, 190.0, 40.0, 100.0, 60.0, 20.0, 380.0, 90.0, 30.0, 210.0, 130.0, 0.0, -60.0, 270.0, 40.0, -80.0, 0.0, 0.0, 20.0, 220.0, -70.0, 10.0, 30.0, 190.0, 20.0, 90.0, 0.0, 230.0, 130.0, 90.0, 220.0, 130.0, 220.0, 20.0, 120.0, 50.0, 30.0, 190.0, 150.0, 20.0, 280.0, -10.0, 40.0, 60.0, 40.0, 250.0, 190.0, 50.0, -5.0, 20.0, -10.0, 310.0, 50.0, 160.0, 80.0, 60.0, 5.0, 60.0, 40.0, 560.0, 210.0, 90.0, 40.0, 80.0, 60.0, 10.0, 0.0, 120.0, 260.0, 310.0, 30.0, 150.0, 130.0, 340.0, 180.0, 30.0, 90.0, 60.0, 40.0, 230.0, 280.0, 10.0, 30.0, 110.0, 60.0, 260.0, 140.0, 120.0, 30.0, 60.0, 60.0, 170.0, 340.0, 610.0, 250.0, 80.0, 70.0, 50.0, 10.0, 20.0, -10.0, 0.0, 40.0, 170.0, 560.0, 200.0, 0.0, 70.0, 70.0, 30.0, 80.0, 70.0, 180.0, 90.0, 160.0, 210.0, 50.0, 40.0, 0.0, 160.0, 30.0, 180.0, 30.0, 20.0, 210.0, 30.0, 20.0, 110.0, 240.0, 50.0, 110.0, 40.0, 20.0, 200.0, 40.0, 30.0, 100.0, 60.0, 170.0, 40.0, 180.0, 60.0, 70.0, 50.0, 130.0, 210.0, 110.0, 20.0, 40.0, 80.0, 210.0, 620.0, 130.0, 40.0, 60.0, 0.0, -20.0, 140.0, 190.0, 90.0, 110.0, 20.0, 120.0, 170.0, 260.0, 50.0, 0.0, 0.0, 10.0, 10.0, 100.0, 15.0, 190.0, 0.0, 190.0, 100.0, 30.0, 0.0, 360.0, 290.0, -20.0, 60.0, 30.0, 30.0, 150.0, 40.0, 70.0, -95.0, 50.0, 60.0, 170.0, 0.0, 605.0, 20.0, -110.0, 20.0, -90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6948629732969724, "mean_inference_ms": 1.490834079041763, "mean_action_processing_ms": 0.43487379600604625, "mean_env_wait_ms": 1.3535599854427673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013230562210083008, "StateBufferConnector_ms": 0.009798288345336914, "ViewRequirementAgentConnector_ms": 0.3983185291290283}, "num_episodes": 18, "episode_return_max": 1790.0, "episode_return_min": 260.0, "episode_return_mean": 911.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.076167269456278, "num_env_steps_trained_throughput_per_sec": 19.076167269456278, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 208838.273, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208838.208, "sample_time_ms": 2731.424, "learn_time_ms": 206084.509, "learn_throughput": 19.41, "synch_weights_time_ms": 11.751}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 62, "trial_id": "aa996_00000", "date": "2024-05-24_02-20-49", "timestamp": 1716531649, "time_this_iter_s": 209.6944317817688, "time_total_s": 12916.425059556961, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332db7ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12916.425059556961, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 19.35791245791246, "ram_util_percent": 79.56262626262625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4707488775443727, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.747033599898203, "policy_loss": -0.007568081976876607, "vf_loss": 6.753316262938852, "vf_explained_var": 3.570436288754399e-05, "kl": 0.006427082750336359, "entropy": 0.4364161666208944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 586875.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "env_runners": {"episode_reward_max": 2120.0, "episode_reward_min": 190.0, "episode_reward_mean": 913.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -365.0}, "policy_reward_max": {"policy_0": 900.0}, "policy_reward_mean": {"policy_0": 91.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [855.0, 460.0, 800.0, 1110.0, 1080.0, 850.0, 1150.0, 290.0, 1230.0, 1200.0, 1140.0, 1630.0, 1120.0, 790.0, 860.0, 675.0, 750.0, 1270.0, 1550.0, 470.0, 1265.0, 1400.0, 810.0, 1115.0, 970.0, 990.0, 1270.0, 1050.0, 830.0, 680.0, 1420.0, 1220.0, 370.0, 1070.0, 475.0, 295.0, 710.0, 925.0, 720.0, 730.0, 910.0, 550.0, 310.0, 430.0, 870.0, 830.0, 640.0, 680.0, 970.0, 880.0, 980.0, 730.0, 370.0, 800.0, 1240.0, 720.0, 1070.0, 960.0, 630.0, 510.0, 1240.0, 1210.0, 720.0, 1150.0, 1640.0, 1220.0, 1790.0, 1040.0, 1010.0, 720.0, 940.0, 1080.0, 1180.0, 1150.0, 645.0, 1010.0, 630.0, 2120.0, 1235.0, 800.0, 600.0, 665.0, 800.0, 575.0, 550.0, 960.0, 510.0, 950.0, 370.0, 1270.0, 440.0, 190.0, 750.0, 890.0, 1100.0, 1040.0, 980.0, 1520.0, 890.0, 1110.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 70.0, 260.0, 40.0, 60.0, 80.0, 90.0, 50.0, 160.0, -15.0, 110.0, 190.0, 30.0, 0.0, -40.0, 20.0, 80.0, 100.0, -5.0, -25.0, 40.0, 60.0, 90.0, 20.0, 210.0, 60.0, 50.0, 70.0, 80.0, 120.0, 130.0, 260.0, 380.0, 50.0, 30.0, 70.0, -40.0, 40.0, 20.0, 170.0, 90.0, 20.0, 140.0, 200.0, 15.0, 110.0, 170.0, 70.0, 190.0, 75.0, 50.0, 10.0, 250.0, 170.0, 30.0, 0.0, -40.0, 260.0, 170.0, -50.0, 40.0, 180.0, 30.0, 170.0, 150.0, 40.0, -50.0, 370.0, 90.0, 130.0, 80.0, 10.0, 60.0, 30.0, 10.0, 60.0, 10.0, 20.0, 0.0, 10.0, 130.0, -40.0, 130.0, 130.0, 60.0, 20.0, 60.0, 130.0, 500.0, 110.0, 60.0, 70.0, 170.0, 360.0, 110.0, 80.0, 170.0, 60.0, 60.0, 60.0, 30.0, 110.0, 370.0, 170.0, 110.0, 90.0, 20.0, 40.0, 120.0, 80.0, 150.0, 10.0, 10.0, 530.0, 70.0, 60.0, 400.0, 160.0, 170.0, 70.0, 40.0, 150.0, 40.0, 40.0, 200.0, 450.0, 0.0, 150.0, 10.0, 40.0, 70.0, 30.0, 10.0, 10.0, 220.0, 30.0, 0.0, 150.0, 250.0, 20.0, 150.0, 50.0, 170.0, 10.0, 100.0, 40.0, 10.0, 200.0, 70.0, 60.0, 70.0, 30.0, 80.0, 60.0, 30.0, 190.0, 70.0, 110.0, 35.0, 0.0, 260.0, 10.0, 30.0, 30.0, 270.0, 20.0, 80.0, 30.0, 20.0, 0.0, 170.0, 170.0, -40.0, -10.0, 30.0, 100.0, 60.0, 460.0, 80.0, 250.0, 300.0, 50.0, 90.0, 110.0, 90.0, 110.0, 200.0, -20.0, 500.0, 120.0, 0.0, 20.0, 40.0, 90.0, 10.0, 90.0, 40.0, 70.0, 70.0, 40.0, 50.0, 165.0, 10.0, 80.0, 60.0, 110.0, 30.0, 330.0, 360.0, 70.0, 170.0, 380.0, 100.0, 10.0, 0.0, 230.0, 80.0, 50.0, 360.0, 20.0, -60.0, 260.0, 80.0, 0.0, 160.0, 120.0, 0.0, 140.0, 60.0, 50.0, 170.0, -85.0, 190.0, -10.0, 110.0, 80.0, 230.0, 80.0, 70.0, 280.0, 210.0, 80.0, 50.0, 10.0, 170.0, 70.0, 100.0, 30.0, 80.0, 170.0, 140.0, 40.0, 310.0, 190.0, 70.0, 40.0, 30.0, 30.0, 80.0, 60.0, 120.0, 60.0, 150.0, 260.0, 330.0, 80.0, 60.0, 130.0, -80.0, 160.0, 160.0, 210.0, 210.0, 20.0, 90.0, 0.0, 10.0, 210.0, 80.0, 60.0, 10.0, 30.0, 130.0, 210.0, -40.0, 100.0, 50.0, 310.0, 20.0, 10.0, 30.0, 20.0, 10.0, 40.0, -10.0, 0.0, 130.0, 0.0, 60.0, 400.0, 190.0, 340.0, 50.0, 120.0, 330.0, 70.0, 60.0, -10.0, 190.0, 80.0, 40.0, 150.0, 150.0, 60.0, 100.0, 390.0, -20.0, 20.0, 160.0, 170.0, 70.0, 10.0, 0.0, 80.0, 20.0, 80.0, 20.0, 30.0, 30.0, 30.0, 40.0, 40.0, 150.0, 180.0, 150.0, 90.0, 90.0, 170.0, 40.0, 120.0, 100.0, 20.0, 70.0, 0.0, 15.0, 60.0, 80.0, 40.0, 60.0, 30.0, 50.0, 25.0, 30.0, 0.0, 20.0, 10.0, 0.0, 90.0, 20.0, 50.0, 170.0, -80.0, 70.0, 80.0, 100.0, 40.0, 10.0, 100.0, 200.0, 20.0, 70.0, 40.0, 90.0, 195.0, 0.0, 30.0, 260.0, 10.0, 30.0, 200.0, 140.0, 190.0, 30.0, 90.0, 40.0, 30.0, 20.0, 40.0, 10.0, 130.0, 10.0, 0.0, 70.0, 160.0, 170.0, 150.0, 50.0, -10.0, 60.0, 70.0, 70.0, 40.0, 80.0, 130.0, 150.0, 30.0, 40.0, 230.0, 70.0, 70.0, 80.0, 40.0, 110.0, 60.0, 60.0, 50.0, 60.0, 0.0, 70.0, 20.0, 20.0, 20.0, 0.0, 10.0, 10.0, 50.0, 30.0, 0.0, 140.0, 30.0, 0.0, 10.0, 10.0, 10.0, 40.0, 40.0, 30.0, 240.0, 50.0, 0.0, 70.0, 140.0, 120.0, 90.0, 100.0, 80.0, 90.0, 50.0, 60.0, 70.0, 130.0, 150.0, 90.0, 90.0, 20.0, 0.0, 140.0, 40.0, 90.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 90.0, 150.0, 180.0, 80.0, 20.0, 100.0, 160.0, 30.0, 30.0, 20.0, 40.0, 30.0, 70.0, 200.0, 0.0, 420.0, 40.0, 0.0, 60.0, 150.0, 160.0, 40.0, 90.0, 20.0, -10.0, 20.0, 80.0, 180.0, 300.0, 40.0, 10.0, 90.0, 0.0, 120.0, 40.0, -30.0, 250.0, 360.0, -10.0, 30.0, 160.0, -40.0, 130.0, 110.0, 20.0, 30.0, 0.0, 70.0, 150.0, 80.0, 90.0, 90.0, 40.0, 30.0, 150.0, 20.0, 20.0, 190.0, 0.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 80.0, 30.0, 20.0, 30.0, 10.0, 420.0, 40.0, 90.0, 30.0, 140.0, 60.0, 120.0, 40.0, 30.0, 190.0, 60.0, 200.0, 260.0, 140.0, 30.0, 20.0, 40.0, 20.0, 20.0, 30.0, 370.0, 170.0, -20.0, 40.0, 410.0, 80.0, 60.0, 40.0, 90.0, 20.0, 50.0, 140.0, 100.0, 80.0, 70.0, 130.0, 0.0, -30.0, 190.0, 40.0, 100.0, 60.0, 20.0, 380.0, 90.0, 30.0, 210.0, 130.0, 0.0, -60.0, 270.0, 40.0, -80.0, 0.0, 0.0, 20.0, 220.0, -70.0, 10.0, 30.0, 190.0, 20.0, 90.0, 0.0, 230.0, 130.0, 90.0, 220.0, 130.0, 220.0, 20.0, 120.0, 50.0, 30.0, 190.0, 150.0, 20.0, 280.0, -10.0, 40.0, 60.0, 40.0, 250.0, 190.0, 50.0, -5.0, 20.0, -10.0, 310.0, 50.0, 160.0, 80.0, 60.0, 5.0, 60.0, 40.0, 560.0, 210.0, 90.0, 40.0, 80.0, 60.0, 10.0, 0.0, 120.0, 260.0, 310.0, 30.0, 150.0, 130.0, 340.0, 180.0, 30.0, 90.0, 60.0, 40.0, 230.0, 280.0, 10.0, 30.0, 110.0, 60.0, 260.0, 140.0, 120.0, 30.0, 60.0, 60.0, 170.0, 340.0, 610.0, 250.0, 80.0, 70.0, 50.0, 10.0, 20.0, -10.0, 0.0, 40.0, 170.0, 560.0, 200.0, 0.0, 70.0, 70.0, 30.0, 80.0, 70.0, 180.0, 90.0, 160.0, 210.0, 50.0, 40.0, 0.0, 160.0, 30.0, 180.0, 30.0, 20.0, 210.0, 30.0, 20.0, 110.0, 240.0, 50.0, 110.0, 40.0, 20.0, 200.0, 40.0, 30.0, 100.0, 60.0, 170.0, 40.0, 180.0, 60.0, 70.0, 50.0, 130.0, 210.0, 110.0, 20.0, 40.0, 80.0, 210.0, 620.0, 130.0, 40.0, 60.0, 0.0, -20.0, 140.0, 190.0, 90.0, 110.0, 20.0, 120.0, 170.0, 260.0, 50.0, 0.0, 0.0, 10.0, 10.0, 100.0, 15.0, 190.0, 0.0, 190.0, 100.0, 30.0, 0.0, 360.0, 290.0, -20.0, 60.0, 30.0, 30.0, 150.0, 40.0, 70.0, -95.0, 50.0, 60.0, 170.0, 0.0, 605.0, 20.0, -110.0, 20.0, -90.0, 100.0, 300.0, 370.0, 60.0, 100.0, 0.0, 150.0, 40.0, 100.0, 900.0, 460.0, 320.0, 65.0, 80.0, 20.0, 190.0, 20.0, 90.0, -50.0, 40.0, 110.0, 40.0, -365.0, 50.0, 530.0, -55.0, 130.0, 110.0, 50.0, 200.0, 110.0, 180.0, -5.0, 10.0, -325.0, 290.0, 140.0, 60.0, -50.0, 190.0, 15.0, 60.0, 60.0, 20.0, 30.0, 90.0, 280.0, 10.0, 40.0, 60.0, 150.0, 0.0, 10.0, 180.0, 100.0, 40.0, 40.0, 220.0, 30.0, 30.0, 80.0, 40.0, 0.0, 130.0, 15.0, 40.0, 160.0, 30.0, 40.0, 40.0, 150.0, 80.0, 60.0, 30.0, 80.0, 10.0, 20.0, 40.0, 60.0, 20.0, 200.0, 60.0, 110.0, 210.0, 50.0, 130.0, 20.0, 60.0, 100.0, 20.0, 30.0, 100.0, 180.0, 30.0, 0.0, 40.0, 50.0, 30.0, 0.0, 50.0, 80.0, 40.0, 10.0, 60.0, 460.0, 180.0, 40.0, 110.0, -250.0, 220.0, 50.0, 0.0, 0.0, 100.0, 0.0, 130.0, 20.0, 50.0, 20.0, 0.0, 160.0, 40.0, 60.0, 120.0, 510.0, 40.0, 80.0, 0.0, 170.0, 90.0, 160.0, 0.0, 90.0, 50.0, 0.0, 10.0, 120.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 10.0, 30.0, 300.0, 20.0, 90.0, 50.0, 90.0, 60.0, 30.0, 20.0, 10.0, 80.0, 40.0, 30.0, 20.0, 40.0, 500.0, 100.0, -90.0, 50.0, 90.0, 110.0, 60.0, 80.0, 300.0, 180.0, 80.0, 120.0, 80.0, 30.0, 110.0, 60.0, 40.0, 10.0, 20.0, 80.0, 70.0, 250.0, 260.0, 90.0, 180.0, 40.0, 190.0, -50.0, 290.0, -40.0, 670.0, 0.0, -40.0, -100.0, 40.0, 20.0, 105.0, -10.0, 130.0, 80.0, 510.0, 160.0, 100.0, 145.0, 270.0, 30.0, 60.0, 30.0, 30.0, 20.0, 140.0, 90.0, 50.0, 90.0, 160.0, 220.0, 210.0, 100.0, 10.0, 50.0, 200.0, -20.0, -20.0, 30.0, 290.0, 260.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6932648657314349, "mean_inference_ms": 1.4912581341021485, "mean_action_processing_ms": 0.43434793916155956, "mean_env_wait_ms": 1.3530492933159228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014321565628051758, "StateBufferConnector_ms": 0.010411739349365234, "ViewRequirementAgentConnector_ms": 0.4128279685974121}, "num_episodes": 23, "episode_return_max": 2120.0, "episode_return_min": 190.0, "episode_return_mean": 913.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.233983547219022, "num_env_steps_trained_throughput_per_sec": 19.233983547219022, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 2520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 208676.344, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208676.28, "sample_time_ms": 2714.435, "learn_time_ms": 205940.526, "learn_throughput": 19.423, "synch_weights_time_ms": 11.924}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "training_iteration": 63, "trial_id": "aa996_00000", "date": "2024-05-24_02-24-17", "timestamp": 1716531857, "time_this_iter_s": 207.97567105293274, "time_total_s": 13124.400730609894, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ff3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13124.400730609894, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 19.53877551020408, "ram_util_percent": 79.70204081632653}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.413522100258178, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.870014533295799, "policy_loss": -0.0079947186597495, "vf_loss": 6.876665339860926, "vf_explained_var": 0.0005585158721834452, "kl": 0.006719568686209057, "entropy": 0.4393834430569658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 596265.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 2120.0, "episode_reward_min": 190.0, "episode_reward_mean": 930.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -365.0}, "policy_reward_max": {"policy_0": 900.0}, "policy_reward_mean": {"policy_0": 93.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1550.0, 470.0, 1265.0, 1400.0, 810.0, 1115.0, 970.0, 990.0, 1270.0, 1050.0, 830.0, 680.0, 1420.0, 1220.0, 370.0, 1070.0, 475.0, 295.0, 710.0, 925.0, 720.0, 730.0, 910.0, 550.0, 310.0, 430.0, 870.0, 830.0, 640.0, 680.0, 970.0, 880.0, 980.0, 730.0, 370.0, 800.0, 1240.0, 720.0, 1070.0, 960.0, 630.0, 510.0, 1240.0, 1210.0, 720.0, 1150.0, 1640.0, 1220.0, 1790.0, 1040.0, 1010.0, 720.0, 940.0, 1080.0, 1180.0, 1150.0, 645.0, 1010.0, 630.0, 2120.0, 1235.0, 800.0, 600.0, 665.0, 800.0, 575.0, 550.0, 960.0, 510.0, 950.0, 370.0, 1270.0, 440.0, 190.0, 750.0, 890.0, 1100.0, 1040.0, 980.0, 1520.0, 890.0, 1110.0, 1120.0, 855.0, 1160.0, 1170.0, 1210.0, 1480.0, 720.0, 850.0, 780.0, 575.0, 1410.0, 680.0, 870.0, 1330.0, 1340.0, 1080.0, 370.0, 1910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [300.0, 50.0, 90.0, 110.0, 90.0, 110.0, 200.0, -20.0, 500.0, 120.0, 0.0, 20.0, 40.0, 90.0, 10.0, 90.0, 40.0, 70.0, 70.0, 40.0, 50.0, 165.0, 10.0, 80.0, 60.0, 110.0, 30.0, 330.0, 360.0, 70.0, 170.0, 380.0, 100.0, 10.0, 0.0, 230.0, 80.0, 50.0, 360.0, 20.0, -60.0, 260.0, 80.0, 0.0, 160.0, 120.0, 0.0, 140.0, 60.0, 50.0, 170.0, -85.0, 190.0, -10.0, 110.0, 80.0, 230.0, 80.0, 70.0, 280.0, 210.0, 80.0, 50.0, 10.0, 170.0, 70.0, 100.0, 30.0, 80.0, 170.0, 140.0, 40.0, 310.0, 190.0, 70.0, 40.0, 30.0, 30.0, 80.0, 60.0, 120.0, 60.0, 150.0, 260.0, 330.0, 80.0, 60.0, 130.0, -80.0, 160.0, 160.0, 210.0, 210.0, 20.0, 90.0, 0.0, 10.0, 210.0, 80.0, 60.0, 10.0, 30.0, 130.0, 210.0, -40.0, 100.0, 50.0, 310.0, 20.0, 10.0, 30.0, 20.0, 10.0, 40.0, -10.0, 0.0, 130.0, 0.0, 60.0, 400.0, 190.0, 340.0, 50.0, 120.0, 330.0, 70.0, 60.0, -10.0, 190.0, 80.0, 40.0, 150.0, 150.0, 60.0, 100.0, 390.0, -20.0, 20.0, 160.0, 170.0, 70.0, 10.0, 0.0, 80.0, 20.0, 80.0, 20.0, 30.0, 30.0, 30.0, 40.0, 40.0, 150.0, 180.0, 150.0, 90.0, 90.0, 170.0, 40.0, 120.0, 100.0, 20.0, 70.0, 0.0, 15.0, 60.0, 80.0, 40.0, 60.0, 30.0, 50.0, 25.0, 30.0, 0.0, 20.0, 10.0, 0.0, 90.0, 20.0, 50.0, 170.0, -80.0, 70.0, 80.0, 100.0, 40.0, 10.0, 100.0, 200.0, 20.0, 70.0, 40.0, 90.0, 195.0, 0.0, 30.0, 260.0, 10.0, 30.0, 200.0, 140.0, 190.0, 30.0, 90.0, 40.0, 30.0, 20.0, 40.0, 10.0, 130.0, 10.0, 0.0, 70.0, 160.0, 170.0, 150.0, 50.0, -10.0, 60.0, 70.0, 70.0, 40.0, 80.0, 130.0, 150.0, 30.0, 40.0, 230.0, 70.0, 70.0, 80.0, 40.0, 110.0, 60.0, 60.0, 50.0, 60.0, 0.0, 70.0, 20.0, 20.0, 20.0, 0.0, 10.0, 10.0, 50.0, 30.0, 0.0, 140.0, 30.0, 0.0, 10.0, 10.0, 10.0, 40.0, 40.0, 30.0, 240.0, 50.0, 0.0, 70.0, 140.0, 120.0, 90.0, 100.0, 80.0, 90.0, 50.0, 60.0, 70.0, 130.0, 150.0, 90.0, 90.0, 20.0, 0.0, 140.0, 40.0, 90.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 90.0, 150.0, 180.0, 80.0, 20.0, 100.0, 160.0, 30.0, 30.0, 20.0, 40.0, 30.0, 70.0, 200.0, 0.0, 420.0, 40.0, 0.0, 60.0, 150.0, 160.0, 40.0, 90.0, 20.0, -10.0, 20.0, 80.0, 180.0, 300.0, 40.0, 10.0, 90.0, 0.0, 120.0, 40.0, -30.0, 250.0, 360.0, -10.0, 30.0, 160.0, -40.0, 130.0, 110.0, 20.0, 30.0, 0.0, 70.0, 150.0, 80.0, 90.0, 90.0, 40.0, 30.0, 150.0, 20.0, 20.0, 190.0, 0.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 80.0, 30.0, 20.0, 30.0, 10.0, 420.0, 40.0, 90.0, 30.0, 140.0, 60.0, 120.0, 40.0, 30.0, 190.0, 60.0, 200.0, 260.0, 140.0, 30.0, 20.0, 40.0, 20.0, 20.0, 30.0, 370.0, 170.0, -20.0, 40.0, 410.0, 80.0, 60.0, 40.0, 90.0, 20.0, 50.0, 140.0, 100.0, 80.0, 70.0, 130.0, 0.0, -30.0, 190.0, 40.0, 100.0, 60.0, 20.0, 380.0, 90.0, 30.0, 210.0, 130.0, 0.0, -60.0, 270.0, 40.0, -80.0, 0.0, 0.0, 20.0, 220.0, -70.0, 10.0, 30.0, 190.0, 20.0, 90.0, 0.0, 230.0, 130.0, 90.0, 220.0, 130.0, 220.0, 20.0, 120.0, 50.0, 30.0, 190.0, 150.0, 20.0, 280.0, -10.0, 40.0, 60.0, 40.0, 250.0, 190.0, 50.0, -5.0, 20.0, -10.0, 310.0, 50.0, 160.0, 80.0, 60.0, 5.0, 60.0, 40.0, 560.0, 210.0, 90.0, 40.0, 80.0, 60.0, 10.0, 0.0, 120.0, 260.0, 310.0, 30.0, 150.0, 130.0, 340.0, 180.0, 30.0, 90.0, 60.0, 40.0, 230.0, 280.0, 10.0, 30.0, 110.0, 60.0, 260.0, 140.0, 120.0, 30.0, 60.0, 60.0, 170.0, 340.0, 610.0, 250.0, 80.0, 70.0, 50.0, 10.0, 20.0, -10.0, 0.0, 40.0, 170.0, 560.0, 200.0, 0.0, 70.0, 70.0, 30.0, 80.0, 70.0, 180.0, 90.0, 160.0, 210.0, 50.0, 40.0, 0.0, 160.0, 30.0, 180.0, 30.0, 20.0, 210.0, 30.0, 20.0, 110.0, 240.0, 50.0, 110.0, 40.0, 20.0, 200.0, 40.0, 30.0, 100.0, 60.0, 170.0, 40.0, 180.0, 60.0, 70.0, 50.0, 130.0, 210.0, 110.0, 20.0, 40.0, 80.0, 210.0, 620.0, 130.0, 40.0, 60.0, 0.0, -20.0, 140.0, 190.0, 90.0, 110.0, 20.0, 120.0, 170.0, 260.0, 50.0, 0.0, 0.0, 10.0, 10.0, 100.0, 15.0, 190.0, 0.0, 190.0, 100.0, 30.0, 0.0, 360.0, 290.0, -20.0, 60.0, 30.0, 30.0, 150.0, 40.0, 70.0, -95.0, 50.0, 60.0, 170.0, 0.0, 605.0, 20.0, -110.0, 20.0, -90.0, 100.0, 300.0, 370.0, 60.0, 100.0, 0.0, 150.0, 40.0, 100.0, 900.0, 460.0, 320.0, 65.0, 80.0, 20.0, 190.0, 20.0, 90.0, -50.0, 40.0, 110.0, 40.0, -365.0, 50.0, 530.0, -55.0, 130.0, 110.0, 50.0, 200.0, 110.0, 180.0, -5.0, 10.0, -325.0, 290.0, 140.0, 60.0, -50.0, 190.0, 15.0, 60.0, 60.0, 20.0, 30.0, 90.0, 280.0, 10.0, 40.0, 60.0, 150.0, 0.0, 10.0, 180.0, 100.0, 40.0, 40.0, 220.0, 30.0, 30.0, 80.0, 40.0, 0.0, 130.0, 15.0, 40.0, 160.0, 30.0, 40.0, 40.0, 150.0, 80.0, 60.0, 30.0, 80.0, 10.0, 20.0, 40.0, 60.0, 20.0, 200.0, 60.0, 110.0, 210.0, 50.0, 130.0, 20.0, 60.0, 100.0, 20.0, 30.0, 100.0, 180.0, 30.0, 0.0, 40.0, 50.0, 30.0, 0.0, 50.0, 80.0, 40.0, 10.0, 60.0, 460.0, 180.0, 40.0, 110.0, -250.0, 220.0, 50.0, 0.0, 0.0, 100.0, 0.0, 130.0, 20.0, 50.0, 20.0, 0.0, 160.0, 40.0, 60.0, 120.0, 510.0, 40.0, 80.0, 0.0, 170.0, 90.0, 160.0, 0.0, 90.0, 50.0, 0.0, 10.0, 120.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 10.0, 30.0, 300.0, 20.0, 90.0, 50.0, 90.0, 60.0, 30.0, 20.0, 10.0, 80.0, 40.0, 30.0, 20.0, 40.0, 500.0, 100.0, -90.0, 50.0, 90.0, 110.0, 60.0, 80.0, 300.0, 180.0, 80.0, 120.0, 80.0, 30.0, 110.0, 60.0, 40.0, 10.0, 20.0, 80.0, 70.0, 250.0, 260.0, 90.0, 180.0, 40.0, 190.0, -50.0, 290.0, -40.0, 670.0, 0.0, -40.0, -100.0, 40.0, 20.0, 105.0, -10.0, 130.0, 80.0, 510.0, 160.0, 100.0, 145.0, 270.0, 30.0, 60.0, 30.0, 30.0, 20.0, 140.0, 90.0, 50.0, 90.0, 160.0, 220.0, 210.0, 100.0, 10.0, 50.0, 200.0, -20.0, -20.0, 30.0, 290.0, 260.0, 110.0, 20.0, 200.0, 120.0, 20.0, 360.0, 70.0, 150.0, 70.0, 0.0, 110.0, 70.0, -30.0, 60.0, -35.0, 140.0, 260.0, 110.0, 100.0, 70.0, 20.0, 50.0, 0.0, 460.0, 40.0, 70.0, 30.0, 60.0, 90.0, 340.0, 100.0, 100.0, 150.0, 190.0, 20.0, 80.0, 20.0, -20.0, 340.0, 190.0, -80.0, 100.0, 10.0, 40.0, 600.0, 60.0, 30.0, 390.0, -20.0, 80.0, 370.0, 110.0, 150.0, 90.0, 120.0, 30.0, 50.0, 220.0, 110.0, 230.0, 20.0, -100.0, 0.0, 50.0, 30.0, 80.0, 260.0, -30.0, 410.0, 0.0, 80.0, 60.0, 80.0, 90.0, 40.0, 30.0, 130.0, -30.0, 170.0, 200.0, -10.0, 20.0, 80.0, 20.0, 0.0, 40.0, 90.0, 160.0, 300.0, 80.0, -15.0, 90.0, 90.0, 10.0, 40.0, 160.0, 20.0, 110.0, 40.0, 30.0, 50.0, 20.0, 30.0, 300.0, 340.0, 40.0, 300.0, 90.0, 110.0, 130.0, 0.0, 400.0, 10.0, 70.0, 0.0, 20.0, 30.0, -20.0, 40.0, 130.0, 110.0, 170.0, 80.0, 10.0, 100.0, 20.0, 100.0, 150.0, 90.0, 40.0, 70.0, 110.0, 30.0, 40.0, 120.0, 120.0, 620.0, 80.0, 50.0, 90.0, 230.0, 20.0, 120.0, -10.0, 50.0, 170.0, 110.0, 100.0, 220.0, 330.0, 90.0, 20.0, 80.0, 70.0, 80.0, 80.0, 500.0, 70.0, 30.0, 60.0, 10.0, 20.0, 170.0, 50.0, -20.0, 10.0, 0.0, 40.0, 60.0, 30.0, 60.0, 30.0, 10.0, 50.0, 650.0, 270.0, 290.0, 310.0, 30.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6919767747388303, "mean_inference_ms": 1.491426148041624, "mean_action_processing_ms": 0.4339482787879804, "mean_env_wait_ms": 1.3527306941436108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014751195907592773, "StateBufferConnector_ms": 0.011007070541381836, "ViewRequirementAgentConnector_ms": 0.4196910858154297}, "num_episodes": 18, "episode_return_max": 2120.0, "episode_return_min": 190.0, "episode_return_mean": 930.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.27948115845977, "num_env_steps_trained_throughput_per_sec": 19.27948115845977, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 208627.17, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208627.106, "sample_time_ms": 2700.305, "learn_time_ms": 205905.483, "learn_throughput": 19.426, "synch_weights_time_ms": 11.868}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 64, "trial_id": "aa996_00000", "date": "2024-05-24_02-27-45", "timestamp": 1716532065, "time_this_iter_s": 207.48248505592346, "time_total_s": 13331.883215665817, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13331.883215665817, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 19.01156462585034, "ram_util_percent": 79.35510204081633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7944284715845433, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.48786577523326, "policy_loss": -0.008320007431474579, "vf_loss": 7.494911033733965, "vf_explained_var": -0.00011251596089242238, "kl": 0.006373693734646444, "entropy": 0.41863786751469867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 605655.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "env_runners": {"episode_reward_max": 2120.0, "episode_reward_min": 190.0, "episode_reward_mean": 946.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -365.0}, "policy_reward_max": {"policy_0": 900.0}, "policy_reward_mean": {"policy_0": 94.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [710.0, 925.0, 720.0, 730.0, 910.0, 550.0, 310.0, 430.0, 870.0, 830.0, 640.0, 680.0, 970.0, 880.0, 980.0, 730.0, 370.0, 800.0, 1240.0, 720.0, 1070.0, 960.0, 630.0, 510.0, 1240.0, 1210.0, 720.0, 1150.0, 1640.0, 1220.0, 1790.0, 1040.0, 1010.0, 720.0, 940.0, 1080.0, 1180.0, 1150.0, 645.0, 1010.0, 630.0, 2120.0, 1235.0, 800.0, 600.0, 665.0, 800.0, 575.0, 550.0, 960.0, 510.0, 950.0, 370.0, 1270.0, 440.0, 190.0, 750.0, 890.0, 1100.0, 1040.0, 980.0, 1520.0, 890.0, 1110.0, 1120.0, 855.0, 1160.0, 1170.0, 1210.0, 1480.0, 720.0, 850.0, 780.0, 575.0, 1410.0, 680.0, 870.0, 1330.0, 1340.0, 1080.0, 370.0, 1910.0, 525.0, 1020.0, 1160.0, 1040.0, 795.0, 1370.0, 1290.0, 1240.0, 720.0, 1720.0, 840.0, 1520.0, 630.0, 1350.0, 640.0, 740.0, 1260.0, 1020.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, -80.0, 70.0, 80.0, 100.0, 40.0, 10.0, 100.0, 200.0, 20.0, 70.0, 40.0, 90.0, 195.0, 0.0, 30.0, 260.0, 10.0, 30.0, 200.0, 140.0, 190.0, 30.0, 90.0, 40.0, 30.0, 20.0, 40.0, 10.0, 130.0, 10.0, 0.0, 70.0, 160.0, 170.0, 150.0, 50.0, -10.0, 60.0, 70.0, 70.0, 40.0, 80.0, 130.0, 150.0, 30.0, 40.0, 230.0, 70.0, 70.0, 80.0, 40.0, 110.0, 60.0, 60.0, 50.0, 60.0, 0.0, 70.0, 20.0, 20.0, 20.0, 0.0, 10.0, 10.0, 50.0, 30.0, 0.0, 140.0, 30.0, 0.0, 10.0, 10.0, 10.0, 40.0, 40.0, 30.0, 240.0, 50.0, 0.0, 70.0, 140.0, 120.0, 90.0, 100.0, 80.0, 90.0, 50.0, 60.0, 70.0, 130.0, 150.0, 90.0, 90.0, 20.0, 0.0, 140.0, 40.0, 90.0, 80.0, 60.0, 20.0, 30.0, 10.0, 0.0, 90.0, 150.0, 180.0, 80.0, 20.0, 100.0, 160.0, 30.0, 30.0, 20.0, 40.0, 30.0, 70.0, 200.0, 0.0, 420.0, 40.0, 0.0, 60.0, 150.0, 160.0, 40.0, 90.0, 20.0, -10.0, 20.0, 80.0, 180.0, 300.0, 40.0, 10.0, 90.0, 0.0, 120.0, 40.0, -30.0, 250.0, 360.0, -10.0, 30.0, 160.0, -40.0, 130.0, 110.0, 20.0, 30.0, 0.0, 70.0, 150.0, 80.0, 90.0, 90.0, 40.0, 30.0, 150.0, 20.0, 20.0, 190.0, 0.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 80.0, 30.0, 20.0, 30.0, 10.0, 420.0, 40.0, 90.0, 30.0, 140.0, 60.0, 120.0, 40.0, 30.0, 190.0, 60.0, 200.0, 260.0, 140.0, 30.0, 20.0, 40.0, 20.0, 20.0, 30.0, 370.0, 170.0, -20.0, 40.0, 410.0, 80.0, 60.0, 40.0, 90.0, 20.0, 50.0, 140.0, 100.0, 80.0, 70.0, 130.0, 0.0, -30.0, 190.0, 40.0, 100.0, 60.0, 20.0, 380.0, 90.0, 30.0, 210.0, 130.0, 0.0, -60.0, 270.0, 40.0, -80.0, 0.0, 0.0, 20.0, 220.0, -70.0, 10.0, 30.0, 190.0, 20.0, 90.0, 0.0, 230.0, 130.0, 90.0, 220.0, 130.0, 220.0, 20.0, 120.0, 50.0, 30.0, 190.0, 150.0, 20.0, 280.0, -10.0, 40.0, 60.0, 40.0, 250.0, 190.0, 50.0, -5.0, 20.0, -10.0, 310.0, 50.0, 160.0, 80.0, 60.0, 5.0, 60.0, 40.0, 560.0, 210.0, 90.0, 40.0, 80.0, 60.0, 10.0, 0.0, 120.0, 260.0, 310.0, 30.0, 150.0, 130.0, 340.0, 180.0, 30.0, 90.0, 60.0, 40.0, 230.0, 280.0, 10.0, 30.0, 110.0, 60.0, 260.0, 140.0, 120.0, 30.0, 60.0, 60.0, 170.0, 340.0, 610.0, 250.0, 80.0, 70.0, 50.0, 10.0, 20.0, -10.0, 0.0, 40.0, 170.0, 560.0, 200.0, 0.0, 70.0, 70.0, 30.0, 80.0, 70.0, 180.0, 90.0, 160.0, 210.0, 50.0, 40.0, 0.0, 160.0, 30.0, 180.0, 30.0, 20.0, 210.0, 30.0, 20.0, 110.0, 240.0, 50.0, 110.0, 40.0, 20.0, 200.0, 40.0, 30.0, 100.0, 60.0, 170.0, 40.0, 180.0, 60.0, 70.0, 50.0, 130.0, 210.0, 110.0, 20.0, 40.0, 80.0, 210.0, 620.0, 130.0, 40.0, 60.0, 0.0, -20.0, 140.0, 190.0, 90.0, 110.0, 20.0, 120.0, 170.0, 260.0, 50.0, 0.0, 0.0, 10.0, 10.0, 100.0, 15.0, 190.0, 0.0, 190.0, 100.0, 30.0, 0.0, 360.0, 290.0, -20.0, 60.0, 30.0, 30.0, 150.0, 40.0, 70.0, -95.0, 50.0, 60.0, 170.0, 0.0, 605.0, 20.0, -110.0, 20.0, -90.0, 100.0, 300.0, 370.0, 60.0, 100.0, 0.0, 150.0, 40.0, 100.0, 900.0, 460.0, 320.0, 65.0, 80.0, 20.0, 190.0, 20.0, 90.0, -50.0, 40.0, 110.0, 40.0, -365.0, 50.0, 530.0, -55.0, 130.0, 110.0, 50.0, 200.0, 110.0, 180.0, -5.0, 10.0, -325.0, 290.0, 140.0, 60.0, -50.0, 190.0, 15.0, 60.0, 60.0, 20.0, 30.0, 90.0, 280.0, 10.0, 40.0, 60.0, 150.0, 0.0, 10.0, 180.0, 100.0, 40.0, 40.0, 220.0, 30.0, 30.0, 80.0, 40.0, 0.0, 130.0, 15.0, 40.0, 160.0, 30.0, 40.0, 40.0, 150.0, 80.0, 60.0, 30.0, 80.0, 10.0, 20.0, 40.0, 60.0, 20.0, 200.0, 60.0, 110.0, 210.0, 50.0, 130.0, 20.0, 60.0, 100.0, 20.0, 30.0, 100.0, 180.0, 30.0, 0.0, 40.0, 50.0, 30.0, 0.0, 50.0, 80.0, 40.0, 10.0, 60.0, 460.0, 180.0, 40.0, 110.0, -250.0, 220.0, 50.0, 0.0, 0.0, 100.0, 0.0, 130.0, 20.0, 50.0, 20.0, 0.0, 160.0, 40.0, 60.0, 120.0, 510.0, 40.0, 80.0, 0.0, 170.0, 90.0, 160.0, 0.0, 90.0, 50.0, 0.0, 10.0, 120.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 10.0, 30.0, 300.0, 20.0, 90.0, 50.0, 90.0, 60.0, 30.0, 20.0, 10.0, 80.0, 40.0, 30.0, 20.0, 40.0, 500.0, 100.0, -90.0, 50.0, 90.0, 110.0, 60.0, 80.0, 300.0, 180.0, 80.0, 120.0, 80.0, 30.0, 110.0, 60.0, 40.0, 10.0, 20.0, 80.0, 70.0, 250.0, 260.0, 90.0, 180.0, 40.0, 190.0, -50.0, 290.0, -40.0, 670.0, 0.0, -40.0, -100.0, 40.0, 20.0, 105.0, -10.0, 130.0, 80.0, 510.0, 160.0, 100.0, 145.0, 270.0, 30.0, 60.0, 30.0, 30.0, 20.0, 140.0, 90.0, 50.0, 90.0, 160.0, 220.0, 210.0, 100.0, 10.0, 50.0, 200.0, -20.0, -20.0, 30.0, 290.0, 260.0, 110.0, 20.0, 200.0, 120.0, 20.0, 360.0, 70.0, 150.0, 70.0, 0.0, 110.0, 70.0, -30.0, 60.0, -35.0, 140.0, 260.0, 110.0, 100.0, 70.0, 20.0, 50.0, 0.0, 460.0, 40.0, 70.0, 30.0, 60.0, 90.0, 340.0, 100.0, 100.0, 150.0, 190.0, 20.0, 80.0, 20.0, -20.0, 340.0, 190.0, -80.0, 100.0, 10.0, 40.0, 600.0, 60.0, 30.0, 390.0, -20.0, 80.0, 370.0, 110.0, 150.0, 90.0, 120.0, 30.0, 50.0, 220.0, 110.0, 230.0, 20.0, -100.0, 0.0, 50.0, 30.0, 80.0, 260.0, -30.0, 410.0, 0.0, 80.0, 60.0, 80.0, 90.0, 40.0, 30.0, 130.0, -30.0, 170.0, 200.0, -10.0, 20.0, 80.0, 20.0, 0.0, 40.0, 90.0, 160.0, 300.0, 80.0, -15.0, 90.0, 90.0, 10.0, 40.0, 160.0, 20.0, 110.0, 40.0, 30.0, 50.0, 20.0, 30.0, 300.0, 340.0, 40.0, 300.0, 90.0, 110.0, 130.0, 0.0, 400.0, 10.0, 70.0, 0.0, 20.0, 30.0, -20.0, 40.0, 130.0, 110.0, 170.0, 80.0, 10.0, 100.0, 20.0, 100.0, 150.0, 90.0, 40.0, 70.0, 110.0, 30.0, 40.0, 120.0, 120.0, 620.0, 80.0, 50.0, 90.0, 230.0, 20.0, 120.0, -10.0, 50.0, 170.0, 110.0, 100.0, 220.0, 330.0, 90.0, 20.0, 80.0, 70.0, 80.0, 80.0, 500.0, 70.0, 30.0, 60.0, 10.0, 20.0, 170.0, 50.0, -20.0, 10.0, 0.0, 40.0, 60.0, 30.0, 60.0, 30.0, 10.0, 50.0, 650.0, 270.0, 290.0, 310.0, 30.0, 210.0, 25.0, 10.0, 70.0, 20.0, 50.0, 30.0, 0.0, 170.0, 20.0, 130.0, 60.0, 260.0, 10.0, 190.0, 130.0, 30.0, 140.0, 100.0, 20.0, 80.0, 120.0, 120.0, 0.0, 470.0, 120.0, -20.0, 90.0, 20.0, 130.0, 110.0, 20.0, 210.0, 70.0, 150.0, 40.0, 40.0, 30.0, 50.0, 400.0, 30.0, 140.0, 40.0, 35.0, 40.0, 310.0, 80.0, 40.0, 20.0, 90.0, 0.0, 210.0, 60.0, 280.0, 40.0, 120.0, 190.0, 0.0, 450.0, -10.0, 30.0, 100.0, 130.0, 200.0, 80.0, 110.0, 380.0, 80.0, 70.0, 60.0, 80.0, 410.0, 10.0, 240.0, 110.0, 50.0, 40.0, 90.0, -40.0, 210.0, 120.0, 40.0, 170.0, 290.0, 20.0, 50.0, 90.0, 0.0, 0.0, 0.0, 60.0, -10.0, 110.0, 270.0, -30.0, 130.0, 120.0, 70.0, 50.0, 350.0, 660.0, 110.0, 70.0, 0.0, 0.0, 150.0, 20.0, 110.0, 180.0, 170.0, 30.0, 60.0, 10.0, 110.0, 20.0, 170.0, 280.0, 480.0, 80.0, 140.0, 170.0, 270.0, 0.0, 10.0, 50.0, 80.0, 20.0, 10.0, 120.0, 60.0, 10.0, 10.0, 60.0, 500.0, 60.0, 30.0, 190.0, 40.0, 190.0, -170.0, 440.0, 70.0, -50.0, 180.0, 90.0, 300.0, 60.0, -60.0, 0.0, 70.0, -20.0, 40.0, 130.0, 170.0, 40.0, 140.0, 70.0, 60.0, 10.0, 50.0, 30.0, 180.0, 50.0, 80.0, 60.0, 20.0, 70.0, 60.0, 40.0, 250.0, 450.0, 160.0, 90.0, 180.0, 30.0, 90.0, 40.0, 50.0, 260.0, 70.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6906178048583491, "mean_inference_ms": 1.4918125881460202, "mean_action_processing_ms": 0.43359567011047245, "mean_env_wait_ms": 1.3525330133193716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01461648941040039, "StateBufferConnector_ms": 0.010915756225585938, "ViewRequirementAgentConnector_ms": 0.4166605472564697}, "num_episodes": 18, "episode_return_max": 2120.0, "episode_return_min": 190.0, "episode_return_mean": 946.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.270934954226483, "num_env_steps_trained_throughput_per_sec": 19.270934954226483, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 2600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2600000, "timers": {"training_iteration_time_ms": 208525.868, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208525.804, "sample_time_ms": 2677.802, "learn_time_ms": 205826.744, "learn_throughput": 19.434, "synch_weights_time_ms": 11.804}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "done": false, "training_iteration": 65, "trial_id": "aa996_00000", "date": "2024-05-24_02-31-12", "timestamp": 1716532272, "time_this_iter_s": 207.57553625106812, "time_total_s": 13539.458751916885, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x330984700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13539.458751916885, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 19.12901023890785, "ram_util_percent": 79.31058020477816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9142390783094623, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.015485640608084, "policy_loss": -0.008216819829725054, "vf_loss": 7.022448027603669, "vf_explained_var": 1.4589306391593112e-05, "kl": 0.006272197500421255, "entropy": 0.42490061866208767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 615045.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 2120.0, "episode_reward_min": 190.0, "episode_reward_mean": 1000.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -365.0}, "policy_reward_max": {"policy_0": 900.0}, "policy_reward_mean": {"policy_0": 100.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [630.0, 510.0, 1240.0, 1210.0, 720.0, 1150.0, 1640.0, 1220.0, 1790.0, 1040.0, 1010.0, 720.0, 940.0, 1080.0, 1180.0, 1150.0, 645.0, 1010.0, 630.0, 2120.0, 1235.0, 800.0, 600.0, 665.0, 800.0, 575.0, 550.0, 960.0, 510.0, 950.0, 370.0, 1270.0, 440.0, 190.0, 750.0, 890.0, 1100.0, 1040.0, 980.0, 1520.0, 890.0, 1110.0, 1120.0, 855.0, 1160.0, 1170.0, 1210.0, 1480.0, 720.0, 850.0, 780.0, 575.0, 1410.0, 680.0, 870.0, 1330.0, 1340.0, 1080.0, 370.0, 1910.0, 525.0, 1020.0, 1160.0, 1040.0, 795.0, 1370.0, 1290.0, 1240.0, 720.0, 1720.0, 840.0, 1520.0, 630.0, 1350.0, 640.0, 740.0, 1260.0, 1020.0, 1170.0, 560.0, 1240.0, 1060.0, 1310.0, 1340.0, 975.0, 1180.0, 1435.0, 1000.0, 950.0, 1880.0, 1220.0, 395.0, 315.0, 1180.0, 1040.0, 1395.0, 1270.0, 510.0, 370.0, 595.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 30.0, 210.0, 130.0, 0.0, -60.0, 270.0, 40.0, -80.0, 0.0, 0.0, 20.0, 220.0, -70.0, 10.0, 30.0, 190.0, 20.0, 90.0, 0.0, 230.0, 130.0, 90.0, 220.0, 130.0, 220.0, 20.0, 120.0, 50.0, 30.0, 190.0, 150.0, 20.0, 280.0, -10.0, 40.0, 60.0, 40.0, 250.0, 190.0, 50.0, -5.0, 20.0, -10.0, 310.0, 50.0, 160.0, 80.0, 60.0, 5.0, 60.0, 40.0, 560.0, 210.0, 90.0, 40.0, 80.0, 60.0, 10.0, 0.0, 120.0, 260.0, 310.0, 30.0, 150.0, 130.0, 340.0, 180.0, 30.0, 90.0, 60.0, 40.0, 230.0, 280.0, 10.0, 30.0, 110.0, 60.0, 260.0, 140.0, 120.0, 30.0, 60.0, 60.0, 170.0, 340.0, 610.0, 250.0, 80.0, 70.0, 50.0, 10.0, 20.0, -10.0, 0.0, 40.0, 170.0, 560.0, 200.0, 0.0, 70.0, 70.0, 30.0, 80.0, 70.0, 180.0, 90.0, 160.0, 210.0, 50.0, 40.0, 0.0, 160.0, 30.0, 180.0, 30.0, 20.0, 210.0, 30.0, 20.0, 110.0, 240.0, 50.0, 110.0, 40.0, 20.0, 200.0, 40.0, 30.0, 100.0, 60.0, 170.0, 40.0, 180.0, 60.0, 70.0, 50.0, 130.0, 210.0, 110.0, 20.0, 40.0, 80.0, 210.0, 620.0, 130.0, 40.0, 60.0, 0.0, -20.0, 140.0, 190.0, 90.0, 110.0, 20.0, 120.0, 170.0, 260.0, 50.0, 0.0, 0.0, 10.0, 10.0, 100.0, 15.0, 190.0, 0.0, 190.0, 100.0, 30.0, 0.0, 360.0, 290.0, -20.0, 60.0, 30.0, 30.0, 150.0, 40.0, 70.0, -95.0, 50.0, 60.0, 170.0, 0.0, 605.0, 20.0, -110.0, 20.0, -90.0, 100.0, 300.0, 370.0, 60.0, 100.0, 0.0, 150.0, 40.0, 100.0, 900.0, 460.0, 320.0, 65.0, 80.0, 20.0, 190.0, 20.0, 90.0, -50.0, 40.0, 110.0, 40.0, -365.0, 50.0, 530.0, -55.0, 130.0, 110.0, 50.0, 200.0, 110.0, 180.0, -5.0, 10.0, -325.0, 290.0, 140.0, 60.0, -50.0, 190.0, 15.0, 60.0, 60.0, 20.0, 30.0, 90.0, 280.0, 10.0, 40.0, 60.0, 150.0, 0.0, 10.0, 180.0, 100.0, 40.0, 40.0, 220.0, 30.0, 30.0, 80.0, 40.0, 0.0, 130.0, 15.0, 40.0, 160.0, 30.0, 40.0, 40.0, 150.0, 80.0, 60.0, 30.0, 80.0, 10.0, 20.0, 40.0, 60.0, 20.0, 200.0, 60.0, 110.0, 210.0, 50.0, 130.0, 20.0, 60.0, 100.0, 20.0, 30.0, 100.0, 180.0, 30.0, 0.0, 40.0, 50.0, 30.0, 0.0, 50.0, 80.0, 40.0, 10.0, 60.0, 460.0, 180.0, 40.0, 110.0, -250.0, 220.0, 50.0, 0.0, 0.0, 100.0, 0.0, 130.0, 20.0, 50.0, 20.0, 0.0, 160.0, 40.0, 60.0, 120.0, 510.0, 40.0, 80.0, 0.0, 170.0, 90.0, 160.0, 0.0, 90.0, 50.0, 0.0, 10.0, 120.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 10.0, 30.0, 300.0, 20.0, 90.0, 50.0, 90.0, 60.0, 30.0, 20.0, 10.0, 80.0, 40.0, 30.0, 20.0, 40.0, 500.0, 100.0, -90.0, 50.0, 90.0, 110.0, 60.0, 80.0, 300.0, 180.0, 80.0, 120.0, 80.0, 30.0, 110.0, 60.0, 40.0, 10.0, 20.0, 80.0, 70.0, 250.0, 260.0, 90.0, 180.0, 40.0, 190.0, -50.0, 290.0, -40.0, 670.0, 0.0, -40.0, -100.0, 40.0, 20.0, 105.0, -10.0, 130.0, 80.0, 510.0, 160.0, 100.0, 145.0, 270.0, 30.0, 60.0, 30.0, 30.0, 20.0, 140.0, 90.0, 50.0, 90.0, 160.0, 220.0, 210.0, 100.0, 10.0, 50.0, 200.0, -20.0, -20.0, 30.0, 290.0, 260.0, 110.0, 20.0, 200.0, 120.0, 20.0, 360.0, 70.0, 150.0, 70.0, 0.0, 110.0, 70.0, -30.0, 60.0, -35.0, 140.0, 260.0, 110.0, 100.0, 70.0, 20.0, 50.0, 0.0, 460.0, 40.0, 70.0, 30.0, 60.0, 90.0, 340.0, 100.0, 100.0, 150.0, 190.0, 20.0, 80.0, 20.0, -20.0, 340.0, 190.0, -80.0, 100.0, 10.0, 40.0, 600.0, 60.0, 30.0, 390.0, -20.0, 80.0, 370.0, 110.0, 150.0, 90.0, 120.0, 30.0, 50.0, 220.0, 110.0, 230.0, 20.0, -100.0, 0.0, 50.0, 30.0, 80.0, 260.0, -30.0, 410.0, 0.0, 80.0, 60.0, 80.0, 90.0, 40.0, 30.0, 130.0, -30.0, 170.0, 200.0, -10.0, 20.0, 80.0, 20.0, 0.0, 40.0, 90.0, 160.0, 300.0, 80.0, -15.0, 90.0, 90.0, 10.0, 40.0, 160.0, 20.0, 110.0, 40.0, 30.0, 50.0, 20.0, 30.0, 300.0, 340.0, 40.0, 300.0, 90.0, 110.0, 130.0, 0.0, 400.0, 10.0, 70.0, 0.0, 20.0, 30.0, -20.0, 40.0, 130.0, 110.0, 170.0, 80.0, 10.0, 100.0, 20.0, 100.0, 150.0, 90.0, 40.0, 70.0, 110.0, 30.0, 40.0, 120.0, 120.0, 620.0, 80.0, 50.0, 90.0, 230.0, 20.0, 120.0, -10.0, 50.0, 170.0, 110.0, 100.0, 220.0, 330.0, 90.0, 20.0, 80.0, 70.0, 80.0, 80.0, 500.0, 70.0, 30.0, 60.0, 10.0, 20.0, 170.0, 50.0, -20.0, 10.0, 0.0, 40.0, 60.0, 30.0, 60.0, 30.0, 10.0, 50.0, 650.0, 270.0, 290.0, 310.0, 30.0, 210.0, 25.0, 10.0, 70.0, 20.0, 50.0, 30.0, 0.0, 170.0, 20.0, 130.0, 60.0, 260.0, 10.0, 190.0, 130.0, 30.0, 140.0, 100.0, 20.0, 80.0, 120.0, 120.0, 0.0, 470.0, 120.0, -20.0, 90.0, 20.0, 130.0, 110.0, 20.0, 210.0, 70.0, 150.0, 40.0, 40.0, 30.0, 50.0, 400.0, 30.0, 140.0, 40.0, 35.0, 40.0, 310.0, 80.0, 40.0, 20.0, 90.0, 0.0, 210.0, 60.0, 280.0, 40.0, 120.0, 190.0, 0.0, 450.0, -10.0, 30.0, 100.0, 130.0, 200.0, 80.0, 110.0, 380.0, 80.0, 70.0, 60.0, 80.0, 410.0, 10.0, 240.0, 110.0, 50.0, 40.0, 90.0, -40.0, 210.0, 120.0, 40.0, 170.0, 290.0, 20.0, 50.0, 90.0, 0.0, 0.0, 0.0, 60.0, -10.0, 110.0, 270.0, -30.0, 130.0, 120.0, 70.0, 50.0, 350.0, 660.0, 110.0, 70.0, 0.0, 0.0, 150.0, 20.0, 110.0, 180.0, 170.0, 30.0, 60.0, 10.0, 110.0, 20.0, 170.0, 280.0, 480.0, 80.0, 140.0, 170.0, 270.0, 0.0, 10.0, 50.0, 80.0, 20.0, 10.0, 120.0, 60.0, 10.0, 10.0, 60.0, 500.0, 60.0, 30.0, 190.0, 40.0, 190.0, -170.0, 440.0, 70.0, -50.0, 180.0, 90.0, 300.0, 60.0, -60.0, 0.0, 70.0, -20.0, 40.0, 130.0, 170.0, 40.0, 140.0, 70.0, 60.0, 10.0, 50.0, 30.0, 180.0, 50.0, 80.0, 60.0, 20.0, 70.0, 60.0, 40.0, 250.0, 450.0, 160.0, 90.0, 180.0, 30.0, 90.0, 40.0, 50.0, 260.0, 70.0, 50.0, 120.0, 60.0, 110.0, 110.0, 50.0, 150.0, 120.0, 360.0, 70.0, 20.0, 30.0, 70.0, 80.0, 40.0, 70.0, 40.0, 10.0, 40.0, 60.0, 120.0, 20.0, 70.0, 130.0, 40.0, 80.0, -20.0, 180.0, 230.0, 380.0, 130.0, 170.0, 140.0, 10.0, 60.0, 30.0, 100.0, 10.0, 310.0, 40.0, 190.0, 360.0, 180.0, 80.0, 90.0, 200.0, 180.0, 40.0, 70.0, 30.0, 80.0, 60.0, 300.0, 90.0, 210.0, 100.0, 50.0, 90.0, 120.0, 70.0, 250.0, 265.0, 210.0, 90.0, 10.0, 160.0, 30.0, 100.0, 10.0, 20.0, 80.0, 110.0, 10.0, 120.0, 220.0, 160.0, 100.0, 110.0, 170.0, 0.0, 180.0, 120.0, 60.0, 320.0, 90.0, 55.0, 40.0, 320.0, 90.0, 340.0, 0.0, 60.0, 70.0, 130.0, 380.0, 70.0, 20.0, -200.0, 30.0, 50.0, 390.0, 40.0, 310.0, 90.0, 170.0, 40.0, 30.0, -20.0, 70.0, 50.0, 170.0, 90.0, 50.0, 370.0, 90.0, 100.0, 120.0, 80.0, 50.0, 540.0, 390.0, 80.0, 40.0, 70.0, 390.0, 110.0, 70.0, 30.0, 30.0, 340.0, 60.0, 20.0, 40.0, 25.0, 20.0, 0.0, 220.0, 35.0, -5.0, 20.0, 20.0, 80.0, 20.0, 150.0, 10.0, 10.0, 30.0, 5.0, 30.0, -40.0, 20.0, 90.0, 90.0, -20.0, 50.0, 390.0, 40.0, 200.0, 40.0, 100.0, 200.0, 70.0, 180.0, -90.0, 120.0, 190.0, 570.0, 30.0, -20.0, 10.0, -20.0, 290.0, 40.0, 90.0, 105.0, 60.0, 110.0, 140.0, 190.0, 20.0, 350.0, 70.0, 640.0, 90.0, 20.0, 30.0, 120.0, 100.0, 20.0, 140.0, 40.0, 30.0, 70.0, 0.0, 80.0, 30.0, 20.0, 40.0, 0.0, 80.0, 160.0, 10.0, 80.0, 160.0, 0.0, -40.0, 70.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 0.0, 380.0, -90.0, -35.0, 0.0, 50.0, 100.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.688895597462495, "mean_inference_ms": 1.4920129314118555, "mean_action_processing_ms": 0.43317771396712745, "mean_env_wait_ms": 1.3522463599268357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01415109634399414, "StateBufferConnector_ms": 0.010872602462768555, "ViewRequirementAgentConnector_ms": 0.42307496070861816}, "num_episodes": 22, "episode_return_max": 2120.0, "episode_return_min": 190.0, "episode_return_mean": 1000.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.167670532447485, "num_env_steps_trained_throughput_per_sec": 19.167670532447485, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 208497.077, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208497.013, "sample_time_ms": 2690.813, "learn_time_ms": 205785.233, "learn_throughput": 19.438, "synch_weights_time_ms": 11.6}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 66, "trial_id": "aa996_00000", "date": "2024-05-24_02-34-41", "timestamp": 1716532481, "time_this_iter_s": 208.7140030860901, "time_total_s": 13748.172755002975, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d9f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13748.172755002975, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 19.120338983050846, "ram_util_percent": 79.52271186440677}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.681536917412243, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.114796248944804, "policy_loss": -0.008098849883346191, "vf_loss": 7.1216395588347705, "vf_explained_var": -0.0007566263627447386, "kl": 0.006277716145118153, "entropy": 0.4062602135827874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 624435.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": 190.0, "episode_reward_mean": 994.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 99.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [665.0, 800.0, 575.0, 550.0, 960.0, 510.0, 950.0, 370.0, 1270.0, 440.0, 190.0, 750.0, 890.0, 1100.0, 1040.0, 980.0, 1520.0, 890.0, 1110.0, 1120.0, 855.0, 1160.0, 1170.0, 1210.0, 1480.0, 720.0, 850.0, 780.0, 575.0, 1410.0, 680.0, 870.0, 1330.0, 1340.0, 1080.0, 370.0, 1910.0, 525.0, 1020.0, 1160.0, 1040.0, 795.0, 1370.0, 1290.0, 1240.0, 720.0, 1720.0, 840.0, 1520.0, 630.0, 1350.0, 640.0, 740.0, 1260.0, 1020.0, 1170.0, 560.0, 1240.0, 1060.0, 1310.0, 1340.0, 975.0, 1180.0, 1435.0, 1000.0, 950.0, 1880.0, 1220.0, 395.0, 315.0, 1180.0, 1040.0, 1395.0, 1270.0, 510.0, 370.0, 595.0, 1240.0, 470.0, 1310.0, 840.0, 480.0, 820.0, 1130.0, 955.0, 565.0, 715.0, 1370.0, 980.0, 790.0, 1300.0, 480.0, 1440.0, 1590.0, 400.0, 1580.0, 1555.0, 1060.0, 1460.0, 1135.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [15.0, 60.0, 60.0, 20.0, 30.0, 90.0, 280.0, 10.0, 40.0, 60.0, 150.0, 0.0, 10.0, 180.0, 100.0, 40.0, 40.0, 220.0, 30.0, 30.0, 80.0, 40.0, 0.0, 130.0, 15.0, 40.0, 160.0, 30.0, 40.0, 40.0, 150.0, 80.0, 60.0, 30.0, 80.0, 10.0, 20.0, 40.0, 60.0, 20.0, 200.0, 60.0, 110.0, 210.0, 50.0, 130.0, 20.0, 60.0, 100.0, 20.0, 30.0, 100.0, 180.0, 30.0, 0.0, 40.0, 50.0, 30.0, 0.0, 50.0, 80.0, 40.0, 10.0, 60.0, 460.0, 180.0, 40.0, 110.0, -250.0, 220.0, 50.0, 0.0, 0.0, 100.0, 0.0, 130.0, 20.0, 50.0, 20.0, 0.0, 160.0, 40.0, 60.0, 120.0, 510.0, 40.0, 80.0, 0.0, 170.0, 90.0, 160.0, 0.0, 90.0, 50.0, 0.0, 10.0, 120.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 10.0, 30.0, 300.0, 20.0, 90.0, 50.0, 90.0, 60.0, 30.0, 20.0, 10.0, 80.0, 40.0, 30.0, 20.0, 40.0, 500.0, 100.0, -90.0, 50.0, 90.0, 110.0, 60.0, 80.0, 300.0, 180.0, 80.0, 120.0, 80.0, 30.0, 110.0, 60.0, 40.0, 10.0, 20.0, 80.0, 70.0, 250.0, 260.0, 90.0, 180.0, 40.0, 190.0, -50.0, 290.0, -40.0, 670.0, 0.0, -40.0, -100.0, 40.0, 20.0, 105.0, -10.0, 130.0, 80.0, 510.0, 160.0, 100.0, 145.0, 270.0, 30.0, 60.0, 30.0, 30.0, 20.0, 140.0, 90.0, 50.0, 90.0, 160.0, 220.0, 210.0, 100.0, 10.0, 50.0, 200.0, -20.0, -20.0, 30.0, 290.0, 260.0, 110.0, 20.0, 200.0, 120.0, 20.0, 360.0, 70.0, 150.0, 70.0, 0.0, 110.0, 70.0, -30.0, 60.0, -35.0, 140.0, 260.0, 110.0, 100.0, 70.0, 20.0, 50.0, 0.0, 460.0, 40.0, 70.0, 30.0, 60.0, 90.0, 340.0, 100.0, 100.0, 150.0, 190.0, 20.0, 80.0, 20.0, -20.0, 340.0, 190.0, -80.0, 100.0, 10.0, 40.0, 600.0, 60.0, 30.0, 390.0, -20.0, 80.0, 370.0, 110.0, 150.0, 90.0, 120.0, 30.0, 50.0, 220.0, 110.0, 230.0, 20.0, -100.0, 0.0, 50.0, 30.0, 80.0, 260.0, -30.0, 410.0, 0.0, 80.0, 60.0, 80.0, 90.0, 40.0, 30.0, 130.0, -30.0, 170.0, 200.0, -10.0, 20.0, 80.0, 20.0, 0.0, 40.0, 90.0, 160.0, 300.0, 80.0, -15.0, 90.0, 90.0, 10.0, 40.0, 160.0, 20.0, 110.0, 40.0, 30.0, 50.0, 20.0, 30.0, 300.0, 340.0, 40.0, 300.0, 90.0, 110.0, 130.0, 0.0, 400.0, 10.0, 70.0, 0.0, 20.0, 30.0, -20.0, 40.0, 130.0, 110.0, 170.0, 80.0, 10.0, 100.0, 20.0, 100.0, 150.0, 90.0, 40.0, 70.0, 110.0, 30.0, 40.0, 120.0, 120.0, 620.0, 80.0, 50.0, 90.0, 230.0, 20.0, 120.0, -10.0, 50.0, 170.0, 110.0, 100.0, 220.0, 330.0, 90.0, 20.0, 80.0, 70.0, 80.0, 80.0, 500.0, 70.0, 30.0, 60.0, 10.0, 20.0, 170.0, 50.0, -20.0, 10.0, 0.0, 40.0, 60.0, 30.0, 60.0, 30.0, 10.0, 50.0, 650.0, 270.0, 290.0, 310.0, 30.0, 210.0, 25.0, 10.0, 70.0, 20.0, 50.0, 30.0, 0.0, 170.0, 20.0, 130.0, 60.0, 260.0, 10.0, 190.0, 130.0, 30.0, 140.0, 100.0, 20.0, 80.0, 120.0, 120.0, 0.0, 470.0, 120.0, -20.0, 90.0, 20.0, 130.0, 110.0, 20.0, 210.0, 70.0, 150.0, 40.0, 40.0, 30.0, 50.0, 400.0, 30.0, 140.0, 40.0, 35.0, 40.0, 310.0, 80.0, 40.0, 20.0, 90.0, 0.0, 210.0, 60.0, 280.0, 40.0, 120.0, 190.0, 0.0, 450.0, -10.0, 30.0, 100.0, 130.0, 200.0, 80.0, 110.0, 380.0, 80.0, 70.0, 60.0, 80.0, 410.0, 10.0, 240.0, 110.0, 50.0, 40.0, 90.0, -40.0, 210.0, 120.0, 40.0, 170.0, 290.0, 20.0, 50.0, 90.0, 0.0, 0.0, 0.0, 60.0, -10.0, 110.0, 270.0, -30.0, 130.0, 120.0, 70.0, 50.0, 350.0, 660.0, 110.0, 70.0, 0.0, 0.0, 150.0, 20.0, 110.0, 180.0, 170.0, 30.0, 60.0, 10.0, 110.0, 20.0, 170.0, 280.0, 480.0, 80.0, 140.0, 170.0, 270.0, 0.0, 10.0, 50.0, 80.0, 20.0, 10.0, 120.0, 60.0, 10.0, 10.0, 60.0, 500.0, 60.0, 30.0, 190.0, 40.0, 190.0, -170.0, 440.0, 70.0, -50.0, 180.0, 90.0, 300.0, 60.0, -60.0, 0.0, 70.0, -20.0, 40.0, 130.0, 170.0, 40.0, 140.0, 70.0, 60.0, 10.0, 50.0, 30.0, 180.0, 50.0, 80.0, 60.0, 20.0, 70.0, 60.0, 40.0, 250.0, 450.0, 160.0, 90.0, 180.0, 30.0, 90.0, 40.0, 50.0, 260.0, 70.0, 50.0, 120.0, 60.0, 110.0, 110.0, 50.0, 150.0, 120.0, 360.0, 70.0, 20.0, 30.0, 70.0, 80.0, 40.0, 70.0, 40.0, 10.0, 40.0, 60.0, 120.0, 20.0, 70.0, 130.0, 40.0, 80.0, -20.0, 180.0, 230.0, 380.0, 130.0, 170.0, 140.0, 10.0, 60.0, 30.0, 100.0, 10.0, 310.0, 40.0, 190.0, 360.0, 180.0, 80.0, 90.0, 200.0, 180.0, 40.0, 70.0, 30.0, 80.0, 60.0, 300.0, 90.0, 210.0, 100.0, 50.0, 90.0, 120.0, 70.0, 250.0, 265.0, 210.0, 90.0, 10.0, 160.0, 30.0, 100.0, 10.0, 20.0, 80.0, 110.0, 10.0, 120.0, 220.0, 160.0, 100.0, 110.0, 170.0, 0.0, 180.0, 120.0, 60.0, 320.0, 90.0, 55.0, 40.0, 320.0, 90.0, 340.0, 0.0, 60.0, 70.0, 130.0, 380.0, 70.0, 20.0, -200.0, 30.0, 50.0, 390.0, 40.0, 310.0, 90.0, 170.0, 40.0, 30.0, -20.0, 70.0, 50.0, 170.0, 90.0, 50.0, 370.0, 90.0, 100.0, 120.0, 80.0, 50.0, 540.0, 390.0, 80.0, 40.0, 70.0, 390.0, 110.0, 70.0, 30.0, 30.0, 340.0, 60.0, 20.0, 40.0, 25.0, 20.0, 0.0, 220.0, 35.0, -5.0, 20.0, 20.0, 80.0, 20.0, 150.0, 10.0, 10.0, 30.0, 5.0, 30.0, -40.0, 20.0, 90.0, 90.0, -20.0, 50.0, 390.0, 40.0, 200.0, 40.0, 100.0, 200.0, 70.0, 180.0, -90.0, 120.0, 190.0, 570.0, 30.0, -20.0, 10.0, -20.0, 290.0, 40.0, 90.0, 105.0, 60.0, 110.0, 140.0, 190.0, 20.0, 350.0, 70.0, 640.0, 90.0, 20.0, 30.0, 120.0, 100.0, 20.0, 140.0, 40.0, 30.0, 70.0, 0.0, 80.0, 30.0, 20.0, 40.0, 0.0, 80.0, 160.0, 10.0, 80.0, 160.0, 0.0, -40.0, 70.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 0.0, 380.0, -90.0, -35.0, 0.0, 50.0, 100.0, 170.0, 70.0, 80.0, 100.0, 80.0, 300.0, 210.0, 210.0, 30.0, 160.0, 0.0, 40.0, 150.0, 0.0, 40.0, 90.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 30.0, 60.0, 200.0, 340.0, 170.0, 80.0, 150.0, 70.0, 200.0, 390.0, 0.0, 10.0, 180.0, 60.0, 30.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 40.0, 70.0, 170.0, 60.0, 60.0, 30.0, 20.0, 20.0, 100.0, 20.0, 10.0, 0.0, 320.0, -30.0, 60.0, 250.0, 20.0, 70.0, 50.0, 130.0, 10.0, 80.0, 190.0, 50.0, 80.0, 150.0, 330.0, 60.0, 180.0, 30.0, 90.0, 100.0, 190.0, 30.0, 100.0, 25.0, 150.0, 60.0, 70.0, -20.0, 120.0, 80.0, 70.0, -75.0, 70.0, -10.0, 190.0, 70.0, 45.0, 330.0, 40.0, 60.0, 40.0, 0.0, 20.0, 180.0, 0.0, 0.0, 10.0, 100.0, 240.0, 40.0, 460.0, 180.0, 40.0, 190.0, 80.0, 30.0, 0.0, 90.0, 100.0, 20.0, 0.0, 450.0, 60.0, 80.0, -20.0, 200.0, 310.0, 10.0, 50.0, 80.0, 200.0, 30.0, -40.0, 70.0, 0.0, 80.0, 60.0, 100.0, 190.0, 330.0, 180.0, 110.0, 100.0, 40.0, 180.0, 10.0, 40.0, 0.0, 180.0, 50.0, 30.0, 40.0, -225.0, 70.0, -65.0, 360.0, 310.0, 50.0, 40.0, 20.0, 200.0, 40.0, 50.0, 110.0, 300.0, 320.0, 110.0, 200.0, 0.0, 280.0, 20.0, 280.0, 40.0, 360.0, 130.0, 170.0, 60.0, 70.0, 30.0, 10.0, 70.0, 20.0, 0.0, 40.0, 60.0, 40.0, 30.0, 260.0, 170.0, 180.0, 30.0, 510.0, 70.0, 20.0, 200.0, 110.0, 480.0, 90.0, 20.0, 165.0, 220.0, 50.0, 200.0, 50.0, 170.0, 110.0, 190.0, 110.0, 20.0, 0.0, 280.0, 100.0, 40.0, 250.0, 10.0, 60.0, 210.0, 270.0, 30.0, 30.0, 120.0, 110.0, 40.0, 370.0, 40.0, 240.0, 100.0, 5.0, 140.0, 120.0, 150.0, 50.0, 40.0, 130.0, 310.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6870630076898954, "mean_inference_ms": 1.4906336741137969, "mean_action_processing_ms": 0.43287931850548517, "mean_env_wait_ms": 1.3535136943158712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013972759246826172, "StateBufferConnector_ms": 0.010872125625610352, "ViewRequirementAgentConnector_ms": 0.4195864200592041}, "num_episodes": 23, "episode_return_max": 1910.0, "episode_return_min": 190.0, "episode_return_mean": 994.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.75333007884846, "num_env_steps_trained_throughput_per_sec": 18.75333007884846, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 2680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2680000, "timers": {"training_iteration_time_ms": 209084.812, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209084.771, "sample_time_ms": 2679.612, "learn_time_ms": 206383.414, "learn_throughput": 19.381, "synch_weights_time_ms": 11.442}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "done": false, "training_iteration": 67, "trial_id": "aa996_00000", "date": "2024-05-24_02-38-14", "timestamp": 1716532694, "time_this_iter_s": 213.31616616249084, "time_total_s": 13961.488921165466, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332db7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13961.488921165466, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 23.968543046357617, "ram_util_percent": 80.6364238410596}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7395332994869848, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.797032256375233, "policy_loss": -0.007444890566453877, "vf_loss": 6.80323333176561, "vf_explained_var": -0.0019246095729966006, "kl": 0.006219076713848185, "entropy": 0.4162405711932939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 633825.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 2070.0, "episode_reward_min": 315.0, "episode_reward_mean": 1023.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -225.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 102.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1110.0, 1120.0, 855.0, 1160.0, 1170.0, 1210.0, 1480.0, 720.0, 850.0, 780.0, 575.0, 1410.0, 680.0, 870.0, 1330.0, 1340.0, 1080.0, 370.0, 1910.0, 525.0, 1020.0, 1160.0, 1040.0, 795.0, 1370.0, 1290.0, 1240.0, 720.0, 1720.0, 840.0, 1520.0, 630.0, 1350.0, 640.0, 740.0, 1260.0, 1020.0, 1170.0, 560.0, 1240.0, 1060.0, 1310.0, 1340.0, 975.0, 1180.0, 1435.0, 1000.0, 950.0, 1880.0, 1220.0, 395.0, 315.0, 1180.0, 1040.0, 1395.0, 1270.0, 510.0, 370.0, 595.0, 1240.0, 470.0, 1310.0, 840.0, 480.0, 820.0, 1130.0, 955.0, 565.0, 715.0, 1370.0, 980.0, 790.0, 1300.0, 480.0, 1440.0, 1590.0, 400.0, 1580.0, 1555.0, 1060.0, 1460.0, 1135.0, 1080.0, 1010.0, 920.0, 500.0, 1350.0, 890.0, 1210.0, 690.0, 2070.0, 680.0, 720.0, 1045.0, 1700.0, 770.0, 450.0, 790.0, 1070.0, 445.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 100.0, 10.0, 50.0, 200.0, -20.0, -20.0, 30.0, 290.0, 260.0, 110.0, 20.0, 200.0, 120.0, 20.0, 360.0, 70.0, 150.0, 70.0, 0.0, 110.0, 70.0, -30.0, 60.0, -35.0, 140.0, 260.0, 110.0, 100.0, 70.0, 20.0, 50.0, 0.0, 460.0, 40.0, 70.0, 30.0, 60.0, 90.0, 340.0, 100.0, 100.0, 150.0, 190.0, 20.0, 80.0, 20.0, -20.0, 340.0, 190.0, -80.0, 100.0, 10.0, 40.0, 600.0, 60.0, 30.0, 390.0, -20.0, 80.0, 370.0, 110.0, 150.0, 90.0, 120.0, 30.0, 50.0, 220.0, 110.0, 230.0, 20.0, -100.0, 0.0, 50.0, 30.0, 80.0, 260.0, -30.0, 410.0, 0.0, 80.0, 60.0, 80.0, 90.0, 40.0, 30.0, 130.0, -30.0, 170.0, 200.0, -10.0, 20.0, 80.0, 20.0, 0.0, 40.0, 90.0, 160.0, 300.0, 80.0, -15.0, 90.0, 90.0, 10.0, 40.0, 160.0, 20.0, 110.0, 40.0, 30.0, 50.0, 20.0, 30.0, 300.0, 340.0, 40.0, 300.0, 90.0, 110.0, 130.0, 0.0, 400.0, 10.0, 70.0, 0.0, 20.0, 30.0, -20.0, 40.0, 130.0, 110.0, 170.0, 80.0, 10.0, 100.0, 20.0, 100.0, 150.0, 90.0, 40.0, 70.0, 110.0, 30.0, 40.0, 120.0, 120.0, 620.0, 80.0, 50.0, 90.0, 230.0, 20.0, 120.0, -10.0, 50.0, 170.0, 110.0, 100.0, 220.0, 330.0, 90.0, 20.0, 80.0, 70.0, 80.0, 80.0, 500.0, 70.0, 30.0, 60.0, 10.0, 20.0, 170.0, 50.0, -20.0, 10.0, 0.0, 40.0, 60.0, 30.0, 60.0, 30.0, 10.0, 50.0, 650.0, 270.0, 290.0, 310.0, 30.0, 210.0, 25.0, 10.0, 70.0, 20.0, 50.0, 30.0, 0.0, 170.0, 20.0, 130.0, 60.0, 260.0, 10.0, 190.0, 130.0, 30.0, 140.0, 100.0, 20.0, 80.0, 120.0, 120.0, 0.0, 470.0, 120.0, -20.0, 90.0, 20.0, 130.0, 110.0, 20.0, 210.0, 70.0, 150.0, 40.0, 40.0, 30.0, 50.0, 400.0, 30.0, 140.0, 40.0, 35.0, 40.0, 310.0, 80.0, 40.0, 20.0, 90.0, 0.0, 210.0, 60.0, 280.0, 40.0, 120.0, 190.0, 0.0, 450.0, -10.0, 30.0, 100.0, 130.0, 200.0, 80.0, 110.0, 380.0, 80.0, 70.0, 60.0, 80.0, 410.0, 10.0, 240.0, 110.0, 50.0, 40.0, 90.0, -40.0, 210.0, 120.0, 40.0, 170.0, 290.0, 20.0, 50.0, 90.0, 0.0, 0.0, 0.0, 60.0, -10.0, 110.0, 270.0, -30.0, 130.0, 120.0, 70.0, 50.0, 350.0, 660.0, 110.0, 70.0, 0.0, 0.0, 150.0, 20.0, 110.0, 180.0, 170.0, 30.0, 60.0, 10.0, 110.0, 20.0, 170.0, 280.0, 480.0, 80.0, 140.0, 170.0, 270.0, 0.0, 10.0, 50.0, 80.0, 20.0, 10.0, 120.0, 60.0, 10.0, 10.0, 60.0, 500.0, 60.0, 30.0, 190.0, 40.0, 190.0, -170.0, 440.0, 70.0, -50.0, 180.0, 90.0, 300.0, 60.0, -60.0, 0.0, 70.0, -20.0, 40.0, 130.0, 170.0, 40.0, 140.0, 70.0, 60.0, 10.0, 50.0, 30.0, 180.0, 50.0, 80.0, 60.0, 20.0, 70.0, 60.0, 40.0, 250.0, 450.0, 160.0, 90.0, 180.0, 30.0, 90.0, 40.0, 50.0, 260.0, 70.0, 50.0, 120.0, 60.0, 110.0, 110.0, 50.0, 150.0, 120.0, 360.0, 70.0, 20.0, 30.0, 70.0, 80.0, 40.0, 70.0, 40.0, 10.0, 40.0, 60.0, 120.0, 20.0, 70.0, 130.0, 40.0, 80.0, -20.0, 180.0, 230.0, 380.0, 130.0, 170.0, 140.0, 10.0, 60.0, 30.0, 100.0, 10.0, 310.0, 40.0, 190.0, 360.0, 180.0, 80.0, 90.0, 200.0, 180.0, 40.0, 70.0, 30.0, 80.0, 60.0, 300.0, 90.0, 210.0, 100.0, 50.0, 90.0, 120.0, 70.0, 250.0, 265.0, 210.0, 90.0, 10.0, 160.0, 30.0, 100.0, 10.0, 20.0, 80.0, 110.0, 10.0, 120.0, 220.0, 160.0, 100.0, 110.0, 170.0, 0.0, 180.0, 120.0, 60.0, 320.0, 90.0, 55.0, 40.0, 320.0, 90.0, 340.0, 0.0, 60.0, 70.0, 130.0, 380.0, 70.0, 20.0, -200.0, 30.0, 50.0, 390.0, 40.0, 310.0, 90.0, 170.0, 40.0, 30.0, -20.0, 70.0, 50.0, 170.0, 90.0, 50.0, 370.0, 90.0, 100.0, 120.0, 80.0, 50.0, 540.0, 390.0, 80.0, 40.0, 70.0, 390.0, 110.0, 70.0, 30.0, 30.0, 340.0, 60.0, 20.0, 40.0, 25.0, 20.0, 0.0, 220.0, 35.0, -5.0, 20.0, 20.0, 80.0, 20.0, 150.0, 10.0, 10.0, 30.0, 5.0, 30.0, -40.0, 20.0, 90.0, 90.0, -20.0, 50.0, 390.0, 40.0, 200.0, 40.0, 100.0, 200.0, 70.0, 180.0, -90.0, 120.0, 190.0, 570.0, 30.0, -20.0, 10.0, -20.0, 290.0, 40.0, 90.0, 105.0, 60.0, 110.0, 140.0, 190.0, 20.0, 350.0, 70.0, 640.0, 90.0, 20.0, 30.0, 120.0, 100.0, 20.0, 140.0, 40.0, 30.0, 70.0, 0.0, 80.0, 30.0, 20.0, 40.0, 0.0, 80.0, 160.0, 10.0, 80.0, 160.0, 0.0, -40.0, 70.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 0.0, 380.0, -90.0, -35.0, 0.0, 50.0, 100.0, 170.0, 70.0, 80.0, 100.0, 80.0, 300.0, 210.0, 210.0, 30.0, 160.0, 0.0, 40.0, 150.0, 0.0, 40.0, 90.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 30.0, 60.0, 200.0, 340.0, 170.0, 80.0, 150.0, 70.0, 200.0, 390.0, 0.0, 10.0, 180.0, 60.0, 30.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 40.0, 70.0, 170.0, 60.0, 60.0, 30.0, 20.0, 20.0, 100.0, 20.0, 10.0, 0.0, 320.0, -30.0, 60.0, 250.0, 20.0, 70.0, 50.0, 130.0, 10.0, 80.0, 190.0, 50.0, 80.0, 150.0, 330.0, 60.0, 180.0, 30.0, 90.0, 100.0, 190.0, 30.0, 100.0, 25.0, 150.0, 60.0, 70.0, -20.0, 120.0, 80.0, 70.0, -75.0, 70.0, -10.0, 190.0, 70.0, 45.0, 330.0, 40.0, 60.0, 40.0, 0.0, 20.0, 180.0, 0.0, 0.0, 10.0, 100.0, 240.0, 40.0, 460.0, 180.0, 40.0, 190.0, 80.0, 30.0, 0.0, 90.0, 100.0, 20.0, 0.0, 450.0, 60.0, 80.0, -20.0, 200.0, 310.0, 10.0, 50.0, 80.0, 200.0, 30.0, -40.0, 70.0, 0.0, 80.0, 60.0, 100.0, 190.0, 330.0, 180.0, 110.0, 100.0, 40.0, 180.0, 10.0, 40.0, 0.0, 180.0, 50.0, 30.0, 40.0, -225.0, 70.0, -65.0, 360.0, 310.0, 50.0, 40.0, 20.0, 200.0, 40.0, 50.0, 110.0, 300.0, 320.0, 110.0, 200.0, 0.0, 280.0, 20.0, 280.0, 40.0, 360.0, 130.0, 170.0, 60.0, 70.0, 30.0, 10.0, 70.0, 20.0, 0.0, 40.0, 60.0, 40.0, 30.0, 260.0, 170.0, 180.0, 30.0, 510.0, 70.0, 20.0, 200.0, 110.0, 480.0, 90.0, 20.0, 165.0, 220.0, 50.0, 200.0, 50.0, 170.0, 110.0, 190.0, 110.0, 20.0, 0.0, 280.0, 100.0, 40.0, 250.0, 10.0, 60.0, 210.0, 270.0, 30.0, 30.0, 120.0, 110.0, 40.0, 370.0, 40.0, 240.0, 100.0, 5.0, 140.0, 120.0, 150.0, 50.0, 40.0, 130.0, 310.0, 90.0, 70.0, 180.0, 30.0, 380.0, 60.0, 50.0, 20.0, 30.0, 230.0, 30.0, 150.0, 60.0, 40.0, 50.0, 10.0, 180.0, 60.0, 110.0, 230.0, 120.0, 20.0, 180.0, 180.0, 290.0, 80.0, 80.0, 40.0, 0.0, -100.0, 150.0, 30.0, 90.0, 40.0, 40.0, 90.0, 140.0, 0.0, 30.0, 20.0, 20.0, 40.0, 290.0, 70.0, 0.0, 220.0, 30.0, 50.0, 60.0, 310.0, 280.0, 200.0, 20.0, 210.0, 0.0, 90.0, 30.0, 110.0, 40.0, 40.0, 150.0, 120.0, 170.0, 310.0, 170.0, 0.0, 210.0, 70.0, 80.0, 30.0, 50.0, 190.0, 90.0, 70.0, 60.0, 60.0, -40.0, 50.0, 80.0, 80.0, 50.0, 210.0, 40.0, 120.0, 0.0, 80.0, 120.0, 200.0, 440.0, 810.0, 50.0, 20.0, 200.0, 70.0, 10.0, 80.0, 60.0, 30.0, 60.0, 70.0, 80.0, 70.0, 10.0, 200.0, 40.0, 90.0, 30.0, 80.0, 90.0, 50.0, 60.0, 40.0, 10.0, 50.0, 120.0, 320.0, 60.0, 190.0, 15.0, 190.0, 50.0, 90.0, 30.0, 20.0, 760.0, 110.0, 270.0, 200.0, 180.0, 20.0, 20.0, 20.0, 190.0, 30.0, 50.0, 10.0, 20.0, 300.0, 110.0, 40.0, 0.0, 20.0, 20.0, 50.0, 10.0, 100.0, 80.0, 10.0, 40.0, 30.0, 90.0, 10.0, 200.0, 30.0, 160.0, 10.0, 160.0, 10.0, 160.0, 50.0, 0.0, 0.0, 70.0, -10.0, 60.0, -80.0, 0.0, 310.0, 580.0, 100.0, 40.0, 60.0, 20.0, 90.0, -15.0, 0.0, 30.0, 50.0, 20.0, 150.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.685756127738232, "mean_inference_ms": 1.4927168218113374, "mean_action_processing_ms": 0.43267561667332466, "mean_env_wait_ms": 1.3523539187797886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01305842399597168, "StateBufferConnector_ms": 0.010413408279418945, "ViewRequirementAgentConnector_ms": 0.41522812843322754}, "num_episodes": 18, "episode_return_max": 2070.0, "episode_return_min": 315.0, "episode_return_mean": 1023.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.18855534401803, "num_env_steps_trained_throughput_per_sec": 19.18855534401803, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 208979.057, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208979.016, "sample_time_ms": 2696.714, "learn_time_ms": 206261.944, "learn_throughput": 19.393, "synch_weights_time_ms": 11.52}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 68, "trial_id": "aa996_00000", "date": "2024-05-24_02-41-43", "timestamp": 1716532903, "time_this_iter_s": 208.4698121547699, "time_total_s": 14169.958733320236, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dc3ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14169.958733320236, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 19.250169491525423, "ram_util_percent": 78.97932203389831}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6556760305032943, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.929613928292125, "policy_loss": -0.006828316248937473, "vf_loss": 5.9352753743830835, "vf_explained_var": -0.0005929709813846186, "kl": 0.005834340035396186, "entropy": 0.42340099025712097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 643215.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "env_runners": {"episode_reward_max": 2070.0, "episode_reward_min": 260.0, "episode_reward_mean": 986.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 98.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1910.0, 525.0, 1020.0, 1160.0, 1040.0, 795.0, 1370.0, 1290.0, 1240.0, 720.0, 1720.0, 840.0, 1520.0, 630.0, 1350.0, 640.0, 740.0, 1260.0, 1020.0, 1170.0, 560.0, 1240.0, 1060.0, 1310.0, 1340.0, 975.0, 1180.0, 1435.0, 1000.0, 950.0, 1880.0, 1220.0, 395.0, 315.0, 1180.0, 1040.0, 1395.0, 1270.0, 510.0, 370.0, 595.0, 1240.0, 470.0, 1310.0, 840.0, 480.0, 820.0, 1130.0, 955.0, 565.0, 715.0, 1370.0, 980.0, 790.0, 1300.0, 480.0, 1440.0, 1590.0, 400.0, 1580.0, 1555.0, 1060.0, 1460.0, 1135.0, 1080.0, 1010.0, 920.0, 500.0, 1350.0, 890.0, 1210.0, 690.0, 2070.0, 680.0, 720.0, 1045.0, 1700.0, 770.0, 450.0, 790.0, 1070.0, 445.0, 700.0, 290.0, 1350.0, 800.0, 1300.0, 1030.0, 670.0, 1270.0, 510.0, 1140.0, 600.0, 960.0, 940.0, 940.0, 660.0, 490.0, 260.0, 500.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 30.0, 10.0, 50.0, 650.0, 270.0, 290.0, 310.0, 30.0, 210.0, 25.0, 10.0, 70.0, 20.0, 50.0, 30.0, 0.0, 170.0, 20.0, 130.0, 60.0, 260.0, 10.0, 190.0, 130.0, 30.0, 140.0, 100.0, 20.0, 80.0, 120.0, 120.0, 0.0, 470.0, 120.0, -20.0, 90.0, 20.0, 130.0, 110.0, 20.0, 210.0, 70.0, 150.0, 40.0, 40.0, 30.0, 50.0, 400.0, 30.0, 140.0, 40.0, 35.0, 40.0, 310.0, 80.0, 40.0, 20.0, 90.0, 0.0, 210.0, 60.0, 280.0, 40.0, 120.0, 190.0, 0.0, 450.0, -10.0, 30.0, 100.0, 130.0, 200.0, 80.0, 110.0, 380.0, 80.0, 70.0, 60.0, 80.0, 410.0, 10.0, 240.0, 110.0, 50.0, 40.0, 90.0, -40.0, 210.0, 120.0, 40.0, 170.0, 290.0, 20.0, 50.0, 90.0, 0.0, 0.0, 0.0, 60.0, -10.0, 110.0, 270.0, -30.0, 130.0, 120.0, 70.0, 50.0, 350.0, 660.0, 110.0, 70.0, 0.0, 0.0, 150.0, 20.0, 110.0, 180.0, 170.0, 30.0, 60.0, 10.0, 110.0, 20.0, 170.0, 280.0, 480.0, 80.0, 140.0, 170.0, 270.0, 0.0, 10.0, 50.0, 80.0, 20.0, 10.0, 120.0, 60.0, 10.0, 10.0, 60.0, 500.0, 60.0, 30.0, 190.0, 40.0, 190.0, -170.0, 440.0, 70.0, -50.0, 180.0, 90.0, 300.0, 60.0, -60.0, 0.0, 70.0, -20.0, 40.0, 130.0, 170.0, 40.0, 140.0, 70.0, 60.0, 10.0, 50.0, 30.0, 180.0, 50.0, 80.0, 60.0, 20.0, 70.0, 60.0, 40.0, 250.0, 450.0, 160.0, 90.0, 180.0, 30.0, 90.0, 40.0, 50.0, 260.0, 70.0, 50.0, 120.0, 60.0, 110.0, 110.0, 50.0, 150.0, 120.0, 360.0, 70.0, 20.0, 30.0, 70.0, 80.0, 40.0, 70.0, 40.0, 10.0, 40.0, 60.0, 120.0, 20.0, 70.0, 130.0, 40.0, 80.0, -20.0, 180.0, 230.0, 380.0, 130.0, 170.0, 140.0, 10.0, 60.0, 30.0, 100.0, 10.0, 310.0, 40.0, 190.0, 360.0, 180.0, 80.0, 90.0, 200.0, 180.0, 40.0, 70.0, 30.0, 80.0, 60.0, 300.0, 90.0, 210.0, 100.0, 50.0, 90.0, 120.0, 70.0, 250.0, 265.0, 210.0, 90.0, 10.0, 160.0, 30.0, 100.0, 10.0, 20.0, 80.0, 110.0, 10.0, 120.0, 220.0, 160.0, 100.0, 110.0, 170.0, 0.0, 180.0, 120.0, 60.0, 320.0, 90.0, 55.0, 40.0, 320.0, 90.0, 340.0, 0.0, 60.0, 70.0, 130.0, 380.0, 70.0, 20.0, -200.0, 30.0, 50.0, 390.0, 40.0, 310.0, 90.0, 170.0, 40.0, 30.0, -20.0, 70.0, 50.0, 170.0, 90.0, 50.0, 370.0, 90.0, 100.0, 120.0, 80.0, 50.0, 540.0, 390.0, 80.0, 40.0, 70.0, 390.0, 110.0, 70.0, 30.0, 30.0, 340.0, 60.0, 20.0, 40.0, 25.0, 20.0, 0.0, 220.0, 35.0, -5.0, 20.0, 20.0, 80.0, 20.0, 150.0, 10.0, 10.0, 30.0, 5.0, 30.0, -40.0, 20.0, 90.0, 90.0, -20.0, 50.0, 390.0, 40.0, 200.0, 40.0, 100.0, 200.0, 70.0, 180.0, -90.0, 120.0, 190.0, 570.0, 30.0, -20.0, 10.0, -20.0, 290.0, 40.0, 90.0, 105.0, 60.0, 110.0, 140.0, 190.0, 20.0, 350.0, 70.0, 640.0, 90.0, 20.0, 30.0, 120.0, 100.0, 20.0, 140.0, 40.0, 30.0, 70.0, 0.0, 80.0, 30.0, 20.0, 40.0, 0.0, 80.0, 160.0, 10.0, 80.0, 160.0, 0.0, -40.0, 70.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 0.0, 380.0, -90.0, -35.0, 0.0, 50.0, 100.0, 170.0, 70.0, 80.0, 100.0, 80.0, 300.0, 210.0, 210.0, 30.0, 160.0, 0.0, 40.0, 150.0, 0.0, 40.0, 90.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 30.0, 60.0, 200.0, 340.0, 170.0, 80.0, 150.0, 70.0, 200.0, 390.0, 0.0, 10.0, 180.0, 60.0, 30.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 40.0, 70.0, 170.0, 60.0, 60.0, 30.0, 20.0, 20.0, 100.0, 20.0, 10.0, 0.0, 320.0, -30.0, 60.0, 250.0, 20.0, 70.0, 50.0, 130.0, 10.0, 80.0, 190.0, 50.0, 80.0, 150.0, 330.0, 60.0, 180.0, 30.0, 90.0, 100.0, 190.0, 30.0, 100.0, 25.0, 150.0, 60.0, 70.0, -20.0, 120.0, 80.0, 70.0, -75.0, 70.0, -10.0, 190.0, 70.0, 45.0, 330.0, 40.0, 60.0, 40.0, 0.0, 20.0, 180.0, 0.0, 0.0, 10.0, 100.0, 240.0, 40.0, 460.0, 180.0, 40.0, 190.0, 80.0, 30.0, 0.0, 90.0, 100.0, 20.0, 0.0, 450.0, 60.0, 80.0, -20.0, 200.0, 310.0, 10.0, 50.0, 80.0, 200.0, 30.0, -40.0, 70.0, 0.0, 80.0, 60.0, 100.0, 190.0, 330.0, 180.0, 110.0, 100.0, 40.0, 180.0, 10.0, 40.0, 0.0, 180.0, 50.0, 30.0, 40.0, -225.0, 70.0, -65.0, 360.0, 310.0, 50.0, 40.0, 20.0, 200.0, 40.0, 50.0, 110.0, 300.0, 320.0, 110.0, 200.0, 0.0, 280.0, 20.0, 280.0, 40.0, 360.0, 130.0, 170.0, 60.0, 70.0, 30.0, 10.0, 70.0, 20.0, 0.0, 40.0, 60.0, 40.0, 30.0, 260.0, 170.0, 180.0, 30.0, 510.0, 70.0, 20.0, 200.0, 110.0, 480.0, 90.0, 20.0, 165.0, 220.0, 50.0, 200.0, 50.0, 170.0, 110.0, 190.0, 110.0, 20.0, 0.0, 280.0, 100.0, 40.0, 250.0, 10.0, 60.0, 210.0, 270.0, 30.0, 30.0, 120.0, 110.0, 40.0, 370.0, 40.0, 240.0, 100.0, 5.0, 140.0, 120.0, 150.0, 50.0, 40.0, 130.0, 310.0, 90.0, 70.0, 180.0, 30.0, 380.0, 60.0, 50.0, 20.0, 30.0, 230.0, 30.0, 150.0, 60.0, 40.0, 50.0, 10.0, 180.0, 60.0, 110.0, 230.0, 120.0, 20.0, 180.0, 180.0, 290.0, 80.0, 80.0, 40.0, 0.0, -100.0, 150.0, 30.0, 90.0, 40.0, 40.0, 90.0, 140.0, 0.0, 30.0, 20.0, 20.0, 40.0, 290.0, 70.0, 0.0, 220.0, 30.0, 50.0, 60.0, 310.0, 280.0, 200.0, 20.0, 210.0, 0.0, 90.0, 30.0, 110.0, 40.0, 40.0, 150.0, 120.0, 170.0, 310.0, 170.0, 0.0, 210.0, 70.0, 80.0, 30.0, 50.0, 190.0, 90.0, 70.0, 60.0, 60.0, -40.0, 50.0, 80.0, 80.0, 50.0, 210.0, 40.0, 120.0, 0.0, 80.0, 120.0, 200.0, 440.0, 810.0, 50.0, 20.0, 200.0, 70.0, 10.0, 80.0, 60.0, 30.0, 60.0, 70.0, 80.0, 70.0, 10.0, 200.0, 40.0, 90.0, 30.0, 80.0, 90.0, 50.0, 60.0, 40.0, 10.0, 50.0, 120.0, 320.0, 60.0, 190.0, 15.0, 190.0, 50.0, 90.0, 30.0, 20.0, 760.0, 110.0, 270.0, 200.0, 180.0, 20.0, 20.0, 20.0, 190.0, 30.0, 50.0, 10.0, 20.0, 300.0, 110.0, 40.0, 0.0, 20.0, 20.0, 50.0, 10.0, 100.0, 80.0, 10.0, 40.0, 30.0, 90.0, 10.0, 200.0, 30.0, 160.0, 10.0, 160.0, 10.0, 160.0, 50.0, 0.0, 0.0, 70.0, -10.0, 60.0, -80.0, 0.0, 310.0, 580.0, 100.0, 40.0, 60.0, 20.0, 90.0, -15.0, 0.0, 30.0, 50.0, 20.0, 150.0, 40.0, 220.0, 100.0, 40.0, 70.0, 60.0, 60.0, 80.0, 40.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 10.0, 160.0, 0.0, 80.0, 180.0, 40.0, 130.0, 60.0, 80.0, 210.0, 310.0, 160.0, 100.0, 100.0, 0.0, 80.0, 120.0, 300.0, 140.0, 50.0, -20.0, 20.0, 10.0, 60.0, 130.0, 80.0, 160.0, 190.0, 40.0, 410.0, 110.0, 70.0, 50.0, 30.0, 70.0, 30.0, 200.0, 10.0, 120.0, 0.0, 20.0, 380.0, 170.0, 0.0, 40.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 160.0, 80.0, 190.0, 90.0, 70.0, 70.0, 10.0, 370.0, 20.0, 160.0, 10.0, 280.0, 170.0, 10.0, 20.0, 160.0, 0.0, 10.0, 30.0, 0.0, 90.0, 20.0, -20.0, 90.0, 70.0, 70.0, 330.0, 10.0, 170.0, 330.0, 0.0, 90.0, 300.0, 50.0, 60.0, 80.0, -290.0, 30.0, 300.0, 30.0, 20.0, 20.0, 20.0, 80.0, 30.0, 30.0, 20.0, 70.0, 50.0, 500.0, 80.0, 80.0, 190.0, 210.0, 80.0, 30.0, 70.0, 20.0, 10.0, 90.0, 80.0, 160.0, 20.0, 40.0, 70.0, -40.0, 260.0, 40.0, 300.0, 10.0, 140.0, 100.0, 90.0, 0.0, 80.0, 30.0, 30.0, 40.0, 80.0, 150.0, 50.0, 110.0, 20.0, 30.0, 20.0, 210.0, 40.0, 50.0, 0.0, 10.0, 40.0, 70.0, 20.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 0.0, 0.0, 50.0, 90.0, 10.0, 0.0, 70.0, 150.0, 100.0, 10.0, 20.0, 0.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6843299342177158, "mean_inference_ms": 1.4927267580085875, "mean_action_processing_ms": 0.43242570209234754, "mean_env_wait_ms": 1.3522478190562657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012663602828979492, "StateBufferConnector_ms": 0.01015329360961914, "ViewRequirementAgentConnector_ms": 0.4112281799316406}, "num_episodes": 18, "episode_return_max": 2070.0, "episode_return_min": 260.0, "episode_return_mean": 986.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.177282670132506, "num_env_steps_trained_throughput_per_sec": 19.177282670132506, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 2760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2760000, "timers": {"training_iteration_time_ms": 208808.964, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208808.922, "sample_time_ms": 2682.898, "learn_time_ms": 206105.762, "learn_throughput": 19.408, "synch_weights_time_ms": 11.537}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "done": false, "training_iteration": 69, "trial_id": "aa996_00000", "date": "2024-05-24_02-45-11", "timestamp": 1716533111, "time_this_iter_s": 208.58777499198914, "time_total_s": 14378.546508312225, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x16003e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14378.546508312225, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 19.132542372881353, "ram_util_percent": 79.03016949152543}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8149207776410385, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.784002298389634, "policy_loss": -0.007581644702374963, "vf_loss": 6.790318605973444, "vf_explained_var": 0.00045026076106598586, "kl": 0.006326674477916653, "entropy": 0.4368103418074731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 652605.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 2070.0, "episode_reward_min": 250.0, "episode_reward_mean": 948.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -360.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 94.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1020.0, 1170.0, 560.0, 1240.0, 1060.0, 1310.0, 1340.0, 975.0, 1180.0, 1435.0, 1000.0, 950.0, 1880.0, 1220.0, 395.0, 315.0, 1180.0, 1040.0, 1395.0, 1270.0, 510.0, 370.0, 595.0, 1240.0, 470.0, 1310.0, 840.0, 480.0, 820.0, 1130.0, 955.0, 565.0, 715.0, 1370.0, 980.0, 790.0, 1300.0, 480.0, 1440.0, 1590.0, 400.0, 1580.0, 1555.0, 1060.0, 1460.0, 1135.0, 1080.0, 1010.0, 920.0, 500.0, 1350.0, 890.0, 1210.0, 690.0, 2070.0, 680.0, 720.0, 1045.0, 1700.0, 770.0, 450.0, 790.0, 1070.0, 445.0, 700.0, 290.0, 1350.0, 800.0, 1300.0, 1030.0, 670.0, 1270.0, 510.0, 1140.0, 600.0, 960.0, 940.0, 940.0, 660.0, 490.0, 260.0, 500.0, 290.0, 1330.0, 1470.0, 810.0, 890.0, 1500.0, 985.0, 310.0, 950.0, 260.0, 900.0, 1140.0, 1130.0, 580.0, 1240.0, 1230.0, 250.0, 710.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [160.0, 90.0, 180.0, 30.0, 90.0, 40.0, 50.0, 260.0, 70.0, 50.0, 120.0, 60.0, 110.0, 110.0, 50.0, 150.0, 120.0, 360.0, 70.0, 20.0, 30.0, 70.0, 80.0, 40.0, 70.0, 40.0, 10.0, 40.0, 60.0, 120.0, 20.0, 70.0, 130.0, 40.0, 80.0, -20.0, 180.0, 230.0, 380.0, 130.0, 170.0, 140.0, 10.0, 60.0, 30.0, 100.0, 10.0, 310.0, 40.0, 190.0, 360.0, 180.0, 80.0, 90.0, 200.0, 180.0, 40.0, 70.0, 30.0, 80.0, 60.0, 300.0, 90.0, 210.0, 100.0, 50.0, 90.0, 120.0, 70.0, 250.0, 265.0, 210.0, 90.0, 10.0, 160.0, 30.0, 100.0, 10.0, 20.0, 80.0, 110.0, 10.0, 120.0, 220.0, 160.0, 100.0, 110.0, 170.0, 0.0, 180.0, 120.0, 60.0, 320.0, 90.0, 55.0, 40.0, 320.0, 90.0, 340.0, 0.0, 60.0, 70.0, 130.0, 380.0, 70.0, 20.0, -200.0, 30.0, 50.0, 390.0, 40.0, 310.0, 90.0, 170.0, 40.0, 30.0, -20.0, 70.0, 50.0, 170.0, 90.0, 50.0, 370.0, 90.0, 100.0, 120.0, 80.0, 50.0, 540.0, 390.0, 80.0, 40.0, 70.0, 390.0, 110.0, 70.0, 30.0, 30.0, 340.0, 60.0, 20.0, 40.0, 25.0, 20.0, 0.0, 220.0, 35.0, -5.0, 20.0, 20.0, 80.0, 20.0, 150.0, 10.0, 10.0, 30.0, 5.0, 30.0, -40.0, 20.0, 90.0, 90.0, -20.0, 50.0, 390.0, 40.0, 200.0, 40.0, 100.0, 200.0, 70.0, 180.0, -90.0, 120.0, 190.0, 570.0, 30.0, -20.0, 10.0, -20.0, 290.0, 40.0, 90.0, 105.0, 60.0, 110.0, 140.0, 190.0, 20.0, 350.0, 70.0, 640.0, 90.0, 20.0, 30.0, 120.0, 100.0, 20.0, 140.0, 40.0, 30.0, 70.0, 0.0, 80.0, 30.0, 20.0, 40.0, 0.0, 80.0, 160.0, 10.0, 80.0, 160.0, 0.0, -40.0, 70.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 0.0, 380.0, -90.0, -35.0, 0.0, 50.0, 100.0, 170.0, 70.0, 80.0, 100.0, 80.0, 300.0, 210.0, 210.0, 30.0, 160.0, 0.0, 40.0, 150.0, 0.0, 40.0, 90.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 30.0, 60.0, 200.0, 340.0, 170.0, 80.0, 150.0, 70.0, 200.0, 390.0, 0.0, 10.0, 180.0, 60.0, 30.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 40.0, 70.0, 170.0, 60.0, 60.0, 30.0, 20.0, 20.0, 100.0, 20.0, 10.0, 0.0, 320.0, -30.0, 60.0, 250.0, 20.0, 70.0, 50.0, 130.0, 10.0, 80.0, 190.0, 50.0, 80.0, 150.0, 330.0, 60.0, 180.0, 30.0, 90.0, 100.0, 190.0, 30.0, 100.0, 25.0, 150.0, 60.0, 70.0, -20.0, 120.0, 80.0, 70.0, -75.0, 70.0, -10.0, 190.0, 70.0, 45.0, 330.0, 40.0, 60.0, 40.0, 0.0, 20.0, 180.0, 0.0, 0.0, 10.0, 100.0, 240.0, 40.0, 460.0, 180.0, 40.0, 190.0, 80.0, 30.0, 0.0, 90.0, 100.0, 20.0, 0.0, 450.0, 60.0, 80.0, -20.0, 200.0, 310.0, 10.0, 50.0, 80.0, 200.0, 30.0, -40.0, 70.0, 0.0, 80.0, 60.0, 100.0, 190.0, 330.0, 180.0, 110.0, 100.0, 40.0, 180.0, 10.0, 40.0, 0.0, 180.0, 50.0, 30.0, 40.0, -225.0, 70.0, -65.0, 360.0, 310.0, 50.0, 40.0, 20.0, 200.0, 40.0, 50.0, 110.0, 300.0, 320.0, 110.0, 200.0, 0.0, 280.0, 20.0, 280.0, 40.0, 360.0, 130.0, 170.0, 60.0, 70.0, 30.0, 10.0, 70.0, 20.0, 0.0, 40.0, 60.0, 40.0, 30.0, 260.0, 170.0, 180.0, 30.0, 510.0, 70.0, 20.0, 200.0, 110.0, 480.0, 90.0, 20.0, 165.0, 220.0, 50.0, 200.0, 50.0, 170.0, 110.0, 190.0, 110.0, 20.0, 0.0, 280.0, 100.0, 40.0, 250.0, 10.0, 60.0, 210.0, 270.0, 30.0, 30.0, 120.0, 110.0, 40.0, 370.0, 40.0, 240.0, 100.0, 5.0, 140.0, 120.0, 150.0, 50.0, 40.0, 130.0, 310.0, 90.0, 70.0, 180.0, 30.0, 380.0, 60.0, 50.0, 20.0, 30.0, 230.0, 30.0, 150.0, 60.0, 40.0, 50.0, 10.0, 180.0, 60.0, 110.0, 230.0, 120.0, 20.0, 180.0, 180.0, 290.0, 80.0, 80.0, 40.0, 0.0, -100.0, 150.0, 30.0, 90.0, 40.0, 40.0, 90.0, 140.0, 0.0, 30.0, 20.0, 20.0, 40.0, 290.0, 70.0, 0.0, 220.0, 30.0, 50.0, 60.0, 310.0, 280.0, 200.0, 20.0, 210.0, 0.0, 90.0, 30.0, 110.0, 40.0, 40.0, 150.0, 120.0, 170.0, 310.0, 170.0, 0.0, 210.0, 70.0, 80.0, 30.0, 50.0, 190.0, 90.0, 70.0, 60.0, 60.0, -40.0, 50.0, 80.0, 80.0, 50.0, 210.0, 40.0, 120.0, 0.0, 80.0, 120.0, 200.0, 440.0, 810.0, 50.0, 20.0, 200.0, 70.0, 10.0, 80.0, 60.0, 30.0, 60.0, 70.0, 80.0, 70.0, 10.0, 200.0, 40.0, 90.0, 30.0, 80.0, 90.0, 50.0, 60.0, 40.0, 10.0, 50.0, 120.0, 320.0, 60.0, 190.0, 15.0, 190.0, 50.0, 90.0, 30.0, 20.0, 760.0, 110.0, 270.0, 200.0, 180.0, 20.0, 20.0, 20.0, 190.0, 30.0, 50.0, 10.0, 20.0, 300.0, 110.0, 40.0, 0.0, 20.0, 20.0, 50.0, 10.0, 100.0, 80.0, 10.0, 40.0, 30.0, 90.0, 10.0, 200.0, 30.0, 160.0, 10.0, 160.0, 10.0, 160.0, 50.0, 0.0, 0.0, 70.0, -10.0, 60.0, -80.0, 0.0, 310.0, 580.0, 100.0, 40.0, 60.0, 20.0, 90.0, -15.0, 0.0, 30.0, 50.0, 20.0, 150.0, 40.0, 220.0, 100.0, 40.0, 70.0, 60.0, 60.0, 80.0, 40.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 10.0, 160.0, 0.0, 80.0, 180.0, 40.0, 130.0, 60.0, 80.0, 210.0, 310.0, 160.0, 100.0, 100.0, 0.0, 80.0, 120.0, 300.0, 140.0, 50.0, -20.0, 20.0, 10.0, 60.0, 130.0, 80.0, 160.0, 190.0, 40.0, 410.0, 110.0, 70.0, 50.0, 30.0, 70.0, 30.0, 200.0, 10.0, 120.0, 0.0, 20.0, 380.0, 170.0, 0.0, 40.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 160.0, 80.0, 190.0, 90.0, 70.0, 70.0, 10.0, 370.0, 20.0, 160.0, 10.0, 280.0, 170.0, 10.0, 20.0, 160.0, 0.0, 10.0, 30.0, 0.0, 90.0, 20.0, -20.0, 90.0, 70.0, 70.0, 330.0, 10.0, 170.0, 330.0, 0.0, 90.0, 300.0, 50.0, 60.0, 80.0, -290.0, 30.0, 300.0, 30.0, 20.0, 20.0, 20.0, 80.0, 30.0, 30.0, 20.0, 70.0, 50.0, 500.0, 80.0, 80.0, 190.0, 210.0, 80.0, 30.0, 70.0, 20.0, 10.0, 90.0, 80.0, 160.0, 20.0, 40.0, 70.0, -40.0, 260.0, 40.0, 300.0, 10.0, 140.0, 100.0, 90.0, 0.0, 80.0, 30.0, 30.0, 40.0, 80.0, 150.0, 50.0, 110.0, 20.0, 30.0, 20.0, 210.0, 40.0, 50.0, 0.0, 10.0, 40.0, 70.0, 20.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 0.0, 0.0, 50.0, 90.0, 10.0, 0.0, 70.0, 150.0, 100.0, 10.0, 20.0, 0.0, 50.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 70.0, 0.0, 90.0, 30.0, 160.0, 510.0, 200.0, 300.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 110.0, 280.0, 150.0, 170.0, 200.0, 130.0, 260.0, 20.0, 70.0, 80.0, 120.0, 70.0, 90.0, 120.0, 0.0, 100.0, 50.0, 180.0, 10.0, 70.0, 40.0, 20.0, 40.0, 90.0, 20.0, 480.0, 110.0, 10.0, 20.0, 60.0, 20.0, 160.0, 70.0, 70.0, 90.0, 110.0, 250.0, 100.0, 510.0, 120.0, 100.0, 60.0, 200.0, 190.0, -50.0, 60.0, 210.0, 140.0, 90.0, -15.0, 10.0, 30.0, 110.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 250.0, 110.0, 210.0, 50.0, 190.0, 40.0, 70.0, 10.0, 10.0, 0.0, 0.0, 70.0, 90.0, 10.0, 20.0, 40.0, 10.0, 170.0, 30.0, 40.0, -30.0, 30.0, 30.0, 590.0, 0.0, 40.0, 0.0, 40.0, 50.0, 50.0, 90.0, 60.0, 80.0, 100.0, 280.0, 300.0, 90.0, 100.0, 60.0, 90.0, -30.0, 400.0, 320.0, 80.0, 60.0, -20.0, 70.0, 30.0, -360.0, 110.0, 0.0, 260.0, 30.0, 260.0, 70.0, 100.0, 80.0, 290.0, 190.0, 20.0, -50.0, 40.0, 30.0, 420.0, 170.0, 50.0, 80.0, 50.0, 40.0, 190.0, 390.0, 120.0, 40.0, 140.0, 300.0, -90.0, 50.0, 0.0, 10.0, 170.0, 30.0, 30.0, -20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 50.0, 80.0, 50.0, 170.0, 160.0, 40.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6832951692437483, "mean_inference_ms": 1.4924107167821685, "mean_action_processing_ms": 0.4321730083679348, "mean_env_wait_ms": 1.3520480189809445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012772321701049805, "StateBufferConnector_ms": 0.010133743286132812, "ViewRequirementAgentConnector_ms": 0.41300511360168457}, "num_episodes": 18, "episode_return_max": 2070.0, "episode_return_min": 250.0, "episode_return_mean": 948.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.072942209049316, "num_env_steps_trained_throughput_per_sec": 19.072942209049316, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 208907.28, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208907.236, "sample_time_ms": 2707.876, "learn_time_ms": 206178.406, "learn_throughput": 19.401, "synch_weights_time_ms": 11.466}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 70, "trial_id": "aa996_00000", "date": "2024-05-24_02-48-41", "timestamp": 1716533321, "time_this_iter_s": 209.75757122039795, "time_total_s": 14588.304079532623, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd4ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14588.304079532623, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 19.67037037037037, "ram_util_percent": 79.28215488215488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7412003176407818, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.934999561005126, "policy_loss": -0.009231156368290607, "vf_loss": 6.942940820647251, "vf_explained_var": -0.00035567251257241346, "kl": 0.0064495099672366605, "entropy": 0.40674934393872086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 661995.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "env_runners": {"episode_reward_max": 2070.0, "episode_reward_min": 250.0, "episode_reward_mean": 945.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -360.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 94.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [595.0, 1240.0, 470.0, 1310.0, 840.0, 480.0, 820.0, 1130.0, 955.0, 565.0, 715.0, 1370.0, 980.0, 790.0, 1300.0, 480.0, 1440.0, 1590.0, 400.0, 1580.0, 1555.0, 1060.0, 1460.0, 1135.0, 1080.0, 1010.0, 920.0, 500.0, 1350.0, 890.0, 1210.0, 690.0, 2070.0, 680.0, 720.0, 1045.0, 1700.0, 770.0, 450.0, 790.0, 1070.0, 445.0, 700.0, 290.0, 1350.0, 800.0, 1300.0, 1030.0, 670.0, 1270.0, 510.0, 1140.0, 600.0, 960.0, 940.0, 940.0, 660.0, 490.0, 260.0, 500.0, 290.0, 1330.0, 1470.0, 810.0, 890.0, 1500.0, 985.0, 310.0, 950.0, 260.0, 900.0, 1140.0, 1130.0, 580.0, 1240.0, 1230.0, 250.0, 710.0, 825.0, 550.0, 1620.0, 800.0, 1060.0, 980.0, 1285.0, 1500.0, 1195.0, 1330.0, 830.0, 410.0, 1205.0, 1320.0, 610.0, 1285.0, 695.0, 1050.0, 750.0, 1480.0, 500.0, 1240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 0.0, 380.0, -90.0, -35.0, 0.0, 50.0, 100.0, 170.0, 70.0, 80.0, 100.0, 80.0, 300.0, 210.0, 210.0, 30.0, 160.0, 0.0, 40.0, 150.0, 0.0, 40.0, 90.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 30.0, 60.0, 200.0, 340.0, 170.0, 80.0, 150.0, 70.0, 200.0, 390.0, 0.0, 10.0, 180.0, 60.0, 30.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 40.0, 70.0, 170.0, 60.0, 60.0, 30.0, 20.0, 20.0, 100.0, 20.0, 10.0, 0.0, 320.0, -30.0, 60.0, 250.0, 20.0, 70.0, 50.0, 130.0, 10.0, 80.0, 190.0, 50.0, 80.0, 150.0, 330.0, 60.0, 180.0, 30.0, 90.0, 100.0, 190.0, 30.0, 100.0, 25.0, 150.0, 60.0, 70.0, -20.0, 120.0, 80.0, 70.0, -75.0, 70.0, -10.0, 190.0, 70.0, 45.0, 330.0, 40.0, 60.0, 40.0, 0.0, 20.0, 180.0, 0.0, 0.0, 10.0, 100.0, 240.0, 40.0, 460.0, 180.0, 40.0, 190.0, 80.0, 30.0, 0.0, 90.0, 100.0, 20.0, 0.0, 450.0, 60.0, 80.0, -20.0, 200.0, 310.0, 10.0, 50.0, 80.0, 200.0, 30.0, -40.0, 70.0, 0.0, 80.0, 60.0, 100.0, 190.0, 330.0, 180.0, 110.0, 100.0, 40.0, 180.0, 10.0, 40.0, 0.0, 180.0, 50.0, 30.0, 40.0, -225.0, 70.0, -65.0, 360.0, 310.0, 50.0, 40.0, 20.0, 200.0, 40.0, 50.0, 110.0, 300.0, 320.0, 110.0, 200.0, 0.0, 280.0, 20.0, 280.0, 40.0, 360.0, 130.0, 170.0, 60.0, 70.0, 30.0, 10.0, 70.0, 20.0, 0.0, 40.0, 60.0, 40.0, 30.0, 260.0, 170.0, 180.0, 30.0, 510.0, 70.0, 20.0, 200.0, 110.0, 480.0, 90.0, 20.0, 165.0, 220.0, 50.0, 200.0, 50.0, 170.0, 110.0, 190.0, 110.0, 20.0, 0.0, 280.0, 100.0, 40.0, 250.0, 10.0, 60.0, 210.0, 270.0, 30.0, 30.0, 120.0, 110.0, 40.0, 370.0, 40.0, 240.0, 100.0, 5.0, 140.0, 120.0, 150.0, 50.0, 40.0, 130.0, 310.0, 90.0, 70.0, 180.0, 30.0, 380.0, 60.0, 50.0, 20.0, 30.0, 230.0, 30.0, 150.0, 60.0, 40.0, 50.0, 10.0, 180.0, 60.0, 110.0, 230.0, 120.0, 20.0, 180.0, 180.0, 290.0, 80.0, 80.0, 40.0, 0.0, -100.0, 150.0, 30.0, 90.0, 40.0, 40.0, 90.0, 140.0, 0.0, 30.0, 20.0, 20.0, 40.0, 290.0, 70.0, 0.0, 220.0, 30.0, 50.0, 60.0, 310.0, 280.0, 200.0, 20.0, 210.0, 0.0, 90.0, 30.0, 110.0, 40.0, 40.0, 150.0, 120.0, 170.0, 310.0, 170.0, 0.0, 210.0, 70.0, 80.0, 30.0, 50.0, 190.0, 90.0, 70.0, 60.0, 60.0, -40.0, 50.0, 80.0, 80.0, 50.0, 210.0, 40.0, 120.0, 0.0, 80.0, 120.0, 200.0, 440.0, 810.0, 50.0, 20.0, 200.0, 70.0, 10.0, 80.0, 60.0, 30.0, 60.0, 70.0, 80.0, 70.0, 10.0, 200.0, 40.0, 90.0, 30.0, 80.0, 90.0, 50.0, 60.0, 40.0, 10.0, 50.0, 120.0, 320.0, 60.0, 190.0, 15.0, 190.0, 50.0, 90.0, 30.0, 20.0, 760.0, 110.0, 270.0, 200.0, 180.0, 20.0, 20.0, 20.0, 190.0, 30.0, 50.0, 10.0, 20.0, 300.0, 110.0, 40.0, 0.0, 20.0, 20.0, 50.0, 10.0, 100.0, 80.0, 10.0, 40.0, 30.0, 90.0, 10.0, 200.0, 30.0, 160.0, 10.0, 160.0, 10.0, 160.0, 50.0, 0.0, 0.0, 70.0, -10.0, 60.0, -80.0, 0.0, 310.0, 580.0, 100.0, 40.0, 60.0, 20.0, 90.0, -15.0, 0.0, 30.0, 50.0, 20.0, 150.0, 40.0, 220.0, 100.0, 40.0, 70.0, 60.0, 60.0, 80.0, 40.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 10.0, 160.0, 0.0, 80.0, 180.0, 40.0, 130.0, 60.0, 80.0, 210.0, 310.0, 160.0, 100.0, 100.0, 0.0, 80.0, 120.0, 300.0, 140.0, 50.0, -20.0, 20.0, 10.0, 60.0, 130.0, 80.0, 160.0, 190.0, 40.0, 410.0, 110.0, 70.0, 50.0, 30.0, 70.0, 30.0, 200.0, 10.0, 120.0, 0.0, 20.0, 380.0, 170.0, 0.0, 40.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 160.0, 80.0, 190.0, 90.0, 70.0, 70.0, 10.0, 370.0, 20.0, 160.0, 10.0, 280.0, 170.0, 10.0, 20.0, 160.0, 0.0, 10.0, 30.0, 0.0, 90.0, 20.0, -20.0, 90.0, 70.0, 70.0, 330.0, 10.0, 170.0, 330.0, 0.0, 90.0, 300.0, 50.0, 60.0, 80.0, -290.0, 30.0, 300.0, 30.0, 20.0, 20.0, 20.0, 80.0, 30.0, 30.0, 20.0, 70.0, 50.0, 500.0, 80.0, 80.0, 190.0, 210.0, 80.0, 30.0, 70.0, 20.0, 10.0, 90.0, 80.0, 160.0, 20.0, 40.0, 70.0, -40.0, 260.0, 40.0, 300.0, 10.0, 140.0, 100.0, 90.0, 0.0, 80.0, 30.0, 30.0, 40.0, 80.0, 150.0, 50.0, 110.0, 20.0, 30.0, 20.0, 210.0, 40.0, 50.0, 0.0, 10.0, 40.0, 70.0, 20.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 0.0, 0.0, 50.0, 90.0, 10.0, 0.0, 70.0, 150.0, 100.0, 10.0, 20.0, 0.0, 50.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 70.0, 0.0, 90.0, 30.0, 160.0, 510.0, 200.0, 300.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 110.0, 280.0, 150.0, 170.0, 200.0, 130.0, 260.0, 20.0, 70.0, 80.0, 120.0, 70.0, 90.0, 120.0, 0.0, 100.0, 50.0, 180.0, 10.0, 70.0, 40.0, 20.0, 40.0, 90.0, 20.0, 480.0, 110.0, 10.0, 20.0, 60.0, 20.0, 160.0, 70.0, 70.0, 90.0, 110.0, 250.0, 100.0, 510.0, 120.0, 100.0, 60.0, 200.0, 190.0, -50.0, 60.0, 210.0, 140.0, 90.0, -15.0, 10.0, 30.0, 110.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 250.0, 110.0, 210.0, 50.0, 190.0, 40.0, 70.0, 10.0, 10.0, 0.0, 0.0, 70.0, 90.0, 10.0, 20.0, 40.0, 10.0, 170.0, 30.0, 40.0, -30.0, 30.0, 30.0, 590.0, 0.0, 40.0, 0.0, 40.0, 50.0, 50.0, 90.0, 60.0, 80.0, 100.0, 280.0, 300.0, 90.0, 100.0, 60.0, 90.0, -30.0, 400.0, 320.0, 80.0, 60.0, -20.0, 70.0, 30.0, -360.0, 110.0, 0.0, 260.0, 30.0, 260.0, 70.0, 100.0, 80.0, 290.0, 190.0, 20.0, -50.0, 40.0, 30.0, 420.0, 170.0, 50.0, 80.0, 50.0, 40.0, 190.0, 390.0, 120.0, 40.0, 140.0, 300.0, -90.0, 50.0, 0.0, 10.0, 170.0, 30.0, 30.0, -20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 50.0, 80.0, 50.0, 170.0, 160.0, 40.0, 60.0, 110.0, 100.0, 10.0, 5.0, 30.0, 160.0, 40.0, 170.0, 0.0, 200.0, 20.0, 10.0, 180.0, 50.0, 0.0, 60.0, 180.0, 0.0, 0.0, 50.0, 110.0, 180.0, 10.0, 530.0, 190.0, 300.0, 120.0, 20.0, 80.0, 80.0, 10.0, 30.0, 0.0, 120.0, 30.0, 40.0, 150.0, 10.0, 200.0, 210.0, 30.0, 70.0, 200.0, 330.0, 190.0, 40.0, 30.0, 50.0, 20.0, 100.0, 30.0, 50.0, 110.0, 40.0, 10.0, 110.0, 10.0, 50.0, 310.0, 260.0, 30.0, 70.0, 90.0, 100.0, 45.0, 90.0, 90.0, 150.0, 440.0, 180.0, 130.0, 60.0, 20.0, 250.0, 260.0, 310.0, 240.0, 70.0, 50.0, 110.0, 280.0, 25.0, 270.0, 300.0, 50.0, 40.0, 120.0, 60.0, 0.0, 50.0, 80.0, 70.0, 40.0, 70.0, 140.0, 120.0, 210.0, 260.0, 60.0, 280.0, 0.0, 220.0, 20.0, 260.0, 20.0, 0.0, 180.0, 100.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 250.0, 40.0, 10.0, 30.0, 20.0, 10.0, 45.0, 40.0, 40.0, 360.0, 140.0, 60.0, 60.0, -30.0, 280.0, 210.0, 0.0, 220.0, 300.0, 140.0, 100.0, 310.0, 100.0, 80.0, 20.0, 50.0, 70.0, 80.0, 130.0, -50.0, 20.0, 250.0, 70.0, 40.0, 0.0, 0.0, 190.0, 260.0, 195.0, 60.0, 110.0, 40.0, 130.0, 210.0, 20.0, 70.0, 10.0, -35.0, 150.0, 80.0, 40.0, 50.0, 80.0, 250.0, 30.0, 40.0, 170.0, 50.0, 100.0, 90.0, 180.0, 30.0, 20.0, 60.0, 300.0, 50.0, 40.0, 210.0, 10.0, 50.0, 150.0, 20.0, 330.0, -100.0, 10.0, 30.0, 100.0, 60.0, 100.0, 70.0, 10.0, 190.0, 190.0, 670.0, 10.0, 80.0, 0.0, 30.0, 70.0, 10.0, 170.0, 20.0, 50.0, 30.0, 80.0, 40.0, 240.0, 10.0, 110.0, 30.0, 90.0, 210.0, 270.0, 80.0, 120.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6820008070309482, "mean_inference_ms": 1.4923531027477526, "mean_action_processing_ms": 0.4318743312756736, "mean_env_wait_ms": 1.351867084320166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013187408447265625, "StateBufferConnector_ms": 0.010899782180786133, "ViewRequirementAgentConnector_ms": 0.4089789390563965}, "num_episodes": 22, "episode_return_max": 2070.0, "episode_return_min": 250.0, "episode_return_mean": 945.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.21625772930427, "num_env_steps_trained_throughput_per_sec": 19.21625772930427, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 2840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2840000, "timers": {"training_iteration_time_ms": 208958.815, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208958.772, "sample_time_ms": 2702.509, "learn_time_ms": 206235.46, "learn_throughput": 19.395, "synch_weights_time_ms": 11.331}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "done": false, "training_iteration": 71, "trial_id": "aa996_00000", "date": "2024-05-24_02-52-09", "timestamp": 1716533529, "time_this_iter_s": 208.16566395759583, "time_total_s": 14796.46974349022, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d7fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14796.46974349022, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 18.963265306122445, "ram_util_percent": 79.2170068027211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6859979217616132, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.348033152296901, "policy_loss": -0.008070396829391032, "vf_loss": 7.354871732713823, "vf_explained_var": -0.0006106303459285293, "kl": 0.0061590168284542494, "entropy": 0.36739221780667036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 671385.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 2070.0, "episode_reward_min": 250.0, "episode_reward_mean": 965.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -360.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 96.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1135.0, 1080.0, 1010.0, 920.0, 500.0, 1350.0, 890.0, 1210.0, 690.0, 2070.0, 680.0, 720.0, 1045.0, 1700.0, 770.0, 450.0, 790.0, 1070.0, 445.0, 700.0, 290.0, 1350.0, 800.0, 1300.0, 1030.0, 670.0, 1270.0, 510.0, 1140.0, 600.0, 960.0, 940.0, 940.0, 660.0, 490.0, 260.0, 500.0, 290.0, 1330.0, 1470.0, 810.0, 890.0, 1500.0, 985.0, 310.0, 950.0, 260.0, 900.0, 1140.0, 1130.0, 580.0, 1240.0, 1230.0, 250.0, 710.0, 825.0, 550.0, 1620.0, 800.0, 1060.0, 980.0, 1285.0, 1500.0, 1195.0, 1330.0, 830.0, 410.0, 1205.0, 1320.0, 610.0, 1285.0, 695.0, 1050.0, 750.0, 1480.0, 500.0, 1240.0, 1310.0, 1060.0, 830.0, 595.0, 755.0, 1390.0, 1280.0, 830.0, 1310.0, 960.0, 260.0, 735.0, 1840.0, 1520.0, 1250.0, 1010.0, 960.0, 1240.0, 1520.0, 1105.0, 1120.0, 1060.0, 1220.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 5.0, 140.0, 120.0, 150.0, 50.0, 40.0, 130.0, 310.0, 90.0, 70.0, 180.0, 30.0, 380.0, 60.0, 50.0, 20.0, 30.0, 230.0, 30.0, 150.0, 60.0, 40.0, 50.0, 10.0, 180.0, 60.0, 110.0, 230.0, 120.0, 20.0, 180.0, 180.0, 290.0, 80.0, 80.0, 40.0, 0.0, -100.0, 150.0, 30.0, 90.0, 40.0, 40.0, 90.0, 140.0, 0.0, 30.0, 20.0, 20.0, 40.0, 290.0, 70.0, 0.0, 220.0, 30.0, 50.0, 60.0, 310.0, 280.0, 200.0, 20.0, 210.0, 0.0, 90.0, 30.0, 110.0, 40.0, 40.0, 150.0, 120.0, 170.0, 310.0, 170.0, 0.0, 210.0, 70.0, 80.0, 30.0, 50.0, 190.0, 90.0, 70.0, 60.0, 60.0, -40.0, 50.0, 80.0, 80.0, 50.0, 210.0, 40.0, 120.0, 0.0, 80.0, 120.0, 200.0, 440.0, 810.0, 50.0, 20.0, 200.0, 70.0, 10.0, 80.0, 60.0, 30.0, 60.0, 70.0, 80.0, 70.0, 10.0, 200.0, 40.0, 90.0, 30.0, 80.0, 90.0, 50.0, 60.0, 40.0, 10.0, 50.0, 120.0, 320.0, 60.0, 190.0, 15.0, 190.0, 50.0, 90.0, 30.0, 20.0, 760.0, 110.0, 270.0, 200.0, 180.0, 20.0, 20.0, 20.0, 190.0, 30.0, 50.0, 10.0, 20.0, 300.0, 110.0, 40.0, 0.0, 20.0, 20.0, 50.0, 10.0, 100.0, 80.0, 10.0, 40.0, 30.0, 90.0, 10.0, 200.0, 30.0, 160.0, 10.0, 160.0, 10.0, 160.0, 50.0, 0.0, 0.0, 70.0, -10.0, 60.0, -80.0, 0.0, 310.0, 580.0, 100.0, 40.0, 60.0, 20.0, 90.0, -15.0, 0.0, 30.0, 50.0, 20.0, 150.0, 40.0, 220.0, 100.0, 40.0, 70.0, 60.0, 60.0, 80.0, 40.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 10.0, 160.0, 0.0, 80.0, 180.0, 40.0, 130.0, 60.0, 80.0, 210.0, 310.0, 160.0, 100.0, 100.0, 0.0, 80.0, 120.0, 300.0, 140.0, 50.0, -20.0, 20.0, 10.0, 60.0, 130.0, 80.0, 160.0, 190.0, 40.0, 410.0, 110.0, 70.0, 50.0, 30.0, 70.0, 30.0, 200.0, 10.0, 120.0, 0.0, 20.0, 380.0, 170.0, 0.0, 40.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 160.0, 80.0, 190.0, 90.0, 70.0, 70.0, 10.0, 370.0, 20.0, 160.0, 10.0, 280.0, 170.0, 10.0, 20.0, 160.0, 0.0, 10.0, 30.0, 0.0, 90.0, 20.0, -20.0, 90.0, 70.0, 70.0, 330.0, 10.0, 170.0, 330.0, 0.0, 90.0, 300.0, 50.0, 60.0, 80.0, -290.0, 30.0, 300.0, 30.0, 20.0, 20.0, 20.0, 80.0, 30.0, 30.0, 20.0, 70.0, 50.0, 500.0, 80.0, 80.0, 190.0, 210.0, 80.0, 30.0, 70.0, 20.0, 10.0, 90.0, 80.0, 160.0, 20.0, 40.0, 70.0, -40.0, 260.0, 40.0, 300.0, 10.0, 140.0, 100.0, 90.0, 0.0, 80.0, 30.0, 30.0, 40.0, 80.0, 150.0, 50.0, 110.0, 20.0, 30.0, 20.0, 210.0, 40.0, 50.0, 0.0, 10.0, 40.0, 70.0, 20.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 0.0, 0.0, 50.0, 90.0, 10.0, 0.0, 70.0, 150.0, 100.0, 10.0, 20.0, 0.0, 50.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 70.0, 0.0, 90.0, 30.0, 160.0, 510.0, 200.0, 300.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 110.0, 280.0, 150.0, 170.0, 200.0, 130.0, 260.0, 20.0, 70.0, 80.0, 120.0, 70.0, 90.0, 120.0, 0.0, 100.0, 50.0, 180.0, 10.0, 70.0, 40.0, 20.0, 40.0, 90.0, 20.0, 480.0, 110.0, 10.0, 20.0, 60.0, 20.0, 160.0, 70.0, 70.0, 90.0, 110.0, 250.0, 100.0, 510.0, 120.0, 100.0, 60.0, 200.0, 190.0, -50.0, 60.0, 210.0, 140.0, 90.0, -15.0, 10.0, 30.0, 110.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 250.0, 110.0, 210.0, 50.0, 190.0, 40.0, 70.0, 10.0, 10.0, 0.0, 0.0, 70.0, 90.0, 10.0, 20.0, 40.0, 10.0, 170.0, 30.0, 40.0, -30.0, 30.0, 30.0, 590.0, 0.0, 40.0, 0.0, 40.0, 50.0, 50.0, 90.0, 60.0, 80.0, 100.0, 280.0, 300.0, 90.0, 100.0, 60.0, 90.0, -30.0, 400.0, 320.0, 80.0, 60.0, -20.0, 70.0, 30.0, -360.0, 110.0, 0.0, 260.0, 30.0, 260.0, 70.0, 100.0, 80.0, 290.0, 190.0, 20.0, -50.0, 40.0, 30.0, 420.0, 170.0, 50.0, 80.0, 50.0, 40.0, 190.0, 390.0, 120.0, 40.0, 140.0, 300.0, -90.0, 50.0, 0.0, 10.0, 170.0, 30.0, 30.0, -20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 50.0, 80.0, 50.0, 170.0, 160.0, 40.0, 60.0, 110.0, 100.0, 10.0, 5.0, 30.0, 160.0, 40.0, 170.0, 0.0, 200.0, 20.0, 10.0, 180.0, 50.0, 0.0, 60.0, 180.0, 0.0, 0.0, 50.0, 110.0, 180.0, 10.0, 530.0, 190.0, 300.0, 120.0, 20.0, 80.0, 80.0, 10.0, 30.0, 0.0, 120.0, 30.0, 40.0, 150.0, 10.0, 200.0, 210.0, 30.0, 70.0, 200.0, 330.0, 190.0, 40.0, 30.0, 50.0, 20.0, 100.0, 30.0, 50.0, 110.0, 40.0, 10.0, 110.0, 10.0, 50.0, 310.0, 260.0, 30.0, 70.0, 90.0, 100.0, 45.0, 90.0, 90.0, 150.0, 440.0, 180.0, 130.0, 60.0, 20.0, 250.0, 260.0, 310.0, 240.0, 70.0, 50.0, 110.0, 280.0, 25.0, 270.0, 300.0, 50.0, 40.0, 120.0, 60.0, 0.0, 50.0, 80.0, 70.0, 40.0, 70.0, 140.0, 120.0, 210.0, 260.0, 60.0, 280.0, 0.0, 220.0, 20.0, 260.0, 20.0, 0.0, 180.0, 100.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 250.0, 40.0, 10.0, 30.0, 20.0, 10.0, 45.0, 40.0, 40.0, 360.0, 140.0, 60.0, 60.0, -30.0, 280.0, 210.0, 0.0, 220.0, 300.0, 140.0, 100.0, 310.0, 100.0, 80.0, 20.0, 50.0, 70.0, 80.0, 130.0, -50.0, 20.0, 250.0, 70.0, 40.0, 0.0, 0.0, 190.0, 260.0, 195.0, 60.0, 110.0, 40.0, 130.0, 210.0, 20.0, 70.0, 10.0, -35.0, 150.0, 80.0, 40.0, 50.0, 80.0, 250.0, 30.0, 40.0, 170.0, 50.0, 100.0, 90.0, 180.0, 30.0, 20.0, 60.0, 300.0, 50.0, 40.0, 210.0, 10.0, 50.0, 150.0, 20.0, 330.0, -100.0, 10.0, 30.0, 100.0, 60.0, 100.0, 70.0, 10.0, 190.0, 190.0, 670.0, 10.0, 80.0, 0.0, 30.0, 70.0, 10.0, 170.0, 20.0, 50.0, 30.0, 80.0, 40.0, 240.0, 10.0, 110.0, 30.0, 90.0, 210.0, 270.0, 80.0, 120.0, 80.0, 380.0, 20.0, -30.0, 270.0, 80.0, 20.0, 170.0, 10.0, 190.0, 200.0, 170.0, 290.0, 230.0, 80.0, 160.0, 40.0, -20.0, 20.0, 30.0, 60.0, 10.0, 40.0, 70.0, 50.0, 190.0, 20.0, 60.0, 330.0, 40.0, 20.0, 180.0, 40.0, 70.0, 40.0, 20.0, 40.0, 60.0, 140.0, 40.0, -35.0, 80.0, 650.0, 30.0, 30.0, 0.0, 50.0, 20.0, -125.0, -20.0, 40.0, 260.0, 90.0, 90.0, 100.0, 450.0, 100.0, 240.0, -140.0, 130.0, 70.0, 40.0, 40.0, 30.0, 260.0, 50.0, 70.0, 600.0, 90.0, 30.0, 70.0, 30.0, 70.0, 270.0, 40.0, 210.0, 70.0, 230.0, -40.0, -30.0, -20.0, 60.0, 150.0, 240.0, 60.0, 110.0, 130.0, 220.0, 240.0, 0.0, 100.0, 40.0, 270.0, 80.0, 100.0, 10.0, 140.0, 70.0, 30.0, 40.0, 180.0, 70.0, 0.0, 20.0, 0.0, 90.0, 60.0, 0.0, 0.0, 10.0, 10.0, 55.0, 30.0, 130.0, 60.0, 70.0, 110.0, 200.0, 120.0, -100.0, 60.0, 560.0, 80.0, 120.0, 170.0, 320.0, 310.0, 90.0, 80.0, 40.0, 70.0, 210.0, 50.0, 10.0, 70.0, 40.0, 70.0, 330.0, 190.0, 170.0, 380.0, 0.0, 30.0, 170.0, 70.0, 60.0, 70.0, 530.0, 230.0, 50.0, 40.0, 90.0, 40.0, 40.0, 280.0, 100.0, 60.0, 170.0, 110.0, 110.0, 10.0, -60.0, 260.0, 50.0, 60.0, 10.0, 290.0, 110.0, 50.0, 150.0, 40.0, -20.0, 170.0, 0.0, 150.0, 180.0, 100.0, 260.0, 70.0, 330.0, 0.0, 80.0, 70.0, 100.0, 310.0, 340.0, 220.0, 70.0, 120.0, 50.0, 160.0, 210.0, 25.0, 0.0, 80.0, 170.0, 180.0, 70.0, 60.0, 60.0, 250.0, 100.0, 40.0, 30.0, 330.0, 210.0, 130.0, 50.0, 60.0, 20.0, 150.0, 50.0, 100.0, 70.0, 50.0, 360.0, 90.0, 210.0, 60.0, 10.0, 60.0, 90.0, 10.0, 70.0, 90.0, 60.0, 40.0, 350.0, 110.0, 320.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.681178152719103, "mean_inference_ms": 1.4918064292938433, "mean_action_processing_ms": 0.4314566844922143, "mean_env_wait_ms": 1.3512375410803852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013373374938964844, "StateBufferConnector_ms": 0.010914325714111328, "ViewRequirementAgentConnector_ms": 0.40712594985961914}, "num_episodes": 23, "episode_return_max": 2070.0, "episode_return_min": 250.0, "episode_return_mean": 965.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.13838666597754, "num_env_steps_trained_throughput_per_sec": 19.13838666597754, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 208890.646, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208890.602, "sample_time_ms": 2678.271, "learn_time_ms": 206191.533, "learn_throughput": 19.399, "synch_weights_time_ms": 11.426}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 72, "trial_id": "aa996_00000", "date": "2024-05-24_02-55-38", "timestamp": 1716533738, "time_this_iter_s": 209.01233506202698, "time_total_s": 15005.482078552246, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309ff430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15005.482078552246, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 18.93412162162162, "ram_util_percent": 79.38108108108108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.525902665797641, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.036022395650926, "policy_loss": -0.007751286029493331, "vf_loss": 7.042554156340984, "vf_explained_var": 0.001005853631625922, "kl": 0.006097594021765238, "entropy": 0.37977852587279676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 680775.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "env_runners": {"episode_reward_max": 1840.0, "episode_reward_min": 220.0, "episode_reward_mean": 975.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -360.0}, "policy_reward_max": {"policy_0": 830.0}, "policy_reward_mean": {"policy_0": 97.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.0, 700.0, 290.0, 1350.0, 800.0, 1300.0, 1030.0, 670.0, 1270.0, 510.0, 1140.0, 600.0, 960.0, 940.0, 940.0, 660.0, 490.0, 260.0, 500.0, 290.0, 1330.0, 1470.0, 810.0, 890.0, 1500.0, 985.0, 310.0, 950.0, 260.0, 900.0, 1140.0, 1130.0, 580.0, 1240.0, 1230.0, 250.0, 710.0, 825.0, 550.0, 1620.0, 800.0, 1060.0, 980.0, 1285.0, 1500.0, 1195.0, 1330.0, 830.0, 410.0, 1205.0, 1320.0, 610.0, 1285.0, 695.0, 1050.0, 750.0, 1480.0, 500.0, 1240.0, 1310.0, 1060.0, 830.0, 595.0, 755.0, 1390.0, 1280.0, 830.0, 1310.0, 960.0, 260.0, 735.0, 1840.0, 1520.0, 1250.0, 1010.0, 960.0, 1240.0, 1520.0, 1105.0, 1120.0, 1060.0, 1220.0, 1325.0, 1160.0, 560.0, 1380.0, 1210.0, 910.0, 930.0, 490.0, 955.0, 740.0, 1650.0, 1040.0, 220.0, 1290.0, 1300.0, 940.0, 1530.0, 1420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 20.0, 90.0, -15.0, 0.0, 30.0, 50.0, 20.0, 150.0, 40.0, 220.0, 100.0, 40.0, 70.0, 60.0, 60.0, 80.0, 40.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 10.0, 160.0, 0.0, 80.0, 180.0, 40.0, 130.0, 60.0, 80.0, 210.0, 310.0, 160.0, 100.0, 100.0, 0.0, 80.0, 120.0, 300.0, 140.0, 50.0, -20.0, 20.0, 10.0, 60.0, 130.0, 80.0, 160.0, 190.0, 40.0, 410.0, 110.0, 70.0, 50.0, 30.0, 70.0, 30.0, 200.0, 10.0, 120.0, 0.0, 20.0, 380.0, 170.0, 0.0, 40.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 160.0, 80.0, 190.0, 90.0, 70.0, 70.0, 10.0, 370.0, 20.0, 160.0, 10.0, 280.0, 170.0, 10.0, 20.0, 160.0, 0.0, 10.0, 30.0, 0.0, 90.0, 20.0, -20.0, 90.0, 70.0, 70.0, 330.0, 10.0, 170.0, 330.0, 0.0, 90.0, 300.0, 50.0, 60.0, 80.0, -290.0, 30.0, 300.0, 30.0, 20.0, 20.0, 20.0, 80.0, 30.0, 30.0, 20.0, 70.0, 50.0, 500.0, 80.0, 80.0, 190.0, 210.0, 80.0, 30.0, 70.0, 20.0, 10.0, 90.0, 80.0, 160.0, 20.0, 40.0, 70.0, -40.0, 260.0, 40.0, 300.0, 10.0, 140.0, 100.0, 90.0, 0.0, 80.0, 30.0, 30.0, 40.0, 80.0, 150.0, 50.0, 110.0, 20.0, 30.0, 20.0, 210.0, 40.0, 50.0, 0.0, 10.0, 40.0, 70.0, 20.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 0.0, 0.0, 50.0, 90.0, 10.0, 0.0, 70.0, 150.0, 100.0, 10.0, 20.0, 0.0, 50.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 70.0, 0.0, 90.0, 30.0, 160.0, 510.0, 200.0, 300.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 110.0, 280.0, 150.0, 170.0, 200.0, 130.0, 260.0, 20.0, 70.0, 80.0, 120.0, 70.0, 90.0, 120.0, 0.0, 100.0, 50.0, 180.0, 10.0, 70.0, 40.0, 20.0, 40.0, 90.0, 20.0, 480.0, 110.0, 10.0, 20.0, 60.0, 20.0, 160.0, 70.0, 70.0, 90.0, 110.0, 250.0, 100.0, 510.0, 120.0, 100.0, 60.0, 200.0, 190.0, -50.0, 60.0, 210.0, 140.0, 90.0, -15.0, 10.0, 30.0, 110.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 250.0, 110.0, 210.0, 50.0, 190.0, 40.0, 70.0, 10.0, 10.0, 0.0, 0.0, 70.0, 90.0, 10.0, 20.0, 40.0, 10.0, 170.0, 30.0, 40.0, -30.0, 30.0, 30.0, 590.0, 0.0, 40.0, 0.0, 40.0, 50.0, 50.0, 90.0, 60.0, 80.0, 100.0, 280.0, 300.0, 90.0, 100.0, 60.0, 90.0, -30.0, 400.0, 320.0, 80.0, 60.0, -20.0, 70.0, 30.0, -360.0, 110.0, 0.0, 260.0, 30.0, 260.0, 70.0, 100.0, 80.0, 290.0, 190.0, 20.0, -50.0, 40.0, 30.0, 420.0, 170.0, 50.0, 80.0, 50.0, 40.0, 190.0, 390.0, 120.0, 40.0, 140.0, 300.0, -90.0, 50.0, 0.0, 10.0, 170.0, 30.0, 30.0, -20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 50.0, 80.0, 50.0, 170.0, 160.0, 40.0, 60.0, 110.0, 100.0, 10.0, 5.0, 30.0, 160.0, 40.0, 170.0, 0.0, 200.0, 20.0, 10.0, 180.0, 50.0, 0.0, 60.0, 180.0, 0.0, 0.0, 50.0, 110.0, 180.0, 10.0, 530.0, 190.0, 300.0, 120.0, 20.0, 80.0, 80.0, 10.0, 30.0, 0.0, 120.0, 30.0, 40.0, 150.0, 10.0, 200.0, 210.0, 30.0, 70.0, 200.0, 330.0, 190.0, 40.0, 30.0, 50.0, 20.0, 100.0, 30.0, 50.0, 110.0, 40.0, 10.0, 110.0, 10.0, 50.0, 310.0, 260.0, 30.0, 70.0, 90.0, 100.0, 45.0, 90.0, 90.0, 150.0, 440.0, 180.0, 130.0, 60.0, 20.0, 250.0, 260.0, 310.0, 240.0, 70.0, 50.0, 110.0, 280.0, 25.0, 270.0, 300.0, 50.0, 40.0, 120.0, 60.0, 0.0, 50.0, 80.0, 70.0, 40.0, 70.0, 140.0, 120.0, 210.0, 260.0, 60.0, 280.0, 0.0, 220.0, 20.0, 260.0, 20.0, 0.0, 180.0, 100.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 250.0, 40.0, 10.0, 30.0, 20.0, 10.0, 45.0, 40.0, 40.0, 360.0, 140.0, 60.0, 60.0, -30.0, 280.0, 210.0, 0.0, 220.0, 300.0, 140.0, 100.0, 310.0, 100.0, 80.0, 20.0, 50.0, 70.0, 80.0, 130.0, -50.0, 20.0, 250.0, 70.0, 40.0, 0.0, 0.0, 190.0, 260.0, 195.0, 60.0, 110.0, 40.0, 130.0, 210.0, 20.0, 70.0, 10.0, -35.0, 150.0, 80.0, 40.0, 50.0, 80.0, 250.0, 30.0, 40.0, 170.0, 50.0, 100.0, 90.0, 180.0, 30.0, 20.0, 60.0, 300.0, 50.0, 40.0, 210.0, 10.0, 50.0, 150.0, 20.0, 330.0, -100.0, 10.0, 30.0, 100.0, 60.0, 100.0, 70.0, 10.0, 190.0, 190.0, 670.0, 10.0, 80.0, 0.0, 30.0, 70.0, 10.0, 170.0, 20.0, 50.0, 30.0, 80.0, 40.0, 240.0, 10.0, 110.0, 30.0, 90.0, 210.0, 270.0, 80.0, 120.0, 80.0, 380.0, 20.0, -30.0, 270.0, 80.0, 20.0, 170.0, 10.0, 190.0, 200.0, 170.0, 290.0, 230.0, 80.0, 160.0, 40.0, -20.0, 20.0, 30.0, 60.0, 10.0, 40.0, 70.0, 50.0, 190.0, 20.0, 60.0, 330.0, 40.0, 20.0, 180.0, 40.0, 70.0, 40.0, 20.0, 40.0, 60.0, 140.0, 40.0, -35.0, 80.0, 650.0, 30.0, 30.0, 0.0, 50.0, 20.0, -125.0, -20.0, 40.0, 260.0, 90.0, 90.0, 100.0, 450.0, 100.0, 240.0, -140.0, 130.0, 70.0, 40.0, 40.0, 30.0, 260.0, 50.0, 70.0, 600.0, 90.0, 30.0, 70.0, 30.0, 70.0, 270.0, 40.0, 210.0, 70.0, 230.0, -40.0, -30.0, -20.0, 60.0, 150.0, 240.0, 60.0, 110.0, 130.0, 220.0, 240.0, 0.0, 100.0, 40.0, 270.0, 80.0, 100.0, 10.0, 140.0, 70.0, 30.0, 40.0, 180.0, 70.0, 0.0, 20.0, 0.0, 90.0, 60.0, 0.0, 0.0, 10.0, 10.0, 55.0, 30.0, 130.0, 60.0, 70.0, 110.0, 200.0, 120.0, -100.0, 60.0, 560.0, 80.0, 120.0, 170.0, 320.0, 310.0, 90.0, 80.0, 40.0, 70.0, 210.0, 50.0, 10.0, 70.0, 40.0, 70.0, 330.0, 190.0, 170.0, 380.0, 0.0, 30.0, 170.0, 70.0, 60.0, 70.0, 530.0, 230.0, 50.0, 40.0, 90.0, 40.0, 40.0, 280.0, 100.0, 60.0, 170.0, 110.0, 110.0, 10.0, -60.0, 260.0, 50.0, 60.0, 10.0, 290.0, 110.0, 50.0, 150.0, 40.0, -20.0, 170.0, 0.0, 150.0, 180.0, 100.0, 260.0, 70.0, 330.0, 0.0, 80.0, 70.0, 100.0, 310.0, 340.0, 220.0, 70.0, 120.0, 50.0, 160.0, 210.0, 25.0, 0.0, 80.0, 170.0, 180.0, 70.0, 60.0, 60.0, 250.0, 100.0, 40.0, 30.0, 330.0, 210.0, 130.0, 50.0, 60.0, 20.0, 150.0, 50.0, 100.0, 70.0, 50.0, 360.0, 90.0, 210.0, 60.0, 10.0, 60.0, 90.0, 10.0, 70.0, 90.0, 60.0, 40.0, 350.0, 110.0, 320.0, 80.0, 30.0, 50.0, 290.0, 110.0, 60.0, 160.0, 200.0, -95.0, 320.0, 200.0, 40.0, 310.0, 10.0, 120.0, 210.0, 100.0, -50.0, 180.0, 10.0, 230.0, 280.0, 50.0, 90.0, -30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 80.0, 70.0, 60.0, 80.0, 140.0, 470.0, 30.0, 340.0, -10.0, 160.0, 40.0, 320.0, 130.0, -5.0, 40.0, 235.0, 100.0, 150.0, 30.0, 180.0, 30.0, 40.0, 10.0, 10.0, 220.0, 10.0, 200.0, 50.0, 100.0, 160.0, 110.0, 60.0, 20.0, 40.0, 160.0, 70.0, 200.0, 20.0, 270.0, 80.0, 10.0, 150.0, 120.0, 40.0, 0.0, 30.0, 70.0, 20.0, 20.0, 10.0, 30.0, -10.0, 80.0, 0.0, 130.0, 360.0, 15.0, 50.0, 10.0, 190.0, 130.0, 120.0, 20.0, 340.0, 0.0, 0.0, 20.0, 20.0, 30.0, 20.0, 170.0, 10.0, 830.0, 80.0, 150.0, 170.0, 130.0, 60.0, 70.0, 50.0, 100.0, 110.0, 200.0, 120.0, 60.0, 100.0, 90.0, 170.0, 170.0, -10.0, 30.0, 0.0, 10.0, 140.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 60.0, 10.0, 70.0, 100.0, 70.0, 10.0, 300.0, 270.0, 370.0, 180.0, 210.0, 80.0, 50.0, 40.0, 110.0, 320.0, 150.0, 80.0, 80.0, 250.0, 0.0, 130.0, 90.0, -30.0, 80.0, 110.0, 60.0, 210.0, 40.0, 200.0, 130.0, 300.0, 100.0, 20.0, 340.0, 100.0, 210.0, 40.0, 90.0, 170.0, 90.0, 90.0, 400.0, 90.0, 80.0, 170.0, 50.0, 260.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6812865165695572, "mean_inference_ms": 1.4914935593960335, "mean_action_processing_ms": 0.4311210418258446, "mean_env_wait_ms": 1.3508427717798472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013556957244873047, "StateBufferConnector_ms": 0.010946273803710938, "ViewRequirementAgentConnector_ms": 0.4010128974914551}, "num_episodes": 18, "episode_return_max": 1840.0, "episode_return_min": 220.0, "episode_return_mean": 975.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.229988384317302, "num_env_steps_trained_throughput_per_sec": 19.229988384317302, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 2920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2920000, "timers": {"training_iteration_time_ms": 208894.967, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208894.922, "sample_time_ms": 2736.146, "learn_time_ms": 206137.77, "learn_throughput": 19.404, "synch_weights_time_ms": 11.482}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "done": false, "training_iteration": 73, "trial_id": "aa996_00000", "date": "2024-05-24_02-59-06", "timestamp": 1716533946, "time_this_iter_s": 208.0162708759308, "time_total_s": 15213.498349428177, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x16003e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15213.498349428177, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 19.132312925170066, "ram_util_percent": 78.70918367346938}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.548868355856409, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.920874175375389, "policy_loss": -0.007135770791825165, "vf_loss": 6.926805825533069, "vf_explained_var": -0.001119669976706703, "kl": 0.006020579927213956, "entropy": 0.3756387548483472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 690165.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 1840.0, "episode_reward_min": 90.0, "episode_reward_mean": 1008.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -360.0}, "policy_reward_max": {"policy_0": 830.0}, "policy_reward_mean": {"policy_0": 100.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 290.0, 1330.0, 1470.0, 810.0, 890.0, 1500.0, 985.0, 310.0, 950.0, 260.0, 900.0, 1140.0, 1130.0, 580.0, 1240.0, 1230.0, 250.0, 710.0, 825.0, 550.0, 1620.0, 800.0, 1060.0, 980.0, 1285.0, 1500.0, 1195.0, 1330.0, 830.0, 410.0, 1205.0, 1320.0, 610.0, 1285.0, 695.0, 1050.0, 750.0, 1480.0, 500.0, 1240.0, 1310.0, 1060.0, 830.0, 595.0, 755.0, 1390.0, 1280.0, 830.0, 1310.0, 960.0, 260.0, 735.0, 1840.0, 1520.0, 1250.0, 1010.0, 960.0, 1240.0, 1520.0, 1105.0, 1120.0, 1060.0, 1220.0, 1325.0, 1160.0, 560.0, 1380.0, 1210.0, 910.0, 930.0, 490.0, 955.0, 740.0, 1650.0, 1040.0, 220.0, 1290.0, 1300.0, 940.0, 1530.0, 1420.0, 850.0, 840.0, 1590.0, 1070.0, 1120.0, 90.0, 310.0, 1580.0, 1330.0, 730.0, 660.0, 1060.0, 1590.0, 1200.0, 820.0, 1340.0, 770.0, 720.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 10.0, 0.0, 70.0, 150.0, 100.0, 10.0, 20.0, 0.0, 50.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 70.0, 0.0, 90.0, 30.0, 160.0, 510.0, 200.0, 300.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 110.0, 280.0, 150.0, 170.0, 200.0, 130.0, 260.0, 20.0, 70.0, 80.0, 120.0, 70.0, 90.0, 120.0, 0.0, 100.0, 50.0, 180.0, 10.0, 70.0, 40.0, 20.0, 40.0, 90.0, 20.0, 480.0, 110.0, 10.0, 20.0, 60.0, 20.0, 160.0, 70.0, 70.0, 90.0, 110.0, 250.0, 100.0, 510.0, 120.0, 100.0, 60.0, 200.0, 190.0, -50.0, 60.0, 210.0, 140.0, 90.0, -15.0, 10.0, 30.0, 110.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 250.0, 110.0, 210.0, 50.0, 190.0, 40.0, 70.0, 10.0, 10.0, 0.0, 0.0, 70.0, 90.0, 10.0, 20.0, 40.0, 10.0, 170.0, 30.0, 40.0, -30.0, 30.0, 30.0, 590.0, 0.0, 40.0, 0.0, 40.0, 50.0, 50.0, 90.0, 60.0, 80.0, 100.0, 280.0, 300.0, 90.0, 100.0, 60.0, 90.0, -30.0, 400.0, 320.0, 80.0, 60.0, -20.0, 70.0, 30.0, -360.0, 110.0, 0.0, 260.0, 30.0, 260.0, 70.0, 100.0, 80.0, 290.0, 190.0, 20.0, -50.0, 40.0, 30.0, 420.0, 170.0, 50.0, 80.0, 50.0, 40.0, 190.0, 390.0, 120.0, 40.0, 140.0, 300.0, -90.0, 50.0, 0.0, 10.0, 170.0, 30.0, 30.0, -20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 40.0, 50.0, 80.0, 50.0, 170.0, 160.0, 40.0, 60.0, 110.0, 100.0, 10.0, 5.0, 30.0, 160.0, 40.0, 170.0, 0.0, 200.0, 20.0, 10.0, 180.0, 50.0, 0.0, 60.0, 180.0, 0.0, 0.0, 50.0, 110.0, 180.0, 10.0, 530.0, 190.0, 300.0, 120.0, 20.0, 80.0, 80.0, 10.0, 30.0, 0.0, 120.0, 30.0, 40.0, 150.0, 10.0, 200.0, 210.0, 30.0, 70.0, 200.0, 330.0, 190.0, 40.0, 30.0, 50.0, 20.0, 100.0, 30.0, 50.0, 110.0, 40.0, 10.0, 110.0, 10.0, 50.0, 310.0, 260.0, 30.0, 70.0, 90.0, 100.0, 45.0, 90.0, 90.0, 150.0, 440.0, 180.0, 130.0, 60.0, 20.0, 250.0, 260.0, 310.0, 240.0, 70.0, 50.0, 110.0, 280.0, 25.0, 270.0, 300.0, 50.0, 40.0, 120.0, 60.0, 0.0, 50.0, 80.0, 70.0, 40.0, 70.0, 140.0, 120.0, 210.0, 260.0, 60.0, 280.0, 0.0, 220.0, 20.0, 260.0, 20.0, 0.0, 180.0, 100.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 250.0, 40.0, 10.0, 30.0, 20.0, 10.0, 45.0, 40.0, 40.0, 360.0, 140.0, 60.0, 60.0, -30.0, 280.0, 210.0, 0.0, 220.0, 300.0, 140.0, 100.0, 310.0, 100.0, 80.0, 20.0, 50.0, 70.0, 80.0, 130.0, -50.0, 20.0, 250.0, 70.0, 40.0, 0.0, 0.0, 190.0, 260.0, 195.0, 60.0, 110.0, 40.0, 130.0, 210.0, 20.0, 70.0, 10.0, -35.0, 150.0, 80.0, 40.0, 50.0, 80.0, 250.0, 30.0, 40.0, 170.0, 50.0, 100.0, 90.0, 180.0, 30.0, 20.0, 60.0, 300.0, 50.0, 40.0, 210.0, 10.0, 50.0, 150.0, 20.0, 330.0, -100.0, 10.0, 30.0, 100.0, 60.0, 100.0, 70.0, 10.0, 190.0, 190.0, 670.0, 10.0, 80.0, 0.0, 30.0, 70.0, 10.0, 170.0, 20.0, 50.0, 30.0, 80.0, 40.0, 240.0, 10.0, 110.0, 30.0, 90.0, 210.0, 270.0, 80.0, 120.0, 80.0, 380.0, 20.0, -30.0, 270.0, 80.0, 20.0, 170.0, 10.0, 190.0, 200.0, 170.0, 290.0, 230.0, 80.0, 160.0, 40.0, -20.0, 20.0, 30.0, 60.0, 10.0, 40.0, 70.0, 50.0, 190.0, 20.0, 60.0, 330.0, 40.0, 20.0, 180.0, 40.0, 70.0, 40.0, 20.0, 40.0, 60.0, 140.0, 40.0, -35.0, 80.0, 650.0, 30.0, 30.0, 0.0, 50.0, 20.0, -125.0, -20.0, 40.0, 260.0, 90.0, 90.0, 100.0, 450.0, 100.0, 240.0, -140.0, 130.0, 70.0, 40.0, 40.0, 30.0, 260.0, 50.0, 70.0, 600.0, 90.0, 30.0, 70.0, 30.0, 70.0, 270.0, 40.0, 210.0, 70.0, 230.0, -40.0, -30.0, -20.0, 60.0, 150.0, 240.0, 60.0, 110.0, 130.0, 220.0, 240.0, 0.0, 100.0, 40.0, 270.0, 80.0, 100.0, 10.0, 140.0, 70.0, 30.0, 40.0, 180.0, 70.0, 0.0, 20.0, 0.0, 90.0, 60.0, 0.0, 0.0, 10.0, 10.0, 55.0, 30.0, 130.0, 60.0, 70.0, 110.0, 200.0, 120.0, -100.0, 60.0, 560.0, 80.0, 120.0, 170.0, 320.0, 310.0, 90.0, 80.0, 40.0, 70.0, 210.0, 50.0, 10.0, 70.0, 40.0, 70.0, 330.0, 190.0, 170.0, 380.0, 0.0, 30.0, 170.0, 70.0, 60.0, 70.0, 530.0, 230.0, 50.0, 40.0, 90.0, 40.0, 40.0, 280.0, 100.0, 60.0, 170.0, 110.0, 110.0, 10.0, -60.0, 260.0, 50.0, 60.0, 10.0, 290.0, 110.0, 50.0, 150.0, 40.0, -20.0, 170.0, 0.0, 150.0, 180.0, 100.0, 260.0, 70.0, 330.0, 0.0, 80.0, 70.0, 100.0, 310.0, 340.0, 220.0, 70.0, 120.0, 50.0, 160.0, 210.0, 25.0, 0.0, 80.0, 170.0, 180.0, 70.0, 60.0, 60.0, 250.0, 100.0, 40.0, 30.0, 330.0, 210.0, 130.0, 50.0, 60.0, 20.0, 150.0, 50.0, 100.0, 70.0, 50.0, 360.0, 90.0, 210.0, 60.0, 10.0, 60.0, 90.0, 10.0, 70.0, 90.0, 60.0, 40.0, 350.0, 110.0, 320.0, 80.0, 30.0, 50.0, 290.0, 110.0, 60.0, 160.0, 200.0, -95.0, 320.0, 200.0, 40.0, 310.0, 10.0, 120.0, 210.0, 100.0, -50.0, 180.0, 10.0, 230.0, 280.0, 50.0, 90.0, -30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 80.0, 70.0, 60.0, 80.0, 140.0, 470.0, 30.0, 340.0, -10.0, 160.0, 40.0, 320.0, 130.0, -5.0, 40.0, 235.0, 100.0, 150.0, 30.0, 180.0, 30.0, 40.0, 10.0, 10.0, 220.0, 10.0, 200.0, 50.0, 100.0, 160.0, 110.0, 60.0, 20.0, 40.0, 160.0, 70.0, 200.0, 20.0, 270.0, 80.0, 10.0, 150.0, 120.0, 40.0, 0.0, 30.0, 70.0, 20.0, 20.0, 10.0, 30.0, -10.0, 80.0, 0.0, 130.0, 360.0, 15.0, 50.0, 10.0, 190.0, 130.0, 120.0, 20.0, 340.0, 0.0, 0.0, 20.0, 20.0, 30.0, 20.0, 170.0, 10.0, 830.0, 80.0, 150.0, 170.0, 130.0, 60.0, 70.0, 50.0, 100.0, 110.0, 200.0, 120.0, 60.0, 100.0, 90.0, 170.0, 170.0, -10.0, 30.0, 0.0, 10.0, 140.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 60.0, 10.0, 70.0, 100.0, 70.0, 10.0, 300.0, 270.0, 370.0, 180.0, 210.0, 80.0, 50.0, 40.0, 110.0, 320.0, 150.0, 80.0, 80.0, 250.0, 0.0, 130.0, 90.0, -30.0, 80.0, 110.0, 60.0, 210.0, 40.0, 200.0, 130.0, 300.0, 100.0, 20.0, 340.0, 100.0, 210.0, 40.0, 90.0, 170.0, 90.0, 90.0, 400.0, 90.0, 80.0, 170.0, 50.0, 260.0, 20.0, 80.0, 20.0, 30.0, 10.0, 120.0, 40.0, 150.0, 20.0, 40.0, 340.0, 120.0, 110.0, 60.0, 170.0, 50.0, 80.0, 10.0, 80.0, 80.0, 80.0, 170.0, 80.0, 270.0, 410.0, 90.0, 60.0, 30.0, 100.0, 120.0, 260.0, 40.0, 180.0, 80.0, 20.0, 120.0, 120.0, 40.0, 120.0, 300.0, 50.0, 100.0, 180.0, 60.0, 100.0, 90.0, 180.0, 40.0, 40.0, 120.0, 210.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, -10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 10.0, 180.0, 110.0, 300.0, 100.0, 150.0, 260.0, 380.0, 40.0, 0.0, 130.0, 110.0, 80.0, 40.0, 90.0, 180.0, 30.0, 10.0, -40.0, 140.0, 680.0, 120.0, 130.0, 100.0, 0.0, 0.0, 280.0, 90.0, 20.0, 40.0, 20.0, 50.0, 70.0, 130.0, 120.0, 110.0, -10.0, 130.0, 40.0, 80.0, 10.0, -20.0, 100.0, 0.0, 250.0, 20.0, 120.0, 50.0, 80.0, 50.0, 360.0, 30.0, 140.0, 80.0, 740.0, 200.0, -10.0, -50.0, 210.0, 60.0, 60.0, 160.0, 30.0, 10.0, 180.0, 200.0, 330.0, 10.0, 140.0, 40.0, 70.0, 190.0, 70.0, 60.0, 270.0, 30.0, 10.0, 230.0, 60.0, 20.0, -20.0, 90.0, 120.0, 360.0, 170.0, 110.0, 340.0, 90.0, 20.0, 60.0, 40.0, 30.0, 10.0, 70.0, 190.0, 50.0, 60.0, 40.0, 80.0, 30.0, 260.0, -20.0, -50.0, -10.0, 10.0, 60.0, 160.0, 40.0, 50.0, 190.0, 210.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6812619976758834, "mean_inference_ms": 1.4915923878472805, "mean_action_processing_ms": 0.43086258181362297, "mean_env_wait_ms": 1.3505883492409947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013679742813110352, "StateBufferConnector_ms": 0.010853052139282227, "ViewRequirementAgentConnector_ms": 0.3989875316619873}, "num_episodes": 18, "episode_return_max": 1840.0, "episode_return_min": 90.0, "episode_return_mean": 1008.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.322344781970248, "num_env_steps_trained_throughput_per_sec": 19.322344781970248, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 208848.942, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208848.896, "sample_time_ms": 2720.568, "learn_time_ms": 206107.638, "learn_throughput": 19.407, "synch_weights_time_ms": 11.153}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 74, "trial_id": "aa996_00000", "date": "2024-05-24_03-02-33", "timestamp": 1716534153, "time_this_iter_s": 207.02489590644836, "time_total_s": 15420.523245334625, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d9f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15420.523245334625, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 18.861774744027304, "ram_util_percent": 78.66621160409555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7906946760270035, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.943286886306616, "policy_loss": -0.00779245781600158, "vf_loss": 6.949885722242605, "vf_explained_var": -0.003789400863952149, "kl": 0.005968090728836622, "entropy": 0.3743122943705771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 699555.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "env_runners": {"episode_reward_max": 1840.0, "episode_reward_min": 90.0, "episode_reward_mean": 1034.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 960.0}, "policy_reward_mean": {"policy_0": 103.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [800.0, 1060.0, 980.0, 1285.0, 1500.0, 1195.0, 1330.0, 830.0, 410.0, 1205.0, 1320.0, 610.0, 1285.0, 695.0, 1050.0, 750.0, 1480.0, 500.0, 1240.0, 1310.0, 1060.0, 830.0, 595.0, 755.0, 1390.0, 1280.0, 830.0, 1310.0, 960.0, 260.0, 735.0, 1840.0, 1520.0, 1250.0, 1010.0, 960.0, 1240.0, 1520.0, 1105.0, 1120.0, 1060.0, 1220.0, 1325.0, 1160.0, 560.0, 1380.0, 1210.0, 910.0, 930.0, 490.0, 955.0, 740.0, 1650.0, 1040.0, 220.0, 1290.0, 1300.0, 940.0, 1530.0, 1420.0, 850.0, 840.0, 1590.0, 1070.0, 1120.0, 90.0, 310.0, 1580.0, 1330.0, 730.0, 660.0, 1060.0, 1590.0, 1200.0, 820.0, 1340.0, 770.0, 720.0, 1110.0, 590.0, 1500.0, 1320.0, 650.0, 1500.0, 590.0, 770.0, 430.0, 1140.0, 1400.0, 100.0, 1370.0, 820.0, 1345.0, 1410.0, 1560.0, 810.0, 940.0, 1050.0, 700.0, 940.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 0.0, 120.0, 30.0, 40.0, 150.0, 10.0, 200.0, 210.0, 30.0, 70.0, 200.0, 330.0, 190.0, 40.0, 30.0, 50.0, 20.0, 100.0, 30.0, 50.0, 110.0, 40.0, 10.0, 110.0, 10.0, 50.0, 310.0, 260.0, 30.0, 70.0, 90.0, 100.0, 45.0, 90.0, 90.0, 150.0, 440.0, 180.0, 130.0, 60.0, 20.0, 250.0, 260.0, 310.0, 240.0, 70.0, 50.0, 110.0, 280.0, 25.0, 270.0, 300.0, 50.0, 40.0, 120.0, 60.0, 0.0, 50.0, 80.0, 70.0, 40.0, 70.0, 140.0, 120.0, 210.0, 260.0, 60.0, 280.0, 0.0, 220.0, 20.0, 260.0, 20.0, 0.0, 180.0, 100.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 250.0, 40.0, 10.0, 30.0, 20.0, 10.0, 45.0, 40.0, 40.0, 360.0, 140.0, 60.0, 60.0, -30.0, 280.0, 210.0, 0.0, 220.0, 300.0, 140.0, 100.0, 310.0, 100.0, 80.0, 20.0, 50.0, 70.0, 80.0, 130.0, -50.0, 20.0, 250.0, 70.0, 40.0, 0.0, 0.0, 190.0, 260.0, 195.0, 60.0, 110.0, 40.0, 130.0, 210.0, 20.0, 70.0, 10.0, -35.0, 150.0, 80.0, 40.0, 50.0, 80.0, 250.0, 30.0, 40.0, 170.0, 50.0, 100.0, 90.0, 180.0, 30.0, 20.0, 60.0, 300.0, 50.0, 40.0, 210.0, 10.0, 50.0, 150.0, 20.0, 330.0, -100.0, 10.0, 30.0, 100.0, 60.0, 100.0, 70.0, 10.0, 190.0, 190.0, 670.0, 10.0, 80.0, 0.0, 30.0, 70.0, 10.0, 170.0, 20.0, 50.0, 30.0, 80.0, 40.0, 240.0, 10.0, 110.0, 30.0, 90.0, 210.0, 270.0, 80.0, 120.0, 80.0, 380.0, 20.0, -30.0, 270.0, 80.0, 20.0, 170.0, 10.0, 190.0, 200.0, 170.0, 290.0, 230.0, 80.0, 160.0, 40.0, -20.0, 20.0, 30.0, 60.0, 10.0, 40.0, 70.0, 50.0, 190.0, 20.0, 60.0, 330.0, 40.0, 20.0, 180.0, 40.0, 70.0, 40.0, 20.0, 40.0, 60.0, 140.0, 40.0, -35.0, 80.0, 650.0, 30.0, 30.0, 0.0, 50.0, 20.0, -125.0, -20.0, 40.0, 260.0, 90.0, 90.0, 100.0, 450.0, 100.0, 240.0, -140.0, 130.0, 70.0, 40.0, 40.0, 30.0, 260.0, 50.0, 70.0, 600.0, 90.0, 30.0, 70.0, 30.0, 70.0, 270.0, 40.0, 210.0, 70.0, 230.0, -40.0, -30.0, -20.0, 60.0, 150.0, 240.0, 60.0, 110.0, 130.0, 220.0, 240.0, 0.0, 100.0, 40.0, 270.0, 80.0, 100.0, 10.0, 140.0, 70.0, 30.0, 40.0, 180.0, 70.0, 0.0, 20.0, 0.0, 90.0, 60.0, 0.0, 0.0, 10.0, 10.0, 55.0, 30.0, 130.0, 60.0, 70.0, 110.0, 200.0, 120.0, -100.0, 60.0, 560.0, 80.0, 120.0, 170.0, 320.0, 310.0, 90.0, 80.0, 40.0, 70.0, 210.0, 50.0, 10.0, 70.0, 40.0, 70.0, 330.0, 190.0, 170.0, 380.0, 0.0, 30.0, 170.0, 70.0, 60.0, 70.0, 530.0, 230.0, 50.0, 40.0, 90.0, 40.0, 40.0, 280.0, 100.0, 60.0, 170.0, 110.0, 110.0, 10.0, -60.0, 260.0, 50.0, 60.0, 10.0, 290.0, 110.0, 50.0, 150.0, 40.0, -20.0, 170.0, 0.0, 150.0, 180.0, 100.0, 260.0, 70.0, 330.0, 0.0, 80.0, 70.0, 100.0, 310.0, 340.0, 220.0, 70.0, 120.0, 50.0, 160.0, 210.0, 25.0, 0.0, 80.0, 170.0, 180.0, 70.0, 60.0, 60.0, 250.0, 100.0, 40.0, 30.0, 330.0, 210.0, 130.0, 50.0, 60.0, 20.0, 150.0, 50.0, 100.0, 70.0, 50.0, 360.0, 90.0, 210.0, 60.0, 10.0, 60.0, 90.0, 10.0, 70.0, 90.0, 60.0, 40.0, 350.0, 110.0, 320.0, 80.0, 30.0, 50.0, 290.0, 110.0, 60.0, 160.0, 200.0, -95.0, 320.0, 200.0, 40.0, 310.0, 10.0, 120.0, 210.0, 100.0, -50.0, 180.0, 10.0, 230.0, 280.0, 50.0, 90.0, -30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 80.0, 70.0, 60.0, 80.0, 140.0, 470.0, 30.0, 340.0, -10.0, 160.0, 40.0, 320.0, 130.0, -5.0, 40.0, 235.0, 100.0, 150.0, 30.0, 180.0, 30.0, 40.0, 10.0, 10.0, 220.0, 10.0, 200.0, 50.0, 100.0, 160.0, 110.0, 60.0, 20.0, 40.0, 160.0, 70.0, 200.0, 20.0, 270.0, 80.0, 10.0, 150.0, 120.0, 40.0, 0.0, 30.0, 70.0, 20.0, 20.0, 10.0, 30.0, -10.0, 80.0, 0.0, 130.0, 360.0, 15.0, 50.0, 10.0, 190.0, 130.0, 120.0, 20.0, 340.0, 0.0, 0.0, 20.0, 20.0, 30.0, 20.0, 170.0, 10.0, 830.0, 80.0, 150.0, 170.0, 130.0, 60.0, 70.0, 50.0, 100.0, 110.0, 200.0, 120.0, 60.0, 100.0, 90.0, 170.0, 170.0, -10.0, 30.0, 0.0, 10.0, 140.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 60.0, 10.0, 70.0, 100.0, 70.0, 10.0, 300.0, 270.0, 370.0, 180.0, 210.0, 80.0, 50.0, 40.0, 110.0, 320.0, 150.0, 80.0, 80.0, 250.0, 0.0, 130.0, 90.0, -30.0, 80.0, 110.0, 60.0, 210.0, 40.0, 200.0, 130.0, 300.0, 100.0, 20.0, 340.0, 100.0, 210.0, 40.0, 90.0, 170.0, 90.0, 90.0, 400.0, 90.0, 80.0, 170.0, 50.0, 260.0, 20.0, 80.0, 20.0, 30.0, 10.0, 120.0, 40.0, 150.0, 20.0, 40.0, 340.0, 120.0, 110.0, 60.0, 170.0, 50.0, 80.0, 10.0, 80.0, 80.0, 80.0, 170.0, 80.0, 270.0, 410.0, 90.0, 60.0, 30.0, 100.0, 120.0, 260.0, 40.0, 180.0, 80.0, 20.0, 120.0, 120.0, 40.0, 120.0, 300.0, 50.0, 100.0, 180.0, 60.0, 100.0, 90.0, 180.0, 40.0, 40.0, 120.0, 210.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, -10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 10.0, 180.0, 110.0, 300.0, 100.0, 150.0, 260.0, 380.0, 40.0, 0.0, 130.0, 110.0, 80.0, 40.0, 90.0, 180.0, 30.0, 10.0, -40.0, 140.0, 680.0, 120.0, 130.0, 100.0, 0.0, 0.0, 280.0, 90.0, 20.0, 40.0, 20.0, 50.0, 70.0, 130.0, 120.0, 110.0, -10.0, 130.0, 40.0, 80.0, 10.0, -20.0, 100.0, 0.0, 250.0, 20.0, 120.0, 50.0, 80.0, 50.0, 360.0, 30.0, 140.0, 80.0, 740.0, 200.0, -10.0, -50.0, 210.0, 60.0, 60.0, 160.0, 30.0, 10.0, 180.0, 200.0, 330.0, 10.0, 140.0, 40.0, 70.0, 190.0, 70.0, 60.0, 270.0, 30.0, 10.0, 230.0, 60.0, 20.0, -20.0, 90.0, 120.0, 360.0, 170.0, 110.0, 340.0, 90.0, 20.0, 60.0, 40.0, 30.0, 10.0, 70.0, 190.0, 50.0, 60.0, 40.0, 80.0, 30.0, 260.0, -20.0, -50.0, -10.0, 10.0, 60.0, 160.0, 40.0, 50.0, 190.0, 210.0, 60.0, 20.0, 110.0, 180.0, 130.0, 90.0, 140.0, 70.0, 40.0, 240.0, 90.0, 20.0, 60.0, 40.0, 20.0, 40.0, 100.0, 10.0, 80.0, 120.0, 100.0, 170.0, 70.0, 90.0, 220.0, 190.0, 70.0, 40.0, 120.0, 480.0, 50.0, 40.0, 130.0, 70.0, 500.0, 100.0, 10.0, 130.0, 210.0, 30.0, 100.0, 160.0, 0.0, 30.0, 10.0, 260.0, 50.0, 30.0, 30.0, 40.0, 40.0, 30.0, 960.0, 40.0, 90.0, 160.0, 60.0, 60.0, 40.0, 40.0, 20.0, 50.0, 30.0, 30.0, 180.0, 100.0, 0.0, 0.0, 20.0, 100.0, 80.0, 30.0, 20.0, 20.0, 50.0, 270.0, 10.0, 10.0, 190.0, 80.0, 90.0, 70.0, 80.0, -40.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 270.0, 70.0, 140.0, 40.0, -20.0, 210.0, 40.0, 380.0, 30.0, 20.0, 230.0, 80.0, 90.0, 480.0, 230.0, 10.0, 180.0, 50.0, 30.0, 30.0, 220.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 30.0, 0.0, 340.0, 90.0, 140.0, 80.0, 290.0, 180.0, 200.0, -20.0, 10.0, 60.0, 50.0, 210.0, 100.0, 30.0, 0.0, 0.0, 160.0, 60.0, 190.0, 20.0, 195.0, 250.0, 90.0, 50.0, 110.0, 140.0, 240.0, 50.0, 70.0, 150.0, 120.0, 310.0, 60.0, 210.0, 140.0, 110.0, 200.0, 30.0, 120.0, 110.0, 30.0, 50.0, 90.0, 130.0, 680.0, 80.0, 190.0, 70.0, 120.0, 120.0, 10.0, 20.0, 90.0, 0.0, 190.0, 20.0, 30.0, 380.0, 70.0, 0.0, 170.0, 0.0, 100.0, 110.0, 20.0, 70.0, 280.0, 90.0, 60.0, 40.0, 110.0, 420.0, 120.0, 40.0, 60.0, 60.0, 0.0, 80.0, 170.0, -10.0, 0.0, 0.0, 170.0, 70.0, 60.0, 40.0, 290.0, 20.0, 40.0, 10.0, 30.0, 300.0, 10.0, 0.0, 30.0, 30.0, 130.0, 400.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6821934777716072, "mean_inference_ms": 1.4929020331749165, "mean_action_processing_ms": 0.4307361009019667, "mean_env_wait_ms": 1.3491941124873206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013384342193603516, "StateBufferConnector_ms": 0.010585308074951172, "ViewRequirementAgentConnector_ms": 0.39525270462036133}, "num_episodes": 22, "episode_return_max": 1840.0, "episode_return_min": 90.0, "episode_return_mean": 1034.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.308621210471628, "num_env_steps_trained_throughput_per_sec": 19.308621210471628, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 3000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000000, "timers": {"training_iteration_time_ms": 208808.429, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208808.384, "sample_time_ms": 2729.308, "learn_time_ms": 206058.171, "learn_throughput": 19.412, "synch_weights_time_ms": 11.277}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "done": false, "training_iteration": 75, "trial_id": "aa996_00000", "date": "2024-05-24_03-06-01", "timestamp": 1716534361, "time_this_iter_s": 207.169264793396, "time_total_s": 15627.692510128021, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x16003e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15627.692510128021, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 19.000341296928326, "ram_util_percent": 78.33924914675768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0242510368521858, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.348861797726827, "policy_loss": -0.008933685106722215, "vf_loss": 7.356490226497792, "vf_explained_var": 0.00028293377167373676, "kl": 0.006526272248624372, "entropy": 0.368151414484833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 708945.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 1840.0, "episode_reward_min": 90.0, "episode_reward_mean": 1048.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 960.0}, "policy_reward_mean": {"policy_0": 104.885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1240.0, 1310.0, 1060.0, 830.0, 595.0, 755.0, 1390.0, 1280.0, 830.0, 1310.0, 960.0, 260.0, 735.0, 1840.0, 1520.0, 1250.0, 1010.0, 960.0, 1240.0, 1520.0, 1105.0, 1120.0, 1060.0, 1220.0, 1325.0, 1160.0, 560.0, 1380.0, 1210.0, 910.0, 930.0, 490.0, 955.0, 740.0, 1650.0, 1040.0, 220.0, 1290.0, 1300.0, 940.0, 1530.0, 1420.0, 850.0, 840.0, 1590.0, 1070.0, 1120.0, 90.0, 310.0, 1580.0, 1330.0, 730.0, 660.0, 1060.0, 1590.0, 1200.0, 820.0, 1340.0, 770.0, 720.0, 1110.0, 590.0, 1500.0, 1320.0, 650.0, 1500.0, 590.0, 770.0, 430.0, 1140.0, 1400.0, 100.0, 1370.0, 820.0, 1345.0, 1410.0, 1560.0, 810.0, 940.0, 1050.0, 700.0, 940.0, 1150.0, 970.0, 1195.0, 1175.0, 830.0, 380.0, 1340.0, 760.0, 1335.0, 1280.0, 1320.0, 920.0, 1260.0, 1350.0, 940.0, 1170.0, 910.0, 1435.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [240.0, 10.0, 110.0, 30.0, 90.0, 210.0, 270.0, 80.0, 120.0, 80.0, 380.0, 20.0, -30.0, 270.0, 80.0, 20.0, 170.0, 10.0, 190.0, 200.0, 170.0, 290.0, 230.0, 80.0, 160.0, 40.0, -20.0, 20.0, 30.0, 60.0, 10.0, 40.0, 70.0, 50.0, 190.0, 20.0, 60.0, 330.0, 40.0, 20.0, 180.0, 40.0, 70.0, 40.0, 20.0, 40.0, 60.0, 140.0, 40.0, -35.0, 80.0, 650.0, 30.0, 30.0, 0.0, 50.0, 20.0, -125.0, -20.0, 40.0, 260.0, 90.0, 90.0, 100.0, 450.0, 100.0, 240.0, -140.0, 130.0, 70.0, 40.0, 40.0, 30.0, 260.0, 50.0, 70.0, 600.0, 90.0, 30.0, 70.0, 30.0, 70.0, 270.0, 40.0, 210.0, 70.0, 230.0, -40.0, -30.0, -20.0, 60.0, 150.0, 240.0, 60.0, 110.0, 130.0, 220.0, 240.0, 0.0, 100.0, 40.0, 270.0, 80.0, 100.0, 10.0, 140.0, 70.0, 30.0, 40.0, 180.0, 70.0, 0.0, 20.0, 0.0, 90.0, 60.0, 0.0, 0.0, 10.0, 10.0, 55.0, 30.0, 130.0, 60.0, 70.0, 110.0, 200.0, 120.0, -100.0, 60.0, 560.0, 80.0, 120.0, 170.0, 320.0, 310.0, 90.0, 80.0, 40.0, 70.0, 210.0, 50.0, 10.0, 70.0, 40.0, 70.0, 330.0, 190.0, 170.0, 380.0, 0.0, 30.0, 170.0, 70.0, 60.0, 70.0, 530.0, 230.0, 50.0, 40.0, 90.0, 40.0, 40.0, 280.0, 100.0, 60.0, 170.0, 110.0, 110.0, 10.0, -60.0, 260.0, 50.0, 60.0, 10.0, 290.0, 110.0, 50.0, 150.0, 40.0, -20.0, 170.0, 0.0, 150.0, 180.0, 100.0, 260.0, 70.0, 330.0, 0.0, 80.0, 70.0, 100.0, 310.0, 340.0, 220.0, 70.0, 120.0, 50.0, 160.0, 210.0, 25.0, 0.0, 80.0, 170.0, 180.0, 70.0, 60.0, 60.0, 250.0, 100.0, 40.0, 30.0, 330.0, 210.0, 130.0, 50.0, 60.0, 20.0, 150.0, 50.0, 100.0, 70.0, 50.0, 360.0, 90.0, 210.0, 60.0, 10.0, 60.0, 90.0, 10.0, 70.0, 90.0, 60.0, 40.0, 350.0, 110.0, 320.0, 80.0, 30.0, 50.0, 290.0, 110.0, 60.0, 160.0, 200.0, -95.0, 320.0, 200.0, 40.0, 310.0, 10.0, 120.0, 210.0, 100.0, -50.0, 180.0, 10.0, 230.0, 280.0, 50.0, 90.0, -30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 80.0, 70.0, 60.0, 80.0, 140.0, 470.0, 30.0, 340.0, -10.0, 160.0, 40.0, 320.0, 130.0, -5.0, 40.0, 235.0, 100.0, 150.0, 30.0, 180.0, 30.0, 40.0, 10.0, 10.0, 220.0, 10.0, 200.0, 50.0, 100.0, 160.0, 110.0, 60.0, 20.0, 40.0, 160.0, 70.0, 200.0, 20.0, 270.0, 80.0, 10.0, 150.0, 120.0, 40.0, 0.0, 30.0, 70.0, 20.0, 20.0, 10.0, 30.0, -10.0, 80.0, 0.0, 130.0, 360.0, 15.0, 50.0, 10.0, 190.0, 130.0, 120.0, 20.0, 340.0, 0.0, 0.0, 20.0, 20.0, 30.0, 20.0, 170.0, 10.0, 830.0, 80.0, 150.0, 170.0, 130.0, 60.0, 70.0, 50.0, 100.0, 110.0, 200.0, 120.0, 60.0, 100.0, 90.0, 170.0, 170.0, -10.0, 30.0, 0.0, 10.0, 140.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 60.0, 10.0, 70.0, 100.0, 70.0, 10.0, 300.0, 270.0, 370.0, 180.0, 210.0, 80.0, 50.0, 40.0, 110.0, 320.0, 150.0, 80.0, 80.0, 250.0, 0.0, 130.0, 90.0, -30.0, 80.0, 110.0, 60.0, 210.0, 40.0, 200.0, 130.0, 300.0, 100.0, 20.0, 340.0, 100.0, 210.0, 40.0, 90.0, 170.0, 90.0, 90.0, 400.0, 90.0, 80.0, 170.0, 50.0, 260.0, 20.0, 80.0, 20.0, 30.0, 10.0, 120.0, 40.0, 150.0, 20.0, 40.0, 340.0, 120.0, 110.0, 60.0, 170.0, 50.0, 80.0, 10.0, 80.0, 80.0, 80.0, 170.0, 80.0, 270.0, 410.0, 90.0, 60.0, 30.0, 100.0, 120.0, 260.0, 40.0, 180.0, 80.0, 20.0, 120.0, 120.0, 40.0, 120.0, 300.0, 50.0, 100.0, 180.0, 60.0, 100.0, 90.0, 180.0, 40.0, 40.0, 120.0, 210.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, -10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 10.0, 180.0, 110.0, 300.0, 100.0, 150.0, 260.0, 380.0, 40.0, 0.0, 130.0, 110.0, 80.0, 40.0, 90.0, 180.0, 30.0, 10.0, -40.0, 140.0, 680.0, 120.0, 130.0, 100.0, 0.0, 0.0, 280.0, 90.0, 20.0, 40.0, 20.0, 50.0, 70.0, 130.0, 120.0, 110.0, -10.0, 130.0, 40.0, 80.0, 10.0, -20.0, 100.0, 0.0, 250.0, 20.0, 120.0, 50.0, 80.0, 50.0, 360.0, 30.0, 140.0, 80.0, 740.0, 200.0, -10.0, -50.0, 210.0, 60.0, 60.0, 160.0, 30.0, 10.0, 180.0, 200.0, 330.0, 10.0, 140.0, 40.0, 70.0, 190.0, 70.0, 60.0, 270.0, 30.0, 10.0, 230.0, 60.0, 20.0, -20.0, 90.0, 120.0, 360.0, 170.0, 110.0, 340.0, 90.0, 20.0, 60.0, 40.0, 30.0, 10.0, 70.0, 190.0, 50.0, 60.0, 40.0, 80.0, 30.0, 260.0, -20.0, -50.0, -10.0, 10.0, 60.0, 160.0, 40.0, 50.0, 190.0, 210.0, 60.0, 20.0, 110.0, 180.0, 130.0, 90.0, 140.0, 70.0, 40.0, 240.0, 90.0, 20.0, 60.0, 40.0, 20.0, 40.0, 100.0, 10.0, 80.0, 120.0, 100.0, 170.0, 70.0, 90.0, 220.0, 190.0, 70.0, 40.0, 120.0, 480.0, 50.0, 40.0, 130.0, 70.0, 500.0, 100.0, 10.0, 130.0, 210.0, 30.0, 100.0, 160.0, 0.0, 30.0, 10.0, 260.0, 50.0, 30.0, 30.0, 40.0, 40.0, 30.0, 960.0, 40.0, 90.0, 160.0, 60.0, 60.0, 40.0, 40.0, 20.0, 50.0, 30.0, 30.0, 180.0, 100.0, 0.0, 0.0, 20.0, 100.0, 80.0, 30.0, 20.0, 20.0, 50.0, 270.0, 10.0, 10.0, 190.0, 80.0, 90.0, 70.0, 80.0, -40.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 270.0, 70.0, 140.0, 40.0, -20.0, 210.0, 40.0, 380.0, 30.0, 20.0, 230.0, 80.0, 90.0, 480.0, 230.0, 10.0, 180.0, 50.0, 30.0, 30.0, 220.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 30.0, 0.0, 340.0, 90.0, 140.0, 80.0, 290.0, 180.0, 200.0, -20.0, 10.0, 60.0, 50.0, 210.0, 100.0, 30.0, 0.0, 0.0, 160.0, 60.0, 190.0, 20.0, 195.0, 250.0, 90.0, 50.0, 110.0, 140.0, 240.0, 50.0, 70.0, 150.0, 120.0, 310.0, 60.0, 210.0, 140.0, 110.0, 200.0, 30.0, 120.0, 110.0, 30.0, 50.0, 90.0, 130.0, 680.0, 80.0, 190.0, 70.0, 120.0, 120.0, 10.0, 20.0, 90.0, 0.0, 190.0, 20.0, 30.0, 380.0, 70.0, 0.0, 170.0, 0.0, 100.0, 110.0, 20.0, 70.0, 280.0, 90.0, 60.0, 40.0, 110.0, 420.0, 120.0, 40.0, 60.0, 60.0, 0.0, 80.0, 170.0, -10.0, 0.0, 0.0, 170.0, 70.0, 60.0, 40.0, 290.0, 20.0, 40.0, 10.0, 30.0, 300.0, 10.0, 0.0, 30.0, 30.0, 130.0, 400.0, 10.0, 0.0, 380.0, 10.0, 40.0, 60.0, 40.0, 20.0, 240.0, 130.0, 190.0, 40.0, 0.0, 110.0, 170.0, 10.0, 50.0, 40.0, 60.0, 320.0, 170.0, 40.0, 20.0, 370.0, 90.0, 240.0, 70.0, 75.0, 60.0, 40.0, 170.0, 60.0, 190.0, 20.0, 190.0, 150.0, 90.0, 290.0, 70.0, 65.0, 20.0, 90.0, 40.0, 25.0, 25.0, 300.0, 40.0, 80.0, 110.0, 80.0, 10.0, 120.0, 20.0, 10.0, 20.0, 10.0, 20.0, 190.0, 0.0, 40.0, 40.0, 30.0, 340.0, 110.0, 160.0, 10.0, 140.0, 30.0, 60.0, 160.0, 40.0, 290.0, 0.0, 10.0, 80.0, 80.0, 160.0, 20.0, 200.0, 10.0, 180.0, 20.0, 170.0, 310.0, 70.0, 100.0, 25.0, 190.0, 150.0, 160.0, 90.0, 70.0, 100.0, 160.0, 70.0, 240.0, 80.0, 190.0, 60.0, 340.0, -40.0, 80.0, 110.0, 120.0, 110.0, 100.0, 110.0, 210.0, 150.0, 100.0, 150.0, 160.0, 20.0, 260.0, 20.0, 50.0, 30.0, 30.0, 50.0, 270.0, 0.0, 190.0, 170.0, 340.0, 60.0, 80.0, 180.0, 120.0, 30.0, 40.0, 150.0, 90.0, 200.0, 380.0, 140.0, 60.0, 100.0, 60.0, 90.0, 20.0, 190.0, 110.0, 40.0, 40.0, 40.0, 240.0, 150.0, 50.0, 50.0, 100.0, 90.0, 140.0, 100.0, 270.0, 50.0, -10.0, 160.0, 20.0, 90.0, 160.0, 280.0, 50.0, 190.0, 30.0, 80.0, 0.0, 90.0, 80.0, 90.0, 150.0, 150.0, 50.0, -30.0, 110.0, 40.0, -15.0, 90.0, 410.0, 100.0, 430.0, 170.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6809286099293552, "mean_inference_ms": 1.4916361771924682, "mean_action_processing_ms": 0.43027335338807093, "mean_env_wait_ms": 1.3499407404519201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01280069351196289, "StateBufferConnector_ms": 0.009705543518066406, "ViewRequirementAgentConnector_ms": 0.3865818977355957}, "num_episodes": 18, "episode_return_max": 1840.0, "episode_return_min": 90.0, "episode_return_mean": 1048.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.80814162747179, "num_env_steps_trained_throughput_per_sec": 18.80814162747179, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 209207.343, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209207.297, "sample_time_ms": 2716.548, "learn_time_ms": 206469.885, "learn_throughput": 19.373, "synch_weights_time_ms": 11.241}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 76, "trial_id": "aa996_00000", "date": "2024-05-24_03-09-33", "timestamp": 1716534573, "time_this_iter_s": 212.68489527702332, "time_total_s": 15840.377405405045, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d9f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15840.377405405045, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 22.130999999999997, "ram_util_percent": 78.74766666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0165233364183934, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.191022024774196, "policy_loss": -0.00871963523932325, "vf_loss": 7.1984915014273065, "vf_explained_var": 0.0011068961808221916, "kl": 0.006250816158131426, "entropy": 0.3478571148964163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 718335.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "env_runners": {"episode_reward_max": 1780.0, "episode_reward_min": 90.0, "episode_reward_mean": 1064.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -95.0}, "policy_reward_max": {"policy_0": 960.0}, "policy_reward_mean": {"policy_0": 106.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.0, 1325.0, 1160.0, 560.0, 1380.0, 1210.0, 910.0, 930.0, 490.0, 955.0, 740.0, 1650.0, 1040.0, 220.0, 1290.0, 1300.0, 940.0, 1530.0, 1420.0, 850.0, 840.0, 1590.0, 1070.0, 1120.0, 90.0, 310.0, 1580.0, 1330.0, 730.0, 660.0, 1060.0, 1590.0, 1200.0, 820.0, 1340.0, 770.0, 720.0, 1110.0, 590.0, 1500.0, 1320.0, 650.0, 1500.0, 590.0, 770.0, 430.0, 1140.0, 1400.0, 100.0, 1370.0, 820.0, 1345.0, 1410.0, 1560.0, 810.0, 940.0, 1050.0, 700.0, 940.0, 1150.0, 970.0, 1195.0, 1175.0, 830.0, 380.0, 1340.0, 760.0, 1335.0, 1280.0, 1320.0, 920.0, 1260.0, 1350.0, 940.0, 1170.0, 910.0, 1435.0, 1300.0, 1210.0, 1420.0, 1310.0, 470.0, 1200.0, 1220.0, 1020.0, 1350.0, 880.0, 1460.0, 1425.0, 1130.0, 680.0, 1310.0, 1460.0, 860.0, 710.0, 1120.0, 1780.0, 1460.0, 940.0, 1020.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 10.0, 70.0, 90.0, 60.0, 40.0, 350.0, 110.0, 320.0, 80.0, 30.0, 50.0, 290.0, 110.0, 60.0, 160.0, 200.0, -95.0, 320.0, 200.0, 40.0, 310.0, 10.0, 120.0, 210.0, 100.0, -50.0, 180.0, 10.0, 230.0, 280.0, 50.0, 90.0, -30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 80.0, 70.0, 60.0, 80.0, 140.0, 470.0, 30.0, 340.0, -10.0, 160.0, 40.0, 320.0, 130.0, -5.0, 40.0, 235.0, 100.0, 150.0, 30.0, 180.0, 30.0, 40.0, 10.0, 10.0, 220.0, 10.0, 200.0, 50.0, 100.0, 160.0, 110.0, 60.0, 20.0, 40.0, 160.0, 70.0, 200.0, 20.0, 270.0, 80.0, 10.0, 150.0, 120.0, 40.0, 0.0, 30.0, 70.0, 20.0, 20.0, 10.0, 30.0, -10.0, 80.0, 0.0, 130.0, 360.0, 15.0, 50.0, 10.0, 190.0, 130.0, 120.0, 20.0, 340.0, 0.0, 0.0, 20.0, 20.0, 30.0, 20.0, 170.0, 10.0, 830.0, 80.0, 150.0, 170.0, 130.0, 60.0, 70.0, 50.0, 100.0, 110.0, 200.0, 120.0, 60.0, 100.0, 90.0, 170.0, 170.0, -10.0, 30.0, 0.0, 10.0, 140.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 60.0, 10.0, 70.0, 100.0, 70.0, 10.0, 300.0, 270.0, 370.0, 180.0, 210.0, 80.0, 50.0, 40.0, 110.0, 320.0, 150.0, 80.0, 80.0, 250.0, 0.0, 130.0, 90.0, -30.0, 80.0, 110.0, 60.0, 210.0, 40.0, 200.0, 130.0, 300.0, 100.0, 20.0, 340.0, 100.0, 210.0, 40.0, 90.0, 170.0, 90.0, 90.0, 400.0, 90.0, 80.0, 170.0, 50.0, 260.0, 20.0, 80.0, 20.0, 30.0, 10.0, 120.0, 40.0, 150.0, 20.0, 40.0, 340.0, 120.0, 110.0, 60.0, 170.0, 50.0, 80.0, 10.0, 80.0, 80.0, 80.0, 170.0, 80.0, 270.0, 410.0, 90.0, 60.0, 30.0, 100.0, 120.0, 260.0, 40.0, 180.0, 80.0, 20.0, 120.0, 120.0, 40.0, 120.0, 300.0, 50.0, 100.0, 180.0, 60.0, 100.0, 90.0, 180.0, 40.0, 40.0, 120.0, 210.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, -10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 10.0, 180.0, 110.0, 300.0, 100.0, 150.0, 260.0, 380.0, 40.0, 0.0, 130.0, 110.0, 80.0, 40.0, 90.0, 180.0, 30.0, 10.0, -40.0, 140.0, 680.0, 120.0, 130.0, 100.0, 0.0, 0.0, 280.0, 90.0, 20.0, 40.0, 20.0, 50.0, 70.0, 130.0, 120.0, 110.0, -10.0, 130.0, 40.0, 80.0, 10.0, -20.0, 100.0, 0.0, 250.0, 20.0, 120.0, 50.0, 80.0, 50.0, 360.0, 30.0, 140.0, 80.0, 740.0, 200.0, -10.0, -50.0, 210.0, 60.0, 60.0, 160.0, 30.0, 10.0, 180.0, 200.0, 330.0, 10.0, 140.0, 40.0, 70.0, 190.0, 70.0, 60.0, 270.0, 30.0, 10.0, 230.0, 60.0, 20.0, -20.0, 90.0, 120.0, 360.0, 170.0, 110.0, 340.0, 90.0, 20.0, 60.0, 40.0, 30.0, 10.0, 70.0, 190.0, 50.0, 60.0, 40.0, 80.0, 30.0, 260.0, -20.0, -50.0, -10.0, 10.0, 60.0, 160.0, 40.0, 50.0, 190.0, 210.0, 60.0, 20.0, 110.0, 180.0, 130.0, 90.0, 140.0, 70.0, 40.0, 240.0, 90.0, 20.0, 60.0, 40.0, 20.0, 40.0, 100.0, 10.0, 80.0, 120.0, 100.0, 170.0, 70.0, 90.0, 220.0, 190.0, 70.0, 40.0, 120.0, 480.0, 50.0, 40.0, 130.0, 70.0, 500.0, 100.0, 10.0, 130.0, 210.0, 30.0, 100.0, 160.0, 0.0, 30.0, 10.0, 260.0, 50.0, 30.0, 30.0, 40.0, 40.0, 30.0, 960.0, 40.0, 90.0, 160.0, 60.0, 60.0, 40.0, 40.0, 20.0, 50.0, 30.0, 30.0, 180.0, 100.0, 0.0, 0.0, 20.0, 100.0, 80.0, 30.0, 20.0, 20.0, 50.0, 270.0, 10.0, 10.0, 190.0, 80.0, 90.0, 70.0, 80.0, -40.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 270.0, 70.0, 140.0, 40.0, -20.0, 210.0, 40.0, 380.0, 30.0, 20.0, 230.0, 80.0, 90.0, 480.0, 230.0, 10.0, 180.0, 50.0, 30.0, 30.0, 220.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 30.0, 0.0, 340.0, 90.0, 140.0, 80.0, 290.0, 180.0, 200.0, -20.0, 10.0, 60.0, 50.0, 210.0, 100.0, 30.0, 0.0, 0.0, 160.0, 60.0, 190.0, 20.0, 195.0, 250.0, 90.0, 50.0, 110.0, 140.0, 240.0, 50.0, 70.0, 150.0, 120.0, 310.0, 60.0, 210.0, 140.0, 110.0, 200.0, 30.0, 120.0, 110.0, 30.0, 50.0, 90.0, 130.0, 680.0, 80.0, 190.0, 70.0, 120.0, 120.0, 10.0, 20.0, 90.0, 0.0, 190.0, 20.0, 30.0, 380.0, 70.0, 0.0, 170.0, 0.0, 100.0, 110.0, 20.0, 70.0, 280.0, 90.0, 60.0, 40.0, 110.0, 420.0, 120.0, 40.0, 60.0, 60.0, 0.0, 80.0, 170.0, -10.0, 0.0, 0.0, 170.0, 70.0, 60.0, 40.0, 290.0, 20.0, 40.0, 10.0, 30.0, 300.0, 10.0, 0.0, 30.0, 30.0, 130.0, 400.0, 10.0, 0.0, 380.0, 10.0, 40.0, 60.0, 40.0, 20.0, 240.0, 130.0, 190.0, 40.0, 0.0, 110.0, 170.0, 10.0, 50.0, 40.0, 60.0, 320.0, 170.0, 40.0, 20.0, 370.0, 90.0, 240.0, 70.0, 75.0, 60.0, 40.0, 170.0, 60.0, 190.0, 20.0, 190.0, 150.0, 90.0, 290.0, 70.0, 65.0, 20.0, 90.0, 40.0, 25.0, 25.0, 300.0, 40.0, 80.0, 110.0, 80.0, 10.0, 120.0, 20.0, 10.0, 20.0, 10.0, 20.0, 190.0, 0.0, 40.0, 40.0, 30.0, 340.0, 110.0, 160.0, 10.0, 140.0, 30.0, 60.0, 160.0, 40.0, 290.0, 0.0, 10.0, 80.0, 80.0, 160.0, 20.0, 200.0, 10.0, 180.0, 20.0, 170.0, 310.0, 70.0, 100.0, 25.0, 190.0, 150.0, 160.0, 90.0, 70.0, 100.0, 160.0, 70.0, 240.0, 80.0, 190.0, 60.0, 340.0, -40.0, 80.0, 110.0, 120.0, 110.0, 100.0, 110.0, 210.0, 150.0, 100.0, 150.0, 160.0, 20.0, 260.0, 20.0, 50.0, 30.0, 30.0, 50.0, 270.0, 0.0, 190.0, 170.0, 340.0, 60.0, 80.0, 180.0, 120.0, 30.0, 40.0, 150.0, 90.0, 200.0, 380.0, 140.0, 60.0, 100.0, 60.0, 90.0, 20.0, 190.0, 110.0, 40.0, 40.0, 40.0, 240.0, 150.0, 50.0, 50.0, 100.0, 90.0, 140.0, 100.0, 270.0, 50.0, -10.0, 160.0, 20.0, 90.0, 160.0, 280.0, 50.0, 190.0, 30.0, 80.0, 0.0, 90.0, 80.0, 90.0, 150.0, 150.0, 50.0, -30.0, 110.0, 40.0, -15.0, 90.0, 410.0, 100.0, 430.0, 170.0, 130.0, 300.0, 130.0, 80.0, 80.0, 100.0, 60.0, 80.0, 80.0, 350.0, 40.0, 80.0, 60.0, 70.0, 10.0, 330.0, 170.0, 90.0, 200.0, 0.0, 200.0, 150.0, 60.0, 160.0, 20.0, 90.0, 40.0, 360.0, 220.0, 210.0, 110.0, 100.0, 340.0, 90.0, 130.0, 0.0, 140.0, 20.0, 160.0, 170.0, 160.0, 80.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 30.0, 10.0, 160.0, 120.0, 80.0, 220.0, 20.0, 50.0, 50.0, 0.0, 290.0, 90.0, 280.0, 150.0, -10.0, 30.0, 70.0, 100.0, 0.0, 150.0, 20.0, 340.0, 370.0, 110.0, 200.0, 30.0, 100.0, 40.0, 70.0, 230.0, 100.0, 100.0, 40.0, 110.0, 30.0, 60.0, 290.0, 360.0, 200.0, 150.0, 60.0, 10.0, 80.0, 280.0, 60.0, 0.0, 40.0, 110.0, 60.0, 130.0, 10.0, 10.0, 180.0, 50.0, 350.0, 300.0, 60.0, 20.0, 0.0, 380.0, 30.0, 90.0, 180.0, 380.0, 320.0, 100.0, 260.0, 20.0, -45.0, 30.0, 160.0, 190.0, 10.0, 30.0, 160.0, 40.0, 90.0, 190.0, 10.0, 10.0, 160.0, 260.0, 180.0, 40.0, 30.0, 190.0, 100.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 210.0, 80.0, 80.0, 60.0, 200.0, 370.0, 120.0, 30.0, 150.0, 10.0, 220.0, 150.0, 210.0, 270.0, 190.0, 90.0, 140.0, 30.0, 100.0, 60.0, 100.0, 0.0, 50.0, 170.0, 270.0, 0.0, 50.0, 50.0, 10.0, 160.0, 0.0, 210.0, 180.0, 120.0, 30.0, 10.0, 10.0, 0.0, 140.0, 10.0, 80.0, 370.0, 50.0, 100.0, 160.0, 100.0, 30.0, 100.0, 30.0, 100.0, 320.0, 190.0, 20.0, 300.0, 170.0, 20.0, 60.0, 70.0, 50.0, 580.0, 110.0, 450.0, 50.0, 90.0, 130.0, 120.0, 40.0, 200.0, 240.0, 30.0, 60.0, 20.0, 180.0, 80.0, 100.0, 20.0, 10.0, 20.0, 280.0, 170.0, 190.0, 60.0, 220.0, 50.0, 230.0, 20.0, 120.0, 40.0, 50.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6804884464715866, "mean_inference_ms": 1.491712495239353, "mean_action_processing_ms": 0.4299561306196366, "mean_env_wait_ms": 1.349517997370911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01302480697631836, "StateBufferConnector_ms": 0.009481191635131836, "ViewRequirementAgentConnector_ms": 0.38205838203430176}, "num_episodes": 23, "episode_return_max": 1780.0, "episode_return_min": 90.0, "episode_return_mean": 1064.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.3058909604544, "num_env_steps_trained_throughput_per_sec": 19.3058909604544, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 3080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3080000, "timers": {"training_iteration_time_ms": 208596.862, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208596.816, "sample_time_ms": 2713.56, "learn_time_ms": 205863.173, "learn_throughput": 19.43, "synch_weights_time_ms": 11.275}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "done": false, "training_iteration": 77, "trial_id": "aa996_00000", "date": "2024-05-24_03-13-00", "timestamp": 1716534780, "time_this_iter_s": 207.20125198364258, "time_total_s": 16047.578657388687, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d9f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16047.578657388687, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 19.206484641638227, "ram_util_percent": 78.27098976109215}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9377455622814717, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.875710303130876, "policy_loss": -0.006762145251840059, "vf_loss": 6.881279929631307, "vf_explained_var": 0.00014953141649183248, "kl": 0.005962571851312867, "entropy": 0.35370010363535126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 727725.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 1780.0, "episode_reward_min": 90.0, "episode_reward_mean": 1035.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 960.0}, "policy_reward_mean": {"policy_0": 103.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1420.0, 850.0, 840.0, 1590.0, 1070.0, 1120.0, 90.0, 310.0, 1580.0, 1330.0, 730.0, 660.0, 1060.0, 1590.0, 1200.0, 820.0, 1340.0, 770.0, 720.0, 1110.0, 590.0, 1500.0, 1320.0, 650.0, 1500.0, 590.0, 770.0, 430.0, 1140.0, 1400.0, 100.0, 1370.0, 820.0, 1345.0, 1410.0, 1560.0, 810.0, 940.0, 1050.0, 700.0, 940.0, 1150.0, 970.0, 1195.0, 1175.0, 830.0, 380.0, 1340.0, 760.0, 1335.0, 1280.0, 1320.0, 920.0, 1260.0, 1350.0, 940.0, 1170.0, 910.0, 1435.0, 1300.0, 1210.0, 1420.0, 1310.0, 470.0, 1200.0, 1220.0, 1020.0, 1350.0, 880.0, 1460.0, 1425.0, 1130.0, 680.0, 1310.0, 1460.0, 860.0, 710.0, 1120.0, 1780.0, 1460.0, 940.0, 1020.0, 330.0, 795.0, 500.0, 765.0, 430.0, 510.0, 1235.0, 930.0, 1130.0, 1070.0, 890.0, 1145.0, 860.0, 935.0, 1350.0, 950.0, 1005.0, 1090.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 90.0, 90.0, 400.0, 90.0, 80.0, 170.0, 50.0, 260.0, 20.0, 80.0, 20.0, 30.0, 10.0, 120.0, 40.0, 150.0, 20.0, 40.0, 340.0, 120.0, 110.0, 60.0, 170.0, 50.0, 80.0, 10.0, 80.0, 80.0, 80.0, 170.0, 80.0, 270.0, 410.0, 90.0, 60.0, 30.0, 100.0, 120.0, 260.0, 40.0, 180.0, 80.0, 20.0, 120.0, 120.0, 40.0, 120.0, 300.0, 50.0, 100.0, 180.0, 60.0, 100.0, 90.0, 180.0, 40.0, 40.0, 120.0, 210.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, -10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 10.0, 180.0, 110.0, 300.0, 100.0, 150.0, 260.0, 380.0, 40.0, 0.0, 130.0, 110.0, 80.0, 40.0, 90.0, 180.0, 30.0, 10.0, -40.0, 140.0, 680.0, 120.0, 130.0, 100.0, 0.0, 0.0, 280.0, 90.0, 20.0, 40.0, 20.0, 50.0, 70.0, 130.0, 120.0, 110.0, -10.0, 130.0, 40.0, 80.0, 10.0, -20.0, 100.0, 0.0, 250.0, 20.0, 120.0, 50.0, 80.0, 50.0, 360.0, 30.0, 140.0, 80.0, 740.0, 200.0, -10.0, -50.0, 210.0, 60.0, 60.0, 160.0, 30.0, 10.0, 180.0, 200.0, 330.0, 10.0, 140.0, 40.0, 70.0, 190.0, 70.0, 60.0, 270.0, 30.0, 10.0, 230.0, 60.0, 20.0, -20.0, 90.0, 120.0, 360.0, 170.0, 110.0, 340.0, 90.0, 20.0, 60.0, 40.0, 30.0, 10.0, 70.0, 190.0, 50.0, 60.0, 40.0, 80.0, 30.0, 260.0, -20.0, -50.0, -10.0, 10.0, 60.0, 160.0, 40.0, 50.0, 190.0, 210.0, 60.0, 20.0, 110.0, 180.0, 130.0, 90.0, 140.0, 70.0, 40.0, 240.0, 90.0, 20.0, 60.0, 40.0, 20.0, 40.0, 100.0, 10.0, 80.0, 120.0, 100.0, 170.0, 70.0, 90.0, 220.0, 190.0, 70.0, 40.0, 120.0, 480.0, 50.0, 40.0, 130.0, 70.0, 500.0, 100.0, 10.0, 130.0, 210.0, 30.0, 100.0, 160.0, 0.0, 30.0, 10.0, 260.0, 50.0, 30.0, 30.0, 40.0, 40.0, 30.0, 960.0, 40.0, 90.0, 160.0, 60.0, 60.0, 40.0, 40.0, 20.0, 50.0, 30.0, 30.0, 180.0, 100.0, 0.0, 0.0, 20.0, 100.0, 80.0, 30.0, 20.0, 20.0, 50.0, 270.0, 10.0, 10.0, 190.0, 80.0, 90.0, 70.0, 80.0, -40.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 270.0, 70.0, 140.0, 40.0, -20.0, 210.0, 40.0, 380.0, 30.0, 20.0, 230.0, 80.0, 90.0, 480.0, 230.0, 10.0, 180.0, 50.0, 30.0, 30.0, 220.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 30.0, 0.0, 340.0, 90.0, 140.0, 80.0, 290.0, 180.0, 200.0, -20.0, 10.0, 60.0, 50.0, 210.0, 100.0, 30.0, 0.0, 0.0, 160.0, 60.0, 190.0, 20.0, 195.0, 250.0, 90.0, 50.0, 110.0, 140.0, 240.0, 50.0, 70.0, 150.0, 120.0, 310.0, 60.0, 210.0, 140.0, 110.0, 200.0, 30.0, 120.0, 110.0, 30.0, 50.0, 90.0, 130.0, 680.0, 80.0, 190.0, 70.0, 120.0, 120.0, 10.0, 20.0, 90.0, 0.0, 190.0, 20.0, 30.0, 380.0, 70.0, 0.0, 170.0, 0.0, 100.0, 110.0, 20.0, 70.0, 280.0, 90.0, 60.0, 40.0, 110.0, 420.0, 120.0, 40.0, 60.0, 60.0, 0.0, 80.0, 170.0, -10.0, 0.0, 0.0, 170.0, 70.0, 60.0, 40.0, 290.0, 20.0, 40.0, 10.0, 30.0, 300.0, 10.0, 0.0, 30.0, 30.0, 130.0, 400.0, 10.0, 0.0, 380.0, 10.0, 40.0, 60.0, 40.0, 20.0, 240.0, 130.0, 190.0, 40.0, 0.0, 110.0, 170.0, 10.0, 50.0, 40.0, 60.0, 320.0, 170.0, 40.0, 20.0, 370.0, 90.0, 240.0, 70.0, 75.0, 60.0, 40.0, 170.0, 60.0, 190.0, 20.0, 190.0, 150.0, 90.0, 290.0, 70.0, 65.0, 20.0, 90.0, 40.0, 25.0, 25.0, 300.0, 40.0, 80.0, 110.0, 80.0, 10.0, 120.0, 20.0, 10.0, 20.0, 10.0, 20.0, 190.0, 0.0, 40.0, 40.0, 30.0, 340.0, 110.0, 160.0, 10.0, 140.0, 30.0, 60.0, 160.0, 40.0, 290.0, 0.0, 10.0, 80.0, 80.0, 160.0, 20.0, 200.0, 10.0, 180.0, 20.0, 170.0, 310.0, 70.0, 100.0, 25.0, 190.0, 150.0, 160.0, 90.0, 70.0, 100.0, 160.0, 70.0, 240.0, 80.0, 190.0, 60.0, 340.0, -40.0, 80.0, 110.0, 120.0, 110.0, 100.0, 110.0, 210.0, 150.0, 100.0, 150.0, 160.0, 20.0, 260.0, 20.0, 50.0, 30.0, 30.0, 50.0, 270.0, 0.0, 190.0, 170.0, 340.0, 60.0, 80.0, 180.0, 120.0, 30.0, 40.0, 150.0, 90.0, 200.0, 380.0, 140.0, 60.0, 100.0, 60.0, 90.0, 20.0, 190.0, 110.0, 40.0, 40.0, 40.0, 240.0, 150.0, 50.0, 50.0, 100.0, 90.0, 140.0, 100.0, 270.0, 50.0, -10.0, 160.0, 20.0, 90.0, 160.0, 280.0, 50.0, 190.0, 30.0, 80.0, 0.0, 90.0, 80.0, 90.0, 150.0, 150.0, 50.0, -30.0, 110.0, 40.0, -15.0, 90.0, 410.0, 100.0, 430.0, 170.0, 130.0, 300.0, 130.0, 80.0, 80.0, 100.0, 60.0, 80.0, 80.0, 350.0, 40.0, 80.0, 60.0, 70.0, 10.0, 330.0, 170.0, 90.0, 200.0, 0.0, 200.0, 150.0, 60.0, 160.0, 20.0, 90.0, 40.0, 360.0, 220.0, 210.0, 110.0, 100.0, 340.0, 90.0, 130.0, 0.0, 140.0, 20.0, 160.0, 170.0, 160.0, 80.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 30.0, 10.0, 160.0, 120.0, 80.0, 220.0, 20.0, 50.0, 50.0, 0.0, 290.0, 90.0, 280.0, 150.0, -10.0, 30.0, 70.0, 100.0, 0.0, 150.0, 20.0, 340.0, 370.0, 110.0, 200.0, 30.0, 100.0, 40.0, 70.0, 230.0, 100.0, 100.0, 40.0, 110.0, 30.0, 60.0, 290.0, 360.0, 200.0, 150.0, 60.0, 10.0, 80.0, 280.0, 60.0, 0.0, 40.0, 110.0, 60.0, 130.0, 10.0, 10.0, 180.0, 50.0, 350.0, 300.0, 60.0, 20.0, 0.0, 380.0, 30.0, 90.0, 180.0, 380.0, 320.0, 100.0, 260.0, 20.0, -45.0, 30.0, 160.0, 190.0, 10.0, 30.0, 160.0, 40.0, 90.0, 190.0, 10.0, 10.0, 160.0, 260.0, 180.0, 40.0, 30.0, 190.0, 100.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 210.0, 80.0, 80.0, 60.0, 200.0, 370.0, 120.0, 30.0, 150.0, 10.0, 220.0, 150.0, 210.0, 270.0, 190.0, 90.0, 140.0, 30.0, 100.0, 60.0, 100.0, 0.0, 50.0, 170.0, 270.0, 0.0, 50.0, 50.0, 10.0, 160.0, 0.0, 210.0, 180.0, 120.0, 30.0, 10.0, 10.0, 0.0, 140.0, 10.0, 80.0, 370.0, 50.0, 100.0, 160.0, 100.0, 30.0, 100.0, 30.0, 100.0, 320.0, 190.0, 20.0, 300.0, 170.0, 20.0, 60.0, 70.0, 50.0, 580.0, 110.0, 450.0, 50.0, 90.0, 130.0, 120.0, 40.0, 200.0, 240.0, 30.0, 60.0, 20.0, 180.0, 80.0, 100.0, 20.0, 10.0, 20.0, 280.0, 170.0, 190.0, 60.0, 220.0, 50.0, 230.0, 20.0, 120.0, 40.0, 50.0, 40.0, 10.0, -80.0, 160.0, 0.0, 10.0, -100.0, 70.0, 40.0, 30.0, 190.0, 190.0, 20.0, 40.0, 120.0, -10.0, 80.0, 200.0, 60.0, 25.0, 70.0, 130.0, 30.0, 10.0, 100.0, 70.0, 80.0, 20.0, 20.0, 30.0, 10.0, 30.0, 100.0, 30.0, 20.0, -5.0, 70.0, 60.0, 70.0, 230.0, 160.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 150.0, 30.0, 160.0, 0.0, 160.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, 20.0, 70.0, 60.0, 30.0, 350.0, 20.0, 130.0, 75.0, 240.0, 180.0, 80.0, 100.0, 80.0, 10.0, 20.0, 150.0, 40.0, 70.0, 120.0, 150.0, 190.0, 30.0, 50.0, 60.0, 300.0, 20.0, 30.0, 80.0, 60.0, 190.0, 310.0, 110.0, 130.0, 120.0, 170.0, 40.0, 40.0, 130.0, 0.0, 170.0, 160.0, 40.0, -40.0, 0.0, 380.0, 130.0, 20.0, -20.0, 270.0, 90.0, 20.0, 70.0, 700.0, 90.0, 20.0, 0.0, 70.0, 50.0, 5.0, 10.0, 130.0, 20.0, -260.0, 490.0, 40.0, 90.0, 110.0, 120.0, 60.0, 20.0, 170.0, 120.0, 210.0, 20.0, 20.0, 20.0, 40.0, 280.0, 35.0, 150.0, 40.0, 30.0, 100.0, 50.0, 160.0, 50.0, 40.0, 50.0, 110.0, 290.0, 470.0, -30.0, 90.0, 300.0, 30.0, 200.0, 140.0, 90.0, 20.0, 210.0, -100.0, 350.0, 30.0, 210.0, 70.0, 80.0, 130.0, 60.0, -10.0, 80.0, 5.0, 100.0, 120.0, 100.0, 210.0, 110.0, 10.0, 20.0, 130.0, 180.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6795738220180914, "mean_inference_ms": 1.4915178272198388, "mean_action_processing_ms": 0.4296852628688282, "mean_env_wait_ms": 1.3491031669198472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013409137725830078, "StateBufferConnector_ms": 0.009512662887573242, "ViewRequirementAgentConnector_ms": 0.39114999771118164}, "num_episodes": 18, "episode_return_max": 1780.0, "episode_return_min": 90.0, "episode_return_mean": 1035.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.233934330612772, "num_env_steps_trained_throughput_per_sec": 19.233934330612772, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 208547.68, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208547.634, "sample_time_ms": 2704.273, "learn_time_ms": 205823.305, "learn_throughput": 19.434, "synch_weights_time_ms": 10.946}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 78, "trial_id": "aa996_00000", "date": "2024-05-24_03-16-28", "timestamp": 1716534988, "time_this_iter_s": 207.97818636894226, "time_total_s": 16255.55684375763, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332db7310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16255.55684375763, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 19.213945578231293, "ram_util_percent": 78.328231292517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5463264183685803, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.88177717866989, "policy_loss": -0.006538396350681361, "vf_loss": 6.887166660662277, "vf_explained_var": -8.223978475259897e-05, "kl": 0.005744579118828795, "entropy": 0.32786784380103073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 737115.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "env_runners": {"episode_reward_max": 1780.0, "episode_reward_min": 100.0, "episode_reward_mean": 1035.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 960.0}, "policy_reward_mean": {"policy_0": 103.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [720.0, 1110.0, 590.0, 1500.0, 1320.0, 650.0, 1500.0, 590.0, 770.0, 430.0, 1140.0, 1400.0, 100.0, 1370.0, 820.0, 1345.0, 1410.0, 1560.0, 810.0, 940.0, 1050.0, 700.0, 940.0, 1150.0, 970.0, 1195.0, 1175.0, 830.0, 380.0, 1340.0, 760.0, 1335.0, 1280.0, 1320.0, 920.0, 1260.0, 1350.0, 940.0, 1170.0, 910.0, 1435.0, 1300.0, 1210.0, 1420.0, 1310.0, 470.0, 1200.0, 1220.0, 1020.0, 1350.0, 880.0, 1460.0, 1425.0, 1130.0, 680.0, 1310.0, 1460.0, 860.0, 710.0, 1120.0, 1780.0, 1460.0, 940.0, 1020.0, 330.0, 795.0, 500.0, 765.0, 430.0, 510.0, 1235.0, 930.0, 1130.0, 1070.0, 890.0, 1145.0, 860.0, 935.0, 1350.0, 950.0, 1005.0, 1090.0, 1700.0, 1290.0, 680.0, 690.0, 1250.0, 340.0, 780.0, 1470.0, 1290.0, 1540.0, 1700.0, 250.0, 490.0, 730.0, 305.0, 1390.0, 1060.0, 1485.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-50.0, -10.0, 10.0, 60.0, 160.0, 40.0, 50.0, 190.0, 210.0, 60.0, 20.0, 110.0, 180.0, 130.0, 90.0, 140.0, 70.0, 40.0, 240.0, 90.0, 20.0, 60.0, 40.0, 20.0, 40.0, 100.0, 10.0, 80.0, 120.0, 100.0, 170.0, 70.0, 90.0, 220.0, 190.0, 70.0, 40.0, 120.0, 480.0, 50.0, 40.0, 130.0, 70.0, 500.0, 100.0, 10.0, 130.0, 210.0, 30.0, 100.0, 160.0, 0.0, 30.0, 10.0, 260.0, 50.0, 30.0, 30.0, 40.0, 40.0, 30.0, 960.0, 40.0, 90.0, 160.0, 60.0, 60.0, 40.0, 40.0, 20.0, 50.0, 30.0, 30.0, 180.0, 100.0, 0.0, 0.0, 20.0, 100.0, 80.0, 30.0, 20.0, 20.0, 50.0, 270.0, 10.0, 10.0, 190.0, 80.0, 90.0, 70.0, 80.0, -40.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 270.0, 70.0, 140.0, 40.0, -20.0, 210.0, 40.0, 380.0, 30.0, 20.0, 230.0, 80.0, 90.0, 480.0, 230.0, 10.0, 180.0, 50.0, 30.0, 30.0, 220.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 30.0, 0.0, 340.0, 90.0, 140.0, 80.0, 290.0, 180.0, 200.0, -20.0, 10.0, 60.0, 50.0, 210.0, 100.0, 30.0, 0.0, 0.0, 160.0, 60.0, 190.0, 20.0, 195.0, 250.0, 90.0, 50.0, 110.0, 140.0, 240.0, 50.0, 70.0, 150.0, 120.0, 310.0, 60.0, 210.0, 140.0, 110.0, 200.0, 30.0, 120.0, 110.0, 30.0, 50.0, 90.0, 130.0, 680.0, 80.0, 190.0, 70.0, 120.0, 120.0, 10.0, 20.0, 90.0, 0.0, 190.0, 20.0, 30.0, 380.0, 70.0, 0.0, 170.0, 0.0, 100.0, 110.0, 20.0, 70.0, 280.0, 90.0, 60.0, 40.0, 110.0, 420.0, 120.0, 40.0, 60.0, 60.0, 0.0, 80.0, 170.0, -10.0, 0.0, 0.0, 170.0, 70.0, 60.0, 40.0, 290.0, 20.0, 40.0, 10.0, 30.0, 300.0, 10.0, 0.0, 30.0, 30.0, 130.0, 400.0, 10.0, 0.0, 380.0, 10.0, 40.0, 60.0, 40.0, 20.0, 240.0, 130.0, 190.0, 40.0, 0.0, 110.0, 170.0, 10.0, 50.0, 40.0, 60.0, 320.0, 170.0, 40.0, 20.0, 370.0, 90.0, 240.0, 70.0, 75.0, 60.0, 40.0, 170.0, 60.0, 190.0, 20.0, 190.0, 150.0, 90.0, 290.0, 70.0, 65.0, 20.0, 90.0, 40.0, 25.0, 25.0, 300.0, 40.0, 80.0, 110.0, 80.0, 10.0, 120.0, 20.0, 10.0, 20.0, 10.0, 20.0, 190.0, 0.0, 40.0, 40.0, 30.0, 340.0, 110.0, 160.0, 10.0, 140.0, 30.0, 60.0, 160.0, 40.0, 290.0, 0.0, 10.0, 80.0, 80.0, 160.0, 20.0, 200.0, 10.0, 180.0, 20.0, 170.0, 310.0, 70.0, 100.0, 25.0, 190.0, 150.0, 160.0, 90.0, 70.0, 100.0, 160.0, 70.0, 240.0, 80.0, 190.0, 60.0, 340.0, -40.0, 80.0, 110.0, 120.0, 110.0, 100.0, 110.0, 210.0, 150.0, 100.0, 150.0, 160.0, 20.0, 260.0, 20.0, 50.0, 30.0, 30.0, 50.0, 270.0, 0.0, 190.0, 170.0, 340.0, 60.0, 80.0, 180.0, 120.0, 30.0, 40.0, 150.0, 90.0, 200.0, 380.0, 140.0, 60.0, 100.0, 60.0, 90.0, 20.0, 190.0, 110.0, 40.0, 40.0, 40.0, 240.0, 150.0, 50.0, 50.0, 100.0, 90.0, 140.0, 100.0, 270.0, 50.0, -10.0, 160.0, 20.0, 90.0, 160.0, 280.0, 50.0, 190.0, 30.0, 80.0, 0.0, 90.0, 80.0, 90.0, 150.0, 150.0, 50.0, -30.0, 110.0, 40.0, -15.0, 90.0, 410.0, 100.0, 430.0, 170.0, 130.0, 300.0, 130.0, 80.0, 80.0, 100.0, 60.0, 80.0, 80.0, 350.0, 40.0, 80.0, 60.0, 70.0, 10.0, 330.0, 170.0, 90.0, 200.0, 0.0, 200.0, 150.0, 60.0, 160.0, 20.0, 90.0, 40.0, 360.0, 220.0, 210.0, 110.0, 100.0, 340.0, 90.0, 130.0, 0.0, 140.0, 20.0, 160.0, 170.0, 160.0, 80.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 30.0, 10.0, 160.0, 120.0, 80.0, 220.0, 20.0, 50.0, 50.0, 0.0, 290.0, 90.0, 280.0, 150.0, -10.0, 30.0, 70.0, 100.0, 0.0, 150.0, 20.0, 340.0, 370.0, 110.0, 200.0, 30.0, 100.0, 40.0, 70.0, 230.0, 100.0, 100.0, 40.0, 110.0, 30.0, 60.0, 290.0, 360.0, 200.0, 150.0, 60.0, 10.0, 80.0, 280.0, 60.0, 0.0, 40.0, 110.0, 60.0, 130.0, 10.0, 10.0, 180.0, 50.0, 350.0, 300.0, 60.0, 20.0, 0.0, 380.0, 30.0, 90.0, 180.0, 380.0, 320.0, 100.0, 260.0, 20.0, -45.0, 30.0, 160.0, 190.0, 10.0, 30.0, 160.0, 40.0, 90.0, 190.0, 10.0, 10.0, 160.0, 260.0, 180.0, 40.0, 30.0, 190.0, 100.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 210.0, 80.0, 80.0, 60.0, 200.0, 370.0, 120.0, 30.0, 150.0, 10.0, 220.0, 150.0, 210.0, 270.0, 190.0, 90.0, 140.0, 30.0, 100.0, 60.0, 100.0, 0.0, 50.0, 170.0, 270.0, 0.0, 50.0, 50.0, 10.0, 160.0, 0.0, 210.0, 180.0, 120.0, 30.0, 10.0, 10.0, 0.0, 140.0, 10.0, 80.0, 370.0, 50.0, 100.0, 160.0, 100.0, 30.0, 100.0, 30.0, 100.0, 320.0, 190.0, 20.0, 300.0, 170.0, 20.0, 60.0, 70.0, 50.0, 580.0, 110.0, 450.0, 50.0, 90.0, 130.0, 120.0, 40.0, 200.0, 240.0, 30.0, 60.0, 20.0, 180.0, 80.0, 100.0, 20.0, 10.0, 20.0, 280.0, 170.0, 190.0, 60.0, 220.0, 50.0, 230.0, 20.0, 120.0, 40.0, 50.0, 40.0, 10.0, -80.0, 160.0, 0.0, 10.0, -100.0, 70.0, 40.0, 30.0, 190.0, 190.0, 20.0, 40.0, 120.0, -10.0, 80.0, 200.0, 60.0, 25.0, 70.0, 130.0, 30.0, 10.0, 100.0, 70.0, 80.0, 20.0, 20.0, 30.0, 10.0, 30.0, 100.0, 30.0, 20.0, -5.0, 70.0, 60.0, 70.0, 230.0, 160.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 150.0, 30.0, 160.0, 0.0, 160.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, 20.0, 70.0, 60.0, 30.0, 350.0, 20.0, 130.0, 75.0, 240.0, 180.0, 80.0, 100.0, 80.0, 10.0, 20.0, 150.0, 40.0, 70.0, 120.0, 150.0, 190.0, 30.0, 50.0, 60.0, 300.0, 20.0, 30.0, 80.0, 60.0, 190.0, 310.0, 110.0, 130.0, 120.0, 170.0, 40.0, 40.0, 130.0, 0.0, 170.0, 160.0, 40.0, -40.0, 0.0, 380.0, 130.0, 20.0, -20.0, 270.0, 90.0, 20.0, 70.0, 700.0, 90.0, 20.0, 0.0, 70.0, 50.0, 5.0, 10.0, 130.0, 20.0, -260.0, 490.0, 40.0, 90.0, 110.0, 120.0, 60.0, 20.0, 170.0, 120.0, 210.0, 20.0, 20.0, 20.0, 40.0, 280.0, 35.0, 150.0, 40.0, 30.0, 100.0, 50.0, 160.0, 50.0, 40.0, 50.0, 110.0, 290.0, 470.0, -30.0, 90.0, 300.0, 30.0, 200.0, 140.0, 90.0, 20.0, 210.0, -100.0, 350.0, 30.0, 210.0, 70.0, 80.0, 130.0, 60.0, -10.0, 80.0, 5.0, 100.0, 120.0, 100.0, 210.0, 110.0, 10.0, 20.0, 130.0, 180.0, 110.0, 230.0, 70.0, 80.0, 0.0, 110.0, 50.0, 450.0, 140.0, 540.0, 30.0, 60.0, 120.0, 100.0, 230.0, 60.0, 210.0, 100.0, 240.0, 100.0, 70.0, 10.0, 210.0, 190.0, 40.0, 0.0, 90.0, 60.0, 0.0, 80.0, 0.0, 0.0, 280.0, 210.0, 60.0, 20.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 40.0, 70.0, 30.0, 50.0, 360.0, 0.0, 10.0, 200.0, 490.0, 70.0, 180.0, 80.0, 120.0, -50.0, -210.0, 50.0, -50.0, -20.0, 170.0, 270.0, 40.0, 200.0, 120.0, 10.0, 30.0, 0.0, 70.0, 30.0, 10.0, 650.0, 180.0, 20.0, 70.0, -50.0, 20.0, 80.0, 90.0, 330.0, 80.0, 140.0, 20.0, 210.0, 290.0, 130.0, 340.0, 50.0, 20.0, 10.0, 80.0, 80.0, 180.0, 100.0, 30.0, 80.0, 510.0, 80.0, 210.0, 60.0, 210.0, 170.0, -50.0, 210.0, 210.0, 130.0, 640.0, 80.0, 50.0, 210.0, 50.0, 20.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 140.0, 0.0, 40.0, 90.0, 40.0, 100.0, 0.0, 100.0, 0.0, 50.0, 80.0, 0.0, 20.0, 180.0, 20.0, 260.0, 20.0, 0.0, 10.0, 25.0, 110.0, 70.0, 20.0, 10.0, 20.0, 20.0, 20.0, 210.0, 40.0, 90.0, 70.0, 100.0, 100.0, 410.0, 90.0, 120.0, 160.0, 30.0, 220.0, 30.0, 90.0, 50.0, 180.0, 50.0, 260.0, 60.0, 90.0, 40.0, 600.0, 380.0, 40.0, 30.0, 100.0, -50.0, 300.0, 15.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6786797529592599, "mean_inference_ms": 1.4910242337203967, "mean_action_processing_ms": 0.4293436525059661, "mean_env_wait_ms": 1.3485604684047034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013895511627197266, "StateBufferConnector_ms": 0.010102510452270508, "ViewRequirementAgentConnector_ms": 0.39185357093811035}, "num_episodes": 18, "episode_return_max": 1780.0, "episode_return_min": 100.0, "episode_return_mean": 1035.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.945444375632913, "num_env_steps_trained_throughput_per_sec": 18.945444375632913, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 3160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3160000, "timers": {"training_iteration_time_ms": 208802.923, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208802.877, "sample_time_ms": 2705.025, "learn_time_ms": 206077.908, "learn_throughput": 19.41, "synch_weights_time_ms": 10.862}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "done": false, "training_iteration": 79, "trial_id": "aa996_00000", "date": "2024-05-24_03-20-00", "timestamp": 1716535200, "time_this_iter_s": 211.14256405830383, "time_total_s": 16466.699407815933, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d9fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16466.699407815933, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 24.13311036789298, "ram_util_percent": 79.9438127090301}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.52147078969862, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.922952654059576, "policy_loss": -0.006683069291991738, "vf_loss": 6.928500042276514, "vf_explained_var": 0.0009694489300314484, "kl": 0.00567842831242764, "entropy": 0.3366169315351211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 746505.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 1780.0, "episode_reward_min": 250.0, "episode_reward_mean": 1036.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 103.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 1150.0, 970.0, 1195.0, 1175.0, 830.0, 380.0, 1340.0, 760.0, 1335.0, 1280.0, 1320.0, 920.0, 1260.0, 1350.0, 940.0, 1170.0, 910.0, 1435.0, 1300.0, 1210.0, 1420.0, 1310.0, 470.0, 1200.0, 1220.0, 1020.0, 1350.0, 880.0, 1460.0, 1425.0, 1130.0, 680.0, 1310.0, 1460.0, 860.0, 710.0, 1120.0, 1780.0, 1460.0, 940.0, 1020.0, 330.0, 795.0, 500.0, 765.0, 430.0, 510.0, 1235.0, 930.0, 1130.0, 1070.0, 890.0, 1145.0, 860.0, 935.0, 1350.0, 950.0, 1005.0, 1090.0, 1700.0, 1290.0, 680.0, 690.0, 1250.0, 340.0, 780.0, 1470.0, 1290.0, 1540.0, 1700.0, 250.0, 490.0, 730.0, 305.0, 1390.0, 1060.0, 1485.0, 380.0, 1350.0, 1170.0, 370.0, 500.0, 1040.0, 1720.0, 390.0, 1030.0, 795.0, 630.0, 1180.0, 1235.0, 700.0, 900.0, 1110.0, 1100.0, 910.0, 1740.0, 1440.0, 690.0, 1550.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 300.0, 10.0, 0.0, 30.0, 30.0, 130.0, 400.0, 10.0, 0.0, 380.0, 10.0, 40.0, 60.0, 40.0, 20.0, 240.0, 130.0, 190.0, 40.0, 0.0, 110.0, 170.0, 10.0, 50.0, 40.0, 60.0, 320.0, 170.0, 40.0, 20.0, 370.0, 90.0, 240.0, 70.0, 75.0, 60.0, 40.0, 170.0, 60.0, 190.0, 20.0, 190.0, 150.0, 90.0, 290.0, 70.0, 65.0, 20.0, 90.0, 40.0, 25.0, 25.0, 300.0, 40.0, 80.0, 110.0, 80.0, 10.0, 120.0, 20.0, 10.0, 20.0, 10.0, 20.0, 190.0, 0.0, 40.0, 40.0, 30.0, 340.0, 110.0, 160.0, 10.0, 140.0, 30.0, 60.0, 160.0, 40.0, 290.0, 0.0, 10.0, 80.0, 80.0, 160.0, 20.0, 200.0, 10.0, 180.0, 20.0, 170.0, 310.0, 70.0, 100.0, 25.0, 190.0, 150.0, 160.0, 90.0, 70.0, 100.0, 160.0, 70.0, 240.0, 80.0, 190.0, 60.0, 340.0, -40.0, 80.0, 110.0, 120.0, 110.0, 100.0, 110.0, 210.0, 150.0, 100.0, 150.0, 160.0, 20.0, 260.0, 20.0, 50.0, 30.0, 30.0, 50.0, 270.0, 0.0, 190.0, 170.0, 340.0, 60.0, 80.0, 180.0, 120.0, 30.0, 40.0, 150.0, 90.0, 200.0, 380.0, 140.0, 60.0, 100.0, 60.0, 90.0, 20.0, 190.0, 110.0, 40.0, 40.0, 40.0, 240.0, 150.0, 50.0, 50.0, 100.0, 90.0, 140.0, 100.0, 270.0, 50.0, -10.0, 160.0, 20.0, 90.0, 160.0, 280.0, 50.0, 190.0, 30.0, 80.0, 0.0, 90.0, 80.0, 90.0, 150.0, 150.0, 50.0, -30.0, 110.0, 40.0, -15.0, 90.0, 410.0, 100.0, 430.0, 170.0, 130.0, 300.0, 130.0, 80.0, 80.0, 100.0, 60.0, 80.0, 80.0, 350.0, 40.0, 80.0, 60.0, 70.0, 10.0, 330.0, 170.0, 90.0, 200.0, 0.0, 200.0, 150.0, 60.0, 160.0, 20.0, 90.0, 40.0, 360.0, 220.0, 210.0, 110.0, 100.0, 340.0, 90.0, 130.0, 0.0, 140.0, 20.0, 160.0, 170.0, 160.0, 80.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 30.0, 10.0, 160.0, 120.0, 80.0, 220.0, 20.0, 50.0, 50.0, 0.0, 290.0, 90.0, 280.0, 150.0, -10.0, 30.0, 70.0, 100.0, 0.0, 150.0, 20.0, 340.0, 370.0, 110.0, 200.0, 30.0, 100.0, 40.0, 70.0, 230.0, 100.0, 100.0, 40.0, 110.0, 30.0, 60.0, 290.0, 360.0, 200.0, 150.0, 60.0, 10.0, 80.0, 280.0, 60.0, 0.0, 40.0, 110.0, 60.0, 130.0, 10.0, 10.0, 180.0, 50.0, 350.0, 300.0, 60.0, 20.0, 0.0, 380.0, 30.0, 90.0, 180.0, 380.0, 320.0, 100.0, 260.0, 20.0, -45.0, 30.0, 160.0, 190.0, 10.0, 30.0, 160.0, 40.0, 90.0, 190.0, 10.0, 10.0, 160.0, 260.0, 180.0, 40.0, 30.0, 190.0, 100.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 210.0, 80.0, 80.0, 60.0, 200.0, 370.0, 120.0, 30.0, 150.0, 10.0, 220.0, 150.0, 210.0, 270.0, 190.0, 90.0, 140.0, 30.0, 100.0, 60.0, 100.0, 0.0, 50.0, 170.0, 270.0, 0.0, 50.0, 50.0, 10.0, 160.0, 0.0, 210.0, 180.0, 120.0, 30.0, 10.0, 10.0, 0.0, 140.0, 10.0, 80.0, 370.0, 50.0, 100.0, 160.0, 100.0, 30.0, 100.0, 30.0, 100.0, 320.0, 190.0, 20.0, 300.0, 170.0, 20.0, 60.0, 70.0, 50.0, 580.0, 110.0, 450.0, 50.0, 90.0, 130.0, 120.0, 40.0, 200.0, 240.0, 30.0, 60.0, 20.0, 180.0, 80.0, 100.0, 20.0, 10.0, 20.0, 280.0, 170.0, 190.0, 60.0, 220.0, 50.0, 230.0, 20.0, 120.0, 40.0, 50.0, 40.0, 10.0, -80.0, 160.0, 0.0, 10.0, -100.0, 70.0, 40.0, 30.0, 190.0, 190.0, 20.0, 40.0, 120.0, -10.0, 80.0, 200.0, 60.0, 25.0, 70.0, 130.0, 30.0, 10.0, 100.0, 70.0, 80.0, 20.0, 20.0, 30.0, 10.0, 30.0, 100.0, 30.0, 20.0, -5.0, 70.0, 60.0, 70.0, 230.0, 160.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 150.0, 30.0, 160.0, 0.0, 160.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, 20.0, 70.0, 60.0, 30.0, 350.0, 20.0, 130.0, 75.0, 240.0, 180.0, 80.0, 100.0, 80.0, 10.0, 20.0, 150.0, 40.0, 70.0, 120.0, 150.0, 190.0, 30.0, 50.0, 60.0, 300.0, 20.0, 30.0, 80.0, 60.0, 190.0, 310.0, 110.0, 130.0, 120.0, 170.0, 40.0, 40.0, 130.0, 0.0, 170.0, 160.0, 40.0, -40.0, 0.0, 380.0, 130.0, 20.0, -20.0, 270.0, 90.0, 20.0, 70.0, 700.0, 90.0, 20.0, 0.0, 70.0, 50.0, 5.0, 10.0, 130.0, 20.0, -260.0, 490.0, 40.0, 90.0, 110.0, 120.0, 60.0, 20.0, 170.0, 120.0, 210.0, 20.0, 20.0, 20.0, 40.0, 280.0, 35.0, 150.0, 40.0, 30.0, 100.0, 50.0, 160.0, 50.0, 40.0, 50.0, 110.0, 290.0, 470.0, -30.0, 90.0, 300.0, 30.0, 200.0, 140.0, 90.0, 20.0, 210.0, -100.0, 350.0, 30.0, 210.0, 70.0, 80.0, 130.0, 60.0, -10.0, 80.0, 5.0, 100.0, 120.0, 100.0, 210.0, 110.0, 10.0, 20.0, 130.0, 180.0, 110.0, 230.0, 70.0, 80.0, 0.0, 110.0, 50.0, 450.0, 140.0, 540.0, 30.0, 60.0, 120.0, 100.0, 230.0, 60.0, 210.0, 100.0, 240.0, 100.0, 70.0, 10.0, 210.0, 190.0, 40.0, 0.0, 90.0, 60.0, 0.0, 80.0, 0.0, 0.0, 280.0, 210.0, 60.0, 20.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 40.0, 70.0, 30.0, 50.0, 360.0, 0.0, 10.0, 200.0, 490.0, 70.0, 180.0, 80.0, 120.0, -50.0, -210.0, 50.0, -50.0, -20.0, 170.0, 270.0, 40.0, 200.0, 120.0, 10.0, 30.0, 0.0, 70.0, 30.0, 10.0, 650.0, 180.0, 20.0, 70.0, -50.0, 20.0, 80.0, 90.0, 330.0, 80.0, 140.0, 20.0, 210.0, 290.0, 130.0, 340.0, 50.0, 20.0, 10.0, 80.0, 80.0, 180.0, 100.0, 30.0, 80.0, 510.0, 80.0, 210.0, 60.0, 210.0, 170.0, -50.0, 210.0, 210.0, 130.0, 640.0, 80.0, 50.0, 210.0, 50.0, 20.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 140.0, 0.0, 40.0, 90.0, 40.0, 100.0, 0.0, 100.0, 0.0, 50.0, 80.0, 0.0, 20.0, 180.0, 20.0, 260.0, 20.0, 0.0, 10.0, 25.0, 110.0, 70.0, 20.0, 10.0, 20.0, 20.0, 20.0, 210.0, 40.0, 90.0, 70.0, 100.0, 100.0, 410.0, 90.0, 120.0, 160.0, 30.0, 220.0, 30.0, 90.0, 50.0, 180.0, 50.0, 260.0, 60.0, 90.0, 40.0, 600.0, 380.0, 40.0, 30.0, 100.0, -50.0, 300.0, 15.0, 30.0, 0.0, 30.0, 40.0, 0.0, 110.0, 20.0, 30.0, 30.0, 100.0, 20.0, 130.0, 230.0, 180.0, 210.0, 120.0, 80.0, 120.0, 120.0, 70.0, 90.0, 40.0, 120.0, 10.0, 30.0, 0.0, 190.0, 610.0, 80.0, 50.0, 40.0, 130.0, 90.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 120.0, 10.0, 50.0, 10.0, 10.0, 140.0, 70.0, 180.0, 20.0, 370.0, 60.0, 50.0, 10.0, 10.0, 10.0, 260.0, 70.0, 500.0, 440.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 250.0, 90.0, 50.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 40.0, 160.0, 0.0, 140.0, 110.0, 50.0, -80.0, 40.0, 400.0, 120.0, 10.0, 160.0, 80.0, 10.0, 30.0, 90.0, 0.0, 110.0, 220.0, 190.0, 80.0, 25.0, 40.0, 50.0, 210.0, 0.0, 10.0, 20.0, 120.0, 0.0, 60.0, 50.0, 110.0, 0.0, 70.0, 270.0, 160.0, 90.0, 80.0, 70.0, 50.0, 160.0, 230.0, 90.0, 160.0, 20.0, 130.0, 10.0, 10.0, 25.0, 60.0, 220.0, 510.0, 70.0, 240.0, 150.0, 40.0, 100.0, 60.0, 30.0, 0.0, 0.0, 10.0, 170.0, 350.0, 20.0, 40.0, 10.0, 70.0, 20.0, 40.0, 20.0, 160.0, 60.0, -10.0, 200.0, 60.0, 310.0, 30.0, 70.0, 110.0, 80.0, 200.0, 410.0, 10.0, 60.0, 110.0, 80.0, 80.0, 50.0, 40.0, 110.0, 150.0, 160.0, 80.0, 130.0, 20.0, 70.0, 80.0, 220.0, 90.0, 20.0, 40.0, 130.0, 170.0, 220.0, 400.0, 40.0, 150.0, 60.0, 260.0, 80.0, 230.0, 270.0, 70.0, 20.0, 100.0, 220.0, 40.0, 260.0, 40.0, 90.0, 330.0, 40.0, 110.0, 0.0, 60.0, 170.0, 20.0, 20.0, 140.0, 90.0, 40.0, 90.0, 340.0, 80.0, 120.0, 30.0, 130.0, 430.0, 90.0, 100.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6777166176885208, "mean_inference_ms": 1.4904235402567998, "mean_action_processing_ms": 0.42892554554299733, "mean_env_wait_ms": 1.347941648551257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013973712921142578, "StateBufferConnector_ms": 0.010249614715576172, "ViewRequirementAgentConnector_ms": 0.39104318618774414}, "num_episodes": 22, "episode_return_max": 1780.0, "episode_return_min": 250.0, "episode_return_mean": 1036.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.1618854759253, "num_env_steps_trained_throughput_per_sec": 19.1618854759253, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 208705.577, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208705.532, "sample_time_ms": 2715.023, "learn_time_ms": 205971.407, "learn_throughput": 19.42, "synch_weights_time_ms": 10.66}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": false, "training_iteration": 80, "trial_id": "aa996_00000", "date": "2024-05-24_03-23-28", "timestamp": 1716535408, "time_this_iter_s": 208.75769686698914, "time_total_s": 16675.457104682922, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dba9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16675.457104682922, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 27.06271186440678, "ram_util_percent": 79.91661016949153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.698287606080627, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.876444320404492, "policy_loss": -0.008029328765797887, "vf_loss": 6.883248549807694, "vf_explained_var": 0.000472340828821428, "kl": 0.006125475841224721, "entropy": 0.3202317232617174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 755895.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "env_runners": {"episode_reward_max": 1780.0, "episode_reward_min": 240.0, "episode_reward_mean": 1038.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 103.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1435.0, 1300.0, 1210.0, 1420.0, 1310.0, 470.0, 1200.0, 1220.0, 1020.0, 1350.0, 880.0, 1460.0, 1425.0, 1130.0, 680.0, 1310.0, 1460.0, 860.0, 710.0, 1120.0, 1780.0, 1460.0, 940.0, 1020.0, 330.0, 795.0, 500.0, 765.0, 430.0, 510.0, 1235.0, 930.0, 1130.0, 1070.0, 890.0, 1145.0, 860.0, 935.0, 1350.0, 950.0, 1005.0, 1090.0, 1700.0, 1290.0, 680.0, 690.0, 1250.0, 340.0, 780.0, 1470.0, 1290.0, 1540.0, 1700.0, 250.0, 490.0, 730.0, 305.0, 1390.0, 1060.0, 1485.0, 380.0, 1350.0, 1170.0, 370.0, 500.0, 1040.0, 1720.0, 390.0, 1030.0, 795.0, 630.0, 1180.0, 1235.0, 700.0, 900.0, 1110.0, 1100.0, 910.0, 1740.0, 1440.0, 690.0, 1550.0, 870.0, 620.0, 1125.0, 1450.0, 850.0, 870.0, 1260.0, 1380.0, 705.0, 930.0, 850.0, 1680.0, 240.0, 1485.0, 1170.0, 1045.0, 1370.0, 1440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-30.0, 110.0, 40.0, -15.0, 90.0, 410.0, 100.0, 430.0, 170.0, 130.0, 300.0, 130.0, 80.0, 80.0, 100.0, 60.0, 80.0, 80.0, 350.0, 40.0, 80.0, 60.0, 70.0, 10.0, 330.0, 170.0, 90.0, 200.0, 0.0, 200.0, 150.0, 60.0, 160.0, 20.0, 90.0, 40.0, 360.0, 220.0, 210.0, 110.0, 100.0, 340.0, 90.0, 130.0, 0.0, 140.0, 20.0, 160.0, 170.0, 160.0, 80.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 30.0, 10.0, 160.0, 120.0, 80.0, 220.0, 20.0, 50.0, 50.0, 0.0, 290.0, 90.0, 280.0, 150.0, -10.0, 30.0, 70.0, 100.0, 0.0, 150.0, 20.0, 340.0, 370.0, 110.0, 200.0, 30.0, 100.0, 40.0, 70.0, 230.0, 100.0, 100.0, 40.0, 110.0, 30.0, 60.0, 290.0, 360.0, 200.0, 150.0, 60.0, 10.0, 80.0, 280.0, 60.0, 0.0, 40.0, 110.0, 60.0, 130.0, 10.0, 10.0, 180.0, 50.0, 350.0, 300.0, 60.0, 20.0, 0.0, 380.0, 30.0, 90.0, 180.0, 380.0, 320.0, 100.0, 260.0, 20.0, -45.0, 30.0, 160.0, 190.0, 10.0, 30.0, 160.0, 40.0, 90.0, 190.0, 10.0, 10.0, 160.0, 260.0, 180.0, 40.0, 30.0, 190.0, 100.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 210.0, 80.0, 80.0, 60.0, 200.0, 370.0, 120.0, 30.0, 150.0, 10.0, 220.0, 150.0, 210.0, 270.0, 190.0, 90.0, 140.0, 30.0, 100.0, 60.0, 100.0, 0.0, 50.0, 170.0, 270.0, 0.0, 50.0, 50.0, 10.0, 160.0, 0.0, 210.0, 180.0, 120.0, 30.0, 10.0, 10.0, 0.0, 140.0, 10.0, 80.0, 370.0, 50.0, 100.0, 160.0, 100.0, 30.0, 100.0, 30.0, 100.0, 320.0, 190.0, 20.0, 300.0, 170.0, 20.0, 60.0, 70.0, 50.0, 580.0, 110.0, 450.0, 50.0, 90.0, 130.0, 120.0, 40.0, 200.0, 240.0, 30.0, 60.0, 20.0, 180.0, 80.0, 100.0, 20.0, 10.0, 20.0, 280.0, 170.0, 190.0, 60.0, 220.0, 50.0, 230.0, 20.0, 120.0, 40.0, 50.0, 40.0, 10.0, -80.0, 160.0, 0.0, 10.0, -100.0, 70.0, 40.0, 30.0, 190.0, 190.0, 20.0, 40.0, 120.0, -10.0, 80.0, 200.0, 60.0, 25.0, 70.0, 130.0, 30.0, 10.0, 100.0, 70.0, 80.0, 20.0, 20.0, 30.0, 10.0, 30.0, 100.0, 30.0, 20.0, -5.0, 70.0, 60.0, 70.0, 230.0, 160.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 150.0, 30.0, 160.0, 0.0, 160.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, 20.0, 70.0, 60.0, 30.0, 350.0, 20.0, 130.0, 75.0, 240.0, 180.0, 80.0, 100.0, 80.0, 10.0, 20.0, 150.0, 40.0, 70.0, 120.0, 150.0, 190.0, 30.0, 50.0, 60.0, 300.0, 20.0, 30.0, 80.0, 60.0, 190.0, 310.0, 110.0, 130.0, 120.0, 170.0, 40.0, 40.0, 130.0, 0.0, 170.0, 160.0, 40.0, -40.0, 0.0, 380.0, 130.0, 20.0, -20.0, 270.0, 90.0, 20.0, 70.0, 700.0, 90.0, 20.0, 0.0, 70.0, 50.0, 5.0, 10.0, 130.0, 20.0, -260.0, 490.0, 40.0, 90.0, 110.0, 120.0, 60.0, 20.0, 170.0, 120.0, 210.0, 20.0, 20.0, 20.0, 40.0, 280.0, 35.0, 150.0, 40.0, 30.0, 100.0, 50.0, 160.0, 50.0, 40.0, 50.0, 110.0, 290.0, 470.0, -30.0, 90.0, 300.0, 30.0, 200.0, 140.0, 90.0, 20.0, 210.0, -100.0, 350.0, 30.0, 210.0, 70.0, 80.0, 130.0, 60.0, -10.0, 80.0, 5.0, 100.0, 120.0, 100.0, 210.0, 110.0, 10.0, 20.0, 130.0, 180.0, 110.0, 230.0, 70.0, 80.0, 0.0, 110.0, 50.0, 450.0, 140.0, 540.0, 30.0, 60.0, 120.0, 100.0, 230.0, 60.0, 210.0, 100.0, 240.0, 100.0, 70.0, 10.0, 210.0, 190.0, 40.0, 0.0, 90.0, 60.0, 0.0, 80.0, 0.0, 0.0, 280.0, 210.0, 60.0, 20.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 40.0, 70.0, 30.0, 50.0, 360.0, 0.0, 10.0, 200.0, 490.0, 70.0, 180.0, 80.0, 120.0, -50.0, -210.0, 50.0, -50.0, -20.0, 170.0, 270.0, 40.0, 200.0, 120.0, 10.0, 30.0, 0.0, 70.0, 30.0, 10.0, 650.0, 180.0, 20.0, 70.0, -50.0, 20.0, 80.0, 90.0, 330.0, 80.0, 140.0, 20.0, 210.0, 290.0, 130.0, 340.0, 50.0, 20.0, 10.0, 80.0, 80.0, 180.0, 100.0, 30.0, 80.0, 510.0, 80.0, 210.0, 60.0, 210.0, 170.0, -50.0, 210.0, 210.0, 130.0, 640.0, 80.0, 50.0, 210.0, 50.0, 20.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 140.0, 0.0, 40.0, 90.0, 40.0, 100.0, 0.0, 100.0, 0.0, 50.0, 80.0, 0.0, 20.0, 180.0, 20.0, 260.0, 20.0, 0.0, 10.0, 25.0, 110.0, 70.0, 20.0, 10.0, 20.0, 20.0, 20.0, 210.0, 40.0, 90.0, 70.0, 100.0, 100.0, 410.0, 90.0, 120.0, 160.0, 30.0, 220.0, 30.0, 90.0, 50.0, 180.0, 50.0, 260.0, 60.0, 90.0, 40.0, 600.0, 380.0, 40.0, 30.0, 100.0, -50.0, 300.0, 15.0, 30.0, 0.0, 30.0, 40.0, 0.0, 110.0, 20.0, 30.0, 30.0, 100.0, 20.0, 130.0, 230.0, 180.0, 210.0, 120.0, 80.0, 120.0, 120.0, 70.0, 90.0, 40.0, 120.0, 10.0, 30.0, 0.0, 190.0, 610.0, 80.0, 50.0, 40.0, 130.0, 90.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 120.0, 10.0, 50.0, 10.0, 10.0, 140.0, 70.0, 180.0, 20.0, 370.0, 60.0, 50.0, 10.0, 10.0, 10.0, 260.0, 70.0, 500.0, 440.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 250.0, 90.0, 50.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 40.0, 160.0, 0.0, 140.0, 110.0, 50.0, -80.0, 40.0, 400.0, 120.0, 10.0, 160.0, 80.0, 10.0, 30.0, 90.0, 0.0, 110.0, 220.0, 190.0, 80.0, 25.0, 40.0, 50.0, 210.0, 0.0, 10.0, 20.0, 120.0, 0.0, 60.0, 50.0, 110.0, 0.0, 70.0, 270.0, 160.0, 90.0, 80.0, 70.0, 50.0, 160.0, 230.0, 90.0, 160.0, 20.0, 130.0, 10.0, 10.0, 25.0, 60.0, 220.0, 510.0, 70.0, 240.0, 150.0, 40.0, 100.0, 60.0, 30.0, 0.0, 0.0, 10.0, 170.0, 350.0, 20.0, 40.0, 10.0, 70.0, 20.0, 40.0, 20.0, 160.0, 60.0, -10.0, 200.0, 60.0, 310.0, 30.0, 70.0, 110.0, 80.0, 200.0, 410.0, 10.0, 60.0, 110.0, 80.0, 80.0, 50.0, 40.0, 110.0, 150.0, 160.0, 80.0, 130.0, 20.0, 70.0, 80.0, 220.0, 90.0, 20.0, 40.0, 130.0, 170.0, 220.0, 400.0, 40.0, 150.0, 60.0, 260.0, 80.0, 230.0, 270.0, 70.0, 20.0, 100.0, 220.0, 40.0, 260.0, 40.0, 90.0, 330.0, 40.0, 110.0, 0.0, 60.0, 170.0, 20.0, 20.0, 140.0, 90.0, 40.0, 90.0, 340.0, 80.0, 120.0, 30.0, 130.0, 430.0, 90.0, 100.0, 140.0, -70.0, 230.0, 20.0, 220.0, 10.0, 220.0, 20.0, 20.0, 70.0, 130.0, 110.0, 10.0, 20.0, 20.0, 60.0, 290.0, 0.0, 30.0, 20.0, 60.0, 450.0, 40.0, 210.0, -40.0, 100.0, 25.0, 50.0, 20.0, 30.0, 240.0, 140.0, -10.0, 210.0, 360.0, 210.0, 30.0, 70.0, -10.0, 40.0, 410.0, 120.0, 10.0, 30.0, 180.0, 60.0, 30.0, 200.0, 170.0, 50.0, 0.0, 20.0, 230.0, 30.0, 40.0, 40.0, -10.0, 200.0, 260.0, 40.0, 20.0, 80.0, 360.0, -50.0, -100.0, 90.0, 180.0, 210.0, 80.0, 370.0, 40.0, 90.0, 610.0, 160.0, 70.0, 60.0, 200.0, 40.0, 80.0, 80.0, -10.0, 0.0, 80.0, 20.0, 35.0, 60.0, 180.0, 40.0, 0.0, 80.0, 210.0, -40.0, 20.0, 90.0, 260.0, -30.0, 190.0, 90.0, 80.0, 110.0, 160.0, 100.0, 50.0, 0.0, 80.0, 10.0, 470.0, -20.0, 110.0, 50.0, 0.0, 30.0, 300.0, 40.0, 60.0, 280.0, 320.0, 380.0, 30.0, 170.0, 70.0, 0.0, 30.0, 30.0, 60.0, 40.0, 10.0, 30.0, -20.0, 10.0, 50.0, 370.0, 280.0, 140.0, 100.0, 200.0, 30.0, 60.0, 140.0, 160.0, 5.0, 100.0, 0.0, 20.0, 170.0, 40.0, 30.0, 390.0, 30.0, 300.0, 90.0, 70.0, 20.0, 210.0, 70.0, 260.0, 110.0, 30.0, 20.0, 5.0, 250.0, 180.0, 50.0, 90.0, 230.0, 100.0, 20.0, 40.0, 70.0, 440.0, 150.0, 20.0, 530.0, 20.0, 170.0, 30.0, 180.0, -20.0, 200.0, 190.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6770919521360985, "mean_inference_ms": 1.4900445765326367, "mean_action_processing_ms": 0.4285992485545467, "mean_env_wait_ms": 1.3475001297109876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014139175415039062, "StateBufferConnector_ms": 0.010414838790893555, "ViewRequirementAgentConnector_ms": 0.4027140140533447}, "num_episodes": 18, "episode_return_max": 1780.0, "episode_return_min": 240.0, "episode_return_mean": 1038.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.29401026077377, "num_env_steps_trained_throughput_per_sec": 19.29401026077377, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 3240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3240000, "timers": {"training_iteration_time_ms": 208621.692, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208621.646, "sample_time_ms": 2729.663, "learn_time_ms": 205872.68, "learn_throughput": 19.429, "synch_weights_time_ms": 10.645}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "done": false, "training_iteration": 81, "trial_id": "aa996_00000", "date": "2024-05-24_03-26-56", "timestamp": 1716535616, "time_this_iter_s": 207.32511806488037, "time_total_s": 16882.782222747803, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332db7040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16882.782222747803, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.783617747440275, "ram_util_percent": 78.8061433447099}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.220402078443188, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.727107571946165, "policy_loss": -0.007480029254299772, "vf_loss": 6.733391709982778, "vf_explained_var": -0.000412826765332613, "kl": 0.005979482874777727, "entropy": 0.33053909008717514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 765285.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "env_runners": {"episode_reward_max": 1865.0, "episode_reward_min": 240.0, "episode_reward_mean": 980.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 98.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1020.0, 330.0, 795.0, 500.0, 765.0, 430.0, 510.0, 1235.0, 930.0, 1130.0, 1070.0, 890.0, 1145.0, 860.0, 935.0, 1350.0, 950.0, 1005.0, 1090.0, 1700.0, 1290.0, 680.0, 690.0, 1250.0, 340.0, 780.0, 1470.0, 1290.0, 1540.0, 1700.0, 250.0, 490.0, 730.0, 305.0, 1390.0, 1060.0, 1485.0, 380.0, 1350.0, 1170.0, 370.0, 500.0, 1040.0, 1720.0, 390.0, 1030.0, 795.0, 630.0, 1180.0, 1235.0, 700.0, 900.0, 1110.0, 1100.0, 910.0, 1740.0, 1440.0, 690.0, 1550.0, 870.0, 620.0, 1125.0, 1450.0, 850.0, 870.0, 1260.0, 1380.0, 705.0, 930.0, 850.0, 1680.0, 240.0, 1485.0, 1170.0, 1045.0, 1370.0, 1440.0, 560.0, 1050.0, 600.0, 1220.0, 1260.0, 260.0, 1130.0, 1270.0, 1320.0, 645.0, 1310.0, 590.0, 800.0, 890.0, 410.0, 670.0, 1580.0, 825.0, 410.0, 920.0, 450.0, 1390.0, 1865.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 60.0, 220.0, 50.0, 230.0, 20.0, 120.0, 40.0, 50.0, 40.0, 10.0, -80.0, 160.0, 0.0, 10.0, -100.0, 70.0, 40.0, 30.0, 190.0, 190.0, 20.0, 40.0, 120.0, -10.0, 80.0, 200.0, 60.0, 25.0, 70.0, 130.0, 30.0, 10.0, 100.0, 70.0, 80.0, 20.0, 20.0, 30.0, 10.0, 30.0, 100.0, 30.0, 20.0, -5.0, 70.0, 60.0, 70.0, 230.0, 160.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 10.0, 20.0, 150.0, 30.0, 160.0, 0.0, 160.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, 20.0, 70.0, 60.0, 30.0, 350.0, 20.0, 130.0, 75.0, 240.0, 180.0, 80.0, 100.0, 80.0, 10.0, 20.0, 150.0, 40.0, 70.0, 120.0, 150.0, 190.0, 30.0, 50.0, 60.0, 300.0, 20.0, 30.0, 80.0, 60.0, 190.0, 310.0, 110.0, 130.0, 120.0, 170.0, 40.0, 40.0, 130.0, 0.0, 170.0, 160.0, 40.0, -40.0, 0.0, 380.0, 130.0, 20.0, -20.0, 270.0, 90.0, 20.0, 70.0, 700.0, 90.0, 20.0, 0.0, 70.0, 50.0, 5.0, 10.0, 130.0, 20.0, -260.0, 490.0, 40.0, 90.0, 110.0, 120.0, 60.0, 20.0, 170.0, 120.0, 210.0, 20.0, 20.0, 20.0, 40.0, 280.0, 35.0, 150.0, 40.0, 30.0, 100.0, 50.0, 160.0, 50.0, 40.0, 50.0, 110.0, 290.0, 470.0, -30.0, 90.0, 300.0, 30.0, 200.0, 140.0, 90.0, 20.0, 210.0, -100.0, 350.0, 30.0, 210.0, 70.0, 80.0, 130.0, 60.0, -10.0, 80.0, 5.0, 100.0, 120.0, 100.0, 210.0, 110.0, 10.0, 20.0, 130.0, 180.0, 110.0, 230.0, 70.0, 80.0, 0.0, 110.0, 50.0, 450.0, 140.0, 540.0, 30.0, 60.0, 120.0, 100.0, 230.0, 60.0, 210.0, 100.0, 240.0, 100.0, 70.0, 10.0, 210.0, 190.0, 40.0, 0.0, 90.0, 60.0, 0.0, 80.0, 0.0, 0.0, 280.0, 210.0, 60.0, 20.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 40.0, 70.0, 30.0, 50.0, 360.0, 0.0, 10.0, 200.0, 490.0, 70.0, 180.0, 80.0, 120.0, -50.0, -210.0, 50.0, -50.0, -20.0, 170.0, 270.0, 40.0, 200.0, 120.0, 10.0, 30.0, 0.0, 70.0, 30.0, 10.0, 650.0, 180.0, 20.0, 70.0, -50.0, 20.0, 80.0, 90.0, 330.0, 80.0, 140.0, 20.0, 210.0, 290.0, 130.0, 340.0, 50.0, 20.0, 10.0, 80.0, 80.0, 180.0, 100.0, 30.0, 80.0, 510.0, 80.0, 210.0, 60.0, 210.0, 170.0, -50.0, 210.0, 210.0, 130.0, 640.0, 80.0, 50.0, 210.0, 50.0, 20.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 140.0, 0.0, 40.0, 90.0, 40.0, 100.0, 0.0, 100.0, 0.0, 50.0, 80.0, 0.0, 20.0, 180.0, 20.0, 260.0, 20.0, 0.0, 10.0, 25.0, 110.0, 70.0, 20.0, 10.0, 20.0, 20.0, 20.0, 210.0, 40.0, 90.0, 70.0, 100.0, 100.0, 410.0, 90.0, 120.0, 160.0, 30.0, 220.0, 30.0, 90.0, 50.0, 180.0, 50.0, 260.0, 60.0, 90.0, 40.0, 600.0, 380.0, 40.0, 30.0, 100.0, -50.0, 300.0, 15.0, 30.0, 0.0, 30.0, 40.0, 0.0, 110.0, 20.0, 30.0, 30.0, 100.0, 20.0, 130.0, 230.0, 180.0, 210.0, 120.0, 80.0, 120.0, 120.0, 70.0, 90.0, 40.0, 120.0, 10.0, 30.0, 0.0, 190.0, 610.0, 80.0, 50.0, 40.0, 130.0, 90.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 120.0, 10.0, 50.0, 10.0, 10.0, 140.0, 70.0, 180.0, 20.0, 370.0, 60.0, 50.0, 10.0, 10.0, 10.0, 260.0, 70.0, 500.0, 440.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 250.0, 90.0, 50.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 40.0, 160.0, 0.0, 140.0, 110.0, 50.0, -80.0, 40.0, 400.0, 120.0, 10.0, 160.0, 80.0, 10.0, 30.0, 90.0, 0.0, 110.0, 220.0, 190.0, 80.0, 25.0, 40.0, 50.0, 210.0, 0.0, 10.0, 20.0, 120.0, 0.0, 60.0, 50.0, 110.0, 0.0, 70.0, 270.0, 160.0, 90.0, 80.0, 70.0, 50.0, 160.0, 230.0, 90.0, 160.0, 20.0, 130.0, 10.0, 10.0, 25.0, 60.0, 220.0, 510.0, 70.0, 240.0, 150.0, 40.0, 100.0, 60.0, 30.0, 0.0, 0.0, 10.0, 170.0, 350.0, 20.0, 40.0, 10.0, 70.0, 20.0, 40.0, 20.0, 160.0, 60.0, -10.0, 200.0, 60.0, 310.0, 30.0, 70.0, 110.0, 80.0, 200.0, 410.0, 10.0, 60.0, 110.0, 80.0, 80.0, 50.0, 40.0, 110.0, 150.0, 160.0, 80.0, 130.0, 20.0, 70.0, 80.0, 220.0, 90.0, 20.0, 40.0, 130.0, 170.0, 220.0, 400.0, 40.0, 150.0, 60.0, 260.0, 80.0, 230.0, 270.0, 70.0, 20.0, 100.0, 220.0, 40.0, 260.0, 40.0, 90.0, 330.0, 40.0, 110.0, 0.0, 60.0, 170.0, 20.0, 20.0, 140.0, 90.0, 40.0, 90.0, 340.0, 80.0, 120.0, 30.0, 130.0, 430.0, 90.0, 100.0, 140.0, -70.0, 230.0, 20.0, 220.0, 10.0, 220.0, 20.0, 20.0, 70.0, 130.0, 110.0, 10.0, 20.0, 20.0, 60.0, 290.0, 0.0, 30.0, 20.0, 60.0, 450.0, 40.0, 210.0, -40.0, 100.0, 25.0, 50.0, 20.0, 30.0, 240.0, 140.0, -10.0, 210.0, 360.0, 210.0, 30.0, 70.0, -10.0, 40.0, 410.0, 120.0, 10.0, 30.0, 180.0, 60.0, 30.0, 200.0, 170.0, 50.0, 0.0, 20.0, 230.0, 30.0, 40.0, 40.0, -10.0, 200.0, 260.0, 40.0, 20.0, 80.0, 360.0, -50.0, -100.0, 90.0, 180.0, 210.0, 80.0, 370.0, 40.0, 90.0, 610.0, 160.0, 70.0, 60.0, 200.0, 40.0, 80.0, 80.0, -10.0, 0.0, 80.0, 20.0, 35.0, 60.0, 180.0, 40.0, 0.0, 80.0, 210.0, -40.0, 20.0, 90.0, 260.0, -30.0, 190.0, 90.0, 80.0, 110.0, 160.0, 100.0, 50.0, 0.0, 80.0, 10.0, 470.0, -20.0, 110.0, 50.0, 0.0, 30.0, 300.0, 40.0, 60.0, 280.0, 320.0, 380.0, 30.0, 170.0, 70.0, 0.0, 30.0, 30.0, 60.0, 40.0, 10.0, 30.0, -20.0, 10.0, 50.0, 370.0, 280.0, 140.0, 100.0, 200.0, 30.0, 60.0, 140.0, 160.0, 5.0, 100.0, 0.0, 20.0, 170.0, 40.0, 30.0, 390.0, 30.0, 300.0, 90.0, 70.0, 20.0, 210.0, 70.0, 260.0, 110.0, 30.0, 20.0, 5.0, 250.0, 180.0, 50.0, 90.0, 230.0, 100.0, 20.0, 40.0, 70.0, 440.0, 150.0, 20.0, 530.0, 20.0, 170.0, 30.0, 180.0, -20.0, 200.0, 190.0, 120.0, 0.0, 50.0, -50.0, 150.0, 20.0, 60.0, 100.0, 110.0, 40.0, 80.0, 130.0, 150.0, 180.0, 40.0, 180.0, 70.0, 70.0, 0.0, 140.0, 90.0, 50.0, 100.0, 180.0, 110.0, 40.0, 0.0, 70.0, 20.0, 10.0, 20.0, 70.0, 390.0, 130.0, 70.0, 40.0, 70.0, 60.0, 300.0, 0.0, 90.0, 460.0, 120.0, 30.0, 40.0, 60.0, 80.0, 80.0, 20.0, 340.0, 30.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 210.0, 70.0, 30.0, 110.0, 160.0, 130.0, 0.0, 330.0, 40.0, 50.0, 40.0, 30.0, 290.0, 240.0, 40.0, 20.0, 180.0, 320.0, 30.0, 80.0, 90.0, 350.0, 30.0, 100.0, 100.0, 10.0, 120.0, -10.0, 20.0, 510.0, 60.0, -50.0, 40.0, 210.0, -5.0, 30.0, 40.0, 60.0, 30.0, 230.0, 100.0, 20.0, 90.0, 90.0, 0.0, 70.0, 10.0, 530.0, 210.0, 190.0, 30.0, 130.0, 20.0, 40.0, 10.0, 70.0, 160.0, 30.0, 0.0, 100.0, 270.0, 50.0, 30.0, 200.0, 20.0, 60.0, 90.0, 0.0, 10.0, 70.0, 100.0, 20.0, 360.0, 60.0, 130.0, 90.0, 80.0, 50.0, 0.0, 0.0, 30.0, 0.0, 150.0, 10.0, 70.0, 50.0, 50.0, 0.0, 10.0, 40.0, 40.0, 30.0, 80.0, 150.0, 60.0, 220.0, 20.0, 40.0, -10.0, 40.0, 5.0, 450.0, 80.0, 130.0, 200.0, 30.0, 190.0, 20.0, 435.0, 40.0, 70.0, 40.0, 20.0, 50.0, 120.0, 200.0, 210.0, -5.0, 10.0, 110.0, 10.0, 0.0, 40.0, 30.0, 160.0, 30.0, 50.0, 70.0, 0.0, 20.0, 10.0, 70.0, 0.0, 160.0, 40.0, 80.0, 250.0, 120.0, 80.0, 110.0, 20.0, 20.0, 0.0, 40.0, 30.0, 80.0, 30.0, 20.0, 40.0, 170.0, 360.0, -40.0, 60.0, 50.0, 180.0, 90.0, 80.0, 370.0, 10.0, 230.0, 500.0, 60.0, 10.0, 145.0, 150.0, 180.0, 210.0, 500.0, 40.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6758330906066532, "mean_inference_ms": 1.489437115086743, "mean_action_processing_ms": 0.4281592662334225, "mean_env_wait_ms": 1.3468417663483911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013840436935424805, "StateBufferConnector_ms": 0.010779857635498047, "ViewRequirementAgentConnector_ms": 0.40717554092407227}, "num_episodes": 23, "episode_return_max": 1865.0, "episode_return_min": 240.0, "episode_return_mean": 980.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.324089330324227, "num_env_steps_trained_throughput_per_sec": 19.324089330324227, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 3280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3280000, "timers": {"training_iteration_time_ms": 208420.841, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208420.795, "sample_time_ms": 2691.797, "learn_time_ms": 205709.71, "learn_throughput": 19.445, "synch_weights_time_ms": 10.572}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "done": false, "training_iteration": 82, "trial_id": "aa996_00000", "date": "2024-05-24_03-30-23", "timestamp": 1716535823, "time_this_iter_s": 207.00496888160706, "time_total_s": 17089.78719162941, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d9f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17089.78719162941, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 26.64607508532423, "ram_util_percent": 79.40648464163822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.881449701585455, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.54379859554628, "policy_loss": -0.006956924529038509, "vf_loss": 7.549593982605127, "vf_explained_var": 0.00031485767029344844, "kl": 0.005807676880961833, "entropy": 0.32256305488629844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 774675.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "env_runners": {"episode_reward_max": 1865.0, "episode_reward_min": 240.0, "episode_reward_mean": 1020.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 102.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1090.0, 1700.0, 1290.0, 680.0, 690.0, 1250.0, 340.0, 780.0, 1470.0, 1290.0, 1540.0, 1700.0, 250.0, 490.0, 730.0, 305.0, 1390.0, 1060.0, 1485.0, 380.0, 1350.0, 1170.0, 370.0, 500.0, 1040.0, 1720.0, 390.0, 1030.0, 795.0, 630.0, 1180.0, 1235.0, 700.0, 900.0, 1110.0, 1100.0, 910.0, 1740.0, 1440.0, 690.0, 1550.0, 870.0, 620.0, 1125.0, 1450.0, 850.0, 870.0, 1260.0, 1380.0, 705.0, 930.0, 850.0, 1680.0, 240.0, 1485.0, 1170.0, 1045.0, 1370.0, 1440.0, 560.0, 1050.0, 600.0, 1220.0, 1260.0, 260.0, 1130.0, 1270.0, 1320.0, 645.0, 1310.0, 590.0, 800.0, 890.0, 410.0, 670.0, 1580.0, 825.0, 410.0, 920.0, 450.0, 1390.0, 1865.0, 1040.0, 860.0, 1110.0, 1410.0, 1600.0, 900.0, 520.0, 1740.0, 860.0, 1140.0, 890.0, 630.0, 520.0, 1030.0, 1030.0, 1540.0, 1650.0, 1335.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 120.0, 100.0, 210.0, 110.0, 10.0, 20.0, 130.0, 180.0, 110.0, 230.0, 70.0, 80.0, 0.0, 110.0, 50.0, 450.0, 140.0, 540.0, 30.0, 60.0, 120.0, 100.0, 230.0, 60.0, 210.0, 100.0, 240.0, 100.0, 70.0, 10.0, 210.0, 190.0, 40.0, 0.0, 90.0, 60.0, 0.0, 80.0, 0.0, 0.0, 280.0, 210.0, 60.0, 20.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 40.0, 70.0, 30.0, 50.0, 360.0, 0.0, 10.0, 200.0, 490.0, 70.0, 180.0, 80.0, 120.0, -50.0, -210.0, 50.0, -50.0, -20.0, 170.0, 270.0, 40.0, 200.0, 120.0, 10.0, 30.0, 0.0, 70.0, 30.0, 10.0, 650.0, 180.0, 20.0, 70.0, -50.0, 20.0, 80.0, 90.0, 330.0, 80.0, 140.0, 20.0, 210.0, 290.0, 130.0, 340.0, 50.0, 20.0, 10.0, 80.0, 80.0, 180.0, 100.0, 30.0, 80.0, 510.0, 80.0, 210.0, 60.0, 210.0, 170.0, -50.0, 210.0, 210.0, 130.0, 640.0, 80.0, 50.0, 210.0, 50.0, 20.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 140.0, 0.0, 40.0, 90.0, 40.0, 100.0, 0.0, 100.0, 0.0, 50.0, 80.0, 0.0, 20.0, 180.0, 20.0, 260.0, 20.0, 0.0, 10.0, 25.0, 110.0, 70.0, 20.0, 10.0, 20.0, 20.0, 20.0, 210.0, 40.0, 90.0, 70.0, 100.0, 100.0, 410.0, 90.0, 120.0, 160.0, 30.0, 220.0, 30.0, 90.0, 50.0, 180.0, 50.0, 260.0, 60.0, 90.0, 40.0, 600.0, 380.0, 40.0, 30.0, 100.0, -50.0, 300.0, 15.0, 30.0, 0.0, 30.0, 40.0, 0.0, 110.0, 20.0, 30.0, 30.0, 100.0, 20.0, 130.0, 230.0, 180.0, 210.0, 120.0, 80.0, 120.0, 120.0, 70.0, 90.0, 40.0, 120.0, 10.0, 30.0, 0.0, 190.0, 610.0, 80.0, 50.0, 40.0, 130.0, 90.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 120.0, 10.0, 50.0, 10.0, 10.0, 140.0, 70.0, 180.0, 20.0, 370.0, 60.0, 50.0, 10.0, 10.0, 10.0, 260.0, 70.0, 500.0, 440.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 250.0, 90.0, 50.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 40.0, 160.0, 0.0, 140.0, 110.0, 50.0, -80.0, 40.0, 400.0, 120.0, 10.0, 160.0, 80.0, 10.0, 30.0, 90.0, 0.0, 110.0, 220.0, 190.0, 80.0, 25.0, 40.0, 50.0, 210.0, 0.0, 10.0, 20.0, 120.0, 0.0, 60.0, 50.0, 110.0, 0.0, 70.0, 270.0, 160.0, 90.0, 80.0, 70.0, 50.0, 160.0, 230.0, 90.0, 160.0, 20.0, 130.0, 10.0, 10.0, 25.0, 60.0, 220.0, 510.0, 70.0, 240.0, 150.0, 40.0, 100.0, 60.0, 30.0, 0.0, 0.0, 10.0, 170.0, 350.0, 20.0, 40.0, 10.0, 70.0, 20.0, 40.0, 20.0, 160.0, 60.0, -10.0, 200.0, 60.0, 310.0, 30.0, 70.0, 110.0, 80.0, 200.0, 410.0, 10.0, 60.0, 110.0, 80.0, 80.0, 50.0, 40.0, 110.0, 150.0, 160.0, 80.0, 130.0, 20.0, 70.0, 80.0, 220.0, 90.0, 20.0, 40.0, 130.0, 170.0, 220.0, 400.0, 40.0, 150.0, 60.0, 260.0, 80.0, 230.0, 270.0, 70.0, 20.0, 100.0, 220.0, 40.0, 260.0, 40.0, 90.0, 330.0, 40.0, 110.0, 0.0, 60.0, 170.0, 20.0, 20.0, 140.0, 90.0, 40.0, 90.0, 340.0, 80.0, 120.0, 30.0, 130.0, 430.0, 90.0, 100.0, 140.0, -70.0, 230.0, 20.0, 220.0, 10.0, 220.0, 20.0, 20.0, 70.0, 130.0, 110.0, 10.0, 20.0, 20.0, 60.0, 290.0, 0.0, 30.0, 20.0, 60.0, 450.0, 40.0, 210.0, -40.0, 100.0, 25.0, 50.0, 20.0, 30.0, 240.0, 140.0, -10.0, 210.0, 360.0, 210.0, 30.0, 70.0, -10.0, 40.0, 410.0, 120.0, 10.0, 30.0, 180.0, 60.0, 30.0, 200.0, 170.0, 50.0, 0.0, 20.0, 230.0, 30.0, 40.0, 40.0, -10.0, 200.0, 260.0, 40.0, 20.0, 80.0, 360.0, -50.0, -100.0, 90.0, 180.0, 210.0, 80.0, 370.0, 40.0, 90.0, 610.0, 160.0, 70.0, 60.0, 200.0, 40.0, 80.0, 80.0, -10.0, 0.0, 80.0, 20.0, 35.0, 60.0, 180.0, 40.0, 0.0, 80.0, 210.0, -40.0, 20.0, 90.0, 260.0, -30.0, 190.0, 90.0, 80.0, 110.0, 160.0, 100.0, 50.0, 0.0, 80.0, 10.0, 470.0, -20.0, 110.0, 50.0, 0.0, 30.0, 300.0, 40.0, 60.0, 280.0, 320.0, 380.0, 30.0, 170.0, 70.0, 0.0, 30.0, 30.0, 60.0, 40.0, 10.0, 30.0, -20.0, 10.0, 50.0, 370.0, 280.0, 140.0, 100.0, 200.0, 30.0, 60.0, 140.0, 160.0, 5.0, 100.0, 0.0, 20.0, 170.0, 40.0, 30.0, 390.0, 30.0, 300.0, 90.0, 70.0, 20.0, 210.0, 70.0, 260.0, 110.0, 30.0, 20.0, 5.0, 250.0, 180.0, 50.0, 90.0, 230.0, 100.0, 20.0, 40.0, 70.0, 440.0, 150.0, 20.0, 530.0, 20.0, 170.0, 30.0, 180.0, -20.0, 200.0, 190.0, 120.0, 0.0, 50.0, -50.0, 150.0, 20.0, 60.0, 100.0, 110.0, 40.0, 80.0, 130.0, 150.0, 180.0, 40.0, 180.0, 70.0, 70.0, 0.0, 140.0, 90.0, 50.0, 100.0, 180.0, 110.0, 40.0, 0.0, 70.0, 20.0, 10.0, 20.0, 70.0, 390.0, 130.0, 70.0, 40.0, 70.0, 60.0, 300.0, 0.0, 90.0, 460.0, 120.0, 30.0, 40.0, 60.0, 80.0, 80.0, 20.0, 340.0, 30.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 210.0, 70.0, 30.0, 110.0, 160.0, 130.0, 0.0, 330.0, 40.0, 50.0, 40.0, 30.0, 290.0, 240.0, 40.0, 20.0, 180.0, 320.0, 30.0, 80.0, 90.0, 350.0, 30.0, 100.0, 100.0, 10.0, 120.0, -10.0, 20.0, 510.0, 60.0, -50.0, 40.0, 210.0, -5.0, 30.0, 40.0, 60.0, 30.0, 230.0, 100.0, 20.0, 90.0, 90.0, 0.0, 70.0, 10.0, 530.0, 210.0, 190.0, 30.0, 130.0, 20.0, 40.0, 10.0, 70.0, 160.0, 30.0, 0.0, 100.0, 270.0, 50.0, 30.0, 200.0, 20.0, 60.0, 90.0, 0.0, 10.0, 70.0, 100.0, 20.0, 360.0, 60.0, 130.0, 90.0, 80.0, 50.0, 0.0, 0.0, 30.0, 0.0, 150.0, 10.0, 70.0, 50.0, 50.0, 0.0, 10.0, 40.0, 40.0, 30.0, 80.0, 150.0, 60.0, 220.0, 20.0, 40.0, -10.0, 40.0, 5.0, 450.0, 80.0, 130.0, 200.0, 30.0, 190.0, 20.0, 435.0, 40.0, 70.0, 40.0, 20.0, 50.0, 120.0, 200.0, 210.0, -5.0, 10.0, 110.0, 10.0, 0.0, 40.0, 30.0, 160.0, 30.0, 50.0, 70.0, 0.0, 20.0, 10.0, 70.0, 0.0, 160.0, 40.0, 80.0, 250.0, 120.0, 80.0, 110.0, 20.0, 20.0, 0.0, 40.0, 30.0, 80.0, 30.0, 20.0, 40.0, 170.0, 360.0, -40.0, 60.0, 50.0, 180.0, 90.0, 80.0, 370.0, 10.0, 230.0, 500.0, 60.0, 10.0, 145.0, 150.0, 180.0, 210.0, 500.0, 40.0, 70.0, 30.0, 20.0, 110.0, 360.0, 40.0, -50.0, 40.0, 390.0, 100.0, 0.0, 260.0, -20.0, 190.0, 40.0, 0.0, 20.0, 130.0, 40.0, 190.0, 10.0, 10.0, 90.0, 90.0, 50.0, 290.0, 50.0, 60.0, 300.0, 0.0, 170.0, 90.0, 320.0, 320.0, 210.0, 120.0, 120.0, 80.0, 20.0, 50.0, 80.0, 110.0, 170.0, 80.0, 50.0, 60.0, 390.0, 110.0, 310.0, 200.0, 120.0, 200.0, 30.0, 200.0, 20.0, 90.0, 30.0, 30.0, 0.0, 210.0, 90.0, 0.0, 80.0, 90.0, 160.0, 50.0, 50.0, 50.0, 0.0, 0.0, 40.0, 150.0, -20.0, 390.0, 20.0, -10.0, 110.0, 30.0, 30.0, 870.0, 170.0, 110.0, 130.0, 230.0, 20.0, 170.0, 30.0, 90.0, 40.0, 40.0, 0.0, 70.0, 160.0, 70.0, 70.0, 30.0, 70.0, 100.0, 80.0, 20.0, 470.0, 120.0, 10.0, 480.0, 10.0, 60.0, 10.0, 30.0, -30.0, 120.0, 80.0, 70.0, 170.0, 20.0, 50.0, 80.0, 20.0, 50.0, 20.0, 130.0, 20.0, 40.0, 10.0, 70.0, 10.0, 20.0, 20.0, 70.0, 30.0, 160.0, 90.0, 190.0, 110.0, -10.0, 30.0, -50.0, 20.0, 400.0, 220.0, 110.0, 10.0, 250.0, -20.0, 120.0, 80.0, 30.0, 280.0, 50.0, 30.0, 120.0, 90.0, 40.0, 70.0, 180.0, 170.0, 130.0, 520.0, 140.0, 120.0, 80.0, 90.0, 0.0, 80.0, 230.0, 70.0, 220.0, 300.0, 70.0, 310.0, 30.0, 340.0, 50.0, 180.0, 190.0, 35.0, 100.0, 90.0, 50.0, 220.0, 330.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6748672793241952, "mean_inference_ms": 1.488916014895597, "mean_action_processing_ms": 0.42780282070977577, "mean_env_wait_ms": 1.346215312836327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013477802276611328, "StateBufferConnector_ms": 0.010769367218017578, "ViewRequirementAgentConnector_ms": 0.3983759880065918}, "num_episodes": 18, "episode_return_max": 1865.0, "episode_return_min": 240.0, "episode_return_mean": 1020.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.334236305181964, "num_env_steps_trained_throughput_per_sec": 19.334236305181964, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 3320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3320000, "timers": {"training_iteration_time_ms": 208308.686, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208308.638, "sample_time_ms": 2639.535, "learn_time_ms": 205649.76, "learn_throughput": 19.451, "synch_weights_time_ms": 10.646}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "done": false, "training_iteration": 83, "trial_id": "aa996_00000", "date": "2024-05-24_03-33-50", "timestamp": 1716536030, "time_this_iter_s": 206.89431309700012, "time_total_s": 17296.68150472641, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17296.68150472641, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 26.89351535836177, "ram_util_percent": 78.57201365187713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1669408420785166, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.096285951429536, "policy_loss": -0.007795074816567067, "vf_loss": 7.10279601440389, "vf_explained_var": -0.0003598018131824855, "kl": 0.006425125165711727, "entropy": 0.34080894336152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 784065.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "env_runners": {"episode_reward_max": 1865.0, "episode_reward_min": 200.0, "episode_reward_mean": 1033.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 103.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1485.0, 380.0, 1350.0, 1170.0, 370.0, 500.0, 1040.0, 1720.0, 390.0, 1030.0, 795.0, 630.0, 1180.0, 1235.0, 700.0, 900.0, 1110.0, 1100.0, 910.0, 1740.0, 1440.0, 690.0, 1550.0, 870.0, 620.0, 1125.0, 1450.0, 850.0, 870.0, 1260.0, 1380.0, 705.0, 930.0, 850.0, 1680.0, 240.0, 1485.0, 1170.0, 1045.0, 1370.0, 1440.0, 560.0, 1050.0, 600.0, 1220.0, 1260.0, 260.0, 1130.0, 1270.0, 1320.0, 645.0, 1310.0, 590.0, 800.0, 890.0, 410.0, 670.0, 1580.0, 825.0, 410.0, 920.0, 450.0, 1390.0, 1865.0, 1040.0, 860.0, 1110.0, 1410.0, 1600.0, 900.0, 520.0, 1740.0, 860.0, 1140.0, 890.0, 630.0, 520.0, 1030.0, 1030.0, 1540.0, 1650.0, 1335.0, 920.0, 510.0, 1360.0, 1650.0, 520.0, 1085.0, 940.0, 1170.0, 1615.0, 1340.0, 1380.0, 200.0, 910.0, 930.0, 970.0, 1670.0, 1190.0, 980.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 600.0, 380.0, 40.0, 30.0, 100.0, -50.0, 300.0, 15.0, 30.0, 0.0, 30.0, 40.0, 0.0, 110.0, 20.0, 30.0, 30.0, 100.0, 20.0, 130.0, 230.0, 180.0, 210.0, 120.0, 80.0, 120.0, 120.0, 70.0, 90.0, 40.0, 120.0, 10.0, 30.0, 0.0, 190.0, 610.0, 80.0, 50.0, 40.0, 130.0, 90.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 120.0, 10.0, 50.0, 10.0, 10.0, 140.0, 70.0, 180.0, 20.0, 370.0, 60.0, 50.0, 10.0, 10.0, 10.0, 260.0, 70.0, 500.0, 440.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 250.0, 90.0, 50.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 40.0, 160.0, 0.0, 140.0, 110.0, 50.0, -80.0, 40.0, 400.0, 120.0, 10.0, 160.0, 80.0, 10.0, 30.0, 90.0, 0.0, 110.0, 220.0, 190.0, 80.0, 25.0, 40.0, 50.0, 210.0, 0.0, 10.0, 20.0, 120.0, 0.0, 60.0, 50.0, 110.0, 0.0, 70.0, 270.0, 160.0, 90.0, 80.0, 70.0, 50.0, 160.0, 230.0, 90.0, 160.0, 20.0, 130.0, 10.0, 10.0, 25.0, 60.0, 220.0, 510.0, 70.0, 240.0, 150.0, 40.0, 100.0, 60.0, 30.0, 0.0, 0.0, 10.0, 170.0, 350.0, 20.0, 40.0, 10.0, 70.0, 20.0, 40.0, 20.0, 160.0, 60.0, -10.0, 200.0, 60.0, 310.0, 30.0, 70.0, 110.0, 80.0, 200.0, 410.0, 10.0, 60.0, 110.0, 80.0, 80.0, 50.0, 40.0, 110.0, 150.0, 160.0, 80.0, 130.0, 20.0, 70.0, 80.0, 220.0, 90.0, 20.0, 40.0, 130.0, 170.0, 220.0, 400.0, 40.0, 150.0, 60.0, 260.0, 80.0, 230.0, 270.0, 70.0, 20.0, 100.0, 220.0, 40.0, 260.0, 40.0, 90.0, 330.0, 40.0, 110.0, 0.0, 60.0, 170.0, 20.0, 20.0, 140.0, 90.0, 40.0, 90.0, 340.0, 80.0, 120.0, 30.0, 130.0, 430.0, 90.0, 100.0, 140.0, -70.0, 230.0, 20.0, 220.0, 10.0, 220.0, 20.0, 20.0, 70.0, 130.0, 110.0, 10.0, 20.0, 20.0, 60.0, 290.0, 0.0, 30.0, 20.0, 60.0, 450.0, 40.0, 210.0, -40.0, 100.0, 25.0, 50.0, 20.0, 30.0, 240.0, 140.0, -10.0, 210.0, 360.0, 210.0, 30.0, 70.0, -10.0, 40.0, 410.0, 120.0, 10.0, 30.0, 180.0, 60.0, 30.0, 200.0, 170.0, 50.0, 0.0, 20.0, 230.0, 30.0, 40.0, 40.0, -10.0, 200.0, 260.0, 40.0, 20.0, 80.0, 360.0, -50.0, -100.0, 90.0, 180.0, 210.0, 80.0, 370.0, 40.0, 90.0, 610.0, 160.0, 70.0, 60.0, 200.0, 40.0, 80.0, 80.0, -10.0, 0.0, 80.0, 20.0, 35.0, 60.0, 180.0, 40.0, 0.0, 80.0, 210.0, -40.0, 20.0, 90.0, 260.0, -30.0, 190.0, 90.0, 80.0, 110.0, 160.0, 100.0, 50.0, 0.0, 80.0, 10.0, 470.0, -20.0, 110.0, 50.0, 0.0, 30.0, 300.0, 40.0, 60.0, 280.0, 320.0, 380.0, 30.0, 170.0, 70.0, 0.0, 30.0, 30.0, 60.0, 40.0, 10.0, 30.0, -20.0, 10.0, 50.0, 370.0, 280.0, 140.0, 100.0, 200.0, 30.0, 60.0, 140.0, 160.0, 5.0, 100.0, 0.0, 20.0, 170.0, 40.0, 30.0, 390.0, 30.0, 300.0, 90.0, 70.0, 20.0, 210.0, 70.0, 260.0, 110.0, 30.0, 20.0, 5.0, 250.0, 180.0, 50.0, 90.0, 230.0, 100.0, 20.0, 40.0, 70.0, 440.0, 150.0, 20.0, 530.0, 20.0, 170.0, 30.0, 180.0, -20.0, 200.0, 190.0, 120.0, 0.0, 50.0, -50.0, 150.0, 20.0, 60.0, 100.0, 110.0, 40.0, 80.0, 130.0, 150.0, 180.0, 40.0, 180.0, 70.0, 70.0, 0.0, 140.0, 90.0, 50.0, 100.0, 180.0, 110.0, 40.0, 0.0, 70.0, 20.0, 10.0, 20.0, 70.0, 390.0, 130.0, 70.0, 40.0, 70.0, 60.0, 300.0, 0.0, 90.0, 460.0, 120.0, 30.0, 40.0, 60.0, 80.0, 80.0, 20.0, 340.0, 30.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 210.0, 70.0, 30.0, 110.0, 160.0, 130.0, 0.0, 330.0, 40.0, 50.0, 40.0, 30.0, 290.0, 240.0, 40.0, 20.0, 180.0, 320.0, 30.0, 80.0, 90.0, 350.0, 30.0, 100.0, 100.0, 10.0, 120.0, -10.0, 20.0, 510.0, 60.0, -50.0, 40.0, 210.0, -5.0, 30.0, 40.0, 60.0, 30.0, 230.0, 100.0, 20.0, 90.0, 90.0, 0.0, 70.0, 10.0, 530.0, 210.0, 190.0, 30.0, 130.0, 20.0, 40.0, 10.0, 70.0, 160.0, 30.0, 0.0, 100.0, 270.0, 50.0, 30.0, 200.0, 20.0, 60.0, 90.0, 0.0, 10.0, 70.0, 100.0, 20.0, 360.0, 60.0, 130.0, 90.0, 80.0, 50.0, 0.0, 0.0, 30.0, 0.0, 150.0, 10.0, 70.0, 50.0, 50.0, 0.0, 10.0, 40.0, 40.0, 30.0, 80.0, 150.0, 60.0, 220.0, 20.0, 40.0, -10.0, 40.0, 5.0, 450.0, 80.0, 130.0, 200.0, 30.0, 190.0, 20.0, 435.0, 40.0, 70.0, 40.0, 20.0, 50.0, 120.0, 200.0, 210.0, -5.0, 10.0, 110.0, 10.0, 0.0, 40.0, 30.0, 160.0, 30.0, 50.0, 70.0, 0.0, 20.0, 10.0, 70.0, 0.0, 160.0, 40.0, 80.0, 250.0, 120.0, 80.0, 110.0, 20.0, 20.0, 0.0, 40.0, 30.0, 80.0, 30.0, 20.0, 40.0, 170.0, 360.0, -40.0, 60.0, 50.0, 180.0, 90.0, 80.0, 370.0, 10.0, 230.0, 500.0, 60.0, 10.0, 145.0, 150.0, 180.0, 210.0, 500.0, 40.0, 70.0, 30.0, 20.0, 110.0, 360.0, 40.0, -50.0, 40.0, 390.0, 100.0, 0.0, 260.0, -20.0, 190.0, 40.0, 0.0, 20.0, 130.0, 40.0, 190.0, 10.0, 10.0, 90.0, 90.0, 50.0, 290.0, 50.0, 60.0, 300.0, 0.0, 170.0, 90.0, 320.0, 320.0, 210.0, 120.0, 120.0, 80.0, 20.0, 50.0, 80.0, 110.0, 170.0, 80.0, 50.0, 60.0, 390.0, 110.0, 310.0, 200.0, 120.0, 200.0, 30.0, 200.0, 20.0, 90.0, 30.0, 30.0, 0.0, 210.0, 90.0, 0.0, 80.0, 90.0, 160.0, 50.0, 50.0, 50.0, 0.0, 0.0, 40.0, 150.0, -20.0, 390.0, 20.0, -10.0, 110.0, 30.0, 30.0, 870.0, 170.0, 110.0, 130.0, 230.0, 20.0, 170.0, 30.0, 90.0, 40.0, 40.0, 0.0, 70.0, 160.0, 70.0, 70.0, 30.0, 70.0, 100.0, 80.0, 20.0, 470.0, 120.0, 10.0, 480.0, 10.0, 60.0, 10.0, 30.0, -30.0, 120.0, 80.0, 70.0, 170.0, 20.0, 50.0, 80.0, 20.0, 50.0, 20.0, 130.0, 20.0, 40.0, 10.0, 70.0, 10.0, 20.0, 20.0, 70.0, 30.0, 160.0, 90.0, 190.0, 110.0, -10.0, 30.0, -50.0, 20.0, 400.0, 220.0, 110.0, 10.0, 250.0, -20.0, 120.0, 80.0, 30.0, 280.0, 50.0, 30.0, 120.0, 90.0, 40.0, 70.0, 180.0, 170.0, 130.0, 520.0, 140.0, 120.0, 80.0, 90.0, 0.0, 80.0, 230.0, 70.0, 220.0, 300.0, 70.0, 310.0, 30.0, 340.0, 50.0, 180.0, 190.0, 35.0, 100.0, 90.0, 50.0, 220.0, 330.0, 90.0, 120.0, -40.0, 80.0, 400.0, 30.0, 120.0, 130.0, 50.0, 0.0, 30.0, 0.0, 90.0, 20.0, 50.0, 80.0, 0.0, 80.0, 160.0, 0.0, 30.0, 340.0, 170.0, 130.0, 90.0, 80.0, 140.0, 90.0, 60.0, 160.0, 100.0, 300.0, 60.0, 90.0, 40.0, 250.0, 60.0, 420.0, 60.0, 80.0, 290.0, 120.0, 110.0, 0.0, 40.0, 10.0, 110.0, 20.0, 30.0, 60.0, 20.0, 60.0, 270.0, 250.0, 0.0, 145.0, 170.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 290.0, 90.0, 80.0, 180.0, 40.0, 10.0, 130.0, 70.0, 160.0, 60.0, 20.0, 270.0, 60.0, 120.0, 160.0, 0.0, 190.0, 130.0, 20.0, 30.0, 90.0, 310.0, 180.0, 330.0, 15.0, 210.0, 30.0, 400.0, 30.0, 190.0, 300.0, 110.0, 90.0, 60.0, 300.0, 220.0, 0.0, 40.0, 50.0, 20.0, 150.0, 180.0, 420.0, 220.0, 80.0, 0.0, 190.0, 70.0, 10.0, 10.0, 0.0, 0.0, 100.0, 10.0, 0.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 50.0, 480.0, 20.0, 0.0, 30.0, 220.0, 10.0, 260.0, 240.0, 60.0, 40.0, 160.0, 30.0, 20.0, 30.0, 80.0, 50.0, 40.0, 20.0, 230.0, 70.0, 100.0, 120.0, 230.0, 60.0, 50.0, 510.0, 440.0, 140.0, 240.0, 30.0, 60.0, 0.0, 20.0, 40.0, 190.0, 280.0, 410.0, 160.0, 110.0, 40.0, 30.0, 30.0, 20.0, 60.0, 50.0, 10.0, 40.0, 100.0, 30.0, 30.0, 400.0, 20.0, 200.0, 80.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6740454539135925, "mean_inference_ms": 1.4884297804677769, "mean_action_processing_ms": 0.4274696505334682, "mean_env_wait_ms": 1.3456057720079153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013638734817504883, "StateBufferConnector_ms": 0.010069847106933594, "ViewRequirementAgentConnector_ms": 0.4007563591003418}, "num_episodes": 18, "episode_return_max": 1865.0, "episode_return_min": 200.0, "episode_return_mean": 1033.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.19608468530291, "num_env_steps_trained_throughput_per_sec": 19.19608468530291, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 3360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3360000, "timers": {"training_iteration_time_ms": 208444.847, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208444.8, "sample_time_ms": 2631.891, "learn_time_ms": 205792.653, "learn_throughput": 19.437, "synch_weights_time_ms": 11.05}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "done": false, "training_iteration": 84, "trial_id": "aa996_00000", "date": "2024-05-24_03-37-18", "timestamp": 1716536238, "time_this_iter_s": 208.3920361995697, "time_total_s": 17505.07354092598, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x16003ee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17505.07354092598, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 28.45034013605442, "ram_util_percent": 78.0843537414966}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.473792600473022, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.585172326013811, "policy_loss": -0.007908555051322761, "vf_loss": 6.591929344678966, "vf_explained_var": 0.00019252979463408676, "kl": 0.005757648674694289, "entropy": 0.343672246816821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 793455.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "env_runners": {"episode_reward_max": 1865.0, "episode_reward_min": 200.0, "episode_reward_mean": 1041.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 104.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1550.0, 870.0, 620.0, 1125.0, 1450.0, 850.0, 870.0, 1260.0, 1380.0, 705.0, 930.0, 850.0, 1680.0, 240.0, 1485.0, 1170.0, 1045.0, 1370.0, 1440.0, 560.0, 1050.0, 600.0, 1220.0, 1260.0, 260.0, 1130.0, 1270.0, 1320.0, 645.0, 1310.0, 590.0, 800.0, 890.0, 410.0, 670.0, 1580.0, 825.0, 410.0, 920.0, 450.0, 1390.0, 1865.0, 1040.0, 860.0, 1110.0, 1410.0, 1600.0, 900.0, 520.0, 1740.0, 860.0, 1140.0, 890.0, 630.0, 520.0, 1030.0, 1030.0, 1540.0, 1650.0, 1335.0, 920.0, 510.0, 1360.0, 1650.0, 520.0, 1085.0, 940.0, 1170.0, 1615.0, 1340.0, 1380.0, 200.0, 910.0, 930.0, 970.0, 1670.0, 1190.0, 980.0, 1255.0, 1300.0, 1010.0, 940.0, 1180.0, 440.0, 1420.0, 770.0, 570.0, 910.0, 1140.0, 290.0, 1450.0, 1400.0, 640.0, 735.0, 1155.0, 950.0, 1790.0, 1255.0, 1330.0, 750.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 340.0, 80.0, 120.0, 30.0, 130.0, 430.0, 90.0, 100.0, 140.0, -70.0, 230.0, 20.0, 220.0, 10.0, 220.0, 20.0, 20.0, 70.0, 130.0, 110.0, 10.0, 20.0, 20.0, 60.0, 290.0, 0.0, 30.0, 20.0, 60.0, 450.0, 40.0, 210.0, -40.0, 100.0, 25.0, 50.0, 20.0, 30.0, 240.0, 140.0, -10.0, 210.0, 360.0, 210.0, 30.0, 70.0, -10.0, 40.0, 410.0, 120.0, 10.0, 30.0, 180.0, 60.0, 30.0, 200.0, 170.0, 50.0, 0.0, 20.0, 230.0, 30.0, 40.0, 40.0, -10.0, 200.0, 260.0, 40.0, 20.0, 80.0, 360.0, -50.0, -100.0, 90.0, 180.0, 210.0, 80.0, 370.0, 40.0, 90.0, 610.0, 160.0, 70.0, 60.0, 200.0, 40.0, 80.0, 80.0, -10.0, 0.0, 80.0, 20.0, 35.0, 60.0, 180.0, 40.0, 0.0, 80.0, 210.0, -40.0, 20.0, 90.0, 260.0, -30.0, 190.0, 90.0, 80.0, 110.0, 160.0, 100.0, 50.0, 0.0, 80.0, 10.0, 470.0, -20.0, 110.0, 50.0, 0.0, 30.0, 300.0, 40.0, 60.0, 280.0, 320.0, 380.0, 30.0, 170.0, 70.0, 0.0, 30.0, 30.0, 60.0, 40.0, 10.0, 30.0, -20.0, 10.0, 50.0, 370.0, 280.0, 140.0, 100.0, 200.0, 30.0, 60.0, 140.0, 160.0, 5.0, 100.0, 0.0, 20.0, 170.0, 40.0, 30.0, 390.0, 30.0, 300.0, 90.0, 70.0, 20.0, 210.0, 70.0, 260.0, 110.0, 30.0, 20.0, 5.0, 250.0, 180.0, 50.0, 90.0, 230.0, 100.0, 20.0, 40.0, 70.0, 440.0, 150.0, 20.0, 530.0, 20.0, 170.0, 30.0, 180.0, -20.0, 200.0, 190.0, 120.0, 0.0, 50.0, -50.0, 150.0, 20.0, 60.0, 100.0, 110.0, 40.0, 80.0, 130.0, 150.0, 180.0, 40.0, 180.0, 70.0, 70.0, 0.0, 140.0, 90.0, 50.0, 100.0, 180.0, 110.0, 40.0, 0.0, 70.0, 20.0, 10.0, 20.0, 70.0, 390.0, 130.0, 70.0, 40.0, 70.0, 60.0, 300.0, 0.0, 90.0, 460.0, 120.0, 30.0, 40.0, 60.0, 80.0, 80.0, 20.0, 340.0, 30.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 210.0, 70.0, 30.0, 110.0, 160.0, 130.0, 0.0, 330.0, 40.0, 50.0, 40.0, 30.0, 290.0, 240.0, 40.0, 20.0, 180.0, 320.0, 30.0, 80.0, 90.0, 350.0, 30.0, 100.0, 100.0, 10.0, 120.0, -10.0, 20.0, 510.0, 60.0, -50.0, 40.0, 210.0, -5.0, 30.0, 40.0, 60.0, 30.0, 230.0, 100.0, 20.0, 90.0, 90.0, 0.0, 70.0, 10.0, 530.0, 210.0, 190.0, 30.0, 130.0, 20.0, 40.0, 10.0, 70.0, 160.0, 30.0, 0.0, 100.0, 270.0, 50.0, 30.0, 200.0, 20.0, 60.0, 90.0, 0.0, 10.0, 70.0, 100.0, 20.0, 360.0, 60.0, 130.0, 90.0, 80.0, 50.0, 0.0, 0.0, 30.0, 0.0, 150.0, 10.0, 70.0, 50.0, 50.0, 0.0, 10.0, 40.0, 40.0, 30.0, 80.0, 150.0, 60.0, 220.0, 20.0, 40.0, -10.0, 40.0, 5.0, 450.0, 80.0, 130.0, 200.0, 30.0, 190.0, 20.0, 435.0, 40.0, 70.0, 40.0, 20.0, 50.0, 120.0, 200.0, 210.0, -5.0, 10.0, 110.0, 10.0, 0.0, 40.0, 30.0, 160.0, 30.0, 50.0, 70.0, 0.0, 20.0, 10.0, 70.0, 0.0, 160.0, 40.0, 80.0, 250.0, 120.0, 80.0, 110.0, 20.0, 20.0, 0.0, 40.0, 30.0, 80.0, 30.0, 20.0, 40.0, 170.0, 360.0, -40.0, 60.0, 50.0, 180.0, 90.0, 80.0, 370.0, 10.0, 230.0, 500.0, 60.0, 10.0, 145.0, 150.0, 180.0, 210.0, 500.0, 40.0, 70.0, 30.0, 20.0, 110.0, 360.0, 40.0, -50.0, 40.0, 390.0, 100.0, 0.0, 260.0, -20.0, 190.0, 40.0, 0.0, 20.0, 130.0, 40.0, 190.0, 10.0, 10.0, 90.0, 90.0, 50.0, 290.0, 50.0, 60.0, 300.0, 0.0, 170.0, 90.0, 320.0, 320.0, 210.0, 120.0, 120.0, 80.0, 20.0, 50.0, 80.0, 110.0, 170.0, 80.0, 50.0, 60.0, 390.0, 110.0, 310.0, 200.0, 120.0, 200.0, 30.0, 200.0, 20.0, 90.0, 30.0, 30.0, 0.0, 210.0, 90.0, 0.0, 80.0, 90.0, 160.0, 50.0, 50.0, 50.0, 0.0, 0.0, 40.0, 150.0, -20.0, 390.0, 20.0, -10.0, 110.0, 30.0, 30.0, 870.0, 170.0, 110.0, 130.0, 230.0, 20.0, 170.0, 30.0, 90.0, 40.0, 40.0, 0.0, 70.0, 160.0, 70.0, 70.0, 30.0, 70.0, 100.0, 80.0, 20.0, 470.0, 120.0, 10.0, 480.0, 10.0, 60.0, 10.0, 30.0, -30.0, 120.0, 80.0, 70.0, 170.0, 20.0, 50.0, 80.0, 20.0, 50.0, 20.0, 130.0, 20.0, 40.0, 10.0, 70.0, 10.0, 20.0, 20.0, 70.0, 30.0, 160.0, 90.0, 190.0, 110.0, -10.0, 30.0, -50.0, 20.0, 400.0, 220.0, 110.0, 10.0, 250.0, -20.0, 120.0, 80.0, 30.0, 280.0, 50.0, 30.0, 120.0, 90.0, 40.0, 70.0, 180.0, 170.0, 130.0, 520.0, 140.0, 120.0, 80.0, 90.0, 0.0, 80.0, 230.0, 70.0, 220.0, 300.0, 70.0, 310.0, 30.0, 340.0, 50.0, 180.0, 190.0, 35.0, 100.0, 90.0, 50.0, 220.0, 330.0, 90.0, 120.0, -40.0, 80.0, 400.0, 30.0, 120.0, 130.0, 50.0, 0.0, 30.0, 0.0, 90.0, 20.0, 50.0, 80.0, 0.0, 80.0, 160.0, 0.0, 30.0, 340.0, 170.0, 130.0, 90.0, 80.0, 140.0, 90.0, 60.0, 160.0, 100.0, 300.0, 60.0, 90.0, 40.0, 250.0, 60.0, 420.0, 60.0, 80.0, 290.0, 120.0, 110.0, 0.0, 40.0, 10.0, 110.0, 20.0, 30.0, 60.0, 20.0, 60.0, 270.0, 250.0, 0.0, 145.0, 170.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 290.0, 90.0, 80.0, 180.0, 40.0, 10.0, 130.0, 70.0, 160.0, 60.0, 20.0, 270.0, 60.0, 120.0, 160.0, 0.0, 190.0, 130.0, 20.0, 30.0, 90.0, 310.0, 180.0, 330.0, 15.0, 210.0, 30.0, 400.0, 30.0, 190.0, 300.0, 110.0, 90.0, 60.0, 300.0, 220.0, 0.0, 40.0, 50.0, 20.0, 150.0, 180.0, 420.0, 220.0, 80.0, 0.0, 190.0, 70.0, 10.0, 10.0, 0.0, 0.0, 100.0, 10.0, 0.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 50.0, 480.0, 20.0, 0.0, 30.0, 220.0, 10.0, 260.0, 240.0, 60.0, 40.0, 160.0, 30.0, 20.0, 30.0, 80.0, 50.0, 40.0, 20.0, 230.0, 70.0, 100.0, 120.0, 230.0, 60.0, 50.0, 510.0, 440.0, 140.0, 240.0, 30.0, 60.0, 0.0, 20.0, 40.0, 190.0, 280.0, 410.0, 160.0, 110.0, 40.0, 30.0, 30.0, 20.0, 60.0, 50.0, 10.0, 40.0, 100.0, 30.0, 30.0, 400.0, 20.0, 200.0, 80.0, 70.0, 90.0, 10.0, 190.0, 380.0, -35.0, 150.0, 40.0, 170.0, 200.0, 60.0, 110.0, 60.0, 310.0, 40.0, 70.0, 40.0, 90.0, 30.0, 220.0, 330.0, 130.0, 40.0, 20.0, 20.0, 10.0, 310.0, 400.0, 20.0, 40.0, 20.0, 40.0, 250.0, 160.0, 20.0, 150.0, 90.0, 20.0, 180.0, 40.0, -10.0, 40.0, 140.0, 40.0, 100.0, 180.0, 70.0, 230.0, 120.0, 240.0, 20.0, 20.0, 40.0, 60.0, 60.0, 0.0, 40.0, 40.0, 40.0, 40.0, 100.0, 170.0, 230.0, 170.0, 80.0, 110.0, 60.0, 550.0, 90.0, -160.0, 120.0, 200.0, 10.0, 90.0, 190.0, 120.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 70.0, 300.0, -60.0, 130.0, 40.0, 40.0, 30.0, 0.0, 20.0, 40.0, 40.0, 150.0, 170.0, 80.0, 200.0, 20.0, 30.0, 160.0, 20.0, 110.0, 370.0, 360.0, 50.0, 30.0, 100.0, 150.0, 0.0, 10.0, -40.0, 0.0, 90.0, 20.0, -25.0, 100.0, 20.0, 0.0, 0.0, 5.0, 80.0, 0.0, 50.0, 60.0, 350.0, 10.0, 50.0, 60.0, 270.0, 170.0, 430.0, 30.0, 30.0, 50.0, 80.0, 100.0, 250.0, 60.0, 70.0, 710.0, 20.0, 10.0, 10.0, 70.0, 90.0, 60.0, 30.0, 190.0, 0.0, 110.0, 70.0, 90.0, 10.0, 40.0, 60.0, 290.0, 60.0, 100.0, 20.0, 60.0, 5.0, 590.0, 20.0, 40.0, 50.0, 70.0, 80.0, -5.0, 170.0, 60.0, 80.0, 180.0, 70.0, 10.0, 0.0, 170.0, 140.0, 70.0, 100.0, 120.0, 90.0, 50.0, 110.0, 80.0, 100.0, 500.0, 90.0, 140.0, 30.0, 80.0, 610.0, 370.0, 180.0, 400.0, 90.0, 0.0, 50.0, 100.0, 0.0, 40.0, 25.0, 20.0, 40.0, 430.0, 220.0, 30.0, 50.0, 170.0, 90.0, 160.0, 120.0, 70.0, 80.0, -10.0, 60.0, 470.0, 30.0, 0.0, -10.0, 10.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6732716786035922, "mean_inference_ms": 1.4886602677008722, "mean_action_processing_ms": 0.42721096126564534, "mean_env_wait_ms": 1.3453932484185123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014303207397460938, "StateBufferConnector_ms": 0.010867595672607422, "ViewRequirementAgentConnector_ms": 0.4178452491760254}, "num_episodes": 22, "episode_return_max": 1865.0, "episode_return_min": 200.0, "episode_return_mean": 1041.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.077107366434824, "num_env_steps_trained_throughput_per_sec": 19.077107366434824, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 3400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3400000, "timers": {"training_iteration_time_ms": 208696.252, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208696.204, "sample_time_ms": 2655.428, "learn_time_ms": 206020.594, "learn_throughput": 19.416, "synch_weights_time_ms": 11.08}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "done": false, "training_iteration": 85, "trial_id": "aa996_00000", "date": "2024-05-24_03-40-48", "timestamp": 1716536448, "time_this_iter_s": 209.68678903579712, "time_total_s": 17714.760329961777, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17714.760329961777, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 27.85454545454546, "ram_util_percent": 78.15892255892255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.813232369100451, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.617298515358418, "policy_loss": -0.0074632689333248075, "vf_loss": 6.623475643214834, "vf_explained_var": 0.0006437320043992437, "kl": 0.006430714865205679, "entropy": 0.3368541065305948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 802845.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "env_runners": {"episode_reward_max": 1865.0, "episode_reward_min": 200.0, "episode_reward_mean": 1022.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 102.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1440.0, 560.0, 1050.0, 600.0, 1220.0, 1260.0, 260.0, 1130.0, 1270.0, 1320.0, 645.0, 1310.0, 590.0, 800.0, 890.0, 410.0, 670.0, 1580.0, 825.0, 410.0, 920.0, 450.0, 1390.0, 1865.0, 1040.0, 860.0, 1110.0, 1410.0, 1600.0, 900.0, 520.0, 1740.0, 860.0, 1140.0, 890.0, 630.0, 520.0, 1030.0, 1030.0, 1540.0, 1650.0, 1335.0, 920.0, 510.0, 1360.0, 1650.0, 520.0, 1085.0, 940.0, 1170.0, 1615.0, 1340.0, 1380.0, 200.0, 910.0, 930.0, 970.0, 1670.0, 1190.0, 980.0, 1255.0, 1300.0, 1010.0, 940.0, 1180.0, 440.0, 1420.0, 770.0, 570.0, 910.0, 1140.0, 290.0, 1450.0, 1400.0, 640.0, 735.0, 1155.0, 950.0, 1790.0, 1255.0, 1330.0, 750.0, 1100.0, 980.0, 1220.0, 410.0, 1310.0, 530.0, 1460.0, 1220.0, 780.0, 1430.0, 1060.0, 1240.0, 1180.0, 380.0, 1350.0, 1180.0, 380.0, 310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 530.0, 20.0, 170.0, 30.0, 180.0, -20.0, 200.0, 190.0, 120.0, 0.0, 50.0, -50.0, 150.0, 20.0, 60.0, 100.0, 110.0, 40.0, 80.0, 130.0, 150.0, 180.0, 40.0, 180.0, 70.0, 70.0, 0.0, 140.0, 90.0, 50.0, 100.0, 180.0, 110.0, 40.0, 0.0, 70.0, 20.0, 10.0, 20.0, 70.0, 390.0, 130.0, 70.0, 40.0, 70.0, 60.0, 300.0, 0.0, 90.0, 460.0, 120.0, 30.0, 40.0, 60.0, 80.0, 80.0, 20.0, 340.0, 30.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 210.0, 70.0, 30.0, 110.0, 160.0, 130.0, 0.0, 330.0, 40.0, 50.0, 40.0, 30.0, 290.0, 240.0, 40.0, 20.0, 180.0, 320.0, 30.0, 80.0, 90.0, 350.0, 30.0, 100.0, 100.0, 10.0, 120.0, -10.0, 20.0, 510.0, 60.0, -50.0, 40.0, 210.0, -5.0, 30.0, 40.0, 60.0, 30.0, 230.0, 100.0, 20.0, 90.0, 90.0, 0.0, 70.0, 10.0, 530.0, 210.0, 190.0, 30.0, 130.0, 20.0, 40.0, 10.0, 70.0, 160.0, 30.0, 0.0, 100.0, 270.0, 50.0, 30.0, 200.0, 20.0, 60.0, 90.0, 0.0, 10.0, 70.0, 100.0, 20.0, 360.0, 60.0, 130.0, 90.0, 80.0, 50.0, 0.0, 0.0, 30.0, 0.0, 150.0, 10.0, 70.0, 50.0, 50.0, 0.0, 10.0, 40.0, 40.0, 30.0, 80.0, 150.0, 60.0, 220.0, 20.0, 40.0, -10.0, 40.0, 5.0, 450.0, 80.0, 130.0, 200.0, 30.0, 190.0, 20.0, 435.0, 40.0, 70.0, 40.0, 20.0, 50.0, 120.0, 200.0, 210.0, -5.0, 10.0, 110.0, 10.0, 0.0, 40.0, 30.0, 160.0, 30.0, 50.0, 70.0, 0.0, 20.0, 10.0, 70.0, 0.0, 160.0, 40.0, 80.0, 250.0, 120.0, 80.0, 110.0, 20.0, 20.0, 0.0, 40.0, 30.0, 80.0, 30.0, 20.0, 40.0, 170.0, 360.0, -40.0, 60.0, 50.0, 180.0, 90.0, 80.0, 370.0, 10.0, 230.0, 500.0, 60.0, 10.0, 145.0, 150.0, 180.0, 210.0, 500.0, 40.0, 70.0, 30.0, 20.0, 110.0, 360.0, 40.0, -50.0, 40.0, 390.0, 100.0, 0.0, 260.0, -20.0, 190.0, 40.0, 0.0, 20.0, 130.0, 40.0, 190.0, 10.0, 10.0, 90.0, 90.0, 50.0, 290.0, 50.0, 60.0, 300.0, 0.0, 170.0, 90.0, 320.0, 320.0, 210.0, 120.0, 120.0, 80.0, 20.0, 50.0, 80.0, 110.0, 170.0, 80.0, 50.0, 60.0, 390.0, 110.0, 310.0, 200.0, 120.0, 200.0, 30.0, 200.0, 20.0, 90.0, 30.0, 30.0, 0.0, 210.0, 90.0, 0.0, 80.0, 90.0, 160.0, 50.0, 50.0, 50.0, 0.0, 0.0, 40.0, 150.0, -20.0, 390.0, 20.0, -10.0, 110.0, 30.0, 30.0, 870.0, 170.0, 110.0, 130.0, 230.0, 20.0, 170.0, 30.0, 90.0, 40.0, 40.0, 0.0, 70.0, 160.0, 70.0, 70.0, 30.0, 70.0, 100.0, 80.0, 20.0, 470.0, 120.0, 10.0, 480.0, 10.0, 60.0, 10.0, 30.0, -30.0, 120.0, 80.0, 70.0, 170.0, 20.0, 50.0, 80.0, 20.0, 50.0, 20.0, 130.0, 20.0, 40.0, 10.0, 70.0, 10.0, 20.0, 20.0, 70.0, 30.0, 160.0, 90.0, 190.0, 110.0, -10.0, 30.0, -50.0, 20.0, 400.0, 220.0, 110.0, 10.0, 250.0, -20.0, 120.0, 80.0, 30.0, 280.0, 50.0, 30.0, 120.0, 90.0, 40.0, 70.0, 180.0, 170.0, 130.0, 520.0, 140.0, 120.0, 80.0, 90.0, 0.0, 80.0, 230.0, 70.0, 220.0, 300.0, 70.0, 310.0, 30.0, 340.0, 50.0, 180.0, 190.0, 35.0, 100.0, 90.0, 50.0, 220.0, 330.0, 90.0, 120.0, -40.0, 80.0, 400.0, 30.0, 120.0, 130.0, 50.0, 0.0, 30.0, 0.0, 90.0, 20.0, 50.0, 80.0, 0.0, 80.0, 160.0, 0.0, 30.0, 340.0, 170.0, 130.0, 90.0, 80.0, 140.0, 90.0, 60.0, 160.0, 100.0, 300.0, 60.0, 90.0, 40.0, 250.0, 60.0, 420.0, 60.0, 80.0, 290.0, 120.0, 110.0, 0.0, 40.0, 10.0, 110.0, 20.0, 30.0, 60.0, 20.0, 60.0, 270.0, 250.0, 0.0, 145.0, 170.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 290.0, 90.0, 80.0, 180.0, 40.0, 10.0, 130.0, 70.0, 160.0, 60.0, 20.0, 270.0, 60.0, 120.0, 160.0, 0.0, 190.0, 130.0, 20.0, 30.0, 90.0, 310.0, 180.0, 330.0, 15.0, 210.0, 30.0, 400.0, 30.0, 190.0, 300.0, 110.0, 90.0, 60.0, 300.0, 220.0, 0.0, 40.0, 50.0, 20.0, 150.0, 180.0, 420.0, 220.0, 80.0, 0.0, 190.0, 70.0, 10.0, 10.0, 0.0, 0.0, 100.0, 10.0, 0.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 50.0, 480.0, 20.0, 0.0, 30.0, 220.0, 10.0, 260.0, 240.0, 60.0, 40.0, 160.0, 30.0, 20.0, 30.0, 80.0, 50.0, 40.0, 20.0, 230.0, 70.0, 100.0, 120.0, 230.0, 60.0, 50.0, 510.0, 440.0, 140.0, 240.0, 30.0, 60.0, 0.0, 20.0, 40.0, 190.0, 280.0, 410.0, 160.0, 110.0, 40.0, 30.0, 30.0, 20.0, 60.0, 50.0, 10.0, 40.0, 100.0, 30.0, 30.0, 400.0, 20.0, 200.0, 80.0, 70.0, 90.0, 10.0, 190.0, 380.0, -35.0, 150.0, 40.0, 170.0, 200.0, 60.0, 110.0, 60.0, 310.0, 40.0, 70.0, 40.0, 90.0, 30.0, 220.0, 330.0, 130.0, 40.0, 20.0, 20.0, 10.0, 310.0, 400.0, 20.0, 40.0, 20.0, 40.0, 250.0, 160.0, 20.0, 150.0, 90.0, 20.0, 180.0, 40.0, -10.0, 40.0, 140.0, 40.0, 100.0, 180.0, 70.0, 230.0, 120.0, 240.0, 20.0, 20.0, 40.0, 60.0, 60.0, 0.0, 40.0, 40.0, 40.0, 40.0, 100.0, 170.0, 230.0, 170.0, 80.0, 110.0, 60.0, 550.0, 90.0, -160.0, 120.0, 200.0, 10.0, 90.0, 190.0, 120.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 70.0, 300.0, -60.0, 130.0, 40.0, 40.0, 30.0, 0.0, 20.0, 40.0, 40.0, 150.0, 170.0, 80.0, 200.0, 20.0, 30.0, 160.0, 20.0, 110.0, 370.0, 360.0, 50.0, 30.0, 100.0, 150.0, 0.0, 10.0, -40.0, 0.0, 90.0, 20.0, -25.0, 100.0, 20.0, 0.0, 0.0, 5.0, 80.0, 0.0, 50.0, 60.0, 350.0, 10.0, 50.0, 60.0, 270.0, 170.0, 430.0, 30.0, 30.0, 50.0, 80.0, 100.0, 250.0, 60.0, 70.0, 710.0, 20.0, 10.0, 10.0, 70.0, 90.0, 60.0, 30.0, 190.0, 0.0, 110.0, 70.0, 90.0, 10.0, 40.0, 60.0, 290.0, 60.0, 100.0, 20.0, 60.0, 5.0, 590.0, 20.0, 40.0, 50.0, 70.0, 80.0, -5.0, 170.0, 60.0, 80.0, 180.0, 70.0, 10.0, 0.0, 170.0, 140.0, 70.0, 100.0, 120.0, 90.0, 50.0, 110.0, 80.0, 100.0, 500.0, 90.0, 140.0, 30.0, 80.0, 610.0, 370.0, 180.0, 400.0, 90.0, 0.0, 50.0, 100.0, 0.0, 40.0, 25.0, 20.0, 40.0, 430.0, 220.0, 30.0, 50.0, 170.0, 90.0, 160.0, 120.0, 70.0, 80.0, -10.0, 60.0, 470.0, 30.0, 0.0, -10.0, 10.0, 50.0, 60.0, -90.0, 20.0, 300.0, 60.0, 100.0, 400.0, 20.0, 130.0, 100.0, 70.0, 20.0, 20.0, 50.0, 60.0, 30.0, 40.0, 190.0, 330.0, 170.0, 170.0, 50.0, 280.0, 80.0, 160.0, 120.0, 160.0, 40.0, 100.0, 60.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 260.0, 450.0, 120.0, 160.0, 20.0, 40.0, 20.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 20.0, 10.0, 0.0, 80.0, 20.0, 160.0, 0.0, 10.0, 70.0, 80.0, 100.0, 170.0, 60.0, 10.0, 40.0, 400.0, 340.0, 190.0, 160.0, 40.0, 230.0, 30.0, 210.0, 150.0, 30.0, 310.0, 0.0, 60.0, 110.0, 20.0, 0.0, 210.0, 10.0, 10.0, 180.0, 190.0, 30.0, 20.0, 210.0, 200.0, 310.0, 130.0, 60.0, 220.0, 70.0, 70.0, 130.0, 30.0, 110.0, 50.0, 60.0, 280.0, 330.0, 70.0, 50.0, 50.0, 40.0, 20.0, 20.0, 200.0, 10.0, 140.0, 220.0, 380.0, 100.0, 10.0, 60.0, 100.0, 0.0, 310.0, 120.0, 130.0, 150.0, 100.0, 50.0, 110.0, 20.0, 190.0, 10.0, 0.0, 40.0, 60.0, 0.0, 50.0, 0.0, 20.0, 20.0, 180.0, 130.0, 270.0, 40.0, 30.0, 300.0, 10.0, 110.0, 130.0, 300.0, 30.0, 30.0, 15.0, 270.0, 470.0, 15.0, 70.0, 110.0, 80.0, 120.0, 0.0, 40.0, 20.0, 10.0, 170.0, 0.0, 40.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 30.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6728638611594746, "mean_inference_ms": 1.4889249944689589, "mean_action_processing_ms": 0.42702381828589403, "mean_env_wait_ms": 1.3452719954582641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014371395111083984, "StateBufferConnector_ms": 0.011577844619750977, "ViewRequirementAgentConnector_ms": 0.4311087131500244}, "num_episodes": 18, "episode_return_max": 1865.0, "episode_return_min": 200.0, "episode_return_mean": 1022.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.09261434284319, "num_env_steps_trained_throughput_per_sec": 19.09261434284319, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 3440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3440000, "timers": {"training_iteration_time_ms": 208379.376, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208379.328, "sample_time_ms": 2668.825, "learn_time_ms": 205690.075, "learn_throughput": 19.447, "synch_weights_time_ms": 11.289}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "done": false, "training_iteration": 86, "trial_id": "aa996_00000", "date": "2024-05-24_03-44-17", "timestamp": 1716536657, "time_this_iter_s": 209.51304602622986, "time_total_s": 17924.273375988007, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17924.273375988007, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 27.237162162162164, "ram_util_percent": 78.47702702702702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7752828348305023, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.81016718455143, "policy_loss": -0.0069495698075450925, "vf_loss": 6.815969169482637, "vf_explained_var": 0.0006555289315720335, "kl": 0.00573794894057111, "entropy": 0.33942667250784314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 812235.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "env_runners": {"episode_reward_max": 1865.0, "episode_reward_min": 200.0, "episode_reward_mean": 1024.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 102.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1865.0, 1040.0, 860.0, 1110.0, 1410.0, 1600.0, 900.0, 520.0, 1740.0, 860.0, 1140.0, 890.0, 630.0, 520.0, 1030.0, 1030.0, 1540.0, 1650.0, 1335.0, 920.0, 510.0, 1360.0, 1650.0, 520.0, 1085.0, 940.0, 1170.0, 1615.0, 1340.0, 1380.0, 200.0, 910.0, 930.0, 970.0, 1670.0, 1190.0, 980.0, 1255.0, 1300.0, 1010.0, 940.0, 1180.0, 440.0, 1420.0, 770.0, 570.0, 910.0, 1140.0, 290.0, 1450.0, 1400.0, 640.0, 735.0, 1155.0, 950.0, 1790.0, 1255.0, 1330.0, 750.0, 1100.0, 980.0, 1220.0, 410.0, 1310.0, 530.0, 1460.0, 1220.0, 780.0, 1430.0, 1060.0, 1240.0, 1180.0, 380.0, 1350.0, 1180.0, 380.0, 310.0, 240.0, 620.0, 1190.0, 450.0, 1540.0, 1165.0, 440.0, 590.0, 1120.0, 930.0, 1040.0, 1150.0, 1330.0, 430.0, 1240.0, 1110.0, 1350.0, 400.0, 1130.0, 1550.0, 440.0, 850.0, 955.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [500.0, 60.0, 10.0, 145.0, 150.0, 180.0, 210.0, 500.0, 40.0, 70.0, 30.0, 20.0, 110.0, 360.0, 40.0, -50.0, 40.0, 390.0, 100.0, 0.0, 260.0, -20.0, 190.0, 40.0, 0.0, 20.0, 130.0, 40.0, 190.0, 10.0, 10.0, 90.0, 90.0, 50.0, 290.0, 50.0, 60.0, 300.0, 0.0, 170.0, 90.0, 320.0, 320.0, 210.0, 120.0, 120.0, 80.0, 20.0, 50.0, 80.0, 110.0, 170.0, 80.0, 50.0, 60.0, 390.0, 110.0, 310.0, 200.0, 120.0, 200.0, 30.0, 200.0, 20.0, 90.0, 30.0, 30.0, 0.0, 210.0, 90.0, 0.0, 80.0, 90.0, 160.0, 50.0, 50.0, 50.0, 0.0, 0.0, 40.0, 150.0, -20.0, 390.0, 20.0, -10.0, 110.0, 30.0, 30.0, 870.0, 170.0, 110.0, 130.0, 230.0, 20.0, 170.0, 30.0, 90.0, 40.0, 40.0, 0.0, 70.0, 160.0, 70.0, 70.0, 30.0, 70.0, 100.0, 80.0, 20.0, 470.0, 120.0, 10.0, 480.0, 10.0, 60.0, 10.0, 30.0, -30.0, 120.0, 80.0, 70.0, 170.0, 20.0, 50.0, 80.0, 20.0, 50.0, 20.0, 130.0, 20.0, 40.0, 10.0, 70.0, 10.0, 20.0, 20.0, 70.0, 30.0, 160.0, 90.0, 190.0, 110.0, -10.0, 30.0, -50.0, 20.0, 400.0, 220.0, 110.0, 10.0, 250.0, -20.0, 120.0, 80.0, 30.0, 280.0, 50.0, 30.0, 120.0, 90.0, 40.0, 70.0, 180.0, 170.0, 130.0, 520.0, 140.0, 120.0, 80.0, 90.0, 0.0, 80.0, 230.0, 70.0, 220.0, 300.0, 70.0, 310.0, 30.0, 340.0, 50.0, 180.0, 190.0, 35.0, 100.0, 90.0, 50.0, 220.0, 330.0, 90.0, 120.0, -40.0, 80.0, 400.0, 30.0, 120.0, 130.0, 50.0, 0.0, 30.0, 0.0, 90.0, 20.0, 50.0, 80.0, 0.0, 80.0, 160.0, 0.0, 30.0, 340.0, 170.0, 130.0, 90.0, 80.0, 140.0, 90.0, 60.0, 160.0, 100.0, 300.0, 60.0, 90.0, 40.0, 250.0, 60.0, 420.0, 60.0, 80.0, 290.0, 120.0, 110.0, 0.0, 40.0, 10.0, 110.0, 20.0, 30.0, 60.0, 20.0, 60.0, 270.0, 250.0, 0.0, 145.0, 170.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 290.0, 90.0, 80.0, 180.0, 40.0, 10.0, 130.0, 70.0, 160.0, 60.0, 20.0, 270.0, 60.0, 120.0, 160.0, 0.0, 190.0, 130.0, 20.0, 30.0, 90.0, 310.0, 180.0, 330.0, 15.0, 210.0, 30.0, 400.0, 30.0, 190.0, 300.0, 110.0, 90.0, 60.0, 300.0, 220.0, 0.0, 40.0, 50.0, 20.0, 150.0, 180.0, 420.0, 220.0, 80.0, 0.0, 190.0, 70.0, 10.0, 10.0, 0.0, 0.0, 100.0, 10.0, 0.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 50.0, 480.0, 20.0, 0.0, 30.0, 220.0, 10.0, 260.0, 240.0, 60.0, 40.0, 160.0, 30.0, 20.0, 30.0, 80.0, 50.0, 40.0, 20.0, 230.0, 70.0, 100.0, 120.0, 230.0, 60.0, 50.0, 510.0, 440.0, 140.0, 240.0, 30.0, 60.0, 0.0, 20.0, 40.0, 190.0, 280.0, 410.0, 160.0, 110.0, 40.0, 30.0, 30.0, 20.0, 60.0, 50.0, 10.0, 40.0, 100.0, 30.0, 30.0, 400.0, 20.0, 200.0, 80.0, 70.0, 90.0, 10.0, 190.0, 380.0, -35.0, 150.0, 40.0, 170.0, 200.0, 60.0, 110.0, 60.0, 310.0, 40.0, 70.0, 40.0, 90.0, 30.0, 220.0, 330.0, 130.0, 40.0, 20.0, 20.0, 10.0, 310.0, 400.0, 20.0, 40.0, 20.0, 40.0, 250.0, 160.0, 20.0, 150.0, 90.0, 20.0, 180.0, 40.0, -10.0, 40.0, 140.0, 40.0, 100.0, 180.0, 70.0, 230.0, 120.0, 240.0, 20.0, 20.0, 40.0, 60.0, 60.0, 0.0, 40.0, 40.0, 40.0, 40.0, 100.0, 170.0, 230.0, 170.0, 80.0, 110.0, 60.0, 550.0, 90.0, -160.0, 120.0, 200.0, 10.0, 90.0, 190.0, 120.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 70.0, 300.0, -60.0, 130.0, 40.0, 40.0, 30.0, 0.0, 20.0, 40.0, 40.0, 150.0, 170.0, 80.0, 200.0, 20.0, 30.0, 160.0, 20.0, 110.0, 370.0, 360.0, 50.0, 30.0, 100.0, 150.0, 0.0, 10.0, -40.0, 0.0, 90.0, 20.0, -25.0, 100.0, 20.0, 0.0, 0.0, 5.0, 80.0, 0.0, 50.0, 60.0, 350.0, 10.0, 50.0, 60.0, 270.0, 170.0, 430.0, 30.0, 30.0, 50.0, 80.0, 100.0, 250.0, 60.0, 70.0, 710.0, 20.0, 10.0, 10.0, 70.0, 90.0, 60.0, 30.0, 190.0, 0.0, 110.0, 70.0, 90.0, 10.0, 40.0, 60.0, 290.0, 60.0, 100.0, 20.0, 60.0, 5.0, 590.0, 20.0, 40.0, 50.0, 70.0, 80.0, -5.0, 170.0, 60.0, 80.0, 180.0, 70.0, 10.0, 0.0, 170.0, 140.0, 70.0, 100.0, 120.0, 90.0, 50.0, 110.0, 80.0, 100.0, 500.0, 90.0, 140.0, 30.0, 80.0, 610.0, 370.0, 180.0, 400.0, 90.0, 0.0, 50.0, 100.0, 0.0, 40.0, 25.0, 20.0, 40.0, 430.0, 220.0, 30.0, 50.0, 170.0, 90.0, 160.0, 120.0, 70.0, 80.0, -10.0, 60.0, 470.0, 30.0, 0.0, -10.0, 10.0, 50.0, 60.0, -90.0, 20.0, 300.0, 60.0, 100.0, 400.0, 20.0, 130.0, 100.0, 70.0, 20.0, 20.0, 50.0, 60.0, 30.0, 40.0, 190.0, 330.0, 170.0, 170.0, 50.0, 280.0, 80.0, 160.0, 120.0, 160.0, 40.0, 100.0, 60.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 260.0, 450.0, 120.0, 160.0, 20.0, 40.0, 20.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 20.0, 10.0, 0.0, 80.0, 20.0, 160.0, 0.0, 10.0, 70.0, 80.0, 100.0, 170.0, 60.0, 10.0, 40.0, 400.0, 340.0, 190.0, 160.0, 40.0, 230.0, 30.0, 210.0, 150.0, 30.0, 310.0, 0.0, 60.0, 110.0, 20.0, 0.0, 210.0, 10.0, 10.0, 180.0, 190.0, 30.0, 20.0, 210.0, 200.0, 310.0, 130.0, 60.0, 220.0, 70.0, 70.0, 130.0, 30.0, 110.0, 50.0, 60.0, 280.0, 330.0, 70.0, 50.0, 50.0, 40.0, 20.0, 20.0, 200.0, 10.0, 140.0, 220.0, 380.0, 100.0, 10.0, 60.0, 100.0, 0.0, 310.0, 120.0, 130.0, 150.0, 100.0, 50.0, 110.0, 20.0, 190.0, 10.0, 0.0, 40.0, 60.0, 0.0, 50.0, 0.0, 20.0, 20.0, 180.0, 130.0, 270.0, 40.0, 30.0, 300.0, 10.0, 110.0, 130.0, 300.0, 30.0, 30.0, 15.0, 270.0, 470.0, 15.0, 70.0, 110.0, 80.0, 120.0, 0.0, 40.0, 20.0, 10.0, 170.0, 0.0, 40.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 30.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 40.0, 50.0, 20.0, 20.0, 10.0, 30.0, 20.0, 40.0, 10.0, 0.0, 10.0, 80.0, 70.0, 230.0, 0.0, 10.0, 10.0, 30.0, 10.0, 170.0, 50.0, 40.0, 270.0, 100.0, 160.0, 20.0, 170.0, 120.0, 80.0, 180.0, 80.0, 40.0, 140.0, 60.0, 20.0, 50.0, 0.0, 20.0, 30.0, 10.0, 250.0, 120.0, 210.0, 140.0, 220.0, 50.0, 70.0, 220.0, 150.0, 110.0, 40.0, 210.0, 565.0, -10.0, 30.0, -30.0, 60.0, 150.0, 40.0, 110.0, 10.0, 10.0, 0.0, 270.0, 0.0, 30.0, 20.0, 20.0, 0.0, 80.0, 30.0, 10.0, 260.0, 20.0, 40.0, 50.0, 100.0, 40.0, 20.0, 20.0, 180.0, 220.0, 90.0, 140.0, 80.0, 180.0, 160.0, 20.0, 20.0, 30.0, 50.0, 70.0, 240.0, 30.0, 150.0, 0.0, 100.0, 230.0, 20.0, 40.0, 370.0, 30.0, 180.0, 0.0, 70.0, 70.0, 100.0, 30.0, 20.0, 170.0, 40.0, 370.0, 20.0, 350.0, 10.0, 230.0, 10.0, 80.0, 20.0, 20.0, 60.0, 40.0, 140.0, 70.0, 170.0, 60.0, 300.0, 310.0, 110.0, 70.0, 20.0, 150.0, 40.0, 20.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 180.0, 280.0, 100.0, 160.0, 10.0, 180.0, 130.0, 40.0, 50.0, 110.0, 380.0, 130.0, 30.0, 180.0, 80.0, 30.0, 70.0, 40.0, 100.0, 70.0, 50.0, 590.0, 60.0, 30.0, 90.0, 60.0, 100.0, 40.0, 310.0, 20.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 40.0, 60.0, 30.0, 130.0, 90.0, 410.0, 30.0, 0.0, 80.0, 20.0, 110.0, 70.0, 80.0, 240.0, 110.0, 70.0, 30.0, 50.0, 350.0, 70.0, 50.0, 140.0, 490.0, 190.0, 70.0, 70.0, 20.0, 30.0, 50.0, 40.0, 0.0, 30.0, 120.0, 10.0, 20.0, 100.0, 70.0, 30.0, 40.0, 10.0, 30.0, 90.0, 20.0, 440.0, 140.0, 60.0, 10.0, -15.0, -20.0, 260.0, 380.0, -40.0, -40.0, 220.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6725112048266684, "mean_inference_ms": 1.4892953493100065, "mean_action_processing_ms": 0.4268255450041927, "mean_env_wait_ms": 1.3452079894238553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014495849609375, "StateBufferConnector_ms": 0.01200556755065918, "ViewRequirementAgentConnector_ms": 0.43771815299987793}, "num_episodes": 23, "episode_return_max": 1865.0, "episode_return_min": 200.0, "episode_return_mean": 1024.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.132879090472525, "num_env_steps_trained_throughput_per_sec": 19.132879090472525, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 3480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3480000, "timers": {"training_iteration_time_ms": 208566.731, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208566.683, "sample_time_ms": 2662.042, "learn_time_ms": 205883.936, "learn_throughput": 19.428, "synch_weights_time_ms": 11.825}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "done": false, "training_iteration": 87, "trial_id": "aa996_00000", "date": "2024-05-24_03-47-46", "timestamp": 1716536866, "time_this_iter_s": 209.09784078598022, "time_total_s": 18133.371216773987, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332db74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18133.371216773987, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 27.137500000000003, "ram_util_percent": 78.16216216216216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6492845397343396, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.430521303548599, "policy_loss": -0.007539106938302124, "vf_loss": 6.436860713410302, "vf_explained_var": -0.0003673338598082749, "kl": 0.0059984590961919245, "entropy": 0.3500089956072573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 821625.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 200.0, "episode_reward_mean": 975.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 97.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1335.0, 920.0, 510.0, 1360.0, 1650.0, 520.0, 1085.0, 940.0, 1170.0, 1615.0, 1340.0, 1380.0, 200.0, 910.0, 930.0, 970.0, 1670.0, 1190.0, 980.0, 1255.0, 1300.0, 1010.0, 940.0, 1180.0, 440.0, 1420.0, 770.0, 570.0, 910.0, 1140.0, 290.0, 1450.0, 1400.0, 640.0, 735.0, 1155.0, 950.0, 1790.0, 1255.0, 1330.0, 750.0, 1100.0, 980.0, 1220.0, 410.0, 1310.0, 530.0, 1460.0, 1220.0, 780.0, 1430.0, 1060.0, 1240.0, 1180.0, 380.0, 1350.0, 1180.0, 380.0, 310.0, 240.0, 620.0, 1190.0, 450.0, 1540.0, 1165.0, 440.0, 590.0, 1120.0, 930.0, 1040.0, 1150.0, 1330.0, 430.0, 1240.0, 1110.0, 1350.0, 400.0, 1130.0, 1550.0, 440.0, 850.0, 955.0, 460.0, 940.0, 520.0, 1150.0, 690.0, 790.0, 900.0, 615.0, 890.0, 820.0, 1050.0, 530.0, 360.0, 1270.0, 1140.0, 1190.0, 970.0, 1120.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 180.0, 190.0, 35.0, 100.0, 90.0, 50.0, 220.0, 330.0, 90.0, 120.0, -40.0, 80.0, 400.0, 30.0, 120.0, 130.0, 50.0, 0.0, 30.0, 0.0, 90.0, 20.0, 50.0, 80.0, 0.0, 80.0, 160.0, 0.0, 30.0, 340.0, 170.0, 130.0, 90.0, 80.0, 140.0, 90.0, 60.0, 160.0, 100.0, 300.0, 60.0, 90.0, 40.0, 250.0, 60.0, 420.0, 60.0, 80.0, 290.0, 120.0, 110.0, 0.0, 40.0, 10.0, 110.0, 20.0, 30.0, 60.0, 20.0, 60.0, 270.0, 250.0, 0.0, 145.0, 170.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 290.0, 90.0, 80.0, 180.0, 40.0, 10.0, 130.0, 70.0, 160.0, 60.0, 20.0, 270.0, 60.0, 120.0, 160.0, 0.0, 190.0, 130.0, 20.0, 30.0, 90.0, 310.0, 180.0, 330.0, 15.0, 210.0, 30.0, 400.0, 30.0, 190.0, 300.0, 110.0, 90.0, 60.0, 300.0, 220.0, 0.0, 40.0, 50.0, 20.0, 150.0, 180.0, 420.0, 220.0, 80.0, 0.0, 190.0, 70.0, 10.0, 10.0, 0.0, 0.0, 100.0, 10.0, 0.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 30.0, 50.0, 480.0, 20.0, 0.0, 30.0, 220.0, 10.0, 260.0, 240.0, 60.0, 40.0, 160.0, 30.0, 20.0, 30.0, 80.0, 50.0, 40.0, 20.0, 230.0, 70.0, 100.0, 120.0, 230.0, 60.0, 50.0, 510.0, 440.0, 140.0, 240.0, 30.0, 60.0, 0.0, 20.0, 40.0, 190.0, 280.0, 410.0, 160.0, 110.0, 40.0, 30.0, 30.0, 20.0, 60.0, 50.0, 10.0, 40.0, 100.0, 30.0, 30.0, 400.0, 20.0, 200.0, 80.0, 70.0, 90.0, 10.0, 190.0, 380.0, -35.0, 150.0, 40.0, 170.0, 200.0, 60.0, 110.0, 60.0, 310.0, 40.0, 70.0, 40.0, 90.0, 30.0, 220.0, 330.0, 130.0, 40.0, 20.0, 20.0, 10.0, 310.0, 400.0, 20.0, 40.0, 20.0, 40.0, 250.0, 160.0, 20.0, 150.0, 90.0, 20.0, 180.0, 40.0, -10.0, 40.0, 140.0, 40.0, 100.0, 180.0, 70.0, 230.0, 120.0, 240.0, 20.0, 20.0, 40.0, 60.0, 60.0, 0.0, 40.0, 40.0, 40.0, 40.0, 100.0, 170.0, 230.0, 170.0, 80.0, 110.0, 60.0, 550.0, 90.0, -160.0, 120.0, 200.0, 10.0, 90.0, 190.0, 120.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 70.0, 300.0, -60.0, 130.0, 40.0, 40.0, 30.0, 0.0, 20.0, 40.0, 40.0, 150.0, 170.0, 80.0, 200.0, 20.0, 30.0, 160.0, 20.0, 110.0, 370.0, 360.0, 50.0, 30.0, 100.0, 150.0, 0.0, 10.0, -40.0, 0.0, 90.0, 20.0, -25.0, 100.0, 20.0, 0.0, 0.0, 5.0, 80.0, 0.0, 50.0, 60.0, 350.0, 10.0, 50.0, 60.0, 270.0, 170.0, 430.0, 30.0, 30.0, 50.0, 80.0, 100.0, 250.0, 60.0, 70.0, 710.0, 20.0, 10.0, 10.0, 70.0, 90.0, 60.0, 30.0, 190.0, 0.0, 110.0, 70.0, 90.0, 10.0, 40.0, 60.0, 290.0, 60.0, 100.0, 20.0, 60.0, 5.0, 590.0, 20.0, 40.0, 50.0, 70.0, 80.0, -5.0, 170.0, 60.0, 80.0, 180.0, 70.0, 10.0, 0.0, 170.0, 140.0, 70.0, 100.0, 120.0, 90.0, 50.0, 110.0, 80.0, 100.0, 500.0, 90.0, 140.0, 30.0, 80.0, 610.0, 370.0, 180.0, 400.0, 90.0, 0.0, 50.0, 100.0, 0.0, 40.0, 25.0, 20.0, 40.0, 430.0, 220.0, 30.0, 50.0, 170.0, 90.0, 160.0, 120.0, 70.0, 80.0, -10.0, 60.0, 470.0, 30.0, 0.0, -10.0, 10.0, 50.0, 60.0, -90.0, 20.0, 300.0, 60.0, 100.0, 400.0, 20.0, 130.0, 100.0, 70.0, 20.0, 20.0, 50.0, 60.0, 30.0, 40.0, 190.0, 330.0, 170.0, 170.0, 50.0, 280.0, 80.0, 160.0, 120.0, 160.0, 40.0, 100.0, 60.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 260.0, 450.0, 120.0, 160.0, 20.0, 40.0, 20.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 20.0, 10.0, 0.0, 80.0, 20.0, 160.0, 0.0, 10.0, 70.0, 80.0, 100.0, 170.0, 60.0, 10.0, 40.0, 400.0, 340.0, 190.0, 160.0, 40.0, 230.0, 30.0, 210.0, 150.0, 30.0, 310.0, 0.0, 60.0, 110.0, 20.0, 0.0, 210.0, 10.0, 10.0, 180.0, 190.0, 30.0, 20.0, 210.0, 200.0, 310.0, 130.0, 60.0, 220.0, 70.0, 70.0, 130.0, 30.0, 110.0, 50.0, 60.0, 280.0, 330.0, 70.0, 50.0, 50.0, 40.0, 20.0, 20.0, 200.0, 10.0, 140.0, 220.0, 380.0, 100.0, 10.0, 60.0, 100.0, 0.0, 310.0, 120.0, 130.0, 150.0, 100.0, 50.0, 110.0, 20.0, 190.0, 10.0, 0.0, 40.0, 60.0, 0.0, 50.0, 0.0, 20.0, 20.0, 180.0, 130.0, 270.0, 40.0, 30.0, 300.0, 10.0, 110.0, 130.0, 300.0, 30.0, 30.0, 15.0, 270.0, 470.0, 15.0, 70.0, 110.0, 80.0, 120.0, 0.0, 40.0, 20.0, 10.0, 170.0, 0.0, 40.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 30.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 40.0, 50.0, 20.0, 20.0, 10.0, 30.0, 20.0, 40.0, 10.0, 0.0, 10.0, 80.0, 70.0, 230.0, 0.0, 10.0, 10.0, 30.0, 10.0, 170.0, 50.0, 40.0, 270.0, 100.0, 160.0, 20.0, 170.0, 120.0, 80.0, 180.0, 80.0, 40.0, 140.0, 60.0, 20.0, 50.0, 0.0, 20.0, 30.0, 10.0, 250.0, 120.0, 210.0, 140.0, 220.0, 50.0, 70.0, 220.0, 150.0, 110.0, 40.0, 210.0, 565.0, -10.0, 30.0, -30.0, 60.0, 150.0, 40.0, 110.0, 10.0, 10.0, 0.0, 270.0, 0.0, 30.0, 20.0, 20.0, 0.0, 80.0, 30.0, 10.0, 260.0, 20.0, 40.0, 50.0, 100.0, 40.0, 20.0, 20.0, 180.0, 220.0, 90.0, 140.0, 80.0, 180.0, 160.0, 20.0, 20.0, 30.0, 50.0, 70.0, 240.0, 30.0, 150.0, 0.0, 100.0, 230.0, 20.0, 40.0, 370.0, 30.0, 180.0, 0.0, 70.0, 70.0, 100.0, 30.0, 20.0, 170.0, 40.0, 370.0, 20.0, 350.0, 10.0, 230.0, 10.0, 80.0, 20.0, 20.0, 60.0, 40.0, 140.0, 70.0, 170.0, 60.0, 300.0, 310.0, 110.0, 70.0, 20.0, 150.0, 40.0, 20.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 180.0, 280.0, 100.0, 160.0, 10.0, 180.0, 130.0, 40.0, 50.0, 110.0, 380.0, 130.0, 30.0, 180.0, 80.0, 30.0, 70.0, 40.0, 100.0, 70.0, 50.0, 590.0, 60.0, 30.0, 90.0, 60.0, 100.0, 40.0, 310.0, 20.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 40.0, 60.0, 30.0, 130.0, 90.0, 410.0, 30.0, 0.0, 80.0, 20.0, 110.0, 70.0, 80.0, 240.0, 110.0, 70.0, 30.0, 50.0, 350.0, 70.0, 50.0, 140.0, 490.0, 190.0, 70.0, 70.0, 20.0, 30.0, 50.0, 40.0, 0.0, 30.0, 120.0, 10.0, 20.0, 100.0, 70.0, 30.0, 40.0, 10.0, 30.0, 90.0, 20.0, 440.0, 140.0, 60.0, 10.0, -15.0, -20.0, 260.0, 380.0, -40.0, -40.0, 220.0, 10.0, 50.0, 170.0, 290.0, 10.0, -50.0, -210.0, 90.0, 20.0, 80.0, 80.0, 570.0, 180.0, 60.0, -30.0, -30.0, 50.0, 70.0, 60.0, -70.0, 50.0, 160.0, 50.0, 40.0, 0.0, 0.0, 30.0, 170.0, 0.0, 20.0, 30.0, 20.0, 170.0, 50.0, 470.0, 130.0, 40.0, 160.0, -20.0, 100.0, 10.0, 20.0, 110.0, 0.0, 70.0, 40.0, 10.0, 20.0, 190.0, 220.0, -60.0, 20.0, 300.0, 40.0, 10.0, 220.0, 10.0, 50.0, 100.0, 100.0, 170.0, 50.0, 20.0, 210.0, 20.0, 30.0, 60.0, 0.0, 10.0, 330.0, 0.0, 20.0, 10.0, 40.0, 220.0, 20.0, -5.0, 210.0, 10.0, 90.0, 190.0, 10.0, 160.0, 100.0, 50.0, 300.0, 20.0, 40.0, 0.0, 20.0, 50.0, 120.0, 340.0, 120.0, 10.0, 110.0, 10.0, 20.0, 0.0, 40.0, 290.0, 20.0, 40.0, 70.0, 40.0, 60.0, 70.0, 390.0, -30.0, 100.0, 40.0, 40.0, 0.0, 80.0, 0.0, 30.0, 40.0, 30.0, 250.0, 20.0, 20.0, 10.0, 20.0, 10.0, 110.0, 40.0, 80.0, 70.0, 0.0, 0.0, 310.0, 180.0, 50.0, 40.0, 60.0, 50.0, 60.0, 190.0, 220.0, 110.0, 0.0, 60.0, 20.0, 0.0, 160.0, -40.0, 310.0, 550.0, 20.0, 60.0, 60.0, 30.0, 40.0, 460.0, 40.0, 220.0, 20.0, 120.0, 120.0, 80.0, 0.0, 20.0, 70.0, 90.0, 60.0, 10.0, 90.0, 40.0, 30.0, 560.0, 30.0, 590.0, -10.0, 260.0, 30.0, 60.0, 160.0, 0.0, -40.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6726173015758585, "mean_inference_ms": 1.4900889864128022, "mean_action_processing_ms": 0.4267336285141586, "mean_env_wait_ms": 1.3454556440720995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014219284057617188, "StateBufferConnector_ms": 0.012530088424682617, "ViewRequirementAgentConnector_ms": 0.44854283332824707}, "num_episodes": 18, "episode_return_max": 1790.0, "episode_return_min": 200.0, "episode_return_mean": 975.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.07764372307583, "num_env_steps_trained_throughput_per_sec": 19.07764372307583, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 3520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3520000, "timers": {"training_iteration_time_ms": 208737.103, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208737.056, "sample_time_ms": 2696.608, "learn_time_ms": 206019.571, "learn_throughput": 19.416, "synch_weights_time_ms": 12.259}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "done": false, "training_iteration": 88, "trial_id": "aa996_00000", "date": "2024-05-24_03-51-16", "timestamp": 1716537076, "time_this_iter_s": 209.67762994766235, "time_total_s": 18343.04884672165, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18343.04884672165, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 28.814527027027022, "ram_util_percent": 78.82094594594595}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7255340405609916, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.133948819502728, "policy_loss": -0.007707345245046, "vf_loss": 7.140430348470442, "vf_explained_var": 0.0002918845294509579, "kl": 0.006129066331633303, "entropy": 0.3397881647760368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 831015.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 240.0, "episode_reward_mean": 972.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 97.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 1180.0, 440.0, 1420.0, 770.0, 570.0, 910.0, 1140.0, 290.0, 1450.0, 1400.0, 640.0, 735.0, 1155.0, 950.0, 1790.0, 1255.0, 1330.0, 750.0, 1100.0, 980.0, 1220.0, 410.0, 1310.0, 530.0, 1460.0, 1220.0, 780.0, 1430.0, 1060.0, 1240.0, 1180.0, 380.0, 1350.0, 1180.0, 380.0, 310.0, 240.0, 620.0, 1190.0, 450.0, 1540.0, 1165.0, 440.0, 590.0, 1120.0, 930.0, 1040.0, 1150.0, 1330.0, 430.0, 1240.0, 1110.0, 1350.0, 400.0, 1130.0, 1550.0, 440.0, 850.0, 955.0, 460.0, 940.0, 520.0, 1150.0, 690.0, 790.0, 900.0, 615.0, 890.0, 820.0, 1050.0, 530.0, 360.0, 1270.0, 1140.0, 1190.0, 970.0, 1120.0, 640.0, 760.0, 1260.0, 1050.0, 1165.0, 1630.0, 1140.0, 1190.0, 840.0, 1470.0, 1220.0, 1050.0, 1120.0, 1050.0, 420.0, 625.0, 950.0, 1490.0, 1145.0, 1060.0, 1150.0, 1540.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 250.0, 160.0, 20.0, 150.0, 90.0, 20.0, 180.0, 40.0, -10.0, 40.0, 140.0, 40.0, 100.0, 180.0, 70.0, 230.0, 120.0, 240.0, 20.0, 20.0, 40.0, 60.0, 60.0, 0.0, 40.0, 40.0, 40.0, 40.0, 100.0, 170.0, 230.0, 170.0, 80.0, 110.0, 60.0, 550.0, 90.0, -160.0, 120.0, 200.0, 10.0, 90.0, 190.0, 120.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 70.0, 300.0, -60.0, 130.0, 40.0, 40.0, 30.0, 0.0, 20.0, 40.0, 40.0, 150.0, 170.0, 80.0, 200.0, 20.0, 30.0, 160.0, 20.0, 110.0, 370.0, 360.0, 50.0, 30.0, 100.0, 150.0, 0.0, 10.0, -40.0, 0.0, 90.0, 20.0, -25.0, 100.0, 20.0, 0.0, 0.0, 5.0, 80.0, 0.0, 50.0, 60.0, 350.0, 10.0, 50.0, 60.0, 270.0, 170.0, 430.0, 30.0, 30.0, 50.0, 80.0, 100.0, 250.0, 60.0, 70.0, 710.0, 20.0, 10.0, 10.0, 70.0, 90.0, 60.0, 30.0, 190.0, 0.0, 110.0, 70.0, 90.0, 10.0, 40.0, 60.0, 290.0, 60.0, 100.0, 20.0, 60.0, 5.0, 590.0, 20.0, 40.0, 50.0, 70.0, 80.0, -5.0, 170.0, 60.0, 80.0, 180.0, 70.0, 10.0, 0.0, 170.0, 140.0, 70.0, 100.0, 120.0, 90.0, 50.0, 110.0, 80.0, 100.0, 500.0, 90.0, 140.0, 30.0, 80.0, 610.0, 370.0, 180.0, 400.0, 90.0, 0.0, 50.0, 100.0, 0.0, 40.0, 25.0, 20.0, 40.0, 430.0, 220.0, 30.0, 50.0, 170.0, 90.0, 160.0, 120.0, 70.0, 80.0, -10.0, 60.0, 470.0, 30.0, 0.0, -10.0, 10.0, 50.0, 60.0, -90.0, 20.0, 300.0, 60.0, 100.0, 400.0, 20.0, 130.0, 100.0, 70.0, 20.0, 20.0, 50.0, 60.0, 30.0, 40.0, 190.0, 330.0, 170.0, 170.0, 50.0, 280.0, 80.0, 160.0, 120.0, 160.0, 40.0, 100.0, 60.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 260.0, 450.0, 120.0, 160.0, 20.0, 40.0, 20.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 20.0, 10.0, 0.0, 80.0, 20.0, 160.0, 0.0, 10.0, 70.0, 80.0, 100.0, 170.0, 60.0, 10.0, 40.0, 400.0, 340.0, 190.0, 160.0, 40.0, 230.0, 30.0, 210.0, 150.0, 30.0, 310.0, 0.0, 60.0, 110.0, 20.0, 0.0, 210.0, 10.0, 10.0, 180.0, 190.0, 30.0, 20.0, 210.0, 200.0, 310.0, 130.0, 60.0, 220.0, 70.0, 70.0, 130.0, 30.0, 110.0, 50.0, 60.0, 280.0, 330.0, 70.0, 50.0, 50.0, 40.0, 20.0, 20.0, 200.0, 10.0, 140.0, 220.0, 380.0, 100.0, 10.0, 60.0, 100.0, 0.0, 310.0, 120.0, 130.0, 150.0, 100.0, 50.0, 110.0, 20.0, 190.0, 10.0, 0.0, 40.0, 60.0, 0.0, 50.0, 0.0, 20.0, 20.0, 180.0, 130.0, 270.0, 40.0, 30.0, 300.0, 10.0, 110.0, 130.0, 300.0, 30.0, 30.0, 15.0, 270.0, 470.0, 15.0, 70.0, 110.0, 80.0, 120.0, 0.0, 40.0, 20.0, 10.0, 170.0, 0.0, 40.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 30.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 40.0, 50.0, 20.0, 20.0, 10.0, 30.0, 20.0, 40.0, 10.0, 0.0, 10.0, 80.0, 70.0, 230.0, 0.0, 10.0, 10.0, 30.0, 10.0, 170.0, 50.0, 40.0, 270.0, 100.0, 160.0, 20.0, 170.0, 120.0, 80.0, 180.0, 80.0, 40.0, 140.0, 60.0, 20.0, 50.0, 0.0, 20.0, 30.0, 10.0, 250.0, 120.0, 210.0, 140.0, 220.0, 50.0, 70.0, 220.0, 150.0, 110.0, 40.0, 210.0, 565.0, -10.0, 30.0, -30.0, 60.0, 150.0, 40.0, 110.0, 10.0, 10.0, 0.0, 270.0, 0.0, 30.0, 20.0, 20.0, 0.0, 80.0, 30.0, 10.0, 260.0, 20.0, 40.0, 50.0, 100.0, 40.0, 20.0, 20.0, 180.0, 220.0, 90.0, 140.0, 80.0, 180.0, 160.0, 20.0, 20.0, 30.0, 50.0, 70.0, 240.0, 30.0, 150.0, 0.0, 100.0, 230.0, 20.0, 40.0, 370.0, 30.0, 180.0, 0.0, 70.0, 70.0, 100.0, 30.0, 20.0, 170.0, 40.0, 370.0, 20.0, 350.0, 10.0, 230.0, 10.0, 80.0, 20.0, 20.0, 60.0, 40.0, 140.0, 70.0, 170.0, 60.0, 300.0, 310.0, 110.0, 70.0, 20.0, 150.0, 40.0, 20.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 180.0, 280.0, 100.0, 160.0, 10.0, 180.0, 130.0, 40.0, 50.0, 110.0, 380.0, 130.0, 30.0, 180.0, 80.0, 30.0, 70.0, 40.0, 100.0, 70.0, 50.0, 590.0, 60.0, 30.0, 90.0, 60.0, 100.0, 40.0, 310.0, 20.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 40.0, 60.0, 30.0, 130.0, 90.0, 410.0, 30.0, 0.0, 80.0, 20.0, 110.0, 70.0, 80.0, 240.0, 110.0, 70.0, 30.0, 50.0, 350.0, 70.0, 50.0, 140.0, 490.0, 190.0, 70.0, 70.0, 20.0, 30.0, 50.0, 40.0, 0.0, 30.0, 120.0, 10.0, 20.0, 100.0, 70.0, 30.0, 40.0, 10.0, 30.0, 90.0, 20.0, 440.0, 140.0, 60.0, 10.0, -15.0, -20.0, 260.0, 380.0, -40.0, -40.0, 220.0, 10.0, 50.0, 170.0, 290.0, 10.0, -50.0, -210.0, 90.0, 20.0, 80.0, 80.0, 570.0, 180.0, 60.0, -30.0, -30.0, 50.0, 70.0, 60.0, -70.0, 50.0, 160.0, 50.0, 40.0, 0.0, 0.0, 30.0, 170.0, 0.0, 20.0, 30.0, 20.0, 170.0, 50.0, 470.0, 130.0, 40.0, 160.0, -20.0, 100.0, 10.0, 20.0, 110.0, 0.0, 70.0, 40.0, 10.0, 20.0, 190.0, 220.0, -60.0, 20.0, 300.0, 40.0, 10.0, 220.0, 10.0, 50.0, 100.0, 100.0, 170.0, 50.0, 20.0, 210.0, 20.0, 30.0, 60.0, 0.0, 10.0, 330.0, 0.0, 20.0, 10.0, 40.0, 220.0, 20.0, -5.0, 210.0, 10.0, 90.0, 190.0, 10.0, 160.0, 100.0, 50.0, 300.0, 20.0, 40.0, 0.0, 20.0, 50.0, 120.0, 340.0, 120.0, 10.0, 110.0, 10.0, 20.0, 0.0, 40.0, 290.0, 20.0, 40.0, 70.0, 40.0, 60.0, 70.0, 390.0, -30.0, 100.0, 40.0, 40.0, 0.0, 80.0, 0.0, 30.0, 40.0, 30.0, 250.0, 20.0, 20.0, 10.0, 20.0, 10.0, 110.0, 40.0, 80.0, 70.0, 0.0, 0.0, 310.0, 180.0, 50.0, 40.0, 60.0, 50.0, 60.0, 190.0, 220.0, 110.0, 0.0, 60.0, 20.0, 0.0, 160.0, -40.0, 310.0, 550.0, 20.0, 60.0, 60.0, 30.0, 40.0, 460.0, 40.0, 220.0, 20.0, 120.0, 120.0, 80.0, 0.0, 20.0, 70.0, 90.0, 60.0, 10.0, 90.0, 40.0, 30.0, 560.0, 30.0, 590.0, -10.0, 260.0, 30.0, 60.0, 160.0, 0.0, -40.0, 40.0, 0.0, 110.0, 20.0, 270.0, 60.0, 30.0, 170.0, -10.0, 0.0, -10.0, 440.0, 10.0, 0.0, 30.0, -10.0, 100.0, 20.0, 20.0, 20.0, 130.0, 130.0, 90.0, 180.0, 60.0, 40.0, 80.0, 300.0, 80.0, 30.0, 270.0, 90.0, 40.0, 70.0, 70.0, 210.0, 360.0, 40.0, 100.0, 40.0, 30.0, 100.0, 50.0, 50.0, 60.0, 270.0, -75.0, 80.0, 390.0, 80.0, 160.0, 60.0, 220.0, 340.0, 200.0, 70.0, 100.0, 290.0, 50.0, 260.0, 40.0, 280.0, 140.0, 70.0, 110.0, -20.0, 220.0, 230.0, 20.0, 40.0, 50.0, 290.0, 20.0, 40.0, 10.0, 100.0, -10.0, 40.0, 0.0, 350.0, 350.0, 20.0, 260.0, 100.0, 10.0, 160.0, 250.0, 40.0, 20.0, -20.0, 0.0, 120.0, 80.0, 40.0, 60.0, 20.0, 410.0, 150.0, 330.0, 140.0, 120.0, 0.0, 20.0, 20.0, 130.0, 150.0, 280.0, 220.0, 160.0, 190.0, 50.0, 40.0, 100.0, 30.0, 80.0, 100.0, 20.0, 390.0, 160.0, 30.0, 100.0, 300.0, 60.0, 70.0, 50.0, 150.0, 400.0, 0.0, 20.0, 40.0, 30.0, 110.0, 80.0, 40.0, 190.0, 40.0, 110.0, 40.0, -30.0, 170.0, 300.0, 10.0, 110.0, 0.0, -170.0, 240.0, 70.0, 10.0, 70.0, 40.0, 40.0, 60.0, 20.0, 100.0, 60.0, 10.0, 80.0, 210.0, 40.0, 10.0, 35.0, 100.0, 0.0, 40.0, 70.0, 110.0, 200.0, 220.0, 40.0, 150.0, 20.0, 230.0, 120.0, -20.0, -10.0, 330.0, 60.0, 50.0, 310.0, 30.0, 390.0, 380.0, 40.0, 35.0, -30.0, 450.0, 180.0, -110.0, 40.0, 120.0, 40.0, 150.0, 120.0, 210.0, 80.0, 130.0, 30.0, 0.0, 50.0, 70.0, 220.0, 120.0, 60.0, 60.0, 50.0, 230.0, 150.0, 340.0, 10.0, 150.0, -20.0, 330.0, 130.0, 210.0, 50.0, 80.0, 480.0, 120.0, 70.0, 10.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6737152843880327, "mean_inference_ms": 1.491896020623378, "mean_action_processing_ms": 0.4267824292628899, "mean_env_wait_ms": 1.344581320281123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013852834701538086, "StateBufferConnector_ms": 0.012379884719848633, "ViewRequirementAgentConnector_ms": 0.4433908462524414}, "num_episodes": 22, "episode_return_max": 1790.0, "episode_return_min": 240.0, "episode_return_mean": 972.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.198259381446753, "num_env_steps_trained_throughput_per_sec": 19.198259381446753, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 3560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3560000, "timers": {"training_iteration_time_ms": 208459.071, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208459.022, "sample_time_ms": 2678.028, "learn_time_ms": 205760.123, "learn_throughput": 19.44, "synch_weights_time_ms": 12.148}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "done": false, "training_iteration": 89, "trial_id": "aa996_00000", "date": "2024-05-24_03-54-45", "timestamp": 1716537285, "time_this_iter_s": 208.3638050556183, "time_total_s": 18551.412651777267, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dba9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18551.412651777267, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 26.752542372881354, "ram_util_percent": 78.7257627118644}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6908706301000045, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.155082792062729, "policy_loss": -0.008283432331980088, "vf_loss": 7.162157781639546, "vf_explained_var": 2.5664782498718196e-05, "kl": 0.006042246419226295, "entropy": 0.32570963137573833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 840405.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 240.0, "episode_reward_mean": 979.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -560.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 97.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [750.0, 1100.0, 980.0, 1220.0, 410.0, 1310.0, 530.0, 1460.0, 1220.0, 780.0, 1430.0, 1060.0, 1240.0, 1180.0, 380.0, 1350.0, 1180.0, 380.0, 310.0, 240.0, 620.0, 1190.0, 450.0, 1540.0, 1165.0, 440.0, 590.0, 1120.0, 930.0, 1040.0, 1150.0, 1330.0, 430.0, 1240.0, 1110.0, 1350.0, 400.0, 1130.0, 1550.0, 440.0, 850.0, 955.0, 460.0, 940.0, 520.0, 1150.0, 690.0, 790.0, 900.0, 615.0, 890.0, 820.0, 1050.0, 530.0, 360.0, 1270.0, 1140.0, 1190.0, 970.0, 1120.0, 640.0, 760.0, 1260.0, 1050.0, 1165.0, 1630.0, 1140.0, 1190.0, 840.0, 1470.0, 1220.0, 1050.0, 1120.0, 1050.0, 420.0, 625.0, 950.0, 1490.0, 1145.0, 1060.0, 1150.0, 1540.0, 1350.0, 1700.0, 1200.0, 1380.0, 640.0, 540.0, 1570.0, 910.0, 820.0, 1645.0, 550.0, 1350.0, 560.0, 890.0, 585.0, 370.0, 1305.0, 1700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 80.0, -10.0, 60.0, 470.0, 30.0, 0.0, -10.0, 10.0, 50.0, 60.0, -90.0, 20.0, 300.0, 60.0, 100.0, 400.0, 20.0, 130.0, 100.0, 70.0, 20.0, 20.0, 50.0, 60.0, 30.0, 40.0, 190.0, 330.0, 170.0, 170.0, 50.0, 280.0, 80.0, 160.0, 120.0, 160.0, 40.0, 100.0, 60.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 260.0, 450.0, 120.0, 160.0, 20.0, 40.0, 20.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 20.0, 10.0, 0.0, 80.0, 20.0, 160.0, 0.0, 10.0, 70.0, 80.0, 100.0, 170.0, 60.0, 10.0, 40.0, 400.0, 340.0, 190.0, 160.0, 40.0, 230.0, 30.0, 210.0, 150.0, 30.0, 310.0, 0.0, 60.0, 110.0, 20.0, 0.0, 210.0, 10.0, 10.0, 180.0, 190.0, 30.0, 20.0, 210.0, 200.0, 310.0, 130.0, 60.0, 220.0, 70.0, 70.0, 130.0, 30.0, 110.0, 50.0, 60.0, 280.0, 330.0, 70.0, 50.0, 50.0, 40.0, 20.0, 20.0, 200.0, 10.0, 140.0, 220.0, 380.0, 100.0, 10.0, 60.0, 100.0, 0.0, 310.0, 120.0, 130.0, 150.0, 100.0, 50.0, 110.0, 20.0, 190.0, 10.0, 0.0, 40.0, 60.0, 0.0, 50.0, 0.0, 20.0, 20.0, 180.0, 130.0, 270.0, 40.0, 30.0, 300.0, 10.0, 110.0, 130.0, 300.0, 30.0, 30.0, 15.0, 270.0, 470.0, 15.0, 70.0, 110.0, 80.0, 120.0, 0.0, 40.0, 20.0, 10.0, 170.0, 0.0, 40.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 30.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 40.0, 50.0, 20.0, 20.0, 10.0, 30.0, 20.0, 40.0, 10.0, 0.0, 10.0, 80.0, 70.0, 230.0, 0.0, 10.0, 10.0, 30.0, 10.0, 170.0, 50.0, 40.0, 270.0, 100.0, 160.0, 20.0, 170.0, 120.0, 80.0, 180.0, 80.0, 40.0, 140.0, 60.0, 20.0, 50.0, 0.0, 20.0, 30.0, 10.0, 250.0, 120.0, 210.0, 140.0, 220.0, 50.0, 70.0, 220.0, 150.0, 110.0, 40.0, 210.0, 565.0, -10.0, 30.0, -30.0, 60.0, 150.0, 40.0, 110.0, 10.0, 10.0, 0.0, 270.0, 0.0, 30.0, 20.0, 20.0, 0.0, 80.0, 30.0, 10.0, 260.0, 20.0, 40.0, 50.0, 100.0, 40.0, 20.0, 20.0, 180.0, 220.0, 90.0, 140.0, 80.0, 180.0, 160.0, 20.0, 20.0, 30.0, 50.0, 70.0, 240.0, 30.0, 150.0, 0.0, 100.0, 230.0, 20.0, 40.0, 370.0, 30.0, 180.0, 0.0, 70.0, 70.0, 100.0, 30.0, 20.0, 170.0, 40.0, 370.0, 20.0, 350.0, 10.0, 230.0, 10.0, 80.0, 20.0, 20.0, 60.0, 40.0, 140.0, 70.0, 170.0, 60.0, 300.0, 310.0, 110.0, 70.0, 20.0, 150.0, 40.0, 20.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 180.0, 280.0, 100.0, 160.0, 10.0, 180.0, 130.0, 40.0, 50.0, 110.0, 380.0, 130.0, 30.0, 180.0, 80.0, 30.0, 70.0, 40.0, 100.0, 70.0, 50.0, 590.0, 60.0, 30.0, 90.0, 60.0, 100.0, 40.0, 310.0, 20.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 40.0, 60.0, 30.0, 130.0, 90.0, 410.0, 30.0, 0.0, 80.0, 20.0, 110.0, 70.0, 80.0, 240.0, 110.0, 70.0, 30.0, 50.0, 350.0, 70.0, 50.0, 140.0, 490.0, 190.0, 70.0, 70.0, 20.0, 30.0, 50.0, 40.0, 0.0, 30.0, 120.0, 10.0, 20.0, 100.0, 70.0, 30.0, 40.0, 10.0, 30.0, 90.0, 20.0, 440.0, 140.0, 60.0, 10.0, -15.0, -20.0, 260.0, 380.0, -40.0, -40.0, 220.0, 10.0, 50.0, 170.0, 290.0, 10.0, -50.0, -210.0, 90.0, 20.0, 80.0, 80.0, 570.0, 180.0, 60.0, -30.0, -30.0, 50.0, 70.0, 60.0, -70.0, 50.0, 160.0, 50.0, 40.0, 0.0, 0.0, 30.0, 170.0, 0.0, 20.0, 30.0, 20.0, 170.0, 50.0, 470.0, 130.0, 40.0, 160.0, -20.0, 100.0, 10.0, 20.0, 110.0, 0.0, 70.0, 40.0, 10.0, 20.0, 190.0, 220.0, -60.0, 20.0, 300.0, 40.0, 10.0, 220.0, 10.0, 50.0, 100.0, 100.0, 170.0, 50.0, 20.0, 210.0, 20.0, 30.0, 60.0, 0.0, 10.0, 330.0, 0.0, 20.0, 10.0, 40.0, 220.0, 20.0, -5.0, 210.0, 10.0, 90.0, 190.0, 10.0, 160.0, 100.0, 50.0, 300.0, 20.0, 40.0, 0.0, 20.0, 50.0, 120.0, 340.0, 120.0, 10.0, 110.0, 10.0, 20.0, 0.0, 40.0, 290.0, 20.0, 40.0, 70.0, 40.0, 60.0, 70.0, 390.0, -30.0, 100.0, 40.0, 40.0, 0.0, 80.0, 0.0, 30.0, 40.0, 30.0, 250.0, 20.0, 20.0, 10.0, 20.0, 10.0, 110.0, 40.0, 80.0, 70.0, 0.0, 0.0, 310.0, 180.0, 50.0, 40.0, 60.0, 50.0, 60.0, 190.0, 220.0, 110.0, 0.0, 60.0, 20.0, 0.0, 160.0, -40.0, 310.0, 550.0, 20.0, 60.0, 60.0, 30.0, 40.0, 460.0, 40.0, 220.0, 20.0, 120.0, 120.0, 80.0, 0.0, 20.0, 70.0, 90.0, 60.0, 10.0, 90.0, 40.0, 30.0, 560.0, 30.0, 590.0, -10.0, 260.0, 30.0, 60.0, 160.0, 0.0, -40.0, 40.0, 0.0, 110.0, 20.0, 270.0, 60.0, 30.0, 170.0, -10.0, 0.0, -10.0, 440.0, 10.0, 0.0, 30.0, -10.0, 100.0, 20.0, 20.0, 20.0, 130.0, 130.0, 90.0, 180.0, 60.0, 40.0, 80.0, 300.0, 80.0, 30.0, 270.0, 90.0, 40.0, 70.0, 70.0, 210.0, 360.0, 40.0, 100.0, 40.0, 30.0, 100.0, 50.0, 50.0, 60.0, 270.0, -75.0, 80.0, 390.0, 80.0, 160.0, 60.0, 220.0, 340.0, 200.0, 70.0, 100.0, 290.0, 50.0, 260.0, 40.0, 280.0, 140.0, 70.0, 110.0, -20.0, 220.0, 230.0, 20.0, 40.0, 50.0, 290.0, 20.0, 40.0, 10.0, 100.0, -10.0, 40.0, 0.0, 350.0, 350.0, 20.0, 260.0, 100.0, 10.0, 160.0, 250.0, 40.0, 20.0, -20.0, 0.0, 120.0, 80.0, 40.0, 60.0, 20.0, 410.0, 150.0, 330.0, 140.0, 120.0, 0.0, 20.0, 20.0, 130.0, 150.0, 280.0, 220.0, 160.0, 190.0, 50.0, 40.0, 100.0, 30.0, 80.0, 100.0, 20.0, 390.0, 160.0, 30.0, 100.0, 300.0, 60.0, 70.0, 50.0, 150.0, 400.0, 0.0, 20.0, 40.0, 30.0, 110.0, 80.0, 40.0, 190.0, 40.0, 110.0, 40.0, -30.0, 170.0, 300.0, 10.0, 110.0, 0.0, -170.0, 240.0, 70.0, 10.0, 70.0, 40.0, 40.0, 60.0, 20.0, 100.0, 60.0, 10.0, 80.0, 210.0, 40.0, 10.0, 35.0, 100.0, 0.0, 40.0, 70.0, 110.0, 200.0, 220.0, 40.0, 150.0, 20.0, 230.0, 120.0, -20.0, -10.0, 330.0, 60.0, 50.0, 310.0, 30.0, 390.0, 380.0, 40.0, 35.0, -30.0, 450.0, 180.0, -110.0, 40.0, 120.0, 40.0, 150.0, 120.0, 210.0, 80.0, 130.0, 30.0, 0.0, 50.0, 70.0, 220.0, 120.0, 60.0, 60.0, 50.0, 230.0, 150.0, 340.0, 10.0, 150.0, -20.0, 330.0, 130.0, 210.0, 50.0, 80.0, 480.0, 120.0, 70.0, 10.0, 60.0, 340.0, 80.0, 330.0, 30.0, 20.0, 120.0, 100.0, 140.0, 20.0, 170.0, 370.0, 0.0, 510.0, 80.0, 160.0, 60.0, 120.0, 130.0, 270.0, 0.0, 20.0, 0.0, 330.0, 240.0, 20.0, 120.0, 150.0, 170.0, 90.0, 60.0, 380.0, -100.0, 80.0, 70.0, 40.0, 160.0, 750.0, -130.0, 40.0, 90.0, 40.0, 80.0, 30.0, 90.0, 0.0, 100.0, 100.0, 80.0, 30.0, 90.0, 0.0, 10.0, 0.0, 10.0, 70.0, 170.0, 200.0, 0.0, 30.0, 50.0, 30.0, 160.0, 720.0, 100.0, 100.0, 200.0, 10.0, 130.0, 70.0, 50.0, 170.0, 10.0, 80.0, -25.0, 125.0, 70.0, 130.0, 210.0, -120.0, 260.0, 10.0, 280.0, 170.0, 50.0, 60.0, 20.0, 0.0, 0.0, 180.0, 50.0, 0.0, 160.0, 100.0, 150.0, 180.0, 120.0, 20.0, 90.0, 720.0, 105.0, 30.0, 60.0, 0.0, 200.0, 0.0, 40.0, 40.0, 170.0, 0.0, 10.0, 260.0, 260.0, 100.0, 20.0, 310.0, 180.0, 70.0, 70.0, 90.0, -10.0, 40.0, 90.0, 10.0, 20.0, 0.0, 40.0, 100.0, 20.0, 170.0, 70.0, 190.0, 40.0, 130.0, 50.0, 70.0, 90.0, 50.0, 40.0, 200.0, 30.0, 0.0, -25.0, 150.0, -130.0, 40.0, 10.0, 190.0, 10.0, 260.0, 80.0, 210.0, 20.0, 610.0, -40.0, 10.0, 20.0, -560.0, 30.0, 20.0, 50.0, 60.0, 220.0, 30.0, 50.0, 40.0, 150.0, 150.0, 65.0, 460.0, 80.0, 60.0, 220.0, 0.0, 870.0, 60.0, 30.0, 190.0, 0.0, 210.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6723532495565498, "mean_inference_ms": 1.4907277714782357, "mean_action_processing_ms": 0.42639084804053984, "mean_env_wait_ms": 1.3454548793597263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012831449508666992, "StateBufferConnector_ms": 0.01163792610168457, "ViewRequirementAgentConnector_ms": 0.43086910247802734}, "num_episodes": 18, "episode_return_max": 1700.0, "episode_return_min": 240.0, "episode_return_mean": 979.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.26095930800986, "num_env_steps_trained_throughput_per_sec": 19.26095930800986, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 3600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3600000, "timers": {"training_iteration_time_ms": 208351.696, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208351.646, "sample_time_ms": 2672.161, "learn_time_ms": 205658.098, "learn_throughput": 19.45, "synch_weights_time_ms": 13.082}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "done": false, "training_iteration": 90, "trial_id": "aa996_00000", "date": "2024-05-24_03-58-12", "timestamp": 1716537492, "time_this_iter_s": 207.69353985786438, "time_total_s": 18759.106191635132, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18759.106191635132, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 26.63707482993197, "ram_util_percent": 78.61836734693878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3275915175835036, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.457092254941329, "policy_loss": -0.007736558991353423, "vf_loss": 7.4636905115633345, "vf_explained_var": -0.00018782736267398595, "kl": 0.005691521132388184, "entropy": 0.32215721638946615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 849795.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": 360.0, "episode_reward_mean": 1033.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -560.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 103.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1540.0, 1165.0, 440.0, 590.0, 1120.0, 930.0, 1040.0, 1150.0, 1330.0, 430.0, 1240.0, 1110.0, 1350.0, 400.0, 1130.0, 1550.0, 440.0, 850.0, 955.0, 460.0, 940.0, 520.0, 1150.0, 690.0, 790.0, 900.0, 615.0, 890.0, 820.0, 1050.0, 530.0, 360.0, 1270.0, 1140.0, 1190.0, 970.0, 1120.0, 640.0, 760.0, 1260.0, 1050.0, 1165.0, 1630.0, 1140.0, 1190.0, 840.0, 1470.0, 1220.0, 1050.0, 1120.0, 1050.0, 420.0, 625.0, 950.0, 1490.0, 1145.0, 1060.0, 1150.0, 1540.0, 1350.0, 1700.0, 1200.0, 1380.0, 640.0, 540.0, 1570.0, 910.0, 820.0, 1645.0, 550.0, 1350.0, 560.0, 890.0, 585.0, 370.0, 1305.0, 1700.0, 1010.0, 1450.0, 735.0, 840.0, 1220.0, 1600.0, 1500.0, 1490.0, 1080.0, 610.0, 1090.0, 1490.0, 880.0, 1525.0, 830.0, 1290.0, 1370.0, 930.0, 1030.0, 650.0, 1910.0, 1060.0, 580.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [250.0, 120.0, 210.0, 140.0, 220.0, 50.0, 70.0, 220.0, 150.0, 110.0, 40.0, 210.0, 565.0, -10.0, 30.0, -30.0, 60.0, 150.0, 40.0, 110.0, 10.0, 10.0, 0.0, 270.0, 0.0, 30.0, 20.0, 20.0, 0.0, 80.0, 30.0, 10.0, 260.0, 20.0, 40.0, 50.0, 100.0, 40.0, 20.0, 20.0, 180.0, 220.0, 90.0, 140.0, 80.0, 180.0, 160.0, 20.0, 20.0, 30.0, 50.0, 70.0, 240.0, 30.0, 150.0, 0.0, 100.0, 230.0, 20.0, 40.0, 370.0, 30.0, 180.0, 0.0, 70.0, 70.0, 100.0, 30.0, 20.0, 170.0, 40.0, 370.0, 20.0, 350.0, 10.0, 230.0, 10.0, 80.0, 20.0, 20.0, 60.0, 40.0, 140.0, 70.0, 170.0, 60.0, 300.0, 310.0, 110.0, 70.0, 20.0, 150.0, 40.0, 20.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 180.0, 280.0, 100.0, 160.0, 10.0, 180.0, 130.0, 40.0, 50.0, 110.0, 380.0, 130.0, 30.0, 180.0, 80.0, 30.0, 70.0, 40.0, 100.0, 70.0, 50.0, 590.0, 60.0, 30.0, 90.0, 60.0, 100.0, 40.0, 310.0, 20.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 40.0, 60.0, 30.0, 130.0, 90.0, 410.0, 30.0, 0.0, 80.0, 20.0, 110.0, 70.0, 80.0, 240.0, 110.0, 70.0, 30.0, 50.0, 350.0, 70.0, 50.0, 140.0, 490.0, 190.0, 70.0, 70.0, 20.0, 30.0, 50.0, 40.0, 0.0, 30.0, 120.0, 10.0, 20.0, 100.0, 70.0, 30.0, 40.0, 10.0, 30.0, 90.0, 20.0, 440.0, 140.0, 60.0, 10.0, -15.0, -20.0, 260.0, 380.0, -40.0, -40.0, 220.0, 10.0, 50.0, 170.0, 290.0, 10.0, -50.0, -210.0, 90.0, 20.0, 80.0, 80.0, 570.0, 180.0, 60.0, -30.0, -30.0, 50.0, 70.0, 60.0, -70.0, 50.0, 160.0, 50.0, 40.0, 0.0, 0.0, 30.0, 170.0, 0.0, 20.0, 30.0, 20.0, 170.0, 50.0, 470.0, 130.0, 40.0, 160.0, -20.0, 100.0, 10.0, 20.0, 110.0, 0.0, 70.0, 40.0, 10.0, 20.0, 190.0, 220.0, -60.0, 20.0, 300.0, 40.0, 10.0, 220.0, 10.0, 50.0, 100.0, 100.0, 170.0, 50.0, 20.0, 210.0, 20.0, 30.0, 60.0, 0.0, 10.0, 330.0, 0.0, 20.0, 10.0, 40.0, 220.0, 20.0, -5.0, 210.0, 10.0, 90.0, 190.0, 10.0, 160.0, 100.0, 50.0, 300.0, 20.0, 40.0, 0.0, 20.0, 50.0, 120.0, 340.0, 120.0, 10.0, 110.0, 10.0, 20.0, 0.0, 40.0, 290.0, 20.0, 40.0, 70.0, 40.0, 60.0, 70.0, 390.0, -30.0, 100.0, 40.0, 40.0, 0.0, 80.0, 0.0, 30.0, 40.0, 30.0, 250.0, 20.0, 20.0, 10.0, 20.0, 10.0, 110.0, 40.0, 80.0, 70.0, 0.0, 0.0, 310.0, 180.0, 50.0, 40.0, 60.0, 50.0, 60.0, 190.0, 220.0, 110.0, 0.0, 60.0, 20.0, 0.0, 160.0, -40.0, 310.0, 550.0, 20.0, 60.0, 60.0, 30.0, 40.0, 460.0, 40.0, 220.0, 20.0, 120.0, 120.0, 80.0, 0.0, 20.0, 70.0, 90.0, 60.0, 10.0, 90.0, 40.0, 30.0, 560.0, 30.0, 590.0, -10.0, 260.0, 30.0, 60.0, 160.0, 0.0, -40.0, 40.0, 0.0, 110.0, 20.0, 270.0, 60.0, 30.0, 170.0, -10.0, 0.0, -10.0, 440.0, 10.0, 0.0, 30.0, -10.0, 100.0, 20.0, 20.0, 20.0, 130.0, 130.0, 90.0, 180.0, 60.0, 40.0, 80.0, 300.0, 80.0, 30.0, 270.0, 90.0, 40.0, 70.0, 70.0, 210.0, 360.0, 40.0, 100.0, 40.0, 30.0, 100.0, 50.0, 50.0, 60.0, 270.0, -75.0, 80.0, 390.0, 80.0, 160.0, 60.0, 220.0, 340.0, 200.0, 70.0, 100.0, 290.0, 50.0, 260.0, 40.0, 280.0, 140.0, 70.0, 110.0, -20.0, 220.0, 230.0, 20.0, 40.0, 50.0, 290.0, 20.0, 40.0, 10.0, 100.0, -10.0, 40.0, 0.0, 350.0, 350.0, 20.0, 260.0, 100.0, 10.0, 160.0, 250.0, 40.0, 20.0, -20.0, 0.0, 120.0, 80.0, 40.0, 60.0, 20.0, 410.0, 150.0, 330.0, 140.0, 120.0, 0.0, 20.0, 20.0, 130.0, 150.0, 280.0, 220.0, 160.0, 190.0, 50.0, 40.0, 100.0, 30.0, 80.0, 100.0, 20.0, 390.0, 160.0, 30.0, 100.0, 300.0, 60.0, 70.0, 50.0, 150.0, 400.0, 0.0, 20.0, 40.0, 30.0, 110.0, 80.0, 40.0, 190.0, 40.0, 110.0, 40.0, -30.0, 170.0, 300.0, 10.0, 110.0, 0.0, -170.0, 240.0, 70.0, 10.0, 70.0, 40.0, 40.0, 60.0, 20.0, 100.0, 60.0, 10.0, 80.0, 210.0, 40.0, 10.0, 35.0, 100.0, 0.0, 40.0, 70.0, 110.0, 200.0, 220.0, 40.0, 150.0, 20.0, 230.0, 120.0, -20.0, -10.0, 330.0, 60.0, 50.0, 310.0, 30.0, 390.0, 380.0, 40.0, 35.0, -30.0, 450.0, 180.0, -110.0, 40.0, 120.0, 40.0, 150.0, 120.0, 210.0, 80.0, 130.0, 30.0, 0.0, 50.0, 70.0, 220.0, 120.0, 60.0, 60.0, 50.0, 230.0, 150.0, 340.0, 10.0, 150.0, -20.0, 330.0, 130.0, 210.0, 50.0, 80.0, 480.0, 120.0, 70.0, 10.0, 60.0, 340.0, 80.0, 330.0, 30.0, 20.0, 120.0, 100.0, 140.0, 20.0, 170.0, 370.0, 0.0, 510.0, 80.0, 160.0, 60.0, 120.0, 130.0, 270.0, 0.0, 20.0, 0.0, 330.0, 240.0, 20.0, 120.0, 150.0, 170.0, 90.0, 60.0, 380.0, -100.0, 80.0, 70.0, 40.0, 160.0, 750.0, -130.0, 40.0, 90.0, 40.0, 80.0, 30.0, 90.0, 0.0, 100.0, 100.0, 80.0, 30.0, 90.0, 0.0, 10.0, 0.0, 10.0, 70.0, 170.0, 200.0, 0.0, 30.0, 50.0, 30.0, 160.0, 720.0, 100.0, 100.0, 200.0, 10.0, 130.0, 70.0, 50.0, 170.0, 10.0, 80.0, -25.0, 125.0, 70.0, 130.0, 210.0, -120.0, 260.0, 10.0, 280.0, 170.0, 50.0, 60.0, 20.0, 0.0, 0.0, 180.0, 50.0, 0.0, 160.0, 100.0, 150.0, 180.0, 120.0, 20.0, 90.0, 720.0, 105.0, 30.0, 60.0, 0.0, 200.0, 0.0, 40.0, 40.0, 170.0, 0.0, 10.0, 260.0, 260.0, 100.0, 20.0, 310.0, 180.0, 70.0, 70.0, 90.0, -10.0, 40.0, 90.0, 10.0, 20.0, 0.0, 40.0, 100.0, 20.0, 170.0, 70.0, 190.0, 40.0, 130.0, 50.0, 70.0, 90.0, 50.0, 40.0, 200.0, 30.0, 0.0, -25.0, 150.0, -130.0, 40.0, 10.0, 190.0, 10.0, 260.0, 80.0, 210.0, 20.0, 610.0, -40.0, 10.0, 20.0, -560.0, 30.0, 20.0, 50.0, 60.0, 220.0, 30.0, 50.0, 40.0, 150.0, 150.0, 65.0, 460.0, 80.0, 60.0, 220.0, 0.0, 870.0, 60.0, 30.0, 190.0, 0.0, 210.0, 60.0, 190.0, 80.0, 150.0, 270.0, 50.0, 0.0, 100.0, 100.0, 20.0, 50.0, 170.0, 80.0, 20.0, 60.0, 500.0, 60.0, 120.0, -80.0, 290.0, 230.0, 30.0, 10.0, 40.0, -5.0, -20.0, 30.0, 410.0, 170.0, 40.0, 30.0, 170.0, 70.0, 40.0, 30.0, 20.0, 60.0, 30.0, 290.0, 20.0, 110.0, 80.0, 30.0, 90.0, 150.0, 50.0, 250.0, 40.0, 140.0, 310.0, 80.0, 0.0, 90.0, 80.0, 200.0, 390.0, 300.0, 80.0, 190.0, 50.0, 220.0, 90.0, 220.0, 40.0, 40.0, 560.0, -50.0, 30.0, 430.0, 100.0, 40.0, 120.0, 330.0, 50.0, 40.0, 100.0, 180.0, 100.0, 500.0, 30.0, 40.0, 60.0, 35.0, 20.0, 0.0, 50.0, 70.0, 575.0, 10.0, 150.0, 110.0, 20.0, 10.0, 160.0, 0.0, 10.0, 20.0, 0.0, 170.0, 10.0, 210.0, 80.0, 50.0, -20.0, 400.0, 180.0, 60.0, 100.0, 40.0, 110.0, 90.0, 20.0, 80.0, 210.0, 310.0, 350.0, 160.0, 160.0, 80.0, 20.0, 100.0, 70.0, 100.0, 30.0, 170.0, 20.0, 180.0, 100.0, 0.0, 160.0, 50.0, 40.0, 130.0, 380.0, 380.0, 50.0, 240.0, 150.0, 5.0, 110.0, 40.0, 40.0, 90.0, 70.0, 30.0, 0.0, 200.0, 90.0, 130.0, 140.0, 40.0, 220.0, 150.0, 110.0, 210.0, 160.0, 10.0, 40.0, 110.0, 180.0, 100.0, 20.0, 60.0, 110.0, 170.0, 190.0, 60.0, 390.0, 110.0, 130.0, 130.0, 110.0, 350.0, -15.0, 20.0, 30.0, 60.0, -15.0, 160.0, 160.0, 70.0, 60.0, 350.0, 80.0, 0.0, 50.0, 60.0, 110.0, 160.0, 100.0, 60.0, 140.0, 10.0, 90.0, 40.0, 40.0, 40.0, 90.0, 60.0, 30.0, 110.0, 190.0, 390.0, 130.0, 90.0, 520.0, 70.0, 110.0, 110.0, 150.0, 150.0, 30.0, 80.0, 150.0, 30.0, -30.0, 80.0, 20.0, 330.0, 160.0, 210.0, 20.0, 330.0, 30.0, 20.0, 0.0, 20.0, 10.0, 80.0, 50.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6722427867957808, "mean_inference_ms": 1.488831862970124, "mean_action_processing_ms": 0.42628006721185235, "mean_env_wait_ms": 1.3464309179623788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012838363647460938, "StateBufferConnector_ms": 0.011843681335449219, "ViewRequirementAgentConnector_ms": 0.4178199768066406}, "num_episodes": 23, "episode_return_max": 1910.0, "episode_return_min": 360.0, "episode_return_mean": 1033.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.2658432299185, "num_env_steps_trained_throughput_per_sec": 19.2658432299185, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 3640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3640000, "timers": {"training_iteration_time_ms": 208382.006, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208381.957, "sample_time_ms": 2660.382, "learn_time_ms": 205700.973, "learn_throughput": 19.446, "synch_weights_time_ms": 13.067}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "done": false, "training_iteration": 91, "trial_id": "aa996_00000", "date": "2024-05-24_04-01-40", "timestamp": 1716537700, "time_this_iter_s": 207.6443428993225, "time_total_s": 18966.750534534454, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d70af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18966.750534534454, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 26.87713310580205, "ram_util_percent": 78.82013651877133}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.549466964104178, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.680955119737294, "policy_loss": -0.008201210123771471, "vf_loss": 6.6878942636382215, "vf_explained_var": -8.979414979489848e-05, "kl": 0.0063103073860600895, "entropy": 0.3523670726944717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 859185.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": 220.0, "episode_reward_mean": 1026.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -560.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 102.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [955.0, 460.0, 940.0, 520.0, 1150.0, 690.0, 790.0, 900.0, 615.0, 890.0, 820.0, 1050.0, 530.0, 360.0, 1270.0, 1140.0, 1190.0, 970.0, 1120.0, 640.0, 760.0, 1260.0, 1050.0, 1165.0, 1630.0, 1140.0, 1190.0, 840.0, 1470.0, 1220.0, 1050.0, 1120.0, 1050.0, 420.0, 625.0, 950.0, 1490.0, 1145.0, 1060.0, 1150.0, 1540.0, 1350.0, 1700.0, 1200.0, 1380.0, 640.0, 540.0, 1570.0, 910.0, 820.0, 1645.0, 550.0, 1350.0, 560.0, 890.0, 585.0, 370.0, 1305.0, 1700.0, 1010.0, 1450.0, 735.0, 840.0, 1220.0, 1600.0, 1500.0, 1490.0, 1080.0, 610.0, 1090.0, 1490.0, 880.0, 1525.0, 830.0, 1290.0, 1370.0, 930.0, 1030.0, 650.0, 1910.0, 1060.0, 580.0, 880.0, 1110.0, 1255.0, 1140.0, 1015.0, 1140.0, 970.0, 320.0, 560.0, 500.0, 295.0, 1565.0, 1400.0, 660.0, 220.0, 980.0, 1380.0, 1740.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 60.0, 10.0, -15.0, -20.0, 260.0, 380.0, -40.0, -40.0, 220.0, 10.0, 50.0, 170.0, 290.0, 10.0, -50.0, -210.0, 90.0, 20.0, 80.0, 80.0, 570.0, 180.0, 60.0, -30.0, -30.0, 50.0, 70.0, 60.0, -70.0, 50.0, 160.0, 50.0, 40.0, 0.0, 0.0, 30.0, 170.0, 0.0, 20.0, 30.0, 20.0, 170.0, 50.0, 470.0, 130.0, 40.0, 160.0, -20.0, 100.0, 10.0, 20.0, 110.0, 0.0, 70.0, 40.0, 10.0, 20.0, 190.0, 220.0, -60.0, 20.0, 300.0, 40.0, 10.0, 220.0, 10.0, 50.0, 100.0, 100.0, 170.0, 50.0, 20.0, 210.0, 20.0, 30.0, 60.0, 0.0, 10.0, 330.0, 0.0, 20.0, 10.0, 40.0, 220.0, 20.0, -5.0, 210.0, 10.0, 90.0, 190.0, 10.0, 160.0, 100.0, 50.0, 300.0, 20.0, 40.0, 0.0, 20.0, 50.0, 120.0, 340.0, 120.0, 10.0, 110.0, 10.0, 20.0, 0.0, 40.0, 290.0, 20.0, 40.0, 70.0, 40.0, 60.0, 70.0, 390.0, -30.0, 100.0, 40.0, 40.0, 0.0, 80.0, 0.0, 30.0, 40.0, 30.0, 250.0, 20.0, 20.0, 10.0, 20.0, 10.0, 110.0, 40.0, 80.0, 70.0, 0.0, 0.0, 310.0, 180.0, 50.0, 40.0, 60.0, 50.0, 60.0, 190.0, 220.0, 110.0, 0.0, 60.0, 20.0, 0.0, 160.0, -40.0, 310.0, 550.0, 20.0, 60.0, 60.0, 30.0, 40.0, 460.0, 40.0, 220.0, 20.0, 120.0, 120.0, 80.0, 0.0, 20.0, 70.0, 90.0, 60.0, 10.0, 90.0, 40.0, 30.0, 560.0, 30.0, 590.0, -10.0, 260.0, 30.0, 60.0, 160.0, 0.0, -40.0, 40.0, 0.0, 110.0, 20.0, 270.0, 60.0, 30.0, 170.0, -10.0, 0.0, -10.0, 440.0, 10.0, 0.0, 30.0, -10.0, 100.0, 20.0, 20.0, 20.0, 130.0, 130.0, 90.0, 180.0, 60.0, 40.0, 80.0, 300.0, 80.0, 30.0, 270.0, 90.0, 40.0, 70.0, 70.0, 210.0, 360.0, 40.0, 100.0, 40.0, 30.0, 100.0, 50.0, 50.0, 60.0, 270.0, -75.0, 80.0, 390.0, 80.0, 160.0, 60.0, 220.0, 340.0, 200.0, 70.0, 100.0, 290.0, 50.0, 260.0, 40.0, 280.0, 140.0, 70.0, 110.0, -20.0, 220.0, 230.0, 20.0, 40.0, 50.0, 290.0, 20.0, 40.0, 10.0, 100.0, -10.0, 40.0, 0.0, 350.0, 350.0, 20.0, 260.0, 100.0, 10.0, 160.0, 250.0, 40.0, 20.0, -20.0, 0.0, 120.0, 80.0, 40.0, 60.0, 20.0, 410.0, 150.0, 330.0, 140.0, 120.0, 0.0, 20.0, 20.0, 130.0, 150.0, 280.0, 220.0, 160.0, 190.0, 50.0, 40.0, 100.0, 30.0, 80.0, 100.0, 20.0, 390.0, 160.0, 30.0, 100.0, 300.0, 60.0, 70.0, 50.0, 150.0, 400.0, 0.0, 20.0, 40.0, 30.0, 110.0, 80.0, 40.0, 190.0, 40.0, 110.0, 40.0, -30.0, 170.0, 300.0, 10.0, 110.0, 0.0, -170.0, 240.0, 70.0, 10.0, 70.0, 40.0, 40.0, 60.0, 20.0, 100.0, 60.0, 10.0, 80.0, 210.0, 40.0, 10.0, 35.0, 100.0, 0.0, 40.0, 70.0, 110.0, 200.0, 220.0, 40.0, 150.0, 20.0, 230.0, 120.0, -20.0, -10.0, 330.0, 60.0, 50.0, 310.0, 30.0, 390.0, 380.0, 40.0, 35.0, -30.0, 450.0, 180.0, -110.0, 40.0, 120.0, 40.0, 150.0, 120.0, 210.0, 80.0, 130.0, 30.0, 0.0, 50.0, 70.0, 220.0, 120.0, 60.0, 60.0, 50.0, 230.0, 150.0, 340.0, 10.0, 150.0, -20.0, 330.0, 130.0, 210.0, 50.0, 80.0, 480.0, 120.0, 70.0, 10.0, 60.0, 340.0, 80.0, 330.0, 30.0, 20.0, 120.0, 100.0, 140.0, 20.0, 170.0, 370.0, 0.0, 510.0, 80.0, 160.0, 60.0, 120.0, 130.0, 270.0, 0.0, 20.0, 0.0, 330.0, 240.0, 20.0, 120.0, 150.0, 170.0, 90.0, 60.0, 380.0, -100.0, 80.0, 70.0, 40.0, 160.0, 750.0, -130.0, 40.0, 90.0, 40.0, 80.0, 30.0, 90.0, 0.0, 100.0, 100.0, 80.0, 30.0, 90.0, 0.0, 10.0, 0.0, 10.0, 70.0, 170.0, 200.0, 0.0, 30.0, 50.0, 30.0, 160.0, 720.0, 100.0, 100.0, 200.0, 10.0, 130.0, 70.0, 50.0, 170.0, 10.0, 80.0, -25.0, 125.0, 70.0, 130.0, 210.0, -120.0, 260.0, 10.0, 280.0, 170.0, 50.0, 60.0, 20.0, 0.0, 0.0, 180.0, 50.0, 0.0, 160.0, 100.0, 150.0, 180.0, 120.0, 20.0, 90.0, 720.0, 105.0, 30.0, 60.0, 0.0, 200.0, 0.0, 40.0, 40.0, 170.0, 0.0, 10.0, 260.0, 260.0, 100.0, 20.0, 310.0, 180.0, 70.0, 70.0, 90.0, -10.0, 40.0, 90.0, 10.0, 20.0, 0.0, 40.0, 100.0, 20.0, 170.0, 70.0, 190.0, 40.0, 130.0, 50.0, 70.0, 90.0, 50.0, 40.0, 200.0, 30.0, 0.0, -25.0, 150.0, -130.0, 40.0, 10.0, 190.0, 10.0, 260.0, 80.0, 210.0, 20.0, 610.0, -40.0, 10.0, 20.0, -560.0, 30.0, 20.0, 50.0, 60.0, 220.0, 30.0, 50.0, 40.0, 150.0, 150.0, 65.0, 460.0, 80.0, 60.0, 220.0, 0.0, 870.0, 60.0, 30.0, 190.0, 0.0, 210.0, 60.0, 190.0, 80.0, 150.0, 270.0, 50.0, 0.0, 100.0, 100.0, 20.0, 50.0, 170.0, 80.0, 20.0, 60.0, 500.0, 60.0, 120.0, -80.0, 290.0, 230.0, 30.0, 10.0, 40.0, -5.0, -20.0, 30.0, 410.0, 170.0, 40.0, 30.0, 170.0, 70.0, 40.0, 30.0, 20.0, 60.0, 30.0, 290.0, 20.0, 110.0, 80.0, 30.0, 90.0, 150.0, 50.0, 250.0, 40.0, 140.0, 310.0, 80.0, 0.0, 90.0, 80.0, 200.0, 390.0, 300.0, 80.0, 190.0, 50.0, 220.0, 90.0, 220.0, 40.0, 40.0, 560.0, -50.0, 30.0, 430.0, 100.0, 40.0, 120.0, 330.0, 50.0, 40.0, 100.0, 180.0, 100.0, 500.0, 30.0, 40.0, 60.0, 35.0, 20.0, 0.0, 50.0, 70.0, 575.0, 10.0, 150.0, 110.0, 20.0, 10.0, 160.0, 0.0, 10.0, 20.0, 0.0, 170.0, 10.0, 210.0, 80.0, 50.0, -20.0, 400.0, 180.0, 60.0, 100.0, 40.0, 110.0, 90.0, 20.0, 80.0, 210.0, 310.0, 350.0, 160.0, 160.0, 80.0, 20.0, 100.0, 70.0, 100.0, 30.0, 170.0, 20.0, 180.0, 100.0, 0.0, 160.0, 50.0, 40.0, 130.0, 380.0, 380.0, 50.0, 240.0, 150.0, 5.0, 110.0, 40.0, 40.0, 90.0, 70.0, 30.0, 0.0, 200.0, 90.0, 130.0, 140.0, 40.0, 220.0, 150.0, 110.0, 210.0, 160.0, 10.0, 40.0, 110.0, 180.0, 100.0, 20.0, 60.0, 110.0, 170.0, 190.0, 60.0, 390.0, 110.0, 130.0, 130.0, 110.0, 350.0, -15.0, 20.0, 30.0, 60.0, -15.0, 160.0, 160.0, 70.0, 60.0, 350.0, 80.0, 0.0, 50.0, 60.0, 110.0, 160.0, 100.0, 60.0, 140.0, 10.0, 90.0, 40.0, 40.0, 40.0, 90.0, 60.0, 30.0, 110.0, 190.0, 390.0, 130.0, 90.0, 520.0, 70.0, 110.0, 110.0, 150.0, 150.0, 30.0, 80.0, 150.0, 30.0, -30.0, 80.0, 20.0, 330.0, 160.0, 210.0, 20.0, 330.0, 30.0, 20.0, 0.0, 20.0, 10.0, 80.0, 50.0, 20.0, 70.0, -80.0, 30.0, 480.0, 30.0, 70.0, 10.0, 110.0, 80.0, 80.0, 70.0, 40.0, 60.0, 130.0, 200.0, 30.0, 310.0, 0.0, 100.0, 170.0, 60.0, 190.0, 190.0, 200.0, 60.0, 55.0, 180.0, 180.0, 190.0, -50.0, 280.0, 100.0, 100.0, 0.0, 80.0, 60.0, 150.0, 20.0, 30.0, 320.0, 130.0, 480.0, -15.0, 100.0, 30.0, 30.0, 20.0, 30.0, 100.0, 110.0, 120.0, 70.0, 30.0, 170.0, 320.0, 160.0, 120.0, 70.0, 60.0, 20.0, 100.0, 80.0, 80.0, 80.0, 160.0, 80.0, 320.0, -210.0, 130.0, 150.0, 10.0, 10.0, 90.0, 0.0, 60.0, 0.0, 20.0, 40.0, 80.0, 10.0, 40.0, 90.0, 90.0, 300.0, 170.0, 80.0, 30.0, -500.0, 170.0, 90.0, 10.0, 120.0, 140.0, 90.0, 40.0, 40.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, -5.0, 0.0, 40.0, 50.0, 0.0, 160.0, 90.0, 270.0, 70.0, 140.0, 250.0, 40.0, 15.0, 200.0, 10.0, 480.0, 40.0, 200.0, 50.0, -10.0, 30.0, 240.0, 50.0, 80.0, 590.0, 130.0, 210.0, 60.0, 90.0, 20.0, 20.0, 10.0, 0.0, 60.0, 30.0, 160.0, 10.0, 20.0, 20.0, 30.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 50.0, 20.0, 200.0, 500.0, 40.0, 20.0, 0.0, 40.0, 100.0, 10.0, 50.0, 40.0, 110.0, 120.0, 10.0, 430.0, 290.0, 110.0, 210.0, 10.0, 80.0, 10.0, 180.0, 100.0, 150.0, 230.0, 90.0, 280.0, 600.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6724227974782833, "mean_inference_ms": 1.4909434594066016, "mean_action_processing_ms": 0.42605143044360927, "mean_env_wait_ms": 1.3451583090499724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012810468673706055, "StateBufferConnector_ms": 0.011367321014404297, "ViewRequirementAgentConnector_ms": 0.41771483421325684}, "num_episodes": 18, "episode_return_max": 1910.0, "episode_return_min": 220.0, "episode_return_mean": 1026.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.084413714850253, "num_env_steps_trained_throughput_per_sec": 19.084413714850253, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 3680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3680000, "timers": {"training_iteration_time_ms": 208641.966, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208641.917, "sample_time_ms": 2707.55, "learn_time_ms": 205913.617, "learn_throughput": 19.426, "synch_weights_time_ms": 13.14}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "done": false, "training_iteration": 92, "trial_id": "aa996_00000", "date": "2024-05-24_04-05-10", "timestamp": 1716537910, "time_this_iter_s": 209.60431098937988, "time_total_s": 19176.354845523834, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d70a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19176.354845523834, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 27.333670033670035, "ram_util_percent": 79.47441077441079}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.450758119119496, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.131121799663995, "policy_loss": -0.007990603654854163, "vf_loss": 7.137930499504423, "vf_explained_var": -0.00012338778462272864, "kl": 0.005909514326665573, "entropy": 0.31582223810612586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 868575.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": 210.0, "episode_reward_mean": 1080.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -560.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 108.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1120.0, 640.0, 760.0, 1260.0, 1050.0, 1165.0, 1630.0, 1140.0, 1190.0, 840.0, 1470.0, 1220.0, 1050.0, 1120.0, 1050.0, 420.0, 625.0, 950.0, 1490.0, 1145.0, 1060.0, 1150.0, 1540.0, 1350.0, 1700.0, 1200.0, 1380.0, 640.0, 540.0, 1570.0, 910.0, 820.0, 1645.0, 550.0, 1350.0, 560.0, 890.0, 585.0, 370.0, 1305.0, 1700.0, 1010.0, 1450.0, 735.0, 840.0, 1220.0, 1600.0, 1500.0, 1490.0, 1080.0, 610.0, 1090.0, 1490.0, 880.0, 1525.0, 830.0, 1290.0, 1370.0, 930.0, 1030.0, 650.0, 1910.0, 1060.0, 580.0, 880.0, 1110.0, 1255.0, 1140.0, 1015.0, 1140.0, 970.0, 320.0, 560.0, 500.0, 295.0, 1565.0, 1400.0, 660.0, 220.0, 980.0, 1380.0, 1740.0, 1315.0, 560.0, 925.0, 1395.0, 1050.0, 1420.0, 420.0, 1310.0, 1590.0, 1370.0, 1360.0, 1350.0, 210.0, 1640.0, 830.0, 1190.0, 1370.0, 1310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 590.0, -10.0, 260.0, 30.0, 60.0, 160.0, 0.0, -40.0, 40.0, 0.0, 110.0, 20.0, 270.0, 60.0, 30.0, 170.0, -10.0, 0.0, -10.0, 440.0, 10.0, 0.0, 30.0, -10.0, 100.0, 20.0, 20.0, 20.0, 130.0, 130.0, 90.0, 180.0, 60.0, 40.0, 80.0, 300.0, 80.0, 30.0, 270.0, 90.0, 40.0, 70.0, 70.0, 210.0, 360.0, 40.0, 100.0, 40.0, 30.0, 100.0, 50.0, 50.0, 60.0, 270.0, -75.0, 80.0, 390.0, 80.0, 160.0, 60.0, 220.0, 340.0, 200.0, 70.0, 100.0, 290.0, 50.0, 260.0, 40.0, 280.0, 140.0, 70.0, 110.0, -20.0, 220.0, 230.0, 20.0, 40.0, 50.0, 290.0, 20.0, 40.0, 10.0, 100.0, -10.0, 40.0, 0.0, 350.0, 350.0, 20.0, 260.0, 100.0, 10.0, 160.0, 250.0, 40.0, 20.0, -20.0, 0.0, 120.0, 80.0, 40.0, 60.0, 20.0, 410.0, 150.0, 330.0, 140.0, 120.0, 0.0, 20.0, 20.0, 130.0, 150.0, 280.0, 220.0, 160.0, 190.0, 50.0, 40.0, 100.0, 30.0, 80.0, 100.0, 20.0, 390.0, 160.0, 30.0, 100.0, 300.0, 60.0, 70.0, 50.0, 150.0, 400.0, 0.0, 20.0, 40.0, 30.0, 110.0, 80.0, 40.0, 190.0, 40.0, 110.0, 40.0, -30.0, 170.0, 300.0, 10.0, 110.0, 0.0, -170.0, 240.0, 70.0, 10.0, 70.0, 40.0, 40.0, 60.0, 20.0, 100.0, 60.0, 10.0, 80.0, 210.0, 40.0, 10.0, 35.0, 100.0, 0.0, 40.0, 70.0, 110.0, 200.0, 220.0, 40.0, 150.0, 20.0, 230.0, 120.0, -20.0, -10.0, 330.0, 60.0, 50.0, 310.0, 30.0, 390.0, 380.0, 40.0, 35.0, -30.0, 450.0, 180.0, -110.0, 40.0, 120.0, 40.0, 150.0, 120.0, 210.0, 80.0, 130.0, 30.0, 0.0, 50.0, 70.0, 220.0, 120.0, 60.0, 60.0, 50.0, 230.0, 150.0, 340.0, 10.0, 150.0, -20.0, 330.0, 130.0, 210.0, 50.0, 80.0, 480.0, 120.0, 70.0, 10.0, 60.0, 340.0, 80.0, 330.0, 30.0, 20.0, 120.0, 100.0, 140.0, 20.0, 170.0, 370.0, 0.0, 510.0, 80.0, 160.0, 60.0, 120.0, 130.0, 270.0, 0.0, 20.0, 0.0, 330.0, 240.0, 20.0, 120.0, 150.0, 170.0, 90.0, 60.0, 380.0, -100.0, 80.0, 70.0, 40.0, 160.0, 750.0, -130.0, 40.0, 90.0, 40.0, 80.0, 30.0, 90.0, 0.0, 100.0, 100.0, 80.0, 30.0, 90.0, 0.0, 10.0, 0.0, 10.0, 70.0, 170.0, 200.0, 0.0, 30.0, 50.0, 30.0, 160.0, 720.0, 100.0, 100.0, 200.0, 10.0, 130.0, 70.0, 50.0, 170.0, 10.0, 80.0, -25.0, 125.0, 70.0, 130.0, 210.0, -120.0, 260.0, 10.0, 280.0, 170.0, 50.0, 60.0, 20.0, 0.0, 0.0, 180.0, 50.0, 0.0, 160.0, 100.0, 150.0, 180.0, 120.0, 20.0, 90.0, 720.0, 105.0, 30.0, 60.0, 0.0, 200.0, 0.0, 40.0, 40.0, 170.0, 0.0, 10.0, 260.0, 260.0, 100.0, 20.0, 310.0, 180.0, 70.0, 70.0, 90.0, -10.0, 40.0, 90.0, 10.0, 20.0, 0.0, 40.0, 100.0, 20.0, 170.0, 70.0, 190.0, 40.0, 130.0, 50.0, 70.0, 90.0, 50.0, 40.0, 200.0, 30.0, 0.0, -25.0, 150.0, -130.0, 40.0, 10.0, 190.0, 10.0, 260.0, 80.0, 210.0, 20.0, 610.0, -40.0, 10.0, 20.0, -560.0, 30.0, 20.0, 50.0, 60.0, 220.0, 30.0, 50.0, 40.0, 150.0, 150.0, 65.0, 460.0, 80.0, 60.0, 220.0, 0.0, 870.0, 60.0, 30.0, 190.0, 0.0, 210.0, 60.0, 190.0, 80.0, 150.0, 270.0, 50.0, 0.0, 100.0, 100.0, 20.0, 50.0, 170.0, 80.0, 20.0, 60.0, 500.0, 60.0, 120.0, -80.0, 290.0, 230.0, 30.0, 10.0, 40.0, -5.0, -20.0, 30.0, 410.0, 170.0, 40.0, 30.0, 170.0, 70.0, 40.0, 30.0, 20.0, 60.0, 30.0, 290.0, 20.0, 110.0, 80.0, 30.0, 90.0, 150.0, 50.0, 250.0, 40.0, 140.0, 310.0, 80.0, 0.0, 90.0, 80.0, 200.0, 390.0, 300.0, 80.0, 190.0, 50.0, 220.0, 90.0, 220.0, 40.0, 40.0, 560.0, -50.0, 30.0, 430.0, 100.0, 40.0, 120.0, 330.0, 50.0, 40.0, 100.0, 180.0, 100.0, 500.0, 30.0, 40.0, 60.0, 35.0, 20.0, 0.0, 50.0, 70.0, 575.0, 10.0, 150.0, 110.0, 20.0, 10.0, 160.0, 0.0, 10.0, 20.0, 0.0, 170.0, 10.0, 210.0, 80.0, 50.0, -20.0, 400.0, 180.0, 60.0, 100.0, 40.0, 110.0, 90.0, 20.0, 80.0, 210.0, 310.0, 350.0, 160.0, 160.0, 80.0, 20.0, 100.0, 70.0, 100.0, 30.0, 170.0, 20.0, 180.0, 100.0, 0.0, 160.0, 50.0, 40.0, 130.0, 380.0, 380.0, 50.0, 240.0, 150.0, 5.0, 110.0, 40.0, 40.0, 90.0, 70.0, 30.0, 0.0, 200.0, 90.0, 130.0, 140.0, 40.0, 220.0, 150.0, 110.0, 210.0, 160.0, 10.0, 40.0, 110.0, 180.0, 100.0, 20.0, 60.0, 110.0, 170.0, 190.0, 60.0, 390.0, 110.0, 130.0, 130.0, 110.0, 350.0, -15.0, 20.0, 30.0, 60.0, -15.0, 160.0, 160.0, 70.0, 60.0, 350.0, 80.0, 0.0, 50.0, 60.0, 110.0, 160.0, 100.0, 60.0, 140.0, 10.0, 90.0, 40.0, 40.0, 40.0, 90.0, 60.0, 30.0, 110.0, 190.0, 390.0, 130.0, 90.0, 520.0, 70.0, 110.0, 110.0, 150.0, 150.0, 30.0, 80.0, 150.0, 30.0, -30.0, 80.0, 20.0, 330.0, 160.0, 210.0, 20.0, 330.0, 30.0, 20.0, 0.0, 20.0, 10.0, 80.0, 50.0, 20.0, 70.0, -80.0, 30.0, 480.0, 30.0, 70.0, 10.0, 110.0, 80.0, 80.0, 70.0, 40.0, 60.0, 130.0, 200.0, 30.0, 310.0, 0.0, 100.0, 170.0, 60.0, 190.0, 190.0, 200.0, 60.0, 55.0, 180.0, 180.0, 190.0, -50.0, 280.0, 100.0, 100.0, 0.0, 80.0, 60.0, 150.0, 20.0, 30.0, 320.0, 130.0, 480.0, -15.0, 100.0, 30.0, 30.0, 20.0, 30.0, 100.0, 110.0, 120.0, 70.0, 30.0, 170.0, 320.0, 160.0, 120.0, 70.0, 60.0, 20.0, 100.0, 80.0, 80.0, 80.0, 160.0, 80.0, 320.0, -210.0, 130.0, 150.0, 10.0, 10.0, 90.0, 0.0, 60.0, 0.0, 20.0, 40.0, 80.0, 10.0, 40.0, 90.0, 90.0, 300.0, 170.0, 80.0, 30.0, -500.0, 170.0, 90.0, 10.0, 120.0, 140.0, 90.0, 40.0, 40.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, -5.0, 0.0, 40.0, 50.0, 0.0, 160.0, 90.0, 270.0, 70.0, 140.0, 250.0, 40.0, 15.0, 200.0, 10.0, 480.0, 40.0, 200.0, 50.0, -10.0, 30.0, 240.0, 50.0, 80.0, 590.0, 130.0, 210.0, 60.0, 90.0, 20.0, 20.0, 10.0, 0.0, 60.0, 30.0, 160.0, 10.0, 20.0, 20.0, 30.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 50.0, 20.0, 200.0, 500.0, 40.0, 20.0, 0.0, 40.0, 100.0, 10.0, 50.0, 40.0, 110.0, 120.0, 10.0, 430.0, 290.0, 110.0, 210.0, 10.0, 80.0, 10.0, 180.0, 100.0, 150.0, 230.0, 90.0, 280.0, 600.0, 20.0, 100.0, 40.0, 30.0, 30.0, 30.0, 500.0, 190.0, 390.0, 20.0, -15.0, 0.0, 20.0, 260.0, 70.0, 10.0, 90.0, 0.0, 60.0, 40.0, 10.0, 200.0, 100.0, 90.0, 80.0, 70.0, 40.0, 100.0, 35.0, 20.0, 190.0, 35.0, 140.0, 180.0, 280.0, 40.0, 40.0, 80.0, 180.0, 220.0, 200.0, 40.0, 150.0, 20.0, 130.0, 20.0, 50.0, 180.0, 40.0, 30.0, 390.0, 80.0, 40.0, 100.0, 250.0, 280.0, 70.0, 120.0, 190.0, 110.0, 180.0, 0.0, 245.0, 90.0, 160.0, -55.0, -5.0, -5.0, -50.0, 40.0, 0.0, 40.0, 110.0, 0.0, 70.0, 0.0, 390.0, 80.0, 80.0, 90.0, 450.0, 140.0, 0.0, 100.0, 70.0, 40.0, 10.0, 290.0, 120.0, 390.0, 430.0, 10.0, 250.0, 10.0, 190.0, 180.0, 150.0, 200.0, 80.0, 20.0, 280.0, 30.0, 10.0, 30.0, 170.0, 30.0, 80.0, -5.0, 155.0, 260.0, 600.0, 250.0, 90.0, 60.0, 300.0, 80.0, 90.0, 70.0, 240.0, 80.0, 90.0, 10.0, 0.0, 0.0, 80.0, 20.0, 20.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 310.0, 400.0, 20.0, 320.0, 340.0, 80.0, 80.0, 50.0, 420.0, 10.0, 10.0, 30.0, 40.0, 0.0, 30.0, 100.0, 140.0, 150.0, 430.0, 210.0, 70.0, 120.0, 200.0, -80.0, 40.0, 20.0, 30.0, 110.0, 320.0, 80.0, 150.0, 140.0, 35.0, 190.0, 250.0, 45.0, 50.0, 170.0, 50.0, 240.0, 80.0, 60.0, 160.0, 80.0, 340.0, 60.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6724174336128996, "mean_inference_ms": 1.4908530572699255, "mean_action_processing_ms": 0.425982255269054, "mean_env_wait_ms": 1.345022488317499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013036966323852539, "StateBufferConnector_ms": 0.012049674987792969, "ViewRequirementAgentConnector_ms": 0.4970817565917969}, "num_episodes": 18, "episode_return_max": 1910.0, "episode_return_min": 210.0, "episode_return_mean": 1080.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.905610478412108, "num_env_steps_trained_throughput_per_sec": 18.905610478412108, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 3720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3720000, "timers": {"training_iteration_time_ms": 209111.017, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209110.97, "sample_time_ms": 2716.595, "learn_time_ms": 206372.836, "learn_throughput": 19.382, "synch_weights_time_ms": 13.443}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "done": false, "training_iteration": 93, "trial_id": "aa996_00000", "date": "2024-05-24_04-08-41", "timestamp": 1716538121, "time_this_iter_s": 211.60319995880127, "time_total_s": 19387.958045482635, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19387.958045482635, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 27.939130434782605, "ram_util_percent": 79.58026755852843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2580845931975353, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.761506278319354, "policy_loss": -0.006381986084834527, "vf_loss": 6.766684553849177, "vf_explained_var": 0.00022957089483039702, "kl": 0.006018498023393442, "entropy": 0.34734261515009773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 877965.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": -570.0, "episode_reward_mean": 1048.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -1140.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 104.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1540.0, 1350.0, 1700.0, 1200.0, 1380.0, 640.0, 540.0, 1570.0, 910.0, 820.0, 1645.0, 550.0, 1350.0, 560.0, 890.0, 585.0, 370.0, 1305.0, 1700.0, 1010.0, 1450.0, 735.0, 840.0, 1220.0, 1600.0, 1500.0, 1490.0, 1080.0, 610.0, 1090.0, 1490.0, 880.0, 1525.0, 830.0, 1290.0, 1370.0, 930.0, 1030.0, 650.0, 1910.0, 1060.0, 580.0, 880.0, 1110.0, 1255.0, 1140.0, 1015.0, 1140.0, 970.0, 320.0, 560.0, 500.0, 295.0, 1565.0, 1400.0, 660.0, 220.0, 980.0, 1380.0, 1740.0, 1315.0, 560.0, 925.0, 1395.0, 1050.0, 1420.0, 420.0, 1310.0, 1590.0, 1370.0, 1360.0, 1350.0, 210.0, 1640.0, 830.0, 1190.0, 1370.0, 1310.0, 1150.0, 950.0, 600.0, 840.0, 850.0, 1000.0, 1280.0, 1110.0, 730.0, 1855.0, 695.0, 1105.0, 1020.0, 770.0, 1040.0, 1100.0, 960.0, 1490.0, 770.0, -570.0, 750.0, 805.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [330.0, 130.0, 210.0, 50.0, 80.0, 480.0, 120.0, 70.0, 10.0, 60.0, 340.0, 80.0, 330.0, 30.0, 20.0, 120.0, 100.0, 140.0, 20.0, 170.0, 370.0, 0.0, 510.0, 80.0, 160.0, 60.0, 120.0, 130.0, 270.0, 0.0, 20.0, 0.0, 330.0, 240.0, 20.0, 120.0, 150.0, 170.0, 90.0, 60.0, 380.0, -100.0, 80.0, 70.0, 40.0, 160.0, 750.0, -130.0, 40.0, 90.0, 40.0, 80.0, 30.0, 90.0, 0.0, 100.0, 100.0, 80.0, 30.0, 90.0, 0.0, 10.0, 0.0, 10.0, 70.0, 170.0, 200.0, 0.0, 30.0, 50.0, 30.0, 160.0, 720.0, 100.0, 100.0, 200.0, 10.0, 130.0, 70.0, 50.0, 170.0, 10.0, 80.0, -25.0, 125.0, 70.0, 130.0, 210.0, -120.0, 260.0, 10.0, 280.0, 170.0, 50.0, 60.0, 20.0, 0.0, 0.0, 180.0, 50.0, 0.0, 160.0, 100.0, 150.0, 180.0, 120.0, 20.0, 90.0, 720.0, 105.0, 30.0, 60.0, 0.0, 200.0, 0.0, 40.0, 40.0, 170.0, 0.0, 10.0, 260.0, 260.0, 100.0, 20.0, 310.0, 180.0, 70.0, 70.0, 90.0, -10.0, 40.0, 90.0, 10.0, 20.0, 0.0, 40.0, 100.0, 20.0, 170.0, 70.0, 190.0, 40.0, 130.0, 50.0, 70.0, 90.0, 50.0, 40.0, 200.0, 30.0, 0.0, -25.0, 150.0, -130.0, 40.0, 10.0, 190.0, 10.0, 260.0, 80.0, 210.0, 20.0, 610.0, -40.0, 10.0, 20.0, -560.0, 30.0, 20.0, 50.0, 60.0, 220.0, 30.0, 50.0, 40.0, 150.0, 150.0, 65.0, 460.0, 80.0, 60.0, 220.0, 0.0, 870.0, 60.0, 30.0, 190.0, 0.0, 210.0, 60.0, 190.0, 80.0, 150.0, 270.0, 50.0, 0.0, 100.0, 100.0, 20.0, 50.0, 170.0, 80.0, 20.0, 60.0, 500.0, 60.0, 120.0, -80.0, 290.0, 230.0, 30.0, 10.0, 40.0, -5.0, -20.0, 30.0, 410.0, 170.0, 40.0, 30.0, 170.0, 70.0, 40.0, 30.0, 20.0, 60.0, 30.0, 290.0, 20.0, 110.0, 80.0, 30.0, 90.0, 150.0, 50.0, 250.0, 40.0, 140.0, 310.0, 80.0, 0.0, 90.0, 80.0, 200.0, 390.0, 300.0, 80.0, 190.0, 50.0, 220.0, 90.0, 220.0, 40.0, 40.0, 560.0, -50.0, 30.0, 430.0, 100.0, 40.0, 120.0, 330.0, 50.0, 40.0, 100.0, 180.0, 100.0, 500.0, 30.0, 40.0, 60.0, 35.0, 20.0, 0.0, 50.0, 70.0, 575.0, 10.0, 150.0, 110.0, 20.0, 10.0, 160.0, 0.0, 10.0, 20.0, 0.0, 170.0, 10.0, 210.0, 80.0, 50.0, -20.0, 400.0, 180.0, 60.0, 100.0, 40.0, 110.0, 90.0, 20.0, 80.0, 210.0, 310.0, 350.0, 160.0, 160.0, 80.0, 20.0, 100.0, 70.0, 100.0, 30.0, 170.0, 20.0, 180.0, 100.0, 0.0, 160.0, 50.0, 40.0, 130.0, 380.0, 380.0, 50.0, 240.0, 150.0, 5.0, 110.0, 40.0, 40.0, 90.0, 70.0, 30.0, 0.0, 200.0, 90.0, 130.0, 140.0, 40.0, 220.0, 150.0, 110.0, 210.0, 160.0, 10.0, 40.0, 110.0, 180.0, 100.0, 20.0, 60.0, 110.0, 170.0, 190.0, 60.0, 390.0, 110.0, 130.0, 130.0, 110.0, 350.0, -15.0, 20.0, 30.0, 60.0, -15.0, 160.0, 160.0, 70.0, 60.0, 350.0, 80.0, 0.0, 50.0, 60.0, 110.0, 160.0, 100.0, 60.0, 140.0, 10.0, 90.0, 40.0, 40.0, 40.0, 90.0, 60.0, 30.0, 110.0, 190.0, 390.0, 130.0, 90.0, 520.0, 70.0, 110.0, 110.0, 150.0, 150.0, 30.0, 80.0, 150.0, 30.0, -30.0, 80.0, 20.0, 330.0, 160.0, 210.0, 20.0, 330.0, 30.0, 20.0, 0.0, 20.0, 10.0, 80.0, 50.0, 20.0, 70.0, -80.0, 30.0, 480.0, 30.0, 70.0, 10.0, 110.0, 80.0, 80.0, 70.0, 40.0, 60.0, 130.0, 200.0, 30.0, 310.0, 0.0, 100.0, 170.0, 60.0, 190.0, 190.0, 200.0, 60.0, 55.0, 180.0, 180.0, 190.0, -50.0, 280.0, 100.0, 100.0, 0.0, 80.0, 60.0, 150.0, 20.0, 30.0, 320.0, 130.0, 480.0, -15.0, 100.0, 30.0, 30.0, 20.0, 30.0, 100.0, 110.0, 120.0, 70.0, 30.0, 170.0, 320.0, 160.0, 120.0, 70.0, 60.0, 20.0, 100.0, 80.0, 80.0, 80.0, 160.0, 80.0, 320.0, -210.0, 130.0, 150.0, 10.0, 10.0, 90.0, 0.0, 60.0, 0.0, 20.0, 40.0, 80.0, 10.0, 40.0, 90.0, 90.0, 300.0, 170.0, 80.0, 30.0, -500.0, 170.0, 90.0, 10.0, 120.0, 140.0, 90.0, 40.0, 40.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, -5.0, 0.0, 40.0, 50.0, 0.0, 160.0, 90.0, 270.0, 70.0, 140.0, 250.0, 40.0, 15.0, 200.0, 10.0, 480.0, 40.0, 200.0, 50.0, -10.0, 30.0, 240.0, 50.0, 80.0, 590.0, 130.0, 210.0, 60.0, 90.0, 20.0, 20.0, 10.0, 0.0, 60.0, 30.0, 160.0, 10.0, 20.0, 20.0, 30.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 50.0, 20.0, 200.0, 500.0, 40.0, 20.0, 0.0, 40.0, 100.0, 10.0, 50.0, 40.0, 110.0, 120.0, 10.0, 430.0, 290.0, 110.0, 210.0, 10.0, 80.0, 10.0, 180.0, 100.0, 150.0, 230.0, 90.0, 280.0, 600.0, 20.0, 100.0, 40.0, 30.0, 30.0, 30.0, 500.0, 190.0, 390.0, 20.0, -15.0, 0.0, 20.0, 260.0, 70.0, 10.0, 90.0, 0.0, 60.0, 40.0, 10.0, 200.0, 100.0, 90.0, 80.0, 70.0, 40.0, 100.0, 35.0, 20.0, 190.0, 35.0, 140.0, 180.0, 280.0, 40.0, 40.0, 80.0, 180.0, 220.0, 200.0, 40.0, 150.0, 20.0, 130.0, 20.0, 50.0, 180.0, 40.0, 30.0, 390.0, 80.0, 40.0, 100.0, 250.0, 280.0, 70.0, 120.0, 190.0, 110.0, 180.0, 0.0, 245.0, 90.0, 160.0, -55.0, -5.0, -5.0, -50.0, 40.0, 0.0, 40.0, 110.0, 0.0, 70.0, 0.0, 390.0, 80.0, 80.0, 90.0, 450.0, 140.0, 0.0, 100.0, 70.0, 40.0, 10.0, 290.0, 120.0, 390.0, 430.0, 10.0, 250.0, 10.0, 190.0, 180.0, 150.0, 200.0, 80.0, 20.0, 280.0, 30.0, 10.0, 30.0, 170.0, 30.0, 80.0, -5.0, 155.0, 260.0, 600.0, 250.0, 90.0, 60.0, 300.0, 80.0, 90.0, 70.0, 240.0, 80.0, 90.0, 10.0, 0.0, 0.0, 80.0, 20.0, 20.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 310.0, 400.0, 20.0, 320.0, 340.0, 80.0, 80.0, 50.0, 420.0, 10.0, 10.0, 30.0, 40.0, 0.0, 30.0, 100.0, 140.0, 150.0, 430.0, 210.0, 70.0, 120.0, 200.0, -80.0, 40.0, 20.0, 30.0, 110.0, 320.0, 80.0, 150.0, 140.0, 35.0, 190.0, 250.0, 45.0, 50.0, 170.0, 50.0, 240.0, 80.0, 60.0, 160.0, 80.0, 340.0, 60.0, 70.0, 110.0, 140.0, 0.0, 30.0, 120.0, 60.0, 430.0, 100.0, 10.0, 150.0, 340.0, 80.0, 80.0, 110.0, 30.0, 60.0, 80.0, 80.0, 70.0, 20.0, 0.0, -30.0, -60.0, 30.0, 210.0, 110.0, -30.0, 310.0, 50.0, 10.0, 10.0, 100.0, 40.0, 10.0, 40.0, 190.0, 150.0, 100.0, 50.0, 150.0, 30.0, 170.0, 130.0, 30.0, 30.0, 0.0, 170.0, 270.0, -20.0, 40.0, 130.0, 80.0, 100.0, 50.0, 100.0, 20.0, 70.0, 30.0, 290.0, 130.0, 50.0, 280.0, 10.0, 90.0, 330.0, 0.0, 100.0, 70.0, 220.0, 130.0, 30.0, 80.0, 90.0, 120.0, 180.0, 90.0, 330.0, 120.0, -30.0, 100.0, 90.0, 20.0, 30.0, 10.0, 160.0, 90.0, 0.0, 250.0, 60.0, 20.0, 15.0, -20.0, 130.0, 170.0, 0.0, 120.0, 410.0, 370.0, 130.0, 530.0, 320.0, 10.0, -10.0, 70.0, 5.0, 40.0, 10.0, 80.0, 10.0, 160.0, 25.0, 30.0, 0.0, 170.0, 170.0, 100.0, 120.0, 60.0, 410.0, 20.0, 20.0, 470.0, 70.0, 20.0, 70.0, 50.0, 160.0, 20.0, 50.0, 90.0, 30.0, 90.0, 0.0, 200.0, 30.0, 30.0, 20.0, 160.0, 70.0, 140.0, 80.0, 130.0, 300.0, 100.0, 80.0, 100.0, 120.0, 250.0, 40.0, -160.0, 250.0, 70.0, -50.0, 10.0, 110.0, 90.0, 370.0, 20.0, 80.0, 150.0, 40.0, 60.0, 220.0, 100.0, 120.0, 290.0, 280.0, -200.0, 40.0, 10.0, -10.0, 90.0, 40.0, 230.0, 50.0, 250.0, 320.0, 310.0, 230.0, -20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 10.0, 0.0, 40.0, 370.0, 130.0, 10.0, 130.0, 0.0, 150.0, 10.0, -1140.0, 100.0, 50.0, 120.0, 0.0, 30.0, 110.0, 90.0, 10.0, 100.0, 40.0, 30.0, 30.0, 30.0, 280.0, 290.0, 190.0, 55.0, 80.0, 20.0, 90.0, 0.0, 40.0, 40.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6724639643765382, "mean_inference_ms": 1.4910356435917642, "mean_action_processing_ms": 0.42594405642843747, "mean_env_wait_ms": 1.3449385189100704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013218879699707031, "StateBufferConnector_ms": 0.011843442916870117, "ViewRequirementAgentConnector_ms": 0.5011553764343262}, "num_episodes": 22, "episode_return_max": 1910.0, "episode_return_min": -570.0, "episode_return_mean": 1048.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.046295435326563, "num_env_steps_trained_throughput_per_sec": 19.046295435326563, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 3760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3760000, "timers": {"training_iteration_time_ms": 209274.894, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209274.846, "sample_time_ms": 2729.522, "learn_time_ms": 206524.592, "learn_throughput": 19.368, "synch_weights_time_ms": 13.253}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "done": false, "training_iteration": 94, "trial_id": "aa996_00000", "date": "2024-05-24_04-12-11", "timestamp": 1716538331, "time_this_iter_s": 210.03036999702454, "time_total_s": 19597.98841547966, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x16003e310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19597.98841547966, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 27.446127946127945, "ram_util_percent": 79.15185185185184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.762689325102348, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.052775517210793, "policy_loss": -0.007449958653980717, "vf_loss": 7.059010290210874, "vf_explained_var": 0.0007829921377606539, "kl": 0.0060759405535927005, "entropy": 0.33623082007462984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 887355.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "env_runners": {"episode_reward_max": 1990.0, "episode_reward_min": -570.0, "episode_reward_mean": 1055.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -1140.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 105.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1700.0, 1010.0, 1450.0, 735.0, 840.0, 1220.0, 1600.0, 1500.0, 1490.0, 1080.0, 610.0, 1090.0, 1490.0, 880.0, 1525.0, 830.0, 1290.0, 1370.0, 930.0, 1030.0, 650.0, 1910.0, 1060.0, 580.0, 880.0, 1110.0, 1255.0, 1140.0, 1015.0, 1140.0, 970.0, 320.0, 560.0, 500.0, 295.0, 1565.0, 1400.0, 660.0, 220.0, 980.0, 1380.0, 1740.0, 1315.0, 560.0, 925.0, 1395.0, 1050.0, 1420.0, 420.0, 1310.0, 1590.0, 1370.0, 1360.0, 1350.0, 210.0, 1640.0, 830.0, 1190.0, 1370.0, 1310.0, 1150.0, 950.0, 600.0, 840.0, 850.0, 1000.0, 1280.0, 1110.0, 730.0, 1855.0, 695.0, 1105.0, 1020.0, 770.0, 1040.0, 1100.0, 960.0, 1490.0, 770.0, -570.0, 750.0, 805.0, 1260.0, 530.0, 1570.0, 1220.0, 460.0, 1290.0, 970.0, 220.0, 1300.0, 350.0, 1540.0, 1990.0, 1600.0, 1050.0, 640.0, 1120.0, 1220.0, 1310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 220.0, 0.0, 870.0, 60.0, 30.0, 190.0, 0.0, 210.0, 60.0, 190.0, 80.0, 150.0, 270.0, 50.0, 0.0, 100.0, 100.0, 20.0, 50.0, 170.0, 80.0, 20.0, 60.0, 500.0, 60.0, 120.0, -80.0, 290.0, 230.0, 30.0, 10.0, 40.0, -5.0, -20.0, 30.0, 410.0, 170.0, 40.0, 30.0, 170.0, 70.0, 40.0, 30.0, 20.0, 60.0, 30.0, 290.0, 20.0, 110.0, 80.0, 30.0, 90.0, 150.0, 50.0, 250.0, 40.0, 140.0, 310.0, 80.0, 0.0, 90.0, 80.0, 200.0, 390.0, 300.0, 80.0, 190.0, 50.0, 220.0, 90.0, 220.0, 40.0, 40.0, 560.0, -50.0, 30.0, 430.0, 100.0, 40.0, 120.0, 330.0, 50.0, 40.0, 100.0, 180.0, 100.0, 500.0, 30.0, 40.0, 60.0, 35.0, 20.0, 0.0, 50.0, 70.0, 575.0, 10.0, 150.0, 110.0, 20.0, 10.0, 160.0, 0.0, 10.0, 20.0, 0.0, 170.0, 10.0, 210.0, 80.0, 50.0, -20.0, 400.0, 180.0, 60.0, 100.0, 40.0, 110.0, 90.0, 20.0, 80.0, 210.0, 310.0, 350.0, 160.0, 160.0, 80.0, 20.0, 100.0, 70.0, 100.0, 30.0, 170.0, 20.0, 180.0, 100.0, 0.0, 160.0, 50.0, 40.0, 130.0, 380.0, 380.0, 50.0, 240.0, 150.0, 5.0, 110.0, 40.0, 40.0, 90.0, 70.0, 30.0, 0.0, 200.0, 90.0, 130.0, 140.0, 40.0, 220.0, 150.0, 110.0, 210.0, 160.0, 10.0, 40.0, 110.0, 180.0, 100.0, 20.0, 60.0, 110.0, 170.0, 190.0, 60.0, 390.0, 110.0, 130.0, 130.0, 110.0, 350.0, -15.0, 20.0, 30.0, 60.0, -15.0, 160.0, 160.0, 70.0, 60.0, 350.0, 80.0, 0.0, 50.0, 60.0, 110.0, 160.0, 100.0, 60.0, 140.0, 10.0, 90.0, 40.0, 40.0, 40.0, 90.0, 60.0, 30.0, 110.0, 190.0, 390.0, 130.0, 90.0, 520.0, 70.0, 110.0, 110.0, 150.0, 150.0, 30.0, 80.0, 150.0, 30.0, -30.0, 80.0, 20.0, 330.0, 160.0, 210.0, 20.0, 330.0, 30.0, 20.0, 0.0, 20.0, 10.0, 80.0, 50.0, 20.0, 70.0, -80.0, 30.0, 480.0, 30.0, 70.0, 10.0, 110.0, 80.0, 80.0, 70.0, 40.0, 60.0, 130.0, 200.0, 30.0, 310.0, 0.0, 100.0, 170.0, 60.0, 190.0, 190.0, 200.0, 60.0, 55.0, 180.0, 180.0, 190.0, -50.0, 280.0, 100.0, 100.0, 0.0, 80.0, 60.0, 150.0, 20.0, 30.0, 320.0, 130.0, 480.0, -15.0, 100.0, 30.0, 30.0, 20.0, 30.0, 100.0, 110.0, 120.0, 70.0, 30.0, 170.0, 320.0, 160.0, 120.0, 70.0, 60.0, 20.0, 100.0, 80.0, 80.0, 80.0, 160.0, 80.0, 320.0, -210.0, 130.0, 150.0, 10.0, 10.0, 90.0, 0.0, 60.0, 0.0, 20.0, 40.0, 80.0, 10.0, 40.0, 90.0, 90.0, 300.0, 170.0, 80.0, 30.0, -500.0, 170.0, 90.0, 10.0, 120.0, 140.0, 90.0, 40.0, 40.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, -5.0, 0.0, 40.0, 50.0, 0.0, 160.0, 90.0, 270.0, 70.0, 140.0, 250.0, 40.0, 15.0, 200.0, 10.0, 480.0, 40.0, 200.0, 50.0, -10.0, 30.0, 240.0, 50.0, 80.0, 590.0, 130.0, 210.0, 60.0, 90.0, 20.0, 20.0, 10.0, 0.0, 60.0, 30.0, 160.0, 10.0, 20.0, 20.0, 30.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 50.0, 20.0, 200.0, 500.0, 40.0, 20.0, 0.0, 40.0, 100.0, 10.0, 50.0, 40.0, 110.0, 120.0, 10.0, 430.0, 290.0, 110.0, 210.0, 10.0, 80.0, 10.0, 180.0, 100.0, 150.0, 230.0, 90.0, 280.0, 600.0, 20.0, 100.0, 40.0, 30.0, 30.0, 30.0, 500.0, 190.0, 390.0, 20.0, -15.0, 0.0, 20.0, 260.0, 70.0, 10.0, 90.0, 0.0, 60.0, 40.0, 10.0, 200.0, 100.0, 90.0, 80.0, 70.0, 40.0, 100.0, 35.0, 20.0, 190.0, 35.0, 140.0, 180.0, 280.0, 40.0, 40.0, 80.0, 180.0, 220.0, 200.0, 40.0, 150.0, 20.0, 130.0, 20.0, 50.0, 180.0, 40.0, 30.0, 390.0, 80.0, 40.0, 100.0, 250.0, 280.0, 70.0, 120.0, 190.0, 110.0, 180.0, 0.0, 245.0, 90.0, 160.0, -55.0, -5.0, -5.0, -50.0, 40.0, 0.0, 40.0, 110.0, 0.0, 70.0, 0.0, 390.0, 80.0, 80.0, 90.0, 450.0, 140.0, 0.0, 100.0, 70.0, 40.0, 10.0, 290.0, 120.0, 390.0, 430.0, 10.0, 250.0, 10.0, 190.0, 180.0, 150.0, 200.0, 80.0, 20.0, 280.0, 30.0, 10.0, 30.0, 170.0, 30.0, 80.0, -5.0, 155.0, 260.0, 600.0, 250.0, 90.0, 60.0, 300.0, 80.0, 90.0, 70.0, 240.0, 80.0, 90.0, 10.0, 0.0, 0.0, 80.0, 20.0, 20.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 310.0, 400.0, 20.0, 320.0, 340.0, 80.0, 80.0, 50.0, 420.0, 10.0, 10.0, 30.0, 40.0, 0.0, 30.0, 100.0, 140.0, 150.0, 430.0, 210.0, 70.0, 120.0, 200.0, -80.0, 40.0, 20.0, 30.0, 110.0, 320.0, 80.0, 150.0, 140.0, 35.0, 190.0, 250.0, 45.0, 50.0, 170.0, 50.0, 240.0, 80.0, 60.0, 160.0, 80.0, 340.0, 60.0, 70.0, 110.0, 140.0, 0.0, 30.0, 120.0, 60.0, 430.0, 100.0, 10.0, 150.0, 340.0, 80.0, 80.0, 110.0, 30.0, 60.0, 80.0, 80.0, 70.0, 20.0, 0.0, -30.0, -60.0, 30.0, 210.0, 110.0, -30.0, 310.0, 50.0, 10.0, 10.0, 100.0, 40.0, 10.0, 40.0, 190.0, 150.0, 100.0, 50.0, 150.0, 30.0, 170.0, 130.0, 30.0, 30.0, 0.0, 170.0, 270.0, -20.0, 40.0, 130.0, 80.0, 100.0, 50.0, 100.0, 20.0, 70.0, 30.0, 290.0, 130.0, 50.0, 280.0, 10.0, 90.0, 330.0, 0.0, 100.0, 70.0, 220.0, 130.0, 30.0, 80.0, 90.0, 120.0, 180.0, 90.0, 330.0, 120.0, -30.0, 100.0, 90.0, 20.0, 30.0, 10.0, 160.0, 90.0, 0.0, 250.0, 60.0, 20.0, 15.0, -20.0, 130.0, 170.0, 0.0, 120.0, 410.0, 370.0, 130.0, 530.0, 320.0, 10.0, -10.0, 70.0, 5.0, 40.0, 10.0, 80.0, 10.0, 160.0, 25.0, 30.0, 0.0, 170.0, 170.0, 100.0, 120.0, 60.0, 410.0, 20.0, 20.0, 470.0, 70.0, 20.0, 70.0, 50.0, 160.0, 20.0, 50.0, 90.0, 30.0, 90.0, 0.0, 200.0, 30.0, 30.0, 20.0, 160.0, 70.0, 140.0, 80.0, 130.0, 300.0, 100.0, 80.0, 100.0, 120.0, 250.0, 40.0, -160.0, 250.0, 70.0, -50.0, 10.0, 110.0, 90.0, 370.0, 20.0, 80.0, 150.0, 40.0, 60.0, 220.0, 100.0, 120.0, 290.0, 280.0, -200.0, 40.0, 10.0, -10.0, 90.0, 40.0, 230.0, 50.0, 250.0, 320.0, 310.0, 230.0, -20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 10.0, 0.0, 40.0, 370.0, 130.0, 10.0, 130.0, 0.0, 150.0, 10.0, -1140.0, 100.0, 50.0, 120.0, 0.0, 30.0, 110.0, 90.0, 10.0, 100.0, 40.0, 30.0, 30.0, 30.0, 280.0, 290.0, 190.0, 55.0, 80.0, 20.0, 90.0, 0.0, 40.0, 40.0, 0.0, 190.0, 80.0, 180.0, 360.0, 30.0, 30.0, 10.0, 200.0, 150.0, 30.0, 90.0, 10.0, 170.0, -10.0, -30.0, 60.0, 40.0, 190.0, -20.0, 30.0, 160.0, 90.0, 60.0, 120.0, 90.0, 510.0, 190.0, 10.0, 10.0, 330.0, 50.0, 70.0, 510.0, 170.0, 30.0, 60.0, 100.0, 20.0, 110.0, 100.0, 20.0, 160.0, 0.0, 30.0, 10.0, 60.0, 30.0, 40.0, 40.0, 70.0, 380.0, 80.0, 150.0, 50.0, 450.0, 110.0, 60.0, -30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 180.0, 0.0, 140.0, 30.0, 10.0, 490.0, 50.0, 0.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 40.0, 30.0, 210.0, 30.0, 40.0, 160.0, 50.0, 0.0, 130.0, 400.0, 250.0, 20.0, 0.0, 110.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 70.0, 240.0, 90.0, 170.0, 250.0, 160.0, 260.0, 20.0, 300.0, 0.0, 50.0, 450.0, 50.0, 120.0, 130.0, 250.0, 70.0, 160.0, 20.0, 380.0, 360.0, 200.0, 140.0, 30.0, 110.0, 0.0, 450.0, 500.0, 50.0, 50.0, 70.0, 420.0, 10.0, 10.0, 90.0, 20.0, 90.0, -50.0, -40.0, 40.0, 460.0, 10.0, 110.0, -20.0, 80.0, 180.0, 20.0, 10.0, 180.0, 20.0, 50.0, -30.0, -30.0, 140.0, 60.0, 140.0, 580.0, 60.0, 140.0, 0.0, 60.0, 190.0, 20.0, 170.0, 140.0, 90.0, 210.0, -10.0, 50.0, 310.0, 50.0, 70.0, 30.0, 120.0, 50.0, 230.0, 130.0, 190.0, 220.0, 230.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.672600445715982, "mean_inference_ms": 1.4915564531942322, "mean_action_processing_ms": 0.4259584043216652, "mean_env_wait_ms": 1.345111596323426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013217449188232422, "StateBufferConnector_ms": 0.012126684188842773, "ViewRequirementAgentConnector_ms": 0.49779415130615234}, "num_episodes": 18, "episode_return_max": 1990.0, "episode_return_min": -570.0, "episode_return_mean": 1055.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.07750460369214, "num_env_steps_trained_throughput_per_sec": 19.07750460369214, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 3800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3800000, "timers": {"training_iteration_time_ms": 209274.457, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209274.409, "sample_time_ms": 2742.387, "learn_time_ms": 206511.053, "learn_throughput": 19.369, "synch_weights_time_ms": 13.472}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "done": false, "training_iteration": 95, "trial_id": "aa996_00000", "date": "2024-05-24_04-15-41", "timestamp": 1716538541, "time_this_iter_s": 209.67800903320312, "time_total_s": 19807.666424512863, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19807.666424512863, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 27.36835016835017, "ram_util_percent": 78.80909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.455505663626237, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.722119613196522, "policy_loss": -0.009289705570706854, "vf_loss": 7.73021233094513, "vf_explained_var": -0.0013622887916585253, "kl": 0.005984953105805869, "entropy": 0.3274924652216534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 896745.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "env_runners": {"episode_reward_max": 1990.0, "episode_reward_min": -570.0, "episode_reward_mean": 1073.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -1140.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 107.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [580.0, 880.0, 1110.0, 1255.0, 1140.0, 1015.0, 1140.0, 970.0, 320.0, 560.0, 500.0, 295.0, 1565.0, 1400.0, 660.0, 220.0, 980.0, 1380.0, 1740.0, 1315.0, 560.0, 925.0, 1395.0, 1050.0, 1420.0, 420.0, 1310.0, 1590.0, 1370.0, 1360.0, 1350.0, 210.0, 1640.0, 830.0, 1190.0, 1370.0, 1310.0, 1150.0, 950.0, 600.0, 840.0, 850.0, 1000.0, 1280.0, 1110.0, 730.0, 1855.0, 695.0, 1105.0, 1020.0, 770.0, 1040.0, 1100.0, 960.0, 1490.0, 770.0, -570.0, 750.0, 805.0, 1260.0, 530.0, 1570.0, 1220.0, 460.0, 1290.0, 970.0, 220.0, 1300.0, 350.0, 1540.0, 1990.0, 1600.0, 1050.0, 640.0, 1120.0, 1220.0, 1310.0, 1205.0, 905.0, 1600.0, 1230.0, 1340.0, 1240.0, 1970.0, 700.0, 1420.0, 1130.0, 1320.0, 1240.0, 1875.0, 1145.0, 70.0, 1620.0, 1375.0, 1190.0, 1650.0, 1100.0, 1745.0, 1160.0, 890.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 330.0, 30.0, 20.0, 0.0, 20.0, 10.0, 80.0, 50.0, 20.0, 70.0, -80.0, 30.0, 480.0, 30.0, 70.0, 10.0, 110.0, 80.0, 80.0, 70.0, 40.0, 60.0, 130.0, 200.0, 30.0, 310.0, 0.0, 100.0, 170.0, 60.0, 190.0, 190.0, 200.0, 60.0, 55.0, 180.0, 180.0, 190.0, -50.0, 280.0, 100.0, 100.0, 0.0, 80.0, 60.0, 150.0, 20.0, 30.0, 320.0, 130.0, 480.0, -15.0, 100.0, 30.0, 30.0, 20.0, 30.0, 100.0, 110.0, 120.0, 70.0, 30.0, 170.0, 320.0, 160.0, 120.0, 70.0, 60.0, 20.0, 100.0, 80.0, 80.0, 80.0, 160.0, 80.0, 320.0, -210.0, 130.0, 150.0, 10.0, 10.0, 90.0, 0.0, 60.0, 0.0, 20.0, 40.0, 80.0, 10.0, 40.0, 90.0, 90.0, 300.0, 170.0, 80.0, 30.0, -500.0, 170.0, 90.0, 10.0, 120.0, 140.0, 90.0, 40.0, 40.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, -5.0, 0.0, 40.0, 50.0, 0.0, 160.0, 90.0, 270.0, 70.0, 140.0, 250.0, 40.0, 15.0, 200.0, 10.0, 480.0, 40.0, 200.0, 50.0, -10.0, 30.0, 240.0, 50.0, 80.0, 590.0, 130.0, 210.0, 60.0, 90.0, 20.0, 20.0, 10.0, 0.0, 60.0, 30.0, 160.0, 10.0, 20.0, 20.0, 30.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 50.0, 20.0, 200.0, 500.0, 40.0, 20.0, 0.0, 40.0, 100.0, 10.0, 50.0, 40.0, 110.0, 120.0, 10.0, 430.0, 290.0, 110.0, 210.0, 10.0, 80.0, 10.0, 180.0, 100.0, 150.0, 230.0, 90.0, 280.0, 600.0, 20.0, 100.0, 40.0, 30.0, 30.0, 30.0, 500.0, 190.0, 390.0, 20.0, -15.0, 0.0, 20.0, 260.0, 70.0, 10.0, 90.0, 0.0, 60.0, 40.0, 10.0, 200.0, 100.0, 90.0, 80.0, 70.0, 40.0, 100.0, 35.0, 20.0, 190.0, 35.0, 140.0, 180.0, 280.0, 40.0, 40.0, 80.0, 180.0, 220.0, 200.0, 40.0, 150.0, 20.0, 130.0, 20.0, 50.0, 180.0, 40.0, 30.0, 390.0, 80.0, 40.0, 100.0, 250.0, 280.0, 70.0, 120.0, 190.0, 110.0, 180.0, 0.0, 245.0, 90.0, 160.0, -55.0, -5.0, -5.0, -50.0, 40.0, 0.0, 40.0, 110.0, 0.0, 70.0, 0.0, 390.0, 80.0, 80.0, 90.0, 450.0, 140.0, 0.0, 100.0, 70.0, 40.0, 10.0, 290.0, 120.0, 390.0, 430.0, 10.0, 250.0, 10.0, 190.0, 180.0, 150.0, 200.0, 80.0, 20.0, 280.0, 30.0, 10.0, 30.0, 170.0, 30.0, 80.0, -5.0, 155.0, 260.0, 600.0, 250.0, 90.0, 60.0, 300.0, 80.0, 90.0, 70.0, 240.0, 80.0, 90.0, 10.0, 0.0, 0.0, 80.0, 20.0, 20.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 310.0, 400.0, 20.0, 320.0, 340.0, 80.0, 80.0, 50.0, 420.0, 10.0, 10.0, 30.0, 40.0, 0.0, 30.0, 100.0, 140.0, 150.0, 430.0, 210.0, 70.0, 120.0, 200.0, -80.0, 40.0, 20.0, 30.0, 110.0, 320.0, 80.0, 150.0, 140.0, 35.0, 190.0, 250.0, 45.0, 50.0, 170.0, 50.0, 240.0, 80.0, 60.0, 160.0, 80.0, 340.0, 60.0, 70.0, 110.0, 140.0, 0.0, 30.0, 120.0, 60.0, 430.0, 100.0, 10.0, 150.0, 340.0, 80.0, 80.0, 110.0, 30.0, 60.0, 80.0, 80.0, 70.0, 20.0, 0.0, -30.0, -60.0, 30.0, 210.0, 110.0, -30.0, 310.0, 50.0, 10.0, 10.0, 100.0, 40.0, 10.0, 40.0, 190.0, 150.0, 100.0, 50.0, 150.0, 30.0, 170.0, 130.0, 30.0, 30.0, 0.0, 170.0, 270.0, -20.0, 40.0, 130.0, 80.0, 100.0, 50.0, 100.0, 20.0, 70.0, 30.0, 290.0, 130.0, 50.0, 280.0, 10.0, 90.0, 330.0, 0.0, 100.0, 70.0, 220.0, 130.0, 30.0, 80.0, 90.0, 120.0, 180.0, 90.0, 330.0, 120.0, -30.0, 100.0, 90.0, 20.0, 30.0, 10.0, 160.0, 90.0, 0.0, 250.0, 60.0, 20.0, 15.0, -20.0, 130.0, 170.0, 0.0, 120.0, 410.0, 370.0, 130.0, 530.0, 320.0, 10.0, -10.0, 70.0, 5.0, 40.0, 10.0, 80.0, 10.0, 160.0, 25.0, 30.0, 0.0, 170.0, 170.0, 100.0, 120.0, 60.0, 410.0, 20.0, 20.0, 470.0, 70.0, 20.0, 70.0, 50.0, 160.0, 20.0, 50.0, 90.0, 30.0, 90.0, 0.0, 200.0, 30.0, 30.0, 20.0, 160.0, 70.0, 140.0, 80.0, 130.0, 300.0, 100.0, 80.0, 100.0, 120.0, 250.0, 40.0, -160.0, 250.0, 70.0, -50.0, 10.0, 110.0, 90.0, 370.0, 20.0, 80.0, 150.0, 40.0, 60.0, 220.0, 100.0, 120.0, 290.0, 280.0, -200.0, 40.0, 10.0, -10.0, 90.0, 40.0, 230.0, 50.0, 250.0, 320.0, 310.0, 230.0, -20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 10.0, 0.0, 40.0, 370.0, 130.0, 10.0, 130.0, 0.0, 150.0, 10.0, -1140.0, 100.0, 50.0, 120.0, 0.0, 30.0, 110.0, 90.0, 10.0, 100.0, 40.0, 30.0, 30.0, 30.0, 280.0, 290.0, 190.0, 55.0, 80.0, 20.0, 90.0, 0.0, 40.0, 40.0, 0.0, 190.0, 80.0, 180.0, 360.0, 30.0, 30.0, 10.0, 200.0, 150.0, 30.0, 90.0, 10.0, 170.0, -10.0, -30.0, 60.0, 40.0, 190.0, -20.0, 30.0, 160.0, 90.0, 60.0, 120.0, 90.0, 510.0, 190.0, 10.0, 10.0, 330.0, 50.0, 70.0, 510.0, 170.0, 30.0, 60.0, 100.0, 20.0, 110.0, 100.0, 20.0, 160.0, 0.0, 30.0, 10.0, 60.0, 30.0, 40.0, 40.0, 70.0, 380.0, 80.0, 150.0, 50.0, 450.0, 110.0, 60.0, -30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 180.0, 0.0, 140.0, 30.0, 10.0, 490.0, 50.0, 0.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 40.0, 30.0, 210.0, 30.0, 40.0, 160.0, 50.0, 0.0, 130.0, 400.0, 250.0, 20.0, 0.0, 110.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 70.0, 240.0, 90.0, 170.0, 250.0, 160.0, 260.0, 20.0, 300.0, 0.0, 50.0, 450.0, 50.0, 120.0, 130.0, 250.0, 70.0, 160.0, 20.0, 380.0, 360.0, 200.0, 140.0, 30.0, 110.0, 0.0, 450.0, 500.0, 50.0, 50.0, 70.0, 420.0, 10.0, 10.0, 90.0, 20.0, 90.0, -50.0, -40.0, 40.0, 460.0, 10.0, 110.0, -20.0, 80.0, 180.0, 20.0, 10.0, 180.0, 20.0, 50.0, -30.0, -30.0, 140.0, 60.0, 140.0, 580.0, 60.0, 140.0, 0.0, 60.0, 190.0, 20.0, 170.0, 140.0, 90.0, 210.0, -10.0, 50.0, 310.0, 50.0, 70.0, 30.0, 120.0, 50.0, 230.0, 130.0, 190.0, 220.0, 230.0, 40.0, 320.0, 80.0, 350.0, 30.0, 40.0, 60.0, 50.0, 10.0, 185.0, 80.0, 10.0, 15.0, 300.0, -75.0, 30.0, 390.0, 90.0, 50.0, 80.0, 15.0, 260.0, 790.0, 140.0, 100.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 90.0, 320.0, 190.0, 60.0, 160.0, 300.0, 0.0, 80.0, 30.0, 0.0, 60.0, 20.0, 60.0, 160.0, 30.0, 500.0, 60.0, 190.0, 170.0, 90.0, 120.0, 120.0, 110.0, 300.0, 100.0, 70.0, 180.0, 50.0, 50.0, 140.0, 10.0, 300.0, 120.0, 290.0, 540.0, 70.0, 80.0, 70.0, 270.0, 220.0, 190.0, 40.0, -30.0, 70.0, 20.0, 70.0, 0.0, 80.0, 100.0, 160.0, 130.0, 45.0, 40.0, 40.0, 600.0, 40.0, 40.0, 25.0, 100.0, 360.0, 290.0, 200.0, 20.0, 30.0, 40.0, 90.0, 370.0, 30.0, 70.0, -10.0, 310.0, 40.0, 50.0, 160.0, 0.0, 360.0, -10.0, 190.0, 100.0, 120.0, 360.0, 70.0, 50.0, 90.0, 120.0, 220.0, 10.0, 70.0, -40.0, 290.0, 230.0, 0.0, 730.0, 0.0, 130.0, 380.0, 25.0, 310.0, 20.0, 50.0, 220.0, 370.0, 100.0, 5.0, -20.0, 180.0, 220.0, 40.0, 0.0, 30.0, 150.0, -35.0, -65.0, 30.0, -105.0, 150.0, 20.0, -70.0, -65.0, 60.0, 10.0, 20.0, 420.0, 80.0, 120.0, 130.0, 20.0, 300.0, 140.0, 380.0, 160.0, 150.0, 50.0, 80.0, 110.0, 130.0, -245.0, 80.0, 40.0, 820.0, 30.0, 170.0, 120.0, 120.0, 250.0, 40.0, 80.0, 20.0, 0.0, 360.0, 190.0, 30.0, 330.0, 350.0, 270.0, 70.0, 170.0, -20.0, 310.0, -50.0, 160.0, 80.0, 20.0, 0.0, 120.0, 90.0, 250.0, 50.0, 120.0, 210.0, 150.0, 110.0, -25.0, 20.0, 450.0, 70.0, 580.0, 160.0, 110.0, 120.0, 40.0, 250.0, 110.0, 60.0, 110.0, 70.0, 60.0, 70.0, 300.0, 90.0, 130.0, 30.0, 20.0, 20.0, 210.0, 210.0, 110.0, 130.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.672892749286219, "mean_inference_ms": 1.4925386409558927, "mean_action_processing_ms": 0.4260609189291052, "mean_env_wait_ms": 1.3456084691140677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013385772705078125, "StateBufferConnector_ms": 0.011341094970703125, "ViewRequirementAgentConnector_ms": 0.48895740509033203}, "num_episodes": 23, "episode_return_max": 1990.0, "episode_return_min": -570.0, "episode_return_mean": 1073.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.100467586109236, "num_env_steps_trained_throughput_per_sec": 19.100467586109236, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 3840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3840000, "timers": {"training_iteration_time_ms": 209265.842, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209265.795, "sample_time_ms": 2747.51, "learn_time_ms": 206497.169, "learn_throughput": 19.371, "synch_weights_time_ms": 13.59}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "done": false, "training_iteration": 96, "trial_id": "aa996_00000", "date": "2024-05-24_04-19-10", "timestamp": 1716538750, "time_this_iter_s": 209.42678809165955, "time_total_s": 20017.093212604523, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d6dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20017.093212604523, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 26.87195945945946, "ram_util_percent": 79.4902027027027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7308503581756476, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00749660623931803, "vf_loss": 7.537668730224918, "vf_explained_var": -0.0010603414747280815, "kl": Infinity, "entropy": 0.32330289026196646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 906135.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "env_runners": {"episode_reward_max": 1990.0, "episode_reward_min": -570.0, "episode_reward_mean": 1111.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -1140.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 111.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1740.0, 1315.0, 560.0, 925.0, 1395.0, 1050.0, 1420.0, 420.0, 1310.0, 1590.0, 1370.0, 1360.0, 1350.0, 210.0, 1640.0, 830.0, 1190.0, 1370.0, 1310.0, 1150.0, 950.0, 600.0, 840.0, 850.0, 1000.0, 1280.0, 1110.0, 730.0, 1855.0, 695.0, 1105.0, 1020.0, 770.0, 1040.0, 1100.0, 960.0, 1490.0, 770.0, -570.0, 750.0, 805.0, 1260.0, 530.0, 1570.0, 1220.0, 460.0, 1290.0, 970.0, 220.0, 1300.0, 350.0, 1540.0, 1990.0, 1600.0, 1050.0, 640.0, 1120.0, 1220.0, 1310.0, 1205.0, 905.0, 1600.0, 1230.0, 1340.0, 1240.0, 1970.0, 700.0, 1420.0, 1130.0, 1320.0, 1240.0, 1875.0, 1145.0, 70.0, 1620.0, 1375.0, 1190.0, 1650.0, 1100.0, 1745.0, 1160.0, 890.0, 755.0, 1000.0, 1180.0, 800.0, 1620.0, 1280.0, 1035.0, 730.0, 780.0, 710.0, 1375.0, 1455.0, 1380.0, 1255.0, 1300.0, 1570.0, 1020.0, 460.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 10.0, 180.0, 100.0, 150.0, 230.0, 90.0, 280.0, 600.0, 20.0, 100.0, 40.0, 30.0, 30.0, 30.0, 500.0, 190.0, 390.0, 20.0, -15.0, 0.0, 20.0, 260.0, 70.0, 10.0, 90.0, 0.0, 60.0, 40.0, 10.0, 200.0, 100.0, 90.0, 80.0, 70.0, 40.0, 100.0, 35.0, 20.0, 190.0, 35.0, 140.0, 180.0, 280.0, 40.0, 40.0, 80.0, 180.0, 220.0, 200.0, 40.0, 150.0, 20.0, 130.0, 20.0, 50.0, 180.0, 40.0, 30.0, 390.0, 80.0, 40.0, 100.0, 250.0, 280.0, 70.0, 120.0, 190.0, 110.0, 180.0, 0.0, 245.0, 90.0, 160.0, -55.0, -5.0, -5.0, -50.0, 40.0, 0.0, 40.0, 110.0, 0.0, 70.0, 0.0, 390.0, 80.0, 80.0, 90.0, 450.0, 140.0, 0.0, 100.0, 70.0, 40.0, 10.0, 290.0, 120.0, 390.0, 430.0, 10.0, 250.0, 10.0, 190.0, 180.0, 150.0, 200.0, 80.0, 20.0, 280.0, 30.0, 10.0, 30.0, 170.0, 30.0, 80.0, -5.0, 155.0, 260.0, 600.0, 250.0, 90.0, 60.0, 300.0, 80.0, 90.0, 70.0, 240.0, 80.0, 90.0, 10.0, 0.0, 0.0, 80.0, 20.0, 20.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 310.0, 400.0, 20.0, 320.0, 340.0, 80.0, 80.0, 50.0, 420.0, 10.0, 10.0, 30.0, 40.0, 0.0, 30.0, 100.0, 140.0, 150.0, 430.0, 210.0, 70.0, 120.0, 200.0, -80.0, 40.0, 20.0, 30.0, 110.0, 320.0, 80.0, 150.0, 140.0, 35.0, 190.0, 250.0, 45.0, 50.0, 170.0, 50.0, 240.0, 80.0, 60.0, 160.0, 80.0, 340.0, 60.0, 70.0, 110.0, 140.0, 0.0, 30.0, 120.0, 60.0, 430.0, 100.0, 10.0, 150.0, 340.0, 80.0, 80.0, 110.0, 30.0, 60.0, 80.0, 80.0, 70.0, 20.0, 0.0, -30.0, -60.0, 30.0, 210.0, 110.0, -30.0, 310.0, 50.0, 10.0, 10.0, 100.0, 40.0, 10.0, 40.0, 190.0, 150.0, 100.0, 50.0, 150.0, 30.0, 170.0, 130.0, 30.0, 30.0, 0.0, 170.0, 270.0, -20.0, 40.0, 130.0, 80.0, 100.0, 50.0, 100.0, 20.0, 70.0, 30.0, 290.0, 130.0, 50.0, 280.0, 10.0, 90.0, 330.0, 0.0, 100.0, 70.0, 220.0, 130.0, 30.0, 80.0, 90.0, 120.0, 180.0, 90.0, 330.0, 120.0, -30.0, 100.0, 90.0, 20.0, 30.0, 10.0, 160.0, 90.0, 0.0, 250.0, 60.0, 20.0, 15.0, -20.0, 130.0, 170.0, 0.0, 120.0, 410.0, 370.0, 130.0, 530.0, 320.0, 10.0, -10.0, 70.0, 5.0, 40.0, 10.0, 80.0, 10.0, 160.0, 25.0, 30.0, 0.0, 170.0, 170.0, 100.0, 120.0, 60.0, 410.0, 20.0, 20.0, 470.0, 70.0, 20.0, 70.0, 50.0, 160.0, 20.0, 50.0, 90.0, 30.0, 90.0, 0.0, 200.0, 30.0, 30.0, 20.0, 160.0, 70.0, 140.0, 80.0, 130.0, 300.0, 100.0, 80.0, 100.0, 120.0, 250.0, 40.0, -160.0, 250.0, 70.0, -50.0, 10.0, 110.0, 90.0, 370.0, 20.0, 80.0, 150.0, 40.0, 60.0, 220.0, 100.0, 120.0, 290.0, 280.0, -200.0, 40.0, 10.0, -10.0, 90.0, 40.0, 230.0, 50.0, 250.0, 320.0, 310.0, 230.0, -20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 10.0, 0.0, 40.0, 370.0, 130.0, 10.0, 130.0, 0.0, 150.0, 10.0, -1140.0, 100.0, 50.0, 120.0, 0.0, 30.0, 110.0, 90.0, 10.0, 100.0, 40.0, 30.0, 30.0, 30.0, 280.0, 290.0, 190.0, 55.0, 80.0, 20.0, 90.0, 0.0, 40.0, 40.0, 0.0, 190.0, 80.0, 180.0, 360.0, 30.0, 30.0, 10.0, 200.0, 150.0, 30.0, 90.0, 10.0, 170.0, -10.0, -30.0, 60.0, 40.0, 190.0, -20.0, 30.0, 160.0, 90.0, 60.0, 120.0, 90.0, 510.0, 190.0, 10.0, 10.0, 330.0, 50.0, 70.0, 510.0, 170.0, 30.0, 60.0, 100.0, 20.0, 110.0, 100.0, 20.0, 160.0, 0.0, 30.0, 10.0, 60.0, 30.0, 40.0, 40.0, 70.0, 380.0, 80.0, 150.0, 50.0, 450.0, 110.0, 60.0, -30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 180.0, 0.0, 140.0, 30.0, 10.0, 490.0, 50.0, 0.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 40.0, 30.0, 210.0, 30.0, 40.0, 160.0, 50.0, 0.0, 130.0, 400.0, 250.0, 20.0, 0.0, 110.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 70.0, 240.0, 90.0, 170.0, 250.0, 160.0, 260.0, 20.0, 300.0, 0.0, 50.0, 450.0, 50.0, 120.0, 130.0, 250.0, 70.0, 160.0, 20.0, 380.0, 360.0, 200.0, 140.0, 30.0, 110.0, 0.0, 450.0, 500.0, 50.0, 50.0, 70.0, 420.0, 10.0, 10.0, 90.0, 20.0, 90.0, -50.0, -40.0, 40.0, 460.0, 10.0, 110.0, -20.0, 80.0, 180.0, 20.0, 10.0, 180.0, 20.0, 50.0, -30.0, -30.0, 140.0, 60.0, 140.0, 580.0, 60.0, 140.0, 0.0, 60.0, 190.0, 20.0, 170.0, 140.0, 90.0, 210.0, -10.0, 50.0, 310.0, 50.0, 70.0, 30.0, 120.0, 50.0, 230.0, 130.0, 190.0, 220.0, 230.0, 40.0, 320.0, 80.0, 350.0, 30.0, 40.0, 60.0, 50.0, 10.0, 185.0, 80.0, 10.0, 15.0, 300.0, -75.0, 30.0, 390.0, 90.0, 50.0, 80.0, 15.0, 260.0, 790.0, 140.0, 100.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 90.0, 320.0, 190.0, 60.0, 160.0, 300.0, 0.0, 80.0, 30.0, 0.0, 60.0, 20.0, 60.0, 160.0, 30.0, 500.0, 60.0, 190.0, 170.0, 90.0, 120.0, 120.0, 110.0, 300.0, 100.0, 70.0, 180.0, 50.0, 50.0, 140.0, 10.0, 300.0, 120.0, 290.0, 540.0, 70.0, 80.0, 70.0, 270.0, 220.0, 190.0, 40.0, -30.0, 70.0, 20.0, 70.0, 0.0, 80.0, 100.0, 160.0, 130.0, 45.0, 40.0, 40.0, 600.0, 40.0, 40.0, 25.0, 100.0, 360.0, 290.0, 200.0, 20.0, 30.0, 40.0, 90.0, 370.0, 30.0, 70.0, -10.0, 310.0, 40.0, 50.0, 160.0, 0.0, 360.0, -10.0, 190.0, 100.0, 120.0, 360.0, 70.0, 50.0, 90.0, 120.0, 220.0, 10.0, 70.0, -40.0, 290.0, 230.0, 0.0, 730.0, 0.0, 130.0, 380.0, 25.0, 310.0, 20.0, 50.0, 220.0, 370.0, 100.0, 5.0, -20.0, 180.0, 220.0, 40.0, 0.0, 30.0, 150.0, -35.0, -65.0, 30.0, -105.0, 150.0, 20.0, -70.0, -65.0, 60.0, 10.0, 20.0, 420.0, 80.0, 120.0, 130.0, 20.0, 300.0, 140.0, 380.0, 160.0, 150.0, 50.0, 80.0, 110.0, 130.0, -245.0, 80.0, 40.0, 820.0, 30.0, 170.0, 120.0, 120.0, 250.0, 40.0, 80.0, 20.0, 0.0, 360.0, 190.0, 30.0, 330.0, 350.0, 270.0, 70.0, 170.0, -20.0, 310.0, -50.0, 160.0, 80.0, 20.0, 0.0, 120.0, 90.0, 250.0, 50.0, 120.0, 210.0, 150.0, 110.0, -25.0, 20.0, 450.0, 70.0, 580.0, 160.0, 110.0, 120.0, 40.0, 250.0, 110.0, 60.0, 110.0, 70.0, 60.0, 70.0, 300.0, 90.0, 130.0, 30.0, 20.0, 20.0, 210.0, 210.0, 110.0, 130.0, 20.0, 10.0, 40.0, 80.0, -30.0, 45.0, 380.0, 30.0, 60.0, 0.0, 50.0, 100.0, 100.0, 360.0, 100.0, 80.0, 220.0, 80.0, 100.0, 80.0, -200.0, 80.0, 180.0, 75.0, 200.0, 120.0, 150.0, 140.0, 0.0, 75.0, 70.0, 170.0, 30.0, 30.0, 240.0, 60.0, 70.0, 60.0, 210.0, 50.0, 40.0, 10.0, 40.0, 300.0, -90.0, 220.0, 510.0, 80.0, 110.0, 70.0, 190.0, 190.0, 360.0, 170.0, 200.0, 70.0, 160.0, 20.0, 50.0, 50.0, 120.0, 80.0, 130.0, 40.0, 220.0, -10.0, -10.0, 470.0, -70.0, 15.0, -10.0, 260.0, 310.0, 30.0, -100.0, 30.0, 480.0, 10.0, 30.0, 20.0, -130.0, 50.0, 30.0, 20.0, 80.0, 180.0, 20.0, -90.0, 250.0, -80.0, -140.0, 510.0, 210.0, 30.0, 0.0, 120.0, 60.0, 20.0, 30.0, 25.0, 220.0, -5.0, 130.0, 55.0, 80.0, 160.0, 10.0, 80.0, 10.0, 210.0, 600.0, 40.0, 50.0, 50.0, 30.0, 10.0, 260.0, -5.0, 220.0, 100.0, 550.0, 190.0, 20.0, 200.0, 100.0, 120.0, 80.0, 160.0, 290.0, 270.0, 120.0, 20.0, 190.0, 170.0, 50.0, 170.0, 520.0, -5.0, 80.0, 20.0, -10.0, 70.0, 90.0, 40.0, 90.0, 70.0, 70.0, 310.0, 260.0, 210.0, 140.0, 20.0, 160.0, 70.0, 110.0, 90.0, 230.0, 10.0, 310.0, 270.0, 170.0, 150.0, 20.0, 40.0, 80.0, 20.0, 190.0, 10.0, 30.0, 90.0, 80.0, 460.0, 30.0, 0.0, 10.0, 120.0, 0.0, 40.0, 140.0, 60.0, 30.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6726415547677356, "mean_inference_ms": 1.4933183883953922, "mean_action_processing_ms": 0.4261717102516225, "mean_env_wait_ms": 1.346102262434848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013597726821899414, "StateBufferConnector_ms": 0.011908531188964844, "ViewRequirementAgentConnector_ms": 0.48843955993652344}, "num_episodes": 18, "episode_return_max": 1990.0, "episode_return_min": -570.0, "episode_return_mean": 1111.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.00893949898195, "num_env_steps_trained_throughput_per_sec": 19.00893949898195, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 3880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3880000, "timers": {"training_iteration_time_ms": 209402.154, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209402.106, "sample_time_ms": 2774.972, "learn_time_ms": 206606.327, "learn_throughput": 19.36, "synch_weights_time_ms": 13.146}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "done": false, "training_iteration": 97, "trial_id": "aa996_00000", "date": "2024-05-24_04-22-41", "timestamp": 1716538961, "time_this_iter_s": 210.45056581497192, "time_total_s": 20227.543778419495, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20227.543778419495, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 26.55503355704698, "ram_util_percent": 80.14463087248322}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3714783190030513, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008813240536683486, "vf_loss": 7.524919175086057, "vf_explained_var": -0.0021501390888287236, "kl": Infinity, "entropy": 0.32686475159419864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 915525.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "env_runners": {"episode_reward_max": 1990.0, "episode_reward_min": -570.0, "episode_reward_mean": 1087.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -1140.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 108.77}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1310.0, 1150.0, 950.0, 600.0, 840.0, 850.0, 1000.0, 1280.0, 1110.0, 730.0, 1855.0, 695.0, 1105.0, 1020.0, 770.0, 1040.0, 1100.0, 960.0, 1490.0, 770.0, -570.0, 750.0, 805.0, 1260.0, 530.0, 1570.0, 1220.0, 460.0, 1290.0, 970.0, 220.0, 1300.0, 350.0, 1540.0, 1990.0, 1600.0, 1050.0, 640.0, 1120.0, 1220.0, 1310.0, 1205.0, 905.0, 1600.0, 1230.0, 1340.0, 1240.0, 1970.0, 700.0, 1420.0, 1130.0, 1320.0, 1240.0, 1875.0, 1145.0, 70.0, 1620.0, 1375.0, 1190.0, 1650.0, 1100.0, 1745.0, 1160.0, 890.0, 755.0, 1000.0, 1180.0, 800.0, 1620.0, 1280.0, 1035.0, 730.0, 780.0, 710.0, 1375.0, 1455.0, 1380.0, 1255.0, 1300.0, 1570.0, 1020.0, 460.0, 1580.0, 1110.0, 840.0, 1120.0, 685.0, 1655.0, 1280.0, 870.0, 940.0, 1280.0, 1100.0, 1330.0, 960.0, 1350.0, 225.0, 1210.0, 190.0, 970.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 50.0, 240.0, 80.0, 60.0, 160.0, 80.0, 340.0, 60.0, 70.0, 110.0, 140.0, 0.0, 30.0, 120.0, 60.0, 430.0, 100.0, 10.0, 150.0, 340.0, 80.0, 80.0, 110.0, 30.0, 60.0, 80.0, 80.0, 70.0, 20.0, 0.0, -30.0, -60.0, 30.0, 210.0, 110.0, -30.0, 310.0, 50.0, 10.0, 10.0, 100.0, 40.0, 10.0, 40.0, 190.0, 150.0, 100.0, 50.0, 150.0, 30.0, 170.0, 130.0, 30.0, 30.0, 0.0, 170.0, 270.0, -20.0, 40.0, 130.0, 80.0, 100.0, 50.0, 100.0, 20.0, 70.0, 30.0, 290.0, 130.0, 50.0, 280.0, 10.0, 90.0, 330.0, 0.0, 100.0, 70.0, 220.0, 130.0, 30.0, 80.0, 90.0, 120.0, 180.0, 90.0, 330.0, 120.0, -30.0, 100.0, 90.0, 20.0, 30.0, 10.0, 160.0, 90.0, 0.0, 250.0, 60.0, 20.0, 15.0, -20.0, 130.0, 170.0, 0.0, 120.0, 410.0, 370.0, 130.0, 530.0, 320.0, 10.0, -10.0, 70.0, 5.0, 40.0, 10.0, 80.0, 10.0, 160.0, 25.0, 30.0, 0.0, 170.0, 170.0, 100.0, 120.0, 60.0, 410.0, 20.0, 20.0, 470.0, 70.0, 20.0, 70.0, 50.0, 160.0, 20.0, 50.0, 90.0, 30.0, 90.0, 0.0, 200.0, 30.0, 30.0, 20.0, 160.0, 70.0, 140.0, 80.0, 130.0, 300.0, 100.0, 80.0, 100.0, 120.0, 250.0, 40.0, -160.0, 250.0, 70.0, -50.0, 10.0, 110.0, 90.0, 370.0, 20.0, 80.0, 150.0, 40.0, 60.0, 220.0, 100.0, 120.0, 290.0, 280.0, -200.0, 40.0, 10.0, -10.0, 90.0, 40.0, 230.0, 50.0, 250.0, 320.0, 310.0, 230.0, -20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 10.0, 0.0, 40.0, 370.0, 130.0, 10.0, 130.0, 0.0, 150.0, 10.0, -1140.0, 100.0, 50.0, 120.0, 0.0, 30.0, 110.0, 90.0, 10.0, 100.0, 40.0, 30.0, 30.0, 30.0, 280.0, 290.0, 190.0, 55.0, 80.0, 20.0, 90.0, 0.0, 40.0, 40.0, 0.0, 190.0, 80.0, 180.0, 360.0, 30.0, 30.0, 10.0, 200.0, 150.0, 30.0, 90.0, 10.0, 170.0, -10.0, -30.0, 60.0, 40.0, 190.0, -20.0, 30.0, 160.0, 90.0, 60.0, 120.0, 90.0, 510.0, 190.0, 10.0, 10.0, 330.0, 50.0, 70.0, 510.0, 170.0, 30.0, 60.0, 100.0, 20.0, 110.0, 100.0, 20.0, 160.0, 0.0, 30.0, 10.0, 60.0, 30.0, 40.0, 40.0, 70.0, 380.0, 80.0, 150.0, 50.0, 450.0, 110.0, 60.0, -30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 180.0, 0.0, 140.0, 30.0, 10.0, 490.0, 50.0, 0.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 40.0, 30.0, 210.0, 30.0, 40.0, 160.0, 50.0, 0.0, 130.0, 400.0, 250.0, 20.0, 0.0, 110.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 70.0, 240.0, 90.0, 170.0, 250.0, 160.0, 260.0, 20.0, 300.0, 0.0, 50.0, 450.0, 50.0, 120.0, 130.0, 250.0, 70.0, 160.0, 20.0, 380.0, 360.0, 200.0, 140.0, 30.0, 110.0, 0.0, 450.0, 500.0, 50.0, 50.0, 70.0, 420.0, 10.0, 10.0, 90.0, 20.0, 90.0, -50.0, -40.0, 40.0, 460.0, 10.0, 110.0, -20.0, 80.0, 180.0, 20.0, 10.0, 180.0, 20.0, 50.0, -30.0, -30.0, 140.0, 60.0, 140.0, 580.0, 60.0, 140.0, 0.0, 60.0, 190.0, 20.0, 170.0, 140.0, 90.0, 210.0, -10.0, 50.0, 310.0, 50.0, 70.0, 30.0, 120.0, 50.0, 230.0, 130.0, 190.0, 220.0, 230.0, 40.0, 320.0, 80.0, 350.0, 30.0, 40.0, 60.0, 50.0, 10.0, 185.0, 80.0, 10.0, 15.0, 300.0, -75.0, 30.0, 390.0, 90.0, 50.0, 80.0, 15.0, 260.0, 790.0, 140.0, 100.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 90.0, 320.0, 190.0, 60.0, 160.0, 300.0, 0.0, 80.0, 30.0, 0.0, 60.0, 20.0, 60.0, 160.0, 30.0, 500.0, 60.0, 190.0, 170.0, 90.0, 120.0, 120.0, 110.0, 300.0, 100.0, 70.0, 180.0, 50.0, 50.0, 140.0, 10.0, 300.0, 120.0, 290.0, 540.0, 70.0, 80.0, 70.0, 270.0, 220.0, 190.0, 40.0, -30.0, 70.0, 20.0, 70.0, 0.0, 80.0, 100.0, 160.0, 130.0, 45.0, 40.0, 40.0, 600.0, 40.0, 40.0, 25.0, 100.0, 360.0, 290.0, 200.0, 20.0, 30.0, 40.0, 90.0, 370.0, 30.0, 70.0, -10.0, 310.0, 40.0, 50.0, 160.0, 0.0, 360.0, -10.0, 190.0, 100.0, 120.0, 360.0, 70.0, 50.0, 90.0, 120.0, 220.0, 10.0, 70.0, -40.0, 290.0, 230.0, 0.0, 730.0, 0.0, 130.0, 380.0, 25.0, 310.0, 20.0, 50.0, 220.0, 370.0, 100.0, 5.0, -20.0, 180.0, 220.0, 40.0, 0.0, 30.0, 150.0, -35.0, -65.0, 30.0, -105.0, 150.0, 20.0, -70.0, -65.0, 60.0, 10.0, 20.0, 420.0, 80.0, 120.0, 130.0, 20.0, 300.0, 140.0, 380.0, 160.0, 150.0, 50.0, 80.0, 110.0, 130.0, -245.0, 80.0, 40.0, 820.0, 30.0, 170.0, 120.0, 120.0, 250.0, 40.0, 80.0, 20.0, 0.0, 360.0, 190.0, 30.0, 330.0, 350.0, 270.0, 70.0, 170.0, -20.0, 310.0, -50.0, 160.0, 80.0, 20.0, 0.0, 120.0, 90.0, 250.0, 50.0, 120.0, 210.0, 150.0, 110.0, -25.0, 20.0, 450.0, 70.0, 580.0, 160.0, 110.0, 120.0, 40.0, 250.0, 110.0, 60.0, 110.0, 70.0, 60.0, 70.0, 300.0, 90.0, 130.0, 30.0, 20.0, 20.0, 210.0, 210.0, 110.0, 130.0, 20.0, 10.0, 40.0, 80.0, -30.0, 45.0, 380.0, 30.0, 60.0, 0.0, 50.0, 100.0, 100.0, 360.0, 100.0, 80.0, 220.0, 80.0, 100.0, 80.0, -200.0, 80.0, 180.0, 75.0, 200.0, 120.0, 150.0, 140.0, 0.0, 75.0, 70.0, 170.0, 30.0, 30.0, 240.0, 60.0, 70.0, 60.0, 210.0, 50.0, 40.0, 10.0, 40.0, 300.0, -90.0, 220.0, 510.0, 80.0, 110.0, 70.0, 190.0, 190.0, 360.0, 170.0, 200.0, 70.0, 160.0, 20.0, 50.0, 50.0, 120.0, 80.0, 130.0, 40.0, 220.0, -10.0, -10.0, 470.0, -70.0, 15.0, -10.0, 260.0, 310.0, 30.0, -100.0, 30.0, 480.0, 10.0, 30.0, 20.0, -130.0, 50.0, 30.0, 20.0, 80.0, 180.0, 20.0, -90.0, 250.0, -80.0, -140.0, 510.0, 210.0, 30.0, 0.0, 120.0, 60.0, 20.0, 30.0, 25.0, 220.0, -5.0, 130.0, 55.0, 80.0, 160.0, 10.0, 80.0, 10.0, 210.0, 600.0, 40.0, 50.0, 50.0, 30.0, 10.0, 260.0, -5.0, 220.0, 100.0, 550.0, 190.0, 20.0, 200.0, 100.0, 120.0, 80.0, 160.0, 290.0, 270.0, 120.0, 20.0, 190.0, 170.0, 50.0, 170.0, 520.0, -5.0, 80.0, 20.0, -10.0, 70.0, 90.0, 40.0, 90.0, 70.0, 70.0, 310.0, 260.0, 210.0, 140.0, 20.0, 160.0, 70.0, 110.0, 90.0, 230.0, 10.0, 310.0, 270.0, 170.0, 150.0, 20.0, 40.0, 80.0, 20.0, 190.0, 10.0, 30.0, 90.0, 80.0, 460.0, 30.0, 0.0, 10.0, 120.0, 0.0, 40.0, 140.0, 60.0, 30.0, 30.0, 190.0, 140.0, 80.0, 350.0, 110.0, 380.0, 50.0, 250.0, 30.0, 0.0, 110.0, 130.0, 100.0, 240.0, 150.0, 60.0, 120.0, 10.0, 0.0, 190.0, 190.0, 20.0, 5.0, 40.0, 290.0, 40.0, 5.0, 70.0, 70.0, 110.0, 210.0, 220.0, 90.0, 60.0, -160.0, 280.0, 20.0, 280.0, 120.0, 0.0, 625.0, -40.0, 30.0, 0.0, -40.0, 0.0, 10.0, 0.0, 50.0, 50.0, 100.0, 90.0, 500.0, 30.0, 60.0, 460.0, 230.0, 120.0, 40.0, 25.0, 340.0, 130.0, 70.0, 90.0, 160.0, 60.0, 160.0, 160.0, 80.0, 30.0, 240.0, 80.0, 290.0, 40.0, 110.0, -40.0, 40.0, 50.0, 0.0, 60.0, 30.0, 10.0, 10.0, 150.0, 280.0, 170.0, 80.0, 160.0, 30.0, 20.0, 130.0, 160.0, 110.0, 240.0, 90.0, 40.0, 290.0, 40.0, 50.0, 130.0, 20.0, 90.0, 100.0, 60.0, 90.0, 70.0, 50.0, 50.0, 150.0, 420.0, 90.0, 330.0, 50.0, 140.0, 310.0, 100.0, 160.0, 10.0, 60.0, 80.0, 20.0, 110.0, 60.0, 190.0, 0.0, -20.0, 380.0, 100.0, 80.0, 40.0, 180.0, 90.0, 190.0, 50.0, 120.0, 110.0, 330.0, 180.0, 70.0, 30.0, -5.0, -20.0, 0.0, 190.0, 0.0, 60.0, 15.0, 0.0, -20.0, 5.0, 100.0, 10.0, 210.0, 210.0, 210.0, 350.0, 40.0, 40.0, 20.0, 20.0, -100.0, 10.0, 0.0, 0.0, 20.0, 60.0, 40.0, 0.0, 0.0, 160.0, 40.0, 90.0, 190.0, 10.0, 480.0, 30.0, 30.0, 40.0, 30.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6724346981606402, "mean_inference_ms": 1.4942369448170978, "mean_action_processing_ms": 0.4262032558861178, "mean_env_wait_ms": 1.3465668634391665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013233661651611328, "StateBufferConnector_ms": 0.010962724685668945, "ViewRequirementAgentConnector_ms": 0.39900875091552734}, "num_episodes": 18, "episode_return_max": 1990.0, "episode_return_min": -570.0, "episode_return_mean": 1087.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.04310871736062, "num_env_steps_trained_throughput_per_sec": 19.04310871736062, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 3920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3920000, "timers": {"training_iteration_time_ms": 209440.177, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209440.131, "sample_time_ms": 2752.184, "learn_time_ms": 206667.243, "learn_throughput": 19.355, "synch_weights_time_ms": 12.937}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "done": false, "training_iteration": 98, "trial_id": "aa996_00000", "date": "2024-05-24_04-26-11", "timestamp": 1716539171, "time_this_iter_s": 210.05770015716553, "time_total_s": 20437.60147857666, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d9f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20437.60147857666, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 23.86262626262626, "ram_util_percent": 79.54006734006734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4810905328637367, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.795583986905944, "policy_loss": -0.007492512237098112, "vf_loss": 7.801335169890691, "vf_explained_var": 0.00043860507595399446, "kl": 0.003869636690872191, "entropy": 0.3120950128752203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 924915.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "env_runners": {"episode_reward_max": 2450.0, "episode_reward_min": 70.0, "episode_reward_mean": 1163.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -245.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 116.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [805.0, 1260.0, 530.0, 1570.0, 1220.0, 460.0, 1290.0, 970.0, 220.0, 1300.0, 350.0, 1540.0, 1990.0, 1600.0, 1050.0, 640.0, 1120.0, 1220.0, 1310.0, 1205.0, 905.0, 1600.0, 1230.0, 1340.0, 1240.0, 1970.0, 700.0, 1420.0, 1130.0, 1320.0, 1240.0, 1875.0, 1145.0, 70.0, 1620.0, 1375.0, 1190.0, 1650.0, 1100.0, 1745.0, 1160.0, 890.0, 755.0, 1000.0, 1180.0, 800.0, 1620.0, 1280.0, 1035.0, 730.0, 780.0, 710.0, 1375.0, 1455.0, 1380.0, 1255.0, 1300.0, 1570.0, 1020.0, 460.0, 1580.0, 1110.0, 840.0, 1120.0, 685.0, 1655.0, 1280.0, 870.0, 940.0, 1280.0, 1100.0, 1330.0, 960.0, 1350.0, 225.0, 1210.0, 190.0, 970.0, 990.0, 1435.0, 1515.0, 860.0, 380.0, 940.0, 1140.0, 1110.0, 1255.0, 2090.0, 1560.0, 855.0, 810.0, 1690.0, 1420.0, 1860.0, 1275.0, 1210.0, 590.0, 2450.0, 1140.0, 1810.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [290.0, 190.0, 55.0, 80.0, 20.0, 90.0, 0.0, 40.0, 40.0, 0.0, 190.0, 80.0, 180.0, 360.0, 30.0, 30.0, 10.0, 200.0, 150.0, 30.0, 90.0, 10.0, 170.0, -10.0, -30.0, 60.0, 40.0, 190.0, -20.0, 30.0, 160.0, 90.0, 60.0, 120.0, 90.0, 510.0, 190.0, 10.0, 10.0, 330.0, 50.0, 70.0, 510.0, 170.0, 30.0, 60.0, 100.0, 20.0, 110.0, 100.0, 20.0, 160.0, 0.0, 30.0, 10.0, 60.0, 30.0, 40.0, 40.0, 70.0, 380.0, 80.0, 150.0, 50.0, 450.0, 110.0, 60.0, -30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 180.0, 0.0, 140.0, 30.0, 10.0, 490.0, 50.0, 0.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 40.0, 30.0, 210.0, 30.0, 40.0, 160.0, 50.0, 0.0, 130.0, 400.0, 250.0, 20.0, 0.0, 110.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 70.0, 240.0, 90.0, 170.0, 250.0, 160.0, 260.0, 20.0, 300.0, 0.0, 50.0, 450.0, 50.0, 120.0, 130.0, 250.0, 70.0, 160.0, 20.0, 380.0, 360.0, 200.0, 140.0, 30.0, 110.0, 0.0, 450.0, 500.0, 50.0, 50.0, 70.0, 420.0, 10.0, 10.0, 90.0, 20.0, 90.0, -50.0, -40.0, 40.0, 460.0, 10.0, 110.0, -20.0, 80.0, 180.0, 20.0, 10.0, 180.0, 20.0, 50.0, -30.0, -30.0, 140.0, 60.0, 140.0, 580.0, 60.0, 140.0, 0.0, 60.0, 190.0, 20.0, 170.0, 140.0, 90.0, 210.0, -10.0, 50.0, 310.0, 50.0, 70.0, 30.0, 120.0, 50.0, 230.0, 130.0, 190.0, 220.0, 230.0, 40.0, 320.0, 80.0, 350.0, 30.0, 40.0, 60.0, 50.0, 10.0, 185.0, 80.0, 10.0, 15.0, 300.0, -75.0, 30.0, 390.0, 90.0, 50.0, 80.0, 15.0, 260.0, 790.0, 140.0, 100.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 90.0, 320.0, 190.0, 60.0, 160.0, 300.0, 0.0, 80.0, 30.0, 0.0, 60.0, 20.0, 60.0, 160.0, 30.0, 500.0, 60.0, 190.0, 170.0, 90.0, 120.0, 120.0, 110.0, 300.0, 100.0, 70.0, 180.0, 50.0, 50.0, 140.0, 10.0, 300.0, 120.0, 290.0, 540.0, 70.0, 80.0, 70.0, 270.0, 220.0, 190.0, 40.0, -30.0, 70.0, 20.0, 70.0, 0.0, 80.0, 100.0, 160.0, 130.0, 45.0, 40.0, 40.0, 600.0, 40.0, 40.0, 25.0, 100.0, 360.0, 290.0, 200.0, 20.0, 30.0, 40.0, 90.0, 370.0, 30.0, 70.0, -10.0, 310.0, 40.0, 50.0, 160.0, 0.0, 360.0, -10.0, 190.0, 100.0, 120.0, 360.0, 70.0, 50.0, 90.0, 120.0, 220.0, 10.0, 70.0, -40.0, 290.0, 230.0, 0.0, 730.0, 0.0, 130.0, 380.0, 25.0, 310.0, 20.0, 50.0, 220.0, 370.0, 100.0, 5.0, -20.0, 180.0, 220.0, 40.0, 0.0, 30.0, 150.0, -35.0, -65.0, 30.0, -105.0, 150.0, 20.0, -70.0, -65.0, 60.0, 10.0, 20.0, 420.0, 80.0, 120.0, 130.0, 20.0, 300.0, 140.0, 380.0, 160.0, 150.0, 50.0, 80.0, 110.0, 130.0, -245.0, 80.0, 40.0, 820.0, 30.0, 170.0, 120.0, 120.0, 250.0, 40.0, 80.0, 20.0, 0.0, 360.0, 190.0, 30.0, 330.0, 350.0, 270.0, 70.0, 170.0, -20.0, 310.0, -50.0, 160.0, 80.0, 20.0, 0.0, 120.0, 90.0, 250.0, 50.0, 120.0, 210.0, 150.0, 110.0, -25.0, 20.0, 450.0, 70.0, 580.0, 160.0, 110.0, 120.0, 40.0, 250.0, 110.0, 60.0, 110.0, 70.0, 60.0, 70.0, 300.0, 90.0, 130.0, 30.0, 20.0, 20.0, 210.0, 210.0, 110.0, 130.0, 20.0, 10.0, 40.0, 80.0, -30.0, 45.0, 380.0, 30.0, 60.0, 0.0, 50.0, 100.0, 100.0, 360.0, 100.0, 80.0, 220.0, 80.0, 100.0, 80.0, -200.0, 80.0, 180.0, 75.0, 200.0, 120.0, 150.0, 140.0, 0.0, 75.0, 70.0, 170.0, 30.0, 30.0, 240.0, 60.0, 70.0, 60.0, 210.0, 50.0, 40.0, 10.0, 40.0, 300.0, -90.0, 220.0, 510.0, 80.0, 110.0, 70.0, 190.0, 190.0, 360.0, 170.0, 200.0, 70.0, 160.0, 20.0, 50.0, 50.0, 120.0, 80.0, 130.0, 40.0, 220.0, -10.0, -10.0, 470.0, -70.0, 15.0, -10.0, 260.0, 310.0, 30.0, -100.0, 30.0, 480.0, 10.0, 30.0, 20.0, -130.0, 50.0, 30.0, 20.0, 80.0, 180.0, 20.0, -90.0, 250.0, -80.0, -140.0, 510.0, 210.0, 30.0, 0.0, 120.0, 60.0, 20.0, 30.0, 25.0, 220.0, -5.0, 130.0, 55.0, 80.0, 160.0, 10.0, 80.0, 10.0, 210.0, 600.0, 40.0, 50.0, 50.0, 30.0, 10.0, 260.0, -5.0, 220.0, 100.0, 550.0, 190.0, 20.0, 200.0, 100.0, 120.0, 80.0, 160.0, 290.0, 270.0, 120.0, 20.0, 190.0, 170.0, 50.0, 170.0, 520.0, -5.0, 80.0, 20.0, -10.0, 70.0, 90.0, 40.0, 90.0, 70.0, 70.0, 310.0, 260.0, 210.0, 140.0, 20.0, 160.0, 70.0, 110.0, 90.0, 230.0, 10.0, 310.0, 270.0, 170.0, 150.0, 20.0, 40.0, 80.0, 20.0, 190.0, 10.0, 30.0, 90.0, 80.0, 460.0, 30.0, 0.0, 10.0, 120.0, 0.0, 40.0, 140.0, 60.0, 30.0, 30.0, 190.0, 140.0, 80.0, 350.0, 110.0, 380.0, 50.0, 250.0, 30.0, 0.0, 110.0, 130.0, 100.0, 240.0, 150.0, 60.0, 120.0, 10.0, 0.0, 190.0, 190.0, 20.0, 5.0, 40.0, 290.0, 40.0, 5.0, 70.0, 70.0, 110.0, 210.0, 220.0, 90.0, 60.0, -160.0, 280.0, 20.0, 280.0, 120.0, 0.0, 625.0, -40.0, 30.0, 0.0, -40.0, 0.0, 10.0, 0.0, 50.0, 50.0, 100.0, 90.0, 500.0, 30.0, 60.0, 460.0, 230.0, 120.0, 40.0, 25.0, 340.0, 130.0, 70.0, 90.0, 160.0, 60.0, 160.0, 160.0, 80.0, 30.0, 240.0, 80.0, 290.0, 40.0, 110.0, -40.0, 40.0, 50.0, 0.0, 60.0, 30.0, 10.0, 10.0, 150.0, 280.0, 170.0, 80.0, 160.0, 30.0, 20.0, 130.0, 160.0, 110.0, 240.0, 90.0, 40.0, 290.0, 40.0, 50.0, 130.0, 20.0, 90.0, 100.0, 60.0, 90.0, 70.0, 50.0, 50.0, 150.0, 420.0, 90.0, 330.0, 50.0, 140.0, 310.0, 100.0, 160.0, 10.0, 60.0, 80.0, 20.0, 110.0, 60.0, 190.0, 0.0, -20.0, 380.0, 100.0, 80.0, 40.0, 180.0, 90.0, 190.0, 50.0, 120.0, 110.0, 330.0, 180.0, 70.0, 30.0, -5.0, -20.0, 0.0, 190.0, 0.0, 60.0, 15.0, 0.0, -20.0, 5.0, 100.0, 10.0, 210.0, 210.0, 210.0, 350.0, 40.0, 40.0, 20.0, 20.0, -100.0, 10.0, 0.0, 0.0, 20.0, 60.0, 40.0, 0.0, 0.0, 160.0, 40.0, 90.0, 190.0, 10.0, 480.0, 30.0, 30.0, 40.0, 30.0, 30.0, 30.0, 40.0, 10.0, 300.0, 390.0, 20.0, 50.0, 80.0, 20.0, 50.0, 80.0, 290.0, 120.0, 50.0, 140.0, 410.0, 50.0, 190.0, 60.0, 45.0, 215.0, -40.0, 170.0, 80.0, 70.0, 410.0, 100.0, 140.0, 220.0, 150.0, 60.0, 60.0, 90.0, 180.0, 90.0, 180.0, 60.0, 60.0, 20.0, 60.0, 20.0, 130.0, 20.0, 20.0, 10.0, 40.0, 40.0, 80.0, 0.0, 20.0, 90.0, 50.0, 450.0, 50.0, 0.0, 40.0, 150.0, 100.0, -40.0, 50.0, 180.0, 30.0, 90.0, 300.0, 190.0, 140.0, -150.0, -110.0, 190.0, 280.0, 60.0, 50.0, 50.0, 40.0, 30.0, 310.0, -20.0, 100.0, 110.0, 380.0, -5.0, 70.0, 110.0, 160.0, 250.0, 230.0, 40.0, 140.0, 210.0, 50.0, 110.0, 210.0, 0.0, 270.0, -50.0, 370.0, 110.0, 40.0, 310.0, 720.0, 300.0, -20.0, 40.0, 90.0, 570.0, 270.0, 60.0, 130.0, 20.0, 100.0, 70.0, 320.0, 40.0, -5.0, 80.0, 90.0, 20.0, 120.0, 20.0, 100.0, 0.0, 20.0, 150.0, 40.0, 190.0, -20.0, 20.0, 200.0, 50.0, 160.0, 80.0, 240.0, 160.0, 40.0, 200.0, 110.0, 140.0, 110.0, 520.0, 90.0, 300.0, 60.0, 170.0, 60.0, 300.0, 220.0, 40.0, 15.0, 220.0, 35.0, 130.0, 80.0, -40.0, 330.0, 180.0, 400.0, 120.0, 370.0, 80.0, 210.0, 110.0, 290.0, 90.0, 55.0, 120.0, 30.0, 10.0, 80.0, 170.0, 320.0, 90.0, 50.0, 230.0, 65.0, 60.0, 70.0, 110.0, 180.0, 350.0, 5.0, 50.0, 100.0, 80.0, 20.0, 30.0, 0.0, 130.0, 50.0, 100.0, 30.0, 80.0, 650.0, 50.0, 210.0, 620.0, 160.0, 220.0, 40.0, 250.0, 170.0, 60.0, 170.0, 170.0, 70.0, 320.0, 80.0, -20.0, 30.0, 170.0, 90.0, 410.0, 80.0, 90.0, 160.0, 190.0, 70.0, 130.0, 390.0, 70.0, 220.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6723195148919487, "mean_inference_ms": 1.4953284106876048, "mean_action_processing_ms": 0.4262277515574952, "mean_env_wait_ms": 1.347166884918995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013736963272094727, "StateBufferConnector_ms": 0.011212825775146484, "ViewRequirementAgentConnector_ms": 0.40116095542907715}, "num_episodes": 22, "episode_return_max": 2450.0, "episode_return_min": 70.0, "episode_return_mean": 1163.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.070618398937974, "num_env_steps_trained_throughput_per_sec": 19.070618398937974, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 3960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3960000, "timers": {"training_iteration_time_ms": 209579.629, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209579.584, "sample_time_ms": 2787.538, "learn_time_ms": 206771.345, "learn_throughput": 19.345, "synch_weights_time_ms": 13.09}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "done": false, "training_iteration": 99, "trial_id": "aa996_00000", "date": "2024-05-24_04-29-41", "timestamp": 1716539381, "time_this_iter_s": 209.75613594055176, "time_total_s": 20647.357614517212, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x1600600d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20647.357614517212, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 25.464983164983167, "ram_util_percent": 79.3114478114478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1280514516579077, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007924292239070898, "vf_loss": 6.479065153316949, "vf_explained_var": 0.0002238451165005295, "kl": Infinity, "entropy": 0.33771330242117625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 934305.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "env_runners": {"episode_reward_max": 2450.0, "episode_reward_min": 70.0, "episode_reward_mean": 1149.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 114.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1310.0, 1205.0, 905.0, 1600.0, 1230.0, 1340.0, 1240.0, 1970.0, 700.0, 1420.0, 1130.0, 1320.0, 1240.0, 1875.0, 1145.0, 70.0, 1620.0, 1375.0, 1190.0, 1650.0, 1100.0, 1745.0, 1160.0, 890.0, 755.0, 1000.0, 1180.0, 800.0, 1620.0, 1280.0, 1035.0, 730.0, 780.0, 710.0, 1375.0, 1455.0, 1380.0, 1255.0, 1300.0, 1570.0, 1020.0, 460.0, 1580.0, 1110.0, 840.0, 1120.0, 685.0, 1655.0, 1280.0, 870.0, 940.0, 1280.0, 1100.0, 1330.0, 960.0, 1350.0, 225.0, 1210.0, 190.0, 970.0, 990.0, 1435.0, 1515.0, 860.0, 380.0, 940.0, 1140.0, 1110.0, 1255.0, 2090.0, 1560.0, 855.0, 810.0, 1690.0, 1420.0, 1860.0, 1275.0, 1210.0, 590.0, 2450.0, 1140.0, 1810.0, 950.0, 1020.0, 955.0, 1180.0, 810.0, 1305.0, 1070.0, 1705.0, 890.0, 590.0, 1520.0, 1010.0, 1310.0, 250.0, 230.0, 620.0, 1420.0, 850.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 30.0, 120.0, 50.0, 230.0, 130.0, 190.0, 220.0, 230.0, 40.0, 320.0, 80.0, 350.0, 30.0, 40.0, 60.0, 50.0, 10.0, 185.0, 80.0, 10.0, 15.0, 300.0, -75.0, 30.0, 390.0, 90.0, 50.0, 80.0, 15.0, 260.0, 790.0, 140.0, 100.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 90.0, 320.0, 190.0, 60.0, 160.0, 300.0, 0.0, 80.0, 30.0, 0.0, 60.0, 20.0, 60.0, 160.0, 30.0, 500.0, 60.0, 190.0, 170.0, 90.0, 120.0, 120.0, 110.0, 300.0, 100.0, 70.0, 180.0, 50.0, 50.0, 140.0, 10.0, 300.0, 120.0, 290.0, 540.0, 70.0, 80.0, 70.0, 270.0, 220.0, 190.0, 40.0, -30.0, 70.0, 20.0, 70.0, 0.0, 80.0, 100.0, 160.0, 130.0, 45.0, 40.0, 40.0, 600.0, 40.0, 40.0, 25.0, 100.0, 360.0, 290.0, 200.0, 20.0, 30.0, 40.0, 90.0, 370.0, 30.0, 70.0, -10.0, 310.0, 40.0, 50.0, 160.0, 0.0, 360.0, -10.0, 190.0, 100.0, 120.0, 360.0, 70.0, 50.0, 90.0, 120.0, 220.0, 10.0, 70.0, -40.0, 290.0, 230.0, 0.0, 730.0, 0.0, 130.0, 380.0, 25.0, 310.0, 20.0, 50.0, 220.0, 370.0, 100.0, 5.0, -20.0, 180.0, 220.0, 40.0, 0.0, 30.0, 150.0, -35.0, -65.0, 30.0, -105.0, 150.0, 20.0, -70.0, -65.0, 60.0, 10.0, 20.0, 420.0, 80.0, 120.0, 130.0, 20.0, 300.0, 140.0, 380.0, 160.0, 150.0, 50.0, 80.0, 110.0, 130.0, -245.0, 80.0, 40.0, 820.0, 30.0, 170.0, 120.0, 120.0, 250.0, 40.0, 80.0, 20.0, 0.0, 360.0, 190.0, 30.0, 330.0, 350.0, 270.0, 70.0, 170.0, -20.0, 310.0, -50.0, 160.0, 80.0, 20.0, 0.0, 120.0, 90.0, 250.0, 50.0, 120.0, 210.0, 150.0, 110.0, -25.0, 20.0, 450.0, 70.0, 580.0, 160.0, 110.0, 120.0, 40.0, 250.0, 110.0, 60.0, 110.0, 70.0, 60.0, 70.0, 300.0, 90.0, 130.0, 30.0, 20.0, 20.0, 210.0, 210.0, 110.0, 130.0, 20.0, 10.0, 40.0, 80.0, -30.0, 45.0, 380.0, 30.0, 60.0, 0.0, 50.0, 100.0, 100.0, 360.0, 100.0, 80.0, 220.0, 80.0, 100.0, 80.0, -200.0, 80.0, 180.0, 75.0, 200.0, 120.0, 150.0, 140.0, 0.0, 75.0, 70.0, 170.0, 30.0, 30.0, 240.0, 60.0, 70.0, 60.0, 210.0, 50.0, 40.0, 10.0, 40.0, 300.0, -90.0, 220.0, 510.0, 80.0, 110.0, 70.0, 190.0, 190.0, 360.0, 170.0, 200.0, 70.0, 160.0, 20.0, 50.0, 50.0, 120.0, 80.0, 130.0, 40.0, 220.0, -10.0, -10.0, 470.0, -70.0, 15.0, -10.0, 260.0, 310.0, 30.0, -100.0, 30.0, 480.0, 10.0, 30.0, 20.0, -130.0, 50.0, 30.0, 20.0, 80.0, 180.0, 20.0, -90.0, 250.0, -80.0, -140.0, 510.0, 210.0, 30.0, 0.0, 120.0, 60.0, 20.0, 30.0, 25.0, 220.0, -5.0, 130.0, 55.0, 80.0, 160.0, 10.0, 80.0, 10.0, 210.0, 600.0, 40.0, 50.0, 50.0, 30.0, 10.0, 260.0, -5.0, 220.0, 100.0, 550.0, 190.0, 20.0, 200.0, 100.0, 120.0, 80.0, 160.0, 290.0, 270.0, 120.0, 20.0, 190.0, 170.0, 50.0, 170.0, 520.0, -5.0, 80.0, 20.0, -10.0, 70.0, 90.0, 40.0, 90.0, 70.0, 70.0, 310.0, 260.0, 210.0, 140.0, 20.0, 160.0, 70.0, 110.0, 90.0, 230.0, 10.0, 310.0, 270.0, 170.0, 150.0, 20.0, 40.0, 80.0, 20.0, 190.0, 10.0, 30.0, 90.0, 80.0, 460.0, 30.0, 0.0, 10.0, 120.0, 0.0, 40.0, 140.0, 60.0, 30.0, 30.0, 190.0, 140.0, 80.0, 350.0, 110.0, 380.0, 50.0, 250.0, 30.0, 0.0, 110.0, 130.0, 100.0, 240.0, 150.0, 60.0, 120.0, 10.0, 0.0, 190.0, 190.0, 20.0, 5.0, 40.0, 290.0, 40.0, 5.0, 70.0, 70.0, 110.0, 210.0, 220.0, 90.0, 60.0, -160.0, 280.0, 20.0, 280.0, 120.0, 0.0, 625.0, -40.0, 30.0, 0.0, -40.0, 0.0, 10.0, 0.0, 50.0, 50.0, 100.0, 90.0, 500.0, 30.0, 60.0, 460.0, 230.0, 120.0, 40.0, 25.0, 340.0, 130.0, 70.0, 90.0, 160.0, 60.0, 160.0, 160.0, 80.0, 30.0, 240.0, 80.0, 290.0, 40.0, 110.0, -40.0, 40.0, 50.0, 0.0, 60.0, 30.0, 10.0, 10.0, 150.0, 280.0, 170.0, 80.0, 160.0, 30.0, 20.0, 130.0, 160.0, 110.0, 240.0, 90.0, 40.0, 290.0, 40.0, 50.0, 130.0, 20.0, 90.0, 100.0, 60.0, 90.0, 70.0, 50.0, 50.0, 150.0, 420.0, 90.0, 330.0, 50.0, 140.0, 310.0, 100.0, 160.0, 10.0, 60.0, 80.0, 20.0, 110.0, 60.0, 190.0, 0.0, -20.0, 380.0, 100.0, 80.0, 40.0, 180.0, 90.0, 190.0, 50.0, 120.0, 110.0, 330.0, 180.0, 70.0, 30.0, -5.0, -20.0, 0.0, 190.0, 0.0, 60.0, 15.0, 0.0, -20.0, 5.0, 100.0, 10.0, 210.0, 210.0, 210.0, 350.0, 40.0, 40.0, 20.0, 20.0, -100.0, 10.0, 0.0, 0.0, 20.0, 60.0, 40.0, 0.0, 0.0, 160.0, 40.0, 90.0, 190.0, 10.0, 480.0, 30.0, 30.0, 40.0, 30.0, 30.0, 30.0, 40.0, 10.0, 300.0, 390.0, 20.0, 50.0, 80.0, 20.0, 50.0, 80.0, 290.0, 120.0, 50.0, 140.0, 410.0, 50.0, 190.0, 60.0, 45.0, 215.0, -40.0, 170.0, 80.0, 70.0, 410.0, 100.0, 140.0, 220.0, 150.0, 60.0, 60.0, 90.0, 180.0, 90.0, 180.0, 60.0, 60.0, 20.0, 60.0, 20.0, 130.0, 20.0, 20.0, 10.0, 40.0, 40.0, 80.0, 0.0, 20.0, 90.0, 50.0, 450.0, 50.0, 0.0, 40.0, 150.0, 100.0, -40.0, 50.0, 180.0, 30.0, 90.0, 300.0, 190.0, 140.0, -150.0, -110.0, 190.0, 280.0, 60.0, 50.0, 50.0, 40.0, 30.0, 310.0, -20.0, 100.0, 110.0, 380.0, -5.0, 70.0, 110.0, 160.0, 250.0, 230.0, 40.0, 140.0, 210.0, 50.0, 110.0, 210.0, 0.0, 270.0, -50.0, 370.0, 110.0, 40.0, 310.0, 720.0, 300.0, -20.0, 40.0, 90.0, 570.0, 270.0, 60.0, 130.0, 20.0, 100.0, 70.0, 320.0, 40.0, -5.0, 80.0, 90.0, 20.0, 120.0, 20.0, 100.0, 0.0, 20.0, 150.0, 40.0, 190.0, -20.0, 20.0, 200.0, 50.0, 160.0, 80.0, 240.0, 160.0, 40.0, 200.0, 110.0, 140.0, 110.0, 520.0, 90.0, 300.0, 60.0, 170.0, 60.0, 300.0, 220.0, 40.0, 15.0, 220.0, 35.0, 130.0, 80.0, -40.0, 330.0, 180.0, 400.0, 120.0, 370.0, 80.0, 210.0, 110.0, 290.0, 90.0, 55.0, 120.0, 30.0, 10.0, 80.0, 170.0, 320.0, 90.0, 50.0, 230.0, 65.0, 60.0, 70.0, 110.0, 180.0, 350.0, 5.0, 50.0, 100.0, 80.0, 20.0, 30.0, 0.0, 130.0, 50.0, 100.0, 30.0, 80.0, 650.0, 50.0, 210.0, 620.0, 160.0, 220.0, 40.0, 250.0, 170.0, 60.0, 170.0, 170.0, 70.0, 320.0, 80.0, -20.0, 30.0, 170.0, 90.0, 410.0, 80.0, 90.0, 160.0, 190.0, 70.0, 130.0, 390.0, 70.0, 220.0, 20.0, 300.0, 60.0, 20.0, 260.0, 100.0, 10.0, 90.0, 50.0, 40.0, 80.0, 40.0, 90.0, 140.0, 130.0, 120.0, 20.0, 150.0, 250.0, 0.0, 90.0, 600.0, 190.0, 10.0, 60.0, -185.0, 40.0, -70.0, 150.0, 70.0, 0.0, 10.0, 250.0, 50.0, 250.0, 10.0, 560.0, 50.0, -60.0, 60.0, 20.0, 180.0, 100.0, 0.0, 40.0, 180.0, 240.0, 50.0, -15.0, 15.0, 50.0, 290.0, 110.0, 30.0, 20.0, 130.0, 85.0, 70.0, 360.0, 160.0, 200.0, 470.0, 0.0, 30.0, 180.0, 30.0, 110.0, 20.0, 10.0, 20.0, 45.0, -20.0, 200.0, 720.0, 50.0, 190.0, 180.0, 160.0, 220.0, -40.0, 90.0, 160.0, 90.0, -30.0, 310.0, -370.0, 30.0, 400.0, 90.0, 120.0, 10.0, 0.0, 110.0, 0.0, 20.0, 80.0, 0.0, 60.0, 260.0, 50.0, 50.0, 410.0, 170.0, 250.0, 120.0, 320.0, 60.0, 70.0, 10.0, 60.0, 120.0, 40.0, 130.0, 100.0, 30.0, 0.0, 120.0, 100.0, 340.0, 30.0, 140.0, 30.0, 520.0, 90.0, 100.0, 320.0, 0.0, 60.0, -20.0, 70.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 190.0, 0.0, 0.0, 40.0, 30.0, 10.0, 30.0, 20.0, 40.0, 0.0, 40.0, 20.0, 30.0, 40.0, 20.0, 20.0, 170.0, 30.0, -10.0, 160.0, 90.0, 70.0, 190.0, 290.0, 40.0, 160.0, 140.0, 120.0, 160.0, 30.0, 60.0, 230.0, 0.0, 320.0, 100.0, -10.0, 40.0, 240.0, 40.0, 40.0, 50.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6722288415200608, "mean_inference_ms": 1.495888117104394, "mean_action_processing_ms": 0.4262132322593907, "mean_env_wait_ms": 1.3474756385554247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01376485824584961, "StateBufferConnector_ms": 0.011216402053833008, "ViewRequirementAgentConnector_ms": 0.40700674057006836}, "num_episodes": 18, "episode_return_max": 2450.0, "episode_return_min": 70.0, "episode_return_mean": 1149.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.990623557784026, "num_env_steps_trained_throughput_per_sec": 18.990623557784026, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 4000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000000, "timers": {"training_iteration_time_ms": 209875.257, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209875.213, "sample_time_ms": 2770.352, "learn_time_ms": 207084.552, "learn_throughput": 19.316, "synch_weights_time_ms": 12.243}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "done": false, "training_iteration": 100, "trial_id": "aa996_00000", "date": "2024-05-24_04-33-11", "timestamp": 1716539591, "time_this_iter_s": 210.6395628452301, "time_total_s": 20857.997177362442, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d8f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20857.997177362442, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.183221476510063, "ram_util_percent": 80.17214765100672}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.370211978404286, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008776613093165759, "vf_loss": 7.013760261109081, "vf_explained_var": -0.0023820203396712884, "kl": Infinity, "entropy": 0.32170881454587874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 943695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "env_runners": {"episode_reward_max": 2450.0, "episode_reward_min": 190.0, "episode_reward_mean": 1070.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 107.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [890.0, 755.0, 1000.0, 1180.0, 800.0, 1620.0, 1280.0, 1035.0, 730.0, 780.0, 710.0, 1375.0, 1455.0, 1380.0, 1255.0, 1300.0, 1570.0, 1020.0, 460.0, 1580.0, 1110.0, 840.0, 1120.0, 685.0, 1655.0, 1280.0, 870.0, 940.0, 1280.0, 1100.0, 1330.0, 960.0, 1350.0, 225.0, 1210.0, 190.0, 970.0, 990.0, 1435.0, 1515.0, 860.0, 380.0, 940.0, 1140.0, 1110.0, 1255.0, 2090.0, 1560.0, 855.0, 810.0, 1690.0, 1420.0, 1860.0, 1275.0, 1210.0, 590.0, 2450.0, 1140.0, 1810.0, 950.0, 1020.0, 955.0, 1180.0, 810.0, 1305.0, 1070.0, 1705.0, 890.0, 590.0, 1520.0, 1010.0, 1310.0, 250.0, 230.0, 620.0, 1420.0, 850.0, 670.0, 350.0, 1250.0, 1610.0, 310.0, 445.0, 890.0, 1340.0, 830.0, 615.0, 1305.0, 1350.0, 1680.0, 590.0, 770.0, 435.0, 950.0, 930.0, 1185.0, 980.0, 660.0, 1290.0, 1250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 30.0, 20.0, 20.0, 210.0, 210.0, 110.0, 130.0, 20.0, 10.0, 40.0, 80.0, -30.0, 45.0, 380.0, 30.0, 60.0, 0.0, 50.0, 100.0, 100.0, 360.0, 100.0, 80.0, 220.0, 80.0, 100.0, 80.0, -200.0, 80.0, 180.0, 75.0, 200.0, 120.0, 150.0, 140.0, 0.0, 75.0, 70.0, 170.0, 30.0, 30.0, 240.0, 60.0, 70.0, 60.0, 210.0, 50.0, 40.0, 10.0, 40.0, 300.0, -90.0, 220.0, 510.0, 80.0, 110.0, 70.0, 190.0, 190.0, 360.0, 170.0, 200.0, 70.0, 160.0, 20.0, 50.0, 50.0, 120.0, 80.0, 130.0, 40.0, 220.0, -10.0, -10.0, 470.0, -70.0, 15.0, -10.0, 260.0, 310.0, 30.0, -100.0, 30.0, 480.0, 10.0, 30.0, 20.0, -130.0, 50.0, 30.0, 20.0, 80.0, 180.0, 20.0, -90.0, 250.0, -80.0, -140.0, 510.0, 210.0, 30.0, 0.0, 120.0, 60.0, 20.0, 30.0, 25.0, 220.0, -5.0, 130.0, 55.0, 80.0, 160.0, 10.0, 80.0, 10.0, 210.0, 600.0, 40.0, 50.0, 50.0, 30.0, 10.0, 260.0, -5.0, 220.0, 100.0, 550.0, 190.0, 20.0, 200.0, 100.0, 120.0, 80.0, 160.0, 290.0, 270.0, 120.0, 20.0, 190.0, 170.0, 50.0, 170.0, 520.0, -5.0, 80.0, 20.0, -10.0, 70.0, 90.0, 40.0, 90.0, 70.0, 70.0, 310.0, 260.0, 210.0, 140.0, 20.0, 160.0, 70.0, 110.0, 90.0, 230.0, 10.0, 310.0, 270.0, 170.0, 150.0, 20.0, 40.0, 80.0, 20.0, 190.0, 10.0, 30.0, 90.0, 80.0, 460.0, 30.0, 0.0, 10.0, 120.0, 0.0, 40.0, 140.0, 60.0, 30.0, 30.0, 190.0, 140.0, 80.0, 350.0, 110.0, 380.0, 50.0, 250.0, 30.0, 0.0, 110.0, 130.0, 100.0, 240.0, 150.0, 60.0, 120.0, 10.0, 0.0, 190.0, 190.0, 20.0, 5.0, 40.0, 290.0, 40.0, 5.0, 70.0, 70.0, 110.0, 210.0, 220.0, 90.0, 60.0, -160.0, 280.0, 20.0, 280.0, 120.0, 0.0, 625.0, -40.0, 30.0, 0.0, -40.0, 0.0, 10.0, 0.0, 50.0, 50.0, 100.0, 90.0, 500.0, 30.0, 60.0, 460.0, 230.0, 120.0, 40.0, 25.0, 340.0, 130.0, 70.0, 90.0, 160.0, 60.0, 160.0, 160.0, 80.0, 30.0, 240.0, 80.0, 290.0, 40.0, 110.0, -40.0, 40.0, 50.0, 0.0, 60.0, 30.0, 10.0, 10.0, 150.0, 280.0, 170.0, 80.0, 160.0, 30.0, 20.0, 130.0, 160.0, 110.0, 240.0, 90.0, 40.0, 290.0, 40.0, 50.0, 130.0, 20.0, 90.0, 100.0, 60.0, 90.0, 70.0, 50.0, 50.0, 150.0, 420.0, 90.0, 330.0, 50.0, 140.0, 310.0, 100.0, 160.0, 10.0, 60.0, 80.0, 20.0, 110.0, 60.0, 190.0, 0.0, -20.0, 380.0, 100.0, 80.0, 40.0, 180.0, 90.0, 190.0, 50.0, 120.0, 110.0, 330.0, 180.0, 70.0, 30.0, -5.0, -20.0, 0.0, 190.0, 0.0, 60.0, 15.0, 0.0, -20.0, 5.0, 100.0, 10.0, 210.0, 210.0, 210.0, 350.0, 40.0, 40.0, 20.0, 20.0, -100.0, 10.0, 0.0, 0.0, 20.0, 60.0, 40.0, 0.0, 0.0, 160.0, 40.0, 90.0, 190.0, 10.0, 480.0, 30.0, 30.0, 40.0, 30.0, 30.0, 30.0, 40.0, 10.0, 300.0, 390.0, 20.0, 50.0, 80.0, 20.0, 50.0, 80.0, 290.0, 120.0, 50.0, 140.0, 410.0, 50.0, 190.0, 60.0, 45.0, 215.0, -40.0, 170.0, 80.0, 70.0, 410.0, 100.0, 140.0, 220.0, 150.0, 60.0, 60.0, 90.0, 180.0, 90.0, 180.0, 60.0, 60.0, 20.0, 60.0, 20.0, 130.0, 20.0, 20.0, 10.0, 40.0, 40.0, 80.0, 0.0, 20.0, 90.0, 50.0, 450.0, 50.0, 0.0, 40.0, 150.0, 100.0, -40.0, 50.0, 180.0, 30.0, 90.0, 300.0, 190.0, 140.0, -150.0, -110.0, 190.0, 280.0, 60.0, 50.0, 50.0, 40.0, 30.0, 310.0, -20.0, 100.0, 110.0, 380.0, -5.0, 70.0, 110.0, 160.0, 250.0, 230.0, 40.0, 140.0, 210.0, 50.0, 110.0, 210.0, 0.0, 270.0, -50.0, 370.0, 110.0, 40.0, 310.0, 720.0, 300.0, -20.0, 40.0, 90.0, 570.0, 270.0, 60.0, 130.0, 20.0, 100.0, 70.0, 320.0, 40.0, -5.0, 80.0, 90.0, 20.0, 120.0, 20.0, 100.0, 0.0, 20.0, 150.0, 40.0, 190.0, -20.0, 20.0, 200.0, 50.0, 160.0, 80.0, 240.0, 160.0, 40.0, 200.0, 110.0, 140.0, 110.0, 520.0, 90.0, 300.0, 60.0, 170.0, 60.0, 300.0, 220.0, 40.0, 15.0, 220.0, 35.0, 130.0, 80.0, -40.0, 330.0, 180.0, 400.0, 120.0, 370.0, 80.0, 210.0, 110.0, 290.0, 90.0, 55.0, 120.0, 30.0, 10.0, 80.0, 170.0, 320.0, 90.0, 50.0, 230.0, 65.0, 60.0, 70.0, 110.0, 180.0, 350.0, 5.0, 50.0, 100.0, 80.0, 20.0, 30.0, 0.0, 130.0, 50.0, 100.0, 30.0, 80.0, 650.0, 50.0, 210.0, 620.0, 160.0, 220.0, 40.0, 250.0, 170.0, 60.0, 170.0, 170.0, 70.0, 320.0, 80.0, -20.0, 30.0, 170.0, 90.0, 410.0, 80.0, 90.0, 160.0, 190.0, 70.0, 130.0, 390.0, 70.0, 220.0, 20.0, 300.0, 60.0, 20.0, 260.0, 100.0, 10.0, 90.0, 50.0, 40.0, 80.0, 40.0, 90.0, 140.0, 130.0, 120.0, 20.0, 150.0, 250.0, 0.0, 90.0, 600.0, 190.0, 10.0, 60.0, -185.0, 40.0, -70.0, 150.0, 70.0, 0.0, 10.0, 250.0, 50.0, 250.0, 10.0, 560.0, 50.0, -60.0, 60.0, 20.0, 180.0, 100.0, 0.0, 40.0, 180.0, 240.0, 50.0, -15.0, 15.0, 50.0, 290.0, 110.0, 30.0, 20.0, 130.0, 85.0, 70.0, 360.0, 160.0, 200.0, 470.0, 0.0, 30.0, 180.0, 30.0, 110.0, 20.0, 10.0, 20.0, 45.0, -20.0, 200.0, 720.0, 50.0, 190.0, 180.0, 160.0, 220.0, -40.0, 90.0, 160.0, 90.0, -30.0, 310.0, -370.0, 30.0, 400.0, 90.0, 120.0, 10.0, 0.0, 110.0, 0.0, 20.0, 80.0, 0.0, 60.0, 260.0, 50.0, 50.0, 410.0, 170.0, 250.0, 120.0, 320.0, 60.0, 70.0, 10.0, 60.0, 120.0, 40.0, 130.0, 100.0, 30.0, 0.0, 120.0, 100.0, 340.0, 30.0, 140.0, 30.0, 520.0, 90.0, 100.0, 320.0, 0.0, 60.0, -20.0, 70.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 190.0, 0.0, 0.0, 40.0, 30.0, 10.0, 30.0, 20.0, 40.0, 0.0, 40.0, 20.0, 30.0, 40.0, 20.0, 20.0, 170.0, 30.0, -10.0, 160.0, 90.0, 70.0, 190.0, 290.0, 40.0, 160.0, 140.0, 120.0, 160.0, 30.0, 60.0, 230.0, 0.0, 320.0, 100.0, -10.0, 40.0, 240.0, 40.0, 40.0, 50.0, 30.0, 40.0, 320.0, 150.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 110.0, 10.0, 20.0, 40.0, 110.0, 0.0, 410.0, 40.0, 90.0, 10.0, 10.0, 90.0, 380.0, 180.0, 40.0, 40.0, 200.0, 80.0, 160.0, 230.0, 410.0, 200.0, 150.0, 30.0, 110.0, 150.0, 0.0, 10.0, 0.0, 0.0, 10.0, 60.0, 20.0, 0.0, 60.0, 0.0, 170.0, -45.0, 60.0, 70.0, 170.0, 60.0, 60.0, -40.0, -60.0, 30.0, 30.0, 60.0, 30.0, 170.0, 170.0, 110.0, 160.0, 120.0, 10.0, 60.0, 160.0, 230.0, 150.0, 50.0, 50.0, 50.0, 410.0, 50.0, 130.0, 100.0, -10.0, 120.0, 80.0, 190.0, 120.0, 10.0, 80.0, 10.0, 130.0, -500.0, 270.0, 140.0, 300.0, -25.0, 20.0, 60.0, 160.0, 100.0, 90.0, 180.0, 40.0, 35.0, 130.0, 50.0, -30.0, 280.0, 160.0, 70.0, 390.0, 190.0, 120.0, 60.0, 0.0, -80.0, 140.0, 380.0, 70.0, 230.0, 240.0, 80.0, 180.0, 350.0, 90.0, 105.0, 15.0, 230.0, 450.0, 200.0, -20.0, 10.0, 60.0, 30.0, 30.0, 0.0, 220.0, 50.0, 110.0, 70.0, 10.0, 10.0, 30.0, 130.0, 80.0, 10.0, 20.0, 170.0, 100.0, 40.0, 180.0, 15.0, 70.0, 120.0, 20.0, 20.0, 10.0, 50.0, 0.0, 110.0, 20.0, 180.0, 90.0, 50.0, 80.0, 0.0, 60.0, 290.0, 140.0, 30.0, 30.0, 20.0, 0.0, 30.0, 10.0, 620.0, 160.0, 0.0, -40.0, 30.0, 100.0, 110.0, 55.0, -120.0, 200.0, 200.0, 100.0, 220.0, 120.0, 130.0, 170.0, 80.0, 240.0, 60.0, 70.0, 20.0, 30.0, 130.0, 120.0, 120.0, 110.0, 40.0, 20.0, 30.0, 40.0, 320.0, 20.0, 10.0, 60.0, 120.0, 0.0, 120.0, 230.0, 340.0, -10.0, 160.0, 140.0, -260.0, 350.0, 210.0, 10.0, 110.0, 120.0, 320.0, 110.0, 40.0, 60.0, 30.0, 100.0, 200.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6720073359425036, "mean_inference_ms": 1.4963031907899258, "mean_action_processing_ms": 0.4260971608461044, "mean_env_wait_ms": 1.3475262643645234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013478755950927734, "StateBufferConnector_ms": 0.010948657989501953, "ViewRequirementAgentConnector_ms": 0.40848851203918457}, "num_episodes": 23, "episode_return_max": 2450.0, "episode_return_min": 190.0, "episode_return_mean": 1070.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.648983269677505, "num_env_steps_trained_throughput_per_sec": 18.648983269677505, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 4040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4040000, "timers": {"training_iteration_time_ms": 210562.015, "restore_workers_time_ms": 0.012, "training_step_time_ms": 210561.97, "sample_time_ms": 2788.532, "learn_time_ms": 207751.128, "learn_throughput": 19.254, "synch_weights_time_ms": 13.157}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "done": false, "training_iteration": 101, "trial_id": "aa996_00000", "date": "2024-05-24_04-36-46", "timestamp": 1716539806, "time_this_iter_s": 214.52837300300598, "time_total_s": 21072.525550365448, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d6dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21072.525550365448, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 32.54059405940594, "ram_util_percent": 80.45544554455445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1817188374658487, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.460722649110138, "policy_loss": -0.00679307447290653, "vf_loss": 7.465749465467069, "vf_explained_var": -0.00041351186327787, "kl": 0.0034889062604102302, "entropy": 0.30514170508256483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 953085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "env_runners": {"episode_reward_max": 2450.0, "episode_reward_min": 190.0, "episode_reward_mean": 1083.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 108.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [460.0, 1580.0, 1110.0, 840.0, 1120.0, 685.0, 1655.0, 1280.0, 870.0, 940.0, 1280.0, 1100.0, 1330.0, 960.0, 1350.0, 225.0, 1210.0, 190.0, 970.0, 990.0, 1435.0, 1515.0, 860.0, 380.0, 940.0, 1140.0, 1110.0, 1255.0, 2090.0, 1560.0, 855.0, 810.0, 1690.0, 1420.0, 1860.0, 1275.0, 1210.0, 590.0, 2450.0, 1140.0, 1810.0, 950.0, 1020.0, 955.0, 1180.0, 810.0, 1305.0, 1070.0, 1705.0, 890.0, 590.0, 1520.0, 1010.0, 1310.0, 250.0, 230.0, 620.0, 1420.0, 850.0, 670.0, 350.0, 1250.0, 1610.0, 310.0, 445.0, 890.0, 1340.0, 830.0, 615.0, 1305.0, 1350.0, 1680.0, 590.0, 770.0, 435.0, 950.0, 930.0, 1185.0, 980.0, 660.0, 1290.0, 1250.0, 1145.0, 1415.0, 1215.0, 1630.0, 325.0, 1110.0, 810.0, 1020.0, 1670.0, 1270.0, 1390.0, 1080.0, 1300.0, 1300.0, 1310.0, 1535.0, 880.0, 1070.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 0.0, 10.0, 120.0, 0.0, 40.0, 140.0, 60.0, 30.0, 30.0, 190.0, 140.0, 80.0, 350.0, 110.0, 380.0, 50.0, 250.0, 30.0, 0.0, 110.0, 130.0, 100.0, 240.0, 150.0, 60.0, 120.0, 10.0, 0.0, 190.0, 190.0, 20.0, 5.0, 40.0, 290.0, 40.0, 5.0, 70.0, 70.0, 110.0, 210.0, 220.0, 90.0, 60.0, -160.0, 280.0, 20.0, 280.0, 120.0, 0.0, 625.0, -40.0, 30.0, 0.0, -40.0, 0.0, 10.0, 0.0, 50.0, 50.0, 100.0, 90.0, 500.0, 30.0, 60.0, 460.0, 230.0, 120.0, 40.0, 25.0, 340.0, 130.0, 70.0, 90.0, 160.0, 60.0, 160.0, 160.0, 80.0, 30.0, 240.0, 80.0, 290.0, 40.0, 110.0, -40.0, 40.0, 50.0, 0.0, 60.0, 30.0, 10.0, 10.0, 150.0, 280.0, 170.0, 80.0, 160.0, 30.0, 20.0, 130.0, 160.0, 110.0, 240.0, 90.0, 40.0, 290.0, 40.0, 50.0, 130.0, 20.0, 90.0, 100.0, 60.0, 90.0, 70.0, 50.0, 50.0, 150.0, 420.0, 90.0, 330.0, 50.0, 140.0, 310.0, 100.0, 160.0, 10.0, 60.0, 80.0, 20.0, 110.0, 60.0, 190.0, 0.0, -20.0, 380.0, 100.0, 80.0, 40.0, 180.0, 90.0, 190.0, 50.0, 120.0, 110.0, 330.0, 180.0, 70.0, 30.0, -5.0, -20.0, 0.0, 190.0, 0.0, 60.0, 15.0, 0.0, -20.0, 5.0, 100.0, 10.0, 210.0, 210.0, 210.0, 350.0, 40.0, 40.0, 20.0, 20.0, -100.0, 10.0, 0.0, 0.0, 20.0, 60.0, 40.0, 0.0, 0.0, 160.0, 40.0, 90.0, 190.0, 10.0, 480.0, 30.0, 30.0, 40.0, 30.0, 30.0, 30.0, 40.0, 10.0, 300.0, 390.0, 20.0, 50.0, 80.0, 20.0, 50.0, 80.0, 290.0, 120.0, 50.0, 140.0, 410.0, 50.0, 190.0, 60.0, 45.0, 215.0, -40.0, 170.0, 80.0, 70.0, 410.0, 100.0, 140.0, 220.0, 150.0, 60.0, 60.0, 90.0, 180.0, 90.0, 180.0, 60.0, 60.0, 20.0, 60.0, 20.0, 130.0, 20.0, 20.0, 10.0, 40.0, 40.0, 80.0, 0.0, 20.0, 90.0, 50.0, 450.0, 50.0, 0.0, 40.0, 150.0, 100.0, -40.0, 50.0, 180.0, 30.0, 90.0, 300.0, 190.0, 140.0, -150.0, -110.0, 190.0, 280.0, 60.0, 50.0, 50.0, 40.0, 30.0, 310.0, -20.0, 100.0, 110.0, 380.0, -5.0, 70.0, 110.0, 160.0, 250.0, 230.0, 40.0, 140.0, 210.0, 50.0, 110.0, 210.0, 0.0, 270.0, -50.0, 370.0, 110.0, 40.0, 310.0, 720.0, 300.0, -20.0, 40.0, 90.0, 570.0, 270.0, 60.0, 130.0, 20.0, 100.0, 70.0, 320.0, 40.0, -5.0, 80.0, 90.0, 20.0, 120.0, 20.0, 100.0, 0.0, 20.0, 150.0, 40.0, 190.0, -20.0, 20.0, 200.0, 50.0, 160.0, 80.0, 240.0, 160.0, 40.0, 200.0, 110.0, 140.0, 110.0, 520.0, 90.0, 300.0, 60.0, 170.0, 60.0, 300.0, 220.0, 40.0, 15.0, 220.0, 35.0, 130.0, 80.0, -40.0, 330.0, 180.0, 400.0, 120.0, 370.0, 80.0, 210.0, 110.0, 290.0, 90.0, 55.0, 120.0, 30.0, 10.0, 80.0, 170.0, 320.0, 90.0, 50.0, 230.0, 65.0, 60.0, 70.0, 110.0, 180.0, 350.0, 5.0, 50.0, 100.0, 80.0, 20.0, 30.0, 0.0, 130.0, 50.0, 100.0, 30.0, 80.0, 650.0, 50.0, 210.0, 620.0, 160.0, 220.0, 40.0, 250.0, 170.0, 60.0, 170.0, 170.0, 70.0, 320.0, 80.0, -20.0, 30.0, 170.0, 90.0, 410.0, 80.0, 90.0, 160.0, 190.0, 70.0, 130.0, 390.0, 70.0, 220.0, 20.0, 300.0, 60.0, 20.0, 260.0, 100.0, 10.0, 90.0, 50.0, 40.0, 80.0, 40.0, 90.0, 140.0, 130.0, 120.0, 20.0, 150.0, 250.0, 0.0, 90.0, 600.0, 190.0, 10.0, 60.0, -185.0, 40.0, -70.0, 150.0, 70.0, 0.0, 10.0, 250.0, 50.0, 250.0, 10.0, 560.0, 50.0, -60.0, 60.0, 20.0, 180.0, 100.0, 0.0, 40.0, 180.0, 240.0, 50.0, -15.0, 15.0, 50.0, 290.0, 110.0, 30.0, 20.0, 130.0, 85.0, 70.0, 360.0, 160.0, 200.0, 470.0, 0.0, 30.0, 180.0, 30.0, 110.0, 20.0, 10.0, 20.0, 45.0, -20.0, 200.0, 720.0, 50.0, 190.0, 180.0, 160.0, 220.0, -40.0, 90.0, 160.0, 90.0, -30.0, 310.0, -370.0, 30.0, 400.0, 90.0, 120.0, 10.0, 0.0, 110.0, 0.0, 20.0, 80.0, 0.0, 60.0, 260.0, 50.0, 50.0, 410.0, 170.0, 250.0, 120.0, 320.0, 60.0, 70.0, 10.0, 60.0, 120.0, 40.0, 130.0, 100.0, 30.0, 0.0, 120.0, 100.0, 340.0, 30.0, 140.0, 30.0, 520.0, 90.0, 100.0, 320.0, 0.0, 60.0, -20.0, 70.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 190.0, 0.0, 0.0, 40.0, 30.0, 10.0, 30.0, 20.0, 40.0, 0.0, 40.0, 20.0, 30.0, 40.0, 20.0, 20.0, 170.0, 30.0, -10.0, 160.0, 90.0, 70.0, 190.0, 290.0, 40.0, 160.0, 140.0, 120.0, 160.0, 30.0, 60.0, 230.0, 0.0, 320.0, 100.0, -10.0, 40.0, 240.0, 40.0, 40.0, 50.0, 30.0, 40.0, 320.0, 150.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 110.0, 10.0, 20.0, 40.0, 110.0, 0.0, 410.0, 40.0, 90.0, 10.0, 10.0, 90.0, 380.0, 180.0, 40.0, 40.0, 200.0, 80.0, 160.0, 230.0, 410.0, 200.0, 150.0, 30.0, 110.0, 150.0, 0.0, 10.0, 0.0, 0.0, 10.0, 60.0, 20.0, 0.0, 60.0, 0.0, 170.0, -45.0, 60.0, 70.0, 170.0, 60.0, 60.0, -40.0, -60.0, 30.0, 30.0, 60.0, 30.0, 170.0, 170.0, 110.0, 160.0, 120.0, 10.0, 60.0, 160.0, 230.0, 150.0, 50.0, 50.0, 50.0, 410.0, 50.0, 130.0, 100.0, -10.0, 120.0, 80.0, 190.0, 120.0, 10.0, 80.0, 10.0, 130.0, -500.0, 270.0, 140.0, 300.0, -25.0, 20.0, 60.0, 160.0, 100.0, 90.0, 180.0, 40.0, 35.0, 130.0, 50.0, -30.0, 280.0, 160.0, 70.0, 390.0, 190.0, 120.0, 60.0, 0.0, -80.0, 140.0, 380.0, 70.0, 230.0, 240.0, 80.0, 180.0, 350.0, 90.0, 105.0, 15.0, 230.0, 450.0, 200.0, -20.0, 10.0, 60.0, 30.0, 30.0, 0.0, 220.0, 50.0, 110.0, 70.0, 10.0, 10.0, 30.0, 130.0, 80.0, 10.0, 20.0, 170.0, 100.0, 40.0, 180.0, 15.0, 70.0, 120.0, 20.0, 20.0, 10.0, 50.0, 0.0, 110.0, 20.0, 180.0, 90.0, 50.0, 80.0, 0.0, 60.0, 290.0, 140.0, 30.0, 30.0, 20.0, 0.0, 30.0, 10.0, 620.0, 160.0, 0.0, -40.0, 30.0, 100.0, 110.0, 55.0, -120.0, 200.0, 200.0, 100.0, 220.0, 120.0, 130.0, 170.0, 80.0, 240.0, 60.0, 70.0, 20.0, 30.0, 130.0, 120.0, 120.0, 110.0, 40.0, 20.0, 30.0, 40.0, 320.0, 20.0, 10.0, 60.0, 120.0, 0.0, 120.0, 230.0, 340.0, -10.0, 160.0, 140.0, -260.0, 350.0, 210.0, 10.0, 110.0, 120.0, 320.0, 110.0, 40.0, 60.0, 30.0, 100.0, 200.0, 160.0, 200.0, 20.0, 100.0, 30.0, 270.0, 125.0, 0.0, 130.0, 80.0, 190.0, 80.0, 170.0, 95.0, 130.0, 440.0, 190.0, 160.0, 80.0, 30.0, 40.0, 290.0, 10.0, 100.0, 80.0, 30.0, 40.0, 15.0, 180.0, 30.0, 440.0, 30.0, 100.0, 320.0, 30.0, 40.0, 80.0, 320.0, 510.0, 120.0, 80.0, 30.0, 20.0, 40.0, 20.0, 70.0, 10.0, 15.0, 80.0, 20.0, 20.0, 70.0, 20.0, 60.0, 190.0, 130.0, 30.0, 40.0, 330.0, 20.0, 220.0, 0.0, 30.0, 40.0, 180.0, 100.0, 20.0, 20.0, 150.0, 300.0, -30.0, 340.0, 30.0, 60.0, 100.0, 40.0, 10.0, 400.0, 40.0, -10.0, 10.0, 60.0, 60.0, 100.0, 130.0, 320.0, 250.0, 30.0, 110.0, 40.0, 570.0, 210.0, 30.0, 200.0, 0.0, 0.0, 40.0, 470.0, 50.0, 270.0, 0.0, 100.0, 50.0, 250.0, 60.0, 20.0, 110.0, 60.0, 70.0, 570.0, 100.0, 40.0, 130.0, 320.0, 0.0, 0.0, 110.0, 250.0, 120.0, 40.0, 70.0, 10.0, 60.0, 60.0, 320.0, 190.0, 110.0, 190.0, 80.0, 240.0, 40.0, 60.0, 70.0, -80.0, 150.0, 480.0, 50.0, 30.0, 20.0, 190.0, 330.0, 50.0, 60.0, 130.0, 140.0, 180.0, 200.0, 50.0, 190.0, 280.0, 30.0, 60.0, 50.0, 120.0, 380.0, -95.0, 400.0, -60.0, 180.0, 320.0, 180.0, 60.0, 80.0, 20.0, 270.0, 30.0, 0.0, 140.0, 170.0, 50.0, 60.0, 30.0, 50.0, 50.0, 150.0, 0.0, 70.0, 80.0, 170.0, 440.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6719683503482003, "mean_inference_ms": 1.496727185980007, "mean_action_processing_ms": 0.42600648456979684, "mean_env_wait_ms": 1.3475948799643152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013263702392578125, "StateBufferConnector_ms": 0.010325193405151367, "ViewRequirementAgentConnector_ms": 0.40464210510253906}, "num_episodes": 18, "episode_return_max": 2450.0, "episode_return_min": 190.0, "episode_return_mean": 1083.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.870381242760853, "num_env_steps_trained_throughput_per_sec": 18.870381242760853, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 4080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4080000, "timers": {"training_iteration_time_ms": 210799.743, "restore_workers_time_ms": 0.012, "training_step_time_ms": 210799.697, "sample_time_ms": 2867.667, "learn_time_ms": 207909.442, "learn_throughput": 19.239, "synch_weights_time_ms": 13.382}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "done": false, "training_iteration": 102, "trial_id": "aa996_00000", "date": "2024-05-24_04-40-18", "timestamp": 1716540018, "time_this_iter_s": 211.97791385650635, "time_total_s": 21284.503464221954, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd4820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21284.503464221954, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 30.714666666666666, "ram_util_percent": 80.34766666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3701641832550746, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.489075522224743, "policy_loss": -0.007251716505401868, "vf_loss": 6.494987377394248, "vf_explained_var": -0.001603476885662546, "kl": 0.005293303556334689, "entropy": 0.32966685556946473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 962475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "env_runners": {"episode_reward_max": 2450.0, "episode_reward_min": 100.0, "episode_reward_mean": 1051.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 105.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [860.0, 380.0, 940.0, 1140.0, 1110.0, 1255.0, 2090.0, 1560.0, 855.0, 810.0, 1690.0, 1420.0, 1860.0, 1275.0, 1210.0, 590.0, 2450.0, 1140.0, 1810.0, 950.0, 1020.0, 955.0, 1180.0, 810.0, 1305.0, 1070.0, 1705.0, 890.0, 590.0, 1520.0, 1010.0, 1310.0, 250.0, 230.0, 620.0, 1420.0, 850.0, 670.0, 350.0, 1250.0, 1610.0, 310.0, 445.0, 890.0, 1340.0, 830.0, 615.0, 1305.0, 1350.0, 1680.0, 590.0, 770.0, 435.0, 950.0, 930.0, 1185.0, 980.0, 660.0, 1290.0, 1250.0, 1145.0, 1415.0, 1215.0, 1630.0, 325.0, 1110.0, 810.0, 1020.0, 1670.0, 1270.0, 1390.0, 1080.0, 1300.0, 1300.0, 1310.0, 1535.0, 880.0, 1070.0, 1425.0, 100.0, 690.0, 955.0, 1470.0, 450.0, 120.0, 730.0, 360.0, 1850.0, 815.0, 610.0, 1030.0, 1700.0, 990.0, 670.0, 1310.0, 1070.0, 680.0, 910.0, 890.0, 1060.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 60.0, 90.0, 180.0, 90.0, 180.0, 60.0, 60.0, 20.0, 60.0, 20.0, 130.0, 20.0, 20.0, 10.0, 40.0, 40.0, 80.0, 0.0, 20.0, 90.0, 50.0, 450.0, 50.0, 0.0, 40.0, 150.0, 100.0, -40.0, 50.0, 180.0, 30.0, 90.0, 300.0, 190.0, 140.0, -150.0, -110.0, 190.0, 280.0, 60.0, 50.0, 50.0, 40.0, 30.0, 310.0, -20.0, 100.0, 110.0, 380.0, -5.0, 70.0, 110.0, 160.0, 250.0, 230.0, 40.0, 140.0, 210.0, 50.0, 110.0, 210.0, 0.0, 270.0, -50.0, 370.0, 110.0, 40.0, 310.0, 720.0, 300.0, -20.0, 40.0, 90.0, 570.0, 270.0, 60.0, 130.0, 20.0, 100.0, 70.0, 320.0, 40.0, -5.0, 80.0, 90.0, 20.0, 120.0, 20.0, 100.0, 0.0, 20.0, 150.0, 40.0, 190.0, -20.0, 20.0, 200.0, 50.0, 160.0, 80.0, 240.0, 160.0, 40.0, 200.0, 110.0, 140.0, 110.0, 520.0, 90.0, 300.0, 60.0, 170.0, 60.0, 300.0, 220.0, 40.0, 15.0, 220.0, 35.0, 130.0, 80.0, -40.0, 330.0, 180.0, 400.0, 120.0, 370.0, 80.0, 210.0, 110.0, 290.0, 90.0, 55.0, 120.0, 30.0, 10.0, 80.0, 170.0, 320.0, 90.0, 50.0, 230.0, 65.0, 60.0, 70.0, 110.0, 180.0, 350.0, 5.0, 50.0, 100.0, 80.0, 20.0, 30.0, 0.0, 130.0, 50.0, 100.0, 30.0, 80.0, 650.0, 50.0, 210.0, 620.0, 160.0, 220.0, 40.0, 250.0, 170.0, 60.0, 170.0, 170.0, 70.0, 320.0, 80.0, -20.0, 30.0, 170.0, 90.0, 410.0, 80.0, 90.0, 160.0, 190.0, 70.0, 130.0, 390.0, 70.0, 220.0, 20.0, 300.0, 60.0, 20.0, 260.0, 100.0, 10.0, 90.0, 50.0, 40.0, 80.0, 40.0, 90.0, 140.0, 130.0, 120.0, 20.0, 150.0, 250.0, 0.0, 90.0, 600.0, 190.0, 10.0, 60.0, -185.0, 40.0, -70.0, 150.0, 70.0, 0.0, 10.0, 250.0, 50.0, 250.0, 10.0, 560.0, 50.0, -60.0, 60.0, 20.0, 180.0, 100.0, 0.0, 40.0, 180.0, 240.0, 50.0, -15.0, 15.0, 50.0, 290.0, 110.0, 30.0, 20.0, 130.0, 85.0, 70.0, 360.0, 160.0, 200.0, 470.0, 0.0, 30.0, 180.0, 30.0, 110.0, 20.0, 10.0, 20.0, 45.0, -20.0, 200.0, 720.0, 50.0, 190.0, 180.0, 160.0, 220.0, -40.0, 90.0, 160.0, 90.0, -30.0, 310.0, -370.0, 30.0, 400.0, 90.0, 120.0, 10.0, 0.0, 110.0, 0.0, 20.0, 80.0, 0.0, 60.0, 260.0, 50.0, 50.0, 410.0, 170.0, 250.0, 120.0, 320.0, 60.0, 70.0, 10.0, 60.0, 120.0, 40.0, 130.0, 100.0, 30.0, 0.0, 120.0, 100.0, 340.0, 30.0, 140.0, 30.0, 520.0, 90.0, 100.0, 320.0, 0.0, 60.0, -20.0, 70.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 190.0, 0.0, 0.0, 40.0, 30.0, 10.0, 30.0, 20.0, 40.0, 0.0, 40.0, 20.0, 30.0, 40.0, 20.0, 20.0, 170.0, 30.0, -10.0, 160.0, 90.0, 70.0, 190.0, 290.0, 40.0, 160.0, 140.0, 120.0, 160.0, 30.0, 60.0, 230.0, 0.0, 320.0, 100.0, -10.0, 40.0, 240.0, 40.0, 40.0, 50.0, 30.0, 40.0, 320.0, 150.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 110.0, 10.0, 20.0, 40.0, 110.0, 0.0, 410.0, 40.0, 90.0, 10.0, 10.0, 90.0, 380.0, 180.0, 40.0, 40.0, 200.0, 80.0, 160.0, 230.0, 410.0, 200.0, 150.0, 30.0, 110.0, 150.0, 0.0, 10.0, 0.0, 0.0, 10.0, 60.0, 20.0, 0.0, 60.0, 0.0, 170.0, -45.0, 60.0, 70.0, 170.0, 60.0, 60.0, -40.0, -60.0, 30.0, 30.0, 60.0, 30.0, 170.0, 170.0, 110.0, 160.0, 120.0, 10.0, 60.0, 160.0, 230.0, 150.0, 50.0, 50.0, 50.0, 410.0, 50.0, 130.0, 100.0, -10.0, 120.0, 80.0, 190.0, 120.0, 10.0, 80.0, 10.0, 130.0, -500.0, 270.0, 140.0, 300.0, -25.0, 20.0, 60.0, 160.0, 100.0, 90.0, 180.0, 40.0, 35.0, 130.0, 50.0, -30.0, 280.0, 160.0, 70.0, 390.0, 190.0, 120.0, 60.0, 0.0, -80.0, 140.0, 380.0, 70.0, 230.0, 240.0, 80.0, 180.0, 350.0, 90.0, 105.0, 15.0, 230.0, 450.0, 200.0, -20.0, 10.0, 60.0, 30.0, 30.0, 0.0, 220.0, 50.0, 110.0, 70.0, 10.0, 10.0, 30.0, 130.0, 80.0, 10.0, 20.0, 170.0, 100.0, 40.0, 180.0, 15.0, 70.0, 120.0, 20.0, 20.0, 10.0, 50.0, 0.0, 110.0, 20.0, 180.0, 90.0, 50.0, 80.0, 0.0, 60.0, 290.0, 140.0, 30.0, 30.0, 20.0, 0.0, 30.0, 10.0, 620.0, 160.0, 0.0, -40.0, 30.0, 100.0, 110.0, 55.0, -120.0, 200.0, 200.0, 100.0, 220.0, 120.0, 130.0, 170.0, 80.0, 240.0, 60.0, 70.0, 20.0, 30.0, 130.0, 120.0, 120.0, 110.0, 40.0, 20.0, 30.0, 40.0, 320.0, 20.0, 10.0, 60.0, 120.0, 0.0, 120.0, 230.0, 340.0, -10.0, 160.0, 140.0, -260.0, 350.0, 210.0, 10.0, 110.0, 120.0, 320.0, 110.0, 40.0, 60.0, 30.0, 100.0, 200.0, 160.0, 200.0, 20.0, 100.0, 30.0, 270.0, 125.0, 0.0, 130.0, 80.0, 190.0, 80.0, 170.0, 95.0, 130.0, 440.0, 190.0, 160.0, 80.0, 30.0, 40.0, 290.0, 10.0, 100.0, 80.0, 30.0, 40.0, 15.0, 180.0, 30.0, 440.0, 30.0, 100.0, 320.0, 30.0, 40.0, 80.0, 320.0, 510.0, 120.0, 80.0, 30.0, 20.0, 40.0, 20.0, 70.0, 10.0, 15.0, 80.0, 20.0, 20.0, 70.0, 20.0, 60.0, 190.0, 130.0, 30.0, 40.0, 330.0, 20.0, 220.0, 0.0, 30.0, 40.0, 180.0, 100.0, 20.0, 20.0, 150.0, 300.0, -30.0, 340.0, 30.0, 60.0, 100.0, 40.0, 10.0, 400.0, 40.0, -10.0, 10.0, 60.0, 60.0, 100.0, 130.0, 320.0, 250.0, 30.0, 110.0, 40.0, 570.0, 210.0, 30.0, 200.0, 0.0, 0.0, 40.0, 470.0, 50.0, 270.0, 0.0, 100.0, 50.0, 250.0, 60.0, 20.0, 110.0, 60.0, 70.0, 570.0, 100.0, 40.0, 130.0, 320.0, 0.0, 0.0, 110.0, 250.0, 120.0, 40.0, 70.0, 10.0, 60.0, 60.0, 320.0, 190.0, 110.0, 190.0, 80.0, 240.0, 40.0, 60.0, 70.0, -80.0, 150.0, 480.0, 50.0, 30.0, 20.0, 190.0, 330.0, 50.0, 60.0, 130.0, 140.0, 180.0, 200.0, 50.0, 190.0, 280.0, 30.0, 60.0, 50.0, 120.0, 380.0, -95.0, 400.0, -60.0, 180.0, 320.0, 180.0, 60.0, 80.0, 20.0, 270.0, 30.0, 0.0, 140.0, 170.0, 50.0, 60.0, 30.0, 50.0, 50.0, 150.0, 0.0, 70.0, 80.0, 170.0, 440.0, 30.0, 50.0, 60.0, 300.0, 90.0, 260.0, 465.0, 10.0, 90.0, 80.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 190.0, 30.0, 190.0, 10.0, 30.0, 140.0, 30.0, 30.0, 0.0, 60.0, -5.0, 120.0, 210.0, 20.0, 40.0, 280.0, 100.0, 100.0, 30.0, 150.0, 70.0, 60.0, 250.0, -30.0, 130.0, 580.0, 150.0, 30.0, 80.0, 30.0, 170.0, 0.0, 20.0, -10.0, 10.0, 100.0, 60.0, 10.0, 60.0, 25.0, 0.0, 20.0, 35.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 190.0, 80.0, 100.0, 0.0, 40.0, 20.0, 220.0, 0.0, 60.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 190.0, 20.0, 50.0, 10.0, 10.0, 60.0, 740.0, 170.0, 190.0, 130.0, 40.0, 70.0, 310.0, 20.0, 120.0, 40.0, 0.0, 410.0, -25.0, -30.0, 110.0, 150.0, 100.0, 50.0, 10.0, 40.0, 100.0, 60.0, 0.0, 160.0, 10.0, 160.0, 40.0, 30.0, 10.0, 230.0, 150.0, 30.0, -70.0, 150.0, 390.0, 70.0, 60.0, -30.0, 50.0, 430.0, 50.0, 90.0, 130.0, 210.0, 50.0, 140.0, 200.0, 340.0, 60.0, 0.0, 150.0, 480.0, 40.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 180.0, 0.0, 10.0, 20.0, 120.0, 100.0, 100.0, 10.0, 90.0, 40.0, 90.0, 60.0, 90.0, 300.0, 80.0, -100.0, 130.0, 40.0, 200.0, 420.0, 50.0, 140.0, 120.0, 20.0, 200.0, 30.0, 50.0, 330.0, 100.0, 30.0, -70.0, 0.0, 40.0, 160.0, -80.0, 10.0, 170.0, 130.0, 10.0, 310.0, 200.0, 200.0, 40.0, 0.0, 140.0, 0.0, 20.0, 30.0, 70.0, 210.0, 190.0, 60.0, 50.0, 0.0, 90.0, 20.0, 200.0, 120.0, 0.0, 160.0, 0.0, 30.0, 130.0, 300.0, 160.0, 40.0, 20.0, 160.0, 60.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.67401422972994, "mean_inference_ms": 1.4983099828705315, "mean_action_processing_ms": 0.4260440453665989, "mean_env_wait_ms": 1.3465970323420147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012657642364501953, "StateBufferConnector_ms": 0.011162281036376953, "ViewRequirementAgentConnector_ms": 0.4067063331604004}, "num_episodes": 22, "episode_return_max": 2450.0, "episode_return_min": 100.0, "episode_return_mean": 1051.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.890457538702446, "num_env_steps_trained_throughput_per_sec": 18.890457538702446, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 4120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4120000, "timers": {"training_iteration_time_ms": 210816.715, "restore_workers_time_ms": 0.013, "training_step_time_ms": 210816.671, "sample_time_ms": 2900.26, "learn_time_ms": 207894.648, "learn_throughput": 19.241, "synch_weights_time_ms": 12.803}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "done": false, "training_iteration": 103, "trial_id": "aa996_00000", "date": "2024-05-24_04-43-50", "timestamp": 1716540230, "time_this_iter_s": 211.76385188102722, "time_total_s": 21496.26731610298, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d89f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21496.26731610298, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 30.313, "ram_util_percent": 79.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.757239826247334, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007694403760192699, "vf_loss": 7.405361105509586, "vf_explained_var": -0.002596392824500006, "kl": Infinity, "entropy": 0.33447191223454553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 971865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "env_runners": {"episode_reward_max": 1850.0, "episode_reward_min": 100.0, "episode_reward_mean": 1022.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 102.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1810.0, 950.0, 1020.0, 955.0, 1180.0, 810.0, 1305.0, 1070.0, 1705.0, 890.0, 590.0, 1520.0, 1010.0, 1310.0, 250.0, 230.0, 620.0, 1420.0, 850.0, 670.0, 350.0, 1250.0, 1610.0, 310.0, 445.0, 890.0, 1340.0, 830.0, 615.0, 1305.0, 1350.0, 1680.0, 590.0, 770.0, 435.0, 950.0, 930.0, 1185.0, 980.0, 660.0, 1290.0, 1250.0, 1145.0, 1415.0, 1215.0, 1630.0, 325.0, 1110.0, 810.0, 1020.0, 1670.0, 1270.0, 1390.0, 1080.0, 1300.0, 1300.0, 1310.0, 1535.0, 880.0, 1070.0, 1425.0, 100.0, 690.0, 955.0, 1470.0, 450.0, 120.0, 730.0, 360.0, 1850.0, 815.0, 610.0, 1030.0, 1700.0, 990.0, 670.0, 1310.0, 1070.0, 680.0, 910.0, 890.0, 1060.0, 1360.0, 750.0, 990.0, 1055.0, 925.0, 1470.0, 1090.0, 550.0, 740.0, 790.0, 810.0, 1200.0, 1265.0, 1370.0, 1175.0, 1630.0, 1280.0, 1290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [410.0, 80.0, 90.0, 160.0, 190.0, 70.0, 130.0, 390.0, 70.0, 220.0, 20.0, 300.0, 60.0, 20.0, 260.0, 100.0, 10.0, 90.0, 50.0, 40.0, 80.0, 40.0, 90.0, 140.0, 130.0, 120.0, 20.0, 150.0, 250.0, 0.0, 90.0, 600.0, 190.0, 10.0, 60.0, -185.0, 40.0, -70.0, 150.0, 70.0, 0.0, 10.0, 250.0, 50.0, 250.0, 10.0, 560.0, 50.0, -60.0, 60.0, 20.0, 180.0, 100.0, 0.0, 40.0, 180.0, 240.0, 50.0, -15.0, 15.0, 50.0, 290.0, 110.0, 30.0, 20.0, 130.0, 85.0, 70.0, 360.0, 160.0, 200.0, 470.0, 0.0, 30.0, 180.0, 30.0, 110.0, 20.0, 10.0, 20.0, 45.0, -20.0, 200.0, 720.0, 50.0, 190.0, 180.0, 160.0, 220.0, -40.0, 90.0, 160.0, 90.0, -30.0, 310.0, -370.0, 30.0, 400.0, 90.0, 120.0, 10.0, 0.0, 110.0, 0.0, 20.0, 80.0, 0.0, 60.0, 260.0, 50.0, 50.0, 410.0, 170.0, 250.0, 120.0, 320.0, 60.0, 70.0, 10.0, 60.0, 120.0, 40.0, 130.0, 100.0, 30.0, 0.0, 120.0, 100.0, 340.0, 30.0, 140.0, 30.0, 520.0, 90.0, 100.0, 320.0, 0.0, 60.0, -20.0, 70.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 190.0, 0.0, 0.0, 40.0, 30.0, 10.0, 30.0, 20.0, 40.0, 0.0, 40.0, 20.0, 30.0, 40.0, 20.0, 20.0, 170.0, 30.0, -10.0, 160.0, 90.0, 70.0, 190.0, 290.0, 40.0, 160.0, 140.0, 120.0, 160.0, 30.0, 60.0, 230.0, 0.0, 320.0, 100.0, -10.0, 40.0, 240.0, 40.0, 40.0, 50.0, 30.0, 40.0, 320.0, 150.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 110.0, 10.0, 20.0, 40.0, 110.0, 0.0, 410.0, 40.0, 90.0, 10.0, 10.0, 90.0, 380.0, 180.0, 40.0, 40.0, 200.0, 80.0, 160.0, 230.0, 410.0, 200.0, 150.0, 30.0, 110.0, 150.0, 0.0, 10.0, 0.0, 0.0, 10.0, 60.0, 20.0, 0.0, 60.0, 0.0, 170.0, -45.0, 60.0, 70.0, 170.0, 60.0, 60.0, -40.0, -60.0, 30.0, 30.0, 60.0, 30.0, 170.0, 170.0, 110.0, 160.0, 120.0, 10.0, 60.0, 160.0, 230.0, 150.0, 50.0, 50.0, 50.0, 410.0, 50.0, 130.0, 100.0, -10.0, 120.0, 80.0, 190.0, 120.0, 10.0, 80.0, 10.0, 130.0, -500.0, 270.0, 140.0, 300.0, -25.0, 20.0, 60.0, 160.0, 100.0, 90.0, 180.0, 40.0, 35.0, 130.0, 50.0, -30.0, 280.0, 160.0, 70.0, 390.0, 190.0, 120.0, 60.0, 0.0, -80.0, 140.0, 380.0, 70.0, 230.0, 240.0, 80.0, 180.0, 350.0, 90.0, 105.0, 15.0, 230.0, 450.0, 200.0, -20.0, 10.0, 60.0, 30.0, 30.0, 0.0, 220.0, 50.0, 110.0, 70.0, 10.0, 10.0, 30.0, 130.0, 80.0, 10.0, 20.0, 170.0, 100.0, 40.0, 180.0, 15.0, 70.0, 120.0, 20.0, 20.0, 10.0, 50.0, 0.0, 110.0, 20.0, 180.0, 90.0, 50.0, 80.0, 0.0, 60.0, 290.0, 140.0, 30.0, 30.0, 20.0, 0.0, 30.0, 10.0, 620.0, 160.0, 0.0, -40.0, 30.0, 100.0, 110.0, 55.0, -120.0, 200.0, 200.0, 100.0, 220.0, 120.0, 130.0, 170.0, 80.0, 240.0, 60.0, 70.0, 20.0, 30.0, 130.0, 120.0, 120.0, 110.0, 40.0, 20.0, 30.0, 40.0, 320.0, 20.0, 10.0, 60.0, 120.0, 0.0, 120.0, 230.0, 340.0, -10.0, 160.0, 140.0, -260.0, 350.0, 210.0, 10.0, 110.0, 120.0, 320.0, 110.0, 40.0, 60.0, 30.0, 100.0, 200.0, 160.0, 200.0, 20.0, 100.0, 30.0, 270.0, 125.0, 0.0, 130.0, 80.0, 190.0, 80.0, 170.0, 95.0, 130.0, 440.0, 190.0, 160.0, 80.0, 30.0, 40.0, 290.0, 10.0, 100.0, 80.0, 30.0, 40.0, 15.0, 180.0, 30.0, 440.0, 30.0, 100.0, 320.0, 30.0, 40.0, 80.0, 320.0, 510.0, 120.0, 80.0, 30.0, 20.0, 40.0, 20.0, 70.0, 10.0, 15.0, 80.0, 20.0, 20.0, 70.0, 20.0, 60.0, 190.0, 130.0, 30.0, 40.0, 330.0, 20.0, 220.0, 0.0, 30.0, 40.0, 180.0, 100.0, 20.0, 20.0, 150.0, 300.0, -30.0, 340.0, 30.0, 60.0, 100.0, 40.0, 10.0, 400.0, 40.0, -10.0, 10.0, 60.0, 60.0, 100.0, 130.0, 320.0, 250.0, 30.0, 110.0, 40.0, 570.0, 210.0, 30.0, 200.0, 0.0, 0.0, 40.0, 470.0, 50.0, 270.0, 0.0, 100.0, 50.0, 250.0, 60.0, 20.0, 110.0, 60.0, 70.0, 570.0, 100.0, 40.0, 130.0, 320.0, 0.0, 0.0, 110.0, 250.0, 120.0, 40.0, 70.0, 10.0, 60.0, 60.0, 320.0, 190.0, 110.0, 190.0, 80.0, 240.0, 40.0, 60.0, 70.0, -80.0, 150.0, 480.0, 50.0, 30.0, 20.0, 190.0, 330.0, 50.0, 60.0, 130.0, 140.0, 180.0, 200.0, 50.0, 190.0, 280.0, 30.0, 60.0, 50.0, 120.0, 380.0, -95.0, 400.0, -60.0, 180.0, 320.0, 180.0, 60.0, 80.0, 20.0, 270.0, 30.0, 0.0, 140.0, 170.0, 50.0, 60.0, 30.0, 50.0, 50.0, 150.0, 0.0, 70.0, 80.0, 170.0, 440.0, 30.0, 50.0, 60.0, 300.0, 90.0, 260.0, 465.0, 10.0, 90.0, 80.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 190.0, 30.0, 190.0, 10.0, 30.0, 140.0, 30.0, 30.0, 0.0, 60.0, -5.0, 120.0, 210.0, 20.0, 40.0, 280.0, 100.0, 100.0, 30.0, 150.0, 70.0, 60.0, 250.0, -30.0, 130.0, 580.0, 150.0, 30.0, 80.0, 30.0, 170.0, 0.0, 20.0, -10.0, 10.0, 100.0, 60.0, 10.0, 60.0, 25.0, 0.0, 20.0, 35.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 190.0, 80.0, 100.0, 0.0, 40.0, 20.0, 220.0, 0.0, 60.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 190.0, 20.0, 50.0, 10.0, 10.0, 60.0, 740.0, 170.0, 190.0, 130.0, 40.0, 70.0, 310.0, 20.0, 120.0, 40.0, 0.0, 410.0, -25.0, -30.0, 110.0, 150.0, 100.0, 50.0, 10.0, 40.0, 100.0, 60.0, 0.0, 160.0, 10.0, 160.0, 40.0, 30.0, 10.0, 230.0, 150.0, 30.0, -70.0, 150.0, 390.0, 70.0, 60.0, -30.0, 50.0, 430.0, 50.0, 90.0, 130.0, 210.0, 50.0, 140.0, 200.0, 340.0, 60.0, 0.0, 150.0, 480.0, 40.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 180.0, 0.0, 10.0, 20.0, 120.0, 100.0, 100.0, 10.0, 90.0, 40.0, 90.0, 60.0, 90.0, 300.0, 80.0, -100.0, 130.0, 40.0, 200.0, 420.0, 50.0, 140.0, 120.0, 20.0, 200.0, 30.0, 50.0, 330.0, 100.0, 30.0, -70.0, 0.0, 40.0, 160.0, -80.0, 10.0, 170.0, 130.0, 10.0, 310.0, 200.0, 200.0, 40.0, 0.0, 140.0, 0.0, 20.0, 30.0, 70.0, 210.0, 190.0, 60.0, 50.0, 0.0, 90.0, 20.0, 200.0, 120.0, 0.0, 160.0, 0.0, 30.0, 130.0, 300.0, 160.0, 40.0, 20.0, 160.0, 60.0, 160.0, 300.0, 20.0, 50.0, -10.0, 120.0, 80.0, 180.0, 180.0, 30.0, 410.0, 70.0, 70.0, 80.0, 20.0, 160.0, 150.0, 0.0, 120.0, 60.0, 20.0, 80.0, 90.0, 105.0, 20.0, 240.0, 100.0, 25.0, 40.0, 290.0, 0.0, 180.0, 210.0, 0.0, 120.0, 120.0, 15.0, 250.0, 0.0, 170.0, -10.0, 220.0, 10.0, 190.0, 30.0, 30.0, 50.0, 70.0, -15.0, 270.0, 70.0, 20.0, 170.0, 150.0, 360.0, 50.0, 220.0, 380.0, 50.0, -10.0, 80.0, 20.0, 10.0, 290.0, 40.0, 0.0, 50.0, 460.0, 50.0, 130.0, 40.0, 0.0, 0.0, 20.0, 230.0, 80.0, 20.0, 170.0, 0.0, 30.0, 0.0, 30.0, 180.0, 40.0, 210.0, -20.0, 170.0, 40.0, 20.0, 30.0, 40.0, 240.0, 10.0, 20.0, 30.0, 20.0, 20.0, 60.0, 0.0, 50.0, 340.0, 60.0, 20.0, 50.0, 30.0, 160.0, 140.0, 50.0, 200.0, 70.0, 30.0, 10.0, 310.0, 30.0, 410.0, 50.0, 70.0, 70.0, 0.0, 0.0, 250.0, 80.0, 200.0, 190.0, 240.0, 65.0, 100.0, 90.0, 30.0, 120.0, 150.0, 30.0, 50.0, 70.0, 60.0, 310.0, 100.0, 80.0, 70.0, 520.0, 80.0, 150.0, 450.0, 120.0, -5.0, 70.0, 10.0, 110.0, 35.0, 5.0, 230.0, 840.0, 60.0, 70.0, 30.0, 130.0, 130.0, 60.0, 90.0, 180.0, 40.0, 120.0, 230.0, -20.0, 50.0, 40.0, 180.0, 450.0, 20.0, 90.0, 120.0, 50.0, 140.0, 40.0, 280.0, 70.0, 100.0, 200.0, -40.0, 480.0, -30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6727561531122603, "mean_inference_ms": 1.4972213476738552, "mean_action_processing_ms": 0.42582837703463616, "mean_env_wait_ms": 1.3477318330275199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012151241302490234, "StateBufferConnector_ms": 0.010977506637573242, "ViewRequirementAgentConnector_ms": 0.3999032974243164}, "num_episodes": 18, "episode_return_max": 1850.0, "episode_return_min": 100.0, "episode_return_mean": 1022.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.107140720329884, "num_env_steps_trained_throughput_per_sec": 19.107140720329884, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 4160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4160000, "timers": {"training_iteration_time_ms": 210749.837, "restore_workers_time_ms": 0.013, "training_step_time_ms": 210749.794, "sample_time_ms": 2922.619, "learn_time_ms": 207805.435, "learn_throughput": 19.249, "synch_weights_time_ms": 12.712}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "done": false, "training_iteration": 104, "trial_id": "aa996_00000", "date": "2024-05-24_04-47-19", "timestamp": 1716540439, "time_this_iter_s": 209.38347792625427, "time_total_s": 21705.650794029236, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3309e6160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21705.650794029236, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 29.818918918918925, "ram_util_percent": 78.75709459459459}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8977787809821365, "cur_kl_coeff": 0.3796875000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.258255009046886, "policy_loss": -0.007957621610126357, "vf_loss": 7.264505438454235, "vf_explained_var": 0.001904529663193594, "kl": 0.004496315102657275, "entropy": 0.31201594099799157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 981255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "env_runners": {"episode_reward_max": 1850.0, "episode_reward_min": 100.0, "episode_reward_mean": 1044.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 104.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [850.0, 670.0, 350.0, 1250.0, 1610.0, 310.0, 445.0, 890.0, 1340.0, 830.0, 615.0, 1305.0, 1350.0, 1680.0, 590.0, 770.0, 435.0, 950.0, 930.0, 1185.0, 980.0, 660.0, 1290.0, 1250.0, 1145.0, 1415.0, 1215.0, 1630.0, 325.0, 1110.0, 810.0, 1020.0, 1670.0, 1270.0, 1390.0, 1080.0, 1300.0, 1300.0, 1310.0, 1535.0, 880.0, 1070.0, 1425.0, 100.0, 690.0, 955.0, 1470.0, 450.0, 120.0, 730.0, 360.0, 1850.0, 815.0, 610.0, 1030.0, 1700.0, 990.0, 670.0, 1310.0, 1070.0, 680.0, 910.0, 890.0, 1060.0, 1360.0, 750.0, 990.0, 1055.0, 925.0, 1470.0, 1090.0, 550.0, 740.0, 790.0, 810.0, 1200.0, 1265.0, 1370.0, 1175.0, 1630.0, 1280.0, 1290.0, 630.0, 1270.0, 1130.0, 1350.0, 1640.0, 610.0, 930.0, 860.0, 1340.0, 1240.0, 1440.0, 1060.0, 1035.0, 1310.0, 1270.0, 880.0, 1360.0, 1490.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 320.0, 100.0, -10.0, 40.0, 240.0, 40.0, 40.0, 50.0, 30.0, 40.0, 320.0, 150.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 110.0, 10.0, 20.0, 40.0, 110.0, 0.0, 410.0, 40.0, 90.0, 10.0, 10.0, 90.0, 380.0, 180.0, 40.0, 40.0, 200.0, 80.0, 160.0, 230.0, 410.0, 200.0, 150.0, 30.0, 110.0, 150.0, 0.0, 10.0, 0.0, 0.0, 10.0, 60.0, 20.0, 0.0, 60.0, 0.0, 170.0, -45.0, 60.0, 70.0, 170.0, 60.0, 60.0, -40.0, -60.0, 30.0, 30.0, 60.0, 30.0, 170.0, 170.0, 110.0, 160.0, 120.0, 10.0, 60.0, 160.0, 230.0, 150.0, 50.0, 50.0, 50.0, 410.0, 50.0, 130.0, 100.0, -10.0, 120.0, 80.0, 190.0, 120.0, 10.0, 80.0, 10.0, 130.0, -500.0, 270.0, 140.0, 300.0, -25.0, 20.0, 60.0, 160.0, 100.0, 90.0, 180.0, 40.0, 35.0, 130.0, 50.0, -30.0, 280.0, 160.0, 70.0, 390.0, 190.0, 120.0, 60.0, 0.0, -80.0, 140.0, 380.0, 70.0, 230.0, 240.0, 80.0, 180.0, 350.0, 90.0, 105.0, 15.0, 230.0, 450.0, 200.0, -20.0, 10.0, 60.0, 30.0, 30.0, 0.0, 220.0, 50.0, 110.0, 70.0, 10.0, 10.0, 30.0, 130.0, 80.0, 10.0, 20.0, 170.0, 100.0, 40.0, 180.0, 15.0, 70.0, 120.0, 20.0, 20.0, 10.0, 50.0, 0.0, 110.0, 20.0, 180.0, 90.0, 50.0, 80.0, 0.0, 60.0, 290.0, 140.0, 30.0, 30.0, 20.0, 0.0, 30.0, 10.0, 620.0, 160.0, 0.0, -40.0, 30.0, 100.0, 110.0, 55.0, -120.0, 200.0, 200.0, 100.0, 220.0, 120.0, 130.0, 170.0, 80.0, 240.0, 60.0, 70.0, 20.0, 30.0, 130.0, 120.0, 120.0, 110.0, 40.0, 20.0, 30.0, 40.0, 320.0, 20.0, 10.0, 60.0, 120.0, 0.0, 120.0, 230.0, 340.0, -10.0, 160.0, 140.0, -260.0, 350.0, 210.0, 10.0, 110.0, 120.0, 320.0, 110.0, 40.0, 60.0, 30.0, 100.0, 200.0, 160.0, 200.0, 20.0, 100.0, 30.0, 270.0, 125.0, 0.0, 130.0, 80.0, 190.0, 80.0, 170.0, 95.0, 130.0, 440.0, 190.0, 160.0, 80.0, 30.0, 40.0, 290.0, 10.0, 100.0, 80.0, 30.0, 40.0, 15.0, 180.0, 30.0, 440.0, 30.0, 100.0, 320.0, 30.0, 40.0, 80.0, 320.0, 510.0, 120.0, 80.0, 30.0, 20.0, 40.0, 20.0, 70.0, 10.0, 15.0, 80.0, 20.0, 20.0, 70.0, 20.0, 60.0, 190.0, 130.0, 30.0, 40.0, 330.0, 20.0, 220.0, 0.0, 30.0, 40.0, 180.0, 100.0, 20.0, 20.0, 150.0, 300.0, -30.0, 340.0, 30.0, 60.0, 100.0, 40.0, 10.0, 400.0, 40.0, -10.0, 10.0, 60.0, 60.0, 100.0, 130.0, 320.0, 250.0, 30.0, 110.0, 40.0, 570.0, 210.0, 30.0, 200.0, 0.0, 0.0, 40.0, 470.0, 50.0, 270.0, 0.0, 100.0, 50.0, 250.0, 60.0, 20.0, 110.0, 60.0, 70.0, 570.0, 100.0, 40.0, 130.0, 320.0, 0.0, 0.0, 110.0, 250.0, 120.0, 40.0, 70.0, 10.0, 60.0, 60.0, 320.0, 190.0, 110.0, 190.0, 80.0, 240.0, 40.0, 60.0, 70.0, -80.0, 150.0, 480.0, 50.0, 30.0, 20.0, 190.0, 330.0, 50.0, 60.0, 130.0, 140.0, 180.0, 200.0, 50.0, 190.0, 280.0, 30.0, 60.0, 50.0, 120.0, 380.0, -95.0, 400.0, -60.0, 180.0, 320.0, 180.0, 60.0, 80.0, 20.0, 270.0, 30.0, 0.0, 140.0, 170.0, 50.0, 60.0, 30.0, 50.0, 50.0, 150.0, 0.0, 70.0, 80.0, 170.0, 440.0, 30.0, 50.0, 60.0, 300.0, 90.0, 260.0, 465.0, 10.0, 90.0, 80.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 190.0, 30.0, 190.0, 10.0, 30.0, 140.0, 30.0, 30.0, 0.0, 60.0, -5.0, 120.0, 210.0, 20.0, 40.0, 280.0, 100.0, 100.0, 30.0, 150.0, 70.0, 60.0, 250.0, -30.0, 130.0, 580.0, 150.0, 30.0, 80.0, 30.0, 170.0, 0.0, 20.0, -10.0, 10.0, 100.0, 60.0, 10.0, 60.0, 25.0, 0.0, 20.0, 35.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 190.0, 80.0, 100.0, 0.0, 40.0, 20.0, 220.0, 0.0, 60.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 190.0, 20.0, 50.0, 10.0, 10.0, 60.0, 740.0, 170.0, 190.0, 130.0, 40.0, 70.0, 310.0, 20.0, 120.0, 40.0, 0.0, 410.0, -25.0, -30.0, 110.0, 150.0, 100.0, 50.0, 10.0, 40.0, 100.0, 60.0, 0.0, 160.0, 10.0, 160.0, 40.0, 30.0, 10.0, 230.0, 150.0, 30.0, -70.0, 150.0, 390.0, 70.0, 60.0, -30.0, 50.0, 430.0, 50.0, 90.0, 130.0, 210.0, 50.0, 140.0, 200.0, 340.0, 60.0, 0.0, 150.0, 480.0, 40.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 180.0, 0.0, 10.0, 20.0, 120.0, 100.0, 100.0, 10.0, 90.0, 40.0, 90.0, 60.0, 90.0, 300.0, 80.0, -100.0, 130.0, 40.0, 200.0, 420.0, 50.0, 140.0, 120.0, 20.0, 200.0, 30.0, 50.0, 330.0, 100.0, 30.0, -70.0, 0.0, 40.0, 160.0, -80.0, 10.0, 170.0, 130.0, 10.0, 310.0, 200.0, 200.0, 40.0, 0.0, 140.0, 0.0, 20.0, 30.0, 70.0, 210.0, 190.0, 60.0, 50.0, 0.0, 90.0, 20.0, 200.0, 120.0, 0.0, 160.0, 0.0, 30.0, 130.0, 300.0, 160.0, 40.0, 20.0, 160.0, 60.0, 160.0, 300.0, 20.0, 50.0, -10.0, 120.0, 80.0, 180.0, 180.0, 30.0, 410.0, 70.0, 70.0, 80.0, 20.0, 160.0, 150.0, 0.0, 120.0, 60.0, 20.0, 80.0, 90.0, 105.0, 20.0, 240.0, 100.0, 25.0, 40.0, 290.0, 0.0, 180.0, 210.0, 0.0, 120.0, 120.0, 15.0, 250.0, 0.0, 170.0, -10.0, 220.0, 10.0, 190.0, 30.0, 30.0, 50.0, 70.0, -15.0, 270.0, 70.0, 20.0, 170.0, 150.0, 360.0, 50.0, 220.0, 380.0, 50.0, -10.0, 80.0, 20.0, 10.0, 290.0, 40.0, 0.0, 50.0, 460.0, 50.0, 130.0, 40.0, 0.0, 0.0, 20.0, 230.0, 80.0, 20.0, 170.0, 0.0, 30.0, 0.0, 30.0, 180.0, 40.0, 210.0, -20.0, 170.0, 40.0, 20.0, 30.0, 40.0, 240.0, 10.0, 20.0, 30.0, 20.0, 20.0, 60.0, 0.0, 50.0, 340.0, 60.0, 20.0, 50.0, 30.0, 160.0, 140.0, 50.0, 200.0, 70.0, 30.0, 10.0, 310.0, 30.0, 410.0, 50.0, 70.0, 70.0, 0.0, 0.0, 250.0, 80.0, 200.0, 190.0, 240.0, 65.0, 100.0, 90.0, 30.0, 120.0, 150.0, 30.0, 50.0, 70.0, 60.0, 310.0, 100.0, 80.0, 70.0, 520.0, 80.0, 150.0, 450.0, 120.0, -5.0, 70.0, 10.0, 110.0, 35.0, 5.0, 230.0, 840.0, 60.0, 70.0, 30.0, 130.0, 130.0, 60.0, 90.0, 180.0, 40.0, 120.0, 230.0, -20.0, 50.0, 40.0, 180.0, 450.0, 20.0, 90.0, 120.0, 50.0, 140.0, 40.0, 280.0, 70.0, 100.0, 200.0, -40.0, 480.0, -30.0, 0.0, 60.0, 20.0, 100.0, 210.0, 30.0, 10.0, 30.0, 0.0, 170.0, 70.0, 30.0, 190.0, 190.0, 90.0, 60.0, 150.0, 350.0, 10.0, 130.0, 230.0, 20.0, 10.0, 360.0, 80.0, 50.0, 120.0, 100.0, 70.0, 90.0, 0.0, 120.0, 350.0, 210.0, 10.0, 50.0, 170.0, 80.0, 360.0, 0.0, 40.0, 280.0, 40.0, 40.0, 240.0, 110.0, -10.0, 240.0, 70.0, 590.0, 320.0, 0.0, 10.0, 40.0, 0.0, 0.0, 40.0, 40.0, 10.0, 150.0, 90.0, 70.0, 10.0, 40.0, 310.0, 50.0, 40.0, 180.0, 20.0, 120.0, 10.0, 160.0, 10.0, 30.0, 50.0, 30.0, 290.0, 250.0, 20.0, 10.0, 170.0, 20.0, 10.0, 80.0, 130.0, 70.0, 50.0, 510.0, 300.0, 0.0, 0.0, 80.0, 80.0, 130.0, 290.0, 200.0, 180.0, 30.0, 210.0, 40.0, 110.0, 50.0, 110.0, 210.0, -10.0, 330.0, 80.0, 40.0, 360.0, 160.0, 30.0, 260.0, 20.0, 190.0, 300.0, 20.0, 80.0, 40.0, 40.0, 80.0, 30.0, 270.0, 30.0, 160.0, 275.0, 80.0, 90.0, 130.0, 40.0, -70.0, 170.0, 120.0, 60.0, 80.0, 150.0, 70.0, 40.0, 150.0, 310.0, 160.0, 70.0, 50.0, 10.0, 210.0, 140.0, 30.0, 30.0, 10.0, 680.0, 40.0, 140.0, 20.0, 0.0, 0.0, 60.0, 280.0, 300.0, 50.0, 30.0, 0.0, 0.0, 110.0, -20.0, -30.0, 110.0, 630.0, 200.0, 50.0, 290.0, 20.0, 150.0, 210.0, 40.0, 270.0, 10.0, 60.0, 100.0, -10.0, 610.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6733811466454802, "mean_inference_ms": 1.4979163745916244, "mean_action_processing_ms": 0.42580243237816334, "mean_env_wait_ms": 1.3480196427887448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012094974517822266, "StateBufferConnector_ms": 0.010630130767822266, "ViewRequirementAgentConnector_ms": 0.4060182571411133}, "num_episodes": 18, "episode_return_max": 1850.0, "episode_return_min": 100.0, "episode_return_mean": 1044.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.229291991111708, "num_env_steps_trained_throughput_per_sec": 19.229291991111708, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 4200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4200000, "timers": {"training_iteration_time_ms": 210584.332, "restore_workers_time_ms": 0.013, "training_step_time_ms": 210584.289, "sample_time_ms": 2935.532, "learn_time_ms": 207627.2, "learn_throughput": 19.265, "synch_weights_time_ms": 12.592}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "done": false, "training_iteration": 105, "trial_id": "aa996_00000", "date": "2024-05-24_04-50-47", "timestamp": 1716540647, "time_this_iter_s": 208.02462673187256, "time_total_s": 21913.67542076111, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x16003e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21913.67542076111, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 29.485374149659865, "ram_util_percent": 78.97551020408163}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7223523306389588, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.921095704880004, "policy_loss": -0.007040601046567463, "vf_loss": 6.926969827859166, "vf_explained_var": 0.0006330535498163063, "kl": 0.006144398134072452, "entropy": 0.3175113367371031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 990645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "env_runners": {"episode_reward_max": 1850.0, "episode_reward_min": 100.0, "episode_reward_mean": 1075.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 107.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1250.0, 1145.0, 1415.0, 1215.0, 1630.0, 325.0, 1110.0, 810.0, 1020.0, 1670.0, 1270.0, 1390.0, 1080.0, 1300.0, 1300.0, 1310.0, 1535.0, 880.0, 1070.0, 1425.0, 100.0, 690.0, 955.0, 1470.0, 450.0, 120.0, 730.0, 360.0, 1850.0, 815.0, 610.0, 1030.0, 1700.0, 990.0, 670.0, 1310.0, 1070.0, 680.0, 910.0, 890.0, 1060.0, 1360.0, 750.0, 990.0, 1055.0, 925.0, 1470.0, 1090.0, 550.0, 740.0, 790.0, 810.0, 1200.0, 1265.0, 1370.0, 1175.0, 1630.0, 1280.0, 1290.0, 630.0, 1270.0, 1130.0, 1350.0, 1640.0, 610.0, 930.0, 860.0, 1340.0, 1240.0, 1440.0, 1060.0, 1035.0, 1310.0, 1270.0, 880.0, 1360.0, 1490.0, 940.0, 1455.0, 555.0, 965.0, 630.0, 920.0, 1540.0, 960.0, 890.0, 1530.0, 1160.0, 1570.0, 405.0, 1040.0, 1660.0, 1270.0, 1100.0, 1030.0, 660.0, 180.0, 1220.0, 1525.0, 1180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 120.0, 320.0, 110.0, 40.0, 60.0, 30.0, 100.0, 200.0, 160.0, 200.0, 20.0, 100.0, 30.0, 270.0, 125.0, 0.0, 130.0, 80.0, 190.0, 80.0, 170.0, 95.0, 130.0, 440.0, 190.0, 160.0, 80.0, 30.0, 40.0, 290.0, 10.0, 100.0, 80.0, 30.0, 40.0, 15.0, 180.0, 30.0, 440.0, 30.0, 100.0, 320.0, 30.0, 40.0, 80.0, 320.0, 510.0, 120.0, 80.0, 30.0, 20.0, 40.0, 20.0, 70.0, 10.0, 15.0, 80.0, 20.0, 20.0, 70.0, 20.0, 60.0, 190.0, 130.0, 30.0, 40.0, 330.0, 20.0, 220.0, 0.0, 30.0, 40.0, 180.0, 100.0, 20.0, 20.0, 150.0, 300.0, -30.0, 340.0, 30.0, 60.0, 100.0, 40.0, 10.0, 400.0, 40.0, -10.0, 10.0, 60.0, 60.0, 100.0, 130.0, 320.0, 250.0, 30.0, 110.0, 40.0, 570.0, 210.0, 30.0, 200.0, 0.0, 0.0, 40.0, 470.0, 50.0, 270.0, 0.0, 100.0, 50.0, 250.0, 60.0, 20.0, 110.0, 60.0, 70.0, 570.0, 100.0, 40.0, 130.0, 320.0, 0.0, 0.0, 110.0, 250.0, 120.0, 40.0, 70.0, 10.0, 60.0, 60.0, 320.0, 190.0, 110.0, 190.0, 80.0, 240.0, 40.0, 60.0, 70.0, -80.0, 150.0, 480.0, 50.0, 30.0, 20.0, 190.0, 330.0, 50.0, 60.0, 130.0, 140.0, 180.0, 200.0, 50.0, 190.0, 280.0, 30.0, 60.0, 50.0, 120.0, 380.0, -95.0, 400.0, -60.0, 180.0, 320.0, 180.0, 60.0, 80.0, 20.0, 270.0, 30.0, 0.0, 140.0, 170.0, 50.0, 60.0, 30.0, 50.0, 50.0, 150.0, 0.0, 70.0, 80.0, 170.0, 440.0, 30.0, 50.0, 60.0, 300.0, 90.0, 260.0, 465.0, 10.0, 90.0, 80.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 190.0, 30.0, 190.0, 10.0, 30.0, 140.0, 30.0, 30.0, 0.0, 60.0, -5.0, 120.0, 210.0, 20.0, 40.0, 280.0, 100.0, 100.0, 30.0, 150.0, 70.0, 60.0, 250.0, -30.0, 130.0, 580.0, 150.0, 30.0, 80.0, 30.0, 170.0, 0.0, 20.0, -10.0, 10.0, 100.0, 60.0, 10.0, 60.0, 25.0, 0.0, 20.0, 35.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 190.0, 80.0, 100.0, 0.0, 40.0, 20.0, 220.0, 0.0, 60.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 190.0, 20.0, 50.0, 10.0, 10.0, 60.0, 740.0, 170.0, 190.0, 130.0, 40.0, 70.0, 310.0, 20.0, 120.0, 40.0, 0.0, 410.0, -25.0, -30.0, 110.0, 150.0, 100.0, 50.0, 10.0, 40.0, 100.0, 60.0, 0.0, 160.0, 10.0, 160.0, 40.0, 30.0, 10.0, 230.0, 150.0, 30.0, -70.0, 150.0, 390.0, 70.0, 60.0, -30.0, 50.0, 430.0, 50.0, 90.0, 130.0, 210.0, 50.0, 140.0, 200.0, 340.0, 60.0, 0.0, 150.0, 480.0, 40.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 180.0, 0.0, 10.0, 20.0, 120.0, 100.0, 100.0, 10.0, 90.0, 40.0, 90.0, 60.0, 90.0, 300.0, 80.0, -100.0, 130.0, 40.0, 200.0, 420.0, 50.0, 140.0, 120.0, 20.0, 200.0, 30.0, 50.0, 330.0, 100.0, 30.0, -70.0, 0.0, 40.0, 160.0, -80.0, 10.0, 170.0, 130.0, 10.0, 310.0, 200.0, 200.0, 40.0, 0.0, 140.0, 0.0, 20.0, 30.0, 70.0, 210.0, 190.0, 60.0, 50.0, 0.0, 90.0, 20.0, 200.0, 120.0, 0.0, 160.0, 0.0, 30.0, 130.0, 300.0, 160.0, 40.0, 20.0, 160.0, 60.0, 160.0, 300.0, 20.0, 50.0, -10.0, 120.0, 80.0, 180.0, 180.0, 30.0, 410.0, 70.0, 70.0, 80.0, 20.0, 160.0, 150.0, 0.0, 120.0, 60.0, 20.0, 80.0, 90.0, 105.0, 20.0, 240.0, 100.0, 25.0, 40.0, 290.0, 0.0, 180.0, 210.0, 0.0, 120.0, 120.0, 15.0, 250.0, 0.0, 170.0, -10.0, 220.0, 10.0, 190.0, 30.0, 30.0, 50.0, 70.0, -15.0, 270.0, 70.0, 20.0, 170.0, 150.0, 360.0, 50.0, 220.0, 380.0, 50.0, -10.0, 80.0, 20.0, 10.0, 290.0, 40.0, 0.0, 50.0, 460.0, 50.0, 130.0, 40.0, 0.0, 0.0, 20.0, 230.0, 80.0, 20.0, 170.0, 0.0, 30.0, 0.0, 30.0, 180.0, 40.0, 210.0, -20.0, 170.0, 40.0, 20.0, 30.0, 40.0, 240.0, 10.0, 20.0, 30.0, 20.0, 20.0, 60.0, 0.0, 50.0, 340.0, 60.0, 20.0, 50.0, 30.0, 160.0, 140.0, 50.0, 200.0, 70.0, 30.0, 10.0, 310.0, 30.0, 410.0, 50.0, 70.0, 70.0, 0.0, 0.0, 250.0, 80.0, 200.0, 190.0, 240.0, 65.0, 100.0, 90.0, 30.0, 120.0, 150.0, 30.0, 50.0, 70.0, 60.0, 310.0, 100.0, 80.0, 70.0, 520.0, 80.0, 150.0, 450.0, 120.0, -5.0, 70.0, 10.0, 110.0, 35.0, 5.0, 230.0, 840.0, 60.0, 70.0, 30.0, 130.0, 130.0, 60.0, 90.0, 180.0, 40.0, 120.0, 230.0, -20.0, 50.0, 40.0, 180.0, 450.0, 20.0, 90.0, 120.0, 50.0, 140.0, 40.0, 280.0, 70.0, 100.0, 200.0, -40.0, 480.0, -30.0, 0.0, 60.0, 20.0, 100.0, 210.0, 30.0, 10.0, 30.0, 0.0, 170.0, 70.0, 30.0, 190.0, 190.0, 90.0, 60.0, 150.0, 350.0, 10.0, 130.0, 230.0, 20.0, 10.0, 360.0, 80.0, 50.0, 120.0, 100.0, 70.0, 90.0, 0.0, 120.0, 350.0, 210.0, 10.0, 50.0, 170.0, 80.0, 360.0, 0.0, 40.0, 280.0, 40.0, 40.0, 240.0, 110.0, -10.0, 240.0, 70.0, 590.0, 320.0, 0.0, 10.0, 40.0, 0.0, 0.0, 40.0, 40.0, 10.0, 150.0, 90.0, 70.0, 10.0, 40.0, 310.0, 50.0, 40.0, 180.0, 20.0, 120.0, 10.0, 160.0, 10.0, 30.0, 50.0, 30.0, 290.0, 250.0, 20.0, 10.0, 170.0, 20.0, 10.0, 80.0, 130.0, 70.0, 50.0, 510.0, 300.0, 0.0, 0.0, 80.0, 80.0, 130.0, 290.0, 200.0, 180.0, 30.0, 210.0, 40.0, 110.0, 50.0, 110.0, 210.0, -10.0, 330.0, 80.0, 40.0, 360.0, 160.0, 30.0, 260.0, 20.0, 190.0, 300.0, 20.0, 80.0, 40.0, 40.0, 80.0, 30.0, 270.0, 30.0, 160.0, 275.0, 80.0, 90.0, 130.0, 40.0, -70.0, 170.0, 120.0, 60.0, 80.0, 150.0, 70.0, 40.0, 150.0, 310.0, 160.0, 70.0, 50.0, 10.0, 210.0, 140.0, 30.0, 30.0, 10.0, 680.0, 40.0, 140.0, 20.0, 0.0, 0.0, 60.0, 280.0, 300.0, 50.0, 30.0, 0.0, 0.0, 110.0, -20.0, -30.0, 110.0, 630.0, 200.0, 50.0, 290.0, 20.0, 150.0, 210.0, 40.0, 270.0, 10.0, 60.0, 100.0, -10.0, 610.0, 50.0, 90.0, 170.0, 110.0, 50.0, 20.0, 10.0, 40.0, -20.0, 160.0, 310.0, 50.0, 110.0, 160.0, 80.0, 165.0, 200.0, 70.0, 310.0, 130.0, 180.0, 10.0, 70.0, 410.0, 30.0, 40.0, 40.0, 10.0, 0.0, 20.0, -75.0, 80.0, 15.0, 60.0, 150.0, 60.0, 100.0, 310.0, 70.0, 100.0, 20.0, 0.0, 80.0, 130.0, 20.0, 20.0, 70.0, 100.0, 20.0, 70.0, 120.0, 60.0, 40.0, 30.0, 30.0, 270.0, 250.0, 0.0, 180.0, 40.0, 20.0, 70.0, 40.0, 310.0, 60.0, 20.0, 20.0, 30.0, 50.0, 670.0, 270.0, 30.0, 240.0, 110.0, 170.0, 40.0, 40.0, 80.0, 110.0, 40.0, 100.0, 90.0, 30.0, 120.0, 360.0, 0.0, 10.0, 90.0, 120.0, 60.0, 10.0, 110.0, 740.0, 190.0, 130.0, 90.0, 20.0, 10.0, 150.0, 0.0, 90.0, 150.0, 160.0, 10.0, 90.0, 30.0, 40.0, 150.0, -10.0, 160.0, 380.0, 510.0, 40.0, 80.0, 90.0, 60.0, 280.0, 180.0, 280.0, 0.0, 50.0, 15.0, 0.0, 40.0, 190.0, 0.0, 40.0, 70.0, 10.0, 40.0, 0.0, 40.0, -10.0, 280.0, -30.0, 20.0, 550.0, 40.0, 30.0, 40.0, 80.0, 90.0, 90.0, 390.0, 40.0, 110.0, 60.0, 500.0, 120.0, 0.0, 260.0, 100.0, 540.0, -30.0, 50.0, -50.0, -40.0, 340.0, 80.0, 280.0, 0.0, 50.0, -10.0, 40.0, 40.0, 140.0, 680.0, 50.0, -30.0, 60.0, 80.0, 0.0, 90.0, 60.0, -10.0, 110.0, 40.0, 240.0, 160.0, 310.0, 30.0, 40.0, 210.0, -25.0, 120.0, 180.0, 20.0, 20.0, 170.0, -75.0, 0.0, 10.0, 20.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 120.0, 150.0, 160.0, -10.0, 330.0, 190.0, 50.0, 40.0, 170.0, 20.0, 340.0, 460.0, 20.0, 30.0, 70.0, 95.0, 50.0, 360.0, 10.0, 90.0, 40.0, 30.0, 110.0, 60.0, 100.0, 60.0, 120.0, 60.0, 520.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6742635625617348, "mean_inference_ms": 1.498994633785357, "mean_action_processing_ms": 0.42578287220171246, "mean_env_wait_ms": 1.3484632484912205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01323699951171875, "StateBufferConnector_ms": 0.010870695114135742, "ViewRequirementAgentConnector_ms": 0.42017292976379395}, "num_episodes": 23, "episode_return_max": 1850.0, "episode_return_min": 100.0, "episode_return_mean": 1075.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.182267239952772, "num_env_steps_trained_throughput_per_sec": 19.182267239952772, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 4240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4240000, "timers": {"training_iteration_time_ms": 210495.029, "restore_workers_time_ms": 0.012, "training_step_time_ms": 210494.986, "sample_time_ms": 2928.02, "learn_time_ms": 207545.47, "learn_throughput": 19.273, "synch_weights_time_ms": 12.42}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "done": false, "training_iteration": 106, "trial_id": "aa996_00000", "date": "2024-05-24_04-54-16", "timestamp": 1716540856, "time_this_iter_s": 208.5506670475006, "time_total_s": 22122.22608780861, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dd48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22122.22608780861, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.751525423728815, "ram_util_percent": 79.17152542372881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.397979525255319, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.225913036974093, "policy_loss": -0.008037485179855341, "vf_loss": 7.232796566123271, "vf_explained_var": 0.0006886542033844482, "kl": 0.006078407479460738, "entropy": 0.3231999205562253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1000035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "env_runners": {"episode_reward_max": 1850.0, "episode_reward_min": 100.0, "episode_reward_mean": 1051.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 105.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1070.0, 1425.0, 100.0, 690.0, 955.0, 1470.0, 450.0, 120.0, 730.0, 360.0, 1850.0, 815.0, 610.0, 1030.0, 1700.0, 990.0, 670.0, 1310.0, 1070.0, 680.0, 910.0, 890.0, 1060.0, 1360.0, 750.0, 990.0, 1055.0, 925.0, 1470.0, 1090.0, 550.0, 740.0, 790.0, 810.0, 1200.0, 1265.0, 1370.0, 1175.0, 1630.0, 1280.0, 1290.0, 630.0, 1270.0, 1130.0, 1350.0, 1640.0, 610.0, 930.0, 860.0, 1340.0, 1240.0, 1440.0, 1060.0, 1035.0, 1310.0, 1270.0, 880.0, 1360.0, 1490.0, 940.0, 1455.0, 555.0, 965.0, 630.0, 920.0, 1540.0, 960.0, 890.0, 1530.0, 1160.0, 1570.0, 405.0, 1040.0, 1660.0, 1270.0, 1100.0, 1030.0, 660.0, 180.0, 1220.0, 1525.0, 1180.0, 1070.0, 760.0, 1205.0, 1440.0, 595.0, 1690.0, 1250.0, 1320.0, 830.0, 910.0, 1320.0, 1205.0, 290.0, 1255.0, 790.0, 1075.0, 1025.0, 1220.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 50.0, 50.0, 150.0, 0.0, 70.0, 80.0, 170.0, 440.0, 30.0, 50.0, 60.0, 300.0, 90.0, 260.0, 465.0, 10.0, 90.0, 80.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 190.0, 30.0, 190.0, 10.0, 30.0, 140.0, 30.0, 30.0, 0.0, 60.0, -5.0, 120.0, 210.0, 20.0, 40.0, 280.0, 100.0, 100.0, 30.0, 150.0, 70.0, 60.0, 250.0, -30.0, 130.0, 580.0, 150.0, 30.0, 80.0, 30.0, 170.0, 0.0, 20.0, -10.0, 10.0, 100.0, 60.0, 10.0, 60.0, 25.0, 0.0, 20.0, 35.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 190.0, 80.0, 100.0, 0.0, 40.0, 20.0, 220.0, 0.0, 60.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 190.0, 20.0, 50.0, 10.0, 10.0, 60.0, 740.0, 170.0, 190.0, 130.0, 40.0, 70.0, 310.0, 20.0, 120.0, 40.0, 0.0, 410.0, -25.0, -30.0, 110.0, 150.0, 100.0, 50.0, 10.0, 40.0, 100.0, 60.0, 0.0, 160.0, 10.0, 160.0, 40.0, 30.0, 10.0, 230.0, 150.0, 30.0, -70.0, 150.0, 390.0, 70.0, 60.0, -30.0, 50.0, 430.0, 50.0, 90.0, 130.0, 210.0, 50.0, 140.0, 200.0, 340.0, 60.0, 0.0, 150.0, 480.0, 40.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 180.0, 0.0, 10.0, 20.0, 120.0, 100.0, 100.0, 10.0, 90.0, 40.0, 90.0, 60.0, 90.0, 300.0, 80.0, -100.0, 130.0, 40.0, 200.0, 420.0, 50.0, 140.0, 120.0, 20.0, 200.0, 30.0, 50.0, 330.0, 100.0, 30.0, -70.0, 0.0, 40.0, 160.0, -80.0, 10.0, 170.0, 130.0, 10.0, 310.0, 200.0, 200.0, 40.0, 0.0, 140.0, 0.0, 20.0, 30.0, 70.0, 210.0, 190.0, 60.0, 50.0, 0.0, 90.0, 20.0, 200.0, 120.0, 0.0, 160.0, 0.0, 30.0, 130.0, 300.0, 160.0, 40.0, 20.0, 160.0, 60.0, 160.0, 300.0, 20.0, 50.0, -10.0, 120.0, 80.0, 180.0, 180.0, 30.0, 410.0, 70.0, 70.0, 80.0, 20.0, 160.0, 150.0, 0.0, 120.0, 60.0, 20.0, 80.0, 90.0, 105.0, 20.0, 240.0, 100.0, 25.0, 40.0, 290.0, 0.0, 180.0, 210.0, 0.0, 120.0, 120.0, 15.0, 250.0, 0.0, 170.0, -10.0, 220.0, 10.0, 190.0, 30.0, 30.0, 50.0, 70.0, -15.0, 270.0, 70.0, 20.0, 170.0, 150.0, 360.0, 50.0, 220.0, 380.0, 50.0, -10.0, 80.0, 20.0, 10.0, 290.0, 40.0, 0.0, 50.0, 460.0, 50.0, 130.0, 40.0, 0.0, 0.0, 20.0, 230.0, 80.0, 20.0, 170.0, 0.0, 30.0, 0.0, 30.0, 180.0, 40.0, 210.0, -20.0, 170.0, 40.0, 20.0, 30.0, 40.0, 240.0, 10.0, 20.0, 30.0, 20.0, 20.0, 60.0, 0.0, 50.0, 340.0, 60.0, 20.0, 50.0, 30.0, 160.0, 140.0, 50.0, 200.0, 70.0, 30.0, 10.0, 310.0, 30.0, 410.0, 50.0, 70.0, 70.0, 0.0, 0.0, 250.0, 80.0, 200.0, 190.0, 240.0, 65.0, 100.0, 90.0, 30.0, 120.0, 150.0, 30.0, 50.0, 70.0, 60.0, 310.0, 100.0, 80.0, 70.0, 520.0, 80.0, 150.0, 450.0, 120.0, -5.0, 70.0, 10.0, 110.0, 35.0, 5.0, 230.0, 840.0, 60.0, 70.0, 30.0, 130.0, 130.0, 60.0, 90.0, 180.0, 40.0, 120.0, 230.0, -20.0, 50.0, 40.0, 180.0, 450.0, 20.0, 90.0, 120.0, 50.0, 140.0, 40.0, 280.0, 70.0, 100.0, 200.0, -40.0, 480.0, -30.0, 0.0, 60.0, 20.0, 100.0, 210.0, 30.0, 10.0, 30.0, 0.0, 170.0, 70.0, 30.0, 190.0, 190.0, 90.0, 60.0, 150.0, 350.0, 10.0, 130.0, 230.0, 20.0, 10.0, 360.0, 80.0, 50.0, 120.0, 100.0, 70.0, 90.0, 0.0, 120.0, 350.0, 210.0, 10.0, 50.0, 170.0, 80.0, 360.0, 0.0, 40.0, 280.0, 40.0, 40.0, 240.0, 110.0, -10.0, 240.0, 70.0, 590.0, 320.0, 0.0, 10.0, 40.0, 0.0, 0.0, 40.0, 40.0, 10.0, 150.0, 90.0, 70.0, 10.0, 40.0, 310.0, 50.0, 40.0, 180.0, 20.0, 120.0, 10.0, 160.0, 10.0, 30.0, 50.0, 30.0, 290.0, 250.0, 20.0, 10.0, 170.0, 20.0, 10.0, 80.0, 130.0, 70.0, 50.0, 510.0, 300.0, 0.0, 0.0, 80.0, 80.0, 130.0, 290.0, 200.0, 180.0, 30.0, 210.0, 40.0, 110.0, 50.0, 110.0, 210.0, -10.0, 330.0, 80.0, 40.0, 360.0, 160.0, 30.0, 260.0, 20.0, 190.0, 300.0, 20.0, 80.0, 40.0, 40.0, 80.0, 30.0, 270.0, 30.0, 160.0, 275.0, 80.0, 90.0, 130.0, 40.0, -70.0, 170.0, 120.0, 60.0, 80.0, 150.0, 70.0, 40.0, 150.0, 310.0, 160.0, 70.0, 50.0, 10.0, 210.0, 140.0, 30.0, 30.0, 10.0, 680.0, 40.0, 140.0, 20.0, 0.0, 0.0, 60.0, 280.0, 300.0, 50.0, 30.0, 0.0, 0.0, 110.0, -20.0, -30.0, 110.0, 630.0, 200.0, 50.0, 290.0, 20.0, 150.0, 210.0, 40.0, 270.0, 10.0, 60.0, 100.0, -10.0, 610.0, 50.0, 90.0, 170.0, 110.0, 50.0, 20.0, 10.0, 40.0, -20.0, 160.0, 310.0, 50.0, 110.0, 160.0, 80.0, 165.0, 200.0, 70.0, 310.0, 130.0, 180.0, 10.0, 70.0, 410.0, 30.0, 40.0, 40.0, 10.0, 0.0, 20.0, -75.0, 80.0, 15.0, 60.0, 150.0, 60.0, 100.0, 310.0, 70.0, 100.0, 20.0, 0.0, 80.0, 130.0, 20.0, 20.0, 70.0, 100.0, 20.0, 70.0, 120.0, 60.0, 40.0, 30.0, 30.0, 270.0, 250.0, 0.0, 180.0, 40.0, 20.0, 70.0, 40.0, 310.0, 60.0, 20.0, 20.0, 30.0, 50.0, 670.0, 270.0, 30.0, 240.0, 110.0, 170.0, 40.0, 40.0, 80.0, 110.0, 40.0, 100.0, 90.0, 30.0, 120.0, 360.0, 0.0, 10.0, 90.0, 120.0, 60.0, 10.0, 110.0, 740.0, 190.0, 130.0, 90.0, 20.0, 10.0, 150.0, 0.0, 90.0, 150.0, 160.0, 10.0, 90.0, 30.0, 40.0, 150.0, -10.0, 160.0, 380.0, 510.0, 40.0, 80.0, 90.0, 60.0, 280.0, 180.0, 280.0, 0.0, 50.0, 15.0, 0.0, 40.0, 190.0, 0.0, 40.0, 70.0, 10.0, 40.0, 0.0, 40.0, -10.0, 280.0, -30.0, 20.0, 550.0, 40.0, 30.0, 40.0, 80.0, 90.0, 90.0, 390.0, 40.0, 110.0, 60.0, 500.0, 120.0, 0.0, 260.0, 100.0, 540.0, -30.0, 50.0, -50.0, -40.0, 340.0, 80.0, 280.0, 0.0, 50.0, -10.0, 40.0, 40.0, 140.0, 680.0, 50.0, -30.0, 60.0, 80.0, 0.0, 90.0, 60.0, -10.0, 110.0, 40.0, 240.0, 160.0, 310.0, 30.0, 40.0, 210.0, -25.0, 120.0, 180.0, 20.0, 20.0, 170.0, -75.0, 0.0, 10.0, 20.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 120.0, 150.0, 160.0, -10.0, 330.0, 190.0, 50.0, 40.0, 170.0, 20.0, 340.0, 460.0, 20.0, 30.0, 70.0, 95.0, 50.0, 360.0, 10.0, 90.0, 40.0, 30.0, 110.0, 60.0, 100.0, 60.0, 120.0, 60.0, 520.0, 80.0, 20.0, 40.0, 40.0, 30.0, 40.0, 490.0, 230.0, 60.0, 80.0, 40.0, 140.0, 30.0, 30.0, 10.0, 220.0, 230.0, 60.0, 30.0, 10.0, 0.0, 590.0, 0.0, 290.0, 40.0, 45.0, 60.0, 60.0, 160.0, -10.0, -30.0, 70.0, 100.0, 200.0, 110.0, 60.0, 180.0, 420.0, 150.0, 100.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 65.0, 90.0, 260.0, 30.0, 330.0, 70.0, 280.0, 130.0, 45.0, 260.0, 375.0, 150.0, 20.0, 50.0, 330.0, 100.0, 210.0, 30.0, 80.0, -20.0, 220.0, 60.0, 190.0, 60.0, 320.0, 250.0, 120.0, 50.0, 120.0, 130.0, 70.0, 40.0, 160.0, 170.0, 110.0, 170.0, 120.0, 60.0, 130.0, 60.0, -140.0, 140.0, 10.0, 70.0, -40.0, 110.0, 20.0, 0.0, 270.0, 100.0, 30.0, 190.0, 160.0, 200.0, 140.0, 160.0, 80.0, 220.0, 70.0, 10.0, 280.0, 80.0, 80.0, 25.0, 100.0, 70.0, 60.0, 120.0, 370.0, 140.0, 190.0, 30.0, 100.0, 90.0, 30.0, 0.0, 10.0, 30.0, 70.0, 30.0, 10.0, 0.0, 20.0, 610.0, 0.0, 10.0, 50.0, 160.0, 210.0, 160.0, 55.0, 10.0, -10.0, 90.0, 150.0, -20.0, 100.0, 40.0, 20.0, 160.0, 60.0, 100.0, 90.0, 40.0, 120.0, 70.0, 35.0, 210.0, 150.0, 40.0, 300.0, 50.0, 60.0, 25.0, 30.0, 100.0, 100.0, 330.0, 80.0, 90.0, 120.0, 90.0, 60.0, 40.0, 230.0, 140.0, 30.0, 10.0, 140.0, 40.0, 460.0, 130.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6750529465566466, "mean_inference_ms": 1.4997921102718998, "mean_action_processing_ms": 0.4257816015502406, "mean_env_wait_ms": 1.3487622597736122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01324009895324707, "StateBufferConnector_ms": 0.011171102523803711, "ViewRequirementAgentConnector_ms": 0.4210622310638428}, "num_episodes": 18, "episode_return_max": 1850.0, "episode_return_min": 100.0, "episode_return_mean": 1051.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.014102800725645, "num_env_steps_trained_throughput_per_sec": 19.014102800725645, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 4280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4280000, "timers": {"training_iteration_time_ms": 210489.315, "restore_workers_time_ms": 0.013, "training_step_time_ms": 210489.271, "sample_time_ms": 2918.96, "learn_time_ms": 207547.376, "learn_throughput": 19.273, "synch_weights_time_ms": 12.524}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "done": false, "training_iteration": 107, "trial_id": "aa996_00000", "date": "2024-05-24_04-57-46", "timestamp": 1716541066, "time_this_iter_s": 210.3827350139618, "time_total_s": 22332.60882282257, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dc3430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22332.60882282257, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 19.293959731543623, "ram_util_percent": 79.97080536912752}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6659518580340222, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.921793007012754, "policy_loss": -0.008045512138859937, "vf_loss": 6.9286882454340954, "vf_explained_var": 0.0004178953437378612, "kl": 0.006059020968972013, "entropy": 0.314958246055439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1009425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "env_runners": {"episode_reward_max": 1690.0, "episode_reward_min": 180.0, "episode_reward_mean": 1075.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 107.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1060.0, 1360.0, 750.0, 990.0, 1055.0, 925.0, 1470.0, 1090.0, 550.0, 740.0, 790.0, 810.0, 1200.0, 1265.0, 1370.0, 1175.0, 1630.0, 1280.0, 1290.0, 630.0, 1270.0, 1130.0, 1350.0, 1640.0, 610.0, 930.0, 860.0, 1340.0, 1240.0, 1440.0, 1060.0, 1035.0, 1310.0, 1270.0, 880.0, 1360.0, 1490.0, 940.0, 1455.0, 555.0, 965.0, 630.0, 920.0, 1540.0, 960.0, 890.0, 1530.0, 1160.0, 1570.0, 405.0, 1040.0, 1660.0, 1270.0, 1100.0, 1030.0, 660.0, 180.0, 1220.0, 1525.0, 1180.0, 1070.0, 760.0, 1205.0, 1440.0, 595.0, 1690.0, 1250.0, 1320.0, 830.0, 910.0, 1320.0, 1205.0, 290.0, 1255.0, 790.0, 1075.0, 1025.0, 1220.0, 590.0, 1670.0, 1240.0, 725.0, 1075.0, 1310.0, 455.0, 710.0, 530.0, 1270.0, 1440.0, 1120.0, 1420.0, 1590.0, 1315.0, 1140.0, 680.0, 800.0, 1010.0, 1050.0, 280.0, 830.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 30.0, 130.0, 300.0, 160.0, 40.0, 20.0, 160.0, 60.0, 160.0, 300.0, 20.0, 50.0, -10.0, 120.0, 80.0, 180.0, 180.0, 30.0, 410.0, 70.0, 70.0, 80.0, 20.0, 160.0, 150.0, 0.0, 120.0, 60.0, 20.0, 80.0, 90.0, 105.0, 20.0, 240.0, 100.0, 25.0, 40.0, 290.0, 0.0, 180.0, 210.0, 0.0, 120.0, 120.0, 15.0, 250.0, 0.0, 170.0, -10.0, 220.0, 10.0, 190.0, 30.0, 30.0, 50.0, 70.0, -15.0, 270.0, 70.0, 20.0, 170.0, 150.0, 360.0, 50.0, 220.0, 380.0, 50.0, -10.0, 80.0, 20.0, 10.0, 290.0, 40.0, 0.0, 50.0, 460.0, 50.0, 130.0, 40.0, 0.0, 0.0, 20.0, 230.0, 80.0, 20.0, 170.0, 0.0, 30.0, 0.0, 30.0, 180.0, 40.0, 210.0, -20.0, 170.0, 40.0, 20.0, 30.0, 40.0, 240.0, 10.0, 20.0, 30.0, 20.0, 20.0, 60.0, 0.0, 50.0, 340.0, 60.0, 20.0, 50.0, 30.0, 160.0, 140.0, 50.0, 200.0, 70.0, 30.0, 10.0, 310.0, 30.0, 410.0, 50.0, 70.0, 70.0, 0.0, 0.0, 250.0, 80.0, 200.0, 190.0, 240.0, 65.0, 100.0, 90.0, 30.0, 120.0, 150.0, 30.0, 50.0, 70.0, 60.0, 310.0, 100.0, 80.0, 70.0, 520.0, 80.0, 150.0, 450.0, 120.0, -5.0, 70.0, 10.0, 110.0, 35.0, 5.0, 230.0, 840.0, 60.0, 70.0, 30.0, 130.0, 130.0, 60.0, 90.0, 180.0, 40.0, 120.0, 230.0, -20.0, 50.0, 40.0, 180.0, 450.0, 20.0, 90.0, 120.0, 50.0, 140.0, 40.0, 280.0, 70.0, 100.0, 200.0, -40.0, 480.0, -30.0, 0.0, 60.0, 20.0, 100.0, 210.0, 30.0, 10.0, 30.0, 0.0, 170.0, 70.0, 30.0, 190.0, 190.0, 90.0, 60.0, 150.0, 350.0, 10.0, 130.0, 230.0, 20.0, 10.0, 360.0, 80.0, 50.0, 120.0, 100.0, 70.0, 90.0, 0.0, 120.0, 350.0, 210.0, 10.0, 50.0, 170.0, 80.0, 360.0, 0.0, 40.0, 280.0, 40.0, 40.0, 240.0, 110.0, -10.0, 240.0, 70.0, 590.0, 320.0, 0.0, 10.0, 40.0, 0.0, 0.0, 40.0, 40.0, 10.0, 150.0, 90.0, 70.0, 10.0, 40.0, 310.0, 50.0, 40.0, 180.0, 20.0, 120.0, 10.0, 160.0, 10.0, 30.0, 50.0, 30.0, 290.0, 250.0, 20.0, 10.0, 170.0, 20.0, 10.0, 80.0, 130.0, 70.0, 50.0, 510.0, 300.0, 0.0, 0.0, 80.0, 80.0, 130.0, 290.0, 200.0, 180.0, 30.0, 210.0, 40.0, 110.0, 50.0, 110.0, 210.0, -10.0, 330.0, 80.0, 40.0, 360.0, 160.0, 30.0, 260.0, 20.0, 190.0, 300.0, 20.0, 80.0, 40.0, 40.0, 80.0, 30.0, 270.0, 30.0, 160.0, 275.0, 80.0, 90.0, 130.0, 40.0, -70.0, 170.0, 120.0, 60.0, 80.0, 150.0, 70.0, 40.0, 150.0, 310.0, 160.0, 70.0, 50.0, 10.0, 210.0, 140.0, 30.0, 30.0, 10.0, 680.0, 40.0, 140.0, 20.0, 0.0, 0.0, 60.0, 280.0, 300.0, 50.0, 30.0, 0.0, 0.0, 110.0, -20.0, -30.0, 110.0, 630.0, 200.0, 50.0, 290.0, 20.0, 150.0, 210.0, 40.0, 270.0, 10.0, 60.0, 100.0, -10.0, 610.0, 50.0, 90.0, 170.0, 110.0, 50.0, 20.0, 10.0, 40.0, -20.0, 160.0, 310.0, 50.0, 110.0, 160.0, 80.0, 165.0, 200.0, 70.0, 310.0, 130.0, 180.0, 10.0, 70.0, 410.0, 30.0, 40.0, 40.0, 10.0, 0.0, 20.0, -75.0, 80.0, 15.0, 60.0, 150.0, 60.0, 100.0, 310.0, 70.0, 100.0, 20.0, 0.0, 80.0, 130.0, 20.0, 20.0, 70.0, 100.0, 20.0, 70.0, 120.0, 60.0, 40.0, 30.0, 30.0, 270.0, 250.0, 0.0, 180.0, 40.0, 20.0, 70.0, 40.0, 310.0, 60.0, 20.0, 20.0, 30.0, 50.0, 670.0, 270.0, 30.0, 240.0, 110.0, 170.0, 40.0, 40.0, 80.0, 110.0, 40.0, 100.0, 90.0, 30.0, 120.0, 360.0, 0.0, 10.0, 90.0, 120.0, 60.0, 10.0, 110.0, 740.0, 190.0, 130.0, 90.0, 20.0, 10.0, 150.0, 0.0, 90.0, 150.0, 160.0, 10.0, 90.0, 30.0, 40.0, 150.0, -10.0, 160.0, 380.0, 510.0, 40.0, 80.0, 90.0, 60.0, 280.0, 180.0, 280.0, 0.0, 50.0, 15.0, 0.0, 40.0, 190.0, 0.0, 40.0, 70.0, 10.0, 40.0, 0.0, 40.0, -10.0, 280.0, -30.0, 20.0, 550.0, 40.0, 30.0, 40.0, 80.0, 90.0, 90.0, 390.0, 40.0, 110.0, 60.0, 500.0, 120.0, 0.0, 260.0, 100.0, 540.0, -30.0, 50.0, -50.0, -40.0, 340.0, 80.0, 280.0, 0.0, 50.0, -10.0, 40.0, 40.0, 140.0, 680.0, 50.0, -30.0, 60.0, 80.0, 0.0, 90.0, 60.0, -10.0, 110.0, 40.0, 240.0, 160.0, 310.0, 30.0, 40.0, 210.0, -25.0, 120.0, 180.0, 20.0, 20.0, 170.0, -75.0, 0.0, 10.0, 20.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 120.0, 150.0, 160.0, -10.0, 330.0, 190.0, 50.0, 40.0, 170.0, 20.0, 340.0, 460.0, 20.0, 30.0, 70.0, 95.0, 50.0, 360.0, 10.0, 90.0, 40.0, 30.0, 110.0, 60.0, 100.0, 60.0, 120.0, 60.0, 520.0, 80.0, 20.0, 40.0, 40.0, 30.0, 40.0, 490.0, 230.0, 60.0, 80.0, 40.0, 140.0, 30.0, 30.0, 10.0, 220.0, 230.0, 60.0, 30.0, 10.0, 0.0, 590.0, 0.0, 290.0, 40.0, 45.0, 60.0, 60.0, 160.0, -10.0, -30.0, 70.0, 100.0, 200.0, 110.0, 60.0, 180.0, 420.0, 150.0, 100.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 65.0, 90.0, 260.0, 30.0, 330.0, 70.0, 280.0, 130.0, 45.0, 260.0, 375.0, 150.0, 20.0, 50.0, 330.0, 100.0, 210.0, 30.0, 80.0, -20.0, 220.0, 60.0, 190.0, 60.0, 320.0, 250.0, 120.0, 50.0, 120.0, 130.0, 70.0, 40.0, 160.0, 170.0, 110.0, 170.0, 120.0, 60.0, 130.0, 60.0, -140.0, 140.0, 10.0, 70.0, -40.0, 110.0, 20.0, 0.0, 270.0, 100.0, 30.0, 190.0, 160.0, 200.0, 140.0, 160.0, 80.0, 220.0, 70.0, 10.0, 280.0, 80.0, 80.0, 25.0, 100.0, 70.0, 60.0, 120.0, 370.0, 140.0, 190.0, 30.0, 100.0, 90.0, 30.0, 0.0, 10.0, 30.0, 70.0, 30.0, 10.0, 0.0, 20.0, 610.0, 0.0, 10.0, 50.0, 160.0, 210.0, 160.0, 55.0, 10.0, -10.0, 90.0, 150.0, -20.0, 100.0, 40.0, 20.0, 160.0, 60.0, 100.0, 90.0, 40.0, 120.0, 70.0, 35.0, 210.0, 150.0, 40.0, 300.0, 50.0, 60.0, 25.0, 30.0, 100.0, 100.0, 330.0, 80.0, 90.0, 120.0, 90.0, 60.0, 40.0, 230.0, 140.0, 30.0, 10.0, 140.0, 40.0, 460.0, 130.0, 0.0, 50.0, 0.0, 150.0, 90.0, -85.0, 210.0, 90.0, -75.0, 130.0, 30.0, 730.0, 60.0, 250.0, 180.0, 140.0, 50.0, 20.0, 80.0, 90.0, 70.0, 460.0, 30.0, 140.0, 160.0, 0.0, 0.0, 40.0, 30.0, 40.0, 340.0, -50.0, 50.0, 30.0, 20.0, 80.0, 30.0, 190.0, 25.0, 320.0, 30.0, 30.0, 30.0, 70.0, 20.0, 510.0, 180.0, 45.0, 90.0, -90.0, 190.0, 140.0, 150.0, 150.0, 150.0, 10.0, 130.0, 20.0, 200.0, 20.0, 340.0, 80.0, 0.0, 20.0, 40.0, 160.0, 0.0, 110.0, 0.0, 25.0, 20.0, 170.0, 0.0, 220.0, 70.0, 50.0, -10.0, 120.0, 70.0, 20.0, 0.0, 10.0, 120.0, 160.0, 0.0, 60.0, 40.0, 70.0, -55.0, 90.0, 35.0, -40.0, 50.0, 510.0, 60.0, 150.0, 120.0, 160.0, 120.0, 110.0, 30.0, 160.0, 200.0, 360.0, 80.0, 80.0, 70.0, 60.0, 310.0, 70.0, 50.0, 280.0, 10.0, 10.0, 160.0, -20.0, 40.0, 0.0, 340.0, 70.0, 230.0, 150.0, 70.0, 270.0, 200.0, 110.0, 320.0, 70.0, 80.0, 40.0, 110.0, 300.0, 310.0, 80.0, 220.0, 240.0, 80.0, 100.0, 150.0, 30.0, 80.0, 260.0, 180.0, 130.0, 350.0, 40.0, 15.0, 80.0, 90.0, 50.0, 120.0, 80.0, 140.0, 120.0, 210.0, 70.0, 260.0, 70.0, 70.0, 60.0, 60.0, 170.0, 150.0, 0.0, 40.0, 20.0, 190.0, 0.0, 10.0, 90.0, 10.0, 220.0, 10.0, 40.0, 0.0, -10.0, 50.0, 10.0, 430.0, 0.0, 50.0, 20.0, 0.0, 90.0, 200.0, 20.0, 120.0, 170.0, 200.0, 80.0, 110.0, 170.0, 100.0, 40.0, 30.0, 20.0, 310.0, 120.0, 80.0, 70.0, 110.0, 10.0, 80.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 10.0, 60.0, 370.0, 140.0, 30.0, -60.0, 95.0, 80.0, 30.0, 30.0, 25.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6754099247985732, "mean_inference_ms": 1.500941470137521, "mean_action_processing_ms": 0.4257557421148789, "mean_env_wait_ms": 1.3490744002093789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014086484909057617, "StateBufferConnector_ms": 0.010191679000854492, "ViewRequirementAgentConnector_ms": 0.4204237461090088}, "num_episodes": 22, "episode_return_max": 1690.0, "episode_return_min": 180.0, "episode_return_mean": 1075.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.206196098040127, "num_env_steps_trained_throughput_per_sec": 19.206196098040127, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 4320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4320000, "timers": {"training_iteration_time_ms": 210310.954, "restore_workers_time_ms": 0.015, "training_step_time_ms": 210310.908, "sample_time_ms": 2917.83, "learn_time_ms": 207370.305, "learn_throughput": 19.289, "synch_weights_time_ms": 12.569}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "done": false, "training_iteration": 108, "trial_id": "aa996_00000", "date": "2024-05-24_05-01-14", "timestamp": 1716541274, "time_this_iter_s": 208.28220105171204, "time_total_s": 22540.891023874283, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332db7ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22540.891023874283, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 18.914625850340133, "ram_util_percent": 79.42278911564627}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3999591213191787, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008332375068385134, "vf_loss": 7.768726443177976, "vf_explained_var": -0.0004535820791388726, "kl": Infinity, "entropy": 0.3122356967899365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1018815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "env_runners": {"episode_reward_max": 1860.0, "episode_reward_min": 160.0, "episode_reward_mean": 1080.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 108.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1290.0, 630.0, 1270.0, 1130.0, 1350.0, 1640.0, 610.0, 930.0, 860.0, 1340.0, 1240.0, 1440.0, 1060.0, 1035.0, 1310.0, 1270.0, 880.0, 1360.0, 1490.0, 940.0, 1455.0, 555.0, 965.0, 630.0, 920.0, 1540.0, 960.0, 890.0, 1530.0, 1160.0, 1570.0, 405.0, 1040.0, 1660.0, 1270.0, 1100.0, 1030.0, 660.0, 180.0, 1220.0, 1525.0, 1180.0, 1070.0, 760.0, 1205.0, 1440.0, 595.0, 1690.0, 1250.0, 1320.0, 830.0, 910.0, 1320.0, 1205.0, 290.0, 1255.0, 790.0, 1075.0, 1025.0, 1220.0, 590.0, 1670.0, 1240.0, 725.0, 1075.0, 1310.0, 455.0, 710.0, 530.0, 1270.0, 1440.0, 1120.0, 1420.0, 1590.0, 1315.0, 1140.0, 680.0, 800.0, 1010.0, 1050.0, 280.0, 830.0, 1140.0, 1080.0, 1435.0, 1030.0, 1470.0, 1430.0, 1090.0, 200.0, 1060.0, 1105.0, 160.0, 940.0, 1320.0, 1300.0, 920.0, 1240.0, 1860.0, 1240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 140.0, 40.0, 280.0, 70.0, 100.0, 200.0, -40.0, 480.0, -30.0, 0.0, 60.0, 20.0, 100.0, 210.0, 30.0, 10.0, 30.0, 0.0, 170.0, 70.0, 30.0, 190.0, 190.0, 90.0, 60.0, 150.0, 350.0, 10.0, 130.0, 230.0, 20.0, 10.0, 360.0, 80.0, 50.0, 120.0, 100.0, 70.0, 90.0, 0.0, 120.0, 350.0, 210.0, 10.0, 50.0, 170.0, 80.0, 360.0, 0.0, 40.0, 280.0, 40.0, 40.0, 240.0, 110.0, -10.0, 240.0, 70.0, 590.0, 320.0, 0.0, 10.0, 40.0, 0.0, 0.0, 40.0, 40.0, 10.0, 150.0, 90.0, 70.0, 10.0, 40.0, 310.0, 50.0, 40.0, 180.0, 20.0, 120.0, 10.0, 160.0, 10.0, 30.0, 50.0, 30.0, 290.0, 250.0, 20.0, 10.0, 170.0, 20.0, 10.0, 80.0, 130.0, 70.0, 50.0, 510.0, 300.0, 0.0, 0.0, 80.0, 80.0, 130.0, 290.0, 200.0, 180.0, 30.0, 210.0, 40.0, 110.0, 50.0, 110.0, 210.0, -10.0, 330.0, 80.0, 40.0, 360.0, 160.0, 30.0, 260.0, 20.0, 190.0, 300.0, 20.0, 80.0, 40.0, 40.0, 80.0, 30.0, 270.0, 30.0, 160.0, 275.0, 80.0, 90.0, 130.0, 40.0, -70.0, 170.0, 120.0, 60.0, 80.0, 150.0, 70.0, 40.0, 150.0, 310.0, 160.0, 70.0, 50.0, 10.0, 210.0, 140.0, 30.0, 30.0, 10.0, 680.0, 40.0, 140.0, 20.0, 0.0, 0.0, 60.0, 280.0, 300.0, 50.0, 30.0, 0.0, 0.0, 110.0, -20.0, -30.0, 110.0, 630.0, 200.0, 50.0, 290.0, 20.0, 150.0, 210.0, 40.0, 270.0, 10.0, 60.0, 100.0, -10.0, 610.0, 50.0, 90.0, 170.0, 110.0, 50.0, 20.0, 10.0, 40.0, -20.0, 160.0, 310.0, 50.0, 110.0, 160.0, 80.0, 165.0, 200.0, 70.0, 310.0, 130.0, 180.0, 10.0, 70.0, 410.0, 30.0, 40.0, 40.0, 10.0, 0.0, 20.0, -75.0, 80.0, 15.0, 60.0, 150.0, 60.0, 100.0, 310.0, 70.0, 100.0, 20.0, 0.0, 80.0, 130.0, 20.0, 20.0, 70.0, 100.0, 20.0, 70.0, 120.0, 60.0, 40.0, 30.0, 30.0, 270.0, 250.0, 0.0, 180.0, 40.0, 20.0, 70.0, 40.0, 310.0, 60.0, 20.0, 20.0, 30.0, 50.0, 670.0, 270.0, 30.0, 240.0, 110.0, 170.0, 40.0, 40.0, 80.0, 110.0, 40.0, 100.0, 90.0, 30.0, 120.0, 360.0, 0.0, 10.0, 90.0, 120.0, 60.0, 10.0, 110.0, 740.0, 190.0, 130.0, 90.0, 20.0, 10.0, 150.0, 0.0, 90.0, 150.0, 160.0, 10.0, 90.0, 30.0, 40.0, 150.0, -10.0, 160.0, 380.0, 510.0, 40.0, 80.0, 90.0, 60.0, 280.0, 180.0, 280.0, 0.0, 50.0, 15.0, 0.0, 40.0, 190.0, 0.0, 40.0, 70.0, 10.0, 40.0, 0.0, 40.0, -10.0, 280.0, -30.0, 20.0, 550.0, 40.0, 30.0, 40.0, 80.0, 90.0, 90.0, 390.0, 40.0, 110.0, 60.0, 500.0, 120.0, 0.0, 260.0, 100.0, 540.0, -30.0, 50.0, -50.0, -40.0, 340.0, 80.0, 280.0, 0.0, 50.0, -10.0, 40.0, 40.0, 140.0, 680.0, 50.0, -30.0, 60.0, 80.0, 0.0, 90.0, 60.0, -10.0, 110.0, 40.0, 240.0, 160.0, 310.0, 30.0, 40.0, 210.0, -25.0, 120.0, 180.0, 20.0, 20.0, 170.0, -75.0, 0.0, 10.0, 20.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 120.0, 150.0, 160.0, -10.0, 330.0, 190.0, 50.0, 40.0, 170.0, 20.0, 340.0, 460.0, 20.0, 30.0, 70.0, 95.0, 50.0, 360.0, 10.0, 90.0, 40.0, 30.0, 110.0, 60.0, 100.0, 60.0, 120.0, 60.0, 520.0, 80.0, 20.0, 40.0, 40.0, 30.0, 40.0, 490.0, 230.0, 60.0, 80.0, 40.0, 140.0, 30.0, 30.0, 10.0, 220.0, 230.0, 60.0, 30.0, 10.0, 0.0, 590.0, 0.0, 290.0, 40.0, 45.0, 60.0, 60.0, 160.0, -10.0, -30.0, 70.0, 100.0, 200.0, 110.0, 60.0, 180.0, 420.0, 150.0, 100.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 65.0, 90.0, 260.0, 30.0, 330.0, 70.0, 280.0, 130.0, 45.0, 260.0, 375.0, 150.0, 20.0, 50.0, 330.0, 100.0, 210.0, 30.0, 80.0, -20.0, 220.0, 60.0, 190.0, 60.0, 320.0, 250.0, 120.0, 50.0, 120.0, 130.0, 70.0, 40.0, 160.0, 170.0, 110.0, 170.0, 120.0, 60.0, 130.0, 60.0, -140.0, 140.0, 10.0, 70.0, -40.0, 110.0, 20.0, 0.0, 270.0, 100.0, 30.0, 190.0, 160.0, 200.0, 140.0, 160.0, 80.0, 220.0, 70.0, 10.0, 280.0, 80.0, 80.0, 25.0, 100.0, 70.0, 60.0, 120.0, 370.0, 140.0, 190.0, 30.0, 100.0, 90.0, 30.0, 0.0, 10.0, 30.0, 70.0, 30.0, 10.0, 0.0, 20.0, 610.0, 0.0, 10.0, 50.0, 160.0, 210.0, 160.0, 55.0, 10.0, -10.0, 90.0, 150.0, -20.0, 100.0, 40.0, 20.0, 160.0, 60.0, 100.0, 90.0, 40.0, 120.0, 70.0, 35.0, 210.0, 150.0, 40.0, 300.0, 50.0, 60.0, 25.0, 30.0, 100.0, 100.0, 330.0, 80.0, 90.0, 120.0, 90.0, 60.0, 40.0, 230.0, 140.0, 30.0, 10.0, 140.0, 40.0, 460.0, 130.0, 0.0, 50.0, 0.0, 150.0, 90.0, -85.0, 210.0, 90.0, -75.0, 130.0, 30.0, 730.0, 60.0, 250.0, 180.0, 140.0, 50.0, 20.0, 80.0, 90.0, 70.0, 460.0, 30.0, 140.0, 160.0, 0.0, 0.0, 40.0, 30.0, 40.0, 340.0, -50.0, 50.0, 30.0, 20.0, 80.0, 30.0, 190.0, 25.0, 320.0, 30.0, 30.0, 30.0, 70.0, 20.0, 510.0, 180.0, 45.0, 90.0, -90.0, 190.0, 140.0, 150.0, 150.0, 150.0, 10.0, 130.0, 20.0, 200.0, 20.0, 340.0, 80.0, 0.0, 20.0, 40.0, 160.0, 0.0, 110.0, 0.0, 25.0, 20.0, 170.0, 0.0, 220.0, 70.0, 50.0, -10.0, 120.0, 70.0, 20.0, 0.0, 10.0, 120.0, 160.0, 0.0, 60.0, 40.0, 70.0, -55.0, 90.0, 35.0, -40.0, 50.0, 510.0, 60.0, 150.0, 120.0, 160.0, 120.0, 110.0, 30.0, 160.0, 200.0, 360.0, 80.0, 80.0, 70.0, 60.0, 310.0, 70.0, 50.0, 280.0, 10.0, 10.0, 160.0, -20.0, 40.0, 0.0, 340.0, 70.0, 230.0, 150.0, 70.0, 270.0, 200.0, 110.0, 320.0, 70.0, 80.0, 40.0, 110.0, 300.0, 310.0, 80.0, 220.0, 240.0, 80.0, 100.0, 150.0, 30.0, 80.0, 260.0, 180.0, 130.0, 350.0, 40.0, 15.0, 80.0, 90.0, 50.0, 120.0, 80.0, 140.0, 120.0, 210.0, 70.0, 260.0, 70.0, 70.0, 60.0, 60.0, 170.0, 150.0, 0.0, 40.0, 20.0, 190.0, 0.0, 10.0, 90.0, 10.0, 220.0, 10.0, 40.0, 0.0, -10.0, 50.0, 10.0, 430.0, 0.0, 50.0, 20.0, 0.0, 90.0, 200.0, 20.0, 120.0, 170.0, 200.0, 80.0, 110.0, 170.0, 100.0, 40.0, 30.0, 20.0, 310.0, 120.0, 80.0, 70.0, 110.0, 10.0, 80.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 10.0, 60.0, 370.0, 140.0, 30.0, -60.0, 95.0, 80.0, 30.0, 30.0, 25.0, 90.0, 340.0, 10.0, 90.0, 40.0, 50.0, 40.0, 90.0, 320.0, 70.0, 90.0, 20.0, 110.0, -20.0, -90.0, 290.0, 70.0, 90.0, -20.0, -70.0, 700.0, 280.0, 520.0, 30.0, 470.0, 100.0, 30.0, 30.0, 190.0, 95.0, -310.0, 20.0, 20.0, 0.0, 150.0, 50.0, 220.0, 40.0, 40.0, 510.0, -20.0, 40.0, 320.0, 210.0, 70.0, 60.0, 30.0, 40.0, 470.0, 140.0, 90.0, 170.0, 70.0, 40.0, 230.0, 90.0, 470.0, 110.0, 150.0, 10.0, 90.0, -10.0, 160.0, 120.0, 120.0, -30.0, 40.0, 60.0, 550.0, -220.0, 300.0, 420.0, 70.0, 50.0, 180.0, 60.0, 0.0, 70.0, -490.0, 320.0, -480.0, 110.0, 180.0, 180.0, 30.0, 350.0, 30.0, 200.0, 20.0, -20.0, -20.0, 70.0, 170.0, 120.0, 180.0, -35.0, 320.0, 0.0, -10.0, 240.0, 50.0, 10.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 0.0, 260.0, 20.0, 40.0, 180.0, 110.0, 30.0, 30.0, 290.0, 180.0, -200.0, 30.0, 40.0, 70.0, 120.0, 80.0, 470.0, 210.0, 110.0, 170.0, 20.0, 50.0, 60.0, 160.0, 120.0, 150.0, 310.0, 370.0, 60.0, 10.0, 10.0, 290.0, 20.0, 0.0, 10.0, 80.0, 30.0, 350.0, 90.0, 20.0, 30.0, 20.0, 30.0, 360.0, 0.0, 90.0, 110.0, 100.0, 130.0, 200.0, 200.0, -20.0, 350.0, 30.0, 40.0, -20.0, 70.0, 880.0, 50.0, 160.0, 320.0, 40.0, 180.0, 170.0, 0.0, 100.0, 50.0, -10.0, 120.0, 310.0, 280.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.675683156188111, "mean_inference_ms": 1.5019711576254564, "mean_action_processing_ms": 0.42577985370269206, "mean_env_wait_ms": 1.3495293778935127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014182329177856445, "StateBufferConnector_ms": 0.011475086212158203, "ViewRequirementAgentConnector_ms": 0.4257926940917969}, "num_episodes": 18, "episode_return_max": 1860.0, "episode_return_min": 160.0, "episode_return_mean": 1080.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.136949233241694, "num_env_steps_trained_throughput_per_sec": 19.136949233241694, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 4360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4360000, "timers": {"training_iteration_time_ms": 210238.253, "restore_workers_time_ms": 0.014, "training_step_time_ms": 210238.208, "sample_time_ms": 2920.487, "learn_time_ms": 207294.896, "learn_throughput": 19.296, "synch_weights_time_ms": 12.653}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "done": false, "training_iteration": 109, "trial_id": "aa996_00000", "date": "2024-05-24_05-04-43", "timestamp": 1716541483, "time_this_iter_s": 209.02986073493958, "time_total_s": 22749.920884609222, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d6dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22749.920884609222, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 19.382432432432434, "ram_util_percent": 79.24324324324324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4233631711544446, "cur_kl_coeff": 0.28476562499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0089161746481858, "vf_loss": 7.430689381943724, "vf_explained_var": -0.00018893781180579823, "kl": Infinity, "entropy": 0.32498651148634344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1028205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "env_runners": {"episode_reward_max": 1860.0, "episode_reward_min": 160.0, "episode_reward_mean": 1075.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 107.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1490.0, 940.0, 1455.0, 555.0, 965.0, 630.0, 920.0, 1540.0, 960.0, 890.0, 1530.0, 1160.0, 1570.0, 405.0, 1040.0, 1660.0, 1270.0, 1100.0, 1030.0, 660.0, 180.0, 1220.0, 1525.0, 1180.0, 1070.0, 760.0, 1205.0, 1440.0, 595.0, 1690.0, 1250.0, 1320.0, 830.0, 910.0, 1320.0, 1205.0, 290.0, 1255.0, 790.0, 1075.0, 1025.0, 1220.0, 590.0, 1670.0, 1240.0, 725.0, 1075.0, 1310.0, 455.0, 710.0, 530.0, 1270.0, 1440.0, 1120.0, 1420.0, 1590.0, 1315.0, 1140.0, 680.0, 800.0, 1010.0, 1050.0, 280.0, 830.0, 1140.0, 1080.0, 1435.0, 1030.0, 1470.0, 1430.0, 1090.0, 200.0, 1060.0, 1105.0, 160.0, 940.0, 1320.0, 1300.0, 920.0, 1240.0, 1860.0, 1240.0, 1810.0, 1260.0, 635.0, 1035.0, 1720.0, 1000.0, 980.0, 1140.0, 1510.0, 1170.0, 910.0, 1200.0, 1520.0, 710.0, 910.0, 850.0, 1220.0, 615.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 210.0, 40.0, 270.0, 10.0, 60.0, 100.0, -10.0, 610.0, 50.0, 90.0, 170.0, 110.0, 50.0, 20.0, 10.0, 40.0, -20.0, 160.0, 310.0, 50.0, 110.0, 160.0, 80.0, 165.0, 200.0, 70.0, 310.0, 130.0, 180.0, 10.0, 70.0, 410.0, 30.0, 40.0, 40.0, 10.0, 0.0, 20.0, -75.0, 80.0, 15.0, 60.0, 150.0, 60.0, 100.0, 310.0, 70.0, 100.0, 20.0, 0.0, 80.0, 130.0, 20.0, 20.0, 70.0, 100.0, 20.0, 70.0, 120.0, 60.0, 40.0, 30.0, 30.0, 270.0, 250.0, 0.0, 180.0, 40.0, 20.0, 70.0, 40.0, 310.0, 60.0, 20.0, 20.0, 30.0, 50.0, 670.0, 270.0, 30.0, 240.0, 110.0, 170.0, 40.0, 40.0, 80.0, 110.0, 40.0, 100.0, 90.0, 30.0, 120.0, 360.0, 0.0, 10.0, 90.0, 120.0, 60.0, 10.0, 110.0, 740.0, 190.0, 130.0, 90.0, 20.0, 10.0, 150.0, 0.0, 90.0, 150.0, 160.0, 10.0, 90.0, 30.0, 40.0, 150.0, -10.0, 160.0, 380.0, 510.0, 40.0, 80.0, 90.0, 60.0, 280.0, 180.0, 280.0, 0.0, 50.0, 15.0, 0.0, 40.0, 190.0, 0.0, 40.0, 70.0, 10.0, 40.0, 0.0, 40.0, -10.0, 280.0, -30.0, 20.0, 550.0, 40.0, 30.0, 40.0, 80.0, 90.0, 90.0, 390.0, 40.0, 110.0, 60.0, 500.0, 120.0, 0.0, 260.0, 100.0, 540.0, -30.0, 50.0, -50.0, -40.0, 340.0, 80.0, 280.0, 0.0, 50.0, -10.0, 40.0, 40.0, 140.0, 680.0, 50.0, -30.0, 60.0, 80.0, 0.0, 90.0, 60.0, -10.0, 110.0, 40.0, 240.0, 160.0, 310.0, 30.0, 40.0, 210.0, -25.0, 120.0, 180.0, 20.0, 20.0, 170.0, -75.0, 0.0, 10.0, 20.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 120.0, 150.0, 160.0, -10.0, 330.0, 190.0, 50.0, 40.0, 170.0, 20.0, 340.0, 460.0, 20.0, 30.0, 70.0, 95.0, 50.0, 360.0, 10.0, 90.0, 40.0, 30.0, 110.0, 60.0, 100.0, 60.0, 120.0, 60.0, 520.0, 80.0, 20.0, 40.0, 40.0, 30.0, 40.0, 490.0, 230.0, 60.0, 80.0, 40.0, 140.0, 30.0, 30.0, 10.0, 220.0, 230.0, 60.0, 30.0, 10.0, 0.0, 590.0, 0.0, 290.0, 40.0, 45.0, 60.0, 60.0, 160.0, -10.0, -30.0, 70.0, 100.0, 200.0, 110.0, 60.0, 180.0, 420.0, 150.0, 100.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 65.0, 90.0, 260.0, 30.0, 330.0, 70.0, 280.0, 130.0, 45.0, 260.0, 375.0, 150.0, 20.0, 50.0, 330.0, 100.0, 210.0, 30.0, 80.0, -20.0, 220.0, 60.0, 190.0, 60.0, 320.0, 250.0, 120.0, 50.0, 120.0, 130.0, 70.0, 40.0, 160.0, 170.0, 110.0, 170.0, 120.0, 60.0, 130.0, 60.0, -140.0, 140.0, 10.0, 70.0, -40.0, 110.0, 20.0, 0.0, 270.0, 100.0, 30.0, 190.0, 160.0, 200.0, 140.0, 160.0, 80.0, 220.0, 70.0, 10.0, 280.0, 80.0, 80.0, 25.0, 100.0, 70.0, 60.0, 120.0, 370.0, 140.0, 190.0, 30.0, 100.0, 90.0, 30.0, 0.0, 10.0, 30.0, 70.0, 30.0, 10.0, 0.0, 20.0, 610.0, 0.0, 10.0, 50.0, 160.0, 210.0, 160.0, 55.0, 10.0, -10.0, 90.0, 150.0, -20.0, 100.0, 40.0, 20.0, 160.0, 60.0, 100.0, 90.0, 40.0, 120.0, 70.0, 35.0, 210.0, 150.0, 40.0, 300.0, 50.0, 60.0, 25.0, 30.0, 100.0, 100.0, 330.0, 80.0, 90.0, 120.0, 90.0, 60.0, 40.0, 230.0, 140.0, 30.0, 10.0, 140.0, 40.0, 460.0, 130.0, 0.0, 50.0, 0.0, 150.0, 90.0, -85.0, 210.0, 90.0, -75.0, 130.0, 30.0, 730.0, 60.0, 250.0, 180.0, 140.0, 50.0, 20.0, 80.0, 90.0, 70.0, 460.0, 30.0, 140.0, 160.0, 0.0, 0.0, 40.0, 30.0, 40.0, 340.0, -50.0, 50.0, 30.0, 20.0, 80.0, 30.0, 190.0, 25.0, 320.0, 30.0, 30.0, 30.0, 70.0, 20.0, 510.0, 180.0, 45.0, 90.0, -90.0, 190.0, 140.0, 150.0, 150.0, 150.0, 10.0, 130.0, 20.0, 200.0, 20.0, 340.0, 80.0, 0.0, 20.0, 40.0, 160.0, 0.0, 110.0, 0.0, 25.0, 20.0, 170.0, 0.0, 220.0, 70.0, 50.0, -10.0, 120.0, 70.0, 20.0, 0.0, 10.0, 120.0, 160.0, 0.0, 60.0, 40.0, 70.0, -55.0, 90.0, 35.0, -40.0, 50.0, 510.0, 60.0, 150.0, 120.0, 160.0, 120.0, 110.0, 30.0, 160.0, 200.0, 360.0, 80.0, 80.0, 70.0, 60.0, 310.0, 70.0, 50.0, 280.0, 10.0, 10.0, 160.0, -20.0, 40.0, 0.0, 340.0, 70.0, 230.0, 150.0, 70.0, 270.0, 200.0, 110.0, 320.0, 70.0, 80.0, 40.0, 110.0, 300.0, 310.0, 80.0, 220.0, 240.0, 80.0, 100.0, 150.0, 30.0, 80.0, 260.0, 180.0, 130.0, 350.0, 40.0, 15.0, 80.0, 90.0, 50.0, 120.0, 80.0, 140.0, 120.0, 210.0, 70.0, 260.0, 70.0, 70.0, 60.0, 60.0, 170.0, 150.0, 0.0, 40.0, 20.0, 190.0, 0.0, 10.0, 90.0, 10.0, 220.0, 10.0, 40.0, 0.0, -10.0, 50.0, 10.0, 430.0, 0.0, 50.0, 20.0, 0.0, 90.0, 200.0, 20.0, 120.0, 170.0, 200.0, 80.0, 110.0, 170.0, 100.0, 40.0, 30.0, 20.0, 310.0, 120.0, 80.0, 70.0, 110.0, 10.0, 80.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 10.0, 60.0, 370.0, 140.0, 30.0, -60.0, 95.0, 80.0, 30.0, 30.0, 25.0, 90.0, 340.0, 10.0, 90.0, 40.0, 50.0, 40.0, 90.0, 320.0, 70.0, 90.0, 20.0, 110.0, -20.0, -90.0, 290.0, 70.0, 90.0, -20.0, -70.0, 700.0, 280.0, 520.0, 30.0, 470.0, 100.0, 30.0, 30.0, 190.0, 95.0, -310.0, 20.0, 20.0, 0.0, 150.0, 50.0, 220.0, 40.0, 40.0, 510.0, -20.0, 40.0, 320.0, 210.0, 70.0, 60.0, 30.0, 40.0, 470.0, 140.0, 90.0, 170.0, 70.0, 40.0, 230.0, 90.0, 470.0, 110.0, 150.0, 10.0, 90.0, -10.0, 160.0, 120.0, 120.0, -30.0, 40.0, 60.0, 550.0, -220.0, 300.0, 420.0, 70.0, 50.0, 180.0, 60.0, 0.0, 70.0, -490.0, 320.0, -480.0, 110.0, 180.0, 180.0, 30.0, 350.0, 30.0, 200.0, 20.0, -20.0, -20.0, 70.0, 170.0, 120.0, 180.0, -35.0, 320.0, 0.0, -10.0, 240.0, 50.0, 10.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 0.0, 260.0, 20.0, 40.0, 180.0, 110.0, 30.0, 30.0, 290.0, 180.0, -200.0, 30.0, 40.0, 70.0, 120.0, 80.0, 470.0, 210.0, 110.0, 170.0, 20.0, 50.0, 60.0, 160.0, 120.0, 150.0, 310.0, 370.0, 60.0, 10.0, 10.0, 290.0, 20.0, 0.0, 10.0, 80.0, 30.0, 350.0, 90.0, 20.0, 30.0, 20.0, 30.0, 360.0, 0.0, 90.0, 110.0, 100.0, 130.0, 200.0, 200.0, -20.0, 350.0, 30.0, 40.0, -20.0, 70.0, 880.0, 50.0, 160.0, 320.0, 40.0, 180.0, 170.0, 0.0, 100.0, 50.0, -10.0, 120.0, 310.0, 280.0, 30.0, 460.0, 880.0, 0.0, 70.0, 10.0, 80.0, 0.0, 0.0, 280.0, -30.0, 120.0, 250.0, 60.0, 160.0, 480.0, -10.0, 190.0, 30.0, 10.0, 260.0, 10.0, -155.0, 70.0, 50.0, -120.0, 120.0, 190.0, 60.0, 150.0, 190.0, 260.0, 100.0, 20.0, 110.0, 85.0, 80.0, 110.0, 10.0, 70.0, 330.0, 220.0, 140.0, 100.0, 240.0, -100.0, 20.0, 430.0, 200.0, 140.0, 170.0, -30.0, 80.0, 150.0, 120.0, 10.0, 70.0, 260.0, 60.0, 110.0, 120.0, -40.0, 100.0, 30.0, 50.0, 10.0, 110.0, 380.0, 50.0, 170.0, 90.0, -40.0, 90.0, 380.0, 70.0, 120.0, 60.0, 60.0, 160.0, 150.0, 130.0, 60.0, 300.0, 60.0, 220.0, 60.0, 300.0, 250.0, 90.0, 40.0, 370.0, 40.0, 70.0, 80.0, 10.0, 10.0, 300.0, 170.0, 110.0, 10.0, 110.0, 30.0, 150.0, 50.0, 40.0, 270.0, 30.0, 150.0, 20.0, 60.0, 270.0, 150.0, 30.0, 270.0, 280.0, 120.0, 20.0, 110.0, 10.0, -60.0, 120.0, 420.0, 150.0, 140.0, 0.0, 80.0, 220.0, 30.0, 220.0, 140.0, 190.0, 40.0, 30.0, 0.0, 40.0, 60.0, 130.0, 0.0, 30.0, 190.0, 100.0, 10.0, 90.0, 40.0, 420.0, 30.0, 20.0, 30.0, 0.0, 170.0, 230.0, 20.0, 120.0, 180.0, 150.0, -60.0, 80.0, 70.0, 50.0, 10.0, 30.0, 100.0, -20.0, 50.0, 80.0, 20.0, 80.0, 40.0, 220.0, 620.0, 20.0, 0.0, 50.0, 150.0, 40.0, 70.0, 50.0, 220.0, 20.0, -5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.675624625281977, "mean_inference_ms": 1.5026684429753328, "mean_action_processing_ms": 0.42576170017108994, "mean_env_wait_ms": 1.3497815631440806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014492273330688477, "StateBufferConnector_ms": 0.011589765548706055, "ViewRequirementAgentConnector_ms": 0.42192673683166504}, "num_episodes": 18, "episode_return_max": 1860.0, "episode_return_min": 160.0, "episode_return_mean": 1075.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.863235599783394, "num_env_steps_trained_throughput_per_sec": 18.863235599783394, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 4400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4400000, "timers": {"training_iteration_time_ms": 210380.497, "restore_workers_time_ms": 0.014, "training_step_time_ms": 210380.452, "sample_time_ms": 2926.661, "learn_time_ms": 207430.207, "learn_throughput": 19.284, "synch_weights_time_ms": 12.779}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "done": false, "training_iteration": 110, "trial_id": "aa996_00000", "date": "2024-05-24_05-08-16", "timestamp": 1716541696, "time_this_iter_s": 212.06869292259216, "time_total_s": 22961.989577531815, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160075dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22961.989577531815, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 21.296, "ram_util_percent": 79.58900000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1125918604377993, "cur_kl_coeff": 0.4271484374999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.656750502753943, "policy_loss": -0.007954675623159201, "vf_loss": 7.662886169949533, "vf_explained_var": 0.0020086050668336585, "kl": 0.004258463954547023, "entropy": 0.2921705229547077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1037595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "env_runners": {"episode_reward_max": 2185.0, "episode_reward_min": -190.0, "episode_reward_mean": 1101.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 110.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1180.0, 1070.0, 760.0, 1205.0, 1440.0, 595.0, 1690.0, 1250.0, 1320.0, 830.0, 910.0, 1320.0, 1205.0, 290.0, 1255.0, 790.0, 1075.0, 1025.0, 1220.0, 590.0, 1670.0, 1240.0, 725.0, 1075.0, 1310.0, 455.0, 710.0, 530.0, 1270.0, 1440.0, 1120.0, 1420.0, 1590.0, 1315.0, 1140.0, 680.0, 800.0, 1010.0, 1050.0, 280.0, 830.0, 1140.0, 1080.0, 1435.0, 1030.0, 1470.0, 1430.0, 1090.0, 200.0, 1060.0, 1105.0, 160.0, 940.0, 1320.0, 1300.0, 920.0, 1240.0, 1860.0, 1240.0, 1810.0, 1260.0, 635.0, 1035.0, 1720.0, 1000.0, 980.0, 1140.0, 1510.0, 1170.0, 910.0, 1200.0, 1520.0, 710.0, 910.0, 850.0, 1220.0, 615.0, 720.0, 1060.0, 1690.0, 1850.0, 2185.0, 1230.0, 725.0, 1420.0, 1085.0, 1140.0, 1390.0, 1380.0, 1205.0, 1500.0, 1095.0, 1680.0, 830.0, 1290.0, 1185.0, 915.0, -190.0, 1030.0, 880.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 30.0, 110.0, 60.0, 100.0, 60.0, 120.0, 60.0, 520.0, 80.0, 20.0, 40.0, 40.0, 30.0, 40.0, 490.0, 230.0, 60.0, 80.0, 40.0, 140.0, 30.0, 30.0, 10.0, 220.0, 230.0, 60.0, 30.0, 10.0, 0.0, 590.0, 0.0, 290.0, 40.0, 45.0, 60.0, 60.0, 160.0, -10.0, -30.0, 70.0, 100.0, 200.0, 110.0, 60.0, 180.0, 420.0, 150.0, 100.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 65.0, 90.0, 260.0, 30.0, 330.0, 70.0, 280.0, 130.0, 45.0, 260.0, 375.0, 150.0, 20.0, 50.0, 330.0, 100.0, 210.0, 30.0, 80.0, -20.0, 220.0, 60.0, 190.0, 60.0, 320.0, 250.0, 120.0, 50.0, 120.0, 130.0, 70.0, 40.0, 160.0, 170.0, 110.0, 170.0, 120.0, 60.0, 130.0, 60.0, -140.0, 140.0, 10.0, 70.0, -40.0, 110.0, 20.0, 0.0, 270.0, 100.0, 30.0, 190.0, 160.0, 200.0, 140.0, 160.0, 80.0, 220.0, 70.0, 10.0, 280.0, 80.0, 80.0, 25.0, 100.0, 70.0, 60.0, 120.0, 370.0, 140.0, 190.0, 30.0, 100.0, 90.0, 30.0, 0.0, 10.0, 30.0, 70.0, 30.0, 10.0, 0.0, 20.0, 610.0, 0.0, 10.0, 50.0, 160.0, 210.0, 160.0, 55.0, 10.0, -10.0, 90.0, 150.0, -20.0, 100.0, 40.0, 20.0, 160.0, 60.0, 100.0, 90.0, 40.0, 120.0, 70.0, 35.0, 210.0, 150.0, 40.0, 300.0, 50.0, 60.0, 25.0, 30.0, 100.0, 100.0, 330.0, 80.0, 90.0, 120.0, 90.0, 60.0, 40.0, 230.0, 140.0, 30.0, 10.0, 140.0, 40.0, 460.0, 130.0, 0.0, 50.0, 0.0, 150.0, 90.0, -85.0, 210.0, 90.0, -75.0, 130.0, 30.0, 730.0, 60.0, 250.0, 180.0, 140.0, 50.0, 20.0, 80.0, 90.0, 70.0, 460.0, 30.0, 140.0, 160.0, 0.0, 0.0, 40.0, 30.0, 40.0, 340.0, -50.0, 50.0, 30.0, 20.0, 80.0, 30.0, 190.0, 25.0, 320.0, 30.0, 30.0, 30.0, 70.0, 20.0, 510.0, 180.0, 45.0, 90.0, -90.0, 190.0, 140.0, 150.0, 150.0, 150.0, 10.0, 130.0, 20.0, 200.0, 20.0, 340.0, 80.0, 0.0, 20.0, 40.0, 160.0, 0.0, 110.0, 0.0, 25.0, 20.0, 170.0, 0.0, 220.0, 70.0, 50.0, -10.0, 120.0, 70.0, 20.0, 0.0, 10.0, 120.0, 160.0, 0.0, 60.0, 40.0, 70.0, -55.0, 90.0, 35.0, -40.0, 50.0, 510.0, 60.0, 150.0, 120.0, 160.0, 120.0, 110.0, 30.0, 160.0, 200.0, 360.0, 80.0, 80.0, 70.0, 60.0, 310.0, 70.0, 50.0, 280.0, 10.0, 10.0, 160.0, -20.0, 40.0, 0.0, 340.0, 70.0, 230.0, 150.0, 70.0, 270.0, 200.0, 110.0, 320.0, 70.0, 80.0, 40.0, 110.0, 300.0, 310.0, 80.0, 220.0, 240.0, 80.0, 100.0, 150.0, 30.0, 80.0, 260.0, 180.0, 130.0, 350.0, 40.0, 15.0, 80.0, 90.0, 50.0, 120.0, 80.0, 140.0, 120.0, 210.0, 70.0, 260.0, 70.0, 70.0, 60.0, 60.0, 170.0, 150.0, 0.0, 40.0, 20.0, 190.0, 0.0, 10.0, 90.0, 10.0, 220.0, 10.0, 40.0, 0.0, -10.0, 50.0, 10.0, 430.0, 0.0, 50.0, 20.0, 0.0, 90.0, 200.0, 20.0, 120.0, 170.0, 200.0, 80.0, 110.0, 170.0, 100.0, 40.0, 30.0, 20.0, 310.0, 120.0, 80.0, 70.0, 110.0, 10.0, 80.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 10.0, 60.0, 370.0, 140.0, 30.0, -60.0, 95.0, 80.0, 30.0, 30.0, 25.0, 90.0, 340.0, 10.0, 90.0, 40.0, 50.0, 40.0, 90.0, 320.0, 70.0, 90.0, 20.0, 110.0, -20.0, -90.0, 290.0, 70.0, 90.0, -20.0, -70.0, 700.0, 280.0, 520.0, 30.0, 470.0, 100.0, 30.0, 30.0, 190.0, 95.0, -310.0, 20.0, 20.0, 0.0, 150.0, 50.0, 220.0, 40.0, 40.0, 510.0, -20.0, 40.0, 320.0, 210.0, 70.0, 60.0, 30.0, 40.0, 470.0, 140.0, 90.0, 170.0, 70.0, 40.0, 230.0, 90.0, 470.0, 110.0, 150.0, 10.0, 90.0, -10.0, 160.0, 120.0, 120.0, -30.0, 40.0, 60.0, 550.0, -220.0, 300.0, 420.0, 70.0, 50.0, 180.0, 60.0, 0.0, 70.0, -490.0, 320.0, -480.0, 110.0, 180.0, 180.0, 30.0, 350.0, 30.0, 200.0, 20.0, -20.0, -20.0, 70.0, 170.0, 120.0, 180.0, -35.0, 320.0, 0.0, -10.0, 240.0, 50.0, 10.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 0.0, 260.0, 20.0, 40.0, 180.0, 110.0, 30.0, 30.0, 290.0, 180.0, -200.0, 30.0, 40.0, 70.0, 120.0, 80.0, 470.0, 210.0, 110.0, 170.0, 20.0, 50.0, 60.0, 160.0, 120.0, 150.0, 310.0, 370.0, 60.0, 10.0, 10.0, 290.0, 20.0, 0.0, 10.0, 80.0, 30.0, 350.0, 90.0, 20.0, 30.0, 20.0, 30.0, 360.0, 0.0, 90.0, 110.0, 100.0, 130.0, 200.0, 200.0, -20.0, 350.0, 30.0, 40.0, -20.0, 70.0, 880.0, 50.0, 160.0, 320.0, 40.0, 180.0, 170.0, 0.0, 100.0, 50.0, -10.0, 120.0, 310.0, 280.0, 30.0, 460.0, 880.0, 0.0, 70.0, 10.0, 80.0, 0.0, 0.0, 280.0, -30.0, 120.0, 250.0, 60.0, 160.0, 480.0, -10.0, 190.0, 30.0, 10.0, 260.0, 10.0, -155.0, 70.0, 50.0, -120.0, 120.0, 190.0, 60.0, 150.0, 190.0, 260.0, 100.0, 20.0, 110.0, 85.0, 80.0, 110.0, 10.0, 70.0, 330.0, 220.0, 140.0, 100.0, 240.0, -100.0, 20.0, 430.0, 200.0, 140.0, 170.0, -30.0, 80.0, 150.0, 120.0, 10.0, 70.0, 260.0, 60.0, 110.0, 120.0, -40.0, 100.0, 30.0, 50.0, 10.0, 110.0, 380.0, 50.0, 170.0, 90.0, -40.0, 90.0, 380.0, 70.0, 120.0, 60.0, 60.0, 160.0, 150.0, 130.0, 60.0, 300.0, 60.0, 220.0, 60.0, 300.0, 250.0, 90.0, 40.0, 370.0, 40.0, 70.0, 80.0, 10.0, 10.0, 300.0, 170.0, 110.0, 10.0, 110.0, 30.0, 150.0, 50.0, 40.0, 270.0, 30.0, 150.0, 20.0, 60.0, 270.0, 150.0, 30.0, 270.0, 280.0, 120.0, 20.0, 110.0, 10.0, -60.0, 120.0, 420.0, 150.0, 140.0, 0.0, 80.0, 220.0, 30.0, 220.0, 140.0, 190.0, 40.0, 30.0, 0.0, 40.0, 60.0, 130.0, 0.0, 30.0, 190.0, 100.0, 10.0, 90.0, 40.0, 420.0, 30.0, 20.0, 30.0, 0.0, 170.0, 230.0, 20.0, 120.0, 180.0, 150.0, -60.0, 80.0, 70.0, 50.0, 10.0, 30.0, 100.0, -20.0, 50.0, 80.0, 20.0, 80.0, 40.0, 220.0, 620.0, 20.0, 0.0, 50.0, 150.0, 40.0, 70.0, 50.0, 220.0, 20.0, -5.0, 130.0, 30.0, 30.0, 20.0, 10.0, 20.0, 170.0, 170.0, 40.0, 100.0, 140.0, 80.0, 30.0, 230.0, 40.0, 250.0, 70.0, 30.0, 0.0, 190.0, -30.0, 20.0, 190.0, 290.0, 230.0, 470.0, 40.0, 340.0, 60.0, 80.0, -10.0, 230.0, 230.0, 40.0, 100.0, 260.0, 160.0, 40.0, 680.0, 120.0, 710.0, 45.0, 230.0, 200.0, 180.0, 70.0, 140.0, 370.0, 20.0, 220.0, 500.0, 10.0, 30.0, 80.0, 150.0, 110.0, 50.0, 170.0, 30.0, 100.0, 10.0, 15.0, 90.0, 330.0, 50.0, 70.0, 0.0, 20.0, 50.0, 90.0, 140.0, 30.0, 170.0, 350.0, 110.0, 100.0, 170.0, 10.0, 230.0, 110.0, 150.0, 130.0, 210.0, 120.0, 55.0, 40.0, 40.0, 370.0, -40.0, 10.0, 390.0, 60.0, 60.0, 70.0, 90.0, 10.0, 40.0, 30.0, 270.0, 120.0, 50.0, 10.0, 60.0, 160.0, 30.0, 500.0, 150.0, 120.0, 240.0, 70.0, -30.0, 90.0, 150.0, 260.0, -20.0, 70.0, 560.0, 10.0, 230.0, 60.0, 270.0, 70.0, 70.0, 120.0, 55.0, 40.0, 280.0, 40.0, 40.0, 220.0, 140.0, 30.0, 0.0, -70.0, 50.0, 180.0, 160.0, 570.0, 480.0, -40.0, 245.0, 70.0, 70.0, -35.0, 310.0, -55.0, 80.0, 270.0, 110.0, 30.0, 130.0, 150.0, 160.0, -40.0, 570.0, 230.0, 150.0, 180.0, 100.0, 50.0, 10.0, 10.0, 190.0, 20.0, 40.0, 200.0, 40.0, 30.0, 190.0, 100.0, 20.0, 90.0, 560.0, 340.0, 40.0, 160.0, 10.0, 20.0, 110.0, -60.0, 130.0, 20.0, 330.0, 50.0, 40.0, 200.0, 160.0, 60.0, 120.0, 75.0, 180.0, 70.0, 120.0, -60.0, 100.0, 60.0, 390.0, -5.0, 30.0, 30.0, -85.0, 40.0, 10.0, 30.0, 40.0, 20.0, -175.0, 70.0, -140.0, 0.0, 80.0, 10.0, 0.0, 160.0, 180.0, 50.0, 50.0, 40.0, 160.0, 300.0, 20.0, 0.0, 290.0, 70.0, 80.0, 170.0, 100.0, 10.0, 120.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6755861969258563, "mean_inference_ms": 1.5032755541602896, "mean_action_processing_ms": 0.4257877518942127, "mean_env_wait_ms": 1.3502601812029353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01541280746459961, "StateBufferConnector_ms": 0.011594772338867188, "ViewRequirementAgentConnector_ms": 0.49502062797546387}, "num_episodes": 23, "episode_return_max": 2185.0, "episode_return_min": -190.0, "episode_return_mean": 1101.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.088026867713584, "num_env_steps_trained_throughput_per_sec": 19.088026867713584, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 4440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4440000, "timers": {"training_iteration_time_ms": 209887.151, "restore_workers_time_ms": 0.014, "training_step_time_ms": 209887.106, "sample_time_ms": 2920.99, "learn_time_ms": 206943.773, "learn_throughput": 19.329, "synch_weights_time_ms": 11.948}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "done": false, "training_iteration": 111, "trial_id": "aa996_00000", "date": "2024-05-24_05-11-45", "timestamp": 1716541905, "time_this_iter_s": 209.56672501564026, "time_total_s": 23171.556302547455, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x1600750d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23171.556302547455, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 19.76283783783784, "ram_util_percent": 79.00472972972972}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5847648534784935, "cur_kl_coeff": 0.21357421874999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.406792263735851, "policy_loss": -0.007378728673914874, "vf_loss": 7.413005612071711, "vf_explained_var": -0.000978758140874747, "kl": 0.005456569233364336, "entropy": 0.3074628446921627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1046985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "env_runners": {"episode_reward_max": 2185.0, "episode_reward_min": -190.0, "episode_reward_mean": 1121.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 112.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.0, 590.0, 1670.0, 1240.0, 725.0, 1075.0, 1310.0, 455.0, 710.0, 530.0, 1270.0, 1440.0, 1120.0, 1420.0, 1590.0, 1315.0, 1140.0, 680.0, 800.0, 1010.0, 1050.0, 280.0, 830.0, 1140.0, 1080.0, 1435.0, 1030.0, 1470.0, 1430.0, 1090.0, 200.0, 1060.0, 1105.0, 160.0, 940.0, 1320.0, 1300.0, 920.0, 1240.0, 1860.0, 1240.0, 1810.0, 1260.0, 635.0, 1035.0, 1720.0, 1000.0, 980.0, 1140.0, 1510.0, 1170.0, 910.0, 1200.0, 1520.0, 710.0, 910.0, 850.0, 1220.0, 615.0, 720.0, 1060.0, 1690.0, 1850.0, 2185.0, 1230.0, 725.0, 1420.0, 1085.0, 1140.0, 1390.0, 1380.0, 1205.0, 1500.0, 1095.0, 1680.0, 830.0, 1290.0, 1185.0, 915.0, -190.0, 1030.0, 880.0, 1010.0, 1920.0, 1360.0, 1655.0, 810.0, 1140.0, 1420.0, 1230.0, 970.0, 1090.0, 1170.0, 1235.0, 555.0, 900.0, 1575.0, 1650.0, 540.0, 890.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 230.0, 140.0, 30.0, 10.0, 140.0, 40.0, 460.0, 130.0, 0.0, 50.0, 0.0, 150.0, 90.0, -85.0, 210.0, 90.0, -75.0, 130.0, 30.0, 730.0, 60.0, 250.0, 180.0, 140.0, 50.0, 20.0, 80.0, 90.0, 70.0, 460.0, 30.0, 140.0, 160.0, 0.0, 0.0, 40.0, 30.0, 40.0, 340.0, -50.0, 50.0, 30.0, 20.0, 80.0, 30.0, 190.0, 25.0, 320.0, 30.0, 30.0, 30.0, 70.0, 20.0, 510.0, 180.0, 45.0, 90.0, -90.0, 190.0, 140.0, 150.0, 150.0, 150.0, 10.0, 130.0, 20.0, 200.0, 20.0, 340.0, 80.0, 0.0, 20.0, 40.0, 160.0, 0.0, 110.0, 0.0, 25.0, 20.0, 170.0, 0.0, 220.0, 70.0, 50.0, -10.0, 120.0, 70.0, 20.0, 0.0, 10.0, 120.0, 160.0, 0.0, 60.0, 40.0, 70.0, -55.0, 90.0, 35.0, -40.0, 50.0, 510.0, 60.0, 150.0, 120.0, 160.0, 120.0, 110.0, 30.0, 160.0, 200.0, 360.0, 80.0, 80.0, 70.0, 60.0, 310.0, 70.0, 50.0, 280.0, 10.0, 10.0, 160.0, -20.0, 40.0, 0.0, 340.0, 70.0, 230.0, 150.0, 70.0, 270.0, 200.0, 110.0, 320.0, 70.0, 80.0, 40.0, 110.0, 300.0, 310.0, 80.0, 220.0, 240.0, 80.0, 100.0, 150.0, 30.0, 80.0, 260.0, 180.0, 130.0, 350.0, 40.0, 15.0, 80.0, 90.0, 50.0, 120.0, 80.0, 140.0, 120.0, 210.0, 70.0, 260.0, 70.0, 70.0, 60.0, 60.0, 170.0, 150.0, 0.0, 40.0, 20.0, 190.0, 0.0, 10.0, 90.0, 10.0, 220.0, 10.0, 40.0, 0.0, -10.0, 50.0, 10.0, 430.0, 0.0, 50.0, 20.0, 0.0, 90.0, 200.0, 20.0, 120.0, 170.0, 200.0, 80.0, 110.0, 170.0, 100.0, 40.0, 30.0, 20.0, 310.0, 120.0, 80.0, 70.0, 110.0, 10.0, 80.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 10.0, 60.0, 370.0, 140.0, 30.0, -60.0, 95.0, 80.0, 30.0, 30.0, 25.0, 90.0, 340.0, 10.0, 90.0, 40.0, 50.0, 40.0, 90.0, 320.0, 70.0, 90.0, 20.0, 110.0, -20.0, -90.0, 290.0, 70.0, 90.0, -20.0, -70.0, 700.0, 280.0, 520.0, 30.0, 470.0, 100.0, 30.0, 30.0, 190.0, 95.0, -310.0, 20.0, 20.0, 0.0, 150.0, 50.0, 220.0, 40.0, 40.0, 510.0, -20.0, 40.0, 320.0, 210.0, 70.0, 60.0, 30.0, 40.0, 470.0, 140.0, 90.0, 170.0, 70.0, 40.0, 230.0, 90.0, 470.0, 110.0, 150.0, 10.0, 90.0, -10.0, 160.0, 120.0, 120.0, -30.0, 40.0, 60.0, 550.0, -220.0, 300.0, 420.0, 70.0, 50.0, 180.0, 60.0, 0.0, 70.0, -490.0, 320.0, -480.0, 110.0, 180.0, 180.0, 30.0, 350.0, 30.0, 200.0, 20.0, -20.0, -20.0, 70.0, 170.0, 120.0, 180.0, -35.0, 320.0, 0.0, -10.0, 240.0, 50.0, 10.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 0.0, 260.0, 20.0, 40.0, 180.0, 110.0, 30.0, 30.0, 290.0, 180.0, -200.0, 30.0, 40.0, 70.0, 120.0, 80.0, 470.0, 210.0, 110.0, 170.0, 20.0, 50.0, 60.0, 160.0, 120.0, 150.0, 310.0, 370.0, 60.0, 10.0, 10.0, 290.0, 20.0, 0.0, 10.0, 80.0, 30.0, 350.0, 90.0, 20.0, 30.0, 20.0, 30.0, 360.0, 0.0, 90.0, 110.0, 100.0, 130.0, 200.0, 200.0, -20.0, 350.0, 30.0, 40.0, -20.0, 70.0, 880.0, 50.0, 160.0, 320.0, 40.0, 180.0, 170.0, 0.0, 100.0, 50.0, -10.0, 120.0, 310.0, 280.0, 30.0, 460.0, 880.0, 0.0, 70.0, 10.0, 80.0, 0.0, 0.0, 280.0, -30.0, 120.0, 250.0, 60.0, 160.0, 480.0, -10.0, 190.0, 30.0, 10.0, 260.0, 10.0, -155.0, 70.0, 50.0, -120.0, 120.0, 190.0, 60.0, 150.0, 190.0, 260.0, 100.0, 20.0, 110.0, 85.0, 80.0, 110.0, 10.0, 70.0, 330.0, 220.0, 140.0, 100.0, 240.0, -100.0, 20.0, 430.0, 200.0, 140.0, 170.0, -30.0, 80.0, 150.0, 120.0, 10.0, 70.0, 260.0, 60.0, 110.0, 120.0, -40.0, 100.0, 30.0, 50.0, 10.0, 110.0, 380.0, 50.0, 170.0, 90.0, -40.0, 90.0, 380.0, 70.0, 120.0, 60.0, 60.0, 160.0, 150.0, 130.0, 60.0, 300.0, 60.0, 220.0, 60.0, 300.0, 250.0, 90.0, 40.0, 370.0, 40.0, 70.0, 80.0, 10.0, 10.0, 300.0, 170.0, 110.0, 10.0, 110.0, 30.0, 150.0, 50.0, 40.0, 270.0, 30.0, 150.0, 20.0, 60.0, 270.0, 150.0, 30.0, 270.0, 280.0, 120.0, 20.0, 110.0, 10.0, -60.0, 120.0, 420.0, 150.0, 140.0, 0.0, 80.0, 220.0, 30.0, 220.0, 140.0, 190.0, 40.0, 30.0, 0.0, 40.0, 60.0, 130.0, 0.0, 30.0, 190.0, 100.0, 10.0, 90.0, 40.0, 420.0, 30.0, 20.0, 30.0, 0.0, 170.0, 230.0, 20.0, 120.0, 180.0, 150.0, -60.0, 80.0, 70.0, 50.0, 10.0, 30.0, 100.0, -20.0, 50.0, 80.0, 20.0, 80.0, 40.0, 220.0, 620.0, 20.0, 0.0, 50.0, 150.0, 40.0, 70.0, 50.0, 220.0, 20.0, -5.0, 130.0, 30.0, 30.0, 20.0, 10.0, 20.0, 170.0, 170.0, 40.0, 100.0, 140.0, 80.0, 30.0, 230.0, 40.0, 250.0, 70.0, 30.0, 0.0, 190.0, -30.0, 20.0, 190.0, 290.0, 230.0, 470.0, 40.0, 340.0, 60.0, 80.0, -10.0, 230.0, 230.0, 40.0, 100.0, 260.0, 160.0, 40.0, 680.0, 120.0, 710.0, 45.0, 230.0, 200.0, 180.0, 70.0, 140.0, 370.0, 20.0, 220.0, 500.0, 10.0, 30.0, 80.0, 150.0, 110.0, 50.0, 170.0, 30.0, 100.0, 10.0, 15.0, 90.0, 330.0, 50.0, 70.0, 0.0, 20.0, 50.0, 90.0, 140.0, 30.0, 170.0, 350.0, 110.0, 100.0, 170.0, 10.0, 230.0, 110.0, 150.0, 130.0, 210.0, 120.0, 55.0, 40.0, 40.0, 370.0, -40.0, 10.0, 390.0, 60.0, 60.0, 70.0, 90.0, 10.0, 40.0, 30.0, 270.0, 120.0, 50.0, 10.0, 60.0, 160.0, 30.0, 500.0, 150.0, 120.0, 240.0, 70.0, -30.0, 90.0, 150.0, 260.0, -20.0, 70.0, 560.0, 10.0, 230.0, 60.0, 270.0, 70.0, 70.0, 120.0, 55.0, 40.0, 280.0, 40.0, 40.0, 220.0, 140.0, 30.0, 0.0, -70.0, 50.0, 180.0, 160.0, 570.0, 480.0, -40.0, 245.0, 70.0, 70.0, -35.0, 310.0, -55.0, 80.0, 270.0, 110.0, 30.0, 130.0, 150.0, 160.0, -40.0, 570.0, 230.0, 150.0, 180.0, 100.0, 50.0, 10.0, 10.0, 190.0, 20.0, 40.0, 200.0, 40.0, 30.0, 190.0, 100.0, 20.0, 90.0, 560.0, 340.0, 40.0, 160.0, 10.0, 20.0, 110.0, -60.0, 130.0, 20.0, 330.0, 50.0, 40.0, 200.0, 160.0, 60.0, 120.0, 75.0, 180.0, 70.0, 120.0, -60.0, 100.0, 60.0, 390.0, -5.0, 30.0, 30.0, -85.0, 40.0, 10.0, 30.0, 40.0, 20.0, -175.0, 70.0, -140.0, 0.0, 80.0, 10.0, 0.0, 160.0, 180.0, 50.0, 50.0, 40.0, 160.0, 300.0, 20.0, 0.0, 290.0, 70.0, 80.0, 170.0, 100.0, 10.0, 120.0, 20.0, 20.0, 110.0, -10.0, 80.0, 10.0, 60.0, 230.0, 70.0, 420.0, 20.0, 180.0, 110.0, 170.0, 40.0, 100.0, 90.0, 350.0, 330.0, 380.0, 170.0, 60.0, 280.0, 40.0, 70.0, 410.0, 160.0, 180.0, 90.0, 60.0, 10.0, 90.0, 50.0, 210.0, 30.0, 170.0, 520.0, 55.0, 70.0, 140.0, 320.0, 40.0, 20.0, 240.0, 50.0, 30.0, 100.0, 50.0, 130.0, 20.0, 130.0, 110.0, 40.0, 40.0, 220.0, 60.0, 80.0, 70.0, 420.0, 90.0, 10.0, 40.0, 220.0, 470.0, 230.0, 40.0, 100.0, 80.0, 60.0, 70.0, 110.0, 70.0, 60.0, 90.0, 30.0, 300.0, 80.0, 310.0, 210.0, 10.0, 70.0, 170.0, 280.0, 50.0, 60.0, 70.0, 170.0, 80.0, 30.0, 30.0, 30.0, 70.0, 50.0, 30.0, 90.0, 200.0, 400.0, 110.0, 90.0, 40.0, 10.0, 40.0, 30.0, 120.0, 160.0, 170.0, 110.0, 180.0, 50.0, 170.0, 140.0, 0.0, 400.0, 90.0, 80.0, 100.0, 180.0, 55.0, 170.0, 90.0, 70.0, 100.0, 0.0, -5.0, 60.0, 0.0, 20.0, -15.0, 15.0, 220.0, 160.0, 0.0, 340.0, 80.0, 50.0, 40.0, 50.0, 0.0, 110.0, 180.0, 50.0, 190.0, 40.0, 170.0, 40.0, 450.0, -10.0, 60.0, 20.0, 560.0, 55.0, 80.0, 180.0, 50.0, 280.0, 30.0, 130.0, 530.0, 90.0, 190.0, 90.0, -30.0, 0.0, 0.0, 0.0, 160.0, 90.0, 190.0, 0.0, 110.0, 20.0, 10.0, 10.0, 80.0, 10.0, 160.0, 30.0, 180.0, 130.0, 90.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6753064496516337, "mean_inference_ms": 1.5035279197270335, "mean_action_processing_ms": 0.42573300226171495, "mean_env_wait_ms": 1.3504636931077874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015219688415527344, "StateBufferConnector_ms": 0.011172056198120117, "ViewRequirementAgentConnector_ms": 0.49917125701904297}, "num_episodes": 18, "episode_return_max": 2185.0, "episode_return_min": -190.0, "episode_return_mean": 1121.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.138764495619352, "num_env_steps_trained_throughput_per_sec": 19.138764495619352, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 4480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4480000, "timers": {"training_iteration_time_ms": 209589.901, "restore_workers_time_ms": 0.014, "training_step_time_ms": 209589.857, "sample_time_ms": 2806.278, "learn_time_ms": 206761.51, "learn_throughput": 19.346, "synch_weights_time_ms": 11.895}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "done": false, "training_iteration": 112, "trial_id": "aa996_00000", "date": "2024-05-24_05-15-14", "timestamp": 1716542114, "time_this_iter_s": 209.008798122406, "time_total_s": 23380.56510066986, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160a85ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23380.56510066986, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 19.29324324324324, "ram_util_percent": 79.79155405405405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.413756789033786, "cur_kl_coeff": 0.21357421874999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.157298140327771, "policy_loss": -0.008360727196628738, "vf_loss": 7.1644107589071675, "vf_explained_var": 0.0008015952742518709, "kl": 0.005843917459838613, "entropy": 0.29749409595585735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1056375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "env_runners": {"episode_reward_max": 2185.0, "episode_reward_min": -190.0, "episode_reward_mean": 1124.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 112.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [830.0, 1140.0, 1080.0, 1435.0, 1030.0, 1470.0, 1430.0, 1090.0, 200.0, 1060.0, 1105.0, 160.0, 940.0, 1320.0, 1300.0, 920.0, 1240.0, 1860.0, 1240.0, 1810.0, 1260.0, 635.0, 1035.0, 1720.0, 1000.0, 980.0, 1140.0, 1510.0, 1170.0, 910.0, 1200.0, 1520.0, 710.0, 910.0, 850.0, 1220.0, 615.0, 720.0, 1060.0, 1690.0, 1850.0, 2185.0, 1230.0, 725.0, 1420.0, 1085.0, 1140.0, 1390.0, 1380.0, 1205.0, 1500.0, 1095.0, 1680.0, 830.0, 1290.0, 1185.0, 915.0, -190.0, 1030.0, 880.0, 1010.0, 1920.0, 1360.0, 1655.0, 810.0, 1140.0, 1420.0, 1230.0, 970.0, 1090.0, 1170.0, 1235.0, 555.0, 900.0, 1575.0, 1650.0, 540.0, 890.0, 1720.0, 1440.0, 500.0, 540.0, 1300.0, 1050.0, 580.0, 1270.0, 690.0, 1310.0, 1310.0, 1010.0, 615.0, 910.0, 1640.0, 960.0, 1720.0, 730.0, 1175.0, 580.0, 770.0, 1210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [370.0, 140.0, 30.0, -60.0, 95.0, 80.0, 30.0, 30.0, 25.0, 90.0, 340.0, 10.0, 90.0, 40.0, 50.0, 40.0, 90.0, 320.0, 70.0, 90.0, 20.0, 110.0, -20.0, -90.0, 290.0, 70.0, 90.0, -20.0, -70.0, 700.0, 280.0, 520.0, 30.0, 470.0, 100.0, 30.0, 30.0, 190.0, 95.0, -310.0, 20.0, 20.0, 0.0, 150.0, 50.0, 220.0, 40.0, 40.0, 510.0, -20.0, 40.0, 320.0, 210.0, 70.0, 60.0, 30.0, 40.0, 470.0, 140.0, 90.0, 170.0, 70.0, 40.0, 230.0, 90.0, 470.0, 110.0, 150.0, 10.0, 90.0, -10.0, 160.0, 120.0, 120.0, -30.0, 40.0, 60.0, 550.0, -220.0, 300.0, 420.0, 70.0, 50.0, 180.0, 60.0, 0.0, 70.0, -490.0, 320.0, -480.0, 110.0, 180.0, 180.0, 30.0, 350.0, 30.0, 200.0, 20.0, -20.0, -20.0, 70.0, 170.0, 120.0, 180.0, -35.0, 320.0, 0.0, -10.0, 240.0, 50.0, 10.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 0.0, 260.0, 20.0, 40.0, 180.0, 110.0, 30.0, 30.0, 290.0, 180.0, -200.0, 30.0, 40.0, 70.0, 120.0, 80.0, 470.0, 210.0, 110.0, 170.0, 20.0, 50.0, 60.0, 160.0, 120.0, 150.0, 310.0, 370.0, 60.0, 10.0, 10.0, 290.0, 20.0, 0.0, 10.0, 80.0, 30.0, 350.0, 90.0, 20.0, 30.0, 20.0, 30.0, 360.0, 0.0, 90.0, 110.0, 100.0, 130.0, 200.0, 200.0, -20.0, 350.0, 30.0, 40.0, -20.0, 70.0, 880.0, 50.0, 160.0, 320.0, 40.0, 180.0, 170.0, 0.0, 100.0, 50.0, -10.0, 120.0, 310.0, 280.0, 30.0, 460.0, 880.0, 0.0, 70.0, 10.0, 80.0, 0.0, 0.0, 280.0, -30.0, 120.0, 250.0, 60.0, 160.0, 480.0, -10.0, 190.0, 30.0, 10.0, 260.0, 10.0, -155.0, 70.0, 50.0, -120.0, 120.0, 190.0, 60.0, 150.0, 190.0, 260.0, 100.0, 20.0, 110.0, 85.0, 80.0, 110.0, 10.0, 70.0, 330.0, 220.0, 140.0, 100.0, 240.0, -100.0, 20.0, 430.0, 200.0, 140.0, 170.0, -30.0, 80.0, 150.0, 120.0, 10.0, 70.0, 260.0, 60.0, 110.0, 120.0, -40.0, 100.0, 30.0, 50.0, 10.0, 110.0, 380.0, 50.0, 170.0, 90.0, -40.0, 90.0, 380.0, 70.0, 120.0, 60.0, 60.0, 160.0, 150.0, 130.0, 60.0, 300.0, 60.0, 220.0, 60.0, 300.0, 250.0, 90.0, 40.0, 370.0, 40.0, 70.0, 80.0, 10.0, 10.0, 300.0, 170.0, 110.0, 10.0, 110.0, 30.0, 150.0, 50.0, 40.0, 270.0, 30.0, 150.0, 20.0, 60.0, 270.0, 150.0, 30.0, 270.0, 280.0, 120.0, 20.0, 110.0, 10.0, -60.0, 120.0, 420.0, 150.0, 140.0, 0.0, 80.0, 220.0, 30.0, 220.0, 140.0, 190.0, 40.0, 30.0, 0.0, 40.0, 60.0, 130.0, 0.0, 30.0, 190.0, 100.0, 10.0, 90.0, 40.0, 420.0, 30.0, 20.0, 30.0, 0.0, 170.0, 230.0, 20.0, 120.0, 180.0, 150.0, -60.0, 80.0, 70.0, 50.0, 10.0, 30.0, 100.0, -20.0, 50.0, 80.0, 20.0, 80.0, 40.0, 220.0, 620.0, 20.0, 0.0, 50.0, 150.0, 40.0, 70.0, 50.0, 220.0, 20.0, -5.0, 130.0, 30.0, 30.0, 20.0, 10.0, 20.0, 170.0, 170.0, 40.0, 100.0, 140.0, 80.0, 30.0, 230.0, 40.0, 250.0, 70.0, 30.0, 0.0, 190.0, -30.0, 20.0, 190.0, 290.0, 230.0, 470.0, 40.0, 340.0, 60.0, 80.0, -10.0, 230.0, 230.0, 40.0, 100.0, 260.0, 160.0, 40.0, 680.0, 120.0, 710.0, 45.0, 230.0, 200.0, 180.0, 70.0, 140.0, 370.0, 20.0, 220.0, 500.0, 10.0, 30.0, 80.0, 150.0, 110.0, 50.0, 170.0, 30.0, 100.0, 10.0, 15.0, 90.0, 330.0, 50.0, 70.0, 0.0, 20.0, 50.0, 90.0, 140.0, 30.0, 170.0, 350.0, 110.0, 100.0, 170.0, 10.0, 230.0, 110.0, 150.0, 130.0, 210.0, 120.0, 55.0, 40.0, 40.0, 370.0, -40.0, 10.0, 390.0, 60.0, 60.0, 70.0, 90.0, 10.0, 40.0, 30.0, 270.0, 120.0, 50.0, 10.0, 60.0, 160.0, 30.0, 500.0, 150.0, 120.0, 240.0, 70.0, -30.0, 90.0, 150.0, 260.0, -20.0, 70.0, 560.0, 10.0, 230.0, 60.0, 270.0, 70.0, 70.0, 120.0, 55.0, 40.0, 280.0, 40.0, 40.0, 220.0, 140.0, 30.0, 0.0, -70.0, 50.0, 180.0, 160.0, 570.0, 480.0, -40.0, 245.0, 70.0, 70.0, -35.0, 310.0, -55.0, 80.0, 270.0, 110.0, 30.0, 130.0, 150.0, 160.0, -40.0, 570.0, 230.0, 150.0, 180.0, 100.0, 50.0, 10.0, 10.0, 190.0, 20.0, 40.0, 200.0, 40.0, 30.0, 190.0, 100.0, 20.0, 90.0, 560.0, 340.0, 40.0, 160.0, 10.0, 20.0, 110.0, -60.0, 130.0, 20.0, 330.0, 50.0, 40.0, 200.0, 160.0, 60.0, 120.0, 75.0, 180.0, 70.0, 120.0, -60.0, 100.0, 60.0, 390.0, -5.0, 30.0, 30.0, -85.0, 40.0, 10.0, 30.0, 40.0, 20.0, -175.0, 70.0, -140.0, 0.0, 80.0, 10.0, 0.0, 160.0, 180.0, 50.0, 50.0, 40.0, 160.0, 300.0, 20.0, 0.0, 290.0, 70.0, 80.0, 170.0, 100.0, 10.0, 120.0, 20.0, 20.0, 110.0, -10.0, 80.0, 10.0, 60.0, 230.0, 70.0, 420.0, 20.0, 180.0, 110.0, 170.0, 40.0, 100.0, 90.0, 350.0, 330.0, 380.0, 170.0, 60.0, 280.0, 40.0, 70.0, 410.0, 160.0, 180.0, 90.0, 60.0, 10.0, 90.0, 50.0, 210.0, 30.0, 170.0, 520.0, 55.0, 70.0, 140.0, 320.0, 40.0, 20.0, 240.0, 50.0, 30.0, 100.0, 50.0, 130.0, 20.0, 130.0, 110.0, 40.0, 40.0, 220.0, 60.0, 80.0, 70.0, 420.0, 90.0, 10.0, 40.0, 220.0, 470.0, 230.0, 40.0, 100.0, 80.0, 60.0, 70.0, 110.0, 70.0, 60.0, 90.0, 30.0, 300.0, 80.0, 310.0, 210.0, 10.0, 70.0, 170.0, 280.0, 50.0, 60.0, 70.0, 170.0, 80.0, 30.0, 30.0, 30.0, 70.0, 50.0, 30.0, 90.0, 200.0, 400.0, 110.0, 90.0, 40.0, 10.0, 40.0, 30.0, 120.0, 160.0, 170.0, 110.0, 180.0, 50.0, 170.0, 140.0, 0.0, 400.0, 90.0, 80.0, 100.0, 180.0, 55.0, 170.0, 90.0, 70.0, 100.0, 0.0, -5.0, 60.0, 0.0, 20.0, -15.0, 15.0, 220.0, 160.0, 0.0, 340.0, 80.0, 50.0, 40.0, 50.0, 0.0, 110.0, 180.0, 50.0, 190.0, 40.0, 170.0, 40.0, 450.0, -10.0, 60.0, 20.0, 560.0, 55.0, 80.0, 180.0, 50.0, 280.0, 30.0, 130.0, 530.0, 90.0, 190.0, 90.0, -30.0, 0.0, 0.0, 0.0, 160.0, 90.0, 190.0, 0.0, 110.0, 20.0, 10.0, 10.0, 80.0, 10.0, 160.0, 30.0, 180.0, 130.0, 90.0, 190.0, 130.0, -60.0, 320.0, 120.0, 60.0, 150.0, 20.0, 100.0, 850.0, 30.0, 250.0, 50.0, 170.0, 70.0, 100.0, 510.0, 130.0, 0.0, 130.0, 30.0, 20.0, 10.0, 150.0, 50.0, 120.0, 0.0, 0.0, 70.0, 40.0, 40.0, 10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 40.0, 100.0, 180.0, 10.0, 180.0, 190.0, 70.0, 50.0, 140.0, 130.0, 270.0, 70.0, 140.0, 60.0, -430.0, 30.0, 70.0, 410.0, 220.0, 80.0, 40.0, 290.0, 100.0, 240.0, 40.0, 40.0, 50.0, 440.0, 60.0, -370.0, 30.0, 190.0, 90.0, 10.0, 110.0, -20.0, 0.0, -90.0, 80.0, 140.0, 30.0, 980.0, 20.0, 20.0, 0.0, 0.0, 50.0, 320.0, 70.0, 170.0, 40.0, 30.0, 10.0, 0.0, 130.0, 100.0, 240.0, 50.0, 130.0, 20.0, 280.0, 60.0, 80.0, 220.0, 100.0, 210.0, 170.0, 160.0, 20.0, 80.0, 260.0, -10.0, 50.0, 270.0, 90.0, 100.0, 320.0, 80.0, -10.0, 150.0, 0.0, 0.0, 30.0, 250.0, 40.0, 40.0, -20.0, -5.0, 360.0, 0.0, 40.0, 110.0, 10.0, 40.0, 160.0, 20.0, 20.0, 50.0, 60.0, 380.0, 0.0, 190.0, 20.0, 10.0, 20.0, 40.0, 350.0, 100.0, 250.0, 130.0, 90.0, 310.0, 200.0, 150.0, 200.0, 15.0, 10.0, 60.0, 80.0, 80.0, 380.0, 5.0, 120.0, 10.0, 150.0, 170.0, 530.0, -10.0, 410.0, 80.0, 130.0, 310.0, -10.0, -40.0, 310.0, 30.0, 220.0, 10.0, 30.0, 10.0, 40.0, 40.0, 30.0, 10.0, 170.0, 190.0, 80.0, 350.0, -10.0, 60.0, 70.0, 100.0, -15.0, 180.0, 10.0, 20.0, 120.0, 20.0, 170.0, 80.0, 40.0, 60.0, 40.0, 20.0, 30.0, 0.0, 200.0, 110.0, 40.0, 50.0, 20.0, 50.0, 60.0, 210.0, 220.0, 30.0, 60.0, 250.0, -70.0, 60.0, 200.0, 190.0, 80.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6747240177157026, "mean_inference_ms": 1.503749514782959, "mean_action_processing_ms": 0.4256340746582612, "mean_env_wait_ms": 1.3505898522664106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01517343521118164, "StateBufferConnector_ms": 0.011411666870117188, "ViewRequirementAgentConnector_ms": 0.5033209323883057}, "num_episodes": 22, "episode_return_max": 2185.0, "episode_return_min": -190.0, "episode_return_mean": 1124.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.15719949095419, "num_env_steps_trained_throughput_per_sec": 19.15719949095419, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 4520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4520000, "timers": {"training_iteration_time_ms": 209295.067, "restore_workers_time_ms": 0.014, "training_step_time_ms": 209295.024, "sample_time_ms": 2775.753, "learn_time_ms": 206497.342, "learn_throughput": 19.371, "synch_weights_time_ms": 12.127}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "done": false, "training_iteration": 113, "trial_id": "aa996_00000", "date": "2024-05-24_05-18-43", "timestamp": 1716542323, "time_this_iter_s": 208.81607580184937, "time_total_s": 23589.38117647171, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160a858b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23589.38117647171, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 19.19050847457627, "ram_util_percent": 78.61627118644067}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4984602934128435, "cur_kl_coeff": 0.21357421874999996, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007803629065816181, "vf_loss": 7.486087812986364, "vf_explained_var": 0.00031797901129189393, "kl": Infinity, "entropy": 0.29011080320111227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1065765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "env_runners": {"episode_reward_max": 2185.0, "episode_reward_min": -190.0, "episode_reward_mean": 1139.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -430.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 113.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1240.0, 1810.0, 1260.0, 635.0, 1035.0, 1720.0, 1000.0, 980.0, 1140.0, 1510.0, 1170.0, 910.0, 1200.0, 1520.0, 710.0, 910.0, 850.0, 1220.0, 615.0, 720.0, 1060.0, 1690.0, 1850.0, 2185.0, 1230.0, 725.0, 1420.0, 1085.0, 1140.0, 1390.0, 1380.0, 1205.0, 1500.0, 1095.0, 1680.0, 830.0, 1290.0, 1185.0, 915.0, -190.0, 1030.0, 880.0, 1010.0, 1920.0, 1360.0, 1655.0, 810.0, 1140.0, 1420.0, 1230.0, 970.0, 1090.0, 1170.0, 1235.0, 555.0, 900.0, 1575.0, 1650.0, 540.0, 890.0, 1720.0, 1440.0, 500.0, 540.0, 1300.0, 1050.0, 580.0, 1270.0, 690.0, 1310.0, 1310.0, 1010.0, 615.0, 910.0, 1640.0, 960.0, 1720.0, 730.0, 1175.0, 580.0, 770.0, 1210.0, 1030.0, 95.0, 1570.0, 1485.0, 750.0, 1820.0, 1820.0, 1350.0, 1405.0, 395.0, 820.0, 1485.0, 1130.0, 865.0, 1380.0, 920.0, 1380.0, 1370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 180.0, 170.0, 0.0, 100.0, 50.0, -10.0, 120.0, 310.0, 280.0, 30.0, 460.0, 880.0, 0.0, 70.0, 10.0, 80.0, 0.0, 0.0, 280.0, -30.0, 120.0, 250.0, 60.0, 160.0, 480.0, -10.0, 190.0, 30.0, 10.0, 260.0, 10.0, -155.0, 70.0, 50.0, -120.0, 120.0, 190.0, 60.0, 150.0, 190.0, 260.0, 100.0, 20.0, 110.0, 85.0, 80.0, 110.0, 10.0, 70.0, 330.0, 220.0, 140.0, 100.0, 240.0, -100.0, 20.0, 430.0, 200.0, 140.0, 170.0, -30.0, 80.0, 150.0, 120.0, 10.0, 70.0, 260.0, 60.0, 110.0, 120.0, -40.0, 100.0, 30.0, 50.0, 10.0, 110.0, 380.0, 50.0, 170.0, 90.0, -40.0, 90.0, 380.0, 70.0, 120.0, 60.0, 60.0, 160.0, 150.0, 130.0, 60.0, 300.0, 60.0, 220.0, 60.0, 300.0, 250.0, 90.0, 40.0, 370.0, 40.0, 70.0, 80.0, 10.0, 10.0, 300.0, 170.0, 110.0, 10.0, 110.0, 30.0, 150.0, 50.0, 40.0, 270.0, 30.0, 150.0, 20.0, 60.0, 270.0, 150.0, 30.0, 270.0, 280.0, 120.0, 20.0, 110.0, 10.0, -60.0, 120.0, 420.0, 150.0, 140.0, 0.0, 80.0, 220.0, 30.0, 220.0, 140.0, 190.0, 40.0, 30.0, 0.0, 40.0, 60.0, 130.0, 0.0, 30.0, 190.0, 100.0, 10.0, 90.0, 40.0, 420.0, 30.0, 20.0, 30.0, 0.0, 170.0, 230.0, 20.0, 120.0, 180.0, 150.0, -60.0, 80.0, 70.0, 50.0, 10.0, 30.0, 100.0, -20.0, 50.0, 80.0, 20.0, 80.0, 40.0, 220.0, 620.0, 20.0, 0.0, 50.0, 150.0, 40.0, 70.0, 50.0, 220.0, 20.0, -5.0, 130.0, 30.0, 30.0, 20.0, 10.0, 20.0, 170.0, 170.0, 40.0, 100.0, 140.0, 80.0, 30.0, 230.0, 40.0, 250.0, 70.0, 30.0, 0.0, 190.0, -30.0, 20.0, 190.0, 290.0, 230.0, 470.0, 40.0, 340.0, 60.0, 80.0, -10.0, 230.0, 230.0, 40.0, 100.0, 260.0, 160.0, 40.0, 680.0, 120.0, 710.0, 45.0, 230.0, 200.0, 180.0, 70.0, 140.0, 370.0, 20.0, 220.0, 500.0, 10.0, 30.0, 80.0, 150.0, 110.0, 50.0, 170.0, 30.0, 100.0, 10.0, 15.0, 90.0, 330.0, 50.0, 70.0, 0.0, 20.0, 50.0, 90.0, 140.0, 30.0, 170.0, 350.0, 110.0, 100.0, 170.0, 10.0, 230.0, 110.0, 150.0, 130.0, 210.0, 120.0, 55.0, 40.0, 40.0, 370.0, -40.0, 10.0, 390.0, 60.0, 60.0, 70.0, 90.0, 10.0, 40.0, 30.0, 270.0, 120.0, 50.0, 10.0, 60.0, 160.0, 30.0, 500.0, 150.0, 120.0, 240.0, 70.0, -30.0, 90.0, 150.0, 260.0, -20.0, 70.0, 560.0, 10.0, 230.0, 60.0, 270.0, 70.0, 70.0, 120.0, 55.0, 40.0, 280.0, 40.0, 40.0, 220.0, 140.0, 30.0, 0.0, -70.0, 50.0, 180.0, 160.0, 570.0, 480.0, -40.0, 245.0, 70.0, 70.0, -35.0, 310.0, -55.0, 80.0, 270.0, 110.0, 30.0, 130.0, 150.0, 160.0, -40.0, 570.0, 230.0, 150.0, 180.0, 100.0, 50.0, 10.0, 10.0, 190.0, 20.0, 40.0, 200.0, 40.0, 30.0, 190.0, 100.0, 20.0, 90.0, 560.0, 340.0, 40.0, 160.0, 10.0, 20.0, 110.0, -60.0, 130.0, 20.0, 330.0, 50.0, 40.0, 200.0, 160.0, 60.0, 120.0, 75.0, 180.0, 70.0, 120.0, -60.0, 100.0, 60.0, 390.0, -5.0, 30.0, 30.0, -85.0, 40.0, 10.0, 30.0, 40.0, 20.0, -175.0, 70.0, -140.0, 0.0, 80.0, 10.0, 0.0, 160.0, 180.0, 50.0, 50.0, 40.0, 160.0, 300.0, 20.0, 0.0, 290.0, 70.0, 80.0, 170.0, 100.0, 10.0, 120.0, 20.0, 20.0, 110.0, -10.0, 80.0, 10.0, 60.0, 230.0, 70.0, 420.0, 20.0, 180.0, 110.0, 170.0, 40.0, 100.0, 90.0, 350.0, 330.0, 380.0, 170.0, 60.0, 280.0, 40.0, 70.0, 410.0, 160.0, 180.0, 90.0, 60.0, 10.0, 90.0, 50.0, 210.0, 30.0, 170.0, 520.0, 55.0, 70.0, 140.0, 320.0, 40.0, 20.0, 240.0, 50.0, 30.0, 100.0, 50.0, 130.0, 20.0, 130.0, 110.0, 40.0, 40.0, 220.0, 60.0, 80.0, 70.0, 420.0, 90.0, 10.0, 40.0, 220.0, 470.0, 230.0, 40.0, 100.0, 80.0, 60.0, 70.0, 110.0, 70.0, 60.0, 90.0, 30.0, 300.0, 80.0, 310.0, 210.0, 10.0, 70.0, 170.0, 280.0, 50.0, 60.0, 70.0, 170.0, 80.0, 30.0, 30.0, 30.0, 70.0, 50.0, 30.0, 90.0, 200.0, 400.0, 110.0, 90.0, 40.0, 10.0, 40.0, 30.0, 120.0, 160.0, 170.0, 110.0, 180.0, 50.0, 170.0, 140.0, 0.0, 400.0, 90.0, 80.0, 100.0, 180.0, 55.0, 170.0, 90.0, 70.0, 100.0, 0.0, -5.0, 60.0, 0.0, 20.0, -15.0, 15.0, 220.0, 160.0, 0.0, 340.0, 80.0, 50.0, 40.0, 50.0, 0.0, 110.0, 180.0, 50.0, 190.0, 40.0, 170.0, 40.0, 450.0, -10.0, 60.0, 20.0, 560.0, 55.0, 80.0, 180.0, 50.0, 280.0, 30.0, 130.0, 530.0, 90.0, 190.0, 90.0, -30.0, 0.0, 0.0, 0.0, 160.0, 90.0, 190.0, 0.0, 110.0, 20.0, 10.0, 10.0, 80.0, 10.0, 160.0, 30.0, 180.0, 130.0, 90.0, 190.0, 130.0, -60.0, 320.0, 120.0, 60.0, 150.0, 20.0, 100.0, 850.0, 30.0, 250.0, 50.0, 170.0, 70.0, 100.0, 510.0, 130.0, 0.0, 130.0, 30.0, 20.0, 10.0, 150.0, 50.0, 120.0, 0.0, 0.0, 70.0, 40.0, 40.0, 10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 40.0, 100.0, 180.0, 10.0, 180.0, 190.0, 70.0, 50.0, 140.0, 130.0, 270.0, 70.0, 140.0, 60.0, -430.0, 30.0, 70.0, 410.0, 220.0, 80.0, 40.0, 290.0, 100.0, 240.0, 40.0, 40.0, 50.0, 440.0, 60.0, -370.0, 30.0, 190.0, 90.0, 10.0, 110.0, -20.0, 0.0, -90.0, 80.0, 140.0, 30.0, 980.0, 20.0, 20.0, 0.0, 0.0, 50.0, 320.0, 70.0, 170.0, 40.0, 30.0, 10.0, 0.0, 130.0, 100.0, 240.0, 50.0, 130.0, 20.0, 280.0, 60.0, 80.0, 220.0, 100.0, 210.0, 170.0, 160.0, 20.0, 80.0, 260.0, -10.0, 50.0, 270.0, 90.0, 100.0, 320.0, 80.0, -10.0, 150.0, 0.0, 0.0, 30.0, 250.0, 40.0, 40.0, -20.0, -5.0, 360.0, 0.0, 40.0, 110.0, 10.0, 40.0, 160.0, 20.0, 20.0, 50.0, 60.0, 380.0, 0.0, 190.0, 20.0, 10.0, 20.0, 40.0, 350.0, 100.0, 250.0, 130.0, 90.0, 310.0, 200.0, 150.0, 200.0, 15.0, 10.0, 60.0, 80.0, 80.0, 380.0, 5.0, 120.0, 10.0, 150.0, 170.0, 530.0, -10.0, 410.0, 80.0, 130.0, 310.0, -10.0, -40.0, 310.0, 30.0, 220.0, 10.0, 30.0, 10.0, 40.0, 40.0, 30.0, 10.0, 170.0, 190.0, 80.0, 350.0, -10.0, 60.0, 70.0, 100.0, -15.0, 180.0, 10.0, 20.0, 120.0, 20.0, 170.0, 80.0, 40.0, 60.0, 40.0, 20.0, 30.0, 0.0, 200.0, 110.0, 40.0, 50.0, 20.0, 50.0, 60.0, 210.0, 220.0, 30.0, 60.0, 250.0, -70.0, 60.0, 200.0, 190.0, 80.0, 190.0, 70.0, 90.0, 40.0, 120.0, 80.0, -90.0, 150.0, 200.0, 40.0, 330.0, 40.0, 20.0, 90.0, -170.0, 20.0, 0.0, 190.0, 5.0, -110.0, 10.0, 30.0, 140.0, 0.0, 140.0, 100.0, 300.0, 10.0, 20.0, 210.0, 620.0, 170.0, 25.0, 220.0, 190.0, -40.0, 0.0, 140.0, 350.0, 170.0, 260.0, 40.0, 150.0, 300.0, 30.0, 10.0, 20.0, 30.0, 50.0, 80.0, 40.0, 110.0, 280.0, 250.0, 20.0, 210.0, 210.0, 400.0, 120.0, 90.0, 130.0, 30.0, 190.0, 240.0, 80.0, 670.0, 170.0, 40.0, 100.0, 110.0, 190.0, 100.0, 130.0, 230.0, 290.0, 60.0, 30.0, 240.0, 160.0, 30.0, 80.0, 100.0, 280.0, 30.0, 140.0, 90.0, 20.0, 280.0, 75.0, 90.0, 300.0, 40.0, 30.0, 0.0, 180.0, 10.0, 0.0, 30.0, 40.0, 20.0, 45.0, 60.0, 40.0, 50.0, 400.0, 20.0, 50.0, 160.0, 0.0, 0.0, 40.0, 50.0, 450.0, 30.0, 160.0, 20.0, 85.0, 80.0, 270.0, 70.0, 270.0, 20.0, 370.0, 20.0, 50.0, 170.0, 100.0, 110.0, 80.0, 180.0, 30.0, 0.0, 60.0, 90.0, 25.0, 180.0, 100.0, 330.0, 10.0, 10.0, 60.0, 120.0, 80.0, 90.0, 10.0, 90.0, 20.0, 520.0, 150.0, 90.0, 210.0, 90.0, 80.0, 170.0, 90.0, 80.0, -30.0, 290.0, 70.0, 70.0, 10.0, 30.0, 190.0, 10.0, 50.0, 340.0, 50.0, 40.0, 140.0, 150.0, 380.0, 20.0, 100.0, 150.0, 60.0, 110.0, 210.0, 30.0, 240.0, 340.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6741543593755404, "mean_inference_ms": 1.5038138905986391, "mean_action_processing_ms": 0.42551884170906357, "mean_env_wait_ms": 1.3505134529307758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015071868896484375, "StateBufferConnector_ms": 0.010434150695800781, "ViewRequirementAgentConnector_ms": 0.5057098865509033}, "num_episodes": 18, "episode_return_max": 2185.0, "episode_return_min": -190.0, "episode_return_mean": 1139.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.199205750630632, "num_env_steps_trained_throughput_per_sec": 19.199205750630632, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 4560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4560000, "timers": {"training_iteration_time_ms": 209194.68, "restore_workers_time_ms": 0.014, "training_step_time_ms": 209194.637, "sample_time_ms": 2744.542, "learn_time_ms": 206427.907, "learn_throughput": 19.377, "synch_weights_time_ms": 12.277}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "done": false, "training_iteration": 114, "trial_id": "aa996_00000", "date": "2024-05-24_05-22-11", "timestamp": 1716542531, "time_this_iter_s": 208.34915900230408, "time_total_s": 23797.730335474014, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dc3430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23797.730335474014, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 18.92847457627119, "ram_util_percent": 78.27016949152542}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.790841350013329, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.023346499513132, "policy_loss": -0.00788930048407338, "vf_loss": 7.029497940776447, "vf_explained_var": -0.0022453638946159453, "kl": 0.005424674183736781, "entropy": 0.3071784613183893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1075155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "env_runners": {"episode_reward_max": 2185.0, "episode_reward_min": -190.0, "episode_reward_mean": 1104.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -430.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 110.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2185.0, 1230.0, 725.0, 1420.0, 1085.0, 1140.0, 1390.0, 1380.0, 1205.0, 1500.0, 1095.0, 1680.0, 830.0, 1290.0, 1185.0, 915.0, -190.0, 1030.0, 880.0, 1010.0, 1920.0, 1360.0, 1655.0, 810.0, 1140.0, 1420.0, 1230.0, 970.0, 1090.0, 1170.0, 1235.0, 555.0, 900.0, 1575.0, 1650.0, 540.0, 890.0, 1720.0, 1440.0, 500.0, 540.0, 1300.0, 1050.0, 580.0, 1270.0, 690.0, 1310.0, 1310.0, 1010.0, 615.0, 910.0, 1640.0, 960.0, 1720.0, 730.0, 1175.0, 580.0, 770.0, 1210.0, 1030.0, 95.0, 1570.0, 1485.0, 750.0, 1820.0, 1820.0, 1350.0, 1405.0, 395.0, 820.0, 1485.0, 1130.0, 865.0, 1380.0, 920.0, 1380.0, 1370.0, 1410.0, 960.0, 1010.0, 1100.0, 1835.0, 750.0, 1395.0, 1280.0, 1350.0, 1120.0, 410.0, 1070.0, 875.0, 365.0, 1090.0, 1430.0, 1280.0, 1560.0, 730.0, 680.0, 110.0, 620.0, 805.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [710.0, 45.0, 230.0, 200.0, 180.0, 70.0, 140.0, 370.0, 20.0, 220.0, 500.0, 10.0, 30.0, 80.0, 150.0, 110.0, 50.0, 170.0, 30.0, 100.0, 10.0, 15.0, 90.0, 330.0, 50.0, 70.0, 0.0, 20.0, 50.0, 90.0, 140.0, 30.0, 170.0, 350.0, 110.0, 100.0, 170.0, 10.0, 230.0, 110.0, 150.0, 130.0, 210.0, 120.0, 55.0, 40.0, 40.0, 370.0, -40.0, 10.0, 390.0, 60.0, 60.0, 70.0, 90.0, 10.0, 40.0, 30.0, 270.0, 120.0, 50.0, 10.0, 60.0, 160.0, 30.0, 500.0, 150.0, 120.0, 240.0, 70.0, -30.0, 90.0, 150.0, 260.0, -20.0, 70.0, 560.0, 10.0, 230.0, 60.0, 270.0, 70.0, 70.0, 120.0, 55.0, 40.0, 280.0, 40.0, 40.0, 220.0, 140.0, 30.0, 0.0, -70.0, 50.0, 180.0, 160.0, 570.0, 480.0, -40.0, 245.0, 70.0, 70.0, -35.0, 310.0, -55.0, 80.0, 270.0, 110.0, 30.0, 130.0, 150.0, 160.0, -40.0, 570.0, 230.0, 150.0, 180.0, 100.0, 50.0, 10.0, 10.0, 190.0, 20.0, 40.0, 200.0, 40.0, 30.0, 190.0, 100.0, 20.0, 90.0, 560.0, 340.0, 40.0, 160.0, 10.0, 20.0, 110.0, -60.0, 130.0, 20.0, 330.0, 50.0, 40.0, 200.0, 160.0, 60.0, 120.0, 75.0, 180.0, 70.0, 120.0, -60.0, 100.0, 60.0, 390.0, -5.0, 30.0, 30.0, -85.0, 40.0, 10.0, 30.0, 40.0, 20.0, -175.0, 70.0, -140.0, 0.0, 80.0, 10.0, 0.0, 160.0, 180.0, 50.0, 50.0, 40.0, 160.0, 300.0, 20.0, 0.0, 290.0, 70.0, 80.0, 170.0, 100.0, 10.0, 120.0, 20.0, 20.0, 110.0, -10.0, 80.0, 10.0, 60.0, 230.0, 70.0, 420.0, 20.0, 180.0, 110.0, 170.0, 40.0, 100.0, 90.0, 350.0, 330.0, 380.0, 170.0, 60.0, 280.0, 40.0, 70.0, 410.0, 160.0, 180.0, 90.0, 60.0, 10.0, 90.0, 50.0, 210.0, 30.0, 170.0, 520.0, 55.0, 70.0, 140.0, 320.0, 40.0, 20.0, 240.0, 50.0, 30.0, 100.0, 50.0, 130.0, 20.0, 130.0, 110.0, 40.0, 40.0, 220.0, 60.0, 80.0, 70.0, 420.0, 90.0, 10.0, 40.0, 220.0, 470.0, 230.0, 40.0, 100.0, 80.0, 60.0, 70.0, 110.0, 70.0, 60.0, 90.0, 30.0, 300.0, 80.0, 310.0, 210.0, 10.0, 70.0, 170.0, 280.0, 50.0, 60.0, 70.0, 170.0, 80.0, 30.0, 30.0, 30.0, 70.0, 50.0, 30.0, 90.0, 200.0, 400.0, 110.0, 90.0, 40.0, 10.0, 40.0, 30.0, 120.0, 160.0, 170.0, 110.0, 180.0, 50.0, 170.0, 140.0, 0.0, 400.0, 90.0, 80.0, 100.0, 180.0, 55.0, 170.0, 90.0, 70.0, 100.0, 0.0, -5.0, 60.0, 0.0, 20.0, -15.0, 15.0, 220.0, 160.0, 0.0, 340.0, 80.0, 50.0, 40.0, 50.0, 0.0, 110.0, 180.0, 50.0, 190.0, 40.0, 170.0, 40.0, 450.0, -10.0, 60.0, 20.0, 560.0, 55.0, 80.0, 180.0, 50.0, 280.0, 30.0, 130.0, 530.0, 90.0, 190.0, 90.0, -30.0, 0.0, 0.0, 0.0, 160.0, 90.0, 190.0, 0.0, 110.0, 20.0, 10.0, 10.0, 80.0, 10.0, 160.0, 30.0, 180.0, 130.0, 90.0, 190.0, 130.0, -60.0, 320.0, 120.0, 60.0, 150.0, 20.0, 100.0, 850.0, 30.0, 250.0, 50.0, 170.0, 70.0, 100.0, 510.0, 130.0, 0.0, 130.0, 30.0, 20.0, 10.0, 150.0, 50.0, 120.0, 0.0, 0.0, 70.0, 40.0, 40.0, 10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 40.0, 100.0, 180.0, 10.0, 180.0, 190.0, 70.0, 50.0, 140.0, 130.0, 270.0, 70.0, 140.0, 60.0, -430.0, 30.0, 70.0, 410.0, 220.0, 80.0, 40.0, 290.0, 100.0, 240.0, 40.0, 40.0, 50.0, 440.0, 60.0, -370.0, 30.0, 190.0, 90.0, 10.0, 110.0, -20.0, 0.0, -90.0, 80.0, 140.0, 30.0, 980.0, 20.0, 20.0, 0.0, 0.0, 50.0, 320.0, 70.0, 170.0, 40.0, 30.0, 10.0, 0.0, 130.0, 100.0, 240.0, 50.0, 130.0, 20.0, 280.0, 60.0, 80.0, 220.0, 100.0, 210.0, 170.0, 160.0, 20.0, 80.0, 260.0, -10.0, 50.0, 270.0, 90.0, 100.0, 320.0, 80.0, -10.0, 150.0, 0.0, 0.0, 30.0, 250.0, 40.0, 40.0, -20.0, -5.0, 360.0, 0.0, 40.0, 110.0, 10.0, 40.0, 160.0, 20.0, 20.0, 50.0, 60.0, 380.0, 0.0, 190.0, 20.0, 10.0, 20.0, 40.0, 350.0, 100.0, 250.0, 130.0, 90.0, 310.0, 200.0, 150.0, 200.0, 15.0, 10.0, 60.0, 80.0, 80.0, 380.0, 5.0, 120.0, 10.0, 150.0, 170.0, 530.0, -10.0, 410.0, 80.0, 130.0, 310.0, -10.0, -40.0, 310.0, 30.0, 220.0, 10.0, 30.0, 10.0, 40.0, 40.0, 30.0, 10.0, 170.0, 190.0, 80.0, 350.0, -10.0, 60.0, 70.0, 100.0, -15.0, 180.0, 10.0, 20.0, 120.0, 20.0, 170.0, 80.0, 40.0, 60.0, 40.0, 20.0, 30.0, 0.0, 200.0, 110.0, 40.0, 50.0, 20.0, 50.0, 60.0, 210.0, 220.0, 30.0, 60.0, 250.0, -70.0, 60.0, 200.0, 190.0, 80.0, 190.0, 70.0, 90.0, 40.0, 120.0, 80.0, -90.0, 150.0, 200.0, 40.0, 330.0, 40.0, 20.0, 90.0, -170.0, 20.0, 0.0, 190.0, 5.0, -110.0, 10.0, 30.0, 140.0, 0.0, 140.0, 100.0, 300.0, 10.0, 20.0, 210.0, 620.0, 170.0, 25.0, 220.0, 190.0, -40.0, 0.0, 140.0, 350.0, 170.0, 260.0, 40.0, 150.0, 300.0, 30.0, 10.0, 20.0, 30.0, 50.0, 80.0, 40.0, 110.0, 280.0, 250.0, 20.0, 210.0, 210.0, 400.0, 120.0, 90.0, 130.0, 30.0, 190.0, 240.0, 80.0, 670.0, 170.0, 40.0, 100.0, 110.0, 190.0, 100.0, 130.0, 230.0, 290.0, 60.0, 30.0, 240.0, 160.0, 30.0, 80.0, 100.0, 280.0, 30.0, 140.0, 90.0, 20.0, 280.0, 75.0, 90.0, 300.0, 40.0, 30.0, 0.0, 180.0, 10.0, 0.0, 30.0, 40.0, 20.0, 45.0, 60.0, 40.0, 50.0, 400.0, 20.0, 50.0, 160.0, 0.0, 0.0, 40.0, 50.0, 450.0, 30.0, 160.0, 20.0, 85.0, 80.0, 270.0, 70.0, 270.0, 20.0, 370.0, 20.0, 50.0, 170.0, 100.0, 110.0, 80.0, 180.0, 30.0, 0.0, 60.0, 90.0, 25.0, 180.0, 100.0, 330.0, 10.0, 10.0, 60.0, 120.0, 80.0, 90.0, 10.0, 90.0, 20.0, 520.0, 150.0, 90.0, 210.0, 90.0, 80.0, 170.0, 90.0, 80.0, -30.0, 290.0, 70.0, 70.0, 10.0, 30.0, 190.0, 10.0, 50.0, 340.0, 50.0, 40.0, 140.0, 150.0, 380.0, 20.0, 100.0, 150.0, 60.0, 110.0, 210.0, 30.0, 240.0, 340.0, 110.0, 110.0, 330.0, 100.0, 270.0, 260.0, 35.0, 190.0, 50.0, -5.0, 70.0, 120.0, 30.0, 100.0, 200.0, 40.0, 70.0, 120.0, 80.0, 110.0, 90.0, 80.0, 30.0, 30.0, 160.0, 50.0, 270.0, 170.0, 80.0, 80.0, 60.0, 120.0, 50.0, 40.0, 20.0, 50.0, 160.0, 210.0, 390.0, 10.0, 50.0, 260.0, 100.0, 40.0, 30.0, 140.0, 815.0, 100.0, 50.0, 180.0, 120.0, 30.0, 60.0, 30.0, 280.0, 20.0, 180.0, 30.0, 30.0, 70.0, 20.0, 80.0, 290.0, 90.0, 70.0, 35.0, 220.0, 360.0, 40.0, 60.0, 150.0, 140.0, 50.0, -40.0, 60.0, 170.0, 0.0, 30.0, 170.0, 240.0, 460.0, 120.0, 90.0, 10.0, 70.0, 190.0, 120.0, -170.0, 0.0, 630.0, 290.0, 10.0, 470.0, 100.0, 10.0, 40.0, 30.0, 140.0, 20.0, 40.0, 260.0, 10.0, 80.0, 20.0, 90.0, 0.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 60.0, 180.0, 120.0, 60.0, 60.0, 30.0, 40.0, 160.0, 330.0, 30.0, 150.0, 70.0, 20.0, 30.0, 15.0, 80.0, 170.0, 290.0, 20.0, 10.0, 30.0, 30.0, 30.0, 175.0, 10.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 130.0, 130.0, 480.0, 170.0, 30.0, 20.0, 20.0, 50.0, 310.0, 30.0, 130.0, 20.0, 360.0, 160.0, 100.0, 140.0, 130.0, 50.0, 420.0, 90.0, 150.0, 40.0, 60.0, 140.0, 50.0, 190.0, 90.0, 50.0, 20.0, 310.0, 40.0, 130.0, 440.0, 120.0, 100.0, 190.0, 180.0, 30.0, 140.0, 40.0, 110.0, 170.0, 40.0, 20.0, 20.0, 10.0, 0.0, 180.0, 50.0, 170.0, 40.0, 0.0, 40.0, 10.0, 30.0, 270.0, 60.0, 10.0, -75.0, -30.0, 90.0, 130.0, 90.0, -35.0, -60.0, 80.0, -20.0, -60.0, 20.0, 40.0, 280.0, 40.0, 70.0, 20.0, 20.0, 100.0, 10.0, 20.0, 100.0, 40.0, 190.0, -170.0, 140.0, 130.0, 20.0, 320.0, -55.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6740581855115042, "mean_inference_ms": 1.5018246498135432, "mean_action_processing_ms": 0.42553110352458007, "mean_env_wait_ms": 1.3517479747300778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01383066177368164, "StateBufferConnector_ms": 0.010248184204101562, "ViewRequirementAgentConnector_ms": 0.4229154586791992}, "num_episodes": 23, "episode_return_max": 2185.0, "episode_return_min": -190.0, "episode_return_mean": 1104.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.130763790762682, "num_env_steps_trained_throughput_per_sec": 19.130763790762682, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 4600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4600000, "timers": {"training_iteration_time_ms": 209301.814, "restore_workers_time_ms": 0.014, "training_step_time_ms": 209301.77, "sample_time_ms": 2686.655, "learn_time_ms": 206592.762, "learn_throughput": 19.362, "synch_weights_time_ms": 12.41}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "done": false, "training_iteration": 115, "trial_id": "aa996_00000", "date": "2024-05-24_05-25-40", "timestamp": 1716542740, "time_this_iter_s": 209.09539794921875, "time_total_s": 24006.825733423233, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160a85b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24006.825733423233, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 18.987837837837837, "ram_util_percent": 78.44527027027027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7547141343450394, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00790046079124446, "vf_loss": 6.845352675841132, "vf_explained_var": 0.001164452241251644, "kl": Infinity, "entropy": 0.29880024212014816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1084545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "env_runners": {"episode_reward_max": 1920.0, "episode_reward_min": 70.0, "episode_reward_mean": 1065.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -430.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 106.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [880.0, 1010.0, 1920.0, 1360.0, 1655.0, 810.0, 1140.0, 1420.0, 1230.0, 970.0, 1090.0, 1170.0, 1235.0, 555.0, 900.0, 1575.0, 1650.0, 540.0, 890.0, 1720.0, 1440.0, 500.0, 540.0, 1300.0, 1050.0, 580.0, 1270.0, 690.0, 1310.0, 1310.0, 1010.0, 615.0, 910.0, 1640.0, 960.0, 1720.0, 730.0, 1175.0, 580.0, 770.0, 1210.0, 1030.0, 95.0, 1570.0, 1485.0, 750.0, 1820.0, 1820.0, 1350.0, 1405.0, 395.0, 820.0, 1485.0, 1130.0, 865.0, 1380.0, 920.0, 1380.0, 1370.0, 1410.0, 960.0, 1010.0, 1100.0, 1835.0, 750.0, 1395.0, 1280.0, 1350.0, 1120.0, 410.0, 1070.0, 875.0, 365.0, 1090.0, 1430.0, 1280.0, 1560.0, 730.0, 680.0, 110.0, 620.0, 805.0, 1310.0, 1230.0, 920.0, 1210.0, 1250.0, 1050.0, 415.0, 630.0, 590.0, 70.0, 930.0, 1040.0, 950.0, 555.0, 1390.0, 1310.0, 980.0, 1390.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 290.0, 70.0, 80.0, 170.0, 100.0, 10.0, 120.0, 20.0, 20.0, 110.0, -10.0, 80.0, 10.0, 60.0, 230.0, 70.0, 420.0, 20.0, 180.0, 110.0, 170.0, 40.0, 100.0, 90.0, 350.0, 330.0, 380.0, 170.0, 60.0, 280.0, 40.0, 70.0, 410.0, 160.0, 180.0, 90.0, 60.0, 10.0, 90.0, 50.0, 210.0, 30.0, 170.0, 520.0, 55.0, 70.0, 140.0, 320.0, 40.0, 20.0, 240.0, 50.0, 30.0, 100.0, 50.0, 130.0, 20.0, 130.0, 110.0, 40.0, 40.0, 220.0, 60.0, 80.0, 70.0, 420.0, 90.0, 10.0, 40.0, 220.0, 470.0, 230.0, 40.0, 100.0, 80.0, 60.0, 70.0, 110.0, 70.0, 60.0, 90.0, 30.0, 300.0, 80.0, 310.0, 210.0, 10.0, 70.0, 170.0, 280.0, 50.0, 60.0, 70.0, 170.0, 80.0, 30.0, 30.0, 30.0, 70.0, 50.0, 30.0, 90.0, 200.0, 400.0, 110.0, 90.0, 40.0, 10.0, 40.0, 30.0, 120.0, 160.0, 170.0, 110.0, 180.0, 50.0, 170.0, 140.0, 0.0, 400.0, 90.0, 80.0, 100.0, 180.0, 55.0, 170.0, 90.0, 70.0, 100.0, 0.0, -5.0, 60.0, 0.0, 20.0, -15.0, 15.0, 220.0, 160.0, 0.0, 340.0, 80.0, 50.0, 40.0, 50.0, 0.0, 110.0, 180.0, 50.0, 190.0, 40.0, 170.0, 40.0, 450.0, -10.0, 60.0, 20.0, 560.0, 55.0, 80.0, 180.0, 50.0, 280.0, 30.0, 130.0, 530.0, 90.0, 190.0, 90.0, -30.0, 0.0, 0.0, 0.0, 160.0, 90.0, 190.0, 0.0, 110.0, 20.0, 10.0, 10.0, 80.0, 10.0, 160.0, 30.0, 180.0, 130.0, 90.0, 190.0, 130.0, -60.0, 320.0, 120.0, 60.0, 150.0, 20.0, 100.0, 850.0, 30.0, 250.0, 50.0, 170.0, 70.0, 100.0, 510.0, 130.0, 0.0, 130.0, 30.0, 20.0, 10.0, 150.0, 50.0, 120.0, 0.0, 0.0, 70.0, 40.0, 40.0, 10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 40.0, 100.0, 180.0, 10.0, 180.0, 190.0, 70.0, 50.0, 140.0, 130.0, 270.0, 70.0, 140.0, 60.0, -430.0, 30.0, 70.0, 410.0, 220.0, 80.0, 40.0, 290.0, 100.0, 240.0, 40.0, 40.0, 50.0, 440.0, 60.0, -370.0, 30.0, 190.0, 90.0, 10.0, 110.0, -20.0, 0.0, -90.0, 80.0, 140.0, 30.0, 980.0, 20.0, 20.0, 0.0, 0.0, 50.0, 320.0, 70.0, 170.0, 40.0, 30.0, 10.0, 0.0, 130.0, 100.0, 240.0, 50.0, 130.0, 20.0, 280.0, 60.0, 80.0, 220.0, 100.0, 210.0, 170.0, 160.0, 20.0, 80.0, 260.0, -10.0, 50.0, 270.0, 90.0, 100.0, 320.0, 80.0, -10.0, 150.0, 0.0, 0.0, 30.0, 250.0, 40.0, 40.0, -20.0, -5.0, 360.0, 0.0, 40.0, 110.0, 10.0, 40.0, 160.0, 20.0, 20.0, 50.0, 60.0, 380.0, 0.0, 190.0, 20.0, 10.0, 20.0, 40.0, 350.0, 100.0, 250.0, 130.0, 90.0, 310.0, 200.0, 150.0, 200.0, 15.0, 10.0, 60.0, 80.0, 80.0, 380.0, 5.0, 120.0, 10.0, 150.0, 170.0, 530.0, -10.0, 410.0, 80.0, 130.0, 310.0, -10.0, -40.0, 310.0, 30.0, 220.0, 10.0, 30.0, 10.0, 40.0, 40.0, 30.0, 10.0, 170.0, 190.0, 80.0, 350.0, -10.0, 60.0, 70.0, 100.0, -15.0, 180.0, 10.0, 20.0, 120.0, 20.0, 170.0, 80.0, 40.0, 60.0, 40.0, 20.0, 30.0, 0.0, 200.0, 110.0, 40.0, 50.0, 20.0, 50.0, 60.0, 210.0, 220.0, 30.0, 60.0, 250.0, -70.0, 60.0, 200.0, 190.0, 80.0, 190.0, 70.0, 90.0, 40.0, 120.0, 80.0, -90.0, 150.0, 200.0, 40.0, 330.0, 40.0, 20.0, 90.0, -170.0, 20.0, 0.0, 190.0, 5.0, -110.0, 10.0, 30.0, 140.0, 0.0, 140.0, 100.0, 300.0, 10.0, 20.0, 210.0, 620.0, 170.0, 25.0, 220.0, 190.0, -40.0, 0.0, 140.0, 350.0, 170.0, 260.0, 40.0, 150.0, 300.0, 30.0, 10.0, 20.0, 30.0, 50.0, 80.0, 40.0, 110.0, 280.0, 250.0, 20.0, 210.0, 210.0, 400.0, 120.0, 90.0, 130.0, 30.0, 190.0, 240.0, 80.0, 670.0, 170.0, 40.0, 100.0, 110.0, 190.0, 100.0, 130.0, 230.0, 290.0, 60.0, 30.0, 240.0, 160.0, 30.0, 80.0, 100.0, 280.0, 30.0, 140.0, 90.0, 20.0, 280.0, 75.0, 90.0, 300.0, 40.0, 30.0, 0.0, 180.0, 10.0, 0.0, 30.0, 40.0, 20.0, 45.0, 60.0, 40.0, 50.0, 400.0, 20.0, 50.0, 160.0, 0.0, 0.0, 40.0, 50.0, 450.0, 30.0, 160.0, 20.0, 85.0, 80.0, 270.0, 70.0, 270.0, 20.0, 370.0, 20.0, 50.0, 170.0, 100.0, 110.0, 80.0, 180.0, 30.0, 0.0, 60.0, 90.0, 25.0, 180.0, 100.0, 330.0, 10.0, 10.0, 60.0, 120.0, 80.0, 90.0, 10.0, 90.0, 20.0, 520.0, 150.0, 90.0, 210.0, 90.0, 80.0, 170.0, 90.0, 80.0, -30.0, 290.0, 70.0, 70.0, 10.0, 30.0, 190.0, 10.0, 50.0, 340.0, 50.0, 40.0, 140.0, 150.0, 380.0, 20.0, 100.0, 150.0, 60.0, 110.0, 210.0, 30.0, 240.0, 340.0, 110.0, 110.0, 330.0, 100.0, 270.0, 260.0, 35.0, 190.0, 50.0, -5.0, 70.0, 120.0, 30.0, 100.0, 200.0, 40.0, 70.0, 120.0, 80.0, 110.0, 90.0, 80.0, 30.0, 30.0, 160.0, 50.0, 270.0, 170.0, 80.0, 80.0, 60.0, 120.0, 50.0, 40.0, 20.0, 50.0, 160.0, 210.0, 390.0, 10.0, 50.0, 260.0, 100.0, 40.0, 30.0, 140.0, 815.0, 100.0, 50.0, 180.0, 120.0, 30.0, 60.0, 30.0, 280.0, 20.0, 180.0, 30.0, 30.0, 70.0, 20.0, 80.0, 290.0, 90.0, 70.0, 35.0, 220.0, 360.0, 40.0, 60.0, 150.0, 140.0, 50.0, -40.0, 60.0, 170.0, 0.0, 30.0, 170.0, 240.0, 460.0, 120.0, 90.0, 10.0, 70.0, 190.0, 120.0, -170.0, 0.0, 630.0, 290.0, 10.0, 470.0, 100.0, 10.0, 40.0, 30.0, 140.0, 20.0, 40.0, 260.0, 10.0, 80.0, 20.0, 90.0, 0.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 60.0, 180.0, 120.0, 60.0, 60.0, 30.0, 40.0, 160.0, 330.0, 30.0, 150.0, 70.0, 20.0, 30.0, 15.0, 80.0, 170.0, 290.0, 20.0, 10.0, 30.0, 30.0, 30.0, 175.0, 10.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 130.0, 130.0, 480.0, 170.0, 30.0, 20.0, 20.0, 50.0, 310.0, 30.0, 130.0, 20.0, 360.0, 160.0, 100.0, 140.0, 130.0, 50.0, 420.0, 90.0, 150.0, 40.0, 60.0, 140.0, 50.0, 190.0, 90.0, 50.0, 20.0, 310.0, 40.0, 130.0, 440.0, 120.0, 100.0, 190.0, 180.0, 30.0, 140.0, 40.0, 110.0, 170.0, 40.0, 20.0, 20.0, 10.0, 0.0, 180.0, 50.0, 170.0, 40.0, 0.0, 40.0, 10.0, 30.0, 270.0, 60.0, 10.0, -75.0, -30.0, 90.0, 130.0, 90.0, -35.0, -60.0, 80.0, -20.0, -60.0, 20.0, 40.0, 280.0, 40.0, 70.0, 20.0, 20.0, 100.0, 10.0, 20.0, 100.0, 40.0, 190.0, -170.0, 140.0, 130.0, 20.0, 320.0, -55.0, 90.0, 80.0, 260.0, 130.0, 50.0, 90.0, 90.0, 320.0, 80.0, 70.0, 140.0, 90.0, 250.0, 110.0, 60.0, 130.0, 90.0, 50.0, 140.0, 80.0, 230.0, 100.0, 10.0, 340.0, 30.0, -20.0, 110.0, 470.0, 60.0, 20.0, -200.0, 310.0, 50.0, 240.0, 90.0, 60.0, 90.0, 190.0, 40.0, 120.0, 20.0, 290.0, 30.0, 120.0, 60.0, 190.0, 120.0, 300.0, 20.0, 40.0, 80.0, 0.0, 370.0, 20.0, 180.0, 80.0, 270.0, 100.0, 60.0, -60.0, 30.0, 30.0, 0.0, 0.0, 20.0, 10.0, 210.0, 30.0, 25.0, 40.0, 50.0, 50.0, 170.0, 20.0, 100.0, 10.0, 30.0, 0.0, 190.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 60.0, 30.0, 350.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 250.0, 210.0, 10.0, 10.0, 20.0, 60.0, 10.0, 220.0, 110.0, 40.0, 170.0, 260.0, 360.0, 30.0, 15.0, 20.0, 70.0, 40.0, 35.0, 140.0, 30.0, 20.0, 460.0, 80.0, 30.0, 20.0, 100.0, 30.0, 40.0, 60.0, 60.0, 160.0, 20.0, 100.0, 30.0, 30.0, 0.0, 5.0, 90.0, 230.0, 110.0, 160.0, 20.0, 140.0, 30.0, 30.0, 510.0, 80.0, 80.0, 100.0, 220.0, 20.0, 150.0, 90.0, 80.0, 50.0, 60.0, 370.0, 170.0, 60.0, 50.0, 10.0, 250.0, 30.0, 100.0, 160.0, 110.0, 20.0, 190.0, 200.0, 10.0, -40.0, 60.0, 270.0, 30.0, 280.0, -60.0, 560.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6725424677168557, "mean_inference_ms": 1.5036377805950993, "mean_action_processing_ms": 0.42530079181844227, "mean_env_wait_ms": 1.3502181268685445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012782096862792969, "StateBufferConnector_ms": 0.013935327529907227, "ViewRequirementAgentConnector_ms": 0.45648765563964844}, "num_episodes": 18, "episode_return_max": 1920.0, "episode_return_min": 70.0, "episode_return_mean": 1065.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.203864896486646, "num_env_steps_trained_throughput_per_sec": 19.203864896486646, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 4640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4640000, "timers": {"training_iteration_time_ms": 209278.362, "restore_workers_time_ms": 0.014, "training_step_time_ms": 209278.318, "sample_time_ms": 2688.388, "learn_time_ms": 206567.929, "learn_throughput": 19.364, "synch_weights_time_ms": 12.301}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "done": false, "training_iteration": 116, "trial_id": "aa996_00000", "date": "2024-05-24_05-29-09", "timestamp": 1716542949, "time_this_iter_s": 208.30482506752014, "time_total_s": 24215.130558490753, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160075ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24215.130558490753, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 18.618707482993194, "ram_util_percent": 78.77925170068026}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.835172335814617, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007157615324754081, "vf_loss": 7.435584988406164, "vf_explained_var": 0.0004153654852106421, "kl": Infinity, "entropy": 0.2877499529871697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1093935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "env_runners": {"episode_reward_max": 1835.0, "episode_reward_min": 70.0, "episode_reward_mean": 1067.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -430.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 106.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [540.0, 1300.0, 1050.0, 580.0, 1270.0, 690.0, 1310.0, 1310.0, 1010.0, 615.0, 910.0, 1640.0, 960.0, 1720.0, 730.0, 1175.0, 580.0, 770.0, 1210.0, 1030.0, 95.0, 1570.0, 1485.0, 750.0, 1820.0, 1820.0, 1350.0, 1405.0, 395.0, 820.0, 1485.0, 1130.0, 865.0, 1380.0, 920.0, 1380.0, 1370.0, 1410.0, 960.0, 1010.0, 1100.0, 1835.0, 750.0, 1395.0, 1280.0, 1350.0, 1120.0, 410.0, 1070.0, 875.0, 365.0, 1090.0, 1430.0, 1280.0, 1560.0, 730.0, 680.0, 110.0, 620.0, 805.0, 1310.0, 1230.0, 920.0, 1210.0, 1250.0, 1050.0, 415.0, 630.0, 590.0, 70.0, 930.0, 1040.0, 950.0, 555.0, 1390.0, 1310.0, 980.0, 1390.0, 775.0, 870.0, 850.0, 830.0, 1540.0, 1720.0, 1560.0, 1765.0, 920.0, 1230.0, 1470.0, 1400.0, 1220.0, 880.0, 1565.0, 780.0, 770.0, 1260.0, 770.0, 700.0, 1510.0, 1470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 40.0, 100.0, 180.0, 10.0, 180.0, 190.0, 70.0, 50.0, 140.0, 130.0, 270.0, 70.0, 140.0, 60.0, -430.0, 30.0, 70.0, 410.0, 220.0, 80.0, 40.0, 290.0, 100.0, 240.0, 40.0, 40.0, 50.0, 440.0, 60.0, -370.0, 30.0, 190.0, 90.0, 10.0, 110.0, -20.0, 0.0, -90.0, 80.0, 140.0, 30.0, 980.0, 20.0, 20.0, 0.0, 0.0, 50.0, 320.0, 70.0, 170.0, 40.0, 30.0, 10.0, 0.0, 130.0, 100.0, 240.0, 50.0, 130.0, 20.0, 280.0, 60.0, 80.0, 220.0, 100.0, 210.0, 170.0, 160.0, 20.0, 80.0, 260.0, -10.0, 50.0, 270.0, 90.0, 100.0, 320.0, 80.0, -10.0, 150.0, 0.0, 0.0, 30.0, 250.0, 40.0, 40.0, -20.0, -5.0, 360.0, 0.0, 40.0, 110.0, 10.0, 40.0, 160.0, 20.0, 20.0, 50.0, 60.0, 380.0, 0.0, 190.0, 20.0, 10.0, 20.0, 40.0, 350.0, 100.0, 250.0, 130.0, 90.0, 310.0, 200.0, 150.0, 200.0, 15.0, 10.0, 60.0, 80.0, 80.0, 380.0, 5.0, 120.0, 10.0, 150.0, 170.0, 530.0, -10.0, 410.0, 80.0, 130.0, 310.0, -10.0, -40.0, 310.0, 30.0, 220.0, 10.0, 30.0, 10.0, 40.0, 40.0, 30.0, 10.0, 170.0, 190.0, 80.0, 350.0, -10.0, 60.0, 70.0, 100.0, -15.0, 180.0, 10.0, 20.0, 120.0, 20.0, 170.0, 80.0, 40.0, 60.0, 40.0, 20.0, 30.0, 0.0, 200.0, 110.0, 40.0, 50.0, 20.0, 50.0, 60.0, 210.0, 220.0, 30.0, 60.0, 250.0, -70.0, 60.0, 200.0, 190.0, 80.0, 190.0, 70.0, 90.0, 40.0, 120.0, 80.0, -90.0, 150.0, 200.0, 40.0, 330.0, 40.0, 20.0, 90.0, -170.0, 20.0, 0.0, 190.0, 5.0, -110.0, 10.0, 30.0, 140.0, 0.0, 140.0, 100.0, 300.0, 10.0, 20.0, 210.0, 620.0, 170.0, 25.0, 220.0, 190.0, -40.0, 0.0, 140.0, 350.0, 170.0, 260.0, 40.0, 150.0, 300.0, 30.0, 10.0, 20.0, 30.0, 50.0, 80.0, 40.0, 110.0, 280.0, 250.0, 20.0, 210.0, 210.0, 400.0, 120.0, 90.0, 130.0, 30.0, 190.0, 240.0, 80.0, 670.0, 170.0, 40.0, 100.0, 110.0, 190.0, 100.0, 130.0, 230.0, 290.0, 60.0, 30.0, 240.0, 160.0, 30.0, 80.0, 100.0, 280.0, 30.0, 140.0, 90.0, 20.0, 280.0, 75.0, 90.0, 300.0, 40.0, 30.0, 0.0, 180.0, 10.0, 0.0, 30.0, 40.0, 20.0, 45.0, 60.0, 40.0, 50.0, 400.0, 20.0, 50.0, 160.0, 0.0, 0.0, 40.0, 50.0, 450.0, 30.0, 160.0, 20.0, 85.0, 80.0, 270.0, 70.0, 270.0, 20.0, 370.0, 20.0, 50.0, 170.0, 100.0, 110.0, 80.0, 180.0, 30.0, 0.0, 60.0, 90.0, 25.0, 180.0, 100.0, 330.0, 10.0, 10.0, 60.0, 120.0, 80.0, 90.0, 10.0, 90.0, 20.0, 520.0, 150.0, 90.0, 210.0, 90.0, 80.0, 170.0, 90.0, 80.0, -30.0, 290.0, 70.0, 70.0, 10.0, 30.0, 190.0, 10.0, 50.0, 340.0, 50.0, 40.0, 140.0, 150.0, 380.0, 20.0, 100.0, 150.0, 60.0, 110.0, 210.0, 30.0, 240.0, 340.0, 110.0, 110.0, 330.0, 100.0, 270.0, 260.0, 35.0, 190.0, 50.0, -5.0, 70.0, 120.0, 30.0, 100.0, 200.0, 40.0, 70.0, 120.0, 80.0, 110.0, 90.0, 80.0, 30.0, 30.0, 160.0, 50.0, 270.0, 170.0, 80.0, 80.0, 60.0, 120.0, 50.0, 40.0, 20.0, 50.0, 160.0, 210.0, 390.0, 10.0, 50.0, 260.0, 100.0, 40.0, 30.0, 140.0, 815.0, 100.0, 50.0, 180.0, 120.0, 30.0, 60.0, 30.0, 280.0, 20.0, 180.0, 30.0, 30.0, 70.0, 20.0, 80.0, 290.0, 90.0, 70.0, 35.0, 220.0, 360.0, 40.0, 60.0, 150.0, 140.0, 50.0, -40.0, 60.0, 170.0, 0.0, 30.0, 170.0, 240.0, 460.0, 120.0, 90.0, 10.0, 70.0, 190.0, 120.0, -170.0, 0.0, 630.0, 290.0, 10.0, 470.0, 100.0, 10.0, 40.0, 30.0, 140.0, 20.0, 40.0, 260.0, 10.0, 80.0, 20.0, 90.0, 0.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 60.0, 180.0, 120.0, 60.0, 60.0, 30.0, 40.0, 160.0, 330.0, 30.0, 150.0, 70.0, 20.0, 30.0, 15.0, 80.0, 170.0, 290.0, 20.0, 10.0, 30.0, 30.0, 30.0, 175.0, 10.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 130.0, 130.0, 480.0, 170.0, 30.0, 20.0, 20.0, 50.0, 310.0, 30.0, 130.0, 20.0, 360.0, 160.0, 100.0, 140.0, 130.0, 50.0, 420.0, 90.0, 150.0, 40.0, 60.0, 140.0, 50.0, 190.0, 90.0, 50.0, 20.0, 310.0, 40.0, 130.0, 440.0, 120.0, 100.0, 190.0, 180.0, 30.0, 140.0, 40.0, 110.0, 170.0, 40.0, 20.0, 20.0, 10.0, 0.0, 180.0, 50.0, 170.0, 40.0, 0.0, 40.0, 10.0, 30.0, 270.0, 60.0, 10.0, -75.0, -30.0, 90.0, 130.0, 90.0, -35.0, -60.0, 80.0, -20.0, -60.0, 20.0, 40.0, 280.0, 40.0, 70.0, 20.0, 20.0, 100.0, 10.0, 20.0, 100.0, 40.0, 190.0, -170.0, 140.0, 130.0, 20.0, 320.0, -55.0, 90.0, 80.0, 260.0, 130.0, 50.0, 90.0, 90.0, 320.0, 80.0, 70.0, 140.0, 90.0, 250.0, 110.0, 60.0, 130.0, 90.0, 50.0, 140.0, 80.0, 230.0, 100.0, 10.0, 340.0, 30.0, -20.0, 110.0, 470.0, 60.0, 20.0, -200.0, 310.0, 50.0, 240.0, 90.0, 60.0, 90.0, 190.0, 40.0, 120.0, 20.0, 290.0, 30.0, 120.0, 60.0, 190.0, 120.0, 300.0, 20.0, 40.0, 80.0, 0.0, 370.0, 20.0, 180.0, 80.0, 270.0, 100.0, 60.0, -60.0, 30.0, 30.0, 0.0, 0.0, 20.0, 10.0, 210.0, 30.0, 25.0, 40.0, 50.0, 50.0, 170.0, 20.0, 100.0, 10.0, 30.0, 0.0, 190.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 60.0, 30.0, 350.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 250.0, 210.0, 10.0, 10.0, 20.0, 60.0, 10.0, 220.0, 110.0, 40.0, 170.0, 260.0, 360.0, 30.0, 15.0, 20.0, 70.0, 40.0, 35.0, 140.0, 30.0, 20.0, 460.0, 80.0, 30.0, 20.0, 100.0, 30.0, 40.0, 60.0, 60.0, 160.0, 20.0, 100.0, 30.0, 30.0, 0.0, 5.0, 90.0, 230.0, 110.0, 160.0, 20.0, 140.0, 30.0, 30.0, 510.0, 80.0, 80.0, 100.0, 220.0, 20.0, 150.0, 90.0, 80.0, 50.0, 60.0, 370.0, 170.0, 60.0, 50.0, 10.0, 250.0, 30.0, 100.0, 160.0, 110.0, 20.0, 190.0, 200.0, 10.0, -40.0, 60.0, 270.0, 30.0, 280.0, -60.0, 560.0, 80.0, 40.0, 80.0, 50.0, 30.0, 15.0, 30.0, 60.0, 70.0, 90.0, 310.0, 20.0, 140.0, 20.0, 390.0, 30.0, 40.0, 40.0, 50.0, 100.0, 40.0, 30.0, 80.0, 360.0, 20.0, 120.0, 20.0, 0.0, 0.0, 190.0, 30.0, 200.0, 60.0, 180.0, 0.0, 30.0, 40.0, 40.0, 10.0, 70.0, 200.0, 30.0, 210.0, 90.0, 230.0, 60.0, 160.0, 150.0, 0.0, 410.0, 200.0, 200.0, 110.0, 60.0, 240.0, 100.0, 610.0, 20.0, 90.0, 40.0, 250.0, 510.0, 80.0, 40.0, 70.0, 110.0, 10.0, 170.0, 300.0, 100.0, 170.0, 80.0, 190.0, 70.0, 50.0, -15.0, 460.0, 70.0, 330.0, 190.0, 340.0, 20.0, 0.0, 490.0, 40.0, 90.0, 130.0, 65.0, -95.0, 110.0, 70.0, 160.0, 100.0, 130.0, 75.0, 120.0, 45.0, 200.0, 60.0, 220.0, 120.0, 130.0, 170.0, 110.0, 70.0, 390.0, -10.0, 80.0, 40.0, 430.0, 60.0, 180.0, 140.0, 140.0, 400.0, 80.0, 70.0, 220.0, 10.0, 130.0, 30.0, 140.0, 180.0, -20.0, 210.0, -160.0, -90.0, 50.0, 150.0, 240.0, 520.0, 30.0, 60.0, -35.0, -30.0, 15.0, 200.0, 30.0, 540.0, 80.0, -10.0, 280.0, -30.0, 200.0, 440.0, 60.0, 80.0, 230.0, 100.0, 80.0, 125.0, 40.0, 110.0, 20.0, 190.0, 110.0, 0.0, 30.0, 210.0, 40.0, 30.0, 0.0, 240.0, 80.0, 230.0, 10.0, 70.0, 30.0, 60.0, 20.0, 30.0, 160.0, 390.0, 40.0, 50.0, 110.0, 10.0, 110.0, 200.0, 150.0, 40.0, 0.0, 40.0, 70.0, 80.0, 20.0, 170.0, 150.0, 160.0, 20.0, 60.0, 70.0, 0.0, 20.0, 0.0, 120.0, 110.0, 0.0, 70.0, 290.0, 20.0, 80.0, 40.0, 60.0, 510.0, 20.0, 120.0, 90.0, 500.0, 70.0, 20.0, 120.0, 60.0, 190.0, 100.0, 185.0, 50.0, 110.0, 310.0, 25.0, 320.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6735809293816755, "mean_inference_ms": 1.5050833867765465, "mean_action_processing_ms": 0.4253816216630071, "mean_env_wait_ms": 1.3489010670745167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012546062469482422, "StateBufferConnector_ms": 0.013937234878540039, "ViewRequirementAgentConnector_ms": 0.4419417381286621}, "num_episodes": 22, "episode_return_max": 1835.0, "episode_return_min": 70.0, "episode_return_mean": 1067.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.13752550331606, "num_env_steps_trained_throughput_per_sec": 19.13752550331606, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 4680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4680000, "timers": {"training_iteration_time_ms": 209142.689, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209142.645, "sample_time_ms": 2681.513, "learn_time_ms": 206440.375, "learn_throughput": 19.376, "synch_weights_time_ms": 12.372}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "done": false, "training_iteration": 117, "trial_id": "aa996_00000", "date": "2024-05-24_05-32-38", "timestamp": 1716543158, "time_this_iter_s": 209.0221881866455, "time_total_s": 24424.1527466774, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x16003ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24424.1527466774, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 19.550337837837837, "ram_util_percent": 79.13952702702704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.05879892862389, "cur_kl_coeff": 0.72081298828125, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007224703520086135, "vf_loss": 7.110549055603238, "vf_explained_var": -0.0011157389964285497, "kl": Infinity, "entropy": 0.29868064525282295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1103325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "env_runners": {"episode_reward_max": 2010.0, "episode_reward_min": -75.0, "episode_reward_mean": 1072.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 815.0}, "policy_reward_mean": {"policy_0": 107.245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1210.0, 1030.0, 95.0, 1570.0, 1485.0, 750.0, 1820.0, 1820.0, 1350.0, 1405.0, 395.0, 820.0, 1485.0, 1130.0, 865.0, 1380.0, 920.0, 1380.0, 1370.0, 1410.0, 960.0, 1010.0, 1100.0, 1835.0, 750.0, 1395.0, 1280.0, 1350.0, 1120.0, 410.0, 1070.0, 875.0, 365.0, 1090.0, 1430.0, 1280.0, 1560.0, 730.0, 680.0, 110.0, 620.0, 805.0, 1310.0, 1230.0, 920.0, 1210.0, 1250.0, 1050.0, 415.0, 630.0, 590.0, 70.0, 930.0, 1040.0, 950.0, 555.0, 1390.0, 1310.0, 980.0, 1390.0, 775.0, 870.0, 850.0, 830.0, 1540.0, 1720.0, 1560.0, 1765.0, 920.0, 1230.0, 1470.0, 1400.0, 1220.0, 880.0, 1565.0, 780.0, 770.0, 1260.0, 770.0, 700.0, 1510.0, 1470.0, 630.0, 1075.0, 1180.0, 1305.0, 810.0, 2010.0, 1280.0, 1365.0, 1370.0, 1210.0, -75.0, 930.0, 960.0, 1370.0, 320.0, 570.0, 1265.0, 1080.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [220.0, 30.0, 60.0, 250.0, -70.0, 60.0, 200.0, 190.0, 80.0, 190.0, 70.0, 90.0, 40.0, 120.0, 80.0, -90.0, 150.0, 200.0, 40.0, 330.0, 40.0, 20.0, 90.0, -170.0, 20.0, 0.0, 190.0, 5.0, -110.0, 10.0, 30.0, 140.0, 0.0, 140.0, 100.0, 300.0, 10.0, 20.0, 210.0, 620.0, 170.0, 25.0, 220.0, 190.0, -40.0, 0.0, 140.0, 350.0, 170.0, 260.0, 40.0, 150.0, 300.0, 30.0, 10.0, 20.0, 30.0, 50.0, 80.0, 40.0, 110.0, 280.0, 250.0, 20.0, 210.0, 210.0, 400.0, 120.0, 90.0, 130.0, 30.0, 190.0, 240.0, 80.0, 670.0, 170.0, 40.0, 100.0, 110.0, 190.0, 100.0, 130.0, 230.0, 290.0, 60.0, 30.0, 240.0, 160.0, 30.0, 80.0, 100.0, 280.0, 30.0, 140.0, 90.0, 20.0, 280.0, 75.0, 90.0, 300.0, 40.0, 30.0, 0.0, 180.0, 10.0, 0.0, 30.0, 40.0, 20.0, 45.0, 60.0, 40.0, 50.0, 400.0, 20.0, 50.0, 160.0, 0.0, 0.0, 40.0, 50.0, 450.0, 30.0, 160.0, 20.0, 85.0, 80.0, 270.0, 70.0, 270.0, 20.0, 370.0, 20.0, 50.0, 170.0, 100.0, 110.0, 80.0, 180.0, 30.0, 0.0, 60.0, 90.0, 25.0, 180.0, 100.0, 330.0, 10.0, 10.0, 60.0, 120.0, 80.0, 90.0, 10.0, 90.0, 20.0, 520.0, 150.0, 90.0, 210.0, 90.0, 80.0, 170.0, 90.0, 80.0, -30.0, 290.0, 70.0, 70.0, 10.0, 30.0, 190.0, 10.0, 50.0, 340.0, 50.0, 40.0, 140.0, 150.0, 380.0, 20.0, 100.0, 150.0, 60.0, 110.0, 210.0, 30.0, 240.0, 340.0, 110.0, 110.0, 330.0, 100.0, 270.0, 260.0, 35.0, 190.0, 50.0, -5.0, 70.0, 120.0, 30.0, 100.0, 200.0, 40.0, 70.0, 120.0, 80.0, 110.0, 90.0, 80.0, 30.0, 30.0, 160.0, 50.0, 270.0, 170.0, 80.0, 80.0, 60.0, 120.0, 50.0, 40.0, 20.0, 50.0, 160.0, 210.0, 390.0, 10.0, 50.0, 260.0, 100.0, 40.0, 30.0, 140.0, 815.0, 100.0, 50.0, 180.0, 120.0, 30.0, 60.0, 30.0, 280.0, 20.0, 180.0, 30.0, 30.0, 70.0, 20.0, 80.0, 290.0, 90.0, 70.0, 35.0, 220.0, 360.0, 40.0, 60.0, 150.0, 140.0, 50.0, -40.0, 60.0, 170.0, 0.0, 30.0, 170.0, 240.0, 460.0, 120.0, 90.0, 10.0, 70.0, 190.0, 120.0, -170.0, 0.0, 630.0, 290.0, 10.0, 470.0, 100.0, 10.0, 40.0, 30.0, 140.0, 20.0, 40.0, 260.0, 10.0, 80.0, 20.0, 90.0, 0.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 60.0, 180.0, 120.0, 60.0, 60.0, 30.0, 40.0, 160.0, 330.0, 30.0, 150.0, 70.0, 20.0, 30.0, 15.0, 80.0, 170.0, 290.0, 20.0, 10.0, 30.0, 30.0, 30.0, 175.0, 10.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 130.0, 130.0, 480.0, 170.0, 30.0, 20.0, 20.0, 50.0, 310.0, 30.0, 130.0, 20.0, 360.0, 160.0, 100.0, 140.0, 130.0, 50.0, 420.0, 90.0, 150.0, 40.0, 60.0, 140.0, 50.0, 190.0, 90.0, 50.0, 20.0, 310.0, 40.0, 130.0, 440.0, 120.0, 100.0, 190.0, 180.0, 30.0, 140.0, 40.0, 110.0, 170.0, 40.0, 20.0, 20.0, 10.0, 0.0, 180.0, 50.0, 170.0, 40.0, 0.0, 40.0, 10.0, 30.0, 270.0, 60.0, 10.0, -75.0, -30.0, 90.0, 130.0, 90.0, -35.0, -60.0, 80.0, -20.0, -60.0, 20.0, 40.0, 280.0, 40.0, 70.0, 20.0, 20.0, 100.0, 10.0, 20.0, 100.0, 40.0, 190.0, -170.0, 140.0, 130.0, 20.0, 320.0, -55.0, 90.0, 80.0, 260.0, 130.0, 50.0, 90.0, 90.0, 320.0, 80.0, 70.0, 140.0, 90.0, 250.0, 110.0, 60.0, 130.0, 90.0, 50.0, 140.0, 80.0, 230.0, 100.0, 10.0, 340.0, 30.0, -20.0, 110.0, 470.0, 60.0, 20.0, -200.0, 310.0, 50.0, 240.0, 90.0, 60.0, 90.0, 190.0, 40.0, 120.0, 20.0, 290.0, 30.0, 120.0, 60.0, 190.0, 120.0, 300.0, 20.0, 40.0, 80.0, 0.0, 370.0, 20.0, 180.0, 80.0, 270.0, 100.0, 60.0, -60.0, 30.0, 30.0, 0.0, 0.0, 20.0, 10.0, 210.0, 30.0, 25.0, 40.0, 50.0, 50.0, 170.0, 20.0, 100.0, 10.0, 30.0, 0.0, 190.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 60.0, 30.0, 350.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 250.0, 210.0, 10.0, 10.0, 20.0, 60.0, 10.0, 220.0, 110.0, 40.0, 170.0, 260.0, 360.0, 30.0, 15.0, 20.0, 70.0, 40.0, 35.0, 140.0, 30.0, 20.0, 460.0, 80.0, 30.0, 20.0, 100.0, 30.0, 40.0, 60.0, 60.0, 160.0, 20.0, 100.0, 30.0, 30.0, 0.0, 5.0, 90.0, 230.0, 110.0, 160.0, 20.0, 140.0, 30.0, 30.0, 510.0, 80.0, 80.0, 100.0, 220.0, 20.0, 150.0, 90.0, 80.0, 50.0, 60.0, 370.0, 170.0, 60.0, 50.0, 10.0, 250.0, 30.0, 100.0, 160.0, 110.0, 20.0, 190.0, 200.0, 10.0, -40.0, 60.0, 270.0, 30.0, 280.0, -60.0, 560.0, 80.0, 40.0, 80.0, 50.0, 30.0, 15.0, 30.0, 60.0, 70.0, 90.0, 310.0, 20.0, 140.0, 20.0, 390.0, 30.0, 40.0, 40.0, 50.0, 100.0, 40.0, 30.0, 80.0, 360.0, 20.0, 120.0, 20.0, 0.0, 0.0, 190.0, 30.0, 200.0, 60.0, 180.0, 0.0, 30.0, 40.0, 40.0, 10.0, 70.0, 200.0, 30.0, 210.0, 90.0, 230.0, 60.0, 160.0, 150.0, 0.0, 410.0, 200.0, 200.0, 110.0, 60.0, 240.0, 100.0, 610.0, 20.0, 90.0, 40.0, 250.0, 510.0, 80.0, 40.0, 70.0, 110.0, 10.0, 170.0, 300.0, 100.0, 170.0, 80.0, 190.0, 70.0, 50.0, -15.0, 460.0, 70.0, 330.0, 190.0, 340.0, 20.0, 0.0, 490.0, 40.0, 90.0, 130.0, 65.0, -95.0, 110.0, 70.0, 160.0, 100.0, 130.0, 75.0, 120.0, 45.0, 200.0, 60.0, 220.0, 120.0, 130.0, 170.0, 110.0, 70.0, 390.0, -10.0, 80.0, 40.0, 430.0, 60.0, 180.0, 140.0, 140.0, 400.0, 80.0, 70.0, 220.0, 10.0, 130.0, 30.0, 140.0, 180.0, -20.0, 210.0, -160.0, -90.0, 50.0, 150.0, 240.0, 520.0, 30.0, 60.0, -35.0, -30.0, 15.0, 200.0, 30.0, 540.0, 80.0, -10.0, 280.0, -30.0, 200.0, 440.0, 60.0, 80.0, 230.0, 100.0, 80.0, 125.0, 40.0, 110.0, 20.0, 190.0, 110.0, 0.0, 30.0, 210.0, 40.0, 30.0, 0.0, 240.0, 80.0, 230.0, 10.0, 70.0, 30.0, 60.0, 20.0, 30.0, 160.0, 390.0, 40.0, 50.0, 110.0, 10.0, 110.0, 200.0, 150.0, 40.0, 0.0, 40.0, 70.0, 80.0, 20.0, 170.0, 150.0, 160.0, 20.0, 60.0, 70.0, 0.0, 20.0, 0.0, 120.0, 110.0, 0.0, 70.0, 290.0, 20.0, 80.0, 40.0, 60.0, 510.0, 20.0, 120.0, 90.0, 500.0, 70.0, 20.0, 120.0, 60.0, 190.0, 100.0, 185.0, 50.0, 110.0, 310.0, 25.0, 320.0, 10.0, 230.0, 110.0, 30.0, 20.0, 50.0, 30.0, 50.0, 80.0, 20.0, -50.0, -45.0, 290.0, 90.0, 10.0, 490.0, 40.0, 30.0, 140.0, 80.0, 120.0, 40.0, 300.0, 30.0, 490.0, 60.0, 30.0, 30.0, 40.0, 40.0, 60.0, 50.0, 260.0, 220.0, 280.0, 40.0, 15.0, 30.0, 210.0, 140.0, 30.0, 50.0, 20.0, 40.0, 20.0, 40.0, 10.0, 460.0, 20.0, 120.0, 90.0, 400.0, 90.0, 120.0, 490.0, 130.0, 70.0, 340.0, 60.0, 220.0, 130.0, 0.0, 190.0, 100.0, 290.0, 30.0, 150.0, 100.0, 100.0, 190.0, 200.0, 180.0, 40.0, 90.0, 330.0, 280.0, 45.0, 60.0, 20.0, 120.0, 20.0, 90.0, 50.0, 280.0, 10.0, 40.0, 270.0, 410.0, 10.0, 190.0, 60.0, 200.0, 10.0, 100.0, 70.0, 70.0, 310.0, 110.0, 280.0, 0.0, -25.0, -35.0, 25.0, -25.0, -25.0, 0.0, -30.0, 20.0, 0.0, 20.0, 50.0, 70.0, 90.0, 50.0, 200.0, 80.0, 10.0, 0.0, 170.0, 210.0, 130.0, 220.0, 300.0, 10.0, 30.0, 20.0, 40.0, 30.0, 70.0, 110.0, 290.0, 30.0, 0.0, 270.0, 190.0, 80.0, 30.0, 110.0, 300.0, 70.0, 30.0, 110.0, 30.0, 0.0, 0.0, 40.0, 10.0, 20.0, 30.0, 50.0, 45.0, -500.0, 15.0, 110.0, 140.0, 210.0, 60.0, 230.0, 250.0, 10.0, 75.0, 110.0, 110.0, 140.0, 80.0, 100.0, 70.0, 440.0, 80.0, 60.0, 20.0, 80.0, 50.0, 100.0, 20.0, 40.0, 150.0, 400.0, 140.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6720402822624814, "mean_inference_ms": 1.5035552489136226, "mean_action_processing_ms": 0.42516272208459155, "mean_env_wait_ms": 1.349981723124293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012162923812866211, "StateBufferConnector_ms": 0.013751029968261719, "ViewRequirementAgentConnector_ms": 0.44126391410827637}, "num_episodes": 18, "episode_return_max": 2010.0, "episode_return_min": -75.0, "episode_return_mean": 1072.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.170065018842713, "num_env_steps_trained_throughput_per_sec": 19.170065018842713, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 4720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4720000, "timers": {"training_iteration_time_ms": 209181.943, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209181.9, "sample_time_ms": 2705.783, "learn_time_ms": 206455.499, "learn_throughput": 19.375, "synch_weights_time_ms": 12.108}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "done": false, "training_iteration": 118, "trial_id": "aa996_00000", "date": "2024-05-24_05-36-07", "timestamp": 1716543367, "time_this_iter_s": 208.66733622550964, "time_total_s": 24632.82008290291, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d70b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24632.82008290291, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 19.291525423728814, "ram_util_percent": 78.2606779661017}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3456323058714372, "cur_kl_coeff": 1.0812194824218753, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006632809252383959, "vf_loss": 7.197213313221551, "vf_explained_var": -0.00013044171186046987, "kl": Infinity, "entropy": 0.3094550742588231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1112715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "env_runners": {"episode_reward_max": 2075.0, "episode_reward_min": -75.0, "episode_reward_mean": 1054.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 1120.0}, "policy_reward_mean": {"policy_0": 105.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1370.0, 1410.0, 960.0, 1010.0, 1100.0, 1835.0, 750.0, 1395.0, 1280.0, 1350.0, 1120.0, 410.0, 1070.0, 875.0, 365.0, 1090.0, 1430.0, 1280.0, 1560.0, 730.0, 680.0, 110.0, 620.0, 805.0, 1310.0, 1230.0, 920.0, 1210.0, 1250.0, 1050.0, 415.0, 630.0, 590.0, 70.0, 930.0, 1040.0, 950.0, 555.0, 1390.0, 1310.0, 980.0, 1390.0, 775.0, 870.0, 850.0, 830.0, 1540.0, 1720.0, 1560.0, 1765.0, 920.0, 1230.0, 1470.0, 1400.0, 1220.0, 880.0, 1565.0, 780.0, 770.0, 1260.0, 770.0, 700.0, 1510.0, 1470.0, 630.0, 1075.0, 1180.0, 1305.0, 810.0, 2010.0, 1280.0, 1365.0, 1370.0, 1210.0, -75.0, 930.0, 960.0, 1370.0, 320.0, 570.0, 1265.0, 1080.0, 1395.0, 1080.0, 1135.0, 2075.0, 780.0, 1265.0, 420.0, 1485.0, 955.0, 560.0, 1050.0, 1150.0, 740.0, 550.0, 1460.0, 210.0, 1320.0, 1530.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 100.0, 150.0, 60.0, 110.0, 210.0, 30.0, 240.0, 340.0, 110.0, 110.0, 330.0, 100.0, 270.0, 260.0, 35.0, 190.0, 50.0, -5.0, 70.0, 120.0, 30.0, 100.0, 200.0, 40.0, 70.0, 120.0, 80.0, 110.0, 90.0, 80.0, 30.0, 30.0, 160.0, 50.0, 270.0, 170.0, 80.0, 80.0, 60.0, 120.0, 50.0, 40.0, 20.0, 50.0, 160.0, 210.0, 390.0, 10.0, 50.0, 260.0, 100.0, 40.0, 30.0, 140.0, 815.0, 100.0, 50.0, 180.0, 120.0, 30.0, 60.0, 30.0, 280.0, 20.0, 180.0, 30.0, 30.0, 70.0, 20.0, 80.0, 290.0, 90.0, 70.0, 35.0, 220.0, 360.0, 40.0, 60.0, 150.0, 140.0, 50.0, -40.0, 60.0, 170.0, 0.0, 30.0, 170.0, 240.0, 460.0, 120.0, 90.0, 10.0, 70.0, 190.0, 120.0, -170.0, 0.0, 630.0, 290.0, 10.0, 470.0, 100.0, 10.0, 40.0, 30.0, 140.0, 20.0, 40.0, 260.0, 10.0, 80.0, 20.0, 90.0, 0.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 60.0, 180.0, 120.0, 60.0, 60.0, 30.0, 40.0, 160.0, 330.0, 30.0, 150.0, 70.0, 20.0, 30.0, 15.0, 80.0, 170.0, 290.0, 20.0, 10.0, 30.0, 30.0, 30.0, 175.0, 10.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 130.0, 130.0, 480.0, 170.0, 30.0, 20.0, 20.0, 50.0, 310.0, 30.0, 130.0, 20.0, 360.0, 160.0, 100.0, 140.0, 130.0, 50.0, 420.0, 90.0, 150.0, 40.0, 60.0, 140.0, 50.0, 190.0, 90.0, 50.0, 20.0, 310.0, 40.0, 130.0, 440.0, 120.0, 100.0, 190.0, 180.0, 30.0, 140.0, 40.0, 110.0, 170.0, 40.0, 20.0, 20.0, 10.0, 0.0, 180.0, 50.0, 170.0, 40.0, 0.0, 40.0, 10.0, 30.0, 270.0, 60.0, 10.0, -75.0, -30.0, 90.0, 130.0, 90.0, -35.0, -60.0, 80.0, -20.0, -60.0, 20.0, 40.0, 280.0, 40.0, 70.0, 20.0, 20.0, 100.0, 10.0, 20.0, 100.0, 40.0, 190.0, -170.0, 140.0, 130.0, 20.0, 320.0, -55.0, 90.0, 80.0, 260.0, 130.0, 50.0, 90.0, 90.0, 320.0, 80.0, 70.0, 140.0, 90.0, 250.0, 110.0, 60.0, 130.0, 90.0, 50.0, 140.0, 80.0, 230.0, 100.0, 10.0, 340.0, 30.0, -20.0, 110.0, 470.0, 60.0, 20.0, -200.0, 310.0, 50.0, 240.0, 90.0, 60.0, 90.0, 190.0, 40.0, 120.0, 20.0, 290.0, 30.0, 120.0, 60.0, 190.0, 120.0, 300.0, 20.0, 40.0, 80.0, 0.0, 370.0, 20.0, 180.0, 80.0, 270.0, 100.0, 60.0, -60.0, 30.0, 30.0, 0.0, 0.0, 20.0, 10.0, 210.0, 30.0, 25.0, 40.0, 50.0, 50.0, 170.0, 20.0, 100.0, 10.0, 30.0, 0.0, 190.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 60.0, 30.0, 350.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 250.0, 210.0, 10.0, 10.0, 20.0, 60.0, 10.0, 220.0, 110.0, 40.0, 170.0, 260.0, 360.0, 30.0, 15.0, 20.0, 70.0, 40.0, 35.0, 140.0, 30.0, 20.0, 460.0, 80.0, 30.0, 20.0, 100.0, 30.0, 40.0, 60.0, 60.0, 160.0, 20.0, 100.0, 30.0, 30.0, 0.0, 5.0, 90.0, 230.0, 110.0, 160.0, 20.0, 140.0, 30.0, 30.0, 510.0, 80.0, 80.0, 100.0, 220.0, 20.0, 150.0, 90.0, 80.0, 50.0, 60.0, 370.0, 170.0, 60.0, 50.0, 10.0, 250.0, 30.0, 100.0, 160.0, 110.0, 20.0, 190.0, 200.0, 10.0, -40.0, 60.0, 270.0, 30.0, 280.0, -60.0, 560.0, 80.0, 40.0, 80.0, 50.0, 30.0, 15.0, 30.0, 60.0, 70.0, 90.0, 310.0, 20.0, 140.0, 20.0, 390.0, 30.0, 40.0, 40.0, 50.0, 100.0, 40.0, 30.0, 80.0, 360.0, 20.0, 120.0, 20.0, 0.0, 0.0, 190.0, 30.0, 200.0, 60.0, 180.0, 0.0, 30.0, 40.0, 40.0, 10.0, 70.0, 200.0, 30.0, 210.0, 90.0, 230.0, 60.0, 160.0, 150.0, 0.0, 410.0, 200.0, 200.0, 110.0, 60.0, 240.0, 100.0, 610.0, 20.0, 90.0, 40.0, 250.0, 510.0, 80.0, 40.0, 70.0, 110.0, 10.0, 170.0, 300.0, 100.0, 170.0, 80.0, 190.0, 70.0, 50.0, -15.0, 460.0, 70.0, 330.0, 190.0, 340.0, 20.0, 0.0, 490.0, 40.0, 90.0, 130.0, 65.0, -95.0, 110.0, 70.0, 160.0, 100.0, 130.0, 75.0, 120.0, 45.0, 200.0, 60.0, 220.0, 120.0, 130.0, 170.0, 110.0, 70.0, 390.0, -10.0, 80.0, 40.0, 430.0, 60.0, 180.0, 140.0, 140.0, 400.0, 80.0, 70.0, 220.0, 10.0, 130.0, 30.0, 140.0, 180.0, -20.0, 210.0, -160.0, -90.0, 50.0, 150.0, 240.0, 520.0, 30.0, 60.0, -35.0, -30.0, 15.0, 200.0, 30.0, 540.0, 80.0, -10.0, 280.0, -30.0, 200.0, 440.0, 60.0, 80.0, 230.0, 100.0, 80.0, 125.0, 40.0, 110.0, 20.0, 190.0, 110.0, 0.0, 30.0, 210.0, 40.0, 30.0, 0.0, 240.0, 80.0, 230.0, 10.0, 70.0, 30.0, 60.0, 20.0, 30.0, 160.0, 390.0, 40.0, 50.0, 110.0, 10.0, 110.0, 200.0, 150.0, 40.0, 0.0, 40.0, 70.0, 80.0, 20.0, 170.0, 150.0, 160.0, 20.0, 60.0, 70.0, 0.0, 20.0, 0.0, 120.0, 110.0, 0.0, 70.0, 290.0, 20.0, 80.0, 40.0, 60.0, 510.0, 20.0, 120.0, 90.0, 500.0, 70.0, 20.0, 120.0, 60.0, 190.0, 100.0, 185.0, 50.0, 110.0, 310.0, 25.0, 320.0, 10.0, 230.0, 110.0, 30.0, 20.0, 50.0, 30.0, 50.0, 80.0, 20.0, -50.0, -45.0, 290.0, 90.0, 10.0, 490.0, 40.0, 30.0, 140.0, 80.0, 120.0, 40.0, 300.0, 30.0, 490.0, 60.0, 30.0, 30.0, 40.0, 40.0, 60.0, 50.0, 260.0, 220.0, 280.0, 40.0, 15.0, 30.0, 210.0, 140.0, 30.0, 50.0, 20.0, 40.0, 20.0, 40.0, 10.0, 460.0, 20.0, 120.0, 90.0, 400.0, 90.0, 120.0, 490.0, 130.0, 70.0, 340.0, 60.0, 220.0, 130.0, 0.0, 190.0, 100.0, 290.0, 30.0, 150.0, 100.0, 100.0, 190.0, 200.0, 180.0, 40.0, 90.0, 330.0, 280.0, 45.0, 60.0, 20.0, 120.0, 20.0, 90.0, 50.0, 280.0, 10.0, 40.0, 270.0, 410.0, 10.0, 190.0, 60.0, 200.0, 10.0, 100.0, 70.0, 70.0, 310.0, 110.0, 280.0, 0.0, -25.0, -35.0, 25.0, -25.0, -25.0, 0.0, -30.0, 20.0, 0.0, 20.0, 50.0, 70.0, 90.0, 50.0, 200.0, 80.0, 10.0, 0.0, 170.0, 210.0, 130.0, 220.0, 300.0, 10.0, 30.0, 20.0, 40.0, 30.0, 70.0, 110.0, 290.0, 30.0, 0.0, 270.0, 190.0, 80.0, 30.0, 110.0, 300.0, 70.0, 30.0, 110.0, 30.0, 0.0, 0.0, 40.0, 10.0, 20.0, 30.0, 50.0, 45.0, -500.0, 15.0, 110.0, 140.0, 210.0, 60.0, 230.0, 250.0, 10.0, 75.0, 110.0, 110.0, 140.0, 80.0, 100.0, 70.0, 440.0, 80.0, 60.0, 20.0, 80.0, 50.0, 100.0, 20.0, 40.0, 150.0, 400.0, 140.0, 80.0, 220.0, 90.0, 50.0, -25.0, 90.0, 110.0, 420.0, 220.0, 40.0, 180.0, 270.0, 180.0, 10.0, 60.0, 0.0, 30.0, 0.0, 450.0, 20.0, 60.0, -40.0, 20.0, -10.0, 705.0, -40.0, 30.0, 190.0, 40.0, 140.0, 100.0, 160.0, 80.0, 40.0, 130.0, 1120.0, -20.0, 30.0, 620.0, 20.0, -105.0, 120.0, 110.0, 40.0, 120.0, 10.0, 190.0, 130.0, 0.0, 40.0, 20.0, 180.0, 380.0, 85.0, 160.0, -80.0, 50.0, 210.0, 210.0, 0.0, 70.0, 50.0, 40.0, 35.0, 20.0, 40.0, 150.0, 40.0, 10.0, 40.0, -5.0, 60.0, 120.0, 75.0, 50.0, 460.0, 170.0, 240.0, 160.0, 30.0, 120.0, 100.0, 160.0, 200.0, 20.0, 230.0, 10.0, 25.0, 140.0, 60.0, 10.0, 70.0, 20.0, -90.0, 10.0, 40.0, 180.0, 350.0, 50.0, 30.0, -100.0, 60.0, 30.0, 150.0, 90.0, 30.0, 20.0, 30.0, 110.0, 630.0, -100.0, 20.0, 40.0, 320.0, 290.0, 210.0, 30.0, 40.0, 60.0, 20.0, 120.0, 20.0, 100.0, 20.0, 10.0, 10.0, 170.0, 0.0, 110.0, 30.0, 270.0, 10.0, -20.0, 80.0, 50.0, 0.0, 380.0, 0.0, 0.0, 20.0, 30.0, 50.0, 400.0, 110.0, 330.0, 100.0, 130.0, 60.0, 200.0, 50.0, 30.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 90.0, 10.0, 0.0, 30.0, 220.0, 270.0, 20.0, 190.0, 30.0, 30.0, 470.0, 20.0, 40.0, 50.0, 190.0, 30.0, 300.0, 30.0, 30.0, 40.0, 30.0, 640.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.672001314880976, "mean_inference_ms": 1.5033790537959928, "mean_action_processing_ms": 0.42509667821584235, "mean_env_wait_ms": 1.3498566388654702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012349843978881836, "StateBufferConnector_ms": 0.013790130615234375, "ViewRequirementAgentConnector_ms": 0.43971872329711914}, "num_episodes": 18, "episode_return_max": 2075.0, "episode_return_min": -75.0, "episode_return_mean": 1054.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.86894202108762, "num_env_steps_trained_throughput_per_sec": 18.86894202108762, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 4760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4760000, "timers": {"training_iteration_time_ms": 209478.826, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209478.783, "sample_time_ms": 2685.8, "learn_time_ms": 206771.998, "learn_throughput": 19.345, "synch_weights_time_ms": 12.19}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "done": false, "training_iteration": 119, "trial_id": "aa996_00000", "date": "2024-05-24_05-39-39", "timestamp": 1716543579, "time_this_iter_s": 212.00256609916687, "time_total_s": 24844.822649002075, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160075280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24844.822649002075, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 22.393, "ram_util_percent": 79.39566666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9133101621184485, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.112469936102724, "policy_loss": -0.006032691707874771, "vf_loss": 7.115991095460642, "vf_explained_var": -0.0006609890407647569, "kl": 0.0015485849350820647, "entropy": 0.296876873969397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1122105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "env_runners": {"episode_reward_max": 2075.0, "episode_reward_min": -75.0, "episode_reward_mean": 1074.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 1120.0}, "policy_reward_mean": {"policy_0": 107.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [805.0, 1310.0, 1230.0, 920.0, 1210.0, 1250.0, 1050.0, 415.0, 630.0, 590.0, 70.0, 930.0, 1040.0, 950.0, 555.0, 1390.0, 1310.0, 980.0, 1390.0, 775.0, 870.0, 850.0, 830.0, 1540.0, 1720.0, 1560.0, 1765.0, 920.0, 1230.0, 1470.0, 1400.0, 1220.0, 880.0, 1565.0, 780.0, 770.0, 1260.0, 770.0, 700.0, 1510.0, 1470.0, 630.0, 1075.0, 1180.0, 1305.0, 810.0, 2010.0, 1280.0, 1365.0, 1370.0, 1210.0, -75.0, 930.0, 960.0, 1370.0, 320.0, 570.0, 1265.0, 1080.0, 1395.0, 1080.0, 1135.0, 2075.0, 780.0, 1265.0, 420.0, 1485.0, 955.0, 560.0, 1050.0, 1150.0, 740.0, 550.0, 1460.0, 210.0, 1320.0, 1530.0, 1475.0, 1540.0, 1530.0, 1030.0, 1520.0, 910.0, 955.0, 1315.0, 1240.0, 460.0, 915.0, 1180.0, 970.0, 1530.0, 780.0, 1220.0, 1540.0, 1080.0, 595.0, 1235.0, 1065.0, 1420.0, 280.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 40.0, 190.0, -170.0, 140.0, 130.0, 20.0, 320.0, -55.0, 90.0, 80.0, 260.0, 130.0, 50.0, 90.0, 90.0, 320.0, 80.0, 70.0, 140.0, 90.0, 250.0, 110.0, 60.0, 130.0, 90.0, 50.0, 140.0, 80.0, 230.0, 100.0, 10.0, 340.0, 30.0, -20.0, 110.0, 470.0, 60.0, 20.0, -200.0, 310.0, 50.0, 240.0, 90.0, 60.0, 90.0, 190.0, 40.0, 120.0, 20.0, 290.0, 30.0, 120.0, 60.0, 190.0, 120.0, 300.0, 20.0, 40.0, 80.0, 0.0, 370.0, 20.0, 180.0, 80.0, 270.0, 100.0, 60.0, -60.0, 30.0, 30.0, 0.0, 0.0, 20.0, 10.0, 210.0, 30.0, 25.0, 40.0, 50.0, 50.0, 170.0, 20.0, 100.0, 10.0, 30.0, 0.0, 190.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 60.0, 30.0, 350.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 30.0, 250.0, 210.0, 10.0, 10.0, 20.0, 60.0, 10.0, 220.0, 110.0, 40.0, 170.0, 260.0, 360.0, 30.0, 15.0, 20.0, 70.0, 40.0, 35.0, 140.0, 30.0, 20.0, 460.0, 80.0, 30.0, 20.0, 100.0, 30.0, 40.0, 60.0, 60.0, 160.0, 20.0, 100.0, 30.0, 30.0, 0.0, 5.0, 90.0, 230.0, 110.0, 160.0, 20.0, 140.0, 30.0, 30.0, 510.0, 80.0, 80.0, 100.0, 220.0, 20.0, 150.0, 90.0, 80.0, 50.0, 60.0, 370.0, 170.0, 60.0, 50.0, 10.0, 250.0, 30.0, 100.0, 160.0, 110.0, 20.0, 190.0, 200.0, 10.0, -40.0, 60.0, 270.0, 30.0, 280.0, -60.0, 560.0, 80.0, 40.0, 80.0, 50.0, 30.0, 15.0, 30.0, 60.0, 70.0, 90.0, 310.0, 20.0, 140.0, 20.0, 390.0, 30.0, 40.0, 40.0, 50.0, 100.0, 40.0, 30.0, 80.0, 360.0, 20.0, 120.0, 20.0, 0.0, 0.0, 190.0, 30.0, 200.0, 60.0, 180.0, 0.0, 30.0, 40.0, 40.0, 10.0, 70.0, 200.0, 30.0, 210.0, 90.0, 230.0, 60.0, 160.0, 150.0, 0.0, 410.0, 200.0, 200.0, 110.0, 60.0, 240.0, 100.0, 610.0, 20.0, 90.0, 40.0, 250.0, 510.0, 80.0, 40.0, 70.0, 110.0, 10.0, 170.0, 300.0, 100.0, 170.0, 80.0, 190.0, 70.0, 50.0, -15.0, 460.0, 70.0, 330.0, 190.0, 340.0, 20.0, 0.0, 490.0, 40.0, 90.0, 130.0, 65.0, -95.0, 110.0, 70.0, 160.0, 100.0, 130.0, 75.0, 120.0, 45.0, 200.0, 60.0, 220.0, 120.0, 130.0, 170.0, 110.0, 70.0, 390.0, -10.0, 80.0, 40.0, 430.0, 60.0, 180.0, 140.0, 140.0, 400.0, 80.0, 70.0, 220.0, 10.0, 130.0, 30.0, 140.0, 180.0, -20.0, 210.0, -160.0, -90.0, 50.0, 150.0, 240.0, 520.0, 30.0, 60.0, -35.0, -30.0, 15.0, 200.0, 30.0, 540.0, 80.0, -10.0, 280.0, -30.0, 200.0, 440.0, 60.0, 80.0, 230.0, 100.0, 80.0, 125.0, 40.0, 110.0, 20.0, 190.0, 110.0, 0.0, 30.0, 210.0, 40.0, 30.0, 0.0, 240.0, 80.0, 230.0, 10.0, 70.0, 30.0, 60.0, 20.0, 30.0, 160.0, 390.0, 40.0, 50.0, 110.0, 10.0, 110.0, 200.0, 150.0, 40.0, 0.0, 40.0, 70.0, 80.0, 20.0, 170.0, 150.0, 160.0, 20.0, 60.0, 70.0, 0.0, 20.0, 0.0, 120.0, 110.0, 0.0, 70.0, 290.0, 20.0, 80.0, 40.0, 60.0, 510.0, 20.0, 120.0, 90.0, 500.0, 70.0, 20.0, 120.0, 60.0, 190.0, 100.0, 185.0, 50.0, 110.0, 310.0, 25.0, 320.0, 10.0, 230.0, 110.0, 30.0, 20.0, 50.0, 30.0, 50.0, 80.0, 20.0, -50.0, -45.0, 290.0, 90.0, 10.0, 490.0, 40.0, 30.0, 140.0, 80.0, 120.0, 40.0, 300.0, 30.0, 490.0, 60.0, 30.0, 30.0, 40.0, 40.0, 60.0, 50.0, 260.0, 220.0, 280.0, 40.0, 15.0, 30.0, 210.0, 140.0, 30.0, 50.0, 20.0, 40.0, 20.0, 40.0, 10.0, 460.0, 20.0, 120.0, 90.0, 400.0, 90.0, 120.0, 490.0, 130.0, 70.0, 340.0, 60.0, 220.0, 130.0, 0.0, 190.0, 100.0, 290.0, 30.0, 150.0, 100.0, 100.0, 190.0, 200.0, 180.0, 40.0, 90.0, 330.0, 280.0, 45.0, 60.0, 20.0, 120.0, 20.0, 90.0, 50.0, 280.0, 10.0, 40.0, 270.0, 410.0, 10.0, 190.0, 60.0, 200.0, 10.0, 100.0, 70.0, 70.0, 310.0, 110.0, 280.0, 0.0, -25.0, -35.0, 25.0, -25.0, -25.0, 0.0, -30.0, 20.0, 0.0, 20.0, 50.0, 70.0, 90.0, 50.0, 200.0, 80.0, 10.0, 0.0, 170.0, 210.0, 130.0, 220.0, 300.0, 10.0, 30.0, 20.0, 40.0, 30.0, 70.0, 110.0, 290.0, 30.0, 0.0, 270.0, 190.0, 80.0, 30.0, 110.0, 300.0, 70.0, 30.0, 110.0, 30.0, 0.0, 0.0, 40.0, 10.0, 20.0, 30.0, 50.0, 45.0, -500.0, 15.0, 110.0, 140.0, 210.0, 60.0, 230.0, 250.0, 10.0, 75.0, 110.0, 110.0, 140.0, 80.0, 100.0, 70.0, 440.0, 80.0, 60.0, 20.0, 80.0, 50.0, 100.0, 20.0, 40.0, 150.0, 400.0, 140.0, 80.0, 220.0, 90.0, 50.0, -25.0, 90.0, 110.0, 420.0, 220.0, 40.0, 180.0, 270.0, 180.0, 10.0, 60.0, 0.0, 30.0, 0.0, 450.0, 20.0, 60.0, -40.0, 20.0, -10.0, 705.0, -40.0, 30.0, 190.0, 40.0, 140.0, 100.0, 160.0, 80.0, 40.0, 130.0, 1120.0, -20.0, 30.0, 620.0, 20.0, -105.0, 120.0, 110.0, 40.0, 120.0, 10.0, 190.0, 130.0, 0.0, 40.0, 20.0, 180.0, 380.0, 85.0, 160.0, -80.0, 50.0, 210.0, 210.0, 0.0, 70.0, 50.0, 40.0, 35.0, 20.0, 40.0, 150.0, 40.0, 10.0, 40.0, -5.0, 60.0, 120.0, 75.0, 50.0, 460.0, 170.0, 240.0, 160.0, 30.0, 120.0, 100.0, 160.0, 200.0, 20.0, 230.0, 10.0, 25.0, 140.0, 60.0, 10.0, 70.0, 20.0, -90.0, 10.0, 40.0, 180.0, 350.0, 50.0, 30.0, -100.0, 60.0, 30.0, 150.0, 90.0, 30.0, 20.0, 30.0, 110.0, 630.0, -100.0, 20.0, 40.0, 320.0, 290.0, 210.0, 30.0, 40.0, 60.0, 20.0, 120.0, 20.0, 100.0, 20.0, 10.0, 10.0, 170.0, 0.0, 110.0, 30.0, 270.0, 10.0, -20.0, 80.0, 50.0, 0.0, 380.0, 0.0, 0.0, 20.0, 30.0, 50.0, 400.0, 110.0, 330.0, 100.0, 130.0, 60.0, 200.0, 50.0, 30.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 90.0, 10.0, 0.0, 30.0, 220.0, 270.0, 20.0, 190.0, 30.0, 30.0, 470.0, 20.0, 40.0, 50.0, 190.0, 30.0, 300.0, 30.0, 30.0, 40.0, 30.0, 640.0, 190.0, 75.0, 90.0, 230.0, 40.0, 260.0, 70.0, 390.0, -10.0, 20.0, 310.0, -90.0, 120.0, 40.0, 90.0, 100.0, 230.0, 180.0, 130.0, 30.0, 710.0, 60.0, 490.0, 340.0, 30.0, 100.0, 90.0, -40.0, 90.0, 330.0, 40.0, 10.0, 160.0, 80.0, 90.0, 180.0, 100.0, 120.0, 170.0, 30.0, 90.0, 70.0, 90.0, 90.0, 100.0, 30.0, 70.0, 140.0, 740.0, 150.0, 40.0, 70.0, 210.0, 20.0, 0.0, 130.0, 30.0, 0.0, 40.0, 80.0, 330.0, 0.0, -15.0, 180.0, 310.0, 60.0, 45.0, -15.0, 110.0, 110.0, 170.0, -180.0, 100.0, 40.0, -10.0, -60.0, 90.0, 100.0, 535.0, 250.0, 450.0, 200.0, 230.0, 180.0, 30.0, 290.0, 170.0, 60.0, 80.0, -25.0, 25.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 10.0, 60.0, 90.0, 30.0, 90.0, 170.0, 20.0, 10.0, 10.0, 50.0, 5.0, 300.0, 100.0, 160.0, 80.0, 20.0, 10.0, 460.0, 20.0, 80.0, 280.0, 190.0, 50.0, -10.0, 80.0, 100.0, 110.0, 200.0, 30.0, 160.0, 50.0, 180.0, 20.0, 40.0, 80.0, 220.0, 180.0, 80.0, 250.0, 470.0, 120.0, 10.0, 40.0, 80.0, 60.0, 10.0, 0.0, 30.0, 150.0, 160.0, 50.0, 70.0, 230.0, 20.0, 30.0, 460.0, 190.0, 50.0, 240.0, 50.0, 10.0, 140.0, 20.0, 30.0, 50.0, 220.0, 280.0, 50.0, 10.0, 330.0, 40.0, 130.0, 110.0, 320.0, 30.0, 20.0, 20.0, 390.0, 170.0, 60.0, 170.0, 120.0, 30.0, 70.0, 30.0, 20.0, -50.0, -5.0, 30.0, 150.0, 80.0, 0.0, 60.0, 280.0, 10.0, 0.0, 40.0, 15.0, 130.0, 720.0, 60.0, 70.0, 20.0, 170.0, 220.0, -140.0, 180.0, 220.0, 170.0, 200.0, 0.0, 160.0, 0.0, 55.0, 240.0, 330.0, 350.0, 210.0, -70.0, 40.0, 0.0, 120.0, 110.0, 90.0, 10.0, 100.0, 20.0, 10.0, 40.0, 10.0, 20.0, 20.0, 10.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6725236795362022, "mean_inference_ms": 1.5039559099047564, "mean_action_processing_ms": 0.4251567525836568, "mean_env_wait_ms": 1.3500568247113223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012919187545776367, "StateBufferConnector_ms": 0.014068126678466797, "ViewRequirementAgentConnector_ms": 0.45013952255249023}, "num_episodes": 23, "episode_return_max": 2075.0, "episode_return_min": -75.0, "episode_return_mean": 1074.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.28284143153112, "num_env_steps_trained_throughput_per_sec": 19.28284143153112, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 4800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4800000, "timers": {"training_iteration_time_ms": 209017.387, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209017.343, "sample_time_ms": 2727.63, "learn_time_ms": 206268.602, "learn_throughput": 19.392, "synch_weights_time_ms": 12.234}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "done": false, "training_iteration": 120, "trial_id": "aa996_00000", "date": "2024-05-24_05-43-06", "timestamp": 1716543786, "time_this_iter_s": 207.45085787773132, "time_total_s": 25052.273506879807, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160aa0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25052.273506879807, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 19.156996587030715, "ram_util_percent": 78.46211604095564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.628176066307976, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.921682531663531, "policy_loss": -0.0069154723550374515, "vf_loss": 6.926423309811642, "vf_explained_var": -0.0008546280911682259, "kl": 0.002681767537286413, "entropy": 0.27793084623905034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1131495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "env_runners": {"episode_reward_max": 2075.0, "episode_reward_min": -75.0, "episode_reward_mean": 1099.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 1120.0}, "policy_reward_mean": {"policy_0": 109.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1390.0, 775.0, 870.0, 850.0, 830.0, 1540.0, 1720.0, 1560.0, 1765.0, 920.0, 1230.0, 1470.0, 1400.0, 1220.0, 880.0, 1565.0, 780.0, 770.0, 1260.0, 770.0, 700.0, 1510.0, 1470.0, 630.0, 1075.0, 1180.0, 1305.0, 810.0, 2010.0, 1280.0, 1365.0, 1370.0, 1210.0, -75.0, 930.0, 960.0, 1370.0, 320.0, 570.0, 1265.0, 1080.0, 1395.0, 1080.0, 1135.0, 2075.0, 780.0, 1265.0, 420.0, 1485.0, 955.0, 560.0, 1050.0, 1150.0, 740.0, 550.0, 1460.0, 210.0, 1320.0, 1530.0, 1475.0, 1540.0, 1530.0, 1030.0, 1520.0, 910.0, 955.0, 1315.0, 1240.0, 460.0, 915.0, 1180.0, 970.0, 1530.0, 780.0, 1220.0, 1540.0, 1080.0, 595.0, 1235.0, 1065.0, 1420.0, 280.0, 1520.0, 1085.0, 950.0, 740.0, 1125.0, 625.0, 1475.0, 780.0, 1340.0, 420.0, 1520.0, 365.0, 980.0, 1280.0, 1120.0, 1280.0, 980.0, 1520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [200.0, 10.0, -40.0, 60.0, 270.0, 30.0, 280.0, -60.0, 560.0, 80.0, 40.0, 80.0, 50.0, 30.0, 15.0, 30.0, 60.0, 70.0, 90.0, 310.0, 20.0, 140.0, 20.0, 390.0, 30.0, 40.0, 40.0, 50.0, 100.0, 40.0, 30.0, 80.0, 360.0, 20.0, 120.0, 20.0, 0.0, 0.0, 190.0, 30.0, 200.0, 60.0, 180.0, 0.0, 30.0, 40.0, 40.0, 10.0, 70.0, 200.0, 30.0, 210.0, 90.0, 230.0, 60.0, 160.0, 150.0, 0.0, 410.0, 200.0, 200.0, 110.0, 60.0, 240.0, 100.0, 610.0, 20.0, 90.0, 40.0, 250.0, 510.0, 80.0, 40.0, 70.0, 110.0, 10.0, 170.0, 300.0, 100.0, 170.0, 80.0, 190.0, 70.0, 50.0, -15.0, 460.0, 70.0, 330.0, 190.0, 340.0, 20.0, 0.0, 490.0, 40.0, 90.0, 130.0, 65.0, -95.0, 110.0, 70.0, 160.0, 100.0, 130.0, 75.0, 120.0, 45.0, 200.0, 60.0, 220.0, 120.0, 130.0, 170.0, 110.0, 70.0, 390.0, -10.0, 80.0, 40.0, 430.0, 60.0, 180.0, 140.0, 140.0, 400.0, 80.0, 70.0, 220.0, 10.0, 130.0, 30.0, 140.0, 180.0, -20.0, 210.0, -160.0, -90.0, 50.0, 150.0, 240.0, 520.0, 30.0, 60.0, -35.0, -30.0, 15.0, 200.0, 30.0, 540.0, 80.0, -10.0, 280.0, -30.0, 200.0, 440.0, 60.0, 80.0, 230.0, 100.0, 80.0, 125.0, 40.0, 110.0, 20.0, 190.0, 110.0, 0.0, 30.0, 210.0, 40.0, 30.0, 0.0, 240.0, 80.0, 230.0, 10.0, 70.0, 30.0, 60.0, 20.0, 30.0, 160.0, 390.0, 40.0, 50.0, 110.0, 10.0, 110.0, 200.0, 150.0, 40.0, 0.0, 40.0, 70.0, 80.0, 20.0, 170.0, 150.0, 160.0, 20.0, 60.0, 70.0, 0.0, 20.0, 0.0, 120.0, 110.0, 0.0, 70.0, 290.0, 20.0, 80.0, 40.0, 60.0, 510.0, 20.0, 120.0, 90.0, 500.0, 70.0, 20.0, 120.0, 60.0, 190.0, 100.0, 185.0, 50.0, 110.0, 310.0, 25.0, 320.0, 10.0, 230.0, 110.0, 30.0, 20.0, 50.0, 30.0, 50.0, 80.0, 20.0, -50.0, -45.0, 290.0, 90.0, 10.0, 490.0, 40.0, 30.0, 140.0, 80.0, 120.0, 40.0, 300.0, 30.0, 490.0, 60.0, 30.0, 30.0, 40.0, 40.0, 60.0, 50.0, 260.0, 220.0, 280.0, 40.0, 15.0, 30.0, 210.0, 140.0, 30.0, 50.0, 20.0, 40.0, 20.0, 40.0, 10.0, 460.0, 20.0, 120.0, 90.0, 400.0, 90.0, 120.0, 490.0, 130.0, 70.0, 340.0, 60.0, 220.0, 130.0, 0.0, 190.0, 100.0, 290.0, 30.0, 150.0, 100.0, 100.0, 190.0, 200.0, 180.0, 40.0, 90.0, 330.0, 280.0, 45.0, 60.0, 20.0, 120.0, 20.0, 90.0, 50.0, 280.0, 10.0, 40.0, 270.0, 410.0, 10.0, 190.0, 60.0, 200.0, 10.0, 100.0, 70.0, 70.0, 310.0, 110.0, 280.0, 0.0, -25.0, -35.0, 25.0, -25.0, -25.0, 0.0, -30.0, 20.0, 0.0, 20.0, 50.0, 70.0, 90.0, 50.0, 200.0, 80.0, 10.0, 0.0, 170.0, 210.0, 130.0, 220.0, 300.0, 10.0, 30.0, 20.0, 40.0, 30.0, 70.0, 110.0, 290.0, 30.0, 0.0, 270.0, 190.0, 80.0, 30.0, 110.0, 300.0, 70.0, 30.0, 110.0, 30.0, 0.0, 0.0, 40.0, 10.0, 20.0, 30.0, 50.0, 45.0, -500.0, 15.0, 110.0, 140.0, 210.0, 60.0, 230.0, 250.0, 10.0, 75.0, 110.0, 110.0, 140.0, 80.0, 100.0, 70.0, 440.0, 80.0, 60.0, 20.0, 80.0, 50.0, 100.0, 20.0, 40.0, 150.0, 400.0, 140.0, 80.0, 220.0, 90.0, 50.0, -25.0, 90.0, 110.0, 420.0, 220.0, 40.0, 180.0, 270.0, 180.0, 10.0, 60.0, 0.0, 30.0, 0.0, 450.0, 20.0, 60.0, -40.0, 20.0, -10.0, 705.0, -40.0, 30.0, 190.0, 40.0, 140.0, 100.0, 160.0, 80.0, 40.0, 130.0, 1120.0, -20.0, 30.0, 620.0, 20.0, -105.0, 120.0, 110.0, 40.0, 120.0, 10.0, 190.0, 130.0, 0.0, 40.0, 20.0, 180.0, 380.0, 85.0, 160.0, -80.0, 50.0, 210.0, 210.0, 0.0, 70.0, 50.0, 40.0, 35.0, 20.0, 40.0, 150.0, 40.0, 10.0, 40.0, -5.0, 60.0, 120.0, 75.0, 50.0, 460.0, 170.0, 240.0, 160.0, 30.0, 120.0, 100.0, 160.0, 200.0, 20.0, 230.0, 10.0, 25.0, 140.0, 60.0, 10.0, 70.0, 20.0, -90.0, 10.0, 40.0, 180.0, 350.0, 50.0, 30.0, -100.0, 60.0, 30.0, 150.0, 90.0, 30.0, 20.0, 30.0, 110.0, 630.0, -100.0, 20.0, 40.0, 320.0, 290.0, 210.0, 30.0, 40.0, 60.0, 20.0, 120.0, 20.0, 100.0, 20.0, 10.0, 10.0, 170.0, 0.0, 110.0, 30.0, 270.0, 10.0, -20.0, 80.0, 50.0, 0.0, 380.0, 0.0, 0.0, 20.0, 30.0, 50.0, 400.0, 110.0, 330.0, 100.0, 130.0, 60.0, 200.0, 50.0, 30.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 90.0, 10.0, 0.0, 30.0, 220.0, 270.0, 20.0, 190.0, 30.0, 30.0, 470.0, 20.0, 40.0, 50.0, 190.0, 30.0, 300.0, 30.0, 30.0, 40.0, 30.0, 640.0, 190.0, 75.0, 90.0, 230.0, 40.0, 260.0, 70.0, 390.0, -10.0, 20.0, 310.0, -90.0, 120.0, 40.0, 90.0, 100.0, 230.0, 180.0, 130.0, 30.0, 710.0, 60.0, 490.0, 340.0, 30.0, 100.0, 90.0, -40.0, 90.0, 330.0, 40.0, 10.0, 160.0, 80.0, 90.0, 180.0, 100.0, 120.0, 170.0, 30.0, 90.0, 70.0, 90.0, 90.0, 100.0, 30.0, 70.0, 140.0, 740.0, 150.0, 40.0, 70.0, 210.0, 20.0, 0.0, 130.0, 30.0, 0.0, 40.0, 80.0, 330.0, 0.0, -15.0, 180.0, 310.0, 60.0, 45.0, -15.0, 110.0, 110.0, 170.0, -180.0, 100.0, 40.0, -10.0, -60.0, 90.0, 100.0, 535.0, 250.0, 450.0, 200.0, 230.0, 180.0, 30.0, 290.0, 170.0, 60.0, 80.0, -25.0, 25.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 10.0, 60.0, 90.0, 30.0, 90.0, 170.0, 20.0, 10.0, 10.0, 50.0, 5.0, 300.0, 100.0, 160.0, 80.0, 20.0, 10.0, 460.0, 20.0, 80.0, 280.0, 190.0, 50.0, -10.0, 80.0, 100.0, 110.0, 200.0, 30.0, 160.0, 50.0, 180.0, 20.0, 40.0, 80.0, 220.0, 180.0, 80.0, 250.0, 470.0, 120.0, 10.0, 40.0, 80.0, 60.0, 10.0, 0.0, 30.0, 150.0, 160.0, 50.0, 70.0, 230.0, 20.0, 30.0, 460.0, 190.0, 50.0, 240.0, 50.0, 10.0, 140.0, 20.0, 30.0, 50.0, 220.0, 280.0, 50.0, 10.0, 330.0, 40.0, 130.0, 110.0, 320.0, 30.0, 20.0, 20.0, 390.0, 170.0, 60.0, 170.0, 120.0, 30.0, 70.0, 30.0, 20.0, -50.0, -5.0, 30.0, 150.0, 80.0, 0.0, 60.0, 280.0, 10.0, 0.0, 40.0, 15.0, 130.0, 720.0, 60.0, 70.0, 20.0, 170.0, 220.0, -140.0, 180.0, 220.0, 170.0, 200.0, 0.0, 160.0, 0.0, 55.0, 240.0, 330.0, 350.0, 210.0, -70.0, 40.0, 0.0, 120.0, 110.0, 90.0, 10.0, 100.0, 20.0, 10.0, 40.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 70.0, 160.0, 440.0, 110.0, 60.0, 160.0, 280.0, 100.0, 160.0, 150.0, 60.0, 10.0, 20.0, 40.0, 275.0, 130.0, 310.0, 40.0, 50.0, 40.0, 370.0, 20.0, -20.0, 10.0, 30.0, 240.0, 180.0, 0.0, 80.0, 90.0, 40.0, 0.0, 40.0, 30.0, 50.0, 110.0, 20.0, 0.0, 360.0, 100.0, 30.0, 45.0, 370.0, 20.0, 140.0, 100.0, 10.0, 110.0, 200.0, 50.0, 30.0, 50.0, 20.0, 10.0, 15.0, 10.0, 30.0, 360.0, 50.0, 630.0, 80.0, 70.0, 130.0, 120.0, 0.0, 160.0, 170.0, 5.0, 110.0, 400.0, 50.0, 60.0, -50.0, 30.0, 40.0, 0.0, -10.0, 180.0, 80.0, 130.0, 50.0, 440.0, 130.0, 170.0, 0.0, 60.0, 60.0, 270.0, 30.0, 0.0, 20.0, 30.0, 40.0, 40.0, 260.0, 10.0, 0.0, -40.0, 60.0, 70.0, 90.0, 80.0, 10.0, 150.0, 400.0, 190.0, 180.0, 90.0, 260.0, 0.0, 0.0, 300.0, 0.0, 0.0, -15.0, 30.0, -10.0, 40.0, 20.0, 70.0, 90.0, 140.0, 90.0, 20.0, 100.0, 140.0, 130.0, 180.0, 20.0, 130.0, 400.0, 110.0, 100.0, 60.0, 40.0, 150.0, 50.0, 150.0, 90.0, 0.0, 40.0, 70.0, 40.0, 500.0, 110.0, -40.0, 240.0, 60.0, 100.0, 100.0, 55.0, 160.0, 340.0, 5.0, 170.0, 130.0, 120.0, 110.0, 90.0, 90.0, 20.0, 20.0, 40.0, 100.0, 40.0, 390.0, 20.0, 240.0, 20.0, 100.0, -30.0, -30.0, 410.0, 170.0, 520.0, 80.0, 210.0, 120.0, -30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6729122236985001, "mean_inference_ms": 1.5042975811209285, "mean_action_processing_ms": 0.4251434577209375, "mean_env_wait_ms": 1.3501864426334655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012885808944702148, "StateBufferConnector_ms": 0.010331392288208008, "ViewRequirementAgentConnector_ms": 0.4028346538543701}, "num_episodes": 18, "episode_return_max": 2075.0, "episode_return_min": -75.0, "episode_return_mean": 1099.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.379840631746994, "num_env_steps_trained_throughput_per_sec": 19.379840631746994, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 4840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4840000, "timers": {"training_iteration_time_ms": 208701.847, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208701.803, "sample_time_ms": 2710.803, "learn_time_ms": 205970.338, "learn_throughput": 19.42, "synch_weights_time_ms": 11.907}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "done": false, "training_iteration": 121, "trial_id": "aa996_00000", "date": "2024-05-24_05-46-32", "timestamp": 1716543992, "time_this_iter_s": 206.41134119033813, "time_total_s": 25258.684848070145, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d70b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25258.684848070145, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 18.624657534246573, "ram_util_percent": 78.35205479452055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2179784347391482, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006900183634393124, "vf_loss": 7.941752865672492, "vf_explained_var": 0.00031424730349653446, "kl": Infinity, "entropy": 0.2714917372003658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1140885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "env_runners": {"episode_reward_max": 2075.0, "episode_reward_min": -75.0, "episode_reward_mean": 1099.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -500.0}, "policy_reward_max": {"policy_0": 1120.0}, "policy_reward_mean": {"policy_0": 109.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1470.0, 630.0, 1075.0, 1180.0, 1305.0, 810.0, 2010.0, 1280.0, 1365.0, 1370.0, 1210.0, -75.0, 930.0, 960.0, 1370.0, 320.0, 570.0, 1265.0, 1080.0, 1395.0, 1080.0, 1135.0, 2075.0, 780.0, 1265.0, 420.0, 1485.0, 955.0, 560.0, 1050.0, 1150.0, 740.0, 550.0, 1460.0, 210.0, 1320.0, 1530.0, 1475.0, 1540.0, 1530.0, 1030.0, 1520.0, 910.0, 955.0, 1315.0, 1240.0, 460.0, 915.0, 1180.0, 970.0, 1530.0, 780.0, 1220.0, 1540.0, 1080.0, 595.0, 1235.0, 1065.0, 1420.0, 280.0, 1520.0, 1085.0, 950.0, 740.0, 1125.0, 625.0, 1475.0, 780.0, 1340.0, 420.0, 1520.0, 365.0, 980.0, 1280.0, 1120.0, 1280.0, 980.0, 1520.0, 430.0, 770.0, 1410.0, 980.0, 1015.0, 1300.0, 1130.0, 1050.0, 1220.0, 640.0, 765.0, 1470.0, 1405.0, 1160.0, 950.0, 1400.0, 1550.0, 1550.0, 1980.0, 1230.0, 1160.0, 1175.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 60.0, 190.0, 100.0, 185.0, 50.0, 110.0, 310.0, 25.0, 320.0, 10.0, 230.0, 110.0, 30.0, 20.0, 50.0, 30.0, 50.0, 80.0, 20.0, -50.0, -45.0, 290.0, 90.0, 10.0, 490.0, 40.0, 30.0, 140.0, 80.0, 120.0, 40.0, 300.0, 30.0, 490.0, 60.0, 30.0, 30.0, 40.0, 40.0, 60.0, 50.0, 260.0, 220.0, 280.0, 40.0, 15.0, 30.0, 210.0, 140.0, 30.0, 50.0, 20.0, 40.0, 20.0, 40.0, 10.0, 460.0, 20.0, 120.0, 90.0, 400.0, 90.0, 120.0, 490.0, 130.0, 70.0, 340.0, 60.0, 220.0, 130.0, 0.0, 190.0, 100.0, 290.0, 30.0, 150.0, 100.0, 100.0, 190.0, 200.0, 180.0, 40.0, 90.0, 330.0, 280.0, 45.0, 60.0, 20.0, 120.0, 20.0, 90.0, 50.0, 280.0, 10.0, 40.0, 270.0, 410.0, 10.0, 190.0, 60.0, 200.0, 10.0, 100.0, 70.0, 70.0, 310.0, 110.0, 280.0, 0.0, -25.0, -35.0, 25.0, -25.0, -25.0, 0.0, -30.0, 20.0, 0.0, 20.0, 50.0, 70.0, 90.0, 50.0, 200.0, 80.0, 10.0, 0.0, 170.0, 210.0, 130.0, 220.0, 300.0, 10.0, 30.0, 20.0, 40.0, 30.0, 70.0, 110.0, 290.0, 30.0, 0.0, 270.0, 190.0, 80.0, 30.0, 110.0, 300.0, 70.0, 30.0, 110.0, 30.0, 0.0, 0.0, 40.0, 10.0, 20.0, 30.0, 50.0, 45.0, -500.0, 15.0, 110.0, 140.0, 210.0, 60.0, 230.0, 250.0, 10.0, 75.0, 110.0, 110.0, 140.0, 80.0, 100.0, 70.0, 440.0, 80.0, 60.0, 20.0, 80.0, 50.0, 100.0, 20.0, 40.0, 150.0, 400.0, 140.0, 80.0, 220.0, 90.0, 50.0, -25.0, 90.0, 110.0, 420.0, 220.0, 40.0, 180.0, 270.0, 180.0, 10.0, 60.0, 0.0, 30.0, 0.0, 450.0, 20.0, 60.0, -40.0, 20.0, -10.0, 705.0, -40.0, 30.0, 190.0, 40.0, 140.0, 100.0, 160.0, 80.0, 40.0, 130.0, 1120.0, -20.0, 30.0, 620.0, 20.0, -105.0, 120.0, 110.0, 40.0, 120.0, 10.0, 190.0, 130.0, 0.0, 40.0, 20.0, 180.0, 380.0, 85.0, 160.0, -80.0, 50.0, 210.0, 210.0, 0.0, 70.0, 50.0, 40.0, 35.0, 20.0, 40.0, 150.0, 40.0, 10.0, 40.0, -5.0, 60.0, 120.0, 75.0, 50.0, 460.0, 170.0, 240.0, 160.0, 30.0, 120.0, 100.0, 160.0, 200.0, 20.0, 230.0, 10.0, 25.0, 140.0, 60.0, 10.0, 70.0, 20.0, -90.0, 10.0, 40.0, 180.0, 350.0, 50.0, 30.0, -100.0, 60.0, 30.0, 150.0, 90.0, 30.0, 20.0, 30.0, 110.0, 630.0, -100.0, 20.0, 40.0, 320.0, 290.0, 210.0, 30.0, 40.0, 60.0, 20.0, 120.0, 20.0, 100.0, 20.0, 10.0, 10.0, 170.0, 0.0, 110.0, 30.0, 270.0, 10.0, -20.0, 80.0, 50.0, 0.0, 380.0, 0.0, 0.0, 20.0, 30.0, 50.0, 400.0, 110.0, 330.0, 100.0, 130.0, 60.0, 200.0, 50.0, 30.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 90.0, 10.0, 0.0, 30.0, 220.0, 270.0, 20.0, 190.0, 30.0, 30.0, 470.0, 20.0, 40.0, 50.0, 190.0, 30.0, 300.0, 30.0, 30.0, 40.0, 30.0, 640.0, 190.0, 75.0, 90.0, 230.0, 40.0, 260.0, 70.0, 390.0, -10.0, 20.0, 310.0, -90.0, 120.0, 40.0, 90.0, 100.0, 230.0, 180.0, 130.0, 30.0, 710.0, 60.0, 490.0, 340.0, 30.0, 100.0, 90.0, -40.0, 90.0, 330.0, 40.0, 10.0, 160.0, 80.0, 90.0, 180.0, 100.0, 120.0, 170.0, 30.0, 90.0, 70.0, 90.0, 90.0, 100.0, 30.0, 70.0, 140.0, 740.0, 150.0, 40.0, 70.0, 210.0, 20.0, 0.0, 130.0, 30.0, 0.0, 40.0, 80.0, 330.0, 0.0, -15.0, 180.0, 310.0, 60.0, 45.0, -15.0, 110.0, 110.0, 170.0, -180.0, 100.0, 40.0, -10.0, -60.0, 90.0, 100.0, 535.0, 250.0, 450.0, 200.0, 230.0, 180.0, 30.0, 290.0, 170.0, 60.0, 80.0, -25.0, 25.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 10.0, 60.0, 90.0, 30.0, 90.0, 170.0, 20.0, 10.0, 10.0, 50.0, 5.0, 300.0, 100.0, 160.0, 80.0, 20.0, 10.0, 460.0, 20.0, 80.0, 280.0, 190.0, 50.0, -10.0, 80.0, 100.0, 110.0, 200.0, 30.0, 160.0, 50.0, 180.0, 20.0, 40.0, 80.0, 220.0, 180.0, 80.0, 250.0, 470.0, 120.0, 10.0, 40.0, 80.0, 60.0, 10.0, 0.0, 30.0, 150.0, 160.0, 50.0, 70.0, 230.0, 20.0, 30.0, 460.0, 190.0, 50.0, 240.0, 50.0, 10.0, 140.0, 20.0, 30.0, 50.0, 220.0, 280.0, 50.0, 10.0, 330.0, 40.0, 130.0, 110.0, 320.0, 30.0, 20.0, 20.0, 390.0, 170.0, 60.0, 170.0, 120.0, 30.0, 70.0, 30.0, 20.0, -50.0, -5.0, 30.0, 150.0, 80.0, 0.0, 60.0, 280.0, 10.0, 0.0, 40.0, 15.0, 130.0, 720.0, 60.0, 70.0, 20.0, 170.0, 220.0, -140.0, 180.0, 220.0, 170.0, 200.0, 0.0, 160.0, 0.0, 55.0, 240.0, 330.0, 350.0, 210.0, -70.0, 40.0, 0.0, 120.0, 110.0, 90.0, 10.0, 100.0, 20.0, 10.0, 40.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 70.0, 160.0, 440.0, 110.0, 60.0, 160.0, 280.0, 100.0, 160.0, 150.0, 60.0, 10.0, 20.0, 40.0, 275.0, 130.0, 310.0, 40.0, 50.0, 40.0, 370.0, 20.0, -20.0, 10.0, 30.0, 240.0, 180.0, 0.0, 80.0, 90.0, 40.0, 0.0, 40.0, 30.0, 50.0, 110.0, 20.0, 0.0, 360.0, 100.0, 30.0, 45.0, 370.0, 20.0, 140.0, 100.0, 10.0, 110.0, 200.0, 50.0, 30.0, 50.0, 20.0, 10.0, 15.0, 10.0, 30.0, 360.0, 50.0, 630.0, 80.0, 70.0, 130.0, 120.0, 0.0, 160.0, 170.0, 5.0, 110.0, 400.0, 50.0, 60.0, -50.0, 30.0, 40.0, 0.0, -10.0, 180.0, 80.0, 130.0, 50.0, 440.0, 130.0, 170.0, 0.0, 60.0, 60.0, 270.0, 30.0, 0.0, 20.0, 30.0, 40.0, 40.0, 260.0, 10.0, 0.0, -40.0, 60.0, 70.0, 90.0, 80.0, 10.0, 150.0, 400.0, 190.0, 180.0, 90.0, 260.0, 0.0, 0.0, 300.0, 0.0, 0.0, -15.0, 30.0, -10.0, 40.0, 20.0, 70.0, 90.0, 140.0, 90.0, 20.0, 100.0, 140.0, 130.0, 180.0, 20.0, 130.0, 400.0, 110.0, 100.0, 60.0, 40.0, 150.0, 50.0, 150.0, 90.0, 0.0, 40.0, 70.0, 40.0, 500.0, 110.0, -40.0, 240.0, 60.0, 100.0, 100.0, 55.0, 160.0, 340.0, 5.0, 170.0, 130.0, 120.0, 110.0, 90.0, 90.0, 20.0, 20.0, 40.0, 100.0, 40.0, 390.0, 20.0, 240.0, 20.0, 100.0, -30.0, -30.0, 410.0, 170.0, 520.0, 80.0, 210.0, 120.0, -30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 190.0, 0.0, 100.0, 140.0, 30.0, 50.0, 220.0, 70.0, 20.0, 20.0, 100.0, 80.0, 40.0, 100.0, 170.0, 100.0, 40.0, 150.0, 130.0, 130.0, 170.0, 260.0, 160.0, 310.0, 170.0, 10.0, 100.0, 40.0, 150.0, 20.0, 150.0, -140.0, 170.0, -40.0, 560.0, 70.0, 140.0, 180.0, 55.0, 70.0, -80.0, -30.0, 90.0, 130.0, -60.0, 230.0, 80.0, 180.0, 40.0, 70.0, 170.0, 340.0, 120.0, 260.0, 260.0, 160.0, 30.0, 110.0, 70.0, 40.0, 20.0, 80.0, 100.0, -60.0, 130.0, 200.0, 50.0, 230.0, 120.0, 50.0, 190.0, 90.0, 50.0, 90.0, 450.0, 120.0, 0.0, -90.0, 110.0, 40.0, 100.0, 320.0, 80.0, 0.0, 70.0, 30.0, 90.0, 0.0, 80.0, 150.0, 160.0, 20.0, 40.0, 120.0, 160.0, 190.0, 90.0, -10.0, 120.0, 50.0, 20.0, 5.0, 20.0, 30.0, 170.0, 390.0, 80.0, 290.0, 170.0, 100.0, 50.0, 120.0, 70.0, 270.0, 160.0, -10.0, 410.0, 40.0, 40.0, 35.0, 10.0, 70.0, 380.0, 30.0, 20.0, 80.0, 70.0, 40.0, 120.0, 520.0, 170.0, 90.0, 20.0, 180.0, 110.0, 180.0, 30.0, 50.0, 160.0, 80.0, 100.0, 50.0, 10.0, 50.0, 40.0, 220.0, 80.0, 530.0, -20.0, 70.0, 80.0, 200.0, 150.0, 220.0, 90.0, 810.0, 30.0, 20.0, -20.0, -90.0, 310.0, 70.0, 110.0, 240.0, 160.0, 60.0, 110.0, 0.0, 200.0, 550.0, 140.0, 20.0, 70.0, 860.0, 60.0, 140.0, 120.0, 100.0, 50.0, 400.0, 110.0, 10.0, 130.0, 90.0, 150.0, 330.0, 30.0, 80.0, 260.0, 50.0, 10.0, 110.0, 120.0, 100.0, 20.0, 0.0, 190.0, 190.0, 40.0, 470.0, 20.0, 40.0, 90.0, 35.0, 40.0, 380.0, 30.0, 190.0, 220.0, 20.0, 90.0, 120.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6728142436844868, "mean_inference_ms": 1.5047090837205852, "mean_action_processing_ms": 0.4251152678356685, "mean_env_wait_ms": 1.3502763883093412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01354837417602539, "StateBufferConnector_ms": 0.01043844223022461, "ViewRequirementAgentConnector_ms": 0.4046511650085449}, "num_episodes": 22, "episode_return_max": 2075.0, "episode_return_min": -75.0, "episode_return_mean": 1099.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.065562178637208, "num_env_steps_trained_throughput_per_sec": 19.065562178637208, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 4880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4880000, "timers": {"training_iteration_time_ms": 208782.093, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208782.049, "sample_time_ms": 2710.861, "learn_time_ms": 206050.701, "learn_throughput": 19.413, "synch_weights_time_ms": 11.776}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "done": false, "training_iteration": 122, "trial_id": "aa996_00000", "date": "2024-05-24_05-50-02", "timestamp": 1716544202, "time_this_iter_s": 209.81175112724304, "time_total_s": 25468.496599197388, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d70040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25468.496599197388, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 19.379461279461275, "ram_util_percent": 78.75656565656566}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9392144562718205, "cur_kl_coeff": 0.6081859588623046, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007182767666297091, "vf_loss": 7.585955972488696, "vf_explained_var": -0.0004434654507012413, "kl": Infinity, "entropy": 0.2873399003054768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1150275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "env_runners": {"episode_reward_max": 2075.0, "episode_reward_min": 210.0, "episode_reward_mean": 1084.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 1120.0}, "policy_reward_mean": {"policy_0": 108.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1080.0, 1395.0, 1080.0, 1135.0, 2075.0, 780.0, 1265.0, 420.0, 1485.0, 955.0, 560.0, 1050.0, 1150.0, 740.0, 550.0, 1460.0, 210.0, 1320.0, 1530.0, 1475.0, 1540.0, 1530.0, 1030.0, 1520.0, 910.0, 955.0, 1315.0, 1240.0, 460.0, 915.0, 1180.0, 970.0, 1530.0, 780.0, 1220.0, 1540.0, 1080.0, 595.0, 1235.0, 1065.0, 1420.0, 280.0, 1520.0, 1085.0, 950.0, 740.0, 1125.0, 625.0, 1475.0, 780.0, 1340.0, 420.0, 1520.0, 365.0, 980.0, 1280.0, 1120.0, 1280.0, 980.0, 1520.0, 430.0, 770.0, 1410.0, 980.0, 1015.0, 1300.0, 1130.0, 1050.0, 1220.0, 640.0, 765.0, 1470.0, 1405.0, 1160.0, 950.0, 1400.0, 1550.0, 1550.0, 1980.0, 1230.0, 1160.0, 1175.0, 480.0, 860.0, 1560.0, 1350.0, 1380.0, 1550.0, 890.0, 1295.0, 1410.0, 410.0, 630.0, 1115.0, 830.0, 515.0, 800.0, 655.0, 370.0, 1450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 80.0, 50.0, 100.0, 20.0, 40.0, 150.0, 400.0, 140.0, 80.0, 220.0, 90.0, 50.0, -25.0, 90.0, 110.0, 420.0, 220.0, 40.0, 180.0, 270.0, 180.0, 10.0, 60.0, 0.0, 30.0, 0.0, 450.0, 20.0, 60.0, -40.0, 20.0, -10.0, 705.0, -40.0, 30.0, 190.0, 40.0, 140.0, 100.0, 160.0, 80.0, 40.0, 130.0, 1120.0, -20.0, 30.0, 620.0, 20.0, -105.0, 120.0, 110.0, 40.0, 120.0, 10.0, 190.0, 130.0, 0.0, 40.0, 20.0, 180.0, 380.0, 85.0, 160.0, -80.0, 50.0, 210.0, 210.0, 0.0, 70.0, 50.0, 40.0, 35.0, 20.0, 40.0, 150.0, 40.0, 10.0, 40.0, -5.0, 60.0, 120.0, 75.0, 50.0, 460.0, 170.0, 240.0, 160.0, 30.0, 120.0, 100.0, 160.0, 200.0, 20.0, 230.0, 10.0, 25.0, 140.0, 60.0, 10.0, 70.0, 20.0, -90.0, 10.0, 40.0, 180.0, 350.0, 50.0, 30.0, -100.0, 60.0, 30.0, 150.0, 90.0, 30.0, 20.0, 30.0, 110.0, 630.0, -100.0, 20.0, 40.0, 320.0, 290.0, 210.0, 30.0, 40.0, 60.0, 20.0, 120.0, 20.0, 100.0, 20.0, 10.0, 10.0, 170.0, 0.0, 110.0, 30.0, 270.0, 10.0, -20.0, 80.0, 50.0, 0.0, 380.0, 0.0, 0.0, 20.0, 30.0, 50.0, 400.0, 110.0, 330.0, 100.0, 130.0, 60.0, 200.0, 50.0, 30.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 90.0, 10.0, 0.0, 30.0, 220.0, 270.0, 20.0, 190.0, 30.0, 30.0, 470.0, 20.0, 40.0, 50.0, 190.0, 30.0, 300.0, 30.0, 30.0, 40.0, 30.0, 640.0, 190.0, 75.0, 90.0, 230.0, 40.0, 260.0, 70.0, 390.0, -10.0, 20.0, 310.0, -90.0, 120.0, 40.0, 90.0, 100.0, 230.0, 180.0, 130.0, 30.0, 710.0, 60.0, 490.0, 340.0, 30.0, 100.0, 90.0, -40.0, 90.0, 330.0, 40.0, 10.0, 160.0, 80.0, 90.0, 180.0, 100.0, 120.0, 170.0, 30.0, 90.0, 70.0, 90.0, 90.0, 100.0, 30.0, 70.0, 140.0, 740.0, 150.0, 40.0, 70.0, 210.0, 20.0, 0.0, 130.0, 30.0, 0.0, 40.0, 80.0, 330.0, 0.0, -15.0, 180.0, 310.0, 60.0, 45.0, -15.0, 110.0, 110.0, 170.0, -180.0, 100.0, 40.0, -10.0, -60.0, 90.0, 100.0, 535.0, 250.0, 450.0, 200.0, 230.0, 180.0, 30.0, 290.0, 170.0, 60.0, 80.0, -25.0, 25.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 10.0, 60.0, 90.0, 30.0, 90.0, 170.0, 20.0, 10.0, 10.0, 50.0, 5.0, 300.0, 100.0, 160.0, 80.0, 20.0, 10.0, 460.0, 20.0, 80.0, 280.0, 190.0, 50.0, -10.0, 80.0, 100.0, 110.0, 200.0, 30.0, 160.0, 50.0, 180.0, 20.0, 40.0, 80.0, 220.0, 180.0, 80.0, 250.0, 470.0, 120.0, 10.0, 40.0, 80.0, 60.0, 10.0, 0.0, 30.0, 150.0, 160.0, 50.0, 70.0, 230.0, 20.0, 30.0, 460.0, 190.0, 50.0, 240.0, 50.0, 10.0, 140.0, 20.0, 30.0, 50.0, 220.0, 280.0, 50.0, 10.0, 330.0, 40.0, 130.0, 110.0, 320.0, 30.0, 20.0, 20.0, 390.0, 170.0, 60.0, 170.0, 120.0, 30.0, 70.0, 30.0, 20.0, -50.0, -5.0, 30.0, 150.0, 80.0, 0.0, 60.0, 280.0, 10.0, 0.0, 40.0, 15.0, 130.0, 720.0, 60.0, 70.0, 20.0, 170.0, 220.0, -140.0, 180.0, 220.0, 170.0, 200.0, 0.0, 160.0, 0.0, 55.0, 240.0, 330.0, 350.0, 210.0, -70.0, 40.0, 0.0, 120.0, 110.0, 90.0, 10.0, 100.0, 20.0, 10.0, 40.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 70.0, 160.0, 440.0, 110.0, 60.0, 160.0, 280.0, 100.0, 160.0, 150.0, 60.0, 10.0, 20.0, 40.0, 275.0, 130.0, 310.0, 40.0, 50.0, 40.0, 370.0, 20.0, -20.0, 10.0, 30.0, 240.0, 180.0, 0.0, 80.0, 90.0, 40.0, 0.0, 40.0, 30.0, 50.0, 110.0, 20.0, 0.0, 360.0, 100.0, 30.0, 45.0, 370.0, 20.0, 140.0, 100.0, 10.0, 110.0, 200.0, 50.0, 30.0, 50.0, 20.0, 10.0, 15.0, 10.0, 30.0, 360.0, 50.0, 630.0, 80.0, 70.0, 130.0, 120.0, 0.0, 160.0, 170.0, 5.0, 110.0, 400.0, 50.0, 60.0, -50.0, 30.0, 40.0, 0.0, -10.0, 180.0, 80.0, 130.0, 50.0, 440.0, 130.0, 170.0, 0.0, 60.0, 60.0, 270.0, 30.0, 0.0, 20.0, 30.0, 40.0, 40.0, 260.0, 10.0, 0.0, -40.0, 60.0, 70.0, 90.0, 80.0, 10.0, 150.0, 400.0, 190.0, 180.0, 90.0, 260.0, 0.0, 0.0, 300.0, 0.0, 0.0, -15.0, 30.0, -10.0, 40.0, 20.0, 70.0, 90.0, 140.0, 90.0, 20.0, 100.0, 140.0, 130.0, 180.0, 20.0, 130.0, 400.0, 110.0, 100.0, 60.0, 40.0, 150.0, 50.0, 150.0, 90.0, 0.0, 40.0, 70.0, 40.0, 500.0, 110.0, -40.0, 240.0, 60.0, 100.0, 100.0, 55.0, 160.0, 340.0, 5.0, 170.0, 130.0, 120.0, 110.0, 90.0, 90.0, 20.0, 20.0, 40.0, 100.0, 40.0, 390.0, 20.0, 240.0, 20.0, 100.0, -30.0, -30.0, 410.0, 170.0, 520.0, 80.0, 210.0, 120.0, -30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 190.0, 0.0, 100.0, 140.0, 30.0, 50.0, 220.0, 70.0, 20.0, 20.0, 100.0, 80.0, 40.0, 100.0, 170.0, 100.0, 40.0, 150.0, 130.0, 130.0, 170.0, 260.0, 160.0, 310.0, 170.0, 10.0, 100.0, 40.0, 150.0, 20.0, 150.0, -140.0, 170.0, -40.0, 560.0, 70.0, 140.0, 180.0, 55.0, 70.0, -80.0, -30.0, 90.0, 130.0, -60.0, 230.0, 80.0, 180.0, 40.0, 70.0, 170.0, 340.0, 120.0, 260.0, 260.0, 160.0, 30.0, 110.0, 70.0, 40.0, 20.0, 80.0, 100.0, -60.0, 130.0, 200.0, 50.0, 230.0, 120.0, 50.0, 190.0, 90.0, 50.0, 90.0, 450.0, 120.0, 0.0, -90.0, 110.0, 40.0, 100.0, 320.0, 80.0, 0.0, 70.0, 30.0, 90.0, 0.0, 80.0, 150.0, 160.0, 20.0, 40.0, 120.0, 160.0, 190.0, 90.0, -10.0, 120.0, 50.0, 20.0, 5.0, 20.0, 30.0, 170.0, 390.0, 80.0, 290.0, 170.0, 100.0, 50.0, 120.0, 70.0, 270.0, 160.0, -10.0, 410.0, 40.0, 40.0, 35.0, 10.0, 70.0, 380.0, 30.0, 20.0, 80.0, 70.0, 40.0, 120.0, 520.0, 170.0, 90.0, 20.0, 180.0, 110.0, 180.0, 30.0, 50.0, 160.0, 80.0, 100.0, 50.0, 10.0, 50.0, 40.0, 220.0, 80.0, 530.0, -20.0, 70.0, 80.0, 200.0, 150.0, 220.0, 90.0, 810.0, 30.0, 20.0, -20.0, -90.0, 310.0, 70.0, 110.0, 240.0, 160.0, 60.0, 110.0, 0.0, 200.0, 550.0, 140.0, 20.0, 70.0, 860.0, 60.0, 140.0, 120.0, 100.0, 50.0, 400.0, 110.0, 10.0, 130.0, 90.0, 150.0, 330.0, 30.0, 80.0, 260.0, 50.0, 10.0, 110.0, 120.0, 100.0, 20.0, 0.0, 190.0, 190.0, 40.0, 470.0, 20.0, 40.0, 90.0, 35.0, 40.0, 380.0, 30.0, 190.0, 220.0, 20.0, 90.0, 120.0, 50.0, 30.0, 160.0, 30.0, 140.0, 50.0, 40.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 190.0, 140.0, 80.0, 30.0, 70.0, 180.0, 60.0, 0.0, 620.0, -10.0, 30.0, 310.0, 170.0, 60.0, 0.0, 150.0, 10.0, 220.0, 110.0, 220.0, 30.0, 230.0, 200.0, 160.0, 170.0, 100.0, 100.0, 30.0, 40.0, -50.0, 80.0, 100.0, 520.0, 20.0, 50.0, 60.0, 300.0, 260.0, 40.0, 240.0, 40.0, 70.0, 280.0, 20.0, 350.0, 390.0, 120.0, 0.0, 50.0, 170.0, 120.0, 150.0, 10.0, 40.0, 10.0, 120.0, 180.0, 40.0, 400.0, 10.0, 250.0, 70.0, 180.0, 30.0, 300.0, 30.0, 20.0, 5.0, 60.0, 50.0, 40.0, 250.0, 100.0, 360.0, 190.0, 180.0, 180.0, 0.0, 40.0, 70.0, 110.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 290.0, 0.0, 0.0, 40.0, 40.0, 150.0, 40.0, 10.0, 0.0, 380.0, 20.0, 110.0, 25.0, 130.0, 210.0, 40.0, 140.0, 0.0, 60.0, 210.0, 190.0, 10.0, 200.0, -120.0, 90.0, 90.0, 110.0, 70.0, -20.0, -90.0, -30.0, 200.0, -55.0, 5.0, 55.0, 5.0, 320.0, 110.0, -5.0, 30.0, 370.0, -20.0, 100.0, 120.0, 70.0, 0.0, 90.0, 20.0, 20.0, 150.0, -40.0, -50.0, 20.0, -15.0, 80.0, 410.0, 0.0, 110.0, -10.0, 20.0, 20.0, 80.0, 40.0, 0.0, 20.0, 50.0, 110.0, 20.0, 10.0, 70.0, 70.0, 140.0, 310.0, 190.0, 330.0, 60.0, 80.0, 60.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6722525782214086, "mean_inference_ms": 1.5050042394302061, "mean_action_processing_ms": 0.42508540438568415, "mean_env_wait_ms": 1.3502890934489649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013478279113769531, "StateBufferConnector_ms": 0.01049661636352539, "ViewRequirementAgentConnector_ms": 0.3985588550567627}, "num_episodes": 18, "episode_return_max": 2075.0, "episode_return_min": 210.0, "episode_return_mean": 1084.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.21053398181255, "num_env_steps_trained_throughput_per_sec": 19.21053398181255, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 4920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4920000, "timers": {"training_iteration_time_ms": 208724.123, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208724.079, "sample_time_ms": 2685.63, "learn_time_ms": 206018.035, "learn_throughput": 19.416, "synch_weights_time_ms": 11.716}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "done": false, "training_iteration": 123, "trial_id": "aa996_00000", "date": "2024-05-24_05-53-31", "timestamp": 1716544411, "time_this_iter_s": 208.22894191741943, "time_total_s": 25676.725541114807, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160a85670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25676.725541114807, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 19.78673469387755, "ram_util_percent": 79.1625850340136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4509302562037214, "cur_kl_coeff": 0.9122789382934572, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0066836398602458345, "vf_loss": 7.6774611070894965, "vf_explained_var": 0.00047897803770721405, "kl": Infinity, "entropy": 0.2820693595134539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1159665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "env_runners": {"episode_reward_max": 2000.0, "episode_reward_min": 280.0, "episode_reward_mean": 1116.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 111.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1530.0, 1475.0, 1540.0, 1530.0, 1030.0, 1520.0, 910.0, 955.0, 1315.0, 1240.0, 460.0, 915.0, 1180.0, 970.0, 1530.0, 780.0, 1220.0, 1540.0, 1080.0, 595.0, 1235.0, 1065.0, 1420.0, 280.0, 1520.0, 1085.0, 950.0, 740.0, 1125.0, 625.0, 1475.0, 780.0, 1340.0, 420.0, 1520.0, 365.0, 980.0, 1280.0, 1120.0, 1280.0, 980.0, 1520.0, 430.0, 770.0, 1410.0, 980.0, 1015.0, 1300.0, 1130.0, 1050.0, 1220.0, 640.0, 765.0, 1470.0, 1405.0, 1160.0, 950.0, 1400.0, 1550.0, 1550.0, 1980.0, 1230.0, 1160.0, 1175.0, 480.0, 860.0, 1560.0, 1350.0, 1380.0, 1550.0, 890.0, 1295.0, 1410.0, 410.0, 630.0, 1115.0, 830.0, 515.0, 800.0, 655.0, 370.0, 1450.0, 1140.0, 940.0, 1210.0, 1580.0, 1220.0, 980.0, 930.0, 1210.0, 1325.0, 930.0, 750.0, 1140.0, 2000.0, 1370.0, 830.0, 1310.0, 1640.0, 1405.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 190.0, 30.0, 300.0, 30.0, 30.0, 40.0, 30.0, 640.0, 190.0, 75.0, 90.0, 230.0, 40.0, 260.0, 70.0, 390.0, -10.0, 20.0, 310.0, -90.0, 120.0, 40.0, 90.0, 100.0, 230.0, 180.0, 130.0, 30.0, 710.0, 60.0, 490.0, 340.0, 30.0, 100.0, 90.0, -40.0, 90.0, 330.0, 40.0, 10.0, 160.0, 80.0, 90.0, 180.0, 100.0, 120.0, 170.0, 30.0, 90.0, 70.0, 90.0, 90.0, 100.0, 30.0, 70.0, 140.0, 740.0, 150.0, 40.0, 70.0, 210.0, 20.0, 0.0, 130.0, 30.0, 0.0, 40.0, 80.0, 330.0, 0.0, -15.0, 180.0, 310.0, 60.0, 45.0, -15.0, 110.0, 110.0, 170.0, -180.0, 100.0, 40.0, -10.0, -60.0, 90.0, 100.0, 535.0, 250.0, 450.0, 200.0, 230.0, 180.0, 30.0, 290.0, 170.0, 60.0, 80.0, -25.0, 25.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 10.0, 60.0, 90.0, 30.0, 90.0, 170.0, 20.0, 10.0, 10.0, 50.0, 5.0, 300.0, 100.0, 160.0, 80.0, 20.0, 10.0, 460.0, 20.0, 80.0, 280.0, 190.0, 50.0, -10.0, 80.0, 100.0, 110.0, 200.0, 30.0, 160.0, 50.0, 180.0, 20.0, 40.0, 80.0, 220.0, 180.0, 80.0, 250.0, 470.0, 120.0, 10.0, 40.0, 80.0, 60.0, 10.0, 0.0, 30.0, 150.0, 160.0, 50.0, 70.0, 230.0, 20.0, 30.0, 460.0, 190.0, 50.0, 240.0, 50.0, 10.0, 140.0, 20.0, 30.0, 50.0, 220.0, 280.0, 50.0, 10.0, 330.0, 40.0, 130.0, 110.0, 320.0, 30.0, 20.0, 20.0, 390.0, 170.0, 60.0, 170.0, 120.0, 30.0, 70.0, 30.0, 20.0, -50.0, -5.0, 30.0, 150.0, 80.0, 0.0, 60.0, 280.0, 10.0, 0.0, 40.0, 15.0, 130.0, 720.0, 60.0, 70.0, 20.0, 170.0, 220.0, -140.0, 180.0, 220.0, 170.0, 200.0, 0.0, 160.0, 0.0, 55.0, 240.0, 330.0, 350.0, 210.0, -70.0, 40.0, 0.0, 120.0, 110.0, 90.0, 10.0, 100.0, 20.0, 10.0, 40.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 70.0, 160.0, 440.0, 110.0, 60.0, 160.0, 280.0, 100.0, 160.0, 150.0, 60.0, 10.0, 20.0, 40.0, 275.0, 130.0, 310.0, 40.0, 50.0, 40.0, 370.0, 20.0, -20.0, 10.0, 30.0, 240.0, 180.0, 0.0, 80.0, 90.0, 40.0, 0.0, 40.0, 30.0, 50.0, 110.0, 20.0, 0.0, 360.0, 100.0, 30.0, 45.0, 370.0, 20.0, 140.0, 100.0, 10.0, 110.0, 200.0, 50.0, 30.0, 50.0, 20.0, 10.0, 15.0, 10.0, 30.0, 360.0, 50.0, 630.0, 80.0, 70.0, 130.0, 120.0, 0.0, 160.0, 170.0, 5.0, 110.0, 400.0, 50.0, 60.0, -50.0, 30.0, 40.0, 0.0, -10.0, 180.0, 80.0, 130.0, 50.0, 440.0, 130.0, 170.0, 0.0, 60.0, 60.0, 270.0, 30.0, 0.0, 20.0, 30.0, 40.0, 40.0, 260.0, 10.0, 0.0, -40.0, 60.0, 70.0, 90.0, 80.0, 10.0, 150.0, 400.0, 190.0, 180.0, 90.0, 260.0, 0.0, 0.0, 300.0, 0.0, 0.0, -15.0, 30.0, -10.0, 40.0, 20.0, 70.0, 90.0, 140.0, 90.0, 20.0, 100.0, 140.0, 130.0, 180.0, 20.0, 130.0, 400.0, 110.0, 100.0, 60.0, 40.0, 150.0, 50.0, 150.0, 90.0, 0.0, 40.0, 70.0, 40.0, 500.0, 110.0, -40.0, 240.0, 60.0, 100.0, 100.0, 55.0, 160.0, 340.0, 5.0, 170.0, 130.0, 120.0, 110.0, 90.0, 90.0, 20.0, 20.0, 40.0, 100.0, 40.0, 390.0, 20.0, 240.0, 20.0, 100.0, -30.0, -30.0, 410.0, 170.0, 520.0, 80.0, 210.0, 120.0, -30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 190.0, 0.0, 100.0, 140.0, 30.0, 50.0, 220.0, 70.0, 20.0, 20.0, 100.0, 80.0, 40.0, 100.0, 170.0, 100.0, 40.0, 150.0, 130.0, 130.0, 170.0, 260.0, 160.0, 310.0, 170.0, 10.0, 100.0, 40.0, 150.0, 20.0, 150.0, -140.0, 170.0, -40.0, 560.0, 70.0, 140.0, 180.0, 55.0, 70.0, -80.0, -30.0, 90.0, 130.0, -60.0, 230.0, 80.0, 180.0, 40.0, 70.0, 170.0, 340.0, 120.0, 260.0, 260.0, 160.0, 30.0, 110.0, 70.0, 40.0, 20.0, 80.0, 100.0, -60.0, 130.0, 200.0, 50.0, 230.0, 120.0, 50.0, 190.0, 90.0, 50.0, 90.0, 450.0, 120.0, 0.0, -90.0, 110.0, 40.0, 100.0, 320.0, 80.0, 0.0, 70.0, 30.0, 90.0, 0.0, 80.0, 150.0, 160.0, 20.0, 40.0, 120.0, 160.0, 190.0, 90.0, -10.0, 120.0, 50.0, 20.0, 5.0, 20.0, 30.0, 170.0, 390.0, 80.0, 290.0, 170.0, 100.0, 50.0, 120.0, 70.0, 270.0, 160.0, -10.0, 410.0, 40.0, 40.0, 35.0, 10.0, 70.0, 380.0, 30.0, 20.0, 80.0, 70.0, 40.0, 120.0, 520.0, 170.0, 90.0, 20.0, 180.0, 110.0, 180.0, 30.0, 50.0, 160.0, 80.0, 100.0, 50.0, 10.0, 50.0, 40.0, 220.0, 80.0, 530.0, -20.0, 70.0, 80.0, 200.0, 150.0, 220.0, 90.0, 810.0, 30.0, 20.0, -20.0, -90.0, 310.0, 70.0, 110.0, 240.0, 160.0, 60.0, 110.0, 0.0, 200.0, 550.0, 140.0, 20.0, 70.0, 860.0, 60.0, 140.0, 120.0, 100.0, 50.0, 400.0, 110.0, 10.0, 130.0, 90.0, 150.0, 330.0, 30.0, 80.0, 260.0, 50.0, 10.0, 110.0, 120.0, 100.0, 20.0, 0.0, 190.0, 190.0, 40.0, 470.0, 20.0, 40.0, 90.0, 35.0, 40.0, 380.0, 30.0, 190.0, 220.0, 20.0, 90.0, 120.0, 50.0, 30.0, 160.0, 30.0, 140.0, 50.0, 40.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 190.0, 140.0, 80.0, 30.0, 70.0, 180.0, 60.0, 0.0, 620.0, -10.0, 30.0, 310.0, 170.0, 60.0, 0.0, 150.0, 10.0, 220.0, 110.0, 220.0, 30.0, 230.0, 200.0, 160.0, 170.0, 100.0, 100.0, 30.0, 40.0, -50.0, 80.0, 100.0, 520.0, 20.0, 50.0, 60.0, 300.0, 260.0, 40.0, 240.0, 40.0, 70.0, 280.0, 20.0, 350.0, 390.0, 120.0, 0.0, 50.0, 170.0, 120.0, 150.0, 10.0, 40.0, 10.0, 120.0, 180.0, 40.0, 400.0, 10.0, 250.0, 70.0, 180.0, 30.0, 300.0, 30.0, 20.0, 5.0, 60.0, 50.0, 40.0, 250.0, 100.0, 360.0, 190.0, 180.0, 180.0, 0.0, 40.0, 70.0, 110.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 290.0, 0.0, 0.0, 40.0, 40.0, 150.0, 40.0, 10.0, 0.0, 380.0, 20.0, 110.0, 25.0, 130.0, 210.0, 40.0, 140.0, 0.0, 60.0, 210.0, 190.0, 10.0, 200.0, -120.0, 90.0, 90.0, 110.0, 70.0, -20.0, -90.0, -30.0, 200.0, -55.0, 5.0, 55.0, 5.0, 320.0, 110.0, -5.0, 30.0, 370.0, -20.0, 100.0, 120.0, 70.0, 0.0, 90.0, 20.0, 20.0, 150.0, -40.0, -50.0, 20.0, -15.0, 80.0, 410.0, 0.0, 110.0, -10.0, 20.0, 20.0, 80.0, 40.0, 0.0, 20.0, 50.0, 110.0, 20.0, 10.0, 70.0, 70.0, 140.0, 310.0, 190.0, 330.0, 60.0, 80.0, 60.0, 140.0, 60.0, 70.0, 90.0, 80.0, 150.0, 390.0, 90.0, 60.0, 60.0, 90.0, 280.0, 50.0, 0.0, 290.0, 20.0, 70.0, 40.0, 30.0, 30.0, 130.0, 50.0, 300.0, 50.0, 20.0, 40.0, 110.0, 520.0, 130.0, -10.0, 0.0, 440.0, 90.0, 80.0, 120.0, 10.0, 220.0, 410.0, 90.0, 30.0, 90.0, 110.0, 50.0, 40.0, 40.0, 20.0, 510.0, 250.0, 120.0, 30.0, 50.0, 320.0, 190.0, 20.0, 20.0, 40.0, 100.0, 90.0, 10.0, -30.0, 220.0, 60.0, 20.0, 60.0, 10.0, 20.0, 310.0, 150.0, 20.0, 270.0, 10.0, 140.0, 130.0, 170.0, 50.0, 40.0, 80.0, 300.0, 100.0, 170.0, 30.0, 80.0, 40.0, 260.0, 40.0, 110.0, 140.0, 510.0, 210.0, -95.0, 30.0, 70.0, 180.0, 100.0, 50.0, 150.0, -10.0, 30.0, 30.0, 270.0, 60.0, -5.0, 10.0, 370.0, 5.0, 50.0, 20.0, 30.0, 10.0, 30.0, 230.0, 70.0, 270.0, 320.0, 90.0, 70.0, 30.0, 210.0, -30.0, 70.0, 40.0, 110.0, 70.0, 200.0, 50.0, 350.0, 240.0, 30.0, 730.0, 160.0, 60.0, 50.0, 110.0, 230.0, 300.0, 230.0, -20.0, 210.0, 160.0, 30.0, 70.0, 130.0, 230.0, 10.0, 190.0, -20.0, 40.0, 40.0, 10.0, 130.0, 70.0, 40.0, 80.0, 160.0, 80.0, 360.0, 340.0, 0.0, 30.0, 170.0, 50.0, 70.0, 190.0, 130.0, 130.0, 80.0, 100.0, 410.0, 100.0, 180.0, 250.0, 0.0, -15.0, 120.0, 130.0, 210.0, 20.0, 200.0, 50.0, 340.0, 350.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.671619623806533, "mean_inference_ms": 1.505214193340808, "mean_action_processing_ms": 0.42504938451540014, "mean_env_wait_ms": 1.3502693983337632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013619422912597656, "StateBufferConnector_ms": 0.010232686996459961, "ViewRequirementAgentConnector_ms": 0.3985002040863037}, "num_episodes": 18, "episode_return_max": 2000.0, "episode_return_min": 280.0, "episode_return_mean": 1116.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.326988549498257, "num_env_steps_trained_throughput_per_sec": 19.326988549498257, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 4960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4960000, "timers": {"training_iteration_time_ms": 208586.376, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208586.331, "sample_time_ms": 2703.835, "learn_time_ms": 205862.201, "learn_throughput": 19.43, "synch_weights_time_ms": 11.491}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "done": false, "training_iteration": 124, "trial_id": "aa996_00000", "date": "2024-05-24_05-56-58", "timestamp": 1716544618, "time_this_iter_s": 206.9753189086914, "time_total_s": 25883.7008600235, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d6de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25883.7008600235, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 18.772013651877135, "ram_util_percent": 78.79863481228669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2487534134850082, "cur_kl_coeff": 1.3684184074401853, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0051399694945235734, "vf_loss": 6.904622424677157, "vf_explained_var": -0.0001716016580502446, "kl": Infinity, "entropy": 0.27958238329877233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1169055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "env_runners": {"episode_reward_max": 2000.0, "episode_reward_min": 180.0, "episode_reward_mean": 1111.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -155.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 111.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 1520.0, 1085.0, 950.0, 740.0, 1125.0, 625.0, 1475.0, 780.0, 1340.0, 420.0, 1520.0, 365.0, 980.0, 1280.0, 1120.0, 1280.0, 980.0, 1520.0, 430.0, 770.0, 1410.0, 980.0, 1015.0, 1300.0, 1130.0, 1050.0, 1220.0, 640.0, 765.0, 1470.0, 1405.0, 1160.0, 950.0, 1400.0, 1550.0, 1550.0, 1980.0, 1230.0, 1160.0, 1175.0, 480.0, 860.0, 1560.0, 1350.0, 1380.0, 1550.0, 890.0, 1295.0, 1410.0, 410.0, 630.0, 1115.0, 830.0, 515.0, 800.0, 655.0, 370.0, 1450.0, 1140.0, 940.0, 1210.0, 1580.0, 1220.0, 980.0, 930.0, 1210.0, 1325.0, 930.0, 750.0, 1140.0, 2000.0, 1370.0, 830.0, 1310.0, 1640.0, 1405.0, 740.0, 1250.0, 810.0, 180.0, 760.0, 1750.0, 1290.0, 1700.0, 960.0, 685.0, 1330.0, 1635.0, 380.0, 950.0, 815.0, 1340.0, 1140.0, 1460.0, 790.0, 1080.0, 1930.0, 2000.0, 1580.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 100.0, 20.0, 10.0, 40.0, 10.0, 20.0, 20.0, 10.0, 40.0, -20.0, 70.0, 160.0, 440.0, 110.0, 60.0, 160.0, 280.0, 100.0, 160.0, 150.0, 60.0, 10.0, 20.0, 40.0, 275.0, 130.0, 310.0, 40.0, 50.0, 40.0, 370.0, 20.0, -20.0, 10.0, 30.0, 240.0, 180.0, 0.0, 80.0, 90.0, 40.0, 0.0, 40.0, 30.0, 50.0, 110.0, 20.0, 0.0, 360.0, 100.0, 30.0, 45.0, 370.0, 20.0, 140.0, 100.0, 10.0, 110.0, 200.0, 50.0, 30.0, 50.0, 20.0, 10.0, 15.0, 10.0, 30.0, 360.0, 50.0, 630.0, 80.0, 70.0, 130.0, 120.0, 0.0, 160.0, 170.0, 5.0, 110.0, 400.0, 50.0, 60.0, -50.0, 30.0, 40.0, 0.0, -10.0, 180.0, 80.0, 130.0, 50.0, 440.0, 130.0, 170.0, 0.0, 60.0, 60.0, 270.0, 30.0, 0.0, 20.0, 30.0, 40.0, 40.0, 260.0, 10.0, 0.0, -40.0, 60.0, 70.0, 90.0, 80.0, 10.0, 150.0, 400.0, 190.0, 180.0, 90.0, 260.0, 0.0, 0.0, 300.0, 0.0, 0.0, -15.0, 30.0, -10.0, 40.0, 20.0, 70.0, 90.0, 140.0, 90.0, 20.0, 100.0, 140.0, 130.0, 180.0, 20.0, 130.0, 400.0, 110.0, 100.0, 60.0, 40.0, 150.0, 50.0, 150.0, 90.0, 0.0, 40.0, 70.0, 40.0, 500.0, 110.0, -40.0, 240.0, 60.0, 100.0, 100.0, 55.0, 160.0, 340.0, 5.0, 170.0, 130.0, 120.0, 110.0, 90.0, 90.0, 20.0, 20.0, 40.0, 100.0, 40.0, 390.0, 20.0, 240.0, 20.0, 100.0, -30.0, -30.0, 410.0, 170.0, 520.0, 80.0, 210.0, 120.0, -30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 190.0, 0.0, 100.0, 140.0, 30.0, 50.0, 220.0, 70.0, 20.0, 20.0, 100.0, 80.0, 40.0, 100.0, 170.0, 100.0, 40.0, 150.0, 130.0, 130.0, 170.0, 260.0, 160.0, 310.0, 170.0, 10.0, 100.0, 40.0, 150.0, 20.0, 150.0, -140.0, 170.0, -40.0, 560.0, 70.0, 140.0, 180.0, 55.0, 70.0, -80.0, -30.0, 90.0, 130.0, -60.0, 230.0, 80.0, 180.0, 40.0, 70.0, 170.0, 340.0, 120.0, 260.0, 260.0, 160.0, 30.0, 110.0, 70.0, 40.0, 20.0, 80.0, 100.0, -60.0, 130.0, 200.0, 50.0, 230.0, 120.0, 50.0, 190.0, 90.0, 50.0, 90.0, 450.0, 120.0, 0.0, -90.0, 110.0, 40.0, 100.0, 320.0, 80.0, 0.0, 70.0, 30.0, 90.0, 0.0, 80.0, 150.0, 160.0, 20.0, 40.0, 120.0, 160.0, 190.0, 90.0, -10.0, 120.0, 50.0, 20.0, 5.0, 20.0, 30.0, 170.0, 390.0, 80.0, 290.0, 170.0, 100.0, 50.0, 120.0, 70.0, 270.0, 160.0, -10.0, 410.0, 40.0, 40.0, 35.0, 10.0, 70.0, 380.0, 30.0, 20.0, 80.0, 70.0, 40.0, 120.0, 520.0, 170.0, 90.0, 20.0, 180.0, 110.0, 180.0, 30.0, 50.0, 160.0, 80.0, 100.0, 50.0, 10.0, 50.0, 40.0, 220.0, 80.0, 530.0, -20.0, 70.0, 80.0, 200.0, 150.0, 220.0, 90.0, 810.0, 30.0, 20.0, -20.0, -90.0, 310.0, 70.0, 110.0, 240.0, 160.0, 60.0, 110.0, 0.0, 200.0, 550.0, 140.0, 20.0, 70.0, 860.0, 60.0, 140.0, 120.0, 100.0, 50.0, 400.0, 110.0, 10.0, 130.0, 90.0, 150.0, 330.0, 30.0, 80.0, 260.0, 50.0, 10.0, 110.0, 120.0, 100.0, 20.0, 0.0, 190.0, 190.0, 40.0, 470.0, 20.0, 40.0, 90.0, 35.0, 40.0, 380.0, 30.0, 190.0, 220.0, 20.0, 90.0, 120.0, 50.0, 30.0, 160.0, 30.0, 140.0, 50.0, 40.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 190.0, 140.0, 80.0, 30.0, 70.0, 180.0, 60.0, 0.0, 620.0, -10.0, 30.0, 310.0, 170.0, 60.0, 0.0, 150.0, 10.0, 220.0, 110.0, 220.0, 30.0, 230.0, 200.0, 160.0, 170.0, 100.0, 100.0, 30.0, 40.0, -50.0, 80.0, 100.0, 520.0, 20.0, 50.0, 60.0, 300.0, 260.0, 40.0, 240.0, 40.0, 70.0, 280.0, 20.0, 350.0, 390.0, 120.0, 0.0, 50.0, 170.0, 120.0, 150.0, 10.0, 40.0, 10.0, 120.0, 180.0, 40.0, 400.0, 10.0, 250.0, 70.0, 180.0, 30.0, 300.0, 30.0, 20.0, 5.0, 60.0, 50.0, 40.0, 250.0, 100.0, 360.0, 190.0, 180.0, 180.0, 0.0, 40.0, 70.0, 110.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 290.0, 0.0, 0.0, 40.0, 40.0, 150.0, 40.0, 10.0, 0.0, 380.0, 20.0, 110.0, 25.0, 130.0, 210.0, 40.0, 140.0, 0.0, 60.0, 210.0, 190.0, 10.0, 200.0, -120.0, 90.0, 90.0, 110.0, 70.0, -20.0, -90.0, -30.0, 200.0, -55.0, 5.0, 55.0, 5.0, 320.0, 110.0, -5.0, 30.0, 370.0, -20.0, 100.0, 120.0, 70.0, 0.0, 90.0, 20.0, 20.0, 150.0, -40.0, -50.0, 20.0, -15.0, 80.0, 410.0, 0.0, 110.0, -10.0, 20.0, 20.0, 80.0, 40.0, 0.0, 20.0, 50.0, 110.0, 20.0, 10.0, 70.0, 70.0, 140.0, 310.0, 190.0, 330.0, 60.0, 80.0, 60.0, 140.0, 60.0, 70.0, 90.0, 80.0, 150.0, 390.0, 90.0, 60.0, 60.0, 90.0, 280.0, 50.0, 0.0, 290.0, 20.0, 70.0, 40.0, 30.0, 30.0, 130.0, 50.0, 300.0, 50.0, 20.0, 40.0, 110.0, 520.0, 130.0, -10.0, 0.0, 440.0, 90.0, 80.0, 120.0, 10.0, 220.0, 410.0, 90.0, 30.0, 90.0, 110.0, 50.0, 40.0, 40.0, 20.0, 510.0, 250.0, 120.0, 30.0, 50.0, 320.0, 190.0, 20.0, 20.0, 40.0, 100.0, 90.0, 10.0, -30.0, 220.0, 60.0, 20.0, 60.0, 10.0, 20.0, 310.0, 150.0, 20.0, 270.0, 10.0, 140.0, 130.0, 170.0, 50.0, 40.0, 80.0, 300.0, 100.0, 170.0, 30.0, 80.0, 40.0, 260.0, 40.0, 110.0, 140.0, 510.0, 210.0, -95.0, 30.0, 70.0, 180.0, 100.0, 50.0, 150.0, -10.0, 30.0, 30.0, 270.0, 60.0, -5.0, 10.0, 370.0, 5.0, 50.0, 20.0, 30.0, 10.0, 30.0, 230.0, 70.0, 270.0, 320.0, 90.0, 70.0, 30.0, 210.0, -30.0, 70.0, 40.0, 110.0, 70.0, 200.0, 50.0, 350.0, 240.0, 30.0, 730.0, 160.0, 60.0, 50.0, 110.0, 230.0, 300.0, 230.0, -20.0, 210.0, 160.0, 30.0, 70.0, 130.0, 230.0, 10.0, 190.0, -20.0, 40.0, 40.0, 10.0, 130.0, 70.0, 40.0, 80.0, 160.0, 80.0, 360.0, 340.0, 0.0, 30.0, 170.0, 50.0, 70.0, 190.0, 130.0, 130.0, 80.0, 100.0, 410.0, 100.0, 180.0, 250.0, 0.0, -15.0, 120.0, 130.0, 210.0, 20.0, 200.0, 50.0, 340.0, 350.0, 40.0, 30.0, 100.0, 80.0, -80.0, 20.0, 200.0, 0.0, 0.0, 350.0, 60.0, 150.0, 100.0, 140.0, 10.0, 20.0, 240.0, 20.0, 470.0, 40.0, 60.0, 70.0, 90.0, 110.0, 90.0, 150.0, 80.0, 30.0, 110.0, 20.0, 20.0, 110.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 180.0, 70.0, 30.0, 170.0, 160.0, 60.0, 500.0, 40.0, 30.0, 40.0, 130.0, 400.0, 470.0, -20.0, 160.0, 0.0, 70.0, 210.0, 120.0, 70.0, 120.0, 100.0, 40.0, 110.0, 440.0, 10.0, 350.0, 90.0, 150.0, 100.0, 120.0, 510.0, 150.0, 60.0, 80.0, 90.0, 70.0, 330.0, 60.0, 70.0, 100.0, 130.0, 80.0, 30.0, 90.0, 0.0, 100.0, 0.0, 250.0, -5.0, 30.0, 100.0, 20.0, 180.0, 0.0, 10.0, 230.0, 60.0, 30.0, 0.0, 210.0, 100.0, 320.0, 70.0, 200.0, 110.0, 40.0, 510.0, 290.0, 50.0, -110.0, 200.0, 310.0, 60.0, 145.0, 140.0, 10.0, 10.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 80.0, 10.0, 30.0, 10.0, 110.0, 100.0, 280.0, 150.0, 230.0, 10.0, 20.0, 290.0, 160.0, 250.0, 50.0, 40.0, 10.0, -65.0, 0.0, 10.0, 70.0, 70.0, 110.0, 50.0, -30.0, 110.0, 290.0, 550.0, 50.0, 50.0, 90.0, 180.0, 100.0, 50.0, 20.0, 20.0, 280.0, 30.0, 40.0, 80.0, 340.0, 60.0, 490.0, 10.0, 220.0, 10.0, 50.0, 240.0, 320.0, -10.0, 70.0, 280.0, 30.0, 70.0, -155.0, 50.0, 50.0, -135.0, 470.0, 80.0, 50.0, 150.0, 40.0, 300.0, 70.0, 20.0, 180.0, 110.0, -140.0, 210.0, 140.0, 390.0, 140.0, 90.0, 180.0, 130.0, 140.0, 480.0, 130.0, 60.0, 190.0, 190.0, 190.0, 110.0, 40.0, 140.0, 500.0, 100.0, 390.0, 100.0, 240.0, 30.0, 100.0, 490.0, 20.0, 20.0, 30.0, 260.0, 200.0, 310.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.670279605720082, "mean_inference_ms": 1.504711412651543, "mean_action_processing_ms": 0.4248340225840086, "mean_env_wait_ms": 1.3497956566356382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01310873031616211, "StateBufferConnector_ms": 0.010033845901489258, "ViewRequirementAgentConnector_ms": 0.3925011157989502}, "num_episodes": 23, "episode_return_max": 2000.0, "episode_return_min": 180.0, "episode_return_mean": 1111.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.156255639715965, "num_env_steps_trained_throughput_per_sec": 19.156255639715965, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 5000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000000, "timers": {"training_iteration_time_ms": 208558.552, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208558.508, "sample_time_ms": 2712.819, "learn_time_ms": 205825.342, "learn_throughput": 19.434, "synch_weights_time_ms": 11.485}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "done": false, "training_iteration": 125, "trial_id": "aa996_00000", "date": "2024-05-24_06-00-26", "timestamp": 1716544826, "time_this_iter_s": 208.8181722164154, "time_total_s": 26092.519032239914, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160ab4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26092.519032239914, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 19.18677966101695, "ram_util_percent": 78.77966101694915}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.961369863809488, "cur_kl_coeff": 2.0526276111602786, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.221832919501649, "policy_loss": -0.005952418810926989, "vf_loss": 7.225019660671425, "vf_explained_var": 0.0005157316581636699, "kl": 0.001347379297375774, "entropy": 0.2688849849759326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1178445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "env_runners": {"episode_reward_max": 2000.0, "episode_reward_min": 180.0, "episode_reward_mean": 1142.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -155.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 114.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1520.0, 430.0, 770.0, 1410.0, 980.0, 1015.0, 1300.0, 1130.0, 1050.0, 1220.0, 640.0, 765.0, 1470.0, 1405.0, 1160.0, 950.0, 1400.0, 1550.0, 1550.0, 1980.0, 1230.0, 1160.0, 1175.0, 480.0, 860.0, 1560.0, 1350.0, 1380.0, 1550.0, 890.0, 1295.0, 1410.0, 410.0, 630.0, 1115.0, 830.0, 515.0, 800.0, 655.0, 370.0, 1450.0, 1140.0, 940.0, 1210.0, 1580.0, 1220.0, 980.0, 930.0, 1210.0, 1325.0, 930.0, 750.0, 1140.0, 2000.0, 1370.0, 830.0, 1310.0, 1640.0, 1405.0, 740.0, 1250.0, 810.0, 180.0, 760.0, 1750.0, 1290.0, 1700.0, 960.0, 685.0, 1330.0, 1635.0, 380.0, 950.0, 815.0, 1340.0, 1140.0, 1460.0, 790.0, 1080.0, 1930.0, 2000.0, 1580.0, 1520.0, 580.0, 910.0, 1240.0, 200.0, 1500.0, 440.0, 1530.0, 795.0, 1140.0, 1655.0, 1380.0, 870.0, 1590.0, 1895.0, 1940.0, 1390.0, 390.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, -30.0, -30.0, 410.0, 170.0, 520.0, 80.0, 210.0, 120.0, -30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 190.0, 0.0, 100.0, 140.0, 30.0, 50.0, 220.0, 70.0, 20.0, 20.0, 100.0, 80.0, 40.0, 100.0, 170.0, 100.0, 40.0, 150.0, 130.0, 130.0, 170.0, 260.0, 160.0, 310.0, 170.0, 10.0, 100.0, 40.0, 150.0, 20.0, 150.0, -140.0, 170.0, -40.0, 560.0, 70.0, 140.0, 180.0, 55.0, 70.0, -80.0, -30.0, 90.0, 130.0, -60.0, 230.0, 80.0, 180.0, 40.0, 70.0, 170.0, 340.0, 120.0, 260.0, 260.0, 160.0, 30.0, 110.0, 70.0, 40.0, 20.0, 80.0, 100.0, -60.0, 130.0, 200.0, 50.0, 230.0, 120.0, 50.0, 190.0, 90.0, 50.0, 90.0, 450.0, 120.0, 0.0, -90.0, 110.0, 40.0, 100.0, 320.0, 80.0, 0.0, 70.0, 30.0, 90.0, 0.0, 80.0, 150.0, 160.0, 20.0, 40.0, 120.0, 160.0, 190.0, 90.0, -10.0, 120.0, 50.0, 20.0, 5.0, 20.0, 30.0, 170.0, 390.0, 80.0, 290.0, 170.0, 100.0, 50.0, 120.0, 70.0, 270.0, 160.0, -10.0, 410.0, 40.0, 40.0, 35.0, 10.0, 70.0, 380.0, 30.0, 20.0, 80.0, 70.0, 40.0, 120.0, 520.0, 170.0, 90.0, 20.0, 180.0, 110.0, 180.0, 30.0, 50.0, 160.0, 80.0, 100.0, 50.0, 10.0, 50.0, 40.0, 220.0, 80.0, 530.0, -20.0, 70.0, 80.0, 200.0, 150.0, 220.0, 90.0, 810.0, 30.0, 20.0, -20.0, -90.0, 310.0, 70.0, 110.0, 240.0, 160.0, 60.0, 110.0, 0.0, 200.0, 550.0, 140.0, 20.0, 70.0, 860.0, 60.0, 140.0, 120.0, 100.0, 50.0, 400.0, 110.0, 10.0, 130.0, 90.0, 150.0, 330.0, 30.0, 80.0, 260.0, 50.0, 10.0, 110.0, 120.0, 100.0, 20.0, 0.0, 190.0, 190.0, 40.0, 470.0, 20.0, 40.0, 90.0, 35.0, 40.0, 380.0, 30.0, 190.0, 220.0, 20.0, 90.0, 120.0, 50.0, 30.0, 160.0, 30.0, 140.0, 50.0, 40.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 190.0, 140.0, 80.0, 30.0, 70.0, 180.0, 60.0, 0.0, 620.0, -10.0, 30.0, 310.0, 170.0, 60.0, 0.0, 150.0, 10.0, 220.0, 110.0, 220.0, 30.0, 230.0, 200.0, 160.0, 170.0, 100.0, 100.0, 30.0, 40.0, -50.0, 80.0, 100.0, 520.0, 20.0, 50.0, 60.0, 300.0, 260.0, 40.0, 240.0, 40.0, 70.0, 280.0, 20.0, 350.0, 390.0, 120.0, 0.0, 50.0, 170.0, 120.0, 150.0, 10.0, 40.0, 10.0, 120.0, 180.0, 40.0, 400.0, 10.0, 250.0, 70.0, 180.0, 30.0, 300.0, 30.0, 20.0, 5.0, 60.0, 50.0, 40.0, 250.0, 100.0, 360.0, 190.0, 180.0, 180.0, 0.0, 40.0, 70.0, 110.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 290.0, 0.0, 0.0, 40.0, 40.0, 150.0, 40.0, 10.0, 0.0, 380.0, 20.0, 110.0, 25.0, 130.0, 210.0, 40.0, 140.0, 0.0, 60.0, 210.0, 190.0, 10.0, 200.0, -120.0, 90.0, 90.0, 110.0, 70.0, -20.0, -90.0, -30.0, 200.0, -55.0, 5.0, 55.0, 5.0, 320.0, 110.0, -5.0, 30.0, 370.0, -20.0, 100.0, 120.0, 70.0, 0.0, 90.0, 20.0, 20.0, 150.0, -40.0, -50.0, 20.0, -15.0, 80.0, 410.0, 0.0, 110.0, -10.0, 20.0, 20.0, 80.0, 40.0, 0.0, 20.0, 50.0, 110.0, 20.0, 10.0, 70.0, 70.0, 140.0, 310.0, 190.0, 330.0, 60.0, 80.0, 60.0, 140.0, 60.0, 70.0, 90.0, 80.0, 150.0, 390.0, 90.0, 60.0, 60.0, 90.0, 280.0, 50.0, 0.0, 290.0, 20.0, 70.0, 40.0, 30.0, 30.0, 130.0, 50.0, 300.0, 50.0, 20.0, 40.0, 110.0, 520.0, 130.0, -10.0, 0.0, 440.0, 90.0, 80.0, 120.0, 10.0, 220.0, 410.0, 90.0, 30.0, 90.0, 110.0, 50.0, 40.0, 40.0, 20.0, 510.0, 250.0, 120.0, 30.0, 50.0, 320.0, 190.0, 20.0, 20.0, 40.0, 100.0, 90.0, 10.0, -30.0, 220.0, 60.0, 20.0, 60.0, 10.0, 20.0, 310.0, 150.0, 20.0, 270.0, 10.0, 140.0, 130.0, 170.0, 50.0, 40.0, 80.0, 300.0, 100.0, 170.0, 30.0, 80.0, 40.0, 260.0, 40.0, 110.0, 140.0, 510.0, 210.0, -95.0, 30.0, 70.0, 180.0, 100.0, 50.0, 150.0, -10.0, 30.0, 30.0, 270.0, 60.0, -5.0, 10.0, 370.0, 5.0, 50.0, 20.0, 30.0, 10.0, 30.0, 230.0, 70.0, 270.0, 320.0, 90.0, 70.0, 30.0, 210.0, -30.0, 70.0, 40.0, 110.0, 70.0, 200.0, 50.0, 350.0, 240.0, 30.0, 730.0, 160.0, 60.0, 50.0, 110.0, 230.0, 300.0, 230.0, -20.0, 210.0, 160.0, 30.0, 70.0, 130.0, 230.0, 10.0, 190.0, -20.0, 40.0, 40.0, 10.0, 130.0, 70.0, 40.0, 80.0, 160.0, 80.0, 360.0, 340.0, 0.0, 30.0, 170.0, 50.0, 70.0, 190.0, 130.0, 130.0, 80.0, 100.0, 410.0, 100.0, 180.0, 250.0, 0.0, -15.0, 120.0, 130.0, 210.0, 20.0, 200.0, 50.0, 340.0, 350.0, 40.0, 30.0, 100.0, 80.0, -80.0, 20.0, 200.0, 0.0, 0.0, 350.0, 60.0, 150.0, 100.0, 140.0, 10.0, 20.0, 240.0, 20.0, 470.0, 40.0, 60.0, 70.0, 90.0, 110.0, 90.0, 150.0, 80.0, 30.0, 110.0, 20.0, 20.0, 110.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 180.0, 70.0, 30.0, 170.0, 160.0, 60.0, 500.0, 40.0, 30.0, 40.0, 130.0, 400.0, 470.0, -20.0, 160.0, 0.0, 70.0, 210.0, 120.0, 70.0, 120.0, 100.0, 40.0, 110.0, 440.0, 10.0, 350.0, 90.0, 150.0, 100.0, 120.0, 510.0, 150.0, 60.0, 80.0, 90.0, 70.0, 330.0, 60.0, 70.0, 100.0, 130.0, 80.0, 30.0, 90.0, 0.0, 100.0, 0.0, 250.0, -5.0, 30.0, 100.0, 20.0, 180.0, 0.0, 10.0, 230.0, 60.0, 30.0, 0.0, 210.0, 100.0, 320.0, 70.0, 200.0, 110.0, 40.0, 510.0, 290.0, 50.0, -110.0, 200.0, 310.0, 60.0, 145.0, 140.0, 10.0, 10.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 80.0, 10.0, 30.0, 10.0, 110.0, 100.0, 280.0, 150.0, 230.0, 10.0, 20.0, 290.0, 160.0, 250.0, 50.0, 40.0, 10.0, -65.0, 0.0, 10.0, 70.0, 70.0, 110.0, 50.0, -30.0, 110.0, 290.0, 550.0, 50.0, 50.0, 90.0, 180.0, 100.0, 50.0, 20.0, 20.0, 280.0, 30.0, 40.0, 80.0, 340.0, 60.0, 490.0, 10.0, 220.0, 10.0, 50.0, 240.0, 320.0, -10.0, 70.0, 280.0, 30.0, 70.0, -155.0, 50.0, 50.0, -135.0, 470.0, 80.0, 50.0, 150.0, 40.0, 300.0, 70.0, 20.0, 180.0, 110.0, -140.0, 210.0, 140.0, 390.0, 140.0, 90.0, 180.0, 130.0, 140.0, 480.0, 130.0, 60.0, 190.0, 190.0, 190.0, 110.0, 40.0, 140.0, 500.0, 100.0, 390.0, 100.0, 240.0, 30.0, 100.0, 490.0, 20.0, 20.0, 30.0, 260.0, 200.0, 310.0, 120.0, 80.0, 80.0, 120.0, 210.0, 500.0, 240.0, 50.0, 120.0, 60.0, 60.0, 90.0, 20.0, 50.0, 120.0, 150.0, 20.0, 40.0, 40.0, 10.0, 40.0, 70.0, 70.0, 260.0, 30.0, 90.0, 90.0, 160.0, 110.0, 10.0, 20.0, 180.0, 320.0, 70.0, 130.0, 30.0, 0.0, -50.0, -50.0, 50.0, 560.0, 0.0, 10.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 0.0, 190.0, 240.0, 80.0, 180.0, 80.0, 40.0, 70.0, 600.0, 60.0, 90.0, 40.0, 40.0, 20.0, 10.0, 50.0, 40.0, 60.0, 30.0, 140.0, 100.0, 290.0, 50.0, 370.0, 200.0, 120.0, 100.0, 60.0, 100.0, 40.0, 210.0, 20.0, 20.0, 60.0, 310.0, 110.0, 10.0, 15.0, 0.0, 170.0, -20.0, 280.0, 10.0, 50.0, 130.0, 150.0, 110.0, 210.0, 50.0, 450.0, 80.0, 160.0, 430.0, 190.0, 30.0, 5.0, -10.0, 150.0, 170.0, 340.0, -100.0, 160.0, 170.0, 70.0, 180.0, 80.0, 20.0, 20.0, 440.0, 10.0, 80.0, 70.0, 70.0, 10.0, 40.0, 230.0, 20.0, 30.0, 310.0, 20.0, 190.0, -10.0, 80.0, 90.0, 320.0, 80.0, 140.0, 110.0, 570.0, 630.0, 160.0, 120.0, 740.0, 70.0, 80.0, 40.0, 10.0, 30.0, 15.0, 510.0, 70.0, 180.0, 540.0, 10.0, 80.0, 30.0, 250.0, 250.0, 20.0, 170.0, 80.0, 10.0, 130.0, 410.0, 40.0, 150.0, 150.0, 210.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 90.0, 20.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6690870835858507, "mean_inference_ms": 1.504234003388584, "mean_action_processing_ms": 0.4246717922898851, "mean_env_wait_ms": 1.3494071065314455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013036251068115234, "StateBufferConnector_ms": 0.01005411148071289, "ViewRequirementAgentConnector_ms": 0.3866565227508545}, "num_episodes": 18, "episode_return_max": 2000.0, "episode_return_min": 180.0, "episode_return_mean": 1142.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.217772965099382, "num_env_steps_trained_throughput_per_sec": 19.217772965099382, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 5040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5040000, "timers": {"training_iteration_time_ms": 208543.478, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208543.434, "sample_time_ms": 2682.817, "learn_time_ms": 205840.163, "learn_throughput": 19.433, "synch_weights_time_ms": 11.654}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "done": false, "training_iteration": 126, "trial_id": "aa996_00000", "date": "2024-05-24_06-03-55", "timestamp": 1716545035, "time_this_iter_s": 208.14980292320251, "time_total_s": 26300.668835163116, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b301f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26300.668835163116, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 18.853559322033902, "ram_util_percent": 79.15525423728813}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.442024650512793, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.258316362957858, "policy_loss": -0.006041098361650405, "vf_loss": 7.2622236795699635, "vf_explained_var": 0.00022687283567727183, "kl": 0.002079072301873112, "entropy": 0.2575492512240323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1187835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "env_runners": {"episode_reward_max": 2100.0, "episode_reward_min": 170.0, "episode_reward_mean": 1116.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 111.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1175.0, 480.0, 860.0, 1560.0, 1350.0, 1380.0, 1550.0, 890.0, 1295.0, 1410.0, 410.0, 630.0, 1115.0, 830.0, 515.0, 800.0, 655.0, 370.0, 1450.0, 1140.0, 940.0, 1210.0, 1580.0, 1220.0, 980.0, 930.0, 1210.0, 1325.0, 930.0, 750.0, 1140.0, 2000.0, 1370.0, 830.0, 1310.0, 1640.0, 1405.0, 740.0, 1250.0, 810.0, 180.0, 760.0, 1750.0, 1290.0, 1700.0, 960.0, 685.0, 1330.0, 1635.0, 380.0, 950.0, 815.0, 1340.0, 1140.0, 1460.0, 790.0, 1080.0, 1930.0, 2000.0, 1580.0, 1520.0, 580.0, 910.0, 1240.0, 200.0, 1500.0, 440.0, 1530.0, 795.0, 1140.0, 1655.0, 1380.0, 870.0, 1590.0, 1895.0, 1940.0, 1390.0, 390.0, 855.0, 1610.0, 710.0, 1000.0, 1450.0, 470.0, 1190.0, 230.0, 1285.0, 1230.0, 1170.0, 1230.0, 1645.0, 220.0, 760.0, 1160.0, 170.0, 2100.0, 1050.0, 1240.0, 1460.0, 1250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [35.0, 40.0, 380.0, 30.0, 190.0, 220.0, 20.0, 90.0, 120.0, 50.0, 30.0, 160.0, 30.0, 140.0, 50.0, 40.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 190.0, 140.0, 80.0, 30.0, 70.0, 180.0, 60.0, 0.0, 620.0, -10.0, 30.0, 310.0, 170.0, 60.0, 0.0, 150.0, 10.0, 220.0, 110.0, 220.0, 30.0, 230.0, 200.0, 160.0, 170.0, 100.0, 100.0, 30.0, 40.0, -50.0, 80.0, 100.0, 520.0, 20.0, 50.0, 60.0, 300.0, 260.0, 40.0, 240.0, 40.0, 70.0, 280.0, 20.0, 350.0, 390.0, 120.0, 0.0, 50.0, 170.0, 120.0, 150.0, 10.0, 40.0, 10.0, 120.0, 180.0, 40.0, 400.0, 10.0, 250.0, 70.0, 180.0, 30.0, 300.0, 30.0, 20.0, 5.0, 60.0, 50.0, 40.0, 250.0, 100.0, 360.0, 190.0, 180.0, 180.0, 0.0, 40.0, 70.0, 110.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 290.0, 0.0, 0.0, 40.0, 40.0, 150.0, 40.0, 10.0, 0.0, 380.0, 20.0, 110.0, 25.0, 130.0, 210.0, 40.0, 140.0, 0.0, 60.0, 210.0, 190.0, 10.0, 200.0, -120.0, 90.0, 90.0, 110.0, 70.0, -20.0, -90.0, -30.0, 200.0, -55.0, 5.0, 55.0, 5.0, 320.0, 110.0, -5.0, 30.0, 370.0, -20.0, 100.0, 120.0, 70.0, 0.0, 90.0, 20.0, 20.0, 150.0, -40.0, -50.0, 20.0, -15.0, 80.0, 410.0, 0.0, 110.0, -10.0, 20.0, 20.0, 80.0, 40.0, 0.0, 20.0, 50.0, 110.0, 20.0, 10.0, 70.0, 70.0, 140.0, 310.0, 190.0, 330.0, 60.0, 80.0, 60.0, 140.0, 60.0, 70.0, 90.0, 80.0, 150.0, 390.0, 90.0, 60.0, 60.0, 90.0, 280.0, 50.0, 0.0, 290.0, 20.0, 70.0, 40.0, 30.0, 30.0, 130.0, 50.0, 300.0, 50.0, 20.0, 40.0, 110.0, 520.0, 130.0, -10.0, 0.0, 440.0, 90.0, 80.0, 120.0, 10.0, 220.0, 410.0, 90.0, 30.0, 90.0, 110.0, 50.0, 40.0, 40.0, 20.0, 510.0, 250.0, 120.0, 30.0, 50.0, 320.0, 190.0, 20.0, 20.0, 40.0, 100.0, 90.0, 10.0, -30.0, 220.0, 60.0, 20.0, 60.0, 10.0, 20.0, 310.0, 150.0, 20.0, 270.0, 10.0, 140.0, 130.0, 170.0, 50.0, 40.0, 80.0, 300.0, 100.0, 170.0, 30.0, 80.0, 40.0, 260.0, 40.0, 110.0, 140.0, 510.0, 210.0, -95.0, 30.0, 70.0, 180.0, 100.0, 50.0, 150.0, -10.0, 30.0, 30.0, 270.0, 60.0, -5.0, 10.0, 370.0, 5.0, 50.0, 20.0, 30.0, 10.0, 30.0, 230.0, 70.0, 270.0, 320.0, 90.0, 70.0, 30.0, 210.0, -30.0, 70.0, 40.0, 110.0, 70.0, 200.0, 50.0, 350.0, 240.0, 30.0, 730.0, 160.0, 60.0, 50.0, 110.0, 230.0, 300.0, 230.0, -20.0, 210.0, 160.0, 30.0, 70.0, 130.0, 230.0, 10.0, 190.0, -20.0, 40.0, 40.0, 10.0, 130.0, 70.0, 40.0, 80.0, 160.0, 80.0, 360.0, 340.0, 0.0, 30.0, 170.0, 50.0, 70.0, 190.0, 130.0, 130.0, 80.0, 100.0, 410.0, 100.0, 180.0, 250.0, 0.0, -15.0, 120.0, 130.0, 210.0, 20.0, 200.0, 50.0, 340.0, 350.0, 40.0, 30.0, 100.0, 80.0, -80.0, 20.0, 200.0, 0.0, 0.0, 350.0, 60.0, 150.0, 100.0, 140.0, 10.0, 20.0, 240.0, 20.0, 470.0, 40.0, 60.0, 70.0, 90.0, 110.0, 90.0, 150.0, 80.0, 30.0, 110.0, 20.0, 20.0, 110.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 180.0, 70.0, 30.0, 170.0, 160.0, 60.0, 500.0, 40.0, 30.0, 40.0, 130.0, 400.0, 470.0, -20.0, 160.0, 0.0, 70.0, 210.0, 120.0, 70.0, 120.0, 100.0, 40.0, 110.0, 440.0, 10.0, 350.0, 90.0, 150.0, 100.0, 120.0, 510.0, 150.0, 60.0, 80.0, 90.0, 70.0, 330.0, 60.0, 70.0, 100.0, 130.0, 80.0, 30.0, 90.0, 0.0, 100.0, 0.0, 250.0, -5.0, 30.0, 100.0, 20.0, 180.0, 0.0, 10.0, 230.0, 60.0, 30.0, 0.0, 210.0, 100.0, 320.0, 70.0, 200.0, 110.0, 40.0, 510.0, 290.0, 50.0, -110.0, 200.0, 310.0, 60.0, 145.0, 140.0, 10.0, 10.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 80.0, 10.0, 30.0, 10.0, 110.0, 100.0, 280.0, 150.0, 230.0, 10.0, 20.0, 290.0, 160.0, 250.0, 50.0, 40.0, 10.0, -65.0, 0.0, 10.0, 70.0, 70.0, 110.0, 50.0, -30.0, 110.0, 290.0, 550.0, 50.0, 50.0, 90.0, 180.0, 100.0, 50.0, 20.0, 20.0, 280.0, 30.0, 40.0, 80.0, 340.0, 60.0, 490.0, 10.0, 220.0, 10.0, 50.0, 240.0, 320.0, -10.0, 70.0, 280.0, 30.0, 70.0, -155.0, 50.0, 50.0, -135.0, 470.0, 80.0, 50.0, 150.0, 40.0, 300.0, 70.0, 20.0, 180.0, 110.0, -140.0, 210.0, 140.0, 390.0, 140.0, 90.0, 180.0, 130.0, 140.0, 480.0, 130.0, 60.0, 190.0, 190.0, 190.0, 110.0, 40.0, 140.0, 500.0, 100.0, 390.0, 100.0, 240.0, 30.0, 100.0, 490.0, 20.0, 20.0, 30.0, 260.0, 200.0, 310.0, 120.0, 80.0, 80.0, 120.0, 210.0, 500.0, 240.0, 50.0, 120.0, 60.0, 60.0, 90.0, 20.0, 50.0, 120.0, 150.0, 20.0, 40.0, 40.0, 10.0, 40.0, 70.0, 70.0, 260.0, 30.0, 90.0, 90.0, 160.0, 110.0, 10.0, 20.0, 180.0, 320.0, 70.0, 130.0, 30.0, 0.0, -50.0, -50.0, 50.0, 560.0, 0.0, 10.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 0.0, 190.0, 240.0, 80.0, 180.0, 80.0, 40.0, 70.0, 600.0, 60.0, 90.0, 40.0, 40.0, 20.0, 10.0, 50.0, 40.0, 60.0, 30.0, 140.0, 100.0, 290.0, 50.0, 370.0, 200.0, 120.0, 100.0, 60.0, 100.0, 40.0, 210.0, 20.0, 20.0, 60.0, 310.0, 110.0, 10.0, 15.0, 0.0, 170.0, -20.0, 280.0, 10.0, 50.0, 130.0, 150.0, 110.0, 210.0, 50.0, 450.0, 80.0, 160.0, 430.0, 190.0, 30.0, 5.0, -10.0, 150.0, 170.0, 340.0, -100.0, 160.0, 170.0, 70.0, 180.0, 80.0, 20.0, 20.0, 440.0, 10.0, 80.0, 70.0, 70.0, 10.0, 40.0, 230.0, 20.0, 30.0, 310.0, 20.0, 190.0, -10.0, 80.0, 90.0, 320.0, 80.0, 140.0, 110.0, 570.0, 630.0, 160.0, 120.0, 740.0, 70.0, 80.0, 40.0, 10.0, 30.0, 15.0, 510.0, 70.0, 180.0, 540.0, 10.0, 80.0, 30.0, 250.0, 250.0, 20.0, 170.0, 80.0, 10.0, 130.0, 410.0, 40.0, 150.0, 150.0, 210.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 90.0, 20.0, 150.0, 0.0, -80.0, 70.0, 110.0, 45.0, 40.0, 180.0, 40.0, 360.0, 90.0, 370.0, 160.0, 10.0, 30.0, 130.0, 150.0, 200.0, 50.0, 50.0, 460.0, 100.0, 110.0, 10.0, 40.0, 40.0, 90.0, 80.0, 90.0, 60.0, 90.0, 40.0, 230.0, 260.0, 150.0, 70.0, 10.0, 60.0, 60.0, 50.0, 70.0, 60.0, 190.0, 120.0, 20.0, 10.0, 230.0, 160.0, 580.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 120.0, 20.0, 170.0, 30.0, 160.0, 0.0, 290.0, 30.0, 0.0, 30.0, 40.0, 220.0, 0.0, 420.0, 20.0, -20.0, 10.0, 80.0, -50.0, 180.0, 50.0, -10.0, -30.0, 0.0, 50.0, 100.0, 160.0, 330.0, 200.0, 15.0, 180.0, 170.0, 40.0, 40.0, 250.0, 90.0, 20.0, 290.0, 100.0, 30.0, 90.0, 180.0, 170.0, 10.0, 40.0, 30.0, 160.0, 50.0, 40.0, 40.0, 210.0, 170.0, 290.0, 140.0, 25.0, 260.0, 530.0, 180.0, 0.0, 90.0, 10.0, 25.0, 30.0, 80.0, 100.0, 280.0, 0.0, 60.0, 170.0, 70.0, 305.0, 230.0, 90.0, 340.0, 20.0, 20.0, 30.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 70.0, 210.0, 240.0, 40.0, 50.0, 70.0, 30.0, 10.0, 0.0, 40.0, 110.0, 100.0, 30.0, 10.0, 30.0, 540.0, 50.0, 40.0, 190.0, 60.0, 170.0, -970.0, 20.0, -360.0, 30.0, 170.0, 150.0, 590.0, 90.0, 280.0, 340.0, 70.0, 0.0, 100.0, 15.0, 170.0, 110.0, 1140.0, 120.0, 35.0, 70.0, 40.0, 160.0, 80.0, 30.0, 50.0, 160.0, 40.0, 200.0, 220.0, 160.0, 20.0, 80.0, 60.0, 80.0, 130.0, 230.0, 120.0, 120.0, 240.0, 30.0, 30.0, 90.0, 230.0, 100.0, 100.0, 60.0, 70.0, 120.0, 630.0, 20.0, 40.0, 0.0, 430.0, 80.0, 0.0, 90.0, 260.0, 40.0, 290.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6677705239131984, "mean_inference_ms": 1.503668080726184, "mean_action_processing_ms": 0.42446438822988874, "mean_env_wait_ms": 1.348950170699161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013162612915039062, "StateBufferConnector_ms": 0.01037454605102539, "ViewRequirementAgentConnector_ms": 0.3952474594116211}, "num_episodes": 22, "episode_return_max": 2100.0, "episode_return_min": 170.0, "episode_return_mean": 1116.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.975537203271767, "num_env_steps_trained_throughput_per_sec": 18.975537203271767, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 5080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5080000, "timers": {"training_iteration_time_ms": 208721.907, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208721.863, "sample_time_ms": 2668.716, "learn_time_ms": 206032.927, "learn_throughput": 19.414, "synch_weights_time_ms": 11.416}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "done": false, "training_iteration": 127, "trial_id": "aa996_00000", "date": "2024-05-24_06-07-25", "timestamp": 1716545245, "time_this_iter_s": 210.82875180244446, "time_total_s": 26511.49758696556, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160ab40d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26511.49758696556, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 20.967114093959733, "ram_util_percent": 79.67785234899328}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4729404435371056, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007319375361748341, "vf_loss": 7.718053732893337, "vf_explained_var": 0.0003892265569668608, "kl": Infinity, "entropy": 0.26372519330190014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1197225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "env_runners": {"episode_reward_max": 2100.0, "episode_reward_min": 170.0, "episode_reward_mean": 1154.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 115.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1450.0, 1140.0, 940.0, 1210.0, 1580.0, 1220.0, 980.0, 930.0, 1210.0, 1325.0, 930.0, 750.0, 1140.0, 2000.0, 1370.0, 830.0, 1310.0, 1640.0, 1405.0, 740.0, 1250.0, 810.0, 180.0, 760.0, 1750.0, 1290.0, 1700.0, 960.0, 685.0, 1330.0, 1635.0, 380.0, 950.0, 815.0, 1340.0, 1140.0, 1460.0, 790.0, 1080.0, 1930.0, 2000.0, 1580.0, 1520.0, 580.0, 910.0, 1240.0, 200.0, 1500.0, 440.0, 1530.0, 795.0, 1140.0, 1655.0, 1380.0, 870.0, 1590.0, 1895.0, 1940.0, 1390.0, 390.0, 855.0, 1610.0, 710.0, 1000.0, 1450.0, 470.0, 1190.0, 230.0, 1285.0, 1230.0, 1170.0, 1230.0, 1645.0, 220.0, 760.0, 1160.0, 170.0, 2100.0, 1050.0, 1240.0, 1460.0, 1250.0, 1515.0, 1030.0, 1570.0, 1580.0, 925.0, 920.0, 1090.0, 1150.0, 910.0, 380.0, 1440.0, 960.0, 1330.0, 845.0, 1180.0, 1765.0, 1290.0, 1205.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 70.0, 140.0, 310.0, 190.0, 330.0, 60.0, 80.0, 60.0, 140.0, 60.0, 70.0, 90.0, 80.0, 150.0, 390.0, 90.0, 60.0, 60.0, 90.0, 280.0, 50.0, 0.0, 290.0, 20.0, 70.0, 40.0, 30.0, 30.0, 130.0, 50.0, 300.0, 50.0, 20.0, 40.0, 110.0, 520.0, 130.0, -10.0, 0.0, 440.0, 90.0, 80.0, 120.0, 10.0, 220.0, 410.0, 90.0, 30.0, 90.0, 110.0, 50.0, 40.0, 40.0, 20.0, 510.0, 250.0, 120.0, 30.0, 50.0, 320.0, 190.0, 20.0, 20.0, 40.0, 100.0, 90.0, 10.0, -30.0, 220.0, 60.0, 20.0, 60.0, 10.0, 20.0, 310.0, 150.0, 20.0, 270.0, 10.0, 140.0, 130.0, 170.0, 50.0, 40.0, 80.0, 300.0, 100.0, 170.0, 30.0, 80.0, 40.0, 260.0, 40.0, 110.0, 140.0, 510.0, 210.0, -95.0, 30.0, 70.0, 180.0, 100.0, 50.0, 150.0, -10.0, 30.0, 30.0, 270.0, 60.0, -5.0, 10.0, 370.0, 5.0, 50.0, 20.0, 30.0, 10.0, 30.0, 230.0, 70.0, 270.0, 320.0, 90.0, 70.0, 30.0, 210.0, -30.0, 70.0, 40.0, 110.0, 70.0, 200.0, 50.0, 350.0, 240.0, 30.0, 730.0, 160.0, 60.0, 50.0, 110.0, 230.0, 300.0, 230.0, -20.0, 210.0, 160.0, 30.0, 70.0, 130.0, 230.0, 10.0, 190.0, -20.0, 40.0, 40.0, 10.0, 130.0, 70.0, 40.0, 80.0, 160.0, 80.0, 360.0, 340.0, 0.0, 30.0, 170.0, 50.0, 70.0, 190.0, 130.0, 130.0, 80.0, 100.0, 410.0, 100.0, 180.0, 250.0, 0.0, -15.0, 120.0, 130.0, 210.0, 20.0, 200.0, 50.0, 340.0, 350.0, 40.0, 30.0, 100.0, 80.0, -80.0, 20.0, 200.0, 0.0, 0.0, 350.0, 60.0, 150.0, 100.0, 140.0, 10.0, 20.0, 240.0, 20.0, 470.0, 40.0, 60.0, 70.0, 90.0, 110.0, 90.0, 150.0, 80.0, 30.0, 110.0, 20.0, 20.0, 110.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 180.0, 70.0, 30.0, 170.0, 160.0, 60.0, 500.0, 40.0, 30.0, 40.0, 130.0, 400.0, 470.0, -20.0, 160.0, 0.0, 70.0, 210.0, 120.0, 70.0, 120.0, 100.0, 40.0, 110.0, 440.0, 10.0, 350.0, 90.0, 150.0, 100.0, 120.0, 510.0, 150.0, 60.0, 80.0, 90.0, 70.0, 330.0, 60.0, 70.0, 100.0, 130.0, 80.0, 30.0, 90.0, 0.0, 100.0, 0.0, 250.0, -5.0, 30.0, 100.0, 20.0, 180.0, 0.0, 10.0, 230.0, 60.0, 30.0, 0.0, 210.0, 100.0, 320.0, 70.0, 200.0, 110.0, 40.0, 510.0, 290.0, 50.0, -110.0, 200.0, 310.0, 60.0, 145.0, 140.0, 10.0, 10.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 80.0, 10.0, 30.0, 10.0, 110.0, 100.0, 280.0, 150.0, 230.0, 10.0, 20.0, 290.0, 160.0, 250.0, 50.0, 40.0, 10.0, -65.0, 0.0, 10.0, 70.0, 70.0, 110.0, 50.0, -30.0, 110.0, 290.0, 550.0, 50.0, 50.0, 90.0, 180.0, 100.0, 50.0, 20.0, 20.0, 280.0, 30.0, 40.0, 80.0, 340.0, 60.0, 490.0, 10.0, 220.0, 10.0, 50.0, 240.0, 320.0, -10.0, 70.0, 280.0, 30.0, 70.0, -155.0, 50.0, 50.0, -135.0, 470.0, 80.0, 50.0, 150.0, 40.0, 300.0, 70.0, 20.0, 180.0, 110.0, -140.0, 210.0, 140.0, 390.0, 140.0, 90.0, 180.0, 130.0, 140.0, 480.0, 130.0, 60.0, 190.0, 190.0, 190.0, 110.0, 40.0, 140.0, 500.0, 100.0, 390.0, 100.0, 240.0, 30.0, 100.0, 490.0, 20.0, 20.0, 30.0, 260.0, 200.0, 310.0, 120.0, 80.0, 80.0, 120.0, 210.0, 500.0, 240.0, 50.0, 120.0, 60.0, 60.0, 90.0, 20.0, 50.0, 120.0, 150.0, 20.0, 40.0, 40.0, 10.0, 40.0, 70.0, 70.0, 260.0, 30.0, 90.0, 90.0, 160.0, 110.0, 10.0, 20.0, 180.0, 320.0, 70.0, 130.0, 30.0, 0.0, -50.0, -50.0, 50.0, 560.0, 0.0, 10.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 0.0, 190.0, 240.0, 80.0, 180.0, 80.0, 40.0, 70.0, 600.0, 60.0, 90.0, 40.0, 40.0, 20.0, 10.0, 50.0, 40.0, 60.0, 30.0, 140.0, 100.0, 290.0, 50.0, 370.0, 200.0, 120.0, 100.0, 60.0, 100.0, 40.0, 210.0, 20.0, 20.0, 60.0, 310.0, 110.0, 10.0, 15.0, 0.0, 170.0, -20.0, 280.0, 10.0, 50.0, 130.0, 150.0, 110.0, 210.0, 50.0, 450.0, 80.0, 160.0, 430.0, 190.0, 30.0, 5.0, -10.0, 150.0, 170.0, 340.0, -100.0, 160.0, 170.0, 70.0, 180.0, 80.0, 20.0, 20.0, 440.0, 10.0, 80.0, 70.0, 70.0, 10.0, 40.0, 230.0, 20.0, 30.0, 310.0, 20.0, 190.0, -10.0, 80.0, 90.0, 320.0, 80.0, 140.0, 110.0, 570.0, 630.0, 160.0, 120.0, 740.0, 70.0, 80.0, 40.0, 10.0, 30.0, 15.0, 510.0, 70.0, 180.0, 540.0, 10.0, 80.0, 30.0, 250.0, 250.0, 20.0, 170.0, 80.0, 10.0, 130.0, 410.0, 40.0, 150.0, 150.0, 210.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 90.0, 20.0, 150.0, 0.0, -80.0, 70.0, 110.0, 45.0, 40.0, 180.0, 40.0, 360.0, 90.0, 370.0, 160.0, 10.0, 30.0, 130.0, 150.0, 200.0, 50.0, 50.0, 460.0, 100.0, 110.0, 10.0, 40.0, 40.0, 90.0, 80.0, 90.0, 60.0, 90.0, 40.0, 230.0, 260.0, 150.0, 70.0, 10.0, 60.0, 60.0, 50.0, 70.0, 60.0, 190.0, 120.0, 20.0, 10.0, 230.0, 160.0, 580.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 120.0, 20.0, 170.0, 30.0, 160.0, 0.0, 290.0, 30.0, 0.0, 30.0, 40.0, 220.0, 0.0, 420.0, 20.0, -20.0, 10.0, 80.0, -50.0, 180.0, 50.0, -10.0, -30.0, 0.0, 50.0, 100.0, 160.0, 330.0, 200.0, 15.0, 180.0, 170.0, 40.0, 40.0, 250.0, 90.0, 20.0, 290.0, 100.0, 30.0, 90.0, 180.0, 170.0, 10.0, 40.0, 30.0, 160.0, 50.0, 40.0, 40.0, 210.0, 170.0, 290.0, 140.0, 25.0, 260.0, 530.0, 180.0, 0.0, 90.0, 10.0, 25.0, 30.0, 80.0, 100.0, 280.0, 0.0, 60.0, 170.0, 70.0, 305.0, 230.0, 90.0, 340.0, 20.0, 20.0, 30.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 70.0, 210.0, 240.0, 40.0, 50.0, 70.0, 30.0, 10.0, 0.0, 40.0, 110.0, 100.0, 30.0, 10.0, 30.0, 540.0, 50.0, 40.0, 190.0, 60.0, 170.0, -970.0, 20.0, -360.0, 30.0, 170.0, 150.0, 590.0, 90.0, 280.0, 340.0, 70.0, 0.0, 100.0, 15.0, 170.0, 110.0, 1140.0, 120.0, 35.0, 70.0, 40.0, 160.0, 80.0, 30.0, 50.0, 160.0, 40.0, 200.0, 220.0, 160.0, 20.0, 80.0, 60.0, 80.0, 130.0, 230.0, 120.0, 120.0, 240.0, 30.0, 30.0, 90.0, 230.0, 100.0, 100.0, 60.0, 70.0, 120.0, 630.0, 20.0, 40.0, 0.0, 430.0, 80.0, 0.0, 90.0, 260.0, 40.0, 290.0, 350.0, 30.0, 160.0, 50.0, 460.0, 230.0, 60.0, 60.0, 50.0, 65.0, 30.0, 200.0, -40.0, 100.0, 90.0, 100.0, 150.0, 140.0, 40.0, 220.0, 10.0, 150.0, 30.0, 160.0, 30.0, 220.0, 180.0, -20.0, 240.0, 570.0, 150.0, 200.0, 240.0, 90.0, 130.0, 270.0, 70.0, 150.0, 230.0, 50.0, 120.0, 5.0, 10.0, 80.0, 110.0, 120.0, 100.0, 140.0, 80.0, 160.0, 30.0, 390.0, 40.0, 30.0, 70.0, 30.0, 70.0, 20.0, 170.0, 70.0, 50.0, 40.0, 230.0, 420.0, 10.0, 20.0, 40.0, 0.0, 280.0, 0.0, 40.0, 220.0, 50.0, 120.0, 110.0, 30.0, 60.0, 160.0, 140.0, 220.0, 10.0, 0.0, 30.0, 110.0, 80.0, 310.0, 240.0, 30.0, 30.0, 70.0, 40.0, 110.0, 0.0, 0.0, 10.0, 90.0, 40.0, 50.0, 70.0, -30.0, 80.0, 160.0, 380.0, 150.0, 190.0, 190.0, -240.0, 240.0, 190.0, 100.0, 40.0, 60.0, 260.0, 20.0, 130.0, 20.0, 70.0, 210.0, 60.0, 90.0, 70.0, 300.0, 40.0, 230.0, 0.0, 70.0, 70.0, 30.0, 230.0, 290.0, 50.0, 180.0, 20.0, 10.0, 130.0, 40.0, 0.0, 25.0, 370.0, 20.0, 0.0, 190.0, 80.0, 80.0, 30.0, 30.0, 530.0, 0.0, 180.0, 60.0, 100.0, 470.0, 240.0, 195.0, 110.0, 70.0, 80.0, 80.0, 60.0, 360.0, 300.0, 130.0, 70.0, 40.0, 120.0, 40.0, 10.0, 70.0, 320.0, 190.0, 55.0, 190.0, 90.0, 120.0, 40.0, 110.0, 70.0, -10.0, 80.0, 460.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.667119603497283, "mean_inference_ms": 1.5034169251860936, "mean_action_processing_ms": 0.42436278555518325, "mean_env_wait_ms": 1.3488303789599956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013389825820922852, "StateBufferConnector_ms": 0.010650396347045898, "ViewRequirementAgentConnector_ms": 0.41391420364379883}, "num_episodes": 18, "episode_return_max": 2100.0, "episode_return_min": 170.0, "episode_return_mean": 1154.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.996999382354662, "num_env_steps_trained_throughput_per_sec": 18.996999382354662, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 5120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5120000, "timers": {"training_iteration_time_ms": 208911.998, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208911.954, "sample_time_ms": 2668.37, "learn_time_ms": 206223.067, "learn_throughput": 19.396, "synch_weights_time_ms": 11.499}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "done": false, "training_iteration": 128, "trial_id": "aa996_00000", "date": "2024-05-24_06-10-56", "timestamp": 1716545456, "time_this_iter_s": 210.56660199165344, "time_total_s": 26722.064188957214, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160affb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26722.064188957214, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 20.461952861952863, "ram_util_percent": 79.40673400673401}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9326651761072258, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0076038279772847215, "vf_loss": 7.81323917214228, "vf_explained_var": 0.002377448625330981, "kl": Infinity, "entropy": 0.2629587003391899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1206615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "env_runners": {"episode_reward_max": 2100.0, "episode_reward_min": 170.0, "episode_reward_mean": 1167.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 116.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1405.0, 740.0, 1250.0, 810.0, 180.0, 760.0, 1750.0, 1290.0, 1700.0, 960.0, 685.0, 1330.0, 1635.0, 380.0, 950.0, 815.0, 1340.0, 1140.0, 1460.0, 790.0, 1080.0, 1930.0, 2000.0, 1580.0, 1520.0, 580.0, 910.0, 1240.0, 200.0, 1500.0, 440.0, 1530.0, 795.0, 1140.0, 1655.0, 1380.0, 870.0, 1590.0, 1895.0, 1940.0, 1390.0, 390.0, 855.0, 1610.0, 710.0, 1000.0, 1450.0, 470.0, 1190.0, 230.0, 1285.0, 1230.0, 1170.0, 1230.0, 1645.0, 220.0, 760.0, 1160.0, 170.0, 2100.0, 1050.0, 1240.0, 1460.0, 1250.0, 1515.0, 1030.0, 1570.0, 1580.0, 925.0, 920.0, 1090.0, 1150.0, 910.0, 380.0, 1440.0, 960.0, 1330.0, 845.0, 1180.0, 1765.0, 1290.0, 1205.0, 960.0, 1760.0, 1450.0, 1445.0, 1710.0, 955.0, 1510.0, 1320.0, 1820.0, 990.0, 1300.0, 995.0, 1270.0, 1170.0, 1850.0, 430.0, 830.0, 1460.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -15.0, 120.0, 130.0, 210.0, 20.0, 200.0, 50.0, 340.0, 350.0, 40.0, 30.0, 100.0, 80.0, -80.0, 20.0, 200.0, 0.0, 0.0, 350.0, 60.0, 150.0, 100.0, 140.0, 10.0, 20.0, 240.0, 20.0, 470.0, 40.0, 60.0, 70.0, 90.0, 110.0, 90.0, 150.0, 80.0, 30.0, 110.0, 20.0, 20.0, 110.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 180.0, 70.0, 30.0, 170.0, 160.0, 60.0, 500.0, 40.0, 30.0, 40.0, 130.0, 400.0, 470.0, -20.0, 160.0, 0.0, 70.0, 210.0, 120.0, 70.0, 120.0, 100.0, 40.0, 110.0, 440.0, 10.0, 350.0, 90.0, 150.0, 100.0, 120.0, 510.0, 150.0, 60.0, 80.0, 90.0, 70.0, 330.0, 60.0, 70.0, 100.0, 130.0, 80.0, 30.0, 90.0, 0.0, 100.0, 0.0, 250.0, -5.0, 30.0, 100.0, 20.0, 180.0, 0.0, 10.0, 230.0, 60.0, 30.0, 0.0, 210.0, 100.0, 320.0, 70.0, 200.0, 110.0, 40.0, 510.0, 290.0, 50.0, -110.0, 200.0, 310.0, 60.0, 145.0, 140.0, 10.0, 10.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 80.0, 10.0, 30.0, 10.0, 110.0, 100.0, 280.0, 150.0, 230.0, 10.0, 20.0, 290.0, 160.0, 250.0, 50.0, 40.0, 10.0, -65.0, 0.0, 10.0, 70.0, 70.0, 110.0, 50.0, -30.0, 110.0, 290.0, 550.0, 50.0, 50.0, 90.0, 180.0, 100.0, 50.0, 20.0, 20.0, 280.0, 30.0, 40.0, 80.0, 340.0, 60.0, 490.0, 10.0, 220.0, 10.0, 50.0, 240.0, 320.0, -10.0, 70.0, 280.0, 30.0, 70.0, -155.0, 50.0, 50.0, -135.0, 470.0, 80.0, 50.0, 150.0, 40.0, 300.0, 70.0, 20.0, 180.0, 110.0, -140.0, 210.0, 140.0, 390.0, 140.0, 90.0, 180.0, 130.0, 140.0, 480.0, 130.0, 60.0, 190.0, 190.0, 190.0, 110.0, 40.0, 140.0, 500.0, 100.0, 390.0, 100.0, 240.0, 30.0, 100.0, 490.0, 20.0, 20.0, 30.0, 260.0, 200.0, 310.0, 120.0, 80.0, 80.0, 120.0, 210.0, 500.0, 240.0, 50.0, 120.0, 60.0, 60.0, 90.0, 20.0, 50.0, 120.0, 150.0, 20.0, 40.0, 40.0, 10.0, 40.0, 70.0, 70.0, 260.0, 30.0, 90.0, 90.0, 160.0, 110.0, 10.0, 20.0, 180.0, 320.0, 70.0, 130.0, 30.0, 0.0, -50.0, -50.0, 50.0, 560.0, 0.0, 10.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 0.0, 190.0, 240.0, 80.0, 180.0, 80.0, 40.0, 70.0, 600.0, 60.0, 90.0, 40.0, 40.0, 20.0, 10.0, 50.0, 40.0, 60.0, 30.0, 140.0, 100.0, 290.0, 50.0, 370.0, 200.0, 120.0, 100.0, 60.0, 100.0, 40.0, 210.0, 20.0, 20.0, 60.0, 310.0, 110.0, 10.0, 15.0, 0.0, 170.0, -20.0, 280.0, 10.0, 50.0, 130.0, 150.0, 110.0, 210.0, 50.0, 450.0, 80.0, 160.0, 430.0, 190.0, 30.0, 5.0, -10.0, 150.0, 170.0, 340.0, -100.0, 160.0, 170.0, 70.0, 180.0, 80.0, 20.0, 20.0, 440.0, 10.0, 80.0, 70.0, 70.0, 10.0, 40.0, 230.0, 20.0, 30.0, 310.0, 20.0, 190.0, -10.0, 80.0, 90.0, 320.0, 80.0, 140.0, 110.0, 570.0, 630.0, 160.0, 120.0, 740.0, 70.0, 80.0, 40.0, 10.0, 30.0, 15.0, 510.0, 70.0, 180.0, 540.0, 10.0, 80.0, 30.0, 250.0, 250.0, 20.0, 170.0, 80.0, 10.0, 130.0, 410.0, 40.0, 150.0, 150.0, 210.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 90.0, 20.0, 150.0, 0.0, -80.0, 70.0, 110.0, 45.0, 40.0, 180.0, 40.0, 360.0, 90.0, 370.0, 160.0, 10.0, 30.0, 130.0, 150.0, 200.0, 50.0, 50.0, 460.0, 100.0, 110.0, 10.0, 40.0, 40.0, 90.0, 80.0, 90.0, 60.0, 90.0, 40.0, 230.0, 260.0, 150.0, 70.0, 10.0, 60.0, 60.0, 50.0, 70.0, 60.0, 190.0, 120.0, 20.0, 10.0, 230.0, 160.0, 580.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 120.0, 20.0, 170.0, 30.0, 160.0, 0.0, 290.0, 30.0, 0.0, 30.0, 40.0, 220.0, 0.0, 420.0, 20.0, -20.0, 10.0, 80.0, -50.0, 180.0, 50.0, -10.0, -30.0, 0.0, 50.0, 100.0, 160.0, 330.0, 200.0, 15.0, 180.0, 170.0, 40.0, 40.0, 250.0, 90.0, 20.0, 290.0, 100.0, 30.0, 90.0, 180.0, 170.0, 10.0, 40.0, 30.0, 160.0, 50.0, 40.0, 40.0, 210.0, 170.0, 290.0, 140.0, 25.0, 260.0, 530.0, 180.0, 0.0, 90.0, 10.0, 25.0, 30.0, 80.0, 100.0, 280.0, 0.0, 60.0, 170.0, 70.0, 305.0, 230.0, 90.0, 340.0, 20.0, 20.0, 30.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 70.0, 210.0, 240.0, 40.0, 50.0, 70.0, 30.0, 10.0, 0.0, 40.0, 110.0, 100.0, 30.0, 10.0, 30.0, 540.0, 50.0, 40.0, 190.0, 60.0, 170.0, -970.0, 20.0, -360.0, 30.0, 170.0, 150.0, 590.0, 90.0, 280.0, 340.0, 70.0, 0.0, 100.0, 15.0, 170.0, 110.0, 1140.0, 120.0, 35.0, 70.0, 40.0, 160.0, 80.0, 30.0, 50.0, 160.0, 40.0, 200.0, 220.0, 160.0, 20.0, 80.0, 60.0, 80.0, 130.0, 230.0, 120.0, 120.0, 240.0, 30.0, 30.0, 90.0, 230.0, 100.0, 100.0, 60.0, 70.0, 120.0, 630.0, 20.0, 40.0, 0.0, 430.0, 80.0, 0.0, 90.0, 260.0, 40.0, 290.0, 350.0, 30.0, 160.0, 50.0, 460.0, 230.0, 60.0, 60.0, 50.0, 65.0, 30.0, 200.0, -40.0, 100.0, 90.0, 100.0, 150.0, 140.0, 40.0, 220.0, 10.0, 150.0, 30.0, 160.0, 30.0, 220.0, 180.0, -20.0, 240.0, 570.0, 150.0, 200.0, 240.0, 90.0, 130.0, 270.0, 70.0, 150.0, 230.0, 50.0, 120.0, 5.0, 10.0, 80.0, 110.0, 120.0, 100.0, 140.0, 80.0, 160.0, 30.0, 390.0, 40.0, 30.0, 70.0, 30.0, 70.0, 20.0, 170.0, 70.0, 50.0, 40.0, 230.0, 420.0, 10.0, 20.0, 40.0, 0.0, 280.0, 0.0, 40.0, 220.0, 50.0, 120.0, 110.0, 30.0, 60.0, 160.0, 140.0, 220.0, 10.0, 0.0, 30.0, 110.0, 80.0, 310.0, 240.0, 30.0, 30.0, 70.0, 40.0, 110.0, 0.0, 0.0, 10.0, 90.0, 40.0, 50.0, 70.0, -30.0, 80.0, 160.0, 380.0, 150.0, 190.0, 190.0, -240.0, 240.0, 190.0, 100.0, 40.0, 60.0, 260.0, 20.0, 130.0, 20.0, 70.0, 210.0, 60.0, 90.0, 70.0, 300.0, 40.0, 230.0, 0.0, 70.0, 70.0, 30.0, 230.0, 290.0, 50.0, 180.0, 20.0, 10.0, 130.0, 40.0, 0.0, 25.0, 370.0, 20.0, 0.0, 190.0, 80.0, 80.0, 30.0, 30.0, 530.0, 0.0, 180.0, 60.0, 100.0, 470.0, 240.0, 195.0, 110.0, 70.0, 80.0, 80.0, 60.0, 360.0, 300.0, 130.0, 70.0, 40.0, 120.0, 40.0, 10.0, 70.0, 320.0, 190.0, 55.0, 190.0, 90.0, 120.0, 40.0, 110.0, 70.0, -10.0, 80.0, 460.0, -25.0, 180.0, 135.0, 90.0, 200.0, 40.0, 0.0, 250.0, 20.0, 70.0, 110.0, 260.0, 140.0, 80.0, 120.0, 130.0, -10.0, 230.0, 530.0, 170.0, 100.0, 110.0, 70.0, 320.0, 100.0, 240.0, 200.0, 90.0, 160.0, 60.0, 60.0, 200.0, 240.0, 105.0, 120.0, 40.0, 40.0, 350.0, 100.0, 190.0, 90.0, 190.0, 160.0, 60.0, 130.0, 10.0, 270.0, 270.0, 50.0, 480.0, 500.0, 40.0, 0.0, 60.0, 90.0, 120.0, 20.0, 15.0, 20.0, 90.0, 170.0, 210.0, 150.0, 60.0, 80.0, 40.0, 300.0, 110.0, 160.0, 230.0, 90.0, 10.0, 250.0, 10.0, 40.0, 120.0, 160.0, 100.0, 20.0, 520.0, 360.0, 200.0, 90.0, 400.0, 70.0, 340.0, 160.0, 40.0, 130.0, 30.0, 10.0, 20.0, 280.0, 80.0, 300.0, 80.0, 160.0, 50.0, 10.0, 0.0, 140.0, 30.0, 60.0, 190.0, 110.0, 150.0, 30.0, 20.0, 390.0, 180.0, 570.0, 40.0, 10.0, 10.0, 100.0, 110.0, -30.0, 150.0, 30.0, 5.0, 60.0, 110.0, 90.0, 0.0, -40.0, 220.0, 210.0, 160.0, 390.0, 70.0, 70.0, 70.0, 330.0, 190.0, 210.0, 30.0, -50.0, 80.0, 230.0, 10.0, 20.0, 220.0, 110.0, 870.0, 70.0, 180.0, 90.0, 250.0, 20.0, 20.0, 0.0, 100.0, 70.0, 20.0, 50.0, 20.0, 10.0, 20.0, 20.0, 120.0, 0.0, 70.0, 100.0, 180.0, 0.0, 130.0, 30.0, 120.0, 180.0, 20.0, 310.0, 320.0, 10.0, 110.0, 80.0, 70.0, 80.0, 190.0, 60.0, 230.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6664924800614886, "mean_inference_ms": 1.5031750913906268, "mean_action_processing_ms": 0.4242718036142989, "mean_env_wait_ms": 1.3487050699204113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013186216354370117, "StateBufferConnector_ms": 0.010972976684570312, "ViewRequirementAgentConnector_ms": 0.4162442684173584}, "num_episodes": 18, "episode_return_max": 2100.0, "episode_return_min": 170.0, "episode_return_mean": 1167.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.350559032955914, "num_env_steps_trained_throughput_per_sec": 19.350559032955914, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 5160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5160000, "timers": {"training_iteration_time_ms": 208384.378, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208384.335, "sample_time_ms": 2658.864, "learn_time_ms": 205705.24, "learn_throughput": 19.445, "synch_weights_time_ms": 11.332}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "done": false, "training_iteration": 129, "trial_id": "aa996_00000", "date": "2024-05-24_06-14-23", "timestamp": 1716545663, "time_this_iter_s": 206.72115802764893, "time_total_s": 26928.785346984863, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160aff670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26928.785346984863, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 19.057337883959043, "ram_util_percent": 79.05870307167235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3646792776858843, "cur_kl_coeff": 1.1546030312776563, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0066852483466709935, "vf_loss": 7.618985308981297, "vf_explained_var": 0.0004777949458113113, "kl": Infinity, "entropy": 0.2619157172239627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1216005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "env_runners": {"episode_reward_max": 2110.0, "episode_reward_min": 170.0, "episode_reward_mean": 1191.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 119.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1580.0, 1520.0, 580.0, 910.0, 1240.0, 200.0, 1500.0, 440.0, 1530.0, 795.0, 1140.0, 1655.0, 1380.0, 870.0, 1590.0, 1895.0, 1940.0, 1390.0, 390.0, 855.0, 1610.0, 710.0, 1000.0, 1450.0, 470.0, 1190.0, 230.0, 1285.0, 1230.0, 1170.0, 1230.0, 1645.0, 220.0, 760.0, 1160.0, 170.0, 2100.0, 1050.0, 1240.0, 1460.0, 1250.0, 1515.0, 1030.0, 1570.0, 1580.0, 925.0, 920.0, 1090.0, 1150.0, 910.0, 380.0, 1440.0, 960.0, 1330.0, 845.0, 1180.0, 1765.0, 1290.0, 1205.0, 960.0, 1760.0, 1450.0, 1445.0, 1710.0, 955.0, 1510.0, 1320.0, 1820.0, 990.0, 1300.0, 995.0, 1270.0, 1170.0, 1850.0, 430.0, 830.0, 1460.0, 1230.0, 1240.0, 1630.0, 690.0, 2110.0, 555.0, 190.0, 1230.0, 1080.0, 570.0, 1670.0, 1300.0, 1700.0, 1310.0, 1300.0, 635.0, 1720.0, 1990.0, 1635.0, 1630.0, 1000.0, 1360.0, 1030.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 100.0, 490.0, 20.0, 20.0, 30.0, 260.0, 200.0, 310.0, 120.0, 80.0, 80.0, 120.0, 210.0, 500.0, 240.0, 50.0, 120.0, 60.0, 60.0, 90.0, 20.0, 50.0, 120.0, 150.0, 20.0, 40.0, 40.0, 10.0, 40.0, 70.0, 70.0, 260.0, 30.0, 90.0, 90.0, 160.0, 110.0, 10.0, 20.0, 180.0, 320.0, 70.0, 130.0, 30.0, 0.0, -50.0, -50.0, 50.0, 560.0, 0.0, 10.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 0.0, 190.0, 240.0, 80.0, 180.0, 80.0, 40.0, 70.0, 600.0, 60.0, 90.0, 40.0, 40.0, 20.0, 10.0, 50.0, 40.0, 60.0, 30.0, 140.0, 100.0, 290.0, 50.0, 370.0, 200.0, 120.0, 100.0, 60.0, 100.0, 40.0, 210.0, 20.0, 20.0, 60.0, 310.0, 110.0, 10.0, 15.0, 0.0, 170.0, -20.0, 280.0, 10.0, 50.0, 130.0, 150.0, 110.0, 210.0, 50.0, 450.0, 80.0, 160.0, 430.0, 190.0, 30.0, 5.0, -10.0, 150.0, 170.0, 340.0, -100.0, 160.0, 170.0, 70.0, 180.0, 80.0, 20.0, 20.0, 440.0, 10.0, 80.0, 70.0, 70.0, 10.0, 40.0, 230.0, 20.0, 30.0, 310.0, 20.0, 190.0, -10.0, 80.0, 90.0, 320.0, 80.0, 140.0, 110.0, 570.0, 630.0, 160.0, 120.0, 740.0, 70.0, 80.0, 40.0, 10.0, 30.0, 15.0, 510.0, 70.0, 180.0, 540.0, 10.0, 80.0, 30.0, 250.0, 250.0, 20.0, 170.0, 80.0, 10.0, 130.0, 410.0, 40.0, 150.0, 150.0, 210.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 90.0, 20.0, 150.0, 0.0, -80.0, 70.0, 110.0, 45.0, 40.0, 180.0, 40.0, 360.0, 90.0, 370.0, 160.0, 10.0, 30.0, 130.0, 150.0, 200.0, 50.0, 50.0, 460.0, 100.0, 110.0, 10.0, 40.0, 40.0, 90.0, 80.0, 90.0, 60.0, 90.0, 40.0, 230.0, 260.0, 150.0, 70.0, 10.0, 60.0, 60.0, 50.0, 70.0, 60.0, 190.0, 120.0, 20.0, 10.0, 230.0, 160.0, 580.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 120.0, 20.0, 170.0, 30.0, 160.0, 0.0, 290.0, 30.0, 0.0, 30.0, 40.0, 220.0, 0.0, 420.0, 20.0, -20.0, 10.0, 80.0, -50.0, 180.0, 50.0, -10.0, -30.0, 0.0, 50.0, 100.0, 160.0, 330.0, 200.0, 15.0, 180.0, 170.0, 40.0, 40.0, 250.0, 90.0, 20.0, 290.0, 100.0, 30.0, 90.0, 180.0, 170.0, 10.0, 40.0, 30.0, 160.0, 50.0, 40.0, 40.0, 210.0, 170.0, 290.0, 140.0, 25.0, 260.0, 530.0, 180.0, 0.0, 90.0, 10.0, 25.0, 30.0, 80.0, 100.0, 280.0, 0.0, 60.0, 170.0, 70.0, 305.0, 230.0, 90.0, 340.0, 20.0, 20.0, 30.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 70.0, 210.0, 240.0, 40.0, 50.0, 70.0, 30.0, 10.0, 0.0, 40.0, 110.0, 100.0, 30.0, 10.0, 30.0, 540.0, 50.0, 40.0, 190.0, 60.0, 170.0, -970.0, 20.0, -360.0, 30.0, 170.0, 150.0, 590.0, 90.0, 280.0, 340.0, 70.0, 0.0, 100.0, 15.0, 170.0, 110.0, 1140.0, 120.0, 35.0, 70.0, 40.0, 160.0, 80.0, 30.0, 50.0, 160.0, 40.0, 200.0, 220.0, 160.0, 20.0, 80.0, 60.0, 80.0, 130.0, 230.0, 120.0, 120.0, 240.0, 30.0, 30.0, 90.0, 230.0, 100.0, 100.0, 60.0, 70.0, 120.0, 630.0, 20.0, 40.0, 0.0, 430.0, 80.0, 0.0, 90.0, 260.0, 40.0, 290.0, 350.0, 30.0, 160.0, 50.0, 460.0, 230.0, 60.0, 60.0, 50.0, 65.0, 30.0, 200.0, -40.0, 100.0, 90.0, 100.0, 150.0, 140.0, 40.0, 220.0, 10.0, 150.0, 30.0, 160.0, 30.0, 220.0, 180.0, -20.0, 240.0, 570.0, 150.0, 200.0, 240.0, 90.0, 130.0, 270.0, 70.0, 150.0, 230.0, 50.0, 120.0, 5.0, 10.0, 80.0, 110.0, 120.0, 100.0, 140.0, 80.0, 160.0, 30.0, 390.0, 40.0, 30.0, 70.0, 30.0, 70.0, 20.0, 170.0, 70.0, 50.0, 40.0, 230.0, 420.0, 10.0, 20.0, 40.0, 0.0, 280.0, 0.0, 40.0, 220.0, 50.0, 120.0, 110.0, 30.0, 60.0, 160.0, 140.0, 220.0, 10.0, 0.0, 30.0, 110.0, 80.0, 310.0, 240.0, 30.0, 30.0, 70.0, 40.0, 110.0, 0.0, 0.0, 10.0, 90.0, 40.0, 50.0, 70.0, -30.0, 80.0, 160.0, 380.0, 150.0, 190.0, 190.0, -240.0, 240.0, 190.0, 100.0, 40.0, 60.0, 260.0, 20.0, 130.0, 20.0, 70.0, 210.0, 60.0, 90.0, 70.0, 300.0, 40.0, 230.0, 0.0, 70.0, 70.0, 30.0, 230.0, 290.0, 50.0, 180.0, 20.0, 10.0, 130.0, 40.0, 0.0, 25.0, 370.0, 20.0, 0.0, 190.0, 80.0, 80.0, 30.0, 30.0, 530.0, 0.0, 180.0, 60.0, 100.0, 470.0, 240.0, 195.0, 110.0, 70.0, 80.0, 80.0, 60.0, 360.0, 300.0, 130.0, 70.0, 40.0, 120.0, 40.0, 10.0, 70.0, 320.0, 190.0, 55.0, 190.0, 90.0, 120.0, 40.0, 110.0, 70.0, -10.0, 80.0, 460.0, -25.0, 180.0, 135.0, 90.0, 200.0, 40.0, 0.0, 250.0, 20.0, 70.0, 110.0, 260.0, 140.0, 80.0, 120.0, 130.0, -10.0, 230.0, 530.0, 170.0, 100.0, 110.0, 70.0, 320.0, 100.0, 240.0, 200.0, 90.0, 160.0, 60.0, 60.0, 200.0, 240.0, 105.0, 120.0, 40.0, 40.0, 350.0, 100.0, 190.0, 90.0, 190.0, 160.0, 60.0, 130.0, 10.0, 270.0, 270.0, 50.0, 480.0, 500.0, 40.0, 0.0, 60.0, 90.0, 120.0, 20.0, 15.0, 20.0, 90.0, 170.0, 210.0, 150.0, 60.0, 80.0, 40.0, 300.0, 110.0, 160.0, 230.0, 90.0, 10.0, 250.0, 10.0, 40.0, 120.0, 160.0, 100.0, 20.0, 520.0, 360.0, 200.0, 90.0, 400.0, 70.0, 340.0, 160.0, 40.0, 130.0, 30.0, 10.0, 20.0, 280.0, 80.0, 300.0, 80.0, 160.0, 50.0, 10.0, 0.0, 140.0, 30.0, 60.0, 190.0, 110.0, 150.0, 30.0, 20.0, 390.0, 180.0, 570.0, 40.0, 10.0, 10.0, 100.0, 110.0, -30.0, 150.0, 30.0, 5.0, 60.0, 110.0, 90.0, 0.0, -40.0, 220.0, 210.0, 160.0, 390.0, 70.0, 70.0, 70.0, 330.0, 190.0, 210.0, 30.0, -50.0, 80.0, 230.0, 10.0, 20.0, 220.0, 110.0, 870.0, 70.0, 180.0, 90.0, 250.0, 20.0, 20.0, 0.0, 100.0, 70.0, 20.0, 50.0, 20.0, 10.0, 20.0, 20.0, 120.0, 0.0, 70.0, 100.0, 180.0, 0.0, 130.0, 30.0, 120.0, 180.0, 20.0, 310.0, 320.0, 10.0, 110.0, 80.0, 70.0, 80.0, 190.0, 60.0, 230.0, 220.0, 340.0, -50.0, 10.0, 400.0, 280.0, -10.0, 0.0, 0.0, 40.0, 80.0, 50.0, 10.0, 180.0, 120.0, 120.0, 100.0, 60.0, 290.0, 230.0, 60.0, 20.0, 160.0, 200.0, 160.0, 20.0, 80.0, 110.0, 160.0, 660.0, 20.0, 50.0, 0.0, -10.0, 490.0, 30.0, 10.0, 60.0, 10.0, 30.0, 180.0, 50.0, 130.0, 90.0, 170.0, 70.0, 290.0, 120.0, 170.0, 840.0, -330.0, 180.0, 230.0, -290.0, 170.0, 60.0, 70.0, 340.0, 70.0, 55.0, 10.0, 120.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 150.0, 390.0, -20.0, 80.0, 90.0, 90.0, -50.0, 200.0, 60.0, 240.0, 230.0, 70.0, 400.0, 10.0, 20.0, 20.0, 60.0, 190.0, 10.0, 70.0, 70.0, 30.0, 20.0, 20.0, 0.0, 160.0, 100.0, 20.0, 40.0, 110.0, 420.0, 190.0, 260.0, 40.0, 120.0, 80.0, 320.0, 70.0, 110.0, 60.0, 230.0, -20.0, 140.0, 110.0, 220.0, 180.0, 160.0, 190.0, 60.0, 30.0, 110.0, 100.0, 190.0, 180.0, 200.0, 30.0, 10.0, 550.0, 230.0, 100.0, 50.0, 490.0, -40.0, 40.0, 120.0, 150.0, -30.0, 480.0, 40.0, 10.0, 170.0, 30.0, 160.0, 50.0, 100.0, 60.0, 340.0, 150.0, 140.0, 100.0, 230.0, -65.0, 50.0, 220.0, -20.0, 220.0, 420.0, 20.0, 20.0, -460.0, 240.0, 90.0, 410.0, 70.0, 50.0, 230.0, 50.0, 250.0, 260.0, 70.0, 210.0, 100.0, 180.0, 580.0, 80.0, 190.0, 130.0, 330.0, 80.0, 110.0, 230.0, 40.0, 40.0, 290.0, 90.0, 55.0, 410.0, -30.0, 220.0, 290.0, -5.0, -30.0, 50.0, 510.0, 190.0, 70.0, 480.0, 80.0, 35.0, 250.0, 200.0, -30.0, 280.0, 130.0, 110.0, 160.0, 20.0, 70.0, -10.0, 70.0, 90.0, 80.0, 390.0, 190.0, 50.0, 60.0, 270.0, 20.0, 190.0, 20.0, 50.0, 190.0, 20.0, 20.0, 10.0, 40.0, 470.0, 20.0, 200.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6656772028443323, "mean_inference_ms": 1.5028606731415437, "mean_action_processing_ms": 0.424179977232882, "mean_env_wait_ms": 1.3485797976465117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01380467414855957, "StateBufferConnector_ms": 0.0115814208984375, "ViewRequirementAgentConnector_ms": 0.42842888832092285}, "num_episodes": 23, "episode_return_max": 2110.0, "episode_return_min": 170.0, "episode_return_mean": 1191.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.123144260919144, "num_env_steps_trained_throughput_per_sec": 19.123144260919144, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 5200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5200000, "timers": {"training_iteration_time_ms": 208557.61, "restore_workers_time_ms": 0.012, "training_step_time_ms": 208557.567, "sample_time_ms": 2620.918, "learn_time_ms": 205916.089, "learn_throughput": 19.425, "synch_weights_time_ms": 12.517}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "done": false, "training_iteration": 130, "trial_id": "aa996_00000", "date": "2024-05-24_06-17-52", "timestamp": 1716545872, "time_this_iter_s": 209.1952006816864, "time_total_s": 27137.98054766655, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160ab4a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27137.98054766655, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 19.559661016949153, "ram_util_percent": 79.36881355932202}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5286730025459527, "cur_kl_coeff": 1.7319045469164853, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.380479843903401, "policy_loss": -0.006332701423276846, "vf_loss": 7.3840102431873165, "vf_explained_var": 0.001370881959653129, "kl": 0.0016180454093785664, "entropy": 0.2595134832925055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1225395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "env_runners": {"episode_reward_max": 2110.0, "episode_reward_min": 170.0, "episode_reward_mean": 1188.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 118.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1000.0, 1450.0, 470.0, 1190.0, 230.0, 1285.0, 1230.0, 1170.0, 1230.0, 1645.0, 220.0, 760.0, 1160.0, 170.0, 2100.0, 1050.0, 1240.0, 1460.0, 1250.0, 1515.0, 1030.0, 1570.0, 1580.0, 925.0, 920.0, 1090.0, 1150.0, 910.0, 380.0, 1440.0, 960.0, 1330.0, 845.0, 1180.0, 1765.0, 1290.0, 1205.0, 960.0, 1760.0, 1450.0, 1445.0, 1710.0, 955.0, 1510.0, 1320.0, 1820.0, 990.0, 1300.0, 995.0, 1270.0, 1170.0, 1850.0, 430.0, 830.0, 1460.0, 1230.0, 1240.0, 1630.0, 690.0, 2110.0, 555.0, 190.0, 1230.0, 1080.0, 570.0, 1670.0, 1300.0, 1700.0, 1310.0, 1300.0, 635.0, 1720.0, 1990.0, 1635.0, 1630.0, 1000.0, 1360.0, 1030.0, 390.0, 905.0, 1485.0, 1380.0, 1280.0, 1255.0, 1580.0, 1130.0, 1080.0, 1610.0, 1050.0, 900.0, 1490.0, 1015.0, 1310.0, 1385.0, 305.0, 1585.0, 1290.0, 1020.0, 745.0, 1260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 230.0, 260.0, 150.0, 70.0, 10.0, 60.0, 60.0, 50.0, 70.0, 60.0, 190.0, 120.0, 20.0, 10.0, 230.0, 160.0, 580.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 120.0, 20.0, 170.0, 30.0, 160.0, 0.0, 290.0, 30.0, 0.0, 30.0, 40.0, 220.0, 0.0, 420.0, 20.0, -20.0, 10.0, 80.0, -50.0, 180.0, 50.0, -10.0, -30.0, 0.0, 50.0, 100.0, 160.0, 330.0, 200.0, 15.0, 180.0, 170.0, 40.0, 40.0, 250.0, 90.0, 20.0, 290.0, 100.0, 30.0, 90.0, 180.0, 170.0, 10.0, 40.0, 30.0, 160.0, 50.0, 40.0, 40.0, 210.0, 170.0, 290.0, 140.0, 25.0, 260.0, 530.0, 180.0, 0.0, 90.0, 10.0, 25.0, 30.0, 80.0, 100.0, 280.0, 0.0, 60.0, 170.0, 70.0, 305.0, 230.0, 90.0, 340.0, 20.0, 20.0, 30.0, 40.0, 0.0, 0.0, 30.0, 40.0, 40.0, 0.0, 70.0, 210.0, 240.0, 40.0, 50.0, 70.0, 30.0, 10.0, 0.0, 40.0, 110.0, 100.0, 30.0, 10.0, 30.0, 540.0, 50.0, 40.0, 190.0, 60.0, 170.0, -970.0, 20.0, -360.0, 30.0, 170.0, 150.0, 590.0, 90.0, 280.0, 340.0, 70.0, 0.0, 100.0, 15.0, 170.0, 110.0, 1140.0, 120.0, 35.0, 70.0, 40.0, 160.0, 80.0, 30.0, 50.0, 160.0, 40.0, 200.0, 220.0, 160.0, 20.0, 80.0, 60.0, 80.0, 130.0, 230.0, 120.0, 120.0, 240.0, 30.0, 30.0, 90.0, 230.0, 100.0, 100.0, 60.0, 70.0, 120.0, 630.0, 20.0, 40.0, 0.0, 430.0, 80.0, 0.0, 90.0, 260.0, 40.0, 290.0, 350.0, 30.0, 160.0, 50.0, 460.0, 230.0, 60.0, 60.0, 50.0, 65.0, 30.0, 200.0, -40.0, 100.0, 90.0, 100.0, 150.0, 140.0, 40.0, 220.0, 10.0, 150.0, 30.0, 160.0, 30.0, 220.0, 180.0, -20.0, 240.0, 570.0, 150.0, 200.0, 240.0, 90.0, 130.0, 270.0, 70.0, 150.0, 230.0, 50.0, 120.0, 5.0, 10.0, 80.0, 110.0, 120.0, 100.0, 140.0, 80.0, 160.0, 30.0, 390.0, 40.0, 30.0, 70.0, 30.0, 70.0, 20.0, 170.0, 70.0, 50.0, 40.0, 230.0, 420.0, 10.0, 20.0, 40.0, 0.0, 280.0, 0.0, 40.0, 220.0, 50.0, 120.0, 110.0, 30.0, 60.0, 160.0, 140.0, 220.0, 10.0, 0.0, 30.0, 110.0, 80.0, 310.0, 240.0, 30.0, 30.0, 70.0, 40.0, 110.0, 0.0, 0.0, 10.0, 90.0, 40.0, 50.0, 70.0, -30.0, 80.0, 160.0, 380.0, 150.0, 190.0, 190.0, -240.0, 240.0, 190.0, 100.0, 40.0, 60.0, 260.0, 20.0, 130.0, 20.0, 70.0, 210.0, 60.0, 90.0, 70.0, 300.0, 40.0, 230.0, 0.0, 70.0, 70.0, 30.0, 230.0, 290.0, 50.0, 180.0, 20.0, 10.0, 130.0, 40.0, 0.0, 25.0, 370.0, 20.0, 0.0, 190.0, 80.0, 80.0, 30.0, 30.0, 530.0, 0.0, 180.0, 60.0, 100.0, 470.0, 240.0, 195.0, 110.0, 70.0, 80.0, 80.0, 60.0, 360.0, 300.0, 130.0, 70.0, 40.0, 120.0, 40.0, 10.0, 70.0, 320.0, 190.0, 55.0, 190.0, 90.0, 120.0, 40.0, 110.0, 70.0, -10.0, 80.0, 460.0, -25.0, 180.0, 135.0, 90.0, 200.0, 40.0, 0.0, 250.0, 20.0, 70.0, 110.0, 260.0, 140.0, 80.0, 120.0, 130.0, -10.0, 230.0, 530.0, 170.0, 100.0, 110.0, 70.0, 320.0, 100.0, 240.0, 200.0, 90.0, 160.0, 60.0, 60.0, 200.0, 240.0, 105.0, 120.0, 40.0, 40.0, 350.0, 100.0, 190.0, 90.0, 190.0, 160.0, 60.0, 130.0, 10.0, 270.0, 270.0, 50.0, 480.0, 500.0, 40.0, 0.0, 60.0, 90.0, 120.0, 20.0, 15.0, 20.0, 90.0, 170.0, 210.0, 150.0, 60.0, 80.0, 40.0, 300.0, 110.0, 160.0, 230.0, 90.0, 10.0, 250.0, 10.0, 40.0, 120.0, 160.0, 100.0, 20.0, 520.0, 360.0, 200.0, 90.0, 400.0, 70.0, 340.0, 160.0, 40.0, 130.0, 30.0, 10.0, 20.0, 280.0, 80.0, 300.0, 80.0, 160.0, 50.0, 10.0, 0.0, 140.0, 30.0, 60.0, 190.0, 110.0, 150.0, 30.0, 20.0, 390.0, 180.0, 570.0, 40.0, 10.0, 10.0, 100.0, 110.0, -30.0, 150.0, 30.0, 5.0, 60.0, 110.0, 90.0, 0.0, -40.0, 220.0, 210.0, 160.0, 390.0, 70.0, 70.0, 70.0, 330.0, 190.0, 210.0, 30.0, -50.0, 80.0, 230.0, 10.0, 20.0, 220.0, 110.0, 870.0, 70.0, 180.0, 90.0, 250.0, 20.0, 20.0, 0.0, 100.0, 70.0, 20.0, 50.0, 20.0, 10.0, 20.0, 20.0, 120.0, 0.0, 70.0, 100.0, 180.0, 0.0, 130.0, 30.0, 120.0, 180.0, 20.0, 310.0, 320.0, 10.0, 110.0, 80.0, 70.0, 80.0, 190.0, 60.0, 230.0, 220.0, 340.0, -50.0, 10.0, 400.0, 280.0, -10.0, 0.0, 0.0, 40.0, 80.0, 50.0, 10.0, 180.0, 120.0, 120.0, 100.0, 60.0, 290.0, 230.0, 60.0, 20.0, 160.0, 200.0, 160.0, 20.0, 80.0, 110.0, 160.0, 660.0, 20.0, 50.0, 0.0, -10.0, 490.0, 30.0, 10.0, 60.0, 10.0, 30.0, 180.0, 50.0, 130.0, 90.0, 170.0, 70.0, 290.0, 120.0, 170.0, 840.0, -330.0, 180.0, 230.0, -290.0, 170.0, 60.0, 70.0, 340.0, 70.0, 55.0, 10.0, 120.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 150.0, 390.0, -20.0, 80.0, 90.0, 90.0, -50.0, 200.0, 60.0, 240.0, 230.0, 70.0, 400.0, 10.0, 20.0, 20.0, 60.0, 190.0, 10.0, 70.0, 70.0, 30.0, 20.0, 20.0, 0.0, 160.0, 100.0, 20.0, 40.0, 110.0, 420.0, 190.0, 260.0, 40.0, 120.0, 80.0, 320.0, 70.0, 110.0, 60.0, 230.0, -20.0, 140.0, 110.0, 220.0, 180.0, 160.0, 190.0, 60.0, 30.0, 110.0, 100.0, 190.0, 180.0, 200.0, 30.0, 10.0, 550.0, 230.0, 100.0, 50.0, 490.0, -40.0, 40.0, 120.0, 150.0, -30.0, 480.0, 40.0, 10.0, 170.0, 30.0, 160.0, 50.0, 100.0, 60.0, 340.0, 150.0, 140.0, 100.0, 230.0, -65.0, 50.0, 220.0, -20.0, 220.0, 420.0, 20.0, 20.0, -460.0, 240.0, 90.0, 410.0, 70.0, 50.0, 230.0, 50.0, 250.0, 260.0, 70.0, 210.0, 100.0, 180.0, 580.0, 80.0, 190.0, 130.0, 330.0, 80.0, 110.0, 230.0, 40.0, 40.0, 290.0, 90.0, 55.0, 410.0, -30.0, 220.0, 290.0, -5.0, -30.0, 50.0, 510.0, 190.0, 70.0, 480.0, 80.0, 35.0, 250.0, 200.0, -30.0, 280.0, 130.0, 110.0, 160.0, 20.0, 70.0, -10.0, 70.0, 90.0, 80.0, 390.0, 190.0, 50.0, 60.0, 270.0, 20.0, 190.0, 20.0, 50.0, 190.0, 20.0, 20.0, 10.0, 40.0, 470.0, 20.0, 200.0, 10.0, 0.0, 40.0, 40.0, 60.0, 20.0, 40.0, 40.0, 0.0, 20.0, 130.0, 10.0, 360.0, 40.0, 25.0, -290.0, 150.0, 180.0, 330.0, 20.0, 80.0, 50.0, 230.0, 20.0, 170.0, 40.0, 40.0, 190.0, 600.0, -25.0, 170.0, 120.0, 30.0, 260.0, 160.0, 250.0, 30.0, 230.0, 130.0, 60.0, 110.0, 40.0, 190.0, 190.0, 180.0, 40.0, 130.0, 70.0, 320.0, 40.0, 80.0, -10.0, 150.0, 20.0, 50.0, 50.0, 10.0, 405.0, 80.0, 370.0, 130.0, 210.0, -110.0, 180.0, 410.0, 70.0, 70.0, 120.0, 460.0, 140.0, 30.0, 130.0, 290.0, 0.0, 20.0, 210.0, 70.0, 210.0, -30.0, 60.0, 170.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 110.0, 60.0, 260.0, 80.0, -20.0, 150.0, 40.0, 310.0, 210.0, 110.0, 70.0, 170.0, 410.0, 160.0, 20.0, 0.0, 310.0, 40.0, 40.0, 10.0, 370.0, 160.0, 80.0, 20.0, 20.0, 20.0, 200.0, 50.0, 20.0, 350.0, 10.0, 30.0, 170.0, 30.0, 30.0, 40.0, 200.0, -70.0, 250.0, 60.0, 90.0, 510.0, 160.0, 220.0, 20.0, 170.0, 55.0, 40.0, 30.0, 90.0, 180.0, 40.0, 80.0, 310.0, 160.0, 30.0, 200.0, 170.0, 80.0, 110.0, 170.0, 280.0, 10.0, 100.0, 70.0, 40.0, 160.0, 455.0, 60.0, 410.0, 70.0, 60.0, 20.0, 40.0, 20.0, 35.0, 0.0, 40.0, 10.0, 30.0, 60.0, 0.0, 40.0, 70.0, 200.0, 170.0, 70.0, 85.0, 150.0, 330.0, 190.0, 130.0, 210.0, 50.0, 210.0, 100.0, 50.0, -20.0, 20.0, 420.0, 90.0, 110.0, 130.0, 180.0, 30.0, 40.0, 130.0, 310.0, -50.0, -100.0, 30.0, 400.0, 70.0, 160.0, 170.0, 20.0, 10.0, 40.0, 110.0, 50.0, 20.0, 310.0, 15.0, 0.0, 50.0, 250.0, 340.0, 20.0, 40.0, 20.0, 90.0, 30.0, 170.0, 250.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6669940288138076, "mean_inference_ms": 1.504560737316553, "mean_action_processing_ms": 0.4243800051261435, "mean_env_wait_ms": 1.3475907182583733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014951705932617188, "StateBufferConnector_ms": 0.011488199234008789, "ViewRequirementAgentConnector_ms": 0.463883638381958}, "num_episodes": 22, "episode_return_max": 2110.0, "episode_return_min": 170.0, "episode_return_mean": 1188.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.223910200312044, "num_env_steps_trained_throughput_per_sec": 19.223910200312044, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 5240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5240000, "timers": {"training_iteration_time_ms": 208725.028, "restore_workers_time_ms": 0.014, "training_step_time_ms": 208724.981, "sample_time_ms": 2657.5, "learn_time_ms": 206046.714, "learn_throughput": 19.413, "synch_weights_time_ms": 12.885}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "done": false, "training_iteration": 131, "trial_id": "aa996_00000", "date": "2024-05-24_06-21-20", "timestamp": 1716546080, "time_this_iter_s": 208.08217692375183, "time_total_s": 27346.0627245903, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d89670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27346.0627245903, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 19.063389830508477, "ram_util_percent": 79.49864406779662}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5449982932581308, "cur_kl_coeff": 0.8659522734582427, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006752191354913381, "vf_loss": 7.839645056729626, "vf_explained_var": 8.148510362139652e-05, "kl": Infinity, "entropy": 0.2517161750453857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1234785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "env_runners": {"episode_reward_max": 2115.0, "episode_reward_min": 190.0, "episode_reward_mean": 1225.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -460.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 122.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1250.0, 1515.0, 1030.0, 1570.0, 1580.0, 925.0, 920.0, 1090.0, 1150.0, 910.0, 380.0, 1440.0, 960.0, 1330.0, 845.0, 1180.0, 1765.0, 1290.0, 1205.0, 960.0, 1760.0, 1450.0, 1445.0, 1710.0, 955.0, 1510.0, 1320.0, 1820.0, 990.0, 1300.0, 995.0, 1270.0, 1170.0, 1850.0, 430.0, 830.0, 1460.0, 1230.0, 1240.0, 1630.0, 690.0, 2110.0, 555.0, 190.0, 1230.0, 1080.0, 570.0, 1670.0, 1300.0, 1700.0, 1310.0, 1300.0, 635.0, 1720.0, 1990.0, 1635.0, 1630.0, 1000.0, 1360.0, 1030.0, 390.0, 905.0, 1485.0, 1380.0, 1280.0, 1255.0, 1580.0, 1130.0, 1080.0, 1610.0, 1050.0, 900.0, 1490.0, 1015.0, 1310.0, 1385.0, 305.0, 1585.0, 1290.0, 1020.0, 745.0, 1260.0, 2115.0, 1525.0, 1530.0, 1320.0, 1410.0, 1545.0, 1265.0, 1400.0, 1240.0, 1290.0, 375.0, 810.0, 1440.0, 805.0, 940.0, 1815.0, 660.0, 1220.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 40.0, 0.0, 430.0, 80.0, 0.0, 90.0, 260.0, 40.0, 290.0, 350.0, 30.0, 160.0, 50.0, 460.0, 230.0, 60.0, 60.0, 50.0, 65.0, 30.0, 200.0, -40.0, 100.0, 90.0, 100.0, 150.0, 140.0, 40.0, 220.0, 10.0, 150.0, 30.0, 160.0, 30.0, 220.0, 180.0, -20.0, 240.0, 570.0, 150.0, 200.0, 240.0, 90.0, 130.0, 270.0, 70.0, 150.0, 230.0, 50.0, 120.0, 5.0, 10.0, 80.0, 110.0, 120.0, 100.0, 140.0, 80.0, 160.0, 30.0, 390.0, 40.0, 30.0, 70.0, 30.0, 70.0, 20.0, 170.0, 70.0, 50.0, 40.0, 230.0, 420.0, 10.0, 20.0, 40.0, 0.0, 280.0, 0.0, 40.0, 220.0, 50.0, 120.0, 110.0, 30.0, 60.0, 160.0, 140.0, 220.0, 10.0, 0.0, 30.0, 110.0, 80.0, 310.0, 240.0, 30.0, 30.0, 70.0, 40.0, 110.0, 0.0, 0.0, 10.0, 90.0, 40.0, 50.0, 70.0, -30.0, 80.0, 160.0, 380.0, 150.0, 190.0, 190.0, -240.0, 240.0, 190.0, 100.0, 40.0, 60.0, 260.0, 20.0, 130.0, 20.0, 70.0, 210.0, 60.0, 90.0, 70.0, 300.0, 40.0, 230.0, 0.0, 70.0, 70.0, 30.0, 230.0, 290.0, 50.0, 180.0, 20.0, 10.0, 130.0, 40.0, 0.0, 25.0, 370.0, 20.0, 0.0, 190.0, 80.0, 80.0, 30.0, 30.0, 530.0, 0.0, 180.0, 60.0, 100.0, 470.0, 240.0, 195.0, 110.0, 70.0, 80.0, 80.0, 60.0, 360.0, 300.0, 130.0, 70.0, 40.0, 120.0, 40.0, 10.0, 70.0, 320.0, 190.0, 55.0, 190.0, 90.0, 120.0, 40.0, 110.0, 70.0, -10.0, 80.0, 460.0, -25.0, 180.0, 135.0, 90.0, 200.0, 40.0, 0.0, 250.0, 20.0, 70.0, 110.0, 260.0, 140.0, 80.0, 120.0, 130.0, -10.0, 230.0, 530.0, 170.0, 100.0, 110.0, 70.0, 320.0, 100.0, 240.0, 200.0, 90.0, 160.0, 60.0, 60.0, 200.0, 240.0, 105.0, 120.0, 40.0, 40.0, 350.0, 100.0, 190.0, 90.0, 190.0, 160.0, 60.0, 130.0, 10.0, 270.0, 270.0, 50.0, 480.0, 500.0, 40.0, 0.0, 60.0, 90.0, 120.0, 20.0, 15.0, 20.0, 90.0, 170.0, 210.0, 150.0, 60.0, 80.0, 40.0, 300.0, 110.0, 160.0, 230.0, 90.0, 10.0, 250.0, 10.0, 40.0, 120.0, 160.0, 100.0, 20.0, 520.0, 360.0, 200.0, 90.0, 400.0, 70.0, 340.0, 160.0, 40.0, 130.0, 30.0, 10.0, 20.0, 280.0, 80.0, 300.0, 80.0, 160.0, 50.0, 10.0, 0.0, 140.0, 30.0, 60.0, 190.0, 110.0, 150.0, 30.0, 20.0, 390.0, 180.0, 570.0, 40.0, 10.0, 10.0, 100.0, 110.0, -30.0, 150.0, 30.0, 5.0, 60.0, 110.0, 90.0, 0.0, -40.0, 220.0, 210.0, 160.0, 390.0, 70.0, 70.0, 70.0, 330.0, 190.0, 210.0, 30.0, -50.0, 80.0, 230.0, 10.0, 20.0, 220.0, 110.0, 870.0, 70.0, 180.0, 90.0, 250.0, 20.0, 20.0, 0.0, 100.0, 70.0, 20.0, 50.0, 20.0, 10.0, 20.0, 20.0, 120.0, 0.0, 70.0, 100.0, 180.0, 0.0, 130.0, 30.0, 120.0, 180.0, 20.0, 310.0, 320.0, 10.0, 110.0, 80.0, 70.0, 80.0, 190.0, 60.0, 230.0, 220.0, 340.0, -50.0, 10.0, 400.0, 280.0, -10.0, 0.0, 0.0, 40.0, 80.0, 50.0, 10.0, 180.0, 120.0, 120.0, 100.0, 60.0, 290.0, 230.0, 60.0, 20.0, 160.0, 200.0, 160.0, 20.0, 80.0, 110.0, 160.0, 660.0, 20.0, 50.0, 0.0, -10.0, 490.0, 30.0, 10.0, 60.0, 10.0, 30.0, 180.0, 50.0, 130.0, 90.0, 170.0, 70.0, 290.0, 120.0, 170.0, 840.0, -330.0, 180.0, 230.0, -290.0, 170.0, 60.0, 70.0, 340.0, 70.0, 55.0, 10.0, 120.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 150.0, 390.0, -20.0, 80.0, 90.0, 90.0, -50.0, 200.0, 60.0, 240.0, 230.0, 70.0, 400.0, 10.0, 20.0, 20.0, 60.0, 190.0, 10.0, 70.0, 70.0, 30.0, 20.0, 20.0, 0.0, 160.0, 100.0, 20.0, 40.0, 110.0, 420.0, 190.0, 260.0, 40.0, 120.0, 80.0, 320.0, 70.0, 110.0, 60.0, 230.0, -20.0, 140.0, 110.0, 220.0, 180.0, 160.0, 190.0, 60.0, 30.0, 110.0, 100.0, 190.0, 180.0, 200.0, 30.0, 10.0, 550.0, 230.0, 100.0, 50.0, 490.0, -40.0, 40.0, 120.0, 150.0, -30.0, 480.0, 40.0, 10.0, 170.0, 30.0, 160.0, 50.0, 100.0, 60.0, 340.0, 150.0, 140.0, 100.0, 230.0, -65.0, 50.0, 220.0, -20.0, 220.0, 420.0, 20.0, 20.0, -460.0, 240.0, 90.0, 410.0, 70.0, 50.0, 230.0, 50.0, 250.0, 260.0, 70.0, 210.0, 100.0, 180.0, 580.0, 80.0, 190.0, 130.0, 330.0, 80.0, 110.0, 230.0, 40.0, 40.0, 290.0, 90.0, 55.0, 410.0, -30.0, 220.0, 290.0, -5.0, -30.0, 50.0, 510.0, 190.0, 70.0, 480.0, 80.0, 35.0, 250.0, 200.0, -30.0, 280.0, 130.0, 110.0, 160.0, 20.0, 70.0, -10.0, 70.0, 90.0, 80.0, 390.0, 190.0, 50.0, 60.0, 270.0, 20.0, 190.0, 20.0, 50.0, 190.0, 20.0, 20.0, 10.0, 40.0, 470.0, 20.0, 200.0, 10.0, 0.0, 40.0, 40.0, 60.0, 20.0, 40.0, 40.0, 0.0, 20.0, 130.0, 10.0, 360.0, 40.0, 25.0, -290.0, 150.0, 180.0, 330.0, 20.0, 80.0, 50.0, 230.0, 20.0, 170.0, 40.0, 40.0, 190.0, 600.0, -25.0, 170.0, 120.0, 30.0, 260.0, 160.0, 250.0, 30.0, 230.0, 130.0, 60.0, 110.0, 40.0, 190.0, 190.0, 180.0, 40.0, 130.0, 70.0, 320.0, 40.0, 80.0, -10.0, 150.0, 20.0, 50.0, 50.0, 10.0, 405.0, 80.0, 370.0, 130.0, 210.0, -110.0, 180.0, 410.0, 70.0, 70.0, 120.0, 460.0, 140.0, 30.0, 130.0, 290.0, 0.0, 20.0, 210.0, 70.0, 210.0, -30.0, 60.0, 170.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 110.0, 60.0, 260.0, 80.0, -20.0, 150.0, 40.0, 310.0, 210.0, 110.0, 70.0, 170.0, 410.0, 160.0, 20.0, 0.0, 310.0, 40.0, 40.0, 10.0, 370.0, 160.0, 80.0, 20.0, 20.0, 20.0, 200.0, 50.0, 20.0, 350.0, 10.0, 30.0, 170.0, 30.0, 30.0, 40.0, 200.0, -70.0, 250.0, 60.0, 90.0, 510.0, 160.0, 220.0, 20.0, 170.0, 55.0, 40.0, 30.0, 90.0, 180.0, 40.0, 80.0, 310.0, 160.0, 30.0, 200.0, 170.0, 80.0, 110.0, 170.0, 280.0, 10.0, 100.0, 70.0, 40.0, 160.0, 455.0, 60.0, 410.0, 70.0, 60.0, 20.0, 40.0, 20.0, 35.0, 0.0, 40.0, 10.0, 30.0, 60.0, 0.0, 40.0, 70.0, 200.0, 170.0, 70.0, 85.0, 150.0, 330.0, 190.0, 130.0, 210.0, 50.0, 210.0, 100.0, 50.0, -20.0, 20.0, 420.0, 90.0, 110.0, 130.0, 180.0, 30.0, 40.0, 130.0, 310.0, -50.0, -100.0, 30.0, 400.0, 70.0, 160.0, 170.0, 20.0, 10.0, 40.0, 110.0, 50.0, 20.0, 310.0, 15.0, 0.0, 50.0, 250.0, 340.0, 20.0, 40.0, 20.0, 90.0, 30.0, 170.0, 250.0, 280.0, 80.0, 590.0, 100.0, 45.0, 240.0, 60.0, -10.0, 600.0, 130.0, 80.0, 120.0, 30.0, 250.0, 65.0, 170.0, 120.0, 60.0, 530.0, 100.0, 110.0, 10.0, 50.0, 300.0, 50.0, 190.0, 60.0, 330.0, 360.0, 70.0, 160.0, 50.0, 30.0, 120.0, 200.0, 120.0, 40.0, 200.0, 380.0, 20.0, 120.0, 330.0, 140.0, 40.0, 100.0, 340.0, 60.0, 80.0, 40.0, 160.0, 55.0, 40.0, 140.0, 180.0, 150.0, 390.0, 70.0, 130.0, 340.0, 50.0, 0.0, 170.0, 90.0, 50.0, 305.0, 190.0, 50.0, 30.0, 230.0, 150.0, 100.0, 100.0, 80.0, 250.0, 20.0, 280.0, 150.0, 430.0, -20.0, 10.0, 20.0, 430.0, 110.0, 80.0, 120.0, 30.0, 130.0, 10.0, 10.0, 300.0, 270.0, 90.0, 30.0, 310.0, 10.0, 30.0, 240.0, 120.0, 40.0, 150.0, 10.0, 0.0, 10.0, 10.0, 40.0, 10.0, 220.0, 10.0, 40.0, 25.0, 110.0, 0.0, 360.0, 110.0, 20.0, 60.0, 90.0, 40.0, 50.0, -30.0, 290.0, 210.0, 110.0, 200.0, 0.0, 20.0, 420.0, 0.0, 120.0, 70.0, 20.0, -30.0, 360.0, -75.0, 10.0, 30.0, 0.0, -50.0, 230.0, 310.0, 10.0, 300.0, 130.0, 10.0, 160.0, 180.0, 90.0, 0.0, 40.0, 20.0, 230.0, 170.0, 640.0, 60.0, 70.0, 190.0, 45.0, 130.0, 220.0, 60.0, 0.0, 20.0, 0.0, 30.0, 90.0, 30.0, 10.0, 260.0, 180.0, 40.0, 640.0, 20.0, 60.0, 110.0, 20.0, 100.0, 40.0, 10.0, 100.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6652025476687187, "mean_inference_ms": 1.50309697082024, "mean_action_processing_ms": 0.4242222915948631, "mean_env_wait_ms": 1.3488909175964998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014546871185302734, "StateBufferConnector_ms": 0.01122283935546875, "ViewRequirementAgentConnector_ms": 0.46633028984069824}, "num_episodes": 18, "episode_return_max": 2115.0, "episode_return_min": 190.0, "episode_return_mean": 1225.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.1370924298075, "num_env_steps_trained_throughput_per_sec": 19.1370924298075, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 5280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5280000, "timers": {"training_iteration_time_ms": 208646.609, "restore_workers_time_ms": 0.014, "training_step_time_ms": 208646.562, "sample_time_ms": 2658.931, "learn_time_ms": 205966.079, "learn_throughput": 19.421, "synch_weights_time_ms": 12.991}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "done": false, "training_iteration": 132, "trial_id": "aa996_00000", "date": "2024-05-24_06-24-49", "timestamp": 1716546289, "time_this_iter_s": 209.0315101146698, "time_total_s": 27555.09423470497, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b23ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27555.09423470497, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 20.227796610169495, "ram_util_percent": 79.91728813559322}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4851307879558133, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005924872847864577, "vf_loss": 7.105337183823347, "vf_explained_var": 0.0007264662664919235, "kl": Infinity, "entropy": 0.26306731899738056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1244175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "env_runners": {"episode_reward_max": 2115.0, "episode_reward_min": 190.0, "episode_reward_mean": 1219.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -460.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 121.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1205.0, 960.0, 1760.0, 1450.0, 1445.0, 1710.0, 955.0, 1510.0, 1320.0, 1820.0, 990.0, 1300.0, 995.0, 1270.0, 1170.0, 1850.0, 430.0, 830.0, 1460.0, 1230.0, 1240.0, 1630.0, 690.0, 2110.0, 555.0, 190.0, 1230.0, 1080.0, 570.0, 1670.0, 1300.0, 1700.0, 1310.0, 1300.0, 635.0, 1720.0, 1990.0, 1635.0, 1630.0, 1000.0, 1360.0, 1030.0, 390.0, 905.0, 1485.0, 1380.0, 1280.0, 1255.0, 1580.0, 1130.0, 1080.0, 1610.0, 1050.0, 900.0, 1490.0, 1015.0, 1310.0, 1385.0, 305.0, 1585.0, 1290.0, 1020.0, 745.0, 1260.0, 2115.0, 1525.0, 1530.0, 1320.0, 1410.0, 1545.0, 1265.0, 1400.0, 1240.0, 1290.0, 375.0, 810.0, 1440.0, 805.0, 940.0, 1815.0, 660.0, 1220.0, 1240.0, 1690.0, 660.0, 1530.0, 910.0, 950.0, 885.0, 1280.0, 1980.0, 420.0, 1560.0, 510.0, 1140.0, 1090.0, 1270.0, 1165.0, 990.0, 1310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [55.0, 190.0, 90.0, 120.0, 40.0, 110.0, 70.0, -10.0, 80.0, 460.0, -25.0, 180.0, 135.0, 90.0, 200.0, 40.0, 0.0, 250.0, 20.0, 70.0, 110.0, 260.0, 140.0, 80.0, 120.0, 130.0, -10.0, 230.0, 530.0, 170.0, 100.0, 110.0, 70.0, 320.0, 100.0, 240.0, 200.0, 90.0, 160.0, 60.0, 60.0, 200.0, 240.0, 105.0, 120.0, 40.0, 40.0, 350.0, 100.0, 190.0, 90.0, 190.0, 160.0, 60.0, 130.0, 10.0, 270.0, 270.0, 50.0, 480.0, 500.0, 40.0, 0.0, 60.0, 90.0, 120.0, 20.0, 15.0, 20.0, 90.0, 170.0, 210.0, 150.0, 60.0, 80.0, 40.0, 300.0, 110.0, 160.0, 230.0, 90.0, 10.0, 250.0, 10.0, 40.0, 120.0, 160.0, 100.0, 20.0, 520.0, 360.0, 200.0, 90.0, 400.0, 70.0, 340.0, 160.0, 40.0, 130.0, 30.0, 10.0, 20.0, 280.0, 80.0, 300.0, 80.0, 160.0, 50.0, 10.0, 0.0, 140.0, 30.0, 60.0, 190.0, 110.0, 150.0, 30.0, 20.0, 390.0, 180.0, 570.0, 40.0, 10.0, 10.0, 100.0, 110.0, -30.0, 150.0, 30.0, 5.0, 60.0, 110.0, 90.0, 0.0, -40.0, 220.0, 210.0, 160.0, 390.0, 70.0, 70.0, 70.0, 330.0, 190.0, 210.0, 30.0, -50.0, 80.0, 230.0, 10.0, 20.0, 220.0, 110.0, 870.0, 70.0, 180.0, 90.0, 250.0, 20.0, 20.0, 0.0, 100.0, 70.0, 20.0, 50.0, 20.0, 10.0, 20.0, 20.0, 120.0, 0.0, 70.0, 100.0, 180.0, 0.0, 130.0, 30.0, 120.0, 180.0, 20.0, 310.0, 320.0, 10.0, 110.0, 80.0, 70.0, 80.0, 190.0, 60.0, 230.0, 220.0, 340.0, -50.0, 10.0, 400.0, 280.0, -10.0, 0.0, 0.0, 40.0, 80.0, 50.0, 10.0, 180.0, 120.0, 120.0, 100.0, 60.0, 290.0, 230.0, 60.0, 20.0, 160.0, 200.0, 160.0, 20.0, 80.0, 110.0, 160.0, 660.0, 20.0, 50.0, 0.0, -10.0, 490.0, 30.0, 10.0, 60.0, 10.0, 30.0, 180.0, 50.0, 130.0, 90.0, 170.0, 70.0, 290.0, 120.0, 170.0, 840.0, -330.0, 180.0, 230.0, -290.0, 170.0, 60.0, 70.0, 340.0, 70.0, 55.0, 10.0, 120.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 150.0, 390.0, -20.0, 80.0, 90.0, 90.0, -50.0, 200.0, 60.0, 240.0, 230.0, 70.0, 400.0, 10.0, 20.0, 20.0, 60.0, 190.0, 10.0, 70.0, 70.0, 30.0, 20.0, 20.0, 0.0, 160.0, 100.0, 20.0, 40.0, 110.0, 420.0, 190.0, 260.0, 40.0, 120.0, 80.0, 320.0, 70.0, 110.0, 60.0, 230.0, -20.0, 140.0, 110.0, 220.0, 180.0, 160.0, 190.0, 60.0, 30.0, 110.0, 100.0, 190.0, 180.0, 200.0, 30.0, 10.0, 550.0, 230.0, 100.0, 50.0, 490.0, -40.0, 40.0, 120.0, 150.0, -30.0, 480.0, 40.0, 10.0, 170.0, 30.0, 160.0, 50.0, 100.0, 60.0, 340.0, 150.0, 140.0, 100.0, 230.0, -65.0, 50.0, 220.0, -20.0, 220.0, 420.0, 20.0, 20.0, -460.0, 240.0, 90.0, 410.0, 70.0, 50.0, 230.0, 50.0, 250.0, 260.0, 70.0, 210.0, 100.0, 180.0, 580.0, 80.0, 190.0, 130.0, 330.0, 80.0, 110.0, 230.0, 40.0, 40.0, 290.0, 90.0, 55.0, 410.0, -30.0, 220.0, 290.0, -5.0, -30.0, 50.0, 510.0, 190.0, 70.0, 480.0, 80.0, 35.0, 250.0, 200.0, -30.0, 280.0, 130.0, 110.0, 160.0, 20.0, 70.0, -10.0, 70.0, 90.0, 80.0, 390.0, 190.0, 50.0, 60.0, 270.0, 20.0, 190.0, 20.0, 50.0, 190.0, 20.0, 20.0, 10.0, 40.0, 470.0, 20.0, 200.0, 10.0, 0.0, 40.0, 40.0, 60.0, 20.0, 40.0, 40.0, 0.0, 20.0, 130.0, 10.0, 360.0, 40.0, 25.0, -290.0, 150.0, 180.0, 330.0, 20.0, 80.0, 50.0, 230.0, 20.0, 170.0, 40.0, 40.0, 190.0, 600.0, -25.0, 170.0, 120.0, 30.0, 260.0, 160.0, 250.0, 30.0, 230.0, 130.0, 60.0, 110.0, 40.0, 190.0, 190.0, 180.0, 40.0, 130.0, 70.0, 320.0, 40.0, 80.0, -10.0, 150.0, 20.0, 50.0, 50.0, 10.0, 405.0, 80.0, 370.0, 130.0, 210.0, -110.0, 180.0, 410.0, 70.0, 70.0, 120.0, 460.0, 140.0, 30.0, 130.0, 290.0, 0.0, 20.0, 210.0, 70.0, 210.0, -30.0, 60.0, 170.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 110.0, 60.0, 260.0, 80.0, -20.0, 150.0, 40.0, 310.0, 210.0, 110.0, 70.0, 170.0, 410.0, 160.0, 20.0, 0.0, 310.0, 40.0, 40.0, 10.0, 370.0, 160.0, 80.0, 20.0, 20.0, 20.0, 200.0, 50.0, 20.0, 350.0, 10.0, 30.0, 170.0, 30.0, 30.0, 40.0, 200.0, -70.0, 250.0, 60.0, 90.0, 510.0, 160.0, 220.0, 20.0, 170.0, 55.0, 40.0, 30.0, 90.0, 180.0, 40.0, 80.0, 310.0, 160.0, 30.0, 200.0, 170.0, 80.0, 110.0, 170.0, 280.0, 10.0, 100.0, 70.0, 40.0, 160.0, 455.0, 60.0, 410.0, 70.0, 60.0, 20.0, 40.0, 20.0, 35.0, 0.0, 40.0, 10.0, 30.0, 60.0, 0.0, 40.0, 70.0, 200.0, 170.0, 70.0, 85.0, 150.0, 330.0, 190.0, 130.0, 210.0, 50.0, 210.0, 100.0, 50.0, -20.0, 20.0, 420.0, 90.0, 110.0, 130.0, 180.0, 30.0, 40.0, 130.0, 310.0, -50.0, -100.0, 30.0, 400.0, 70.0, 160.0, 170.0, 20.0, 10.0, 40.0, 110.0, 50.0, 20.0, 310.0, 15.0, 0.0, 50.0, 250.0, 340.0, 20.0, 40.0, 20.0, 90.0, 30.0, 170.0, 250.0, 280.0, 80.0, 590.0, 100.0, 45.0, 240.0, 60.0, -10.0, 600.0, 130.0, 80.0, 120.0, 30.0, 250.0, 65.0, 170.0, 120.0, 60.0, 530.0, 100.0, 110.0, 10.0, 50.0, 300.0, 50.0, 190.0, 60.0, 330.0, 360.0, 70.0, 160.0, 50.0, 30.0, 120.0, 200.0, 120.0, 40.0, 200.0, 380.0, 20.0, 120.0, 330.0, 140.0, 40.0, 100.0, 340.0, 60.0, 80.0, 40.0, 160.0, 55.0, 40.0, 140.0, 180.0, 150.0, 390.0, 70.0, 130.0, 340.0, 50.0, 0.0, 170.0, 90.0, 50.0, 305.0, 190.0, 50.0, 30.0, 230.0, 150.0, 100.0, 100.0, 80.0, 250.0, 20.0, 280.0, 150.0, 430.0, -20.0, 10.0, 20.0, 430.0, 110.0, 80.0, 120.0, 30.0, 130.0, 10.0, 10.0, 300.0, 270.0, 90.0, 30.0, 310.0, 10.0, 30.0, 240.0, 120.0, 40.0, 150.0, 10.0, 0.0, 10.0, 10.0, 40.0, 10.0, 220.0, 10.0, 40.0, 25.0, 110.0, 0.0, 360.0, 110.0, 20.0, 60.0, 90.0, 40.0, 50.0, -30.0, 290.0, 210.0, 110.0, 200.0, 0.0, 20.0, 420.0, 0.0, 120.0, 70.0, 20.0, -30.0, 360.0, -75.0, 10.0, 30.0, 0.0, -50.0, 230.0, 310.0, 10.0, 300.0, 130.0, 10.0, 160.0, 180.0, 90.0, 0.0, 40.0, 20.0, 230.0, 170.0, 640.0, 60.0, 70.0, 190.0, 45.0, 130.0, 220.0, 60.0, 0.0, 20.0, 0.0, 30.0, 90.0, 30.0, 10.0, 260.0, 180.0, 40.0, 640.0, 20.0, 60.0, 110.0, 20.0, 100.0, 40.0, 10.0, 100.0, 120.0, 150.0, 260.0, 150.0, 90.0, 70.0, 140.0, 120.0, 60.0, 100.0, 100.0, 170.0, 30.0, 20.0, 130.0, 180.0, 150.0, 220.0, 270.0, 290.0, 230.0, 40.0, 0.0, 40.0, 50.0, 360.0, 20.0, 30.0, 40.0, 10.0, 70.0, 80.0, 60.0, 140.0, 260.0, 180.0, 110.0, 50.0, 90.0, 70.0, 490.0, 30.0, 0.0, 100.0, 190.0, 60.0, 140.0, 95.0, 240.0, 140.0, -85.0, 110.0, 40.0, 60.0, 290.0, 60.0, 90.0, 40.0, 50.0, 80.0, 130.0, 40.0, 90.0, 60.0, 150.0, -80.0, 30.0, 10.0, 420.0, 155.0, 10.0, 70.0, 10.0, 360.0, 110.0, 70.0, -40.0, 260.0, 40.0, 240.0, 160.0, 160.0, 100.0, 680.0, 50.0, 90.0, 80.0, 40.0, 360.0, 10.0, 410.0, 0.0, 50.0, 80.0, 40.0, 40.0, 160.0, 0.0, 50.0, 0.0, 0.0, 80.0, 160.0, 30.0, 220.0, 540.0, 140.0, 120.0, 140.0, 30.0, 100.0, 70.0, 10.0, 20.0, 0.0, 70.0, 0.0, 40.0, 90.0, 140.0, 70.0, 320.0, 25.0, 80.0, 80.0, 110.0, 30.0, -40.0, 165.0, 220.0, 150.0, 310.0, 250.0, 30.0, 170.0, 180.0, -20.0, 120.0, 10.0, -20.0, 60.0, 120.0, 110.0, 420.0, -50.0, 100.0, 240.0, 40.0, 40.0, 130.0, 120.0, 30.0, 180.0, 130.0, 80.0, 90.0, 80.0, 140.0, 400.0, -5.0, 40.0, 50.0, 20.0, 190.0, 80.0, 160.0, 70.0, 70.0, -60.0, 280.0, 130.0, 430.0, 70.0, 10.0, 20.0, 90.0, 300.0, 130.0, 20.0, 40.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6646663228304077, "mean_inference_ms": 1.502965453922634, "mean_action_processing_ms": 0.42417135663724054, "mean_env_wait_ms": 1.3488040783393922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014127016067504883, "StateBufferConnector_ms": 0.01078653335571289, "ViewRequirementAgentConnector_ms": 0.4504508972167969}, "num_episodes": 18, "episode_return_max": 2115.0, "episode_return_min": 190.0, "episode_return_mean": 1219.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.21158370319135, "num_env_steps_trained_throughput_per_sec": 19.21158370319135, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 5320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5320000, "timers": {"training_iteration_time_ms": 208645.471, "restore_workers_time_ms": 0.014, "training_step_time_ms": 208645.424, "sample_time_ms": 2690.096, "learn_time_ms": 205933.617, "learn_throughput": 19.424, "synch_weights_time_ms": 13.063}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "done": false, "training_iteration": 133, "trial_id": "aa996_00000", "date": "2024-05-24_06-28-17", "timestamp": 1716546497, "time_this_iter_s": 208.21541118621826, "time_total_s": 27763.30964589119, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b3d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27763.30964589119, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 19.317288135593223, "ram_util_percent": 79.03999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.068451597813727, "cur_kl_coeff": 1.9483926152810451, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.40065022743802, "policy_loss": -0.005068531651416827, "vf_loss": 7.403146572539601, "vf_explained_var": 0.0011940233750592152, "kl": 0.0013201546036631922, "entropy": 0.2587609647181087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1253565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "env_runners": {"episode_reward_max": 2115.0, "episode_reward_min": 190.0, "episode_reward_mean": 1178.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -460.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 117.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2110.0, 555.0, 190.0, 1230.0, 1080.0, 570.0, 1670.0, 1300.0, 1700.0, 1310.0, 1300.0, 635.0, 1720.0, 1990.0, 1635.0, 1630.0, 1000.0, 1360.0, 1030.0, 390.0, 905.0, 1485.0, 1380.0, 1280.0, 1255.0, 1580.0, 1130.0, 1080.0, 1610.0, 1050.0, 900.0, 1490.0, 1015.0, 1310.0, 1385.0, 305.0, 1585.0, 1290.0, 1020.0, 745.0, 1260.0, 2115.0, 1525.0, 1530.0, 1320.0, 1410.0, 1545.0, 1265.0, 1400.0, 1240.0, 1290.0, 375.0, 810.0, 1440.0, 805.0, 940.0, 1815.0, 660.0, 1220.0, 1240.0, 1690.0, 660.0, 1530.0, 910.0, 950.0, 885.0, 1280.0, 1980.0, 420.0, 1560.0, 510.0, 1140.0, 1090.0, 1270.0, 1165.0, 990.0, 1310.0, 1285.0, 1175.0, 900.0, 750.0, 1070.0, 1550.0, 1160.0, 1080.0, 1105.0, 1660.0, 650.0, 1060.0, 1145.0, 1370.0, 1390.0, 1030.0, 855.0, 740.0, 1600.0, 1130.0, 580.0, 1300.0, 535.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 50.0, 130.0, 90.0, 170.0, 70.0, 290.0, 120.0, 170.0, 840.0, -330.0, 180.0, 230.0, -290.0, 170.0, 60.0, 70.0, 340.0, 70.0, 55.0, 10.0, 120.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 150.0, 390.0, -20.0, 80.0, 90.0, 90.0, -50.0, 200.0, 60.0, 240.0, 230.0, 70.0, 400.0, 10.0, 20.0, 20.0, 60.0, 190.0, 10.0, 70.0, 70.0, 30.0, 20.0, 20.0, 0.0, 160.0, 100.0, 20.0, 40.0, 110.0, 420.0, 190.0, 260.0, 40.0, 120.0, 80.0, 320.0, 70.0, 110.0, 60.0, 230.0, -20.0, 140.0, 110.0, 220.0, 180.0, 160.0, 190.0, 60.0, 30.0, 110.0, 100.0, 190.0, 180.0, 200.0, 30.0, 10.0, 550.0, 230.0, 100.0, 50.0, 490.0, -40.0, 40.0, 120.0, 150.0, -30.0, 480.0, 40.0, 10.0, 170.0, 30.0, 160.0, 50.0, 100.0, 60.0, 340.0, 150.0, 140.0, 100.0, 230.0, -65.0, 50.0, 220.0, -20.0, 220.0, 420.0, 20.0, 20.0, -460.0, 240.0, 90.0, 410.0, 70.0, 50.0, 230.0, 50.0, 250.0, 260.0, 70.0, 210.0, 100.0, 180.0, 580.0, 80.0, 190.0, 130.0, 330.0, 80.0, 110.0, 230.0, 40.0, 40.0, 290.0, 90.0, 55.0, 410.0, -30.0, 220.0, 290.0, -5.0, -30.0, 50.0, 510.0, 190.0, 70.0, 480.0, 80.0, 35.0, 250.0, 200.0, -30.0, 280.0, 130.0, 110.0, 160.0, 20.0, 70.0, -10.0, 70.0, 90.0, 80.0, 390.0, 190.0, 50.0, 60.0, 270.0, 20.0, 190.0, 20.0, 50.0, 190.0, 20.0, 20.0, 10.0, 40.0, 470.0, 20.0, 200.0, 10.0, 0.0, 40.0, 40.0, 60.0, 20.0, 40.0, 40.0, 0.0, 20.0, 130.0, 10.0, 360.0, 40.0, 25.0, -290.0, 150.0, 180.0, 330.0, 20.0, 80.0, 50.0, 230.0, 20.0, 170.0, 40.0, 40.0, 190.0, 600.0, -25.0, 170.0, 120.0, 30.0, 260.0, 160.0, 250.0, 30.0, 230.0, 130.0, 60.0, 110.0, 40.0, 190.0, 190.0, 180.0, 40.0, 130.0, 70.0, 320.0, 40.0, 80.0, -10.0, 150.0, 20.0, 50.0, 50.0, 10.0, 405.0, 80.0, 370.0, 130.0, 210.0, -110.0, 180.0, 410.0, 70.0, 70.0, 120.0, 460.0, 140.0, 30.0, 130.0, 290.0, 0.0, 20.0, 210.0, 70.0, 210.0, -30.0, 60.0, 170.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 110.0, 60.0, 260.0, 80.0, -20.0, 150.0, 40.0, 310.0, 210.0, 110.0, 70.0, 170.0, 410.0, 160.0, 20.0, 0.0, 310.0, 40.0, 40.0, 10.0, 370.0, 160.0, 80.0, 20.0, 20.0, 20.0, 200.0, 50.0, 20.0, 350.0, 10.0, 30.0, 170.0, 30.0, 30.0, 40.0, 200.0, -70.0, 250.0, 60.0, 90.0, 510.0, 160.0, 220.0, 20.0, 170.0, 55.0, 40.0, 30.0, 90.0, 180.0, 40.0, 80.0, 310.0, 160.0, 30.0, 200.0, 170.0, 80.0, 110.0, 170.0, 280.0, 10.0, 100.0, 70.0, 40.0, 160.0, 455.0, 60.0, 410.0, 70.0, 60.0, 20.0, 40.0, 20.0, 35.0, 0.0, 40.0, 10.0, 30.0, 60.0, 0.0, 40.0, 70.0, 200.0, 170.0, 70.0, 85.0, 150.0, 330.0, 190.0, 130.0, 210.0, 50.0, 210.0, 100.0, 50.0, -20.0, 20.0, 420.0, 90.0, 110.0, 130.0, 180.0, 30.0, 40.0, 130.0, 310.0, -50.0, -100.0, 30.0, 400.0, 70.0, 160.0, 170.0, 20.0, 10.0, 40.0, 110.0, 50.0, 20.0, 310.0, 15.0, 0.0, 50.0, 250.0, 340.0, 20.0, 40.0, 20.0, 90.0, 30.0, 170.0, 250.0, 280.0, 80.0, 590.0, 100.0, 45.0, 240.0, 60.0, -10.0, 600.0, 130.0, 80.0, 120.0, 30.0, 250.0, 65.0, 170.0, 120.0, 60.0, 530.0, 100.0, 110.0, 10.0, 50.0, 300.0, 50.0, 190.0, 60.0, 330.0, 360.0, 70.0, 160.0, 50.0, 30.0, 120.0, 200.0, 120.0, 40.0, 200.0, 380.0, 20.0, 120.0, 330.0, 140.0, 40.0, 100.0, 340.0, 60.0, 80.0, 40.0, 160.0, 55.0, 40.0, 140.0, 180.0, 150.0, 390.0, 70.0, 130.0, 340.0, 50.0, 0.0, 170.0, 90.0, 50.0, 305.0, 190.0, 50.0, 30.0, 230.0, 150.0, 100.0, 100.0, 80.0, 250.0, 20.0, 280.0, 150.0, 430.0, -20.0, 10.0, 20.0, 430.0, 110.0, 80.0, 120.0, 30.0, 130.0, 10.0, 10.0, 300.0, 270.0, 90.0, 30.0, 310.0, 10.0, 30.0, 240.0, 120.0, 40.0, 150.0, 10.0, 0.0, 10.0, 10.0, 40.0, 10.0, 220.0, 10.0, 40.0, 25.0, 110.0, 0.0, 360.0, 110.0, 20.0, 60.0, 90.0, 40.0, 50.0, -30.0, 290.0, 210.0, 110.0, 200.0, 0.0, 20.0, 420.0, 0.0, 120.0, 70.0, 20.0, -30.0, 360.0, -75.0, 10.0, 30.0, 0.0, -50.0, 230.0, 310.0, 10.0, 300.0, 130.0, 10.0, 160.0, 180.0, 90.0, 0.0, 40.0, 20.0, 230.0, 170.0, 640.0, 60.0, 70.0, 190.0, 45.0, 130.0, 220.0, 60.0, 0.0, 20.0, 0.0, 30.0, 90.0, 30.0, 10.0, 260.0, 180.0, 40.0, 640.0, 20.0, 60.0, 110.0, 20.0, 100.0, 40.0, 10.0, 100.0, 120.0, 150.0, 260.0, 150.0, 90.0, 70.0, 140.0, 120.0, 60.0, 100.0, 100.0, 170.0, 30.0, 20.0, 130.0, 180.0, 150.0, 220.0, 270.0, 290.0, 230.0, 40.0, 0.0, 40.0, 50.0, 360.0, 20.0, 30.0, 40.0, 10.0, 70.0, 80.0, 60.0, 140.0, 260.0, 180.0, 110.0, 50.0, 90.0, 70.0, 490.0, 30.0, 0.0, 100.0, 190.0, 60.0, 140.0, 95.0, 240.0, 140.0, -85.0, 110.0, 40.0, 60.0, 290.0, 60.0, 90.0, 40.0, 50.0, 80.0, 130.0, 40.0, 90.0, 60.0, 150.0, -80.0, 30.0, 10.0, 420.0, 155.0, 10.0, 70.0, 10.0, 360.0, 110.0, 70.0, -40.0, 260.0, 40.0, 240.0, 160.0, 160.0, 100.0, 680.0, 50.0, 90.0, 80.0, 40.0, 360.0, 10.0, 410.0, 0.0, 50.0, 80.0, 40.0, 40.0, 160.0, 0.0, 50.0, 0.0, 0.0, 80.0, 160.0, 30.0, 220.0, 540.0, 140.0, 120.0, 140.0, 30.0, 100.0, 70.0, 10.0, 20.0, 0.0, 70.0, 0.0, 40.0, 90.0, 140.0, 70.0, 320.0, 25.0, 80.0, 80.0, 110.0, 30.0, -40.0, 165.0, 220.0, 150.0, 310.0, 250.0, 30.0, 170.0, 180.0, -20.0, 120.0, 10.0, -20.0, 60.0, 120.0, 110.0, 420.0, -50.0, 100.0, 240.0, 40.0, 40.0, 130.0, 120.0, 30.0, 180.0, 130.0, 80.0, 90.0, 80.0, 140.0, 400.0, -5.0, 40.0, 50.0, 20.0, 190.0, 80.0, 160.0, 70.0, 70.0, -60.0, 280.0, 130.0, 430.0, 70.0, 10.0, 20.0, 90.0, 300.0, 130.0, 20.0, 40.0, 200.0, 280.0, 0.0, 520.0, 140.0, 30.0, 65.0, 40.0, 50.0, 90.0, 70.0, 420.0, 180.0, 30.0, -40.0, -10.0, -30.0, 100.0, 270.0, 65.0, 190.0, 90.0, 180.0, 20.0, 40.0, 20.0, 270.0, 80.0, 40.0, 0.0, 160.0, 40.0, 30.0, 90.0, 110.0, 200.0, 10.0, 0.0, 220.0, 40.0, 10.0, 100.0, 90.0, 230.0, 160.0, 130.0, 120.0, 10.0, 150.0, 60.0, 20.0, 25.0, 35.0, 290.0, 190.0, 500.0, 10.0, 80.0, 10.0, 140.0, 270.0, 70.0, 250.0, 220.0, 220.0, 60.0, -100.0, 380.0, 10.0, 30.0, 20.0, 120.0, -20.0, 10.0, 320.0, 170.0, 200.0, 70.0, 50.0, 90.0, 70.0, 90.0, 10.0, 20.0, 80.0, 70.0, 100.0, 95.0, 440.0, 60.0, 140.0, 90.0, 210.0, 140.0, 430.0, 280.0, 70.0, 70.0, 180.0, 200.0, -10.0, 30.0, 80.0, 40.0, 40.0, 10.0, 80.0, 0.0, 290.0, 110.0, -30.0, 180.0, 70.0, 80.0, 60.0, 40.0, -50.0, 240.0, 230.0, 40.0, 170.0, -25.0, -90.0, 10.0, 0.0, 50.0, -20.0, 10.0, -10.0, 570.0, 650.0, 320.0, 70.0, 80.0, -40.0, 220.0, 420.0, 140.0, 40.0, 0.0, 120.0, 100.0, 340.0, 30.0, 20.0, 20.0, 350.0, 160.0, 280.0, 50.0, 40.0, 10.0, 440.0, 20.0, 20.0, 110.0, 250.0, 30.0, 40.0, 80.0, 30.0, 120.0, 300.0, 80.0, 150.0, -15.0, 40.0, 0.0, 0.0, 20.0, 160.0, 10.0, 110.0, 0.0, 30.0, 90.0, 40.0, 90.0, 10.0, 200.0, 160.0, 350.0, 140.0, 300.0, 80.0, 40.0, 30.0, 110.0, 60.0, 100.0, 390.0, 180.0, 160.0, 0.0, 100.0, 150.0, 110.0, 120.0, 100.0, 180.0, 30.0, 20.0, 0.0, 10.0, 0.0, 40.0, 0.0, 150.0, 10.0, 170.0, 180.0, -80.0, 10.0, 60.0, 270.0, 420.0, 100.0, 320.0, 50.0, 50.0, 100.0, 30.0, 70.0, 100.0, 10.0, 10.0, 170.0, 120.0, 10.0, 10.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.664156514912387, "mean_inference_ms": 1.5005494115328255, "mean_action_processing_ms": 0.42419269761255096, "mean_env_wait_ms": 1.3497839584600861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411747932434082, "StateBufferConnector_ms": 0.01053309440612793, "ViewRequirementAgentConnector_ms": 0.44553637504577637}, "num_episodes": 23, "episode_return_max": 2115.0, "episode_return_min": 190.0, "episode_return_mean": 1178.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.23390187248698, "num_env_steps_trained_throughput_per_sec": 19.23390187248698, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 5360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5360000, "timers": {"training_iteration_time_ms": 208745.636, "restore_workers_time_ms": 0.014, "training_step_time_ms": 208745.589, "sample_time_ms": 2653.498, "learn_time_ms": 206069.761, "learn_throughput": 19.411, "synch_weights_time_ms": 13.137}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "done": false, "training_iteration": 134, "trial_id": "aa996_00000", "date": "2024-05-24_06-31-45", "timestamp": 1716546705, "time_this_iter_s": 207.9909360408783, "time_total_s": 27971.300581932068, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160ab44c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27971.300581932068, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 19.622448979591837, "ram_util_percent": 80.05544217687074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.798539418413743, "cur_kl_coeff": 0.9741963076405226, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006365470681438685, "vf_loss": 7.812822032761904, "vf_explained_var": 6.314012697075629e-05, "kl": Infinity, "entropy": 0.26366883433791904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1262955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "env_runners": {"episode_reward_max": 2115.0, "episode_reward_min": 305.0, "episode_reward_mean": 1170.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 730.0}, "policy_reward_mean": {"policy_0": 117.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1030.0, 390.0, 905.0, 1485.0, 1380.0, 1280.0, 1255.0, 1580.0, 1130.0, 1080.0, 1610.0, 1050.0, 900.0, 1490.0, 1015.0, 1310.0, 1385.0, 305.0, 1585.0, 1290.0, 1020.0, 745.0, 1260.0, 2115.0, 1525.0, 1530.0, 1320.0, 1410.0, 1545.0, 1265.0, 1400.0, 1240.0, 1290.0, 375.0, 810.0, 1440.0, 805.0, 940.0, 1815.0, 660.0, 1220.0, 1240.0, 1690.0, 660.0, 1530.0, 910.0, 950.0, 885.0, 1280.0, 1980.0, 420.0, 1560.0, 510.0, 1140.0, 1090.0, 1270.0, 1165.0, 990.0, 1310.0, 1285.0, 1175.0, 900.0, 750.0, 1070.0, 1550.0, 1160.0, 1080.0, 1105.0, 1660.0, 650.0, 1060.0, 1145.0, 1370.0, 1390.0, 1030.0, 855.0, 740.0, 1600.0, 1130.0, 580.0, 1300.0, 535.0, 1320.0, 1410.0, 1080.0, 1265.0, 1085.0, 1880.0, 700.0, 580.0, 890.0, 1510.0, 1680.0, 460.0, 1545.0, 890.0, 1900.0, 1360.0, 1315.0, 1280.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 190.0, 20.0, 20.0, 10.0, 40.0, 470.0, 20.0, 200.0, 10.0, 0.0, 40.0, 40.0, 60.0, 20.0, 40.0, 40.0, 0.0, 20.0, 130.0, 10.0, 360.0, 40.0, 25.0, -290.0, 150.0, 180.0, 330.0, 20.0, 80.0, 50.0, 230.0, 20.0, 170.0, 40.0, 40.0, 190.0, 600.0, -25.0, 170.0, 120.0, 30.0, 260.0, 160.0, 250.0, 30.0, 230.0, 130.0, 60.0, 110.0, 40.0, 190.0, 190.0, 180.0, 40.0, 130.0, 70.0, 320.0, 40.0, 80.0, -10.0, 150.0, 20.0, 50.0, 50.0, 10.0, 405.0, 80.0, 370.0, 130.0, 210.0, -110.0, 180.0, 410.0, 70.0, 70.0, 120.0, 460.0, 140.0, 30.0, 130.0, 290.0, 0.0, 20.0, 210.0, 70.0, 210.0, -30.0, 60.0, 170.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 110.0, 60.0, 260.0, 80.0, -20.0, 150.0, 40.0, 310.0, 210.0, 110.0, 70.0, 170.0, 410.0, 160.0, 20.0, 0.0, 310.0, 40.0, 40.0, 10.0, 370.0, 160.0, 80.0, 20.0, 20.0, 20.0, 200.0, 50.0, 20.0, 350.0, 10.0, 30.0, 170.0, 30.0, 30.0, 40.0, 200.0, -70.0, 250.0, 60.0, 90.0, 510.0, 160.0, 220.0, 20.0, 170.0, 55.0, 40.0, 30.0, 90.0, 180.0, 40.0, 80.0, 310.0, 160.0, 30.0, 200.0, 170.0, 80.0, 110.0, 170.0, 280.0, 10.0, 100.0, 70.0, 40.0, 160.0, 455.0, 60.0, 410.0, 70.0, 60.0, 20.0, 40.0, 20.0, 35.0, 0.0, 40.0, 10.0, 30.0, 60.0, 0.0, 40.0, 70.0, 200.0, 170.0, 70.0, 85.0, 150.0, 330.0, 190.0, 130.0, 210.0, 50.0, 210.0, 100.0, 50.0, -20.0, 20.0, 420.0, 90.0, 110.0, 130.0, 180.0, 30.0, 40.0, 130.0, 310.0, -50.0, -100.0, 30.0, 400.0, 70.0, 160.0, 170.0, 20.0, 10.0, 40.0, 110.0, 50.0, 20.0, 310.0, 15.0, 0.0, 50.0, 250.0, 340.0, 20.0, 40.0, 20.0, 90.0, 30.0, 170.0, 250.0, 280.0, 80.0, 590.0, 100.0, 45.0, 240.0, 60.0, -10.0, 600.0, 130.0, 80.0, 120.0, 30.0, 250.0, 65.0, 170.0, 120.0, 60.0, 530.0, 100.0, 110.0, 10.0, 50.0, 300.0, 50.0, 190.0, 60.0, 330.0, 360.0, 70.0, 160.0, 50.0, 30.0, 120.0, 200.0, 120.0, 40.0, 200.0, 380.0, 20.0, 120.0, 330.0, 140.0, 40.0, 100.0, 340.0, 60.0, 80.0, 40.0, 160.0, 55.0, 40.0, 140.0, 180.0, 150.0, 390.0, 70.0, 130.0, 340.0, 50.0, 0.0, 170.0, 90.0, 50.0, 305.0, 190.0, 50.0, 30.0, 230.0, 150.0, 100.0, 100.0, 80.0, 250.0, 20.0, 280.0, 150.0, 430.0, -20.0, 10.0, 20.0, 430.0, 110.0, 80.0, 120.0, 30.0, 130.0, 10.0, 10.0, 300.0, 270.0, 90.0, 30.0, 310.0, 10.0, 30.0, 240.0, 120.0, 40.0, 150.0, 10.0, 0.0, 10.0, 10.0, 40.0, 10.0, 220.0, 10.0, 40.0, 25.0, 110.0, 0.0, 360.0, 110.0, 20.0, 60.0, 90.0, 40.0, 50.0, -30.0, 290.0, 210.0, 110.0, 200.0, 0.0, 20.0, 420.0, 0.0, 120.0, 70.0, 20.0, -30.0, 360.0, -75.0, 10.0, 30.0, 0.0, -50.0, 230.0, 310.0, 10.0, 300.0, 130.0, 10.0, 160.0, 180.0, 90.0, 0.0, 40.0, 20.0, 230.0, 170.0, 640.0, 60.0, 70.0, 190.0, 45.0, 130.0, 220.0, 60.0, 0.0, 20.0, 0.0, 30.0, 90.0, 30.0, 10.0, 260.0, 180.0, 40.0, 640.0, 20.0, 60.0, 110.0, 20.0, 100.0, 40.0, 10.0, 100.0, 120.0, 150.0, 260.0, 150.0, 90.0, 70.0, 140.0, 120.0, 60.0, 100.0, 100.0, 170.0, 30.0, 20.0, 130.0, 180.0, 150.0, 220.0, 270.0, 290.0, 230.0, 40.0, 0.0, 40.0, 50.0, 360.0, 20.0, 30.0, 40.0, 10.0, 70.0, 80.0, 60.0, 140.0, 260.0, 180.0, 110.0, 50.0, 90.0, 70.0, 490.0, 30.0, 0.0, 100.0, 190.0, 60.0, 140.0, 95.0, 240.0, 140.0, -85.0, 110.0, 40.0, 60.0, 290.0, 60.0, 90.0, 40.0, 50.0, 80.0, 130.0, 40.0, 90.0, 60.0, 150.0, -80.0, 30.0, 10.0, 420.0, 155.0, 10.0, 70.0, 10.0, 360.0, 110.0, 70.0, -40.0, 260.0, 40.0, 240.0, 160.0, 160.0, 100.0, 680.0, 50.0, 90.0, 80.0, 40.0, 360.0, 10.0, 410.0, 0.0, 50.0, 80.0, 40.0, 40.0, 160.0, 0.0, 50.0, 0.0, 0.0, 80.0, 160.0, 30.0, 220.0, 540.0, 140.0, 120.0, 140.0, 30.0, 100.0, 70.0, 10.0, 20.0, 0.0, 70.0, 0.0, 40.0, 90.0, 140.0, 70.0, 320.0, 25.0, 80.0, 80.0, 110.0, 30.0, -40.0, 165.0, 220.0, 150.0, 310.0, 250.0, 30.0, 170.0, 180.0, -20.0, 120.0, 10.0, -20.0, 60.0, 120.0, 110.0, 420.0, -50.0, 100.0, 240.0, 40.0, 40.0, 130.0, 120.0, 30.0, 180.0, 130.0, 80.0, 90.0, 80.0, 140.0, 400.0, -5.0, 40.0, 50.0, 20.0, 190.0, 80.0, 160.0, 70.0, 70.0, -60.0, 280.0, 130.0, 430.0, 70.0, 10.0, 20.0, 90.0, 300.0, 130.0, 20.0, 40.0, 200.0, 280.0, 0.0, 520.0, 140.0, 30.0, 65.0, 40.0, 50.0, 90.0, 70.0, 420.0, 180.0, 30.0, -40.0, -10.0, -30.0, 100.0, 270.0, 65.0, 190.0, 90.0, 180.0, 20.0, 40.0, 20.0, 270.0, 80.0, 40.0, 0.0, 160.0, 40.0, 30.0, 90.0, 110.0, 200.0, 10.0, 0.0, 220.0, 40.0, 10.0, 100.0, 90.0, 230.0, 160.0, 130.0, 120.0, 10.0, 150.0, 60.0, 20.0, 25.0, 35.0, 290.0, 190.0, 500.0, 10.0, 80.0, 10.0, 140.0, 270.0, 70.0, 250.0, 220.0, 220.0, 60.0, -100.0, 380.0, 10.0, 30.0, 20.0, 120.0, -20.0, 10.0, 320.0, 170.0, 200.0, 70.0, 50.0, 90.0, 70.0, 90.0, 10.0, 20.0, 80.0, 70.0, 100.0, 95.0, 440.0, 60.0, 140.0, 90.0, 210.0, 140.0, 430.0, 280.0, 70.0, 70.0, 180.0, 200.0, -10.0, 30.0, 80.0, 40.0, 40.0, 10.0, 80.0, 0.0, 290.0, 110.0, -30.0, 180.0, 70.0, 80.0, 60.0, 40.0, -50.0, 240.0, 230.0, 40.0, 170.0, -25.0, -90.0, 10.0, 0.0, 50.0, -20.0, 10.0, -10.0, 570.0, 650.0, 320.0, 70.0, 80.0, -40.0, 220.0, 420.0, 140.0, 40.0, 0.0, 120.0, 100.0, 340.0, 30.0, 20.0, 20.0, 350.0, 160.0, 280.0, 50.0, 40.0, 10.0, 440.0, 20.0, 20.0, 110.0, 250.0, 30.0, 40.0, 80.0, 30.0, 120.0, 300.0, 80.0, 150.0, -15.0, 40.0, 0.0, 0.0, 20.0, 160.0, 10.0, 110.0, 0.0, 30.0, 90.0, 40.0, 90.0, 10.0, 200.0, 160.0, 350.0, 140.0, 300.0, 80.0, 40.0, 30.0, 110.0, 60.0, 100.0, 390.0, 180.0, 160.0, 0.0, 100.0, 150.0, 110.0, 120.0, 100.0, 180.0, 30.0, 20.0, 0.0, 10.0, 0.0, 40.0, 0.0, 150.0, 10.0, 170.0, 180.0, -80.0, 10.0, 60.0, 270.0, 420.0, 100.0, 320.0, 50.0, 50.0, 100.0, 30.0, 70.0, 100.0, 10.0, 10.0, 170.0, 120.0, 10.0, 10.0, 5.0, 10.0, 120.0, 300.0, 50.0, 290.0, 40.0, 70.0, 60.0, 70.0, 310.0, 130.0, 110.0, 330.0, 90.0, 130.0, 100.0, 0.0, 320.0, 160.0, 40.0, 170.0, 60.0, 30.0, 100.0, 30.0, 100.0, 60.0, 180.0, 0.0, 350.0, 30.0, 280.0, 50.0, 100.0, 330.0, 120.0, 130.0, 130.0, 40.0, 55.0, 0.0, 180.0, 0.0, -5.0, 100.0, 130.0, 190.0, 60.0, 30.0, 400.0, 430.0, 30.0, 310.0, 500.0, 80.0, 90.0, 30.0, 220.0, 110.0, 80.0, 20.0, 110.0, 90.0, 70.0, 50.0, 30.0, 30.0, 160.0, 140.0, 0.0, 60.0, 60.0, 0.0, 10.0, 140.0, 0.0, 160.0, 40.0, 90.0, 20.0, 70.0, 20.0, 180.0, 50.0, 400.0, 0.0, 50.0, -290.0, 180.0, 230.0, 90.0, 220.0, 10.0, 60.0, 450.0, 80.0, 120.0, 170.0, 70.0, 240.0, 250.0, 120.0, 60.0, 50.0, 30.0, 170.0, 180.0, 80.0, 730.0, 10.0, 100.0, 50.0, 40.0, 20.0, 0.0, 20.0, 50.0, 50.0, 0.0, 130.0, 670.0, 80.0, 190.0, 160.0, 30.0, -5.0, 10.0, 310.0, 30.0, 70.0, 40.0, 60.0, 290.0, 250.0, 10.0, 0.0, 20.0, 80.0, 60.0, 80.0, 110.0, 160.0, 30.0, 560.0, 120.0, -10.0, 250.0, 350.0, 50.0, 280.0, 60.0, -40.0, 0.0, 190.0, 720.0, 180.0, -60.0, 80.0, 100.0, 130.0, 140.0, 470.0, -25.0, 100.0, 70.0, -40.0, 40.0, 240.0, 400.0, -80.0, 140.0, 70.0, 110.0, 90.0, 550.0, 70.0, 0.0, 130.0, 30.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6631176520781157, "mean_inference_ms": 1.502884968801711, "mean_action_processing_ms": 0.4241020998225241, "mean_env_wait_ms": 1.3487986348163312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013578414916992188, "StateBufferConnector_ms": 0.010111570358276367, "ViewRequirementAgentConnector_ms": 0.4402487277984619}, "num_episodes": 18, "episode_return_max": 2115.0, "episode_return_min": 305.0, "episode_return_mean": 1170.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.193955782731333, "num_env_steps_trained_throughput_per_sec": 19.193955782731333, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 5400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5400000, "timers": {"training_iteration_time_ms": 208704.623, "restore_workers_time_ms": 0.014, "training_step_time_ms": 208704.576, "sample_time_ms": 2681.288, "learn_time_ms": 206001.119, "learn_throughput": 19.417, "synch_weights_time_ms": 13.084}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "done": false, "training_iteration": 135, "trial_id": "aa996_00000", "date": "2024-05-24_06-35-14", "timestamp": 1716546914, "time_this_iter_s": 208.40721487998962, "time_total_s": 28179.707796812057, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b3d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28179.707796812057, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 19.083728813559325, "ram_util_percent": 78.69627118644068}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7346479131200443, "cur_kl_coeff": 1.4612944614607846, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.928257088006114, "policy_loss": -0.005976165827915184, "vf_loss": 7.931643035084295, "vf_explained_var": 0.0002723699877945125, "kl": 0.0017725536472241758, "entropy": 0.2572082463227395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1272345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "env_runners": {"episode_reward_max": 2115.0, "episode_reward_min": 375.0, "episode_reward_mean": 1180.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 730.0}, "policy_reward_mean": {"policy_0": 118.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1260.0, 2115.0, 1525.0, 1530.0, 1320.0, 1410.0, 1545.0, 1265.0, 1400.0, 1240.0, 1290.0, 375.0, 810.0, 1440.0, 805.0, 940.0, 1815.0, 660.0, 1220.0, 1240.0, 1690.0, 660.0, 1530.0, 910.0, 950.0, 885.0, 1280.0, 1980.0, 420.0, 1560.0, 510.0, 1140.0, 1090.0, 1270.0, 1165.0, 990.0, 1310.0, 1285.0, 1175.0, 900.0, 750.0, 1070.0, 1550.0, 1160.0, 1080.0, 1105.0, 1660.0, 650.0, 1060.0, 1145.0, 1370.0, 1390.0, 1030.0, 855.0, 740.0, 1600.0, 1130.0, 580.0, 1300.0, 535.0, 1320.0, 1410.0, 1080.0, 1265.0, 1085.0, 1880.0, 700.0, 580.0, 890.0, 1510.0, 1680.0, 460.0, 1545.0, 890.0, 1900.0, 1360.0, 1315.0, 1280.0, 1165.0, 1280.0, 1970.0, 500.0, 1290.0, 970.0, 1425.0, 1340.0, 1550.0, 890.0, 1285.0, 1300.0, 1095.0, 830.0, 1000.0, 900.0, 800.0, 1420.0, 1510.0, 1625.0, 665.0, 1440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 250.0, 340.0, 20.0, 40.0, 20.0, 90.0, 30.0, 170.0, 250.0, 280.0, 80.0, 590.0, 100.0, 45.0, 240.0, 60.0, -10.0, 600.0, 130.0, 80.0, 120.0, 30.0, 250.0, 65.0, 170.0, 120.0, 60.0, 530.0, 100.0, 110.0, 10.0, 50.0, 300.0, 50.0, 190.0, 60.0, 330.0, 360.0, 70.0, 160.0, 50.0, 30.0, 120.0, 200.0, 120.0, 40.0, 200.0, 380.0, 20.0, 120.0, 330.0, 140.0, 40.0, 100.0, 340.0, 60.0, 80.0, 40.0, 160.0, 55.0, 40.0, 140.0, 180.0, 150.0, 390.0, 70.0, 130.0, 340.0, 50.0, 0.0, 170.0, 90.0, 50.0, 305.0, 190.0, 50.0, 30.0, 230.0, 150.0, 100.0, 100.0, 80.0, 250.0, 20.0, 280.0, 150.0, 430.0, -20.0, 10.0, 20.0, 430.0, 110.0, 80.0, 120.0, 30.0, 130.0, 10.0, 10.0, 300.0, 270.0, 90.0, 30.0, 310.0, 10.0, 30.0, 240.0, 120.0, 40.0, 150.0, 10.0, 0.0, 10.0, 10.0, 40.0, 10.0, 220.0, 10.0, 40.0, 25.0, 110.0, 0.0, 360.0, 110.0, 20.0, 60.0, 90.0, 40.0, 50.0, -30.0, 290.0, 210.0, 110.0, 200.0, 0.0, 20.0, 420.0, 0.0, 120.0, 70.0, 20.0, -30.0, 360.0, -75.0, 10.0, 30.0, 0.0, -50.0, 230.0, 310.0, 10.0, 300.0, 130.0, 10.0, 160.0, 180.0, 90.0, 0.0, 40.0, 20.0, 230.0, 170.0, 640.0, 60.0, 70.0, 190.0, 45.0, 130.0, 220.0, 60.0, 0.0, 20.0, 0.0, 30.0, 90.0, 30.0, 10.0, 260.0, 180.0, 40.0, 640.0, 20.0, 60.0, 110.0, 20.0, 100.0, 40.0, 10.0, 100.0, 120.0, 150.0, 260.0, 150.0, 90.0, 70.0, 140.0, 120.0, 60.0, 100.0, 100.0, 170.0, 30.0, 20.0, 130.0, 180.0, 150.0, 220.0, 270.0, 290.0, 230.0, 40.0, 0.0, 40.0, 50.0, 360.0, 20.0, 30.0, 40.0, 10.0, 70.0, 80.0, 60.0, 140.0, 260.0, 180.0, 110.0, 50.0, 90.0, 70.0, 490.0, 30.0, 0.0, 100.0, 190.0, 60.0, 140.0, 95.0, 240.0, 140.0, -85.0, 110.0, 40.0, 60.0, 290.0, 60.0, 90.0, 40.0, 50.0, 80.0, 130.0, 40.0, 90.0, 60.0, 150.0, -80.0, 30.0, 10.0, 420.0, 155.0, 10.0, 70.0, 10.0, 360.0, 110.0, 70.0, -40.0, 260.0, 40.0, 240.0, 160.0, 160.0, 100.0, 680.0, 50.0, 90.0, 80.0, 40.0, 360.0, 10.0, 410.0, 0.0, 50.0, 80.0, 40.0, 40.0, 160.0, 0.0, 50.0, 0.0, 0.0, 80.0, 160.0, 30.0, 220.0, 540.0, 140.0, 120.0, 140.0, 30.0, 100.0, 70.0, 10.0, 20.0, 0.0, 70.0, 0.0, 40.0, 90.0, 140.0, 70.0, 320.0, 25.0, 80.0, 80.0, 110.0, 30.0, -40.0, 165.0, 220.0, 150.0, 310.0, 250.0, 30.0, 170.0, 180.0, -20.0, 120.0, 10.0, -20.0, 60.0, 120.0, 110.0, 420.0, -50.0, 100.0, 240.0, 40.0, 40.0, 130.0, 120.0, 30.0, 180.0, 130.0, 80.0, 90.0, 80.0, 140.0, 400.0, -5.0, 40.0, 50.0, 20.0, 190.0, 80.0, 160.0, 70.0, 70.0, -60.0, 280.0, 130.0, 430.0, 70.0, 10.0, 20.0, 90.0, 300.0, 130.0, 20.0, 40.0, 200.0, 280.0, 0.0, 520.0, 140.0, 30.0, 65.0, 40.0, 50.0, 90.0, 70.0, 420.0, 180.0, 30.0, -40.0, -10.0, -30.0, 100.0, 270.0, 65.0, 190.0, 90.0, 180.0, 20.0, 40.0, 20.0, 270.0, 80.0, 40.0, 0.0, 160.0, 40.0, 30.0, 90.0, 110.0, 200.0, 10.0, 0.0, 220.0, 40.0, 10.0, 100.0, 90.0, 230.0, 160.0, 130.0, 120.0, 10.0, 150.0, 60.0, 20.0, 25.0, 35.0, 290.0, 190.0, 500.0, 10.0, 80.0, 10.0, 140.0, 270.0, 70.0, 250.0, 220.0, 220.0, 60.0, -100.0, 380.0, 10.0, 30.0, 20.0, 120.0, -20.0, 10.0, 320.0, 170.0, 200.0, 70.0, 50.0, 90.0, 70.0, 90.0, 10.0, 20.0, 80.0, 70.0, 100.0, 95.0, 440.0, 60.0, 140.0, 90.0, 210.0, 140.0, 430.0, 280.0, 70.0, 70.0, 180.0, 200.0, -10.0, 30.0, 80.0, 40.0, 40.0, 10.0, 80.0, 0.0, 290.0, 110.0, -30.0, 180.0, 70.0, 80.0, 60.0, 40.0, -50.0, 240.0, 230.0, 40.0, 170.0, -25.0, -90.0, 10.0, 0.0, 50.0, -20.0, 10.0, -10.0, 570.0, 650.0, 320.0, 70.0, 80.0, -40.0, 220.0, 420.0, 140.0, 40.0, 0.0, 120.0, 100.0, 340.0, 30.0, 20.0, 20.0, 350.0, 160.0, 280.0, 50.0, 40.0, 10.0, 440.0, 20.0, 20.0, 110.0, 250.0, 30.0, 40.0, 80.0, 30.0, 120.0, 300.0, 80.0, 150.0, -15.0, 40.0, 0.0, 0.0, 20.0, 160.0, 10.0, 110.0, 0.0, 30.0, 90.0, 40.0, 90.0, 10.0, 200.0, 160.0, 350.0, 140.0, 300.0, 80.0, 40.0, 30.0, 110.0, 60.0, 100.0, 390.0, 180.0, 160.0, 0.0, 100.0, 150.0, 110.0, 120.0, 100.0, 180.0, 30.0, 20.0, 0.0, 10.0, 0.0, 40.0, 0.0, 150.0, 10.0, 170.0, 180.0, -80.0, 10.0, 60.0, 270.0, 420.0, 100.0, 320.0, 50.0, 50.0, 100.0, 30.0, 70.0, 100.0, 10.0, 10.0, 170.0, 120.0, 10.0, 10.0, 5.0, 10.0, 120.0, 300.0, 50.0, 290.0, 40.0, 70.0, 60.0, 70.0, 310.0, 130.0, 110.0, 330.0, 90.0, 130.0, 100.0, 0.0, 320.0, 160.0, 40.0, 170.0, 60.0, 30.0, 100.0, 30.0, 100.0, 60.0, 180.0, 0.0, 350.0, 30.0, 280.0, 50.0, 100.0, 330.0, 120.0, 130.0, 130.0, 40.0, 55.0, 0.0, 180.0, 0.0, -5.0, 100.0, 130.0, 190.0, 60.0, 30.0, 400.0, 430.0, 30.0, 310.0, 500.0, 80.0, 90.0, 30.0, 220.0, 110.0, 80.0, 20.0, 110.0, 90.0, 70.0, 50.0, 30.0, 30.0, 160.0, 140.0, 0.0, 60.0, 60.0, 0.0, 10.0, 140.0, 0.0, 160.0, 40.0, 90.0, 20.0, 70.0, 20.0, 180.0, 50.0, 400.0, 0.0, 50.0, -290.0, 180.0, 230.0, 90.0, 220.0, 10.0, 60.0, 450.0, 80.0, 120.0, 170.0, 70.0, 240.0, 250.0, 120.0, 60.0, 50.0, 30.0, 170.0, 180.0, 80.0, 730.0, 10.0, 100.0, 50.0, 40.0, 20.0, 0.0, 20.0, 50.0, 50.0, 0.0, 130.0, 670.0, 80.0, 190.0, 160.0, 30.0, -5.0, 10.0, 310.0, 30.0, 70.0, 40.0, 60.0, 290.0, 250.0, 10.0, 0.0, 20.0, 80.0, 60.0, 80.0, 110.0, 160.0, 30.0, 560.0, 120.0, -10.0, 250.0, 350.0, 50.0, 280.0, 60.0, -40.0, 0.0, 190.0, 720.0, 180.0, -60.0, 80.0, 100.0, 130.0, 140.0, 470.0, -25.0, 100.0, 70.0, -40.0, 40.0, 240.0, 400.0, -80.0, 140.0, 70.0, 110.0, 90.0, 550.0, 70.0, 0.0, 130.0, 30.0, 90.0, 210.0, 0.0, 60.0, 15.0, 370.0, 310.0, 40.0, 10.0, 140.0, 10.0, 210.0, 70.0, 100.0, 70.0, 70.0, -50.0, 190.0, 150.0, 380.0, 90.0, 200.0, 110.0, 130.0, 70.0, 300.0, 60.0, 400.0, 10.0, 100.0, 590.0, 80.0, 40.0, 10.0, 0.0, 0.0, 280.0, 40.0, 30.0, 20.0, 0.0, 60.0, 10.0, 50.0, 20.0, 710.0, 50.0, 40.0, 50.0, 250.0, 50.0, 50.0, 70.0, 200.0, 10.0, 130.0, 160.0, 120.0, 50.0, 110.0, 70.0, 280.0, 540.0, 250.0, 15.0, 50.0, 20.0, 20.0, 50.0, 160.0, 40.0, 130.0, 210.0, 90.0, 80.0, 120.0, 20.0, 140.0, 220.0, 30.0, 300.0, 100.0, 140.0, 40.0, 50.0, 30.0, 310.0, 50.0, 430.0, 60.0, 340.0, 30.0, 50.0, 60.0, 170.0, 0.0, 10.0, 120.0, 30.0, 420.0, 0.0, 100.0, 20.0, 55.0, 20.0, 190.0, 250.0, 40.0, -10.0, 240.0, 380.0, -10.0, 350.0, 130.0, 70.0, 160.0, 190.0, 40.0, 40.0, 270.0, 60.0, 10.0, 0.0, 120.0, 100.0, -25.0, 50.0, 380.0, 0.0, 160.0, 300.0, 90.0, 30.0, 90.0, 60.0, 130.0, 90.0, 160.0, 40.0, 170.0, -30.0, 100.0, 70.0, 220.0, 230.0, 20.0, 90.0, 70.0, 90.0, 40.0, 70.0, 40.0, 20.0, 20.0, 210.0, 30.0, 80.0, 280.0, 140.0, 0.0, 80.0, 20.0, 80.0, 80.0, 160.0, 90.0, 10.0, 220.0, 30.0, 40.0, 70.0, 150.0, 10.0, 80.0, 50.0, 100.0, 220.0, 350.0, 30.0, 350.0, 80.0, 160.0, 450.0, 140.0, 230.0, 50.0, 90.0, -10.0, 160.0, 100.0, 140.0, 100.0, 240.0, 260.0, 160.0, 390.0, -10.0, 155.0, 80.0, 285.0, -35.0, 0.0, -30.0, 180.0, 170.0, 190.0, -30.0, 10.0, 110.0, -25.0, 90.0, 400.0, 30.0, 250.0, 0.0, 140.0, 50.0, 110.0, 270.0, 40.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6621203471028145, "mean_inference_ms": 1.5027666152623425, "mean_action_processing_ms": 0.4240224455427731, "mean_env_wait_ms": 1.3487299488399094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012683868408203125, "StateBufferConnector_ms": 0.009954214096069336, "ViewRequirementAgentConnector_ms": 0.4063234329223633}, "num_episodes": 22, "episode_return_max": 2115.0, "episode_return_min": 375.0, "episode_return_mean": 1180.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.011297957180577, "num_env_steps_trained_throughput_per_sec": 19.011297957180577, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 5440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5440000, "timers": {"training_iteration_time_ms": 208930.676, "restore_workers_time_ms": 0.014, "training_step_time_ms": 208930.63, "sample_time_ms": 2701.788, "learn_time_ms": 206205.584, "learn_throughput": 19.398, "synch_weights_time_ms": 12.99}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "done": false, "training_iteration": 136, "trial_id": "aa996_00000", "date": "2024-05-24_06-38-44", "timestamp": 1716547124, "time_this_iter_s": 210.4248502254486, "time_total_s": 28390.132647037506, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332dc3c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28390.132647037506, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 23.06161616161616, "ram_util_percent": 79.8037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4470260777349035, "cur_kl_coeff": 0.7306472307303923, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006547409606947741, "vf_loss": 7.391591944455847, "vf_explained_var": 9.91512030458298e-05, "kl": Infinity, "entropy": 0.2505556147763777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1281735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 420.0, "episode_reward_mean": 1172.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 117.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.0, 1240.0, 1690.0, 660.0, 1530.0, 910.0, 950.0, 885.0, 1280.0, 1980.0, 420.0, 1560.0, 510.0, 1140.0, 1090.0, 1270.0, 1165.0, 990.0, 1310.0, 1285.0, 1175.0, 900.0, 750.0, 1070.0, 1550.0, 1160.0, 1080.0, 1105.0, 1660.0, 650.0, 1060.0, 1145.0, 1370.0, 1390.0, 1030.0, 855.0, 740.0, 1600.0, 1130.0, 580.0, 1300.0, 535.0, 1320.0, 1410.0, 1080.0, 1265.0, 1085.0, 1880.0, 700.0, 580.0, 890.0, 1510.0, 1680.0, 460.0, 1545.0, 890.0, 1900.0, 1360.0, 1315.0, 1280.0, 1165.0, 1280.0, 1970.0, 500.0, 1290.0, 970.0, 1425.0, 1340.0, 1550.0, 890.0, 1285.0, 1300.0, 1095.0, 830.0, 1000.0, 900.0, 800.0, 1420.0, 1510.0, 1625.0, 665.0, 1440.0, 1290.0, 670.0, 1280.0, 1380.0, 1570.0, 1160.0, 760.0, 1290.0, 1110.0, 1190.0, 1115.0, 1680.0, 1950.0, 540.0, 1125.0, 1335.0, 1230.0, 1290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [640.0, 20.0, 60.0, 110.0, 20.0, 100.0, 40.0, 10.0, 100.0, 120.0, 150.0, 260.0, 150.0, 90.0, 70.0, 140.0, 120.0, 60.0, 100.0, 100.0, 170.0, 30.0, 20.0, 130.0, 180.0, 150.0, 220.0, 270.0, 290.0, 230.0, 40.0, 0.0, 40.0, 50.0, 360.0, 20.0, 30.0, 40.0, 10.0, 70.0, 80.0, 60.0, 140.0, 260.0, 180.0, 110.0, 50.0, 90.0, 70.0, 490.0, 30.0, 0.0, 100.0, 190.0, 60.0, 140.0, 95.0, 240.0, 140.0, -85.0, 110.0, 40.0, 60.0, 290.0, 60.0, 90.0, 40.0, 50.0, 80.0, 130.0, 40.0, 90.0, 60.0, 150.0, -80.0, 30.0, 10.0, 420.0, 155.0, 10.0, 70.0, 10.0, 360.0, 110.0, 70.0, -40.0, 260.0, 40.0, 240.0, 160.0, 160.0, 100.0, 680.0, 50.0, 90.0, 80.0, 40.0, 360.0, 10.0, 410.0, 0.0, 50.0, 80.0, 40.0, 40.0, 160.0, 0.0, 50.0, 0.0, 0.0, 80.0, 160.0, 30.0, 220.0, 540.0, 140.0, 120.0, 140.0, 30.0, 100.0, 70.0, 10.0, 20.0, 0.0, 70.0, 0.0, 40.0, 90.0, 140.0, 70.0, 320.0, 25.0, 80.0, 80.0, 110.0, 30.0, -40.0, 165.0, 220.0, 150.0, 310.0, 250.0, 30.0, 170.0, 180.0, -20.0, 120.0, 10.0, -20.0, 60.0, 120.0, 110.0, 420.0, -50.0, 100.0, 240.0, 40.0, 40.0, 130.0, 120.0, 30.0, 180.0, 130.0, 80.0, 90.0, 80.0, 140.0, 400.0, -5.0, 40.0, 50.0, 20.0, 190.0, 80.0, 160.0, 70.0, 70.0, -60.0, 280.0, 130.0, 430.0, 70.0, 10.0, 20.0, 90.0, 300.0, 130.0, 20.0, 40.0, 200.0, 280.0, 0.0, 520.0, 140.0, 30.0, 65.0, 40.0, 50.0, 90.0, 70.0, 420.0, 180.0, 30.0, -40.0, -10.0, -30.0, 100.0, 270.0, 65.0, 190.0, 90.0, 180.0, 20.0, 40.0, 20.0, 270.0, 80.0, 40.0, 0.0, 160.0, 40.0, 30.0, 90.0, 110.0, 200.0, 10.0, 0.0, 220.0, 40.0, 10.0, 100.0, 90.0, 230.0, 160.0, 130.0, 120.0, 10.0, 150.0, 60.0, 20.0, 25.0, 35.0, 290.0, 190.0, 500.0, 10.0, 80.0, 10.0, 140.0, 270.0, 70.0, 250.0, 220.0, 220.0, 60.0, -100.0, 380.0, 10.0, 30.0, 20.0, 120.0, -20.0, 10.0, 320.0, 170.0, 200.0, 70.0, 50.0, 90.0, 70.0, 90.0, 10.0, 20.0, 80.0, 70.0, 100.0, 95.0, 440.0, 60.0, 140.0, 90.0, 210.0, 140.0, 430.0, 280.0, 70.0, 70.0, 180.0, 200.0, -10.0, 30.0, 80.0, 40.0, 40.0, 10.0, 80.0, 0.0, 290.0, 110.0, -30.0, 180.0, 70.0, 80.0, 60.0, 40.0, -50.0, 240.0, 230.0, 40.0, 170.0, -25.0, -90.0, 10.0, 0.0, 50.0, -20.0, 10.0, -10.0, 570.0, 650.0, 320.0, 70.0, 80.0, -40.0, 220.0, 420.0, 140.0, 40.0, 0.0, 120.0, 100.0, 340.0, 30.0, 20.0, 20.0, 350.0, 160.0, 280.0, 50.0, 40.0, 10.0, 440.0, 20.0, 20.0, 110.0, 250.0, 30.0, 40.0, 80.0, 30.0, 120.0, 300.0, 80.0, 150.0, -15.0, 40.0, 0.0, 0.0, 20.0, 160.0, 10.0, 110.0, 0.0, 30.0, 90.0, 40.0, 90.0, 10.0, 200.0, 160.0, 350.0, 140.0, 300.0, 80.0, 40.0, 30.0, 110.0, 60.0, 100.0, 390.0, 180.0, 160.0, 0.0, 100.0, 150.0, 110.0, 120.0, 100.0, 180.0, 30.0, 20.0, 0.0, 10.0, 0.0, 40.0, 0.0, 150.0, 10.0, 170.0, 180.0, -80.0, 10.0, 60.0, 270.0, 420.0, 100.0, 320.0, 50.0, 50.0, 100.0, 30.0, 70.0, 100.0, 10.0, 10.0, 170.0, 120.0, 10.0, 10.0, 5.0, 10.0, 120.0, 300.0, 50.0, 290.0, 40.0, 70.0, 60.0, 70.0, 310.0, 130.0, 110.0, 330.0, 90.0, 130.0, 100.0, 0.0, 320.0, 160.0, 40.0, 170.0, 60.0, 30.0, 100.0, 30.0, 100.0, 60.0, 180.0, 0.0, 350.0, 30.0, 280.0, 50.0, 100.0, 330.0, 120.0, 130.0, 130.0, 40.0, 55.0, 0.0, 180.0, 0.0, -5.0, 100.0, 130.0, 190.0, 60.0, 30.0, 400.0, 430.0, 30.0, 310.0, 500.0, 80.0, 90.0, 30.0, 220.0, 110.0, 80.0, 20.0, 110.0, 90.0, 70.0, 50.0, 30.0, 30.0, 160.0, 140.0, 0.0, 60.0, 60.0, 0.0, 10.0, 140.0, 0.0, 160.0, 40.0, 90.0, 20.0, 70.0, 20.0, 180.0, 50.0, 400.0, 0.0, 50.0, -290.0, 180.0, 230.0, 90.0, 220.0, 10.0, 60.0, 450.0, 80.0, 120.0, 170.0, 70.0, 240.0, 250.0, 120.0, 60.0, 50.0, 30.0, 170.0, 180.0, 80.0, 730.0, 10.0, 100.0, 50.0, 40.0, 20.0, 0.0, 20.0, 50.0, 50.0, 0.0, 130.0, 670.0, 80.0, 190.0, 160.0, 30.0, -5.0, 10.0, 310.0, 30.0, 70.0, 40.0, 60.0, 290.0, 250.0, 10.0, 0.0, 20.0, 80.0, 60.0, 80.0, 110.0, 160.0, 30.0, 560.0, 120.0, -10.0, 250.0, 350.0, 50.0, 280.0, 60.0, -40.0, 0.0, 190.0, 720.0, 180.0, -60.0, 80.0, 100.0, 130.0, 140.0, 470.0, -25.0, 100.0, 70.0, -40.0, 40.0, 240.0, 400.0, -80.0, 140.0, 70.0, 110.0, 90.0, 550.0, 70.0, 0.0, 130.0, 30.0, 90.0, 210.0, 0.0, 60.0, 15.0, 370.0, 310.0, 40.0, 10.0, 140.0, 10.0, 210.0, 70.0, 100.0, 70.0, 70.0, -50.0, 190.0, 150.0, 380.0, 90.0, 200.0, 110.0, 130.0, 70.0, 300.0, 60.0, 400.0, 10.0, 100.0, 590.0, 80.0, 40.0, 10.0, 0.0, 0.0, 280.0, 40.0, 30.0, 20.0, 0.0, 60.0, 10.0, 50.0, 20.0, 710.0, 50.0, 40.0, 50.0, 250.0, 50.0, 50.0, 70.0, 200.0, 10.0, 130.0, 160.0, 120.0, 50.0, 110.0, 70.0, 280.0, 540.0, 250.0, 15.0, 50.0, 20.0, 20.0, 50.0, 160.0, 40.0, 130.0, 210.0, 90.0, 80.0, 120.0, 20.0, 140.0, 220.0, 30.0, 300.0, 100.0, 140.0, 40.0, 50.0, 30.0, 310.0, 50.0, 430.0, 60.0, 340.0, 30.0, 50.0, 60.0, 170.0, 0.0, 10.0, 120.0, 30.0, 420.0, 0.0, 100.0, 20.0, 55.0, 20.0, 190.0, 250.0, 40.0, -10.0, 240.0, 380.0, -10.0, 350.0, 130.0, 70.0, 160.0, 190.0, 40.0, 40.0, 270.0, 60.0, 10.0, 0.0, 120.0, 100.0, -25.0, 50.0, 380.0, 0.0, 160.0, 300.0, 90.0, 30.0, 90.0, 60.0, 130.0, 90.0, 160.0, 40.0, 170.0, -30.0, 100.0, 70.0, 220.0, 230.0, 20.0, 90.0, 70.0, 90.0, 40.0, 70.0, 40.0, 20.0, 20.0, 210.0, 30.0, 80.0, 280.0, 140.0, 0.0, 80.0, 20.0, 80.0, 80.0, 160.0, 90.0, 10.0, 220.0, 30.0, 40.0, 70.0, 150.0, 10.0, 80.0, 50.0, 100.0, 220.0, 350.0, 30.0, 350.0, 80.0, 160.0, 450.0, 140.0, 230.0, 50.0, 90.0, -10.0, 160.0, 100.0, 140.0, 100.0, 240.0, 260.0, 160.0, 390.0, -10.0, 155.0, 80.0, 285.0, -35.0, 0.0, -30.0, 180.0, 170.0, 190.0, -30.0, 10.0, 110.0, -25.0, 90.0, 400.0, 30.0, 250.0, 0.0, 140.0, 50.0, 110.0, 270.0, 40.0, 150.0, 120.0, 30.0, 40.0, 390.0, 120.0, 120.0, 130.0, 60.0, 100.0, 180.0, 80.0, 30.0, 50.0, 190.0, 10.0, 70.0, 20.0, 10.0, 170.0, 40.0, 30.0, -230.0, 290.0, 70.0, 100.0, 70.0, 370.0, 190.0, 360.0, 30.0, -40.0, 280.0, 160.0, 330.0, 50.0, 50.0, 70.0, 210.0, 210.0, 60.0, 60.0, 70.0, 170.0, 300.0, 190.0, 30.0, 110.0, 340.0, 260.0, 40.0, 100.0, -95.0, 10.0, 60.0, 180.0, 170.0, 60.0, 690.0, -175.0, 160.0, -50.0, 110.0, 30.0, 10.0, 10.0, 350.0, 30.0, -30.0, 300.0, 0.0, 310.0, 60.0, 270.0, 10.0, 30.0, 70.0, 420.0, 30.0, 10.0, 80.0, 50.0, 10.0, 390.0, 120.0, 370.0, 10.0, 80.0, 40.0, 40.0, 0.0, 170.0, 40.0, 110.0, 30.0, 130.0, 230.0, 120.0, 80.0, 140.0, 140.0, 110.0, -20.0, 120.0, 200.0, 50.0, 460.0, 45.0, 50.0, 0.0, 100.0, 750.0, 20.0, 15.0, 130.0, 0.0, 110.0, 140.0, 170.0, 0.0, 345.0, 210.0, 550.0, 130.0, 420.0, 110.0, 90.0, 80.0, 10.0, 240.0, 110.0, 10.0, 40.0, 10.0, 20.0, 180.0, 80.0, 120.0, 30.0, 40.0, 10.0, 80.0, 30.0, 60.0, 120.0, 10.0, 290.0, 15.0, 10.0, 370.0, 140.0, 60.0, 80.0, 190.0, 50.0, 30.0, 40.0, 200.0, 165.0, 30.0, 490.0, 560.0, 20.0, 110.0, 30.0, 120.0, 50.0, 210.0, 50.0, 70.0, 10.0, 60.0, 90.0, 40.0, 20.0, 100.0, 530.0, 110.0, 210.0, 20.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6615813180065147, "mean_inference_ms": 1.5029271580116563, "mean_action_processing_ms": 0.4240327324496204, "mean_env_wait_ms": 1.3488826142450945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013179540634155273, "StateBufferConnector_ms": 0.010300397872924805, "ViewRequirementAgentConnector_ms": 0.4205954074859619}, "num_episodes": 18, "episode_return_max": 1980.0, "episode_return_min": 420.0, "episode_return_mean": 1172.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.153368469887827, "num_env_steps_trained_throughput_per_sec": 19.153368469887827, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 5480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5480000, "timers": {"training_iteration_time_ms": 208734.959, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208734.912, "sample_time_ms": 2749.121, "learn_time_ms": 205962.346, "learn_throughput": 19.421, "synch_weights_time_ms": 13.065}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "done": false, "training_iteration": 137, "trial_id": "aa996_00000", "date": "2024-05-24_06-42-13", "timestamp": 1716547333, "time_this_iter_s": 208.84880685806274, "time_total_s": 28598.98145389557, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d89670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28598.98145389557, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 27.29493243243243, "ram_util_percent": 79.8233108108108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3287540458833065, "cur_kl_coeff": 1.095970846095588, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006184323024722778, "vf_loss": 6.990823482070614, "vf_explained_var": 0.0007098300388445869, "kl": Infinity, "entropy": 0.251054117926203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1291125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "env_runners": {"episode_reward_max": 1970.0, "episode_reward_min": 140.0, "episode_reward_mean": 1165.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 116.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1310.0, 1285.0, 1175.0, 900.0, 750.0, 1070.0, 1550.0, 1160.0, 1080.0, 1105.0, 1660.0, 650.0, 1060.0, 1145.0, 1370.0, 1390.0, 1030.0, 855.0, 740.0, 1600.0, 1130.0, 580.0, 1300.0, 535.0, 1320.0, 1410.0, 1080.0, 1265.0, 1085.0, 1880.0, 700.0, 580.0, 890.0, 1510.0, 1680.0, 460.0, 1545.0, 890.0, 1900.0, 1360.0, 1315.0, 1280.0, 1165.0, 1280.0, 1970.0, 500.0, 1290.0, 970.0, 1425.0, 1340.0, 1550.0, 890.0, 1285.0, 1300.0, 1095.0, 830.0, 1000.0, 900.0, 800.0, 1420.0, 1510.0, 1625.0, 665.0, 1440.0, 1290.0, 670.0, 1280.0, 1380.0, 1570.0, 1160.0, 760.0, 1290.0, 1110.0, 1190.0, 1115.0, 1680.0, 1950.0, 540.0, 1125.0, 1335.0, 1230.0, 1290.0, 1180.0, 930.0, 850.0, 1320.0, 1160.0, 625.0, 1440.0, 1705.0, 1300.0, 1510.0, 1030.0, 140.0, 760.0, 1495.0, 1290.0, 1570.0, 670.0, 820.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [430.0, 70.0, 10.0, 20.0, 90.0, 300.0, 130.0, 20.0, 40.0, 200.0, 280.0, 0.0, 520.0, 140.0, 30.0, 65.0, 40.0, 50.0, 90.0, 70.0, 420.0, 180.0, 30.0, -40.0, -10.0, -30.0, 100.0, 270.0, 65.0, 190.0, 90.0, 180.0, 20.0, 40.0, 20.0, 270.0, 80.0, 40.0, 0.0, 160.0, 40.0, 30.0, 90.0, 110.0, 200.0, 10.0, 0.0, 220.0, 40.0, 10.0, 100.0, 90.0, 230.0, 160.0, 130.0, 120.0, 10.0, 150.0, 60.0, 20.0, 25.0, 35.0, 290.0, 190.0, 500.0, 10.0, 80.0, 10.0, 140.0, 270.0, 70.0, 250.0, 220.0, 220.0, 60.0, -100.0, 380.0, 10.0, 30.0, 20.0, 120.0, -20.0, 10.0, 320.0, 170.0, 200.0, 70.0, 50.0, 90.0, 70.0, 90.0, 10.0, 20.0, 80.0, 70.0, 100.0, 95.0, 440.0, 60.0, 140.0, 90.0, 210.0, 140.0, 430.0, 280.0, 70.0, 70.0, 180.0, 200.0, -10.0, 30.0, 80.0, 40.0, 40.0, 10.0, 80.0, 0.0, 290.0, 110.0, -30.0, 180.0, 70.0, 80.0, 60.0, 40.0, -50.0, 240.0, 230.0, 40.0, 170.0, -25.0, -90.0, 10.0, 0.0, 50.0, -20.0, 10.0, -10.0, 570.0, 650.0, 320.0, 70.0, 80.0, -40.0, 220.0, 420.0, 140.0, 40.0, 0.0, 120.0, 100.0, 340.0, 30.0, 20.0, 20.0, 350.0, 160.0, 280.0, 50.0, 40.0, 10.0, 440.0, 20.0, 20.0, 110.0, 250.0, 30.0, 40.0, 80.0, 30.0, 120.0, 300.0, 80.0, 150.0, -15.0, 40.0, 0.0, 0.0, 20.0, 160.0, 10.0, 110.0, 0.0, 30.0, 90.0, 40.0, 90.0, 10.0, 200.0, 160.0, 350.0, 140.0, 300.0, 80.0, 40.0, 30.0, 110.0, 60.0, 100.0, 390.0, 180.0, 160.0, 0.0, 100.0, 150.0, 110.0, 120.0, 100.0, 180.0, 30.0, 20.0, 0.0, 10.0, 0.0, 40.0, 0.0, 150.0, 10.0, 170.0, 180.0, -80.0, 10.0, 60.0, 270.0, 420.0, 100.0, 320.0, 50.0, 50.0, 100.0, 30.0, 70.0, 100.0, 10.0, 10.0, 170.0, 120.0, 10.0, 10.0, 5.0, 10.0, 120.0, 300.0, 50.0, 290.0, 40.0, 70.0, 60.0, 70.0, 310.0, 130.0, 110.0, 330.0, 90.0, 130.0, 100.0, 0.0, 320.0, 160.0, 40.0, 170.0, 60.0, 30.0, 100.0, 30.0, 100.0, 60.0, 180.0, 0.0, 350.0, 30.0, 280.0, 50.0, 100.0, 330.0, 120.0, 130.0, 130.0, 40.0, 55.0, 0.0, 180.0, 0.0, -5.0, 100.0, 130.0, 190.0, 60.0, 30.0, 400.0, 430.0, 30.0, 310.0, 500.0, 80.0, 90.0, 30.0, 220.0, 110.0, 80.0, 20.0, 110.0, 90.0, 70.0, 50.0, 30.0, 30.0, 160.0, 140.0, 0.0, 60.0, 60.0, 0.0, 10.0, 140.0, 0.0, 160.0, 40.0, 90.0, 20.0, 70.0, 20.0, 180.0, 50.0, 400.0, 0.0, 50.0, -290.0, 180.0, 230.0, 90.0, 220.0, 10.0, 60.0, 450.0, 80.0, 120.0, 170.0, 70.0, 240.0, 250.0, 120.0, 60.0, 50.0, 30.0, 170.0, 180.0, 80.0, 730.0, 10.0, 100.0, 50.0, 40.0, 20.0, 0.0, 20.0, 50.0, 50.0, 0.0, 130.0, 670.0, 80.0, 190.0, 160.0, 30.0, -5.0, 10.0, 310.0, 30.0, 70.0, 40.0, 60.0, 290.0, 250.0, 10.0, 0.0, 20.0, 80.0, 60.0, 80.0, 110.0, 160.0, 30.0, 560.0, 120.0, -10.0, 250.0, 350.0, 50.0, 280.0, 60.0, -40.0, 0.0, 190.0, 720.0, 180.0, -60.0, 80.0, 100.0, 130.0, 140.0, 470.0, -25.0, 100.0, 70.0, -40.0, 40.0, 240.0, 400.0, -80.0, 140.0, 70.0, 110.0, 90.0, 550.0, 70.0, 0.0, 130.0, 30.0, 90.0, 210.0, 0.0, 60.0, 15.0, 370.0, 310.0, 40.0, 10.0, 140.0, 10.0, 210.0, 70.0, 100.0, 70.0, 70.0, -50.0, 190.0, 150.0, 380.0, 90.0, 200.0, 110.0, 130.0, 70.0, 300.0, 60.0, 400.0, 10.0, 100.0, 590.0, 80.0, 40.0, 10.0, 0.0, 0.0, 280.0, 40.0, 30.0, 20.0, 0.0, 60.0, 10.0, 50.0, 20.0, 710.0, 50.0, 40.0, 50.0, 250.0, 50.0, 50.0, 70.0, 200.0, 10.0, 130.0, 160.0, 120.0, 50.0, 110.0, 70.0, 280.0, 540.0, 250.0, 15.0, 50.0, 20.0, 20.0, 50.0, 160.0, 40.0, 130.0, 210.0, 90.0, 80.0, 120.0, 20.0, 140.0, 220.0, 30.0, 300.0, 100.0, 140.0, 40.0, 50.0, 30.0, 310.0, 50.0, 430.0, 60.0, 340.0, 30.0, 50.0, 60.0, 170.0, 0.0, 10.0, 120.0, 30.0, 420.0, 0.0, 100.0, 20.0, 55.0, 20.0, 190.0, 250.0, 40.0, -10.0, 240.0, 380.0, -10.0, 350.0, 130.0, 70.0, 160.0, 190.0, 40.0, 40.0, 270.0, 60.0, 10.0, 0.0, 120.0, 100.0, -25.0, 50.0, 380.0, 0.0, 160.0, 300.0, 90.0, 30.0, 90.0, 60.0, 130.0, 90.0, 160.0, 40.0, 170.0, -30.0, 100.0, 70.0, 220.0, 230.0, 20.0, 90.0, 70.0, 90.0, 40.0, 70.0, 40.0, 20.0, 20.0, 210.0, 30.0, 80.0, 280.0, 140.0, 0.0, 80.0, 20.0, 80.0, 80.0, 160.0, 90.0, 10.0, 220.0, 30.0, 40.0, 70.0, 150.0, 10.0, 80.0, 50.0, 100.0, 220.0, 350.0, 30.0, 350.0, 80.0, 160.0, 450.0, 140.0, 230.0, 50.0, 90.0, -10.0, 160.0, 100.0, 140.0, 100.0, 240.0, 260.0, 160.0, 390.0, -10.0, 155.0, 80.0, 285.0, -35.0, 0.0, -30.0, 180.0, 170.0, 190.0, -30.0, 10.0, 110.0, -25.0, 90.0, 400.0, 30.0, 250.0, 0.0, 140.0, 50.0, 110.0, 270.0, 40.0, 150.0, 120.0, 30.0, 40.0, 390.0, 120.0, 120.0, 130.0, 60.0, 100.0, 180.0, 80.0, 30.0, 50.0, 190.0, 10.0, 70.0, 20.0, 10.0, 170.0, 40.0, 30.0, -230.0, 290.0, 70.0, 100.0, 70.0, 370.0, 190.0, 360.0, 30.0, -40.0, 280.0, 160.0, 330.0, 50.0, 50.0, 70.0, 210.0, 210.0, 60.0, 60.0, 70.0, 170.0, 300.0, 190.0, 30.0, 110.0, 340.0, 260.0, 40.0, 100.0, -95.0, 10.0, 60.0, 180.0, 170.0, 60.0, 690.0, -175.0, 160.0, -50.0, 110.0, 30.0, 10.0, 10.0, 350.0, 30.0, -30.0, 300.0, 0.0, 310.0, 60.0, 270.0, 10.0, 30.0, 70.0, 420.0, 30.0, 10.0, 80.0, 50.0, 10.0, 390.0, 120.0, 370.0, 10.0, 80.0, 40.0, 40.0, 0.0, 170.0, 40.0, 110.0, 30.0, 130.0, 230.0, 120.0, 80.0, 140.0, 140.0, 110.0, -20.0, 120.0, 200.0, 50.0, 460.0, 45.0, 50.0, 0.0, 100.0, 750.0, 20.0, 15.0, 130.0, 0.0, 110.0, 140.0, 170.0, 0.0, 345.0, 210.0, 550.0, 130.0, 420.0, 110.0, 90.0, 80.0, 10.0, 240.0, 110.0, 10.0, 40.0, 10.0, 20.0, 180.0, 80.0, 120.0, 30.0, 40.0, 10.0, 80.0, 30.0, 60.0, 120.0, 10.0, 290.0, 15.0, 10.0, 370.0, 140.0, 60.0, 80.0, 190.0, 50.0, 30.0, 40.0, 200.0, 165.0, 30.0, 490.0, 560.0, 20.0, 110.0, 30.0, 120.0, 50.0, 210.0, 50.0, 70.0, 10.0, 60.0, 90.0, 40.0, 20.0, 100.0, 530.0, 110.0, 210.0, 20.0, 110.0, 160.0, 10.0, 310.0, 260.0, 20.0, 110.0, 170.0, 80.0, -10.0, 70.0, 40.0, 80.0, 40.0, 110.0, 10.0, 80.0, 170.0, 170.0, 200.0, 30.0, 20.0, 170.0, 0.0, 200.0, 80.0, 60.0, 30.0, 130.0, 30.0, 130.0, 110.0, 290.0, 60.0, -10.0, 10.0, 140.0, 230.0, 20.0, 420.0, 50.0, 340.0, 30.0, 30.0, 20.0, 150.0, 20.0, 120.0, 50.0, 240.0, 160.0, 150.0, 15.0, 180.0, 160.0, 30.0, 20.0, 10.0, 0.0, 30.0, 30.0, 260.0, 80.0, 100.0, 130.0, 60.0, 130.0, 310.0, 80.0, 110.0, 180.0, 20.0, 230.0, 180.0, 320.0, 220.0, 0.0, 45.0, 260.0, 40.0, 390.0, 300.0, 190.0, 80.0, 40.0, 100.0, 0.0, 40.0, 410.0, 90.0, 50.0, 260.0, 60.0, 220.0, 190.0, 170.0, 40.0, 300.0, 60.0, 70.0, 140.0, -50.0, 130.0, 470.0, 10.0, 50.0, 10.0, 110.0, 170.0, 120.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 10.0, 10.0, 0.0, 100.0, -50.0, 10.0, 380.0, 90.0, 0.0, 10.0, 50.0, 150.0, 20.0, 70.0, 55.0, -40.0, 400.0, 50.0, 120.0, 300.0, 70.0, 440.0, 30.0, 250.0, 50.0, 190.0, 60.0, 90.0, -80.0, 330.0, 70.0, 180.0, 150.0, 500.0, 90.0, 340.0, 360.0, 70.0, 110.0, 70.0, -10.0, 30.0, 10.0, 70.0, 0.0, 120.0, 80.0, 80.0, 40.0, 10.0, 210.0, 10.0, 50.0, 0.0, 60.0, 160.0, 20.0, 10.0, 100.0, 0.0, 30.0, 420.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6610534886197243, "mean_inference_ms": 1.502968873087999, "mean_action_processing_ms": 0.4240375687535836, "mean_env_wait_ms": 1.3489912090184786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013483047485351562, "StateBufferConnector_ms": 0.012831687927246094, "ViewRequirementAgentConnector_ms": 0.4216647148132324}, "num_episodes": 18, "episode_return_max": 1970.0, "episode_return_min": 140.0, "episode_return_mean": 1165.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.14109533527803, "num_env_steps_trained_throughput_per_sec": 19.14109533527803, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 5520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5520000, "timers": {"training_iteration_time_ms": 208576.448, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208576.401, "sample_time_ms": 2716.157, "learn_time_ms": 205836.857, "learn_throughput": 19.433, "synch_weights_time_ms": 13.317}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "done": false, "training_iteration": 138, "trial_id": "aa996_00000", "date": "2024-05-24_06-45-42", "timestamp": 1716547542, "time_this_iter_s": 208.98309993743896, "time_total_s": 28807.964553833008, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b01700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28807.964553833008, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 27.216610169491524, "ram_util_percent": 79.49254237288136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.373397267632845, "cur_kl_coeff": 1.6439562691433818, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005329160306194085, "vf_loss": 7.346158682627165, "vf_explained_var": -0.0007845763898632143, "kl": Infinity, "entropy": 0.236762828301317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1300515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "env_runners": {"episode_reward_max": 1970.0, "episode_reward_min": 140.0, "episode_reward_mean": 1151.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 115.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [535.0, 1320.0, 1410.0, 1080.0, 1265.0, 1085.0, 1880.0, 700.0, 580.0, 890.0, 1510.0, 1680.0, 460.0, 1545.0, 890.0, 1900.0, 1360.0, 1315.0, 1280.0, 1165.0, 1280.0, 1970.0, 500.0, 1290.0, 970.0, 1425.0, 1340.0, 1550.0, 890.0, 1285.0, 1300.0, 1095.0, 830.0, 1000.0, 900.0, 800.0, 1420.0, 1510.0, 1625.0, 665.0, 1440.0, 1290.0, 670.0, 1280.0, 1380.0, 1570.0, 1160.0, 760.0, 1290.0, 1110.0, 1190.0, 1115.0, 1680.0, 1950.0, 540.0, 1125.0, 1335.0, 1230.0, 1290.0, 1180.0, 930.0, 850.0, 1320.0, 1160.0, 625.0, 1440.0, 1705.0, 1300.0, 1510.0, 1030.0, 140.0, 760.0, 1495.0, 1290.0, 1570.0, 670.0, 820.0, 960.0, 1360.0, 710.0, 1210.0, 1570.0, 1420.0, 1190.0, 1360.0, 1660.0, 1360.0, 805.0, 1000.0, 1270.0, 450.0, 350.0, 1470.0, 590.0, 940.0, 1530.0, 970.0, 1380.0, 340.0, 560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 70.0, 100.0, 10.0, 10.0, 170.0, 120.0, 10.0, 10.0, 5.0, 10.0, 120.0, 300.0, 50.0, 290.0, 40.0, 70.0, 60.0, 70.0, 310.0, 130.0, 110.0, 330.0, 90.0, 130.0, 100.0, 0.0, 320.0, 160.0, 40.0, 170.0, 60.0, 30.0, 100.0, 30.0, 100.0, 60.0, 180.0, 0.0, 350.0, 30.0, 280.0, 50.0, 100.0, 330.0, 120.0, 130.0, 130.0, 40.0, 55.0, 0.0, 180.0, 0.0, -5.0, 100.0, 130.0, 190.0, 60.0, 30.0, 400.0, 430.0, 30.0, 310.0, 500.0, 80.0, 90.0, 30.0, 220.0, 110.0, 80.0, 20.0, 110.0, 90.0, 70.0, 50.0, 30.0, 30.0, 160.0, 140.0, 0.0, 60.0, 60.0, 0.0, 10.0, 140.0, 0.0, 160.0, 40.0, 90.0, 20.0, 70.0, 20.0, 180.0, 50.0, 400.0, 0.0, 50.0, -290.0, 180.0, 230.0, 90.0, 220.0, 10.0, 60.0, 450.0, 80.0, 120.0, 170.0, 70.0, 240.0, 250.0, 120.0, 60.0, 50.0, 30.0, 170.0, 180.0, 80.0, 730.0, 10.0, 100.0, 50.0, 40.0, 20.0, 0.0, 20.0, 50.0, 50.0, 0.0, 130.0, 670.0, 80.0, 190.0, 160.0, 30.0, -5.0, 10.0, 310.0, 30.0, 70.0, 40.0, 60.0, 290.0, 250.0, 10.0, 0.0, 20.0, 80.0, 60.0, 80.0, 110.0, 160.0, 30.0, 560.0, 120.0, -10.0, 250.0, 350.0, 50.0, 280.0, 60.0, -40.0, 0.0, 190.0, 720.0, 180.0, -60.0, 80.0, 100.0, 130.0, 140.0, 470.0, -25.0, 100.0, 70.0, -40.0, 40.0, 240.0, 400.0, -80.0, 140.0, 70.0, 110.0, 90.0, 550.0, 70.0, 0.0, 130.0, 30.0, 90.0, 210.0, 0.0, 60.0, 15.0, 370.0, 310.0, 40.0, 10.0, 140.0, 10.0, 210.0, 70.0, 100.0, 70.0, 70.0, -50.0, 190.0, 150.0, 380.0, 90.0, 200.0, 110.0, 130.0, 70.0, 300.0, 60.0, 400.0, 10.0, 100.0, 590.0, 80.0, 40.0, 10.0, 0.0, 0.0, 280.0, 40.0, 30.0, 20.0, 0.0, 60.0, 10.0, 50.0, 20.0, 710.0, 50.0, 40.0, 50.0, 250.0, 50.0, 50.0, 70.0, 200.0, 10.0, 130.0, 160.0, 120.0, 50.0, 110.0, 70.0, 280.0, 540.0, 250.0, 15.0, 50.0, 20.0, 20.0, 50.0, 160.0, 40.0, 130.0, 210.0, 90.0, 80.0, 120.0, 20.0, 140.0, 220.0, 30.0, 300.0, 100.0, 140.0, 40.0, 50.0, 30.0, 310.0, 50.0, 430.0, 60.0, 340.0, 30.0, 50.0, 60.0, 170.0, 0.0, 10.0, 120.0, 30.0, 420.0, 0.0, 100.0, 20.0, 55.0, 20.0, 190.0, 250.0, 40.0, -10.0, 240.0, 380.0, -10.0, 350.0, 130.0, 70.0, 160.0, 190.0, 40.0, 40.0, 270.0, 60.0, 10.0, 0.0, 120.0, 100.0, -25.0, 50.0, 380.0, 0.0, 160.0, 300.0, 90.0, 30.0, 90.0, 60.0, 130.0, 90.0, 160.0, 40.0, 170.0, -30.0, 100.0, 70.0, 220.0, 230.0, 20.0, 90.0, 70.0, 90.0, 40.0, 70.0, 40.0, 20.0, 20.0, 210.0, 30.0, 80.0, 280.0, 140.0, 0.0, 80.0, 20.0, 80.0, 80.0, 160.0, 90.0, 10.0, 220.0, 30.0, 40.0, 70.0, 150.0, 10.0, 80.0, 50.0, 100.0, 220.0, 350.0, 30.0, 350.0, 80.0, 160.0, 450.0, 140.0, 230.0, 50.0, 90.0, -10.0, 160.0, 100.0, 140.0, 100.0, 240.0, 260.0, 160.0, 390.0, -10.0, 155.0, 80.0, 285.0, -35.0, 0.0, -30.0, 180.0, 170.0, 190.0, -30.0, 10.0, 110.0, -25.0, 90.0, 400.0, 30.0, 250.0, 0.0, 140.0, 50.0, 110.0, 270.0, 40.0, 150.0, 120.0, 30.0, 40.0, 390.0, 120.0, 120.0, 130.0, 60.0, 100.0, 180.0, 80.0, 30.0, 50.0, 190.0, 10.0, 70.0, 20.0, 10.0, 170.0, 40.0, 30.0, -230.0, 290.0, 70.0, 100.0, 70.0, 370.0, 190.0, 360.0, 30.0, -40.0, 280.0, 160.0, 330.0, 50.0, 50.0, 70.0, 210.0, 210.0, 60.0, 60.0, 70.0, 170.0, 300.0, 190.0, 30.0, 110.0, 340.0, 260.0, 40.0, 100.0, -95.0, 10.0, 60.0, 180.0, 170.0, 60.0, 690.0, -175.0, 160.0, -50.0, 110.0, 30.0, 10.0, 10.0, 350.0, 30.0, -30.0, 300.0, 0.0, 310.0, 60.0, 270.0, 10.0, 30.0, 70.0, 420.0, 30.0, 10.0, 80.0, 50.0, 10.0, 390.0, 120.0, 370.0, 10.0, 80.0, 40.0, 40.0, 0.0, 170.0, 40.0, 110.0, 30.0, 130.0, 230.0, 120.0, 80.0, 140.0, 140.0, 110.0, -20.0, 120.0, 200.0, 50.0, 460.0, 45.0, 50.0, 0.0, 100.0, 750.0, 20.0, 15.0, 130.0, 0.0, 110.0, 140.0, 170.0, 0.0, 345.0, 210.0, 550.0, 130.0, 420.0, 110.0, 90.0, 80.0, 10.0, 240.0, 110.0, 10.0, 40.0, 10.0, 20.0, 180.0, 80.0, 120.0, 30.0, 40.0, 10.0, 80.0, 30.0, 60.0, 120.0, 10.0, 290.0, 15.0, 10.0, 370.0, 140.0, 60.0, 80.0, 190.0, 50.0, 30.0, 40.0, 200.0, 165.0, 30.0, 490.0, 560.0, 20.0, 110.0, 30.0, 120.0, 50.0, 210.0, 50.0, 70.0, 10.0, 60.0, 90.0, 40.0, 20.0, 100.0, 530.0, 110.0, 210.0, 20.0, 110.0, 160.0, 10.0, 310.0, 260.0, 20.0, 110.0, 170.0, 80.0, -10.0, 70.0, 40.0, 80.0, 40.0, 110.0, 10.0, 80.0, 170.0, 170.0, 200.0, 30.0, 20.0, 170.0, 0.0, 200.0, 80.0, 60.0, 30.0, 130.0, 30.0, 130.0, 110.0, 290.0, 60.0, -10.0, 10.0, 140.0, 230.0, 20.0, 420.0, 50.0, 340.0, 30.0, 30.0, 20.0, 150.0, 20.0, 120.0, 50.0, 240.0, 160.0, 150.0, 15.0, 180.0, 160.0, 30.0, 20.0, 10.0, 0.0, 30.0, 30.0, 260.0, 80.0, 100.0, 130.0, 60.0, 130.0, 310.0, 80.0, 110.0, 180.0, 20.0, 230.0, 180.0, 320.0, 220.0, 0.0, 45.0, 260.0, 40.0, 390.0, 300.0, 190.0, 80.0, 40.0, 100.0, 0.0, 40.0, 410.0, 90.0, 50.0, 260.0, 60.0, 220.0, 190.0, 170.0, 40.0, 300.0, 60.0, 70.0, 140.0, -50.0, 130.0, 470.0, 10.0, 50.0, 10.0, 110.0, 170.0, 120.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 10.0, 10.0, 0.0, 100.0, -50.0, 10.0, 380.0, 90.0, 0.0, 10.0, 50.0, 150.0, 20.0, 70.0, 55.0, -40.0, 400.0, 50.0, 120.0, 300.0, 70.0, 440.0, 30.0, 250.0, 50.0, 190.0, 60.0, 90.0, -80.0, 330.0, 70.0, 180.0, 150.0, 500.0, 90.0, 340.0, 360.0, 70.0, 110.0, 70.0, -10.0, 30.0, 10.0, 70.0, 0.0, 120.0, 80.0, 80.0, 40.0, 10.0, 210.0, 10.0, 50.0, 0.0, 60.0, 160.0, 20.0, 10.0, 100.0, 0.0, 30.0, 420.0, 20.0, 170.0, 110.0, -50.0, 190.0, 50.0, 190.0, 10.0, 140.0, 40.0, 110.0, 200.0, 510.0, 170.0, 60.0, 80.0, 50.0, 90.0, 110.0, 70.0, 20.0, 70.0, 0.0, 20.0, 30.0, 110.0, 30.0, 190.0, 20.0, 220.0, 20.0, 40.0, 140.0, 60.0, 50.0, 380.0, 60.0, 20.0, 0.0, 310.0, 150.0, 310.0, 310.0, 40.0, 250.0, 60.0, 30.0, 80.0, 330.0, 110.0, 50.0, 100.0, 130.0, 260.0, 200.0, 70.0, 90.0, 370.0, 60.0, 80.0, 60.0, 30.0, 290.0, 90.0, -20.0, 0.0, 20.0, 70.0, 230.0, 380.0, 100.0, 50.0, 60.0, 250.0, 50.0, 100.0, 30.0, 100.0, 240.0, 370.0, 110.0, 110.0, 170.0, 300.0, 120.0, 200.0, 150.0, 30.0, 100.0, 290.0, 190.0, 30.0, 40.0, 60.0, 230.0, 300.0, 100.0, 120.0, 70.0, 100.0, 310.0, 85.0, 230.0, -10.0, 0.0, 110.0, 30.0, 30.0, 50.0, 20.0, 260.0, 30.0, 260.0, 90.0, 130.0, 60.0, 190.0, 100.0, 90.0, 40.0, 10.0, 190.0, 220.0, -180.0, 580.0, 50.0, 100.0, 30.0, 120.0, 110.0, 50.0, 190.0, 30.0, 30.0, 0.0, -50.0, 80.0, 10.0, 70.0, 60.0, 30.0, -5.0, 30.0, 80.0, -5.0, 20.0, 40.0, 40.0, 120.0, 30.0, 0.0, 110.0, 150.0, 140.0, 170.0, 180.0, 60.0, 180.0, 90.0, 290.0, 100.0, 120.0, 20.0, 20.0, 60.0, 180.0, 30.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 210.0, 0.0, 50.0, 340.0, 160.0, 40.0, 70.0, 20.0, 310.0, 70.0, 120.0, 30.0, 150.0, 130.0, 280.0, 60.0, 150.0, 230.0, 110.0, 10.0, 110.0, 20.0, 280.0, 10.0, 60.0, 20.0, 80.0, 270.0, 20.0, 30.0, 50.0, 50.0, 420.0, 40.0, 330.0, 180.0, 200.0, 60.0, 170.0, 40.0, 0.0, 130.0, 130.0, 140.0, 120.0, -420.0, 10.0, 20.0, 20.0, 60.0, 80.0, 90.0, 50.0, 70.0, 50.0, 60.0, 60.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6608850520994702, "mean_inference_ms": 1.5031495866122828, "mean_action_processing_ms": 0.4240687787938869, "mean_env_wait_ms": 1.3492327228721306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013851642608642578, "StateBufferConnector_ms": 0.012938737869262695, "ViewRequirementAgentConnector_ms": 0.4361588954925537}, "num_episodes": 23, "episode_return_max": 1970.0, "episode_return_min": 140.0, "episode_return_mean": 1151.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.30605646876203, "num_env_steps_trained_throughput_per_sec": 19.30605646876203, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 5560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5560000, "timers": {"training_iteration_time_ms": 208624.098, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208624.051, "sample_time_ms": 2743.013, "learn_time_ms": 205856.994, "learn_throughput": 19.431, "synch_weights_time_ms": 13.236}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "done": false, "training_iteration": 139, "trial_id": "aa996_00000", "date": "2024-05-24_06-49-09", "timestamp": 1716547749, "time_this_iter_s": 207.19866609573364, "time_total_s": 29015.16321992874, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d70040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29015.16321992874, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 26.83139931740614, "ram_util_percent": 79.440614334471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.864408280655218, "cur_kl_coeff": 2.4659344037150737, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004901744311757751, "vf_loss": 7.502039689784106, "vf_explained_var": -2.6099464763848547e-05, "kl": Infinity, "entropy": 0.2448213194934324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1309905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "env_runners": {"episode_reward_max": 2190.0, "episode_reward_min": 140.0, "episode_reward_mean": 1156.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 115.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1280.0, 1165.0, 1280.0, 1970.0, 500.0, 1290.0, 970.0, 1425.0, 1340.0, 1550.0, 890.0, 1285.0, 1300.0, 1095.0, 830.0, 1000.0, 900.0, 800.0, 1420.0, 1510.0, 1625.0, 665.0, 1440.0, 1290.0, 670.0, 1280.0, 1380.0, 1570.0, 1160.0, 760.0, 1290.0, 1110.0, 1190.0, 1115.0, 1680.0, 1950.0, 540.0, 1125.0, 1335.0, 1230.0, 1290.0, 1180.0, 930.0, 850.0, 1320.0, 1160.0, 625.0, 1440.0, 1705.0, 1300.0, 1510.0, 1030.0, 140.0, 760.0, 1495.0, 1290.0, 1570.0, 670.0, 820.0, 960.0, 1360.0, 710.0, 1210.0, 1570.0, 1420.0, 1190.0, 1360.0, 1660.0, 1360.0, 805.0, 1000.0, 1270.0, 450.0, 350.0, 1470.0, 590.0, 940.0, 1530.0, 970.0, 1380.0, 340.0, 560.0, 1260.0, 2190.0, 1230.0, 1200.0, 1290.0, 1180.0, 1450.0, 1585.0, 620.0, 640.0, 1930.0, 1020.0, 1730.0, 1415.0, 185.0, 1280.0, 570.0, 1170.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 70.0, 110.0, 90.0, 550.0, 70.0, 0.0, 130.0, 30.0, 90.0, 210.0, 0.0, 60.0, 15.0, 370.0, 310.0, 40.0, 10.0, 140.0, 10.0, 210.0, 70.0, 100.0, 70.0, 70.0, -50.0, 190.0, 150.0, 380.0, 90.0, 200.0, 110.0, 130.0, 70.0, 300.0, 60.0, 400.0, 10.0, 100.0, 590.0, 80.0, 40.0, 10.0, 0.0, 0.0, 280.0, 40.0, 30.0, 20.0, 0.0, 60.0, 10.0, 50.0, 20.0, 710.0, 50.0, 40.0, 50.0, 250.0, 50.0, 50.0, 70.0, 200.0, 10.0, 130.0, 160.0, 120.0, 50.0, 110.0, 70.0, 280.0, 540.0, 250.0, 15.0, 50.0, 20.0, 20.0, 50.0, 160.0, 40.0, 130.0, 210.0, 90.0, 80.0, 120.0, 20.0, 140.0, 220.0, 30.0, 300.0, 100.0, 140.0, 40.0, 50.0, 30.0, 310.0, 50.0, 430.0, 60.0, 340.0, 30.0, 50.0, 60.0, 170.0, 0.0, 10.0, 120.0, 30.0, 420.0, 0.0, 100.0, 20.0, 55.0, 20.0, 190.0, 250.0, 40.0, -10.0, 240.0, 380.0, -10.0, 350.0, 130.0, 70.0, 160.0, 190.0, 40.0, 40.0, 270.0, 60.0, 10.0, 0.0, 120.0, 100.0, -25.0, 50.0, 380.0, 0.0, 160.0, 300.0, 90.0, 30.0, 90.0, 60.0, 130.0, 90.0, 160.0, 40.0, 170.0, -30.0, 100.0, 70.0, 220.0, 230.0, 20.0, 90.0, 70.0, 90.0, 40.0, 70.0, 40.0, 20.0, 20.0, 210.0, 30.0, 80.0, 280.0, 140.0, 0.0, 80.0, 20.0, 80.0, 80.0, 160.0, 90.0, 10.0, 220.0, 30.0, 40.0, 70.0, 150.0, 10.0, 80.0, 50.0, 100.0, 220.0, 350.0, 30.0, 350.0, 80.0, 160.0, 450.0, 140.0, 230.0, 50.0, 90.0, -10.0, 160.0, 100.0, 140.0, 100.0, 240.0, 260.0, 160.0, 390.0, -10.0, 155.0, 80.0, 285.0, -35.0, 0.0, -30.0, 180.0, 170.0, 190.0, -30.0, 10.0, 110.0, -25.0, 90.0, 400.0, 30.0, 250.0, 0.0, 140.0, 50.0, 110.0, 270.0, 40.0, 150.0, 120.0, 30.0, 40.0, 390.0, 120.0, 120.0, 130.0, 60.0, 100.0, 180.0, 80.0, 30.0, 50.0, 190.0, 10.0, 70.0, 20.0, 10.0, 170.0, 40.0, 30.0, -230.0, 290.0, 70.0, 100.0, 70.0, 370.0, 190.0, 360.0, 30.0, -40.0, 280.0, 160.0, 330.0, 50.0, 50.0, 70.0, 210.0, 210.0, 60.0, 60.0, 70.0, 170.0, 300.0, 190.0, 30.0, 110.0, 340.0, 260.0, 40.0, 100.0, -95.0, 10.0, 60.0, 180.0, 170.0, 60.0, 690.0, -175.0, 160.0, -50.0, 110.0, 30.0, 10.0, 10.0, 350.0, 30.0, -30.0, 300.0, 0.0, 310.0, 60.0, 270.0, 10.0, 30.0, 70.0, 420.0, 30.0, 10.0, 80.0, 50.0, 10.0, 390.0, 120.0, 370.0, 10.0, 80.0, 40.0, 40.0, 0.0, 170.0, 40.0, 110.0, 30.0, 130.0, 230.0, 120.0, 80.0, 140.0, 140.0, 110.0, -20.0, 120.0, 200.0, 50.0, 460.0, 45.0, 50.0, 0.0, 100.0, 750.0, 20.0, 15.0, 130.0, 0.0, 110.0, 140.0, 170.0, 0.0, 345.0, 210.0, 550.0, 130.0, 420.0, 110.0, 90.0, 80.0, 10.0, 240.0, 110.0, 10.0, 40.0, 10.0, 20.0, 180.0, 80.0, 120.0, 30.0, 40.0, 10.0, 80.0, 30.0, 60.0, 120.0, 10.0, 290.0, 15.0, 10.0, 370.0, 140.0, 60.0, 80.0, 190.0, 50.0, 30.0, 40.0, 200.0, 165.0, 30.0, 490.0, 560.0, 20.0, 110.0, 30.0, 120.0, 50.0, 210.0, 50.0, 70.0, 10.0, 60.0, 90.0, 40.0, 20.0, 100.0, 530.0, 110.0, 210.0, 20.0, 110.0, 160.0, 10.0, 310.0, 260.0, 20.0, 110.0, 170.0, 80.0, -10.0, 70.0, 40.0, 80.0, 40.0, 110.0, 10.0, 80.0, 170.0, 170.0, 200.0, 30.0, 20.0, 170.0, 0.0, 200.0, 80.0, 60.0, 30.0, 130.0, 30.0, 130.0, 110.0, 290.0, 60.0, -10.0, 10.0, 140.0, 230.0, 20.0, 420.0, 50.0, 340.0, 30.0, 30.0, 20.0, 150.0, 20.0, 120.0, 50.0, 240.0, 160.0, 150.0, 15.0, 180.0, 160.0, 30.0, 20.0, 10.0, 0.0, 30.0, 30.0, 260.0, 80.0, 100.0, 130.0, 60.0, 130.0, 310.0, 80.0, 110.0, 180.0, 20.0, 230.0, 180.0, 320.0, 220.0, 0.0, 45.0, 260.0, 40.0, 390.0, 300.0, 190.0, 80.0, 40.0, 100.0, 0.0, 40.0, 410.0, 90.0, 50.0, 260.0, 60.0, 220.0, 190.0, 170.0, 40.0, 300.0, 60.0, 70.0, 140.0, -50.0, 130.0, 470.0, 10.0, 50.0, 10.0, 110.0, 170.0, 120.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 10.0, 10.0, 0.0, 100.0, -50.0, 10.0, 380.0, 90.0, 0.0, 10.0, 50.0, 150.0, 20.0, 70.0, 55.0, -40.0, 400.0, 50.0, 120.0, 300.0, 70.0, 440.0, 30.0, 250.0, 50.0, 190.0, 60.0, 90.0, -80.0, 330.0, 70.0, 180.0, 150.0, 500.0, 90.0, 340.0, 360.0, 70.0, 110.0, 70.0, -10.0, 30.0, 10.0, 70.0, 0.0, 120.0, 80.0, 80.0, 40.0, 10.0, 210.0, 10.0, 50.0, 0.0, 60.0, 160.0, 20.0, 10.0, 100.0, 0.0, 30.0, 420.0, 20.0, 170.0, 110.0, -50.0, 190.0, 50.0, 190.0, 10.0, 140.0, 40.0, 110.0, 200.0, 510.0, 170.0, 60.0, 80.0, 50.0, 90.0, 110.0, 70.0, 20.0, 70.0, 0.0, 20.0, 30.0, 110.0, 30.0, 190.0, 20.0, 220.0, 20.0, 40.0, 140.0, 60.0, 50.0, 380.0, 60.0, 20.0, 0.0, 310.0, 150.0, 310.0, 310.0, 40.0, 250.0, 60.0, 30.0, 80.0, 330.0, 110.0, 50.0, 100.0, 130.0, 260.0, 200.0, 70.0, 90.0, 370.0, 60.0, 80.0, 60.0, 30.0, 290.0, 90.0, -20.0, 0.0, 20.0, 70.0, 230.0, 380.0, 100.0, 50.0, 60.0, 250.0, 50.0, 100.0, 30.0, 100.0, 240.0, 370.0, 110.0, 110.0, 170.0, 300.0, 120.0, 200.0, 150.0, 30.0, 100.0, 290.0, 190.0, 30.0, 40.0, 60.0, 230.0, 300.0, 100.0, 120.0, 70.0, 100.0, 310.0, 85.0, 230.0, -10.0, 0.0, 110.0, 30.0, 30.0, 50.0, 20.0, 260.0, 30.0, 260.0, 90.0, 130.0, 60.0, 190.0, 100.0, 90.0, 40.0, 10.0, 190.0, 220.0, -180.0, 580.0, 50.0, 100.0, 30.0, 120.0, 110.0, 50.0, 190.0, 30.0, 30.0, 0.0, -50.0, 80.0, 10.0, 70.0, 60.0, 30.0, -5.0, 30.0, 80.0, -5.0, 20.0, 40.0, 40.0, 120.0, 30.0, 0.0, 110.0, 150.0, 140.0, 170.0, 180.0, 60.0, 180.0, 90.0, 290.0, 100.0, 120.0, 20.0, 20.0, 60.0, 180.0, 30.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 210.0, 0.0, 50.0, 340.0, 160.0, 40.0, 70.0, 20.0, 310.0, 70.0, 120.0, 30.0, 150.0, 130.0, 280.0, 60.0, 150.0, 230.0, 110.0, 10.0, 110.0, 20.0, 280.0, 10.0, 60.0, 20.0, 80.0, 270.0, 20.0, 30.0, 50.0, 50.0, 420.0, 40.0, 330.0, 180.0, 200.0, 60.0, 170.0, 40.0, 0.0, 130.0, 130.0, 140.0, 120.0, -420.0, 10.0, 20.0, 20.0, 60.0, 80.0, 90.0, 50.0, 70.0, 50.0, 60.0, 60.0, 20.0, 240.0, 150.0, -50.0, 160.0, 90.0, 10.0, 30.0, 80.0, 180.0, 370.0, 240.0, 220.0, 290.0, 790.0, 70.0, 120.0, 280.0, 110.0, 10.0, 60.0, 210.0, 70.0, 90.0, 180.0, 60.0, 180.0, 110.0, 120.0, 140.0, 70.0, 80.0, 180.0, 420.0, 30.0, 70.0, 270.0, 40.0, 100.0, -10.0, 20.0, 60.0, 30.0, 20.0, 590.0, 60.0, 210.0, 10.0, 70.0, 190.0, 50.0, 220.0, 80.0, 70.0, 190.0, 10.0, 80.0, 350.0, 70.0, 30.0, 80.0, 300.0, 340.0, 0.0, 210.0, 100.0, 50.0, 110.0, 70.0, 100.0, 170.0, 110.0, 0.0, 260.0, 170.0, 15.0, 330.0, 180.0, 80.0, 170.0, 270.0, 20.0, 50.0, 180.0, 160.0, 40.0, 10.0, 80.0, 30.0, 0.0, 50.0, 390.0, 80.0, 170.0, 10.0, 0.0, 70.0, 50.0, 10.0, -270.0, 130.0, 0.0, 110.0, 60.0, 90.0, 490.0, 360.0, 60.0, 80.0, 380.0, 300.0, 20.0, 40.0, 110.0, 610.0, 10.0, 40.0, 110.0, 0.0, 10.0, 70.0, 60.0, 120.0, 440.0, 0.0, 420.0, 200.0, 180.0, 60.0, 80.0, 170.0, 200.0, 80.0, 170.0, 90.0, 420.0, 10.0, 275.0, 80.0, 50.0, 40.0, 40.0, 20.0, -15.0, 10.0, 100.0, 0.0, 0.0, 0.0, 20.0, 10.0, 350.0, 60.0, 40.0, 30.0, 110.0, 100.0, 80.0, 150.0, 300.0, 60.0, 30.0, 100.0, 50.0, 200.0, 30.0, 20.0, 0.0, 50.0, 180.0, -90.0, 50.0, 40.0, 0.0, 10.0, 190.0, 160.0, 140.0, 20.0, 100.0, 460.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6605504555816972, "mean_inference_ms": 1.503115405706937, "mean_action_processing_ms": 0.424032600977462, "mean_env_wait_ms": 1.3492465564203724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01396489143371582, "StateBufferConnector_ms": 0.012891769409179688, "ViewRequirementAgentConnector_ms": 0.44292664527893066}, "num_episodes": 18, "episode_return_max": 2190.0, "episode_return_min": 140.0, "episode_return_mean": 1156.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.307013384569775, "num_env_steps_trained_throughput_per_sec": 19.307013384569775, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 5600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5600000, "timers": {"training_iteration_time_ms": 208424.895, "restore_workers_time_ms": 0.013, "training_step_time_ms": 208424.849, "sample_time_ms": 2716.65, "learn_time_ms": 205685.253, "learn_throughput": 19.447, "synch_weights_time_ms": 11.992}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "done": false, "training_iteration": 140, "trial_id": "aa996_00000", "date": "2024-05-24_06-52-36", "timestamp": 1716547956, "time_this_iter_s": 207.18692994117737, "time_total_s": 29222.35014986992, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b01280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29222.35014986992, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 26.49112627986348, "ram_util_percent": 79.44300341296929}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7982365923504227, "cur_kl_coeff": 3.6989016055726087, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004411950122904235, "vf_loss": 7.8294121723459424, "vf_explained_var": 0.0007175086849667648, "kl": Infinity, "entropy": 0.24011046629522048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1319295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "env_runners": {"episode_reward_max": 2190.0, "episode_reward_min": 140.0, "episode_reward_mean": 1173.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 117.305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1440.0, 1290.0, 670.0, 1280.0, 1380.0, 1570.0, 1160.0, 760.0, 1290.0, 1110.0, 1190.0, 1115.0, 1680.0, 1950.0, 540.0, 1125.0, 1335.0, 1230.0, 1290.0, 1180.0, 930.0, 850.0, 1320.0, 1160.0, 625.0, 1440.0, 1705.0, 1300.0, 1510.0, 1030.0, 140.0, 760.0, 1495.0, 1290.0, 1570.0, 670.0, 820.0, 960.0, 1360.0, 710.0, 1210.0, 1570.0, 1420.0, 1190.0, 1360.0, 1660.0, 1360.0, 805.0, 1000.0, 1270.0, 450.0, 350.0, 1470.0, 590.0, 940.0, 1530.0, 970.0, 1380.0, 340.0, 560.0, 1260.0, 2190.0, 1230.0, 1200.0, 1290.0, 1180.0, 1450.0, 1585.0, 620.0, 640.0, 1930.0, 1020.0, 1730.0, 1415.0, 185.0, 1280.0, 570.0, 1170.0, 1110.0, 1570.0, 1640.0, 1345.0, 1245.0, 1170.0, 990.0, 1330.0, 1610.0, 1400.0, 1540.0, 470.0, 645.0, 1500.0, 1300.0, 940.0, 1210.0, 1930.0, 1370.0, 1135.0, 1305.0, 950.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [400.0, 30.0, 250.0, 0.0, 140.0, 50.0, 110.0, 270.0, 40.0, 150.0, 120.0, 30.0, 40.0, 390.0, 120.0, 120.0, 130.0, 60.0, 100.0, 180.0, 80.0, 30.0, 50.0, 190.0, 10.0, 70.0, 20.0, 10.0, 170.0, 40.0, 30.0, -230.0, 290.0, 70.0, 100.0, 70.0, 370.0, 190.0, 360.0, 30.0, -40.0, 280.0, 160.0, 330.0, 50.0, 50.0, 70.0, 210.0, 210.0, 60.0, 60.0, 70.0, 170.0, 300.0, 190.0, 30.0, 110.0, 340.0, 260.0, 40.0, 100.0, -95.0, 10.0, 60.0, 180.0, 170.0, 60.0, 690.0, -175.0, 160.0, -50.0, 110.0, 30.0, 10.0, 10.0, 350.0, 30.0, -30.0, 300.0, 0.0, 310.0, 60.0, 270.0, 10.0, 30.0, 70.0, 420.0, 30.0, 10.0, 80.0, 50.0, 10.0, 390.0, 120.0, 370.0, 10.0, 80.0, 40.0, 40.0, 0.0, 170.0, 40.0, 110.0, 30.0, 130.0, 230.0, 120.0, 80.0, 140.0, 140.0, 110.0, -20.0, 120.0, 200.0, 50.0, 460.0, 45.0, 50.0, 0.0, 100.0, 750.0, 20.0, 15.0, 130.0, 0.0, 110.0, 140.0, 170.0, 0.0, 345.0, 210.0, 550.0, 130.0, 420.0, 110.0, 90.0, 80.0, 10.0, 240.0, 110.0, 10.0, 40.0, 10.0, 20.0, 180.0, 80.0, 120.0, 30.0, 40.0, 10.0, 80.0, 30.0, 60.0, 120.0, 10.0, 290.0, 15.0, 10.0, 370.0, 140.0, 60.0, 80.0, 190.0, 50.0, 30.0, 40.0, 200.0, 165.0, 30.0, 490.0, 560.0, 20.0, 110.0, 30.0, 120.0, 50.0, 210.0, 50.0, 70.0, 10.0, 60.0, 90.0, 40.0, 20.0, 100.0, 530.0, 110.0, 210.0, 20.0, 110.0, 160.0, 10.0, 310.0, 260.0, 20.0, 110.0, 170.0, 80.0, -10.0, 70.0, 40.0, 80.0, 40.0, 110.0, 10.0, 80.0, 170.0, 170.0, 200.0, 30.0, 20.0, 170.0, 0.0, 200.0, 80.0, 60.0, 30.0, 130.0, 30.0, 130.0, 110.0, 290.0, 60.0, -10.0, 10.0, 140.0, 230.0, 20.0, 420.0, 50.0, 340.0, 30.0, 30.0, 20.0, 150.0, 20.0, 120.0, 50.0, 240.0, 160.0, 150.0, 15.0, 180.0, 160.0, 30.0, 20.0, 10.0, 0.0, 30.0, 30.0, 260.0, 80.0, 100.0, 130.0, 60.0, 130.0, 310.0, 80.0, 110.0, 180.0, 20.0, 230.0, 180.0, 320.0, 220.0, 0.0, 45.0, 260.0, 40.0, 390.0, 300.0, 190.0, 80.0, 40.0, 100.0, 0.0, 40.0, 410.0, 90.0, 50.0, 260.0, 60.0, 220.0, 190.0, 170.0, 40.0, 300.0, 60.0, 70.0, 140.0, -50.0, 130.0, 470.0, 10.0, 50.0, 10.0, 110.0, 170.0, 120.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 10.0, 10.0, 0.0, 100.0, -50.0, 10.0, 380.0, 90.0, 0.0, 10.0, 50.0, 150.0, 20.0, 70.0, 55.0, -40.0, 400.0, 50.0, 120.0, 300.0, 70.0, 440.0, 30.0, 250.0, 50.0, 190.0, 60.0, 90.0, -80.0, 330.0, 70.0, 180.0, 150.0, 500.0, 90.0, 340.0, 360.0, 70.0, 110.0, 70.0, -10.0, 30.0, 10.0, 70.0, 0.0, 120.0, 80.0, 80.0, 40.0, 10.0, 210.0, 10.0, 50.0, 0.0, 60.0, 160.0, 20.0, 10.0, 100.0, 0.0, 30.0, 420.0, 20.0, 170.0, 110.0, -50.0, 190.0, 50.0, 190.0, 10.0, 140.0, 40.0, 110.0, 200.0, 510.0, 170.0, 60.0, 80.0, 50.0, 90.0, 110.0, 70.0, 20.0, 70.0, 0.0, 20.0, 30.0, 110.0, 30.0, 190.0, 20.0, 220.0, 20.0, 40.0, 140.0, 60.0, 50.0, 380.0, 60.0, 20.0, 0.0, 310.0, 150.0, 310.0, 310.0, 40.0, 250.0, 60.0, 30.0, 80.0, 330.0, 110.0, 50.0, 100.0, 130.0, 260.0, 200.0, 70.0, 90.0, 370.0, 60.0, 80.0, 60.0, 30.0, 290.0, 90.0, -20.0, 0.0, 20.0, 70.0, 230.0, 380.0, 100.0, 50.0, 60.0, 250.0, 50.0, 100.0, 30.0, 100.0, 240.0, 370.0, 110.0, 110.0, 170.0, 300.0, 120.0, 200.0, 150.0, 30.0, 100.0, 290.0, 190.0, 30.0, 40.0, 60.0, 230.0, 300.0, 100.0, 120.0, 70.0, 100.0, 310.0, 85.0, 230.0, -10.0, 0.0, 110.0, 30.0, 30.0, 50.0, 20.0, 260.0, 30.0, 260.0, 90.0, 130.0, 60.0, 190.0, 100.0, 90.0, 40.0, 10.0, 190.0, 220.0, -180.0, 580.0, 50.0, 100.0, 30.0, 120.0, 110.0, 50.0, 190.0, 30.0, 30.0, 0.0, -50.0, 80.0, 10.0, 70.0, 60.0, 30.0, -5.0, 30.0, 80.0, -5.0, 20.0, 40.0, 40.0, 120.0, 30.0, 0.0, 110.0, 150.0, 140.0, 170.0, 180.0, 60.0, 180.0, 90.0, 290.0, 100.0, 120.0, 20.0, 20.0, 60.0, 180.0, 30.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 210.0, 0.0, 50.0, 340.0, 160.0, 40.0, 70.0, 20.0, 310.0, 70.0, 120.0, 30.0, 150.0, 130.0, 280.0, 60.0, 150.0, 230.0, 110.0, 10.0, 110.0, 20.0, 280.0, 10.0, 60.0, 20.0, 80.0, 270.0, 20.0, 30.0, 50.0, 50.0, 420.0, 40.0, 330.0, 180.0, 200.0, 60.0, 170.0, 40.0, 0.0, 130.0, 130.0, 140.0, 120.0, -420.0, 10.0, 20.0, 20.0, 60.0, 80.0, 90.0, 50.0, 70.0, 50.0, 60.0, 60.0, 20.0, 240.0, 150.0, -50.0, 160.0, 90.0, 10.0, 30.0, 80.0, 180.0, 370.0, 240.0, 220.0, 290.0, 790.0, 70.0, 120.0, 280.0, 110.0, 10.0, 60.0, 210.0, 70.0, 90.0, 180.0, 60.0, 180.0, 110.0, 120.0, 140.0, 70.0, 80.0, 180.0, 420.0, 30.0, 70.0, 270.0, 40.0, 100.0, -10.0, 20.0, 60.0, 30.0, 20.0, 590.0, 60.0, 210.0, 10.0, 70.0, 190.0, 50.0, 220.0, 80.0, 70.0, 190.0, 10.0, 80.0, 350.0, 70.0, 30.0, 80.0, 300.0, 340.0, 0.0, 210.0, 100.0, 50.0, 110.0, 70.0, 100.0, 170.0, 110.0, 0.0, 260.0, 170.0, 15.0, 330.0, 180.0, 80.0, 170.0, 270.0, 20.0, 50.0, 180.0, 160.0, 40.0, 10.0, 80.0, 30.0, 0.0, 50.0, 390.0, 80.0, 170.0, 10.0, 0.0, 70.0, 50.0, 10.0, -270.0, 130.0, 0.0, 110.0, 60.0, 90.0, 490.0, 360.0, 60.0, 80.0, 380.0, 300.0, 20.0, 40.0, 110.0, 610.0, 10.0, 40.0, 110.0, 0.0, 10.0, 70.0, 60.0, 120.0, 440.0, 0.0, 420.0, 200.0, 180.0, 60.0, 80.0, 170.0, 200.0, 80.0, 170.0, 90.0, 420.0, 10.0, 275.0, 80.0, 50.0, 40.0, 40.0, 20.0, -15.0, 10.0, 100.0, 0.0, 0.0, 0.0, 20.0, 10.0, 350.0, 60.0, 40.0, 30.0, 110.0, 100.0, 80.0, 150.0, 300.0, 60.0, 30.0, 100.0, 50.0, 200.0, 30.0, 20.0, 0.0, 50.0, 180.0, -90.0, 50.0, 40.0, 0.0, 10.0, 190.0, 160.0, 140.0, 20.0, 100.0, 460.0, 20.0, 200.0, 150.0, 80.0, 50.0, 30.0, 160.0, 90.0, 40.0, 290.0, 410.0, 140.0, 80.0, 210.0, 70.0, 210.0, 20.0, 150.0, 130.0, 150.0, 150.0, 40.0, 60.0, 50.0, 30.0, 390.0, 90.0, 200.0, 490.0, 140.0, 190.0, 90.0, 190.0, 120.0, 340.0, 70.0, 70.0, 100.0, 15.0, 160.0, 0.0, 420.0, 20.0, 110.0, 50.0, 75.0, 40.0, 500.0, 20.0, 10.0, 450.0, 50.0, 120.0, 40.0, 50.0, 190.0, 30.0, 40.0, 20.0, 180.0, 40.0, 40.0, 290.0, 30.0, 80.0, 40.0, 290.0, 70.0, 0.0, 110.0, 120.0, 180.0, 360.0, 400.0, 50.0, 10.0, 30.0, 100.0, -10.0, 90.0, 190.0, -10.0, -60.0, 220.0, 210.0, 400.0, 120.0, 120.0, 110.0, 310.0, 20.0, 30.0, 30.0, 310.0, 90.0, 70.0, 530.0, 60.0, 200.0, 60.0, 200.0, 10.0, 130.0, 10.0, 110.0, 30.0, 280.0, 360.0, 240.0, 170.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 20.0, 0.0, 200.0, 60.0, 210.0, 10.0, 70.0, 90.0, 100.0, 170.0, 10.0, -55.0, 40.0, 0.0, 200.0, 110.0, 60.0, 100.0, 60.0, 330.0, 70.0, 310.0, 150.0, 110.0, 120.0, 0.0, 100.0, 10.0, 130.0, 0.0, 300.0, 100.0, 500.0, 40.0, 10.0, 110.0, 170.0, 30.0, 140.0, 100.0, -20.0, 10.0, 300.0, 90.0, 40.0, 330.0, 90.0, 190.0, 10.0, 60.0, 90.0, 230.0, 60.0, 110.0, -20.0, 110.0, 80.0, 10.0, 40.0, 660.0, 160.0, 130.0, 440.0, 320.0, 60.0, 60.0, 30.0, 40.0, 520.0, 30.0, 90.0, 190.0, 300.0, 50.0, 60.0, 65.0, 410.0, 0.0, 90.0, 100.0, 10.0, 30.0, 170.0, 200.0, 90.0, 160.0, 130.0, 150.0, 5.0, 110.0, 90.0, 280.0, 50.0, 240.0, 270.0, 230.0, 200.0, 30.0, 140.0, -200.0, 240.0, -110.0, 90.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6600219095809683, "mean_inference_ms": 1.5032041079886846, "mean_action_processing_ms": 0.4239913576842417, "mean_env_wait_ms": 1.3492726714914818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015294790267944336, "StateBufferConnector_ms": 0.01315164566040039, "ViewRequirementAgentConnector_ms": 0.4508345127105713}, "num_episodes": 22, "episode_return_max": 2190.0, "episode_return_min": 140.0, "episode_return_mean": 1173.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.141052358109867, "num_env_steps_trained_throughput_per_sec": 19.141052358109867, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 5640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5640000, "timers": {"training_iteration_time_ms": 208514.965, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208514.922, "sample_time_ms": 2665.553, "learn_time_ms": 205826.333, "learn_throughput": 19.434, "synch_weights_time_ms": 11.839}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "done": false, "training_iteration": 141, "trial_id": "aa996_00000", "date": "2024-05-24_06-56-05", "timestamp": 1716548165, "time_this_iter_s": 208.98333287239075, "time_total_s": 29431.33348274231, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160ae9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29431.33348274231, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 26.87533783783784, "ram_util_percent": 79.57770270270271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9295529141212806, "cur_kl_coeff": 5.548352408358914, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004143828913099326, "vf_loss": 7.286468361589474, "vf_explained_var": -0.0003555873521981529, "kl": Infinity, "entropy": 0.2464028726830777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1328685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "env_runners": {"episode_reward_max": 2190.0, "episode_reward_min": 140.0, "episode_reward_mean": 1158.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 115.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1290.0, 1180.0, 930.0, 850.0, 1320.0, 1160.0, 625.0, 1440.0, 1705.0, 1300.0, 1510.0, 1030.0, 140.0, 760.0, 1495.0, 1290.0, 1570.0, 670.0, 820.0, 960.0, 1360.0, 710.0, 1210.0, 1570.0, 1420.0, 1190.0, 1360.0, 1660.0, 1360.0, 805.0, 1000.0, 1270.0, 450.0, 350.0, 1470.0, 590.0, 940.0, 1530.0, 970.0, 1380.0, 340.0, 560.0, 1260.0, 2190.0, 1230.0, 1200.0, 1290.0, 1180.0, 1450.0, 1585.0, 620.0, 640.0, 1930.0, 1020.0, 1730.0, 1415.0, 185.0, 1280.0, 570.0, 1170.0, 1110.0, 1570.0, 1640.0, 1345.0, 1245.0, 1170.0, 990.0, 1330.0, 1610.0, 1400.0, 1540.0, 470.0, 645.0, 1500.0, 1300.0, 940.0, 1210.0, 1930.0, 1370.0, 1135.0, 1305.0, 950.0, 735.0, 1740.0, 1400.0, 560.0, 1485.0, 1370.0, 1440.0, 500.0, 1150.0, 1450.0, 1410.0, 290.0, 950.0, 2180.0, 970.0, 990.0, 790.0, 1210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 90.0, 40.0, 20.0, 100.0, 530.0, 110.0, 210.0, 20.0, 110.0, 160.0, 10.0, 310.0, 260.0, 20.0, 110.0, 170.0, 80.0, -10.0, 70.0, 40.0, 80.0, 40.0, 110.0, 10.0, 80.0, 170.0, 170.0, 200.0, 30.0, 20.0, 170.0, 0.0, 200.0, 80.0, 60.0, 30.0, 130.0, 30.0, 130.0, 110.0, 290.0, 60.0, -10.0, 10.0, 140.0, 230.0, 20.0, 420.0, 50.0, 340.0, 30.0, 30.0, 20.0, 150.0, 20.0, 120.0, 50.0, 240.0, 160.0, 150.0, 15.0, 180.0, 160.0, 30.0, 20.0, 10.0, 0.0, 30.0, 30.0, 260.0, 80.0, 100.0, 130.0, 60.0, 130.0, 310.0, 80.0, 110.0, 180.0, 20.0, 230.0, 180.0, 320.0, 220.0, 0.0, 45.0, 260.0, 40.0, 390.0, 300.0, 190.0, 80.0, 40.0, 100.0, 0.0, 40.0, 410.0, 90.0, 50.0, 260.0, 60.0, 220.0, 190.0, 170.0, 40.0, 300.0, 60.0, 70.0, 140.0, -50.0, 130.0, 470.0, 10.0, 50.0, 10.0, 110.0, 170.0, 120.0, 10.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 10.0, 10.0, 0.0, 100.0, -50.0, 10.0, 380.0, 90.0, 0.0, 10.0, 50.0, 150.0, 20.0, 70.0, 55.0, -40.0, 400.0, 50.0, 120.0, 300.0, 70.0, 440.0, 30.0, 250.0, 50.0, 190.0, 60.0, 90.0, -80.0, 330.0, 70.0, 180.0, 150.0, 500.0, 90.0, 340.0, 360.0, 70.0, 110.0, 70.0, -10.0, 30.0, 10.0, 70.0, 0.0, 120.0, 80.0, 80.0, 40.0, 10.0, 210.0, 10.0, 50.0, 0.0, 60.0, 160.0, 20.0, 10.0, 100.0, 0.0, 30.0, 420.0, 20.0, 170.0, 110.0, -50.0, 190.0, 50.0, 190.0, 10.0, 140.0, 40.0, 110.0, 200.0, 510.0, 170.0, 60.0, 80.0, 50.0, 90.0, 110.0, 70.0, 20.0, 70.0, 0.0, 20.0, 30.0, 110.0, 30.0, 190.0, 20.0, 220.0, 20.0, 40.0, 140.0, 60.0, 50.0, 380.0, 60.0, 20.0, 0.0, 310.0, 150.0, 310.0, 310.0, 40.0, 250.0, 60.0, 30.0, 80.0, 330.0, 110.0, 50.0, 100.0, 130.0, 260.0, 200.0, 70.0, 90.0, 370.0, 60.0, 80.0, 60.0, 30.0, 290.0, 90.0, -20.0, 0.0, 20.0, 70.0, 230.0, 380.0, 100.0, 50.0, 60.0, 250.0, 50.0, 100.0, 30.0, 100.0, 240.0, 370.0, 110.0, 110.0, 170.0, 300.0, 120.0, 200.0, 150.0, 30.0, 100.0, 290.0, 190.0, 30.0, 40.0, 60.0, 230.0, 300.0, 100.0, 120.0, 70.0, 100.0, 310.0, 85.0, 230.0, -10.0, 0.0, 110.0, 30.0, 30.0, 50.0, 20.0, 260.0, 30.0, 260.0, 90.0, 130.0, 60.0, 190.0, 100.0, 90.0, 40.0, 10.0, 190.0, 220.0, -180.0, 580.0, 50.0, 100.0, 30.0, 120.0, 110.0, 50.0, 190.0, 30.0, 30.0, 0.0, -50.0, 80.0, 10.0, 70.0, 60.0, 30.0, -5.0, 30.0, 80.0, -5.0, 20.0, 40.0, 40.0, 120.0, 30.0, 0.0, 110.0, 150.0, 140.0, 170.0, 180.0, 60.0, 180.0, 90.0, 290.0, 100.0, 120.0, 20.0, 20.0, 60.0, 180.0, 30.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 210.0, 0.0, 50.0, 340.0, 160.0, 40.0, 70.0, 20.0, 310.0, 70.0, 120.0, 30.0, 150.0, 130.0, 280.0, 60.0, 150.0, 230.0, 110.0, 10.0, 110.0, 20.0, 280.0, 10.0, 60.0, 20.0, 80.0, 270.0, 20.0, 30.0, 50.0, 50.0, 420.0, 40.0, 330.0, 180.0, 200.0, 60.0, 170.0, 40.0, 0.0, 130.0, 130.0, 140.0, 120.0, -420.0, 10.0, 20.0, 20.0, 60.0, 80.0, 90.0, 50.0, 70.0, 50.0, 60.0, 60.0, 20.0, 240.0, 150.0, -50.0, 160.0, 90.0, 10.0, 30.0, 80.0, 180.0, 370.0, 240.0, 220.0, 290.0, 790.0, 70.0, 120.0, 280.0, 110.0, 10.0, 60.0, 210.0, 70.0, 90.0, 180.0, 60.0, 180.0, 110.0, 120.0, 140.0, 70.0, 80.0, 180.0, 420.0, 30.0, 70.0, 270.0, 40.0, 100.0, -10.0, 20.0, 60.0, 30.0, 20.0, 590.0, 60.0, 210.0, 10.0, 70.0, 190.0, 50.0, 220.0, 80.0, 70.0, 190.0, 10.0, 80.0, 350.0, 70.0, 30.0, 80.0, 300.0, 340.0, 0.0, 210.0, 100.0, 50.0, 110.0, 70.0, 100.0, 170.0, 110.0, 0.0, 260.0, 170.0, 15.0, 330.0, 180.0, 80.0, 170.0, 270.0, 20.0, 50.0, 180.0, 160.0, 40.0, 10.0, 80.0, 30.0, 0.0, 50.0, 390.0, 80.0, 170.0, 10.0, 0.0, 70.0, 50.0, 10.0, -270.0, 130.0, 0.0, 110.0, 60.0, 90.0, 490.0, 360.0, 60.0, 80.0, 380.0, 300.0, 20.0, 40.0, 110.0, 610.0, 10.0, 40.0, 110.0, 0.0, 10.0, 70.0, 60.0, 120.0, 440.0, 0.0, 420.0, 200.0, 180.0, 60.0, 80.0, 170.0, 200.0, 80.0, 170.0, 90.0, 420.0, 10.0, 275.0, 80.0, 50.0, 40.0, 40.0, 20.0, -15.0, 10.0, 100.0, 0.0, 0.0, 0.0, 20.0, 10.0, 350.0, 60.0, 40.0, 30.0, 110.0, 100.0, 80.0, 150.0, 300.0, 60.0, 30.0, 100.0, 50.0, 200.0, 30.0, 20.0, 0.0, 50.0, 180.0, -90.0, 50.0, 40.0, 0.0, 10.0, 190.0, 160.0, 140.0, 20.0, 100.0, 460.0, 20.0, 200.0, 150.0, 80.0, 50.0, 30.0, 160.0, 90.0, 40.0, 290.0, 410.0, 140.0, 80.0, 210.0, 70.0, 210.0, 20.0, 150.0, 130.0, 150.0, 150.0, 40.0, 60.0, 50.0, 30.0, 390.0, 90.0, 200.0, 490.0, 140.0, 190.0, 90.0, 190.0, 120.0, 340.0, 70.0, 70.0, 100.0, 15.0, 160.0, 0.0, 420.0, 20.0, 110.0, 50.0, 75.0, 40.0, 500.0, 20.0, 10.0, 450.0, 50.0, 120.0, 40.0, 50.0, 190.0, 30.0, 40.0, 20.0, 180.0, 40.0, 40.0, 290.0, 30.0, 80.0, 40.0, 290.0, 70.0, 0.0, 110.0, 120.0, 180.0, 360.0, 400.0, 50.0, 10.0, 30.0, 100.0, -10.0, 90.0, 190.0, -10.0, -60.0, 220.0, 210.0, 400.0, 120.0, 120.0, 110.0, 310.0, 20.0, 30.0, 30.0, 310.0, 90.0, 70.0, 530.0, 60.0, 200.0, 60.0, 200.0, 10.0, 130.0, 10.0, 110.0, 30.0, 280.0, 360.0, 240.0, 170.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 20.0, 0.0, 200.0, 60.0, 210.0, 10.0, 70.0, 90.0, 100.0, 170.0, 10.0, -55.0, 40.0, 0.0, 200.0, 110.0, 60.0, 100.0, 60.0, 330.0, 70.0, 310.0, 150.0, 110.0, 120.0, 0.0, 100.0, 10.0, 130.0, 0.0, 300.0, 100.0, 500.0, 40.0, 10.0, 110.0, 170.0, 30.0, 140.0, 100.0, -20.0, 10.0, 300.0, 90.0, 40.0, 330.0, 90.0, 190.0, 10.0, 60.0, 90.0, 230.0, 60.0, 110.0, -20.0, 110.0, 80.0, 10.0, 40.0, 660.0, 160.0, 130.0, 440.0, 320.0, 60.0, 60.0, 30.0, 40.0, 520.0, 30.0, 90.0, 190.0, 300.0, 50.0, 60.0, 65.0, 410.0, 0.0, 90.0, 100.0, 10.0, 30.0, 170.0, 200.0, 90.0, 160.0, 130.0, 150.0, 5.0, 110.0, 90.0, 280.0, 50.0, 240.0, 270.0, 230.0, 200.0, 30.0, 140.0, -200.0, 240.0, -110.0, 90.0, 60.0, 10.0, 140.0, 130.0, 290.0, 15.0, 5.0, 110.0, 20.0, 20.0, -5.0, 150.0, 100.0, 120.0, 50.0, 350.0, 240.0, 120.0, 80.0, 100.0, 430.0, 100.0, 40.0, 200.0, 130.0, 250.0, 270.0, 100.0, 100.0, 60.0, 150.0, 30.0, 70.0, 50.0, 10.0, 260.0, 100.0, 10.0, 10.0, 10.0, 10.0, 70.0, 100.0, 250.0, 240.0, 140.0, 470.0, 25.0, 30.0, 10.0, 150.0, 50.0, 30.0, 360.0, 60.0, 190.0, 110.0, 200.0, 40.0, 60.0, 270.0, 190.0, 620.0, 40.0, 120.0, 50.0, 120.0, 20.0, 0.0, 60.0, 220.0, 20.0, 60.0, 320.0, 0.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 60.0, 300.0, 60.0, 20.0, 120.0, 190.0, 90.0, 10.0, 170.0, 130.0, 20.0, 110.0, 320.0, 20.0, 190.0, 100.0, 60.0, 40.0, 150.0, 440.0, 80.0, 60.0, 300.0, 130.0, 20.0, 90.0, 310.0, 200.0, 90.0, 130.0, 40.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 140.0, 10.0, 30.0, 10.0, 10.0, 300.0, 450.0, 40.0, -10.0, 40.0, 50.0, 30.0, 30.0, 120.0, 410.0, 520.0, 250.0, 60.0, 210.0, 130.0, 360.0, 30.0, 90.0, 150.0, 50.0, 80.0, 0.0, 300.0, 20.0, 150.0, 10.0, 60.0, 150.0, 10.0, 80.0, 300.0, 190.0, 90.0, 70.0, 50.0, 90.0, -50.0, 160.0, 0.0, 140.0, 0.0, 30.0, 130.0, 360.0, 0.0, 20.0, 20.0, 90.0, 160.0, 40.0, -80.0, 210.0, 40.0, 560.0, 30.0, 120.0, -40.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.659316315198558, "mean_inference_ms": 1.502952384496769, "mean_action_processing_ms": 0.4238931674971337, "mean_env_wait_ms": 1.3491461928008261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014915943145751953, "StateBufferConnector_ms": 0.012943506240844727, "ViewRequirementAgentConnector_ms": 0.43862390518188477}, "num_episodes": 18, "episode_return_max": 2190.0, "episode_return_min": 140.0, "episode_return_mean": 1158.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.260345332501036, "num_env_steps_trained_throughput_per_sec": 19.260345332501036, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 5680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5680000, "timers": {"training_iteration_time_ms": 208381.208, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208381.166, "sample_time_ms": 2664.759, "learn_time_ms": 205694.226, "learn_throughput": 19.446, "synch_weights_time_ms": 11.606}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "done": false, "training_iteration": 142, "trial_id": "aa996_00000", "date": "2024-05-24_06-59-33", "timestamp": 1716548373, "time_this_iter_s": 207.6915409564972, "time_total_s": 29639.025023698807, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b011f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29639.025023698807, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 26.77176870748299, "ram_util_percent": 79.6234693877551}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9127023236693157, "cur_kl_coeff": 8.322528612538374, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0033112693667764893, "vf_loss": 7.5149898493505765, "vf_explained_var": -0.00026555333020715033, "kl": Infinity, "entropy": 0.2462387541247506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1338075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "env_runners": {"episode_reward_max": 2190.0, "episode_reward_min": 185.0, "episode_reward_mean": 1180.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 118.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [820.0, 960.0, 1360.0, 710.0, 1210.0, 1570.0, 1420.0, 1190.0, 1360.0, 1660.0, 1360.0, 805.0, 1000.0, 1270.0, 450.0, 350.0, 1470.0, 590.0, 940.0, 1530.0, 970.0, 1380.0, 340.0, 560.0, 1260.0, 2190.0, 1230.0, 1200.0, 1290.0, 1180.0, 1450.0, 1585.0, 620.0, 640.0, 1930.0, 1020.0, 1730.0, 1415.0, 185.0, 1280.0, 570.0, 1170.0, 1110.0, 1570.0, 1640.0, 1345.0, 1245.0, 1170.0, 990.0, 1330.0, 1610.0, 1400.0, 1540.0, 470.0, 645.0, 1500.0, 1300.0, 940.0, 1210.0, 1930.0, 1370.0, 1135.0, 1305.0, 950.0, 735.0, 1740.0, 1400.0, 560.0, 1485.0, 1370.0, 1440.0, 500.0, 1150.0, 1450.0, 1410.0, 290.0, 950.0, 2180.0, 970.0, 990.0, 790.0, 1210.0, 820.0, 530.0, 1470.0, 1305.0, 1250.0, 690.0, 1360.0, 1295.0, 500.0, 1310.0, 1230.0, 1505.0, 1315.0, 1350.0, 1845.0, 1370.0, 1540.0, 1820.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 60.0, 160.0, 20.0, 10.0, 100.0, 0.0, 30.0, 420.0, 20.0, 170.0, 110.0, -50.0, 190.0, 50.0, 190.0, 10.0, 140.0, 40.0, 110.0, 200.0, 510.0, 170.0, 60.0, 80.0, 50.0, 90.0, 110.0, 70.0, 20.0, 70.0, 0.0, 20.0, 30.0, 110.0, 30.0, 190.0, 20.0, 220.0, 20.0, 40.0, 140.0, 60.0, 50.0, 380.0, 60.0, 20.0, 0.0, 310.0, 150.0, 310.0, 310.0, 40.0, 250.0, 60.0, 30.0, 80.0, 330.0, 110.0, 50.0, 100.0, 130.0, 260.0, 200.0, 70.0, 90.0, 370.0, 60.0, 80.0, 60.0, 30.0, 290.0, 90.0, -20.0, 0.0, 20.0, 70.0, 230.0, 380.0, 100.0, 50.0, 60.0, 250.0, 50.0, 100.0, 30.0, 100.0, 240.0, 370.0, 110.0, 110.0, 170.0, 300.0, 120.0, 200.0, 150.0, 30.0, 100.0, 290.0, 190.0, 30.0, 40.0, 60.0, 230.0, 300.0, 100.0, 120.0, 70.0, 100.0, 310.0, 85.0, 230.0, -10.0, 0.0, 110.0, 30.0, 30.0, 50.0, 20.0, 260.0, 30.0, 260.0, 90.0, 130.0, 60.0, 190.0, 100.0, 90.0, 40.0, 10.0, 190.0, 220.0, -180.0, 580.0, 50.0, 100.0, 30.0, 120.0, 110.0, 50.0, 190.0, 30.0, 30.0, 0.0, -50.0, 80.0, 10.0, 70.0, 60.0, 30.0, -5.0, 30.0, 80.0, -5.0, 20.0, 40.0, 40.0, 120.0, 30.0, 0.0, 110.0, 150.0, 140.0, 170.0, 180.0, 60.0, 180.0, 90.0, 290.0, 100.0, 120.0, 20.0, 20.0, 60.0, 180.0, 30.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 210.0, 0.0, 50.0, 340.0, 160.0, 40.0, 70.0, 20.0, 310.0, 70.0, 120.0, 30.0, 150.0, 130.0, 280.0, 60.0, 150.0, 230.0, 110.0, 10.0, 110.0, 20.0, 280.0, 10.0, 60.0, 20.0, 80.0, 270.0, 20.0, 30.0, 50.0, 50.0, 420.0, 40.0, 330.0, 180.0, 200.0, 60.0, 170.0, 40.0, 0.0, 130.0, 130.0, 140.0, 120.0, -420.0, 10.0, 20.0, 20.0, 60.0, 80.0, 90.0, 50.0, 70.0, 50.0, 60.0, 60.0, 20.0, 240.0, 150.0, -50.0, 160.0, 90.0, 10.0, 30.0, 80.0, 180.0, 370.0, 240.0, 220.0, 290.0, 790.0, 70.0, 120.0, 280.0, 110.0, 10.0, 60.0, 210.0, 70.0, 90.0, 180.0, 60.0, 180.0, 110.0, 120.0, 140.0, 70.0, 80.0, 180.0, 420.0, 30.0, 70.0, 270.0, 40.0, 100.0, -10.0, 20.0, 60.0, 30.0, 20.0, 590.0, 60.0, 210.0, 10.0, 70.0, 190.0, 50.0, 220.0, 80.0, 70.0, 190.0, 10.0, 80.0, 350.0, 70.0, 30.0, 80.0, 300.0, 340.0, 0.0, 210.0, 100.0, 50.0, 110.0, 70.0, 100.0, 170.0, 110.0, 0.0, 260.0, 170.0, 15.0, 330.0, 180.0, 80.0, 170.0, 270.0, 20.0, 50.0, 180.0, 160.0, 40.0, 10.0, 80.0, 30.0, 0.0, 50.0, 390.0, 80.0, 170.0, 10.0, 0.0, 70.0, 50.0, 10.0, -270.0, 130.0, 0.0, 110.0, 60.0, 90.0, 490.0, 360.0, 60.0, 80.0, 380.0, 300.0, 20.0, 40.0, 110.0, 610.0, 10.0, 40.0, 110.0, 0.0, 10.0, 70.0, 60.0, 120.0, 440.0, 0.0, 420.0, 200.0, 180.0, 60.0, 80.0, 170.0, 200.0, 80.0, 170.0, 90.0, 420.0, 10.0, 275.0, 80.0, 50.0, 40.0, 40.0, 20.0, -15.0, 10.0, 100.0, 0.0, 0.0, 0.0, 20.0, 10.0, 350.0, 60.0, 40.0, 30.0, 110.0, 100.0, 80.0, 150.0, 300.0, 60.0, 30.0, 100.0, 50.0, 200.0, 30.0, 20.0, 0.0, 50.0, 180.0, -90.0, 50.0, 40.0, 0.0, 10.0, 190.0, 160.0, 140.0, 20.0, 100.0, 460.0, 20.0, 200.0, 150.0, 80.0, 50.0, 30.0, 160.0, 90.0, 40.0, 290.0, 410.0, 140.0, 80.0, 210.0, 70.0, 210.0, 20.0, 150.0, 130.0, 150.0, 150.0, 40.0, 60.0, 50.0, 30.0, 390.0, 90.0, 200.0, 490.0, 140.0, 190.0, 90.0, 190.0, 120.0, 340.0, 70.0, 70.0, 100.0, 15.0, 160.0, 0.0, 420.0, 20.0, 110.0, 50.0, 75.0, 40.0, 500.0, 20.0, 10.0, 450.0, 50.0, 120.0, 40.0, 50.0, 190.0, 30.0, 40.0, 20.0, 180.0, 40.0, 40.0, 290.0, 30.0, 80.0, 40.0, 290.0, 70.0, 0.0, 110.0, 120.0, 180.0, 360.0, 400.0, 50.0, 10.0, 30.0, 100.0, -10.0, 90.0, 190.0, -10.0, -60.0, 220.0, 210.0, 400.0, 120.0, 120.0, 110.0, 310.0, 20.0, 30.0, 30.0, 310.0, 90.0, 70.0, 530.0, 60.0, 200.0, 60.0, 200.0, 10.0, 130.0, 10.0, 110.0, 30.0, 280.0, 360.0, 240.0, 170.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 20.0, 0.0, 200.0, 60.0, 210.0, 10.0, 70.0, 90.0, 100.0, 170.0, 10.0, -55.0, 40.0, 0.0, 200.0, 110.0, 60.0, 100.0, 60.0, 330.0, 70.0, 310.0, 150.0, 110.0, 120.0, 0.0, 100.0, 10.0, 130.0, 0.0, 300.0, 100.0, 500.0, 40.0, 10.0, 110.0, 170.0, 30.0, 140.0, 100.0, -20.0, 10.0, 300.0, 90.0, 40.0, 330.0, 90.0, 190.0, 10.0, 60.0, 90.0, 230.0, 60.0, 110.0, -20.0, 110.0, 80.0, 10.0, 40.0, 660.0, 160.0, 130.0, 440.0, 320.0, 60.0, 60.0, 30.0, 40.0, 520.0, 30.0, 90.0, 190.0, 300.0, 50.0, 60.0, 65.0, 410.0, 0.0, 90.0, 100.0, 10.0, 30.0, 170.0, 200.0, 90.0, 160.0, 130.0, 150.0, 5.0, 110.0, 90.0, 280.0, 50.0, 240.0, 270.0, 230.0, 200.0, 30.0, 140.0, -200.0, 240.0, -110.0, 90.0, 60.0, 10.0, 140.0, 130.0, 290.0, 15.0, 5.0, 110.0, 20.0, 20.0, -5.0, 150.0, 100.0, 120.0, 50.0, 350.0, 240.0, 120.0, 80.0, 100.0, 430.0, 100.0, 40.0, 200.0, 130.0, 250.0, 270.0, 100.0, 100.0, 60.0, 150.0, 30.0, 70.0, 50.0, 10.0, 260.0, 100.0, 10.0, 10.0, 10.0, 10.0, 70.0, 100.0, 250.0, 240.0, 140.0, 470.0, 25.0, 30.0, 10.0, 150.0, 50.0, 30.0, 360.0, 60.0, 190.0, 110.0, 200.0, 40.0, 60.0, 270.0, 190.0, 620.0, 40.0, 120.0, 50.0, 120.0, 20.0, 0.0, 60.0, 220.0, 20.0, 60.0, 320.0, 0.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 60.0, 300.0, 60.0, 20.0, 120.0, 190.0, 90.0, 10.0, 170.0, 130.0, 20.0, 110.0, 320.0, 20.0, 190.0, 100.0, 60.0, 40.0, 150.0, 440.0, 80.0, 60.0, 300.0, 130.0, 20.0, 90.0, 310.0, 200.0, 90.0, 130.0, 40.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 140.0, 10.0, 30.0, 10.0, 10.0, 300.0, 450.0, 40.0, -10.0, 40.0, 50.0, 30.0, 30.0, 120.0, 410.0, 520.0, 250.0, 60.0, 210.0, 130.0, 360.0, 30.0, 90.0, 150.0, 50.0, 80.0, 0.0, 300.0, 20.0, 150.0, 10.0, 60.0, 150.0, 10.0, 80.0, 300.0, 190.0, 90.0, 70.0, 50.0, 90.0, -50.0, 160.0, 0.0, 140.0, 0.0, 30.0, 130.0, 360.0, 0.0, 20.0, 20.0, 90.0, 160.0, 40.0, -80.0, 210.0, 40.0, 560.0, 30.0, 120.0, -40.0, 170.0, 90.0, 30.0, 160.0, 10.0, 30.0, 50.0, 40.0, 60.0, 20.0, 330.0, 10.0, 40.0, 110.0, 270.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, -10.0, 330.0, 160.0, 210.0, 110.0, 320.0, 40.0, 80.0, 220.0, 390.0, 390.0, 50.0, -35.0, -190.0, 440.0, 240.0, 50.0, 20.0, -50.0, 140.0, 100.0, -60.0, 190.0, 310.0, 80.0, 110.0, 20.0, 110.0, 250.0, 100.0, 60.0, 40.0, 20.0, 130.0, 10.0, 50.0, 220.0, 60.0, 0.0, 90.0, 70.0, 80.0, 350.0, 20.0, 290.0, 50.0, 390.0, 110.0, -90.0, 5.0, 60.0, 100.0, 40.0, 10.0, 50.0, 550.0, 320.0, 20.0, 140.0, 200.0, 0.0, 10.0, 110.0, 10.0, 20.0, 20.0, 30.0, 30.0, 70.0, 110.0, 70.0, 100.0, 350.0, 70.0, 100.0, 100.0, 40.0, 390.0, -20.0, 20.0, 80.0, 120.0, 220.0, 40.0, 90.0, 30.0, 180.0, 90.0, 360.0, 90.0, 40.0, 150.0, 140.0, 280.0, 80.0, 130.0, 255.0, 250.0, 90.0, 40.0, 15.0, 170.0, 30.0, 350.0, 230.0, 30.0, 240.0, 90.0, 120.0, 90.0, 50.0, 40.0, 60.0, 380.0, -30.0, 40.0, 320.0, 130.0, 270.0, 100.0, 125.0, 60.0, 760.0, 70.0, 110.0, 190.0, -30.0, 160.0, 300.0, 40.0, 30.0, 220.0, 30.0, 30.0, 160.0, 440.0, 350.0, 40.0, 30.0, 100.0, 140.0, 340.0, 80.0, 40.0, 180.0, 160.0, 430.0, 70.0, 0.0, 40.0, -30.0, 140.0, 80.0, 420.0, 200.0, 110.0, 550.0, 110.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6586643582625626, "mean_inference_ms": 1.5029331077691057, "mean_action_processing_ms": 0.42383145271298245, "mean_env_wait_ms": 1.3491226466433182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014524459838867188, "StateBufferConnector_ms": 0.010332345962524414, "ViewRequirementAgentConnector_ms": 0.4268486499786377}, "num_episodes": 18, "episode_return_max": 2190.0, "episode_return_min": 185.0, "episode_return_mean": 1180.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.14369983233087, "num_env_steps_trained_throughput_per_sec": 19.14369983233087, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 5720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5720000, "timers": {"training_iteration_time_ms": 208455.039, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208454.997, "sample_time_ms": 2657.763, "learn_time_ms": 205775.197, "learn_throughput": 19.439, "synch_weights_time_ms": 11.475}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "done": false, "training_iteration": 143, "trial_id": "aa996_00000", "date": "2024-05-24_07-03-02", "timestamp": 1716548582, "time_this_iter_s": 208.9562017917633, "time_total_s": 29847.98122549057, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160ae98b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29847.98122549057, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 27.08271186440678, "ram_util_percent": 79.64033898305085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.177471887430571, "cur_kl_coeff": 12.483792918807556, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0031925310135032504, "vf_loss": 7.510944883206401, "vf_explained_var": -0.0005552898517178017, "kl": Infinity, "entropy": 0.25201390550191155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1347465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "env_runners": {"episode_reward_max": 2190.0, "episode_reward_min": 185.0, "episode_reward_mean": 1183.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 118.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [560.0, 1260.0, 2190.0, 1230.0, 1200.0, 1290.0, 1180.0, 1450.0, 1585.0, 620.0, 640.0, 1930.0, 1020.0, 1730.0, 1415.0, 185.0, 1280.0, 570.0, 1170.0, 1110.0, 1570.0, 1640.0, 1345.0, 1245.0, 1170.0, 990.0, 1330.0, 1610.0, 1400.0, 1540.0, 470.0, 645.0, 1500.0, 1300.0, 940.0, 1210.0, 1930.0, 1370.0, 1135.0, 1305.0, 950.0, 735.0, 1740.0, 1400.0, 560.0, 1485.0, 1370.0, 1440.0, 500.0, 1150.0, 1450.0, 1410.0, 290.0, 950.0, 2180.0, 970.0, 990.0, 790.0, 1210.0, 820.0, 530.0, 1470.0, 1305.0, 1250.0, 690.0, 1360.0, 1295.0, 500.0, 1310.0, 1230.0, 1505.0, 1315.0, 1350.0, 1845.0, 1370.0, 1540.0, 1820.0, 1010.0, 1240.0, 1110.0, 1290.0, 850.0, 440.0, 1725.0, 1490.0, 590.0, 320.0, 1210.0, 1155.0, 940.0, 820.0, 1170.0, 1090.0, 1055.0, 1475.0, 910.0, 1235.0, 980.0, 1485.0, 1395.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 60.0, 80.0, 90.0, 50.0, 70.0, 50.0, 60.0, 60.0, 20.0, 240.0, 150.0, -50.0, 160.0, 90.0, 10.0, 30.0, 80.0, 180.0, 370.0, 240.0, 220.0, 290.0, 790.0, 70.0, 120.0, 280.0, 110.0, 10.0, 60.0, 210.0, 70.0, 90.0, 180.0, 60.0, 180.0, 110.0, 120.0, 140.0, 70.0, 80.0, 180.0, 420.0, 30.0, 70.0, 270.0, 40.0, 100.0, -10.0, 20.0, 60.0, 30.0, 20.0, 590.0, 60.0, 210.0, 10.0, 70.0, 190.0, 50.0, 220.0, 80.0, 70.0, 190.0, 10.0, 80.0, 350.0, 70.0, 30.0, 80.0, 300.0, 340.0, 0.0, 210.0, 100.0, 50.0, 110.0, 70.0, 100.0, 170.0, 110.0, 0.0, 260.0, 170.0, 15.0, 330.0, 180.0, 80.0, 170.0, 270.0, 20.0, 50.0, 180.0, 160.0, 40.0, 10.0, 80.0, 30.0, 0.0, 50.0, 390.0, 80.0, 170.0, 10.0, 0.0, 70.0, 50.0, 10.0, -270.0, 130.0, 0.0, 110.0, 60.0, 90.0, 490.0, 360.0, 60.0, 80.0, 380.0, 300.0, 20.0, 40.0, 110.0, 610.0, 10.0, 40.0, 110.0, 0.0, 10.0, 70.0, 60.0, 120.0, 440.0, 0.0, 420.0, 200.0, 180.0, 60.0, 80.0, 170.0, 200.0, 80.0, 170.0, 90.0, 420.0, 10.0, 275.0, 80.0, 50.0, 40.0, 40.0, 20.0, -15.0, 10.0, 100.0, 0.0, 0.0, 0.0, 20.0, 10.0, 350.0, 60.0, 40.0, 30.0, 110.0, 100.0, 80.0, 150.0, 300.0, 60.0, 30.0, 100.0, 50.0, 200.0, 30.0, 20.0, 0.0, 50.0, 180.0, -90.0, 50.0, 40.0, 0.0, 10.0, 190.0, 160.0, 140.0, 20.0, 100.0, 460.0, 20.0, 200.0, 150.0, 80.0, 50.0, 30.0, 160.0, 90.0, 40.0, 290.0, 410.0, 140.0, 80.0, 210.0, 70.0, 210.0, 20.0, 150.0, 130.0, 150.0, 150.0, 40.0, 60.0, 50.0, 30.0, 390.0, 90.0, 200.0, 490.0, 140.0, 190.0, 90.0, 190.0, 120.0, 340.0, 70.0, 70.0, 100.0, 15.0, 160.0, 0.0, 420.0, 20.0, 110.0, 50.0, 75.0, 40.0, 500.0, 20.0, 10.0, 450.0, 50.0, 120.0, 40.0, 50.0, 190.0, 30.0, 40.0, 20.0, 180.0, 40.0, 40.0, 290.0, 30.0, 80.0, 40.0, 290.0, 70.0, 0.0, 110.0, 120.0, 180.0, 360.0, 400.0, 50.0, 10.0, 30.0, 100.0, -10.0, 90.0, 190.0, -10.0, -60.0, 220.0, 210.0, 400.0, 120.0, 120.0, 110.0, 310.0, 20.0, 30.0, 30.0, 310.0, 90.0, 70.0, 530.0, 60.0, 200.0, 60.0, 200.0, 10.0, 130.0, 10.0, 110.0, 30.0, 280.0, 360.0, 240.0, 170.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 20.0, 0.0, 200.0, 60.0, 210.0, 10.0, 70.0, 90.0, 100.0, 170.0, 10.0, -55.0, 40.0, 0.0, 200.0, 110.0, 60.0, 100.0, 60.0, 330.0, 70.0, 310.0, 150.0, 110.0, 120.0, 0.0, 100.0, 10.0, 130.0, 0.0, 300.0, 100.0, 500.0, 40.0, 10.0, 110.0, 170.0, 30.0, 140.0, 100.0, -20.0, 10.0, 300.0, 90.0, 40.0, 330.0, 90.0, 190.0, 10.0, 60.0, 90.0, 230.0, 60.0, 110.0, -20.0, 110.0, 80.0, 10.0, 40.0, 660.0, 160.0, 130.0, 440.0, 320.0, 60.0, 60.0, 30.0, 40.0, 520.0, 30.0, 90.0, 190.0, 300.0, 50.0, 60.0, 65.0, 410.0, 0.0, 90.0, 100.0, 10.0, 30.0, 170.0, 200.0, 90.0, 160.0, 130.0, 150.0, 5.0, 110.0, 90.0, 280.0, 50.0, 240.0, 270.0, 230.0, 200.0, 30.0, 140.0, -200.0, 240.0, -110.0, 90.0, 60.0, 10.0, 140.0, 130.0, 290.0, 15.0, 5.0, 110.0, 20.0, 20.0, -5.0, 150.0, 100.0, 120.0, 50.0, 350.0, 240.0, 120.0, 80.0, 100.0, 430.0, 100.0, 40.0, 200.0, 130.0, 250.0, 270.0, 100.0, 100.0, 60.0, 150.0, 30.0, 70.0, 50.0, 10.0, 260.0, 100.0, 10.0, 10.0, 10.0, 10.0, 70.0, 100.0, 250.0, 240.0, 140.0, 470.0, 25.0, 30.0, 10.0, 150.0, 50.0, 30.0, 360.0, 60.0, 190.0, 110.0, 200.0, 40.0, 60.0, 270.0, 190.0, 620.0, 40.0, 120.0, 50.0, 120.0, 20.0, 0.0, 60.0, 220.0, 20.0, 60.0, 320.0, 0.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 60.0, 300.0, 60.0, 20.0, 120.0, 190.0, 90.0, 10.0, 170.0, 130.0, 20.0, 110.0, 320.0, 20.0, 190.0, 100.0, 60.0, 40.0, 150.0, 440.0, 80.0, 60.0, 300.0, 130.0, 20.0, 90.0, 310.0, 200.0, 90.0, 130.0, 40.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 140.0, 10.0, 30.0, 10.0, 10.0, 300.0, 450.0, 40.0, -10.0, 40.0, 50.0, 30.0, 30.0, 120.0, 410.0, 520.0, 250.0, 60.0, 210.0, 130.0, 360.0, 30.0, 90.0, 150.0, 50.0, 80.0, 0.0, 300.0, 20.0, 150.0, 10.0, 60.0, 150.0, 10.0, 80.0, 300.0, 190.0, 90.0, 70.0, 50.0, 90.0, -50.0, 160.0, 0.0, 140.0, 0.0, 30.0, 130.0, 360.0, 0.0, 20.0, 20.0, 90.0, 160.0, 40.0, -80.0, 210.0, 40.0, 560.0, 30.0, 120.0, -40.0, 170.0, 90.0, 30.0, 160.0, 10.0, 30.0, 50.0, 40.0, 60.0, 20.0, 330.0, 10.0, 40.0, 110.0, 270.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, -10.0, 330.0, 160.0, 210.0, 110.0, 320.0, 40.0, 80.0, 220.0, 390.0, 390.0, 50.0, -35.0, -190.0, 440.0, 240.0, 50.0, 20.0, -50.0, 140.0, 100.0, -60.0, 190.0, 310.0, 80.0, 110.0, 20.0, 110.0, 250.0, 100.0, 60.0, 40.0, 20.0, 130.0, 10.0, 50.0, 220.0, 60.0, 0.0, 90.0, 70.0, 80.0, 350.0, 20.0, 290.0, 50.0, 390.0, 110.0, -90.0, 5.0, 60.0, 100.0, 40.0, 10.0, 50.0, 550.0, 320.0, 20.0, 140.0, 200.0, 0.0, 10.0, 110.0, 10.0, 20.0, 20.0, 30.0, 30.0, 70.0, 110.0, 70.0, 100.0, 350.0, 70.0, 100.0, 100.0, 40.0, 390.0, -20.0, 20.0, 80.0, 120.0, 220.0, 40.0, 90.0, 30.0, 180.0, 90.0, 360.0, 90.0, 40.0, 150.0, 140.0, 280.0, 80.0, 130.0, 255.0, 250.0, 90.0, 40.0, 15.0, 170.0, 30.0, 350.0, 230.0, 30.0, 240.0, 90.0, 120.0, 90.0, 50.0, 40.0, 60.0, 380.0, -30.0, 40.0, 320.0, 130.0, 270.0, 100.0, 125.0, 60.0, 760.0, 70.0, 110.0, 190.0, -30.0, 160.0, 300.0, 40.0, 30.0, 220.0, 30.0, 30.0, 160.0, 440.0, 350.0, 40.0, 30.0, 100.0, 140.0, 340.0, 80.0, 40.0, 180.0, 160.0, 430.0, 70.0, 0.0, 40.0, -30.0, 140.0, 80.0, 420.0, 200.0, 110.0, 550.0, 110.0, 200.0, -25.0, 230.0, 110.0, 160.0, 65.0, 270.0, 140.0, 15.0, 100.0, -55.0, 300.0, 190.0, 70.0, 190.0, 40.0, 70.0, 50.0, 0.0, 280.0, 50.0, -10.0, 70.0, 210.0, 30.0, 80.0, 50.0, 240.0, 50.0, 320.0, 70.0, 110.0, 130.0, 70.0, 90.0, 70.0, 40.0, 100.0, 340.0, 60.0, 280.0, 270.0, 0.0, 40.0, 10.0, 60.0, 50.0, 380.0, 0.0, 30.0, 10.0, 60.0, 50.0, -40.0, 10.0, 140.0, 10.0, 110.0, 10.0, 0.0, 90.0, 55.0, 190.0, 695.0, 210.0, 10.0, 190.0, 150.0, 15.0, 120.0, 90.0, 400.0, 340.0, 70.0, 0.0, 70.0, 40.0, 40.0, 180.0, 330.0, 20.0, 10.0, 110.0, 150.0, 30.0, 30.0, 20.0, 0.0, 110.0, 100.0, 30.0, 70.0, 20.0, 40.0, 10.0, 30.0, 70.0, 0.0, 20.0, 60.0, 0.0, 150.0, 10.0, 180.0, 270.0, 140.0, 60.0, 50.0, 60.0, 90.0, 200.0, 15.0, 60.0, 100.0, 70.0, 60.0, 130.0, 30.0, 90.0, 340.0, 260.0, 140.0, 60.0, 80.0, 20.0, 50.0, 50.0, 320.0, 110.0, 100.0, 10.0, 220.0, 150.0, 140.0, 50.0, 20.0, 60.0, 20.0, 110.0, 40.0, 10.0, 100.0, 20.0, 20.0, 280.0, 440.0, 90.0, 60.0, 10.0, 30.0, 120.0, 80.0, -50.0, 70.0, -60.0, 30.0, 640.0, 170.0, 50.0, 130.0, 30.0, 110.0, 60.0, 20.0, 690.0, 60.0, 60.0, -40.0, 0.0, 90.0, 5.0, 50.0, 80.0, 215.0, 350.0, 30.0, 160.0, 190.0, 170.0, 30.0, 200.0, 80.0, 50.0, 70.0, 20.0, 40.0, 40.0, 10.0, 180.0, 120.0, 300.0, 340.0, -15.0, 190.0, 230.0, 80.0, 210.0, 50.0, 40.0, 50.0, 60.0, 80.0, -20.0, 680.0, 20.0, 90.0, 90.0, 40.0, 30.0, 220.0, -250.0, 230.0, 10.0, 80.0, 320.0, 70.0, 45.0, 100.0, 170.0, 90.0, 370.0, 200.0, 130.0, 0.0, 210.0, 115.0, 150.0, 70.0, 40.0, 340.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6575620684993557, "mean_inference_ms": 1.5027390140067574, "mean_action_processing_ms": 0.42373232471892736, "mean_env_wait_ms": 1.3489367051116252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014795780181884766, "StateBufferConnector_ms": 0.010512828826904297, "ViewRequirementAgentConnector_ms": 0.42032384872436523}, "num_episodes": 23, "episode_return_max": 2190.0, "episode_return_min": 185.0, "episode_return_mean": 1183.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.139734681835716, "num_env_steps_trained_throughput_per_sec": 19.139734681835716, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 5760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5760000, "timers": {"training_iteration_time_ms": 208557.358, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208557.315, "sample_time_ms": 2676.425, "learn_time_ms": 205859.47, "learn_throughput": 19.431, "synch_weights_time_ms": 11.543}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "done": false, "training_iteration": 144, "trial_id": "aa996_00000", "date": "2024-05-24_07-06-31", "timestamp": 1716548791, "time_this_iter_s": 209.03000378608704, "time_total_s": 30057.011229276657, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x332d6d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30057.011229276657, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 27.210135135135136, "ram_util_percent": 79.30506756756756}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4006148426042704, "cur_kl_coeff": 18.725689378211335, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0025162027805847244, "vf_loss": 7.684963820155817, "vf_explained_var": -0.000992589865248805, "kl": Infinity, "entropy": 0.2595238281975285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1356855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "env_runners": {"episode_reward_max": 2180.0, "episode_reward_min": 290.0, "episode_reward_mean": 1205.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 120.545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1345.0, 1245.0, 1170.0, 990.0, 1330.0, 1610.0, 1400.0, 1540.0, 470.0, 645.0, 1500.0, 1300.0, 940.0, 1210.0, 1930.0, 1370.0, 1135.0, 1305.0, 950.0, 735.0, 1740.0, 1400.0, 560.0, 1485.0, 1370.0, 1440.0, 500.0, 1150.0, 1450.0, 1410.0, 290.0, 950.0, 2180.0, 970.0, 990.0, 790.0, 1210.0, 820.0, 530.0, 1470.0, 1305.0, 1250.0, 690.0, 1360.0, 1295.0, 500.0, 1310.0, 1230.0, 1505.0, 1315.0, 1350.0, 1845.0, 1370.0, 1540.0, 1820.0, 1010.0, 1240.0, 1110.0, 1290.0, 850.0, 440.0, 1725.0, 1490.0, 590.0, 320.0, 1210.0, 1155.0, 940.0, 820.0, 1170.0, 1090.0, 1055.0, 1475.0, 910.0, 1235.0, 980.0, 1485.0, 1395.0, 1890.0, 1380.0, 1080.0, 1180.0, 1530.0, 1210.0, 1900.0, 1330.0, 1190.0, 1940.0, 1550.0, 1780.0, 1230.0, 1650.0, 1055.0, 1275.0, 1130.0, 490.0, 730.0, 1030.0, 760.0, 1740.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 90.0, 190.0, 120.0, 340.0, 70.0, 70.0, 100.0, 15.0, 160.0, 0.0, 420.0, 20.0, 110.0, 50.0, 75.0, 40.0, 500.0, 20.0, 10.0, 450.0, 50.0, 120.0, 40.0, 50.0, 190.0, 30.0, 40.0, 20.0, 180.0, 40.0, 40.0, 290.0, 30.0, 80.0, 40.0, 290.0, 70.0, 0.0, 110.0, 120.0, 180.0, 360.0, 400.0, 50.0, 10.0, 30.0, 100.0, -10.0, 90.0, 190.0, -10.0, -60.0, 220.0, 210.0, 400.0, 120.0, 120.0, 110.0, 310.0, 20.0, 30.0, 30.0, 310.0, 90.0, 70.0, 530.0, 60.0, 200.0, 60.0, 200.0, 10.0, 130.0, 10.0, 110.0, 30.0, 280.0, 360.0, 240.0, 170.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 20.0, 0.0, 200.0, 60.0, 210.0, 10.0, 70.0, 90.0, 100.0, 170.0, 10.0, -55.0, 40.0, 0.0, 200.0, 110.0, 60.0, 100.0, 60.0, 330.0, 70.0, 310.0, 150.0, 110.0, 120.0, 0.0, 100.0, 10.0, 130.0, 0.0, 300.0, 100.0, 500.0, 40.0, 10.0, 110.0, 170.0, 30.0, 140.0, 100.0, -20.0, 10.0, 300.0, 90.0, 40.0, 330.0, 90.0, 190.0, 10.0, 60.0, 90.0, 230.0, 60.0, 110.0, -20.0, 110.0, 80.0, 10.0, 40.0, 660.0, 160.0, 130.0, 440.0, 320.0, 60.0, 60.0, 30.0, 40.0, 520.0, 30.0, 90.0, 190.0, 300.0, 50.0, 60.0, 65.0, 410.0, 0.0, 90.0, 100.0, 10.0, 30.0, 170.0, 200.0, 90.0, 160.0, 130.0, 150.0, 5.0, 110.0, 90.0, 280.0, 50.0, 240.0, 270.0, 230.0, 200.0, 30.0, 140.0, -200.0, 240.0, -110.0, 90.0, 60.0, 10.0, 140.0, 130.0, 290.0, 15.0, 5.0, 110.0, 20.0, 20.0, -5.0, 150.0, 100.0, 120.0, 50.0, 350.0, 240.0, 120.0, 80.0, 100.0, 430.0, 100.0, 40.0, 200.0, 130.0, 250.0, 270.0, 100.0, 100.0, 60.0, 150.0, 30.0, 70.0, 50.0, 10.0, 260.0, 100.0, 10.0, 10.0, 10.0, 10.0, 70.0, 100.0, 250.0, 240.0, 140.0, 470.0, 25.0, 30.0, 10.0, 150.0, 50.0, 30.0, 360.0, 60.0, 190.0, 110.0, 200.0, 40.0, 60.0, 270.0, 190.0, 620.0, 40.0, 120.0, 50.0, 120.0, 20.0, 0.0, 60.0, 220.0, 20.0, 60.0, 320.0, 0.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 60.0, 300.0, 60.0, 20.0, 120.0, 190.0, 90.0, 10.0, 170.0, 130.0, 20.0, 110.0, 320.0, 20.0, 190.0, 100.0, 60.0, 40.0, 150.0, 440.0, 80.0, 60.0, 300.0, 130.0, 20.0, 90.0, 310.0, 200.0, 90.0, 130.0, 40.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 140.0, 10.0, 30.0, 10.0, 10.0, 300.0, 450.0, 40.0, -10.0, 40.0, 50.0, 30.0, 30.0, 120.0, 410.0, 520.0, 250.0, 60.0, 210.0, 130.0, 360.0, 30.0, 90.0, 150.0, 50.0, 80.0, 0.0, 300.0, 20.0, 150.0, 10.0, 60.0, 150.0, 10.0, 80.0, 300.0, 190.0, 90.0, 70.0, 50.0, 90.0, -50.0, 160.0, 0.0, 140.0, 0.0, 30.0, 130.0, 360.0, 0.0, 20.0, 20.0, 90.0, 160.0, 40.0, -80.0, 210.0, 40.0, 560.0, 30.0, 120.0, -40.0, 170.0, 90.0, 30.0, 160.0, 10.0, 30.0, 50.0, 40.0, 60.0, 20.0, 330.0, 10.0, 40.0, 110.0, 270.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, -10.0, 330.0, 160.0, 210.0, 110.0, 320.0, 40.0, 80.0, 220.0, 390.0, 390.0, 50.0, -35.0, -190.0, 440.0, 240.0, 50.0, 20.0, -50.0, 140.0, 100.0, -60.0, 190.0, 310.0, 80.0, 110.0, 20.0, 110.0, 250.0, 100.0, 60.0, 40.0, 20.0, 130.0, 10.0, 50.0, 220.0, 60.0, 0.0, 90.0, 70.0, 80.0, 350.0, 20.0, 290.0, 50.0, 390.0, 110.0, -90.0, 5.0, 60.0, 100.0, 40.0, 10.0, 50.0, 550.0, 320.0, 20.0, 140.0, 200.0, 0.0, 10.0, 110.0, 10.0, 20.0, 20.0, 30.0, 30.0, 70.0, 110.0, 70.0, 100.0, 350.0, 70.0, 100.0, 100.0, 40.0, 390.0, -20.0, 20.0, 80.0, 120.0, 220.0, 40.0, 90.0, 30.0, 180.0, 90.0, 360.0, 90.0, 40.0, 150.0, 140.0, 280.0, 80.0, 130.0, 255.0, 250.0, 90.0, 40.0, 15.0, 170.0, 30.0, 350.0, 230.0, 30.0, 240.0, 90.0, 120.0, 90.0, 50.0, 40.0, 60.0, 380.0, -30.0, 40.0, 320.0, 130.0, 270.0, 100.0, 125.0, 60.0, 760.0, 70.0, 110.0, 190.0, -30.0, 160.0, 300.0, 40.0, 30.0, 220.0, 30.0, 30.0, 160.0, 440.0, 350.0, 40.0, 30.0, 100.0, 140.0, 340.0, 80.0, 40.0, 180.0, 160.0, 430.0, 70.0, 0.0, 40.0, -30.0, 140.0, 80.0, 420.0, 200.0, 110.0, 550.0, 110.0, 200.0, -25.0, 230.0, 110.0, 160.0, 65.0, 270.0, 140.0, 15.0, 100.0, -55.0, 300.0, 190.0, 70.0, 190.0, 40.0, 70.0, 50.0, 0.0, 280.0, 50.0, -10.0, 70.0, 210.0, 30.0, 80.0, 50.0, 240.0, 50.0, 320.0, 70.0, 110.0, 130.0, 70.0, 90.0, 70.0, 40.0, 100.0, 340.0, 60.0, 280.0, 270.0, 0.0, 40.0, 10.0, 60.0, 50.0, 380.0, 0.0, 30.0, 10.0, 60.0, 50.0, -40.0, 10.0, 140.0, 10.0, 110.0, 10.0, 0.0, 90.0, 55.0, 190.0, 695.0, 210.0, 10.0, 190.0, 150.0, 15.0, 120.0, 90.0, 400.0, 340.0, 70.0, 0.0, 70.0, 40.0, 40.0, 180.0, 330.0, 20.0, 10.0, 110.0, 150.0, 30.0, 30.0, 20.0, 0.0, 110.0, 100.0, 30.0, 70.0, 20.0, 40.0, 10.0, 30.0, 70.0, 0.0, 20.0, 60.0, 0.0, 150.0, 10.0, 180.0, 270.0, 140.0, 60.0, 50.0, 60.0, 90.0, 200.0, 15.0, 60.0, 100.0, 70.0, 60.0, 130.0, 30.0, 90.0, 340.0, 260.0, 140.0, 60.0, 80.0, 20.0, 50.0, 50.0, 320.0, 110.0, 100.0, 10.0, 220.0, 150.0, 140.0, 50.0, 20.0, 60.0, 20.0, 110.0, 40.0, 10.0, 100.0, 20.0, 20.0, 280.0, 440.0, 90.0, 60.0, 10.0, 30.0, 120.0, 80.0, -50.0, 70.0, -60.0, 30.0, 640.0, 170.0, 50.0, 130.0, 30.0, 110.0, 60.0, 20.0, 690.0, 60.0, 60.0, -40.0, 0.0, 90.0, 5.0, 50.0, 80.0, 215.0, 350.0, 30.0, 160.0, 190.0, 170.0, 30.0, 200.0, 80.0, 50.0, 70.0, 20.0, 40.0, 40.0, 10.0, 180.0, 120.0, 300.0, 340.0, -15.0, 190.0, 230.0, 80.0, 210.0, 50.0, 40.0, 50.0, 60.0, 80.0, -20.0, 680.0, 20.0, 90.0, 90.0, 40.0, 30.0, 220.0, -250.0, 230.0, 10.0, 80.0, 320.0, 70.0, 45.0, 100.0, 170.0, 90.0, 370.0, 200.0, 130.0, 0.0, 210.0, 115.0, 150.0, 70.0, 40.0, 340.0, 140.0, 190.0, -50.0, 310.0, 60.0, 180.0, 300.0, 90.0, 530.0, 160.0, 120.0, 180.0, 100.0, 10.0, 180.0, 30.0, 610.0, 80.0, 100.0, 50.0, 40.0, 60.0, 120.0, 60.0, 20.0, 10.0, 210.0, 220.0, 110.0, 40.0, 230.0, 30.0, 570.0, 30.0, 90.0, 140.0, 50.0, 60.0, 110.0, 40.0, 60.0, 20.0, 70.0, 310.0, 340.0, 50.0, 0.0, 120.0, 330.0, 150.0, 140.0, 480.0, 40.0, 30.0, -10.0, -110.0, 10.0, 350.0, 160.0, 210.0, 50.0, 240.0, 30.0, 280.0, 260.0, 70.0, 480.0, 10.0, 190.0, 90.0, 250.0, 100.0, 190.0, 130.0, 60.0, 190.0, 130.0, 120.0, 90.0, 290.0, 30.0, 750.0, 100.0, 120.0, 140.0, -630.0, 80.0, 330.0, 50.0, 110.0, 140.0, 180.0, 700.0, 40.0, 100.0, 70.0, 450.0, 80.0, 70.0, 140.0, 110.0, 50.0, 40.0, 110.0, 110.0, 700.0, 210.0, 80.0, 80.0, 100.0, 70.0, 260.0, 270.0, 170.0, 90.0, 120.0, 100.0, 220.0, 40.0, 150.0, 360.0, 80.0, 110.0, 210.0, 20.0, 60.0, 330.0, 60.0, 110.0, 80.0, 170.0, 430.0, -100.0, 60.0, 50.0, 220.0, 450.0, 320.0, 100.0, 50.0, 70.0, 50.0, 310.0, 10.0, 5.0, 230.0, 300.0, 50.0, 70.0, 0.0, 30.0, 90.0, 120.0, 80.0, 70.0, 5.0, 320.0, 40.0, 460.0, 20.0, 70.0, 340.0, 190.0, 30.0, 90.0, 60.0, 150.0, 100.0, 40.0, -20.0, 150.0, 40.0, 190.0, 10.0, 80.0, 20.0, 0.0, 50.0, 0.0, 70.0, 30.0, 180.0, 130.0, 180.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 0.0, 80.0, 190.0, -10.0, 20.0, 110.0, 240.0, 120.0, -80.0, 60.0, 300.0, 250.0, 90.0, 10.0, 220.0, 120.0, 80.0, -100.0, 50.0, 30.0, 10.0, 90.0, 520.0, 80.0, 500.0, 70.0, 50.0, 40.0, 20.0, 70.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6582492753390765, "mean_inference_ms": 1.5041843526987264, "mean_action_processing_ms": 0.4238170193764866, "mean_env_wait_ms": 1.3477462696263416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014230728149414062, "StateBufferConnector_ms": 0.010421276092529297, "ViewRequirementAgentConnector_ms": 0.40967321395874023}, "num_episodes": 22, "episode_return_max": 2180.0, "episode_return_min": 290.0, "episode_return_mean": 1205.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.739918229441365, "num_env_steps_trained_throughput_per_sec": 18.739918229441365, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 5800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5800000, "timers": {"training_iteration_time_ms": 209062.274, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209062.231, "sample_time_ms": 2652.728, "learn_time_ms": 206387.648, "learn_throughput": 19.381, "synch_weights_time_ms": 11.768}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "done": false, "training_iteration": 145, "trial_id": "aa996_00000", "date": "2024-05-24_07-10-05", "timestamp": 1716549005, "time_this_iter_s": 213.4623417854309, "time_total_s": 30270.473571062088, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b23040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30270.473571062088, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 29.054966887417212, "ram_util_percent": 79.60033112582781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.102266316736341, "cur_kl_coeff": 28.088534067317013, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0018192955177585785, "vf_loss": 7.912877930061251, "vf_explained_var": -0.0002890804197333745, "kl": Infinity, "entropy": 0.24418670686162192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1366245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "env_runners": {"episode_reward_max": 2300.0, "episode_reward_min": 290.0, "episode_reward_mean": 1217.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 121.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 735.0, 1740.0, 1400.0, 560.0, 1485.0, 1370.0, 1440.0, 500.0, 1150.0, 1450.0, 1410.0, 290.0, 950.0, 2180.0, 970.0, 990.0, 790.0, 1210.0, 820.0, 530.0, 1470.0, 1305.0, 1250.0, 690.0, 1360.0, 1295.0, 500.0, 1310.0, 1230.0, 1505.0, 1315.0, 1350.0, 1845.0, 1370.0, 1540.0, 1820.0, 1010.0, 1240.0, 1110.0, 1290.0, 850.0, 440.0, 1725.0, 1490.0, 590.0, 320.0, 1210.0, 1155.0, 940.0, 820.0, 1170.0, 1090.0, 1055.0, 1475.0, 910.0, 1235.0, 980.0, 1485.0, 1395.0, 1890.0, 1380.0, 1080.0, 1180.0, 1530.0, 1210.0, 1900.0, 1330.0, 1190.0, 1940.0, 1550.0, 1780.0, 1230.0, 1650.0, 1055.0, 1275.0, 1130.0, 490.0, 730.0, 1030.0, 760.0, 1740.0, 1180.0, 1315.0, 790.0, 1080.0, 2300.0, 1840.0, 1860.0, 1315.0, 1520.0, 1405.0, 1425.0, 855.0, 1220.0, 745.0, 1045.0, 1330.0, 1090.0, 1310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [270.0, 230.0, 200.0, 30.0, 140.0, -200.0, 240.0, -110.0, 90.0, 60.0, 10.0, 140.0, 130.0, 290.0, 15.0, 5.0, 110.0, 20.0, 20.0, -5.0, 150.0, 100.0, 120.0, 50.0, 350.0, 240.0, 120.0, 80.0, 100.0, 430.0, 100.0, 40.0, 200.0, 130.0, 250.0, 270.0, 100.0, 100.0, 60.0, 150.0, 30.0, 70.0, 50.0, 10.0, 260.0, 100.0, 10.0, 10.0, 10.0, 10.0, 70.0, 100.0, 250.0, 240.0, 140.0, 470.0, 25.0, 30.0, 10.0, 150.0, 50.0, 30.0, 360.0, 60.0, 190.0, 110.0, 200.0, 40.0, 60.0, 270.0, 190.0, 620.0, 40.0, 120.0, 50.0, 120.0, 20.0, 0.0, 60.0, 220.0, 20.0, 60.0, 320.0, 0.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 60.0, 300.0, 60.0, 20.0, 120.0, 190.0, 90.0, 10.0, 170.0, 130.0, 20.0, 110.0, 320.0, 20.0, 190.0, 100.0, 60.0, 40.0, 150.0, 440.0, 80.0, 60.0, 300.0, 130.0, 20.0, 90.0, 310.0, 200.0, 90.0, 130.0, 40.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 140.0, 10.0, 30.0, 10.0, 10.0, 300.0, 450.0, 40.0, -10.0, 40.0, 50.0, 30.0, 30.0, 120.0, 410.0, 520.0, 250.0, 60.0, 210.0, 130.0, 360.0, 30.0, 90.0, 150.0, 50.0, 80.0, 0.0, 300.0, 20.0, 150.0, 10.0, 60.0, 150.0, 10.0, 80.0, 300.0, 190.0, 90.0, 70.0, 50.0, 90.0, -50.0, 160.0, 0.0, 140.0, 0.0, 30.0, 130.0, 360.0, 0.0, 20.0, 20.0, 90.0, 160.0, 40.0, -80.0, 210.0, 40.0, 560.0, 30.0, 120.0, -40.0, 170.0, 90.0, 30.0, 160.0, 10.0, 30.0, 50.0, 40.0, 60.0, 20.0, 330.0, 10.0, 40.0, 110.0, 270.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, -10.0, 330.0, 160.0, 210.0, 110.0, 320.0, 40.0, 80.0, 220.0, 390.0, 390.0, 50.0, -35.0, -190.0, 440.0, 240.0, 50.0, 20.0, -50.0, 140.0, 100.0, -60.0, 190.0, 310.0, 80.0, 110.0, 20.0, 110.0, 250.0, 100.0, 60.0, 40.0, 20.0, 130.0, 10.0, 50.0, 220.0, 60.0, 0.0, 90.0, 70.0, 80.0, 350.0, 20.0, 290.0, 50.0, 390.0, 110.0, -90.0, 5.0, 60.0, 100.0, 40.0, 10.0, 50.0, 550.0, 320.0, 20.0, 140.0, 200.0, 0.0, 10.0, 110.0, 10.0, 20.0, 20.0, 30.0, 30.0, 70.0, 110.0, 70.0, 100.0, 350.0, 70.0, 100.0, 100.0, 40.0, 390.0, -20.0, 20.0, 80.0, 120.0, 220.0, 40.0, 90.0, 30.0, 180.0, 90.0, 360.0, 90.0, 40.0, 150.0, 140.0, 280.0, 80.0, 130.0, 255.0, 250.0, 90.0, 40.0, 15.0, 170.0, 30.0, 350.0, 230.0, 30.0, 240.0, 90.0, 120.0, 90.0, 50.0, 40.0, 60.0, 380.0, -30.0, 40.0, 320.0, 130.0, 270.0, 100.0, 125.0, 60.0, 760.0, 70.0, 110.0, 190.0, -30.0, 160.0, 300.0, 40.0, 30.0, 220.0, 30.0, 30.0, 160.0, 440.0, 350.0, 40.0, 30.0, 100.0, 140.0, 340.0, 80.0, 40.0, 180.0, 160.0, 430.0, 70.0, 0.0, 40.0, -30.0, 140.0, 80.0, 420.0, 200.0, 110.0, 550.0, 110.0, 200.0, -25.0, 230.0, 110.0, 160.0, 65.0, 270.0, 140.0, 15.0, 100.0, -55.0, 300.0, 190.0, 70.0, 190.0, 40.0, 70.0, 50.0, 0.0, 280.0, 50.0, -10.0, 70.0, 210.0, 30.0, 80.0, 50.0, 240.0, 50.0, 320.0, 70.0, 110.0, 130.0, 70.0, 90.0, 70.0, 40.0, 100.0, 340.0, 60.0, 280.0, 270.0, 0.0, 40.0, 10.0, 60.0, 50.0, 380.0, 0.0, 30.0, 10.0, 60.0, 50.0, -40.0, 10.0, 140.0, 10.0, 110.0, 10.0, 0.0, 90.0, 55.0, 190.0, 695.0, 210.0, 10.0, 190.0, 150.0, 15.0, 120.0, 90.0, 400.0, 340.0, 70.0, 0.0, 70.0, 40.0, 40.0, 180.0, 330.0, 20.0, 10.0, 110.0, 150.0, 30.0, 30.0, 20.0, 0.0, 110.0, 100.0, 30.0, 70.0, 20.0, 40.0, 10.0, 30.0, 70.0, 0.0, 20.0, 60.0, 0.0, 150.0, 10.0, 180.0, 270.0, 140.0, 60.0, 50.0, 60.0, 90.0, 200.0, 15.0, 60.0, 100.0, 70.0, 60.0, 130.0, 30.0, 90.0, 340.0, 260.0, 140.0, 60.0, 80.0, 20.0, 50.0, 50.0, 320.0, 110.0, 100.0, 10.0, 220.0, 150.0, 140.0, 50.0, 20.0, 60.0, 20.0, 110.0, 40.0, 10.0, 100.0, 20.0, 20.0, 280.0, 440.0, 90.0, 60.0, 10.0, 30.0, 120.0, 80.0, -50.0, 70.0, -60.0, 30.0, 640.0, 170.0, 50.0, 130.0, 30.0, 110.0, 60.0, 20.0, 690.0, 60.0, 60.0, -40.0, 0.0, 90.0, 5.0, 50.0, 80.0, 215.0, 350.0, 30.0, 160.0, 190.0, 170.0, 30.0, 200.0, 80.0, 50.0, 70.0, 20.0, 40.0, 40.0, 10.0, 180.0, 120.0, 300.0, 340.0, -15.0, 190.0, 230.0, 80.0, 210.0, 50.0, 40.0, 50.0, 60.0, 80.0, -20.0, 680.0, 20.0, 90.0, 90.0, 40.0, 30.0, 220.0, -250.0, 230.0, 10.0, 80.0, 320.0, 70.0, 45.0, 100.0, 170.0, 90.0, 370.0, 200.0, 130.0, 0.0, 210.0, 115.0, 150.0, 70.0, 40.0, 340.0, 140.0, 190.0, -50.0, 310.0, 60.0, 180.0, 300.0, 90.0, 530.0, 160.0, 120.0, 180.0, 100.0, 10.0, 180.0, 30.0, 610.0, 80.0, 100.0, 50.0, 40.0, 60.0, 120.0, 60.0, 20.0, 10.0, 210.0, 220.0, 110.0, 40.0, 230.0, 30.0, 570.0, 30.0, 90.0, 140.0, 50.0, 60.0, 110.0, 40.0, 60.0, 20.0, 70.0, 310.0, 340.0, 50.0, 0.0, 120.0, 330.0, 150.0, 140.0, 480.0, 40.0, 30.0, -10.0, -110.0, 10.0, 350.0, 160.0, 210.0, 50.0, 240.0, 30.0, 280.0, 260.0, 70.0, 480.0, 10.0, 190.0, 90.0, 250.0, 100.0, 190.0, 130.0, 60.0, 190.0, 130.0, 120.0, 90.0, 290.0, 30.0, 750.0, 100.0, 120.0, 140.0, -630.0, 80.0, 330.0, 50.0, 110.0, 140.0, 180.0, 700.0, 40.0, 100.0, 70.0, 450.0, 80.0, 70.0, 140.0, 110.0, 50.0, 40.0, 110.0, 110.0, 700.0, 210.0, 80.0, 80.0, 100.0, 70.0, 260.0, 270.0, 170.0, 90.0, 120.0, 100.0, 220.0, 40.0, 150.0, 360.0, 80.0, 110.0, 210.0, 20.0, 60.0, 330.0, 60.0, 110.0, 80.0, 170.0, 430.0, -100.0, 60.0, 50.0, 220.0, 450.0, 320.0, 100.0, 50.0, 70.0, 50.0, 310.0, 10.0, 5.0, 230.0, 300.0, 50.0, 70.0, 0.0, 30.0, 90.0, 120.0, 80.0, 70.0, 5.0, 320.0, 40.0, 460.0, 20.0, 70.0, 340.0, 190.0, 30.0, 90.0, 60.0, 150.0, 100.0, 40.0, -20.0, 150.0, 40.0, 190.0, 10.0, 80.0, 20.0, 0.0, 50.0, 0.0, 70.0, 30.0, 180.0, 130.0, 180.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 0.0, 80.0, 190.0, -10.0, 20.0, 110.0, 240.0, 120.0, -80.0, 60.0, 300.0, 250.0, 90.0, 10.0, 220.0, 120.0, 80.0, -100.0, 50.0, 30.0, 10.0, 90.0, 520.0, 80.0, 500.0, 70.0, 50.0, 40.0, 20.0, 70.0, 300.0, 20.0, 100.0, 140.0, 150.0, 50.0, 140.0, 50.0, 190.0, 290.0, 50.0, 100.0, 150.0, 330.0, 170.0, 50.0, 20.0, 75.0, 10.0, 60.0, 350.0, 45.0, 130.0, 90.0, 50.0, 380.0, 55.0, 5.0, 10.0, 10.0, 15.0, 140.0, 90.0, 30.0, 40.0, 110.0, 110.0, 250.0, 80.0, 210.0, 20.0, 750.0, 350.0, 100.0, 110.0, 60.0, 170.0, 240.0, 420.0, 50.0, 50.0, 530.0, 20.0, 0.0, 130.0, 10.0, 280.0, 200.0, 290.0, 210.0, 170.0, 330.0, 190.0, 200.0, 350.0, 0.0, 70.0, 230.0, 40.0, 110.0, 340.0, 70.0, 75.0, 80.0, 80.0, 210.0, 420.0, 100.0, 270.0, 20.0, -10.0, 60.0, 110.0, 60.0, 210.0, 10.0, 390.0, 140.0, 10.0, 550.0, -20.0, 310.0, 140.0, 40.0, 60.0, 25.0, 20.0, 80.0, 210.0, 250.0, 270.0, 280.0, -310.0, 510.0, 180.0, 15.0, 30.0, 350.0, 130.0, 110.0, 130.0, 140.0, 40.0, -5.0, 170.0, 10.0, 380.0, 50.0, 0.0, 10.0, 60.0, 60.0, 80.0, 310.0, 60.0, 90.0, 230.0, 270.0, 30.0, 80.0, 10.0, 40.0, 60.0, 40.0, 10.0, 220.0, 40.0, 235.0, 60.0, 80.0, -40.0, 30.0, 260.0, -5.0, 240.0, 10.0, 90.0, 50.0, 30.0, 290.0, 50.0, 310.0, 30.0, 20.0, 30.0, 220.0, 60.0, 100.0, 300.0, 180.0, 80.0, 190.0, 40.0, 50.0, 290.0, 150.0, 20.0, 0.0, 150.0, 170.0, 30.0, 190.0, 70.0, 280.0, 290.0, 180.0, 100.0, 10.0, 90.0, 60.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.656636062208101, "mean_inference_ms": 1.502704828909699, "mean_action_processing_ms": 0.42356002688218775, "mean_env_wait_ms": 1.3489039244008247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012976884841918945, "StateBufferConnector_ms": 0.010149002075195312, "ViewRequirementAgentConnector_ms": 0.39943742752075195}, "num_episodes": 18, "episode_return_max": 2300.0, "episode_return_min": 290.0, "episode_return_mean": 1217.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.150729032339978, "num_env_steps_trained_throughput_per_sec": 19.150729032339978, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 5840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5840000, "timers": {"training_iteration_time_ms": 208909.087, "restore_workers_time_ms": 0.011, "training_step_time_ms": 208909.044, "sample_time_ms": 2687.722, "learn_time_ms": 206200.513, "learn_throughput": 19.399, "synch_weights_time_ms": 11.892}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "done": false, "training_iteration": 146, "trial_id": "aa996_00000", "date": "2024-05-24_07-13-34", "timestamp": 1716549214, "time_this_iter_s": 208.88397908210754, "time_total_s": 30479.357550144196, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x1600addc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30479.357550144196, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 27.02237288135593, "ram_util_percent": 79.39661016949152}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.621615515527126, "cur_kl_coeff": 42.1328011009755, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.519862055092955, "policy_loss": -0.0012402302010780294, "vf_loss": 7.518339475859214, "vf_explained_var": 0.0005061903319800624, "kl": 6.55739071796335e-05, "entropy": 0.2554606886241383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1375635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "env_runners": {"episode_reward_max": 2300.0, "episode_reward_min": 320.0, "episode_reward_mean": 1241.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 124.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1210.0, 820.0, 530.0, 1470.0, 1305.0, 1250.0, 690.0, 1360.0, 1295.0, 500.0, 1310.0, 1230.0, 1505.0, 1315.0, 1350.0, 1845.0, 1370.0, 1540.0, 1820.0, 1010.0, 1240.0, 1110.0, 1290.0, 850.0, 440.0, 1725.0, 1490.0, 590.0, 320.0, 1210.0, 1155.0, 940.0, 820.0, 1170.0, 1090.0, 1055.0, 1475.0, 910.0, 1235.0, 980.0, 1485.0, 1395.0, 1890.0, 1380.0, 1080.0, 1180.0, 1530.0, 1210.0, 1900.0, 1330.0, 1190.0, 1940.0, 1550.0, 1780.0, 1230.0, 1650.0, 1055.0, 1275.0, 1130.0, 490.0, 730.0, 1030.0, 760.0, 1740.0, 1180.0, 1315.0, 790.0, 1080.0, 2300.0, 1840.0, 1860.0, 1315.0, 1520.0, 1405.0, 1425.0, 855.0, 1220.0, 745.0, 1045.0, 1330.0, 1090.0, 1310.0, 1030.0, 1430.0, 1370.0, 1350.0, 1700.0, 1080.0, 1420.0, 1280.0, 1110.0, 1480.0, 1250.0, 1125.0, 1080.0, 960.0, 835.0, 1175.0, 1600.0, 1540.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [160.0, 40.0, -80.0, 210.0, 40.0, 560.0, 30.0, 120.0, -40.0, 170.0, 90.0, 30.0, 160.0, 10.0, 30.0, 50.0, 40.0, 60.0, 20.0, 330.0, 10.0, 40.0, 110.0, 270.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, -10.0, 330.0, 160.0, 210.0, 110.0, 320.0, 40.0, 80.0, 220.0, 390.0, 390.0, 50.0, -35.0, -190.0, 440.0, 240.0, 50.0, 20.0, -50.0, 140.0, 100.0, -60.0, 190.0, 310.0, 80.0, 110.0, 20.0, 110.0, 250.0, 100.0, 60.0, 40.0, 20.0, 130.0, 10.0, 50.0, 220.0, 60.0, 0.0, 90.0, 70.0, 80.0, 350.0, 20.0, 290.0, 50.0, 390.0, 110.0, -90.0, 5.0, 60.0, 100.0, 40.0, 10.0, 50.0, 550.0, 320.0, 20.0, 140.0, 200.0, 0.0, 10.0, 110.0, 10.0, 20.0, 20.0, 30.0, 30.0, 70.0, 110.0, 70.0, 100.0, 350.0, 70.0, 100.0, 100.0, 40.0, 390.0, -20.0, 20.0, 80.0, 120.0, 220.0, 40.0, 90.0, 30.0, 180.0, 90.0, 360.0, 90.0, 40.0, 150.0, 140.0, 280.0, 80.0, 130.0, 255.0, 250.0, 90.0, 40.0, 15.0, 170.0, 30.0, 350.0, 230.0, 30.0, 240.0, 90.0, 120.0, 90.0, 50.0, 40.0, 60.0, 380.0, -30.0, 40.0, 320.0, 130.0, 270.0, 100.0, 125.0, 60.0, 760.0, 70.0, 110.0, 190.0, -30.0, 160.0, 300.0, 40.0, 30.0, 220.0, 30.0, 30.0, 160.0, 440.0, 350.0, 40.0, 30.0, 100.0, 140.0, 340.0, 80.0, 40.0, 180.0, 160.0, 430.0, 70.0, 0.0, 40.0, -30.0, 140.0, 80.0, 420.0, 200.0, 110.0, 550.0, 110.0, 200.0, -25.0, 230.0, 110.0, 160.0, 65.0, 270.0, 140.0, 15.0, 100.0, -55.0, 300.0, 190.0, 70.0, 190.0, 40.0, 70.0, 50.0, 0.0, 280.0, 50.0, -10.0, 70.0, 210.0, 30.0, 80.0, 50.0, 240.0, 50.0, 320.0, 70.0, 110.0, 130.0, 70.0, 90.0, 70.0, 40.0, 100.0, 340.0, 60.0, 280.0, 270.0, 0.0, 40.0, 10.0, 60.0, 50.0, 380.0, 0.0, 30.0, 10.0, 60.0, 50.0, -40.0, 10.0, 140.0, 10.0, 110.0, 10.0, 0.0, 90.0, 55.0, 190.0, 695.0, 210.0, 10.0, 190.0, 150.0, 15.0, 120.0, 90.0, 400.0, 340.0, 70.0, 0.0, 70.0, 40.0, 40.0, 180.0, 330.0, 20.0, 10.0, 110.0, 150.0, 30.0, 30.0, 20.0, 0.0, 110.0, 100.0, 30.0, 70.0, 20.0, 40.0, 10.0, 30.0, 70.0, 0.0, 20.0, 60.0, 0.0, 150.0, 10.0, 180.0, 270.0, 140.0, 60.0, 50.0, 60.0, 90.0, 200.0, 15.0, 60.0, 100.0, 70.0, 60.0, 130.0, 30.0, 90.0, 340.0, 260.0, 140.0, 60.0, 80.0, 20.0, 50.0, 50.0, 320.0, 110.0, 100.0, 10.0, 220.0, 150.0, 140.0, 50.0, 20.0, 60.0, 20.0, 110.0, 40.0, 10.0, 100.0, 20.0, 20.0, 280.0, 440.0, 90.0, 60.0, 10.0, 30.0, 120.0, 80.0, -50.0, 70.0, -60.0, 30.0, 640.0, 170.0, 50.0, 130.0, 30.0, 110.0, 60.0, 20.0, 690.0, 60.0, 60.0, -40.0, 0.0, 90.0, 5.0, 50.0, 80.0, 215.0, 350.0, 30.0, 160.0, 190.0, 170.0, 30.0, 200.0, 80.0, 50.0, 70.0, 20.0, 40.0, 40.0, 10.0, 180.0, 120.0, 300.0, 340.0, -15.0, 190.0, 230.0, 80.0, 210.0, 50.0, 40.0, 50.0, 60.0, 80.0, -20.0, 680.0, 20.0, 90.0, 90.0, 40.0, 30.0, 220.0, -250.0, 230.0, 10.0, 80.0, 320.0, 70.0, 45.0, 100.0, 170.0, 90.0, 370.0, 200.0, 130.0, 0.0, 210.0, 115.0, 150.0, 70.0, 40.0, 340.0, 140.0, 190.0, -50.0, 310.0, 60.0, 180.0, 300.0, 90.0, 530.0, 160.0, 120.0, 180.0, 100.0, 10.0, 180.0, 30.0, 610.0, 80.0, 100.0, 50.0, 40.0, 60.0, 120.0, 60.0, 20.0, 10.0, 210.0, 220.0, 110.0, 40.0, 230.0, 30.0, 570.0, 30.0, 90.0, 140.0, 50.0, 60.0, 110.0, 40.0, 60.0, 20.0, 70.0, 310.0, 340.0, 50.0, 0.0, 120.0, 330.0, 150.0, 140.0, 480.0, 40.0, 30.0, -10.0, -110.0, 10.0, 350.0, 160.0, 210.0, 50.0, 240.0, 30.0, 280.0, 260.0, 70.0, 480.0, 10.0, 190.0, 90.0, 250.0, 100.0, 190.0, 130.0, 60.0, 190.0, 130.0, 120.0, 90.0, 290.0, 30.0, 750.0, 100.0, 120.0, 140.0, -630.0, 80.0, 330.0, 50.0, 110.0, 140.0, 180.0, 700.0, 40.0, 100.0, 70.0, 450.0, 80.0, 70.0, 140.0, 110.0, 50.0, 40.0, 110.0, 110.0, 700.0, 210.0, 80.0, 80.0, 100.0, 70.0, 260.0, 270.0, 170.0, 90.0, 120.0, 100.0, 220.0, 40.0, 150.0, 360.0, 80.0, 110.0, 210.0, 20.0, 60.0, 330.0, 60.0, 110.0, 80.0, 170.0, 430.0, -100.0, 60.0, 50.0, 220.0, 450.0, 320.0, 100.0, 50.0, 70.0, 50.0, 310.0, 10.0, 5.0, 230.0, 300.0, 50.0, 70.0, 0.0, 30.0, 90.0, 120.0, 80.0, 70.0, 5.0, 320.0, 40.0, 460.0, 20.0, 70.0, 340.0, 190.0, 30.0, 90.0, 60.0, 150.0, 100.0, 40.0, -20.0, 150.0, 40.0, 190.0, 10.0, 80.0, 20.0, 0.0, 50.0, 0.0, 70.0, 30.0, 180.0, 130.0, 180.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 0.0, 80.0, 190.0, -10.0, 20.0, 110.0, 240.0, 120.0, -80.0, 60.0, 300.0, 250.0, 90.0, 10.0, 220.0, 120.0, 80.0, -100.0, 50.0, 30.0, 10.0, 90.0, 520.0, 80.0, 500.0, 70.0, 50.0, 40.0, 20.0, 70.0, 300.0, 20.0, 100.0, 140.0, 150.0, 50.0, 140.0, 50.0, 190.0, 290.0, 50.0, 100.0, 150.0, 330.0, 170.0, 50.0, 20.0, 75.0, 10.0, 60.0, 350.0, 45.0, 130.0, 90.0, 50.0, 380.0, 55.0, 5.0, 10.0, 10.0, 15.0, 140.0, 90.0, 30.0, 40.0, 110.0, 110.0, 250.0, 80.0, 210.0, 20.0, 750.0, 350.0, 100.0, 110.0, 60.0, 170.0, 240.0, 420.0, 50.0, 50.0, 530.0, 20.0, 0.0, 130.0, 10.0, 280.0, 200.0, 290.0, 210.0, 170.0, 330.0, 190.0, 200.0, 350.0, 0.0, 70.0, 230.0, 40.0, 110.0, 340.0, 70.0, 75.0, 80.0, 80.0, 210.0, 420.0, 100.0, 270.0, 20.0, -10.0, 60.0, 110.0, 60.0, 210.0, 10.0, 390.0, 140.0, 10.0, 550.0, -20.0, 310.0, 140.0, 40.0, 60.0, 25.0, 20.0, 80.0, 210.0, 250.0, 270.0, 280.0, -310.0, 510.0, 180.0, 15.0, 30.0, 350.0, 130.0, 110.0, 130.0, 140.0, 40.0, -5.0, 170.0, 10.0, 380.0, 50.0, 0.0, 10.0, 60.0, 60.0, 80.0, 310.0, 60.0, 90.0, 230.0, 270.0, 30.0, 80.0, 10.0, 40.0, 60.0, 40.0, 10.0, 220.0, 40.0, 235.0, 60.0, 80.0, -40.0, 30.0, 260.0, -5.0, 240.0, 10.0, 90.0, 50.0, 30.0, 290.0, 50.0, 310.0, 30.0, 20.0, 30.0, 220.0, 60.0, 100.0, 300.0, 180.0, 80.0, 190.0, 40.0, 50.0, 290.0, 150.0, 20.0, 0.0, 150.0, 170.0, 30.0, 190.0, 70.0, 280.0, 290.0, 180.0, 100.0, 10.0, 90.0, 60.0, 40.0, 70.0, 150.0, 350.0, 40.0, 100.0, 70.0, -50.0, 110.0, 180.0, 10.0, 70.0, 130.0, 170.0, 130.0, 310.0, 300.0, 40.0, 180.0, 120.0, -20.0, 80.0, 180.0, 50.0, -30.0, 280.0, 0.0, 130.0, 80.0, 300.0, 300.0, 170.0, 30.0, 430.0, 60.0, 110.0, 0.0, 70.0, 340.0, 110.0, 30.0, 90.0, 80.0, 590.0, 50.0, 180.0, 60.0, 160.0, 380.0, 90.0, 20.0, 60.0, 130.0, 160.0, -40.0, 50.0, 460.0, -140.0, 180.0, 60.0, 160.0, -90.0, 80.0, 40.0, 610.0, 250.0, 110.0, 140.0, 120.0, -30.0, 190.0, 340.0, 90.0, 120.0, 30.0, 370.0, 20.0, -20.0, 110.0, -130.0, 350.0, 50.0, 50.0, 150.0, 70.0, 100.0, 450.0, 30.0, 100.0, 80.0, 30.0, 30.0, 30.0, 20.0, 350.0, 80.0, 510.0, 20.0, 150.0, 270.0, 20.0, 50.0, 210.0, 130.0, 310.0, 110.0, 30.0, 120.0, 180.0, 90.0, 20.0, 90.0, 550.0, 70.0, 210.0, -15.0, 30.0, 90.0, 30.0, 40.0, 30.0, 120.0, 210.0, 40.0, 20.0, 30.0, 90.0, 230.0, 160.0, 90.0, 90.0, 190.0, 100.0, 10.0, 40.0, 40.0, 100.0, 30.0, 10.0, 90.0, 350.0, 120.0, 0.0, 10.0, 130.0, 20.0, 110.0, 50.0, 110.0, 110.0, 175.0, 100.0, 210.0, 30.0, 100.0, 30.0, 30.0, 30.0, 100.0, -15.0, 560.0, 350.0, 130.0, 170.0, 160.0, 340.0, 50.0, 50.0, 40.0, 70.0, 240.0, 230.0, 100.0, 80.0, 60.0, 80.0, 180.0, 40.0, 350.0, 330.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6565555594473917, "mean_inference_ms": 1.5028233754581697, "mean_action_processing_ms": 0.4235228050080782, "mean_env_wait_ms": 1.3490091856677413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012834310531616211, "StateBufferConnector_ms": 0.010007381439208984, "ViewRequirementAgentConnector_ms": 0.39685940742492676}, "num_episodes": 18, "episode_return_max": 2300.0, "episode_return_min": 320.0, "episode_return_mean": 1241.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.053527107878097, "num_env_steps_trained_throughput_per_sec": 19.053527107878097, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 5880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5880000, "timers": {"training_iteration_time_ms": 209018.52, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209018.478, "sample_time_ms": 2661.126, "learn_time_ms": 206336.73, "learn_throughput": 19.386, "synch_weights_time_ms": 11.739}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "done": false, "training_iteration": 147, "trial_id": "aa996_00000", "date": "2024-05-24_07-17-04", "timestamp": 1716549424, "time_this_iter_s": 209.94595980644226, "time_total_s": 30689.303509950638, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b23a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30689.303509950638, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 27.69461279461279, "ram_util_percent": 79.07912457912458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6836956753136634, "cur_kl_coeff": 21.06640055048775, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0019868941398642967, "vf_loss": 7.394728599087245, "vf_explained_var": -2.8848908325861563e-05, "kl": Infinity, "entropy": 0.26567645957643865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1385025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "env_runners": {"episode_reward_max": 2300.0, "episode_reward_min": 320.0, "episode_reward_mean": 1248.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 124.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1820.0, 1010.0, 1240.0, 1110.0, 1290.0, 850.0, 440.0, 1725.0, 1490.0, 590.0, 320.0, 1210.0, 1155.0, 940.0, 820.0, 1170.0, 1090.0, 1055.0, 1475.0, 910.0, 1235.0, 980.0, 1485.0, 1395.0, 1890.0, 1380.0, 1080.0, 1180.0, 1530.0, 1210.0, 1900.0, 1330.0, 1190.0, 1940.0, 1550.0, 1780.0, 1230.0, 1650.0, 1055.0, 1275.0, 1130.0, 490.0, 730.0, 1030.0, 760.0, 1740.0, 1180.0, 1315.0, 790.0, 1080.0, 2300.0, 1840.0, 1860.0, 1315.0, 1520.0, 1405.0, 1425.0, 855.0, 1220.0, 745.0, 1045.0, 1330.0, 1090.0, 1310.0, 1030.0, 1430.0, 1370.0, 1350.0, 1700.0, 1080.0, 1420.0, 1280.0, 1110.0, 1480.0, 1250.0, 1125.0, 1080.0, 960.0, 835.0, 1175.0, 1600.0, 1540.0, 775.0, 1440.0, 390.0, 1470.0, 1460.0, 950.0, 1195.0, 1505.0, 1315.0, 1290.0, 1510.0, 1320.0, 1410.0, 1540.0, 1560.0, 935.0, 1140.0, 1320.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, -30.0, 140.0, 80.0, 420.0, 200.0, 110.0, 550.0, 110.0, 200.0, -25.0, 230.0, 110.0, 160.0, 65.0, 270.0, 140.0, 15.0, 100.0, -55.0, 300.0, 190.0, 70.0, 190.0, 40.0, 70.0, 50.0, 0.0, 280.0, 50.0, -10.0, 70.0, 210.0, 30.0, 80.0, 50.0, 240.0, 50.0, 320.0, 70.0, 110.0, 130.0, 70.0, 90.0, 70.0, 40.0, 100.0, 340.0, 60.0, 280.0, 270.0, 0.0, 40.0, 10.0, 60.0, 50.0, 380.0, 0.0, 30.0, 10.0, 60.0, 50.0, -40.0, 10.0, 140.0, 10.0, 110.0, 10.0, 0.0, 90.0, 55.0, 190.0, 695.0, 210.0, 10.0, 190.0, 150.0, 15.0, 120.0, 90.0, 400.0, 340.0, 70.0, 0.0, 70.0, 40.0, 40.0, 180.0, 330.0, 20.0, 10.0, 110.0, 150.0, 30.0, 30.0, 20.0, 0.0, 110.0, 100.0, 30.0, 70.0, 20.0, 40.0, 10.0, 30.0, 70.0, 0.0, 20.0, 60.0, 0.0, 150.0, 10.0, 180.0, 270.0, 140.0, 60.0, 50.0, 60.0, 90.0, 200.0, 15.0, 60.0, 100.0, 70.0, 60.0, 130.0, 30.0, 90.0, 340.0, 260.0, 140.0, 60.0, 80.0, 20.0, 50.0, 50.0, 320.0, 110.0, 100.0, 10.0, 220.0, 150.0, 140.0, 50.0, 20.0, 60.0, 20.0, 110.0, 40.0, 10.0, 100.0, 20.0, 20.0, 280.0, 440.0, 90.0, 60.0, 10.0, 30.0, 120.0, 80.0, -50.0, 70.0, -60.0, 30.0, 640.0, 170.0, 50.0, 130.0, 30.0, 110.0, 60.0, 20.0, 690.0, 60.0, 60.0, -40.0, 0.0, 90.0, 5.0, 50.0, 80.0, 215.0, 350.0, 30.0, 160.0, 190.0, 170.0, 30.0, 200.0, 80.0, 50.0, 70.0, 20.0, 40.0, 40.0, 10.0, 180.0, 120.0, 300.0, 340.0, -15.0, 190.0, 230.0, 80.0, 210.0, 50.0, 40.0, 50.0, 60.0, 80.0, -20.0, 680.0, 20.0, 90.0, 90.0, 40.0, 30.0, 220.0, -250.0, 230.0, 10.0, 80.0, 320.0, 70.0, 45.0, 100.0, 170.0, 90.0, 370.0, 200.0, 130.0, 0.0, 210.0, 115.0, 150.0, 70.0, 40.0, 340.0, 140.0, 190.0, -50.0, 310.0, 60.0, 180.0, 300.0, 90.0, 530.0, 160.0, 120.0, 180.0, 100.0, 10.0, 180.0, 30.0, 610.0, 80.0, 100.0, 50.0, 40.0, 60.0, 120.0, 60.0, 20.0, 10.0, 210.0, 220.0, 110.0, 40.0, 230.0, 30.0, 570.0, 30.0, 90.0, 140.0, 50.0, 60.0, 110.0, 40.0, 60.0, 20.0, 70.0, 310.0, 340.0, 50.0, 0.0, 120.0, 330.0, 150.0, 140.0, 480.0, 40.0, 30.0, -10.0, -110.0, 10.0, 350.0, 160.0, 210.0, 50.0, 240.0, 30.0, 280.0, 260.0, 70.0, 480.0, 10.0, 190.0, 90.0, 250.0, 100.0, 190.0, 130.0, 60.0, 190.0, 130.0, 120.0, 90.0, 290.0, 30.0, 750.0, 100.0, 120.0, 140.0, -630.0, 80.0, 330.0, 50.0, 110.0, 140.0, 180.0, 700.0, 40.0, 100.0, 70.0, 450.0, 80.0, 70.0, 140.0, 110.0, 50.0, 40.0, 110.0, 110.0, 700.0, 210.0, 80.0, 80.0, 100.0, 70.0, 260.0, 270.0, 170.0, 90.0, 120.0, 100.0, 220.0, 40.0, 150.0, 360.0, 80.0, 110.0, 210.0, 20.0, 60.0, 330.0, 60.0, 110.0, 80.0, 170.0, 430.0, -100.0, 60.0, 50.0, 220.0, 450.0, 320.0, 100.0, 50.0, 70.0, 50.0, 310.0, 10.0, 5.0, 230.0, 300.0, 50.0, 70.0, 0.0, 30.0, 90.0, 120.0, 80.0, 70.0, 5.0, 320.0, 40.0, 460.0, 20.0, 70.0, 340.0, 190.0, 30.0, 90.0, 60.0, 150.0, 100.0, 40.0, -20.0, 150.0, 40.0, 190.0, 10.0, 80.0, 20.0, 0.0, 50.0, 0.0, 70.0, 30.0, 180.0, 130.0, 180.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 0.0, 80.0, 190.0, -10.0, 20.0, 110.0, 240.0, 120.0, -80.0, 60.0, 300.0, 250.0, 90.0, 10.0, 220.0, 120.0, 80.0, -100.0, 50.0, 30.0, 10.0, 90.0, 520.0, 80.0, 500.0, 70.0, 50.0, 40.0, 20.0, 70.0, 300.0, 20.0, 100.0, 140.0, 150.0, 50.0, 140.0, 50.0, 190.0, 290.0, 50.0, 100.0, 150.0, 330.0, 170.0, 50.0, 20.0, 75.0, 10.0, 60.0, 350.0, 45.0, 130.0, 90.0, 50.0, 380.0, 55.0, 5.0, 10.0, 10.0, 15.0, 140.0, 90.0, 30.0, 40.0, 110.0, 110.0, 250.0, 80.0, 210.0, 20.0, 750.0, 350.0, 100.0, 110.0, 60.0, 170.0, 240.0, 420.0, 50.0, 50.0, 530.0, 20.0, 0.0, 130.0, 10.0, 280.0, 200.0, 290.0, 210.0, 170.0, 330.0, 190.0, 200.0, 350.0, 0.0, 70.0, 230.0, 40.0, 110.0, 340.0, 70.0, 75.0, 80.0, 80.0, 210.0, 420.0, 100.0, 270.0, 20.0, -10.0, 60.0, 110.0, 60.0, 210.0, 10.0, 390.0, 140.0, 10.0, 550.0, -20.0, 310.0, 140.0, 40.0, 60.0, 25.0, 20.0, 80.0, 210.0, 250.0, 270.0, 280.0, -310.0, 510.0, 180.0, 15.0, 30.0, 350.0, 130.0, 110.0, 130.0, 140.0, 40.0, -5.0, 170.0, 10.0, 380.0, 50.0, 0.0, 10.0, 60.0, 60.0, 80.0, 310.0, 60.0, 90.0, 230.0, 270.0, 30.0, 80.0, 10.0, 40.0, 60.0, 40.0, 10.0, 220.0, 40.0, 235.0, 60.0, 80.0, -40.0, 30.0, 260.0, -5.0, 240.0, 10.0, 90.0, 50.0, 30.0, 290.0, 50.0, 310.0, 30.0, 20.0, 30.0, 220.0, 60.0, 100.0, 300.0, 180.0, 80.0, 190.0, 40.0, 50.0, 290.0, 150.0, 20.0, 0.0, 150.0, 170.0, 30.0, 190.0, 70.0, 280.0, 290.0, 180.0, 100.0, 10.0, 90.0, 60.0, 40.0, 70.0, 150.0, 350.0, 40.0, 100.0, 70.0, -50.0, 110.0, 180.0, 10.0, 70.0, 130.0, 170.0, 130.0, 310.0, 300.0, 40.0, 180.0, 120.0, -20.0, 80.0, 180.0, 50.0, -30.0, 280.0, 0.0, 130.0, 80.0, 300.0, 300.0, 170.0, 30.0, 430.0, 60.0, 110.0, 0.0, 70.0, 340.0, 110.0, 30.0, 90.0, 80.0, 590.0, 50.0, 180.0, 60.0, 160.0, 380.0, 90.0, 20.0, 60.0, 130.0, 160.0, -40.0, 50.0, 460.0, -140.0, 180.0, 60.0, 160.0, -90.0, 80.0, 40.0, 610.0, 250.0, 110.0, 140.0, 120.0, -30.0, 190.0, 340.0, 90.0, 120.0, 30.0, 370.0, 20.0, -20.0, 110.0, -130.0, 350.0, 50.0, 50.0, 150.0, 70.0, 100.0, 450.0, 30.0, 100.0, 80.0, 30.0, 30.0, 30.0, 20.0, 350.0, 80.0, 510.0, 20.0, 150.0, 270.0, 20.0, 50.0, 210.0, 130.0, 310.0, 110.0, 30.0, 120.0, 180.0, 90.0, 20.0, 90.0, 550.0, 70.0, 210.0, -15.0, 30.0, 90.0, 30.0, 40.0, 30.0, 120.0, 210.0, 40.0, 20.0, 30.0, 90.0, 230.0, 160.0, 90.0, 90.0, 190.0, 100.0, 10.0, 40.0, 40.0, 100.0, 30.0, 10.0, 90.0, 350.0, 120.0, 0.0, 10.0, 130.0, 20.0, 110.0, 50.0, 110.0, 110.0, 175.0, 100.0, 210.0, 30.0, 100.0, 30.0, 30.0, 30.0, 100.0, -15.0, 560.0, 350.0, 130.0, 170.0, 160.0, 340.0, 50.0, 50.0, 40.0, 70.0, 240.0, 230.0, 100.0, 80.0, 60.0, 80.0, 180.0, 40.0, 350.0, 330.0, 90.0, 5.0, 0.0, 20.0, 60.0, 140.0, 110.0, 0.0, 400.0, 30.0, 10.0, 120.0, 350.0, 150.0, 80.0, 230.0, 230.0, 210.0, 40.0, 10.0, 20.0, 0.0, 0.0, 20.0, 60.0, 40.0, 0.0, 20.0, 50.0, 20.0, 180.0, 30.0, 90.0, 90.0, 140.0, 60.0, 90.0, 150.0, 190.0, 10.0, 620.0, 40.0, 100.0, 20.0, 750.0, 270.0, 0.0, 30.0, 70.0, 70.0, 110.0, 30.0, 30.0, 50.0, 250.0, 100.0, 10.0, 230.0, 110.0, 100.0, 40.0, 90.0, -15.0, 110.0, 300.0, 50.0, 40.0, 180.0, 320.0, 90.0, 30.0, 45.0, 60.0, 140.0, 70.0, 300.0, 100.0, 190.0, 230.0, 300.0, 70.0, 35.0, 60.0, 150.0, 70.0, 370.0, 10.0, 140.0, 180.0, 100.0, 200.0, 160.0, 40.0, 30.0, 340.0, 10.0, 70.0, 0.0, 260.0, 50.0, 330.0, 30.0, 220.0, 70.0, 60.0, 80.0, 60.0, 60.0, 130.0, 190.0, 610.0, 420.0, -20.0, 50.0, -40.0, 470.0, 10.0, 40.0, 60.0, 160.0, 170.0, 60.0, 50.0, 520.0, 120.0, 80.0, 130.0, 30.0, 160.0, 90.0, 170.0, 20.0, 90.0, 0.0, 270.0, 20.0, 530.0, 120.0, 380.0, 80.0, 30.0, 280.0, 180.0, 450.0, 30.0, 40.0, 120.0, 160.0, 110.0, 110.0, 80.0, 0.0, 160.0, 250.0, 70.0, 65.0, 110.0, 80.0, 180.0, 0.0, 20.0, 260.0, 80.0, 40.0, 170.0, 100.0, 40.0, 190.0, 0.0, 70.0, 190.0, 70.0, 230.0, 640.0, 40.0, 60.0, 40.0, 10.0, 30.0, 10.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6563550332829786, "mean_inference_ms": 1.5028159796360376, "mean_action_processing_ms": 0.4234510656733556, "mean_env_wait_ms": 1.3490219171794668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012967586517333984, "StateBufferConnector_ms": 0.010141611099243164, "ViewRequirementAgentConnector_ms": 0.40756988525390625}, "num_episodes": 18, "episode_return_max": 2300.0, "episode_return_min": 320.0, "episode_return_mean": 1248.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.072450932679043, "num_env_steps_trained_throughput_per_sec": 19.072450932679043, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 5920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5920000, "timers": {"training_iteration_time_ms": 209093.734, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209093.691, "sample_time_ms": 2643.95, "learn_time_ms": 206429.304, "learn_throughput": 19.377, "synch_weights_time_ms": 11.349}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "done": false, "training_iteration": 148, "trial_id": "aa996_00000", "date": "2024-05-24_07-20-33", "timestamp": 1716549633, "time_this_iter_s": 209.7368791103363, "time_total_s": 30899.040389060974, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x160b30b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30899.040389060974, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 27.437710437710436, "ram_util_percent": 80.02390572390571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9362527080364247, "cur_kl_coeff": 31.599600825731628, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.187573305308755, "policy_loss": -0.0014194877143538654, "vf_loss": 8.186418726446783, "vf_explained_var": 0.00012275289041927448, "kl": 8.145860504794829e-05, "entropy": 0.23116287833220533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1394415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "env_runners": {"episode_reward_max": 2300.0, "episode_reward_min": 390.0, "episode_reward_mean": 1300.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 130.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1395.0, 1890.0, 1380.0, 1080.0, 1180.0, 1530.0, 1210.0, 1900.0, 1330.0, 1190.0, 1940.0, 1550.0, 1780.0, 1230.0, 1650.0, 1055.0, 1275.0, 1130.0, 490.0, 730.0, 1030.0, 760.0, 1740.0, 1180.0, 1315.0, 790.0, 1080.0, 2300.0, 1840.0, 1860.0, 1315.0, 1520.0, 1405.0, 1425.0, 855.0, 1220.0, 745.0, 1045.0, 1330.0, 1090.0, 1310.0, 1030.0, 1430.0, 1370.0, 1350.0, 1700.0, 1080.0, 1420.0, 1280.0, 1110.0, 1480.0, 1250.0, 1125.0, 1080.0, 960.0, 835.0, 1175.0, 1600.0, 1540.0, 775.0, 1440.0, 390.0, 1470.0, 1460.0, 950.0, 1195.0, 1505.0, 1315.0, 1290.0, 1510.0, 1320.0, 1410.0, 1540.0, 1560.0, 935.0, 1140.0, 1320.0, 1410.0, 1740.0, 1910.0, 1810.0, 1270.0, 1300.0, 1390.0, 1740.0, 1230.0, 1595.0, 1290.0, 1530.0, 1130.0, 1450.0, 1180.0, 965.0, 1260.0, 1340.0, 540.0, 1170.0, 530.0, 1425.0, 1420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [200.0, 130.0, 0.0, 210.0, 115.0, 150.0, 70.0, 40.0, 340.0, 140.0, 190.0, -50.0, 310.0, 60.0, 180.0, 300.0, 90.0, 530.0, 160.0, 120.0, 180.0, 100.0, 10.0, 180.0, 30.0, 610.0, 80.0, 100.0, 50.0, 40.0, 60.0, 120.0, 60.0, 20.0, 10.0, 210.0, 220.0, 110.0, 40.0, 230.0, 30.0, 570.0, 30.0, 90.0, 140.0, 50.0, 60.0, 110.0, 40.0, 60.0, 20.0, 70.0, 310.0, 340.0, 50.0, 0.0, 120.0, 330.0, 150.0, 140.0, 480.0, 40.0, 30.0, -10.0, -110.0, 10.0, 350.0, 160.0, 210.0, 50.0, 240.0, 30.0, 280.0, 260.0, 70.0, 480.0, 10.0, 190.0, 90.0, 250.0, 100.0, 190.0, 130.0, 60.0, 190.0, 130.0, 120.0, 90.0, 290.0, 30.0, 750.0, 100.0, 120.0, 140.0, -630.0, 80.0, 330.0, 50.0, 110.0, 140.0, 180.0, 700.0, 40.0, 100.0, 70.0, 450.0, 80.0, 70.0, 140.0, 110.0, 50.0, 40.0, 110.0, 110.0, 700.0, 210.0, 80.0, 80.0, 100.0, 70.0, 260.0, 270.0, 170.0, 90.0, 120.0, 100.0, 220.0, 40.0, 150.0, 360.0, 80.0, 110.0, 210.0, 20.0, 60.0, 330.0, 60.0, 110.0, 80.0, 170.0, 430.0, -100.0, 60.0, 50.0, 220.0, 450.0, 320.0, 100.0, 50.0, 70.0, 50.0, 310.0, 10.0, 5.0, 230.0, 300.0, 50.0, 70.0, 0.0, 30.0, 90.0, 120.0, 80.0, 70.0, 5.0, 320.0, 40.0, 460.0, 20.0, 70.0, 340.0, 190.0, 30.0, 90.0, 60.0, 150.0, 100.0, 40.0, -20.0, 150.0, 40.0, 190.0, 10.0, 80.0, 20.0, 0.0, 50.0, 0.0, 70.0, 30.0, 180.0, 130.0, 180.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 0.0, 80.0, 190.0, -10.0, 20.0, 110.0, 240.0, 120.0, -80.0, 60.0, 300.0, 250.0, 90.0, 10.0, 220.0, 120.0, 80.0, -100.0, 50.0, 30.0, 10.0, 90.0, 520.0, 80.0, 500.0, 70.0, 50.0, 40.0, 20.0, 70.0, 300.0, 20.0, 100.0, 140.0, 150.0, 50.0, 140.0, 50.0, 190.0, 290.0, 50.0, 100.0, 150.0, 330.0, 170.0, 50.0, 20.0, 75.0, 10.0, 60.0, 350.0, 45.0, 130.0, 90.0, 50.0, 380.0, 55.0, 5.0, 10.0, 10.0, 15.0, 140.0, 90.0, 30.0, 40.0, 110.0, 110.0, 250.0, 80.0, 210.0, 20.0, 750.0, 350.0, 100.0, 110.0, 60.0, 170.0, 240.0, 420.0, 50.0, 50.0, 530.0, 20.0, 0.0, 130.0, 10.0, 280.0, 200.0, 290.0, 210.0, 170.0, 330.0, 190.0, 200.0, 350.0, 0.0, 70.0, 230.0, 40.0, 110.0, 340.0, 70.0, 75.0, 80.0, 80.0, 210.0, 420.0, 100.0, 270.0, 20.0, -10.0, 60.0, 110.0, 60.0, 210.0, 10.0, 390.0, 140.0, 10.0, 550.0, -20.0, 310.0, 140.0, 40.0, 60.0, 25.0, 20.0, 80.0, 210.0, 250.0, 270.0, 280.0, -310.0, 510.0, 180.0, 15.0, 30.0, 350.0, 130.0, 110.0, 130.0, 140.0, 40.0, -5.0, 170.0, 10.0, 380.0, 50.0, 0.0, 10.0, 60.0, 60.0, 80.0, 310.0, 60.0, 90.0, 230.0, 270.0, 30.0, 80.0, 10.0, 40.0, 60.0, 40.0, 10.0, 220.0, 40.0, 235.0, 60.0, 80.0, -40.0, 30.0, 260.0, -5.0, 240.0, 10.0, 90.0, 50.0, 30.0, 290.0, 50.0, 310.0, 30.0, 20.0, 30.0, 220.0, 60.0, 100.0, 300.0, 180.0, 80.0, 190.0, 40.0, 50.0, 290.0, 150.0, 20.0, 0.0, 150.0, 170.0, 30.0, 190.0, 70.0, 280.0, 290.0, 180.0, 100.0, 10.0, 90.0, 60.0, 40.0, 70.0, 150.0, 350.0, 40.0, 100.0, 70.0, -50.0, 110.0, 180.0, 10.0, 70.0, 130.0, 170.0, 130.0, 310.0, 300.0, 40.0, 180.0, 120.0, -20.0, 80.0, 180.0, 50.0, -30.0, 280.0, 0.0, 130.0, 80.0, 300.0, 300.0, 170.0, 30.0, 430.0, 60.0, 110.0, 0.0, 70.0, 340.0, 110.0, 30.0, 90.0, 80.0, 590.0, 50.0, 180.0, 60.0, 160.0, 380.0, 90.0, 20.0, 60.0, 130.0, 160.0, -40.0, 50.0, 460.0, -140.0, 180.0, 60.0, 160.0, -90.0, 80.0, 40.0, 610.0, 250.0, 110.0, 140.0, 120.0, -30.0, 190.0, 340.0, 90.0, 120.0, 30.0, 370.0, 20.0, -20.0, 110.0, -130.0, 350.0, 50.0, 50.0, 150.0, 70.0, 100.0, 450.0, 30.0, 100.0, 80.0, 30.0, 30.0, 30.0, 20.0, 350.0, 80.0, 510.0, 20.0, 150.0, 270.0, 20.0, 50.0, 210.0, 130.0, 310.0, 110.0, 30.0, 120.0, 180.0, 90.0, 20.0, 90.0, 550.0, 70.0, 210.0, -15.0, 30.0, 90.0, 30.0, 40.0, 30.0, 120.0, 210.0, 40.0, 20.0, 30.0, 90.0, 230.0, 160.0, 90.0, 90.0, 190.0, 100.0, 10.0, 40.0, 40.0, 100.0, 30.0, 10.0, 90.0, 350.0, 120.0, 0.0, 10.0, 130.0, 20.0, 110.0, 50.0, 110.0, 110.0, 175.0, 100.0, 210.0, 30.0, 100.0, 30.0, 30.0, 30.0, 100.0, -15.0, 560.0, 350.0, 130.0, 170.0, 160.0, 340.0, 50.0, 50.0, 40.0, 70.0, 240.0, 230.0, 100.0, 80.0, 60.0, 80.0, 180.0, 40.0, 350.0, 330.0, 90.0, 5.0, 0.0, 20.0, 60.0, 140.0, 110.0, 0.0, 400.0, 30.0, 10.0, 120.0, 350.0, 150.0, 80.0, 230.0, 230.0, 210.0, 40.0, 10.0, 20.0, 0.0, 0.0, 20.0, 60.0, 40.0, 0.0, 20.0, 50.0, 20.0, 180.0, 30.0, 90.0, 90.0, 140.0, 60.0, 90.0, 150.0, 190.0, 10.0, 620.0, 40.0, 100.0, 20.0, 750.0, 270.0, 0.0, 30.0, 70.0, 70.0, 110.0, 30.0, 30.0, 50.0, 250.0, 100.0, 10.0, 230.0, 110.0, 100.0, 40.0, 90.0, -15.0, 110.0, 300.0, 50.0, 40.0, 180.0, 320.0, 90.0, 30.0, 45.0, 60.0, 140.0, 70.0, 300.0, 100.0, 190.0, 230.0, 300.0, 70.0, 35.0, 60.0, 150.0, 70.0, 370.0, 10.0, 140.0, 180.0, 100.0, 200.0, 160.0, 40.0, 30.0, 340.0, 10.0, 70.0, 0.0, 260.0, 50.0, 330.0, 30.0, 220.0, 70.0, 60.0, 80.0, 60.0, 60.0, 130.0, 190.0, 610.0, 420.0, -20.0, 50.0, -40.0, 470.0, 10.0, 40.0, 60.0, 160.0, 170.0, 60.0, 50.0, 520.0, 120.0, 80.0, 130.0, 30.0, 160.0, 90.0, 170.0, 20.0, 90.0, 0.0, 270.0, 20.0, 530.0, 120.0, 380.0, 80.0, 30.0, 280.0, 180.0, 450.0, 30.0, 40.0, 120.0, 160.0, 110.0, 110.0, 80.0, 0.0, 160.0, 250.0, 70.0, 65.0, 110.0, 80.0, 180.0, 0.0, 20.0, 260.0, 80.0, 40.0, 170.0, 100.0, 40.0, 190.0, 0.0, 70.0, 190.0, 70.0, 230.0, 640.0, 40.0, 60.0, 40.0, 10.0, 30.0, 10.0, 190.0, 120.0, 70.0, 80.0, 80.0, 90.0, 170.0, 230.0, 160.0, 300.0, 110.0, 70.0, 0.0, 220.0, 110.0, 210.0, 60.0, 230.0, 150.0, 560.0, 130.0, 90.0, 110.0, 100.0, 140.0, 70.0, 380.0, 790.0, 30.0, 40.0, 160.0, 140.0, 30.0, 80.0, 150.0, 420.0, 180.0, 320.0, 100.0, 350.0, 40.0, 120.0, 20.0, 50.0, 190.0, 340.0, 210.0, 80.0, 90.0, 70.0, 100.0, 410.0, 30.0, 120.0, 100.0, 220.0, 70.0, 50.0, -30.0, 280.0, 50.0, 20.0, 50.0, 370.0, 120.0, 140.0, 120.0, 100.0, 160.0, 110.0, 200.0, 80.0, 60.0, -90.0, 410.0, 100.0, 520.0, 100.0, -10.0, 440.0, 130.0, 110.0, 10.0, -40.0, 40.0, 330.0, 40.0, 460.0, 50.0, 160.0, 70.0, 20.0, 420.0, 70.0, 100.0, 40.0, 100.0, 280.0, 200.0, 340.0, 25.0, 320.0, 300.0, 160.0, -10.0, 20.0, 160.0, 140.0, 100.0, 50.0, 50.0, 10.0, -30.0, 130.0, 60.0, 390.0, 30.0, 510.0, 260.0, 40.0, 130.0, 70.0, 40.0, 110.0, 360.0, 80.0, 60.0, 30.0, 40.0, 300.0, 40.0, 30.0, 180.0, 150.0, 110.0, 110.0, 150.0, 330.0, 190.0, 150.0, 50.0, 190.0, 170.0, 370.0, 60.0, 20.0, 150.0, 0.0, 60.0, 70.0, 90.0, 40.0, 170.0, 15.0, 380.0, 150.0, 0.0, 10.0, 0.0, 30.0, 170.0, 110.0, 160.0, 80.0, 70.0, 90.0, 230.0, 100.0, 100.0, 240.0, 80.0, 20.0, 50.0, 180.0, 80.0, 250.0, 310.0, 260.0, 90.0, 70.0, 30.0, 10.0, 160.0, 50.0, 130.0, 10.0, 90.0, 30.0, 30.0, 10.0, 20.0, 260.0, 160.0, 220.0, 60.0, 290.0, 150.0, -20.0, -10.0, 20.0, 40.0, 60.0, 40.0, 50.0, 110.0, 0.0, 50.0, 30.0, 80.0, 20.0, 90.0, 20.0, 665.0, 200.0, 80.0, 110.0, 40.0, 30.0, 20.0, 160.0, 100.0, 220.0, 50.0, 170.0, 90.0, 150.0, 110.0, 120.0, 170.0, 80.0, 260.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6561196176035216, "mean_inference_ms": 1.5030281988946785, "mean_action_processing_ms": 0.4233973912572403, "mean_env_wait_ms": 1.3491639169157057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013200044631958008, "StateBufferConnector_ms": 0.010036706924438477, "ViewRequirementAgentConnector_ms": 0.4247322082519531}, "num_episodes": 23, "episode_return_max": 2300.0, "episode_return_min": 390.0, "episode_return_mean": 1300.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.09658707542257, "num_env_steps_trained_throughput_per_sec": 19.09658707542257, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 5960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5960000, "timers": {"training_iteration_time_ms": 209320.998, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209320.955, "sample_time_ms": 2640.189, "learn_time_ms": 206661.145, "learn_throughput": 19.355, "synch_weights_time_ms": 11.429}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "done": false, "training_iteration": 149, "trial_id": "aa996_00000", "date": "2024-05-24_07-24-03", "timestamp": 1716549843, "time_this_iter_s": 209.4711389541626, "time_total_s": 31108.511528015137, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x1600ad8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31108.511528015137, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 26.811824324324323, "ram_util_percent": 78.79020270270271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7060442684874877, "cur_kl_coeff": 15.799800412865814, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002523646107056556, "vf_loss": 7.400165893221562, "vf_explained_var": -0.0005390497442251577, "kl": Infinity, "entropy": 0.22724771991261025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1403805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "env_runners": {"episode_reward_max": 2300.0, "episode_reward_min": 290.0, "episode_reward_mean": 1267.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -310.0}, "policy_reward_max": {"policy_0": 910.0}, "policy_reward_mean": {"policy_0": 126.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1740.0, 1180.0, 1315.0, 790.0, 1080.0, 2300.0, 1840.0, 1860.0, 1315.0, 1520.0, 1405.0, 1425.0, 855.0, 1220.0, 745.0, 1045.0, 1330.0, 1090.0, 1310.0, 1030.0, 1430.0, 1370.0, 1350.0, 1700.0, 1080.0, 1420.0, 1280.0, 1110.0, 1480.0, 1250.0, 1125.0, 1080.0, 960.0, 835.0, 1175.0, 1600.0, 1540.0, 775.0, 1440.0, 390.0, 1470.0, 1460.0, 950.0, 1195.0, 1505.0, 1315.0, 1290.0, 1510.0, 1320.0, 1410.0, 1540.0, 1560.0, 935.0, 1140.0, 1320.0, 1410.0, 1740.0, 1910.0, 1810.0, 1270.0, 1300.0, 1390.0, 1740.0, 1230.0, 1595.0, 1290.0, 1530.0, 1130.0, 1450.0, 1180.0, 965.0, 1260.0, 1340.0, 540.0, 1170.0, 530.0, 1425.0, 1420.0, 1010.0, 1060.0, 710.0, 1425.0, 1800.0, 600.0, 680.0, 1370.0, 1610.0, 1220.0, 730.0, 1260.0, 1240.0, 1150.0, 290.0, 1100.0, 1195.0, 1030.0, 1370.0, 1730.0, 1250.0, 1560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 520.0, 80.0, 500.0, 70.0, 50.0, 40.0, 20.0, 70.0, 300.0, 20.0, 100.0, 140.0, 150.0, 50.0, 140.0, 50.0, 190.0, 290.0, 50.0, 100.0, 150.0, 330.0, 170.0, 50.0, 20.0, 75.0, 10.0, 60.0, 350.0, 45.0, 130.0, 90.0, 50.0, 380.0, 55.0, 5.0, 10.0, 10.0, 15.0, 140.0, 90.0, 30.0, 40.0, 110.0, 110.0, 250.0, 80.0, 210.0, 20.0, 750.0, 350.0, 100.0, 110.0, 60.0, 170.0, 240.0, 420.0, 50.0, 50.0, 530.0, 20.0, 0.0, 130.0, 10.0, 280.0, 200.0, 290.0, 210.0, 170.0, 330.0, 190.0, 200.0, 350.0, 0.0, 70.0, 230.0, 40.0, 110.0, 340.0, 70.0, 75.0, 80.0, 80.0, 210.0, 420.0, 100.0, 270.0, 20.0, -10.0, 60.0, 110.0, 60.0, 210.0, 10.0, 390.0, 140.0, 10.0, 550.0, -20.0, 310.0, 140.0, 40.0, 60.0, 25.0, 20.0, 80.0, 210.0, 250.0, 270.0, 280.0, -310.0, 510.0, 180.0, 15.0, 30.0, 350.0, 130.0, 110.0, 130.0, 140.0, 40.0, -5.0, 170.0, 10.0, 380.0, 50.0, 0.0, 10.0, 60.0, 60.0, 80.0, 310.0, 60.0, 90.0, 230.0, 270.0, 30.0, 80.0, 10.0, 40.0, 60.0, 40.0, 10.0, 220.0, 40.0, 235.0, 60.0, 80.0, -40.0, 30.0, 260.0, -5.0, 240.0, 10.0, 90.0, 50.0, 30.0, 290.0, 50.0, 310.0, 30.0, 20.0, 30.0, 220.0, 60.0, 100.0, 300.0, 180.0, 80.0, 190.0, 40.0, 50.0, 290.0, 150.0, 20.0, 0.0, 150.0, 170.0, 30.0, 190.0, 70.0, 280.0, 290.0, 180.0, 100.0, 10.0, 90.0, 60.0, 40.0, 70.0, 150.0, 350.0, 40.0, 100.0, 70.0, -50.0, 110.0, 180.0, 10.0, 70.0, 130.0, 170.0, 130.0, 310.0, 300.0, 40.0, 180.0, 120.0, -20.0, 80.0, 180.0, 50.0, -30.0, 280.0, 0.0, 130.0, 80.0, 300.0, 300.0, 170.0, 30.0, 430.0, 60.0, 110.0, 0.0, 70.0, 340.0, 110.0, 30.0, 90.0, 80.0, 590.0, 50.0, 180.0, 60.0, 160.0, 380.0, 90.0, 20.0, 60.0, 130.0, 160.0, -40.0, 50.0, 460.0, -140.0, 180.0, 60.0, 160.0, -90.0, 80.0, 40.0, 610.0, 250.0, 110.0, 140.0, 120.0, -30.0, 190.0, 340.0, 90.0, 120.0, 30.0, 370.0, 20.0, -20.0, 110.0, -130.0, 350.0, 50.0, 50.0, 150.0, 70.0, 100.0, 450.0, 30.0, 100.0, 80.0, 30.0, 30.0, 30.0, 20.0, 350.0, 80.0, 510.0, 20.0, 150.0, 270.0, 20.0, 50.0, 210.0, 130.0, 310.0, 110.0, 30.0, 120.0, 180.0, 90.0, 20.0, 90.0, 550.0, 70.0, 210.0, -15.0, 30.0, 90.0, 30.0, 40.0, 30.0, 120.0, 210.0, 40.0, 20.0, 30.0, 90.0, 230.0, 160.0, 90.0, 90.0, 190.0, 100.0, 10.0, 40.0, 40.0, 100.0, 30.0, 10.0, 90.0, 350.0, 120.0, 0.0, 10.0, 130.0, 20.0, 110.0, 50.0, 110.0, 110.0, 175.0, 100.0, 210.0, 30.0, 100.0, 30.0, 30.0, 30.0, 100.0, -15.0, 560.0, 350.0, 130.0, 170.0, 160.0, 340.0, 50.0, 50.0, 40.0, 70.0, 240.0, 230.0, 100.0, 80.0, 60.0, 80.0, 180.0, 40.0, 350.0, 330.0, 90.0, 5.0, 0.0, 20.0, 60.0, 140.0, 110.0, 0.0, 400.0, 30.0, 10.0, 120.0, 350.0, 150.0, 80.0, 230.0, 230.0, 210.0, 40.0, 10.0, 20.0, 0.0, 0.0, 20.0, 60.0, 40.0, 0.0, 20.0, 50.0, 20.0, 180.0, 30.0, 90.0, 90.0, 140.0, 60.0, 90.0, 150.0, 190.0, 10.0, 620.0, 40.0, 100.0, 20.0, 750.0, 270.0, 0.0, 30.0, 70.0, 70.0, 110.0, 30.0, 30.0, 50.0, 250.0, 100.0, 10.0, 230.0, 110.0, 100.0, 40.0, 90.0, -15.0, 110.0, 300.0, 50.0, 40.0, 180.0, 320.0, 90.0, 30.0, 45.0, 60.0, 140.0, 70.0, 300.0, 100.0, 190.0, 230.0, 300.0, 70.0, 35.0, 60.0, 150.0, 70.0, 370.0, 10.0, 140.0, 180.0, 100.0, 200.0, 160.0, 40.0, 30.0, 340.0, 10.0, 70.0, 0.0, 260.0, 50.0, 330.0, 30.0, 220.0, 70.0, 60.0, 80.0, 60.0, 60.0, 130.0, 190.0, 610.0, 420.0, -20.0, 50.0, -40.0, 470.0, 10.0, 40.0, 60.0, 160.0, 170.0, 60.0, 50.0, 520.0, 120.0, 80.0, 130.0, 30.0, 160.0, 90.0, 170.0, 20.0, 90.0, 0.0, 270.0, 20.0, 530.0, 120.0, 380.0, 80.0, 30.0, 280.0, 180.0, 450.0, 30.0, 40.0, 120.0, 160.0, 110.0, 110.0, 80.0, 0.0, 160.0, 250.0, 70.0, 65.0, 110.0, 80.0, 180.0, 0.0, 20.0, 260.0, 80.0, 40.0, 170.0, 100.0, 40.0, 190.0, 0.0, 70.0, 190.0, 70.0, 230.0, 640.0, 40.0, 60.0, 40.0, 10.0, 30.0, 10.0, 190.0, 120.0, 70.0, 80.0, 80.0, 90.0, 170.0, 230.0, 160.0, 300.0, 110.0, 70.0, 0.0, 220.0, 110.0, 210.0, 60.0, 230.0, 150.0, 560.0, 130.0, 90.0, 110.0, 100.0, 140.0, 70.0, 380.0, 790.0, 30.0, 40.0, 160.0, 140.0, 30.0, 80.0, 150.0, 420.0, 180.0, 320.0, 100.0, 350.0, 40.0, 120.0, 20.0, 50.0, 190.0, 340.0, 210.0, 80.0, 90.0, 70.0, 100.0, 410.0, 30.0, 120.0, 100.0, 220.0, 70.0, 50.0, -30.0, 280.0, 50.0, 20.0, 50.0, 370.0, 120.0, 140.0, 120.0, 100.0, 160.0, 110.0, 200.0, 80.0, 60.0, -90.0, 410.0, 100.0, 520.0, 100.0, -10.0, 440.0, 130.0, 110.0, 10.0, -40.0, 40.0, 330.0, 40.0, 460.0, 50.0, 160.0, 70.0, 20.0, 420.0, 70.0, 100.0, 40.0, 100.0, 280.0, 200.0, 340.0, 25.0, 320.0, 300.0, 160.0, -10.0, 20.0, 160.0, 140.0, 100.0, 50.0, 50.0, 10.0, -30.0, 130.0, 60.0, 390.0, 30.0, 510.0, 260.0, 40.0, 130.0, 70.0, 40.0, 110.0, 360.0, 80.0, 60.0, 30.0, 40.0, 300.0, 40.0, 30.0, 180.0, 150.0, 110.0, 110.0, 150.0, 330.0, 190.0, 150.0, 50.0, 190.0, 170.0, 370.0, 60.0, 20.0, 150.0, 0.0, 60.0, 70.0, 90.0, 40.0, 170.0, 15.0, 380.0, 150.0, 0.0, 10.0, 0.0, 30.0, 170.0, 110.0, 160.0, 80.0, 70.0, 90.0, 230.0, 100.0, 100.0, 240.0, 80.0, 20.0, 50.0, 180.0, 80.0, 250.0, 310.0, 260.0, 90.0, 70.0, 30.0, 10.0, 160.0, 50.0, 130.0, 10.0, 90.0, 30.0, 30.0, 10.0, 20.0, 260.0, 160.0, 220.0, 60.0, 290.0, 150.0, -20.0, -10.0, 20.0, 40.0, 60.0, 40.0, 50.0, 110.0, 0.0, 50.0, 30.0, 80.0, 20.0, 90.0, 20.0, 665.0, 200.0, 80.0, 110.0, 40.0, 30.0, 20.0, 160.0, 100.0, 220.0, 50.0, 170.0, 90.0, 150.0, 110.0, 120.0, 170.0, 80.0, 260.0, 100.0, 110.0, 140.0, 110.0, 170.0, -80.0, 210.0, 0.0, 170.0, 80.0, 90.0, 40.0, 380.0, 150.0, 50.0, 90.0, 40.0, 20.0, 170.0, 30.0, 290.0, 10.0, 0.0, 30.0, 100.0, 10.0, 50.0, 10.0, 190.0, 20.0, 140.0, 170.0, 100.0, 440.0, -20.0, -85.0, 630.0, 30.0, 10.0, 10.0, 90.0, 40.0, 310.0, 50.0, 290.0, 20.0, 40.0, 910.0, 40.0, 10.0, 20.0, 40.0, 40.0, 160.0, 10.0, 20.0, 20.0, 300.0, -20.0, 10.0, 210.0, 200.0, 10.0, 60.0, 30.0, 30.0, 0.0, 50.0, 60.0, 30.0, 60.0, 15.0, 90.0, 80.0, -80.0, 555.0, 70.0, 70.0, 0.0, 510.0, 20.0, 310.0, 50.0, 20.0, 200.0, 190.0, 90.0, 150.0, 230.0, 350.0, 210.0, 80.0, 160.0, 130.0, 60.0, 20.0, 30.0, 70.0, 50.0, 410.0, 30.0, 110.0, 0.0, 50.0, 50.0, 30.0, 260.0, 30.0, 20.0, 150.0, 190.0, 20.0, 170.0, 150.0, 100.0, 120.0, 245.0, 210.0, 5.0, 50.0, 20.0, 80.0, 70.0, 60.0, 420.0, 70.0, 240.0, 90.0, 20.0, 170.0, 530.0, 170.0, 60.0, 200.0, -50.0, 20.0, 0.0, -20.0, 50.0, 190.0, 110.0, 10.0, 10.0, 90.0, 120.0, 0.0, 0.0, -50.0, -50.0, 50.0, 120.0, 150.0, 170.0, 80.0, 130.0, 170.0, 70.0, 110.0, 60.0, 40.0, 240.0, -60.0, 310.0, 160.0, 170.0, -70.0, 100.0, 290.0, -30.0, 85.0, 250.0, 60.0, 50.0, 190.0, 0.0, 120.0, 20.0, 20.0, 10.0, 310.0, 160.0, 40.0, 420.0, 70.0, 10.0, 100.0, 110.0, 220.0, 60.0, 180.0, 120.0, 0.0, 110.0, 100.0, 60.0, 140.0, 860.0, 60.0, 210.0, 70.0, 170.0, 110.0, 90.0, 50.0, 120.0, 60.0, 220.0, 310.0, 30.0, 90.0, 500.0, 130.0, 60.0, 40.0, 280.0, 190.0, 10.0, 90.0, 190.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6558631341596304, "mean_inference_ms": 1.503218316874063, "mean_action_processing_ms": 0.4233329457291478, "mean_env_wait_ms": 1.349230422098084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01300048828125, "StateBufferConnector_ms": 0.010062932968139648, "ViewRequirementAgentConnector_ms": 0.42446374893188477}, "num_episodes": 22, "episode_return_max": 2300.0, "episode_return_min": 290.0, "episode_return_mean": 1267.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.164009261896577, "num_env_steps_trained_throughput_per_sec": 19.164009261896577, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 6000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000000, "timers": {"training_iteration_time_ms": 209475.597, "restore_workers_time_ms": 0.011, "training_step_time_ms": 209475.553, "sample_time_ms": 2651.083, "learn_time_ms": 206804.773, "learn_throughput": 19.342, "synch_weights_time_ms": 11.489}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "done": true, "training_iteration": 150, "trial_id": "aa996_00000", "date": "2024-05-24_07-27-32", "timestamp": 1716550052, "time_this_iter_s": 208.73177790641785, "time_total_s": 31317.243305921555, "pid": 94287, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x1600b24c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31317.243305921555, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 26.76474576271186, "ram_util_percent": 78.74813559322033}}
