{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9889696766155216, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5567753205030237, "policy_loss": -0.012906344308040807, "vf_loss": 2.5675895589609117, "vf_explained_var": 0.002825079221948902, "kl": 0.010460542321215639, "entropy": 1.5975659443928412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 4695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 35.0, "episode_reward_min": -980.0, "episode_reward_mean": -276.3888888888889, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3618, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -27.63888888888889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.0, -210.0, -200.0, -155.0, -275.0, -275.0, 35.0, -140.0, 15.0, -745.0, -220.0, -390.0, -85.0, -575.0, -440.0, -200.0, -980.0, -15.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-150.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -180.0, -30.0, 0.0, 0.0, 0.0, 0.0, -55.0, 10.0, 10.0, -100.0, 0.0, 0.0, -65.0, 0.0, 0.0, 0.0, -50.0, 0.0, 10.0, -85.0, 10.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 0.0, -25.0, -75.0, 10.0, 0.0, -35.0, -180.0, 10.0, 20.0, 0.0, 0.0, -195.0, 0.0, 20.0, 0.0, -100.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -80.0, -15.0, 0.0, 0.0, 0.0, 0.0, -5.0, -50.0, 0.0, 20.0, 0.0, 10.0, -5.0, -30.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -405.0, 0.0, 0.0, -90.0, 0.0, -250.0, 0.0, 10.0, 10.0, -210.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -295.0, 0.0, 0.0, 10.0, 0.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, -10.0, -245.0, 0.0, -105.0, -140.0, 0.0, 0.0, 0.0, -150.0, 0.0, -5.0, 0.0, -120.0, -165.0, 0.0, 10.0, 30.0, -55.0, 0.0, 10.0, 10.0, -205.0, 0.0, 0.0, 0.0, -290.0, -160.0, -60.0, -115.0, 0.0, 0.0, -140.0, -75.0, 0.0, -140.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 10.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.256689590048805, "mean_inference_ms": 1.8014781618139908, "mean_action_processing_ms": 0.6099367559770016, "mean_env_wait_ms": 1.915399166361807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015592575073242188, "StateBufferConnector_ms": 0.011536810133192275, "ViewRequirementAgentConnector_ms": 0.6635427474975586}, "num_episodes": 18, "episode_return_max": 35.0, "episode_return_min": -980.0, "episode_return_mean": -276.3888888888889}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.196161558021345, "num_env_steps_trained_throughput_per_sec": 18.196161558021345, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 219826.592, "restore_workers_time_ms": 0.146, "training_step_time_ms": 219826.356, "sample_time_ms": 3714.975, "learn_time_ms": 216094.834, "learn_throughput": 18.51, "synch_weights_time_ms": 9.211}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "3d3a5_00000", "date": "2024-05-31_22-36-42", "timestamp": 1717209402, "time_this_iter_s": 219.88134002685547, "time_total_s": 219.88134002685547, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7d3dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 219.88134002685547, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.07923322683706, "ram_util_percent": 82.50095846645367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1498441226534442, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.111166229520362, "policy_loss": -0.008565381495691181, "vf_loss": 1.1188211517497755, "vf_explained_var": 0.000919942822827064, "kl": 0.004552295696536575, "entropy": 1.5932117708447897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 14085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -980.0, "episode_reward_mean": -146.80555555555554, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7236, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -14.680555555555555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.0, -210.0, -200.0, -155.0, -275.0, -275.0, 35.0, -140.0, 15.0, -745.0, -220.0, -390.0, -85.0, -575.0, -440.0, -200.0, -980.0, -15.0, -10.0, 15.0, -45.0, 40.0, -100.0, 40.0, 10.0, 10.0, -35.0, -80.0, -20.0, 0.0, -50.0, 40.0, 10.0, 60.0, -235.0, 40.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-150.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -180.0, -30.0, 0.0, 0.0, 0.0, 0.0, -55.0, 10.0, 10.0, -100.0, 0.0, 0.0, -65.0, 0.0, 0.0, 0.0, -50.0, 0.0, 10.0, -85.0, 10.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 0.0, -25.0, -75.0, 10.0, 0.0, -35.0, -180.0, 10.0, 20.0, 0.0, 0.0, -195.0, 0.0, 20.0, 0.0, -100.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -80.0, -15.0, 0.0, 0.0, 0.0, 0.0, -5.0, -50.0, 0.0, 20.0, 0.0, 10.0, -5.0, -30.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -405.0, 0.0, 0.0, -90.0, 0.0, -250.0, 0.0, 10.0, 10.0, -210.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -295.0, 0.0, 0.0, 10.0, 0.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, -10.0, -245.0, 0.0, -105.0, -140.0, 0.0, 0.0, 0.0, -150.0, 0.0, -5.0, 0.0, -120.0, -165.0, 0.0, 10.0, 30.0, -55.0, 0.0, 10.0, 10.0, -205.0, 0.0, 0.0, 0.0, -290.0, -160.0, -60.0, -115.0, 0.0, 0.0, -140.0, -75.0, 0.0, -140.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, -45.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -35.0, -40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, -25.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -55.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -55.0, 0.0, -45.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, -180.0, 10.0, 0.0, -85.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.165966816661231, "mean_inference_ms": 1.758693745563824, "mean_action_processing_ms": 0.5847777182229721, "mean_env_wait_ms": 1.8348498953392642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015309784147474501, "StateBufferConnector_ms": 0.010579162173800997, "ViewRequirementAgentConnector_ms": 0.6979154215918647}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -980.0, "episode_return_mean": -146.80555555555554}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.379507055412684, "num_env_steps_trained_throughput_per_sec": 18.379507055412684, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 218730.146, "restore_workers_time_ms": 0.079, "training_step_time_ms": 218730.009, "sample_time_ms": 3929.732, "learn_time_ms": 214781.71, "learn_throughput": 18.624, "synch_weights_time_ms": 10.65}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "3d3a5_00000", "date": "2024-05-31_22-40-19", "timestamp": 1717209619, "time_this_iter_s": 217.66586709022522, "time_total_s": 437.5472071170807, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7d3a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 437.5472071170807, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.501941747572815, "ram_util_percent": 82.11391585760516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4294065818999904, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.153554988929385, "policy_loss": -0.010487137182295339, "vf_loss": 1.1630988604185808, "vf_explained_var": 0.026022082053053494, "kl": 0.009432643461872097, "entropy": 1.5840700733268096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 23475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 90.0, "episode_reward_min": -980.0, "episode_reward_mean": -90.83333333333333, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10854, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -9.083333333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.0, -210.0, -200.0, -155.0, -275.0, -275.0, 35.0, -140.0, 15.0, -745.0, -220.0, -390.0, -85.0, -575.0, -440.0, -200.0, -980.0, -15.0, -10.0, 15.0, -45.0, 40.0, -100.0, 40.0, 10.0, 10.0, -35.0, -80.0, -20.0, 0.0, -50.0, 40.0, 10.0, 60.0, -235.0, 40.0, 20.0, 20.0, 30.0, 15.0, 30.0, 90.0, 20.0, 20.0, 5.0, 60.0, 30.0, 20.0, -115.0, 30.0, -5.0, 30.0, 30.0, 50.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-150.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -180.0, -30.0, 0.0, 0.0, 0.0, 0.0, -55.0, 10.0, 10.0, -100.0, 0.0, 0.0, -65.0, 0.0, 0.0, 0.0, -50.0, 0.0, 10.0, -85.0, 10.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 0.0, -25.0, -75.0, 10.0, 0.0, -35.0, -180.0, 10.0, 20.0, 0.0, 0.0, -195.0, 0.0, 20.0, 0.0, -100.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -80.0, -15.0, 0.0, 0.0, 0.0, 0.0, -5.0, -50.0, 0.0, 20.0, 0.0, 10.0, -5.0, -30.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -405.0, 0.0, 0.0, -90.0, 0.0, -250.0, 0.0, 10.0, 10.0, -210.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -295.0, 0.0, 0.0, 10.0, 0.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, -10.0, -245.0, 0.0, -105.0, -140.0, 0.0, 0.0, 0.0, -150.0, 0.0, -5.0, 0.0, -120.0, -165.0, 0.0, 10.0, 30.0, -55.0, 0.0, 10.0, 10.0, -205.0, 0.0, 0.0, 0.0, -290.0, -160.0, -60.0, -115.0, 0.0, 0.0, -140.0, -75.0, 0.0, -140.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, -45.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -35.0, -40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, -25.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -55.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -55.0, 0.0, -45.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, -180.0, 10.0, 0.0, -85.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -145.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1251706409808326, "mean_inference_ms": 1.7197206910089322, "mean_action_processing_ms": 0.5681866315166166, "mean_env_wait_ms": 1.7902362372242602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01575946807861328, "StateBufferConnector_ms": 0.01048865141691985, "ViewRequirementAgentConnector_ms": 0.6365118203339754}, "num_episodes": 18, "episode_return_max": 90.0, "episode_return_min": -980.0, "episode_return_mean": -90.83333333333333}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.192961026124877, "num_env_steps_trained_throughput_per_sec": 18.192961026124877, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 219108.521, "restore_workers_time_ms": 0.057, "training_step_time_ms": 219108.393, "sample_time_ms": 3813.235, "learn_time_ms": 215270.402, "learn_throughput": 18.581, "synch_weights_time_ms": 14.581}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "3d3a5_00000", "date": "2024-05-31_22-43-59", "timestamp": 1717209839, "time_this_iter_s": 219.8922758102417, "time_total_s": 657.4394829273224, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f819550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 657.4394829273224, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.727597402597404, "ram_util_percent": 81.64577922077923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6589221702533534, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2568002576169115, "policy_loss": -0.010345659249698241, "vf_loss": 1.2661405471011726, "vf_explained_var": 0.012000152770195779, "kl": 0.010053707950600168, "entropy": 1.5701343534472652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 32865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 90.0, "episode_reward_min": -980.0, "episode_reward_mean": -60.208333333333336, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 14472, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -6.020833333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.0, -210.0, -200.0, -155.0, -275.0, -275.0, 35.0, -140.0, 15.0, -745.0, -220.0, -390.0, -85.0, -575.0, -440.0, -200.0, -980.0, -15.0, -10.0, 15.0, -45.0, 40.0, -100.0, 40.0, 10.0, 10.0, -35.0, -80.0, -20.0, 0.0, -50.0, 40.0, 10.0, 60.0, -235.0, 40.0, 20.0, 20.0, 30.0, 15.0, 30.0, 90.0, 20.0, 20.0, 5.0, 60.0, 30.0, 20.0, -115.0, 30.0, -5.0, 30.0, 30.0, 50.0, 20.0, 45.0, 30.0, 30.0, 10.0, 40.0, -10.0, 20.0, 55.0, 60.0, 30.0, 70.0, -5.0, 30.0, 15.0, 50.0, 30.0, 50.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-150.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -180.0, -30.0, 0.0, 0.0, 0.0, 0.0, -55.0, 10.0, 10.0, -100.0, 0.0, 0.0, -65.0, 0.0, 0.0, 0.0, -50.0, 0.0, 10.0, -85.0, 10.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 0.0, -25.0, -75.0, 10.0, 0.0, -35.0, -180.0, 10.0, 20.0, 0.0, 0.0, -195.0, 0.0, 20.0, 0.0, -100.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -80.0, -15.0, 0.0, 0.0, 0.0, 0.0, -5.0, -50.0, 0.0, 20.0, 0.0, 10.0, -5.0, -30.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -405.0, 0.0, 0.0, -90.0, 0.0, -250.0, 0.0, 10.0, 10.0, -210.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -295.0, 0.0, 0.0, 10.0, 0.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, -10.0, -245.0, 0.0, -105.0, -140.0, 0.0, 0.0, 0.0, -150.0, 0.0, -5.0, 0.0, -120.0, -165.0, 0.0, 10.0, 30.0, -55.0, 0.0, 10.0, 10.0, -205.0, 0.0, 0.0, 0.0, -290.0, -160.0, -60.0, -115.0, 0.0, 0.0, -140.0, -75.0, 0.0, -140.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, -45.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -35.0, -40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, -25.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -55.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -55.0, 0.0, -45.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, -180.0, 10.0, 0.0, -85.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -145.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -80.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -30.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -25.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.147185964461928, "mean_inference_ms": 1.7248960824665123, "mean_action_processing_ms": 0.5702728005409342, "mean_env_wait_ms": 1.8054271156402075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016373727056715224, "StateBufferConnector_ms": 0.011624230278862847, "ViewRequirementAgentConnector_ms": 0.6820234987470839}, "num_episodes": 18, "episode_return_max": 90.0, "episode_return_min": -980.0, "episode_return_mean": -60.208333333333336}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.218572416661179, "num_env_steps_trained_throughput_per_sec": 3.218572416661179, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 475028.148, "restore_workers_time_ms": 0.049, "training_step_time_ms": 475028.036, "sample_time_ms": 4010.48, "learn_time_ms": 470993.234, "learn_throughput": 8.493, "synch_weights_time_ms": 14.648}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "3d3a5_00000", "date": "2024-05-31_23-04-42", "timestamp": 1717211082, "time_this_iter_s": 1242.8390820026398, "time_total_s": 1900.2785649299622, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7bbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1900.2785649299622, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 50.61467889908257, "ram_util_percent": 82.58715596330275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.950365723030001, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.352190034762739, "policy_loss": -0.011400720429942965, "vf_loss": 2.3625634193674316, "vf_explained_var": 0.029087059369610268, "kl": 0.010273371817967848, "entropy": 1.552487538505794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 42255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 140.0, "episode_reward_min": -980.0, "episode_reward_mean": -26.717171717171716, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 19899, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -2.6717171717171717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.0, -210.0, -200.0, -155.0, -275.0, -275.0, 35.0, -140.0, 15.0, -745.0, -220.0, -390.0, -85.0, -575.0, -440.0, -200.0, -980.0, -15.0, -10.0, 15.0, -45.0, 40.0, -100.0, 40.0, 10.0, 10.0, -35.0, -80.0, -20.0, 0.0, -50.0, 40.0, 10.0, 60.0, -235.0, 40.0, 20.0, 20.0, 30.0, 15.0, 30.0, 90.0, 20.0, 20.0, 5.0, 60.0, 30.0, 20.0, -115.0, 30.0, -5.0, 30.0, 30.0, 50.0, 20.0, 45.0, 30.0, 30.0, 10.0, 40.0, -10.0, 20.0, 55.0, 60.0, 30.0, 70.0, -5.0, 30.0, 15.0, 50.0, 30.0, 50.0, 20.0, 70.0, 100.0, 0.0, 75.0, 40.0, 40.0, 70.0, 100.0, 20.0, 30.0, 50.0, 10.0, 125.0, 125.0, 30.0, 100.0, 140.0, 60.0, 40.0, 45.0, 20.0, 100.0, 80.0, 80.0, 80.0, 40.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-150.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -180.0, -30.0, 0.0, 0.0, 0.0, 0.0, -55.0, 10.0, 10.0, -100.0, 0.0, 0.0, -65.0, 0.0, 0.0, 0.0, -50.0, 0.0, 10.0, -85.0, 10.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 0.0, -25.0, -75.0, 10.0, 0.0, -35.0, -180.0, 10.0, 20.0, 0.0, 0.0, -195.0, 0.0, 20.0, 0.0, -100.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -80.0, -15.0, 0.0, 0.0, 0.0, 0.0, -5.0, -50.0, 0.0, 20.0, 0.0, 10.0, -5.0, -30.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -405.0, 0.0, 0.0, -90.0, 0.0, -250.0, 0.0, 10.0, 10.0, -210.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -295.0, 0.0, 0.0, 10.0, 0.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, -10.0, -245.0, 0.0, -105.0, -140.0, 0.0, 0.0, 0.0, -150.0, 0.0, -5.0, 0.0, -120.0, -165.0, 0.0, 10.0, 30.0, -55.0, 0.0, 10.0, 10.0, -205.0, 0.0, 0.0, 0.0, -290.0, -160.0, -60.0, -115.0, 0.0, 0.0, -140.0, -75.0, 0.0, -140.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, -45.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -35.0, -40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, -25.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -55.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -55.0, 0.0, -45.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, -180.0, 10.0, 0.0, -85.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -145.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -80.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -30.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -25.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, -5.0, 0.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 15.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 15.0, 30.0, 0.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, -10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1829929176334666, "mean_inference_ms": 1.7402731810368248, "mean_action_processing_ms": 0.5777908758244465, "mean_env_wait_ms": 1.836538522812567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016471593066899465, "StateBufferConnector_ms": 0.01567830943097972, "ViewRequirementAgentConnector_ms": 0.682401175450797}, "num_episodes": 27, "episode_return_max": 140.0, "episode_return_min": -980.0, "episode_return_mean": -26.717171717171716}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.3543731004323805, "num_env_steps_trained_throughput_per_sec": 5.3543731004323805, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 529433.103, "restore_workers_time_ms": 0.042, "training_step_time_ms": 529433.003, "sample_time_ms": 4068.436, "learn_time_ms": 525339.065, "learn_throughput": 7.614, "synch_weights_time_ms": 13.703}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "3d3a5_00000", "date": "2024-05-31_23-17-09", "timestamp": 1717211829, "time_this_iter_s": 747.083967924118, "time_total_s": 2647.36253285408, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f85a310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2647.36253285408, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 42.400925925925925, "ram_util_percent": 81.41141975308643}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.518021035619691, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.517453965186057, "policy_loss": -0.011313842978309622, "vf_loss": 2.527696694898656, "vf_explained_var": 0.019667308633954633, "kl": 0.010711107928008126, "entropy": 1.5455831058997824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 51645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 240.0, "episode_reward_min": -235.0, "episode_reward_mean": 40.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 60.0}, "policy_reward_mean": {"policy_0": 4.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, -10.0, 15.0, -45.0, 40.0, -100.0, 40.0, 10.0, 10.0, -35.0, -80.0, -20.0, 0.0, -50.0, 40.0, 10.0, 60.0, -235.0, 40.0, 20.0, 20.0, 30.0, 15.0, 30.0, 90.0, 20.0, 20.0, 5.0, 60.0, 30.0, 20.0, -115.0, 30.0, -5.0, 30.0, 30.0, 50.0, 20.0, 45.0, 30.0, 30.0, 10.0, 40.0, -10.0, 20.0, 55.0, 60.0, 30.0, 70.0, -5.0, 30.0, 15.0, 50.0, 30.0, 50.0, 20.0, 70.0, 100.0, 0.0, 75.0, 40.0, 40.0, 70.0, 100.0, 20.0, 30.0, 50.0, 10.0, 125.0, 125.0, 30.0, 100.0, 140.0, 60.0, 40.0, 45.0, 20.0, 100.0, 80.0, 80.0, 80.0, 40.0, 35.0, 240.0, 80.0, 160.0, 120.0, 80.0, 80.0, 130.0, 120.0, 20.0, 10.0, 100.0, 50.0, 140.0, 120.0, 110.0, 50.0, 110.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, -45.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -35.0, -40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, -25.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -55.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -55.0, 0.0, -45.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, -180.0, 10.0, 0.0, -85.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -145.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -80.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -30.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -25.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, -5.0, 0.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 15.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 15.0, 30.0, 0.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, -10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 40.0, 20.0, 20.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 20.0, 0.0, -10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, -10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1849621401471744, "mean_inference_ms": 1.7393651002650137, "mean_action_processing_ms": 0.5751403779897869, "mean_env_wait_ms": 1.835159661253723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016064167022705078, "StateBufferConnector_ms": 0.015447854995727539, "ViewRequirementAgentConnector_ms": 0.6564877033233643}, "num_episodes": 18, "episode_return_max": 240.0, "episode_return_min": -235.0, "episode_return_mean": 40.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.874557026955707, "num_env_steps_trained_throughput_per_sec": 4.874557026955707, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 577958.819, "restore_workers_time_ms": 0.037, "training_step_time_ms": 577958.727, "sample_time_ms": 3977.829, "learn_time_ms": 573956.429, "learn_throughput": 6.969, "synch_weights_time_ms": 13.243}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "3d3a5_00000", "date": "2024-05-31_23-30-50", "timestamp": 1717212650, "time_this_iter_s": 820.6129488945007, "time_total_s": 3467.975481748581, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f84f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3467.975481748581, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.28050314465409, "ram_util_percent": 81.62138364779874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.401286720436094, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.099260311284131, "policy_loss": -0.011743193102804141, "vf_loss": 3.1100520779530463, "vf_explained_var": 0.004903195244562638, "kl": 0.009514250371712595, "entropy": 1.5264278255712491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 61035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 270.0, "episode_reward_min": -115.0, "episode_reward_mean": 69.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -145.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 6.93}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 20.0, 20.0, 30.0, 15.0, 30.0, 90.0, 20.0, 20.0, 5.0, 60.0, 30.0, 20.0, -115.0, 30.0, -5.0, 30.0, 30.0, 50.0, 20.0, 45.0, 30.0, 30.0, 10.0, 40.0, -10.0, 20.0, 55.0, 60.0, 30.0, 70.0, -5.0, 30.0, 15.0, 50.0, 30.0, 50.0, 20.0, 70.0, 100.0, 0.0, 75.0, 40.0, 40.0, 70.0, 100.0, 20.0, 30.0, 50.0, 10.0, 125.0, 125.0, 30.0, 100.0, 140.0, 60.0, 40.0, 45.0, 20.0, 100.0, 80.0, 80.0, 80.0, 40.0, 35.0, 240.0, 80.0, 160.0, 120.0, 80.0, 80.0, 130.0, 120.0, 20.0, 10.0, 100.0, 50.0, 140.0, 120.0, 110.0, 50.0, 110.0, 120.0, 160.0, 160.0, 100.0, 95.0, 130.0, 110.0, 110.0, 150.0, 100.0, 120.0, 150.0, 150.0, 130.0, 180.0, 110.0, 150.0, 270.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, -145.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -35.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -80.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -30.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -25.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, -5.0, 0.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 15.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 15.0, 30.0, 0.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, -10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 40.0, 20.0, 20.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 20.0, 0.0, -10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, -10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, -10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, -5.0, 0.0, 20.0, 0.0, 40.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 20.0, 20.0, 30.0, -10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 10.0, 40.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 50.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 170.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.203110188695937, "mean_inference_ms": 1.740680058052775, "mean_action_processing_ms": 0.5771924165814056, "mean_env_wait_ms": 1.846028391765424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016434669494628906, "StateBufferConnector_ms": 0.015496253967285156, "ViewRequirementAgentConnector_ms": 0.6489048004150391}, "num_episodes": 18, "episode_return_max": 270.0, "episode_return_min": -115.0, "episode_return_mean": 69.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 17.171059578751546, "num_env_steps_trained_throughput_per_sec": 17.171059578751546, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 528671.861, "restore_workers_time_ms": 0.033, "training_step_time_ms": 528671.775, "sample_time_ms": 3879.216, "learn_time_ms": 524767.512, "learn_throughput": 7.622, "synch_weights_time_ms": 13.344}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "3d3a5_00000", "date": "2024-05-31_23-34-43", "timestamp": 1717212883, "time_this_iter_s": 232.99162006378174, "time_total_s": 3700.9671018123627, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321bf6310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3700.9671018123627, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 47.44909090909091, "ram_util_percent": 79.47939393939394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.347862564889006, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6964427527274313, "policy_loss": -0.008631594235219331, "vf_loss": 3.7040559122737604, "vf_explained_var": 0.004807178553935692, "kl": 0.010184330356717381, "entropy": 1.4976855662176276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 70425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 405.0, "episode_reward_min": -10.0, "episode_reward_mean": 98.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 9.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 20.0, 45.0, 30.0, 30.0, 10.0, 40.0, -10.0, 20.0, 55.0, 60.0, 30.0, 70.0, -5.0, 30.0, 15.0, 50.0, 30.0, 50.0, 20.0, 70.0, 100.0, 0.0, 75.0, 40.0, 40.0, 70.0, 100.0, 20.0, 30.0, 50.0, 10.0, 125.0, 125.0, 30.0, 100.0, 140.0, 60.0, 40.0, 45.0, 20.0, 100.0, 80.0, 80.0, 80.0, 40.0, 35.0, 240.0, 80.0, 160.0, 120.0, 80.0, 80.0, 130.0, 120.0, 20.0, 10.0, 100.0, 50.0, 140.0, 120.0, 110.0, 50.0, 110.0, 120.0, 160.0, 160.0, 100.0, 95.0, 130.0, 110.0, 110.0, 150.0, 100.0, 120.0, 150.0, 150.0, 130.0, 180.0, 110.0, 150.0, 270.0, 180.0, 250.0, 165.0, 90.0, 130.0, 240.0, 55.0, 200.0, 70.0, 110.0, 190.0, 270.0, 405.0, 310.0, 115.0, 220.0, 135.0, 180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -80.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -30.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -25.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, -5.0, 0.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 15.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 15.0, 30.0, 0.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, -10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 40.0, 20.0, 20.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 20.0, 0.0, -10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, -10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, -10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, -5.0, 0.0, 20.0, 0.0, 40.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 20.0, 20.0, 30.0, -10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 10.0, 40.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 50.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 170.0, 20.0, 10.0, 20.0, 0.0, 60.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 20.0, 50.0, 5.0, 0.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 30.0, 10.0, 70.0, 30.0, 10.0, 0.0, 20.0, 0.0, 5.0, 0.0, 5.0, 10.0, 0.0, -5.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 60.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 50.0, 20.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 250.0, 10.0, 20.0, -140.0, 0.0, -40.0, 30.0, 10.0, -20.0, -5.0, 20.0, 360.0, 40.0, 10.0, 0.0, 10.0, 50.0, 30.0, 40.0, 50.0, 30.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 60.0, 10.0, 40.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 15.0, 10.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2520370351368086, "mean_inference_ms": 1.7719272461422844, "mean_action_processing_ms": 0.5909527233494489, "mean_env_wait_ms": 1.8910350189708311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017556190490722656, "StateBufferConnector_ms": 0.017014026641845703, "ViewRequirementAgentConnector_ms": 0.7347784042358398}, "num_episodes": 18, "episode_return_max": 405.0, "episode_return_min": -10.0, "episode_return_mean": 98.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.963056633512661, "num_env_steps_trained_throughput_per_sec": 14.963056633512661, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 496003.512, "restore_workers_time_ms": 0.031, "training_step_time_ms": 496003.431, "sample_time_ms": 4033.089, "learn_time_ms": 491944.06, "learn_throughput": 8.131, "synch_weights_time_ms": 13.973}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "3d3a5_00000", "date": "2024-05-31_23-39-10", "timestamp": 1717213150, "time_this_iter_s": 267.3473150730133, "time_total_s": 3968.314416885376, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321bf6160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3968.314416885376, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 50.957671957671955, "ram_util_percent": 81.92407407407407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.013425564950013, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.256219547929855, "policy_loss": -0.008868533452894416, "vf_loss": 4.264077322348492, "vf_explained_var": 0.0008617874088124853, "kl": 0.010107586342681395, "entropy": 1.4580579745375946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 79815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 450.0, "episode_reward_min": 0.0, "episode_reward_mean": 133.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 13.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 20.0, 70.0, 100.0, 0.0, 75.0, 40.0, 40.0, 70.0, 100.0, 20.0, 30.0, 50.0, 10.0, 125.0, 125.0, 30.0, 100.0, 140.0, 60.0, 40.0, 45.0, 20.0, 100.0, 80.0, 80.0, 80.0, 40.0, 35.0, 240.0, 80.0, 160.0, 120.0, 80.0, 80.0, 130.0, 120.0, 20.0, 10.0, 100.0, 50.0, 140.0, 120.0, 110.0, 50.0, 110.0, 120.0, 160.0, 160.0, 100.0, 95.0, 130.0, 110.0, 110.0, 150.0, 100.0, 120.0, 150.0, 150.0, 130.0, 180.0, 110.0, 150.0, 270.0, 180.0, 250.0, 165.0, 90.0, 130.0, 240.0, 55.0, 200.0, 70.0, 110.0, 190.0, 270.0, 405.0, 310.0, 115.0, 220.0, 135.0, 180.0, 250.0, 325.0, 165.0, 160.0, 220.0, 400.0, 130.0, 185.0, 450.0, 165.0, 120.0, 300.0, 155.0, 185.0, 170.0, 260.0, 130.0, 250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 0.0, -5.0, 0.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 15.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 15.0, 30.0, 0.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, -10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 40.0, 20.0, 20.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 20.0, 0.0, -10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, -10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, -10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, -5.0, 0.0, 20.0, 0.0, 40.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 20.0, 20.0, 30.0, -10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 10.0, 40.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 50.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 170.0, 20.0, 10.0, 20.0, 0.0, 60.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 20.0, 50.0, 5.0, 0.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 30.0, 10.0, 70.0, 30.0, 10.0, 0.0, 20.0, 0.0, 5.0, 0.0, 5.0, 10.0, 0.0, -5.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 60.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 50.0, 20.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 250.0, 10.0, 20.0, -140.0, 0.0, -40.0, 30.0, 10.0, -20.0, -5.0, 20.0, 360.0, 40.0, 10.0, 0.0, 10.0, 50.0, 30.0, 40.0, 50.0, 30.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 60.0, 10.0, 40.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 15.0, 10.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 10.0, 20.0, 150.0, 30.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 20.0, 30.0, 160.0, 0.0, -15.0, 10.0, 40.0, 40.0, 45.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 270.0, 60.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 30.0, 260.0, 30.0, 0.0, 20.0, 10.0, -5.0, 40.0, 0.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 160.0, 10.0, 10.0, -30.0, 10.0, 10.0, 10.0, -10.0, -5.0, 20.0, 30.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 0.0, 30.0, 10.0, 25.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 40.0, 20.0, 10.0, 10.0, 50.0, 30.0, 10.0, 50.0, 20.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3105654343452495, "mean_inference_ms": 1.8209582037178809, "mean_action_processing_ms": 0.6074959629245188, "mean_env_wait_ms": 1.9423067507691507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01972341537475586, "StateBufferConnector_ms": 0.01833510398864746, "ViewRequirementAgentConnector_ms": 0.7693939208984375}, "num_episodes": 18, "episode_return_max": 450.0, "episode_return_min": 0.0, "episode_return_mean": 133.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 13.58619981587855, "num_env_steps_trained_throughput_per_sec": 13.58619981587855, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 473604.946, "restore_workers_time_ms": 0.029, "training_step_time_ms": 473604.868, "sample_time_ms": 4299.301, "learn_time_ms": 469278.808, "learn_throughput": 8.524, "synch_weights_time_ms": 14.463}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "3d3a5_00000", "date": "2024-05-31_23-44-05", "timestamp": 1717213445, "time_this_iter_s": 294.4365620613098, "time_total_s": 4262.750978946686, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321bf64c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4262.750978946686, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 51.83573141486811, "ram_util_percent": 81.64268585131894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5337297744517384, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.125919505125418, "policy_loss": -0.011496619639880518, "vf_loss": 4.136397191993217, "vf_explained_var": 0.003502056621514951, "kl": 0.010189300309582584, "entropy": 1.432262535102832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 89205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 450.0, "episode_reward_min": 10.0, "episode_reward_mean": 178.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 17.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 35.0, 240.0, 80.0, 160.0, 120.0, 80.0, 80.0, 130.0, 120.0, 20.0, 10.0, 100.0, 50.0, 140.0, 120.0, 110.0, 50.0, 110.0, 120.0, 160.0, 160.0, 100.0, 95.0, 130.0, 110.0, 110.0, 150.0, 100.0, 120.0, 150.0, 150.0, 130.0, 180.0, 110.0, 150.0, 270.0, 180.0, 250.0, 165.0, 90.0, 130.0, 240.0, 55.0, 200.0, 70.0, 110.0, 190.0, 270.0, 405.0, 310.0, 115.0, 220.0, 135.0, 180.0, 250.0, 325.0, 165.0, 160.0, 220.0, 400.0, 130.0, 185.0, 450.0, 165.0, 120.0, 300.0, 155.0, 185.0, 170.0, 260.0, 130.0, 250.0, 90.0, 190.0, 290.0, 355.0, 310.0, 180.0, 260.0, 70.0, 170.0, 150.0, 200.0, 340.0, 240.0, 195.0, 355.0, 155.0, 280.0, 220.0, 200.0, 260.0, 330.0, 180.0, 230.0, 125.0, 350.0, 270.0, 190.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 40.0, 20.0, 20.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 40.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 20.0, 0.0, -10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, -10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, -10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, -5.0, 0.0, 20.0, 0.0, 40.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 20.0, 20.0, 30.0, -10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 10.0, 40.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 50.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 170.0, 20.0, 10.0, 20.0, 0.0, 60.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 20.0, 50.0, 5.0, 0.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 30.0, 10.0, 70.0, 30.0, 10.0, 0.0, 20.0, 0.0, 5.0, 0.0, 5.0, 10.0, 0.0, -5.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 60.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 50.0, 20.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 250.0, 10.0, 20.0, -140.0, 0.0, -40.0, 30.0, 10.0, -20.0, -5.0, 20.0, 360.0, 40.0, 10.0, 0.0, 10.0, 50.0, 30.0, 40.0, 50.0, 30.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 60.0, 10.0, 40.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 15.0, 10.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 10.0, 20.0, 150.0, 30.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 20.0, 30.0, 160.0, 0.0, -15.0, 10.0, 40.0, 40.0, 45.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 270.0, 60.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 30.0, 260.0, 30.0, 0.0, 20.0, 10.0, -5.0, 40.0, 0.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 160.0, 10.0, 10.0, -30.0, 10.0, 10.0, 10.0, -10.0, -5.0, 20.0, 30.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 0.0, 30.0, 10.0, 25.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 40.0, 20.0, 10.0, 10.0, 50.0, 30.0, 10.0, 50.0, 20.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, -20.0, 40.0, -20.0, 10.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 0.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 70.0, 20.0, 40.0, 25.0, 30.0, 30.0, 20.0, 50.0, 50.0, 10.0, 50.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 50.0, 30.0, 20.0, -40.0, 160.0, 0.0, 0.0, -130.0, 20.0, 0.0, 0.0, 30.0, 80.0, 0.0, 180.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 90.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 50.0, 10.0, 0.0, 30.0, 10.0, 20.0, -20.0, 0.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 90.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 50.0, 50.0, 10.0, 10.0, 20.0, 30.0, 40.0, 80.0, 0.0, 50.0, 40.0, 30.0, 0.0, 10.0, 10.0, 0.0, 90.0, 30.0, 10.0, 20.0, 50.0, 30.0, -55.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 0.0, 30.0, 30.0, -5.0, 40.0, 20.0, 0.0, 0.0, 20.0, 180.0, 40.0, 50.0, 0.0, 30.0, 20.0, 0.0, 30.0, -5.0, 10.0, 10.0, 10.0, 150.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 0.0, 20.0, 30.0, 60.0, 60.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 50.0, 10.0, 30.0, 30.0, 40.0, 40.0, 50.0, 40.0, 10.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 0.0, 0.0, 50.0, 10.0, 20.0, 40.0, 30.0, 40.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, -15.0, 10.0, 0.0, 20.0, 0.0, 10.0, -30.0, 0.0, 30.0, 350.0, -40.0, 10.0, 70.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4358802577592167, "mean_inference_ms": 1.9509584413218493, "mean_action_processing_ms": 0.644511578444146, "mean_env_wait_ms": 2.0591127054452834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029331207275390625, "StateBufferConnector_ms": 0.019102096557617188, "ViewRequirementAgentConnector_ms": 0.9317841529846191}, "num_episodes": 27, "episode_return_max": 450.0, "episode_return_min": 10.0, "episode_return_mean": 178.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 11.701474522551026, "num_env_steps_trained_throughput_per_sec": 11.701474522551026, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 460428.179, "restore_workers_time_ms": 0.028, "training_step_time_ms": 460428.103, "sample_time_ms": 4611.66, "learn_time_ms": 455789.14, "learn_throughput": 8.776, "synch_weights_time_ms": 14.758}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 10, "trial_id": "3d3a5_00000", "date": "2024-05-31_23-49-47", "timestamp": 1717213787, "time_this_iter_s": 341.867155790329, "time_total_s": 4604.618134737015, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f85a670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4604.618134737015, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 51.33747412008282, "ram_util_percent": 82.21304347826087}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3747012352219787, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.613275416920614, "policy_loss": -0.011085970514489653, "vf_loss": 4.623322095683081, "vf_explained_var": 0.0013627908798579337, "kl": 0.010392913776875724, "entropy": 1.3828794856802724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 98595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 660.0, "episode_reward_min": 55.0, "episode_reward_mean": 213.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 21.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.0, 120.0, 160.0, 160.0, 100.0, 95.0, 130.0, 110.0, 110.0, 150.0, 100.0, 120.0, 150.0, 150.0, 130.0, 180.0, 110.0, 150.0, 270.0, 180.0, 250.0, 165.0, 90.0, 130.0, 240.0, 55.0, 200.0, 70.0, 110.0, 190.0, 270.0, 405.0, 310.0, 115.0, 220.0, 135.0, 180.0, 250.0, 325.0, 165.0, 160.0, 220.0, 400.0, 130.0, 185.0, 450.0, 165.0, 120.0, 300.0, 155.0, 185.0, 170.0, 260.0, 130.0, 250.0, 90.0, 190.0, 290.0, 355.0, 310.0, 180.0, 260.0, 70.0, 170.0, 150.0, 200.0, 340.0, 240.0, 195.0, 355.0, 155.0, 280.0, 220.0, 200.0, 260.0, 330.0, 180.0, 230.0, 125.0, 350.0, 270.0, 190.0, 340.0, 270.0, 255.0, 210.0, 330.0, 300.0, 140.0, 405.0, 335.0, 130.0, 300.0, 170.0, 140.0, 660.0, 230.0, 280.0, 380.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, -10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, -5.0, 0.0, 20.0, 0.0, 40.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 20.0, 20.0, 30.0, -10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 10.0, 40.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 10.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 30.0, 0.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 50.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 170.0, 20.0, 10.0, 20.0, 0.0, 60.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 20.0, 50.0, 5.0, 0.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 30.0, 10.0, 70.0, 30.0, 10.0, 0.0, 20.0, 0.0, 5.0, 0.0, 5.0, 10.0, 0.0, -5.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 60.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 50.0, 20.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 250.0, 10.0, 20.0, -140.0, 0.0, -40.0, 30.0, 10.0, -20.0, -5.0, 20.0, 360.0, 40.0, 10.0, 0.0, 10.0, 50.0, 30.0, 40.0, 50.0, 30.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 60.0, 10.0, 40.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 15.0, 10.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 10.0, 20.0, 150.0, 30.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 20.0, 30.0, 160.0, 0.0, -15.0, 10.0, 40.0, 40.0, 45.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 270.0, 60.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 30.0, 260.0, 30.0, 0.0, 20.0, 10.0, -5.0, 40.0, 0.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 160.0, 10.0, 10.0, -30.0, 10.0, 10.0, 10.0, -10.0, -5.0, 20.0, 30.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 0.0, 30.0, 10.0, 25.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 40.0, 20.0, 10.0, 10.0, 50.0, 30.0, 10.0, 50.0, 20.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, -20.0, 40.0, -20.0, 10.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 0.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 70.0, 20.0, 40.0, 25.0, 30.0, 30.0, 20.0, 50.0, 50.0, 10.0, 50.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 50.0, 30.0, 20.0, -40.0, 160.0, 0.0, 0.0, -130.0, 20.0, 0.0, 0.0, 30.0, 80.0, 0.0, 180.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 90.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 50.0, 10.0, 0.0, 30.0, 10.0, 20.0, -20.0, 0.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 90.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 50.0, 50.0, 10.0, 10.0, 20.0, 30.0, 40.0, 80.0, 0.0, 50.0, 40.0, 30.0, 0.0, 10.0, 10.0, 0.0, 90.0, 30.0, 10.0, 20.0, 50.0, 30.0, -55.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 0.0, 30.0, 30.0, -5.0, 40.0, 20.0, 0.0, 0.0, 20.0, 180.0, 40.0, 50.0, 0.0, 30.0, 20.0, 0.0, 30.0, -5.0, 10.0, 10.0, 10.0, 150.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 0.0, 20.0, 30.0, 60.0, 60.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 50.0, 10.0, 30.0, 30.0, 40.0, 40.0, 50.0, 40.0, 10.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 0.0, 0.0, 50.0, 10.0, 20.0, 40.0, 30.0, 40.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, -15.0, 10.0, 0.0, 20.0, 0.0, 10.0, -30.0, 0.0, 30.0, 350.0, -40.0, 10.0, 70.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 70.0, 20.0, 35.0, 60.0, 20.0, 35.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 150.0, 40.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 30.0, 0.0, 50.0, 100.0, 0.0, 10.0, 25.0, 30.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 50.0, 70.0, 40.0, 30.0, 80.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 20.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 30.0, 20.0, 20.0, 20.0, 0.0, 5.0, 10.0, 50.0, 30.0, 50.0, 200.0, 40.0, 20.0, 0.0, 0.0, 30.0, 160.0, 0.0, 40.0, 100.0, 0.0, 10.0, -55.0, 50.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 50.0, 30.0, 0.0, 40.0, 30.0, 10.0, 70.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, 240.0, 20.0, 160.0, 30.0, 40.0, 90.0, 0.0, 80.0, -50.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 70.0, 40.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 60.0, 30.0, 0.0, -30.0, 30.0, 0.0, 80.0, 70.0, 0.0, 10.0, 50.0, 170.0, 10.0, 20.0, 20.0, 30.0, 150.0, 30.0, 10.0, 10.0, 20.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.556114270029782, "mean_inference_ms": 2.0781957852318733, "mean_action_processing_ms": 0.6822801997246919, "mean_env_wait_ms": 2.180248074208306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032176971435546875, "StateBufferConnector_ms": 0.021455049514770508, "ViewRequirementAgentConnector_ms": 1.0476696491241455}, "num_episodes": 18, "episode_return_max": 660.0, "episode_return_min": 55.0, "episode_return_mean": 213.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 10.333047579826319, "num_env_steps_trained_throughput_per_sec": 10.333047579826319, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 477156.269, "restore_workers_time_ms": 0.015, "training_step_time_ms": 477156.201, "sample_time_ms": 5007.163, "learn_time_ms": 472119.292, "learn_throughput": 8.472, "synch_weights_time_ms": 15.686}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 11, "trial_id": "3d3a5_00000", "date": "2024-05-31_23-56-14", "timestamp": 1717214174, "time_this_iter_s": 387.13093519210815, "time_total_s": 4991.749069929123, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321bf68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4991.749069929123, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.4748031496063, "ram_util_percent": 81.46167979002625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.373117621396931, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.061556138347386, "policy_loss": -0.01013200241344345, "vf_loss": 5.070679182747302, "vf_explained_var": 0.0024757895987635604, "kl": 0.010089505671715534, "entropy": 1.3666025808951852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 107985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 730.0, "episode_reward_min": 55.0, "episode_reward_mean": 257.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 360.0}, "policy_reward_mean": {"policy_0": 25.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.0, 180.0, 250.0, 165.0, 90.0, 130.0, 240.0, 55.0, 200.0, 70.0, 110.0, 190.0, 270.0, 405.0, 310.0, 115.0, 220.0, 135.0, 180.0, 250.0, 325.0, 165.0, 160.0, 220.0, 400.0, 130.0, 185.0, 450.0, 165.0, 120.0, 300.0, 155.0, 185.0, 170.0, 260.0, 130.0, 250.0, 90.0, 190.0, 290.0, 355.0, 310.0, 180.0, 260.0, 70.0, 170.0, 150.0, 200.0, 340.0, 240.0, 195.0, 355.0, 155.0, 280.0, 220.0, 200.0, 260.0, 330.0, 180.0, 230.0, 125.0, 350.0, 270.0, 190.0, 340.0, 270.0, 255.0, 210.0, 330.0, 300.0, 140.0, 405.0, 335.0, 130.0, 300.0, 170.0, 140.0, 660.0, 230.0, 280.0, 380.0, 370.0, 430.0, 290.0, 330.0, 320.0, 420.0, 490.0, 330.0, 150.0, 290.0, 410.0, 185.0, 550.0, 490.0, 290.0, 240.0, 730.0, 300.0, 450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 170.0, 20.0, 10.0, 20.0, 0.0, 60.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 20.0, 50.0, 5.0, 0.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 30.0, 10.0, 70.0, 30.0, 10.0, 0.0, 20.0, 0.0, 5.0, 0.0, 5.0, 10.0, 0.0, -5.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 60.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 50.0, 20.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 250.0, 10.0, 20.0, -140.0, 0.0, -40.0, 30.0, 10.0, -20.0, -5.0, 20.0, 360.0, 40.0, 10.0, 0.0, 10.0, 50.0, 30.0, 40.0, 50.0, 30.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 60.0, 10.0, 40.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 15.0, 10.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 10.0, 20.0, 150.0, 30.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 20.0, 30.0, 160.0, 0.0, -15.0, 10.0, 40.0, 40.0, 45.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 270.0, 60.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 30.0, 260.0, 30.0, 0.0, 20.0, 10.0, -5.0, 40.0, 0.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 160.0, 10.0, 10.0, -30.0, 10.0, 10.0, 10.0, -10.0, -5.0, 20.0, 30.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 0.0, 30.0, 10.0, 25.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 40.0, 20.0, 10.0, 10.0, 50.0, 30.0, 10.0, 50.0, 20.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, -20.0, 40.0, -20.0, 10.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 0.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 70.0, 20.0, 40.0, 25.0, 30.0, 30.0, 20.0, 50.0, 50.0, 10.0, 50.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 50.0, 30.0, 20.0, -40.0, 160.0, 0.0, 0.0, -130.0, 20.0, 0.0, 0.0, 30.0, 80.0, 0.0, 180.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 90.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 50.0, 10.0, 0.0, 30.0, 10.0, 20.0, -20.0, 0.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 90.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 50.0, 50.0, 10.0, 10.0, 20.0, 30.0, 40.0, 80.0, 0.0, 50.0, 40.0, 30.0, 0.0, 10.0, 10.0, 0.0, 90.0, 30.0, 10.0, 20.0, 50.0, 30.0, -55.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 0.0, 30.0, 30.0, -5.0, 40.0, 20.0, 0.0, 0.0, 20.0, 180.0, 40.0, 50.0, 0.0, 30.0, 20.0, 0.0, 30.0, -5.0, 10.0, 10.0, 10.0, 150.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 0.0, 20.0, 30.0, 60.0, 60.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 50.0, 10.0, 30.0, 30.0, 40.0, 40.0, 50.0, 40.0, 10.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 0.0, 0.0, 50.0, 10.0, 20.0, 40.0, 30.0, 40.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, -15.0, 10.0, 0.0, 20.0, 0.0, 10.0, -30.0, 0.0, 30.0, 350.0, -40.0, 10.0, 70.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 70.0, 20.0, 35.0, 60.0, 20.0, 35.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 150.0, 40.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 30.0, 0.0, 50.0, 100.0, 0.0, 10.0, 25.0, 30.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 50.0, 70.0, 40.0, 30.0, 80.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 20.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 30.0, 20.0, 20.0, 20.0, 0.0, 5.0, 10.0, 50.0, 30.0, 50.0, 200.0, 40.0, 20.0, 0.0, 0.0, 30.0, 160.0, 0.0, 40.0, 100.0, 0.0, 10.0, -55.0, 50.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 50.0, 30.0, 0.0, 40.0, 30.0, 10.0, 70.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, 240.0, 20.0, 160.0, 30.0, 40.0, 90.0, 0.0, 80.0, -50.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 70.0, 40.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 60.0, 30.0, 0.0, -30.0, 30.0, 0.0, 80.0, 70.0, 0.0, 10.0, 50.0, 170.0, 10.0, 20.0, 20.0, 30.0, 150.0, 30.0, 10.0, 10.0, 20.0, 70.0, -20.0, 20.0, 10.0, 150.0, 40.0, 0.0, 40.0, 60.0, 30.0, 100.0, -40.0, 20.0, 0.0, 180.0, 20.0, 30.0, 30.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 30.0, 110.0, 20.0, 30.0, 10.0, 70.0, 0.0, 80.0, 30.0, 0.0, 60.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 280.0, 30.0, 0.0, 50.0, 180.0, 30.0, 80.0, 20.0, 40.0, 10.0, 50.0, 160.0, 50.0, -40.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 50.0, 0.0, 30.0, 10.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 160.0, 0.0, 20.0, 20.0, 40.0, 40.0, 70.0, 10.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 10.0, 15.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 250.0, 60.0, 100.0, 50.0, 30.0, 20.0, 50.0, -20.0, -40.0, 50.0, 10.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 0.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 180.0, 40.0, 0.0, 30.0, 10.0, 60.0, 170.0, 40.0, 160.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 30.0, 60.0, 40.0, 40.0, 0.0, 20.0, 40.0, 160.0, 30.0, 20.0, 50.0, 30.0, 30.0, 60.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.695049400333302, "mean_inference_ms": 2.2260364224476086, "mean_action_processing_ms": 0.7254153901237353, "mean_env_wait_ms": 2.321914644012057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0353245735168457, "StateBufferConnector_ms": 0.023070335388183594, "ViewRequirementAgentConnector_ms": 1.1207914352416992}, "num_episodes": 18, "episode_return_max": 730.0, "episode_return_min": 55.0, "episode_return_mean": 257.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 11.86370638458675, "num_env_steps_trained_throughput_per_sec": 11.86370638458675, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 489109.177, "restore_workers_time_ms": 0.015, "training_step_time_ms": 489109.089, "sample_time_ms": 5161.89, "learn_time_ms": 483917.295, "learn_throughput": 8.266, "synch_weights_time_ms": 15.976}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 12, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-01-51", "timestamp": 1717214511, "time_this_iter_s": 337.1842942237854, "time_total_s": 5328.933364152908, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f824820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5328.933364152908, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 48.32457983193277, "ram_util_percent": 79.95231092436975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.82420003760737, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.569296712844897, "policy_loss": -0.010452030199269702, "vf_loss": 4.578572321522096, "vf_explained_var": 0.0034953235119930346, "kl": 0.011764220718755873, "entropy": 1.3446236946712287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 117375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 820.0, "episode_reward_min": 70.0, "episode_reward_mean": 277.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 380.0}, "policy_reward_mean": {"policy_0": 27.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.0, 250.0, 325.0, 165.0, 160.0, 220.0, 400.0, 130.0, 185.0, 450.0, 165.0, 120.0, 300.0, 155.0, 185.0, 170.0, 260.0, 130.0, 250.0, 90.0, 190.0, 290.0, 355.0, 310.0, 180.0, 260.0, 70.0, 170.0, 150.0, 200.0, 340.0, 240.0, 195.0, 355.0, 155.0, 280.0, 220.0, 200.0, 260.0, 330.0, 180.0, 230.0, 125.0, 350.0, 270.0, 190.0, 340.0, 270.0, 255.0, 210.0, 330.0, 300.0, 140.0, 405.0, 335.0, 130.0, 300.0, 170.0, 140.0, 660.0, 230.0, 280.0, 380.0, 370.0, 430.0, 290.0, 330.0, 320.0, 420.0, 490.0, 330.0, 150.0, 290.0, 410.0, 185.0, 550.0, 490.0, 290.0, 240.0, 730.0, 300.0, 450.0, 270.0, 310.0, 250.0, 410.0, 400.0, 820.0, 270.0, 290.0, 130.0, 240.0, 150.0, 160.0, 170.0, 320.0, 300.0, 335.0, 240.0, 400.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 10.0, 20.0, 150.0, 30.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 10.0, 20.0, 30.0, 160.0, 0.0, -15.0, 10.0, 40.0, 40.0, 45.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 270.0, 60.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 30.0, 260.0, 30.0, 0.0, 20.0, 10.0, -5.0, 40.0, 0.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 160.0, 10.0, 10.0, -30.0, 10.0, 10.0, 10.0, -10.0, -5.0, 20.0, 30.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 0.0, 30.0, 10.0, 25.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 40.0, 20.0, 10.0, 10.0, 50.0, 30.0, 10.0, 50.0, 20.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, -20.0, 40.0, -20.0, 10.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 0.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 70.0, 20.0, 40.0, 25.0, 30.0, 30.0, 20.0, 50.0, 50.0, 10.0, 50.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 50.0, 30.0, 20.0, -40.0, 160.0, 0.0, 0.0, -130.0, 20.0, 0.0, 0.0, 30.0, 80.0, 0.0, 180.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 90.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 50.0, 10.0, 0.0, 30.0, 10.0, 20.0, -20.0, 0.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 90.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 50.0, 50.0, 10.0, 10.0, 20.0, 30.0, 40.0, 80.0, 0.0, 50.0, 40.0, 30.0, 0.0, 10.0, 10.0, 0.0, 90.0, 30.0, 10.0, 20.0, 50.0, 30.0, -55.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 0.0, 30.0, 30.0, -5.0, 40.0, 20.0, 0.0, 0.0, 20.0, 180.0, 40.0, 50.0, 0.0, 30.0, 20.0, 0.0, 30.0, -5.0, 10.0, 10.0, 10.0, 150.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 0.0, 20.0, 30.0, 60.0, 60.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 50.0, 10.0, 30.0, 30.0, 40.0, 40.0, 50.0, 40.0, 10.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 0.0, 0.0, 50.0, 10.0, 20.0, 40.0, 30.0, 40.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, -15.0, 10.0, 0.0, 20.0, 0.0, 10.0, -30.0, 0.0, 30.0, 350.0, -40.0, 10.0, 70.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 70.0, 20.0, 35.0, 60.0, 20.0, 35.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 150.0, 40.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 30.0, 0.0, 50.0, 100.0, 0.0, 10.0, 25.0, 30.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 50.0, 70.0, 40.0, 30.0, 80.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 20.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 30.0, 20.0, 20.0, 20.0, 0.0, 5.0, 10.0, 50.0, 30.0, 50.0, 200.0, 40.0, 20.0, 0.0, 0.0, 30.0, 160.0, 0.0, 40.0, 100.0, 0.0, 10.0, -55.0, 50.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 50.0, 30.0, 0.0, 40.0, 30.0, 10.0, 70.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, 240.0, 20.0, 160.0, 30.0, 40.0, 90.0, 0.0, 80.0, -50.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 70.0, 40.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 60.0, 30.0, 0.0, -30.0, 30.0, 0.0, 80.0, 70.0, 0.0, 10.0, 50.0, 170.0, 10.0, 20.0, 20.0, 30.0, 150.0, 30.0, 10.0, 10.0, 20.0, 70.0, -20.0, 20.0, 10.0, 150.0, 40.0, 0.0, 40.0, 60.0, 30.0, 100.0, -40.0, 20.0, 0.0, 180.0, 20.0, 30.0, 30.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 30.0, 110.0, 20.0, 30.0, 10.0, 70.0, 0.0, 80.0, 30.0, 0.0, 60.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 280.0, 30.0, 0.0, 50.0, 180.0, 30.0, 80.0, 20.0, 40.0, 10.0, 50.0, 160.0, 50.0, -40.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 50.0, 0.0, 30.0, 10.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 160.0, 0.0, 20.0, 20.0, 40.0, 40.0, 70.0, 10.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 10.0, 15.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 250.0, 60.0, 100.0, 50.0, 30.0, 20.0, 50.0, -20.0, -40.0, 50.0, 10.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 0.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 180.0, 40.0, 0.0, 30.0, 10.0, 60.0, 170.0, 40.0, 160.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 30.0, 60.0, 40.0, 40.0, 0.0, 20.0, 40.0, 160.0, 30.0, 20.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 70.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 20.0, 10.0, 130.0, 0.0, 0.0, 10.0, 20.0, 40.0, 80.0, 0.0, 30.0, 60.0, 10.0, 0.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 90.0, 30.0, 0.0, 20.0, 60.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 40.0, 20.0, 350.0, 10.0, 10.0, 20.0, -80.0, 20.0, 0.0, 50.0, 380.0, 60.0, 10.0, 30.0, 160.0, 0.0, 50.0, 80.0, 0.0, 80.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 30.0, 70.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 70.0, 70.0, 0.0, 10.0, 0.0, 0.0, 10.0, 50.0, 30.0, 0.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 30.0, 130.0, 30.0, 0.0, 40.0, 10.0, 50.0, 20.0, 30.0, 60.0, 20.0, 40.0, 190.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 40.0, -5.0, 10.0, 10.0, 80.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 50.0, 30.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8249199670872422, "mean_inference_ms": 2.37500840479857, "mean_action_processing_ms": 0.7655935744215836, "mean_env_wait_ms": 2.4561866950151194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03639340400695801, "StateBufferConnector_ms": 0.03011298179626465, "ViewRequirementAgentConnector_ms": 1.1615641117095947}, "num_episodes": 18, "episode_return_max": 820.0, "episode_return_min": 70.0, "episode_return_mean": 277.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.587225141713866, "num_env_steps_trained_throughput_per_sec": 12.587225141713866, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 498900.902, "restore_workers_time_ms": 0.015, "training_step_time_ms": 498900.82, "sample_time_ms": 5495.239, "learn_time_ms": 493375.5, "learn_throughput": 8.107, "synch_weights_time_ms": 15.456}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 13, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-07-09", "timestamp": 1717214829, "time_this_iter_s": 317.7959260940552, "time_total_s": 5646.7292902469635, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8191f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5646.7292902469635, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 45.385333333333335, "ram_util_percent": 81.87022222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7339789951063445, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.37465791059886, "policy_loss": -0.01041088545206102, "vf_loss": 5.384030588493307, "vf_explained_var": -4.3417914860799545e-05, "kl": 0.010381982086726464, "entropy": 1.2952653248977863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 126765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 820.0, "episode_reward_min": 70.0, "episode_reward_mean": 302.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 380.0}, "policy_reward_mean": {"policy_0": 30.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 90.0, 190.0, 290.0, 355.0, 310.0, 180.0, 260.0, 70.0, 170.0, 150.0, 200.0, 340.0, 240.0, 195.0, 355.0, 155.0, 280.0, 220.0, 200.0, 260.0, 330.0, 180.0, 230.0, 125.0, 350.0, 270.0, 190.0, 340.0, 270.0, 255.0, 210.0, 330.0, 300.0, 140.0, 405.0, 335.0, 130.0, 300.0, 170.0, 140.0, 660.0, 230.0, 280.0, 380.0, 370.0, 430.0, 290.0, 330.0, 320.0, 420.0, 490.0, 330.0, 150.0, 290.0, 410.0, 185.0, 550.0, 490.0, 290.0, 240.0, 730.0, 300.0, 450.0, 270.0, 310.0, 250.0, 410.0, 400.0, 820.0, 270.0, 290.0, 130.0, 240.0, 150.0, 160.0, 170.0, 320.0, 300.0, 335.0, 240.0, 400.0, 370.0, 260.0, 440.0, 120.0, 150.0, 620.0, 300.0, 440.0, 290.0, 465.0, 400.0, 670.0, 220.0, 130.0, 150.0, 680.0, 335.0, 340.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 20.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, -20.0, 40.0, -20.0, 10.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 0.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 70.0, 20.0, 40.0, 25.0, 30.0, 30.0, 20.0, 50.0, 50.0, 10.0, 50.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 50.0, 30.0, 20.0, -40.0, 160.0, 0.0, 0.0, -130.0, 20.0, 0.0, 0.0, 30.0, 80.0, 0.0, 180.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 90.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 50.0, 10.0, 0.0, 30.0, 10.0, 20.0, -20.0, 0.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 90.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 20.0, 10.0, 50.0, 50.0, 10.0, 10.0, 20.0, 30.0, 40.0, 80.0, 0.0, 50.0, 40.0, 30.0, 0.0, 10.0, 10.0, 0.0, 90.0, 30.0, 10.0, 20.0, 50.0, 30.0, -55.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 0.0, 30.0, 30.0, -5.0, 40.0, 20.0, 0.0, 0.0, 20.0, 180.0, 40.0, 50.0, 0.0, 30.0, 20.0, 0.0, 30.0, -5.0, 10.0, 10.0, 10.0, 150.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 20.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 0.0, 20.0, 30.0, 60.0, 60.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 50.0, 10.0, 30.0, 30.0, 40.0, 40.0, 50.0, 40.0, 10.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 0.0, 0.0, 50.0, 10.0, 20.0, 40.0, 30.0, 40.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 30.0, -15.0, 10.0, 0.0, 20.0, 0.0, 10.0, -30.0, 0.0, 30.0, 350.0, -40.0, 10.0, 70.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 70.0, 20.0, 35.0, 60.0, 20.0, 35.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 150.0, 40.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 30.0, 0.0, 50.0, 100.0, 0.0, 10.0, 25.0, 30.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 50.0, 70.0, 40.0, 30.0, 80.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 20.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 30.0, 20.0, 20.0, 20.0, 0.0, 5.0, 10.0, 50.0, 30.0, 50.0, 200.0, 40.0, 20.0, 0.0, 0.0, 30.0, 160.0, 0.0, 40.0, 100.0, 0.0, 10.0, -55.0, 50.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 50.0, 30.0, 0.0, 40.0, 30.0, 10.0, 70.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, 240.0, 20.0, 160.0, 30.0, 40.0, 90.0, 0.0, 80.0, -50.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 70.0, 40.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 60.0, 30.0, 0.0, -30.0, 30.0, 0.0, 80.0, 70.0, 0.0, 10.0, 50.0, 170.0, 10.0, 20.0, 20.0, 30.0, 150.0, 30.0, 10.0, 10.0, 20.0, 70.0, -20.0, 20.0, 10.0, 150.0, 40.0, 0.0, 40.0, 60.0, 30.0, 100.0, -40.0, 20.0, 0.0, 180.0, 20.0, 30.0, 30.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 30.0, 110.0, 20.0, 30.0, 10.0, 70.0, 0.0, 80.0, 30.0, 0.0, 60.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 280.0, 30.0, 0.0, 50.0, 180.0, 30.0, 80.0, 20.0, 40.0, 10.0, 50.0, 160.0, 50.0, -40.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 50.0, 0.0, 30.0, 10.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 160.0, 0.0, 20.0, 20.0, 40.0, 40.0, 70.0, 10.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 10.0, 15.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 250.0, 60.0, 100.0, 50.0, 30.0, 20.0, 50.0, -20.0, -40.0, 50.0, 10.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 0.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 180.0, 40.0, 0.0, 30.0, 10.0, 60.0, 170.0, 40.0, 160.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 30.0, 60.0, 40.0, 40.0, 0.0, 20.0, 40.0, 160.0, 30.0, 20.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 70.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 20.0, 10.0, 130.0, 0.0, 0.0, 10.0, 20.0, 40.0, 80.0, 0.0, 30.0, 60.0, 10.0, 0.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 90.0, 30.0, 0.0, 20.0, 60.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 40.0, 20.0, 350.0, 10.0, 10.0, 20.0, -80.0, 20.0, 0.0, 50.0, 380.0, 60.0, 10.0, 30.0, 160.0, 0.0, 50.0, 80.0, 0.0, 80.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 30.0, 70.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 70.0, 70.0, 0.0, 10.0, 0.0, 0.0, 10.0, 50.0, 30.0, 0.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 30.0, 130.0, 30.0, 0.0, 40.0, 10.0, 50.0, 20.0, 30.0, 60.0, 20.0, 40.0, 190.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 40.0, -5.0, 10.0, 10.0, 80.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 50.0, 30.0, 140.0, 0.0, 170.0, 40.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 100.0, 20.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 60.0, 30.0, 80.0, 90.0, 20.0, 20.0, -35.0, 105.0, 40.0, 30.0, 40.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 10.0, 20.0, 90.0, 270.0, 20.0, 30.0, 30.0, 90.0, 40.0, 0.0, 0.0, 50.0, 10.0, 0.0, 0.0, 50.0, 150.0, 0.0, 40.0, 70.0, 70.0, 40.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 20.0, 10.0, 10.0, 60.0, 20.0, -5.0, 40.0, 170.0, 0.0, -130.0, 210.0, 90.0, 60.0, 10.0, 40.0, 30.0, 10.0, 70.0, 50.0, 60.0, 60.0, 10.0, 50.0, 100.0, 60.0, 60.0, 50.0, 20.0, 50.0, 100.0, 160.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 40.0, 0.0, 0.0, 200.0, 50.0, -30.0, 40.0, 10.0, 30.0, 0.0, 80.0, 40.0, 260.0, -20.0, 10.0, 180.0, 30.0, 30.0, 0.0, 15.0, 10.0, 30.0, 50.0, 30.0, 30.0, 90.0, 20.0, 80.0, 10.0, 40.0, 40.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.936307229989786, "mean_inference_ms": 2.5112565454601685, "mean_action_processing_ms": 0.8018225964933694, "mean_env_wait_ms": 2.579099137449304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03708362579345703, "StateBufferConnector_ms": 0.0346531867980957, "ViewRequirementAgentConnector_ms": 1.2788312435150146}, "num_episodes": 18, "episode_return_max": 820.0, "episode_return_min": 70.0, "episode_return_mean": 302.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.376312403911735, "num_env_steps_trained_throughput_per_sec": 12.376312403911735, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 406942.006, "restore_workers_time_ms": 0.014, "training_step_time_ms": 406941.924, "sample_time_ms": 5743.75, "learn_time_ms": 401168.188, "learn_throughput": 9.971, "synch_weights_time_ms": 15.344}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 14, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-12-32", "timestamp": 1717215152, "time_this_iter_s": 323.23552799224854, "time_total_s": 5969.964818239212, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f819280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5969.964818239212, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 46.35951859956237, "ram_util_percent": 81.84004376367614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.867762092070077, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.455697736623315, "policy_loss": -0.010842777872497773, "vf_loss": 5.465552231805901, "vf_explained_var": 0.00011139641554591754, "kl": 0.009882788512786705, "entropy": 1.2662954169848222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 136155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 950.0, "episode_reward_min": 120.0, "episode_reward_mean": 373.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 37.355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 340.0, 270.0, 255.0, 210.0, 330.0, 300.0, 140.0, 405.0, 335.0, 130.0, 300.0, 170.0, 140.0, 660.0, 230.0, 280.0, 380.0, 370.0, 430.0, 290.0, 330.0, 320.0, 420.0, 490.0, 330.0, 150.0, 290.0, 410.0, 185.0, 550.0, 490.0, 290.0, 240.0, 730.0, 300.0, 450.0, 270.0, 310.0, 250.0, 410.0, 400.0, 820.0, 270.0, 290.0, 130.0, 240.0, 150.0, 160.0, 170.0, 320.0, 300.0, 335.0, 240.0, 400.0, 370.0, 260.0, 440.0, 120.0, 150.0, 620.0, 300.0, 440.0, 290.0, 465.0, 400.0, 670.0, 220.0, 130.0, 150.0, 680.0, 335.0, 340.0, 640.0, 200.0, 560.0, 950.0, 570.0, 320.0, 795.0, 405.0, 550.0, 370.0, 675.0, 460.0, 340.0, 410.0, 510.0, 470.0, 920.0, 350.0, 330.0, 360.0, 570.0, 370.0, 380.0, 440.0, 570.0, 255.0, 610.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 70.0, 20.0, 35.0, 60.0, 20.0, 35.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 150.0, 40.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 30.0, 0.0, 50.0, 100.0, 0.0, 10.0, 25.0, 30.0, 20.0, 20.0, 50.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 50.0, 70.0, 40.0, 30.0, 80.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 20.0, 40.0, 30.0, 30.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 30.0, 20.0, 20.0, 20.0, 0.0, 5.0, 10.0, 50.0, 30.0, 50.0, 200.0, 40.0, 20.0, 0.0, 0.0, 30.0, 160.0, 0.0, 40.0, 100.0, 0.0, 10.0, -55.0, 50.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 50.0, 30.0, 0.0, 40.0, 30.0, 10.0, 70.0, 10.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, 240.0, 20.0, 160.0, 30.0, 40.0, 90.0, 0.0, 80.0, -50.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 70.0, 40.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 60.0, 30.0, 0.0, -30.0, 30.0, 0.0, 80.0, 70.0, 0.0, 10.0, 50.0, 170.0, 10.0, 20.0, 20.0, 30.0, 150.0, 30.0, 10.0, 10.0, 20.0, 70.0, -20.0, 20.0, 10.0, 150.0, 40.0, 0.0, 40.0, 60.0, 30.0, 100.0, -40.0, 20.0, 0.0, 180.0, 20.0, 30.0, 30.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 30.0, 110.0, 20.0, 30.0, 10.0, 70.0, 0.0, 80.0, 30.0, 0.0, 60.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 280.0, 30.0, 0.0, 50.0, 180.0, 30.0, 80.0, 20.0, 40.0, 10.0, 50.0, 160.0, 50.0, -40.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 50.0, 0.0, 30.0, 10.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 160.0, 0.0, 20.0, 20.0, 40.0, 40.0, 70.0, 10.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 10.0, 15.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 250.0, 60.0, 100.0, 50.0, 30.0, 20.0, 50.0, -20.0, -40.0, 50.0, 10.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 0.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 180.0, 40.0, 0.0, 30.0, 10.0, 60.0, 170.0, 40.0, 160.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 30.0, 60.0, 40.0, 40.0, 0.0, 20.0, 40.0, 160.0, 30.0, 20.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 70.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 20.0, 10.0, 130.0, 0.0, 0.0, 10.0, 20.0, 40.0, 80.0, 0.0, 30.0, 60.0, 10.0, 0.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 90.0, 30.0, 0.0, 20.0, 60.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 40.0, 20.0, 350.0, 10.0, 10.0, 20.0, -80.0, 20.0, 0.0, 50.0, 380.0, 60.0, 10.0, 30.0, 160.0, 0.0, 50.0, 80.0, 0.0, 80.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 30.0, 70.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 70.0, 70.0, 0.0, 10.0, 0.0, 0.0, 10.0, 50.0, 30.0, 0.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 30.0, 130.0, 30.0, 0.0, 40.0, 10.0, 50.0, 20.0, 30.0, 60.0, 20.0, 40.0, 190.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 40.0, -5.0, 10.0, 10.0, 80.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 50.0, 30.0, 140.0, 0.0, 170.0, 40.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 100.0, 20.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 60.0, 30.0, 80.0, 90.0, 20.0, 20.0, -35.0, 105.0, 40.0, 30.0, 40.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 10.0, 20.0, 90.0, 270.0, 20.0, 30.0, 30.0, 90.0, 40.0, 0.0, 0.0, 50.0, 10.0, 0.0, 0.0, 50.0, 150.0, 0.0, 40.0, 70.0, 70.0, 40.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 20.0, 10.0, 10.0, 60.0, 20.0, -5.0, 40.0, 170.0, 0.0, -130.0, 210.0, 90.0, 60.0, 10.0, 40.0, 30.0, 10.0, 70.0, 50.0, 60.0, 60.0, 10.0, 50.0, 100.0, 60.0, 60.0, 50.0, 20.0, 50.0, 100.0, 160.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 40.0, 0.0, 0.0, 200.0, 50.0, -30.0, 40.0, 10.0, 30.0, 0.0, 80.0, 40.0, 260.0, -20.0, 10.0, 180.0, 30.0, 30.0, 0.0, 15.0, 10.0, 30.0, 50.0, 30.0, 30.0, 90.0, 20.0, 80.0, 10.0, 40.0, 40.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 70.0, 10.0, 0.0, 190.0, 260.0, 20.0, 20.0, 40.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 40.0, 0.0, 20.0, 100.0, 10.0, 90.0, 150.0, 110.0, 10.0, 30.0, -40.0, 40.0, 10.0, 180.0, 30.0, 50.0, 40.0, 580.0, 40.0, 20.0, 20.0, 30.0, 20.0, 380.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 170.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 70.0, 80.0, 20.0, 270.0, 170.0, 40.0, 65.0, 40.0, 20.0, 100.0, 40.0, 90.0, 60.0, 25.0, 0.0, 60.0, 0.0, 30.0, 0.0, 90.0, 20.0, 40.0, 0.0, 20.0, 250.0, 10.0, 10.0, 90.0, 20.0, 0.0, 0.0, 0.0, 80.0, 30.0, 40.0, 0.0, 40.0, 20.0, 160.0, 60.0, 60.0, 60.0, 70.0, -5.0, 20.0, 10.0, 40.0, 300.0, 60.0, 20.0, 40.0, 10.0, 10.0, 0.0, 250.0, 50.0, 40.0, 10.0, 30.0, 60.0, 40.0, 30.0, 30.0, 30.0, 20.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 10.0, 40.0, 70.0, 30.0, 0.0, 40.0, 10.0, 90.0, -60.0, 30.0, 10.0, 160.0, 10.0, -30.0, 90.0, 260.0, 10.0, 30.0, 20.0, 190.0, 70.0, 50.0, 20.0, 30.0, 20.0, 40.0, 30.0, 0.0, 70.0, 90.0, 70.0, 200.0, 30.0, 80.0, 90.0, 80.0, 160.0, 50.0, 20.0, 10.0, 20.0, 30.0, 40.0, 70.0, 80.0, 30.0, 20.0, 30.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 10.0, 70.0, 40.0, 60.0, 20.0, 360.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 80.0, 50.0, 0.0, 0.0, 10.0, 100.0, 30.0, 10.0, 60.0, 60.0, -130.0, 180.0, 0.0, 60.0, 10.0, 40.0, 30.0, 260.0, -130.0, 0.0, 60.0, 10.0, 20.0, 20.0, 300.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 270.0, 30.0, 50.0, 40.0, 60.0, 50.0, 20.0, 10.0, 20.0, -5.0, 10.0, 10.0, 40.0, 10.0, 100.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 290.0, 160.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0723337653817024, "mean_inference_ms": 2.6748769515010378, "mean_action_processing_ms": 0.8458551245819018, "mean_env_wait_ms": 2.7275511930424754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030942440032958984, "StateBufferConnector_ms": 0.03365588188171387, "ViewRequirementAgentConnector_ms": 1.2562780380249023}, "num_episodes": 27, "episode_return_max": 950.0, "episode_return_min": 120.0, "episode_return_mean": 373.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.671033421007543, "num_env_steps_trained_throughput_per_sec": 12.671033421007543, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 363804.78, "restore_workers_time_ms": 0.015, "training_step_time_ms": 363804.697, "sample_time_ms": 6048.742, "learn_time_ms": 357726.728, "learn_throughput": 11.182, "synch_weights_time_ms": 15.457}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 15, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-17-48", "timestamp": 1717215468, "time_this_iter_s": 315.69960713386536, "time_total_s": 6285.664425373077, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8240d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6285.664425373077, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 45.617225950783, "ram_util_percent": 81.74049217002238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3951515609083085, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.169006456912389, "policy_loss": -0.011541075370543764, "vf_loss": 5.179536918964122, "vf_explained_var": 0.00111960992137718, "kl": 0.01010620318418849, "entropy": 1.2531555224531374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 950.0, "episode_reward_min": 120.0, "episode_reward_mean": 395.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 39.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 430.0, 290.0, 330.0, 320.0, 420.0, 490.0, 330.0, 150.0, 290.0, 410.0, 185.0, 550.0, 490.0, 290.0, 240.0, 730.0, 300.0, 450.0, 270.0, 310.0, 250.0, 410.0, 400.0, 820.0, 270.0, 290.0, 130.0, 240.0, 150.0, 160.0, 170.0, 320.0, 300.0, 335.0, 240.0, 400.0, 370.0, 260.0, 440.0, 120.0, 150.0, 620.0, 300.0, 440.0, 290.0, 465.0, 400.0, 670.0, 220.0, 130.0, 150.0, 680.0, 335.0, 340.0, 640.0, 200.0, 560.0, 950.0, 570.0, 320.0, 795.0, 405.0, 550.0, 370.0, 675.0, 460.0, 340.0, 410.0, 510.0, 470.0, 920.0, 350.0, 330.0, 360.0, 570.0, 370.0, 380.0, 440.0, 570.0, 255.0, 610.0, 550.0, 150.0, 590.0, 540.0, 280.0, 360.0, 210.0, 550.0, 520.0, 260.0, 605.0, 145.0, 270.0, 435.0, 500.0, 375.0, 600.0, 290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 20.0, 30.0, 150.0, 30.0, 10.0, 10.0, 20.0, 70.0, -20.0, 20.0, 10.0, 150.0, 40.0, 0.0, 40.0, 60.0, 30.0, 100.0, -40.0, 20.0, 0.0, 180.0, 20.0, 30.0, 30.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 30.0, 110.0, 20.0, 30.0, 10.0, 70.0, 0.0, 80.0, 30.0, 0.0, 60.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 280.0, 30.0, 0.0, 50.0, 180.0, 30.0, 80.0, 20.0, 40.0, 10.0, 50.0, 160.0, 50.0, -40.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 50.0, 0.0, 30.0, 10.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 160.0, 0.0, 20.0, 20.0, 40.0, 40.0, 70.0, 10.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 10.0, 15.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 250.0, 60.0, 100.0, 50.0, 30.0, 20.0, 50.0, -20.0, -40.0, 50.0, 10.0, 40.0, 40.0, 40.0, 50.0, 0.0, 280.0, 0.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 30.0, 10.0, 0.0, 180.0, 40.0, 0.0, 30.0, 10.0, 60.0, 170.0, 40.0, 160.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 30.0, 60.0, 40.0, 40.0, 0.0, 20.0, 40.0, 160.0, 30.0, 20.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 70.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 20.0, 10.0, 130.0, 0.0, 0.0, 10.0, 20.0, 40.0, 80.0, 0.0, 30.0, 60.0, 10.0, 0.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 90.0, 30.0, 0.0, 20.0, 60.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 40.0, 20.0, 350.0, 10.0, 10.0, 20.0, -80.0, 20.0, 0.0, 50.0, 380.0, 60.0, 10.0, 30.0, 160.0, 0.0, 50.0, 80.0, 0.0, 80.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 30.0, 70.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 70.0, 70.0, 0.0, 10.0, 0.0, 0.0, 10.0, 50.0, 30.0, 0.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 30.0, 130.0, 30.0, 0.0, 40.0, 10.0, 50.0, 20.0, 30.0, 60.0, 20.0, 40.0, 190.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 40.0, -5.0, 10.0, 10.0, 80.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 50.0, 30.0, 140.0, 0.0, 170.0, 40.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 100.0, 20.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 60.0, 30.0, 80.0, 90.0, 20.0, 20.0, -35.0, 105.0, 40.0, 30.0, 40.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 10.0, 20.0, 90.0, 270.0, 20.0, 30.0, 30.0, 90.0, 40.0, 0.0, 0.0, 50.0, 10.0, 0.0, 0.0, 50.0, 150.0, 0.0, 40.0, 70.0, 70.0, 40.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 20.0, 10.0, 10.0, 60.0, 20.0, -5.0, 40.0, 170.0, 0.0, -130.0, 210.0, 90.0, 60.0, 10.0, 40.0, 30.0, 10.0, 70.0, 50.0, 60.0, 60.0, 10.0, 50.0, 100.0, 60.0, 60.0, 50.0, 20.0, 50.0, 100.0, 160.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 40.0, 0.0, 0.0, 200.0, 50.0, -30.0, 40.0, 10.0, 30.0, 0.0, 80.0, 40.0, 260.0, -20.0, 10.0, 180.0, 30.0, 30.0, 0.0, 15.0, 10.0, 30.0, 50.0, 30.0, 30.0, 90.0, 20.0, 80.0, 10.0, 40.0, 40.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 70.0, 10.0, 0.0, 190.0, 260.0, 20.0, 20.0, 40.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 40.0, 0.0, 20.0, 100.0, 10.0, 90.0, 150.0, 110.0, 10.0, 30.0, -40.0, 40.0, 10.0, 180.0, 30.0, 50.0, 40.0, 580.0, 40.0, 20.0, 20.0, 30.0, 20.0, 380.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 170.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 70.0, 80.0, 20.0, 270.0, 170.0, 40.0, 65.0, 40.0, 20.0, 100.0, 40.0, 90.0, 60.0, 25.0, 0.0, 60.0, 0.0, 30.0, 0.0, 90.0, 20.0, 40.0, 0.0, 20.0, 250.0, 10.0, 10.0, 90.0, 20.0, 0.0, 0.0, 0.0, 80.0, 30.0, 40.0, 0.0, 40.0, 20.0, 160.0, 60.0, 60.0, 60.0, 70.0, -5.0, 20.0, 10.0, 40.0, 300.0, 60.0, 20.0, 40.0, 10.0, 10.0, 0.0, 250.0, 50.0, 40.0, 10.0, 30.0, 60.0, 40.0, 30.0, 30.0, 30.0, 20.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 10.0, 40.0, 70.0, 30.0, 0.0, 40.0, 10.0, 90.0, -60.0, 30.0, 10.0, 160.0, 10.0, -30.0, 90.0, 260.0, 10.0, 30.0, 20.0, 190.0, 70.0, 50.0, 20.0, 30.0, 20.0, 40.0, 30.0, 0.0, 70.0, 90.0, 70.0, 200.0, 30.0, 80.0, 90.0, 80.0, 160.0, 50.0, 20.0, 10.0, 20.0, 30.0, 40.0, 70.0, 80.0, 30.0, 20.0, 30.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 10.0, 70.0, 40.0, 60.0, 20.0, 360.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 80.0, 50.0, 0.0, 0.0, 10.0, 100.0, 30.0, 10.0, 60.0, 60.0, -130.0, 180.0, 0.0, 60.0, 10.0, 40.0, 30.0, 260.0, -130.0, 0.0, 60.0, 10.0, 20.0, 20.0, 300.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 270.0, 30.0, 50.0, 40.0, 60.0, 50.0, 20.0, 10.0, 20.0, -5.0, 10.0, 10.0, 40.0, 10.0, 100.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 290.0, 160.0, 10.0, 0.0, 160.0, 30.0, 40.0, 0.0, 250.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 70.0, 0.0, 100.0, 30.0, 0.0, 100.0, 20.0, 60.0, 30.0, 180.0, 10.0, 40.0, 10.0, 40.0, 90.0, 40.0, 40.0, 50.0, 50.0, 170.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 0.0, 160.0, 0.0, 20.0, -30.0, 30.0, 20.0, 10.0, 150.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 100.0, 50.0, 40.0, 180.0, 30.0, 40.0, 40.0, 40.0, 80.0, -50.0, 60.0, 40.0, 170.0, 10.0, 60.0, 20.0, 40.0, 60.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 30.0, 50.0, 30.0, 65.0, -10.0, 160.0, 70.0, 40.0, 170.0, 0.0, 20.0, 0.0, 5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 50.0, 20.0, 40.0, 0.0, 40.0, 70.0, 90.0, 190.0, 20.0, 10.0, 20.0, 40.0, 0.0, 25.0, 20.0, 20.0, -40.0, 40.0, 190.0, -80.0, 50.0, 40.0, 20.0, 60.0, 160.0, 60.0, 60.0, 40.0, 30.0, 60.0, 20.0, 0.0, -55.0, 60.0, 90.0, 70.0, 50.0, 30.0, 70.0, 40.0, 0.0, 10.0, 370.0, 10.0, -30.0, 50.0, 10.0, 0.0, 10.0, 160.0, 30.0, 10.0, 20.0, 20.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1363711849616185, "mean_inference_ms": 2.7531538256260295, "mean_action_processing_ms": 0.8646081292476867, "mean_env_wait_ms": 2.793552303128006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03017425537109375, "StateBufferConnector_ms": 0.032806396484375, "ViewRequirementAgentConnector_ms": 1.2195005416870117}, "num_episodes": 18, "episode_return_max": 950.0, "episode_return_min": 120.0, "episode_return_mean": 395.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.496814033598405, "num_env_steps_trained_throughput_per_sec": 19.496814033598405, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 302262.214, "restore_workers_time_ms": 0.015, "training_step_time_ms": 302262.132, "sample_time_ms": 6302.682, "learn_time_ms": 295929.904, "learn_throughput": 13.517, "synch_weights_time_ms": 15.715}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 16, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-21-13", "timestamp": 1717215673, "time_this_iter_s": 205.17906880378723, "time_total_s": 6490.843494176865, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f860b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6490.843494176865, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.17, "ram_util_percent": 81.78103448275863}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0783706091272944, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.348184348523807, "policy_loss": -0.00955474061962848, "vf_loss": 5.356764625208066, "vf_explained_var": 7.26160530845959e-05, "kl": 0.009744662981499003, "entropy": 1.2108882376307242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 154935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 950.0, "episode_reward_min": 120.0, "episode_reward_mean": 419.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 41.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [450.0, 270.0, 310.0, 250.0, 410.0, 400.0, 820.0, 270.0, 290.0, 130.0, 240.0, 150.0, 160.0, 170.0, 320.0, 300.0, 335.0, 240.0, 400.0, 370.0, 260.0, 440.0, 120.0, 150.0, 620.0, 300.0, 440.0, 290.0, 465.0, 400.0, 670.0, 220.0, 130.0, 150.0, 680.0, 335.0, 340.0, 640.0, 200.0, 560.0, 950.0, 570.0, 320.0, 795.0, 405.0, 550.0, 370.0, 675.0, 460.0, 340.0, 410.0, 510.0, 470.0, 920.0, 350.0, 330.0, 360.0, 570.0, 370.0, 380.0, 440.0, 570.0, 255.0, 610.0, 550.0, 150.0, 590.0, 540.0, 280.0, 360.0, 210.0, 550.0, 520.0, 260.0, 605.0, 145.0, 270.0, 435.0, 500.0, 375.0, 600.0, 290.0, 480.0, 320.0, 825.0, 280.0, 420.0, 325.0, 700.0, 480.0, 920.0, 380.0, 630.0, 295.0, 630.0, 350.0, 840.0, 355.0, 340.0, 440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 40.0, 160.0, 30.0, 20.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 70.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 20.0, 10.0, 130.0, 0.0, 0.0, 10.0, 20.0, 40.0, 80.0, 0.0, 30.0, 60.0, 10.0, 0.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 90.0, 30.0, 0.0, 20.0, 60.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 40.0, 20.0, 350.0, 10.0, 10.0, 20.0, -80.0, 20.0, 0.0, 50.0, 380.0, 60.0, 10.0, 30.0, 160.0, 0.0, 50.0, 80.0, 0.0, 80.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 30.0, 70.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 70.0, 70.0, 0.0, 10.0, 0.0, 0.0, 10.0, 50.0, 30.0, 0.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 30.0, 130.0, 30.0, 0.0, 40.0, 10.0, 50.0, 20.0, 30.0, 60.0, 20.0, 40.0, 190.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 40.0, -5.0, 10.0, 10.0, 80.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 50.0, 30.0, 140.0, 0.0, 170.0, 40.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 100.0, 20.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 60.0, 30.0, 80.0, 90.0, 20.0, 20.0, -35.0, 105.0, 40.0, 30.0, 40.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 10.0, 20.0, 90.0, 270.0, 20.0, 30.0, 30.0, 90.0, 40.0, 0.0, 0.0, 50.0, 10.0, 0.0, 0.0, 50.0, 150.0, 0.0, 40.0, 70.0, 70.0, 40.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 20.0, 10.0, 10.0, 60.0, 20.0, -5.0, 40.0, 170.0, 0.0, -130.0, 210.0, 90.0, 60.0, 10.0, 40.0, 30.0, 10.0, 70.0, 50.0, 60.0, 60.0, 10.0, 50.0, 100.0, 60.0, 60.0, 50.0, 20.0, 50.0, 100.0, 160.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 40.0, 0.0, 0.0, 200.0, 50.0, -30.0, 40.0, 10.0, 30.0, 0.0, 80.0, 40.0, 260.0, -20.0, 10.0, 180.0, 30.0, 30.0, 0.0, 15.0, 10.0, 30.0, 50.0, 30.0, 30.0, 90.0, 20.0, 80.0, 10.0, 40.0, 40.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 70.0, 10.0, 0.0, 190.0, 260.0, 20.0, 20.0, 40.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 40.0, 0.0, 20.0, 100.0, 10.0, 90.0, 150.0, 110.0, 10.0, 30.0, -40.0, 40.0, 10.0, 180.0, 30.0, 50.0, 40.0, 580.0, 40.0, 20.0, 20.0, 30.0, 20.0, 380.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 170.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 70.0, 80.0, 20.0, 270.0, 170.0, 40.0, 65.0, 40.0, 20.0, 100.0, 40.0, 90.0, 60.0, 25.0, 0.0, 60.0, 0.0, 30.0, 0.0, 90.0, 20.0, 40.0, 0.0, 20.0, 250.0, 10.0, 10.0, 90.0, 20.0, 0.0, 0.0, 0.0, 80.0, 30.0, 40.0, 0.0, 40.0, 20.0, 160.0, 60.0, 60.0, 60.0, 70.0, -5.0, 20.0, 10.0, 40.0, 300.0, 60.0, 20.0, 40.0, 10.0, 10.0, 0.0, 250.0, 50.0, 40.0, 10.0, 30.0, 60.0, 40.0, 30.0, 30.0, 30.0, 20.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 10.0, 40.0, 70.0, 30.0, 0.0, 40.0, 10.0, 90.0, -60.0, 30.0, 10.0, 160.0, 10.0, -30.0, 90.0, 260.0, 10.0, 30.0, 20.0, 190.0, 70.0, 50.0, 20.0, 30.0, 20.0, 40.0, 30.0, 0.0, 70.0, 90.0, 70.0, 200.0, 30.0, 80.0, 90.0, 80.0, 160.0, 50.0, 20.0, 10.0, 20.0, 30.0, 40.0, 70.0, 80.0, 30.0, 20.0, 30.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 10.0, 70.0, 40.0, 60.0, 20.0, 360.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 80.0, 50.0, 0.0, 0.0, 10.0, 100.0, 30.0, 10.0, 60.0, 60.0, -130.0, 180.0, 0.0, 60.0, 10.0, 40.0, 30.0, 260.0, -130.0, 0.0, 60.0, 10.0, 20.0, 20.0, 300.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 270.0, 30.0, 50.0, 40.0, 60.0, 50.0, 20.0, 10.0, 20.0, -5.0, 10.0, 10.0, 40.0, 10.0, 100.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 290.0, 160.0, 10.0, 0.0, 160.0, 30.0, 40.0, 0.0, 250.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 70.0, 0.0, 100.0, 30.0, 0.0, 100.0, 20.0, 60.0, 30.0, 180.0, 10.0, 40.0, 10.0, 40.0, 90.0, 40.0, 40.0, 50.0, 50.0, 170.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 0.0, 160.0, 0.0, 20.0, -30.0, 30.0, 20.0, 10.0, 150.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 100.0, 50.0, 40.0, 180.0, 30.0, 40.0, 40.0, 40.0, 80.0, -50.0, 60.0, 40.0, 170.0, 10.0, 60.0, 20.0, 40.0, 60.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 30.0, 50.0, 30.0, 65.0, -10.0, 160.0, 70.0, 40.0, 170.0, 0.0, 20.0, 0.0, 5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 50.0, 20.0, 40.0, 0.0, 40.0, 70.0, 90.0, 190.0, 20.0, 10.0, 20.0, 40.0, 0.0, 25.0, 20.0, 20.0, -40.0, 40.0, 190.0, -80.0, 50.0, 40.0, 20.0, 60.0, 160.0, 60.0, 60.0, 40.0, 30.0, 60.0, 20.0, 0.0, -55.0, 60.0, 90.0, 70.0, 50.0, 30.0, 70.0, 40.0, 0.0, 10.0, 370.0, 10.0, -30.0, 50.0, 10.0, 0.0, 10.0, 160.0, 30.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 20.0, 40.0, 40.0, 40.0, 20.0, 30.0, 160.0, 40.0, 20.0, 40.0, 40.0, 20.0, 40.0, 40.0, 30.0, 40.0, 0.0, 50.0, -5.0, 10.0, 70.0, 80.0, 20.0, 500.0, 30.0, 70.0, 50.0, 0.0, 10.0, 40.0, 20.0, 0.0, 10.0, 0.0, 80.0, 40.0, 40.0, 40.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 70.0, -50.0, 250.0, 0.0, 30.0, 0.0, 50.0, 20.0, 50.0, 100.0, 60.0, 0.0, 5.0, 10.0, 180.0, 50.0, 170.0, 0.0, 100.0, 30.0, 30.0, 0.0, 50.0, 90.0, 40.0, 40.0, 50.0, 70.0, 80.0, 110.0, 20.0, 40.0, 10.0, 20.0, 30.0, 60.0, 160.0, -20.0, 10.0, 80.0, 20.0, 210.0, 370.0, 0.0, 40.0, 20.0, 30.0, 150.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 50.0, 180.0, 0.0, 110.0, 40.0, 10.0, 90.0, 50.0, 80.0, 10.0, 10.0, -5.0, 0.0, 50.0, 10.0, 0.0, 40.0, 20.0, 160.0, 380.0, -80.0, 80.0, 30.0, 160.0, -60.0, 40.0, 20.0, 40.0, 20.0, 0.0, -40.0, 20.0, 160.0, 40.0, 30.0, 90.0, 40.0, 10.0, 0.0, 50.0, 30.0, -140.0, 470.0, 70.0, 70.0, 30.0, 300.0, -30.0, -10.0, 35.0, 40.0, 70.0, 20.0, 40.0, 20.0, 10.0, 60.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 10.0, 90.0, 50.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 30.0, 30.0, 40.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1810491403431076, "mean_inference_ms": 2.8110810417594814, "mean_action_processing_ms": 0.8783530493964529, "mean_env_wait_ms": 2.8399277414799804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993534088134766, "StateBufferConnector_ms": 0.0324091911315918, "ViewRequirementAgentConnector_ms": 1.1412968635559082}, "num_episodes": 18, "episode_return_max": 950.0, "episode_return_min": 120.0, "episode_return_mean": 419.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.844186616643228, "num_env_steps_trained_throughput_per_sec": 19.844186616643228, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 299124.24, "restore_workers_time_ms": 0.015, "training_step_time_ms": 299124.159, "sample_time_ms": 6355.926, "learn_time_ms": 292739.448, "learn_throughput": 13.664, "synch_weights_time_ms": 15.619}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 17, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-24-35", "timestamp": 1717215875, "time_this_iter_s": 201.5919051170349, "time_total_s": 6692.4353992938995, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f824ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6692.4353992938995, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.12, "ram_util_percent": 81.38912280701754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2170728540902958, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.8989489317194215, "policy_loss": -0.010253342509337158, "vf_loss": 5.908256579867313, "vf_explained_var": 0.0005043913127261355, "kl": 0.009456931338304888, "entropy": 1.1732648890874129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 164325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 950.0, "episode_reward_min": 120.0, "episode_reward_mean": 459.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 45.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 370.0, 260.0, 440.0, 120.0, 150.0, 620.0, 300.0, 440.0, 290.0, 465.0, 400.0, 670.0, 220.0, 130.0, 150.0, 680.0, 335.0, 340.0, 640.0, 200.0, 560.0, 950.0, 570.0, 320.0, 795.0, 405.0, 550.0, 370.0, 675.0, 460.0, 340.0, 410.0, 510.0, 470.0, 920.0, 350.0, 330.0, 360.0, 570.0, 370.0, 380.0, 440.0, 570.0, 255.0, 610.0, 550.0, 150.0, 590.0, 540.0, 280.0, 360.0, 210.0, 550.0, 520.0, 260.0, 605.0, 145.0, 270.0, 435.0, 500.0, 375.0, 600.0, 290.0, 480.0, 320.0, 825.0, 280.0, 420.0, 325.0, 700.0, 480.0, 920.0, 380.0, 630.0, 295.0, 630.0, 350.0, 840.0, 355.0, 340.0, 440.0, 410.0, 420.0, 310.0, 570.0, 275.0, 890.0, 220.0, 540.0, 590.0, 650.0, 250.0, 640.0, 490.0, 900.0, 310.0, 750.0, 550.0, 755.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 50.0, 30.0, 140.0, 0.0, 170.0, 40.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 100.0, 20.0, 0.0, 0.0, 40.0, 30.0, 40.0, 20.0, 60.0, 30.0, 80.0, 90.0, 20.0, 20.0, -35.0, 105.0, 40.0, 30.0, 40.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 10.0, 20.0, 90.0, 270.0, 20.0, 30.0, 30.0, 90.0, 40.0, 0.0, 0.0, 50.0, 10.0, 0.0, 0.0, 50.0, 150.0, 0.0, 40.0, 70.0, 70.0, 40.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 20.0, 10.0, 10.0, 60.0, 20.0, -5.0, 40.0, 170.0, 0.0, -130.0, 210.0, 90.0, 60.0, 10.0, 40.0, 30.0, 10.0, 70.0, 50.0, 60.0, 60.0, 10.0, 50.0, 100.0, 60.0, 60.0, 50.0, 20.0, 50.0, 100.0, 160.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 40.0, 0.0, 0.0, 200.0, 50.0, -30.0, 40.0, 10.0, 30.0, 0.0, 80.0, 40.0, 260.0, -20.0, 10.0, 180.0, 30.0, 30.0, 0.0, 15.0, 10.0, 30.0, 50.0, 30.0, 30.0, 90.0, 20.0, 80.0, 10.0, 40.0, 40.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 70.0, 10.0, 0.0, 190.0, 260.0, 20.0, 20.0, 40.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 40.0, 0.0, 20.0, 100.0, 10.0, 90.0, 150.0, 110.0, 10.0, 30.0, -40.0, 40.0, 10.0, 180.0, 30.0, 50.0, 40.0, 580.0, 40.0, 20.0, 20.0, 30.0, 20.0, 380.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 170.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 70.0, 80.0, 20.0, 270.0, 170.0, 40.0, 65.0, 40.0, 20.0, 100.0, 40.0, 90.0, 60.0, 25.0, 0.0, 60.0, 0.0, 30.0, 0.0, 90.0, 20.0, 40.0, 0.0, 20.0, 250.0, 10.0, 10.0, 90.0, 20.0, 0.0, 0.0, 0.0, 80.0, 30.0, 40.0, 0.0, 40.0, 20.0, 160.0, 60.0, 60.0, 60.0, 70.0, -5.0, 20.0, 10.0, 40.0, 300.0, 60.0, 20.0, 40.0, 10.0, 10.0, 0.0, 250.0, 50.0, 40.0, 10.0, 30.0, 60.0, 40.0, 30.0, 30.0, 30.0, 20.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 10.0, 40.0, 70.0, 30.0, 0.0, 40.0, 10.0, 90.0, -60.0, 30.0, 10.0, 160.0, 10.0, -30.0, 90.0, 260.0, 10.0, 30.0, 20.0, 190.0, 70.0, 50.0, 20.0, 30.0, 20.0, 40.0, 30.0, 0.0, 70.0, 90.0, 70.0, 200.0, 30.0, 80.0, 90.0, 80.0, 160.0, 50.0, 20.0, 10.0, 20.0, 30.0, 40.0, 70.0, 80.0, 30.0, 20.0, 30.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 10.0, 70.0, 40.0, 60.0, 20.0, 360.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 80.0, 50.0, 0.0, 0.0, 10.0, 100.0, 30.0, 10.0, 60.0, 60.0, -130.0, 180.0, 0.0, 60.0, 10.0, 40.0, 30.0, 260.0, -130.0, 0.0, 60.0, 10.0, 20.0, 20.0, 300.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 270.0, 30.0, 50.0, 40.0, 60.0, 50.0, 20.0, 10.0, 20.0, -5.0, 10.0, 10.0, 40.0, 10.0, 100.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 290.0, 160.0, 10.0, 0.0, 160.0, 30.0, 40.0, 0.0, 250.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 70.0, 0.0, 100.0, 30.0, 0.0, 100.0, 20.0, 60.0, 30.0, 180.0, 10.0, 40.0, 10.0, 40.0, 90.0, 40.0, 40.0, 50.0, 50.0, 170.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 0.0, 160.0, 0.0, 20.0, -30.0, 30.0, 20.0, 10.0, 150.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 100.0, 50.0, 40.0, 180.0, 30.0, 40.0, 40.0, 40.0, 80.0, -50.0, 60.0, 40.0, 170.0, 10.0, 60.0, 20.0, 40.0, 60.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 30.0, 50.0, 30.0, 65.0, -10.0, 160.0, 70.0, 40.0, 170.0, 0.0, 20.0, 0.0, 5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 50.0, 20.0, 40.0, 0.0, 40.0, 70.0, 90.0, 190.0, 20.0, 10.0, 20.0, 40.0, 0.0, 25.0, 20.0, 20.0, -40.0, 40.0, 190.0, -80.0, 50.0, 40.0, 20.0, 60.0, 160.0, 60.0, 60.0, 40.0, 30.0, 60.0, 20.0, 0.0, -55.0, 60.0, 90.0, 70.0, 50.0, 30.0, 70.0, 40.0, 0.0, 10.0, 370.0, 10.0, -30.0, 50.0, 10.0, 0.0, 10.0, 160.0, 30.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 20.0, 40.0, 40.0, 40.0, 20.0, 30.0, 160.0, 40.0, 20.0, 40.0, 40.0, 20.0, 40.0, 40.0, 30.0, 40.0, 0.0, 50.0, -5.0, 10.0, 70.0, 80.0, 20.0, 500.0, 30.0, 70.0, 50.0, 0.0, 10.0, 40.0, 20.0, 0.0, 10.0, 0.0, 80.0, 40.0, 40.0, 40.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 70.0, -50.0, 250.0, 0.0, 30.0, 0.0, 50.0, 20.0, 50.0, 100.0, 60.0, 0.0, 5.0, 10.0, 180.0, 50.0, 170.0, 0.0, 100.0, 30.0, 30.0, 0.0, 50.0, 90.0, 40.0, 40.0, 50.0, 70.0, 80.0, 110.0, 20.0, 40.0, 10.0, 20.0, 30.0, 60.0, 160.0, -20.0, 10.0, 80.0, 20.0, 210.0, 370.0, 0.0, 40.0, 20.0, 30.0, 150.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 50.0, 180.0, 0.0, 110.0, 40.0, 10.0, 90.0, 50.0, 80.0, 10.0, 10.0, -5.0, 0.0, 50.0, 10.0, 0.0, 40.0, 20.0, 160.0, 380.0, -80.0, 80.0, 30.0, 160.0, -60.0, 40.0, 20.0, 40.0, 20.0, 0.0, -40.0, 20.0, 160.0, 40.0, 30.0, 90.0, 40.0, 10.0, 0.0, 50.0, 30.0, -140.0, 470.0, 70.0, 70.0, 30.0, 300.0, -30.0, -10.0, 35.0, 40.0, 70.0, 20.0, 40.0, 20.0, 10.0, 60.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 10.0, 90.0, 50.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 30.0, 30.0, 40.0, 120.0, 20.0, 20.0, 40.0, 110.0, 60.0, 60.0, 10.0, 40.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 60.0, 110.0, 80.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 60.0, 20.0, 10.0, 10.0, 30.0, 80.0, 80.0, 70.0, 170.0, 80.0, 30.0, -10.0, 30.0, 40.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 80.0, 150.0, 0.0, 10.0, 0.0, 5.0, 30.0, 10.0, 120.0, 40.0, 40.0, 40.0, 190.0, 50.0, 350.0, 20.0, 90.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 50.0, 20.0, 80.0, 20.0, 190.0, 20.0, 80.0, 10.0, 10.0, 40.0, 40.0, 100.0, 40.0, 60.0, 0.0, 50.0, 20.0, 170.0, 70.0, 40.0, 140.0, 30.0, 90.0, 50.0, 0.0, 160.0, 20.0, 100.0, 20.0, 30.0, 40.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 40.0, 60.0, 50.0, 70.0, 190.0, 20.0, 30.0, 40.0, 30.0, -100.0, 20.0, 40.0, 170.0, 30.0, 270.0, -60.0, 50.0, 40.0, 30.0, 470.0, -10.0, 160.0, 30.0, 80.0, 50.0, 40.0, 10.0, 30.0, 0.0, 20.0, 70.0, 20.0, 10.0, 60.0, 50.0, 40.0, 10.0, 80.0, 100.0, 20.0, 180.0, 30.0, 100.0, 30.0, 0.0, 150.0, 60.0, 40.0, 40.0, 180.0, 90.0, 10.0, 30.0, 10.0, 40.0, 70.0, 40.0, 5.0, 40.0, 120.0, 60.0, 80.0, 50.0, 20.0, 40.0, 300.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1998170981143064, "mean_inference_ms": 2.8437388031426463, "mean_action_processing_ms": 0.8845460987532939, "mean_env_wait_ms": 2.8606760361856036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025034427642822266, "StateBufferConnector_ms": 0.02410292625427246, "ViewRequirementAgentConnector_ms": 1.0204391479492188}, "num_episodes": 18, "episode_return_max": 950.0, "episode_return_min": 120.0, "episode_return_mean": 459.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.85692982791006, "num_env_steps_trained_throughput_per_sec": 19.85692982791006, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 292535.836, "restore_workers_time_ms": 0.015, "training_step_time_ms": 292535.752, "sample_time_ms": 6139.125, "learn_time_ms": 286369.203, "learn_throughput": 13.968, "synch_weights_time_ms": 15.024}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 18, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-27-56", "timestamp": 1717216076, "time_this_iter_s": 201.44902300834656, "time_total_s": 6893.884422302246, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f860a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6893.884422302246, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.992631578947368, "ram_util_percent": 80.20807017543859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.340208941666336, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.717294134651891, "policy_loss": -0.010740231960308683, "vf_loss": 5.727031750724719, "vf_explained_var": -6.06080848441972e-05, "kl": 0.010026167946748411, "entropy": 1.156434579715688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 173715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 1090.0, "episode_reward_min": 145.0, "episode_reward_mean": 495.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 49.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 570.0, 320.0, 795.0, 405.0, 550.0, 370.0, 675.0, 460.0, 340.0, 410.0, 510.0, 470.0, 920.0, 350.0, 330.0, 360.0, 570.0, 370.0, 380.0, 440.0, 570.0, 255.0, 610.0, 550.0, 150.0, 590.0, 540.0, 280.0, 360.0, 210.0, 550.0, 520.0, 260.0, 605.0, 145.0, 270.0, 435.0, 500.0, 375.0, 600.0, 290.0, 480.0, 320.0, 825.0, 280.0, 420.0, 325.0, 700.0, 480.0, 920.0, 380.0, 630.0, 295.0, 630.0, 350.0, 840.0, 355.0, 340.0, 440.0, 410.0, 420.0, 310.0, 570.0, 275.0, 890.0, 220.0, 540.0, 590.0, 650.0, 250.0, 640.0, 490.0, 900.0, 310.0, 750.0, 550.0, 755.0, 210.0, 385.0, 470.0, 410.0, 635.0, 600.0, 240.0, 590.0, 490.0, 520.0, 490.0, 1050.0, 810.0, 1090.0, 620.0, 320.0, 240.0, 570.0, 665.0, 640.0, 250.0, 560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-40.0, 40.0, 10.0, 180.0, 30.0, 50.0, 40.0, 580.0, 40.0, 20.0, 20.0, 30.0, 20.0, 380.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 170.0, 40.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 70.0, 80.0, 20.0, 270.0, 170.0, 40.0, 65.0, 40.0, 20.0, 100.0, 40.0, 90.0, 60.0, 25.0, 0.0, 60.0, 0.0, 30.0, 0.0, 90.0, 20.0, 40.0, 0.0, 20.0, 250.0, 10.0, 10.0, 90.0, 20.0, 0.0, 0.0, 0.0, 80.0, 30.0, 40.0, 0.0, 40.0, 20.0, 160.0, 60.0, 60.0, 60.0, 70.0, -5.0, 20.0, 10.0, 40.0, 300.0, 60.0, 20.0, 40.0, 10.0, 10.0, 0.0, 250.0, 50.0, 40.0, 10.0, 30.0, 60.0, 40.0, 30.0, 30.0, 30.0, 20.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 10.0, 40.0, 70.0, 30.0, 0.0, 40.0, 10.0, 90.0, -60.0, 30.0, 10.0, 160.0, 10.0, -30.0, 90.0, 260.0, 10.0, 30.0, 20.0, 190.0, 70.0, 50.0, 20.0, 30.0, 20.0, 40.0, 30.0, 0.0, 70.0, 90.0, 70.0, 200.0, 30.0, 80.0, 90.0, 80.0, 160.0, 50.0, 20.0, 10.0, 20.0, 30.0, 40.0, 70.0, 80.0, 30.0, 20.0, 30.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 10.0, 70.0, 40.0, 60.0, 20.0, 360.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 80.0, 50.0, 0.0, 0.0, 10.0, 100.0, 30.0, 10.0, 60.0, 60.0, -130.0, 180.0, 0.0, 60.0, 10.0, 40.0, 30.0, 260.0, -130.0, 0.0, 60.0, 10.0, 20.0, 20.0, 300.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 10.0, 270.0, 30.0, 50.0, 40.0, 60.0, 50.0, 20.0, 10.0, 20.0, -5.0, 10.0, 10.0, 40.0, 10.0, 100.0, 30.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 290.0, 160.0, 10.0, 0.0, 160.0, 30.0, 40.0, 0.0, 250.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 70.0, 0.0, 100.0, 30.0, 0.0, 100.0, 20.0, 60.0, 30.0, 180.0, 10.0, 40.0, 10.0, 40.0, 90.0, 40.0, 40.0, 50.0, 50.0, 170.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 0.0, 160.0, 0.0, 20.0, -30.0, 30.0, 20.0, 10.0, 150.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 100.0, 50.0, 40.0, 180.0, 30.0, 40.0, 40.0, 40.0, 80.0, -50.0, 60.0, 40.0, 170.0, 10.0, 60.0, 20.0, 40.0, 60.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 30.0, 50.0, 30.0, 65.0, -10.0, 160.0, 70.0, 40.0, 170.0, 0.0, 20.0, 0.0, 5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 50.0, 20.0, 40.0, 0.0, 40.0, 70.0, 90.0, 190.0, 20.0, 10.0, 20.0, 40.0, 0.0, 25.0, 20.0, 20.0, -40.0, 40.0, 190.0, -80.0, 50.0, 40.0, 20.0, 60.0, 160.0, 60.0, 60.0, 40.0, 30.0, 60.0, 20.0, 0.0, -55.0, 60.0, 90.0, 70.0, 50.0, 30.0, 70.0, 40.0, 0.0, 10.0, 370.0, 10.0, -30.0, 50.0, 10.0, 0.0, 10.0, 160.0, 30.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 20.0, 40.0, 40.0, 40.0, 20.0, 30.0, 160.0, 40.0, 20.0, 40.0, 40.0, 20.0, 40.0, 40.0, 30.0, 40.0, 0.0, 50.0, -5.0, 10.0, 70.0, 80.0, 20.0, 500.0, 30.0, 70.0, 50.0, 0.0, 10.0, 40.0, 20.0, 0.0, 10.0, 0.0, 80.0, 40.0, 40.0, 40.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 70.0, -50.0, 250.0, 0.0, 30.0, 0.0, 50.0, 20.0, 50.0, 100.0, 60.0, 0.0, 5.0, 10.0, 180.0, 50.0, 170.0, 0.0, 100.0, 30.0, 30.0, 0.0, 50.0, 90.0, 40.0, 40.0, 50.0, 70.0, 80.0, 110.0, 20.0, 40.0, 10.0, 20.0, 30.0, 60.0, 160.0, -20.0, 10.0, 80.0, 20.0, 210.0, 370.0, 0.0, 40.0, 20.0, 30.0, 150.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 50.0, 180.0, 0.0, 110.0, 40.0, 10.0, 90.0, 50.0, 80.0, 10.0, 10.0, -5.0, 0.0, 50.0, 10.0, 0.0, 40.0, 20.0, 160.0, 380.0, -80.0, 80.0, 30.0, 160.0, -60.0, 40.0, 20.0, 40.0, 20.0, 0.0, -40.0, 20.0, 160.0, 40.0, 30.0, 90.0, 40.0, 10.0, 0.0, 50.0, 30.0, -140.0, 470.0, 70.0, 70.0, 30.0, 300.0, -30.0, -10.0, 35.0, 40.0, 70.0, 20.0, 40.0, 20.0, 10.0, 60.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 10.0, 90.0, 50.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 30.0, 30.0, 40.0, 120.0, 20.0, 20.0, 40.0, 110.0, 60.0, 60.0, 10.0, 40.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 60.0, 110.0, 80.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 60.0, 20.0, 10.0, 10.0, 30.0, 80.0, 80.0, 70.0, 170.0, 80.0, 30.0, -10.0, 30.0, 40.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 80.0, 150.0, 0.0, 10.0, 0.0, 5.0, 30.0, 10.0, 120.0, 40.0, 40.0, 40.0, 190.0, 50.0, 350.0, 20.0, 90.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 50.0, 20.0, 80.0, 20.0, 190.0, 20.0, 80.0, 10.0, 10.0, 40.0, 40.0, 100.0, 40.0, 60.0, 0.0, 50.0, 20.0, 170.0, 70.0, 40.0, 140.0, 30.0, 90.0, 50.0, 0.0, 160.0, 20.0, 100.0, 20.0, 30.0, 40.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 40.0, 60.0, 50.0, 70.0, 190.0, 20.0, 30.0, 40.0, 30.0, -100.0, 20.0, 40.0, 170.0, 30.0, 270.0, -60.0, 50.0, 40.0, 30.0, 470.0, -10.0, 160.0, 30.0, 80.0, 50.0, 40.0, 10.0, 30.0, 0.0, 20.0, 70.0, 20.0, 10.0, 60.0, 50.0, 40.0, 10.0, 80.0, 100.0, 20.0, 180.0, 30.0, 100.0, 30.0, 0.0, 150.0, 60.0, 40.0, 40.0, 180.0, 90.0, 10.0, 30.0, 10.0, 40.0, 70.0, 40.0, 5.0, 40.0, 120.0, 60.0, 80.0, 50.0, 20.0, 40.0, 300.0, 40.0, 40.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 200.0, 0.0, 10.0, 10.0, 35.0, 40.0, 20.0, -50.0, 10.0, 50.0, 350.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 30.0, 180.0, 60.0, 10.0, 40.0, 5.0, 30.0, 120.0, 0.0, 180.0, 10.0, 20.0, 60.0, 70.0, 10.0, 30.0, -40.0, 30.0, 30.0, 350.0, 40.0, 0.0, 20.0, 70.0, 30.0, 20.0, 0.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 40.0, 70.0, 60.0, 110.0, 40.0, 10.0, 210.0, 120.0, 80.0, 10.0, 30.0, 60.0, 70.0, 30.0, 0.0, 50.0, 40.0, 0.0, 20.0, 190.0, 20.0, 30.0, 80.0, 30.0, 50.0, 80.0, 20.0, 20.0, 30.0, 0.0, 150.0, 10.0, 20.0, 50.0, 160.0, -10.0, 60.0, 0.0, 40.0, 80.0, 40.0, 180.0, 50.0, 300.0, 170.0, 60.0, 130.0, 260.0, 60.0, 20.0, 50.0, 40.0, 30.0, 260.0, 0.0, 40.0, 50.0, 40.0, 90.0, 410.0, -40.0, 50.0, -30.0, 370.0, 20.0, 90.0, 90.0, 40.0, 40.0, 10.0, 20.0, 210.0, 160.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 30.0, 70.0, 30.0, 60.0, 50.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 80.0, 0.0, 0.0, 40.0, 30.0, 30.0, 40.0, -50.0, -50.0, 70.0, 0.0, 350.0, 30.0, 0.0, 60.0, 120.0, 130.0, 15.0, 20.0, 160.0, 60.0, 30.0, 70.0, 10.0, 160.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 50.0, 0.0, 80.0, 260.0, 30.0, 10.0, 0.0, 20.0, 10.0, 150.0, 0.0, 10.0, 10.0, 20.0, 20.0, 40.0, 60.0, 30.0, 0.0, 90.0, 40.0, 70.0, 180.0, 0.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.177322889503539, "mean_inference_ms": 2.839860559553931, "mean_action_processing_ms": 0.8804427425335207, "mean_env_wait_ms": 2.8440650080514693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0207822322845459, "StateBufferConnector_ms": 0.01732778549194336, "ViewRequirementAgentConnector_ms": 0.7734556198120117}, "num_episodes": 22, "episode_return_max": 1090.0, "episode_return_min": 145.0, "episode_return_mean": 495.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.913136118349936, "num_env_steps_trained_throughput_per_sec": 19.913136118349936, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 283181.439, "restore_workers_time_ms": 0.014, "training_step_time_ms": 283181.355, "sample_time_ms": 5792.363, "learn_time_ms": 277361.702, "learn_throughput": 14.422, "synch_weights_time_ms": 14.356}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 19, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-31-17", "timestamp": 1717216277, "time_this_iter_s": 200.8818380832672, "time_total_s": 7094.766260385513, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8194c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7094.766260385513, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.86549295774648, "ram_util_percent": 81.018661971831}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1757118637950277, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.891640041481319, "policy_loss": -0.010912836453762337, "vf_loss": 5.9016185322254735, "vf_explained_var": 0.000485153389941897, "kl": 0.009343486273423242, "entropy": 1.1000572627916123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 183105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 1090.0, "episode_reward_min": 145.0, "episode_reward_mean": 492.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 500.0}, "policy_reward_mean": {"policy_0": 49.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [610.0, 550.0, 150.0, 590.0, 540.0, 280.0, 360.0, 210.0, 550.0, 520.0, 260.0, 605.0, 145.0, 270.0, 435.0, 500.0, 375.0, 600.0, 290.0, 480.0, 320.0, 825.0, 280.0, 420.0, 325.0, 700.0, 480.0, 920.0, 380.0, 630.0, 295.0, 630.0, 350.0, 840.0, 355.0, 340.0, 440.0, 410.0, 420.0, 310.0, 570.0, 275.0, 890.0, 220.0, 540.0, 590.0, 650.0, 250.0, 640.0, 490.0, 900.0, 310.0, 750.0, 550.0, 755.0, 210.0, 385.0, 470.0, 410.0, 635.0, 600.0, 240.0, 590.0, 490.0, 520.0, 490.0, 1050.0, 810.0, 1090.0, 620.0, 320.0, 240.0, 570.0, 665.0, 640.0, 250.0, 560.0, 250.0, 730.0, 490.0, 620.0, 940.0, 470.0, 285.0, 510.0, 230.0, 270.0, 535.0, 290.0, 530.0, 700.0, 500.0, 410.0, 380.0, 460.0, 250.0, 725.0, 540.0, 550.0, 385.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 290.0, 160.0, 10.0, 0.0, 160.0, 30.0, 40.0, 0.0, 250.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 70.0, 0.0, 100.0, 30.0, 0.0, 100.0, 20.0, 60.0, 30.0, 180.0, 10.0, 40.0, 10.0, 40.0, 90.0, 40.0, 40.0, 50.0, 50.0, 170.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 0.0, 160.0, 0.0, 20.0, -30.0, 30.0, 20.0, 10.0, 150.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 30.0, 20.0, 100.0, 50.0, 40.0, 180.0, 30.0, 40.0, 40.0, 40.0, 80.0, -50.0, 60.0, 40.0, 170.0, 10.0, 60.0, 20.0, 40.0, 60.0, 50.0, 10.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 30.0, 50.0, 30.0, 65.0, -10.0, 160.0, 70.0, 40.0, 170.0, 0.0, 20.0, 0.0, 5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 50.0, 20.0, 40.0, 0.0, 40.0, 70.0, 90.0, 190.0, 20.0, 10.0, 20.0, 40.0, 0.0, 25.0, 20.0, 20.0, -40.0, 40.0, 190.0, -80.0, 50.0, 40.0, 20.0, 60.0, 160.0, 60.0, 60.0, 40.0, 30.0, 60.0, 20.0, 0.0, -55.0, 60.0, 90.0, 70.0, 50.0, 30.0, 70.0, 40.0, 0.0, 10.0, 370.0, 10.0, -30.0, 50.0, 10.0, 0.0, 10.0, 160.0, 30.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 20.0, 40.0, 40.0, 40.0, 20.0, 30.0, 160.0, 40.0, 20.0, 40.0, 40.0, 20.0, 40.0, 40.0, 30.0, 40.0, 0.0, 50.0, -5.0, 10.0, 70.0, 80.0, 20.0, 500.0, 30.0, 70.0, 50.0, 0.0, 10.0, 40.0, 20.0, 0.0, 10.0, 0.0, 80.0, 40.0, 40.0, 40.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 70.0, -50.0, 250.0, 0.0, 30.0, 0.0, 50.0, 20.0, 50.0, 100.0, 60.0, 0.0, 5.0, 10.0, 180.0, 50.0, 170.0, 0.0, 100.0, 30.0, 30.0, 0.0, 50.0, 90.0, 40.0, 40.0, 50.0, 70.0, 80.0, 110.0, 20.0, 40.0, 10.0, 20.0, 30.0, 60.0, 160.0, -20.0, 10.0, 80.0, 20.0, 210.0, 370.0, 0.0, 40.0, 20.0, 30.0, 150.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 50.0, 180.0, 0.0, 110.0, 40.0, 10.0, 90.0, 50.0, 80.0, 10.0, 10.0, -5.0, 0.0, 50.0, 10.0, 0.0, 40.0, 20.0, 160.0, 380.0, -80.0, 80.0, 30.0, 160.0, -60.0, 40.0, 20.0, 40.0, 20.0, 0.0, -40.0, 20.0, 160.0, 40.0, 30.0, 90.0, 40.0, 10.0, 0.0, 50.0, 30.0, -140.0, 470.0, 70.0, 70.0, 30.0, 300.0, -30.0, -10.0, 35.0, 40.0, 70.0, 20.0, 40.0, 20.0, 10.0, 60.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 10.0, 90.0, 50.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 30.0, 30.0, 40.0, 120.0, 20.0, 20.0, 40.0, 110.0, 60.0, 60.0, 10.0, 40.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 60.0, 110.0, 80.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 60.0, 20.0, 10.0, 10.0, 30.0, 80.0, 80.0, 70.0, 170.0, 80.0, 30.0, -10.0, 30.0, 40.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 80.0, 150.0, 0.0, 10.0, 0.0, 5.0, 30.0, 10.0, 120.0, 40.0, 40.0, 40.0, 190.0, 50.0, 350.0, 20.0, 90.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 50.0, 20.0, 80.0, 20.0, 190.0, 20.0, 80.0, 10.0, 10.0, 40.0, 40.0, 100.0, 40.0, 60.0, 0.0, 50.0, 20.0, 170.0, 70.0, 40.0, 140.0, 30.0, 90.0, 50.0, 0.0, 160.0, 20.0, 100.0, 20.0, 30.0, 40.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 40.0, 60.0, 50.0, 70.0, 190.0, 20.0, 30.0, 40.0, 30.0, -100.0, 20.0, 40.0, 170.0, 30.0, 270.0, -60.0, 50.0, 40.0, 30.0, 470.0, -10.0, 160.0, 30.0, 80.0, 50.0, 40.0, 10.0, 30.0, 0.0, 20.0, 70.0, 20.0, 10.0, 60.0, 50.0, 40.0, 10.0, 80.0, 100.0, 20.0, 180.0, 30.0, 100.0, 30.0, 0.0, 150.0, 60.0, 40.0, 40.0, 180.0, 90.0, 10.0, 30.0, 10.0, 40.0, 70.0, 40.0, 5.0, 40.0, 120.0, 60.0, 80.0, 50.0, 20.0, 40.0, 300.0, 40.0, 40.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 200.0, 0.0, 10.0, 10.0, 35.0, 40.0, 20.0, -50.0, 10.0, 50.0, 350.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 30.0, 180.0, 60.0, 10.0, 40.0, 5.0, 30.0, 120.0, 0.0, 180.0, 10.0, 20.0, 60.0, 70.0, 10.0, 30.0, -40.0, 30.0, 30.0, 350.0, 40.0, 0.0, 20.0, 70.0, 30.0, 20.0, 0.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 40.0, 70.0, 60.0, 110.0, 40.0, 10.0, 210.0, 120.0, 80.0, 10.0, 30.0, 60.0, 70.0, 30.0, 0.0, 50.0, 40.0, 0.0, 20.0, 190.0, 20.0, 30.0, 80.0, 30.0, 50.0, 80.0, 20.0, 20.0, 30.0, 0.0, 150.0, 10.0, 20.0, 50.0, 160.0, -10.0, 60.0, 0.0, 40.0, 80.0, 40.0, 180.0, 50.0, 300.0, 170.0, 60.0, 130.0, 260.0, 60.0, 20.0, 50.0, 40.0, 30.0, 260.0, 0.0, 40.0, 50.0, 40.0, 90.0, 410.0, -40.0, 50.0, -30.0, 370.0, 20.0, 90.0, 90.0, 40.0, 40.0, 10.0, 20.0, 210.0, 160.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 30.0, 70.0, 30.0, 60.0, 50.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 80.0, 0.0, 0.0, 40.0, 30.0, 30.0, 40.0, -50.0, -50.0, 70.0, 0.0, 350.0, 30.0, 0.0, 60.0, 120.0, 130.0, 15.0, 20.0, 160.0, 60.0, 30.0, 70.0, 10.0, 160.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 50.0, 0.0, 80.0, 260.0, 30.0, 10.0, 0.0, 20.0, 10.0, 150.0, 0.0, 10.0, 10.0, 20.0, 20.0, 40.0, 60.0, 30.0, 0.0, 90.0, 40.0, 70.0, 180.0, 0.0, 50.0, 10.0, 80.0, 0.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 0.0, 40.0, 20.0, 50.0, 40.0, 30.0, 30.0, 90.0, 20.0, 150.0, 260.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 30.0, 10.0, 0.0, 390.0, 250.0, 10.0, 80.0, 60.0, 30.0, 60.0, 60.0, 40.0, 40.0, -10.0, 20.0, 10.0, 80.0, 200.0, 60.0, 360.0, 70.0, 20.0, 50.0, 70.0, 60.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 50.0, 90.0, 20.0, 10.0, -5.0, 160.0, 30.0, 50.0, 0.0, 0.0, 10.0, 10.0, 160.0, 40.0, 60.0, 40.0, 20.0, 0.0, 40.0, 50.0, 80.0, 20.0, 10.0, 130.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 50.0, 20.0, 0.0, 30.0, 0.0, 0.0, 40.0, 80.0, 50.0, 15.0, 20.0, 60.0, 10.0, 70.0, 0.0, 160.0, 40.0, 110.0, 50.0, 10.0, 0.0, 20.0, 100.0, 10.0, 50.0, 10.0, 10.0, 60.0, 20.0, 270.0, 100.0, 90.0, 10.0, 0.0, -30.0, 20.0, 50.0, 20.0, 0.0, 80.0, 90.0, 110.0, 30.0, 50.0, 70.0, 40.0, 160.0, 70.0, 0.0, 60.0, 30.0, 10.0, 30.0, -10.0, 10.0, 20.0, 80.0, 50.0, 220.0, 0.0, 180.0, 0.0, 60.0, 90.0, 0.0, 50.0, 0.0, 30.0, 0.0, 10.0, 30.0, 40.0, 20.0, 60.0, 150.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 90.0, 50.0, 150.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, -50.0, 50.0, 20.0, 30.0, 10.0, 0.0, 160.0, 10.0, -45.0, 30.0, 20.0, 360.0, 20.0, 40.0, 50.0, 160.0, 40.0, 50.0, 20.0, 30.0, 40.0, 50.0, -20.0, 20.0, 30.0, 60.0, 270.0, 40.0, 50.0, 50.0, 30.0, 20.0, 120.0, 10.0, 30.0, 60.0, 30.0, 150.0, 60.0, 30.0, 60.0, 20.0, 50.0, 20.0, 30.0, -5.0, 20.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.125732279040999, "mean_inference_ms": 2.812180264424538, "mean_action_processing_ms": 0.8643791131965679, "mean_env_wait_ms": 2.7949916753607242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018929004669189453, "StateBufferConnector_ms": 0.015199661254882812, "ViewRequirementAgentConnector_ms": 0.6149513721466064}, "num_episodes": 23, "episode_return_max": 1090.0, "episode_return_min": 145.0, "episode_return_mean": 492.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.005462779188857, "num_env_steps_trained_throughput_per_sec": 20.005462779188857, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 268992.251, "restore_workers_time_ms": 0.014, "training_step_time_ms": 268992.169, "sample_time_ms": 5301.579, "learn_time_ms": 263664.218, "learn_throughput": 15.171, "synch_weights_time_ms": 13.62}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 20, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-34-37", "timestamp": 1717216477, "time_this_iter_s": 199.95675492286682, "time_total_s": 7294.72301530838, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8243a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7294.72301530838, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.963120567375885, "ram_util_percent": 79.50106382978724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1077429004180166, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.942084634824556, "policy_loss": -0.010234140677286334, "vf_loss": 4.951331335464859, "vf_explained_var": 0.00099104353414176, "kl": 0.009874332856527933, "entropy": 1.1030854421619156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 192495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 1370.0, "episode_reward_min": 170.0, "episode_reward_mean": 522.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 510.0}, "policy_reward_mean": {"policy_0": 52.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.0, 480.0, 320.0, 825.0, 280.0, 420.0, 325.0, 700.0, 480.0, 920.0, 380.0, 630.0, 295.0, 630.0, 350.0, 840.0, 355.0, 340.0, 440.0, 410.0, 420.0, 310.0, 570.0, 275.0, 890.0, 220.0, 540.0, 590.0, 650.0, 250.0, 640.0, 490.0, 900.0, 310.0, 750.0, 550.0, 755.0, 210.0, 385.0, 470.0, 410.0, 635.0, 600.0, 240.0, 590.0, 490.0, 520.0, 490.0, 1050.0, 810.0, 1090.0, 620.0, 320.0, 240.0, 570.0, 665.0, 640.0, 250.0, 560.0, 250.0, 730.0, 490.0, 620.0, 940.0, 470.0, 285.0, 510.0, 230.0, 270.0, 535.0, 290.0, 530.0, 700.0, 500.0, 410.0, 380.0, 460.0, 250.0, 725.0, 540.0, 550.0, 385.0, 400.0, 320.0, 630.0, 590.0, 390.0, 850.0, 1110.0, 1370.0, 260.0, 290.0, 770.0, 250.0, 500.0, 500.0, 770.0, 170.0, 660.0, 720.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 10.0, 160.0, 30.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 20.0, 40.0, 40.0, 40.0, 20.0, 30.0, 160.0, 40.0, 20.0, 40.0, 40.0, 20.0, 40.0, 40.0, 30.0, 40.0, 0.0, 50.0, -5.0, 10.0, 70.0, 80.0, 20.0, 500.0, 30.0, 70.0, 50.0, 0.0, 10.0, 40.0, 20.0, 0.0, 10.0, 0.0, 80.0, 40.0, 40.0, 40.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 70.0, -50.0, 250.0, 0.0, 30.0, 0.0, 50.0, 20.0, 50.0, 100.0, 60.0, 0.0, 5.0, 10.0, 180.0, 50.0, 170.0, 0.0, 100.0, 30.0, 30.0, 0.0, 50.0, 90.0, 40.0, 40.0, 50.0, 70.0, 80.0, 110.0, 20.0, 40.0, 10.0, 20.0, 30.0, 60.0, 160.0, -20.0, 10.0, 80.0, 20.0, 210.0, 370.0, 0.0, 40.0, 20.0, 30.0, 150.0, 20.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 50.0, 180.0, 0.0, 110.0, 40.0, 10.0, 90.0, 50.0, 80.0, 10.0, 10.0, -5.0, 0.0, 50.0, 10.0, 0.0, 40.0, 20.0, 160.0, 380.0, -80.0, 80.0, 30.0, 160.0, -60.0, 40.0, 20.0, 40.0, 20.0, 0.0, -40.0, 20.0, 160.0, 40.0, 30.0, 90.0, 40.0, 10.0, 0.0, 50.0, 30.0, -140.0, 470.0, 70.0, 70.0, 30.0, 300.0, -30.0, -10.0, 35.0, 40.0, 70.0, 20.0, 40.0, 20.0, 10.0, 60.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 10.0, 90.0, 50.0, 40.0, 20.0, 70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 30.0, 30.0, 40.0, 120.0, 20.0, 20.0, 40.0, 110.0, 60.0, 60.0, 10.0, 40.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 60.0, 110.0, 80.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 60.0, 20.0, 10.0, 10.0, 30.0, 80.0, 80.0, 70.0, 170.0, 80.0, 30.0, -10.0, 30.0, 40.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 80.0, 150.0, 0.0, 10.0, 0.0, 5.0, 30.0, 10.0, 120.0, 40.0, 40.0, 40.0, 190.0, 50.0, 350.0, 20.0, 90.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 50.0, 20.0, 80.0, 20.0, 190.0, 20.0, 80.0, 10.0, 10.0, 40.0, 40.0, 100.0, 40.0, 60.0, 0.0, 50.0, 20.0, 170.0, 70.0, 40.0, 140.0, 30.0, 90.0, 50.0, 0.0, 160.0, 20.0, 100.0, 20.0, 30.0, 40.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 40.0, 60.0, 50.0, 70.0, 190.0, 20.0, 30.0, 40.0, 30.0, -100.0, 20.0, 40.0, 170.0, 30.0, 270.0, -60.0, 50.0, 40.0, 30.0, 470.0, -10.0, 160.0, 30.0, 80.0, 50.0, 40.0, 10.0, 30.0, 0.0, 20.0, 70.0, 20.0, 10.0, 60.0, 50.0, 40.0, 10.0, 80.0, 100.0, 20.0, 180.0, 30.0, 100.0, 30.0, 0.0, 150.0, 60.0, 40.0, 40.0, 180.0, 90.0, 10.0, 30.0, 10.0, 40.0, 70.0, 40.0, 5.0, 40.0, 120.0, 60.0, 80.0, 50.0, 20.0, 40.0, 300.0, 40.0, 40.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 200.0, 0.0, 10.0, 10.0, 35.0, 40.0, 20.0, -50.0, 10.0, 50.0, 350.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 30.0, 180.0, 60.0, 10.0, 40.0, 5.0, 30.0, 120.0, 0.0, 180.0, 10.0, 20.0, 60.0, 70.0, 10.0, 30.0, -40.0, 30.0, 30.0, 350.0, 40.0, 0.0, 20.0, 70.0, 30.0, 20.0, 0.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 40.0, 70.0, 60.0, 110.0, 40.0, 10.0, 210.0, 120.0, 80.0, 10.0, 30.0, 60.0, 70.0, 30.0, 0.0, 50.0, 40.0, 0.0, 20.0, 190.0, 20.0, 30.0, 80.0, 30.0, 50.0, 80.0, 20.0, 20.0, 30.0, 0.0, 150.0, 10.0, 20.0, 50.0, 160.0, -10.0, 60.0, 0.0, 40.0, 80.0, 40.0, 180.0, 50.0, 300.0, 170.0, 60.0, 130.0, 260.0, 60.0, 20.0, 50.0, 40.0, 30.0, 260.0, 0.0, 40.0, 50.0, 40.0, 90.0, 410.0, -40.0, 50.0, -30.0, 370.0, 20.0, 90.0, 90.0, 40.0, 40.0, 10.0, 20.0, 210.0, 160.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 30.0, 70.0, 30.0, 60.0, 50.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 80.0, 0.0, 0.0, 40.0, 30.0, 30.0, 40.0, -50.0, -50.0, 70.0, 0.0, 350.0, 30.0, 0.0, 60.0, 120.0, 130.0, 15.0, 20.0, 160.0, 60.0, 30.0, 70.0, 10.0, 160.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 50.0, 0.0, 80.0, 260.0, 30.0, 10.0, 0.0, 20.0, 10.0, 150.0, 0.0, 10.0, 10.0, 20.0, 20.0, 40.0, 60.0, 30.0, 0.0, 90.0, 40.0, 70.0, 180.0, 0.0, 50.0, 10.0, 80.0, 0.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 0.0, 40.0, 20.0, 50.0, 40.0, 30.0, 30.0, 90.0, 20.0, 150.0, 260.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 30.0, 10.0, 0.0, 390.0, 250.0, 10.0, 80.0, 60.0, 30.0, 60.0, 60.0, 40.0, 40.0, -10.0, 20.0, 10.0, 80.0, 200.0, 60.0, 360.0, 70.0, 20.0, 50.0, 70.0, 60.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 50.0, 90.0, 20.0, 10.0, -5.0, 160.0, 30.0, 50.0, 0.0, 0.0, 10.0, 10.0, 160.0, 40.0, 60.0, 40.0, 20.0, 0.0, 40.0, 50.0, 80.0, 20.0, 10.0, 130.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 50.0, 20.0, 0.0, 30.0, 0.0, 0.0, 40.0, 80.0, 50.0, 15.0, 20.0, 60.0, 10.0, 70.0, 0.0, 160.0, 40.0, 110.0, 50.0, 10.0, 0.0, 20.0, 100.0, 10.0, 50.0, 10.0, 10.0, 60.0, 20.0, 270.0, 100.0, 90.0, 10.0, 0.0, -30.0, 20.0, 50.0, 20.0, 0.0, 80.0, 90.0, 110.0, 30.0, 50.0, 70.0, 40.0, 160.0, 70.0, 0.0, 60.0, 30.0, 10.0, 30.0, -10.0, 10.0, 20.0, 80.0, 50.0, 220.0, 0.0, 180.0, 0.0, 60.0, 90.0, 0.0, 50.0, 0.0, 30.0, 0.0, 10.0, 30.0, 40.0, 20.0, 60.0, 150.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 90.0, 50.0, 150.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, -50.0, 50.0, 20.0, 30.0, 10.0, 0.0, 160.0, 10.0, -45.0, 30.0, 20.0, 360.0, 20.0, 40.0, 50.0, 160.0, 40.0, 50.0, 20.0, 30.0, 40.0, 50.0, -20.0, 20.0, 30.0, 60.0, 270.0, 40.0, 50.0, 50.0, 30.0, 20.0, 120.0, 10.0, 30.0, 60.0, 30.0, 150.0, 60.0, 30.0, 60.0, 20.0, 50.0, 20.0, 30.0, -5.0, 20.0, 100.0, 30.0, 20.0, 30.0, 80.0, 0.0, 110.0, 30.0, 50.0, 50.0, 0.0, 0.0, 30.0, 40.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 50.0, 10.0, 90.0, 60.0, 0.0, 0.0, 50.0, 180.0, 180.0, 10.0, 30.0, 40.0, 50.0, 60.0, -30.0, 360.0, 20.0, -40.0, 70.0, 30.0, 20.0, 60.0, 50.0, 180.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, -40.0, 110.0, 40.0, 60.0, 130.0, 270.0, 10.0, 0.0, 40.0, 230.0, 70.0, 150.0, 290.0, 70.0, -20.0, 60.0, 120.0, 290.0, 30.0, 50.0, 170.0, 60.0, 160.0, 280.0, 70.0, 30.0, 30.0, 50.0, 510.0, 10.0, 0.0, 10.0, 40.0, 100.0, 10.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 140.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 50.0, 40.0, 170.0, 100.0, 40.0, 20.0, 20.0, 300.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 20.0, 50.0, 20.0, 0.0, 100.0, 0.0, 20.0, 70.0, 10.0, 80.0, 0.0, 120.0, 40.0, 60.0, 20.0, 20.0, 390.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 230.0, 30.0, 0.0, 50.0, 30.0, 270.0, 60.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 30.0, 0.0, 110.0, 210.0, 0.0, 210.0, 40.0, 10.0, 10.0, 40.0, 20.0, 10.0, 210.0, -80.0, 20.0, 10.0, 40.0, 500.0, 10.0, -20.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0633445244608923, "mean_inference_ms": 2.7668536876373038, "mean_action_processing_ms": 0.8466889575642162, "mean_env_wait_ms": 2.737957510204042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01649785041809082, "StateBufferConnector_ms": 0.013149023056030273, "ViewRequirementAgentConnector_ms": 0.5120418071746826}, "num_episodes": 18, "episode_return_max": 1370.0, "episode_return_min": 170.0, "episode_return_mean": 522.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.657829794064195, "num_env_steps_trained_throughput_per_sec": 19.657829794064195, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 250629.629, "restore_workers_time_ms": 0.013, "training_step_time_ms": 250629.558, "sample_time_ms": 4779.048, "learn_time_ms": 245826.093, "learn_throughput": 16.272, "synch_weights_time_ms": 13.027}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 21, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-38-01", "timestamp": 1717216681, "time_this_iter_s": 203.51252102851868, "time_total_s": 7498.235536336899, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x2984ef9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7498.235536336899, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.456249999999997, "ram_util_percent": 81.62847222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.037424907078758, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.50780754033496, "policy_loss": -0.010230542933424545, "vf_loss": 5.517018058988106, "vf_explained_var": 0.0037377546960934284, "kl": 0.010200313867267257, "entropy": 1.0392735562385462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 201885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 1370.0, "episode_reward_min": 90.0, "episode_reward_mean": 523.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 510.0}, "policy_reward_mean": {"policy_0": 52.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [440.0, 410.0, 420.0, 310.0, 570.0, 275.0, 890.0, 220.0, 540.0, 590.0, 650.0, 250.0, 640.0, 490.0, 900.0, 310.0, 750.0, 550.0, 755.0, 210.0, 385.0, 470.0, 410.0, 635.0, 600.0, 240.0, 590.0, 490.0, 520.0, 490.0, 1050.0, 810.0, 1090.0, 620.0, 320.0, 240.0, 570.0, 665.0, 640.0, 250.0, 560.0, 250.0, 730.0, 490.0, 620.0, 940.0, 470.0, 285.0, 510.0, 230.0, 270.0, 535.0, 290.0, 530.0, 700.0, 500.0, 410.0, 380.0, 460.0, 250.0, 725.0, 540.0, 550.0, 385.0, 400.0, 320.0, 630.0, 590.0, 390.0, 850.0, 1110.0, 1370.0, 260.0, 290.0, 770.0, 250.0, 500.0, 500.0, 770.0, 170.0, 660.0, 720.0, 680.0, 90.0, 530.0, 260.0, 620.0, 680.0, 500.0, 530.0, 300.0, 650.0, 410.0, 310.0, 450.0, 570.0, 640.0, 640.0, 390.0, 680.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 40.0, 10.0, 40.0, 0.0, 60.0, 30.0, 30.0, 40.0, 120.0, 20.0, 20.0, 40.0, 110.0, 60.0, 60.0, 10.0, 40.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 60.0, 110.0, 80.0, 20.0, 40.0, 10.0, 60.0, 10.0, 10.0, 20.0, 60.0, 20.0, 10.0, 10.0, 30.0, 80.0, 80.0, 70.0, 170.0, 80.0, 30.0, -10.0, 30.0, 40.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 80.0, 150.0, 0.0, 10.0, 0.0, 5.0, 30.0, 10.0, 120.0, 40.0, 40.0, 40.0, 190.0, 50.0, 350.0, 20.0, 90.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 50.0, 20.0, 80.0, 20.0, 190.0, 20.0, 80.0, 10.0, 10.0, 40.0, 40.0, 100.0, 40.0, 60.0, 0.0, 50.0, 20.0, 170.0, 70.0, 40.0, 140.0, 30.0, 90.0, 50.0, 0.0, 160.0, 20.0, 100.0, 20.0, 30.0, 40.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 40.0, 60.0, 50.0, 70.0, 190.0, 20.0, 30.0, 40.0, 30.0, -100.0, 20.0, 40.0, 170.0, 30.0, 270.0, -60.0, 50.0, 40.0, 30.0, 470.0, -10.0, 160.0, 30.0, 80.0, 50.0, 40.0, 10.0, 30.0, 0.0, 20.0, 70.0, 20.0, 10.0, 60.0, 50.0, 40.0, 10.0, 80.0, 100.0, 20.0, 180.0, 30.0, 100.0, 30.0, 0.0, 150.0, 60.0, 40.0, 40.0, 180.0, 90.0, 10.0, 30.0, 10.0, 40.0, 70.0, 40.0, 5.0, 40.0, 120.0, 60.0, 80.0, 50.0, 20.0, 40.0, 300.0, 40.0, 40.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 200.0, 0.0, 10.0, 10.0, 35.0, 40.0, 20.0, -50.0, 10.0, 50.0, 350.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 30.0, 180.0, 60.0, 10.0, 40.0, 5.0, 30.0, 120.0, 0.0, 180.0, 10.0, 20.0, 60.0, 70.0, 10.0, 30.0, -40.0, 30.0, 30.0, 350.0, 40.0, 0.0, 20.0, 70.0, 30.0, 20.0, 0.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 40.0, 70.0, 60.0, 110.0, 40.0, 10.0, 210.0, 120.0, 80.0, 10.0, 30.0, 60.0, 70.0, 30.0, 0.0, 50.0, 40.0, 0.0, 20.0, 190.0, 20.0, 30.0, 80.0, 30.0, 50.0, 80.0, 20.0, 20.0, 30.0, 0.0, 150.0, 10.0, 20.0, 50.0, 160.0, -10.0, 60.0, 0.0, 40.0, 80.0, 40.0, 180.0, 50.0, 300.0, 170.0, 60.0, 130.0, 260.0, 60.0, 20.0, 50.0, 40.0, 30.0, 260.0, 0.0, 40.0, 50.0, 40.0, 90.0, 410.0, -40.0, 50.0, -30.0, 370.0, 20.0, 90.0, 90.0, 40.0, 40.0, 10.0, 20.0, 210.0, 160.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 30.0, 70.0, 30.0, 60.0, 50.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 80.0, 0.0, 0.0, 40.0, 30.0, 30.0, 40.0, -50.0, -50.0, 70.0, 0.0, 350.0, 30.0, 0.0, 60.0, 120.0, 130.0, 15.0, 20.0, 160.0, 60.0, 30.0, 70.0, 10.0, 160.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 50.0, 0.0, 80.0, 260.0, 30.0, 10.0, 0.0, 20.0, 10.0, 150.0, 0.0, 10.0, 10.0, 20.0, 20.0, 40.0, 60.0, 30.0, 0.0, 90.0, 40.0, 70.0, 180.0, 0.0, 50.0, 10.0, 80.0, 0.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 0.0, 40.0, 20.0, 50.0, 40.0, 30.0, 30.0, 90.0, 20.0, 150.0, 260.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 30.0, 10.0, 0.0, 390.0, 250.0, 10.0, 80.0, 60.0, 30.0, 60.0, 60.0, 40.0, 40.0, -10.0, 20.0, 10.0, 80.0, 200.0, 60.0, 360.0, 70.0, 20.0, 50.0, 70.0, 60.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 50.0, 90.0, 20.0, 10.0, -5.0, 160.0, 30.0, 50.0, 0.0, 0.0, 10.0, 10.0, 160.0, 40.0, 60.0, 40.0, 20.0, 0.0, 40.0, 50.0, 80.0, 20.0, 10.0, 130.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 50.0, 20.0, 0.0, 30.0, 0.0, 0.0, 40.0, 80.0, 50.0, 15.0, 20.0, 60.0, 10.0, 70.0, 0.0, 160.0, 40.0, 110.0, 50.0, 10.0, 0.0, 20.0, 100.0, 10.0, 50.0, 10.0, 10.0, 60.0, 20.0, 270.0, 100.0, 90.0, 10.0, 0.0, -30.0, 20.0, 50.0, 20.0, 0.0, 80.0, 90.0, 110.0, 30.0, 50.0, 70.0, 40.0, 160.0, 70.0, 0.0, 60.0, 30.0, 10.0, 30.0, -10.0, 10.0, 20.0, 80.0, 50.0, 220.0, 0.0, 180.0, 0.0, 60.0, 90.0, 0.0, 50.0, 0.0, 30.0, 0.0, 10.0, 30.0, 40.0, 20.0, 60.0, 150.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 90.0, 50.0, 150.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, -50.0, 50.0, 20.0, 30.0, 10.0, 0.0, 160.0, 10.0, -45.0, 30.0, 20.0, 360.0, 20.0, 40.0, 50.0, 160.0, 40.0, 50.0, 20.0, 30.0, 40.0, 50.0, -20.0, 20.0, 30.0, 60.0, 270.0, 40.0, 50.0, 50.0, 30.0, 20.0, 120.0, 10.0, 30.0, 60.0, 30.0, 150.0, 60.0, 30.0, 60.0, 20.0, 50.0, 20.0, 30.0, -5.0, 20.0, 100.0, 30.0, 20.0, 30.0, 80.0, 0.0, 110.0, 30.0, 50.0, 50.0, 0.0, 0.0, 30.0, 40.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 50.0, 10.0, 90.0, 60.0, 0.0, 0.0, 50.0, 180.0, 180.0, 10.0, 30.0, 40.0, 50.0, 60.0, -30.0, 360.0, 20.0, -40.0, 70.0, 30.0, 20.0, 60.0, 50.0, 180.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, -40.0, 110.0, 40.0, 60.0, 130.0, 270.0, 10.0, 0.0, 40.0, 230.0, 70.0, 150.0, 290.0, 70.0, -20.0, 60.0, 120.0, 290.0, 30.0, 50.0, 170.0, 60.0, 160.0, 280.0, 70.0, 30.0, 30.0, 50.0, 510.0, 10.0, 0.0, 10.0, 40.0, 100.0, 10.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 140.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 50.0, 40.0, 170.0, 100.0, 40.0, 20.0, 20.0, 300.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 20.0, 50.0, 20.0, 0.0, 100.0, 0.0, 20.0, 70.0, 10.0, 80.0, 0.0, 120.0, 40.0, 60.0, 20.0, 20.0, 390.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 230.0, 30.0, 0.0, 50.0, 30.0, 270.0, 60.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 30.0, 0.0, 110.0, 210.0, 0.0, 210.0, 40.0, 10.0, 10.0, 40.0, 20.0, 10.0, 210.0, -80.0, 20.0, 10.0, 40.0, 500.0, 10.0, -20.0, 10.0, 20.0, 90.0, 150.0, 10.0, 60.0, 20.0, 0.0, -20.0, 40.0, 260.0, 70.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 30.0, 40.0, 40.0, 70.0, 20.0, 180.0, 30.0, 80.0, 40.0, 30.0, 210.0, 0.0, -160.0, 20.0, 40.0, 20.0, 30.0, 30.0, 60.0, 40.0, 40.0, 10.0, 10.0, 110.0, 20.0, 220.0, 60.0, 50.0, 90.0, 130.0, 30.0, 0.0, 90.0, 0.0, 50.0, 50.0, 40.0, 200.0, 20.0, 170.0, 110.0, 20.0, 20.0, 10.0, 70.0, 30.0, 40.0, 10.0, 90.0, 30.0, 0.0, 120.0, 80.0, 70.0, 10.0, 50.0, 40.0, 40.0, 10.0, 20.0, 60.0, 50.0, 20.0, 10.0, 10.0, 50.0, 70.0, 0.0, 360.0, 70.0, 10.0, 0.0, 50.0, 80.0, 20.0, 10.0, 20.0, 30.0, 160.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 0.0, 150.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 160.0, 30.0, 10.0, 110.0, 0.0, 20.0, 60.0, 50.0, 50.0, 10.0, 110.0, 50.0, 250.0, 0.0, 20.0, 10.0, 70.0, 60.0, 20.0, 50.0, 40.0, 50.0, 70.0, 0.0, 70.0, 60.0, 40.0, 0.0, 170.0, 90.0, 90.0, 0.0, 190.0, 20.0, 30.0, 200.0, 60.0, 20.0, 30.0, 70.0, 20.0, 10.0, 70.0, 30.0, 110.0, 60.0, 30.0, 40.0, 0.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 30.0, 160.0, 90.0, 10.0, 160.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9975364465459613, "mean_inference_ms": 2.717850618581052, "mean_action_processing_ms": 0.8278975575650549, "mean_env_wait_ms": 2.6772196619520967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01497960090637207, "StateBufferConnector_ms": 0.011922121047973633, "ViewRequirementAgentConnector_ms": 0.45505285263061523}, "num_episodes": 18, "episode_return_max": 1370.0, "episode_return_min": 90.0, "episode_return_mean": 523.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.49830481407773, "num_env_steps_trained_throughput_per_sec": 19.49830481407773, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 237427.956, "restore_workers_time_ms": 0.013, "training_step_time_ms": 237427.905, "sample_time_ms": 4469.098, "learn_time_ms": 232934.08, "learn_throughput": 17.172, "synch_weights_time_ms": 12.763}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 22, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-41-26", "timestamp": 1717216886, "time_this_iter_s": 205.15487575531006, "time_total_s": 7703.390412092209, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f85aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7703.390412092209, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.299655172413793, "ram_util_percent": 82.23827586206897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1920761668961397, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.434274700528389, "policy_loss": -0.010712680441904635, "vf_loss": 5.444017647478146, "vf_explained_var": 0.0026034076691181644, "kl": 0.009697360359345474, "entropy": 1.011002363919958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 211275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 1370.0, "episode_reward_min": 90.0, "episode_reward_mean": 547.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 510.0}, "policy_reward_mean": {"policy_0": 54.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [755.0, 210.0, 385.0, 470.0, 410.0, 635.0, 600.0, 240.0, 590.0, 490.0, 520.0, 490.0, 1050.0, 810.0, 1090.0, 620.0, 320.0, 240.0, 570.0, 665.0, 640.0, 250.0, 560.0, 250.0, 730.0, 490.0, 620.0, 940.0, 470.0, 285.0, 510.0, 230.0, 270.0, 535.0, 290.0, 530.0, 700.0, 500.0, 410.0, 380.0, 460.0, 250.0, 725.0, 540.0, 550.0, 385.0, 400.0, 320.0, 630.0, 590.0, 390.0, 850.0, 1110.0, 1370.0, 260.0, 290.0, 770.0, 250.0, 500.0, 500.0, 770.0, 170.0, 660.0, 720.0, 680.0, 90.0, 530.0, 260.0, 620.0, 680.0, 500.0, 530.0, 300.0, 650.0, 410.0, 310.0, 450.0, 570.0, 640.0, 640.0, 390.0, 680.0, 1160.0, 400.0, 460.0, 670.0, 940.0, 760.0, 970.0, 210.0, 480.0, 870.0, 1010.0, 380.0, 230.0, 850.0, 610.0, 820.0, 250.0, 500.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [5.0, 40.0, 120.0, 60.0, 80.0, 50.0, 20.0, 40.0, 300.0, 40.0, 40.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 200.0, 0.0, 10.0, 10.0, 35.0, 40.0, 20.0, -50.0, 10.0, 50.0, 350.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 40.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 30.0, 180.0, 60.0, 10.0, 40.0, 5.0, 30.0, 120.0, 0.0, 180.0, 10.0, 20.0, 60.0, 70.0, 10.0, 30.0, -40.0, 30.0, 30.0, 350.0, 40.0, 0.0, 20.0, 70.0, 30.0, 20.0, 0.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 40.0, 70.0, 60.0, 110.0, 40.0, 10.0, 210.0, 120.0, 80.0, 10.0, 30.0, 60.0, 70.0, 30.0, 0.0, 50.0, 40.0, 0.0, 20.0, 190.0, 20.0, 30.0, 80.0, 30.0, 50.0, 80.0, 20.0, 20.0, 30.0, 0.0, 150.0, 10.0, 20.0, 50.0, 160.0, -10.0, 60.0, 0.0, 40.0, 80.0, 40.0, 180.0, 50.0, 300.0, 170.0, 60.0, 130.0, 260.0, 60.0, 20.0, 50.0, 40.0, 30.0, 260.0, 0.0, 40.0, 50.0, 40.0, 90.0, 410.0, -40.0, 50.0, -30.0, 370.0, 20.0, 90.0, 90.0, 40.0, 40.0, 10.0, 20.0, 210.0, 160.0, 30.0, 20.0, 40.0, 50.0, 30.0, 0.0, 30.0, 70.0, 30.0, 60.0, 50.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 80.0, 0.0, 0.0, 40.0, 30.0, 30.0, 40.0, -50.0, -50.0, 70.0, 0.0, 350.0, 30.0, 0.0, 60.0, 120.0, 130.0, 15.0, 20.0, 160.0, 60.0, 30.0, 70.0, 10.0, 160.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 50.0, 0.0, 80.0, 260.0, 30.0, 10.0, 0.0, 20.0, 10.0, 150.0, 0.0, 10.0, 10.0, 20.0, 20.0, 40.0, 60.0, 30.0, 0.0, 90.0, 40.0, 70.0, 180.0, 0.0, 50.0, 10.0, 80.0, 0.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 0.0, 40.0, 20.0, 50.0, 40.0, 30.0, 30.0, 90.0, 20.0, 150.0, 260.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 30.0, 10.0, 0.0, 390.0, 250.0, 10.0, 80.0, 60.0, 30.0, 60.0, 60.0, 40.0, 40.0, -10.0, 20.0, 10.0, 80.0, 200.0, 60.0, 360.0, 70.0, 20.0, 50.0, 70.0, 60.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 50.0, 90.0, 20.0, 10.0, -5.0, 160.0, 30.0, 50.0, 0.0, 0.0, 10.0, 10.0, 160.0, 40.0, 60.0, 40.0, 20.0, 0.0, 40.0, 50.0, 80.0, 20.0, 10.0, 130.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 50.0, 20.0, 0.0, 30.0, 0.0, 0.0, 40.0, 80.0, 50.0, 15.0, 20.0, 60.0, 10.0, 70.0, 0.0, 160.0, 40.0, 110.0, 50.0, 10.0, 0.0, 20.0, 100.0, 10.0, 50.0, 10.0, 10.0, 60.0, 20.0, 270.0, 100.0, 90.0, 10.0, 0.0, -30.0, 20.0, 50.0, 20.0, 0.0, 80.0, 90.0, 110.0, 30.0, 50.0, 70.0, 40.0, 160.0, 70.0, 0.0, 60.0, 30.0, 10.0, 30.0, -10.0, 10.0, 20.0, 80.0, 50.0, 220.0, 0.0, 180.0, 0.0, 60.0, 90.0, 0.0, 50.0, 0.0, 30.0, 0.0, 10.0, 30.0, 40.0, 20.0, 60.0, 150.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 90.0, 50.0, 150.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, -50.0, 50.0, 20.0, 30.0, 10.0, 0.0, 160.0, 10.0, -45.0, 30.0, 20.0, 360.0, 20.0, 40.0, 50.0, 160.0, 40.0, 50.0, 20.0, 30.0, 40.0, 50.0, -20.0, 20.0, 30.0, 60.0, 270.0, 40.0, 50.0, 50.0, 30.0, 20.0, 120.0, 10.0, 30.0, 60.0, 30.0, 150.0, 60.0, 30.0, 60.0, 20.0, 50.0, 20.0, 30.0, -5.0, 20.0, 100.0, 30.0, 20.0, 30.0, 80.0, 0.0, 110.0, 30.0, 50.0, 50.0, 0.0, 0.0, 30.0, 40.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 50.0, 10.0, 90.0, 60.0, 0.0, 0.0, 50.0, 180.0, 180.0, 10.0, 30.0, 40.0, 50.0, 60.0, -30.0, 360.0, 20.0, -40.0, 70.0, 30.0, 20.0, 60.0, 50.0, 180.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, -40.0, 110.0, 40.0, 60.0, 130.0, 270.0, 10.0, 0.0, 40.0, 230.0, 70.0, 150.0, 290.0, 70.0, -20.0, 60.0, 120.0, 290.0, 30.0, 50.0, 170.0, 60.0, 160.0, 280.0, 70.0, 30.0, 30.0, 50.0, 510.0, 10.0, 0.0, 10.0, 40.0, 100.0, 10.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 140.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 50.0, 40.0, 170.0, 100.0, 40.0, 20.0, 20.0, 300.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 20.0, 50.0, 20.0, 0.0, 100.0, 0.0, 20.0, 70.0, 10.0, 80.0, 0.0, 120.0, 40.0, 60.0, 20.0, 20.0, 390.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 230.0, 30.0, 0.0, 50.0, 30.0, 270.0, 60.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 30.0, 0.0, 110.0, 210.0, 0.0, 210.0, 40.0, 10.0, 10.0, 40.0, 20.0, 10.0, 210.0, -80.0, 20.0, 10.0, 40.0, 500.0, 10.0, -20.0, 10.0, 20.0, 90.0, 150.0, 10.0, 60.0, 20.0, 0.0, -20.0, 40.0, 260.0, 70.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 30.0, 40.0, 40.0, 70.0, 20.0, 180.0, 30.0, 80.0, 40.0, 30.0, 210.0, 0.0, -160.0, 20.0, 40.0, 20.0, 30.0, 30.0, 60.0, 40.0, 40.0, 10.0, 10.0, 110.0, 20.0, 220.0, 60.0, 50.0, 90.0, 130.0, 30.0, 0.0, 90.0, 0.0, 50.0, 50.0, 40.0, 200.0, 20.0, 170.0, 110.0, 20.0, 20.0, 10.0, 70.0, 30.0, 40.0, 10.0, 90.0, 30.0, 0.0, 120.0, 80.0, 70.0, 10.0, 50.0, 40.0, 40.0, 10.0, 20.0, 60.0, 50.0, 20.0, 10.0, 10.0, 50.0, 70.0, 0.0, 360.0, 70.0, 10.0, 0.0, 50.0, 80.0, 20.0, 10.0, 20.0, 30.0, 160.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 0.0, 150.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 160.0, 30.0, 10.0, 110.0, 0.0, 20.0, 60.0, 50.0, 50.0, 10.0, 110.0, 50.0, 250.0, 0.0, 20.0, 10.0, 70.0, 60.0, 20.0, 50.0, 40.0, 50.0, 70.0, 0.0, 70.0, 60.0, 40.0, 0.0, 170.0, 90.0, 90.0, 0.0, 190.0, 20.0, 30.0, 200.0, 60.0, 20.0, 30.0, 70.0, 20.0, 10.0, 70.0, 30.0, 110.0, 60.0, 30.0, 40.0, 0.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 30.0, 160.0, 90.0, 10.0, 160.0, 30.0, 210.0, 50.0, 150.0, 10.0, 30.0, 40.0, 20.0, 100.0, 180.0, 370.0, 50.0, 50.0, 60.0, 20.0, 20.0, 40.0, 90.0, 60.0, 0.0, 10.0, 80.0, 0.0, 30.0, 70.0, 0.0, 40.0, 50.0, 10.0, 160.0, 20.0, 40.0, 0.0, 50.0, 10.0, 20.0, 20.0, 80.0, 80.0, 370.0, 0.0, 30.0, 60.0, 370.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 300.0, 20.0, 30.0, 170.0, 210.0, -10.0, 50.0, 80.0, -30.0, 170.0, 70.0, 10.0, 60.0, 20.0, 190.0, 80.0, 160.0, 20.0, 190.0, 180.0, 60.0, 70.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 20.0, 40.0, 150.0, 20.0, 30.0, 100.0, 40.0, 30.0, 40.0, 60.0, 110.0, 50.0, 210.0, 20.0, 60.0, 320.0, 0.0, 0.0, 40.0, 40.0, 80.0, -20.0, 150.0, 70.0, 40.0, 90.0, 480.0, 30.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 130.0, 0.0, 50.0, 40.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 90.0, 110.0, 200.0, 10.0, 300.0, -40.0, 80.0, 30.0, 0.0, 40.0, 160.0, 20.0, 210.0, 20.0, 30.0, 10.0, 30.0, 90.0, 30.0, 10.0, 250.0, 380.0, -30.0, 30.0, -50.0, -20.0, 140.0, 80.0, 0.0, 60.0, 20.0, 0.0, 20.0, 10.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 100.0, 30.0, 0.0, 130.0, 20.0, 0.0, 30.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.936462992155484, "mean_inference_ms": 2.670838376004069, "mean_action_processing_ms": 0.8101490971540233, "mean_env_wait_ms": 2.6193425652237954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015182733535766602, "StateBufferConnector_ms": 0.011848688125610352, "ViewRequirementAgentConnector_ms": 0.45904111862182617}, "num_episodes": 18, "episode_return_max": 1370.0, "episode_return_min": 90.0, "episode_return_mean": 547.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.66034619927464, "num_env_steps_trained_throughput_per_sec": 19.66034619927464, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 225995.226, "restore_workers_time_ms": 0.013, "training_step_time_ms": 225995.176, "sample_time_ms": 4035.021, "learn_time_ms": 221936.634, "learn_throughput": 18.023, "synch_weights_time_ms": 12.006}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 23, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-44-49", "timestamp": 1717217089, "time_this_iter_s": 203.48143410682678, "time_total_s": 7906.871846199036, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f87d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7906.871846199036, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.029166666666665, "ram_util_percent": 81.39097222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1938147032476714, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.286751266815665, "policy_loss": -0.011029401989861989, "vf_loss": 5.296906741104695, "vf_explained_var": 0.003701547267464911, "kl": 0.00873919926965207, "entropy": 1.0018308048177198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 220665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 1370.0, "episode_reward_min": 90.0, "episode_reward_mean": 553.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 55.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 470.0, 285.0, 510.0, 230.0, 270.0, 535.0, 290.0, 530.0, 700.0, 500.0, 410.0, 380.0, 460.0, 250.0, 725.0, 540.0, 550.0, 385.0, 400.0, 320.0, 630.0, 590.0, 390.0, 850.0, 1110.0, 1370.0, 260.0, 290.0, 770.0, 250.0, 500.0, 500.0, 770.0, 170.0, 660.0, 720.0, 680.0, 90.0, 530.0, 260.0, 620.0, 680.0, 500.0, 530.0, 300.0, 650.0, 410.0, 310.0, 450.0, 570.0, 640.0, 640.0, 390.0, 680.0, 1160.0, 400.0, 460.0, 670.0, 940.0, 760.0, 970.0, 210.0, 480.0, 870.0, 1010.0, 380.0, 230.0, 850.0, 610.0, 820.0, 250.0, 500.0, 810.0, 540.0, 390.0, 510.0, 490.0, 520.0, 390.0, 180.0, 980.0, 460.0, 790.0, 1050.0, 560.0, 220.0, 650.0, 280.0, 820.0, 960.0, 230.0, 880.0, 150.0, 630.0, 530.0, 730.0, 710.0, 550.0, 350.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 80.0, 200.0, 60.0, 360.0, 70.0, 20.0, 50.0, 70.0, 60.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 50.0, 90.0, 20.0, 10.0, -5.0, 160.0, 30.0, 50.0, 0.0, 0.0, 10.0, 10.0, 160.0, 40.0, 60.0, 40.0, 20.0, 0.0, 40.0, 50.0, 80.0, 20.0, 10.0, 130.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 50.0, 20.0, 0.0, 30.0, 0.0, 0.0, 40.0, 80.0, 50.0, 15.0, 20.0, 60.0, 10.0, 70.0, 0.0, 160.0, 40.0, 110.0, 50.0, 10.0, 0.0, 20.0, 100.0, 10.0, 50.0, 10.0, 10.0, 60.0, 20.0, 270.0, 100.0, 90.0, 10.0, 0.0, -30.0, 20.0, 50.0, 20.0, 0.0, 80.0, 90.0, 110.0, 30.0, 50.0, 70.0, 40.0, 160.0, 70.0, 0.0, 60.0, 30.0, 10.0, 30.0, -10.0, 10.0, 20.0, 80.0, 50.0, 220.0, 0.0, 180.0, 0.0, 60.0, 90.0, 0.0, 50.0, 0.0, 30.0, 0.0, 10.0, 30.0, 40.0, 20.0, 60.0, 150.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 90.0, 50.0, 150.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 10.0, -50.0, 50.0, 20.0, 30.0, 10.0, 0.0, 160.0, 10.0, -45.0, 30.0, 20.0, 360.0, 20.0, 40.0, 50.0, 160.0, 40.0, 50.0, 20.0, 30.0, 40.0, 50.0, -20.0, 20.0, 30.0, 60.0, 270.0, 40.0, 50.0, 50.0, 30.0, 20.0, 120.0, 10.0, 30.0, 60.0, 30.0, 150.0, 60.0, 30.0, 60.0, 20.0, 50.0, 20.0, 30.0, -5.0, 20.0, 100.0, 30.0, 20.0, 30.0, 80.0, 0.0, 110.0, 30.0, 50.0, 50.0, 0.0, 0.0, 30.0, 40.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 50.0, 10.0, 90.0, 60.0, 0.0, 0.0, 50.0, 180.0, 180.0, 10.0, 30.0, 40.0, 50.0, 60.0, -30.0, 360.0, 20.0, -40.0, 70.0, 30.0, 20.0, 60.0, 50.0, 180.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, -40.0, 110.0, 40.0, 60.0, 130.0, 270.0, 10.0, 0.0, 40.0, 230.0, 70.0, 150.0, 290.0, 70.0, -20.0, 60.0, 120.0, 290.0, 30.0, 50.0, 170.0, 60.0, 160.0, 280.0, 70.0, 30.0, 30.0, 50.0, 510.0, 10.0, 0.0, 10.0, 40.0, 100.0, 10.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 140.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 50.0, 40.0, 170.0, 100.0, 40.0, 20.0, 20.0, 300.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 20.0, 50.0, 20.0, 0.0, 100.0, 0.0, 20.0, 70.0, 10.0, 80.0, 0.0, 120.0, 40.0, 60.0, 20.0, 20.0, 390.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 230.0, 30.0, 0.0, 50.0, 30.0, 270.0, 60.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 30.0, 0.0, 110.0, 210.0, 0.0, 210.0, 40.0, 10.0, 10.0, 40.0, 20.0, 10.0, 210.0, -80.0, 20.0, 10.0, 40.0, 500.0, 10.0, -20.0, 10.0, 20.0, 90.0, 150.0, 10.0, 60.0, 20.0, 0.0, -20.0, 40.0, 260.0, 70.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 30.0, 40.0, 40.0, 70.0, 20.0, 180.0, 30.0, 80.0, 40.0, 30.0, 210.0, 0.0, -160.0, 20.0, 40.0, 20.0, 30.0, 30.0, 60.0, 40.0, 40.0, 10.0, 10.0, 110.0, 20.0, 220.0, 60.0, 50.0, 90.0, 130.0, 30.0, 0.0, 90.0, 0.0, 50.0, 50.0, 40.0, 200.0, 20.0, 170.0, 110.0, 20.0, 20.0, 10.0, 70.0, 30.0, 40.0, 10.0, 90.0, 30.0, 0.0, 120.0, 80.0, 70.0, 10.0, 50.0, 40.0, 40.0, 10.0, 20.0, 60.0, 50.0, 20.0, 10.0, 10.0, 50.0, 70.0, 0.0, 360.0, 70.0, 10.0, 0.0, 50.0, 80.0, 20.0, 10.0, 20.0, 30.0, 160.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 0.0, 150.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 160.0, 30.0, 10.0, 110.0, 0.0, 20.0, 60.0, 50.0, 50.0, 10.0, 110.0, 50.0, 250.0, 0.0, 20.0, 10.0, 70.0, 60.0, 20.0, 50.0, 40.0, 50.0, 70.0, 0.0, 70.0, 60.0, 40.0, 0.0, 170.0, 90.0, 90.0, 0.0, 190.0, 20.0, 30.0, 200.0, 60.0, 20.0, 30.0, 70.0, 20.0, 10.0, 70.0, 30.0, 110.0, 60.0, 30.0, 40.0, 0.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 30.0, 160.0, 90.0, 10.0, 160.0, 30.0, 210.0, 50.0, 150.0, 10.0, 30.0, 40.0, 20.0, 100.0, 180.0, 370.0, 50.0, 50.0, 60.0, 20.0, 20.0, 40.0, 90.0, 60.0, 0.0, 10.0, 80.0, 0.0, 30.0, 70.0, 0.0, 40.0, 50.0, 10.0, 160.0, 20.0, 40.0, 0.0, 50.0, 10.0, 20.0, 20.0, 80.0, 80.0, 370.0, 0.0, 30.0, 60.0, 370.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 300.0, 20.0, 30.0, 170.0, 210.0, -10.0, 50.0, 80.0, -30.0, 170.0, 70.0, 10.0, 60.0, 20.0, 190.0, 80.0, 160.0, 20.0, 190.0, 180.0, 60.0, 70.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 20.0, 40.0, 150.0, 20.0, 30.0, 100.0, 40.0, 30.0, 40.0, 60.0, 110.0, 50.0, 210.0, 20.0, 60.0, 320.0, 0.0, 0.0, 40.0, 40.0, 80.0, -20.0, 150.0, 70.0, 40.0, 90.0, 480.0, 30.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 130.0, 0.0, 50.0, 40.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 90.0, 110.0, 200.0, 10.0, 300.0, -40.0, 80.0, 30.0, 0.0, 40.0, 160.0, 20.0, 210.0, 20.0, 30.0, 10.0, 30.0, 90.0, 30.0, 10.0, 250.0, 380.0, -30.0, 30.0, -50.0, -20.0, 140.0, 80.0, 0.0, 60.0, 20.0, 0.0, 20.0, 10.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 100.0, 30.0, 0.0, 130.0, 20.0, 0.0, 30.0, 50.0, 50.0, 120.0, 30.0, 170.0, 60.0, 170.0, 20.0, -10.0, 200.0, 0.0, 0.0, 20.0, 100.0, 190.0, 10.0, 100.0, 50.0, 10.0, 10.0, 50.0, 30.0, 30.0, 20.0, 20.0, 10.0, 150.0, 0.0, 70.0, 20.0, 40.0, 45.0, 30.0, 80.0, 20.0, 115.0, 20.0, 60.0, 50.0, 70.0, 20.0, 80.0, 30.0, 50.0, 0.0, 20.0, 20.0, 20.0, 70.0, 180.0, 20.0, 270.0, 30.0, 40.0, 60.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 390.0, -40.0, 10.0, -40.0, 40.0, -40.0, 10.0, -40.0, 60.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 60.0, 30.0, 0.0, 20.0, 0.0, 260.0, 70.0, 20.0, 70.0, 60.0, 30.0, 80.0, 80.0, 80.0, 230.0, 90.0, -20.0, 110.0, 20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 40.0, 40.0, 30.0, 90.0, 200.0, 20.0, 10.0, 70.0, 190.0, 30.0, 110.0, 350.0, 170.0, -20.0, 90.0, 100.0, 70.0, 190.0, 40.0, 10.0, 50.0, 10.0, 40.0, 60.0, 30.0, 20.0, 180.0, 60.0, 0.0, 70.0, 90.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 30.0, 140.0, 30.0, 70.0, 270.0, 10.0, 0.0, 20.0, 50.0, 10.0, 40.0, 40.0, 0.0, 30.0, 80.0, 120.0, 30.0, 80.0, 50.0, 20.0, 210.0, 130.0, 60.0, 110.0, 10.0, 160.0, 150.0, 20.0, 0.0, 190.0, 180.0, 80.0, 0.0, 70.0, 110.0, 10.0, 10.0, 20.0, 70.0, 0.0, 10.0, 40.0, 10.0, 20.0, 40.0, -70.0, -30.0, 50.0, 90.0, 50.0, 70.0, 50.0, 40.0, 530.0, 100.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 60.0, 10.0, 0.0, 260.0, 20.0, 90.0, -20.0, 0.0, 40.0, 190.0, 20.0, 30.0, 70.0, 40.0, 90.0, 90.0, 20.0, 20.0, 20.0, 30.0, 20.0, 130.0, 40.0, 20.0, 30.0, 30.0, 170.0, 20.0, 270.0, 50.0, 80.0, 20.0, 20.0, 40.0, 90.0, 50.0, 40.0, 20.0, 40.0, 20.0, 370.0, 20.0, 130.0, 70.0, 0.0, 0.0, 10.0, 90.0, 20.0, 40.0, 160.0, 30.0, 100.0, 50.0, 0.0, 60.0, 20.0, 50.0, 10.0, 30.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.850546601411798, "mean_inference_ms": 2.6027237119537556, "mean_action_processing_ms": 0.7850613426797427, "mean_env_wait_ms": 2.5370404182658337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014666318893432617, "StateBufferConnector_ms": 0.010999202728271484, "ViewRequirementAgentConnector_ms": 0.4449625015258789}, "num_episodes": 27, "episode_return_max": 1370.0, "episode_return_min": 90.0, "episode_return_mean": 553.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.798880400414237, "num_env_steps_trained_throughput_per_sec": 19.798880400414237, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 213878.584, "restore_workers_time_ms": 0.012, "training_step_time_ms": 213878.534, "sample_time_ms": 3593.815, "learn_time_ms": 210261.475, "learn_throughput": 19.024, "synch_weights_time_ms": 11.686}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 24, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-48-11", "timestamp": 1717217291, "time_this_iter_s": 202.04214096069336, "time_total_s": 8108.913987159729, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f84f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8108.913987159729, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.029122807017547, "ram_util_percent": 80.48666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9314824408235642, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.763805667127664, "policy_loss": -0.0104313353314119, "vf_loss": 5.77332369120865, "vf_explained_var": 0.002400067959603664, "kl": 0.009133140903601776, "entropy": 0.9455070223099888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 230055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 1470.0, "episode_reward_min": 90.0, "episode_reward_mean": 593.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 59.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [385.0, 400.0, 320.0, 630.0, 590.0, 390.0, 850.0, 1110.0, 1370.0, 260.0, 290.0, 770.0, 250.0, 500.0, 500.0, 770.0, 170.0, 660.0, 720.0, 680.0, 90.0, 530.0, 260.0, 620.0, 680.0, 500.0, 530.0, 300.0, 650.0, 410.0, 310.0, 450.0, 570.0, 640.0, 640.0, 390.0, 680.0, 1160.0, 400.0, 460.0, 670.0, 940.0, 760.0, 970.0, 210.0, 480.0, 870.0, 1010.0, 380.0, 230.0, 850.0, 610.0, 820.0, 250.0, 500.0, 810.0, 540.0, 390.0, 510.0, 490.0, 520.0, 390.0, 180.0, 980.0, 460.0, 790.0, 1050.0, 560.0, 220.0, 650.0, 280.0, 820.0, 960.0, 230.0, 880.0, 150.0, 630.0, 530.0, 730.0, 710.0, 550.0, 350.0, 1020.0, 1090.0, 320.0, 180.0, 570.0, 365.0, 250.0, 940.0, 410.0, 1000.0, 930.0, 1040.0, 1470.0, 320.0, 230.0, 300.0, 990.0, 1110.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 30.0, 60.0, 20.0, 50.0, 20.0, 30.0, -5.0, 20.0, 100.0, 30.0, 20.0, 30.0, 80.0, 0.0, 110.0, 30.0, 50.0, 50.0, 0.0, 0.0, 30.0, 40.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 50.0, 10.0, 90.0, 60.0, 0.0, 0.0, 50.0, 180.0, 180.0, 10.0, 30.0, 40.0, 50.0, 60.0, -30.0, 360.0, 20.0, -40.0, 70.0, 30.0, 20.0, 60.0, 50.0, 180.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, -40.0, 110.0, 40.0, 60.0, 130.0, 270.0, 10.0, 0.0, 40.0, 230.0, 70.0, 150.0, 290.0, 70.0, -20.0, 60.0, 120.0, 290.0, 30.0, 50.0, 170.0, 60.0, 160.0, 280.0, 70.0, 30.0, 30.0, 50.0, 510.0, 10.0, 0.0, 10.0, 40.0, 100.0, 10.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 140.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 50.0, 40.0, 170.0, 100.0, 40.0, 20.0, 20.0, 300.0, 40.0, 50.0, 40.0, 10.0, 20.0, 0.0, 20.0, 50.0, 20.0, 0.0, 100.0, 0.0, 20.0, 70.0, 10.0, 80.0, 0.0, 120.0, 40.0, 60.0, 20.0, 20.0, 390.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 230.0, 30.0, 0.0, 50.0, 30.0, 270.0, 60.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 10.0, 10.0, 30.0, 0.0, 110.0, 210.0, 0.0, 210.0, 40.0, 10.0, 10.0, 40.0, 20.0, 10.0, 210.0, -80.0, 20.0, 10.0, 40.0, 500.0, 10.0, -20.0, 10.0, 20.0, 90.0, 150.0, 10.0, 60.0, 20.0, 0.0, -20.0, 40.0, 260.0, 70.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 30.0, 40.0, 40.0, 70.0, 20.0, 180.0, 30.0, 80.0, 40.0, 30.0, 210.0, 0.0, -160.0, 20.0, 40.0, 20.0, 30.0, 30.0, 60.0, 40.0, 40.0, 10.0, 10.0, 110.0, 20.0, 220.0, 60.0, 50.0, 90.0, 130.0, 30.0, 0.0, 90.0, 0.0, 50.0, 50.0, 40.0, 200.0, 20.0, 170.0, 110.0, 20.0, 20.0, 10.0, 70.0, 30.0, 40.0, 10.0, 90.0, 30.0, 0.0, 120.0, 80.0, 70.0, 10.0, 50.0, 40.0, 40.0, 10.0, 20.0, 60.0, 50.0, 20.0, 10.0, 10.0, 50.0, 70.0, 0.0, 360.0, 70.0, 10.0, 0.0, 50.0, 80.0, 20.0, 10.0, 20.0, 30.0, 160.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 0.0, 150.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 160.0, 30.0, 10.0, 110.0, 0.0, 20.0, 60.0, 50.0, 50.0, 10.0, 110.0, 50.0, 250.0, 0.0, 20.0, 10.0, 70.0, 60.0, 20.0, 50.0, 40.0, 50.0, 70.0, 0.0, 70.0, 60.0, 40.0, 0.0, 170.0, 90.0, 90.0, 0.0, 190.0, 20.0, 30.0, 200.0, 60.0, 20.0, 30.0, 70.0, 20.0, 10.0, 70.0, 30.0, 110.0, 60.0, 30.0, 40.0, 0.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 30.0, 160.0, 90.0, 10.0, 160.0, 30.0, 210.0, 50.0, 150.0, 10.0, 30.0, 40.0, 20.0, 100.0, 180.0, 370.0, 50.0, 50.0, 60.0, 20.0, 20.0, 40.0, 90.0, 60.0, 0.0, 10.0, 80.0, 0.0, 30.0, 70.0, 0.0, 40.0, 50.0, 10.0, 160.0, 20.0, 40.0, 0.0, 50.0, 10.0, 20.0, 20.0, 80.0, 80.0, 370.0, 0.0, 30.0, 60.0, 370.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 300.0, 20.0, 30.0, 170.0, 210.0, -10.0, 50.0, 80.0, -30.0, 170.0, 70.0, 10.0, 60.0, 20.0, 190.0, 80.0, 160.0, 20.0, 190.0, 180.0, 60.0, 70.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 20.0, 40.0, 150.0, 20.0, 30.0, 100.0, 40.0, 30.0, 40.0, 60.0, 110.0, 50.0, 210.0, 20.0, 60.0, 320.0, 0.0, 0.0, 40.0, 40.0, 80.0, -20.0, 150.0, 70.0, 40.0, 90.0, 480.0, 30.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 130.0, 0.0, 50.0, 40.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 90.0, 110.0, 200.0, 10.0, 300.0, -40.0, 80.0, 30.0, 0.0, 40.0, 160.0, 20.0, 210.0, 20.0, 30.0, 10.0, 30.0, 90.0, 30.0, 10.0, 250.0, 380.0, -30.0, 30.0, -50.0, -20.0, 140.0, 80.0, 0.0, 60.0, 20.0, 0.0, 20.0, 10.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 100.0, 30.0, 0.0, 130.0, 20.0, 0.0, 30.0, 50.0, 50.0, 120.0, 30.0, 170.0, 60.0, 170.0, 20.0, -10.0, 200.0, 0.0, 0.0, 20.0, 100.0, 190.0, 10.0, 100.0, 50.0, 10.0, 10.0, 50.0, 30.0, 30.0, 20.0, 20.0, 10.0, 150.0, 0.0, 70.0, 20.0, 40.0, 45.0, 30.0, 80.0, 20.0, 115.0, 20.0, 60.0, 50.0, 70.0, 20.0, 80.0, 30.0, 50.0, 0.0, 20.0, 20.0, 20.0, 70.0, 180.0, 20.0, 270.0, 30.0, 40.0, 60.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 390.0, -40.0, 10.0, -40.0, 40.0, -40.0, 10.0, -40.0, 60.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 60.0, 30.0, 0.0, 20.0, 0.0, 260.0, 70.0, 20.0, 70.0, 60.0, 30.0, 80.0, 80.0, 80.0, 230.0, 90.0, -20.0, 110.0, 20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 40.0, 40.0, 30.0, 90.0, 200.0, 20.0, 10.0, 70.0, 190.0, 30.0, 110.0, 350.0, 170.0, -20.0, 90.0, 100.0, 70.0, 190.0, 40.0, 10.0, 50.0, 10.0, 40.0, 60.0, 30.0, 20.0, 180.0, 60.0, 0.0, 70.0, 90.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 30.0, 140.0, 30.0, 70.0, 270.0, 10.0, 0.0, 20.0, 50.0, 10.0, 40.0, 40.0, 0.0, 30.0, 80.0, 120.0, 30.0, 80.0, 50.0, 20.0, 210.0, 130.0, 60.0, 110.0, 10.0, 160.0, 150.0, 20.0, 0.0, 190.0, 180.0, 80.0, 0.0, 70.0, 110.0, 10.0, 10.0, 20.0, 70.0, 0.0, 10.0, 40.0, 10.0, 20.0, 40.0, -70.0, -30.0, 50.0, 90.0, 50.0, 70.0, 50.0, 40.0, 530.0, 100.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 60.0, 10.0, 0.0, 260.0, 20.0, 90.0, -20.0, 0.0, 40.0, 190.0, 20.0, 30.0, 70.0, 40.0, 90.0, 90.0, 20.0, 20.0, 20.0, 30.0, 20.0, 130.0, 40.0, 20.0, 30.0, 30.0, 170.0, 20.0, 270.0, 50.0, 80.0, 20.0, 20.0, 40.0, 90.0, 50.0, 40.0, 20.0, 40.0, 20.0, 370.0, 20.0, 130.0, 70.0, 0.0, 0.0, 10.0, 90.0, 20.0, 40.0, 160.0, 30.0, 100.0, 50.0, 0.0, 60.0, 20.0, 50.0, 10.0, 30.0, 20.0, 10.0, 120.0, 100.0, 30.0, 40.0, 60.0, 50.0, 200.0, 110.0, 50.0, 260.0, 40.0, 60.0, -40.0, 100.0, 490.0, 90.0, 70.0, 20.0, 50.0, 210.0, 30.0, 80.0, 20.0, 40.0, 0.0, 30.0, 10.0, 30.0, 20.0, 60.0, 10.0, 60.0, 0.0, 40.0, 30.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 40.0, 20.0, 80.0, 290.0, 0.0, 20.0, 70.0, 10.0, 20.0, 0.0, 40.0, 5.0, 70.0, 70.0, 90.0, 0.0, 60.0, 0.0, 50.0, 40.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, 40.0, 320.0, 0.0, 80.0, 80.0, 50.0, 70.0, 30.0, 180.0, 90.0, 10.0, 30.0, 150.0, 30.0, 40.0, 0.0, 100.0, 0.0, 20.0, 30.0, 30.0, 10.0, 220.0, 460.0, 50.0, 40.0, 30.0, 50.0, 40.0, 70.0, 10.0, 40.0, 210.0, 40.0, 170.0, 160.0, 80.0, 30.0, 10.0, 180.0, 120.0, 30.0, 70.0, 10.0, 290.0, 50.0, 40.0, 320.0, 90.0, 20.0, 20.0, 140.0, 330.0, 180.0, 270.0, 300.0, 60.0, 30.0, 0.0, 140.0, 0.0, 20.0, 50.0, 180.0, 180.0, 10.0, 20.0, -210.0, 20.0, 50.0, 70.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 20.0, 0.0, 10.0, 160.0, 40.0, 0.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 80.0, 390.0, 50.0, 20.0, 20.0, 40.0, 10.0, 170.0, 80.0, 130.0, 70.0, 10.0, 70.0, 360.0, 100.0, 50.0, 80.0, 160.0, -40.0, 250.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8021479395279068, "mean_inference_ms": 2.5634729261829743, "mean_action_processing_ms": 0.7703101788725201, "mean_env_wait_ms": 2.489544734952586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01333928108215332, "StateBufferConnector_ms": 0.010159730911254883, "ViewRequirementAgentConnector_ms": 0.42922496795654297}, "num_episodes": 18, "episode_return_max": 1470.0, "episode_return_min": 90.0, "episode_return_mean": 593.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.913131934918997, "num_env_steps_trained_throughput_per_sec": 19.913131934918997, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 202397.766, "restore_workers_time_ms": 0.012, "training_step_time_ms": 202397.717, "sample_time_ms": 3123.296, "learn_time_ms": 199251.533, "learn_throughput": 20.075, "synch_weights_time_ms": 11.692}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 25, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-51-32", "timestamp": 1717217492, "time_this_iter_s": 200.88054203987122, "time_total_s": 8309.7945291996, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f824f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8309.7945291996, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.629122807017545, "ram_util_percent": 80.68912280701754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.826431803536999, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.340377619142096, "policy_loss": -0.011223873382318205, "vf_loss": 5.350651129543845, "vf_explained_var": 0.0009521220375300723, "kl": 0.00950362021253011, "entropy": 0.9483872039947774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 239445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 1470.0, "episode_reward_min": 90.0, "episode_reward_mean": 593.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 59.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [720.0, 680.0, 90.0, 530.0, 260.0, 620.0, 680.0, 500.0, 530.0, 300.0, 650.0, 410.0, 310.0, 450.0, 570.0, 640.0, 640.0, 390.0, 680.0, 1160.0, 400.0, 460.0, 670.0, 940.0, 760.0, 970.0, 210.0, 480.0, 870.0, 1010.0, 380.0, 230.0, 850.0, 610.0, 820.0, 250.0, 500.0, 810.0, 540.0, 390.0, 510.0, 490.0, 520.0, 390.0, 180.0, 980.0, 460.0, 790.0, 1050.0, 560.0, 220.0, 650.0, 280.0, 820.0, 960.0, 230.0, 880.0, 150.0, 630.0, 530.0, 730.0, 710.0, 550.0, 350.0, 1020.0, 1090.0, 320.0, 180.0, 570.0, 365.0, 250.0, 940.0, 410.0, 1000.0, 930.0, 1040.0, 1470.0, 320.0, 230.0, 300.0, 990.0, 1110.0, 1020.0, 390.0, 340.0, 210.0, 1000.0, 450.0, 380.0, 1120.0, 600.0, 140.0, 990.0, 920.0, 545.0, 435.0, 145.0, 440.0, 705.0, 380.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, -80.0, 20.0, 10.0, 40.0, 500.0, 10.0, -20.0, 10.0, 20.0, 90.0, 150.0, 10.0, 60.0, 20.0, 0.0, -20.0, 40.0, 260.0, 70.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 30.0, 40.0, 40.0, 70.0, 20.0, 180.0, 30.0, 80.0, 40.0, 30.0, 210.0, 0.0, -160.0, 20.0, 40.0, 20.0, 30.0, 30.0, 60.0, 40.0, 40.0, 10.0, 10.0, 110.0, 20.0, 220.0, 60.0, 50.0, 90.0, 130.0, 30.0, 0.0, 90.0, 0.0, 50.0, 50.0, 40.0, 200.0, 20.0, 170.0, 110.0, 20.0, 20.0, 10.0, 70.0, 30.0, 40.0, 10.0, 90.0, 30.0, 0.0, 120.0, 80.0, 70.0, 10.0, 50.0, 40.0, 40.0, 10.0, 20.0, 60.0, 50.0, 20.0, 10.0, 10.0, 50.0, 70.0, 0.0, 360.0, 70.0, 10.0, 0.0, 50.0, 80.0, 20.0, 10.0, 20.0, 30.0, 160.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 0.0, 150.0, 30.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 160.0, 30.0, 10.0, 110.0, 0.0, 20.0, 60.0, 50.0, 50.0, 10.0, 110.0, 50.0, 250.0, 0.0, 20.0, 10.0, 70.0, 60.0, 20.0, 50.0, 40.0, 50.0, 70.0, 0.0, 70.0, 60.0, 40.0, 0.0, 170.0, 90.0, 90.0, 0.0, 190.0, 20.0, 30.0, 200.0, 60.0, 20.0, 30.0, 70.0, 20.0, 10.0, 70.0, 30.0, 110.0, 60.0, 30.0, 40.0, 0.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 30.0, 160.0, 90.0, 10.0, 160.0, 30.0, 210.0, 50.0, 150.0, 10.0, 30.0, 40.0, 20.0, 100.0, 180.0, 370.0, 50.0, 50.0, 60.0, 20.0, 20.0, 40.0, 90.0, 60.0, 0.0, 10.0, 80.0, 0.0, 30.0, 70.0, 0.0, 40.0, 50.0, 10.0, 160.0, 20.0, 40.0, 0.0, 50.0, 10.0, 20.0, 20.0, 80.0, 80.0, 370.0, 0.0, 30.0, 60.0, 370.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 300.0, 20.0, 30.0, 170.0, 210.0, -10.0, 50.0, 80.0, -30.0, 170.0, 70.0, 10.0, 60.0, 20.0, 190.0, 80.0, 160.0, 20.0, 190.0, 180.0, 60.0, 70.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 20.0, 40.0, 150.0, 20.0, 30.0, 100.0, 40.0, 30.0, 40.0, 60.0, 110.0, 50.0, 210.0, 20.0, 60.0, 320.0, 0.0, 0.0, 40.0, 40.0, 80.0, -20.0, 150.0, 70.0, 40.0, 90.0, 480.0, 30.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 130.0, 0.0, 50.0, 40.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 90.0, 110.0, 200.0, 10.0, 300.0, -40.0, 80.0, 30.0, 0.0, 40.0, 160.0, 20.0, 210.0, 20.0, 30.0, 10.0, 30.0, 90.0, 30.0, 10.0, 250.0, 380.0, -30.0, 30.0, -50.0, -20.0, 140.0, 80.0, 0.0, 60.0, 20.0, 0.0, 20.0, 10.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 100.0, 30.0, 0.0, 130.0, 20.0, 0.0, 30.0, 50.0, 50.0, 120.0, 30.0, 170.0, 60.0, 170.0, 20.0, -10.0, 200.0, 0.0, 0.0, 20.0, 100.0, 190.0, 10.0, 100.0, 50.0, 10.0, 10.0, 50.0, 30.0, 30.0, 20.0, 20.0, 10.0, 150.0, 0.0, 70.0, 20.0, 40.0, 45.0, 30.0, 80.0, 20.0, 115.0, 20.0, 60.0, 50.0, 70.0, 20.0, 80.0, 30.0, 50.0, 0.0, 20.0, 20.0, 20.0, 70.0, 180.0, 20.0, 270.0, 30.0, 40.0, 60.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 390.0, -40.0, 10.0, -40.0, 40.0, -40.0, 10.0, -40.0, 60.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 60.0, 30.0, 0.0, 20.0, 0.0, 260.0, 70.0, 20.0, 70.0, 60.0, 30.0, 80.0, 80.0, 80.0, 230.0, 90.0, -20.0, 110.0, 20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 40.0, 40.0, 30.0, 90.0, 200.0, 20.0, 10.0, 70.0, 190.0, 30.0, 110.0, 350.0, 170.0, -20.0, 90.0, 100.0, 70.0, 190.0, 40.0, 10.0, 50.0, 10.0, 40.0, 60.0, 30.0, 20.0, 180.0, 60.0, 0.0, 70.0, 90.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 30.0, 140.0, 30.0, 70.0, 270.0, 10.0, 0.0, 20.0, 50.0, 10.0, 40.0, 40.0, 0.0, 30.0, 80.0, 120.0, 30.0, 80.0, 50.0, 20.0, 210.0, 130.0, 60.0, 110.0, 10.0, 160.0, 150.0, 20.0, 0.0, 190.0, 180.0, 80.0, 0.0, 70.0, 110.0, 10.0, 10.0, 20.0, 70.0, 0.0, 10.0, 40.0, 10.0, 20.0, 40.0, -70.0, -30.0, 50.0, 90.0, 50.0, 70.0, 50.0, 40.0, 530.0, 100.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 60.0, 10.0, 0.0, 260.0, 20.0, 90.0, -20.0, 0.0, 40.0, 190.0, 20.0, 30.0, 70.0, 40.0, 90.0, 90.0, 20.0, 20.0, 20.0, 30.0, 20.0, 130.0, 40.0, 20.0, 30.0, 30.0, 170.0, 20.0, 270.0, 50.0, 80.0, 20.0, 20.0, 40.0, 90.0, 50.0, 40.0, 20.0, 40.0, 20.0, 370.0, 20.0, 130.0, 70.0, 0.0, 0.0, 10.0, 90.0, 20.0, 40.0, 160.0, 30.0, 100.0, 50.0, 0.0, 60.0, 20.0, 50.0, 10.0, 30.0, 20.0, 10.0, 120.0, 100.0, 30.0, 40.0, 60.0, 50.0, 200.0, 110.0, 50.0, 260.0, 40.0, 60.0, -40.0, 100.0, 490.0, 90.0, 70.0, 20.0, 50.0, 210.0, 30.0, 80.0, 20.0, 40.0, 0.0, 30.0, 10.0, 30.0, 20.0, 60.0, 10.0, 60.0, 0.0, 40.0, 30.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 40.0, 20.0, 80.0, 290.0, 0.0, 20.0, 70.0, 10.0, 20.0, 0.0, 40.0, 5.0, 70.0, 70.0, 90.0, 0.0, 60.0, 0.0, 50.0, 40.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, 40.0, 320.0, 0.0, 80.0, 80.0, 50.0, 70.0, 30.0, 180.0, 90.0, 10.0, 30.0, 150.0, 30.0, 40.0, 0.0, 100.0, 0.0, 20.0, 30.0, 30.0, 10.0, 220.0, 460.0, 50.0, 40.0, 30.0, 50.0, 40.0, 70.0, 10.0, 40.0, 210.0, 40.0, 170.0, 160.0, 80.0, 30.0, 10.0, 180.0, 120.0, 30.0, 70.0, 10.0, 290.0, 50.0, 40.0, 320.0, 90.0, 20.0, 20.0, 140.0, 330.0, 180.0, 270.0, 300.0, 60.0, 30.0, 0.0, 140.0, 0.0, 20.0, 50.0, 180.0, 180.0, 10.0, 20.0, -210.0, 20.0, 50.0, 70.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 20.0, 0.0, 10.0, 160.0, 40.0, 0.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 80.0, 390.0, 50.0, 20.0, 20.0, 40.0, 10.0, 170.0, 80.0, 130.0, 70.0, 10.0, 70.0, 360.0, 100.0, 50.0, 80.0, 160.0, -40.0, 250.0, 50.0, 160.0, 180.0, 140.0, 30.0, 150.0, 20.0, 100.0, 180.0, 10.0, 10.0, 70.0, 30.0, 20.0, 0.0, 60.0, 20.0, 80.0, 60.0, 40.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 70.0, 20.0, 30.0, 50.0, 20.0, 0.0, 10.0, 40.0, 0.0, 10.0, 30.0, 110.0, 170.0, 130.0, 40.0, 330.0, 10.0, 20.0, 50.0, 80.0, 60.0, 70.0, 20.0, 110.0, 0.0, 80.0, 30.0, 70.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 50.0, 80.0, 100.0, 30.0, 20.0, 30.0, 10.0, -20.0, 70.0, 90.0, 340.0, 120.0, 50.0, 190.0, 10.0, 110.0, 160.0, 90.0, 30.0, 40.0, 40.0, 150.0, 20.0, 100.0, 50.0, 60.0, 20.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, -30.0, 80.0, 0.0, 100.0, 20.0, 120.0, 100.0, 390.0, -30.0, 240.0, 110.0, 20.0, 50.0, 360.0, 210.0, 40.0, 80.0, -20.0, 40.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 230.0, 50.0, 55.0, 50.0, -5.0, 50.0, 40.0, 50.0, 20.0, 40.0, 60.0, 100.0, 40.0, 40.0, 80.0, 10.0, -10.0, 0.0, 10.0, 5.0, 0.0, 30.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 20.0, 290.0, 0.0, 20.0, 0.0, 60.0, 90.0, 80.0, 25.0, 250.0, 0.0, 130.0, 0.0, 30.0, 40.0, 10.0, 40.0, 40.0, 40.0, 20.0, 40.0, 10.0, 60.0, 40.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.754993118669986, "mean_inference_ms": 2.5244108784706114, "mean_action_processing_ms": 0.7558820436267021, "mean_env_wait_ms": 2.442568420096968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013669252395629883, "StateBufferConnector_ms": 0.00999760627746582, "ViewRequirementAgentConnector_ms": 0.42397189140319824}, "num_episodes": 18, "episode_return_max": 1470.0, "episode_return_min": 90.0, "episode_return_mean": 593.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 16.894898445712414, "num_env_steps_trained_throughput_per_sec": 16.894898445712414, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 205557.379, "restore_workers_time_ms": 0.012, "training_step_time_ms": 205557.331, "sample_time_ms": 2786.501, "learn_time_ms": 202748.381, "learn_throughput": 19.729, "synch_weights_time_ms": 11.254}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 26, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-55-29", "timestamp": 1717217729, "time_this_iter_s": 236.76450276374817, "time_total_s": 8546.559031963348, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f887550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8546.559031963348, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.453521126760563, "ram_util_percent": 80.21126760563381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9448221013568843, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6590069102530025, "policy_loss": -0.009577170559438193, "vf_loss": 5.66765931188362, "vf_explained_var": 0.0009910449750634173, "kl": 0.00924769166006239, "entropy": 0.90111213945987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 248835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 140.0, "episode_reward_mean": 650.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 65.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [680.0, 1160.0, 400.0, 460.0, 670.0, 940.0, 760.0, 970.0, 210.0, 480.0, 870.0, 1010.0, 380.0, 230.0, 850.0, 610.0, 820.0, 250.0, 500.0, 810.0, 540.0, 390.0, 510.0, 490.0, 520.0, 390.0, 180.0, 980.0, 460.0, 790.0, 1050.0, 560.0, 220.0, 650.0, 280.0, 820.0, 960.0, 230.0, 880.0, 150.0, 630.0, 530.0, 730.0, 710.0, 550.0, 350.0, 1020.0, 1090.0, 320.0, 180.0, 570.0, 365.0, 250.0, 940.0, 410.0, 1000.0, 930.0, 1040.0, 1470.0, 320.0, 230.0, 300.0, 990.0, 1110.0, 1020.0, 390.0, 340.0, 210.0, 1000.0, 450.0, 380.0, 1120.0, 600.0, 140.0, 990.0, 920.0, 545.0, 435.0, 145.0, 440.0, 705.0, 380.0, 770.0, 380.0, 1060.0, 290.0, 670.0, 750.0, 620.0, 925.0, 295.0, 1210.0, 940.0, 620.0, 1210.0, 720.0, 680.0, 1660.0, 960.0, 940.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 80.0, 60.0, 0.0, 30.0, 160.0, 90.0, 10.0, 160.0, 30.0, 210.0, 50.0, 150.0, 10.0, 30.0, 40.0, 20.0, 100.0, 180.0, 370.0, 50.0, 50.0, 60.0, 20.0, 20.0, 40.0, 90.0, 60.0, 0.0, 10.0, 80.0, 0.0, 30.0, 70.0, 0.0, 40.0, 50.0, 10.0, 160.0, 20.0, 40.0, 0.0, 50.0, 10.0, 20.0, 20.0, 80.0, 80.0, 370.0, 0.0, 30.0, 60.0, 370.0, 10.0, 40.0, 20.0, 0.0, 40.0, 70.0, 300.0, 20.0, 30.0, 170.0, 210.0, -10.0, 50.0, 80.0, -30.0, 170.0, 70.0, 10.0, 60.0, 20.0, 190.0, 80.0, 160.0, 20.0, 190.0, 180.0, 60.0, 70.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 20.0, 40.0, 150.0, 20.0, 30.0, 100.0, 40.0, 30.0, 40.0, 60.0, 110.0, 50.0, 210.0, 20.0, 60.0, 320.0, 0.0, 0.0, 40.0, 40.0, 80.0, -20.0, 150.0, 70.0, 40.0, 90.0, 480.0, 30.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 130.0, 0.0, 50.0, 40.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 90.0, 110.0, 200.0, 10.0, 300.0, -40.0, 80.0, 30.0, 0.0, 40.0, 160.0, 20.0, 210.0, 20.0, 30.0, 10.0, 30.0, 90.0, 30.0, 10.0, 250.0, 380.0, -30.0, 30.0, -50.0, -20.0, 140.0, 80.0, 0.0, 60.0, 20.0, 0.0, 20.0, 10.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 100.0, 30.0, 0.0, 130.0, 20.0, 0.0, 30.0, 50.0, 50.0, 120.0, 30.0, 170.0, 60.0, 170.0, 20.0, -10.0, 200.0, 0.0, 0.0, 20.0, 100.0, 190.0, 10.0, 100.0, 50.0, 10.0, 10.0, 50.0, 30.0, 30.0, 20.0, 20.0, 10.0, 150.0, 0.0, 70.0, 20.0, 40.0, 45.0, 30.0, 80.0, 20.0, 115.0, 20.0, 60.0, 50.0, 70.0, 20.0, 80.0, 30.0, 50.0, 0.0, 20.0, 20.0, 20.0, 70.0, 180.0, 20.0, 270.0, 30.0, 40.0, 60.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 390.0, -40.0, 10.0, -40.0, 40.0, -40.0, 10.0, -40.0, 60.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 60.0, 30.0, 0.0, 20.0, 0.0, 260.0, 70.0, 20.0, 70.0, 60.0, 30.0, 80.0, 80.0, 80.0, 230.0, 90.0, -20.0, 110.0, 20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 40.0, 40.0, 30.0, 90.0, 200.0, 20.0, 10.0, 70.0, 190.0, 30.0, 110.0, 350.0, 170.0, -20.0, 90.0, 100.0, 70.0, 190.0, 40.0, 10.0, 50.0, 10.0, 40.0, 60.0, 30.0, 20.0, 180.0, 60.0, 0.0, 70.0, 90.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 30.0, 140.0, 30.0, 70.0, 270.0, 10.0, 0.0, 20.0, 50.0, 10.0, 40.0, 40.0, 0.0, 30.0, 80.0, 120.0, 30.0, 80.0, 50.0, 20.0, 210.0, 130.0, 60.0, 110.0, 10.0, 160.0, 150.0, 20.0, 0.0, 190.0, 180.0, 80.0, 0.0, 70.0, 110.0, 10.0, 10.0, 20.0, 70.0, 0.0, 10.0, 40.0, 10.0, 20.0, 40.0, -70.0, -30.0, 50.0, 90.0, 50.0, 70.0, 50.0, 40.0, 530.0, 100.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 60.0, 10.0, 0.0, 260.0, 20.0, 90.0, -20.0, 0.0, 40.0, 190.0, 20.0, 30.0, 70.0, 40.0, 90.0, 90.0, 20.0, 20.0, 20.0, 30.0, 20.0, 130.0, 40.0, 20.0, 30.0, 30.0, 170.0, 20.0, 270.0, 50.0, 80.0, 20.0, 20.0, 40.0, 90.0, 50.0, 40.0, 20.0, 40.0, 20.0, 370.0, 20.0, 130.0, 70.0, 0.0, 0.0, 10.0, 90.0, 20.0, 40.0, 160.0, 30.0, 100.0, 50.0, 0.0, 60.0, 20.0, 50.0, 10.0, 30.0, 20.0, 10.0, 120.0, 100.0, 30.0, 40.0, 60.0, 50.0, 200.0, 110.0, 50.0, 260.0, 40.0, 60.0, -40.0, 100.0, 490.0, 90.0, 70.0, 20.0, 50.0, 210.0, 30.0, 80.0, 20.0, 40.0, 0.0, 30.0, 10.0, 30.0, 20.0, 60.0, 10.0, 60.0, 0.0, 40.0, 30.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 40.0, 20.0, 80.0, 290.0, 0.0, 20.0, 70.0, 10.0, 20.0, 0.0, 40.0, 5.0, 70.0, 70.0, 90.0, 0.0, 60.0, 0.0, 50.0, 40.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, 40.0, 320.0, 0.0, 80.0, 80.0, 50.0, 70.0, 30.0, 180.0, 90.0, 10.0, 30.0, 150.0, 30.0, 40.0, 0.0, 100.0, 0.0, 20.0, 30.0, 30.0, 10.0, 220.0, 460.0, 50.0, 40.0, 30.0, 50.0, 40.0, 70.0, 10.0, 40.0, 210.0, 40.0, 170.0, 160.0, 80.0, 30.0, 10.0, 180.0, 120.0, 30.0, 70.0, 10.0, 290.0, 50.0, 40.0, 320.0, 90.0, 20.0, 20.0, 140.0, 330.0, 180.0, 270.0, 300.0, 60.0, 30.0, 0.0, 140.0, 0.0, 20.0, 50.0, 180.0, 180.0, 10.0, 20.0, -210.0, 20.0, 50.0, 70.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 20.0, 0.0, 10.0, 160.0, 40.0, 0.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 80.0, 390.0, 50.0, 20.0, 20.0, 40.0, 10.0, 170.0, 80.0, 130.0, 70.0, 10.0, 70.0, 360.0, 100.0, 50.0, 80.0, 160.0, -40.0, 250.0, 50.0, 160.0, 180.0, 140.0, 30.0, 150.0, 20.0, 100.0, 180.0, 10.0, 10.0, 70.0, 30.0, 20.0, 0.0, 60.0, 20.0, 80.0, 60.0, 40.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 70.0, 20.0, 30.0, 50.0, 20.0, 0.0, 10.0, 40.0, 0.0, 10.0, 30.0, 110.0, 170.0, 130.0, 40.0, 330.0, 10.0, 20.0, 50.0, 80.0, 60.0, 70.0, 20.0, 110.0, 0.0, 80.0, 30.0, 70.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 50.0, 80.0, 100.0, 30.0, 20.0, 30.0, 10.0, -20.0, 70.0, 90.0, 340.0, 120.0, 50.0, 190.0, 10.0, 110.0, 160.0, 90.0, 30.0, 40.0, 40.0, 150.0, 20.0, 100.0, 50.0, 60.0, 20.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, -30.0, 80.0, 0.0, 100.0, 20.0, 120.0, 100.0, 390.0, -30.0, 240.0, 110.0, 20.0, 50.0, 360.0, 210.0, 40.0, 80.0, -20.0, 40.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 230.0, 50.0, 55.0, 50.0, -5.0, 50.0, 40.0, 50.0, 20.0, 40.0, 60.0, 100.0, 40.0, 40.0, 80.0, 10.0, -10.0, 0.0, 10.0, 5.0, 0.0, 30.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 20.0, 290.0, 0.0, 20.0, 0.0, 60.0, 90.0, 80.0, 25.0, 250.0, 0.0, 130.0, 0.0, 30.0, 40.0, 10.0, 40.0, 40.0, 40.0, 20.0, 40.0, 10.0, 60.0, 40.0, 80.0, 100.0, 90.0, 60.0, -30.0, 30.0, 10.0, 20.0, 60.0, 40.0, 390.0, 50.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 250.0, 0.0, 180.0, 30.0, 20.0, 80.0, 50.0, 20.0, 10.0, 10.0, 590.0, 70.0, 170.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 150.0, 260.0, 60.0, 50.0, 10.0, 80.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 80.0, 60.0, 80.0, 280.0, 140.0, 0.0, 0.0, 20.0, 50.0, 10.0, 20.0, 190.0, 130.0, 50.0, 150.0, 25.0, 0.0, 50.0, 230.0, 0.0, 180.0, 30.0, 0.0, 10.0, 400.0, 40.0, 30.0, -5.0, 110.0, 10.0, 20.0, 0.0, 30.0, 20.0, 40.0, 360.0, 80.0, 60.0, 90.0, 40.0, 80.0, 190.0, 70.0, 150.0, 90.0, 50.0, 200.0, 40.0, 80.0, 90.0, 170.0, 80.0, 120.0, 60.0, 50.0, 60.0, 20.0, 30.0, 270.0, 70.0, 50.0, 10.0, 40.0, 60.0, 10.0, 40.0, 290.0, -40.0, 40.0, 30.0, 530.0, 110.0, 50.0, 80.0, 80.0, 180.0, 140.0, 180.0, 10.0, -30.0, 110.0, 70.0, 10.0, 20.0, 30.0, 60.0, 80.0, 80.0, 30.0, -40.0, 10.0, 270.0, 10.0, 80.0, 100.0, 110.0, 80.0, 100.0, 80.0, 210.0, 300.0, 100.0, 260.0, 210.0, 210.0, 20.0, 280.0, -30.0, 60.0, 190.0, 40.0, 50.0, 80.0, 250.0, 20.0, 30.0, 20.0, 170.0, -40.0, 90.0, 190.0, 220.0, 120.0, 20.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.712314533524678, "mean_inference_ms": 2.4872311188497433, "mean_action_processing_ms": 0.7423711586194048, "mean_env_wait_ms": 2.398765266840528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013788461685180664, "StateBufferConnector_ms": 0.009714126586914062, "ViewRequirementAgentConnector_ms": 0.4152035713195801}, "num_episodes": 18, "episode_return_max": 1660.0, "episode_return_min": 140.0, "episode_return_mean": 650.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.172296924288677, "num_env_steps_trained_throughput_per_sec": 20.172296924288677, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 205229.517, "restore_workers_time_ms": 0.012, "training_step_time_ms": 205229.469, "sample_time_ms": 2668.262, "learn_time_ms": 202538.803, "learn_throughput": 19.749, "synch_weights_time_ms": 11.286}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 27, "trial_id": "3d3a5_00000", "date": "2024-06-01_00-58-47", "timestamp": 1717217927, "time_this_iter_s": 198.302179813385, "time_total_s": 8744.861211776733, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8874c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8744.861211776733, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.30642857142857, "ram_util_percent": 78.96714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.188157791032578, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.786814377026055, "policy_loss": -0.01002681535984567, "vf_loss": 5.795816274242787, "vf_explained_var": 0.0013433499902455062, "kl": 0.010249156479956474, "entropy": 0.9084739362660308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 258225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 140.0, "episode_reward_mean": 635.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 63.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 810.0, 540.0, 390.0, 510.0, 490.0, 520.0, 390.0, 180.0, 980.0, 460.0, 790.0, 1050.0, 560.0, 220.0, 650.0, 280.0, 820.0, 960.0, 230.0, 880.0, 150.0, 630.0, 530.0, 730.0, 710.0, 550.0, 350.0, 1020.0, 1090.0, 320.0, 180.0, 570.0, 365.0, 250.0, 940.0, 410.0, 1000.0, 930.0, 1040.0, 1470.0, 320.0, 230.0, 300.0, 990.0, 1110.0, 1020.0, 390.0, 340.0, 210.0, 1000.0, 450.0, 380.0, 1120.0, 600.0, 140.0, 990.0, 920.0, 545.0, 435.0, 145.0, 440.0, 705.0, 380.0, 770.0, 380.0, 1060.0, 290.0, 670.0, 750.0, 620.0, 925.0, 295.0, 1210.0, 940.0, 620.0, 1210.0, 720.0, 680.0, 1660.0, 960.0, 940.0, 350.0, 750.0, 380.0, 800.0, 705.0, 310.0, 1110.0, 330.0, 770.0, 710.0, 500.0, 510.0, 455.0, 300.0, 720.0, 590.0, 725.0, 270.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 30.0, 100.0, 30.0, 0.0, 130.0, 20.0, 0.0, 30.0, 50.0, 50.0, 120.0, 30.0, 170.0, 60.0, 170.0, 20.0, -10.0, 200.0, 0.0, 0.0, 20.0, 100.0, 190.0, 10.0, 100.0, 50.0, 10.0, 10.0, 50.0, 30.0, 30.0, 20.0, 20.0, 10.0, 150.0, 0.0, 70.0, 20.0, 40.0, 45.0, 30.0, 80.0, 20.0, 115.0, 20.0, 60.0, 50.0, 70.0, 20.0, 80.0, 30.0, 50.0, 0.0, 20.0, 20.0, 20.0, 70.0, 180.0, 20.0, 270.0, 30.0, 40.0, 60.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 390.0, -40.0, 10.0, -40.0, 40.0, -40.0, 10.0, -40.0, 60.0, 40.0, 30.0, 10.0, 20.0, 0.0, 10.0, 60.0, 30.0, 0.0, 20.0, 0.0, 260.0, 70.0, 20.0, 70.0, 60.0, 30.0, 80.0, 80.0, 80.0, 230.0, 90.0, -20.0, 110.0, 20.0, 10.0, 20.0, 60.0, 10.0, 120.0, 40.0, 40.0, 30.0, 90.0, 200.0, 20.0, 10.0, 70.0, 190.0, 30.0, 110.0, 350.0, 170.0, -20.0, 90.0, 100.0, 70.0, 190.0, 40.0, 10.0, 50.0, 10.0, 40.0, 60.0, 30.0, 20.0, 180.0, 60.0, 0.0, 70.0, 90.0, 30.0, 10.0, 20.0, 30.0, 10.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 30.0, 140.0, 30.0, 70.0, 270.0, 10.0, 0.0, 20.0, 50.0, 10.0, 40.0, 40.0, 0.0, 30.0, 80.0, 120.0, 30.0, 80.0, 50.0, 20.0, 210.0, 130.0, 60.0, 110.0, 10.0, 160.0, 150.0, 20.0, 0.0, 190.0, 180.0, 80.0, 0.0, 70.0, 110.0, 10.0, 10.0, 20.0, 70.0, 0.0, 10.0, 40.0, 10.0, 20.0, 40.0, -70.0, -30.0, 50.0, 90.0, 50.0, 70.0, 50.0, 40.0, 530.0, 100.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 60.0, 10.0, 0.0, 260.0, 20.0, 90.0, -20.0, 0.0, 40.0, 190.0, 20.0, 30.0, 70.0, 40.0, 90.0, 90.0, 20.0, 20.0, 20.0, 30.0, 20.0, 130.0, 40.0, 20.0, 30.0, 30.0, 170.0, 20.0, 270.0, 50.0, 80.0, 20.0, 20.0, 40.0, 90.0, 50.0, 40.0, 20.0, 40.0, 20.0, 370.0, 20.0, 130.0, 70.0, 0.0, 0.0, 10.0, 90.0, 20.0, 40.0, 160.0, 30.0, 100.0, 50.0, 0.0, 60.0, 20.0, 50.0, 10.0, 30.0, 20.0, 10.0, 120.0, 100.0, 30.0, 40.0, 60.0, 50.0, 200.0, 110.0, 50.0, 260.0, 40.0, 60.0, -40.0, 100.0, 490.0, 90.0, 70.0, 20.0, 50.0, 210.0, 30.0, 80.0, 20.0, 40.0, 0.0, 30.0, 10.0, 30.0, 20.0, 60.0, 10.0, 60.0, 0.0, 40.0, 30.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 40.0, 20.0, 80.0, 290.0, 0.0, 20.0, 70.0, 10.0, 20.0, 0.0, 40.0, 5.0, 70.0, 70.0, 90.0, 0.0, 60.0, 0.0, 50.0, 40.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, 40.0, 320.0, 0.0, 80.0, 80.0, 50.0, 70.0, 30.0, 180.0, 90.0, 10.0, 30.0, 150.0, 30.0, 40.0, 0.0, 100.0, 0.0, 20.0, 30.0, 30.0, 10.0, 220.0, 460.0, 50.0, 40.0, 30.0, 50.0, 40.0, 70.0, 10.0, 40.0, 210.0, 40.0, 170.0, 160.0, 80.0, 30.0, 10.0, 180.0, 120.0, 30.0, 70.0, 10.0, 290.0, 50.0, 40.0, 320.0, 90.0, 20.0, 20.0, 140.0, 330.0, 180.0, 270.0, 300.0, 60.0, 30.0, 0.0, 140.0, 0.0, 20.0, 50.0, 180.0, 180.0, 10.0, 20.0, -210.0, 20.0, 50.0, 70.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 20.0, 0.0, 10.0, 160.0, 40.0, 0.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 80.0, 390.0, 50.0, 20.0, 20.0, 40.0, 10.0, 170.0, 80.0, 130.0, 70.0, 10.0, 70.0, 360.0, 100.0, 50.0, 80.0, 160.0, -40.0, 250.0, 50.0, 160.0, 180.0, 140.0, 30.0, 150.0, 20.0, 100.0, 180.0, 10.0, 10.0, 70.0, 30.0, 20.0, 0.0, 60.0, 20.0, 80.0, 60.0, 40.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 70.0, 20.0, 30.0, 50.0, 20.0, 0.0, 10.0, 40.0, 0.0, 10.0, 30.0, 110.0, 170.0, 130.0, 40.0, 330.0, 10.0, 20.0, 50.0, 80.0, 60.0, 70.0, 20.0, 110.0, 0.0, 80.0, 30.0, 70.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 50.0, 80.0, 100.0, 30.0, 20.0, 30.0, 10.0, -20.0, 70.0, 90.0, 340.0, 120.0, 50.0, 190.0, 10.0, 110.0, 160.0, 90.0, 30.0, 40.0, 40.0, 150.0, 20.0, 100.0, 50.0, 60.0, 20.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, -30.0, 80.0, 0.0, 100.0, 20.0, 120.0, 100.0, 390.0, -30.0, 240.0, 110.0, 20.0, 50.0, 360.0, 210.0, 40.0, 80.0, -20.0, 40.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 230.0, 50.0, 55.0, 50.0, -5.0, 50.0, 40.0, 50.0, 20.0, 40.0, 60.0, 100.0, 40.0, 40.0, 80.0, 10.0, -10.0, 0.0, 10.0, 5.0, 0.0, 30.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 20.0, 290.0, 0.0, 20.0, 0.0, 60.0, 90.0, 80.0, 25.0, 250.0, 0.0, 130.0, 0.0, 30.0, 40.0, 10.0, 40.0, 40.0, 40.0, 20.0, 40.0, 10.0, 60.0, 40.0, 80.0, 100.0, 90.0, 60.0, -30.0, 30.0, 10.0, 20.0, 60.0, 40.0, 390.0, 50.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 250.0, 0.0, 180.0, 30.0, 20.0, 80.0, 50.0, 20.0, 10.0, 10.0, 590.0, 70.0, 170.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 150.0, 260.0, 60.0, 50.0, 10.0, 80.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 80.0, 60.0, 80.0, 280.0, 140.0, 0.0, 0.0, 20.0, 50.0, 10.0, 20.0, 190.0, 130.0, 50.0, 150.0, 25.0, 0.0, 50.0, 230.0, 0.0, 180.0, 30.0, 0.0, 10.0, 400.0, 40.0, 30.0, -5.0, 110.0, 10.0, 20.0, 0.0, 30.0, 20.0, 40.0, 360.0, 80.0, 60.0, 90.0, 40.0, 80.0, 190.0, 70.0, 150.0, 90.0, 50.0, 200.0, 40.0, 80.0, 90.0, 170.0, 80.0, 120.0, 60.0, 50.0, 60.0, 20.0, 30.0, 270.0, 70.0, 50.0, 10.0, 40.0, 60.0, 10.0, 40.0, 290.0, -40.0, 40.0, 30.0, 530.0, 110.0, 50.0, 80.0, 80.0, 180.0, 140.0, 180.0, 10.0, -30.0, 110.0, 70.0, 10.0, 20.0, 30.0, 60.0, 80.0, 80.0, 30.0, -40.0, 10.0, 270.0, 10.0, 80.0, 100.0, 110.0, 80.0, 100.0, 80.0, 210.0, 300.0, 100.0, 260.0, 210.0, 210.0, 20.0, 280.0, -30.0, 60.0, 190.0, 40.0, 50.0, 80.0, 250.0, 20.0, 30.0, 20.0, 170.0, -40.0, 90.0, 190.0, 220.0, 120.0, 20.0, 120.0, 20.0, 120.0, 0.0, 40.0, 70.0, 0.0, 10.0, 50.0, 40.0, 0.0, 100.0, 30.0, 0.0, 460.0, 20.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 190.0, 30.0, 20.0, 0.0, 20.0, 70.0, 30.0, 10.0, 0.0, 80.0, 20.0, 90.0, 40.0, 10.0, 70.0, 370.0, 10.0, 30.0, 80.0, 10.0, 560.0, 40.0, 50.0, -40.0, 90.0, 20.0, 20.0, -45.0, 0.0, 60.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 70.0, 0.0, 40.0, 0.0, 250.0, 10.0, 230.0, 50.0, 0.0, 20.0, 10.0, 80.0, 460.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 160.0, 0.0, 40.0, 50.0, 70.0, 150.0, 190.0, -190.0, 30.0, 10.0, 80.0, 320.0, 60.0, 250.0, 20.0, 0.0, 100.0, 130.0, 20.0, 80.0, 30.0, 30.0, 50.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 370.0, 30.0, 10.0, 60.0, 30.0, 10.0, 30.0, 80.0, 0.0, 40.0, 160.0, 10.0, 90.0, 180.0, 20.0, -5.0, 10.0, 30.0, 10.0, 10.0, 160.0, 10.0, 30.0, 10.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 130.0, 40.0, 50.0, -40.0, 60.0, 240.0, 150.0, 20.0, 80.0, 50.0, 40.0, 70.0, 10.0, -240.0, 90.0, 180.0, 40.0, 60.0, 160.0, 230.0, 40.0, 20.0, 210.0, 150.0, 20.0, 5.0, 70.0, 0.0, 70.0, 50.0, 110.0, 40.0, 100.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 30.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.671988913771267, "mean_inference_ms": 2.451930383495243, "mean_action_processing_ms": 0.7296948756538231, "mean_env_wait_ms": 2.357699665433305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013403654098510742, "StateBufferConnector_ms": 0.009653329849243164, "ViewRequirementAgentConnector_ms": 0.4017140865325928}, "num_episodes": 18, "episode_return_max": 1660.0, "episode_return_min": 140.0, "episode_return_mean": 635.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.000838338705094, "num_env_steps_trained_throughput_per_sec": 20.000838338705094, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 205084.577, "restore_workers_time_ms": 0.012, "training_step_time_ms": 205084.532, "sample_time_ms": 2608.638, "learn_time_ms": 202453.978, "learn_throughput": 19.758, "synch_weights_time_ms": 10.993}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 28, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-02-07", "timestamp": 1717218127, "time_this_iter_s": 200.0000262260437, "time_total_s": 8944.861238002777, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f860430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8944.861238002777, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 26.125088339222618, "ram_util_percent": 79.92155477031802}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1377049482605073, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.281913812168109, "policy_loss": -0.009445486698560992, "vf_loss": 6.290477286157008, "vf_explained_var": 0.0005827191919564439, "kl": 0.008820132440284609, "entropy": 0.839678195642587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 267615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 140.0, "episode_reward_mean": 712.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 71.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0, 1020.0, 1090.0, 320.0, 180.0, 570.0, 365.0, 250.0, 940.0, 410.0, 1000.0, 930.0, 1040.0, 1470.0, 320.0, 230.0, 300.0, 990.0, 1110.0, 1020.0, 390.0, 340.0, 210.0, 1000.0, 450.0, 380.0, 1120.0, 600.0, 140.0, 990.0, 920.0, 545.0, 435.0, 145.0, 440.0, 705.0, 380.0, 770.0, 380.0, 1060.0, 290.0, 670.0, 750.0, 620.0, 925.0, 295.0, 1210.0, 940.0, 620.0, 1210.0, 720.0, 680.0, 1660.0, 960.0, 940.0, 350.0, 750.0, 380.0, 800.0, 705.0, 310.0, 1110.0, 330.0, 770.0, 710.0, 500.0, 510.0, 455.0, 300.0, 720.0, 590.0, 725.0, 270.0, 1170.0, 1220.0, 1480.0, 670.0, 1210.0, 1350.0, 890.0, 840.0, 610.0, 750.0, 480.0, 1180.0, 980.0, 340.0, 1620.0, 600.0, 970.0, 310.0, 1180.0, 590.0, 420.0, 770.0, 610.0, 570.0, 630.0, 870.0, 810.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 50.0, 0.0, 60.0, 20.0, 50.0, 10.0, 30.0, 20.0, 10.0, 120.0, 100.0, 30.0, 40.0, 60.0, 50.0, 200.0, 110.0, 50.0, 260.0, 40.0, 60.0, -40.0, 100.0, 490.0, 90.0, 70.0, 20.0, 50.0, 210.0, 30.0, 80.0, 20.0, 40.0, 0.0, 30.0, 10.0, 30.0, 20.0, 60.0, 10.0, 60.0, 0.0, 40.0, 30.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 40.0, 20.0, 80.0, 290.0, 0.0, 20.0, 70.0, 10.0, 20.0, 0.0, 40.0, 5.0, 70.0, 70.0, 90.0, 0.0, 60.0, 0.0, 50.0, 40.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, 40.0, 320.0, 0.0, 80.0, 80.0, 50.0, 70.0, 30.0, 180.0, 90.0, 10.0, 30.0, 150.0, 30.0, 40.0, 0.0, 100.0, 0.0, 20.0, 30.0, 30.0, 10.0, 220.0, 460.0, 50.0, 40.0, 30.0, 50.0, 40.0, 70.0, 10.0, 40.0, 210.0, 40.0, 170.0, 160.0, 80.0, 30.0, 10.0, 180.0, 120.0, 30.0, 70.0, 10.0, 290.0, 50.0, 40.0, 320.0, 90.0, 20.0, 20.0, 140.0, 330.0, 180.0, 270.0, 300.0, 60.0, 30.0, 0.0, 140.0, 0.0, 20.0, 50.0, 180.0, 180.0, 10.0, 20.0, -210.0, 20.0, 50.0, 70.0, 0.0, 0.0, 0.0, 10.0, 80.0, 40.0, 20.0, 0.0, 10.0, 160.0, 40.0, 0.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 0.0, 80.0, 390.0, 50.0, 20.0, 20.0, 40.0, 10.0, 170.0, 80.0, 130.0, 70.0, 10.0, 70.0, 360.0, 100.0, 50.0, 80.0, 160.0, -40.0, 250.0, 50.0, 160.0, 180.0, 140.0, 30.0, 150.0, 20.0, 100.0, 180.0, 10.0, 10.0, 70.0, 30.0, 20.0, 0.0, 60.0, 20.0, 80.0, 60.0, 40.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 70.0, 20.0, 30.0, 50.0, 20.0, 0.0, 10.0, 40.0, 0.0, 10.0, 30.0, 110.0, 170.0, 130.0, 40.0, 330.0, 10.0, 20.0, 50.0, 80.0, 60.0, 70.0, 20.0, 110.0, 0.0, 80.0, 30.0, 70.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 50.0, 80.0, 100.0, 30.0, 20.0, 30.0, 10.0, -20.0, 70.0, 90.0, 340.0, 120.0, 50.0, 190.0, 10.0, 110.0, 160.0, 90.0, 30.0, 40.0, 40.0, 150.0, 20.0, 100.0, 50.0, 60.0, 20.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, -30.0, 80.0, 0.0, 100.0, 20.0, 120.0, 100.0, 390.0, -30.0, 240.0, 110.0, 20.0, 50.0, 360.0, 210.0, 40.0, 80.0, -20.0, 40.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 230.0, 50.0, 55.0, 50.0, -5.0, 50.0, 40.0, 50.0, 20.0, 40.0, 60.0, 100.0, 40.0, 40.0, 80.0, 10.0, -10.0, 0.0, 10.0, 5.0, 0.0, 30.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 20.0, 290.0, 0.0, 20.0, 0.0, 60.0, 90.0, 80.0, 25.0, 250.0, 0.0, 130.0, 0.0, 30.0, 40.0, 10.0, 40.0, 40.0, 40.0, 20.0, 40.0, 10.0, 60.0, 40.0, 80.0, 100.0, 90.0, 60.0, -30.0, 30.0, 10.0, 20.0, 60.0, 40.0, 390.0, 50.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 250.0, 0.0, 180.0, 30.0, 20.0, 80.0, 50.0, 20.0, 10.0, 10.0, 590.0, 70.0, 170.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 150.0, 260.0, 60.0, 50.0, 10.0, 80.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 80.0, 60.0, 80.0, 280.0, 140.0, 0.0, 0.0, 20.0, 50.0, 10.0, 20.0, 190.0, 130.0, 50.0, 150.0, 25.0, 0.0, 50.0, 230.0, 0.0, 180.0, 30.0, 0.0, 10.0, 400.0, 40.0, 30.0, -5.0, 110.0, 10.0, 20.0, 0.0, 30.0, 20.0, 40.0, 360.0, 80.0, 60.0, 90.0, 40.0, 80.0, 190.0, 70.0, 150.0, 90.0, 50.0, 200.0, 40.0, 80.0, 90.0, 170.0, 80.0, 120.0, 60.0, 50.0, 60.0, 20.0, 30.0, 270.0, 70.0, 50.0, 10.0, 40.0, 60.0, 10.0, 40.0, 290.0, -40.0, 40.0, 30.0, 530.0, 110.0, 50.0, 80.0, 80.0, 180.0, 140.0, 180.0, 10.0, -30.0, 110.0, 70.0, 10.0, 20.0, 30.0, 60.0, 80.0, 80.0, 30.0, -40.0, 10.0, 270.0, 10.0, 80.0, 100.0, 110.0, 80.0, 100.0, 80.0, 210.0, 300.0, 100.0, 260.0, 210.0, 210.0, 20.0, 280.0, -30.0, 60.0, 190.0, 40.0, 50.0, 80.0, 250.0, 20.0, 30.0, 20.0, 170.0, -40.0, 90.0, 190.0, 220.0, 120.0, 20.0, 120.0, 20.0, 120.0, 0.0, 40.0, 70.0, 0.0, 10.0, 50.0, 40.0, 0.0, 100.0, 30.0, 0.0, 460.0, 20.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 190.0, 30.0, 20.0, 0.0, 20.0, 70.0, 30.0, 10.0, 0.0, 80.0, 20.0, 90.0, 40.0, 10.0, 70.0, 370.0, 10.0, 30.0, 80.0, 10.0, 560.0, 40.0, 50.0, -40.0, 90.0, 20.0, 20.0, -45.0, 0.0, 60.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 70.0, 0.0, 40.0, 0.0, 250.0, 10.0, 230.0, 50.0, 0.0, 20.0, 10.0, 80.0, 460.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 160.0, 0.0, 40.0, 50.0, 70.0, 150.0, 190.0, -190.0, 30.0, 10.0, 80.0, 320.0, 60.0, 250.0, 20.0, 0.0, 100.0, 130.0, 20.0, 80.0, 30.0, 30.0, 50.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 370.0, 30.0, 10.0, 60.0, 30.0, 10.0, 30.0, 80.0, 0.0, 40.0, 160.0, 10.0, 90.0, 180.0, 20.0, -5.0, 10.0, 30.0, 10.0, 10.0, 160.0, 10.0, 30.0, 10.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 130.0, 40.0, 50.0, -40.0, 60.0, 240.0, 150.0, 20.0, 80.0, 50.0, 40.0, 70.0, 10.0, -240.0, 90.0, 180.0, 40.0, 60.0, 160.0, 230.0, 40.0, 20.0, 210.0, 150.0, 20.0, 5.0, 70.0, 0.0, 70.0, 50.0, 110.0, 40.0, 100.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 30.0, 60.0, 200.0, 30.0, 300.0, 230.0, 60.0, 60.0, 60.0, 70.0, 70.0, 90.0, -40.0, -80.0, 360.0, 270.0, 160.0, 50.0, 100.0, 70.0, 310.0, 20.0, 210.0, 220.0, 10.0, 80.0, 60.0, 160.0, 240.0, 350.0, 90.0, 60.0, 170.0, 50.0, 250.0, 80.0, 20.0, 20.0, 20.0, 50.0, 10.0, 0.0, 40.0, 90.0, 260.0, 70.0, 110.0, 70.0, 60.0, 20.0, 150.0, 340.0, 100.0, 610.0, 90.0, -10.0, 20.0, 400.0, 100.0, -20.0, 10.0, 50.0, 90.0, 80.0, 40.0, 10.0, 170.0, 70.0, 30.0, 60.0, 170.0, 170.0, 50.0, 80.0, 160.0, 20.0, 0.0, 20.0, 90.0, 320.0, 60.0, 40.0, 20.0, 50.0, 0.0, 210.0, 30.0, 30.0, 70.0, 20.0, 30.0, 150.0, 90.0, 30.0, 30.0, 430.0, 0.0, 10.0, 0.0, 70.0, 60.0, 30.0, 10.0, -20.0, 60.0, 290.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 150.0, 40.0, 530.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 290.0, 70.0, 0.0, 360.0, 20.0, 40.0, 10.0, 30.0, 350.0, 20.0, 80.0, 30.0, 0.0, 170.0, 20.0, 40.0, 10.0, 20.0, 0.0, 20.0, 30.0, 710.0, 30.0, -10.0, -20.0, 40.0, 110.0, 240.0, 100.0, 100.0, 320.0, 60.0, 370.0, 0.0, 10.0, 20.0, 40.0, 20.0, 30.0, 40.0, 10.0, 360.0, 30.0, 30.0, 60.0, 40.0, 40.0, 20.0, 60.0, 150.0, 180.0, 40.0, -20.0, 120.0, 60.0, 70.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 50.0, 60.0, 500.0, 70.0, 180.0, 160.0, -30.0, 20.0, 140.0, -10.0, 60.0, 30.0, 160.0, 40.0, 10.0, 40.0, 220.0, 0.0, 40.0, 100.0, 150.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 160.0, 20.0, 60.0, 70.0, 300.0, 10.0, 0.0, 20.0, 90.0, 40.0, 0.0, 0.0, 190.0, 20.0, 50.0, 10.0, 40.0, 60.0, 180.0, 60.0, 20.0, 30.0, 0.0, 20.0, 250.0, 60.0, 20.0, 170.0, 0.0, 0.0, 270.0, 40.0, 70.0, 90.0, 10.0, 0.0, 80.0, 30.0, 20.0, 20.0, 0.0, 0.0, -50.0, -20.0, 370.0, 30.0, 210.0, 20.0, 290.0, 20.0, 40.0, 350.0, 20.0, 20.0, 10.0, 150.0, 80.0, 80.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.616486866540115, "mean_inference_ms": 2.402410008253916, "mean_action_processing_ms": 0.7121357636629659, "mean_env_wait_ms": 2.300538516062766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01377725601196289, "StateBufferConnector_ms": 0.010066986083984375, "ViewRequirementAgentConnector_ms": 0.39682698249816895}, "num_episodes": 27, "episode_return_max": 1660.0, "episode_return_min": 140.0, "episode_return_mean": 712.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.21461616734113, "num_env_steps_trained_throughput_per_sec": 20.21461616734113, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 204784.997, "restore_workers_time_ms": 0.012, "training_step_time_ms": 204784.952, "sample_time_ms": 2591.764, "learn_time_ms": 202172.348, "learn_throughput": 19.785, "synch_weights_time_ms": 11.045}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 29, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-05-25", "timestamp": 1717218325, "time_this_iter_s": 197.8835220336914, "time_total_s": 9142.744760036469, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f84f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9142.744760036469, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.169285714285714, "ram_util_percent": 79.04642857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.140887620591254, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.452296600707423, "policy_loss": -0.010368396889882538, "vf_loss": 6.461835397470493, "vf_explained_var": 0.0006170231757707363, "kl": 0.008295974749989906, "entropy": 0.8139792983270427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 277005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 140.0, "episode_reward_mean": 736.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 73.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1110.0, 1020.0, 390.0, 340.0, 210.0, 1000.0, 450.0, 380.0, 1120.0, 600.0, 140.0, 990.0, 920.0, 545.0, 435.0, 145.0, 440.0, 705.0, 380.0, 770.0, 380.0, 1060.0, 290.0, 670.0, 750.0, 620.0, 925.0, 295.0, 1210.0, 940.0, 620.0, 1210.0, 720.0, 680.0, 1660.0, 960.0, 940.0, 350.0, 750.0, 380.0, 800.0, 705.0, 310.0, 1110.0, 330.0, 770.0, 710.0, 500.0, 510.0, 455.0, 300.0, 720.0, 590.0, 725.0, 270.0, 1170.0, 1220.0, 1480.0, 670.0, 1210.0, 1350.0, 890.0, 840.0, 610.0, 750.0, 480.0, 1180.0, 980.0, 340.0, 1620.0, 600.0, 970.0, 310.0, 1180.0, 590.0, 420.0, 770.0, 610.0, 570.0, 630.0, 870.0, 810.0, 1270.0, 1320.0, 610.0, 440.0, 1020.0, 805.0, 450.0, 430.0, 1100.0, 1010.0, 770.0, 940.0, 960.0, 1060.0, 770.0, 690.0, 330.0, 285.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 10.0, 70.0, 360.0, 100.0, 50.0, 80.0, 160.0, -40.0, 250.0, 50.0, 160.0, 180.0, 140.0, 30.0, 150.0, 20.0, 100.0, 180.0, 10.0, 10.0, 70.0, 30.0, 20.0, 0.0, 60.0, 20.0, 80.0, 60.0, 40.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 70.0, 20.0, 30.0, 50.0, 20.0, 0.0, 10.0, 40.0, 0.0, 10.0, 30.0, 110.0, 170.0, 130.0, 40.0, 330.0, 10.0, 20.0, 50.0, 80.0, 60.0, 70.0, 20.0, 110.0, 0.0, 80.0, 30.0, 70.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 50.0, 80.0, 100.0, 30.0, 20.0, 30.0, 10.0, -20.0, 70.0, 90.0, 340.0, 120.0, 50.0, 190.0, 10.0, 110.0, 160.0, 90.0, 30.0, 40.0, 40.0, 150.0, 20.0, 100.0, 50.0, 60.0, 20.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, -30.0, 80.0, 0.0, 100.0, 20.0, 120.0, 100.0, 390.0, -30.0, 240.0, 110.0, 20.0, 50.0, 360.0, 210.0, 40.0, 80.0, -20.0, 40.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 230.0, 50.0, 55.0, 50.0, -5.0, 50.0, 40.0, 50.0, 20.0, 40.0, 60.0, 100.0, 40.0, 40.0, 80.0, 10.0, -10.0, 0.0, 10.0, 5.0, 0.0, 30.0, 20.0, 0.0, 10.0, 50.0, 30.0, 20.0, 0.0, 20.0, 290.0, 0.0, 20.0, 0.0, 60.0, 90.0, 80.0, 25.0, 250.0, 0.0, 130.0, 0.0, 30.0, 40.0, 10.0, 40.0, 40.0, 40.0, 20.0, 40.0, 10.0, 60.0, 40.0, 80.0, 100.0, 90.0, 60.0, -30.0, 30.0, 10.0, 20.0, 60.0, 40.0, 390.0, 50.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 250.0, 0.0, 180.0, 30.0, 20.0, 80.0, 50.0, 20.0, 10.0, 10.0, 590.0, 70.0, 170.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 150.0, 260.0, 60.0, 50.0, 10.0, 80.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 80.0, 60.0, 80.0, 280.0, 140.0, 0.0, 0.0, 20.0, 50.0, 10.0, 20.0, 190.0, 130.0, 50.0, 150.0, 25.0, 0.0, 50.0, 230.0, 0.0, 180.0, 30.0, 0.0, 10.0, 400.0, 40.0, 30.0, -5.0, 110.0, 10.0, 20.0, 0.0, 30.0, 20.0, 40.0, 360.0, 80.0, 60.0, 90.0, 40.0, 80.0, 190.0, 70.0, 150.0, 90.0, 50.0, 200.0, 40.0, 80.0, 90.0, 170.0, 80.0, 120.0, 60.0, 50.0, 60.0, 20.0, 30.0, 270.0, 70.0, 50.0, 10.0, 40.0, 60.0, 10.0, 40.0, 290.0, -40.0, 40.0, 30.0, 530.0, 110.0, 50.0, 80.0, 80.0, 180.0, 140.0, 180.0, 10.0, -30.0, 110.0, 70.0, 10.0, 20.0, 30.0, 60.0, 80.0, 80.0, 30.0, -40.0, 10.0, 270.0, 10.0, 80.0, 100.0, 110.0, 80.0, 100.0, 80.0, 210.0, 300.0, 100.0, 260.0, 210.0, 210.0, 20.0, 280.0, -30.0, 60.0, 190.0, 40.0, 50.0, 80.0, 250.0, 20.0, 30.0, 20.0, 170.0, -40.0, 90.0, 190.0, 220.0, 120.0, 20.0, 120.0, 20.0, 120.0, 0.0, 40.0, 70.0, 0.0, 10.0, 50.0, 40.0, 0.0, 100.0, 30.0, 0.0, 460.0, 20.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 190.0, 30.0, 20.0, 0.0, 20.0, 70.0, 30.0, 10.0, 0.0, 80.0, 20.0, 90.0, 40.0, 10.0, 70.0, 370.0, 10.0, 30.0, 80.0, 10.0, 560.0, 40.0, 50.0, -40.0, 90.0, 20.0, 20.0, -45.0, 0.0, 60.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 70.0, 0.0, 40.0, 0.0, 250.0, 10.0, 230.0, 50.0, 0.0, 20.0, 10.0, 80.0, 460.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 160.0, 0.0, 40.0, 50.0, 70.0, 150.0, 190.0, -190.0, 30.0, 10.0, 80.0, 320.0, 60.0, 250.0, 20.0, 0.0, 100.0, 130.0, 20.0, 80.0, 30.0, 30.0, 50.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 370.0, 30.0, 10.0, 60.0, 30.0, 10.0, 30.0, 80.0, 0.0, 40.0, 160.0, 10.0, 90.0, 180.0, 20.0, -5.0, 10.0, 30.0, 10.0, 10.0, 160.0, 10.0, 30.0, 10.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 130.0, 40.0, 50.0, -40.0, 60.0, 240.0, 150.0, 20.0, 80.0, 50.0, 40.0, 70.0, 10.0, -240.0, 90.0, 180.0, 40.0, 60.0, 160.0, 230.0, 40.0, 20.0, 210.0, 150.0, 20.0, 5.0, 70.0, 0.0, 70.0, 50.0, 110.0, 40.0, 100.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 30.0, 60.0, 200.0, 30.0, 300.0, 230.0, 60.0, 60.0, 60.0, 70.0, 70.0, 90.0, -40.0, -80.0, 360.0, 270.0, 160.0, 50.0, 100.0, 70.0, 310.0, 20.0, 210.0, 220.0, 10.0, 80.0, 60.0, 160.0, 240.0, 350.0, 90.0, 60.0, 170.0, 50.0, 250.0, 80.0, 20.0, 20.0, 20.0, 50.0, 10.0, 0.0, 40.0, 90.0, 260.0, 70.0, 110.0, 70.0, 60.0, 20.0, 150.0, 340.0, 100.0, 610.0, 90.0, -10.0, 20.0, 400.0, 100.0, -20.0, 10.0, 50.0, 90.0, 80.0, 40.0, 10.0, 170.0, 70.0, 30.0, 60.0, 170.0, 170.0, 50.0, 80.0, 160.0, 20.0, 0.0, 20.0, 90.0, 320.0, 60.0, 40.0, 20.0, 50.0, 0.0, 210.0, 30.0, 30.0, 70.0, 20.0, 30.0, 150.0, 90.0, 30.0, 30.0, 430.0, 0.0, 10.0, 0.0, 70.0, 60.0, 30.0, 10.0, -20.0, 60.0, 290.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 150.0, 40.0, 530.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 290.0, 70.0, 0.0, 360.0, 20.0, 40.0, 10.0, 30.0, 350.0, 20.0, 80.0, 30.0, 0.0, 170.0, 20.0, 40.0, 10.0, 20.0, 0.0, 20.0, 30.0, 710.0, 30.0, -10.0, -20.0, 40.0, 110.0, 240.0, 100.0, 100.0, 320.0, 60.0, 370.0, 0.0, 10.0, 20.0, 40.0, 20.0, 30.0, 40.0, 10.0, 360.0, 30.0, 30.0, 60.0, 40.0, 40.0, 20.0, 60.0, 150.0, 180.0, 40.0, -20.0, 120.0, 60.0, 70.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 50.0, 60.0, 500.0, 70.0, 180.0, 160.0, -30.0, 20.0, 140.0, -10.0, 60.0, 30.0, 160.0, 40.0, 10.0, 40.0, 220.0, 0.0, 40.0, 100.0, 150.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 160.0, 20.0, 60.0, 70.0, 300.0, 10.0, 0.0, 20.0, 90.0, 40.0, 0.0, 0.0, 190.0, 20.0, 50.0, 10.0, 40.0, 60.0, 180.0, 60.0, 20.0, 30.0, 0.0, 20.0, 250.0, 60.0, 20.0, 170.0, 0.0, 0.0, 270.0, 40.0, 70.0, 90.0, 10.0, 0.0, 80.0, 30.0, 20.0, 20.0, 0.0, 0.0, -50.0, -20.0, 370.0, 30.0, 210.0, 20.0, 290.0, 20.0, 40.0, 350.0, 20.0, 20.0, 10.0, 150.0, 80.0, 80.0, 20.0, 40.0, 240.0, 40.0, 40.0, 30.0, 310.0, 100.0, 0.0, 240.0, 260.0, 10.0, 20.0, 120.0, 150.0, 200.0, 40.0, 340.0, 140.0, 260.0, 20.0, 30.0, 10.0, 80.0, 340.0, 30.0, 20.0, 30.0, 20.0, 0.0, 60.0, 20.0, 40.0, 30.0, 0.0, 170.0, 30.0, 10.0, 0.0, 30.0, 40.0, 90.0, 110.0, 240.0, 10.0, 50.0, 190.0, 70.0, 190.0, 80.0, 10.0, 70.0, 20.0, 40.0, 65.0, 30.0, 70.0, 50.0, 200.0, 60.0, 160.0, 110.0, 30.0, 80.0, 90.0, 0.0, 10.0, 160.0, 30.0, 30.0, 20.0, 0.0, 40.0, 20.0, 70.0, 20.0, 70.0, 10.0, 40.0, 110.0, 0.0, 50.0, 30.0, 200.0, 170.0, 560.0, -40.0, 30.0, 60.0, 10.0, 70.0, 10.0, 40.0, 80.0, 30.0, 60.0, 50.0, 40.0, 80.0, 170.0, 400.0, 60.0, 0.0, 50.0, 20.0, 80.0, 160.0, 40.0, 20.0, 30.0, 10.0, 360.0, 20.0, 270.0, 220.0, 70.0, 60.0, 40.0, 90.0, 20.0, 80.0, 70.0, 160.0, 60.0, 70.0, 10.0, 110.0, 130.0, 20.0, 20.0, 70.0, 310.0, 20.0, 110.0, 90.0, 210.0, 40.0, 190.0, 150.0, 120.0, 100.0, 30.0, 90.0, 40.0, -80.0, 40.0, 120.0, 10.0, 300.0, 10.0, 200.0, 40.0, 20.0, 30.0, 0.0, 10.0, 0.0, 250.0, 0.0, 300.0, 0.0, 80.0, 30.0, 50.0, 20.0, 0.0, 20.0, 10.0, 0.0, 160.0, 30.0, 10.0, 20.0, 50.0, 5.0, 10.0, 70.0, 10.0, 0.0, 40.0, 0.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.58130908177434, "mean_inference_ms": 2.371328960931178, "mean_action_processing_ms": 0.7012084687364105, "mean_env_wait_ms": 2.2649089839445464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013517618179321289, "StateBufferConnector_ms": 0.010146617889404297, "ViewRequirementAgentConnector_ms": 0.3899822235107422}, "num_episodes": 18, "episode_return_max": 1660.0, "episode_return_min": 140.0, "episode_return_mean": 736.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.05206499391897, "num_env_steps_trained_throughput_per_sec": 20.05206499391897, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 204738.528, "restore_workers_time_ms": 0.012, "training_step_time_ms": 204738.483, "sample_time_ms": 2586.491, "learn_time_ms": 202131.541, "learn_throughput": 19.789, "synch_weights_time_ms": 11.125}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 30, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-08-45", "timestamp": 1717218525, "time_this_iter_s": 199.50053310394287, "time_total_s": 9342.245293140411, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8875e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9342.245293140411, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.96560283687943, "ram_util_percent": 80.4758865248227}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9626816877097495, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.324708314698598, "policy_loss": -0.010712056101921696, "vf_loss": 6.334470335337809, "vf_explained_var": 0.00046165966378233303, "kl": 0.009500363759110337, "entropy": 0.7996802262414378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 286395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 195.0, "episode_reward_mean": 754.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 75.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 770.0, 380.0, 1060.0, 290.0, 670.0, 750.0, 620.0, 925.0, 295.0, 1210.0, 940.0, 620.0, 1210.0, 720.0, 680.0, 1660.0, 960.0, 940.0, 350.0, 750.0, 380.0, 800.0, 705.0, 310.0, 1110.0, 330.0, 770.0, 710.0, 500.0, 510.0, 455.0, 300.0, 720.0, 590.0, 725.0, 270.0, 1170.0, 1220.0, 1480.0, 670.0, 1210.0, 1350.0, 890.0, 840.0, 610.0, 750.0, 480.0, 1180.0, 980.0, 340.0, 1620.0, 600.0, 970.0, 310.0, 1180.0, 590.0, 420.0, 770.0, 610.0, 570.0, 630.0, 870.0, 810.0, 1270.0, 1320.0, 610.0, 440.0, 1020.0, 805.0, 450.0, 430.0, 1100.0, 1010.0, 770.0, 940.0, 960.0, 1060.0, 770.0, 690.0, 330.0, 285.0, 850.0, 675.0, 220.0, 550.0, 640.0, 690.0, 260.0, 195.0, 1070.0, 795.0, 1020.0, 210.0, 970.0, 850.0, 830.0, 1240.0, 470.0, 1150.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 40.0, 40.0, 20.0, 40.0, 10.0, 60.0, 40.0, 80.0, 100.0, 90.0, 60.0, -30.0, 30.0, 10.0, 20.0, 60.0, 40.0, 390.0, 50.0, 0.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 250.0, 0.0, 180.0, 30.0, 20.0, 80.0, 50.0, 20.0, 10.0, 10.0, 590.0, 70.0, 170.0, 20.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 150.0, 260.0, 60.0, 50.0, 10.0, 80.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 80.0, 60.0, 80.0, 280.0, 140.0, 0.0, 0.0, 20.0, 50.0, 10.0, 20.0, 190.0, 130.0, 50.0, 150.0, 25.0, 0.0, 50.0, 230.0, 0.0, 180.0, 30.0, 0.0, 10.0, 400.0, 40.0, 30.0, -5.0, 110.0, 10.0, 20.0, 0.0, 30.0, 20.0, 40.0, 360.0, 80.0, 60.0, 90.0, 40.0, 80.0, 190.0, 70.0, 150.0, 90.0, 50.0, 200.0, 40.0, 80.0, 90.0, 170.0, 80.0, 120.0, 60.0, 50.0, 60.0, 20.0, 30.0, 270.0, 70.0, 50.0, 10.0, 40.0, 60.0, 10.0, 40.0, 290.0, -40.0, 40.0, 30.0, 530.0, 110.0, 50.0, 80.0, 80.0, 180.0, 140.0, 180.0, 10.0, -30.0, 110.0, 70.0, 10.0, 20.0, 30.0, 60.0, 80.0, 80.0, 30.0, -40.0, 10.0, 270.0, 10.0, 80.0, 100.0, 110.0, 80.0, 100.0, 80.0, 210.0, 300.0, 100.0, 260.0, 210.0, 210.0, 20.0, 280.0, -30.0, 60.0, 190.0, 40.0, 50.0, 80.0, 250.0, 20.0, 30.0, 20.0, 170.0, -40.0, 90.0, 190.0, 220.0, 120.0, 20.0, 120.0, 20.0, 120.0, 0.0, 40.0, 70.0, 0.0, 10.0, 50.0, 40.0, 0.0, 100.0, 30.0, 0.0, 460.0, 20.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 190.0, 30.0, 20.0, 0.0, 20.0, 70.0, 30.0, 10.0, 0.0, 80.0, 20.0, 90.0, 40.0, 10.0, 70.0, 370.0, 10.0, 30.0, 80.0, 10.0, 560.0, 40.0, 50.0, -40.0, 90.0, 20.0, 20.0, -45.0, 0.0, 60.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 70.0, 0.0, 40.0, 0.0, 250.0, 10.0, 230.0, 50.0, 0.0, 20.0, 10.0, 80.0, 460.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 160.0, 0.0, 40.0, 50.0, 70.0, 150.0, 190.0, -190.0, 30.0, 10.0, 80.0, 320.0, 60.0, 250.0, 20.0, 0.0, 100.0, 130.0, 20.0, 80.0, 30.0, 30.0, 50.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 370.0, 30.0, 10.0, 60.0, 30.0, 10.0, 30.0, 80.0, 0.0, 40.0, 160.0, 10.0, 90.0, 180.0, 20.0, -5.0, 10.0, 30.0, 10.0, 10.0, 160.0, 10.0, 30.0, 10.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 130.0, 40.0, 50.0, -40.0, 60.0, 240.0, 150.0, 20.0, 80.0, 50.0, 40.0, 70.0, 10.0, -240.0, 90.0, 180.0, 40.0, 60.0, 160.0, 230.0, 40.0, 20.0, 210.0, 150.0, 20.0, 5.0, 70.0, 0.0, 70.0, 50.0, 110.0, 40.0, 100.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 30.0, 60.0, 200.0, 30.0, 300.0, 230.0, 60.0, 60.0, 60.0, 70.0, 70.0, 90.0, -40.0, -80.0, 360.0, 270.0, 160.0, 50.0, 100.0, 70.0, 310.0, 20.0, 210.0, 220.0, 10.0, 80.0, 60.0, 160.0, 240.0, 350.0, 90.0, 60.0, 170.0, 50.0, 250.0, 80.0, 20.0, 20.0, 20.0, 50.0, 10.0, 0.0, 40.0, 90.0, 260.0, 70.0, 110.0, 70.0, 60.0, 20.0, 150.0, 340.0, 100.0, 610.0, 90.0, -10.0, 20.0, 400.0, 100.0, -20.0, 10.0, 50.0, 90.0, 80.0, 40.0, 10.0, 170.0, 70.0, 30.0, 60.0, 170.0, 170.0, 50.0, 80.0, 160.0, 20.0, 0.0, 20.0, 90.0, 320.0, 60.0, 40.0, 20.0, 50.0, 0.0, 210.0, 30.0, 30.0, 70.0, 20.0, 30.0, 150.0, 90.0, 30.0, 30.0, 430.0, 0.0, 10.0, 0.0, 70.0, 60.0, 30.0, 10.0, -20.0, 60.0, 290.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 150.0, 40.0, 530.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 290.0, 70.0, 0.0, 360.0, 20.0, 40.0, 10.0, 30.0, 350.0, 20.0, 80.0, 30.0, 0.0, 170.0, 20.0, 40.0, 10.0, 20.0, 0.0, 20.0, 30.0, 710.0, 30.0, -10.0, -20.0, 40.0, 110.0, 240.0, 100.0, 100.0, 320.0, 60.0, 370.0, 0.0, 10.0, 20.0, 40.0, 20.0, 30.0, 40.0, 10.0, 360.0, 30.0, 30.0, 60.0, 40.0, 40.0, 20.0, 60.0, 150.0, 180.0, 40.0, -20.0, 120.0, 60.0, 70.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 50.0, 60.0, 500.0, 70.0, 180.0, 160.0, -30.0, 20.0, 140.0, -10.0, 60.0, 30.0, 160.0, 40.0, 10.0, 40.0, 220.0, 0.0, 40.0, 100.0, 150.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 160.0, 20.0, 60.0, 70.0, 300.0, 10.0, 0.0, 20.0, 90.0, 40.0, 0.0, 0.0, 190.0, 20.0, 50.0, 10.0, 40.0, 60.0, 180.0, 60.0, 20.0, 30.0, 0.0, 20.0, 250.0, 60.0, 20.0, 170.0, 0.0, 0.0, 270.0, 40.0, 70.0, 90.0, 10.0, 0.0, 80.0, 30.0, 20.0, 20.0, 0.0, 0.0, -50.0, -20.0, 370.0, 30.0, 210.0, 20.0, 290.0, 20.0, 40.0, 350.0, 20.0, 20.0, 10.0, 150.0, 80.0, 80.0, 20.0, 40.0, 240.0, 40.0, 40.0, 30.0, 310.0, 100.0, 0.0, 240.0, 260.0, 10.0, 20.0, 120.0, 150.0, 200.0, 40.0, 340.0, 140.0, 260.0, 20.0, 30.0, 10.0, 80.0, 340.0, 30.0, 20.0, 30.0, 20.0, 0.0, 60.0, 20.0, 40.0, 30.0, 0.0, 170.0, 30.0, 10.0, 0.0, 30.0, 40.0, 90.0, 110.0, 240.0, 10.0, 50.0, 190.0, 70.0, 190.0, 80.0, 10.0, 70.0, 20.0, 40.0, 65.0, 30.0, 70.0, 50.0, 200.0, 60.0, 160.0, 110.0, 30.0, 80.0, 90.0, 0.0, 10.0, 160.0, 30.0, 30.0, 20.0, 0.0, 40.0, 20.0, 70.0, 20.0, 70.0, 10.0, 40.0, 110.0, 0.0, 50.0, 30.0, 200.0, 170.0, 560.0, -40.0, 30.0, 60.0, 10.0, 70.0, 10.0, 40.0, 80.0, 30.0, 60.0, 50.0, 40.0, 80.0, 170.0, 400.0, 60.0, 0.0, 50.0, 20.0, 80.0, 160.0, 40.0, 20.0, 30.0, 10.0, 360.0, 20.0, 270.0, 220.0, 70.0, 60.0, 40.0, 90.0, 20.0, 80.0, 70.0, 160.0, 60.0, 70.0, 10.0, 110.0, 130.0, 20.0, 20.0, 70.0, 310.0, 20.0, 110.0, 90.0, 210.0, 40.0, 190.0, 150.0, 120.0, 100.0, 30.0, 90.0, 40.0, -80.0, 40.0, 120.0, 10.0, 300.0, 10.0, 200.0, 40.0, 20.0, 30.0, 0.0, 10.0, 0.0, 250.0, 0.0, 300.0, 0.0, 80.0, 30.0, 50.0, 20.0, 0.0, 20.0, 10.0, 0.0, 160.0, 30.0, 10.0, 20.0, 50.0, 5.0, 10.0, 70.0, 10.0, 0.0, 40.0, 0.0, 80.0, 40.0, 40.0, 0.0, 50.0, 470.0, 50.0, 40.0, 100.0, 40.0, 20.0, 70.0, 50.0, 10.0, 150.0, 110.0, 30.0, -25.0, 40.0, 50.0, 190.0, 20.0, 20.0, 70.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 30.0, 30.0, 30.0, 0.0, 40.0, 90.0, 80.0, 30.0, 40.0, 180.0, 30.0, 50.0, 40.0, 40.0, 30.0, 260.0, 80.0, 10.0, 30.0, 70.0, 70.0, 100.0, -60.0, 120.0, 0.0, 230.0, 30.0, 40.0, 60.0, 100.0, 0.0, 10.0, 60.0, 0.0, 130.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, -5.0, 60.0, 20.0, 20.0, 70.0, 30.0, -30.0, 190.0, 10.0, 190.0, 40.0, 130.0, 370.0, 70.0, 200.0, 30.0, 30.0, 180.0, 30.0, 20.0, 5.0, 210.0, 90.0, 0.0, 160.0, 460.0, -20.0, 270.0, -10.0, -30.0, -60.0, 260.0, 0.0, -10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 320.0, 20.0, 210.0, 80.0, 40.0, 60.0, 90.0, 60.0, 60.0, 30.0, 0.0, 480.0, -30.0, 130.0, 20.0, 90.0, 40.0, 50.0, 30.0, 40.0, 50.0, 100.0, 160.0, 160.0, 0.0, 20.0, 10.0, 240.0, 50.0, 40.0, -40.0, 350.0, 30.0, 80.0, -10.0, 10.0, 70.0, 420.0, 310.0, 20.0, 290.0, 30.0, 30.0, 10.0, 20.0, 0.0, 50.0, 40.0, 0.0, 0.0, 40.0, 50.0, 30.0, 30.0, 80.0, 280.0, 10.0, 40.0, 190.0, 400.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5483555013249792, "mean_inference_ms": 2.3421254947773646, "mean_action_processing_ms": 0.6911115118827723, "mean_env_wait_ms": 2.2317000614634126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013492107391357422, "StateBufferConnector_ms": 0.009946823120117188, "ViewRequirementAgentConnector_ms": 0.38805675506591797}, "num_episodes": 18, "episode_return_max": 1660.0, "episode_return_min": 195.0, "episode_return_mean": 754.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.895553330401892, "num_env_steps_trained_throughput_per_sec": 19.895553330401892, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 204495.397, "restore_workers_time_ms": 0.012, "training_step_time_ms": 204495.352, "sample_time_ms": 2614.592, "learn_time_ms": 201860.2, "learn_throughput": 19.816, "synch_weights_time_ms": 11.354}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 31, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-12-06", "timestamp": 1717218726, "time_this_iter_s": 201.07137727737427, "time_total_s": 9543.316670417786, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f824f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9543.316670417786, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 26.018661971830984, "ram_util_percent": 80.51619718309858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2316781320764867, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.146344224789653, "policy_loss": -0.010782990866802887, "vf_loss": 6.156178905458623, "vf_explained_var": 0.0024183538838570364, "kl": 0.009483027612768018, "entropy": 0.7954827484675744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 1620.0, "episode_reward_min": 160.0, "episode_reward_mean": 746.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 74.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 350.0, 750.0, 380.0, 800.0, 705.0, 310.0, 1110.0, 330.0, 770.0, 710.0, 500.0, 510.0, 455.0, 300.0, 720.0, 590.0, 725.0, 270.0, 1170.0, 1220.0, 1480.0, 670.0, 1210.0, 1350.0, 890.0, 840.0, 610.0, 750.0, 480.0, 1180.0, 980.0, 340.0, 1620.0, 600.0, 970.0, 310.0, 1180.0, 590.0, 420.0, 770.0, 610.0, 570.0, 630.0, 870.0, 810.0, 1270.0, 1320.0, 610.0, 440.0, 1020.0, 805.0, 450.0, 430.0, 1100.0, 1010.0, 770.0, 940.0, 960.0, 1060.0, 770.0, 690.0, 330.0, 285.0, 850.0, 675.0, 220.0, 550.0, 640.0, 690.0, 260.0, 195.0, 1070.0, 795.0, 1020.0, 210.0, 970.0, 850.0, 830.0, 1240.0, 470.0, 1150.0, 700.0, 680.0, 340.0, 1090.0, 820.0, 690.0, 805.0, 190.0, 600.0, 1050.0, 1070.0, 160.0, 1050.0, 1140.0, 530.0, 635.0, 1280.0, 510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 20.0, 170.0, -40.0, 90.0, 190.0, 220.0, 120.0, 20.0, 120.0, 20.0, 120.0, 0.0, 40.0, 70.0, 0.0, 10.0, 50.0, 40.0, 0.0, 100.0, 30.0, 0.0, 460.0, 20.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 190.0, 30.0, 20.0, 0.0, 20.0, 70.0, 30.0, 10.0, 0.0, 80.0, 20.0, 90.0, 40.0, 10.0, 70.0, 370.0, 10.0, 30.0, 80.0, 10.0, 560.0, 40.0, 50.0, -40.0, 90.0, 20.0, 20.0, -45.0, 0.0, 60.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 70.0, 0.0, 40.0, 0.0, 250.0, 10.0, 230.0, 50.0, 0.0, 20.0, 10.0, 80.0, 460.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 160.0, 0.0, 40.0, 50.0, 70.0, 150.0, 190.0, -190.0, 30.0, 10.0, 80.0, 320.0, 60.0, 250.0, 20.0, 0.0, 100.0, 130.0, 20.0, 80.0, 30.0, 30.0, 50.0, 40.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 370.0, 30.0, 10.0, 60.0, 30.0, 10.0, 30.0, 80.0, 0.0, 40.0, 160.0, 10.0, 90.0, 180.0, 20.0, -5.0, 10.0, 30.0, 10.0, 10.0, 160.0, 10.0, 30.0, 10.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 130.0, 40.0, 50.0, -40.0, 60.0, 240.0, 150.0, 20.0, 80.0, 50.0, 40.0, 70.0, 10.0, -240.0, 90.0, 180.0, 40.0, 60.0, 160.0, 230.0, 40.0, 20.0, 210.0, 150.0, 20.0, 5.0, 70.0, 0.0, 70.0, 50.0, 110.0, 40.0, 100.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 30.0, 60.0, 200.0, 30.0, 300.0, 230.0, 60.0, 60.0, 60.0, 70.0, 70.0, 90.0, -40.0, -80.0, 360.0, 270.0, 160.0, 50.0, 100.0, 70.0, 310.0, 20.0, 210.0, 220.0, 10.0, 80.0, 60.0, 160.0, 240.0, 350.0, 90.0, 60.0, 170.0, 50.0, 250.0, 80.0, 20.0, 20.0, 20.0, 50.0, 10.0, 0.0, 40.0, 90.0, 260.0, 70.0, 110.0, 70.0, 60.0, 20.0, 150.0, 340.0, 100.0, 610.0, 90.0, -10.0, 20.0, 400.0, 100.0, -20.0, 10.0, 50.0, 90.0, 80.0, 40.0, 10.0, 170.0, 70.0, 30.0, 60.0, 170.0, 170.0, 50.0, 80.0, 160.0, 20.0, 0.0, 20.0, 90.0, 320.0, 60.0, 40.0, 20.0, 50.0, 0.0, 210.0, 30.0, 30.0, 70.0, 20.0, 30.0, 150.0, 90.0, 30.0, 30.0, 430.0, 0.0, 10.0, 0.0, 70.0, 60.0, 30.0, 10.0, -20.0, 60.0, 290.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 150.0, 40.0, 530.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 290.0, 70.0, 0.0, 360.0, 20.0, 40.0, 10.0, 30.0, 350.0, 20.0, 80.0, 30.0, 0.0, 170.0, 20.0, 40.0, 10.0, 20.0, 0.0, 20.0, 30.0, 710.0, 30.0, -10.0, -20.0, 40.0, 110.0, 240.0, 100.0, 100.0, 320.0, 60.0, 370.0, 0.0, 10.0, 20.0, 40.0, 20.0, 30.0, 40.0, 10.0, 360.0, 30.0, 30.0, 60.0, 40.0, 40.0, 20.0, 60.0, 150.0, 180.0, 40.0, -20.0, 120.0, 60.0, 70.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 50.0, 60.0, 500.0, 70.0, 180.0, 160.0, -30.0, 20.0, 140.0, -10.0, 60.0, 30.0, 160.0, 40.0, 10.0, 40.0, 220.0, 0.0, 40.0, 100.0, 150.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 160.0, 20.0, 60.0, 70.0, 300.0, 10.0, 0.0, 20.0, 90.0, 40.0, 0.0, 0.0, 190.0, 20.0, 50.0, 10.0, 40.0, 60.0, 180.0, 60.0, 20.0, 30.0, 0.0, 20.0, 250.0, 60.0, 20.0, 170.0, 0.0, 0.0, 270.0, 40.0, 70.0, 90.0, 10.0, 0.0, 80.0, 30.0, 20.0, 20.0, 0.0, 0.0, -50.0, -20.0, 370.0, 30.0, 210.0, 20.0, 290.0, 20.0, 40.0, 350.0, 20.0, 20.0, 10.0, 150.0, 80.0, 80.0, 20.0, 40.0, 240.0, 40.0, 40.0, 30.0, 310.0, 100.0, 0.0, 240.0, 260.0, 10.0, 20.0, 120.0, 150.0, 200.0, 40.0, 340.0, 140.0, 260.0, 20.0, 30.0, 10.0, 80.0, 340.0, 30.0, 20.0, 30.0, 20.0, 0.0, 60.0, 20.0, 40.0, 30.0, 0.0, 170.0, 30.0, 10.0, 0.0, 30.0, 40.0, 90.0, 110.0, 240.0, 10.0, 50.0, 190.0, 70.0, 190.0, 80.0, 10.0, 70.0, 20.0, 40.0, 65.0, 30.0, 70.0, 50.0, 200.0, 60.0, 160.0, 110.0, 30.0, 80.0, 90.0, 0.0, 10.0, 160.0, 30.0, 30.0, 20.0, 0.0, 40.0, 20.0, 70.0, 20.0, 70.0, 10.0, 40.0, 110.0, 0.0, 50.0, 30.0, 200.0, 170.0, 560.0, -40.0, 30.0, 60.0, 10.0, 70.0, 10.0, 40.0, 80.0, 30.0, 60.0, 50.0, 40.0, 80.0, 170.0, 400.0, 60.0, 0.0, 50.0, 20.0, 80.0, 160.0, 40.0, 20.0, 30.0, 10.0, 360.0, 20.0, 270.0, 220.0, 70.0, 60.0, 40.0, 90.0, 20.0, 80.0, 70.0, 160.0, 60.0, 70.0, 10.0, 110.0, 130.0, 20.0, 20.0, 70.0, 310.0, 20.0, 110.0, 90.0, 210.0, 40.0, 190.0, 150.0, 120.0, 100.0, 30.0, 90.0, 40.0, -80.0, 40.0, 120.0, 10.0, 300.0, 10.0, 200.0, 40.0, 20.0, 30.0, 0.0, 10.0, 0.0, 250.0, 0.0, 300.0, 0.0, 80.0, 30.0, 50.0, 20.0, 0.0, 20.0, 10.0, 0.0, 160.0, 30.0, 10.0, 20.0, 50.0, 5.0, 10.0, 70.0, 10.0, 0.0, 40.0, 0.0, 80.0, 40.0, 40.0, 0.0, 50.0, 470.0, 50.0, 40.0, 100.0, 40.0, 20.0, 70.0, 50.0, 10.0, 150.0, 110.0, 30.0, -25.0, 40.0, 50.0, 190.0, 20.0, 20.0, 70.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 30.0, 30.0, 30.0, 0.0, 40.0, 90.0, 80.0, 30.0, 40.0, 180.0, 30.0, 50.0, 40.0, 40.0, 30.0, 260.0, 80.0, 10.0, 30.0, 70.0, 70.0, 100.0, -60.0, 120.0, 0.0, 230.0, 30.0, 40.0, 60.0, 100.0, 0.0, 10.0, 60.0, 0.0, 130.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, -5.0, 60.0, 20.0, 20.0, 70.0, 30.0, -30.0, 190.0, 10.0, 190.0, 40.0, 130.0, 370.0, 70.0, 200.0, 30.0, 30.0, 180.0, 30.0, 20.0, 5.0, 210.0, 90.0, 0.0, 160.0, 460.0, -20.0, 270.0, -10.0, -30.0, -60.0, 260.0, 0.0, -10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 320.0, 20.0, 210.0, 80.0, 40.0, 60.0, 90.0, 60.0, 60.0, 30.0, 0.0, 480.0, -30.0, 130.0, 20.0, 90.0, 40.0, 50.0, 30.0, 40.0, 50.0, 100.0, 160.0, 160.0, 0.0, 20.0, 10.0, 240.0, 50.0, 40.0, -40.0, 350.0, 30.0, 80.0, -10.0, 10.0, 70.0, 420.0, 310.0, 20.0, 290.0, 30.0, 30.0, 10.0, 20.0, 0.0, 50.0, 40.0, 0.0, 0.0, 40.0, 50.0, 30.0, 30.0, 80.0, 280.0, 10.0, 40.0, 190.0, 400.0, 90.0, -20.0, 10.0, 60.0, 10.0, 60.0, 170.0, 220.0, 60.0, 40.0, 0.0, 30.0, 20.0, 400.0, 50.0, 30.0, 10.0, 140.0, 30.0, -30.0, 30.0, 20.0, 40.0, 50.0, 10.0, 140.0, 0.0, 0.0, 40.0, 10.0, 30.0, 220.0, 80.0, 280.0, 20.0, 80.0, 30.0, 30.0, 240.0, 80.0, 20.0, 180.0, 170.0, 30.0, -70.0, 170.0, 60.0, 120.0, 10.0, 130.0, -70.0, 60.0, 310.0, 90.0, 20.0, 20.0, 80.0, 50.0, 100.0, 30.0, 60.0, 60.0, 60.0, 230.0, 240.0, 60.0, 40.0, 110.0, -80.0, 25.0, 20.0, 20.0, 20.0, 10.0, 10.0, 70.0, 10.0, -20.0, 50.0, 0.0, 20.0, 0.0, 40.0, 40.0, 50.0, 40.0, 100.0, 80.0, 50.0, 180.0, 20.0, 90.0, 90.0, 90.0, 20.0, 110.0, 340.0, 10.0, 160.0, 120.0, 70.0, 60.0, 40.0, 300.0, 190.0, 80.0, 10.0, 60.0, 60.0, 200.0, 70.0, 0.0, 10.0, 10.0, -80.0, 20.0, 20.0, 10.0, 70.0, 30.0, 50.0, 30.0, 10.0, -10.0, 320.0, 10.0, 70.0, 50.0, 180.0, 340.0, 20.0, 310.0, 80.0, 90.0, 40.0, 10.0, 210.0, 10.0, 70.0, 300.0, 40.0, 30.0, 40.0, -20.0, 60.0, 70.0, 40.0, 190.0, 10.0, 70.0, 40.0, 210.0, 0.0, 40.0, 180.0, 30.0, 30.0, 30.0, 50.0, 25.0, 130.0, 120.0, 470.0, 160.0, 60.0, 20.0, 100.0, 90.0, 110.0, 20.0, 70.0, 20.0, 90.0, 30.0, 0.0, 150.0, 70.0, 10.0, 30.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5177835466145293, "mean_inference_ms": 2.315376298574575, "mean_action_processing_ms": 0.6817844117509267, "mean_env_wait_ms": 2.2010367709336043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013193368911743164, "StateBufferConnector_ms": 0.009995460510253906, "ViewRequirementAgentConnector_ms": 0.3882908821105957}, "num_episodes": 18, "episode_return_max": 1620.0, "episode_return_min": 160.0, "episode_return_mean": 746.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.113888460691825, "num_env_steps_trained_throughput_per_sec": 20.113888460691825, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 203867.55, "restore_workers_time_ms": 0.012, "training_step_time_ms": 203867.505, "sample_time_ms": 2634.236, "learn_time_ms": 201213.191, "learn_throughput": 19.879, "synch_weights_time_ms": 11.49}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 32, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-15-25", "timestamp": 1717218925, "time_this_iter_s": 198.87574195861816, "time_total_s": 9742.192412376404, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f88a670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9742.192412376404, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.799999999999997, "ram_util_percent": 79.12419928825624}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3848790350940408, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.401977183237371, "policy_loss": -0.008855548595684293, "vf_loss": 6.409988112190661, "vf_explained_var": 0.002743476223006162, "kl": 0.008446182710674028, "entropy": 0.7501153587279356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 305175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 1620.0, "episode_reward_min": 160.0, "episode_reward_mean": 780.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -200.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 78.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [670.0, 1210.0, 1350.0, 890.0, 840.0, 610.0, 750.0, 480.0, 1180.0, 980.0, 340.0, 1620.0, 600.0, 970.0, 310.0, 1180.0, 590.0, 420.0, 770.0, 610.0, 570.0, 630.0, 870.0, 810.0, 1270.0, 1320.0, 610.0, 440.0, 1020.0, 805.0, 450.0, 430.0, 1100.0, 1010.0, 770.0, 940.0, 960.0, 1060.0, 770.0, 690.0, 330.0, 285.0, 850.0, 675.0, 220.0, 550.0, 640.0, 690.0, 260.0, 195.0, 1070.0, 795.0, 1020.0, 210.0, 970.0, 850.0, 830.0, 1240.0, 470.0, 1150.0, 700.0, 680.0, 340.0, 1090.0, 820.0, 690.0, 805.0, 190.0, 600.0, 1050.0, 1070.0, 160.0, 1050.0, 1140.0, 530.0, 635.0, 1280.0, 510.0, 410.0, 960.0, 420.0, 1060.0, 1170.0, 1165.0, 410.0, 745.0, 1100.0, 790.0, 685.0, 990.0, 810.0, 640.0, 1080.0, 1575.0, 1080.0, 835.0, 1220.0, 680.0, 340.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 50.0, 250.0, 80.0, 20.0, 20.0, 20.0, 50.0, 10.0, 0.0, 40.0, 90.0, 260.0, 70.0, 110.0, 70.0, 60.0, 20.0, 150.0, 340.0, 100.0, 610.0, 90.0, -10.0, 20.0, 400.0, 100.0, -20.0, 10.0, 50.0, 90.0, 80.0, 40.0, 10.0, 170.0, 70.0, 30.0, 60.0, 170.0, 170.0, 50.0, 80.0, 160.0, 20.0, 0.0, 20.0, 90.0, 320.0, 60.0, 40.0, 20.0, 50.0, 0.0, 210.0, 30.0, 30.0, 70.0, 20.0, 30.0, 150.0, 90.0, 30.0, 30.0, 430.0, 0.0, 10.0, 0.0, 70.0, 60.0, 30.0, 10.0, -20.0, 60.0, 290.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 150.0, 40.0, 530.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 290.0, 70.0, 0.0, 360.0, 20.0, 40.0, 10.0, 30.0, 350.0, 20.0, 80.0, 30.0, 0.0, 170.0, 20.0, 40.0, 10.0, 20.0, 0.0, 20.0, 30.0, 710.0, 30.0, -10.0, -20.0, 40.0, 110.0, 240.0, 100.0, 100.0, 320.0, 60.0, 370.0, 0.0, 10.0, 20.0, 40.0, 20.0, 30.0, 40.0, 10.0, 360.0, 30.0, 30.0, 60.0, 40.0, 40.0, 20.0, 60.0, 150.0, 180.0, 40.0, -20.0, 120.0, 60.0, 70.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 50.0, 60.0, 500.0, 70.0, 180.0, 160.0, -30.0, 20.0, 140.0, -10.0, 60.0, 30.0, 160.0, 40.0, 10.0, 40.0, 220.0, 0.0, 40.0, 100.0, 150.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 160.0, 20.0, 60.0, 70.0, 300.0, 10.0, 0.0, 20.0, 90.0, 40.0, 0.0, 0.0, 190.0, 20.0, 50.0, 10.0, 40.0, 60.0, 180.0, 60.0, 20.0, 30.0, 0.0, 20.0, 250.0, 60.0, 20.0, 170.0, 0.0, 0.0, 270.0, 40.0, 70.0, 90.0, 10.0, 0.0, 80.0, 30.0, 20.0, 20.0, 0.0, 0.0, -50.0, -20.0, 370.0, 30.0, 210.0, 20.0, 290.0, 20.0, 40.0, 350.0, 20.0, 20.0, 10.0, 150.0, 80.0, 80.0, 20.0, 40.0, 240.0, 40.0, 40.0, 30.0, 310.0, 100.0, 0.0, 240.0, 260.0, 10.0, 20.0, 120.0, 150.0, 200.0, 40.0, 340.0, 140.0, 260.0, 20.0, 30.0, 10.0, 80.0, 340.0, 30.0, 20.0, 30.0, 20.0, 0.0, 60.0, 20.0, 40.0, 30.0, 0.0, 170.0, 30.0, 10.0, 0.0, 30.0, 40.0, 90.0, 110.0, 240.0, 10.0, 50.0, 190.0, 70.0, 190.0, 80.0, 10.0, 70.0, 20.0, 40.0, 65.0, 30.0, 70.0, 50.0, 200.0, 60.0, 160.0, 110.0, 30.0, 80.0, 90.0, 0.0, 10.0, 160.0, 30.0, 30.0, 20.0, 0.0, 40.0, 20.0, 70.0, 20.0, 70.0, 10.0, 40.0, 110.0, 0.0, 50.0, 30.0, 200.0, 170.0, 560.0, -40.0, 30.0, 60.0, 10.0, 70.0, 10.0, 40.0, 80.0, 30.0, 60.0, 50.0, 40.0, 80.0, 170.0, 400.0, 60.0, 0.0, 50.0, 20.0, 80.0, 160.0, 40.0, 20.0, 30.0, 10.0, 360.0, 20.0, 270.0, 220.0, 70.0, 60.0, 40.0, 90.0, 20.0, 80.0, 70.0, 160.0, 60.0, 70.0, 10.0, 110.0, 130.0, 20.0, 20.0, 70.0, 310.0, 20.0, 110.0, 90.0, 210.0, 40.0, 190.0, 150.0, 120.0, 100.0, 30.0, 90.0, 40.0, -80.0, 40.0, 120.0, 10.0, 300.0, 10.0, 200.0, 40.0, 20.0, 30.0, 0.0, 10.0, 0.0, 250.0, 0.0, 300.0, 0.0, 80.0, 30.0, 50.0, 20.0, 0.0, 20.0, 10.0, 0.0, 160.0, 30.0, 10.0, 20.0, 50.0, 5.0, 10.0, 70.0, 10.0, 0.0, 40.0, 0.0, 80.0, 40.0, 40.0, 0.0, 50.0, 470.0, 50.0, 40.0, 100.0, 40.0, 20.0, 70.0, 50.0, 10.0, 150.0, 110.0, 30.0, -25.0, 40.0, 50.0, 190.0, 20.0, 20.0, 70.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 30.0, 30.0, 30.0, 0.0, 40.0, 90.0, 80.0, 30.0, 40.0, 180.0, 30.0, 50.0, 40.0, 40.0, 30.0, 260.0, 80.0, 10.0, 30.0, 70.0, 70.0, 100.0, -60.0, 120.0, 0.0, 230.0, 30.0, 40.0, 60.0, 100.0, 0.0, 10.0, 60.0, 0.0, 130.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, -5.0, 60.0, 20.0, 20.0, 70.0, 30.0, -30.0, 190.0, 10.0, 190.0, 40.0, 130.0, 370.0, 70.0, 200.0, 30.0, 30.0, 180.0, 30.0, 20.0, 5.0, 210.0, 90.0, 0.0, 160.0, 460.0, -20.0, 270.0, -10.0, -30.0, -60.0, 260.0, 0.0, -10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 320.0, 20.0, 210.0, 80.0, 40.0, 60.0, 90.0, 60.0, 60.0, 30.0, 0.0, 480.0, -30.0, 130.0, 20.0, 90.0, 40.0, 50.0, 30.0, 40.0, 50.0, 100.0, 160.0, 160.0, 0.0, 20.0, 10.0, 240.0, 50.0, 40.0, -40.0, 350.0, 30.0, 80.0, -10.0, 10.0, 70.0, 420.0, 310.0, 20.0, 290.0, 30.0, 30.0, 10.0, 20.0, 0.0, 50.0, 40.0, 0.0, 0.0, 40.0, 50.0, 30.0, 30.0, 80.0, 280.0, 10.0, 40.0, 190.0, 400.0, 90.0, -20.0, 10.0, 60.0, 10.0, 60.0, 170.0, 220.0, 60.0, 40.0, 0.0, 30.0, 20.0, 400.0, 50.0, 30.0, 10.0, 140.0, 30.0, -30.0, 30.0, 20.0, 40.0, 50.0, 10.0, 140.0, 0.0, 0.0, 40.0, 10.0, 30.0, 220.0, 80.0, 280.0, 20.0, 80.0, 30.0, 30.0, 240.0, 80.0, 20.0, 180.0, 170.0, 30.0, -70.0, 170.0, 60.0, 120.0, 10.0, 130.0, -70.0, 60.0, 310.0, 90.0, 20.0, 20.0, 80.0, 50.0, 100.0, 30.0, 60.0, 60.0, 60.0, 230.0, 240.0, 60.0, 40.0, 110.0, -80.0, 25.0, 20.0, 20.0, 20.0, 10.0, 10.0, 70.0, 10.0, -20.0, 50.0, 0.0, 20.0, 0.0, 40.0, 40.0, 50.0, 40.0, 100.0, 80.0, 50.0, 180.0, 20.0, 90.0, 90.0, 90.0, 20.0, 110.0, 340.0, 10.0, 160.0, 120.0, 70.0, 60.0, 40.0, 300.0, 190.0, 80.0, 10.0, 60.0, 60.0, 200.0, 70.0, 0.0, 10.0, 10.0, -80.0, 20.0, 20.0, 10.0, 70.0, 30.0, 50.0, 30.0, 10.0, -10.0, 320.0, 10.0, 70.0, 50.0, 180.0, 340.0, 20.0, 310.0, 80.0, 90.0, 40.0, 10.0, 210.0, 10.0, 70.0, 300.0, 40.0, 30.0, 40.0, -20.0, 60.0, 70.0, 40.0, 190.0, 10.0, 70.0, 40.0, 210.0, 0.0, 40.0, 180.0, 30.0, 30.0, 30.0, 50.0, 25.0, 130.0, 120.0, 470.0, 160.0, 60.0, 20.0, 100.0, 90.0, 110.0, 20.0, 70.0, 20.0, 90.0, 30.0, 0.0, 150.0, 70.0, 10.0, 30.0, 40.0, 20.0, 10.0, 80.0, 100.0, 0.0, 30.0, 50.0, 80.0, 40.0, 0.0, 80.0, 0.0, 140.0, 40.0, 380.0, 110.0, 10.0, 100.0, 40.0, 60.0, 30.0, 80.0, 50.0, 40.0, 70.0, 20.0, 0.0, 80.0, 20.0, 30.0, 0.0, 40.0, 50.0, 300.0, 80.0, 60.0, 30.0, 150.0, 170.0, 180.0, 10.0, 70.0, 130.0, 150.0, 90.0, 90.0, 60.0, 300.0, 250.0, 20.0, 140.0, 35.0, 310.0, -20.0, 180.0, 80.0, 40.0, 100.0, 40.0, 260.0, 20.0, 380.0, 40.0, 40.0, 50.0, 20.0, 20.0, 0.0, -170.0, 10.0, 100.0, 20.0, 20.0, 60.0, 40.0, 85.0, 20.0, 320.0, 60.0, 20.0, 100.0, 100.0, 40.0, 370.0, 50.0, 30.0, 60.0, 40.0, 290.0, 20.0, 180.0, 20.0, 20.0, 60.0, 0.0, 20.0, 260.0, 170.0, 60.0, 0.0, 40.0, 90.0, 10.0, 15.0, 130.0, 20.0, 10.0, 10.0, 560.0, -200.0, 50.0, 60.0, 320.0, 20.0, 10.0, 120.0, 200.0, 90.0, 50.0, 70.0, 90.0, 30.0, 220.0, 20.0, 10.0, 40.0, 0.0, 100.0, 140.0, 160.0, 80.0, 10.0, 240.0, 20.0, 50.0, 20.0, 140.0, 50.0, 30.0, 0.0, 80.0, 50.0, 70.0, 80.0, 0.0, 30.0, 250.0, 240.0, 210.0, 70.0, 60.0, 450.0, 150.0, 110.0, 40.0, 500.0, 200.0, 60.0, 25.0, -20.0, 170.0, 60.0, 60.0, 90.0, 10.0, 390.0, 80.0, 40.0, 160.0, 20.0, 30.0, 100.0, 50.0, 15.0, 260.0, 290.0, 20.0, 20.0, 50.0, 0.0, 60.0, 170.0, 80.0, 210.0, 50.0, 430.0, 60.0, 40.0, 40.0, 80.0, 40.0, 0.0, 100.0, 180.0, 60.0, 10.0, 70.0, 30.0, 190.0, 0.0, 30.0, 30.0, 50.0, 60.0, 20.0, 20.0, 0.0, 0.0, 20.0, 110.0, 30.0, 0.0, 90.0, 40.0, 80.0, 40.0, 10.0, 40.0, 10.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.48108213921192, "mean_inference_ms": 2.2801122684119117, "mean_action_processing_ms": 0.671376589480424, "mean_env_wait_ms": 2.166030236757231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013139963150024414, "StateBufferConnector_ms": 0.009925127029418945, "ViewRequirementAgentConnector_ms": 0.3933281898498535}, "num_episodes": 22, "episode_return_max": 1620.0, "episode_return_min": 160.0, "episode_return_mean": 780.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.046064371496524, "num_env_steps_trained_throughput_per_sec": 20.046064371496524, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 203476.069, "restore_workers_time_ms": 0.012, "training_step_time_ms": 203476.025, "sample_time_ms": 2658.867, "learn_time_ms": 200797.796, "learn_throughput": 19.921, "synch_weights_time_ms": 11.762}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 33, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-18-44", "timestamp": 1717219124, "time_this_iter_s": 199.55287194252014, "time_total_s": 9941.745284318924, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f87d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9941.745284318924, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 25.681978798586574, "ram_util_percent": 78.16643109540635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2549716275086165, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.445622580907088, "policy_loss": -0.009399292053068622, "vf_loss": 6.4541919640712715, "vf_explained_var": 0.001302781018713158, "kl": 0.008299060349821457, "entropy": 0.6982702000199542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 314565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 1575.0, "episode_reward_min": 100.0, "episode_reward_mean": 779.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 77.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [810.0, 1270.0, 1320.0, 610.0, 440.0, 1020.0, 805.0, 450.0, 430.0, 1100.0, 1010.0, 770.0, 940.0, 960.0, 1060.0, 770.0, 690.0, 330.0, 285.0, 850.0, 675.0, 220.0, 550.0, 640.0, 690.0, 260.0, 195.0, 1070.0, 795.0, 1020.0, 210.0, 970.0, 850.0, 830.0, 1240.0, 470.0, 1150.0, 700.0, 680.0, 340.0, 1090.0, 820.0, 690.0, 805.0, 190.0, 600.0, 1050.0, 1070.0, 160.0, 1050.0, 1140.0, 530.0, 635.0, 1280.0, 510.0, 410.0, 960.0, 420.0, 1060.0, 1170.0, 1165.0, 410.0, 745.0, 1100.0, 790.0, 685.0, 990.0, 810.0, 640.0, 1080.0, 1575.0, 1080.0, 835.0, 1220.0, 680.0, 340.0, 370.0, 1040.0, 370.0, 290.0, 1230.0, 490.0, 480.0, 1140.0, 1330.0, 870.0, 1370.0, 820.0, 780.0, 1160.0, 840.0, 690.0, 710.0, 900.0, 430.0, 780.0, 680.0, 470.0, 1300.0, 100.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 350.0, 20.0, 20.0, 10.0, 150.0, 80.0, 80.0, 20.0, 40.0, 240.0, 40.0, 40.0, 30.0, 310.0, 100.0, 0.0, 240.0, 260.0, 10.0, 20.0, 120.0, 150.0, 200.0, 40.0, 340.0, 140.0, 260.0, 20.0, 30.0, 10.0, 80.0, 340.0, 30.0, 20.0, 30.0, 20.0, 0.0, 60.0, 20.0, 40.0, 30.0, 0.0, 170.0, 30.0, 10.0, 0.0, 30.0, 40.0, 90.0, 110.0, 240.0, 10.0, 50.0, 190.0, 70.0, 190.0, 80.0, 10.0, 70.0, 20.0, 40.0, 65.0, 30.0, 70.0, 50.0, 200.0, 60.0, 160.0, 110.0, 30.0, 80.0, 90.0, 0.0, 10.0, 160.0, 30.0, 30.0, 20.0, 0.0, 40.0, 20.0, 70.0, 20.0, 70.0, 10.0, 40.0, 110.0, 0.0, 50.0, 30.0, 200.0, 170.0, 560.0, -40.0, 30.0, 60.0, 10.0, 70.0, 10.0, 40.0, 80.0, 30.0, 60.0, 50.0, 40.0, 80.0, 170.0, 400.0, 60.0, 0.0, 50.0, 20.0, 80.0, 160.0, 40.0, 20.0, 30.0, 10.0, 360.0, 20.0, 270.0, 220.0, 70.0, 60.0, 40.0, 90.0, 20.0, 80.0, 70.0, 160.0, 60.0, 70.0, 10.0, 110.0, 130.0, 20.0, 20.0, 70.0, 310.0, 20.0, 110.0, 90.0, 210.0, 40.0, 190.0, 150.0, 120.0, 100.0, 30.0, 90.0, 40.0, -80.0, 40.0, 120.0, 10.0, 300.0, 10.0, 200.0, 40.0, 20.0, 30.0, 0.0, 10.0, 0.0, 250.0, 0.0, 300.0, 0.0, 80.0, 30.0, 50.0, 20.0, 0.0, 20.0, 10.0, 0.0, 160.0, 30.0, 10.0, 20.0, 50.0, 5.0, 10.0, 70.0, 10.0, 0.0, 40.0, 0.0, 80.0, 40.0, 40.0, 0.0, 50.0, 470.0, 50.0, 40.0, 100.0, 40.0, 20.0, 70.0, 50.0, 10.0, 150.0, 110.0, 30.0, -25.0, 40.0, 50.0, 190.0, 20.0, 20.0, 70.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 30.0, 30.0, 30.0, 0.0, 40.0, 90.0, 80.0, 30.0, 40.0, 180.0, 30.0, 50.0, 40.0, 40.0, 30.0, 260.0, 80.0, 10.0, 30.0, 70.0, 70.0, 100.0, -60.0, 120.0, 0.0, 230.0, 30.0, 40.0, 60.0, 100.0, 0.0, 10.0, 60.0, 0.0, 130.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, -5.0, 60.0, 20.0, 20.0, 70.0, 30.0, -30.0, 190.0, 10.0, 190.0, 40.0, 130.0, 370.0, 70.0, 200.0, 30.0, 30.0, 180.0, 30.0, 20.0, 5.0, 210.0, 90.0, 0.0, 160.0, 460.0, -20.0, 270.0, -10.0, -30.0, -60.0, 260.0, 0.0, -10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 320.0, 20.0, 210.0, 80.0, 40.0, 60.0, 90.0, 60.0, 60.0, 30.0, 0.0, 480.0, -30.0, 130.0, 20.0, 90.0, 40.0, 50.0, 30.0, 40.0, 50.0, 100.0, 160.0, 160.0, 0.0, 20.0, 10.0, 240.0, 50.0, 40.0, -40.0, 350.0, 30.0, 80.0, -10.0, 10.0, 70.0, 420.0, 310.0, 20.0, 290.0, 30.0, 30.0, 10.0, 20.0, 0.0, 50.0, 40.0, 0.0, 0.0, 40.0, 50.0, 30.0, 30.0, 80.0, 280.0, 10.0, 40.0, 190.0, 400.0, 90.0, -20.0, 10.0, 60.0, 10.0, 60.0, 170.0, 220.0, 60.0, 40.0, 0.0, 30.0, 20.0, 400.0, 50.0, 30.0, 10.0, 140.0, 30.0, -30.0, 30.0, 20.0, 40.0, 50.0, 10.0, 140.0, 0.0, 0.0, 40.0, 10.0, 30.0, 220.0, 80.0, 280.0, 20.0, 80.0, 30.0, 30.0, 240.0, 80.0, 20.0, 180.0, 170.0, 30.0, -70.0, 170.0, 60.0, 120.0, 10.0, 130.0, -70.0, 60.0, 310.0, 90.0, 20.0, 20.0, 80.0, 50.0, 100.0, 30.0, 60.0, 60.0, 60.0, 230.0, 240.0, 60.0, 40.0, 110.0, -80.0, 25.0, 20.0, 20.0, 20.0, 10.0, 10.0, 70.0, 10.0, -20.0, 50.0, 0.0, 20.0, 0.0, 40.0, 40.0, 50.0, 40.0, 100.0, 80.0, 50.0, 180.0, 20.0, 90.0, 90.0, 90.0, 20.0, 110.0, 340.0, 10.0, 160.0, 120.0, 70.0, 60.0, 40.0, 300.0, 190.0, 80.0, 10.0, 60.0, 60.0, 200.0, 70.0, 0.0, 10.0, 10.0, -80.0, 20.0, 20.0, 10.0, 70.0, 30.0, 50.0, 30.0, 10.0, -10.0, 320.0, 10.0, 70.0, 50.0, 180.0, 340.0, 20.0, 310.0, 80.0, 90.0, 40.0, 10.0, 210.0, 10.0, 70.0, 300.0, 40.0, 30.0, 40.0, -20.0, 60.0, 70.0, 40.0, 190.0, 10.0, 70.0, 40.0, 210.0, 0.0, 40.0, 180.0, 30.0, 30.0, 30.0, 50.0, 25.0, 130.0, 120.0, 470.0, 160.0, 60.0, 20.0, 100.0, 90.0, 110.0, 20.0, 70.0, 20.0, 90.0, 30.0, 0.0, 150.0, 70.0, 10.0, 30.0, 40.0, 20.0, 10.0, 80.0, 100.0, 0.0, 30.0, 50.0, 80.0, 40.0, 0.0, 80.0, 0.0, 140.0, 40.0, 380.0, 110.0, 10.0, 100.0, 40.0, 60.0, 30.0, 80.0, 50.0, 40.0, 70.0, 20.0, 0.0, 80.0, 20.0, 30.0, 0.0, 40.0, 50.0, 300.0, 80.0, 60.0, 30.0, 150.0, 170.0, 180.0, 10.0, 70.0, 130.0, 150.0, 90.0, 90.0, 60.0, 300.0, 250.0, 20.0, 140.0, 35.0, 310.0, -20.0, 180.0, 80.0, 40.0, 100.0, 40.0, 260.0, 20.0, 380.0, 40.0, 40.0, 50.0, 20.0, 20.0, 0.0, -170.0, 10.0, 100.0, 20.0, 20.0, 60.0, 40.0, 85.0, 20.0, 320.0, 60.0, 20.0, 100.0, 100.0, 40.0, 370.0, 50.0, 30.0, 60.0, 40.0, 290.0, 20.0, 180.0, 20.0, 20.0, 60.0, 0.0, 20.0, 260.0, 170.0, 60.0, 0.0, 40.0, 90.0, 10.0, 15.0, 130.0, 20.0, 10.0, 10.0, 560.0, -200.0, 50.0, 60.0, 320.0, 20.0, 10.0, 120.0, 200.0, 90.0, 50.0, 70.0, 90.0, 30.0, 220.0, 20.0, 10.0, 40.0, 0.0, 100.0, 140.0, 160.0, 80.0, 10.0, 240.0, 20.0, 50.0, 20.0, 140.0, 50.0, 30.0, 0.0, 80.0, 50.0, 70.0, 80.0, 0.0, 30.0, 250.0, 240.0, 210.0, 70.0, 60.0, 450.0, 150.0, 110.0, 40.0, 500.0, 200.0, 60.0, 25.0, -20.0, 170.0, 60.0, 60.0, 90.0, 10.0, 390.0, 80.0, 40.0, 160.0, 20.0, 30.0, 100.0, 50.0, 15.0, 260.0, 290.0, 20.0, 20.0, 50.0, 0.0, 60.0, 170.0, 80.0, 210.0, 50.0, 430.0, 60.0, 40.0, 40.0, 80.0, 40.0, 0.0, 100.0, 180.0, 60.0, 10.0, 70.0, 30.0, 190.0, 0.0, 30.0, 30.0, 50.0, 60.0, 20.0, 20.0, 0.0, 0.0, 20.0, 110.0, 30.0, 0.0, 90.0, 40.0, 80.0, 40.0, 10.0, 40.0, 10.0, 30.0, 190.0, 50.0, 80.0, 150.0, 30.0, 30.0, 150.0, 20.0, 310.0, 30.0, 180.0, 30.0, 10.0, 40.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 40.0, 60.0, 20.0, 30.0, 50.0, 370.0, 10.0, 30.0, 210.0, 180.0, 30.0, 70.0, 60.0, 200.0, 70.0, 50.0, 10.0, 30.0, 30.0, 50.0, 10.0, 30.0, 70.0, 210.0, 0.0, 30.0, 0.0, 0.0, 0.0, 90.0, 20.0, 40.0, 50.0, 50.0, 200.0, 190.0, 20.0, 430.0, 160.0, -20.0, 80.0, 100.0, 80.0, 70.0, 30.0, 50.0, 140.0, 480.0, 170.0, 130.0, 30.0, 110.0, 120.0, 60.0, 40.0, 10.0, 40.0, 50.0, 420.0, 0.0, 80.0, 40.0, 200.0, 20.0, 10.0, -80.0, 100.0, 840.0, 90.0, 40.0, 170.0, 60.0, -40.0, 90.0, 100.0, 10.0, 320.0, 30.0, 20.0, 10.0, 90.0, 90.0, 80.0, 90.0, 80.0, 50.0, -60.0, 20.0, 180.0, 100.0, 10.0, 100.0, 20.0, 0.0, 360.0, 40.0, 40.0, -50.0, 190.0, 10.0, 90.0, 580.0, 120.0, 0.0, 140.0, 80.0, 10.0, 20.0, 60.0, 130.0, 160.0, 10.0, 10.0, 350.0, 10.0, 50.0, 0.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 0.0, 200.0, 60.0, 50.0, 60.0, 10.0, 10.0, 120.0, 0.0, 280.0, 60.0, 60.0, 40.0, 40.0, 370.0, 80.0, 10.0, 90.0, 30.0, 90.0, 110.0, 40.0, -20.0, 30.0, 160.0, 130.0, 20.0, 160.0, -340.0, 140.0, 150.0, 0.0, 160.0, 350.0, 50.0, -55.0, -30.0, -85.0, 10.0, 300.0, 40.0, 40.0, 300.0, 10.0, 0.0, -30.0, 0.0, 190.0, 70.0, 70.0, 20.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 0.0, 150.0, 20.0, 10.0, 150.0, 150.0, 390.0, 150.0, 0.0, 10.0, 30.0, 310.0, 40.0, 230.0, -10.0, 0.0, 0.0, 0.0, 10.0, -210.0, 20.0, 20.0, 10.0, 240.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.452250488072139, "mean_inference_ms": 2.2571144901928353, "mean_action_processing_ms": 0.6612272781549808, "mean_env_wait_ms": 2.1334276175873117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012645483016967773, "StateBufferConnector_ms": 0.009813070297241211, "ViewRequirementAgentConnector_ms": 0.38070034980773926}, "num_episodes": 23, "episode_return_max": 1575.0, "episode_return_min": 100.0, "episode_return_mean": 779.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.13620207615601, "num_env_steps_trained_throughput_per_sec": 20.13620207615601, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 203137.626, "restore_workers_time_ms": 0.012, "training_step_time_ms": 203137.581, "sample_time_ms": 2631.839, "learn_time_ms": 200486.543, "learn_throughput": 19.951, "synch_weights_time_ms": 11.659}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 34, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-22-03", "timestamp": 1717219323, "time_this_iter_s": 198.6550669670105, "time_total_s": 10140.400351285934, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f88aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10140.400351285934, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.583214285714288, "ram_util_percent": 78.9367857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.196368832437121, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.783473110249756, "policy_loss": -0.009953731264551076, "vf_loss": 6.792552343242592, "vf_explained_var": 0.0010512328820741468, "kl": 0.008744981118018899, "entropy": 0.6949985963658403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 323955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 1575.0, "episode_reward_min": 100.0, "episode_reward_mean": 786.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 78.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.0, 850.0, 675.0, 220.0, 550.0, 640.0, 690.0, 260.0, 195.0, 1070.0, 795.0, 1020.0, 210.0, 970.0, 850.0, 830.0, 1240.0, 470.0, 1150.0, 700.0, 680.0, 340.0, 1090.0, 820.0, 690.0, 805.0, 190.0, 600.0, 1050.0, 1070.0, 160.0, 1050.0, 1140.0, 530.0, 635.0, 1280.0, 510.0, 410.0, 960.0, 420.0, 1060.0, 1170.0, 1165.0, 410.0, 745.0, 1100.0, 790.0, 685.0, 990.0, 810.0, 640.0, 1080.0, 1575.0, 1080.0, 835.0, 1220.0, 680.0, 340.0, 370.0, 1040.0, 370.0, 290.0, 1230.0, 490.0, 480.0, 1140.0, 1330.0, 870.0, 1370.0, 820.0, 780.0, 1160.0, 840.0, 690.0, 710.0, 900.0, 430.0, 780.0, 680.0, 470.0, 1300.0, 100.0, 1080.0, 440.0, 675.0, 980.0, 645.0, 1200.0, 1030.0, 390.0, 1130.0, 1010.0, 740.0, 1190.0, 990.0, 680.0, 630.0, 610.0, 790.0, 1300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 50.0, 5.0, 10.0, 70.0, 10.0, 0.0, 40.0, 0.0, 80.0, 40.0, 40.0, 0.0, 50.0, 470.0, 50.0, 40.0, 100.0, 40.0, 20.0, 70.0, 50.0, 10.0, 150.0, 110.0, 30.0, -25.0, 40.0, 50.0, 190.0, 20.0, 20.0, 70.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 30.0, 30.0, 30.0, 0.0, 40.0, 90.0, 80.0, 30.0, 40.0, 180.0, 30.0, 50.0, 40.0, 40.0, 30.0, 260.0, 80.0, 10.0, 30.0, 70.0, 70.0, 100.0, -60.0, 120.0, 0.0, 230.0, 30.0, 40.0, 60.0, 100.0, 0.0, 10.0, 60.0, 0.0, 130.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, -5.0, 60.0, 20.0, 20.0, 70.0, 30.0, -30.0, 190.0, 10.0, 190.0, 40.0, 130.0, 370.0, 70.0, 200.0, 30.0, 30.0, 180.0, 30.0, 20.0, 5.0, 210.0, 90.0, 0.0, 160.0, 460.0, -20.0, 270.0, -10.0, -30.0, -60.0, 260.0, 0.0, -10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 320.0, 20.0, 210.0, 80.0, 40.0, 60.0, 90.0, 60.0, 60.0, 30.0, 0.0, 480.0, -30.0, 130.0, 20.0, 90.0, 40.0, 50.0, 30.0, 40.0, 50.0, 100.0, 160.0, 160.0, 0.0, 20.0, 10.0, 240.0, 50.0, 40.0, -40.0, 350.0, 30.0, 80.0, -10.0, 10.0, 70.0, 420.0, 310.0, 20.0, 290.0, 30.0, 30.0, 10.0, 20.0, 0.0, 50.0, 40.0, 0.0, 0.0, 40.0, 50.0, 30.0, 30.0, 80.0, 280.0, 10.0, 40.0, 190.0, 400.0, 90.0, -20.0, 10.0, 60.0, 10.0, 60.0, 170.0, 220.0, 60.0, 40.0, 0.0, 30.0, 20.0, 400.0, 50.0, 30.0, 10.0, 140.0, 30.0, -30.0, 30.0, 20.0, 40.0, 50.0, 10.0, 140.0, 0.0, 0.0, 40.0, 10.0, 30.0, 220.0, 80.0, 280.0, 20.0, 80.0, 30.0, 30.0, 240.0, 80.0, 20.0, 180.0, 170.0, 30.0, -70.0, 170.0, 60.0, 120.0, 10.0, 130.0, -70.0, 60.0, 310.0, 90.0, 20.0, 20.0, 80.0, 50.0, 100.0, 30.0, 60.0, 60.0, 60.0, 230.0, 240.0, 60.0, 40.0, 110.0, -80.0, 25.0, 20.0, 20.0, 20.0, 10.0, 10.0, 70.0, 10.0, -20.0, 50.0, 0.0, 20.0, 0.0, 40.0, 40.0, 50.0, 40.0, 100.0, 80.0, 50.0, 180.0, 20.0, 90.0, 90.0, 90.0, 20.0, 110.0, 340.0, 10.0, 160.0, 120.0, 70.0, 60.0, 40.0, 300.0, 190.0, 80.0, 10.0, 60.0, 60.0, 200.0, 70.0, 0.0, 10.0, 10.0, -80.0, 20.0, 20.0, 10.0, 70.0, 30.0, 50.0, 30.0, 10.0, -10.0, 320.0, 10.0, 70.0, 50.0, 180.0, 340.0, 20.0, 310.0, 80.0, 90.0, 40.0, 10.0, 210.0, 10.0, 70.0, 300.0, 40.0, 30.0, 40.0, -20.0, 60.0, 70.0, 40.0, 190.0, 10.0, 70.0, 40.0, 210.0, 0.0, 40.0, 180.0, 30.0, 30.0, 30.0, 50.0, 25.0, 130.0, 120.0, 470.0, 160.0, 60.0, 20.0, 100.0, 90.0, 110.0, 20.0, 70.0, 20.0, 90.0, 30.0, 0.0, 150.0, 70.0, 10.0, 30.0, 40.0, 20.0, 10.0, 80.0, 100.0, 0.0, 30.0, 50.0, 80.0, 40.0, 0.0, 80.0, 0.0, 140.0, 40.0, 380.0, 110.0, 10.0, 100.0, 40.0, 60.0, 30.0, 80.0, 50.0, 40.0, 70.0, 20.0, 0.0, 80.0, 20.0, 30.0, 0.0, 40.0, 50.0, 300.0, 80.0, 60.0, 30.0, 150.0, 170.0, 180.0, 10.0, 70.0, 130.0, 150.0, 90.0, 90.0, 60.0, 300.0, 250.0, 20.0, 140.0, 35.0, 310.0, -20.0, 180.0, 80.0, 40.0, 100.0, 40.0, 260.0, 20.0, 380.0, 40.0, 40.0, 50.0, 20.0, 20.0, 0.0, -170.0, 10.0, 100.0, 20.0, 20.0, 60.0, 40.0, 85.0, 20.0, 320.0, 60.0, 20.0, 100.0, 100.0, 40.0, 370.0, 50.0, 30.0, 60.0, 40.0, 290.0, 20.0, 180.0, 20.0, 20.0, 60.0, 0.0, 20.0, 260.0, 170.0, 60.0, 0.0, 40.0, 90.0, 10.0, 15.0, 130.0, 20.0, 10.0, 10.0, 560.0, -200.0, 50.0, 60.0, 320.0, 20.0, 10.0, 120.0, 200.0, 90.0, 50.0, 70.0, 90.0, 30.0, 220.0, 20.0, 10.0, 40.0, 0.0, 100.0, 140.0, 160.0, 80.0, 10.0, 240.0, 20.0, 50.0, 20.0, 140.0, 50.0, 30.0, 0.0, 80.0, 50.0, 70.0, 80.0, 0.0, 30.0, 250.0, 240.0, 210.0, 70.0, 60.0, 450.0, 150.0, 110.0, 40.0, 500.0, 200.0, 60.0, 25.0, -20.0, 170.0, 60.0, 60.0, 90.0, 10.0, 390.0, 80.0, 40.0, 160.0, 20.0, 30.0, 100.0, 50.0, 15.0, 260.0, 290.0, 20.0, 20.0, 50.0, 0.0, 60.0, 170.0, 80.0, 210.0, 50.0, 430.0, 60.0, 40.0, 40.0, 80.0, 40.0, 0.0, 100.0, 180.0, 60.0, 10.0, 70.0, 30.0, 190.0, 0.0, 30.0, 30.0, 50.0, 60.0, 20.0, 20.0, 0.0, 0.0, 20.0, 110.0, 30.0, 0.0, 90.0, 40.0, 80.0, 40.0, 10.0, 40.0, 10.0, 30.0, 190.0, 50.0, 80.0, 150.0, 30.0, 30.0, 150.0, 20.0, 310.0, 30.0, 180.0, 30.0, 10.0, 40.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 40.0, 60.0, 20.0, 30.0, 50.0, 370.0, 10.0, 30.0, 210.0, 180.0, 30.0, 70.0, 60.0, 200.0, 70.0, 50.0, 10.0, 30.0, 30.0, 50.0, 10.0, 30.0, 70.0, 210.0, 0.0, 30.0, 0.0, 0.0, 0.0, 90.0, 20.0, 40.0, 50.0, 50.0, 200.0, 190.0, 20.0, 430.0, 160.0, -20.0, 80.0, 100.0, 80.0, 70.0, 30.0, 50.0, 140.0, 480.0, 170.0, 130.0, 30.0, 110.0, 120.0, 60.0, 40.0, 10.0, 40.0, 50.0, 420.0, 0.0, 80.0, 40.0, 200.0, 20.0, 10.0, -80.0, 100.0, 840.0, 90.0, 40.0, 170.0, 60.0, -40.0, 90.0, 100.0, 10.0, 320.0, 30.0, 20.0, 10.0, 90.0, 90.0, 80.0, 90.0, 80.0, 50.0, -60.0, 20.0, 180.0, 100.0, 10.0, 100.0, 20.0, 0.0, 360.0, 40.0, 40.0, -50.0, 190.0, 10.0, 90.0, 580.0, 120.0, 0.0, 140.0, 80.0, 10.0, 20.0, 60.0, 130.0, 160.0, 10.0, 10.0, 350.0, 10.0, 50.0, 0.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 0.0, 200.0, 60.0, 50.0, 60.0, 10.0, 10.0, 120.0, 0.0, 280.0, 60.0, 60.0, 40.0, 40.0, 370.0, 80.0, 10.0, 90.0, 30.0, 90.0, 110.0, 40.0, -20.0, 30.0, 160.0, 130.0, 20.0, 160.0, -340.0, 140.0, 150.0, 0.0, 160.0, 350.0, 50.0, -55.0, -30.0, -85.0, 10.0, 300.0, 40.0, 40.0, 300.0, 10.0, 0.0, -30.0, 0.0, 190.0, 70.0, 70.0, 20.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 0.0, 150.0, 20.0, 10.0, 150.0, 150.0, 390.0, 150.0, 0.0, 10.0, 30.0, 310.0, 40.0, 230.0, -10.0, 0.0, 0.0, 0.0, 10.0, -210.0, 20.0, 20.0, 10.0, 240.0, 10.0, 0.0, 160.0, 30.0, 180.0, 30.0, 10.0, 80.0, 190.0, 390.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 110.0, 70.0, 50.0, 40.0, 20.0, 320.0, 130.0, -130.0, -40.0, 60.0, 160.0, 35.0, 40.0, 10.0, 90.0, 60.0, -50.0, 90.0, 30.0, 260.0, 70.0, 10.0, 390.0, -50.0, 170.0, 0.0, 50.0, -35.0, 10.0, 200.0, 40.0, 0.0, 80.0, 280.0, 20.0, 30.0, 80.0, 80.0, 70.0, 250.0, 100.0, 95.0, 440.0, 50.0, 5.0, 180.0, 100.0, 70.0, -20.0, 90.0, 170.0, 20.0, 10.0, 410.0, 0.0, 10.0, 0.0, 0.0, 160.0, 20.0, 0.0, 40.0, 40.0, 40.0, 80.0, 60.0, 170.0, -30.0, 70.0, 70.0, 190.0, -40.0, 140.0, 20.0, 480.0, 260.0, 40.0, 10.0, 40.0, 10.0, -10.0, 30.0, 160.0, 430.0, 40.0, -30.0, 240.0, 80.0, 70.0, 110.0, 130.0, 20.0, 60.0, 0.0, 60.0, 50.0, 40.0, 520.0, -10.0, 110.0, 110.0, 190.0, 50.0, 60.0, 70.0, 40.0, 30.0, 260.0, 100.0, 40.0, 250.0, -20.0, 10.0, 150.0, 130.0, 30.0, 80.0, 0.0, 50.0, 40.0, 0.0, 0.0, 20.0, 300.0, 160.0, 20.0, 170.0, 80.0, 90.0, 190.0, 30.0, 0.0, 30.0, 20.0, 0.0, -30.0, 70.0, 60.0, 40.0, 200.0, 30.0, 60.0, 100.0, -20.0, 100.0, 60.0, 190.0, 20.0, 80.0, 80.0, 210.0, 0.0, 30.0, 50.0, 70.0, 530.0, 40.0, 60.0, 20.0, 90.0, 140.0, 80.0, 40.0, 280.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278642266869674, "mean_inference_ms": 2.235001942533918, "mean_action_processing_ms": 0.6535651939064759, "mean_env_wait_ms": 2.1082045452756306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012717962265014648, "StateBufferConnector_ms": 0.009718656539916992, "ViewRequirementAgentConnector_ms": 0.380828857421875}, "num_episodes": 18, "episode_return_max": 1575.0, "episode_return_min": 100.0, "episode_return_mean": 786.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.891955549534387, "num_env_steps_trained_throughput_per_sec": 19.891955549534387, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 203159.01, "restore_workers_time_ms": 0.011, "training_step_time_ms": 203158.966, "sample_time_ms": 2617.438, "learn_time_ms": 200521.41, "learn_throughput": 19.948, "synch_weights_time_ms": 12.401}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 35, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-25-24", "timestamp": 1717219524, "time_this_iter_s": 201.1046199798584, "time_total_s": 10341.504971265793, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f87df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10341.504971265793, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 26.08842105263158, "ram_util_percent": 80.78280701754386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.10158238292883, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.226900972522739, "policy_loss": -0.009598290982110182, "vf_loss": 6.2356707148404675, "vf_explained_var": 0.0006341063747771631, "kl": 0.008285485152171146, "entropy": 0.6928795889289742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 333345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 1575.0, "episode_reward_min": 100.0, "episode_reward_mean": 834.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 83.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1150.0, 700.0, 680.0, 340.0, 1090.0, 820.0, 690.0, 805.0, 190.0, 600.0, 1050.0, 1070.0, 160.0, 1050.0, 1140.0, 530.0, 635.0, 1280.0, 510.0, 410.0, 960.0, 420.0, 1060.0, 1170.0, 1165.0, 410.0, 745.0, 1100.0, 790.0, 685.0, 990.0, 810.0, 640.0, 1080.0, 1575.0, 1080.0, 835.0, 1220.0, 680.0, 340.0, 370.0, 1040.0, 370.0, 290.0, 1230.0, 490.0, 480.0, 1140.0, 1330.0, 870.0, 1370.0, 820.0, 780.0, 1160.0, 840.0, 690.0, 710.0, 900.0, 430.0, 780.0, 680.0, 470.0, 1300.0, 100.0, 1080.0, 440.0, 675.0, 980.0, 645.0, 1200.0, 1030.0, 390.0, 1130.0, 1010.0, 740.0, 1190.0, 990.0, 680.0, 630.0, 610.0, 790.0, 1300.0, 1150.0, 1190.0, 375.0, 1200.0, 1070.0, 575.0, 930.0, 220.0, 770.0, 1305.0, 1340.0, 860.0, 1310.0, 1100.0, 930.0, 210.0, 1015.0, 1100.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 50.0, 30.0, 30.0, 80.0, 280.0, 10.0, 40.0, 190.0, 400.0, 90.0, -20.0, 10.0, 60.0, 10.0, 60.0, 170.0, 220.0, 60.0, 40.0, 0.0, 30.0, 20.0, 400.0, 50.0, 30.0, 10.0, 140.0, 30.0, -30.0, 30.0, 20.0, 40.0, 50.0, 10.0, 140.0, 0.0, 0.0, 40.0, 10.0, 30.0, 220.0, 80.0, 280.0, 20.0, 80.0, 30.0, 30.0, 240.0, 80.0, 20.0, 180.0, 170.0, 30.0, -70.0, 170.0, 60.0, 120.0, 10.0, 130.0, -70.0, 60.0, 310.0, 90.0, 20.0, 20.0, 80.0, 50.0, 100.0, 30.0, 60.0, 60.0, 60.0, 230.0, 240.0, 60.0, 40.0, 110.0, -80.0, 25.0, 20.0, 20.0, 20.0, 10.0, 10.0, 70.0, 10.0, -20.0, 50.0, 0.0, 20.0, 0.0, 40.0, 40.0, 50.0, 40.0, 100.0, 80.0, 50.0, 180.0, 20.0, 90.0, 90.0, 90.0, 20.0, 110.0, 340.0, 10.0, 160.0, 120.0, 70.0, 60.0, 40.0, 300.0, 190.0, 80.0, 10.0, 60.0, 60.0, 200.0, 70.0, 0.0, 10.0, 10.0, -80.0, 20.0, 20.0, 10.0, 70.0, 30.0, 50.0, 30.0, 10.0, -10.0, 320.0, 10.0, 70.0, 50.0, 180.0, 340.0, 20.0, 310.0, 80.0, 90.0, 40.0, 10.0, 210.0, 10.0, 70.0, 300.0, 40.0, 30.0, 40.0, -20.0, 60.0, 70.0, 40.0, 190.0, 10.0, 70.0, 40.0, 210.0, 0.0, 40.0, 180.0, 30.0, 30.0, 30.0, 50.0, 25.0, 130.0, 120.0, 470.0, 160.0, 60.0, 20.0, 100.0, 90.0, 110.0, 20.0, 70.0, 20.0, 90.0, 30.0, 0.0, 150.0, 70.0, 10.0, 30.0, 40.0, 20.0, 10.0, 80.0, 100.0, 0.0, 30.0, 50.0, 80.0, 40.0, 0.0, 80.0, 0.0, 140.0, 40.0, 380.0, 110.0, 10.0, 100.0, 40.0, 60.0, 30.0, 80.0, 50.0, 40.0, 70.0, 20.0, 0.0, 80.0, 20.0, 30.0, 0.0, 40.0, 50.0, 300.0, 80.0, 60.0, 30.0, 150.0, 170.0, 180.0, 10.0, 70.0, 130.0, 150.0, 90.0, 90.0, 60.0, 300.0, 250.0, 20.0, 140.0, 35.0, 310.0, -20.0, 180.0, 80.0, 40.0, 100.0, 40.0, 260.0, 20.0, 380.0, 40.0, 40.0, 50.0, 20.0, 20.0, 0.0, -170.0, 10.0, 100.0, 20.0, 20.0, 60.0, 40.0, 85.0, 20.0, 320.0, 60.0, 20.0, 100.0, 100.0, 40.0, 370.0, 50.0, 30.0, 60.0, 40.0, 290.0, 20.0, 180.0, 20.0, 20.0, 60.0, 0.0, 20.0, 260.0, 170.0, 60.0, 0.0, 40.0, 90.0, 10.0, 15.0, 130.0, 20.0, 10.0, 10.0, 560.0, -200.0, 50.0, 60.0, 320.0, 20.0, 10.0, 120.0, 200.0, 90.0, 50.0, 70.0, 90.0, 30.0, 220.0, 20.0, 10.0, 40.0, 0.0, 100.0, 140.0, 160.0, 80.0, 10.0, 240.0, 20.0, 50.0, 20.0, 140.0, 50.0, 30.0, 0.0, 80.0, 50.0, 70.0, 80.0, 0.0, 30.0, 250.0, 240.0, 210.0, 70.0, 60.0, 450.0, 150.0, 110.0, 40.0, 500.0, 200.0, 60.0, 25.0, -20.0, 170.0, 60.0, 60.0, 90.0, 10.0, 390.0, 80.0, 40.0, 160.0, 20.0, 30.0, 100.0, 50.0, 15.0, 260.0, 290.0, 20.0, 20.0, 50.0, 0.0, 60.0, 170.0, 80.0, 210.0, 50.0, 430.0, 60.0, 40.0, 40.0, 80.0, 40.0, 0.0, 100.0, 180.0, 60.0, 10.0, 70.0, 30.0, 190.0, 0.0, 30.0, 30.0, 50.0, 60.0, 20.0, 20.0, 0.0, 0.0, 20.0, 110.0, 30.0, 0.0, 90.0, 40.0, 80.0, 40.0, 10.0, 40.0, 10.0, 30.0, 190.0, 50.0, 80.0, 150.0, 30.0, 30.0, 150.0, 20.0, 310.0, 30.0, 180.0, 30.0, 10.0, 40.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 40.0, 60.0, 20.0, 30.0, 50.0, 370.0, 10.0, 30.0, 210.0, 180.0, 30.0, 70.0, 60.0, 200.0, 70.0, 50.0, 10.0, 30.0, 30.0, 50.0, 10.0, 30.0, 70.0, 210.0, 0.0, 30.0, 0.0, 0.0, 0.0, 90.0, 20.0, 40.0, 50.0, 50.0, 200.0, 190.0, 20.0, 430.0, 160.0, -20.0, 80.0, 100.0, 80.0, 70.0, 30.0, 50.0, 140.0, 480.0, 170.0, 130.0, 30.0, 110.0, 120.0, 60.0, 40.0, 10.0, 40.0, 50.0, 420.0, 0.0, 80.0, 40.0, 200.0, 20.0, 10.0, -80.0, 100.0, 840.0, 90.0, 40.0, 170.0, 60.0, -40.0, 90.0, 100.0, 10.0, 320.0, 30.0, 20.0, 10.0, 90.0, 90.0, 80.0, 90.0, 80.0, 50.0, -60.0, 20.0, 180.0, 100.0, 10.0, 100.0, 20.0, 0.0, 360.0, 40.0, 40.0, -50.0, 190.0, 10.0, 90.0, 580.0, 120.0, 0.0, 140.0, 80.0, 10.0, 20.0, 60.0, 130.0, 160.0, 10.0, 10.0, 350.0, 10.0, 50.0, 0.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 0.0, 200.0, 60.0, 50.0, 60.0, 10.0, 10.0, 120.0, 0.0, 280.0, 60.0, 60.0, 40.0, 40.0, 370.0, 80.0, 10.0, 90.0, 30.0, 90.0, 110.0, 40.0, -20.0, 30.0, 160.0, 130.0, 20.0, 160.0, -340.0, 140.0, 150.0, 0.0, 160.0, 350.0, 50.0, -55.0, -30.0, -85.0, 10.0, 300.0, 40.0, 40.0, 300.0, 10.0, 0.0, -30.0, 0.0, 190.0, 70.0, 70.0, 20.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 0.0, 150.0, 20.0, 10.0, 150.0, 150.0, 390.0, 150.0, 0.0, 10.0, 30.0, 310.0, 40.0, 230.0, -10.0, 0.0, 0.0, 0.0, 10.0, -210.0, 20.0, 20.0, 10.0, 240.0, 10.0, 0.0, 160.0, 30.0, 180.0, 30.0, 10.0, 80.0, 190.0, 390.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 110.0, 70.0, 50.0, 40.0, 20.0, 320.0, 130.0, -130.0, -40.0, 60.0, 160.0, 35.0, 40.0, 10.0, 90.0, 60.0, -50.0, 90.0, 30.0, 260.0, 70.0, 10.0, 390.0, -50.0, 170.0, 0.0, 50.0, -35.0, 10.0, 200.0, 40.0, 0.0, 80.0, 280.0, 20.0, 30.0, 80.0, 80.0, 70.0, 250.0, 100.0, 95.0, 440.0, 50.0, 5.0, 180.0, 100.0, 70.0, -20.0, 90.0, 170.0, 20.0, 10.0, 410.0, 0.0, 10.0, 0.0, 0.0, 160.0, 20.0, 0.0, 40.0, 40.0, 40.0, 80.0, 60.0, 170.0, -30.0, 70.0, 70.0, 190.0, -40.0, 140.0, 20.0, 480.0, 260.0, 40.0, 10.0, 40.0, 10.0, -10.0, 30.0, 160.0, 430.0, 40.0, -30.0, 240.0, 80.0, 70.0, 110.0, 130.0, 20.0, 60.0, 0.0, 60.0, 50.0, 40.0, 520.0, -10.0, 110.0, 110.0, 190.0, 50.0, 60.0, 70.0, 40.0, 30.0, 260.0, 100.0, 40.0, 250.0, -20.0, 10.0, 150.0, 130.0, 30.0, 80.0, 0.0, 50.0, 40.0, 0.0, 0.0, 20.0, 300.0, 160.0, 20.0, 170.0, 80.0, 90.0, 190.0, 30.0, 0.0, 30.0, 20.0, 0.0, -30.0, 70.0, 60.0, 40.0, 200.0, 30.0, 60.0, 100.0, -20.0, 100.0, 60.0, 190.0, 20.0, 80.0, 80.0, 210.0, 0.0, 30.0, 50.0, 70.0, 530.0, 40.0, 60.0, 20.0, 90.0, 140.0, 80.0, 40.0, 280.0, 20.0, 400.0, 110.0, 30.0, 80.0, 30.0, 40.0, 10.0, 20.0, 30.0, 400.0, 40.0, 40.0, 240.0, 80.0, 330.0, 10.0, 270.0, 30.0, 60.0, 90.0, 15.0, 0.0, 50.0, 10.0, 40.0, 0.0, 100.0, 20.0, 90.0, 50.0, 600.0, 50.0, 0.0, 260.0, 180.0, 20.0, 90.0, 40.0, -40.0, 0.0, 200.0, 10.0, 100.0, 70.0, 360.0, 70.0, 120.0, 90.0, 30.0, 20.0, 170.0, -5.0, 60.0, 80.0, 70.0, 20.0, 30.0, 70.0, 30.0, 50.0, 30.0, 70.0, -40.0, 80.0, 40.0, 120.0, 60.0, 350.0, 190.0, 30.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 140.0, 30.0, 90.0, 270.0, 20.0, 40.0, 110.0, 0.0, 30.0, 40.0, 200.0, 20.0, 200.0, 70.0, 190.0, 260.0, 30.0, 35.0, 100.0, 200.0, 30.0, 190.0, 220.0, 390.0, 100.0, 30.0, 80.0, 40.0, 220.0, 40.0, 140.0, 40.0, 230.0, 10.0, 110.0, 30.0, 50.0, 200.0, 50.0, 0.0, 90.0, 440.0, 120.0, 130.0, 180.0, 100.0, -60.0, 10.0, 180.0, 120.0, 30.0, 360.0, 80.0, 150.0, 50.0, 260.0, 10.0, -10.0, 190.0, -20.0, 500.0, 30.0, 110.0, 10.0, 120.0, 90.0, 80.0, -40.0, 30.0, 0.0, 20.0, 150.0, 0.0, 20.0, -70.0, 10.0, 60.0, 10.0, 0.0, 10.0, -20.0, 40.0, 195.0, 70.0, 90.0, 100.0, -20.0, 90.0, 440.0, 30.0, 20.0, 20.0, 90.0, 0.0, 20.0, 270.0, 60.0, 200.0, 70.0, 350.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.404874148724101, "mean_inference_ms": 2.2146380639723677, "mean_action_processing_ms": 0.6463253745974126, "mean_env_wait_ms": 2.0846090968120383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012112855911254883, "StateBufferConnector_ms": 0.009749412536621094, "ViewRequirementAgentConnector_ms": 0.3820381164550781}, "num_episodes": 18, "episode_return_max": 1575.0, "episode_return_min": 100.0, "episode_return_mean": 834.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.152388436645207, "num_env_steps_trained_throughput_per_sec": 20.152388436645207, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 199331.988, "restore_workers_time_ms": 0.011, "training_step_time_ms": 199331.944, "sample_time_ms": 2613.429, "learn_time_ms": 196698.374, "learn_throughput": 20.336, "synch_weights_time_ms": 12.358}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 36, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-28-43", "timestamp": 1717219723, "time_this_iter_s": 198.49617528915405, "time_total_s": 10540.001146554947, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f88a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10540.001146554947, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 25.14590747330961, "ram_util_percent": 79.1715302491103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0619120893450464, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.440697017086707, "policy_loss": -0.00931863362347475, "vf_loss": 6.449146808323642, "vf_explained_var": 0.00021517064116887265, "kl": 0.008688347061696241, "entropy": 0.6389101775468221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 342735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 1575.0, "episode_reward_min": 100.0, "episode_reward_mean": 844.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 84.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [510.0, 410.0, 960.0, 420.0, 1060.0, 1170.0, 1165.0, 410.0, 745.0, 1100.0, 790.0, 685.0, 990.0, 810.0, 640.0, 1080.0, 1575.0, 1080.0, 835.0, 1220.0, 680.0, 340.0, 370.0, 1040.0, 370.0, 290.0, 1230.0, 490.0, 480.0, 1140.0, 1330.0, 870.0, 1370.0, 820.0, 780.0, 1160.0, 840.0, 690.0, 710.0, 900.0, 430.0, 780.0, 680.0, 470.0, 1300.0, 100.0, 1080.0, 440.0, 675.0, 980.0, 645.0, 1200.0, 1030.0, 390.0, 1130.0, 1010.0, 740.0, 1190.0, 990.0, 680.0, 630.0, 610.0, 790.0, 1300.0, 1150.0, 1190.0, 375.0, 1200.0, 1070.0, 575.0, 930.0, 220.0, 770.0, 1305.0, 1340.0, 860.0, 1310.0, 1100.0, 930.0, 210.0, 1015.0, 1100.0, 170.0, 1340.0, 340.0, 1300.0, 1000.0, 460.0, 825.0, 1020.0, 1050.0, 330.0, 620.0, 1260.0, 1150.0, 900.0, 505.0, 870.0, 935.0, 855.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 20.0, 90.0, 30.0, 0.0, 150.0, 70.0, 10.0, 30.0, 40.0, 20.0, 10.0, 80.0, 100.0, 0.0, 30.0, 50.0, 80.0, 40.0, 0.0, 80.0, 0.0, 140.0, 40.0, 380.0, 110.0, 10.0, 100.0, 40.0, 60.0, 30.0, 80.0, 50.0, 40.0, 70.0, 20.0, 0.0, 80.0, 20.0, 30.0, 0.0, 40.0, 50.0, 300.0, 80.0, 60.0, 30.0, 150.0, 170.0, 180.0, 10.0, 70.0, 130.0, 150.0, 90.0, 90.0, 60.0, 300.0, 250.0, 20.0, 140.0, 35.0, 310.0, -20.0, 180.0, 80.0, 40.0, 100.0, 40.0, 260.0, 20.0, 380.0, 40.0, 40.0, 50.0, 20.0, 20.0, 0.0, -170.0, 10.0, 100.0, 20.0, 20.0, 60.0, 40.0, 85.0, 20.0, 320.0, 60.0, 20.0, 100.0, 100.0, 40.0, 370.0, 50.0, 30.0, 60.0, 40.0, 290.0, 20.0, 180.0, 20.0, 20.0, 60.0, 0.0, 20.0, 260.0, 170.0, 60.0, 0.0, 40.0, 90.0, 10.0, 15.0, 130.0, 20.0, 10.0, 10.0, 560.0, -200.0, 50.0, 60.0, 320.0, 20.0, 10.0, 120.0, 200.0, 90.0, 50.0, 70.0, 90.0, 30.0, 220.0, 20.0, 10.0, 40.0, 0.0, 100.0, 140.0, 160.0, 80.0, 10.0, 240.0, 20.0, 50.0, 20.0, 140.0, 50.0, 30.0, 0.0, 80.0, 50.0, 70.0, 80.0, 0.0, 30.0, 250.0, 240.0, 210.0, 70.0, 60.0, 450.0, 150.0, 110.0, 40.0, 500.0, 200.0, 60.0, 25.0, -20.0, 170.0, 60.0, 60.0, 90.0, 10.0, 390.0, 80.0, 40.0, 160.0, 20.0, 30.0, 100.0, 50.0, 15.0, 260.0, 290.0, 20.0, 20.0, 50.0, 0.0, 60.0, 170.0, 80.0, 210.0, 50.0, 430.0, 60.0, 40.0, 40.0, 80.0, 40.0, 0.0, 100.0, 180.0, 60.0, 10.0, 70.0, 30.0, 190.0, 0.0, 30.0, 30.0, 50.0, 60.0, 20.0, 20.0, 0.0, 0.0, 20.0, 110.0, 30.0, 0.0, 90.0, 40.0, 80.0, 40.0, 10.0, 40.0, 10.0, 30.0, 190.0, 50.0, 80.0, 150.0, 30.0, 30.0, 150.0, 20.0, 310.0, 30.0, 180.0, 30.0, 10.0, 40.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 40.0, 60.0, 20.0, 30.0, 50.0, 370.0, 10.0, 30.0, 210.0, 180.0, 30.0, 70.0, 60.0, 200.0, 70.0, 50.0, 10.0, 30.0, 30.0, 50.0, 10.0, 30.0, 70.0, 210.0, 0.0, 30.0, 0.0, 0.0, 0.0, 90.0, 20.0, 40.0, 50.0, 50.0, 200.0, 190.0, 20.0, 430.0, 160.0, -20.0, 80.0, 100.0, 80.0, 70.0, 30.0, 50.0, 140.0, 480.0, 170.0, 130.0, 30.0, 110.0, 120.0, 60.0, 40.0, 10.0, 40.0, 50.0, 420.0, 0.0, 80.0, 40.0, 200.0, 20.0, 10.0, -80.0, 100.0, 840.0, 90.0, 40.0, 170.0, 60.0, -40.0, 90.0, 100.0, 10.0, 320.0, 30.0, 20.0, 10.0, 90.0, 90.0, 80.0, 90.0, 80.0, 50.0, -60.0, 20.0, 180.0, 100.0, 10.0, 100.0, 20.0, 0.0, 360.0, 40.0, 40.0, -50.0, 190.0, 10.0, 90.0, 580.0, 120.0, 0.0, 140.0, 80.0, 10.0, 20.0, 60.0, 130.0, 160.0, 10.0, 10.0, 350.0, 10.0, 50.0, 0.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 0.0, 200.0, 60.0, 50.0, 60.0, 10.0, 10.0, 120.0, 0.0, 280.0, 60.0, 60.0, 40.0, 40.0, 370.0, 80.0, 10.0, 90.0, 30.0, 90.0, 110.0, 40.0, -20.0, 30.0, 160.0, 130.0, 20.0, 160.0, -340.0, 140.0, 150.0, 0.0, 160.0, 350.0, 50.0, -55.0, -30.0, -85.0, 10.0, 300.0, 40.0, 40.0, 300.0, 10.0, 0.0, -30.0, 0.0, 190.0, 70.0, 70.0, 20.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 0.0, 150.0, 20.0, 10.0, 150.0, 150.0, 390.0, 150.0, 0.0, 10.0, 30.0, 310.0, 40.0, 230.0, -10.0, 0.0, 0.0, 0.0, 10.0, -210.0, 20.0, 20.0, 10.0, 240.0, 10.0, 0.0, 160.0, 30.0, 180.0, 30.0, 10.0, 80.0, 190.0, 390.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 110.0, 70.0, 50.0, 40.0, 20.0, 320.0, 130.0, -130.0, -40.0, 60.0, 160.0, 35.0, 40.0, 10.0, 90.0, 60.0, -50.0, 90.0, 30.0, 260.0, 70.0, 10.0, 390.0, -50.0, 170.0, 0.0, 50.0, -35.0, 10.0, 200.0, 40.0, 0.0, 80.0, 280.0, 20.0, 30.0, 80.0, 80.0, 70.0, 250.0, 100.0, 95.0, 440.0, 50.0, 5.0, 180.0, 100.0, 70.0, -20.0, 90.0, 170.0, 20.0, 10.0, 410.0, 0.0, 10.0, 0.0, 0.0, 160.0, 20.0, 0.0, 40.0, 40.0, 40.0, 80.0, 60.0, 170.0, -30.0, 70.0, 70.0, 190.0, -40.0, 140.0, 20.0, 480.0, 260.0, 40.0, 10.0, 40.0, 10.0, -10.0, 30.0, 160.0, 430.0, 40.0, -30.0, 240.0, 80.0, 70.0, 110.0, 130.0, 20.0, 60.0, 0.0, 60.0, 50.0, 40.0, 520.0, -10.0, 110.0, 110.0, 190.0, 50.0, 60.0, 70.0, 40.0, 30.0, 260.0, 100.0, 40.0, 250.0, -20.0, 10.0, 150.0, 130.0, 30.0, 80.0, 0.0, 50.0, 40.0, 0.0, 0.0, 20.0, 300.0, 160.0, 20.0, 170.0, 80.0, 90.0, 190.0, 30.0, 0.0, 30.0, 20.0, 0.0, -30.0, 70.0, 60.0, 40.0, 200.0, 30.0, 60.0, 100.0, -20.0, 100.0, 60.0, 190.0, 20.0, 80.0, 80.0, 210.0, 0.0, 30.0, 50.0, 70.0, 530.0, 40.0, 60.0, 20.0, 90.0, 140.0, 80.0, 40.0, 280.0, 20.0, 400.0, 110.0, 30.0, 80.0, 30.0, 40.0, 10.0, 20.0, 30.0, 400.0, 40.0, 40.0, 240.0, 80.0, 330.0, 10.0, 270.0, 30.0, 60.0, 90.0, 15.0, 0.0, 50.0, 10.0, 40.0, 0.0, 100.0, 20.0, 90.0, 50.0, 600.0, 50.0, 0.0, 260.0, 180.0, 20.0, 90.0, 40.0, -40.0, 0.0, 200.0, 10.0, 100.0, 70.0, 360.0, 70.0, 120.0, 90.0, 30.0, 20.0, 170.0, -5.0, 60.0, 80.0, 70.0, 20.0, 30.0, 70.0, 30.0, 50.0, 30.0, 70.0, -40.0, 80.0, 40.0, 120.0, 60.0, 350.0, 190.0, 30.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 140.0, 30.0, 90.0, 270.0, 20.0, 40.0, 110.0, 0.0, 30.0, 40.0, 200.0, 20.0, 200.0, 70.0, 190.0, 260.0, 30.0, 35.0, 100.0, 200.0, 30.0, 190.0, 220.0, 390.0, 100.0, 30.0, 80.0, 40.0, 220.0, 40.0, 140.0, 40.0, 230.0, 10.0, 110.0, 30.0, 50.0, 200.0, 50.0, 0.0, 90.0, 440.0, 120.0, 130.0, 180.0, 100.0, -60.0, 10.0, 180.0, 120.0, 30.0, 360.0, 80.0, 150.0, 50.0, 260.0, 10.0, -10.0, 190.0, -20.0, 500.0, 30.0, 110.0, 10.0, 120.0, 90.0, 80.0, -40.0, 30.0, 0.0, 20.0, 150.0, 0.0, 20.0, -70.0, 10.0, 60.0, 10.0, 0.0, 10.0, -20.0, 40.0, 195.0, 70.0, 90.0, 100.0, -20.0, 90.0, 440.0, 30.0, 20.0, 20.0, 90.0, 0.0, 20.0, 270.0, 60.0, 200.0, 70.0, 350.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 80.0, 100.0, 260.0, -10.0, 190.0, 150.0, 60.0, 20.0, 440.0, 50.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 20.0, 110.0, 10.0, 50.0, 80.0, 50.0, 180.0, 50.0, 80.0, 230.0, 200.0, 60.0, 50.0, 320.0, 20.0, 0.0, 290.0, 60.0, 320.0, 0.0, 10.0, 190.0, 40.0, 70.0, 10.0, 30.0, 50.0, 150.0, 20.0, 10.0, 20.0, 70.0, 40.0, 60.0, 20.0, 50.0, 10.0, 25.0, 160.0, 300.0, 20.0, 80.0, 130.0, 30.0, 0.0, 130.0, 130.0, 430.0, 60.0, 90.0, 40.0, 10.0, 110.0, 20.0, 80.0, 90.0, 100.0, 10.0, 70.0, 10.0, 190.0, 60.0, 140.0, 300.0, 30.0, 20.0, 10.0, 90.0, 0.0, 30.0, 40.0, 20.0, 40.0, 50.0, 30.0, 40.0, 0.0, 0.0, 50.0, 80.0, 170.0, 0.0, 40.0, 210.0, 80.0, 10.0, 0.0, 440.0, 120.0, 340.0, 60.0, 80.0, 120.0, 10.0, 90.0, 90.0, 180.0, 90.0, 50.0, 210.0, 30.0, 340.0, 40.0, 30.0, 170.0, 150.0, 0.0, 10.0, 40.0, 0.0, 10.0, 330.0, 40.0, 150.0, 10.0, 5.0, 160.0, 60.0, 0.0, 250.0, 10.0, 0.0, 0.0, 10.0, 350.0, 200.0, 60.0, 120.0, -20.0, 80.0, 25.0, 60.0, 10.0, -15.0, 40.0, -30.0, -15.0, 50.0, 40.0, 110.0, 20.0, 470.0, 250.0, 0.0, 40.0, 0.0, 30.0, 40.0, 30.0, 430.0, 80.0, 30.0, 20.0, 155.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3826739593615547, "mean_inference_ms": 2.195139768134668, "mean_action_processing_ms": 0.6394415025349127, "mean_env_wait_ms": 2.0620932272298997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01217198371887207, "StateBufferConnector_ms": 0.009665966033935547, "ViewRequirementAgentConnector_ms": 0.37667131423950195}, "num_episodes": 18, "episode_return_max": 1575.0, "episode_return_min": 100.0, "episode_return_mean": 844.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.978325802080573, "num_env_steps_trained_throughput_per_sec": 19.978325802080573, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 199524.512, "restore_workers_time_ms": 0.011, "training_step_time_ms": 199524.467, "sample_time_ms": 2621.157, "learn_time_ms": 196883.215, "learn_throughput": 20.317, "synch_weights_time_ms": 12.326}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 37, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-32-03", "timestamp": 1717219923, "time_this_iter_s": 200.22489595413208, "time_total_s": 10740.226042509079, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x2984ef9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10740.226042509079, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 26.192579505300355, "ram_util_percent": 79.49929328621909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2221781604269695, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.189071405581392, "policy_loss": -0.009314041425567219, "vf_loss": 6.1975474450027095, "vf_explained_var": 0.000300060541104204, "kl": 0.008379997643874447, "entropy": 0.6602715350441531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 352125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 1380.0, "episode_reward_min": 100.0, "episode_reward_mean": 852.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 85.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 1040.0, 370.0, 290.0, 1230.0, 490.0, 480.0, 1140.0, 1330.0, 870.0, 1370.0, 820.0, 780.0, 1160.0, 840.0, 690.0, 710.0, 900.0, 430.0, 780.0, 680.0, 470.0, 1300.0, 100.0, 1080.0, 440.0, 675.0, 980.0, 645.0, 1200.0, 1030.0, 390.0, 1130.0, 1010.0, 740.0, 1190.0, 990.0, 680.0, 630.0, 610.0, 790.0, 1300.0, 1150.0, 1190.0, 375.0, 1200.0, 1070.0, 575.0, 930.0, 220.0, 770.0, 1305.0, 1340.0, 860.0, 1310.0, 1100.0, 930.0, 210.0, 1015.0, 1100.0, 170.0, 1340.0, 340.0, 1300.0, 1000.0, 460.0, 825.0, 1020.0, 1050.0, 330.0, 620.0, 1260.0, 1150.0, 900.0, 505.0, 870.0, 935.0, 855.0, 920.0, 120.0, 920.0, 330.0, 1080.0, 240.0, 1370.0, 760.0, 1010.0, 880.0, 1260.0, 1160.0, 1130.0, 480.0, 960.0, 1350.0, 1380.0, 1260.0, 550.0, 185.0, 1150.0, 1040.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 0.0, 90.0, 40.0, 80.0, 40.0, 10.0, 40.0, 10.0, 30.0, 190.0, 50.0, 80.0, 150.0, 30.0, 30.0, 150.0, 20.0, 310.0, 30.0, 180.0, 30.0, 10.0, 40.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 40.0, 60.0, 20.0, 30.0, 50.0, 370.0, 10.0, 30.0, 210.0, 180.0, 30.0, 70.0, 60.0, 200.0, 70.0, 50.0, 10.0, 30.0, 30.0, 50.0, 10.0, 30.0, 70.0, 210.0, 0.0, 30.0, 0.0, 0.0, 0.0, 90.0, 20.0, 40.0, 50.0, 50.0, 200.0, 190.0, 20.0, 430.0, 160.0, -20.0, 80.0, 100.0, 80.0, 70.0, 30.0, 50.0, 140.0, 480.0, 170.0, 130.0, 30.0, 110.0, 120.0, 60.0, 40.0, 10.0, 40.0, 50.0, 420.0, 0.0, 80.0, 40.0, 200.0, 20.0, 10.0, -80.0, 100.0, 840.0, 90.0, 40.0, 170.0, 60.0, -40.0, 90.0, 100.0, 10.0, 320.0, 30.0, 20.0, 10.0, 90.0, 90.0, 80.0, 90.0, 80.0, 50.0, -60.0, 20.0, 180.0, 100.0, 10.0, 100.0, 20.0, 0.0, 360.0, 40.0, 40.0, -50.0, 190.0, 10.0, 90.0, 580.0, 120.0, 0.0, 140.0, 80.0, 10.0, 20.0, 60.0, 130.0, 160.0, 10.0, 10.0, 350.0, 10.0, 50.0, 0.0, 60.0, 160.0, 90.0, 50.0, 40.0, 40.0, 0.0, 200.0, 60.0, 50.0, 60.0, 10.0, 10.0, 120.0, 0.0, 280.0, 60.0, 60.0, 40.0, 40.0, 370.0, 80.0, 10.0, 90.0, 30.0, 90.0, 110.0, 40.0, -20.0, 30.0, 160.0, 130.0, 20.0, 160.0, -340.0, 140.0, 150.0, 0.0, 160.0, 350.0, 50.0, -55.0, -30.0, -85.0, 10.0, 300.0, 40.0, 40.0, 300.0, 10.0, 0.0, -30.0, 0.0, 190.0, 70.0, 70.0, 20.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 0.0, 150.0, 20.0, 10.0, 150.0, 150.0, 390.0, 150.0, 0.0, 10.0, 30.0, 310.0, 40.0, 230.0, -10.0, 0.0, 0.0, 0.0, 10.0, -210.0, 20.0, 20.0, 10.0, 240.0, 10.0, 0.0, 160.0, 30.0, 180.0, 30.0, 10.0, 80.0, 190.0, 390.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 110.0, 70.0, 50.0, 40.0, 20.0, 320.0, 130.0, -130.0, -40.0, 60.0, 160.0, 35.0, 40.0, 10.0, 90.0, 60.0, -50.0, 90.0, 30.0, 260.0, 70.0, 10.0, 390.0, -50.0, 170.0, 0.0, 50.0, -35.0, 10.0, 200.0, 40.0, 0.0, 80.0, 280.0, 20.0, 30.0, 80.0, 80.0, 70.0, 250.0, 100.0, 95.0, 440.0, 50.0, 5.0, 180.0, 100.0, 70.0, -20.0, 90.0, 170.0, 20.0, 10.0, 410.0, 0.0, 10.0, 0.0, 0.0, 160.0, 20.0, 0.0, 40.0, 40.0, 40.0, 80.0, 60.0, 170.0, -30.0, 70.0, 70.0, 190.0, -40.0, 140.0, 20.0, 480.0, 260.0, 40.0, 10.0, 40.0, 10.0, -10.0, 30.0, 160.0, 430.0, 40.0, -30.0, 240.0, 80.0, 70.0, 110.0, 130.0, 20.0, 60.0, 0.0, 60.0, 50.0, 40.0, 520.0, -10.0, 110.0, 110.0, 190.0, 50.0, 60.0, 70.0, 40.0, 30.0, 260.0, 100.0, 40.0, 250.0, -20.0, 10.0, 150.0, 130.0, 30.0, 80.0, 0.0, 50.0, 40.0, 0.0, 0.0, 20.0, 300.0, 160.0, 20.0, 170.0, 80.0, 90.0, 190.0, 30.0, 0.0, 30.0, 20.0, 0.0, -30.0, 70.0, 60.0, 40.0, 200.0, 30.0, 60.0, 100.0, -20.0, 100.0, 60.0, 190.0, 20.0, 80.0, 80.0, 210.0, 0.0, 30.0, 50.0, 70.0, 530.0, 40.0, 60.0, 20.0, 90.0, 140.0, 80.0, 40.0, 280.0, 20.0, 400.0, 110.0, 30.0, 80.0, 30.0, 40.0, 10.0, 20.0, 30.0, 400.0, 40.0, 40.0, 240.0, 80.0, 330.0, 10.0, 270.0, 30.0, 60.0, 90.0, 15.0, 0.0, 50.0, 10.0, 40.0, 0.0, 100.0, 20.0, 90.0, 50.0, 600.0, 50.0, 0.0, 260.0, 180.0, 20.0, 90.0, 40.0, -40.0, 0.0, 200.0, 10.0, 100.0, 70.0, 360.0, 70.0, 120.0, 90.0, 30.0, 20.0, 170.0, -5.0, 60.0, 80.0, 70.0, 20.0, 30.0, 70.0, 30.0, 50.0, 30.0, 70.0, -40.0, 80.0, 40.0, 120.0, 60.0, 350.0, 190.0, 30.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 140.0, 30.0, 90.0, 270.0, 20.0, 40.0, 110.0, 0.0, 30.0, 40.0, 200.0, 20.0, 200.0, 70.0, 190.0, 260.0, 30.0, 35.0, 100.0, 200.0, 30.0, 190.0, 220.0, 390.0, 100.0, 30.0, 80.0, 40.0, 220.0, 40.0, 140.0, 40.0, 230.0, 10.0, 110.0, 30.0, 50.0, 200.0, 50.0, 0.0, 90.0, 440.0, 120.0, 130.0, 180.0, 100.0, -60.0, 10.0, 180.0, 120.0, 30.0, 360.0, 80.0, 150.0, 50.0, 260.0, 10.0, -10.0, 190.0, -20.0, 500.0, 30.0, 110.0, 10.0, 120.0, 90.0, 80.0, -40.0, 30.0, 0.0, 20.0, 150.0, 0.0, 20.0, -70.0, 10.0, 60.0, 10.0, 0.0, 10.0, -20.0, 40.0, 195.0, 70.0, 90.0, 100.0, -20.0, 90.0, 440.0, 30.0, 20.0, 20.0, 90.0, 0.0, 20.0, 270.0, 60.0, 200.0, 70.0, 350.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 80.0, 100.0, 260.0, -10.0, 190.0, 150.0, 60.0, 20.0, 440.0, 50.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 20.0, 110.0, 10.0, 50.0, 80.0, 50.0, 180.0, 50.0, 80.0, 230.0, 200.0, 60.0, 50.0, 320.0, 20.0, 0.0, 290.0, 60.0, 320.0, 0.0, 10.0, 190.0, 40.0, 70.0, 10.0, 30.0, 50.0, 150.0, 20.0, 10.0, 20.0, 70.0, 40.0, 60.0, 20.0, 50.0, 10.0, 25.0, 160.0, 300.0, 20.0, 80.0, 130.0, 30.0, 0.0, 130.0, 130.0, 430.0, 60.0, 90.0, 40.0, 10.0, 110.0, 20.0, 80.0, 90.0, 100.0, 10.0, 70.0, 10.0, 190.0, 60.0, 140.0, 300.0, 30.0, 20.0, 10.0, 90.0, 0.0, 30.0, 40.0, 20.0, 40.0, 50.0, 30.0, 40.0, 0.0, 0.0, 50.0, 80.0, 170.0, 0.0, 40.0, 210.0, 80.0, 10.0, 0.0, 440.0, 120.0, 340.0, 60.0, 80.0, 120.0, 10.0, 90.0, 90.0, 180.0, 90.0, 50.0, 210.0, 30.0, 340.0, 40.0, 30.0, 170.0, 150.0, 0.0, 10.0, 40.0, 0.0, 10.0, 330.0, 40.0, 150.0, 10.0, 5.0, 160.0, 60.0, 0.0, 250.0, 10.0, 0.0, 0.0, 10.0, 350.0, 200.0, 60.0, 120.0, -20.0, 80.0, 25.0, 60.0, 10.0, -15.0, 40.0, -30.0, -15.0, 50.0, 40.0, 110.0, 20.0, 470.0, 250.0, 0.0, 40.0, 0.0, 30.0, 40.0, 30.0, 430.0, 80.0, 30.0, 20.0, 155.0, 40.0, 50.0, 0.0, 120.0, 210.0, -10.0, 110.0, 40.0, 200.0, 160.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 100.0, 170.0, 20.0, 20.0, 70.0, 30.0, 300.0, 170.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 190.0, 100.0, 0.0, 0.0, 20.0, 120.0, 140.0, 190.0, 180.0, 110.0, 280.0, 10.0, 20.0, 10.0, 0.0, 50.0, 20.0, 0.0, 40.0, 60.0, 30.0, 0.0, 10.0, 30.0, 80.0, 40.0, 210.0, 120.0, 250.0, 60.0, 70.0, 40.0, 260.0, 240.0, 230.0, 60.0, 90.0, 80.0, 30.0, 100.0, 100.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 30.0, 30.0, 260.0, 310.0, 80.0, 190.0, 160.0, 20.0, 330.0, 40.0, 70.0, 30.0, 0.0, 160.0, 10.0, 60.0, 40.0, -40.0, 80.0, 80.0, 510.0, 40.0, 160.0, 40.0, 10.0, 340.0, 600.0, 40.0, 30.0, 30.0, 250.0, 70.0, 70.0, 20.0, 40.0, 10.0, 20.0, 280.0, 20.0, 160.0, 40.0, 130.0, 60.0, 10.0, 190.0, 220.0, 60.0, 70.0, 70.0, 20.0, 70.0, 0.0, 50.0, 30.0, 20.0, 90.0, 60.0, 160.0, 390.0, 80.0, 20.0, 40.0, 0.0, 90.0, 120.0, 0.0, 70.0, 80.0, 70.0, 40.0, 20.0, 180.0, 160.0, 220.0, 100.0, 410.0, 20.0, -10.0, 120.0, 570.0, 270.0, 210.0, 60.0, 10.0, 30.0, 100.0, 210.0, 20.0, 380.0, 50.0, 20.0, 30.0, 0.0, 400.0, 110.0, 40.0, 60.0, 20.0, 20.0, 160.0, 80.0, 80.0, -40.0, 0.0, 50.0, 120.0, -80.0, 10.0, 0.0, 10.0, 0.0, 60.0, 150.0, -5.0, 0.0, 40.0, 160.0, 80.0, 100.0, 50.0, 150.0, 50.0, 160.0, 0.0, 390.0, 10.0, 300.0, 30.0, 40.0, 100.0, 400.0, 40.0, 40.0, 0.0, 20.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3564830854477474, "mean_inference_ms": 2.1730305158506384, "mean_action_processing_ms": 0.6314748048173634, "mean_env_wait_ms": 2.0360992403005636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012399911880493164, "StateBufferConnector_ms": 0.009945392608642578, "ViewRequirementAgentConnector_ms": 0.37728214263916016}, "num_episodes": 22, "episode_return_max": 1380.0, "episode_return_min": 100.0, "episode_return_mean": 852.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.799768698438005, "num_env_steps_trained_throughput_per_sec": 19.799768698438005, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 199727.606, "restore_workers_time_ms": 0.011, "training_step_time_ms": 199727.562, "sample_time_ms": 2635.202, "learn_time_ms": 197071.693, "learn_throughput": 20.297, "synch_weights_time_ms": 12.47}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 38, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-35-25", "timestamp": 1717220125, "time_this_iter_s": 202.03845882415771, "time_total_s": 10942.264501333237, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f88a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10942.264501333237, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 26.248070175438595, "ram_util_percent": 81.58842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.106931072454483, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.056888209618192, "policy_loss": -0.009244433673261342, "vf_loss": 7.065337912393962, "vf_explained_var": 0.0001052102087912595, "kl": 0.007947309379530207, "entropy": 0.5969085597826904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 361515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 100.0, "episode_reward_mean": 883.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 88.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.0, 1080.0, 440.0, 675.0, 980.0, 645.0, 1200.0, 1030.0, 390.0, 1130.0, 1010.0, 740.0, 1190.0, 990.0, 680.0, 630.0, 610.0, 790.0, 1300.0, 1150.0, 1190.0, 375.0, 1200.0, 1070.0, 575.0, 930.0, 220.0, 770.0, 1305.0, 1340.0, 860.0, 1310.0, 1100.0, 930.0, 210.0, 1015.0, 1100.0, 170.0, 1340.0, 340.0, 1300.0, 1000.0, 460.0, 825.0, 1020.0, 1050.0, 330.0, 620.0, 1260.0, 1150.0, 900.0, 505.0, 870.0, 935.0, 855.0, 920.0, 120.0, 920.0, 330.0, 1080.0, 240.0, 1370.0, 760.0, 1010.0, 880.0, 1260.0, 1160.0, 1130.0, 480.0, 960.0, 1350.0, 1380.0, 1260.0, 550.0, 185.0, 1150.0, 1040.0, 1175.0, 1100.0, 1440.0, 740.0, 1280.0, 1090.0, 1080.0, 250.0, 1340.0, 1130.0, 1240.0, 780.0, 540.0, 1190.0, 715.0, 1480.0, 1160.0, 160.0, 890.0, 590.0, 750.0, 860.0, 655.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 0.0, 10.0, -210.0, 20.0, 20.0, 10.0, 240.0, 10.0, 0.0, 160.0, 30.0, 180.0, 30.0, 10.0, 80.0, 190.0, 390.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 110.0, 70.0, 50.0, 40.0, 20.0, 320.0, 130.0, -130.0, -40.0, 60.0, 160.0, 35.0, 40.0, 10.0, 90.0, 60.0, -50.0, 90.0, 30.0, 260.0, 70.0, 10.0, 390.0, -50.0, 170.0, 0.0, 50.0, -35.0, 10.0, 200.0, 40.0, 0.0, 80.0, 280.0, 20.0, 30.0, 80.0, 80.0, 70.0, 250.0, 100.0, 95.0, 440.0, 50.0, 5.0, 180.0, 100.0, 70.0, -20.0, 90.0, 170.0, 20.0, 10.0, 410.0, 0.0, 10.0, 0.0, 0.0, 160.0, 20.0, 0.0, 40.0, 40.0, 40.0, 80.0, 60.0, 170.0, -30.0, 70.0, 70.0, 190.0, -40.0, 140.0, 20.0, 480.0, 260.0, 40.0, 10.0, 40.0, 10.0, -10.0, 30.0, 160.0, 430.0, 40.0, -30.0, 240.0, 80.0, 70.0, 110.0, 130.0, 20.0, 60.0, 0.0, 60.0, 50.0, 40.0, 520.0, -10.0, 110.0, 110.0, 190.0, 50.0, 60.0, 70.0, 40.0, 30.0, 260.0, 100.0, 40.0, 250.0, -20.0, 10.0, 150.0, 130.0, 30.0, 80.0, 0.0, 50.0, 40.0, 0.0, 0.0, 20.0, 300.0, 160.0, 20.0, 170.0, 80.0, 90.0, 190.0, 30.0, 0.0, 30.0, 20.0, 0.0, -30.0, 70.0, 60.0, 40.0, 200.0, 30.0, 60.0, 100.0, -20.0, 100.0, 60.0, 190.0, 20.0, 80.0, 80.0, 210.0, 0.0, 30.0, 50.0, 70.0, 530.0, 40.0, 60.0, 20.0, 90.0, 140.0, 80.0, 40.0, 280.0, 20.0, 400.0, 110.0, 30.0, 80.0, 30.0, 40.0, 10.0, 20.0, 30.0, 400.0, 40.0, 40.0, 240.0, 80.0, 330.0, 10.0, 270.0, 30.0, 60.0, 90.0, 15.0, 0.0, 50.0, 10.0, 40.0, 0.0, 100.0, 20.0, 90.0, 50.0, 600.0, 50.0, 0.0, 260.0, 180.0, 20.0, 90.0, 40.0, -40.0, 0.0, 200.0, 10.0, 100.0, 70.0, 360.0, 70.0, 120.0, 90.0, 30.0, 20.0, 170.0, -5.0, 60.0, 80.0, 70.0, 20.0, 30.0, 70.0, 30.0, 50.0, 30.0, 70.0, -40.0, 80.0, 40.0, 120.0, 60.0, 350.0, 190.0, 30.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 140.0, 30.0, 90.0, 270.0, 20.0, 40.0, 110.0, 0.0, 30.0, 40.0, 200.0, 20.0, 200.0, 70.0, 190.0, 260.0, 30.0, 35.0, 100.0, 200.0, 30.0, 190.0, 220.0, 390.0, 100.0, 30.0, 80.0, 40.0, 220.0, 40.0, 140.0, 40.0, 230.0, 10.0, 110.0, 30.0, 50.0, 200.0, 50.0, 0.0, 90.0, 440.0, 120.0, 130.0, 180.0, 100.0, -60.0, 10.0, 180.0, 120.0, 30.0, 360.0, 80.0, 150.0, 50.0, 260.0, 10.0, -10.0, 190.0, -20.0, 500.0, 30.0, 110.0, 10.0, 120.0, 90.0, 80.0, -40.0, 30.0, 0.0, 20.0, 150.0, 0.0, 20.0, -70.0, 10.0, 60.0, 10.0, 0.0, 10.0, -20.0, 40.0, 195.0, 70.0, 90.0, 100.0, -20.0, 90.0, 440.0, 30.0, 20.0, 20.0, 90.0, 0.0, 20.0, 270.0, 60.0, 200.0, 70.0, 350.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 80.0, 100.0, 260.0, -10.0, 190.0, 150.0, 60.0, 20.0, 440.0, 50.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 20.0, 110.0, 10.0, 50.0, 80.0, 50.0, 180.0, 50.0, 80.0, 230.0, 200.0, 60.0, 50.0, 320.0, 20.0, 0.0, 290.0, 60.0, 320.0, 0.0, 10.0, 190.0, 40.0, 70.0, 10.0, 30.0, 50.0, 150.0, 20.0, 10.0, 20.0, 70.0, 40.0, 60.0, 20.0, 50.0, 10.0, 25.0, 160.0, 300.0, 20.0, 80.0, 130.0, 30.0, 0.0, 130.0, 130.0, 430.0, 60.0, 90.0, 40.0, 10.0, 110.0, 20.0, 80.0, 90.0, 100.0, 10.0, 70.0, 10.0, 190.0, 60.0, 140.0, 300.0, 30.0, 20.0, 10.0, 90.0, 0.0, 30.0, 40.0, 20.0, 40.0, 50.0, 30.0, 40.0, 0.0, 0.0, 50.0, 80.0, 170.0, 0.0, 40.0, 210.0, 80.0, 10.0, 0.0, 440.0, 120.0, 340.0, 60.0, 80.0, 120.0, 10.0, 90.0, 90.0, 180.0, 90.0, 50.0, 210.0, 30.0, 340.0, 40.0, 30.0, 170.0, 150.0, 0.0, 10.0, 40.0, 0.0, 10.0, 330.0, 40.0, 150.0, 10.0, 5.0, 160.0, 60.0, 0.0, 250.0, 10.0, 0.0, 0.0, 10.0, 350.0, 200.0, 60.0, 120.0, -20.0, 80.0, 25.0, 60.0, 10.0, -15.0, 40.0, -30.0, -15.0, 50.0, 40.0, 110.0, 20.0, 470.0, 250.0, 0.0, 40.0, 0.0, 30.0, 40.0, 30.0, 430.0, 80.0, 30.0, 20.0, 155.0, 40.0, 50.0, 0.0, 120.0, 210.0, -10.0, 110.0, 40.0, 200.0, 160.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 100.0, 170.0, 20.0, 20.0, 70.0, 30.0, 300.0, 170.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 190.0, 100.0, 0.0, 0.0, 20.0, 120.0, 140.0, 190.0, 180.0, 110.0, 280.0, 10.0, 20.0, 10.0, 0.0, 50.0, 20.0, 0.0, 40.0, 60.0, 30.0, 0.0, 10.0, 30.0, 80.0, 40.0, 210.0, 120.0, 250.0, 60.0, 70.0, 40.0, 260.0, 240.0, 230.0, 60.0, 90.0, 80.0, 30.0, 100.0, 100.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 30.0, 30.0, 260.0, 310.0, 80.0, 190.0, 160.0, 20.0, 330.0, 40.0, 70.0, 30.0, 0.0, 160.0, 10.0, 60.0, 40.0, -40.0, 80.0, 80.0, 510.0, 40.0, 160.0, 40.0, 10.0, 340.0, 600.0, 40.0, 30.0, 30.0, 250.0, 70.0, 70.0, 20.0, 40.0, 10.0, 20.0, 280.0, 20.0, 160.0, 40.0, 130.0, 60.0, 10.0, 190.0, 220.0, 60.0, 70.0, 70.0, 20.0, 70.0, 0.0, 50.0, 30.0, 20.0, 90.0, 60.0, 160.0, 390.0, 80.0, 20.0, 40.0, 0.0, 90.0, 120.0, 0.0, 70.0, 80.0, 70.0, 40.0, 20.0, 180.0, 160.0, 220.0, 100.0, 410.0, 20.0, -10.0, 120.0, 570.0, 270.0, 210.0, 60.0, 10.0, 30.0, 100.0, 210.0, 20.0, 380.0, 50.0, 20.0, 30.0, 0.0, 400.0, 110.0, 40.0, 60.0, 20.0, 20.0, 160.0, 80.0, 80.0, -40.0, 0.0, 50.0, 120.0, -80.0, 10.0, 0.0, 10.0, 0.0, 60.0, 150.0, -5.0, 0.0, 40.0, 160.0, 80.0, 100.0, 50.0, 150.0, 50.0, 160.0, 0.0, 390.0, 10.0, 300.0, 30.0, 40.0, 100.0, 400.0, 40.0, 40.0, 0.0, 20.0, 70.0, 200.0, 20.0, 80.0, 35.0, 30.0, 310.0, 270.0, 80.0, 10.0, 140.0, 20.0, 0.0, 60.0, 80.0, 80.0, 230.0, 290.0, 90.0, 60.0, 190.0, 80.0, 400.0, 750.0, 50.0, 30.0, 180.0, 40.0, -60.0, 70.0, -100.0, 0.0, 40.0, 130.0, 140.0, 20.0, 20.0, 340.0, 30.0, 20.0, 0.0, 60.0, 110.0, 340.0, 280.0, 60.0, 10.0, 40.0, 220.0, 70.0, 90.0, 70.0, 30.0, 80.0, 310.0, 110.0, 60.0, 180.0, 70.0, 110.0, 70.0, 420.0, 40.0, 310.0, 60.0, 60.0, 20.0, -30.0, 100.0, 60.0, 40.0, 20.0, 360.0, -10.0, 30.0, 50.0, 30.0, 10.0, 190.0, 40.0, -470.0, 300.0, 80.0, 160.0, 80.0, 90.0, 70.0, 60.0, 200.0, 40.0, 260.0, 20.0, 80.0, 70.0, 310.0, 20.0, 70.0, 210.0, 130.0, 170.0, 50.0, 470.0, 10.0, 200.0, 120.0, 310.0, 30.0, 30.0, 80.0, -60.0, 50.0, 10.0, 260.0, 40.0, 90.0, 10.0, 40.0, 250.0, 20.0, 20.0, 40.0, 10.0, 40.0, 30.0, 100.0, 20.0, 20.0, 30.0, 170.0, 90.0, 30.0, 180.0, 60.0, 210.0, -50.0, 110.0, 50.0, 260.0, 280.0, 20.0, 70.0, 30.0, 100.0, 30.0, 180.0, 150.0, 40.0, 90.0, 25.0, 60.0, 10.0, 60.0, 320.0, 60.0, 390.0, 220.0, 80.0, 90.0, 30.0, 60.0, 170.0, 30.0, 70.0, 150.0, 20.0, 470.0, 90.0, 20.0, 150.0, 80.0, 80.0, 10.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 20.0, 60.0, 0.0, 30.0, 30.0, 110.0, 370.0, -20.0, 150.0, 30.0, -30.0, 220.0, 0.0, 50.0, 200.0, 50.0, 80.0, 0.0, 40.0, 120.0, 10.0, 20.0, 20.0, 40.0, 50.0, 20.0, 150.0, 20.0, 30.0, 290.0, 30.0, 80.0, 40.0, 240.0, 80.0, 20.0, 10.0, 30.0, 100.0, 40.0, 130.0, 40.0, 170.0, 120.0, 30.0, 20.0, 90.0, 40.0, 260.0, 5.0, 40.0, 20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3305479779591285, "mean_inference_ms": 2.151618109383455, "mean_action_processing_ms": 0.6236253316106418, "mean_env_wait_ms": 2.010724420675646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012805461883544922, "StateBufferConnector_ms": 0.009730815887451172, "ViewRequirementAgentConnector_ms": 0.37858152389526367}, "num_episodes": 23, "episode_return_max": 1480.0, "episode_return_min": 100.0, "episode_return_mean": 883.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.21166227872112, "num_env_steps_trained_throughput_per_sec": 20.21166227872112, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 199730.498, "restore_workers_time_ms": 0.011, "training_step_time_ms": 199730.454, "sample_time_ms": 2597.892, "learn_time_ms": 197111.601, "learn_throughput": 20.293, "synch_weights_time_ms": 12.555}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 39, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-38-43", "timestamp": 1717220323, "time_this_iter_s": 197.91246795654297, "time_total_s": 11140.17696928978, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7ef790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11140.17696928978, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 25.09785714285714, "ram_util_percent": 79.2525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3537246239896272, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8548946609131445, "policy_loss": -0.009065998720820433, "vf_loss": 6.863149414478907, "vf_explained_var": 0.0007882069030635781, "kl": 0.008112558276107275, "entropy": 0.5906508032347575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 370905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 120.0, "episode_reward_mean": 920.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 92.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1300.0, 1150.0, 1190.0, 375.0, 1200.0, 1070.0, 575.0, 930.0, 220.0, 770.0, 1305.0, 1340.0, 860.0, 1310.0, 1100.0, 930.0, 210.0, 1015.0, 1100.0, 170.0, 1340.0, 340.0, 1300.0, 1000.0, 460.0, 825.0, 1020.0, 1050.0, 330.0, 620.0, 1260.0, 1150.0, 900.0, 505.0, 870.0, 935.0, 855.0, 920.0, 120.0, 920.0, 330.0, 1080.0, 240.0, 1370.0, 760.0, 1010.0, 880.0, 1260.0, 1160.0, 1130.0, 480.0, 960.0, 1350.0, 1380.0, 1260.0, 550.0, 185.0, 1150.0, 1040.0, 1175.0, 1100.0, 1440.0, 740.0, 1280.0, 1090.0, 1080.0, 250.0, 1340.0, 1130.0, 1240.0, 780.0, 540.0, 1190.0, 715.0, 1480.0, 1160.0, 160.0, 890.0, 590.0, 750.0, 860.0, 655.0, 530.0, 1300.0, 470.0, 1190.0, 1010.0, 1185.0, 1260.0, 810.0, 1185.0, 1055.0, 1260.0, 1270.0, 530.0, 765.0, 1385.0, 710.0, 1030.0, 1050.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [530.0, 40.0, 60.0, 20.0, 90.0, 140.0, 80.0, 40.0, 280.0, 20.0, 400.0, 110.0, 30.0, 80.0, 30.0, 40.0, 10.0, 20.0, 30.0, 400.0, 40.0, 40.0, 240.0, 80.0, 330.0, 10.0, 270.0, 30.0, 60.0, 90.0, 15.0, 0.0, 50.0, 10.0, 40.0, 0.0, 100.0, 20.0, 90.0, 50.0, 600.0, 50.0, 0.0, 260.0, 180.0, 20.0, 90.0, 40.0, -40.0, 0.0, 200.0, 10.0, 100.0, 70.0, 360.0, 70.0, 120.0, 90.0, 30.0, 20.0, 170.0, -5.0, 60.0, 80.0, 70.0, 20.0, 30.0, 70.0, 30.0, 50.0, 30.0, 70.0, -40.0, 80.0, 40.0, 120.0, 60.0, 350.0, 190.0, 30.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 140.0, 30.0, 90.0, 270.0, 20.0, 40.0, 110.0, 0.0, 30.0, 40.0, 200.0, 20.0, 200.0, 70.0, 190.0, 260.0, 30.0, 35.0, 100.0, 200.0, 30.0, 190.0, 220.0, 390.0, 100.0, 30.0, 80.0, 40.0, 220.0, 40.0, 140.0, 40.0, 230.0, 10.0, 110.0, 30.0, 50.0, 200.0, 50.0, 0.0, 90.0, 440.0, 120.0, 130.0, 180.0, 100.0, -60.0, 10.0, 180.0, 120.0, 30.0, 360.0, 80.0, 150.0, 50.0, 260.0, 10.0, -10.0, 190.0, -20.0, 500.0, 30.0, 110.0, 10.0, 120.0, 90.0, 80.0, -40.0, 30.0, 0.0, 20.0, 150.0, 0.0, 20.0, -70.0, 10.0, 60.0, 10.0, 0.0, 10.0, -20.0, 40.0, 195.0, 70.0, 90.0, 100.0, -20.0, 90.0, 440.0, 30.0, 20.0, 20.0, 90.0, 0.0, 20.0, 270.0, 60.0, 200.0, 70.0, 350.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 80.0, 100.0, 260.0, -10.0, 190.0, 150.0, 60.0, 20.0, 440.0, 50.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 20.0, 110.0, 10.0, 50.0, 80.0, 50.0, 180.0, 50.0, 80.0, 230.0, 200.0, 60.0, 50.0, 320.0, 20.0, 0.0, 290.0, 60.0, 320.0, 0.0, 10.0, 190.0, 40.0, 70.0, 10.0, 30.0, 50.0, 150.0, 20.0, 10.0, 20.0, 70.0, 40.0, 60.0, 20.0, 50.0, 10.0, 25.0, 160.0, 300.0, 20.0, 80.0, 130.0, 30.0, 0.0, 130.0, 130.0, 430.0, 60.0, 90.0, 40.0, 10.0, 110.0, 20.0, 80.0, 90.0, 100.0, 10.0, 70.0, 10.0, 190.0, 60.0, 140.0, 300.0, 30.0, 20.0, 10.0, 90.0, 0.0, 30.0, 40.0, 20.0, 40.0, 50.0, 30.0, 40.0, 0.0, 0.0, 50.0, 80.0, 170.0, 0.0, 40.0, 210.0, 80.0, 10.0, 0.0, 440.0, 120.0, 340.0, 60.0, 80.0, 120.0, 10.0, 90.0, 90.0, 180.0, 90.0, 50.0, 210.0, 30.0, 340.0, 40.0, 30.0, 170.0, 150.0, 0.0, 10.0, 40.0, 0.0, 10.0, 330.0, 40.0, 150.0, 10.0, 5.0, 160.0, 60.0, 0.0, 250.0, 10.0, 0.0, 0.0, 10.0, 350.0, 200.0, 60.0, 120.0, -20.0, 80.0, 25.0, 60.0, 10.0, -15.0, 40.0, -30.0, -15.0, 50.0, 40.0, 110.0, 20.0, 470.0, 250.0, 0.0, 40.0, 0.0, 30.0, 40.0, 30.0, 430.0, 80.0, 30.0, 20.0, 155.0, 40.0, 50.0, 0.0, 120.0, 210.0, -10.0, 110.0, 40.0, 200.0, 160.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 100.0, 170.0, 20.0, 20.0, 70.0, 30.0, 300.0, 170.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 190.0, 100.0, 0.0, 0.0, 20.0, 120.0, 140.0, 190.0, 180.0, 110.0, 280.0, 10.0, 20.0, 10.0, 0.0, 50.0, 20.0, 0.0, 40.0, 60.0, 30.0, 0.0, 10.0, 30.0, 80.0, 40.0, 210.0, 120.0, 250.0, 60.0, 70.0, 40.0, 260.0, 240.0, 230.0, 60.0, 90.0, 80.0, 30.0, 100.0, 100.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 30.0, 30.0, 260.0, 310.0, 80.0, 190.0, 160.0, 20.0, 330.0, 40.0, 70.0, 30.0, 0.0, 160.0, 10.0, 60.0, 40.0, -40.0, 80.0, 80.0, 510.0, 40.0, 160.0, 40.0, 10.0, 340.0, 600.0, 40.0, 30.0, 30.0, 250.0, 70.0, 70.0, 20.0, 40.0, 10.0, 20.0, 280.0, 20.0, 160.0, 40.0, 130.0, 60.0, 10.0, 190.0, 220.0, 60.0, 70.0, 70.0, 20.0, 70.0, 0.0, 50.0, 30.0, 20.0, 90.0, 60.0, 160.0, 390.0, 80.0, 20.0, 40.0, 0.0, 90.0, 120.0, 0.0, 70.0, 80.0, 70.0, 40.0, 20.0, 180.0, 160.0, 220.0, 100.0, 410.0, 20.0, -10.0, 120.0, 570.0, 270.0, 210.0, 60.0, 10.0, 30.0, 100.0, 210.0, 20.0, 380.0, 50.0, 20.0, 30.0, 0.0, 400.0, 110.0, 40.0, 60.0, 20.0, 20.0, 160.0, 80.0, 80.0, -40.0, 0.0, 50.0, 120.0, -80.0, 10.0, 0.0, 10.0, 0.0, 60.0, 150.0, -5.0, 0.0, 40.0, 160.0, 80.0, 100.0, 50.0, 150.0, 50.0, 160.0, 0.0, 390.0, 10.0, 300.0, 30.0, 40.0, 100.0, 400.0, 40.0, 40.0, 0.0, 20.0, 70.0, 200.0, 20.0, 80.0, 35.0, 30.0, 310.0, 270.0, 80.0, 10.0, 140.0, 20.0, 0.0, 60.0, 80.0, 80.0, 230.0, 290.0, 90.0, 60.0, 190.0, 80.0, 400.0, 750.0, 50.0, 30.0, 180.0, 40.0, -60.0, 70.0, -100.0, 0.0, 40.0, 130.0, 140.0, 20.0, 20.0, 340.0, 30.0, 20.0, 0.0, 60.0, 110.0, 340.0, 280.0, 60.0, 10.0, 40.0, 220.0, 70.0, 90.0, 70.0, 30.0, 80.0, 310.0, 110.0, 60.0, 180.0, 70.0, 110.0, 70.0, 420.0, 40.0, 310.0, 60.0, 60.0, 20.0, -30.0, 100.0, 60.0, 40.0, 20.0, 360.0, -10.0, 30.0, 50.0, 30.0, 10.0, 190.0, 40.0, -470.0, 300.0, 80.0, 160.0, 80.0, 90.0, 70.0, 60.0, 200.0, 40.0, 260.0, 20.0, 80.0, 70.0, 310.0, 20.0, 70.0, 210.0, 130.0, 170.0, 50.0, 470.0, 10.0, 200.0, 120.0, 310.0, 30.0, 30.0, 80.0, -60.0, 50.0, 10.0, 260.0, 40.0, 90.0, 10.0, 40.0, 250.0, 20.0, 20.0, 40.0, 10.0, 40.0, 30.0, 100.0, 20.0, 20.0, 30.0, 170.0, 90.0, 30.0, 180.0, 60.0, 210.0, -50.0, 110.0, 50.0, 260.0, 280.0, 20.0, 70.0, 30.0, 100.0, 30.0, 180.0, 150.0, 40.0, 90.0, 25.0, 60.0, 10.0, 60.0, 320.0, 60.0, 390.0, 220.0, 80.0, 90.0, 30.0, 60.0, 170.0, 30.0, 70.0, 150.0, 20.0, 470.0, 90.0, 20.0, 150.0, 80.0, 80.0, 10.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 20.0, 60.0, 0.0, 30.0, 30.0, 110.0, 370.0, -20.0, 150.0, 30.0, -30.0, 220.0, 0.0, 50.0, 200.0, 50.0, 80.0, 0.0, 40.0, 120.0, 10.0, 20.0, 20.0, 40.0, 50.0, 20.0, 150.0, 20.0, 30.0, 290.0, 30.0, 80.0, 40.0, 240.0, 80.0, 20.0, 10.0, 30.0, 100.0, 40.0, 130.0, 40.0, 170.0, 120.0, 30.0, 20.0, 90.0, 40.0, 260.0, 5.0, 40.0, 20.0, 30.0, 150.0, 30.0, 20.0, 100.0, 20.0, -20.0, 10.0, 30.0, 100.0, 90.0, -20.0, 320.0, 170.0, 170.0, 30.0, 70.0, 60.0, 10.0, 60.0, 430.0, 10.0, 170.0, 10.0, 160.0, 40.0, 10.0, 20.0, 10.0, 10.0, 30.0, 360.0, 70.0, 90.0, 310.0, 80.0, 140.0, 30.0, -110.0, 70.0, 150.0, 30.0, 180.0, -50.0, -20.0, 190.0, 310.0, 110.0, 50.0, 20.0, 190.0, 150.0, 160.0, 480.0, 30.0, 80.0, 110.0, 30.0, 15.0, 80.0, 50.0, 50.0, 210.0, -30.0, 0.0, 450.0, 150.0, 30.0, 140.0, 70.0, 190.0, 10.0, 0.0, 20.0, 100.0, 40.0, 80.0, 310.0, 10.0, 200.0, 40.0, 10.0, 70.0, 570.0, 260.0, 40.0, 5.0, 40.0, 70.0, 60.0, 60.0, 0.0, 290.0, 80.0, 80.0, 40.0, -10.0, 25.0, 170.0, 90.0, 290.0, 30.0, 140.0, 20.0, 190.0, 580.0, 70.0, 90.0, 30.0, 80.0, 30.0, 220.0, 100.0, 30.0, 390.0, 300.0, 20.0, -30.0, 40.0, 150.0, 50.0, 20.0, 80.0, 10.0, 160.0, 30.0, 130.0, 50.0, 10.0, 40.0, 0.0, 20.0, 40.0, 120.0, 30.0, 90.0, 110.0, 50.0, 40.0, 265.0, 0.0, 320.0, 20.0, 70.0, 205.0, 190.0, 50.0, 190.0, 250.0, 40.0, 50.0, 50.0, 130.0, 100.0, 30.0, 0.0, 10.0, 30.0, 20.0, 300.0, 40.0, 300.0, 80.0, 270.0, 90.0, 20.0, 70.0, 30.0, 80.0, 50.0, 40.0, 260.0, 100.0, 10.0, 150.0, 20.0, 190.0, 150.0, 50.0, 100.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.311491768881502, "mean_inference_ms": 2.1356757639250525, "mean_action_processing_ms": 0.6177551580695642, "mean_env_wait_ms": 1.991673855535127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012621402740478516, "StateBufferConnector_ms": 0.009778738021850586, "ViewRequirementAgentConnector_ms": 0.37511110305786133}, "num_episodes": 18, "episode_return_max": 1480.0, "episode_return_min": 120.0, "episode_return_mean": 920.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.939119308960215, "num_env_steps_trained_throughput_per_sec": 19.939119308960215, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 199843.495, "restore_workers_time_ms": 0.012, "training_step_time_ms": 199843.45, "sample_time_ms": 2608.313, "learn_time_ms": 197214.233, "learn_throughput": 20.283, "synch_weights_time_ms": 12.467}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 40, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-42-03", "timestamp": 1717220523, "time_this_iter_s": 200.61646604537964, "time_total_s": 11340.79343533516, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f84f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11340.79343533516, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.490140845070425, "ram_util_percent": 81.78204225352114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.400216850743126, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.071082224911902, "policy_loss": -0.008408091460251477, "vf_loss": 6.078658434224967, "vf_explained_var": 0.0005578266736417533, "kl": 0.00831879369733849, "entropy": 0.6254471358907616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 380295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 120.0, "episode_reward_mean": 900.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 90.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1100.0, 170.0, 1340.0, 340.0, 1300.0, 1000.0, 460.0, 825.0, 1020.0, 1050.0, 330.0, 620.0, 1260.0, 1150.0, 900.0, 505.0, 870.0, 935.0, 855.0, 920.0, 120.0, 920.0, 330.0, 1080.0, 240.0, 1370.0, 760.0, 1010.0, 880.0, 1260.0, 1160.0, 1130.0, 480.0, 960.0, 1350.0, 1380.0, 1260.0, 550.0, 185.0, 1150.0, 1040.0, 1175.0, 1100.0, 1440.0, 740.0, 1280.0, 1090.0, 1080.0, 250.0, 1340.0, 1130.0, 1240.0, 780.0, 540.0, 1190.0, 715.0, 1480.0, 1160.0, 160.0, 890.0, 590.0, 750.0, 860.0, 655.0, 530.0, 1300.0, 470.0, 1190.0, 1010.0, 1185.0, 1260.0, 810.0, 1185.0, 1055.0, 1260.0, 1270.0, 530.0, 765.0, 1385.0, 710.0, 1030.0, 1050.0, 1420.0, 1790.0, 550.0, 230.0, 940.0, 790.0, 500.0, 610.0, 1220.0, 300.0, 650.0, 1055.0, 620.0, 130.0, 1110.0, 1450.0, 1060.0, 450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 20.0, 90.0, 0.0, 20.0, 270.0, 60.0, 200.0, 70.0, 350.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 80.0, 100.0, 260.0, -10.0, 190.0, 150.0, 60.0, 20.0, 440.0, 50.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 20.0, 110.0, 10.0, 50.0, 80.0, 50.0, 180.0, 50.0, 80.0, 230.0, 200.0, 60.0, 50.0, 320.0, 20.0, 0.0, 290.0, 60.0, 320.0, 0.0, 10.0, 190.0, 40.0, 70.0, 10.0, 30.0, 50.0, 150.0, 20.0, 10.0, 20.0, 70.0, 40.0, 60.0, 20.0, 50.0, 10.0, 25.0, 160.0, 300.0, 20.0, 80.0, 130.0, 30.0, 0.0, 130.0, 130.0, 430.0, 60.0, 90.0, 40.0, 10.0, 110.0, 20.0, 80.0, 90.0, 100.0, 10.0, 70.0, 10.0, 190.0, 60.0, 140.0, 300.0, 30.0, 20.0, 10.0, 90.0, 0.0, 30.0, 40.0, 20.0, 40.0, 50.0, 30.0, 40.0, 0.0, 0.0, 50.0, 80.0, 170.0, 0.0, 40.0, 210.0, 80.0, 10.0, 0.0, 440.0, 120.0, 340.0, 60.0, 80.0, 120.0, 10.0, 90.0, 90.0, 180.0, 90.0, 50.0, 210.0, 30.0, 340.0, 40.0, 30.0, 170.0, 150.0, 0.0, 10.0, 40.0, 0.0, 10.0, 330.0, 40.0, 150.0, 10.0, 5.0, 160.0, 60.0, 0.0, 250.0, 10.0, 0.0, 0.0, 10.0, 350.0, 200.0, 60.0, 120.0, -20.0, 80.0, 25.0, 60.0, 10.0, -15.0, 40.0, -30.0, -15.0, 50.0, 40.0, 110.0, 20.0, 470.0, 250.0, 0.0, 40.0, 0.0, 30.0, 40.0, 30.0, 430.0, 80.0, 30.0, 20.0, 155.0, 40.0, 50.0, 0.0, 120.0, 210.0, -10.0, 110.0, 40.0, 200.0, 160.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 100.0, 170.0, 20.0, 20.0, 70.0, 30.0, 300.0, 170.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 190.0, 100.0, 0.0, 0.0, 20.0, 120.0, 140.0, 190.0, 180.0, 110.0, 280.0, 10.0, 20.0, 10.0, 0.0, 50.0, 20.0, 0.0, 40.0, 60.0, 30.0, 0.0, 10.0, 30.0, 80.0, 40.0, 210.0, 120.0, 250.0, 60.0, 70.0, 40.0, 260.0, 240.0, 230.0, 60.0, 90.0, 80.0, 30.0, 100.0, 100.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 30.0, 30.0, 260.0, 310.0, 80.0, 190.0, 160.0, 20.0, 330.0, 40.0, 70.0, 30.0, 0.0, 160.0, 10.0, 60.0, 40.0, -40.0, 80.0, 80.0, 510.0, 40.0, 160.0, 40.0, 10.0, 340.0, 600.0, 40.0, 30.0, 30.0, 250.0, 70.0, 70.0, 20.0, 40.0, 10.0, 20.0, 280.0, 20.0, 160.0, 40.0, 130.0, 60.0, 10.0, 190.0, 220.0, 60.0, 70.0, 70.0, 20.0, 70.0, 0.0, 50.0, 30.0, 20.0, 90.0, 60.0, 160.0, 390.0, 80.0, 20.0, 40.0, 0.0, 90.0, 120.0, 0.0, 70.0, 80.0, 70.0, 40.0, 20.0, 180.0, 160.0, 220.0, 100.0, 410.0, 20.0, -10.0, 120.0, 570.0, 270.0, 210.0, 60.0, 10.0, 30.0, 100.0, 210.0, 20.0, 380.0, 50.0, 20.0, 30.0, 0.0, 400.0, 110.0, 40.0, 60.0, 20.0, 20.0, 160.0, 80.0, 80.0, -40.0, 0.0, 50.0, 120.0, -80.0, 10.0, 0.0, 10.0, 0.0, 60.0, 150.0, -5.0, 0.0, 40.0, 160.0, 80.0, 100.0, 50.0, 150.0, 50.0, 160.0, 0.0, 390.0, 10.0, 300.0, 30.0, 40.0, 100.0, 400.0, 40.0, 40.0, 0.0, 20.0, 70.0, 200.0, 20.0, 80.0, 35.0, 30.0, 310.0, 270.0, 80.0, 10.0, 140.0, 20.0, 0.0, 60.0, 80.0, 80.0, 230.0, 290.0, 90.0, 60.0, 190.0, 80.0, 400.0, 750.0, 50.0, 30.0, 180.0, 40.0, -60.0, 70.0, -100.0, 0.0, 40.0, 130.0, 140.0, 20.0, 20.0, 340.0, 30.0, 20.0, 0.0, 60.0, 110.0, 340.0, 280.0, 60.0, 10.0, 40.0, 220.0, 70.0, 90.0, 70.0, 30.0, 80.0, 310.0, 110.0, 60.0, 180.0, 70.0, 110.0, 70.0, 420.0, 40.0, 310.0, 60.0, 60.0, 20.0, -30.0, 100.0, 60.0, 40.0, 20.0, 360.0, -10.0, 30.0, 50.0, 30.0, 10.0, 190.0, 40.0, -470.0, 300.0, 80.0, 160.0, 80.0, 90.0, 70.0, 60.0, 200.0, 40.0, 260.0, 20.0, 80.0, 70.0, 310.0, 20.0, 70.0, 210.0, 130.0, 170.0, 50.0, 470.0, 10.0, 200.0, 120.0, 310.0, 30.0, 30.0, 80.0, -60.0, 50.0, 10.0, 260.0, 40.0, 90.0, 10.0, 40.0, 250.0, 20.0, 20.0, 40.0, 10.0, 40.0, 30.0, 100.0, 20.0, 20.0, 30.0, 170.0, 90.0, 30.0, 180.0, 60.0, 210.0, -50.0, 110.0, 50.0, 260.0, 280.0, 20.0, 70.0, 30.0, 100.0, 30.0, 180.0, 150.0, 40.0, 90.0, 25.0, 60.0, 10.0, 60.0, 320.0, 60.0, 390.0, 220.0, 80.0, 90.0, 30.0, 60.0, 170.0, 30.0, 70.0, 150.0, 20.0, 470.0, 90.0, 20.0, 150.0, 80.0, 80.0, 10.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 20.0, 60.0, 0.0, 30.0, 30.0, 110.0, 370.0, -20.0, 150.0, 30.0, -30.0, 220.0, 0.0, 50.0, 200.0, 50.0, 80.0, 0.0, 40.0, 120.0, 10.0, 20.0, 20.0, 40.0, 50.0, 20.0, 150.0, 20.0, 30.0, 290.0, 30.0, 80.0, 40.0, 240.0, 80.0, 20.0, 10.0, 30.0, 100.0, 40.0, 130.0, 40.0, 170.0, 120.0, 30.0, 20.0, 90.0, 40.0, 260.0, 5.0, 40.0, 20.0, 30.0, 150.0, 30.0, 20.0, 100.0, 20.0, -20.0, 10.0, 30.0, 100.0, 90.0, -20.0, 320.0, 170.0, 170.0, 30.0, 70.0, 60.0, 10.0, 60.0, 430.0, 10.0, 170.0, 10.0, 160.0, 40.0, 10.0, 20.0, 10.0, 10.0, 30.0, 360.0, 70.0, 90.0, 310.0, 80.0, 140.0, 30.0, -110.0, 70.0, 150.0, 30.0, 180.0, -50.0, -20.0, 190.0, 310.0, 110.0, 50.0, 20.0, 190.0, 150.0, 160.0, 480.0, 30.0, 80.0, 110.0, 30.0, 15.0, 80.0, 50.0, 50.0, 210.0, -30.0, 0.0, 450.0, 150.0, 30.0, 140.0, 70.0, 190.0, 10.0, 0.0, 20.0, 100.0, 40.0, 80.0, 310.0, 10.0, 200.0, 40.0, 10.0, 70.0, 570.0, 260.0, 40.0, 5.0, 40.0, 70.0, 60.0, 60.0, 0.0, 290.0, 80.0, 80.0, 40.0, -10.0, 25.0, 170.0, 90.0, 290.0, 30.0, 140.0, 20.0, 190.0, 580.0, 70.0, 90.0, 30.0, 80.0, 30.0, 220.0, 100.0, 30.0, 390.0, 300.0, 20.0, -30.0, 40.0, 150.0, 50.0, 20.0, 80.0, 10.0, 160.0, 30.0, 130.0, 50.0, 10.0, 40.0, 0.0, 20.0, 40.0, 120.0, 30.0, 90.0, 110.0, 50.0, 40.0, 265.0, 0.0, 320.0, 20.0, 70.0, 205.0, 190.0, 50.0, 190.0, 250.0, 40.0, 50.0, 50.0, 130.0, 100.0, 30.0, 0.0, 10.0, 30.0, 20.0, 300.0, 40.0, 300.0, 80.0, 270.0, 90.0, 20.0, 70.0, 30.0, 80.0, 50.0, 40.0, 260.0, 100.0, 10.0, 150.0, 20.0, 190.0, 150.0, 50.0, 100.0, 20.0, 140.0, 140.0, 60.0, 30.0, 150.0, 180.0, 360.0, 70.0, 200.0, 90.0, 270.0, 90.0, 80.0, 50.0, 190.0, 170.0, 160.0, 380.0, 310.0, 90.0, 110.0, 0.0, 40.0, -140.0, 0.0, 30.0, 10.0, 10.0, 150.0, 340.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 60.0, 10.0, 70.0, 100.0, 40.0, 160.0, 220.0, 190.0, 10.0, 30.0, 70.0, 50.0, 50.0, 70.0, 230.0, -90.0, 200.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, -90.0, 200.0, 60.0, 60.0, -350.0, 60.0, 150.0, 150.0, 220.0, 70.0, 20.0, 170.0, 30.0, 30.0, 40.0, 40.0, 50.0, 170.0, -10.0, 60.0, 200.0, 100.0, 300.0, 260.0, 70.0, 60.0, 90.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 150.0, 0.0, 10.0, 20.0, 90.0, 230.0, 130.0, 30.0, 10.0, 30.0, 50.0, 100.0, 0.0, 0.0, 70.0, 40.0, 80.0, 220.0, 65.0, 150.0, 310.0, 30.0, 80.0, 60.0, 20.0, 260.0, 20.0, 30.0, 20.0, 20.0, 170.0, 10.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, -30.0, 0.0, 80.0, 0.0, 0.0, 100.0, 450.0, 70.0, 50.0, 40.0, 10.0, 70.0, 60.0, 170.0, 90.0, 10.0, -40.0, 60.0, 10.0, 580.0, 300.0, 200.0, 80.0, 190.0, 60.0, 80.0, 40.0, 220.0, 40.0, 360.0, 20.0, 30.0, 150.0, 30.0, 90.0, 20.0, 10.0, 10.0, 250.0, 0.0, 40.0, 30.0, 40.0, 40.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2934743978424814, "mean_inference_ms": 2.1208940350045538, "mean_action_processing_ms": 0.6122117064418685, "mean_env_wait_ms": 1.9735403457224212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012499094009399414, "StateBufferConnector_ms": 0.009623527526855469, "ViewRequirementAgentConnector_ms": 0.368680477142334}, "num_episodes": 18, "episode_return_max": 1790.0, "episode_return_min": 120.0, "episode_return_mean": 900.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.03302955912413, "num_env_steps_trained_throughput_per_sec": 20.03302955912413, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 1640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1640000, "timers": {"training_iteration_time_ms": 199705.525, "restore_workers_time_ms": 0.012, "training_step_time_ms": 199705.48, "sample_time_ms": 2589.553, "learn_time_ms": 197095.394, "learn_throughput": 20.295, "synch_weights_time_ms": 11.994}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "done": false, "training_iteration": 41, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-45-23", "timestamp": 1717220723, "time_this_iter_s": 199.67806315422058, "time_total_s": 11540.47149848938, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x2984ef9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11540.47149848938, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 25.636170212765958, "ram_util_percent": 80.02872340425532}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6502514234429606, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.423755223504778, "policy_loss": -0.009131847728957265, "vf_loss": 6.43209973016359, "vf_explained_var": 0.0021559779953778868, "kl": 0.007873399512716041, "entropy": 0.5658084512899478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 389685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 120.0, "episode_reward_mean": 896.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 89.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [855.0, 920.0, 120.0, 920.0, 330.0, 1080.0, 240.0, 1370.0, 760.0, 1010.0, 880.0, 1260.0, 1160.0, 1130.0, 480.0, 960.0, 1350.0, 1380.0, 1260.0, 550.0, 185.0, 1150.0, 1040.0, 1175.0, 1100.0, 1440.0, 740.0, 1280.0, 1090.0, 1080.0, 250.0, 1340.0, 1130.0, 1240.0, 780.0, 540.0, 1190.0, 715.0, 1480.0, 1160.0, 160.0, 890.0, 590.0, 750.0, 860.0, 655.0, 530.0, 1300.0, 470.0, 1190.0, 1010.0, 1185.0, 1260.0, 810.0, 1185.0, 1055.0, 1260.0, 1270.0, 530.0, 765.0, 1385.0, 710.0, 1030.0, 1050.0, 1420.0, 1790.0, 550.0, 230.0, 940.0, 790.0, 500.0, 610.0, 1220.0, 300.0, 650.0, 1055.0, 620.0, 130.0, 1110.0, 1450.0, 1060.0, 450.0, 1455.0, 1390.0, 980.0, 1160.0, 530.0, 1140.0, 1170.0, 1290.0, 790.0, 580.0, 995.0, 970.0, 180.0, 230.0, 500.0, 535.0, 300.0, 550.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 0.0, 30.0, 40.0, 30.0, 430.0, 80.0, 30.0, 20.0, 155.0, 40.0, 50.0, 0.0, 120.0, 210.0, -10.0, 110.0, 40.0, 200.0, 160.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 100.0, 170.0, 20.0, 20.0, 70.0, 30.0, 300.0, 170.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 190.0, 100.0, 0.0, 0.0, 20.0, 120.0, 140.0, 190.0, 180.0, 110.0, 280.0, 10.0, 20.0, 10.0, 0.0, 50.0, 20.0, 0.0, 40.0, 60.0, 30.0, 0.0, 10.0, 30.0, 80.0, 40.0, 210.0, 120.0, 250.0, 60.0, 70.0, 40.0, 260.0, 240.0, 230.0, 60.0, 90.0, 80.0, 30.0, 100.0, 100.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 30.0, 30.0, 260.0, 310.0, 80.0, 190.0, 160.0, 20.0, 330.0, 40.0, 70.0, 30.0, 0.0, 160.0, 10.0, 60.0, 40.0, -40.0, 80.0, 80.0, 510.0, 40.0, 160.0, 40.0, 10.0, 340.0, 600.0, 40.0, 30.0, 30.0, 250.0, 70.0, 70.0, 20.0, 40.0, 10.0, 20.0, 280.0, 20.0, 160.0, 40.0, 130.0, 60.0, 10.0, 190.0, 220.0, 60.0, 70.0, 70.0, 20.0, 70.0, 0.0, 50.0, 30.0, 20.0, 90.0, 60.0, 160.0, 390.0, 80.0, 20.0, 40.0, 0.0, 90.0, 120.0, 0.0, 70.0, 80.0, 70.0, 40.0, 20.0, 180.0, 160.0, 220.0, 100.0, 410.0, 20.0, -10.0, 120.0, 570.0, 270.0, 210.0, 60.0, 10.0, 30.0, 100.0, 210.0, 20.0, 380.0, 50.0, 20.0, 30.0, 0.0, 400.0, 110.0, 40.0, 60.0, 20.0, 20.0, 160.0, 80.0, 80.0, -40.0, 0.0, 50.0, 120.0, -80.0, 10.0, 0.0, 10.0, 0.0, 60.0, 150.0, -5.0, 0.0, 40.0, 160.0, 80.0, 100.0, 50.0, 150.0, 50.0, 160.0, 0.0, 390.0, 10.0, 300.0, 30.0, 40.0, 100.0, 400.0, 40.0, 40.0, 0.0, 20.0, 70.0, 200.0, 20.0, 80.0, 35.0, 30.0, 310.0, 270.0, 80.0, 10.0, 140.0, 20.0, 0.0, 60.0, 80.0, 80.0, 230.0, 290.0, 90.0, 60.0, 190.0, 80.0, 400.0, 750.0, 50.0, 30.0, 180.0, 40.0, -60.0, 70.0, -100.0, 0.0, 40.0, 130.0, 140.0, 20.0, 20.0, 340.0, 30.0, 20.0, 0.0, 60.0, 110.0, 340.0, 280.0, 60.0, 10.0, 40.0, 220.0, 70.0, 90.0, 70.0, 30.0, 80.0, 310.0, 110.0, 60.0, 180.0, 70.0, 110.0, 70.0, 420.0, 40.0, 310.0, 60.0, 60.0, 20.0, -30.0, 100.0, 60.0, 40.0, 20.0, 360.0, -10.0, 30.0, 50.0, 30.0, 10.0, 190.0, 40.0, -470.0, 300.0, 80.0, 160.0, 80.0, 90.0, 70.0, 60.0, 200.0, 40.0, 260.0, 20.0, 80.0, 70.0, 310.0, 20.0, 70.0, 210.0, 130.0, 170.0, 50.0, 470.0, 10.0, 200.0, 120.0, 310.0, 30.0, 30.0, 80.0, -60.0, 50.0, 10.0, 260.0, 40.0, 90.0, 10.0, 40.0, 250.0, 20.0, 20.0, 40.0, 10.0, 40.0, 30.0, 100.0, 20.0, 20.0, 30.0, 170.0, 90.0, 30.0, 180.0, 60.0, 210.0, -50.0, 110.0, 50.0, 260.0, 280.0, 20.0, 70.0, 30.0, 100.0, 30.0, 180.0, 150.0, 40.0, 90.0, 25.0, 60.0, 10.0, 60.0, 320.0, 60.0, 390.0, 220.0, 80.0, 90.0, 30.0, 60.0, 170.0, 30.0, 70.0, 150.0, 20.0, 470.0, 90.0, 20.0, 150.0, 80.0, 80.0, 10.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 20.0, 60.0, 0.0, 30.0, 30.0, 110.0, 370.0, -20.0, 150.0, 30.0, -30.0, 220.0, 0.0, 50.0, 200.0, 50.0, 80.0, 0.0, 40.0, 120.0, 10.0, 20.0, 20.0, 40.0, 50.0, 20.0, 150.0, 20.0, 30.0, 290.0, 30.0, 80.0, 40.0, 240.0, 80.0, 20.0, 10.0, 30.0, 100.0, 40.0, 130.0, 40.0, 170.0, 120.0, 30.0, 20.0, 90.0, 40.0, 260.0, 5.0, 40.0, 20.0, 30.0, 150.0, 30.0, 20.0, 100.0, 20.0, -20.0, 10.0, 30.0, 100.0, 90.0, -20.0, 320.0, 170.0, 170.0, 30.0, 70.0, 60.0, 10.0, 60.0, 430.0, 10.0, 170.0, 10.0, 160.0, 40.0, 10.0, 20.0, 10.0, 10.0, 30.0, 360.0, 70.0, 90.0, 310.0, 80.0, 140.0, 30.0, -110.0, 70.0, 150.0, 30.0, 180.0, -50.0, -20.0, 190.0, 310.0, 110.0, 50.0, 20.0, 190.0, 150.0, 160.0, 480.0, 30.0, 80.0, 110.0, 30.0, 15.0, 80.0, 50.0, 50.0, 210.0, -30.0, 0.0, 450.0, 150.0, 30.0, 140.0, 70.0, 190.0, 10.0, 0.0, 20.0, 100.0, 40.0, 80.0, 310.0, 10.0, 200.0, 40.0, 10.0, 70.0, 570.0, 260.0, 40.0, 5.0, 40.0, 70.0, 60.0, 60.0, 0.0, 290.0, 80.0, 80.0, 40.0, -10.0, 25.0, 170.0, 90.0, 290.0, 30.0, 140.0, 20.0, 190.0, 580.0, 70.0, 90.0, 30.0, 80.0, 30.0, 220.0, 100.0, 30.0, 390.0, 300.0, 20.0, -30.0, 40.0, 150.0, 50.0, 20.0, 80.0, 10.0, 160.0, 30.0, 130.0, 50.0, 10.0, 40.0, 0.0, 20.0, 40.0, 120.0, 30.0, 90.0, 110.0, 50.0, 40.0, 265.0, 0.0, 320.0, 20.0, 70.0, 205.0, 190.0, 50.0, 190.0, 250.0, 40.0, 50.0, 50.0, 130.0, 100.0, 30.0, 0.0, 10.0, 30.0, 20.0, 300.0, 40.0, 300.0, 80.0, 270.0, 90.0, 20.0, 70.0, 30.0, 80.0, 50.0, 40.0, 260.0, 100.0, 10.0, 150.0, 20.0, 190.0, 150.0, 50.0, 100.0, 20.0, 140.0, 140.0, 60.0, 30.0, 150.0, 180.0, 360.0, 70.0, 200.0, 90.0, 270.0, 90.0, 80.0, 50.0, 190.0, 170.0, 160.0, 380.0, 310.0, 90.0, 110.0, 0.0, 40.0, -140.0, 0.0, 30.0, 10.0, 10.0, 150.0, 340.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 60.0, 10.0, 70.0, 100.0, 40.0, 160.0, 220.0, 190.0, 10.0, 30.0, 70.0, 50.0, 50.0, 70.0, 230.0, -90.0, 200.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, -90.0, 200.0, 60.0, 60.0, -350.0, 60.0, 150.0, 150.0, 220.0, 70.0, 20.0, 170.0, 30.0, 30.0, 40.0, 40.0, 50.0, 170.0, -10.0, 60.0, 200.0, 100.0, 300.0, 260.0, 70.0, 60.0, 90.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 150.0, 0.0, 10.0, 20.0, 90.0, 230.0, 130.0, 30.0, 10.0, 30.0, 50.0, 100.0, 0.0, 0.0, 70.0, 40.0, 80.0, 220.0, 65.0, 150.0, 310.0, 30.0, 80.0, 60.0, 20.0, 260.0, 20.0, 30.0, 20.0, 20.0, 170.0, 10.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, -30.0, 0.0, 80.0, 0.0, 0.0, 100.0, 450.0, 70.0, 50.0, 40.0, 10.0, 70.0, 60.0, 170.0, 90.0, 10.0, -40.0, 60.0, 10.0, 580.0, 300.0, 200.0, 80.0, 190.0, 60.0, 80.0, 40.0, 220.0, 40.0, 360.0, 20.0, 30.0, 150.0, 30.0, 90.0, 20.0, 10.0, 10.0, 250.0, 0.0, 40.0, 30.0, 40.0, 40.0, 10.0, -10.0, 20.0, 60.0, 120.0, 270.0, 180.0, 240.0, 25.0, 50.0, 500.0, 180.0, 120.0, 240.0, 60.0, 110.0, 30.0, 310.0, 140.0, 30.0, 170.0, 40.0, 50.0, 0.0, 30.0, 30.0, 100.0, 570.0, 60.0, 50.0, 50.0, 470.0, 130.0, 160.0, 70.0, 30.0, 0.0, -10.0, 110.0, 30.0, 170.0, 260.0, 50.0, 40.0, 10.0, 30.0, 20.0, 10.0, 10.0, 80.0, 20.0, 120.0, 80.0, 60.0, 60.0, 40.0, 10.0, 160.0, 330.0, 120.0, 160.0, 0.0, 360.0, 20.0, 150.0, 0.0, 110.0, 210.0, 10.0, 60.0, 250.0, 10.0, 470.0, 370.0, 20.0, 0.0, -10.0, 40.0, 100.0, 220.0, 70.0, 180.0, 20.0, 60.0, 20.0, 30.0, 90.0, 40.0, 250.0, 30.0, 70.0, 20.0, 210.0, 110.0, 50.0, 30.0, 10.0, 80.0, 0.0, 50.0, 20.0, 60.0, 40.0, 0.0, 370.0, 150.0, 25.0, 0.0, 60.0, 270.0, 20.0, 50.0, 60.0, 30.0, 360.0, 10.0, 380.0, -40.0, 50.0, -30.0, 100.0, 40.0, 0.0, 60.0, 10.0, 20.0, 10.0, 20.0, 40.0, -50.0, 30.0, 110.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 10.0, 60.0, 30.0, 70.0, 120.0, 80.0, 40.0, 20.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 10.0, 95.0, 160.0, 100.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 190.0, 0.0, 60.0, 60.0, 0.0, 50.0, 0.0, 60.0, 10.0, 290.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2765767079115995, "mean_inference_ms": 2.1072328564482854, "mean_action_processing_ms": 0.6070430171982566, "mean_env_wait_ms": 1.9566622390178383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012480735778808594, "StateBufferConnector_ms": 0.009773492813110352, "ViewRequirementAgentConnector_ms": 0.37973928451538086}, "num_episodes": 18, "episode_return_max": 1790.0, "episode_return_min": 120.0, "episode_return_mean": 896.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.07707950759668, "num_env_steps_trained_throughput_per_sec": 20.07707950759668, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 199741.984, "restore_workers_time_ms": 0.012, "training_step_time_ms": 199741.933, "sample_time_ms": 2580.461, "learn_time_ms": 197140.88, "learn_throughput": 20.29, "synch_weights_time_ms": 11.781}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 42, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-48-42", "timestamp": 1717220922, "time_this_iter_s": 199.26587581634521, "time_total_s": 11739.737374305725, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7db040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11739.737374305725, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 25.40921985815603, "ram_util_percent": 79.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8882195666321295, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.156780846151935, "policy_loss": -0.008080930372053426, "vf_loss": 6.16406315980247, "vf_explained_var": 0.0007614581475750453, "kl": 0.007986162471225989, "entropy": 0.5659912643944239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 399075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 70.0, "episode_reward_mean": 883.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 88.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1040.0, 1175.0, 1100.0, 1440.0, 740.0, 1280.0, 1090.0, 1080.0, 250.0, 1340.0, 1130.0, 1240.0, 780.0, 540.0, 1190.0, 715.0, 1480.0, 1160.0, 160.0, 890.0, 590.0, 750.0, 860.0, 655.0, 530.0, 1300.0, 470.0, 1190.0, 1010.0, 1185.0, 1260.0, 810.0, 1185.0, 1055.0, 1260.0, 1270.0, 530.0, 765.0, 1385.0, 710.0, 1030.0, 1050.0, 1420.0, 1790.0, 550.0, 230.0, 940.0, 790.0, 500.0, 610.0, 1220.0, 300.0, 650.0, 1055.0, 620.0, 130.0, 1110.0, 1450.0, 1060.0, 450.0, 1455.0, 1390.0, 980.0, 1160.0, 530.0, 1140.0, 1170.0, 1290.0, 790.0, 580.0, 995.0, 970.0, 180.0, 230.0, 500.0, 535.0, 300.0, 550.0, 1200.0, 820.0, 490.0, 1060.0, 1220.0, 590.0, 690.0, 1270.0, 1140.0, 1030.0, 880.0, 1220.0, 810.0, 310.0, 510.0, 70.0, 810.0, 1150.0, 440.0, 780.0, 870.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [300.0, 30.0, 40.0, 100.0, 400.0, 40.0, 40.0, 0.0, 20.0, 70.0, 200.0, 20.0, 80.0, 35.0, 30.0, 310.0, 270.0, 80.0, 10.0, 140.0, 20.0, 0.0, 60.0, 80.0, 80.0, 230.0, 290.0, 90.0, 60.0, 190.0, 80.0, 400.0, 750.0, 50.0, 30.0, 180.0, 40.0, -60.0, 70.0, -100.0, 0.0, 40.0, 130.0, 140.0, 20.0, 20.0, 340.0, 30.0, 20.0, 0.0, 60.0, 110.0, 340.0, 280.0, 60.0, 10.0, 40.0, 220.0, 70.0, 90.0, 70.0, 30.0, 80.0, 310.0, 110.0, 60.0, 180.0, 70.0, 110.0, 70.0, 420.0, 40.0, 310.0, 60.0, 60.0, 20.0, -30.0, 100.0, 60.0, 40.0, 20.0, 360.0, -10.0, 30.0, 50.0, 30.0, 10.0, 190.0, 40.0, -470.0, 300.0, 80.0, 160.0, 80.0, 90.0, 70.0, 60.0, 200.0, 40.0, 260.0, 20.0, 80.0, 70.0, 310.0, 20.0, 70.0, 210.0, 130.0, 170.0, 50.0, 470.0, 10.0, 200.0, 120.0, 310.0, 30.0, 30.0, 80.0, -60.0, 50.0, 10.0, 260.0, 40.0, 90.0, 10.0, 40.0, 250.0, 20.0, 20.0, 40.0, 10.0, 40.0, 30.0, 100.0, 20.0, 20.0, 30.0, 170.0, 90.0, 30.0, 180.0, 60.0, 210.0, -50.0, 110.0, 50.0, 260.0, 280.0, 20.0, 70.0, 30.0, 100.0, 30.0, 180.0, 150.0, 40.0, 90.0, 25.0, 60.0, 10.0, 60.0, 320.0, 60.0, 390.0, 220.0, 80.0, 90.0, 30.0, 60.0, 170.0, 30.0, 70.0, 150.0, 20.0, 470.0, 90.0, 20.0, 150.0, 80.0, 80.0, 10.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 20.0, 60.0, 0.0, 30.0, 30.0, 110.0, 370.0, -20.0, 150.0, 30.0, -30.0, 220.0, 0.0, 50.0, 200.0, 50.0, 80.0, 0.0, 40.0, 120.0, 10.0, 20.0, 20.0, 40.0, 50.0, 20.0, 150.0, 20.0, 30.0, 290.0, 30.0, 80.0, 40.0, 240.0, 80.0, 20.0, 10.0, 30.0, 100.0, 40.0, 130.0, 40.0, 170.0, 120.0, 30.0, 20.0, 90.0, 40.0, 260.0, 5.0, 40.0, 20.0, 30.0, 150.0, 30.0, 20.0, 100.0, 20.0, -20.0, 10.0, 30.0, 100.0, 90.0, -20.0, 320.0, 170.0, 170.0, 30.0, 70.0, 60.0, 10.0, 60.0, 430.0, 10.0, 170.0, 10.0, 160.0, 40.0, 10.0, 20.0, 10.0, 10.0, 30.0, 360.0, 70.0, 90.0, 310.0, 80.0, 140.0, 30.0, -110.0, 70.0, 150.0, 30.0, 180.0, -50.0, -20.0, 190.0, 310.0, 110.0, 50.0, 20.0, 190.0, 150.0, 160.0, 480.0, 30.0, 80.0, 110.0, 30.0, 15.0, 80.0, 50.0, 50.0, 210.0, -30.0, 0.0, 450.0, 150.0, 30.0, 140.0, 70.0, 190.0, 10.0, 0.0, 20.0, 100.0, 40.0, 80.0, 310.0, 10.0, 200.0, 40.0, 10.0, 70.0, 570.0, 260.0, 40.0, 5.0, 40.0, 70.0, 60.0, 60.0, 0.0, 290.0, 80.0, 80.0, 40.0, -10.0, 25.0, 170.0, 90.0, 290.0, 30.0, 140.0, 20.0, 190.0, 580.0, 70.0, 90.0, 30.0, 80.0, 30.0, 220.0, 100.0, 30.0, 390.0, 300.0, 20.0, -30.0, 40.0, 150.0, 50.0, 20.0, 80.0, 10.0, 160.0, 30.0, 130.0, 50.0, 10.0, 40.0, 0.0, 20.0, 40.0, 120.0, 30.0, 90.0, 110.0, 50.0, 40.0, 265.0, 0.0, 320.0, 20.0, 70.0, 205.0, 190.0, 50.0, 190.0, 250.0, 40.0, 50.0, 50.0, 130.0, 100.0, 30.0, 0.0, 10.0, 30.0, 20.0, 300.0, 40.0, 300.0, 80.0, 270.0, 90.0, 20.0, 70.0, 30.0, 80.0, 50.0, 40.0, 260.0, 100.0, 10.0, 150.0, 20.0, 190.0, 150.0, 50.0, 100.0, 20.0, 140.0, 140.0, 60.0, 30.0, 150.0, 180.0, 360.0, 70.0, 200.0, 90.0, 270.0, 90.0, 80.0, 50.0, 190.0, 170.0, 160.0, 380.0, 310.0, 90.0, 110.0, 0.0, 40.0, -140.0, 0.0, 30.0, 10.0, 10.0, 150.0, 340.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 60.0, 10.0, 70.0, 100.0, 40.0, 160.0, 220.0, 190.0, 10.0, 30.0, 70.0, 50.0, 50.0, 70.0, 230.0, -90.0, 200.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, -90.0, 200.0, 60.0, 60.0, -350.0, 60.0, 150.0, 150.0, 220.0, 70.0, 20.0, 170.0, 30.0, 30.0, 40.0, 40.0, 50.0, 170.0, -10.0, 60.0, 200.0, 100.0, 300.0, 260.0, 70.0, 60.0, 90.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 150.0, 0.0, 10.0, 20.0, 90.0, 230.0, 130.0, 30.0, 10.0, 30.0, 50.0, 100.0, 0.0, 0.0, 70.0, 40.0, 80.0, 220.0, 65.0, 150.0, 310.0, 30.0, 80.0, 60.0, 20.0, 260.0, 20.0, 30.0, 20.0, 20.0, 170.0, 10.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, -30.0, 0.0, 80.0, 0.0, 0.0, 100.0, 450.0, 70.0, 50.0, 40.0, 10.0, 70.0, 60.0, 170.0, 90.0, 10.0, -40.0, 60.0, 10.0, 580.0, 300.0, 200.0, 80.0, 190.0, 60.0, 80.0, 40.0, 220.0, 40.0, 360.0, 20.0, 30.0, 150.0, 30.0, 90.0, 20.0, 10.0, 10.0, 250.0, 0.0, 40.0, 30.0, 40.0, 40.0, 10.0, -10.0, 20.0, 60.0, 120.0, 270.0, 180.0, 240.0, 25.0, 50.0, 500.0, 180.0, 120.0, 240.0, 60.0, 110.0, 30.0, 310.0, 140.0, 30.0, 170.0, 40.0, 50.0, 0.0, 30.0, 30.0, 100.0, 570.0, 60.0, 50.0, 50.0, 470.0, 130.0, 160.0, 70.0, 30.0, 0.0, -10.0, 110.0, 30.0, 170.0, 260.0, 50.0, 40.0, 10.0, 30.0, 20.0, 10.0, 10.0, 80.0, 20.0, 120.0, 80.0, 60.0, 60.0, 40.0, 10.0, 160.0, 330.0, 120.0, 160.0, 0.0, 360.0, 20.0, 150.0, 0.0, 110.0, 210.0, 10.0, 60.0, 250.0, 10.0, 470.0, 370.0, 20.0, 0.0, -10.0, 40.0, 100.0, 220.0, 70.0, 180.0, 20.0, 60.0, 20.0, 30.0, 90.0, 40.0, 250.0, 30.0, 70.0, 20.0, 210.0, 110.0, 50.0, 30.0, 10.0, 80.0, 0.0, 50.0, 20.0, 60.0, 40.0, 0.0, 370.0, 150.0, 25.0, 0.0, 60.0, 270.0, 20.0, 50.0, 60.0, 30.0, 360.0, 10.0, 380.0, -40.0, 50.0, -30.0, 100.0, 40.0, 0.0, 60.0, 10.0, 20.0, 10.0, 20.0, 40.0, -50.0, 30.0, 110.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 10.0, 60.0, 30.0, 70.0, 120.0, 80.0, 40.0, 20.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 10.0, 95.0, 160.0, 100.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 190.0, 0.0, 60.0, 60.0, 0.0, 50.0, 0.0, 60.0, 10.0, 290.0, 10.0, 10.0, 210.0, 60.0, 90.0, 360.0, 120.0, 50.0, 0.0, 120.0, 60.0, 130.0, -370.0, 80.0, 110.0, 220.0, 70.0, 130.0, 100.0, 350.0, 70.0, 60.0, 20.0, 70.0, 30.0, 20.0, 40.0, 0.0, 150.0, 140.0, 0.0, 20.0, 190.0, 330.0, 180.0, 30.0, 330.0, 40.0, -50.0, 20.0, -50.0, 40.0, 180.0, 40.0, 50.0, -10.0, 120.0, 320.0, 380.0, 30.0, 60.0, 50.0, 50.0, 30.0, 170.0, 100.0, 20.0, 30.0, 10.0, 110.0, 40.0, 30.0, 20.0, 0.0, 130.0, 0.0, 200.0, 60.0, 90.0, 40.0, 110.0, 40.0, 20.0, 60.0, 40.0, 380.0, 30.0, 450.0, 0.0, 30.0, 10.0, 250.0, -30.0, 0.0, 80.0, 120.0, 320.0, 70.0, 20.0, 40.0, 60.0, 460.0, 120.0, 90.0, 0.0, 40.0, 240.0, 80.0, 320.0, 40.0, 90.0, 10.0, 190.0, 270.0, 90.0, 40.0, 30.0, 50.0, 50.0, 40.0, 120.0, 0.0, 10.0, 310.0, 40.0, 140.0, 30.0, 50.0, 130.0, 380.0, 90.0, 40.0, 150.0, 120.0, 10.0, 10.0, 30.0, 120.0, 30.0, 220.0, 30.0, 90.0, -5.0, -5.0, 40.0, 20.0, 0.0, 20.0, 70.0, 100.0, 20.0, 50.0, 80.0, 20.0, 10.0, 150.0, 20.0, 20.0, 110.0, 20.0, 0.0, 80.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, -30.0, -10.0, 380.0, 30.0, 10.0, 20.0, 250.0, 60.0, 390.0, 10.0, 150.0, 20.0, 150.0, 70.0, 210.0, 40.0, 50.0, 40.0, 110.0, 30.0, 0.0, 40.0, 20.0, 150.0, 0.0, 10.0, 40.0, 10.0, 50.0, 0.0, 20.0, 60.0, 40.0, 210.0, 10.0, 310.0, 70.0, 10.0, 200.0, 110.0, 30.0, 20.0, -10.0, 10.0, 90.0, 400.0, 10.0, 10.0, 60.0, 70.0, 70.0, 40.0, 180.0, 110.0, 100.0, 60.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2568787768372287, "mean_inference_ms": 2.091119522481033, "mean_action_processing_ms": 0.6010991011978024, "mean_env_wait_ms": 1.9372612935572517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012808561325073242, "StateBufferConnector_ms": 0.010675668716430664, "ViewRequirementAgentConnector_ms": 0.38738465309143066}, "num_episodes": 22, "episode_return_max": 1790.0, "episode_return_min": 70.0, "episode_return_mean": 883.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.921035206248607, "num_env_steps_trained_throughput_per_sec": 19.921035206248607, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 1720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1720000, "timers": {"training_iteration_time_ms": 199867.221, "restore_workers_time_ms": 0.012, "training_step_time_ms": 199867.168, "sample_time_ms": 2545.82, "learn_time_ms": 197300.618, "learn_throughput": 20.274, "synch_weights_time_ms": 11.44}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "done": false, "training_iteration": 43, "trial_id": "3d3a5_00000", "date": "2024-06-01_01-52-03", "timestamp": 1717221123, "time_this_iter_s": 200.8027400970459, "time_total_s": 11940.540114402771, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f87d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11940.540114402771, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 26.357746478873242, "ram_util_percent": 81.26478873239435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1911464436366535, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8239894386551505, "policy_loss": -0.008761357771320996, "vf_loss": 6.8319894122874265, "vf_explained_var": -0.0018948075489495129, "kl": 0.007613939544307322, "entropy": 0.5046972633455508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 408465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 70.0, "episode_reward_mean": 881.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 88.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [655.0, 530.0, 1300.0, 470.0, 1190.0, 1010.0, 1185.0, 1260.0, 810.0, 1185.0, 1055.0, 1260.0, 1270.0, 530.0, 765.0, 1385.0, 710.0, 1030.0, 1050.0, 1420.0, 1790.0, 550.0, 230.0, 940.0, 790.0, 500.0, 610.0, 1220.0, 300.0, 650.0, 1055.0, 620.0, 130.0, 1110.0, 1450.0, 1060.0, 450.0, 1455.0, 1390.0, 980.0, 1160.0, 530.0, 1140.0, 1170.0, 1290.0, 790.0, 580.0, 995.0, 970.0, 180.0, 230.0, 500.0, 535.0, 300.0, 550.0, 1200.0, 820.0, 490.0, 1060.0, 1220.0, 590.0, 690.0, 1270.0, 1140.0, 1030.0, 880.0, 1220.0, 810.0, 310.0, 510.0, 70.0, 810.0, 1150.0, 440.0, 780.0, 870.0, 700.0, 1430.0, 725.0, 840.0, 1255.0, 1090.0, 970.0, 1290.0, 1335.0, 770.0, 1090.0, 330.0, 340.0, 920.0, 1340.0, 690.0, 1060.0, 540.0, 510.0, 110.0, 1560.0, 1545.0, 1040.0, 1010.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 30.0, 20.0, 90.0, 40.0, 260.0, 5.0, 40.0, 20.0, 30.0, 150.0, 30.0, 20.0, 100.0, 20.0, -20.0, 10.0, 30.0, 100.0, 90.0, -20.0, 320.0, 170.0, 170.0, 30.0, 70.0, 60.0, 10.0, 60.0, 430.0, 10.0, 170.0, 10.0, 160.0, 40.0, 10.0, 20.0, 10.0, 10.0, 30.0, 360.0, 70.0, 90.0, 310.0, 80.0, 140.0, 30.0, -110.0, 70.0, 150.0, 30.0, 180.0, -50.0, -20.0, 190.0, 310.0, 110.0, 50.0, 20.0, 190.0, 150.0, 160.0, 480.0, 30.0, 80.0, 110.0, 30.0, 15.0, 80.0, 50.0, 50.0, 210.0, -30.0, 0.0, 450.0, 150.0, 30.0, 140.0, 70.0, 190.0, 10.0, 0.0, 20.0, 100.0, 40.0, 80.0, 310.0, 10.0, 200.0, 40.0, 10.0, 70.0, 570.0, 260.0, 40.0, 5.0, 40.0, 70.0, 60.0, 60.0, 0.0, 290.0, 80.0, 80.0, 40.0, -10.0, 25.0, 170.0, 90.0, 290.0, 30.0, 140.0, 20.0, 190.0, 580.0, 70.0, 90.0, 30.0, 80.0, 30.0, 220.0, 100.0, 30.0, 390.0, 300.0, 20.0, -30.0, 40.0, 150.0, 50.0, 20.0, 80.0, 10.0, 160.0, 30.0, 130.0, 50.0, 10.0, 40.0, 0.0, 20.0, 40.0, 120.0, 30.0, 90.0, 110.0, 50.0, 40.0, 265.0, 0.0, 320.0, 20.0, 70.0, 205.0, 190.0, 50.0, 190.0, 250.0, 40.0, 50.0, 50.0, 130.0, 100.0, 30.0, 0.0, 10.0, 30.0, 20.0, 300.0, 40.0, 300.0, 80.0, 270.0, 90.0, 20.0, 70.0, 30.0, 80.0, 50.0, 40.0, 260.0, 100.0, 10.0, 150.0, 20.0, 190.0, 150.0, 50.0, 100.0, 20.0, 140.0, 140.0, 60.0, 30.0, 150.0, 180.0, 360.0, 70.0, 200.0, 90.0, 270.0, 90.0, 80.0, 50.0, 190.0, 170.0, 160.0, 380.0, 310.0, 90.0, 110.0, 0.0, 40.0, -140.0, 0.0, 30.0, 10.0, 10.0, 150.0, 340.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 60.0, 10.0, 70.0, 100.0, 40.0, 160.0, 220.0, 190.0, 10.0, 30.0, 70.0, 50.0, 50.0, 70.0, 230.0, -90.0, 200.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, -90.0, 200.0, 60.0, 60.0, -350.0, 60.0, 150.0, 150.0, 220.0, 70.0, 20.0, 170.0, 30.0, 30.0, 40.0, 40.0, 50.0, 170.0, -10.0, 60.0, 200.0, 100.0, 300.0, 260.0, 70.0, 60.0, 90.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 150.0, 0.0, 10.0, 20.0, 90.0, 230.0, 130.0, 30.0, 10.0, 30.0, 50.0, 100.0, 0.0, 0.0, 70.0, 40.0, 80.0, 220.0, 65.0, 150.0, 310.0, 30.0, 80.0, 60.0, 20.0, 260.0, 20.0, 30.0, 20.0, 20.0, 170.0, 10.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, -30.0, 0.0, 80.0, 0.0, 0.0, 100.0, 450.0, 70.0, 50.0, 40.0, 10.0, 70.0, 60.0, 170.0, 90.0, 10.0, -40.0, 60.0, 10.0, 580.0, 300.0, 200.0, 80.0, 190.0, 60.0, 80.0, 40.0, 220.0, 40.0, 360.0, 20.0, 30.0, 150.0, 30.0, 90.0, 20.0, 10.0, 10.0, 250.0, 0.0, 40.0, 30.0, 40.0, 40.0, 10.0, -10.0, 20.0, 60.0, 120.0, 270.0, 180.0, 240.0, 25.0, 50.0, 500.0, 180.0, 120.0, 240.0, 60.0, 110.0, 30.0, 310.0, 140.0, 30.0, 170.0, 40.0, 50.0, 0.0, 30.0, 30.0, 100.0, 570.0, 60.0, 50.0, 50.0, 470.0, 130.0, 160.0, 70.0, 30.0, 0.0, -10.0, 110.0, 30.0, 170.0, 260.0, 50.0, 40.0, 10.0, 30.0, 20.0, 10.0, 10.0, 80.0, 20.0, 120.0, 80.0, 60.0, 60.0, 40.0, 10.0, 160.0, 330.0, 120.0, 160.0, 0.0, 360.0, 20.0, 150.0, 0.0, 110.0, 210.0, 10.0, 60.0, 250.0, 10.0, 470.0, 370.0, 20.0, 0.0, -10.0, 40.0, 100.0, 220.0, 70.0, 180.0, 20.0, 60.0, 20.0, 30.0, 90.0, 40.0, 250.0, 30.0, 70.0, 20.0, 210.0, 110.0, 50.0, 30.0, 10.0, 80.0, 0.0, 50.0, 20.0, 60.0, 40.0, 0.0, 370.0, 150.0, 25.0, 0.0, 60.0, 270.0, 20.0, 50.0, 60.0, 30.0, 360.0, 10.0, 380.0, -40.0, 50.0, -30.0, 100.0, 40.0, 0.0, 60.0, 10.0, 20.0, 10.0, 20.0, 40.0, -50.0, 30.0, 110.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 10.0, 60.0, 30.0, 70.0, 120.0, 80.0, 40.0, 20.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 10.0, 95.0, 160.0, 100.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 190.0, 0.0, 60.0, 60.0, 0.0, 50.0, 0.0, 60.0, 10.0, 290.0, 10.0, 10.0, 210.0, 60.0, 90.0, 360.0, 120.0, 50.0, 0.0, 120.0, 60.0, 130.0, -370.0, 80.0, 110.0, 220.0, 70.0, 130.0, 100.0, 350.0, 70.0, 60.0, 20.0, 70.0, 30.0, 20.0, 40.0, 0.0, 150.0, 140.0, 0.0, 20.0, 190.0, 330.0, 180.0, 30.0, 330.0, 40.0, -50.0, 20.0, -50.0, 40.0, 180.0, 40.0, 50.0, -10.0, 120.0, 320.0, 380.0, 30.0, 60.0, 50.0, 50.0, 30.0, 170.0, 100.0, 20.0, 30.0, 10.0, 110.0, 40.0, 30.0, 20.0, 0.0, 130.0, 0.0, 200.0, 60.0, 90.0, 40.0, 110.0, 40.0, 20.0, 60.0, 40.0, 380.0, 30.0, 450.0, 0.0, 30.0, 10.0, 250.0, -30.0, 0.0, 80.0, 120.0, 320.0, 70.0, 20.0, 40.0, 60.0, 460.0, 120.0, 90.0, 0.0, 40.0, 240.0, 80.0, 320.0, 40.0, 90.0, 10.0, 190.0, 270.0, 90.0, 40.0, 30.0, 50.0, 50.0, 40.0, 120.0, 0.0, 10.0, 310.0, 40.0, 140.0, 30.0, 50.0, 130.0, 380.0, 90.0, 40.0, 150.0, 120.0, 10.0, 10.0, 30.0, 120.0, 30.0, 220.0, 30.0, 90.0, -5.0, -5.0, 40.0, 20.0, 0.0, 20.0, 70.0, 100.0, 20.0, 50.0, 80.0, 20.0, 10.0, 150.0, 20.0, 20.0, 110.0, 20.0, 0.0, 80.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, -30.0, -10.0, 380.0, 30.0, 10.0, 20.0, 250.0, 60.0, 390.0, 10.0, 150.0, 20.0, 150.0, 70.0, 210.0, 40.0, 50.0, 40.0, 110.0, 30.0, 0.0, 40.0, 20.0, 150.0, 0.0, 10.0, 40.0, 10.0, 50.0, 0.0, 20.0, 60.0, 40.0, 210.0, 10.0, 310.0, 70.0, 10.0, 200.0, 110.0, 30.0, 20.0, -10.0, 10.0, 90.0, 400.0, 10.0, 10.0, 60.0, 70.0, 70.0, 40.0, 180.0, 110.0, 100.0, 60.0, 0.0, 380.0, 60.0, 60.0, 70.0, 210.0, 40.0, 50.0, 500.0, 0.0, 60.0, 30.0, 30.0, 20.0, 20.0, 20.0, 180.0, 90.0, 110.0, 35.0, 190.0, 50.0, 30.0, 80.0, 30.0, 210.0, 10.0, 0.0, 30.0, 30.0, 370.0, 30.0, 100.0, 110.0, 25.0, 30.0, 270.0, 310.0, 220.0, 30.0, 130.0, 10.0, 30.0, 310.0, 140.0, 70.0, 190.0, 30.0, 90.0, 100.0, 120.0, 260.0, 150.0, 40.0, 20.0, 90.0, 40.0, 210.0, 80.0, 30.0, 50.0, 100.0, 10.0, 220.0, 40.0, 300.0, 330.0, 160.0, 50.0, 40.0, 40.0, -40.0, 10.0, 50.0, 190.0, 490.0, -5.0, 60.0, 240.0, 50.0, 290.0, 80.0, 90.0, 10.0, 180.0, 40.0, 40.0, 10.0, 260.0, 40.0, 20.0, 110.0, 350.0, 20.0, 120.0, 0.0, 40.0, 360.0, 0.0, 70.0, 20.0, 30.0, 30.0, 20.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 10.0, 80.0, 110.0, 20.0, 40.0, 0.0, 10.0, 60.0, 0.0, 20.0, 0.0, 0.0, 50.0, 30.0, 20.0, 400.0, 320.0, 70.0, 10.0, 0.0, 20.0, 60.0, 320.0, 210.0, 40.0, 70.0, -10.0, 220.0, 280.0, 170.0, -20.0, 0.0, 20.0, 20.0, 0.0, 160.0, 260.0, 150.0, -20.0, 40.0, 60.0, 340.0, -20.0, 40.0, 20.0, 20.0, -10.0, 50.0, 50.0, 110.0, 460.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 300.0, -40.0, 20.0, 30.0, 0.0, 360.0, 40.0, 0.0, 40.0, 30.0, 30.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 70.0, 10.0, 380.0, 190.0, 190.0, 50.0, 50.0, 40.0, 290.0, 0.0, 360.0, 10.0, 20.0, 150.0, 80.0, 35.0, 170.0, 510.0, 270.0, 80.0, 220.0, 50.0, 360.0, 30.0, 10.0, 150.0, 40.0, 340.0, 10.0, 50.0, 0.0, 40.0, -40.0, 360.0, 10.0, 50.0, 20.0, 360.0, -40.0, 40.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2375540496273345, "mean_inference_ms": 2.0763900777268502, "mean_action_processing_ms": 0.5954220890215973, "mean_env_wait_ms": 1.918720748329741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013225555419921875, "StateBufferConnector_ms": 0.011536359786987305, "ViewRequirementAgentConnector_ms": 0.4101402759552002}, "num_episodes": 23, "episode_return_max": 1790.0, "episode_return_min": 70.0, "episode_return_mean": 881.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.574938717342907, "num_env_steps_trained_throughput_per_sec": 3.574938717342907, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 291892.531, "restore_workers_time_ms": 0.012, "training_step_time_ms": 291892.479, "sample_time_ms": 2573.87, "learn_time_ms": 289297.416, "learn_throughput": 13.827, "synch_weights_time_ms": 11.921}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 44, "trial_id": "3d3a5_00000", "date": "2024-06-01_02-10-42", "timestamp": 1717222242, "time_this_iter_s": 1118.9126381874084, "time_total_s": 13059.45275259018, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7db1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13059.45275259018, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 27.857439446366783, "ram_util_percent": 81.77058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.723776044670385, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.851114183239027, "policy_loss": -0.007653513948231761, "vf_loss": 6.858047421011554, "vf_explained_var": 0.000994995328438041, "kl": 0.00720271619679269, "entropy": 0.5177689444238005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 417855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 70.0, "episode_reward_mean": 895.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 89.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1050.0, 1420.0, 1790.0, 550.0, 230.0, 940.0, 790.0, 500.0, 610.0, 1220.0, 300.0, 650.0, 1055.0, 620.0, 130.0, 1110.0, 1450.0, 1060.0, 450.0, 1455.0, 1390.0, 980.0, 1160.0, 530.0, 1140.0, 1170.0, 1290.0, 790.0, 580.0, 995.0, 970.0, 180.0, 230.0, 500.0, 535.0, 300.0, 550.0, 1200.0, 820.0, 490.0, 1060.0, 1220.0, 590.0, 690.0, 1270.0, 1140.0, 1030.0, 880.0, 1220.0, 810.0, 310.0, 510.0, 70.0, 810.0, 1150.0, 440.0, 780.0, 870.0, 700.0, 1430.0, 725.0, 840.0, 1255.0, 1090.0, 970.0, 1290.0, 1335.0, 770.0, 1090.0, 330.0, 340.0, 920.0, 1340.0, 690.0, 1060.0, 540.0, 510.0, 110.0, 1560.0, 1545.0, 1040.0, 1010.0, 280.0, 1900.0, 1210.0, 1090.0, 1330.0, 930.0, 920.0, 1215.0, 1070.0, 1150.0, 1110.0, 790.0, 1000.0, 1070.0, 1530.0, 1440.0, 720.0, 260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [260.0, 100.0, 10.0, 150.0, 20.0, 190.0, 150.0, 50.0, 100.0, 20.0, 140.0, 140.0, 60.0, 30.0, 150.0, 180.0, 360.0, 70.0, 200.0, 90.0, 270.0, 90.0, 80.0, 50.0, 190.0, 170.0, 160.0, 380.0, 310.0, 90.0, 110.0, 0.0, 40.0, -140.0, 0.0, 30.0, 10.0, 10.0, 150.0, 340.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 60.0, 10.0, 70.0, 100.0, 40.0, 160.0, 220.0, 190.0, 10.0, 30.0, 70.0, 50.0, 50.0, 70.0, 230.0, -90.0, 200.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, -90.0, 200.0, 60.0, 60.0, -350.0, 60.0, 150.0, 150.0, 220.0, 70.0, 20.0, 170.0, 30.0, 30.0, 40.0, 40.0, 50.0, 170.0, -10.0, 60.0, 200.0, 100.0, 300.0, 260.0, 70.0, 60.0, 90.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 150.0, 0.0, 10.0, 20.0, 90.0, 230.0, 130.0, 30.0, 10.0, 30.0, 50.0, 100.0, 0.0, 0.0, 70.0, 40.0, 80.0, 220.0, 65.0, 150.0, 310.0, 30.0, 80.0, 60.0, 20.0, 260.0, 20.0, 30.0, 20.0, 20.0, 170.0, 10.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, -30.0, 0.0, 80.0, 0.0, 0.0, 100.0, 450.0, 70.0, 50.0, 40.0, 10.0, 70.0, 60.0, 170.0, 90.0, 10.0, -40.0, 60.0, 10.0, 580.0, 300.0, 200.0, 80.0, 190.0, 60.0, 80.0, 40.0, 220.0, 40.0, 360.0, 20.0, 30.0, 150.0, 30.0, 90.0, 20.0, 10.0, 10.0, 250.0, 0.0, 40.0, 30.0, 40.0, 40.0, 10.0, -10.0, 20.0, 60.0, 120.0, 270.0, 180.0, 240.0, 25.0, 50.0, 500.0, 180.0, 120.0, 240.0, 60.0, 110.0, 30.0, 310.0, 140.0, 30.0, 170.0, 40.0, 50.0, 0.0, 30.0, 30.0, 100.0, 570.0, 60.0, 50.0, 50.0, 470.0, 130.0, 160.0, 70.0, 30.0, 0.0, -10.0, 110.0, 30.0, 170.0, 260.0, 50.0, 40.0, 10.0, 30.0, 20.0, 10.0, 10.0, 80.0, 20.0, 120.0, 80.0, 60.0, 60.0, 40.0, 10.0, 160.0, 330.0, 120.0, 160.0, 0.0, 360.0, 20.0, 150.0, 0.0, 110.0, 210.0, 10.0, 60.0, 250.0, 10.0, 470.0, 370.0, 20.0, 0.0, -10.0, 40.0, 100.0, 220.0, 70.0, 180.0, 20.0, 60.0, 20.0, 30.0, 90.0, 40.0, 250.0, 30.0, 70.0, 20.0, 210.0, 110.0, 50.0, 30.0, 10.0, 80.0, 0.0, 50.0, 20.0, 60.0, 40.0, 0.0, 370.0, 150.0, 25.0, 0.0, 60.0, 270.0, 20.0, 50.0, 60.0, 30.0, 360.0, 10.0, 380.0, -40.0, 50.0, -30.0, 100.0, 40.0, 0.0, 60.0, 10.0, 20.0, 10.0, 20.0, 40.0, -50.0, 30.0, 110.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 10.0, 60.0, 30.0, 70.0, 120.0, 80.0, 40.0, 20.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 10.0, 95.0, 160.0, 100.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 190.0, 0.0, 60.0, 60.0, 0.0, 50.0, 0.0, 60.0, 10.0, 290.0, 10.0, 10.0, 210.0, 60.0, 90.0, 360.0, 120.0, 50.0, 0.0, 120.0, 60.0, 130.0, -370.0, 80.0, 110.0, 220.0, 70.0, 130.0, 100.0, 350.0, 70.0, 60.0, 20.0, 70.0, 30.0, 20.0, 40.0, 0.0, 150.0, 140.0, 0.0, 20.0, 190.0, 330.0, 180.0, 30.0, 330.0, 40.0, -50.0, 20.0, -50.0, 40.0, 180.0, 40.0, 50.0, -10.0, 120.0, 320.0, 380.0, 30.0, 60.0, 50.0, 50.0, 30.0, 170.0, 100.0, 20.0, 30.0, 10.0, 110.0, 40.0, 30.0, 20.0, 0.0, 130.0, 0.0, 200.0, 60.0, 90.0, 40.0, 110.0, 40.0, 20.0, 60.0, 40.0, 380.0, 30.0, 450.0, 0.0, 30.0, 10.0, 250.0, -30.0, 0.0, 80.0, 120.0, 320.0, 70.0, 20.0, 40.0, 60.0, 460.0, 120.0, 90.0, 0.0, 40.0, 240.0, 80.0, 320.0, 40.0, 90.0, 10.0, 190.0, 270.0, 90.0, 40.0, 30.0, 50.0, 50.0, 40.0, 120.0, 0.0, 10.0, 310.0, 40.0, 140.0, 30.0, 50.0, 130.0, 380.0, 90.0, 40.0, 150.0, 120.0, 10.0, 10.0, 30.0, 120.0, 30.0, 220.0, 30.0, 90.0, -5.0, -5.0, 40.0, 20.0, 0.0, 20.0, 70.0, 100.0, 20.0, 50.0, 80.0, 20.0, 10.0, 150.0, 20.0, 20.0, 110.0, 20.0, 0.0, 80.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, -30.0, -10.0, 380.0, 30.0, 10.0, 20.0, 250.0, 60.0, 390.0, 10.0, 150.0, 20.0, 150.0, 70.0, 210.0, 40.0, 50.0, 40.0, 110.0, 30.0, 0.0, 40.0, 20.0, 150.0, 0.0, 10.0, 40.0, 10.0, 50.0, 0.0, 20.0, 60.0, 40.0, 210.0, 10.0, 310.0, 70.0, 10.0, 200.0, 110.0, 30.0, 20.0, -10.0, 10.0, 90.0, 400.0, 10.0, 10.0, 60.0, 70.0, 70.0, 40.0, 180.0, 110.0, 100.0, 60.0, 0.0, 380.0, 60.0, 60.0, 70.0, 210.0, 40.0, 50.0, 500.0, 0.0, 60.0, 30.0, 30.0, 20.0, 20.0, 20.0, 180.0, 90.0, 110.0, 35.0, 190.0, 50.0, 30.0, 80.0, 30.0, 210.0, 10.0, 0.0, 30.0, 30.0, 370.0, 30.0, 100.0, 110.0, 25.0, 30.0, 270.0, 310.0, 220.0, 30.0, 130.0, 10.0, 30.0, 310.0, 140.0, 70.0, 190.0, 30.0, 90.0, 100.0, 120.0, 260.0, 150.0, 40.0, 20.0, 90.0, 40.0, 210.0, 80.0, 30.0, 50.0, 100.0, 10.0, 220.0, 40.0, 300.0, 330.0, 160.0, 50.0, 40.0, 40.0, -40.0, 10.0, 50.0, 190.0, 490.0, -5.0, 60.0, 240.0, 50.0, 290.0, 80.0, 90.0, 10.0, 180.0, 40.0, 40.0, 10.0, 260.0, 40.0, 20.0, 110.0, 350.0, 20.0, 120.0, 0.0, 40.0, 360.0, 0.0, 70.0, 20.0, 30.0, 30.0, 20.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 10.0, 80.0, 110.0, 20.0, 40.0, 0.0, 10.0, 60.0, 0.0, 20.0, 0.0, 0.0, 50.0, 30.0, 20.0, 400.0, 320.0, 70.0, 10.0, 0.0, 20.0, 60.0, 320.0, 210.0, 40.0, 70.0, -10.0, 220.0, 280.0, 170.0, -20.0, 0.0, 20.0, 20.0, 0.0, 160.0, 260.0, 150.0, -20.0, 40.0, 60.0, 340.0, -20.0, 40.0, 20.0, 20.0, -10.0, 50.0, 50.0, 110.0, 460.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 300.0, -40.0, 20.0, 30.0, 0.0, 360.0, 40.0, 0.0, 40.0, 30.0, 30.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 70.0, 10.0, 380.0, 190.0, 190.0, 50.0, 50.0, 40.0, 290.0, 0.0, 360.0, 10.0, 20.0, 150.0, 80.0, 35.0, 170.0, 510.0, 270.0, 80.0, 220.0, 50.0, 360.0, 30.0, 10.0, 150.0, 40.0, 340.0, 10.0, 50.0, 0.0, 40.0, -40.0, 360.0, 10.0, 50.0, 20.0, 360.0, -40.0, 40.0, 210.0, 30.0, 20.0, 40.0, 30.0, 40.0, 40.0, 0.0, 10.0, 40.0, 30.0, 60.0, 640.0, 50.0, 600.0, 40.0, 300.0, 40.0, 100.0, 100.0, -30.0, 300.0, 80.0, 40.0, 40.0, 20.0, -90.0, 20.0, 70.0, 170.0, 560.0, 180.0, 0.0, 90.0, 30.0, 30.0, 20.0, 220.0, 140.0, 0.0, 380.0, 80.0, 50.0, 110.0, 40.0, 390.0, 190.0, 280.0, 70.0, 100.0, 20.0, 390.0, -10.0, 160.0, 110.0, 80.0, 50.0, 60.0, 10.0, 180.0, -100.0, 50.0, 110.0, 90.0, 100.0, 170.0, 160.0, 70.0, 80.0, 50.0, 40.0, 20.0, 60.0, 70.0, 60.0, 0.0, -20.0, 25.0, 370.0, 30.0, 600.0, 390.0, 40.0, 30.0, 40.0, 30.0, 0.0, 80.0, 170.0, 270.0, 20.0, 20.0, 270.0, 40.0, 60.0, 60.0, 50.0, 80.0, 450.0, 70.0, 50.0, 20.0, 50.0, 10.0, 280.0, 160.0, 30.0, 470.0, 40.0, 60.0, -10.0, 160.0, 130.0, 40.0, 300.0, 180.0, 10.0, 40.0, -70.0, -30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 410.0, 10.0, 20.0, 50.0, 120.0, 280.0, 10.0, 40.0, 50.0, 240.0, 290.0, 80.0, 180.0, 100.0, 40.0, 40.0, 30.0, 60.0, 0.0, 650.0, 410.0, 120.0, 20.0, 50.0, 160.0, 30.0, 60.0, 750.0, 300.0, 40.0, 200.0, 40.0, -70.0, 90.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 150.0, 20.0, 180.0, 60.0, 170.0, 10.0, 0.0, 40.0, 0.0, 100.0, 0.0, 0.0, 60.0, 50.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2234420431930424, "mean_inference_ms": 2.065656493004179, "mean_action_processing_ms": 0.5912224254192623, "mean_env_wait_ms": 1.905014144045043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013210535049438477, "StateBufferConnector_ms": 0.011443853378295898, "ViewRequirementAgentConnector_ms": 0.4133615493774414}, "num_episodes": 18, "episode_return_max": 1900.0, "episode_return_min": 70.0, "episode_return_mean": 895.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.426062064228492, "num_env_steps_trained_throughput_per_sec": 3.426062064228492, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 388536.017, "restore_workers_time_ms": 0.012, "training_step_time_ms": 388535.965, "sample_time_ms": 2660.35, "learn_time_ms": 385854.404, "learn_throughput": 10.367, "synch_weights_time_ms": 11.113}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 45, "trial_id": "3d3a5_00000", "date": "2024-06-01_02-30-10", "timestamp": 1717223410, "time_this_iter_s": 1167.5466349124908, "time_total_s": 14226.99938750267, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7e8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14226.99938750267, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 23.135051546391754, "ram_util_percent": 81.52061855670104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9496837617998053, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.464128404074964, "policy_loss": -0.00826726424832867, "vf_loss": 6.471597110222196, "vf_explained_var": 0.0003967828009202204, "kl": 0.00798553815075109, "entropy": 0.5414367695776419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 427245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 70.0, "episode_reward_mean": 897.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 89.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [450.0, 1455.0, 1390.0, 980.0, 1160.0, 530.0, 1140.0, 1170.0, 1290.0, 790.0, 580.0, 995.0, 970.0, 180.0, 230.0, 500.0, 535.0, 300.0, 550.0, 1200.0, 820.0, 490.0, 1060.0, 1220.0, 590.0, 690.0, 1270.0, 1140.0, 1030.0, 880.0, 1220.0, 810.0, 310.0, 510.0, 70.0, 810.0, 1150.0, 440.0, 780.0, 870.0, 700.0, 1430.0, 725.0, 840.0, 1255.0, 1090.0, 970.0, 1290.0, 1335.0, 770.0, 1090.0, 330.0, 340.0, 920.0, 1340.0, 690.0, 1060.0, 540.0, 510.0, 110.0, 1560.0, 1545.0, 1040.0, 1010.0, 280.0, 1900.0, 1210.0, 1090.0, 1330.0, 930.0, 920.0, 1215.0, 1070.0, 1150.0, 1110.0, 790.0, 1000.0, 1070.0, 1530.0, 1440.0, 720.0, 260.0, 620.0, 440.0, 650.0, 1000.0, 1050.0, 470.0, 1140.0, 380.0, 650.0, 840.0, 1340.0, 1390.0, 540.0, 685.0, 710.0, 1375.0, 1470.0, 985.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 10.0, 250.0, 0.0, 40.0, 30.0, 40.0, 40.0, 10.0, -10.0, 20.0, 60.0, 120.0, 270.0, 180.0, 240.0, 25.0, 50.0, 500.0, 180.0, 120.0, 240.0, 60.0, 110.0, 30.0, 310.0, 140.0, 30.0, 170.0, 40.0, 50.0, 0.0, 30.0, 30.0, 100.0, 570.0, 60.0, 50.0, 50.0, 470.0, 130.0, 160.0, 70.0, 30.0, 0.0, -10.0, 110.0, 30.0, 170.0, 260.0, 50.0, 40.0, 10.0, 30.0, 20.0, 10.0, 10.0, 80.0, 20.0, 120.0, 80.0, 60.0, 60.0, 40.0, 10.0, 160.0, 330.0, 120.0, 160.0, 0.0, 360.0, 20.0, 150.0, 0.0, 110.0, 210.0, 10.0, 60.0, 250.0, 10.0, 470.0, 370.0, 20.0, 0.0, -10.0, 40.0, 100.0, 220.0, 70.0, 180.0, 20.0, 60.0, 20.0, 30.0, 90.0, 40.0, 250.0, 30.0, 70.0, 20.0, 210.0, 110.0, 50.0, 30.0, 10.0, 80.0, 0.0, 50.0, 20.0, 60.0, 40.0, 0.0, 370.0, 150.0, 25.0, 0.0, 60.0, 270.0, 20.0, 50.0, 60.0, 30.0, 360.0, 10.0, 380.0, -40.0, 50.0, -30.0, 100.0, 40.0, 0.0, 60.0, 10.0, 20.0, 10.0, 20.0, 40.0, -50.0, 30.0, 110.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 10.0, 60.0, 30.0, 70.0, 120.0, 80.0, 40.0, 20.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 10.0, 95.0, 160.0, 100.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 190.0, 0.0, 60.0, 60.0, 0.0, 50.0, 0.0, 60.0, 10.0, 290.0, 10.0, 10.0, 210.0, 60.0, 90.0, 360.0, 120.0, 50.0, 0.0, 120.0, 60.0, 130.0, -370.0, 80.0, 110.0, 220.0, 70.0, 130.0, 100.0, 350.0, 70.0, 60.0, 20.0, 70.0, 30.0, 20.0, 40.0, 0.0, 150.0, 140.0, 0.0, 20.0, 190.0, 330.0, 180.0, 30.0, 330.0, 40.0, -50.0, 20.0, -50.0, 40.0, 180.0, 40.0, 50.0, -10.0, 120.0, 320.0, 380.0, 30.0, 60.0, 50.0, 50.0, 30.0, 170.0, 100.0, 20.0, 30.0, 10.0, 110.0, 40.0, 30.0, 20.0, 0.0, 130.0, 0.0, 200.0, 60.0, 90.0, 40.0, 110.0, 40.0, 20.0, 60.0, 40.0, 380.0, 30.0, 450.0, 0.0, 30.0, 10.0, 250.0, -30.0, 0.0, 80.0, 120.0, 320.0, 70.0, 20.0, 40.0, 60.0, 460.0, 120.0, 90.0, 0.0, 40.0, 240.0, 80.0, 320.0, 40.0, 90.0, 10.0, 190.0, 270.0, 90.0, 40.0, 30.0, 50.0, 50.0, 40.0, 120.0, 0.0, 10.0, 310.0, 40.0, 140.0, 30.0, 50.0, 130.0, 380.0, 90.0, 40.0, 150.0, 120.0, 10.0, 10.0, 30.0, 120.0, 30.0, 220.0, 30.0, 90.0, -5.0, -5.0, 40.0, 20.0, 0.0, 20.0, 70.0, 100.0, 20.0, 50.0, 80.0, 20.0, 10.0, 150.0, 20.0, 20.0, 110.0, 20.0, 0.0, 80.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, -30.0, -10.0, 380.0, 30.0, 10.0, 20.0, 250.0, 60.0, 390.0, 10.0, 150.0, 20.0, 150.0, 70.0, 210.0, 40.0, 50.0, 40.0, 110.0, 30.0, 0.0, 40.0, 20.0, 150.0, 0.0, 10.0, 40.0, 10.0, 50.0, 0.0, 20.0, 60.0, 40.0, 210.0, 10.0, 310.0, 70.0, 10.0, 200.0, 110.0, 30.0, 20.0, -10.0, 10.0, 90.0, 400.0, 10.0, 10.0, 60.0, 70.0, 70.0, 40.0, 180.0, 110.0, 100.0, 60.0, 0.0, 380.0, 60.0, 60.0, 70.0, 210.0, 40.0, 50.0, 500.0, 0.0, 60.0, 30.0, 30.0, 20.0, 20.0, 20.0, 180.0, 90.0, 110.0, 35.0, 190.0, 50.0, 30.0, 80.0, 30.0, 210.0, 10.0, 0.0, 30.0, 30.0, 370.0, 30.0, 100.0, 110.0, 25.0, 30.0, 270.0, 310.0, 220.0, 30.0, 130.0, 10.0, 30.0, 310.0, 140.0, 70.0, 190.0, 30.0, 90.0, 100.0, 120.0, 260.0, 150.0, 40.0, 20.0, 90.0, 40.0, 210.0, 80.0, 30.0, 50.0, 100.0, 10.0, 220.0, 40.0, 300.0, 330.0, 160.0, 50.0, 40.0, 40.0, -40.0, 10.0, 50.0, 190.0, 490.0, -5.0, 60.0, 240.0, 50.0, 290.0, 80.0, 90.0, 10.0, 180.0, 40.0, 40.0, 10.0, 260.0, 40.0, 20.0, 110.0, 350.0, 20.0, 120.0, 0.0, 40.0, 360.0, 0.0, 70.0, 20.0, 30.0, 30.0, 20.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 10.0, 80.0, 110.0, 20.0, 40.0, 0.0, 10.0, 60.0, 0.0, 20.0, 0.0, 0.0, 50.0, 30.0, 20.0, 400.0, 320.0, 70.0, 10.0, 0.0, 20.0, 60.0, 320.0, 210.0, 40.0, 70.0, -10.0, 220.0, 280.0, 170.0, -20.0, 0.0, 20.0, 20.0, 0.0, 160.0, 260.0, 150.0, -20.0, 40.0, 60.0, 340.0, -20.0, 40.0, 20.0, 20.0, -10.0, 50.0, 50.0, 110.0, 460.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 300.0, -40.0, 20.0, 30.0, 0.0, 360.0, 40.0, 0.0, 40.0, 30.0, 30.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 70.0, 10.0, 380.0, 190.0, 190.0, 50.0, 50.0, 40.0, 290.0, 0.0, 360.0, 10.0, 20.0, 150.0, 80.0, 35.0, 170.0, 510.0, 270.0, 80.0, 220.0, 50.0, 360.0, 30.0, 10.0, 150.0, 40.0, 340.0, 10.0, 50.0, 0.0, 40.0, -40.0, 360.0, 10.0, 50.0, 20.0, 360.0, -40.0, 40.0, 210.0, 30.0, 20.0, 40.0, 30.0, 40.0, 40.0, 0.0, 10.0, 40.0, 30.0, 60.0, 640.0, 50.0, 600.0, 40.0, 300.0, 40.0, 100.0, 100.0, -30.0, 300.0, 80.0, 40.0, 40.0, 20.0, -90.0, 20.0, 70.0, 170.0, 560.0, 180.0, 0.0, 90.0, 30.0, 30.0, 20.0, 220.0, 140.0, 0.0, 380.0, 80.0, 50.0, 110.0, 40.0, 390.0, 190.0, 280.0, 70.0, 100.0, 20.0, 390.0, -10.0, 160.0, 110.0, 80.0, 50.0, 60.0, 10.0, 180.0, -100.0, 50.0, 110.0, 90.0, 100.0, 170.0, 160.0, 70.0, 80.0, 50.0, 40.0, 20.0, 60.0, 70.0, 60.0, 0.0, -20.0, 25.0, 370.0, 30.0, 600.0, 390.0, 40.0, 30.0, 40.0, 30.0, 0.0, 80.0, 170.0, 270.0, 20.0, 20.0, 270.0, 40.0, 60.0, 60.0, 50.0, 80.0, 450.0, 70.0, 50.0, 20.0, 50.0, 10.0, 280.0, 160.0, 30.0, 470.0, 40.0, 60.0, -10.0, 160.0, 130.0, 40.0, 300.0, 180.0, 10.0, 40.0, -70.0, -30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 410.0, 10.0, 20.0, 50.0, 120.0, 280.0, 10.0, 40.0, 50.0, 240.0, 290.0, 80.0, 180.0, 100.0, 40.0, 40.0, 30.0, 60.0, 0.0, 650.0, 410.0, 120.0, 20.0, 50.0, 160.0, 30.0, 60.0, 750.0, 300.0, 40.0, 200.0, 40.0, -70.0, 90.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 150.0, 20.0, 180.0, 60.0, 170.0, 10.0, 0.0, 40.0, 0.0, 100.0, 0.0, 0.0, 60.0, 50.0, 0.0, 10.0, 20.0, 0.0, 50.0, 180.0, 0.0, 50.0, 170.0, 20.0, 40.0, 90.0, 50.0, 30.0, 0.0, 10.0, 20.0, 10.0, 200.0, 10.0, 10.0, 100.0, 200.0, 20.0, 170.0, 30.0, -30.0, 50.0, 60.0, 20.0, 70.0, 60.0, -50.0, 20.0, 80.0, 0.0, 190.0, 40.0, 260.0, 150.0, 30.0, 280.0, 150.0, 70.0, 40.0, 30.0, 40.0, 570.0, 140.0, 0.0, 10.0, 0.0, 150.0, 40.0, 80.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 80.0, 200.0, 100.0, 150.0, 290.0, 100.0, 90.0, 120.0, 10.0, 0.0, 20.0, 60.0, 40.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 40.0, 20.0, 10.0, 60.0, 20.0, 190.0, 40.0, 100.0, 40.0, 70.0, 100.0, 0.0, 170.0, 20.0, 60.0, 110.0, 40.0, 220.0, 10.0, 110.0, 100.0, 380.0, 40.0, 40.0, 40.0, 220.0, 130.0, 90.0, 0.0, 400.0, 0.0, 20.0, 50.0, 160.0, 40.0, 110.0, 430.0, 230.0, 0.0, 260.0, 90.0, 0.0, 70.0, 80.0, 30.0, 260.0, 20.0, 10.0, 30.0, 0.0, 40.0, -30.0, 150.0, -5.0, 10.0, 0.0, 50.0, -290.0, 50.0, 270.0, 480.0, 0.0, 10.0, 0.0, 30.0, 0.0, 430.0, 30.0, 40.0, 170.0, 0.0, 40.0, 65.0, 100.0, 340.0, 70.0, 10.0, 20.0, 330.0, 110.0, 290.0, 110.0, 10.0, 50.0, 320.0, 10.0, 100.0, 280.0, 110.0, 40.0, 440.0, 50.0, 250.0, 160.0, 100.0, 65.0, 60.0, 30.0, 350.0, 10.0, -90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.209707494469414, "mean_inference_ms": 2.0553364129707705, "mean_action_processing_ms": 0.5872350345951627, "mean_env_wait_ms": 1.8921467016882147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013338565826416016, "StateBufferConnector_ms": 0.011607885360717773, "ViewRequirementAgentConnector_ms": 0.42217302322387695}, "num_episodes": 18, "episode_return_max": 1900.0, "episode_return_min": 70.0, "episode_return_mean": 897.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.164914868782715, "num_env_steps_trained_throughput_per_sec": 6.164914868782715, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 433570.55, "restore_workers_time_ms": 0.012, "training_step_time_ms": 433570.498, "sample_time_ms": 2717.878, "learn_time_ms": 430831.082, "learn_throughput": 9.284, "synch_weights_time_ms": 11.773}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 46, "trial_id": "3d3a5_00000", "date": "2024-06-01_02-40-59", "timestamp": 1717224059, "time_this_iter_s": 648.8397300243378, "time_total_s": 14875.839117527008, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7ef940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14875.839117527008, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.97038327526132, "ram_util_percent": 81.16898954703832}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.403323145809011, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.917921929262952, "policy_loss": -0.008066517872367892, "vf_loss": 6.925254864230578, "vf_explained_var": -0.002218393122934051, "kl": 0.007335843595125887, "entropy": 0.5161190681024608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 436635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 70.0, "episode_reward_mean": 935.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 93.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1060.0, 1220.0, 590.0, 690.0, 1270.0, 1140.0, 1030.0, 880.0, 1220.0, 810.0, 310.0, 510.0, 70.0, 810.0, 1150.0, 440.0, 780.0, 870.0, 700.0, 1430.0, 725.0, 840.0, 1255.0, 1090.0, 970.0, 1290.0, 1335.0, 770.0, 1090.0, 330.0, 340.0, 920.0, 1340.0, 690.0, 1060.0, 540.0, 510.0, 110.0, 1560.0, 1545.0, 1040.0, 1010.0, 280.0, 1900.0, 1210.0, 1090.0, 1330.0, 930.0, 920.0, 1215.0, 1070.0, 1150.0, 1110.0, 790.0, 1000.0, 1070.0, 1530.0, 1440.0, 720.0, 260.0, 620.0, 440.0, 650.0, 1000.0, 1050.0, 470.0, 1140.0, 380.0, 650.0, 840.0, 1340.0, 1390.0, 540.0, 685.0, 710.0, 1375.0, 1470.0, 985.0, 390.0, 1670.0, 710.0, 1155.0, 1570.0, 945.0, 720.0, 1205.0, 185.0, 400.0, 640.0, 1540.0, 1050.0, 1220.0, 920.0, 950.0, 310.0, 1450.0, 450.0, 1600.0, 730.0, 1640.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 330.0, 180.0, 30.0, 330.0, 40.0, -50.0, 20.0, -50.0, 40.0, 180.0, 40.0, 50.0, -10.0, 120.0, 320.0, 380.0, 30.0, 60.0, 50.0, 50.0, 30.0, 170.0, 100.0, 20.0, 30.0, 10.0, 110.0, 40.0, 30.0, 20.0, 0.0, 130.0, 0.0, 200.0, 60.0, 90.0, 40.0, 110.0, 40.0, 20.0, 60.0, 40.0, 380.0, 30.0, 450.0, 0.0, 30.0, 10.0, 250.0, -30.0, 0.0, 80.0, 120.0, 320.0, 70.0, 20.0, 40.0, 60.0, 460.0, 120.0, 90.0, 0.0, 40.0, 240.0, 80.0, 320.0, 40.0, 90.0, 10.0, 190.0, 270.0, 90.0, 40.0, 30.0, 50.0, 50.0, 40.0, 120.0, 0.0, 10.0, 310.0, 40.0, 140.0, 30.0, 50.0, 130.0, 380.0, 90.0, 40.0, 150.0, 120.0, 10.0, 10.0, 30.0, 120.0, 30.0, 220.0, 30.0, 90.0, -5.0, -5.0, 40.0, 20.0, 0.0, 20.0, 70.0, 100.0, 20.0, 50.0, 80.0, 20.0, 10.0, 150.0, 20.0, 20.0, 110.0, 20.0, 0.0, 80.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, -30.0, -10.0, 380.0, 30.0, 10.0, 20.0, 250.0, 60.0, 390.0, 10.0, 150.0, 20.0, 150.0, 70.0, 210.0, 40.0, 50.0, 40.0, 110.0, 30.0, 0.0, 40.0, 20.0, 150.0, 0.0, 10.0, 40.0, 10.0, 50.0, 0.0, 20.0, 60.0, 40.0, 210.0, 10.0, 310.0, 70.0, 10.0, 200.0, 110.0, 30.0, 20.0, -10.0, 10.0, 90.0, 400.0, 10.0, 10.0, 60.0, 70.0, 70.0, 40.0, 180.0, 110.0, 100.0, 60.0, 0.0, 380.0, 60.0, 60.0, 70.0, 210.0, 40.0, 50.0, 500.0, 0.0, 60.0, 30.0, 30.0, 20.0, 20.0, 20.0, 180.0, 90.0, 110.0, 35.0, 190.0, 50.0, 30.0, 80.0, 30.0, 210.0, 10.0, 0.0, 30.0, 30.0, 370.0, 30.0, 100.0, 110.0, 25.0, 30.0, 270.0, 310.0, 220.0, 30.0, 130.0, 10.0, 30.0, 310.0, 140.0, 70.0, 190.0, 30.0, 90.0, 100.0, 120.0, 260.0, 150.0, 40.0, 20.0, 90.0, 40.0, 210.0, 80.0, 30.0, 50.0, 100.0, 10.0, 220.0, 40.0, 300.0, 330.0, 160.0, 50.0, 40.0, 40.0, -40.0, 10.0, 50.0, 190.0, 490.0, -5.0, 60.0, 240.0, 50.0, 290.0, 80.0, 90.0, 10.0, 180.0, 40.0, 40.0, 10.0, 260.0, 40.0, 20.0, 110.0, 350.0, 20.0, 120.0, 0.0, 40.0, 360.0, 0.0, 70.0, 20.0, 30.0, 30.0, 20.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 10.0, 80.0, 110.0, 20.0, 40.0, 0.0, 10.0, 60.0, 0.0, 20.0, 0.0, 0.0, 50.0, 30.0, 20.0, 400.0, 320.0, 70.0, 10.0, 0.0, 20.0, 60.0, 320.0, 210.0, 40.0, 70.0, -10.0, 220.0, 280.0, 170.0, -20.0, 0.0, 20.0, 20.0, 0.0, 160.0, 260.0, 150.0, -20.0, 40.0, 60.0, 340.0, -20.0, 40.0, 20.0, 20.0, -10.0, 50.0, 50.0, 110.0, 460.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 300.0, -40.0, 20.0, 30.0, 0.0, 360.0, 40.0, 0.0, 40.0, 30.0, 30.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 70.0, 10.0, 380.0, 190.0, 190.0, 50.0, 50.0, 40.0, 290.0, 0.0, 360.0, 10.0, 20.0, 150.0, 80.0, 35.0, 170.0, 510.0, 270.0, 80.0, 220.0, 50.0, 360.0, 30.0, 10.0, 150.0, 40.0, 340.0, 10.0, 50.0, 0.0, 40.0, -40.0, 360.0, 10.0, 50.0, 20.0, 360.0, -40.0, 40.0, 210.0, 30.0, 20.0, 40.0, 30.0, 40.0, 40.0, 0.0, 10.0, 40.0, 30.0, 60.0, 640.0, 50.0, 600.0, 40.0, 300.0, 40.0, 100.0, 100.0, -30.0, 300.0, 80.0, 40.0, 40.0, 20.0, -90.0, 20.0, 70.0, 170.0, 560.0, 180.0, 0.0, 90.0, 30.0, 30.0, 20.0, 220.0, 140.0, 0.0, 380.0, 80.0, 50.0, 110.0, 40.0, 390.0, 190.0, 280.0, 70.0, 100.0, 20.0, 390.0, -10.0, 160.0, 110.0, 80.0, 50.0, 60.0, 10.0, 180.0, -100.0, 50.0, 110.0, 90.0, 100.0, 170.0, 160.0, 70.0, 80.0, 50.0, 40.0, 20.0, 60.0, 70.0, 60.0, 0.0, -20.0, 25.0, 370.0, 30.0, 600.0, 390.0, 40.0, 30.0, 40.0, 30.0, 0.0, 80.0, 170.0, 270.0, 20.0, 20.0, 270.0, 40.0, 60.0, 60.0, 50.0, 80.0, 450.0, 70.0, 50.0, 20.0, 50.0, 10.0, 280.0, 160.0, 30.0, 470.0, 40.0, 60.0, -10.0, 160.0, 130.0, 40.0, 300.0, 180.0, 10.0, 40.0, -70.0, -30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 410.0, 10.0, 20.0, 50.0, 120.0, 280.0, 10.0, 40.0, 50.0, 240.0, 290.0, 80.0, 180.0, 100.0, 40.0, 40.0, 30.0, 60.0, 0.0, 650.0, 410.0, 120.0, 20.0, 50.0, 160.0, 30.0, 60.0, 750.0, 300.0, 40.0, 200.0, 40.0, -70.0, 90.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 150.0, 20.0, 180.0, 60.0, 170.0, 10.0, 0.0, 40.0, 0.0, 100.0, 0.0, 0.0, 60.0, 50.0, 0.0, 10.0, 20.0, 0.0, 50.0, 180.0, 0.0, 50.0, 170.0, 20.0, 40.0, 90.0, 50.0, 30.0, 0.0, 10.0, 20.0, 10.0, 200.0, 10.0, 10.0, 100.0, 200.0, 20.0, 170.0, 30.0, -30.0, 50.0, 60.0, 20.0, 70.0, 60.0, -50.0, 20.0, 80.0, 0.0, 190.0, 40.0, 260.0, 150.0, 30.0, 280.0, 150.0, 70.0, 40.0, 30.0, 40.0, 570.0, 140.0, 0.0, 10.0, 0.0, 150.0, 40.0, 80.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 80.0, 200.0, 100.0, 150.0, 290.0, 100.0, 90.0, 120.0, 10.0, 0.0, 20.0, 60.0, 40.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 40.0, 20.0, 10.0, 60.0, 20.0, 190.0, 40.0, 100.0, 40.0, 70.0, 100.0, 0.0, 170.0, 20.0, 60.0, 110.0, 40.0, 220.0, 10.0, 110.0, 100.0, 380.0, 40.0, 40.0, 40.0, 220.0, 130.0, 90.0, 0.0, 400.0, 0.0, 20.0, 50.0, 160.0, 40.0, 110.0, 430.0, 230.0, 0.0, 260.0, 90.0, 0.0, 70.0, 80.0, 30.0, 260.0, 20.0, 10.0, 30.0, 0.0, 40.0, -30.0, 150.0, -5.0, 10.0, 0.0, 50.0, -290.0, 50.0, 270.0, 480.0, 0.0, 10.0, 0.0, 30.0, 0.0, 430.0, 30.0, 40.0, 170.0, 0.0, 40.0, 65.0, 100.0, 340.0, 70.0, 10.0, 20.0, 330.0, 110.0, 290.0, 110.0, 10.0, 50.0, 320.0, 10.0, 100.0, 280.0, 110.0, 40.0, 440.0, 50.0, 250.0, 160.0, 100.0, 65.0, 60.0, 30.0, 350.0, 10.0, -90.0, 0.0, 10.0, 60.0, 60.0, 80.0, 40.0, 40.0, 30.0, 60.0, 10.0, 480.0, 150.0, 70.0, 20.0, 150.0, 240.0, 90.0, 340.0, 60.0, 70.0, 10.0, 10.0, 70.0, 30.0, 40.0, 400.0, 30.0, 50.0, 30.0, 40.0, 40.0, 70.0, 270.0, 5.0, 20.0, 20.0, 0.0, 200.0, 460.0, 70.0, 20.0, 30.0, 270.0, -10.0, 200.0, 40.0, 340.0, 60.0, 620.0, 0.0, 210.0, 60.0, 270.0, 35.0, 20.0, 30.0, 150.0, 80.0, 20.0, 70.0, 160.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 340.0, -60.0, 110.0, 10.0, 40.0, 90.0, 30.0, 145.0, 230.0, 120.0, 390.0, 30.0, 120.0, 0.0, 0.0, 30.0, 0.0, 15.0, 70.0, 0.0, 0.0, 40.0, 30.0, 30.0, 20.0, 10.0, 30.0, 110.0, 10.0, 10.0, 10.0, 170.0, 0.0, 60.0, 40.0, 380.0, 40.0, 0.0, 20.0, 10.0, 60.0, 30.0, 0.0, 50.0, 90.0, 0.0, 160.0, 50.0, 270.0, 410.0, 430.0, 20.0, 60.0, -10.0, 40.0, 10.0, 110.0, 30.0, 110.0, 90.0, 20.0, 100.0, 550.0, 20.0, 150.0, 390.0, 170.0, 80.0, 180.0, 80.0, 40.0, 60.0, 50.0, 160.0, 190.0, 0.0, 190.0, 140.0, 30.0, 20.0, 70.0, 20.0, 100.0, 60.0, 20.0, 10.0, 60.0, 30.0, 130.0, 420.0, 10.0, 50.0, 160.0, 40.0, 60.0, 10.0, 30.0, 0.0, 40.0, 40.0, 40.0, 20.0, 30.0, 30.0, 50.0, 750.0, 80.0, 250.0, 130.0, -20.0, 100.0, 50.0, 30.0, 0.0, 60.0, 40.0, -20.0, 80.0, -30.0, 30.0, 180.0, 40.0, 70.0, 0.0, 260.0, 210.0, 190.0, 50.0, 40.0, 310.0, 70.0, 460.0, 10.0, 10.0, 20.0, 10.0, 210.0, 250.0, 110.0, 0.0, 30.0, 60.0, 30.0, 50.0, 90.0, 180.0, 190.0, 30.0, 290.0, 280.0, 70.0, 190.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1905648010607304, "mean_inference_ms": 2.0379075067758032, "mean_action_processing_ms": 0.5825200386218382, "mean_env_wait_ms": 1.8765392520866653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013107776641845703, "StateBufferConnector_ms": 0.011367559432983398, "ViewRequirementAgentConnector_ms": 0.41376662254333496}, "num_episodes": 22, "episode_return_max": 1900.0, "episode_return_min": 70.0, "episode_return_mean": 935.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.9204242233988216, "num_env_steps_trained_throughput_per_sec": 1.9204242233988216, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 1880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1880000, "timers": {"training_iteration_time_ms": 621836.164, "restore_workers_time_ms": 0.012, "training_step_time_ms": 621836.112, "sample_time_ms": 2727.233, "learn_time_ms": 619085.989, "learn_throughput": 6.461, "synch_weights_time_ms": 12.102}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "done": false, "training_iteration": 47, "trial_id": "3d3a5_00000", "date": "2024-06-01_03-15-42", "timestamp": 1717226142, "time_this_iter_s": 2082.908908843994, "time_total_s": 16958.748026371002, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8879d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16958.748026371002, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 22.79965870307167, "ram_util_percent": 80.60887372013653}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7524241439641095, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.716289476388559, "policy_loss": -0.008115752935394668, "vf_loss": 6.7236304294821805, "vf_explained_var": -0.0014859563562943658, "kl": 0.0077480279320425866, "entropy": 0.486010614846842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 446025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 2230.0, "episode_reward_min": 110.0, "episode_reward_mean": 968.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 96.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1090.0, 970.0, 1290.0, 1335.0, 770.0, 1090.0, 330.0, 340.0, 920.0, 1340.0, 690.0, 1060.0, 540.0, 510.0, 110.0, 1560.0, 1545.0, 1040.0, 1010.0, 280.0, 1900.0, 1210.0, 1090.0, 1330.0, 930.0, 920.0, 1215.0, 1070.0, 1150.0, 1110.0, 790.0, 1000.0, 1070.0, 1530.0, 1440.0, 720.0, 260.0, 620.0, 440.0, 650.0, 1000.0, 1050.0, 470.0, 1140.0, 380.0, 650.0, 840.0, 1340.0, 1390.0, 540.0, 685.0, 710.0, 1375.0, 1470.0, 985.0, 390.0, 1670.0, 710.0, 1155.0, 1570.0, 945.0, 720.0, 1205.0, 185.0, 400.0, 640.0, 1540.0, 1050.0, 1220.0, 920.0, 950.0, 310.0, 1450.0, 450.0, 1600.0, 730.0, 1640.0, 240.0, 1210.0, 1290.0, 1325.0, 1325.0, 910.0, 2230.0, 630.0, 1155.0, 630.0, 1270.0, 675.0, 1210.0, 790.0, 1180.0, 190.0, 1060.0, 1450.0, 680.0, 750.0, 1140.0, 690.0, 1080.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 310.0, 140.0, 70.0, 190.0, 30.0, 90.0, 100.0, 120.0, 260.0, 150.0, 40.0, 20.0, 90.0, 40.0, 210.0, 80.0, 30.0, 50.0, 100.0, 10.0, 220.0, 40.0, 300.0, 330.0, 160.0, 50.0, 40.0, 40.0, -40.0, 10.0, 50.0, 190.0, 490.0, -5.0, 60.0, 240.0, 50.0, 290.0, 80.0, 90.0, 10.0, 180.0, 40.0, 40.0, 10.0, 260.0, 40.0, 20.0, 110.0, 350.0, 20.0, 120.0, 0.0, 40.0, 360.0, 0.0, 70.0, 20.0, 30.0, 30.0, 20.0, 30.0, 40.0, 20.0, 20.0, 90.0, 40.0, 10.0, 80.0, 110.0, 20.0, 40.0, 0.0, 10.0, 60.0, 0.0, 20.0, 0.0, 0.0, 50.0, 30.0, 20.0, 400.0, 320.0, 70.0, 10.0, 0.0, 20.0, 60.0, 320.0, 210.0, 40.0, 70.0, -10.0, 220.0, 280.0, 170.0, -20.0, 0.0, 20.0, 20.0, 0.0, 160.0, 260.0, 150.0, -20.0, 40.0, 60.0, 340.0, -20.0, 40.0, 20.0, 20.0, -10.0, 50.0, 50.0, 110.0, 460.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 300.0, -40.0, 20.0, 30.0, 0.0, 360.0, 40.0, 0.0, 40.0, 30.0, 30.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 70.0, 10.0, 380.0, 190.0, 190.0, 50.0, 50.0, 40.0, 290.0, 0.0, 360.0, 10.0, 20.0, 150.0, 80.0, 35.0, 170.0, 510.0, 270.0, 80.0, 220.0, 50.0, 360.0, 30.0, 10.0, 150.0, 40.0, 340.0, 10.0, 50.0, 0.0, 40.0, -40.0, 360.0, 10.0, 50.0, 20.0, 360.0, -40.0, 40.0, 210.0, 30.0, 20.0, 40.0, 30.0, 40.0, 40.0, 0.0, 10.0, 40.0, 30.0, 60.0, 640.0, 50.0, 600.0, 40.0, 300.0, 40.0, 100.0, 100.0, -30.0, 300.0, 80.0, 40.0, 40.0, 20.0, -90.0, 20.0, 70.0, 170.0, 560.0, 180.0, 0.0, 90.0, 30.0, 30.0, 20.0, 220.0, 140.0, 0.0, 380.0, 80.0, 50.0, 110.0, 40.0, 390.0, 190.0, 280.0, 70.0, 100.0, 20.0, 390.0, -10.0, 160.0, 110.0, 80.0, 50.0, 60.0, 10.0, 180.0, -100.0, 50.0, 110.0, 90.0, 100.0, 170.0, 160.0, 70.0, 80.0, 50.0, 40.0, 20.0, 60.0, 70.0, 60.0, 0.0, -20.0, 25.0, 370.0, 30.0, 600.0, 390.0, 40.0, 30.0, 40.0, 30.0, 0.0, 80.0, 170.0, 270.0, 20.0, 20.0, 270.0, 40.0, 60.0, 60.0, 50.0, 80.0, 450.0, 70.0, 50.0, 20.0, 50.0, 10.0, 280.0, 160.0, 30.0, 470.0, 40.0, 60.0, -10.0, 160.0, 130.0, 40.0, 300.0, 180.0, 10.0, 40.0, -70.0, -30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 410.0, 10.0, 20.0, 50.0, 120.0, 280.0, 10.0, 40.0, 50.0, 240.0, 290.0, 80.0, 180.0, 100.0, 40.0, 40.0, 30.0, 60.0, 0.0, 650.0, 410.0, 120.0, 20.0, 50.0, 160.0, 30.0, 60.0, 750.0, 300.0, 40.0, 200.0, 40.0, -70.0, 90.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 150.0, 20.0, 180.0, 60.0, 170.0, 10.0, 0.0, 40.0, 0.0, 100.0, 0.0, 0.0, 60.0, 50.0, 0.0, 10.0, 20.0, 0.0, 50.0, 180.0, 0.0, 50.0, 170.0, 20.0, 40.0, 90.0, 50.0, 30.0, 0.0, 10.0, 20.0, 10.0, 200.0, 10.0, 10.0, 100.0, 200.0, 20.0, 170.0, 30.0, -30.0, 50.0, 60.0, 20.0, 70.0, 60.0, -50.0, 20.0, 80.0, 0.0, 190.0, 40.0, 260.0, 150.0, 30.0, 280.0, 150.0, 70.0, 40.0, 30.0, 40.0, 570.0, 140.0, 0.0, 10.0, 0.0, 150.0, 40.0, 80.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 80.0, 200.0, 100.0, 150.0, 290.0, 100.0, 90.0, 120.0, 10.0, 0.0, 20.0, 60.0, 40.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 40.0, 20.0, 10.0, 60.0, 20.0, 190.0, 40.0, 100.0, 40.0, 70.0, 100.0, 0.0, 170.0, 20.0, 60.0, 110.0, 40.0, 220.0, 10.0, 110.0, 100.0, 380.0, 40.0, 40.0, 40.0, 220.0, 130.0, 90.0, 0.0, 400.0, 0.0, 20.0, 50.0, 160.0, 40.0, 110.0, 430.0, 230.0, 0.0, 260.0, 90.0, 0.0, 70.0, 80.0, 30.0, 260.0, 20.0, 10.0, 30.0, 0.0, 40.0, -30.0, 150.0, -5.0, 10.0, 0.0, 50.0, -290.0, 50.0, 270.0, 480.0, 0.0, 10.0, 0.0, 30.0, 0.0, 430.0, 30.0, 40.0, 170.0, 0.0, 40.0, 65.0, 100.0, 340.0, 70.0, 10.0, 20.0, 330.0, 110.0, 290.0, 110.0, 10.0, 50.0, 320.0, 10.0, 100.0, 280.0, 110.0, 40.0, 440.0, 50.0, 250.0, 160.0, 100.0, 65.0, 60.0, 30.0, 350.0, 10.0, -90.0, 0.0, 10.0, 60.0, 60.0, 80.0, 40.0, 40.0, 30.0, 60.0, 10.0, 480.0, 150.0, 70.0, 20.0, 150.0, 240.0, 90.0, 340.0, 60.0, 70.0, 10.0, 10.0, 70.0, 30.0, 40.0, 400.0, 30.0, 50.0, 30.0, 40.0, 40.0, 70.0, 270.0, 5.0, 20.0, 20.0, 0.0, 200.0, 460.0, 70.0, 20.0, 30.0, 270.0, -10.0, 200.0, 40.0, 340.0, 60.0, 620.0, 0.0, 210.0, 60.0, 270.0, 35.0, 20.0, 30.0, 150.0, 80.0, 20.0, 70.0, 160.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 340.0, -60.0, 110.0, 10.0, 40.0, 90.0, 30.0, 145.0, 230.0, 120.0, 390.0, 30.0, 120.0, 0.0, 0.0, 30.0, 0.0, 15.0, 70.0, 0.0, 0.0, 40.0, 30.0, 30.0, 20.0, 10.0, 30.0, 110.0, 10.0, 10.0, 10.0, 170.0, 0.0, 60.0, 40.0, 380.0, 40.0, 0.0, 20.0, 10.0, 60.0, 30.0, 0.0, 50.0, 90.0, 0.0, 160.0, 50.0, 270.0, 410.0, 430.0, 20.0, 60.0, -10.0, 40.0, 10.0, 110.0, 30.0, 110.0, 90.0, 20.0, 100.0, 550.0, 20.0, 150.0, 390.0, 170.0, 80.0, 180.0, 80.0, 40.0, 60.0, 50.0, 160.0, 190.0, 0.0, 190.0, 140.0, 30.0, 20.0, 70.0, 20.0, 100.0, 60.0, 20.0, 10.0, 60.0, 30.0, 130.0, 420.0, 10.0, 50.0, 160.0, 40.0, 60.0, 10.0, 30.0, 0.0, 40.0, 40.0, 40.0, 20.0, 30.0, 30.0, 50.0, 750.0, 80.0, 250.0, 130.0, -20.0, 100.0, 50.0, 30.0, 0.0, 60.0, 40.0, -20.0, 80.0, -30.0, 30.0, 180.0, 40.0, 70.0, 0.0, 260.0, 210.0, 190.0, 50.0, 40.0, 310.0, 70.0, 460.0, 10.0, 10.0, 20.0, 10.0, 210.0, 250.0, 110.0, 0.0, 30.0, 60.0, 30.0, 50.0, 90.0, 180.0, 190.0, 30.0, 290.0, 280.0, 70.0, 190.0, 270.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 120.0, 30.0, 20.0, 30.0, 10.0, 190.0, 30.0, 160.0, 90.0, 180.0, 10.0, 290.0, 220.0, 30.0, 0.0, 430.0, 60.0, 130.0, 50.0, 50.0, 310.0, 80.0, 140.0, 40.0, 60.0, 55.0, 110.0, 20.0, 320.0, 190.0, 40.0, 400.0, 80.0, 50.0, 100.0, 285.0, 90.0, 170.0, 0.0, 150.0, 270.0, 40.0, 50.0, 170.0, 200.0, 130.0, 100.0, 10.0, 160.0, 120.0, 10.0, 30.0, 10.0, 140.0, 740.0, 50.0, 210.0, 210.0, 70.0, 490.0, 80.0, 50.0, 220.0, 110.0, 10.0, 20.0, 40.0, 10.0, 20.0, 290.0, 110.0, 0.0, 60.0, 70.0, -10.0, 100.0, 80.0, 30.0, 40.0, 25.0, 60.0, 410.0, 370.0, 50.0, 0.0, 140.0, 0.0, 40.0, 320.0, 30.0, 30.0, 20.0, 10.0, 40.0, 40.0, 60.0, 10.0, 70.0, 160.0, 450.0, 180.0, -10.0, 50.0, 260.0, 100.0, 40.0, 80.0, 5.0, 30.0, 220.0, 50.0, 0.0, 90.0, 60.0, 180.0, 250.0, 420.0, 20.0, 0.0, 110.0, 50.0, 90.0, 40.0, 50.0, 40.0, 20.0, 40.0, 70.0, 180.0, 160.0, 10.0, 20.0, 60.0, 190.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 500.0, 30.0, 130.0, 90.0, 10.0, 30.0, 10.0, 20.0, 0.0, 70.0, 0.0, 0.0, 30.0, 20.0, 90.0, 80.0, 10.0, 0.0, 390.0, 200.0, 20.0, 10.0, 10.0, 250.0, 40.0, 40.0, 150.0, 490.0, 170.0, 270.0, 80.0, 40.0, 40.0, 130.0, 60.0, 90.0, 190.0, 110.0, 0.0, 20.0, 30.0, 90.0, 50.0, 40.0, 60.0, 200.0, 90.0, 190.0, 0.0, 10.0, 40.0, 30.0, 50.0, 80.0, -30.0, 380.0, 120.0, 30.0, 130.0, 90.0, 20.0, 20.0, 360.0, 20.0, 10.0, 10.0, 80.0, 60.0, 190.0, 50.0, 160.0, 100.0, 10.0, 20.0, 40.0, 290.0, 60.0, 30.0, 140.0, 210.0, 60.0, 40.0, 120.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.178675200191212, "mean_inference_ms": 2.031913774313818, "mean_action_processing_ms": 0.5778033390268366, "mean_env_wait_ms": 1.8619193148760016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013292789459228516, "StateBufferConnector_ms": 0.010558843612670898, "ViewRequirementAgentConnector_ms": 0.4095616340637207}, "num_episodes": 23, "episode_return_max": 2230.0, "episode_return_min": 110.0, "episode_return_mean": 968.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.5885091813066916, "num_env_steps_trained_throughput_per_sec": 1.5885091813066916, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 853442.336, "restore_workers_time_ms": 0.012, "training_step_time_ms": 853442.272, "sample_time_ms": 2761.597, "learn_time_ms": 850651.582, "learn_throughput": 4.702, "synch_weights_time_ms": 12.317}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 48, "trial_id": "3d3a5_00000", "date": "2024-06-01_03-57-40", "timestamp": 1717228660, "time_this_iter_s": 2518.1548171043396, "time_total_s": 19476.90284347534, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321bf64c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19476.90284347534, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.605723905723906, "ram_util_percent": 82.38148148148149}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.697142648842896, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.702935484448434, "policy_loss": -0.008435784730786523, "vf_loss": 6.7105518140478, "vf_explained_var": 0.0019521636323045237, "kl": 0.00819450407779906, "entropy": 0.48376233171477234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 455415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "env_runners": {"episode_reward_max": 2230.0, "episode_reward_min": 185.0, "episode_reward_mean": 980.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 98.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1010.0, 280.0, 1900.0, 1210.0, 1090.0, 1330.0, 930.0, 920.0, 1215.0, 1070.0, 1150.0, 1110.0, 790.0, 1000.0, 1070.0, 1530.0, 1440.0, 720.0, 260.0, 620.0, 440.0, 650.0, 1000.0, 1050.0, 470.0, 1140.0, 380.0, 650.0, 840.0, 1340.0, 1390.0, 540.0, 685.0, 710.0, 1375.0, 1470.0, 985.0, 390.0, 1670.0, 710.0, 1155.0, 1570.0, 945.0, 720.0, 1205.0, 185.0, 400.0, 640.0, 1540.0, 1050.0, 1220.0, 920.0, 950.0, 310.0, 1450.0, 450.0, 1600.0, 730.0, 1640.0, 240.0, 1210.0, 1290.0, 1325.0, 1325.0, 910.0, 2230.0, 630.0, 1155.0, 630.0, 1270.0, 675.0, 1210.0, 790.0, 1180.0, 190.0, 1060.0, 1450.0, 680.0, 750.0, 1140.0, 690.0, 1080.0, 1400.0, 760.0, 1330.0, 1110.0, 1430.0, 400.0, 1300.0, 290.0, 1080.0, 730.0, 930.0, 510.0, 635.0, 945.0, 1310.0, 750.0, 1570.0, 1270.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, -40.0, 360.0, 10.0, 50.0, 20.0, 360.0, -40.0, 40.0, 210.0, 30.0, 20.0, 40.0, 30.0, 40.0, 40.0, 0.0, 10.0, 40.0, 30.0, 60.0, 640.0, 50.0, 600.0, 40.0, 300.0, 40.0, 100.0, 100.0, -30.0, 300.0, 80.0, 40.0, 40.0, 20.0, -90.0, 20.0, 70.0, 170.0, 560.0, 180.0, 0.0, 90.0, 30.0, 30.0, 20.0, 220.0, 140.0, 0.0, 380.0, 80.0, 50.0, 110.0, 40.0, 390.0, 190.0, 280.0, 70.0, 100.0, 20.0, 390.0, -10.0, 160.0, 110.0, 80.0, 50.0, 60.0, 10.0, 180.0, -100.0, 50.0, 110.0, 90.0, 100.0, 170.0, 160.0, 70.0, 80.0, 50.0, 40.0, 20.0, 60.0, 70.0, 60.0, 0.0, -20.0, 25.0, 370.0, 30.0, 600.0, 390.0, 40.0, 30.0, 40.0, 30.0, 0.0, 80.0, 170.0, 270.0, 20.0, 20.0, 270.0, 40.0, 60.0, 60.0, 50.0, 80.0, 450.0, 70.0, 50.0, 20.0, 50.0, 10.0, 280.0, 160.0, 30.0, 470.0, 40.0, 60.0, -10.0, 160.0, 130.0, 40.0, 300.0, 180.0, 10.0, 40.0, -70.0, -30.0, 30.0, 30.0, 30.0, 30.0, 20.0, 410.0, 10.0, 20.0, 50.0, 120.0, 280.0, 10.0, 40.0, 50.0, 240.0, 290.0, 80.0, 180.0, 100.0, 40.0, 40.0, 30.0, 60.0, 0.0, 650.0, 410.0, 120.0, 20.0, 50.0, 160.0, 30.0, 60.0, 750.0, 300.0, 40.0, 200.0, 40.0, -70.0, 90.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 150.0, 20.0, 180.0, 60.0, 170.0, 10.0, 0.0, 40.0, 0.0, 100.0, 0.0, 0.0, 60.0, 50.0, 0.0, 10.0, 20.0, 0.0, 50.0, 180.0, 0.0, 50.0, 170.0, 20.0, 40.0, 90.0, 50.0, 30.0, 0.0, 10.0, 20.0, 10.0, 200.0, 10.0, 10.0, 100.0, 200.0, 20.0, 170.0, 30.0, -30.0, 50.0, 60.0, 20.0, 70.0, 60.0, -50.0, 20.0, 80.0, 0.0, 190.0, 40.0, 260.0, 150.0, 30.0, 280.0, 150.0, 70.0, 40.0, 30.0, 40.0, 570.0, 140.0, 0.0, 10.0, 0.0, 150.0, 40.0, 80.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 80.0, 200.0, 100.0, 150.0, 290.0, 100.0, 90.0, 120.0, 10.0, 0.0, 20.0, 60.0, 40.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 40.0, 20.0, 10.0, 60.0, 20.0, 190.0, 40.0, 100.0, 40.0, 70.0, 100.0, 0.0, 170.0, 20.0, 60.0, 110.0, 40.0, 220.0, 10.0, 110.0, 100.0, 380.0, 40.0, 40.0, 40.0, 220.0, 130.0, 90.0, 0.0, 400.0, 0.0, 20.0, 50.0, 160.0, 40.0, 110.0, 430.0, 230.0, 0.0, 260.0, 90.0, 0.0, 70.0, 80.0, 30.0, 260.0, 20.0, 10.0, 30.0, 0.0, 40.0, -30.0, 150.0, -5.0, 10.0, 0.0, 50.0, -290.0, 50.0, 270.0, 480.0, 0.0, 10.0, 0.0, 30.0, 0.0, 430.0, 30.0, 40.0, 170.0, 0.0, 40.0, 65.0, 100.0, 340.0, 70.0, 10.0, 20.0, 330.0, 110.0, 290.0, 110.0, 10.0, 50.0, 320.0, 10.0, 100.0, 280.0, 110.0, 40.0, 440.0, 50.0, 250.0, 160.0, 100.0, 65.0, 60.0, 30.0, 350.0, 10.0, -90.0, 0.0, 10.0, 60.0, 60.0, 80.0, 40.0, 40.0, 30.0, 60.0, 10.0, 480.0, 150.0, 70.0, 20.0, 150.0, 240.0, 90.0, 340.0, 60.0, 70.0, 10.0, 10.0, 70.0, 30.0, 40.0, 400.0, 30.0, 50.0, 30.0, 40.0, 40.0, 70.0, 270.0, 5.0, 20.0, 20.0, 0.0, 200.0, 460.0, 70.0, 20.0, 30.0, 270.0, -10.0, 200.0, 40.0, 340.0, 60.0, 620.0, 0.0, 210.0, 60.0, 270.0, 35.0, 20.0, 30.0, 150.0, 80.0, 20.0, 70.0, 160.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 340.0, -60.0, 110.0, 10.0, 40.0, 90.0, 30.0, 145.0, 230.0, 120.0, 390.0, 30.0, 120.0, 0.0, 0.0, 30.0, 0.0, 15.0, 70.0, 0.0, 0.0, 40.0, 30.0, 30.0, 20.0, 10.0, 30.0, 110.0, 10.0, 10.0, 10.0, 170.0, 0.0, 60.0, 40.0, 380.0, 40.0, 0.0, 20.0, 10.0, 60.0, 30.0, 0.0, 50.0, 90.0, 0.0, 160.0, 50.0, 270.0, 410.0, 430.0, 20.0, 60.0, -10.0, 40.0, 10.0, 110.0, 30.0, 110.0, 90.0, 20.0, 100.0, 550.0, 20.0, 150.0, 390.0, 170.0, 80.0, 180.0, 80.0, 40.0, 60.0, 50.0, 160.0, 190.0, 0.0, 190.0, 140.0, 30.0, 20.0, 70.0, 20.0, 100.0, 60.0, 20.0, 10.0, 60.0, 30.0, 130.0, 420.0, 10.0, 50.0, 160.0, 40.0, 60.0, 10.0, 30.0, 0.0, 40.0, 40.0, 40.0, 20.0, 30.0, 30.0, 50.0, 750.0, 80.0, 250.0, 130.0, -20.0, 100.0, 50.0, 30.0, 0.0, 60.0, 40.0, -20.0, 80.0, -30.0, 30.0, 180.0, 40.0, 70.0, 0.0, 260.0, 210.0, 190.0, 50.0, 40.0, 310.0, 70.0, 460.0, 10.0, 10.0, 20.0, 10.0, 210.0, 250.0, 110.0, 0.0, 30.0, 60.0, 30.0, 50.0, 90.0, 180.0, 190.0, 30.0, 290.0, 280.0, 70.0, 190.0, 270.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 120.0, 30.0, 20.0, 30.0, 10.0, 190.0, 30.0, 160.0, 90.0, 180.0, 10.0, 290.0, 220.0, 30.0, 0.0, 430.0, 60.0, 130.0, 50.0, 50.0, 310.0, 80.0, 140.0, 40.0, 60.0, 55.0, 110.0, 20.0, 320.0, 190.0, 40.0, 400.0, 80.0, 50.0, 100.0, 285.0, 90.0, 170.0, 0.0, 150.0, 270.0, 40.0, 50.0, 170.0, 200.0, 130.0, 100.0, 10.0, 160.0, 120.0, 10.0, 30.0, 10.0, 140.0, 740.0, 50.0, 210.0, 210.0, 70.0, 490.0, 80.0, 50.0, 220.0, 110.0, 10.0, 20.0, 40.0, 10.0, 20.0, 290.0, 110.0, 0.0, 60.0, 70.0, -10.0, 100.0, 80.0, 30.0, 40.0, 25.0, 60.0, 410.0, 370.0, 50.0, 0.0, 140.0, 0.0, 40.0, 320.0, 30.0, 30.0, 20.0, 10.0, 40.0, 40.0, 60.0, 10.0, 70.0, 160.0, 450.0, 180.0, -10.0, 50.0, 260.0, 100.0, 40.0, 80.0, 5.0, 30.0, 220.0, 50.0, 0.0, 90.0, 60.0, 180.0, 250.0, 420.0, 20.0, 0.0, 110.0, 50.0, 90.0, 40.0, 50.0, 40.0, 20.0, 40.0, 70.0, 180.0, 160.0, 10.0, 20.0, 60.0, 190.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 500.0, 30.0, 130.0, 90.0, 10.0, 30.0, 10.0, 20.0, 0.0, 70.0, 0.0, 0.0, 30.0, 20.0, 90.0, 80.0, 10.0, 0.0, 390.0, 200.0, 20.0, 10.0, 10.0, 250.0, 40.0, 40.0, 150.0, 490.0, 170.0, 270.0, 80.0, 40.0, 40.0, 130.0, 60.0, 90.0, 190.0, 110.0, 0.0, 20.0, 30.0, 90.0, 50.0, 40.0, 60.0, 200.0, 90.0, 190.0, 0.0, 10.0, 40.0, 30.0, 50.0, 80.0, -30.0, 380.0, 120.0, 30.0, 130.0, 90.0, 20.0, 20.0, 360.0, 20.0, 10.0, 10.0, 80.0, 60.0, 190.0, 50.0, 160.0, 100.0, 10.0, 20.0, 40.0, 290.0, 60.0, 30.0, 140.0, 210.0, 60.0, 40.0, 120.0, 90.0, 320.0, -40.0, 190.0, 0.0, 20.0, 90.0, 460.0, 310.0, 40.0, 10.0, 40.0, 20.0, 10.0, 30.0, 40.0, 380.0, 20.0, 30.0, 0.0, 190.0, 180.0, 0.0, 170.0, 130.0, 40.0, 100.0, 50.0, 70.0, 80.0, 510.0, 70.0, -40.0, 130.0, 120.0, 260.0, 30.0, 340.0, 40.0, 180.0, -20.0, 520.0, 80.0, 20.0, 70.0, 260.0, 30.0, 160.0, 40.0, 90.0, 160.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 290.0, 70.0, 20.0, 40.0, 90.0, 210.0, 130.0, 230.0, 360.0, 50.0, 50.0, 130.0, 10.0, 10.0, 40.0, 10.0, 0.0, 40.0, 20.0, 70.0, 30.0, 20.0, 50.0, 10.0, 50.0, 200.0, 30.0, 90.0, 20.0, 320.0, 150.0, 100.0, 110.0, 290.0, 180.0, 30.0, 20.0, 10.0, 30.0, 100.0, 20.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 190.0, 270.0, 20.0, 250.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 220.0, 50.0, 0.0, 130.0, 20.0, 60.0, 30.0, 0.0, 330.0, 15.0, 50.0, 30.0, 80.0, 20.0, 200.0, 30.0, 40.0, 30.0, 150.0, 155.0, 220.0, 20.0, 80.0, 20.0, 10.0, 200.0, 60.0, 100.0, 570.0, 70.0, 30.0, 40.0, 170.0, 60.0, 50.0, 50.0, 70.0, 0.0, 0.0, 20.0, 100.0, 380.0, 40.0, 40.0, 30.0, 440.0, 100.0, 50.0, 130.0, 150.0, 320.0, 230.0, 70.0, 50.0, 180.0, 190.0, 130.0, 290.0, 380.0, 60.0, -30.0, 90.0, -90.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1785096429058153, "mean_inference_ms": 2.03980721450878, "mean_action_processing_ms": 0.578111172431884, "mean_env_wait_ms": 1.8634360947844164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014227151870727539, "StateBufferConnector_ms": 0.02612757682800293, "ViewRequirementAgentConnector_ms": 0.6367611885070801}, "num_episodes": 18, "episode_return_max": 2230.0, "episode_return_min": 185.0, "episode_return_mean": 980.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.3742876931318975, "num_env_steps_trained_throughput_per_sec": 3.3742876931318975, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 1960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1960000, "timers": {"training_iteration_time_ms": 952195.321, "restore_workers_time_ms": 0.014, "training_step_time_ms": 952195.252, "sample_time_ms": 3260.382, "learn_time_ms": 948905.043, "learn_throughput": 4.215, "synch_weights_time_ms": 12.808}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "done": false, "training_iteration": 49, "trial_id": "3d3a5_00000", "date": "2024-06-01_04-17-25", "timestamp": 1717229845, "time_this_iter_s": 1185.4649741649628, "time_total_s": 20662.367817640305, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f80b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20662.367817640305, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 23.13074324324324, "ram_util_percent": 82.45540540540541}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7521170955052137, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.2931969309005495, "policy_loss": -0.00804386588357264, "vf_loss": 6.300473404540041, "vf_explained_var": 0.0010169068718362793, "kl": 0.007673768740594563, "entropy": 0.47085309375843176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 464805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 2230.0, "episode_reward_min": 185.0, "episode_reward_mean": 949.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 94.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [260.0, 620.0, 440.0, 650.0, 1000.0, 1050.0, 470.0, 1140.0, 380.0, 650.0, 840.0, 1340.0, 1390.0, 540.0, 685.0, 710.0, 1375.0, 1470.0, 985.0, 390.0, 1670.0, 710.0, 1155.0, 1570.0, 945.0, 720.0, 1205.0, 185.0, 400.0, 640.0, 1540.0, 1050.0, 1220.0, 920.0, 950.0, 310.0, 1450.0, 450.0, 1600.0, 730.0, 1640.0, 240.0, 1210.0, 1290.0, 1325.0, 1325.0, 910.0, 2230.0, 630.0, 1155.0, 630.0, 1270.0, 675.0, 1210.0, 790.0, 1180.0, 190.0, 1060.0, 1450.0, 680.0, 750.0, 1140.0, 690.0, 1080.0, 1400.0, 760.0, 1330.0, 1110.0, 1430.0, 400.0, 1300.0, 290.0, 1080.0, 730.0, 930.0, 510.0, 635.0, 945.0, 1310.0, 750.0, 1570.0, 1270.0, 1760.0, 420.0, 795.0, 1110.0, 1140.0, 1300.0, 1010.0, 250.0, 300.0, 390.0, 1070.0, 970.0, 730.0, 1015.0, 1510.0, 1030.0, 1170.0, 650.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 40.0, 0.0, 100.0, 0.0, 0.0, 60.0, 50.0, 0.0, 10.0, 20.0, 0.0, 50.0, 180.0, 0.0, 50.0, 170.0, 20.0, 40.0, 90.0, 50.0, 30.0, 0.0, 10.0, 20.0, 10.0, 200.0, 10.0, 10.0, 100.0, 200.0, 20.0, 170.0, 30.0, -30.0, 50.0, 60.0, 20.0, 70.0, 60.0, -50.0, 20.0, 80.0, 0.0, 190.0, 40.0, 260.0, 150.0, 30.0, 280.0, 150.0, 70.0, 40.0, 30.0, 40.0, 570.0, 140.0, 0.0, 10.0, 0.0, 150.0, 40.0, 80.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 80.0, 200.0, 100.0, 150.0, 290.0, 100.0, 90.0, 120.0, 10.0, 0.0, 20.0, 60.0, 40.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 40.0, 20.0, 10.0, 60.0, 20.0, 190.0, 40.0, 100.0, 40.0, 70.0, 100.0, 0.0, 170.0, 20.0, 60.0, 110.0, 40.0, 220.0, 10.0, 110.0, 100.0, 380.0, 40.0, 40.0, 40.0, 220.0, 130.0, 90.0, 0.0, 400.0, 0.0, 20.0, 50.0, 160.0, 40.0, 110.0, 430.0, 230.0, 0.0, 260.0, 90.0, 0.0, 70.0, 80.0, 30.0, 260.0, 20.0, 10.0, 30.0, 0.0, 40.0, -30.0, 150.0, -5.0, 10.0, 0.0, 50.0, -290.0, 50.0, 270.0, 480.0, 0.0, 10.0, 0.0, 30.0, 0.0, 430.0, 30.0, 40.0, 170.0, 0.0, 40.0, 65.0, 100.0, 340.0, 70.0, 10.0, 20.0, 330.0, 110.0, 290.0, 110.0, 10.0, 50.0, 320.0, 10.0, 100.0, 280.0, 110.0, 40.0, 440.0, 50.0, 250.0, 160.0, 100.0, 65.0, 60.0, 30.0, 350.0, 10.0, -90.0, 0.0, 10.0, 60.0, 60.0, 80.0, 40.0, 40.0, 30.0, 60.0, 10.0, 480.0, 150.0, 70.0, 20.0, 150.0, 240.0, 90.0, 340.0, 60.0, 70.0, 10.0, 10.0, 70.0, 30.0, 40.0, 400.0, 30.0, 50.0, 30.0, 40.0, 40.0, 70.0, 270.0, 5.0, 20.0, 20.0, 0.0, 200.0, 460.0, 70.0, 20.0, 30.0, 270.0, -10.0, 200.0, 40.0, 340.0, 60.0, 620.0, 0.0, 210.0, 60.0, 270.0, 35.0, 20.0, 30.0, 150.0, 80.0, 20.0, 70.0, 160.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 340.0, -60.0, 110.0, 10.0, 40.0, 90.0, 30.0, 145.0, 230.0, 120.0, 390.0, 30.0, 120.0, 0.0, 0.0, 30.0, 0.0, 15.0, 70.0, 0.0, 0.0, 40.0, 30.0, 30.0, 20.0, 10.0, 30.0, 110.0, 10.0, 10.0, 10.0, 170.0, 0.0, 60.0, 40.0, 380.0, 40.0, 0.0, 20.0, 10.0, 60.0, 30.0, 0.0, 50.0, 90.0, 0.0, 160.0, 50.0, 270.0, 410.0, 430.0, 20.0, 60.0, -10.0, 40.0, 10.0, 110.0, 30.0, 110.0, 90.0, 20.0, 100.0, 550.0, 20.0, 150.0, 390.0, 170.0, 80.0, 180.0, 80.0, 40.0, 60.0, 50.0, 160.0, 190.0, 0.0, 190.0, 140.0, 30.0, 20.0, 70.0, 20.0, 100.0, 60.0, 20.0, 10.0, 60.0, 30.0, 130.0, 420.0, 10.0, 50.0, 160.0, 40.0, 60.0, 10.0, 30.0, 0.0, 40.0, 40.0, 40.0, 20.0, 30.0, 30.0, 50.0, 750.0, 80.0, 250.0, 130.0, -20.0, 100.0, 50.0, 30.0, 0.0, 60.0, 40.0, -20.0, 80.0, -30.0, 30.0, 180.0, 40.0, 70.0, 0.0, 260.0, 210.0, 190.0, 50.0, 40.0, 310.0, 70.0, 460.0, 10.0, 10.0, 20.0, 10.0, 210.0, 250.0, 110.0, 0.0, 30.0, 60.0, 30.0, 50.0, 90.0, 180.0, 190.0, 30.0, 290.0, 280.0, 70.0, 190.0, 270.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 120.0, 30.0, 20.0, 30.0, 10.0, 190.0, 30.0, 160.0, 90.0, 180.0, 10.0, 290.0, 220.0, 30.0, 0.0, 430.0, 60.0, 130.0, 50.0, 50.0, 310.0, 80.0, 140.0, 40.0, 60.0, 55.0, 110.0, 20.0, 320.0, 190.0, 40.0, 400.0, 80.0, 50.0, 100.0, 285.0, 90.0, 170.0, 0.0, 150.0, 270.0, 40.0, 50.0, 170.0, 200.0, 130.0, 100.0, 10.0, 160.0, 120.0, 10.0, 30.0, 10.0, 140.0, 740.0, 50.0, 210.0, 210.0, 70.0, 490.0, 80.0, 50.0, 220.0, 110.0, 10.0, 20.0, 40.0, 10.0, 20.0, 290.0, 110.0, 0.0, 60.0, 70.0, -10.0, 100.0, 80.0, 30.0, 40.0, 25.0, 60.0, 410.0, 370.0, 50.0, 0.0, 140.0, 0.0, 40.0, 320.0, 30.0, 30.0, 20.0, 10.0, 40.0, 40.0, 60.0, 10.0, 70.0, 160.0, 450.0, 180.0, -10.0, 50.0, 260.0, 100.0, 40.0, 80.0, 5.0, 30.0, 220.0, 50.0, 0.0, 90.0, 60.0, 180.0, 250.0, 420.0, 20.0, 0.0, 110.0, 50.0, 90.0, 40.0, 50.0, 40.0, 20.0, 40.0, 70.0, 180.0, 160.0, 10.0, 20.0, 60.0, 190.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 500.0, 30.0, 130.0, 90.0, 10.0, 30.0, 10.0, 20.0, 0.0, 70.0, 0.0, 0.0, 30.0, 20.0, 90.0, 80.0, 10.0, 0.0, 390.0, 200.0, 20.0, 10.0, 10.0, 250.0, 40.0, 40.0, 150.0, 490.0, 170.0, 270.0, 80.0, 40.0, 40.0, 130.0, 60.0, 90.0, 190.0, 110.0, 0.0, 20.0, 30.0, 90.0, 50.0, 40.0, 60.0, 200.0, 90.0, 190.0, 0.0, 10.0, 40.0, 30.0, 50.0, 80.0, -30.0, 380.0, 120.0, 30.0, 130.0, 90.0, 20.0, 20.0, 360.0, 20.0, 10.0, 10.0, 80.0, 60.0, 190.0, 50.0, 160.0, 100.0, 10.0, 20.0, 40.0, 290.0, 60.0, 30.0, 140.0, 210.0, 60.0, 40.0, 120.0, 90.0, 320.0, -40.0, 190.0, 0.0, 20.0, 90.0, 460.0, 310.0, 40.0, 10.0, 40.0, 20.0, 10.0, 30.0, 40.0, 380.0, 20.0, 30.0, 0.0, 190.0, 180.0, 0.0, 170.0, 130.0, 40.0, 100.0, 50.0, 70.0, 80.0, 510.0, 70.0, -40.0, 130.0, 120.0, 260.0, 30.0, 340.0, 40.0, 180.0, -20.0, 520.0, 80.0, 20.0, 70.0, 260.0, 30.0, 160.0, 40.0, 90.0, 160.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 290.0, 70.0, 20.0, 40.0, 90.0, 210.0, 130.0, 230.0, 360.0, 50.0, 50.0, 130.0, 10.0, 10.0, 40.0, 10.0, 0.0, 40.0, 20.0, 70.0, 30.0, 20.0, 50.0, 10.0, 50.0, 200.0, 30.0, 90.0, 20.0, 320.0, 150.0, 100.0, 110.0, 290.0, 180.0, 30.0, 20.0, 10.0, 30.0, 100.0, 20.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 190.0, 270.0, 20.0, 250.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 220.0, 50.0, 0.0, 130.0, 20.0, 60.0, 30.0, 0.0, 330.0, 15.0, 50.0, 30.0, 80.0, 20.0, 200.0, 30.0, 40.0, 30.0, 150.0, 155.0, 220.0, 20.0, 80.0, 20.0, 10.0, 200.0, 60.0, 100.0, 570.0, 70.0, 30.0, 40.0, 170.0, 60.0, 50.0, 50.0, 70.0, 0.0, 0.0, 20.0, 100.0, 380.0, 40.0, 40.0, 30.0, 440.0, 100.0, 50.0, 130.0, 150.0, 320.0, 230.0, 70.0, 50.0, 180.0, 190.0, 130.0, 290.0, 380.0, 60.0, -30.0, 90.0, -90.0, 70.0, 150.0, 190.0, 560.0, 30.0, 80.0, 90.0, 30.0, 180.0, -70.0, 520.0, 40.0, 30.0, 0.0, 40.0, 20.0, 120.0, 20.0, 20.0, 100.0, 30.0, 20.0, 0.0, 35.0, 120.0, 120.0, 10.0, 20.0, 50.0, 380.0, 40.0, 30.0, 180.0, 240.0, 80.0, 50.0, 10.0, 60.0, 70.0, -40.0, 430.0, -50.0, 160.0, 50.0, 70.0, 90.0, 10.0, 170.0, 350.0, 70.0, 220.0, 80.0, 180.0, 390.0, 100.0, 30.0, 70.0, 20.0, 250.0, 80.0, 100.0, 60.0, 50.0, 150.0, 200.0, 120.0, -30.0, -10.0, 30.0, 360.0, 80.0, 30.0, 50.0, 10.0, 110.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 0.0, 10.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 0.0, 20.0, 150.0, 10.0, 0.0, 0.0, 50.0, 20.0, 140.0, 150.0, 300.0, 240.0, 40.0, 0.0, 80.0, 90.0, 160.0, 10.0, 0.0, 200.0, 110.0, 40.0, 90.0, 10.0, 70.0, 90.0, 30.0, 360.0, -30.0, 190.0, 20.0, 40.0, 0.0, 70.0, 60.0, 40.0, 170.0, -20.0, 160.0, 35.0, 210.0, 60.0, 50.0, 20.0, 70.0, 50.0, 190.0, 120.0, 210.0, 100.0, 40.0, 100.0, 10.0, 80.0, 520.0, 270.0, 20.0, 60.0, 310.0, 20.0, 0.0, 500.0, 0.0, -30.0, 90.0, 40.0, 0.0, 90.0, 320.0, 230.0, 80.0, 70.0, 40.0, 30.0, 200.0, 90.0, -20.0, 410.0, 40.0, 80.0, 80.0, 180.0, 30.0, 20.0, 10.0, 10.0, 220.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.176807658060661, "mean_inference_ms": 2.0458667657087863, "mean_action_processing_ms": 0.5779748701923031, "mean_env_wait_ms": 1.8638047469370806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01564955711364746, "StateBufferConnector_ms": 0.0259401798248291, "ViewRequirementAgentConnector_ms": 0.6272516250610352}, "num_episodes": 18, "episode_return_max": 2230.0, "episode_return_min": 185.0, "episode_return_mean": 949.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.5794027038875513, "num_env_steps_trained_throughput_per_sec": 3.5794027038875513, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 1043884.743, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1043884.674, "sample_time_ms": 3275.199, "learn_time_ms": 1040578.497, "learn_throughput": 3.844, "synch_weights_time_ms": 13.804}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 50, "trial_id": "3d3a5_00000", "date": "2024-06-01_04-36-03", "timestamp": 1717230963, "time_this_iter_s": 1117.5401890277863, "time_total_s": 21779.90800666809, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f85aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21779.90800666809, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 26.009342560553634, "ram_util_percent": 80.69446366782007}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.684272709181007, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6964533155845505, "policy_loss": -0.008801369445003704, "vf_loss": 6.704520946925187, "vf_explained_var": 3.1868553263183856e-06, "kl": 0.007337379857855962, "entropy": 0.4640206929403372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 474195.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 2230.0, "episode_reward_min": 185.0, "episode_reward_mean": 1013.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 101.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [985.0, 390.0, 1670.0, 710.0, 1155.0, 1570.0, 945.0, 720.0, 1205.0, 185.0, 400.0, 640.0, 1540.0, 1050.0, 1220.0, 920.0, 950.0, 310.0, 1450.0, 450.0, 1600.0, 730.0, 1640.0, 240.0, 1210.0, 1290.0, 1325.0, 1325.0, 910.0, 2230.0, 630.0, 1155.0, 630.0, 1270.0, 675.0, 1210.0, 790.0, 1180.0, 190.0, 1060.0, 1450.0, 680.0, 750.0, 1140.0, 690.0, 1080.0, 1400.0, 760.0, 1330.0, 1110.0, 1430.0, 400.0, 1300.0, 290.0, 1080.0, 730.0, 930.0, 510.0, 635.0, 945.0, 1310.0, 750.0, 1570.0, 1270.0, 1760.0, 420.0, 795.0, 1110.0, 1140.0, 1300.0, 1010.0, 250.0, 300.0, 390.0, 1070.0, 970.0, 730.0, 1015.0, 1510.0, 1030.0, 1170.0, 650.0, 1430.0, 2110.0, 610.0, 1150.0, 1630.0, 1030.0, 835.0, 1180.0, 1990.0, 1080.0, 1140.0, 810.0, 1390.0, 1080.0, 1140.0, 1215.0, 1215.0, 380.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 250.0, 160.0, 100.0, 65.0, 60.0, 30.0, 350.0, 10.0, -90.0, 0.0, 10.0, 60.0, 60.0, 80.0, 40.0, 40.0, 30.0, 60.0, 10.0, 480.0, 150.0, 70.0, 20.0, 150.0, 240.0, 90.0, 340.0, 60.0, 70.0, 10.0, 10.0, 70.0, 30.0, 40.0, 400.0, 30.0, 50.0, 30.0, 40.0, 40.0, 70.0, 270.0, 5.0, 20.0, 20.0, 0.0, 200.0, 460.0, 70.0, 20.0, 30.0, 270.0, -10.0, 200.0, 40.0, 340.0, 60.0, 620.0, 0.0, 210.0, 60.0, 270.0, 35.0, 20.0, 30.0, 150.0, 80.0, 20.0, 70.0, 160.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 340.0, -60.0, 110.0, 10.0, 40.0, 90.0, 30.0, 145.0, 230.0, 120.0, 390.0, 30.0, 120.0, 0.0, 0.0, 30.0, 0.0, 15.0, 70.0, 0.0, 0.0, 40.0, 30.0, 30.0, 20.0, 10.0, 30.0, 110.0, 10.0, 10.0, 10.0, 170.0, 0.0, 60.0, 40.0, 380.0, 40.0, 0.0, 20.0, 10.0, 60.0, 30.0, 0.0, 50.0, 90.0, 0.0, 160.0, 50.0, 270.0, 410.0, 430.0, 20.0, 60.0, -10.0, 40.0, 10.0, 110.0, 30.0, 110.0, 90.0, 20.0, 100.0, 550.0, 20.0, 150.0, 390.0, 170.0, 80.0, 180.0, 80.0, 40.0, 60.0, 50.0, 160.0, 190.0, 0.0, 190.0, 140.0, 30.0, 20.0, 70.0, 20.0, 100.0, 60.0, 20.0, 10.0, 60.0, 30.0, 130.0, 420.0, 10.0, 50.0, 160.0, 40.0, 60.0, 10.0, 30.0, 0.0, 40.0, 40.0, 40.0, 20.0, 30.0, 30.0, 50.0, 750.0, 80.0, 250.0, 130.0, -20.0, 100.0, 50.0, 30.0, 0.0, 60.0, 40.0, -20.0, 80.0, -30.0, 30.0, 180.0, 40.0, 70.0, 0.0, 260.0, 210.0, 190.0, 50.0, 40.0, 310.0, 70.0, 460.0, 10.0, 10.0, 20.0, 10.0, 210.0, 250.0, 110.0, 0.0, 30.0, 60.0, 30.0, 50.0, 90.0, 180.0, 190.0, 30.0, 290.0, 280.0, 70.0, 190.0, 270.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 120.0, 30.0, 20.0, 30.0, 10.0, 190.0, 30.0, 160.0, 90.0, 180.0, 10.0, 290.0, 220.0, 30.0, 0.0, 430.0, 60.0, 130.0, 50.0, 50.0, 310.0, 80.0, 140.0, 40.0, 60.0, 55.0, 110.0, 20.0, 320.0, 190.0, 40.0, 400.0, 80.0, 50.0, 100.0, 285.0, 90.0, 170.0, 0.0, 150.0, 270.0, 40.0, 50.0, 170.0, 200.0, 130.0, 100.0, 10.0, 160.0, 120.0, 10.0, 30.0, 10.0, 140.0, 740.0, 50.0, 210.0, 210.0, 70.0, 490.0, 80.0, 50.0, 220.0, 110.0, 10.0, 20.0, 40.0, 10.0, 20.0, 290.0, 110.0, 0.0, 60.0, 70.0, -10.0, 100.0, 80.0, 30.0, 40.0, 25.0, 60.0, 410.0, 370.0, 50.0, 0.0, 140.0, 0.0, 40.0, 320.0, 30.0, 30.0, 20.0, 10.0, 40.0, 40.0, 60.0, 10.0, 70.0, 160.0, 450.0, 180.0, -10.0, 50.0, 260.0, 100.0, 40.0, 80.0, 5.0, 30.0, 220.0, 50.0, 0.0, 90.0, 60.0, 180.0, 250.0, 420.0, 20.0, 0.0, 110.0, 50.0, 90.0, 40.0, 50.0, 40.0, 20.0, 40.0, 70.0, 180.0, 160.0, 10.0, 20.0, 60.0, 190.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 500.0, 30.0, 130.0, 90.0, 10.0, 30.0, 10.0, 20.0, 0.0, 70.0, 0.0, 0.0, 30.0, 20.0, 90.0, 80.0, 10.0, 0.0, 390.0, 200.0, 20.0, 10.0, 10.0, 250.0, 40.0, 40.0, 150.0, 490.0, 170.0, 270.0, 80.0, 40.0, 40.0, 130.0, 60.0, 90.0, 190.0, 110.0, 0.0, 20.0, 30.0, 90.0, 50.0, 40.0, 60.0, 200.0, 90.0, 190.0, 0.0, 10.0, 40.0, 30.0, 50.0, 80.0, -30.0, 380.0, 120.0, 30.0, 130.0, 90.0, 20.0, 20.0, 360.0, 20.0, 10.0, 10.0, 80.0, 60.0, 190.0, 50.0, 160.0, 100.0, 10.0, 20.0, 40.0, 290.0, 60.0, 30.0, 140.0, 210.0, 60.0, 40.0, 120.0, 90.0, 320.0, -40.0, 190.0, 0.0, 20.0, 90.0, 460.0, 310.0, 40.0, 10.0, 40.0, 20.0, 10.0, 30.0, 40.0, 380.0, 20.0, 30.0, 0.0, 190.0, 180.0, 0.0, 170.0, 130.0, 40.0, 100.0, 50.0, 70.0, 80.0, 510.0, 70.0, -40.0, 130.0, 120.0, 260.0, 30.0, 340.0, 40.0, 180.0, -20.0, 520.0, 80.0, 20.0, 70.0, 260.0, 30.0, 160.0, 40.0, 90.0, 160.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 290.0, 70.0, 20.0, 40.0, 90.0, 210.0, 130.0, 230.0, 360.0, 50.0, 50.0, 130.0, 10.0, 10.0, 40.0, 10.0, 0.0, 40.0, 20.0, 70.0, 30.0, 20.0, 50.0, 10.0, 50.0, 200.0, 30.0, 90.0, 20.0, 320.0, 150.0, 100.0, 110.0, 290.0, 180.0, 30.0, 20.0, 10.0, 30.0, 100.0, 20.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 190.0, 270.0, 20.0, 250.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 220.0, 50.0, 0.0, 130.0, 20.0, 60.0, 30.0, 0.0, 330.0, 15.0, 50.0, 30.0, 80.0, 20.0, 200.0, 30.0, 40.0, 30.0, 150.0, 155.0, 220.0, 20.0, 80.0, 20.0, 10.0, 200.0, 60.0, 100.0, 570.0, 70.0, 30.0, 40.0, 170.0, 60.0, 50.0, 50.0, 70.0, 0.0, 0.0, 20.0, 100.0, 380.0, 40.0, 40.0, 30.0, 440.0, 100.0, 50.0, 130.0, 150.0, 320.0, 230.0, 70.0, 50.0, 180.0, 190.0, 130.0, 290.0, 380.0, 60.0, -30.0, 90.0, -90.0, 70.0, 150.0, 190.0, 560.0, 30.0, 80.0, 90.0, 30.0, 180.0, -70.0, 520.0, 40.0, 30.0, 0.0, 40.0, 20.0, 120.0, 20.0, 20.0, 100.0, 30.0, 20.0, 0.0, 35.0, 120.0, 120.0, 10.0, 20.0, 50.0, 380.0, 40.0, 30.0, 180.0, 240.0, 80.0, 50.0, 10.0, 60.0, 70.0, -40.0, 430.0, -50.0, 160.0, 50.0, 70.0, 90.0, 10.0, 170.0, 350.0, 70.0, 220.0, 80.0, 180.0, 390.0, 100.0, 30.0, 70.0, 20.0, 250.0, 80.0, 100.0, 60.0, 50.0, 150.0, 200.0, 120.0, -30.0, -10.0, 30.0, 360.0, 80.0, 30.0, 50.0, 10.0, 110.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 0.0, 10.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 0.0, 20.0, 150.0, 10.0, 0.0, 0.0, 50.0, 20.0, 140.0, 150.0, 300.0, 240.0, 40.0, 0.0, 80.0, 90.0, 160.0, 10.0, 0.0, 200.0, 110.0, 40.0, 90.0, 10.0, 70.0, 90.0, 30.0, 360.0, -30.0, 190.0, 20.0, 40.0, 0.0, 70.0, 60.0, 40.0, 170.0, -20.0, 160.0, 35.0, 210.0, 60.0, 50.0, 20.0, 70.0, 50.0, 190.0, 120.0, 210.0, 100.0, 40.0, 100.0, 10.0, 80.0, 520.0, 270.0, 20.0, 60.0, 310.0, 20.0, 0.0, 500.0, 0.0, -30.0, 90.0, 40.0, 0.0, 90.0, 320.0, 230.0, 80.0, 70.0, 40.0, 30.0, 200.0, 90.0, -20.0, 410.0, 40.0, 80.0, 80.0, 180.0, 30.0, 20.0, 10.0, 10.0, 220.0, 20.0, 0.0, 110.0, 370.0, 390.0, 150.0, 210.0, 20.0, 50.0, 30.0, 100.0, 0.0, 100.0, 50.0, 70.0, 310.0, 160.0, 120.0, 220.0, 800.0, 110.0, 170.0, 70.0, 50.0, 20.0, 0.0, 220.0, 50.0, 190.0, 50.0, -40.0, 0.0, 30.0, 50.0, 90.0, 30.0, 70.0, 400.0, 40.0, 80.0, 70.0, 290.0, 60.0, 160.0, 60.0, 170.0, 30.0, 270.0, 40.0, 490.0, 260.0, 90.0, 20.0, 190.0, 80.0, 150.0, 60.0, 20.0, 160.0, 300.0, 10.0, 40.0, 410.0, 30.0, 190.0, 70.0, 30.0, -15.0, 10.0, 20.0, 50.0, 40.0, 210.0, 420.0, 50.0, 100.0, 210.0, 40.0, 10.0, 50.0, 80.0, 10.0, 90.0, 130.0, 40.0, 600.0, 80.0, 420.0, -30.0, 560.0, 70.0, 30.0, 110.0, 40.0, 70.0, 0.0, 60.0, 40.0, 170.0, 220.0, 350.0, 20.0, 60.0, 290.0, 10.0, 50.0, 210.0, 90.0, 250.0, 170.0, 0.0, 10.0, 70.0, 90.0, 20.0, 70.0, 40.0, 420.0, 40.0, 20.0, 10.0, 30.0, 110.0, 210.0, 270.0, 190.0, 40.0, 160.0, 10.0, 80.0, 300.0, 20.0, 90.0, 240.0, 170.0, 30.0, 10.0, 110.0, 30.0, 230.0, 150.0, 20.0, 10.0, 180.0, 60.0, 50.0, 120.0, 360.0, -40.0, -50.0, 130.0, 320.0, 40.0, 300.0, 55.0, 140.0, 20.0, 480.0, 0.0, 70.0, 30.0, 80.0, 130.0, 70.0, 130.0, 400.0, 0.0, 170.0, 120.0, 90.0, 70.0, 35.0, 50.0, 0.0, 0.0, 20.0, 170.0, 10.0, 0.0, 110.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.175802437747474, "mean_inference_ms": 2.0525072604425025, "mean_action_processing_ms": 0.5780331830887948, "mean_env_wait_ms": 1.8648582480392923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016109466552734375, "StateBufferConnector_ms": 0.026309967041015625, "ViewRequirementAgentConnector_ms": 0.6324276924133301}, "num_episodes": 18, "episode_return_max": 2230.0, "episode_return_min": 185.0, "episode_return_mean": 1013.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.8244942253139995, "num_env_steps_trained_throughput_per_sec": 2.8244942253139995, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 1165535.993, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1165535.924, "sample_time_ms": 3378.908, "learn_time_ms": 1162124.862, "learn_throughput": 3.442, "synch_weights_time_ms": 14.313}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 51, "trial_id": "3d3a5_00000", "date": "2024-06-01_04-59-39", "timestamp": 1717232379, "time_this_iter_s": 1416.2211022377014, "time_total_s": 23196.129108905792, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f84f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23196.129108905792, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.549319727891156, "ram_util_percent": 80.26904761904763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6056548054352864, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.697368304290203, "policy_loss": -0.008119680706130915, "vf_loss": 6.704753146410242, "vf_explained_var": 0.0006462870822293056, "kl": 0.007348380335724625, "entropy": 0.4470090000678937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 483585.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 2250.0, "episode_reward_min": 190.0, "episode_reward_mean": 1011.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -200.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 101.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1640.0, 240.0, 1210.0, 1290.0, 1325.0, 1325.0, 910.0, 2230.0, 630.0, 1155.0, 630.0, 1270.0, 675.0, 1210.0, 790.0, 1180.0, 190.0, 1060.0, 1450.0, 680.0, 750.0, 1140.0, 690.0, 1080.0, 1400.0, 760.0, 1330.0, 1110.0, 1430.0, 400.0, 1300.0, 290.0, 1080.0, 730.0, 930.0, 510.0, 635.0, 945.0, 1310.0, 750.0, 1570.0, 1270.0, 1760.0, 420.0, 795.0, 1110.0, 1140.0, 1300.0, 1010.0, 250.0, 300.0, 390.0, 1070.0, 970.0, 730.0, 1015.0, 1510.0, 1030.0, 1170.0, 650.0, 1430.0, 2110.0, 610.0, 1150.0, 1630.0, 1030.0, 835.0, 1180.0, 1990.0, 1080.0, 1140.0, 810.0, 1390.0, 1080.0, 1140.0, 1215.0, 1215.0, 380.0, 1410.0, 330.0, 860.0, 320.0, 2250.0, 1410.0, 1260.0, 415.0, 1220.0, 1040.0, 950.0, 475.0, 1410.0, 1290.0, 810.0, 820.0, 350.0, 1330.0, 650.0, 345.0, 340.0, 1300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 90.0, 180.0, 190.0, 30.0, 290.0, 280.0, 70.0, 190.0, 270.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 120.0, 30.0, 20.0, 30.0, 10.0, 190.0, 30.0, 160.0, 90.0, 180.0, 10.0, 290.0, 220.0, 30.0, 0.0, 430.0, 60.0, 130.0, 50.0, 50.0, 310.0, 80.0, 140.0, 40.0, 60.0, 55.0, 110.0, 20.0, 320.0, 190.0, 40.0, 400.0, 80.0, 50.0, 100.0, 285.0, 90.0, 170.0, 0.0, 150.0, 270.0, 40.0, 50.0, 170.0, 200.0, 130.0, 100.0, 10.0, 160.0, 120.0, 10.0, 30.0, 10.0, 140.0, 740.0, 50.0, 210.0, 210.0, 70.0, 490.0, 80.0, 50.0, 220.0, 110.0, 10.0, 20.0, 40.0, 10.0, 20.0, 290.0, 110.0, 0.0, 60.0, 70.0, -10.0, 100.0, 80.0, 30.0, 40.0, 25.0, 60.0, 410.0, 370.0, 50.0, 0.0, 140.0, 0.0, 40.0, 320.0, 30.0, 30.0, 20.0, 10.0, 40.0, 40.0, 60.0, 10.0, 70.0, 160.0, 450.0, 180.0, -10.0, 50.0, 260.0, 100.0, 40.0, 80.0, 5.0, 30.0, 220.0, 50.0, 0.0, 90.0, 60.0, 180.0, 250.0, 420.0, 20.0, 0.0, 110.0, 50.0, 90.0, 40.0, 50.0, 40.0, 20.0, 40.0, 70.0, 180.0, 160.0, 10.0, 20.0, 60.0, 190.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 500.0, 30.0, 130.0, 90.0, 10.0, 30.0, 10.0, 20.0, 0.0, 70.0, 0.0, 0.0, 30.0, 20.0, 90.0, 80.0, 10.0, 0.0, 390.0, 200.0, 20.0, 10.0, 10.0, 250.0, 40.0, 40.0, 150.0, 490.0, 170.0, 270.0, 80.0, 40.0, 40.0, 130.0, 60.0, 90.0, 190.0, 110.0, 0.0, 20.0, 30.0, 90.0, 50.0, 40.0, 60.0, 200.0, 90.0, 190.0, 0.0, 10.0, 40.0, 30.0, 50.0, 80.0, -30.0, 380.0, 120.0, 30.0, 130.0, 90.0, 20.0, 20.0, 360.0, 20.0, 10.0, 10.0, 80.0, 60.0, 190.0, 50.0, 160.0, 100.0, 10.0, 20.0, 40.0, 290.0, 60.0, 30.0, 140.0, 210.0, 60.0, 40.0, 120.0, 90.0, 320.0, -40.0, 190.0, 0.0, 20.0, 90.0, 460.0, 310.0, 40.0, 10.0, 40.0, 20.0, 10.0, 30.0, 40.0, 380.0, 20.0, 30.0, 0.0, 190.0, 180.0, 0.0, 170.0, 130.0, 40.0, 100.0, 50.0, 70.0, 80.0, 510.0, 70.0, -40.0, 130.0, 120.0, 260.0, 30.0, 340.0, 40.0, 180.0, -20.0, 520.0, 80.0, 20.0, 70.0, 260.0, 30.0, 160.0, 40.0, 90.0, 160.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 290.0, 70.0, 20.0, 40.0, 90.0, 210.0, 130.0, 230.0, 360.0, 50.0, 50.0, 130.0, 10.0, 10.0, 40.0, 10.0, 0.0, 40.0, 20.0, 70.0, 30.0, 20.0, 50.0, 10.0, 50.0, 200.0, 30.0, 90.0, 20.0, 320.0, 150.0, 100.0, 110.0, 290.0, 180.0, 30.0, 20.0, 10.0, 30.0, 100.0, 20.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 190.0, 270.0, 20.0, 250.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 220.0, 50.0, 0.0, 130.0, 20.0, 60.0, 30.0, 0.0, 330.0, 15.0, 50.0, 30.0, 80.0, 20.0, 200.0, 30.0, 40.0, 30.0, 150.0, 155.0, 220.0, 20.0, 80.0, 20.0, 10.0, 200.0, 60.0, 100.0, 570.0, 70.0, 30.0, 40.0, 170.0, 60.0, 50.0, 50.0, 70.0, 0.0, 0.0, 20.0, 100.0, 380.0, 40.0, 40.0, 30.0, 440.0, 100.0, 50.0, 130.0, 150.0, 320.0, 230.0, 70.0, 50.0, 180.0, 190.0, 130.0, 290.0, 380.0, 60.0, -30.0, 90.0, -90.0, 70.0, 150.0, 190.0, 560.0, 30.0, 80.0, 90.0, 30.0, 180.0, -70.0, 520.0, 40.0, 30.0, 0.0, 40.0, 20.0, 120.0, 20.0, 20.0, 100.0, 30.0, 20.0, 0.0, 35.0, 120.0, 120.0, 10.0, 20.0, 50.0, 380.0, 40.0, 30.0, 180.0, 240.0, 80.0, 50.0, 10.0, 60.0, 70.0, -40.0, 430.0, -50.0, 160.0, 50.0, 70.0, 90.0, 10.0, 170.0, 350.0, 70.0, 220.0, 80.0, 180.0, 390.0, 100.0, 30.0, 70.0, 20.0, 250.0, 80.0, 100.0, 60.0, 50.0, 150.0, 200.0, 120.0, -30.0, -10.0, 30.0, 360.0, 80.0, 30.0, 50.0, 10.0, 110.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 0.0, 10.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 0.0, 20.0, 150.0, 10.0, 0.0, 0.0, 50.0, 20.0, 140.0, 150.0, 300.0, 240.0, 40.0, 0.0, 80.0, 90.0, 160.0, 10.0, 0.0, 200.0, 110.0, 40.0, 90.0, 10.0, 70.0, 90.0, 30.0, 360.0, -30.0, 190.0, 20.0, 40.0, 0.0, 70.0, 60.0, 40.0, 170.0, -20.0, 160.0, 35.0, 210.0, 60.0, 50.0, 20.0, 70.0, 50.0, 190.0, 120.0, 210.0, 100.0, 40.0, 100.0, 10.0, 80.0, 520.0, 270.0, 20.0, 60.0, 310.0, 20.0, 0.0, 500.0, 0.0, -30.0, 90.0, 40.0, 0.0, 90.0, 320.0, 230.0, 80.0, 70.0, 40.0, 30.0, 200.0, 90.0, -20.0, 410.0, 40.0, 80.0, 80.0, 180.0, 30.0, 20.0, 10.0, 10.0, 220.0, 20.0, 0.0, 110.0, 370.0, 390.0, 150.0, 210.0, 20.0, 50.0, 30.0, 100.0, 0.0, 100.0, 50.0, 70.0, 310.0, 160.0, 120.0, 220.0, 800.0, 110.0, 170.0, 70.0, 50.0, 20.0, 0.0, 220.0, 50.0, 190.0, 50.0, -40.0, 0.0, 30.0, 50.0, 90.0, 30.0, 70.0, 400.0, 40.0, 80.0, 70.0, 290.0, 60.0, 160.0, 60.0, 170.0, 30.0, 270.0, 40.0, 490.0, 260.0, 90.0, 20.0, 190.0, 80.0, 150.0, 60.0, 20.0, 160.0, 300.0, 10.0, 40.0, 410.0, 30.0, 190.0, 70.0, 30.0, -15.0, 10.0, 20.0, 50.0, 40.0, 210.0, 420.0, 50.0, 100.0, 210.0, 40.0, 10.0, 50.0, 80.0, 10.0, 90.0, 130.0, 40.0, 600.0, 80.0, 420.0, -30.0, 560.0, 70.0, 30.0, 110.0, 40.0, 70.0, 0.0, 60.0, 40.0, 170.0, 220.0, 350.0, 20.0, 60.0, 290.0, 10.0, 50.0, 210.0, 90.0, 250.0, 170.0, 0.0, 10.0, 70.0, 90.0, 20.0, 70.0, 40.0, 420.0, 40.0, 20.0, 10.0, 30.0, 110.0, 210.0, 270.0, 190.0, 40.0, 160.0, 10.0, 80.0, 300.0, 20.0, 90.0, 240.0, 170.0, 30.0, 10.0, 110.0, 30.0, 230.0, 150.0, 20.0, 10.0, 180.0, 60.0, 50.0, 120.0, 360.0, -40.0, -50.0, 130.0, 320.0, 40.0, 300.0, 55.0, 140.0, 20.0, 480.0, 0.0, 70.0, 30.0, 80.0, 130.0, 70.0, 130.0, 400.0, 0.0, 170.0, 120.0, 90.0, 70.0, 35.0, 50.0, 0.0, 0.0, 20.0, 170.0, 10.0, 0.0, 110.0, 20.0, 0.0, 70.0, 110.0, 80.0, 70.0, 130.0, 230.0, 410.0, 180.0, 60.0, 70.0, 0.0, 50.0, 10.0, 160.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 350.0, 20.0, 140.0, 30.0, 20.0, 30.0, 0.0, 90.0, 20.0, 160.0, 80.0, 20.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 930.0, 100.0, 20.0, 110.0, -30.0, -20.0, 640.0, 350.0, 90.0, 60.0, -10.0, 320.0, 700.0, 30.0, 30.0, -20.0, 10.0, 200.0, 100.0, 50.0, 110.0, 190.0, 40.0, 80.0, 60.0, 200.0, 60.0, 50.0, 370.0, 100.0, 10.0, 30.0, 30.0, 30.0, 60.0, 20.0, 20.0, 25.0, 20.0, 170.0, -10.0, 130.0, 260.0, 40.0, 180.0, 30.0, 90.0, 90.0, 400.0, 10.0, 350.0, 60.0, 0.0, 310.0, 30.0, 10.0, 120.0, 80.0, 70.0, 10.0, 35.0, 80.0, 20.0, 100.0, 390.0, 50.0, -5.0, 70.0, 190.0, 20.0, 30.0, 10.0, 10.0, 190.0, 10.0, -5.0, 20.0, 0.0, 210.0, 0.0, 310.0, 0.0, 320.0, -200.0, 240.0, 220.0, 20.0, 300.0, 150.0, 50.0, 30.0, 50.0, 60.0, 160.0, 120.0, 40.0, 30.0, 210.0, 80.0, 510.0, 50.0, 50.0, 10.0, 120.0, 180.0, 20.0, 40.0, 110.0, 190.0, 40.0, 130.0, 30.0, 80.0, 50.0, 20.0, 40.0, 0.0, 140.0, 20.0, 310.0, 10.0, 40.0, 0.0, 0.0, 10.0, 30.0, 20.0, 190.0, 10.0, 40.0, 70.0, 90.0, 460.0, 100.0, 0.0, 170.0, 50.0, 210.0, 40.0, 140.0, 10.0, 40.0, 200.0, 0.0, -30.0, 70.0, 60.0, 0.0, 250.0, 50.0, 20.0, 0.0, 15.0, 20.0, 90.0, 40.0, 10.0, 20.0, 100.0, 30.0, 0.0, 60.0, 10.0, 40.0, 0.0, 20.0, 160.0, 10.0, 40.0, 0.0, 60.0, -30.0, 540.0, 290.0, 10.0, 160.0, 70.0, 40.0, 120.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1740677742211556, "mean_inference_ms": 2.0608590676807124, "mean_action_processing_ms": 0.5781032929274719, "mean_env_wait_ms": 1.866712859708175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017094850540161133, "StateBufferConnector_ms": 0.02682971954345703, "ViewRequirementAgentConnector_ms": 0.6386833190917969}, "num_episodes": 22, "episode_return_max": 2250.0, "episode_return_min": 190.0, "episode_return_mean": 1011.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.896099452448405, "num_env_steps_trained_throughput_per_sec": 1.896099452448405, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 1356572.175, "restore_workers_time_ms": 0.015, "training_step_time_ms": 1356572.114, "sample_time_ms": 3392.873, "learn_time_ms": 1353145.843, "learn_throughput": 2.956, "synch_weights_time_ms": 14.968}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 52, "trial_id": "3d3a5_00000", "date": "2024-06-01_05-34-49", "timestamp": 1717234489, "time_this_iter_s": 2109.606810092926, "time_total_s": 25305.73591899872, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f87d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25305.73591899872, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 24.79429530201342, "ram_util_percent": 82.51476510067114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6313895850961075, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.006227829255743, "policy_loss": -0.008041288916996549, "vf_loss": 7.013543448889979, "vf_explained_var": 0.00014537739169737275, "kl": 0.007256712229631902, "entropy": 0.43604956613942836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 492975.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "env_runners": {"episode_reward_max": 2250.0, "episode_reward_min": 180.0, "episode_reward_mean": 1014.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -215.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 101.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1080.0, 1400.0, 760.0, 1330.0, 1110.0, 1430.0, 400.0, 1300.0, 290.0, 1080.0, 730.0, 930.0, 510.0, 635.0, 945.0, 1310.0, 750.0, 1570.0, 1270.0, 1760.0, 420.0, 795.0, 1110.0, 1140.0, 1300.0, 1010.0, 250.0, 300.0, 390.0, 1070.0, 970.0, 730.0, 1015.0, 1510.0, 1030.0, 1170.0, 650.0, 1430.0, 2110.0, 610.0, 1150.0, 1630.0, 1030.0, 835.0, 1180.0, 1990.0, 1080.0, 1140.0, 810.0, 1390.0, 1080.0, 1140.0, 1215.0, 1215.0, 380.0, 1410.0, 330.0, 860.0, 320.0, 2250.0, 1410.0, 1260.0, 415.0, 1220.0, 1040.0, 950.0, 475.0, 1410.0, 1290.0, 810.0, 820.0, 350.0, 1330.0, 650.0, 345.0, 340.0, 1300.0, 810.0, 1250.0, 1430.0, 470.0, 1260.0, 840.0, 915.0, 620.0, 1210.0, 1115.0, 1640.0, 1080.0, 1450.0, 180.0, 1060.0, 1480.0, 1430.0, 530.0, 1360.0, 1180.0, 1010.0, 745.0, 970.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 290.0, 60.0, 30.0, 140.0, 210.0, 60.0, 40.0, 120.0, 90.0, 320.0, -40.0, 190.0, 0.0, 20.0, 90.0, 460.0, 310.0, 40.0, 10.0, 40.0, 20.0, 10.0, 30.0, 40.0, 380.0, 20.0, 30.0, 0.0, 190.0, 180.0, 0.0, 170.0, 130.0, 40.0, 100.0, 50.0, 70.0, 80.0, 510.0, 70.0, -40.0, 130.0, 120.0, 260.0, 30.0, 340.0, 40.0, 180.0, -20.0, 520.0, 80.0, 20.0, 70.0, 260.0, 30.0, 160.0, 40.0, 90.0, 160.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, -30.0, 290.0, 70.0, 20.0, 40.0, 90.0, 210.0, 130.0, 230.0, 360.0, 50.0, 50.0, 130.0, 10.0, 10.0, 40.0, 10.0, 0.0, 40.0, 20.0, 70.0, 30.0, 20.0, 50.0, 10.0, 50.0, 200.0, 30.0, 90.0, 20.0, 320.0, 150.0, 100.0, 110.0, 290.0, 180.0, 30.0, 20.0, 10.0, 30.0, 100.0, 20.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 190.0, 270.0, 20.0, 250.0, 40.0, 40.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 220.0, 50.0, 0.0, 130.0, 20.0, 60.0, 30.0, 0.0, 330.0, 15.0, 50.0, 30.0, 80.0, 20.0, 200.0, 30.0, 40.0, 30.0, 150.0, 155.0, 220.0, 20.0, 80.0, 20.0, 10.0, 200.0, 60.0, 100.0, 570.0, 70.0, 30.0, 40.0, 170.0, 60.0, 50.0, 50.0, 70.0, 0.0, 0.0, 20.0, 100.0, 380.0, 40.0, 40.0, 30.0, 440.0, 100.0, 50.0, 130.0, 150.0, 320.0, 230.0, 70.0, 50.0, 180.0, 190.0, 130.0, 290.0, 380.0, 60.0, -30.0, 90.0, -90.0, 70.0, 150.0, 190.0, 560.0, 30.0, 80.0, 90.0, 30.0, 180.0, -70.0, 520.0, 40.0, 30.0, 0.0, 40.0, 20.0, 120.0, 20.0, 20.0, 100.0, 30.0, 20.0, 0.0, 35.0, 120.0, 120.0, 10.0, 20.0, 50.0, 380.0, 40.0, 30.0, 180.0, 240.0, 80.0, 50.0, 10.0, 60.0, 70.0, -40.0, 430.0, -50.0, 160.0, 50.0, 70.0, 90.0, 10.0, 170.0, 350.0, 70.0, 220.0, 80.0, 180.0, 390.0, 100.0, 30.0, 70.0, 20.0, 250.0, 80.0, 100.0, 60.0, 50.0, 150.0, 200.0, 120.0, -30.0, -10.0, 30.0, 360.0, 80.0, 30.0, 50.0, 10.0, 110.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 0.0, 10.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 0.0, 20.0, 150.0, 10.0, 0.0, 0.0, 50.0, 20.0, 140.0, 150.0, 300.0, 240.0, 40.0, 0.0, 80.0, 90.0, 160.0, 10.0, 0.0, 200.0, 110.0, 40.0, 90.0, 10.0, 70.0, 90.0, 30.0, 360.0, -30.0, 190.0, 20.0, 40.0, 0.0, 70.0, 60.0, 40.0, 170.0, -20.0, 160.0, 35.0, 210.0, 60.0, 50.0, 20.0, 70.0, 50.0, 190.0, 120.0, 210.0, 100.0, 40.0, 100.0, 10.0, 80.0, 520.0, 270.0, 20.0, 60.0, 310.0, 20.0, 0.0, 500.0, 0.0, -30.0, 90.0, 40.0, 0.0, 90.0, 320.0, 230.0, 80.0, 70.0, 40.0, 30.0, 200.0, 90.0, -20.0, 410.0, 40.0, 80.0, 80.0, 180.0, 30.0, 20.0, 10.0, 10.0, 220.0, 20.0, 0.0, 110.0, 370.0, 390.0, 150.0, 210.0, 20.0, 50.0, 30.0, 100.0, 0.0, 100.0, 50.0, 70.0, 310.0, 160.0, 120.0, 220.0, 800.0, 110.0, 170.0, 70.0, 50.0, 20.0, 0.0, 220.0, 50.0, 190.0, 50.0, -40.0, 0.0, 30.0, 50.0, 90.0, 30.0, 70.0, 400.0, 40.0, 80.0, 70.0, 290.0, 60.0, 160.0, 60.0, 170.0, 30.0, 270.0, 40.0, 490.0, 260.0, 90.0, 20.0, 190.0, 80.0, 150.0, 60.0, 20.0, 160.0, 300.0, 10.0, 40.0, 410.0, 30.0, 190.0, 70.0, 30.0, -15.0, 10.0, 20.0, 50.0, 40.0, 210.0, 420.0, 50.0, 100.0, 210.0, 40.0, 10.0, 50.0, 80.0, 10.0, 90.0, 130.0, 40.0, 600.0, 80.0, 420.0, -30.0, 560.0, 70.0, 30.0, 110.0, 40.0, 70.0, 0.0, 60.0, 40.0, 170.0, 220.0, 350.0, 20.0, 60.0, 290.0, 10.0, 50.0, 210.0, 90.0, 250.0, 170.0, 0.0, 10.0, 70.0, 90.0, 20.0, 70.0, 40.0, 420.0, 40.0, 20.0, 10.0, 30.0, 110.0, 210.0, 270.0, 190.0, 40.0, 160.0, 10.0, 80.0, 300.0, 20.0, 90.0, 240.0, 170.0, 30.0, 10.0, 110.0, 30.0, 230.0, 150.0, 20.0, 10.0, 180.0, 60.0, 50.0, 120.0, 360.0, -40.0, -50.0, 130.0, 320.0, 40.0, 300.0, 55.0, 140.0, 20.0, 480.0, 0.0, 70.0, 30.0, 80.0, 130.0, 70.0, 130.0, 400.0, 0.0, 170.0, 120.0, 90.0, 70.0, 35.0, 50.0, 0.0, 0.0, 20.0, 170.0, 10.0, 0.0, 110.0, 20.0, 0.0, 70.0, 110.0, 80.0, 70.0, 130.0, 230.0, 410.0, 180.0, 60.0, 70.0, 0.0, 50.0, 10.0, 160.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 350.0, 20.0, 140.0, 30.0, 20.0, 30.0, 0.0, 90.0, 20.0, 160.0, 80.0, 20.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 930.0, 100.0, 20.0, 110.0, -30.0, -20.0, 640.0, 350.0, 90.0, 60.0, -10.0, 320.0, 700.0, 30.0, 30.0, -20.0, 10.0, 200.0, 100.0, 50.0, 110.0, 190.0, 40.0, 80.0, 60.0, 200.0, 60.0, 50.0, 370.0, 100.0, 10.0, 30.0, 30.0, 30.0, 60.0, 20.0, 20.0, 25.0, 20.0, 170.0, -10.0, 130.0, 260.0, 40.0, 180.0, 30.0, 90.0, 90.0, 400.0, 10.0, 350.0, 60.0, 0.0, 310.0, 30.0, 10.0, 120.0, 80.0, 70.0, 10.0, 35.0, 80.0, 20.0, 100.0, 390.0, 50.0, -5.0, 70.0, 190.0, 20.0, 30.0, 10.0, 10.0, 190.0, 10.0, -5.0, 20.0, 0.0, 210.0, 0.0, 310.0, 0.0, 320.0, -200.0, 240.0, 220.0, 20.0, 300.0, 150.0, 50.0, 30.0, 50.0, 60.0, 160.0, 120.0, 40.0, 30.0, 210.0, 80.0, 510.0, 50.0, 50.0, 10.0, 120.0, 180.0, 20.0, 40.0, 110.0, 190.0, 40.0, 130.0, 30.0, 80.0, 50.0, 20.0, 40.0, 0.0, 140.0, 20.0, 310.0, 10.0, 40.0, 0.0, 0.0, 10.0, 30.0, 20.0, 190.0, 10.0, 40.0, 70.0, 90.0, 460.0, 100.0, 0.0, 170.0, 50.0, 210.0, 40.0, 140.0, 10.0, 40.0, 200.0, 0.0, -30.0, 70.0, 60.0, 0.0, 250.0, 50.0, 20.0, 0.0, 15.0, 20.0, 90.0, 40.0, 10.0, 20.0, 100.0, 30.0, 0.0, 60.0, 10.0, 40.0, 0.0, 20.0, 160.0, 10.0, 40.0, 0.0, 60.0, -30.0, 540.0, 290.0, 10.0, 160.0, 70.0, 40.0, 120.0, 40.0, 40.0, 150.0, 290.0, 0.0, 10.0, 220.0, -40.0, 20.0, 50.0, 70.0, 90.0, 30.0, 220.0, 80.0, 30.0, 150.0, 40.0, 80.0, 300.0, 230.0, 70.0, 50.0, 30.0, 0.0, 340.0, 60.0, 20.0, 290.0, 110.0, 460.0, 30.0, 10.0, 20.0, 0.0, 160.0, 20.0, 120.0, 20.0, 90.0, 0.0, 50.0, 420.0, 50.0, -20.0, 30.0, 230.0, 170.0, 300.0, 20.0, 10.0, -40.0, 65.0, 410.0, -215.0, 190.0, -130.0, 310.0, 80.0, 180.0, -10.0, 190.0, 100.0, 0.0, 90.0, 30.0, 120.0, 230.0, 20.0, 10.0, 125.0, 80.0, 10.0, 35.0, 60.0, 15.0, 170.0, 70.0, 0.0, 20.0, 160.0, 290.0, 200.0, 420.0, 20.0, 40.0, 80.0, 10.0, 90.0, 20.0, 40.0, 0.0, 130.0, 30.0, 160.0, 20.0, 70.0, 25.0, 380.0, 280.0, 20.0, 80.0, 50.0, 630.0, 330.0, 200.0, 60.0, 180.0, 10.0, 80.0, 20.0, 10.0, 30.0, -30.0, 70.0, 170.0, 50.0, 200.0, 230.0, 270.0, 80.0, 320.0, 440.0, 20.0, 110.0, 10.0, 30.0, 410.0, 50.0, 20.0, 40.0, 10.0, -5.0, 0.0, -5.0, 40.0, 10.0, 110.0, 0.0, 0.0, 20.0, 90.0, 220.0, 30.0, 0.0, 100.0, 30.0, 0.0, 210.0, 40.0, 340.0, 70.0, 270.0, 640.0, 40.0, 190.0, 0.0, 20.0, 40.0, 190.0, 20.0, 220.0, 210.0, 0.0, 80.0, 240.0, 80.0, 110.0, 310.0, 50.0, 130.0, 60.0, 50.0, 50.0, 0.0, 40.0, 20.0, 270.0, -90.0, 120.0, 10.0, 380.0, 120.0, 40.0, 40.0, 270.0, 40.0, 120.0, 180.0, 70.0, 100.0, 60.0, 170.0, 250.0, 0.0, 210.0, 60.0, 60.0, 80.0, 230.0, 60.0, 20.0, 220.0, 50.0, 350.0, 20.0, 20.0, 30.0, 180.0, 80.0, 40.0, 90.0, -40.0, 190.0, 150.0, 30.0, 10.0, 120.0, 25.0, 10.0, 160.0, 50.0, 80.0, 180.0, 200.0, 40.0, 0.0, 0.0, 30.0, 110.0, 280.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.172289666926222, "mean_inference_ms": 2.0688674729894476, "mean_action_processing_ms": 0.5783811171489276, "mean_env_wait_ms": 1.868103109902206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016407012939453125, "StateBufferConnector_ms": 0.026589155197143555, "ViewRequirementAgentConnector_ms": 0.6386220455169678}, "num_episodes": 23, "episode_return_max": 2250.0, "episode_return_min": 180.0, "episode_return_mean": 1014.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 7.180156173563237, "num_env_steps_trained_throughput_per_sec": 7.180156173563237, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 2120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2120000, "timers": {"training_iteration_time_ms": 1392201.992, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1392201.931, "sample_time_ms": 3481.124, "learn_time_ms": 1388687.973, "learn_throughput": 2.88, "synch_weights_time_ms": 14.954}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "done": false, "training_iteration": 53, "trial_id": "3d3a5_00000", "date": "2024-06-01_05-44-06", "timestamp": 1717235046, "time_this_iter_s": 557.1213271617889, "time_total_s": 25862.857246160507, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7e8ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25862.857246160507, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 19.647569444444443, "ram_util_percent": 82.36631944444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.319000421792935, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.379008406800584, "policy_loss": -0.008272130992903281, "vf_loss": 7.386542536935614, "vf_explained_var": 0.00044329201324552265, "kl": 0.0073799881039387704, "entropy": 0.404303517147375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 502365.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 2250.0, "episode_reward_min": 180.0, "episode_reward_mean": 1040.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 104.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1270.0, 1760.0, 420.0, 795.0, 1110.0, 1140.0, 1300.0, 1010.0, 250.0, 300.0, 390.0, 1070.0, 970.0, 730.0, 1015.0, 1510.0, 1030.0, 1170.0, 650.0, 1430.0, 2110.0, 610.0, 1150.0, 1630.0, 1030.0, 835.0, 1180.0, 1990.0, 1080.0, 1140.0, 810.0, 1390.0, 1080.0, 1140.0, 1215.0, 1215.0, 380.0, 1410.0, 330.0, 860.0, 320.0, 2250.0, 1410.0, 1260.0, 415.0, 1220.0, 1040.0, 950.0, 475.0, 1410.0, 1290.0, 810.0, 820.0, 350.0, 1330.0, 650.0, 345.0, 340.0, 1300.0, 810.0, 1250.0, 1430.0, 470.0, 1260.0, 840.0, 915.0, 620.0, 1210.0, 1115.0, 1640.0, 1080.0, 1450.0, 180.0, 1060.0, 1480.0, 1430.0, 530.0, 1360.0, 1180.0, 1010.0, 745.0, 970.0, 520.0, 1430.0, 1420.0, 980.0, 370.0, 1550.0, 1360.0, 955.0, 1110.0, 1360.0, 1380.0, 1540.0, 550.0, 1030.0, 1230.0, 1200.0, 675.0, 1470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 190.0, 130.0, 290.0, 380.0, 60.0, -30.0, 90.0, -90.0, 70.0, 150.0, 190.0, 560.0, 30.0, 80.0, 90.0, 30.0, 180.0, -70.0, 520.0, 40.0, 30.0, 0.0, 40.0, 20.0, 120.0, 20.0, 20.0, 100.0, 30.0, 20.0, 0.0, 35.0, 120.0, 120.0, 10.0, 20.0, 50.0, 380.0, 40.0, 30.0, 180.0, 240.0, 80.0, 50.0, 10.0, 60.0, 70.0, -40.0, 430.0, -50.0, 160.0, 50.0, 70.0, 90.0, 10.0, 170.0, 350.0, 70.0, 220.0, 80.0, 180.0, 390.0, 100.0, 30.0, 70.0, 20.0, 250.0, 80.0, 100.0, 60.0, 50.0, 150.0, 200.0, 120.0, -30.0, -10.0, 30.0, 360.0, 80.0, 30.0, 50.0, 10.0, 110.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 0.0, 10.0, 10.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 0.0, 20.0, 150.0, 10.0, 0.0, 0.0, 50.0, 20.0, 140.0, 150.0, 300.0, 240.0, 40.0, 0.0, 80.0, 90.0, 160.0, 10.0, 0.0, 200.0, 110.0, 40.0, 90.0, 10.0, 70.0, 90.0, 30.0, 360.0, -30.0, 190.0, 20.0, 40.0, 0.0, 70.0, 60.0, 40.0, 170.0, -20.0, 160.0, 35.0, 210.0, 60.0, 50.0, 20.0, 70.0, 50.0, 190.0, 120.0, 210.0, 100.0, 40.0, 100.0, 10.0, 80.0, 520.0, 270.0, 20.0, 60.0, 310.0, 20.0, 0.0, 500.0, 0.0, -30.0, 90.0, 40.0, 0.0, 90.0, 320.0, 230.0, 80.0, 70.0, 40.0, 30.0, 200.0, 90.0, -20.0, 410.0, 40.0, 80.0, 80.0, 180.0, 30.0, 20.0, 10.0, 10.0, 220.0, 20.0, 0.0, 110.0, 370.0, 390.0, 150.0, 210.0, 20.0, 50.0, 30.0, 100.0, 0.0, 100.0, 50.0, 70.0, 310.0, 160.0, 120.0, 220.0, 800.0, 110.0, 170.0, 70.0, 50.0, 20.0, 0.0, 220.0, 50.0, 190.0, 50.0, -40.0, 0.0, 30.0, 50.0, 90.0, 30.0, 70.0, 400.0, 40.0, 80.0, 70.0, 290.0, 60.0, 160.0, 60.0, 170.0, 30.0, 270.0, 40.0, 490.0, 260.0, 90.0, 20.0, 190.0, 80.0, 150.0, 60.0, 20.0, 160.0, 300.0, 10.0, 40.0, 410.0, 30.0, 190.0, 70.0, 30.0, -15.0, 10.0, 20.0, 50.0, 40.0, 210.0, 420.0, 50.0, 100.0, 210.0, 40.0, 10.0, 50.0, 80.0, 10.0, 90.0, 130.0, 40.0, 600.0, 80.0, 420.0, -30.0, 560.0, 70.0, 30.0, 110.0, 40.0, 70.0, 0.0, 60.0, 40.0, 170.0, 220.0, 350.0, 20.0, 60.0, 290.0, 10.0, 50.0, 210.0, 90.0, 250.0, 170.0, 0.0, 10.0, 70.0, 90.0, 20.0, 70.0, 40.0, 420.0, 40.0, 20.0, 10.0, 30.0, 110.0, 210.0, 270.0, 190.0, 40.0, 160.0, 10.0, 80.0, 300.0, 20.0, 90.0, 240.0, 170.0, 30.0, 10.0, 110.0, 30.0, 230.0, 150.0, 20.0, 10.0, 180.0, 60.0, 50.0, 120.0, 360.0, -40.0, -50.0, 130.0, 320.0, 40.0, 300.0, 55.0, 140.0, 20.0, 480.0, 0.0, 70.0, 30.0, 80.0, 130.0, 70.0, 130.0, 400.0, 0.0, 170.0, 120.0, 90.0, 70.0, 35.0, 50.0, 0.0, 0.0, 20.0, 170.0, 10.0, 0.0, 110.0, 20.0, 0.0, 70.0, 110.0, 80.0, 70.0, 130.0, 230.0, 410.0, 180.0, 60.0, 70.0, 0.0, 50.0, 10.0, 160.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 350.0, 20.0, 140.0, 30.0, 20.0, 30.0, 0.0, 90.0, 20.0, 160.0, 80.0, 20.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 930.0, 100.0, 20.0, 110.0, -30.0, -20.0, 640.0, 350.0, 90.0, 60.0, -10.0, 320.0, 700.0, 30.0, 30.0, -20.0, 10.0, 200.0, 100.0, 50.0, 110.0, 190.0, 40.0, 80.0, 60.0, 200.0, 60.0, 50.0, 370.0, 100.0, 10.0, 30.0, 30.0, 30.0, 60.0, 20.0, 20.0, 25.0, 20.0, 170.0, -10.0, 130.0, 260.0, 40.0, 180.0, 30.0, 90.0, 90.0, 400.0, 10.0, 350.0, 60.0, 0.0, 310.0, 30.0, 10.0, 120.0, 80.0, 70.0, 10.0, 35.0, 80.0, 20.0, 100.0, 390.0, 50.0, -5.0, 70.0, 190.0, 20.0, 30.0, 10.0, 10.0, 190.0, 10.0, -5.0, 20.0, 0.0, 210.0, 0.0, 310.0, 0.0, 320.0, -200.0, 240.0, 220.0, 20.0, 300.0, 150.0, 50.0, 30.0, 50.0, 60.0, 160.0, 120.0, 40.0, 30.0, 210.0, 80.0, 510.0, 50.0, 50.0, 10.0, 120.0, 180.0, 20.0, 40.0, 110.0, 190.0, 40.0, 130.0, 30.0, 80.0, 50.0, 20.0, 40.0, 0.0, 140.0, 20.0, 310.0, 10.0, 40.0, 0.0, 0.0, 10.0, 30.0, 20.0, 190.0, 10.0, 40.0, 70.0, 90.0, 460.0, 100.0, 0.0, 170.0, 50.0, 210.0, 40.0, 140.0, 10.0, 40.0, 200.0, 0.0, -30.0, 70.0, 60.0, 0.0, 250.0, 50.0, 20.0, 0.0, 15.0, 20.0, 90.0, 40.0, 10.0, 20.0, 100.0, 30.0, 0.0, 60.0, 10.0, 40.0, 0.0, 20.0, 160.0, 10.0, 40.0, 0.0, 60.0, -30.0, 540.0, 290.0, 10.0, 160.0, 70.0, 40.0, 120.0, 40.0, 40.0, 150.0, 290.0, 0.0, 10.0, 220.0, -40.0, 20.0, 50.0, 70.0, 90.0, 30.0, 220.0, 80.0, 30.0, 150.0, 40.0, 80.0, 300.0, 230.0, 70.0, 50.0, 30.0, 0.0, 340.0, 60.0, 20.0, 290.0, 110.0, 460.0, 30.0, 10.0, 20.0, 0.0, 160.0, 20.0, 120.0, 20.0, 90.0, 0.0, 50.0, 420.0, 50.0, -20.0, 30.0, 230.0, 170.0, 300.0, 20.0, 10.0, -40.0, 65.0, 410.0, -215.0, 190.0, -130.0, 310.0, 80.0, 180.0, -10.0, 190.0, 100.0, 0.0, 90.0, 30.0, 120.0, 230.0, 20.0, 10.0, 125.0, 80.0, 10.0, 35.0, 60.0, 15.0, 170.0, 70.0, 0.0, 20.0, 160.0, 290.0, 200.0, 420.0, 20.0, 40.0, 80.0, 10.0, 90.0, 20.0, 40.0, 0.0, 130.0, 30.0, 160.0, 20.0, 70.0, 25.0, 380.0, 280.0, 20.0, 80.0, 50.0, 630.0, 330.0, 200.0, 60.0, 180.0, 10.0, 80.0, 20.0, 10.0, 30.0, -30.0, 70.0, 170.0, 50.0, 200.0, 230.0, 270.0, 80.0, 320.0, 440.0, 20.0, 110.0, 10.0, 30.0, 410.0, 50.0, 20.0, 40.0, 10.0, -5.0, 0.0, -5.0, 40.0, 10.0, 110.0, 0.0, 0.0, 20.0, 90.0, 220.0, 30.0, 0.0, 100.0, 30.0, 0.0, 210.0, 40.0, 340.0, 70.0, 270.0, 640.0, 40.0, 190.0, 0.0, 20.0, 40.0, 190.0, 20.0, 220.0, 210.0, 0.0, 80.0, 240.0, 80.0, 110.0, 310.0, 50.0, 130.0, 60.0, 50.0, 50.0, 0.0, 40.0, 20.0, 270.0, -90.0, 120.0, 10.0, 380.0, 120.0, 40.0, 40.0, 270.0, 40.0, 120.0, 180.0, 70.0, 100.0, 60.0, 170.0, 250.0, 0.0, 210.0, 60.0, 60.0, 80.0, 230.0, 60.0, 20.0, 220.0, 50.0, 350.0, 20.0, 20.0, 30.0, 180.0, 80.0, 40.0, 90.0, -40.0, 190.0, 150.0, 30.0, 10.0, 120.0, 25.0, 10.0, 160.0, 50.0, 80.0, 180.0, 200.0, 40.0, 0.0, 0.0, 30.0, 110.0, 280.0, 10.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 50.0, 220.0, 20.0, 80.0, 180.0, 70.0, 110.0, 120.0, 390.0, 70.0, 30.0, 340.0, 40.0, 150.0, 30.0, 440.0, 10.0, 110.0, 120.0, 280.0, 60.0, 190.0, 30.0, 60.0, 30.0, 0.0, 10.0, 20.0, 0.0, 150.0, 170.0, 170.0, 370.0, 40.0, 20.0, -90.0, 10.0, 10.0, 200.0, 0.0, 30.0, 10.0, 140.0, 90.0, 270.0, 0.0, 460.0, 70.0, 20.0, 100.0, 30.0, 370.0, 140.0, 260.0, 200.0, 50.0, 70.0, 150.0, 20.0, 30.0, 130.0, 50.0, 400.0, 80.0, 300.0, 70.0, 10.0, 170.0, 110.0, 30.0, 10.0, 130.0, 45.0, 60.0, 130.0, 20.0, 60.0, 280.0, 310.0, 180.0, 20.0, 50.0, 0.0, 170.0, 310.0, 180.0, 40.0, 100.0, 50.0, 80.0, 60.0, 240.0, 130.0, 170.0, 130.0, 60.0, 40.0, 200.0, 330.0, 30.0, 10.0, 400.0, 10.0, 40.0, 380.0, 250.0, 70.0, 270.0, 80.0, 50.0, 140.0, -30.0, 290.0, 30.0, 10.0, 90.0, 170.0, 410.0, 20.0, 80.0, -270.0, 10.0, 0.0, 350.0, 100.0, -10.0, 90.0, -80.0, 590.0, 20.0, -10.0, 0.0, -20.0, 320.0, 0.0, 10.0, 80.0, 190.0, 20.0, 70.0, 20.0, 220.0, 300.0, 260.0, 90.0, 40.0, -10.0, 310.0, 80.0, 20.0, 170.0, 90.0, 150.0, 10.0, 60.0, 25.0, 10.0, 10.0, 0.0, 260.0, 80.0, 170.0, 50.0, 630.0, 40.0, 210.0, 270.0, 170.0, 10.0, 190.0, 20.0, -50.0, -20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.161668312620645, "mean_inference_ms": 2.062080164200832, "mean_action_processing_ms": 0.5755109341158107, "mean_env_wait_ms": 1.8591539429017103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014896154403686523, "StateBufferConnector_ms": 0.010147333145141602, "ViewRequirementAgentConnector_ms": 0.39324951171875}, "num_episodes": 18, "episode_return_max": 2250.0, "episode_return_min": 180.0, "episode_return_mean": 1040.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.9229585463696857, "num_env_steps_trained_throughput_per_sec": 1.9229585463696857, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 1488324.766, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1488324.706, "sample_time_ms": 3471.133, "learn_time_ms": 1484821.105, "learn_throughput": 2.694, "synch_weights_time_ms": 14.668}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 54, "trial_id": "3d3a5_00000", "date": "2024-06-01_06-18-46", "timestamp": 1717237126, "time_this_iter_s": 2080.170874118805, "time_total_s": 27943.028120279312, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7ef0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27943.028120279312, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 22.703061224489797, "ram_util_percent": 82.0938775510204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0900737186336418, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.451156694058793, "policy_loss": -0.007643041131384195, "vf_loss": 6.458005131141573, "vf_explained_var": 0.00034360427318162685, "kl": 0.00794602401084569, "entropy": 0.4241477380894497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 511755.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "env_runners": {"episode_reward_max": 2250.0, "episode_reward_min": 110.0, "episode_reward_mean": 1067.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 106.755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [650.0, 1430.0, 2110.0, 610.0, 1150.0, 1630.0, 1030.0, 835.0, 1180.0, 1990.0, 1080.0, 1140.0, 810.0, 1390.0, 1080.0, 1140.0, 1215.0, 1215.0, 380.0, 1410.0, 330.0, 860.0, 320.0, 2250.0, 1410.0, 1260.0, 415.0, 1220.0, 1040.0, 950.0, 475.0, 1410.0, 1290.0, 810.0, 820.0, 350.0, 1330.0, 650.0, 345.0, 340.0, 1300.0, 810.0, 1250.0, 1430.0, 470.0, 1260.0, 840.0, 915.0, 620.0, 1210.0, 1115.0, 1640.0, 1080.0, 1450.0, 180.0, 1060.0, 1480.0, 1430.0, 530.0, 1360.0, 1180.0, 1010.0, 745.0, 970.0, 520.0, 1430.0, 1420.0, 980.0, 370.0, 1550.0, 1360.0, 955.0, 1110.0, 1360.0, 1380.0, 1540.0, 550.0, 1030.0, 1230.0, 1200.0, 675.0, 1470.0, 460.0, 580.0, 310.0, 1520.0, 1530.0, 1280.0, 1540.0, 620.0, 1370.0, 110.0, 1765.0, 680.0, 1290.0, 1150.0, 790.0, 1320.0, 1470.0, 2155.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 80.0, 180.0, 30.0, 20.0, 10.0, 10.0, 220.0, 20.0, 0.0, 110.0, 370.0, 390.0, 150.0, 210.0, 20.0, 50.0, 30.0, 100.0, 0.0, 100.0, 50.0, 70.0, 310.0, 160.0, 120.0, 220.0, 800.0, 110.0, 170.0, 70.0, 50.0, 20.0, 0.0, 220.0, 50.0, 190.0, 50.0, -40.0, 0.0, 30.0, 50.0, 90.0, 30.0, 70.0, 400.0, 40.0, 80.0, 70.0, 290.0, 60.0, 160.0, 60.0, 170.0, 30.0, 270.0, 40.0, 490.0, 260.0, 90.0, 20.0, 190.0, 80.0, 150.0, 60.0, 20.0, 160.0, 300.0, 10.0, 40.0, 410.0, 30.0, 190.0, 70.0, 30.0, -15.0, 10.0, 20.0, 50.0, 40.0, 210.0, 420.0, 50.0, 100.0, 210.0, 40.0, 10.0, 50.0, 80.0, 10.0, 90.0, 130.0, 40.0, 600.0, 80.0, 420.0, -30.0, 560.0, 70.0, 30.0, 110.0, 40.0, 70.0, 0.0, 60.0, 40.0, 170.0, 220.0, 350.0, 20.0, 60.0, 290.0, 10.0, 50.0, 210.0, 90.0, 250.0, 170.0, 0.0, 10.0, 70.0, 90.0, 20.0, 70.0, 40.0, 420.0, 40.0, 20.0, 10.0, 30.0, 110.0, 210.0, 270.0, 190.0, 40.0, 160.0, 10.0, 80.0, 300.0, 20.0, 90.0, 240.0, 170.0, 30.0, 10.0, 110.0, 30.0, 230.0, 150.0, 20.0, 10.0, 180.0, 60.0, 50.0, 120.0, 360.0, -40.0, -50.0, 130.0, 320.0, 40.0, 300.0, 55.0, 140.0, 20.0, 480.0, 0.0, 70.0, 30.0, 80.0, 130.0, 70.0, 130.0, 400.0, 0.0, 170.0, 120.0, 90.0, 70.0, 35.0, 50.0, 0.0, 0.0, 20.0, 170.0, 10.0, 0.0, 110.0, 20.0, 0.0, 70.0, 110.0, 80.0, 70.0, 130.0, 230.0, 410.0, 180.0, 60.0, 70.0, 0.0, 50.0, 10.0, 160.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 350.0, 20.0, 140.0, 30.0, 20.0, 30.0, 0.0, 90.0, 20.0, 160.0, 80.0, 20.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 930.0, 100.0, 20.0, 110.0, -30.0, -20.0, 640.0, 350.0, 90.0, 60.0, -10.0, 320.0, 700.0, 30.0, 30.0, -20.0, 10.0, 200.0, 100.0, 50.0, 110.0, 190.0, 40.0, 80.0, 60.0, 200.0, 60.0, 50.0, 370.0, 100.0, 10.0, 30.0, 30.0, 30.0, 60.0, 20.0, 20.0, 25.0, 20.0, 170.0, -10.0, 130.0, 260.0, 40.0, 180.0, 30.0, 90.0, 90.0, 400.0, 10.0, 350.0, 60.0, 0.0, 310.0, 30.0, 10.0, 120.0, 80.0, 70.0, 10.0, 35.0, 80.0, 20.0, 100.0, 390.0, 50.0, -5.0, 70.0, 190.0, 20.0, 30.0, 10.0, 10.0, 190.0, 10.0, -5.0, 20.0, 0.0, 210.0, 0.0, 310.0, 0.0, 320.0, -200.0, 240.0, 220.0, 20.0, 300.0, 150.0, 50.0, 30.0, 50.0, 60.0, 160.0, 120.0, 40.0, 30.0, 210.0, 80.0, 510.0, 50.0, 50.0, 10.0, 120.0, 180.0, 20.0, 40.0, 110.0, 190.0, 40.0, 130.0, 30.0, 80.0, 50.0, 20.0, 40.0, 0.0, 140.0, 20.0, 310.0, 10.0, 40.0, 0.0, 0.0, 10.0, 30.0, 20.0, 190.0, 10.0, 40.0, 70.0, 90.0, 460.0, 100.0, 0.0, 170.0, 50.0, 210.0, 40.0, 140.0, 10.0, 40.0, 200.0, 0.0, -30.0, 70.0, 60.0, 0.0, 250.0, 50.0, 20.0, 0.0, 15.0, 20.0, 90.0, 40.0, 10.0, 20.0, 100.0, 30.0, 0.0, 60.0, 10.0, 40.0, 0.0, 20.0, 160.0, 10.0, 40.0, 0.0, 60.0, -30.0, 540.0, 290.0, 10.0, 160.0, 70.0, 40.0, 120.0, 40.0, 40.0, 150.0, 290.0, 0.0, 10.0, 220.0, -40.0, 20.0, 50.0, 70.0, 90.0, 30.0, 220.0, 80.0, 30.0, 150.0, 40.0, 80.0, 300.0, 230.0, 70.0, 50.0, 30.0, 0.0, 340.0, 60.0, 20.0, 290.0, 110.0, 460.0, 30.0, 10.0, 20.0, 0.0, 160.0, 20.0, 120.0, 20.0, 90.0, 0.0, 50.0, 420.0, 50.0, -20.0, 30.0, 230.0, 170.0, 300.0, 20.0, 10.0, -40.0, 65.0, 410.0, -215.0, 190.0, -130.0, 310.0, 80.0, 180.0, -10.0, 190.0, 100.0, 0.0, 90.0, 30.0, 120.0, 230.0, 20.0, 10.0, 125.0, 80.0, 10.0, 35.0, 60.0, 15.0, 170.0, 70.0, 0.0, 20.0, 160.0, 290.0, 200.0, 420.0, 20.0, 40.0, 80.0, 10.0, 90.0, 20.0, 40.0, 0.0, 130.0, 30.0, 160.0, 20.0, 70.0, 25.0, 380.0, 280.0, 20.0, 80.0, 50.0, 630.0, 330.0, 200.0, 60.0, 180.0, 10.0, 80.0, 20.0, 10.0, 30.0, -30.0, 70.0, 170.0, 50.0, 200.0, 230.0, 270.0, 80.0, 320.0, 440.0, 20.0, 110.0, 10.0, 30.0, 410.0, 50.0, 20.0, 40.0, 10.0, -5.0, 0.0, -5.0, 40.0, 10.0, 110.0, 0.0, 0.0, 20.0, 90.0, 220.0, 30.0, 0.0, 100.0, 30.0, 0.0, 210.0, 40.0, 340.0, 70.0, 270.0, 640.0, 40.0, 190.0, 0.0, 20.0, 40.0, 190.0, 20.0, 220.0, 210.0, 0.0, 80.0, 240.0, 80.0, 110.0, 310.0, 50.0, 130.0, 60.0, 50.0, 50.0, 0.0, 40.0, 20.0, 270.0, -90.0, 120.0, 10.0, 380.0, 120.0, 40.0, 40.0, 270.0, 40.0, 120.0, 180.0, 70.0, 100.0, 60.0, 170.0, 250.0, 0.0, 210.0, 60.0, 60.0, 80.0, 230.0, 60.0, 20.0, 220.0, 50.0, 350.0, 20.0, 20.0, 30.0, 180.0, 80.0, 40.0, 90.0, -40.0, 190.0, 150.0, 30.0, 10.0, 120.0, 25.0, 10.0, 160.0, 50.0, 80.0, 180.0, 200.0, 40.0, 0.0, 0.0, 30.0, 110.0, 280.0, 10.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 50.0, 220.0, 20.0, 80.0, 180.0, 70.0, 110.0, 120.0, 390.0, 70.0, 30.0, 340.0, 40.0, 150.0, 30.0, 440.0, 10.0, 110.0, 120.0, 280.0, 60.0, 190.0, 30.0, 60.0, 30.0, 0.0, 10.0, 20.0, 0.0, 150.0, 170.0, 170.0, 370.0, 40.0, 20.0, -90.0, 10.0, 10.0, 200.0, 0.0, 30.0, 10.0, 140.0, 90.0, 270.0, 0.0, 460.0, 70.0, 20.0, 100.0, 30.0, 370.0, 140.0, 260.0, 200.0, 50.0, 70.0, 150.0, 20.0, 30.0, 130.0, 50.0, 400.0, 80.0, 300.0, 70.0, 10.0, 170.0, 110.0, 30.0, 10.0, 130.0, 45.0, 60.0, 130.0, 20.0, 60.0, 280.0, 310.0, 180.0, 20.0, 50.0, 0.0, 170.0, 310.0, 180.0, 40.0, 100.0, 50.0, 80.0, 60.0, 240.0, 130.0, 170.0, 130.0, 60.0, 40.0, 200.0, 330.0, 30.0, 10.0, 400.0, 10.0, 40.0, 380.0, 250.0, 70.0, 270.0, 80.0, 50.0, 140.0, -30.0, 290.0, 30.0, 10.0, 90.0, 170.0, 410.0, 20.0, 80.0, -270.0, 10.0, 0.0, 350.0, 100.0, -10.0, 90.0, -80.0, 590.0, 20.0, -10.0, 0.0, -20.0, 320.0, 0.0, 10.0, 80.0, 190.0, 20.0, 70.0, 20.0, 220.0, 300.0, 260.0, 90.0, 40.0, -10.0, 310.0, 80.0, 20.0, 170.0, 90.0, 150.0, 10.0, 60.0, 25.0, 10.0, 10.0, 0.0, 260.0, 80.0, 170.0, 50.0, 630.0, 40.0, 210.0, 270.0, 170.0, 10.0, 190.0, 20.0, -50.0, -20.0, 40.0, 170.0, 50.0, 40.0, 40.0, 0.0, 110.0, 0.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 210.0, 180.0, 60.0, 30.0, 10.0, 60.0, 60.0, 10.0, 60.0, 30.0, 10.0, 20.0, 30.0, 20.0, 80.0, 370.0, 20.0, 30.0, 440.0, 290.0, 60.0, 20.0, 40.0, 170.0, 20.0, 10.0, 320.0, 60.0, 40.0, 470.0, 80.0, 500.0, 20.0, 10.0, 40.0, 0.0, 50.0, 300.0, 0.0, 270.0, 20.0, 30.0, 370.0, 200.0, 360.0, -10.0, 60.0, 100.0, 540.0, 90.0, 70.0, 220.0, 30.0, 80.0, 60.0, 270.0, 90.0, 70.0, 40.0, 20.0, 110.0, -150.0, 20.0, 90.0, 410.0, 110.0, 40.0, 170.0, 30.0, 40.0, 120.0, 220.0, 50.0, 180.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 40.0, 510.0, 270.0, 80.0, 15.0, 150.0, 30.0, 100.0, 220.0, 350.0, 80.0, 60.0, 150.0, 20.0, 80.0, 90.0, 20.0, 110.0, 40.0, 30.0, 30.0, 40.0, 170.0, 40.0, 90.0, 10.0, 370.0, 90.0, 480.0, -30.0, -50.0, 300.0, 90.0, 10.0, 30.0, 20.0, 260.0, 10.0, 10.0, 470.0, 230.0, 10.0, 30.0, 20.0, 290.0, 190.0, -10.0, 0.0, 10.0, 20.0, 150.0, 90.0, 400.0, 360.0, 70.0, 120.0, 0.0, 30.0, 50.0, 50.0, 310.0, 80.0, 50.0, 340.0, 20.0, 20.0, 200.0, 320.0, 80.0, 50.0, -70.0, 10.0, -80.0, 220.0, 180.0, 525.0, 350.0, 210.0, 110.0, 700.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1509993650797643, "mean_inference_ms": 2.0545512731939493, "mean_action_processing_ms": 0.5725390676047638, "mean_env_wait_ms": 1.8496630761822928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013403177261352539, "StateBufferConnector_ms": 0.010329008102416992, "ViewRequirementAgentConnector_ms": 0.3926422595977783}, "num_episodes": 18, "episode_return_max": 2250.0, "episode_return_min": 110.0, "episode_return_mean": 1067.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.725002968666044, "num_env_steps_trained_throughput_per_sec": 5.725002968666044, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 2200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2200000, "timers": {"training_iteration_time_ms": 1441441.608, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1441441.549, "sample_time_ms": 3417.477, "learn_time_ms": 1437992.147, "learn_throughput": 2.782, "synch_weights_time_ms": 14.713}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "done": false, "training_iteration": 55, "trial_id": "3d3a5_00000", "date": "2024-06-01_06-30-25", "timestamp": 1717237825, "time_this_iter_s": 698.7020471096039, "time_total_s": 28641.730167388916, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8249d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28641.730167388916, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 19.988028169014086, "ram_util_percent": 80.78345070422536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.355831265367004, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.696910514719824, "policy_loss": -0.006902500831361372, "vf_loss": 6.703131787134563, "vf_explained_var": 0.0005757300363688931, "kl": 0.0068123619286250174, "entropy": 0.4028517565216881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 521145.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 2250.0, "episode_reward_min": 110.0, "episode_reward_mean": 1025.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -400.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 102.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 1410.0, 330.0, 860.0, 320.0, 2250.0, 1410.0, 1260.0, 415.0, 1220.0, 1040.0, 950.0, 475.0, 1410.0, 1290.0, 810.0, 820.0, 350.0, 1330.0, 650.0, 345.0, 340.0, 1300.0, 810.0, 1250.0, 1430.0, 470.0, 1260.0, 840.0, 915.0, 620.0, 1210.0, 1115.0, 1640.0, 1080.0, 1450.0, 180.0, 1060.0, 1480.0, 1430.0, 530.0, 1360.0, 1180.0, 1010.0, 745.0, 970.0, 520.0, 1430.0, 1420.0, 980.0, 370.0, 1550.0, 1360.0, 955.0, 1110.0, 1360.0, 1380.0, 1540.0, 550.0, 1030.0, 1230.0, 1200.0, 675.0, 1470.0, 460.0, 580.0, 310.0, 1520.0, 1530.0, 1280.0, 1540.0, 620.0, 1370.0, 110.0, 1765.0, 680.0, 1290.0, 1150.0, 790.0, 1320.0, 1470.0, 2155.0, 1390.0, 1430.0, 1080.0, 1270.0, 750.0, 1240.0, 790.0, 1570.0, 570.0, 690.0, 810.0, 730.0, 685.0, 800.0, 460.0, 1180.0, 950.0, 1045.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 0.0, 0.0, 20.0, 170.0, 10.0, 0.0, 110.0, 20.0, 0.0, 70.0, 110.0, 80.0, 70.0, 130.0, 230.0, 410.0, 180.0, 60.0, 70.0, 0.0, 50.0, 10.0, 160.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 350.0, 20.0, 140.0, 30.0, 20.0, 30.0, 0.0, 90.0, 20.0, 160.0, 80.0, 20.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 930.0, 100.0, 20.0, 110.0, -30.0, -20.0, 640.0, 350.0, 90.0, 60.0, -10.0, 320.0, 700.0, 30.0, 30.0, -20.0, 10.0, 200.0, 100.0, 50.0, 110.0, 190.0, 40.0, 80.0, 60.0, 200.0, 60.0, 50.0, 370.0, 100.0, 10.0, 30.0, 30.0, 30.0, 60.0, 20.0, 20.0, 25.0, 20.0, 170.0, -10.0, 130.0, 260.0, 40.0, 180.0, 30.0, 90.0, 90.0, 400.0, 10.0, 350.0, 60.0, 0.0, 310.0, 30.0, 10.0, 120.0, 80.0, 70.0, 10.0, 35.0, 80.0, 20.0, 100.0, 390.0, 50.0, -5.0, 70.0, 190.0, 20.0, 30.0, 10.0, 10.0, 190.0, 10.0, -5.0, 20.0, 0.0, 210.0, 0.0, 310.0, 0.0, 320.0, -200.0, 240.0, 220.0, 20.0, 300.0, 150.0, 50.0, 30.0, 50.0, 60.0, 160.0, 120.0, 40.0, 30.0, 210.0, 80.0, 510.0, 50.0, 50.0, 10.0, 120.0, 180.0, 20.0, 40.0, 110.0, 190.0, 40.0, 130.0, 30.0, 80.0, 50.0, 20.0, 40.0, 0.0, 140.0, 20.0, 310.0, 10.0, 40.0, 0.0, 0.0, 10.0, 30.0, 20.0, 190.0, 10.0, 40.0, 70.0, 90.0, 460.0, 100.0, 0.0, 170.0, 50.0, 210.0, 40.0, 140.0, 10.0, 40.0, 200.0, 0.0, -30.0, 70.0, 60.0, 0.0, 250.0, 50.0, 20.0, 0.0, 15.0, 20.0, 90.0, 40.0, 10.0, 20.0, 100.0, 30.0, 0.0, 60.0, 10.0, 40.0, 0.0, 20.0, 160.0, 10.0, 40.0, 0.0, 60.0, -30.0, 540.0, 290.0, 10.0, 160.0, 70.0, 40.0, 120.0, 40.0, 40.0, 150.0, 290.0, 0.0, 10.0, 220.0, -40.0, 20.0, 50.0, 70.0, 90.0, 30.0, 220.0, 80.0, 30.0, 150.0, 40.0, 80.0, 300.0, 230.0, 70.0, 50.0, 30.0, 0.0, 340.0, 60.0, 20.0, 290.0, 110.0, 460.0, 30.0, 10.0, 20.0, 0.0, 160.0, 20.0, 120.0, 20.0, 90.0, 0.0, 50.0, 420.0, 50.0, -20.0, 30.0, 230.0, 170.0, 300.0, 20.0, 10.0, -40.0, 65.0, 410.0, -215.0, 190.0, -130.0, 310.0, 80.0, 180.0, -10.0, 190.0, 100.0, 0.0, 90.0, 30.0, 120.0, 230.0, 20.0, 10.0, 125.0, 80.0, 10.0, 35.0, 60.0, 15.0, 170.0, 70.0, 0.0, 20.0, 160.0, 290.0, 200.0, 420.0, 20.0, 40.0, 80.0, 10.0, 90.0, 20.0, 40.0, 0.0, 130.0, 30.0, 160.0, 20.0, 70.0, 25.0, 380.0, 280.0, 20.0, 80.0, 50.0, 630.0, 330.0, 200.0, 60.0, 180.0, 10.0, 80.0, 20.0, 10.0, 30.0, -30.0, 70.0, 170.0, 50.0, 200.0, 230.0, 270.0, 80.0, 320.0, 440.0, 20.0, 110.0, 10.0, 30.0, 410.0, 50.0, 20.0, 40.0, 10.0, -5.0, 0.0, -5.0, 40.0, 10.0, 110.0, 0.0, 0.0, 20.0, 90.0, 220.0, 30.0, 0.0, 100.0, 30.0, 0.0, 210.0, 40.0, 340.0, 70.0, 270.0, 640.0, 40.0, 190.0, 0.0, 20.0, 40.0, 190.0, 20.0, 220.0, 210.0, 0.0, 80.0, 240.0, 80.0, 110.0, 310.0, 50.0, 130.0, 60.0, 50.0, 50.0, 0.0, 40.0, 20.0, 270.0, -90.0, 120.0, 10.0, 380.0, 120.0, 40.0, 40.0, 270.0, 40.0, 120.0, 180.0, 70.0, 100.0, 60.0, 170.0, 250.0, 0.0, 210.0, 60.0, 60.0, 80.0, 230.0, 60.0, 20.0, 220.0, 50.0, 350.0, 20.0, 20.0, 30.0, 180.0, 80.0, 40.0, 90.0, -40.0, 190.0, 150.0, 30.0, 10.0, 120.0, 25.0, 10.0, 160.0, 50.0, 80.0, 180.0, 200.0, 40.0, 0.0, 0.0, 30.0, 110.0, 280.0, 10.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 50.0, 220.0, 20.0, 80.0, 180.0, 70.0, 110.0, 120.0, 390.0, 70.0, 30.0, 340.0, 40.0, 150.0, 30.0, 440.0, 10.0, 110.0, 120.0, 280.0, 60.0, 190.0, 30.0, 60.0, 30.0, 0.0, 10.0, 20.0, 0.0, 150.0, 170.0, 170.0, 370.0, 40.0, 20.0, -90.0, 10.0, 10.0, 200.0, 0.0, 30.0, 10.0, 140.0, 90.0, 270.0, 0.0, 460.0, 70.0, 20.0, 100.0, 30.0, 370.0, 140.0, 260.0, 200.0, 50.0, 70.0, 150.0, 20.0, 30.0, 130.0, 50.0, 400.0, 80.0, 300.0, 70.0, 10.0, 170.0, 110.0, 30.0, 10.0, 130.0, 45.0, 60.0, 130.0, 20.0, 60.0, 280.0, 310.0, 180.0, 20.0, 50.0, 0.0, 170.0, 310.0, 180.0, 40.0, 100.0, 50.0, 80.0, 60.0, 240.0, 130.0, 170.0, 130.0, 60.0, 40.0, 200.0, 330.0, 30.0, 10.0, 400.0, 10.0, 40.0, 380.0, 250.0, 70.0, 270.0, 80.0, 50.0, 140.0, -30.0, 290.0, 30.0, 10.0, 90.0, 170.0, 410.0, 20.0, 80.0, -270.0, 10.0, 0.0, 350.0, 100.0, -10.0, 90.0, -80.0, 590.0, 20.0, -10.0, 0.0, -20.0, 320.0, 0.0, 10.0, 80.0, 190.0, 20.0, 70.0, 20.0, 220.0, 300.0, 260.0, 90.0, 40.0, -10.0, 310.0, 80.0, 20.0, 170.0, 90.0, 150.0, 10.0, 60.0, 25.0, 10.0, 10.0, 0.0, 260.0, 80.0, 170.0, 50.0, 630.0, 40.0, 210.0, 270.0, 170.0, 10.0, 190.0, 20.0, -50.0, -20.0, 40.0, 170.0, 50.0, 40.0, 40.0, 0.0, 110.0, 0.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 210.0, 180.0, 60.0, 30.0, 10.0, 60.0, 60.0, 10.0, 60.0, 30.0, 10.0, 20.0, 30.0, 20.0, 80.0, 370.0, 20.0, 30.0, 440.0, 290.0, 60.0, 20.0, 40.0, 170.0, 20.0, 10.0, 320.0, 60.0, 40.0, 470.0, 80.0, 500.0, 20.0, 10.0, 40.0, 0.0, 50.0, 300.0, 0.0, 270.0, 20.0, 30.0, 370.0, 200.0, 360.0, -10.0, 60.0, 100.0, 540.0, 90.0, 70.0, 220.0, 30.0, 80.0, 60.0, 270.0, 90.0, 70.0, 40.0, 20.0, 110.0, -150.0, 20.0, 90.0, 410.0, 110.0, 40.0, 170.0, 30.0, 40.0, 120.0, 220.0, 50.0, 180.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 40.0, 510.0, 270.0, 80.0, 15.0, 150.0, 30.0, 100.0, 220.0, 350.0, 80.0, 60.0, 150.0, 20.0, 80.0, 90.0, 20.0, 110.0, 40.0, 30.0, 30.0, 40.0, 170.0, 40.0, 90.0, 10.0, 370.0, 90.0, 480.0, -30.0, -50.0, 300.0, 90.0, 10.0, 30.0, 20.0, 260.0, 10.0, 10.0, 470.0, 230.0, 10.0, 30.0, 20.0, 290.0, 190.0, -10.0, 0.0, 10.0, 20.0, 150.0, 90.0, 400.0, 360.0, 70.0, 120.0, 0.0, 30.0, 50.0, 50.0, 310.0, 80.0, 50.0, 340.0, 20.0, 20.0, 200.0, 320.0, 80.0, 50.0, -70.0, 10.0, -80.0, 220.0, 180.0, 525.0, 350.0, 210.0, 110.0, 700.0, 20.0, 200.0, 310.0, 400.0, 80.0, 270.0, -90.0, 40.0, 70.0, 90.0, 690.0, 10.0, 360.0, 30.0, -10.0, 130.0, 80.0, 80.0, 60.0, 0.0, 0.0, 70.0, 0.0, 50.0, 90.0, 80.0, 0.0, 510.0, 310.0, -30.0, 680.0, -20.0, 20.0, 30.0, 260.0, 260.0, 20.0, -20.0, 0.0, 40.0, 60.0, 30.0, 10.0, 410.0, 30.0, 40.0, -40.0, 20.0, 0.0, 190.0, 0.0, 410.0, 130.0, 60.0, 280.0, 140.0, 80.0, 0.0, 40.0, 100.0, 100.0, 80.0, 100.0, 300.0, 80.0, 30.0, 0.0, 30.0, 70.0, 0.0, 10.0, 0.0, 100.0, 30.0, 540.0, 30.0, 20.0, 180.0, 500.0, 160.0, 10.0, 30.0, 20.0, 110.0, 40.0, 60.0, 0.0, 60.0, 210.0, 30.0, -10.0, 50.0, 10.0, 200.0, 20.0, 380.0, 40.0, 30.0, -30.0, 0.0, 10.0, 210.0, 0.0, 30.0, 120.0, 0.0, -10.0, 80.0, 200.0, 170.0, 110.0, 10.0, 310.0, 70.0, 0.0, 0.0, 40.0, 120.0, 0.0, 70.0, 10.0, 110.0, 0.0, 20.0, 30.0, 310.0, 0.0, 0.0, 35.0, 170.0, 130.0, 270.0, 10.0, 0.0, 170.0, 0.0, 120.0, 60.0, -40.0, 80.0, 40.0, 10.0, 110.0, 10.0, 20.0, 20.0, 40.0, 500.0, -400.0, 110.0, 70.0, 190.0, 60.0, 110.0, 50.0, 30.0, 0.0, 80.0, 0.0, 590.0, 10.0, 20.0, 20.0, 0.0, 20.0, 560.0, 80.0, 180.0, 60.0, 0.0, 170.0, 30.0, 20.0, 110.0, 0.0, 290.0, 260.0, 40.0, 35.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.140473504324774, "mean_inference_ms": 2.047223436024926, "mean_action_processing_ms": 0.5696093771014241, "mean_env_wait_ms": 1.8401291197990632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013382196426391602, "StateBufferConnector_ms": 0.010264158248901367, "ViewRequirementAgentConnector_ms": 0.3914525508880615}, "num_episodes": 18, "episode_return_max": 2250.0, "episode_return_min": 110.0, "episode_return_mean": 1025.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.0944510746977913, "num_env_steps_trained_throughput_per_sec": 2.0944510746977913, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 1567539.139, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1567539.08, "sample_time_ms": 3351.239, "learn_time_ms": 1564154.696, "learn_throughput": 2.557, "synch_weights_time_ms": 14.369}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 56, "trial_id": "3d3a5_00000", "date": "2024-06-01_07-02-15", "timestamp": 1717239735, "time_this_iter_s": 1909.8462913036346, "time_total_s": 30551.57645869255, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f887ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30551.57645869255, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 26.27986348122867, "ram_util_percent": 82.09931740614334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.286398129138195, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.120317688587502, "policy_loss": -0.009282287517592263, "vf_loss": 7.128821572150412, "vf_explained_var": -3.1893582135851515e-05, "kl": 0.007784173423679699, "entropy": 0.41605372683753095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 530535.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 2155.0, "episode_reward_min": 110.0, "episode_reward_mean": 1069.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -400.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 106.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1300.0, 810.0, 1250.0, 1430.0, 470.0, 1260.0, 840.0, 915.0, 620.0, 1210.0, 1115.0, 1640.0, 1080.0, 1450.0, 180.0, 1060.0, 1480.0, 1430.0, 530.0, 1360.0, 1180.0, 1010.0, 745.0, 970.0, 520.0, 1430.0, 1420.0, 980.0, 370.0, 1550.0, 1360.0, 955.0, 1110.0, 1360.0, 1380.0, 1540.0, 550.0, 1030.0, 1230.0, 1200.0, 675.0, 1470.0, 460.0, 580.0, 310.0, 1520.0, 1530.0, 1280.0, 1540.0, 620.0, 1370.0, 110.0, 1765.0, 680.0, 1290.0, 1150.0, 790.0, 1320.0, 1470.0, 2155.0, 1390.0, 1430.0, 1080.0, 1270.0, 750.0, 1240.0, 790.0, 1570.0, 570.0, 690.0, 810.0, 730.0, 685.0, 800.0, 460.0, 1180.0, 950.0, 1045.0, 420.0, 980.0, 1455.0, 890.0, 1710.0, 1300.0, 1110.0, 830.0, 1410.0, 570.0, 1020.0, 900.0, 1230.0, 1640.0, 1285.0, 1355.0, 1420.0, 450.0, 780.0, 940.0, 1520.0, 910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, -30.0, 540.0, 290.0, 10.0, 160.0, 70.0, 40.0, 120.0, 40.0, 40.0, 150.0, 290.0, 0.0, 10.0, 220.0, -40.0, 20.0, 50.0, 70.0, 90.0, 30.0, 220.0, 80.0, 30.0, 150.0, 40.0, 80.0, 300.0, 230.0, 70.0, 50.0, 30.0, 0.0, 340.0, 60.0, 20.0, 290.0, 110.0, 460.0, 30.0, 10.0, 20.0, 0.0, 160.0, 20.0, 120.0, 20.0, 90.0, 0.0, 50.0, 420.0, 50.0, -20.0, 30.0, 230.0, 170.0, 300.0, 20.0, 10.0, -40.0, 65.0, 410.0, -215.0, 190.0, -130.0, 310.0, 80.0, 180.0, -10.0, 190.0, 100.0, 0.0, 90.0, 30.0, 120.0, 230.0, 20.0, 10.0, 125.0, 80.0, 10.0, 35.0, 60.0, 15.0, 170.0, 70.0, 0.0, 20.0, 160.0, 290.0, 200.0, 420.0, 20.0, 40.0, 80.0, 10.0, 90.0, 20.0, 40.0, 0.0, 130.0, 30.0, 160.0, 20.0, 70.0, 25.0, 380.0, 280.0, 20.0, 80.0, 50.0, 630.0, 330.0, 200.0, 60.0, 180.0, 10.0, 80.0, 20.0, 10.0, 30.0, -30.0, 70.0, 170.0, 50.0, 200.0, 230.0, 270.0, 80.0, 320.0, 440.0, 20.0, 110.0, 10.0, 30.0, 410.0, 50.0, 20.0, 40.0, 10.0, -5.0, 0.0, -5.0, 40.0, 10.0, 110.0, 0.0, 0.0, 20.0, 90.0, 220.0, 30.0, 0.0, 100.0, 30.0, 0.0, 210.0, 40.0, 340.0, 70.0, 270.0, 640.0, 40.0, 190.0, 0.0, 20.0, 40.0, 190.0, 20.0, 220.0, 210.0, 0.0, 80.0, 240.0, 80.0, 110.0, 310.0, 50.0, 130.0, 60.0, 50.0, 50.0, 0.0, 40.0, 20.0, 270.0, -90.0, 120.0, 10.0, 380.0, 120.0, 40.0, 40.0, 270.0, 40.0, 120.0, 180.0, 70.0, 100.0, 60.0, 170.0, 250.0, 0.0, 210.0, 60.0, 60.0, 80.0, 230.0, 60.0, 20.0, 220.0, 50.0, 350.0, 20.0, 20.0, 30.0, 180.0, 80.0, 40.0, 90.0, -40.0, 190.0, 150.0, 30.0, 10.0, 120.0, 25.0, 10.0, 160.0, 50.0, 80.0, 180.0, 200.0, 40.0, 0.0, 0.0, 30.0, 110.0, 280.0, 10.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 50.0, 220.0, 20.0, 80.0, 180.0, 70.0, 110.0, 120.0, 390.0, 70.0, 30.0, 340.0, 40.0, 150.0, 30.0, 440.0, 10.0, 110.0, 120.0, 280.0, 60.0, 190.0, 30.0, 60.0, 30.0, 0.0, 10.0, 20.0, 0.0, 150.0, 170.0, 170.0, 370.0, 40.0, 20.0, -90.0, 10.0, 10.0, 200.0, 0.0, 30.0, 10.0, 140.0, 90.0, 270.0, 0.0, 460.0, 70.0, 20.0, 100.0, 30.0, 370.0, 140.0, 260.0, 200.0, 50.0, 70.0, 150.0, 20.0, 30.0, 130.0, 50.0, 400.0, 80.0, 300.0, 70.0, 10.0, 170.0, 110.0, 30.0, 10.0, 130.0, 45.0, 60.0, 130.0, 20.0, 60.0, 280.0, 310.0, 180.0, 20.0, 50.0, 0.0, 170.0, 310.0, 180.0, 40.0, 100.0, 50.0, 80.0, 60.0, 240.0, 130.0, 170.0, 130.0, 60.0, 40.0, 200.0, 330.0, 30.0, 10.0, 400.0, 10.0, 40.0, 380.0, 250.0, 70.0, 270.0, 80.0, 50.0, 140.0, -30.0, 290.0, 30.0, 10.0, 90.0, 170.0, 410.0, 20.0, 80.0, -270.0, 10.0, 0.0, 350.0, 100.0, -10.0, 90.0, -80.0, 590.0, 20.0, -10.0, 0.0, -20.0, 320.0, 0.0, 10.0, 80.0, 190.0, 20.0, 70.0, 20.0, 220.0, 300.0, 260.0, 90.0, 40.0, -10.0, 310.0, 80.0, 20.0, 170.0, 90.0, 150.0, 10.0, 60.0, 25.0, 10.0, 10.0, 0.0, 260.0, 80.0, 170.0, 50.0, 630.0, 40.0, 210.0, 270.0, 170.0, 10.0, 190.0, 20.0, -50.0, -20.0, 40.0, 170.0, 50.0, 40.0, 40.0, 0.0, 110.0, 0.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 210.0, 180.0, 60.0, 30.0, 10.0, 60.0, 60.0, 10.0, 60.0, 30.0, 10.0, 20.0, 30.0, 20.0, 80.0, 370.0, 20.0, 30.0, 440.0, 290.0, 60.0, 20.0, 40.0, 170.0, 20.0, 10.0, 320.0, 60.0, 40.0, 470.0, 80.0, 500.0, 20.0, 10.0, 40.0, 0.0, 50.0, 300.0, 0.0, 270.0, 20.0, 30.0, 370.0, 200.0, 360.0, -10.0, 60.0, 100.0, 540.0, 90.0, 70.0, 220.0, 30.0, 80.0, 60.0, 270.0, 90.0, 70.0, 40.0, 20.0, 110.0, -150.0, 20.0, 90.0, 410.0, 110.0, 40.0, 170.0, 30.0, 40.0, 120.0, 220.0, 50.0, 180.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 40.0, 510.0, 270.0, 80.0, 15.0, 150.0, 30.0, 100.0, 220.0, 350.0, 80.0, 60.0, 150.0, 20.0, 80.0, 90.0, 20.0, 110.0, 40.0, 30.0, 30.0, 40.0, 170.0, 40.0, 90.0, 10.0, 370.0, 90.0, 480.0, -30.0, -50.0, 300.0, 90.0, 10.0, 30.0, 20.0, 260.0, 10.0, 10.0, 470.0, 230.0, 10.0, 30.0, 20.0, 290.0, 190.0, -10.0, 0.0, 10.0, 20.0, 150.0, 90.0, 400.0, 360.0, 70.0, 120.0, 0.0, 30.0, 50.0, 50.0, 310.0, 80.0, 50.0, 340.0, 20.0, 20.0, 200.0, 320.0, 80.0, 50.0, -70.0, 10.0, -80.0, 220.0, 180.0, 525.0, 350.0, 210.0, 110.0, 700.0, 20.0, 200.0, 310.0, 400.0, 80.0, 270.0, -90.0, 40.0, 70.0, 90.0, 690.0, 10.0, 360.0, 30.0, -10.0, 130.0, 80.0, 80.0, 60.0, 0.0, 0.0, 70.0, 0.0, 50.0, 90.0, 80.0, 0.0, 510.0, 310.0, -30.0, 680.0, -20.0, 20.0, 30.0, 260.0, 260.0, 20.0, -20.0, 0.0, 40.0, 60.0, 30.0, 10.0, 410.0, 30.0, 40.0, -40.0, 20.0, 0.0, 190.0, 0.0, 410.0, 130.0, 60.0, 280.0, 140.0, 80.0, 0.0, 40.0, 100.0, 100.0, 80.0, 100.0, 300.0, 80.0, 30.0, 0.0, 30.0, 70.0, 0.0, 10.0, 0.0, 100.0, 30.0, 540.0, 30.0, 20.0, 180.0, 500.0, 160.0, 10.0, 30.0, 20.0, 110.0, 40.0, 60.0, 0.0, 60.0, 210.0, 30.0, -10.0, 50.0, 10.0, 200.0, 20.0, 380.0, 40.0, 30.0, -30.0, 0.0, 10.0, 210.0, 0.0, 30.0, 120.0, 0.0, -10.0, 80.0, 200.0, 170.0, 110.0, 10.0, 310.0, 70.0, 0.0, 0.0, 40.0, 120.0, 0.0, 70.0, 10.0, 110.0, 0.0, 20.0, 30.0, 310.0, 0.0, 0.0, 35.0, 170.0, 130.0, 270.0, 10.0, 0.0, 170.0, 0.0, 120.0, 60.0, -40.0, 80.0, 40.0, 10.0, 110.0, 10.0, 20.0, 20.0, 40.0, 500.0, -400.0, 110.0, 70.0, 190.0, 60.0, 110.0, 50.0, 30.0, 0.0, 80.0, 0.0, 590.0, 10.0, 20.0, 20.0, 0.0, 20.0, 560.0, 80.0, 180.0, 60.0, 0.0, 170.0, 30.0, 20.0, 110.0, 0.0, 290.0, 260.0, 40.0, 35.0, 90.0, 0.0, 50.0, 70.0, 40.0, 40.0, 80.0, 30.0, 40.0, 0.0, 70.0, 20.0, 390.0, 90.0, 30.0, 90.0, 0.0, 40.0, 140.0, 140.0, 40.0, 245.0, 360.0, 10.0, 210.0, 260.0, 80.0, 50.0, 200.0, 10.0, 30.0, 0.0, 50.0, 30.0, 20.0, 50.0, 100.0, 30.0, 60.0, 0.0, 550.0, 410.0, 10.0, 40.0, 320.0, 60.0, 220.0, 80.0, 100.0, 70.0, 400.0, 300.0, 440.0, 30.0, 20.0, 30.0, 30.0, 270.0, 40.0, 0.0, 140.0, 110.0, 90.0, 290.0, 80.0, 30.0, 80.0, 190.0, -10.0, 30.0, 220.0, 0.0, 60.0, 50.0, 320.0, 160.0, 60.0, 10.0, 110.0, 20.0, 40.0, 110.0, 260.0, 20.0, 40.0, 10.0, 0.0, 390.0, -30.0, 320.0, 290.0, 30.0, 0.0, 70.0, 10.0, 30.0, 20.0, 20.0, 200.0, 40.0, 150.0, 230.0, 150.0, 50.0, 80.0, 410.0, 60.0, 10.0, 10.0, 0.0, 20.0, 290.0, 200.0, 200.0, 30.0, 70.0, 60.0, 10.0, 160.0, -10.0, -110.0, 80.0, 30.0, 10.0, 70.0, 90.0, 470.0, 170.0, 80.0, 30.0, 200.0, 0.0, 40.0, 140.0, 30.0, 270.0, 440.0, -20.0, 60.0, 690.0, -10.0, 10.0, 60.0, 220.0, 10.0, 20.0, -75.0, 30.0, 420.0, 540.0, 50.0, 20.0, 80.0, 60.0, 40.0, 15.0, 240.0, 600.0, 60.0, 200.0, 40.0, 20.0, 0.0, 590.0, 110.0, 170.0, 340.0, 40.0, 50.0, 10.0, 90.0, 20.0, 10.0, 20.0, 40.0, 0.0, 80.0, 0.0, 50.0, 20.0, 210.0, 200.0, 30.0, 20.0, 60.0, 40.0, 210.0, 20.0, 100.0, 80.0, 20.0, 30.0, 310.0, 0.0, 30.0, 20.0, 290.0, 100.0, 110.0, 50.0, 0.0, 190.0, 220.0, 40.0, 160.0, 80.0, -20.0, 170.0, 470.0, 20.0, 190.0, 50.0, 10.0, 70.0, 40.0, 180.0, 20.0, 90.0, 400.0, 20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1280856356432865, "mean_inference_ms": 2.0386158952655866, "mean_action_processing_ms": 0.5662326100293531, "mean_env_wait_ms": 1.8289813093396037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012868881225585938, "StateBufferConnector_ms": 0.01183319091796875, "ViewRequirementAgentConnector_ms": 0.39710402488708496}, "num_episodes": 22, "episode_return_max": 2155.0, "episode_return_min": 110.0, "episode_return_mean": 1069.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.215386504613079, "num_env_steps_trained_throughput_per_sec": 3.215386504613079, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 1483653.668, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1483653.608, "sample_time_ms": 3328.468, "learn_time_ms": 1480293.444, "learn_throughput": 2.702, "synch_weights_time_ms": 13.822}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 57, "trial_id": "3d3a5_00000", "date": "2024-06-01_07-22-59", "timestamp": 1717240979, "time_this_iter_s": 1244.0324459075928, "time_total_s": 31795.608904600143, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7fe670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31795.608904600143, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 26.59551724137931, "ram_util_percent": 81.75620689655173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3750893616257382, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.150505220293364, "policy_loss": -0.008770792870073162, "vf_loss": 6.15850446937691, "vf_explained_var": 0.0002391979907648251, "kl": 0.0077154148209745265, "entropy": 0.41596401877804434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 539925.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 2155.0, "episode_reward_min": 110.0, "episode_reward_mean": 1053.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -400.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 105.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [970.0, 520.0, 1430.0, 1420.0, 980.0, 370.0, 1550.0, 1360.0, 955.0, 1110.0, 1360.0, 1380.0, 1540.0, 550.0, 1030.0, 1230.0, 1200.0, 675.0, 1470.0, 460.0, 580.0, 310.0, 1520.0, 1530.0, 1280.0, 1540.0, 620.0, 1370.0, 110.0, 1765.0, 680.0, 1290.0, 1150.0, 790.0, 1320.0, 1470.0, 2155.0, 1390.0, 1430.0, 1080.0, 1270.0, 750.0, 1240.0, 790.0, 1570.0, 570.0, 690.0, 810.0, 730.0, 685.0, 800.0, 460.0, 1180.0, 950.0, 1045.0, 420.0, 980.0, 1455.0, 890.0, 1710.0, 1300.0, 1110.0, 830.0, 1410.0, 570.0, 1020.0, 900.0, 1230.0, 1640.0, 1285.0, 1355.0, 1420.0, 450.0, 780.0, 940.0, 1520.0, 910.0, 890.0, 1350.0, 270.0, 640.0, 1410.0, 1760.0, 1200.0, 880.0, 1520.0, 125.0, 1070.0, 1230.0, 855.0, 370.0, 1530.0, 360.0, 660.0, 1295.0, 1025.0, 860.0, 1135.0, 970.0, 1340.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 80.0, 180.0, 200.0, 40.0, 0.0, 0.0, 30.0, 110.0, 280.0, 10.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 50.0, 220.0, 20.0, 80.0, 180.0, 70.0, 110.0, 120.0, 390.0, 70.0, 30.0, 340.0, 40.0, 150.0, 30.0, 440.0, 10.0, 110.0, 120.0, 280.0, 60.0, 190.0, 30.0, 60.0, 30.0, 0.0, 10.0, 20.0, 0.0, 150.0, 170.0, 170.0, 370.0, 40.0, 20.0, -90.0, 10.0, 10.0, 200.0, 0.0, 30.0, 10.0, 140.0, 90.0, 270.0, 0.0, 460.0, 70.0, 20.0, 100.0, 30.0, 370.0, 140.0, 260.0, 200.0, 50.0, 70.0, 150.0, 20.0, 30.0, 130.0, 50.0, 400.0, 80.0, 300.0, 70.0, 10.0, 170.0, 110.0, 30.0, 10.0, 130.0, 45.0, 60.0, 130.0, 20.0, 60.0, 280.0, 310.0, 180.0, 20.0, 50.0, 0.0, 170.0, 310.0, 180.0, 40.0, 100.0, 50.0, 80.0, 60.0, 240.0, 130.0, 170.0, 130.0, 60.0, 40.0, 200.0, 330.0, 30.0, 10.0, 400.0, 10.0, 40.0, 380.0, 250.0, 70.0, 270.0, 80.0, 50.0, 140.0, -30.0, 290.0, 30.0, 10.0, 90.0, 170.0, 410.0, 20.0, 80.0, -270.0, 10.0, 0.0, 350.0, 100.0, -10.0, 90.0, -80.0, 590.0, 20.0, -10.0, 0.0, -20.0, 320.0, 0.0, 10.0, 80.0, 190.0, 20.0, 70.0, 20.0, 220.0, 300.0, 260.0, 90.0, 40.0, -10.0, 310.0, 80.0, 20.0, 170.0, 90.0, 150.0, 10.0, 60.0, 25.0, 10.0, 10.0, 0.0, 260.0, 80.0, 170.0, 50.0, 630.0, 40.0, 210.0, 270.0, 170.0, 10.0, 190.0, 20.0, -50.0, -20.0, 40.0, 170.0, 50.0, 40.0, 40.0, 0.0, 110.0, 0.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 210.0, 180.0, 60.0, 30.0, 10.0, 60.0, 60.0, 10.0, 60.0, 30.0, 10.0, 20.0, 30.0, 20.0, 80.0, 370.0, 20.0, 30.0, 440.0, 290.0, 60.0, 20.0, 40.0, 170.0, 20.0, 10.0, 320.0, 60.0, 40.0, 470.0, 80.0, 500.0, 20.0, 10.0, 40.0, 0.0, 50.0, 300.0, 0.0, 270.0, 20.0, 30.0, 370.0, 200.0, 360.0, -10.0, 60.0, 100.0, 540.0, 90.0, 70.0, 220.0, 30.0, 80.0, 60.0, 270.0, 90.0, 70.0, 40.0, 20.0, 110.0, -150.0, 20.0, 90.0, 410.0, 110.0, 40.0, 170.0, 30.0, 40.0, 120.0, 220.0, 50.0, 180.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 40.0, 510.0, 270.0, 80.0, 15.0, 150.0, 30.0, 100.0, 220.0, 350.0, 80.0, 60.0, 150.0, 20.0, 80.0, 90.0, 20.0, 110.0, 40.0, 30.0, 30.0, 40.0, 170.0, 40.0, 90.0, 10.0, 370.0, 90.0, 480.0, -30.0, -50.0, 300.0, 90.0, 10.0, 30.0, 20.0, 260.0, 10.0, 10.0, 470.0, 230.0, 10.0, 30.0, 20.0, 290.0, 190.0, -10.0, 0.0, 10.0, 20.0, 150.0, 90.0, 400.0, 360.0, 70.0, 120.0, 0.0, 30.0, 50.0, 50.0, 310.0, 80.0, 50.0, 340.0, 20.0, 20.0, 200.0, 320.0, 80.0, 50.0, -70.0, 10.0, -80.0, 220.0, 180.0, 525.0, 350.0, 210.0, 110.0, 700.0, 20.0, 200.0, 310.0, 400.0, 80.0, 270.0, -90.0, 40.0, 70.0, 90.0, 690.0, 10.0, 360.0, 30.0, -10.0, 130.0, 80.0, 80.0, 60.0, 0.0, 0.0, 70.0, 0.0, 50.0, 90.0, 80.0, 0.0, 510.0, 310.0, -30.0, 680.0, -20.0, 20.0, 30.0, 260.0, 260.0, 20.0, -20.0, 0.0, 40.0, 60.0, 30.0, 10.0, 410.0, 30.0, 40.0, -40.0, 20.0, 0.0, 190.0, 0.0, 410.0, 130.0, 60.0, 280.0, 140.0, 80.0, 0.0, 40.0, 100.0, 100.0, 80.0, 100.0, 300.0, 80.0, 30.0, 0.0, 30.0, 70.0, 0.0, 10.0, 0.0, 100.0, 30.0, 540.0, 30.0, 20.0, 180.0, 500.0, 160.0, 10.0, 30.0, 20.0, 110.0, 40.0, 60.0, 0.0, 60.0, 210.0, 30.0, -10.0, 50.0, 10.0, 200.0, 20.0, 380.0, 40.0, 30.0, -30.0, 0.0, 10.0, 210.0, 0.0, 30.0, 120.0, 0.0, -10.0, 80.0, 200.0, 170.0, 110.0, 10.0, 310.0, 70.0, 0.0, 0.0, 40.0, 120.0, 0.0, 70.0, 10.0, 110.0, 0.0, 20.0, 30.0, 310.0, 0.0, 0.0, 35.0, 170.0, 130.0, 270.0, 10.0, 0.0, 170.0, 0.0, 120.0, 60.0, -40.0, 80.0, 40.0, 10.0, 110.0, 10.0, 20.0, 20.0, 40.0, 500.0, -400.0, 110.0, 70.0, 190.0, 60.0, 110.0, 50.0, 30.0, 0.0, 80.0, 0.0, 590.0, 10.0, 20.0, 20.0, 0.0, 20.0, 560.0, 80.0, 180.0, 60.0, 0.0, 170.0, 30.0, 20.0, 110.0, 0.0, 290.0, 260.0, 40.0, 35.0, 90.0, 0.0, 50.0, 70.0, 40.0, 40.0, 80.0, 30.0, 40.0, 0.0, 70.0, 20.0, 390.0, 90.0, 30.0, 90.0, 0.0, 40.0, 140.0, 140.0, 40.0, 245.0, 360.0, 10.0, 210.0, 260.0, 80.0, 50.0, 200.0, 10.0, 30.0, 0.0, 50.0, 30.0, 20.0, 50.0, 100.0, 30.0, 60.0, 0.0, 550.0, 410.0, 10.0, 40.0, 320.0, 60.0, 220.0, 80.0, 100.0, 70.0, 400.0, 300.0, 440.0, 30.0, 20.0, 30.0, 30.0, 270.0, 40.0, 0.0, 140.0, 110.0, 90.0, 290.0, 80.0, 30.0, 80.0, 190.0, -10.0, 30.0, 220.0, 0.0, 60.0, 50.0, 320.0, 160.0, 60.0, 10.0, 110.0, 20.0, 40.0, 110.0, 260.0, 20.0, 40.0, 10.0, 0.0, 390.0, -30.0, 320.0, 290.0, 30.0, 0.0, 70.0, 10.0, 30.0, 20.0, 20.0, 200.0, 40.0, 150.0, 230.0, 150.0, 50.0, 80.0, 410.0, 60.0, 10.0, 10.0, 0.0, 20.0, 290.0, 200.0, 200.0, 30.0, 70.0, 60.0, 10.0, 160.0, -10.0, -110.0, 80.0, 30.0, 10.0, 70.0, 90.0, 470.0, 170.0, 80.0, 30.0, 200.0, 0.0, 40.0, 140.0, 30.0, 270.0, 440.0, -20.0, 60.0, 690.0, -10.0, 10.0, 60.0, 220.0, 10.0, 20.0, -75.0, 30.0, 420.0, 540.0, 50.0, 20.0, 80.0, 60.0, 40.0, 15.0, 240.0, 600.0, 60.0, 200.0, 40.0, 20.0, 0.0, 590.0, 110.0, 170.0, 340.0, 40.0, 50.0, 10.0, 90.0, 20.0, 10.0, 20.0, 40.0, 0.0, 80.0, 0.0, 50.0, 20.0, 210.0, 200.0, 30.0, 20.0, 60.0, 40.0, 210.0, 20.0, 100.0, 80.0, 20.0, 30.0, 310.0, 0.0, 30.0, 20.0, 290.0, 100.0, 110.0, 50.0, 0.0, 190.0, 220.0, 40.0, 160.0, 80.0, -20.0, 170.0, 470.0, 20.0, 190.0, 50.0, 10.0, 70.0, 40.0, 180.0, 20.0, 90.0, 400.0, 20.0, 30.0, 80.0, 20.0, 70.0, 310.0, 50.0, 40.0, 30.0, 10.0, 180.0, 100.0, 10.0, 110.0, 60.0, 390.0, 410.0, 220.0, 10.0, 90.0, 10.0, 40.0, 10.0, 0.0, 70.0, 30.0, 30.0, 20.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 20.0, 80.0, 80.0, 40.0, 30.0, 20.0, 310.0, 20.0, 20.0, 30.0, 20.0, 20.0, 170.0, 270.0, 40.0, 270.0, 300.0, 270.0, 40.0, 260.0, 40.0, 130.0, 140.0, 200.0, 110.0, 280.0, -10.0, 570.0, 40.0, 270.0, 120.0, 70.0, 10.0, 320.0, 80.0, 10.0, 120.0, 160.0, 0.0, 10.0, 500.0, 160.0, 10.0, 0.0, 80.0, 40.0, 10.0, 70.0, 180.0, 260.0, 70.0, 40.0, 60.0, 20.0, 230.0, 170.0, 170.0, 320.0, 20.0, 30.0, 30.0, 10.0, 20.0, 0.0, 10.0, 5.0, 0.0, 0.0, 30.0, 110.0, 100.0, 20.0, 100.0, 110.0, 300.0, 20.0, 110.0, 170.0, 220.0, 50.0, 100.0, 90.0, 350.0, 400.0, 30.0, 30.0, 10.0, -50.0, 40.0, 20.0, 0.0, 20.0, 180.0, 200.0, 290.0, 90.0, 30.0, -15.0, 90.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 10.0, 50.0, 0.0, 40.0, 540.0, 240.0, 160.0, 290.0, 10.0, 30.0, 60.0, 80.0, 80.0, -10.0, 50.0, 40.0, 50.0, 40.0, 20.0, 40.0, 10.0, 10.0, 110.0, 10.0, 0.0, 30.0, 150.0, 210.0, 80.0, 0.0, 0.0, 140.0, 40.0, 160.0, 30.0, 120.0, 80.0, 15.0, 70.0, 100.0, 290.0, 270.0, 160.0, 260.0, 10.0, 20.0, 100.0, 110.0, 0.0, 40.0, 40.0, 420.0, 25.0, 70.0, -20.0, 210.0, 80.0, -180.0, 230.0, 70.0, 0.0, 10.0, 390.0, 410.0, 20.0, 10.0, 310.0, 10.0, 80.0, 10.0, 15.0, 30.0, 240.0, 10.0, 90.0, 300.0, 60.0, 80.0, 150.0, -70.0, 70.0, 180.0, 100.0, 40.0, 120.0, 20.0, 50.0, 160.0, 340.0, 90.0, 100.0, 110.0, 310.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.11506125125952, "mean_inference_ms": 2.029584464635017, "mean_action_processing_ms": 0.5627110220362033, "mean_env_wait_ms": 1.8178799618306254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013065814971923828, "StateBufferConnector_ms": 0.012151479721069336, "ViewRequirementAgentConnector_ms": 0.3997159004211426}, "num_episodes": 23, "episode_return_max": 2155.0, "episode_return_min": 110.0, "episode_return_mean": 1053.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.0334298273615588, "num_env_steps_trained_throughput_per_sec": 3.0334298273615588, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 1363709.177, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1363709.128, "sample_time_ms": 3292.005, "learn_time_ms": 1360392.009, "learn_throughput": 2.94, "synch_weights_time_ms": 13.639}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 58, "trial_id": "3d3a5_00000", "date": "2024-06-01_07-44-57", "timestamp": 1717242297, "time_this_iter_s": 1318.6598210334778, "time_total_s": 33114.26872563362, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8879d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 33114.26872563362, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 25.489003436426117, "ram_util_percent": 82.04742268041238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.181014755536446, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.569300706800434, "policy_loss": -0.0076634785030493405, "vf_loss": 6.576178492270847, "vf_explained_var": 0.00034206285517309674, "kl": 0.007856864575453933, "entropy": 0.412640699522056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 549315.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "env_runners": {"episode_reward_max": 2155.0, "episode_reward_min": 110.0, "episode_reward_mean": 1032.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -400.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 103.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1470.0, 460.0, 580.0, 310.0, 1520.0, 1530.0, 1280.0, 1540.0, 620.0, 1370.0, 110.0, 1765.0, 680.0, 1290.0, 1150.0, 790.0, 1320.0, 1470.0, 2155.0, 1390.0, 1430.0, 1080.0, 1270.0, 750.0, 1240.0, 790.0, 1570.0, 570.0, 690.0, 810.0, 730.0, 685.0, 800.0, 460.0, 1180.0, 950.0, 1045.0, 420.0, 980.0, 1455.0, 890.0, 1710.0, 1300.0, 1110.0, 830.0, 1410.0, 570.0, 1020.0, 900.0, 1230.0, 1640.0, 1285.0, 1355.0, 1420.0, 450.0, 780.0, 940.0, 1520.0, 910.0, 890.0, 1350.0, 270.0, 640.0, 1410.0, 1760.0, 1200.0, 880.0, 1520.0, 125.0, 1070.0, 1230.0, 855.0, 370.0, 1530.0, 360.0, 660.0, 1295.0, 1025.0, 860.0, 1135.0, 970.0, 1340.0, 465.0, 1290.0, 550.0, 1220.0, 220.0, 2010.0, 1880.0, 360.0, 735.0, 840.0, 1270.0, 595.0, 1200.0, 850.0, 790.0, 980.0, 1075.0, 1215.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [630.0, 40.0, 210.0, 270.0, 170.0, 10.0, 190.0, 20.0, -50.0, -20.0, 40.0, 170.0, 50.0, 40.0, 40.0, 0.0, 110.0, 0.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 210.0, 180.0, 60.0, 30.0, 10.0, 60.0, 60.0, 10.0, 60.0, 30.0, 10.0, 20.0, 30.0, 20.0, 80.0, 370.0, 20.0, 30.0, 440.0, 290.0, 60.0, 20.0, 40.0, 170.0, 20.0, 10.0, 320.0, 60.0, 40.0, 470.0, 80.0, 500.0, 20.0, 10.0, 40.0, 0.0, 50.0, 300.0, 0.0, 270.0, 20.0, 30.0, 370.0, 200.0, 360.0, -10.0, 60.0, 100.0, 540.0, 90.0, 70.0, 220.0, 30.0, 80.0, 60.0, 270.0, 90.0, 70.0, 40.0, 20.0, 110.0, -150.0, 20.0, 90.0, 410.0, 110.0, 40.0, 170.0, 30.0, 40.0, 120.0, 220.0, 50.0, 180.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 40.0, 510.0, 270.0, 80.0, 15.0, 150.0, 30.0, 100.0, 220.0, 350.0, 80.0, 60.0, 150.0, 20.0, 80.0, 90.0, 20.0, 110.0, 40.0, 30.0, 30.0, 40.0, 170.0, 40.0, 90.0, 10.0, 370.0, 90.0, 480.0, -30.0, -50.0, 300.0, 90.0, 10.0, 30.0, 20.0, 260.0, 10.0, 10.0, 470.0, 230.0, 10.0, 30.0, 20.0, 290.0, 190.0, -10.0, 0.0, 10.0, 20.0, 150.0, 90.0, 400.0, 360.0, 70.0, 120.0, 0.0, 30.0, 50.0, 50.0, 310.0, 80.0, 50.0, 340.0, 20.0, 20.0, 200.0, 320.0, 80.0, 50.0, -70.0, 10.0, -80.0, 220.0, 180.0, 525.0, 350.0, 210.0, 110.0, 700.0, 20.0, 200.0, 310.0, 400.0, 80.0, 270.0, -90.0, 40.0, 70.0, 90.0, 690.0, 10.0, 360.0, 30.0, -10.0, 130.0, 80.0, 80.0, 60.0, 0.0, 0.0, 70.0, 0.0, 50.0, 90.0, 80.0, 0.0, 510.0, 310.0, -30.0, 680.0, -20.0, 20.0, 30.0, 260.0, 260.0, 20.0, -20.0, 0.0, 40.0, 60.0, 30.0, 10.0, 410.0, 30.0, 40.0, -40.0, 20.0, 0.0, 190.0, 0.0, 410.0, 130.0, 60.0, 280.0, 140.0, 80.0, 0.0, 40.0, 100.0, 100.0, 80.0, 100.0, 300.0, 80.0, 30.0, 0.0, 30.0, 70.0, 0.0, 10.0, 0.0, 100.0, 30.0, 540.0, 30.0, 20.0, 180.0, 500.0, 160.0, 10.0, 30.0, 20.0, 110.0, 40.0, 60.0, 0.0, 60.0, 210.0, 30.0, -10.0, 50.0, 10.0, 200.0, 20.0, 380.0, 40.0, 30.0, -30.0, 0.0, 10.0, 210.0, 0.0, 30.0, 120.0, 0.0, -10.0, 80.0, 200.0, 170.0, 110.0, 10.0, 310.0, 70.0, 0.0, 0.0, 40.0, 120.0, 0.0, 70.0, 10.0, 110.0, 0.0, 20.0, 30.0, 310.0, 0.0, 0.0, 35.0, 170.0, 130.0, 270.0, 10.0, 0.0, 170.0, 0.0, 120.0, 60.0, -40.0, 80.0, 40.0, 10.0, 110.0, 10.0, 20.0, 20.0, 40.0, 500.0, -400.0, 110.0, 70.0, 190.0, 60.0, 110.0, 50.0, 30.0, 0.0, 80.0, 0.0, 590.0, 10.0, 20.0, 20.0, 0.0, 20.0, 560.0, 80.0, 180.0, 60.0, 0.0, 170.0, 30.0, 20.0, 110.0, 0.0, 290.0, 260.0, 40.0, 35.0, 90.0, 0.0, 50.0, 70.0, 40.0, 40.0, 80.0, 30.0, 40.0, 0.0, 70.0, 20.0, 390.0, 90.0, 30.0, 90.0, 0.0, 40.0, 140.0, 140.0, 40.0, 245.0, 360.0, 10.0, 210.0, 260.0, 80.0, 50.0, 200.0, 10.0, 30.0, 0.0, 50.0, 30.0, 20.0, 50.0, 100.0, 30.0, 60.0, 0.0, 550.0, 410.0, 10.0, 40.0, 320.0, 60.0, 220.0, 80.0, 100.0, 70.0, 400.0, 300.0, 440.0, 30.0, 20.0, 30.0, 30.0, 270.0, 40.0, 0.0, 140.0, 110.0, 90.0, 290.0, 80.0, 30.0, 80.0, 190.0, -10.0, 30.0, 220.0, 0.0, 60.0, 50.0, 320.0, 160.0, 60.0, 10.0, 110.0, 20.0, 40.0, 110.0, 260.0, 20.0, 40.0, 10.0, 0.0, 390.0, -30.0, 320.0, 290.0, 30.0, 0.0, 70.0, 10.0, 30.0, 20.0, 20.0, 200.0, 40.0, 150.0, 230.0, 150.0, 50.0, 80.0, 410.0, 60.0, 10.0, 10.0, 0.0, 20.0, 290.0, 200.0, 200.0, 30.0, 70.0, 60.0, 10.0, 160.0, -10.0, -110.0, 80.0, 30.0, 10.0, 70.0, 90.0, 470.0, 170.0, 80.0, 30.0, 200.0, 0.0, 40.0, 140.0, 30.0, 270.0, 440.0, -20.0, 60.0, 690.0, -10.0, 10.0, 60.0, 220.0, 10.0, 20.0, -75.0, 30.0, 420.0, 540.0, 50.0, 20.0, 80.0, 60.0, 40.0, 15.0, 240.0, 600.0, 60.0, 200.0, 40.0, 20.0, 0.0, 590.0, 110.0, 170.0, 340.0, 40.0, 50.0, 10.0, 90.0, 20.0, 10.0, 20.0, 40.0, 0.0, 80.0, 0.0, 50.0, 20.0, 210.0, 200.0, 30.0, 20.0, 60.0, 40.0, 210.0, 20.0, 100.0, 80.0, 20.0, 30.0, 310.0, 0.0, 30.0, 20.0, 290.0, 100.0, 110.0, 50.0, 0.0, 190.0, 220.0, 40.0, 160.0, 80.0, -20.0, 170.0, 470.0, 20.0, 190.0, 50.0, 10.0, 70.0, 40.0, 180.0, 20.0, 90.0, 400.0, 20.0, 30.0, 80.0, 20.0, 70.0, 310.0, 50.0, 40.0, 30.0, 10.0, 180.0, 100.0, 10.0, 110.0, 60.0, 390.0, 410.0, 220.0, 10.0, 90.0, 10.0, 40.0, 10.0, 0.0, 70.0, 30.0, 30.0, 20.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 20.0, 80.0, 80.0, 40.0, 30.0, 20.0, 310.0, 20.0, 20.0, 30.0, 20.0, 20.0, 170.0, 270.0, 40.0, 270.0, 300.0, 270.0, 40.0, 260.0, 40.0, 130.0, 140.0, 200.0, 110.0, 280.0, -10.0, 570.0, 40.0, 270.0, 120.0, 70.0, 10.0, 320.0, 80.0, 10.0, 120.0, 160.0, 0.0, 10.0, 500.0, 160.0, 10.0, 0.0, 80.0, 40.0, 10.0, 70.0, 180.0, 260.0, 70.0, 40.0, 60.0, 20.0, 230.0, 170.0, 170.0, 320.0, 20.0, 30.0, 30.0, 10.0, 20.0, 0.0, 10.0, 5.0, 0.0, 0.0, 30.0, 110.0, 100.0, 20.0, 100.0, 110.0, 300.0, 20.0, 110.0, 170.0, 220.0, 50.0, 100.0, 90.0, 350.0, 400.0, 30.0, 30.0, 10.0, -50.0, 40.0, 20.0, 0.0, 20.0, 180.0, 200.0, 290.0, 90.0, 30.0, -15.0, 90.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 10.0, 50.0, 0.0, 40.0, 540.0, 240.0, 160.0, 290.0, 10.0, 30.0, 60.0, 80.0, 80.0, -10.0, 50.0, 40.0, 50.0, 40.0, 20.0, 40.0, 10.0, 10.0, 110.0, 10.0, 0.0, 30.0, 150.0, 210.0, 80.0, 0.0, 0.0, 140.0, 40.0, 160.0, 30.0, 120.0, 80.0, 15.0, 70.0, 100.0, 290.0, 270.0, 160.0, 260.0, 10.0, 20.0, 100.0, 110.0, 0.0, 40.0, 40.0, 420.0, 25.0, 70.0, -20.0, 210.0, 80.0, -180.0, 230.0, 70.0, 0.0, 10.0, 390.0, 410.0, 20.0, 10.0, 310.0, 10.0, 80.0, 10.0, 15.0, 30.0, 240.0, 10.0, 90.0, 300.0, 60.0, 80.0, 150.0, -70.0, 70.0, 180.0, 100.0, 40.0, 120.0, 20.0, 50.0, 160.0, 340.0, 90.0, 100.0, 110.0, 310.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 20.0, -15.0, 330.0, 10.0, 450.0, -40.0, 30.0, 180.0, 160.0, 50.0, 70.0, 200.0, 20.0, 170.0, 70.0, 90.0, 50.0, 0.0, 20.0, 50.0, 180.0, 50.0, 40.0, 0.0, 0.0, 110.0, 290.0, 50.0, 20.0, 70.0, 350.0, -20.0, 30.0, 320.0, 40.0, 0.0, 80.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 110.0, 130.0, 370.0, 120.0, 170.0, 90.0, 20.0, 140.0, 220.0, 640.0, 90.0, 80.0, 650.0, 170.0, 170.0, 70.0, 10.0, 610.0, -20.0, 50.0, 110.0, 10.0, 10.0, 160.0, 0.0, 0.0, 60.0, 0.0, 10.0, 0.0, 40.0, 20.0, 60.0, 30.0, 160.0, 10.0, 30.0, 35.0, 30.0, 320.0, 50.0, 390.0, -30.0, 260.0, 20.0, 20.0, 40.0, 90.0, 20.0, -20.0, 30.0, 140.0, 30.0, 60.0, 40.0, 50.0, 250.0, 210.0, 290.0, 170.0, 10.0, 65.0, 30.0, 200.0, 40.0, 30.0, 10.0, 120.0, 60.0, 30.0, 70.0, 30.0, 0.0, 220.0, 80.0, 70.0, 200.0, 70.0, 420.0, 40.0, 140.0, 60.0, 180.0, 180.0, 220.0, 30.0, -110.0, 90.0, 30.0, 30.0, 80.0, 90.0, 30.0, 210.0, 10.0, 10.0, 60.0, 40.0, 90.0, 170.0, 20.0, 140.0, 170.0, 0.0, 150.0, 200.0, 20.0, 40.0, 190.0, 50.0, 0.0, 70.0, 170.0, 100.0, 20.0, 270.0, 290.0, 90.0, 35.0, 30.0, 70.0, 140.0, 0.0, 130.0, 310.0, 140.0, 60.0, 40.0, 310.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1055441424524997, "mean_inference_ms": 2.0225533991568416, "mean_action_processing_ms": 0.5600319970719222, "mean_env_wait_ms": 1.8094122565241253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013217449188232422, "StateBufferConnector_ms": 0.012149572372436523, "ViewRequirementAgentConnector_ms": 0.3982076644897461}, "num_episodes": 18, "episode_return_max": 2155.0, "episode_return_min": 110.0, "episode_return_mean": 1032.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.6207899733238036, "num_env_steps_trained_throughput_per_sec": 3.6207899733238036, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 2360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2360000, "timers": {"training_iteration_time_ms": 1355638.767, "restore_workers_time_ms": 0.012, "training_step_time_ms": 1355638.723, "sample_time_ms": 2837.03, "learn_time_ms": 1352776.872, "learn_throughput": 2.957, "synch_weights_time_ms": 12.992}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "done": false, "training_iteration": 59, "trial_id": "3d3a5_00000", "date": "2024-06-01_08-03-22", "timestamp": 1717243402, "time_this_iter_s": 1104.7556002140045, "time_total_s": 34219.024325847626, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f86eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 34219.024325847626, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.533797909407664, "ram_util_percent": 80.97177700348432}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8925842177436247, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.20429585018097, "policy_loss": -0.007183248663288407, "vf_loss": 6.210742101679468, "vf_explained_var": -0.00011058532264920724, "kl": 0.007369933042584543, "entropy": 0.3964322909665184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 558705.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 2155.0, "episode_reward_min": 125.0, "episode_reward_mean": 1010.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -400.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 101.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2155.0, 1390.0, 1430.0, 1080.0, 1270.0, 750.0, 1240.0, 790.0, 1570.0, 570.0, 690.0, 810.0, 730.0, 685.0, 800.0, 460.0, 1180.0, 950.0, 1045.0, 420.0, 980.0, 1455.0, 890.0, 1710.0, 1300.0, 1110.0, 830.0, 1410.0, 570.0, 1020.0, 900.0, 1230.0, 1640.0, 1285.0, 1355.0, 1420.0, 450.0, 780.0, 940.0, 1520.0, 910.0, 890.0, 1350.0, 270.0, 640.0, 1410.0, 1760.0, 1200.0, 880.0, 1520.0, 125.0, 1070.0, 1230.0, 855.0, 370.0, 1530.0, 360.0, 660.0, 1295.0, 1025.0, 860.0, 1135.0, 970.0, 1340.0, 465.0, 1290.0, 550.0, 1220.0, 220.0, 2010.0, 1880.0, 360.0, 735.0, 840.0, 1270.0, 595.0, 1200.0, 850.0, 790.0, 980.0, 1075.0, 1215.0, 1210.0, 1010.0, 270.0, 1670.0, 510.0, 980.0, 560.0, 1570.0, 1160.0, 910.0, 940.0, 470.0, 740.0, 1110.0, 1270.0, 1340.0, 910.0, 380.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-70.0, 10.0, -80.0, 220.0, 180.0, 525.0, 350.0, 210.0, 110.0, 700.0, 20.0, 200.0, 310.0, 400.0, 80.0, 270.0, -90.0, 40.0, 70.0, 90.0, 690.0, 10.0, 360.0, 30.0, -10.0, 130.0, 80.0, 80.0, 60.0, 0.0, 0.0, 70.0, 0.0, 50.0, 90.0, 80.0, 0.0, 510.0, 310.0, -30.0, 680.0, -20.0, 20.0, 30.0, 260.0, 260.0, 20.0, -20.0, 0.0, 40.0, 60.0, 30.0, 10.0, 410.0, 30.0, 40.0, -40.0, 20.0, 0.0, 190.0, 0.0, 410.0, 130.0, 60.0, 280.0, 140.0, 80.0, 0.0, 40.0, 100.0, 100.0, 80.0, 100.0, 300.0, 80.0, 30.0, 0.0, 30.0, 70.0, 0.0, 10.0, 0.0, 100.0, 30.0, 540.0, 30.0, 20.0, 180.0, 500.0, 160.0, 10.0, 30.0, 20.0, 110.0, 40.0, 60.0, 0.0, 60.0, 210.0, 30.0, -10.0, 50.0, 10.0, 200.0, 20.0, 380.0, 40.0, 30.0, -30.0, 0.0, 10.0, 210.0, 0.0, 30.0, 120.0, 0.0, -10.0, 80.0, 200.0, 170.0, 110.0, 10.0, 310.0, 70.0, 0.0, 0.0, 40.0, 120.0, 0.0, 70.0, 10.0, 110.0, 0.0, 20.0, 30.0, 310.0, 0.0, 0.0, 35.0, 170.0, 130.0, 270.0, 10.0, 0.0, 170.0, 0.0, 120.0, 60.0, -40.0, 80.0, 40.0, 10.0, 110.0, 10.0, 20.0, 20.0, 40.0, 500.0, -400.0, 110.0, 70.0, 190.0, 60.0, 110.0, 50.0, 30.0, 0.0, 80.0, 0.0, 590.0, 10.0, 20.0, 20.0, 0.0, 20.0, 560.0, 80.0, 180.0, 60.0, 0.0, 170.0, 30.0, 20.0, 110.0, 0.0, 290.0, 260.0, 40.0, 35.0, 90.0, 0.0, 50.0, 70.0, 40.0, 40.0, 80.0, 30.0, 40.0, 0.0, 70.0, 20.0, 390.0, 90.0, 30.0, 90.0, 0.0, 40.0, 140.0, 140.0, 40.0, 245.0, 360.0, 10.0, 210.0, 260.0, 80.0, 50.0, 200.0, 10.0, 30.0, 0.0, 50.0, 30.0, 20.0, 50.0, 100.0, 30.0, 60.0, 0.0, 550.0, 410.0, 10.0, 40.0, 320.0, 60.0, 220.0, 80.0, 100.0, 70.0, 400.0, 300.0, 440.0, 30.0, 20.0, 30.0, 30.0, 270.0, 40.0, 0.0, 140.0, 110.0, 90.0, 290.0, 80.0, 30.0, 80.0, 190.0, -10.0, 30.0, 220.0, 0.0, 60.0, 50.0, 320.0, 160.0, 60.0, 10.0, 110.0, 20.0, 40.0, 110.0, 260.0, 20.0, 40.0, 10.0, 0.0, 390.0, -30.0, 320.0, 290.0, 30.0, 0.0, 70.0, 10.0, 30.0, 20.0, 20.0, 200.0, 40.0, 150.0, 230.0, 150.0, 50.0, 80.0, 410.0, 60.0, 10.0, 10.0, 0.0, 20.0, 290.0, 200.0, 200.0, 30.0, 70.0, 60.0, 10.0, 160.0, -10.0, -110.0, 80.0, 30.0, 10.0, 70.0, 90.0, 470.0, 170.0, 80.0, 30.0, 200.0, 0.0, 40.0, 140.0, 30.0, 270.0, 440.0, -20.0, 60.0, 690.0, -10.0, 10.0, 60.0, 220.0, 10.0, 20.0, -75.0, 30.0, 420.0, 540.0, 50.0, 20.0, 80.0, 60.0, 40.0, 15.0, 240.0, 600.0, 60.0, 200.0, 40.0, 20.0, 0.0, 590.0, 110.0, 170.0, 340.0, 40.0, 50.0, 10.0, 90.0, 20.0, 10.0, 20.0, 40.0, 0.0, 80.0, 0.0, 50.0, 20.0, 210.0, 200.0, 30.0, 20.0, 60.0, 40.0, 210.0, 20.0, 100.0, 80.0, 20.0, 30.0, 310.0, 0.0, 30.0, 20.0, 290.0, 100.0, 110.0, 50.0, 0.0, 190.0, 220.0, 40.0, 160.0, 80.0, -20.0, 170.0, 470.0, 20.0, 190.0, 50.0, 10.0, 70.0, 40.0, 180.0, 20.0, 90.0, 400.0, 20.0, 30.0, 80.0, 20.0, 70.0, 310.0, 50.0, 40.0, 30.0, 10.0, 180.0, 100.0, 10.0, 110.0, 60.0, 390.0, 410.0, 220.0, 10.0, 90.0, 10.0, 40.0, 10.0, 0.0, 70.0, 30.0, 30.0, 20.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 20.0, 80.0, 80.0, 40.0, 30.0, 20.0, 310.0, 20.0, 20.0, 30.0, 20.0, 20.0, 170.0, 270.0, 40.0, 270.0, 300.0, 270.0, 40.0, 260.0, 40.0, 130.0, 140.0, 200.0, 110.0, 280.0, -10.0, 570.0, 40.0, 270.0, 120.0, 70.0, 10.0, 320.0, 80.0, 10.0, 120.0, 160.0, 0.0, 10.0, 500.0, 160.0, 10.0, 0.0, 80.0, 40.0, 10.0, 70.0, 180.0, 260.0, 70.0, 40.0, 60.0, 20.0, 230.0, 170.0, 170.0, 320.0, 20.0, 30.0, 30.0, 10.0, 20.0, 0.0, 10.0, 5.0, 0.0, 0.0, 30.0, 110.0, 100.0, 20.0, 100.0, 110.0, 300.0, 20.0, 110.0, 170.0, 220.0, 50.0, 100.0, 90.0, 350.0, 400.0, 30.0, 30.0, 10.0, -50.0, 40.0, 20.0, 0.0, 20.0, 180.0, 200.0, 290.0, 90.0, 30.0, -15.0, 90.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 10.0, 50.0, 0.0, 40.0, 540.0, 240.0, 160.0, 290.0, 10.0, 30.0, 60.0, 80.0, 80.0, -10.0, 50.0, 40.0, 50.0, 40.0, 20.0, 40.0, 10.0, 10.0, 110.0, 10.0, 0.0, 30.0, 150.0, 210.0, 80.0, 0.0, 0.0, 140.0, 40.0, 160.0, 30.0, 120.0, 80.0, 15.0, 70.0, 100.0, 290.0, 270.0, 160.0, 260.0, 10.0, 20.0, 100.0, 110.0, 0.0, 40.0, 40.0, 420.0, 25.0, 70.0, -20.0, 210.0, 80.0, -180.0, 230.0, 70.0, 0.0, 10.0, 390.0, 410.0, 20.0, 10.0, 310.0, 10.0, 80.0, 10.0, 15.0, 30.0, 240.0, 10.0, 90.0, 300.0, 60.0, 80.0, 150.0, -70.0, 70.0, 180.0, 100.0, 40.0, 120.0, 20.0, 50.0, 160.0, 340.0, 90.0, 100.0, 110.0, 310.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 20.0, -15.0, 330.0, 10.0, 450.0, -40.0, 30.0, 180.0, 160.0, 50.0, 70.0, 200.0, 20.0, 170.0, 70.0, 90.0, 50.0, 0.0, 20.0, 50.0, 180.0, 50.0, 40.0, 0.0, 0.0, 110.0, 290.0, 50.0, 20.0, 70.0, 350.0, -20.0, 30.0, 320.0, 40.0, 0.0, 80.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 110.0, 130.0, 370.0, 120.0, 170.0, 90.0, 20.0, 140.0, 220.0, 640.0, 90.0, 80.0, 650.0, 170.0, 170.0, 70.0, 10.0, 610.0, -20.0, 50.0, 110.0, 10.0, 10.0, 160.0, 0.0, 0.0, 60.0, 0.0, 10.0, 0.0, 40.0, 20.0, 60.0, 30.0, 160.0, 10.0, 30.0, 35.0, 30.0, 320.0, 50.0, 390.0, -30.0, 260.0, 20.0, 20.0, 40.0, 90.0, 20.0, -20.0, 30.0, 140.0, 30.0, 60.0, 40.0, 50.0, 250.0, 210.0, 290.0, 170.0, 10.0, 65.0, 30.0, 200.0, 40.0, 30.0, 10.0, 120.0, 60.0, 30.0, 70.0, 30.0, 0.0, 220.0, 80.0, 70.0, 200.0, 70.0, 420.0, 40.0, 140.0, 60.0, 180.0, 180.0, 220.0, 30.0, -110.0, 90.0, 30.0, 30.0, 80.0, 90.0, 30.0, 210.0, 10.0, 10.0, 60.0, 40.0, 90.0, 170.0, 20.0, 140.0, 170.0, 0.0, 150.0, 200.0, 20.0, 40.0, 190.0, 50.0, 0.0, 70.0, 170.0, 100.0, 20.0, 270.0, 290.0, 90.0, 35.0, 30.0, 70.0, 140.0, 0.0, 130.0, 310.0, 140.0, 60.0, 40.0, 310.0, 15.0, 90.0, -30.0, 310.0, 220.0, 70.0, 20.0, -40.0, 130.0, 20.0, 420.0, 140.0, 170.0, 130.0, 240.0, 0.0, 40.0, 60.0, 40.0, 100.0, 90.0, 50.0, 10.0, 40.0, 70.0, 20.0, 10.0, 20.0, 40.0, 0.0, 10.0, 10.0, 520.0, 170.0, 50.0, 250.0, 230.0, 20.0, 20.0, 260.0, 140.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 20.0, 40.0, 30.0, 360.0, 0.0, 20.0, 20.0, 160.0, 170.0, 0.0, 510.0, 40.0, 20.0, 40.0, 70.0, 10.0, 0.0, 10.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 80.0, 0.0, 430.0, 80.0, 550.0, 170.0, 70.0, 70.0, 60.0, 60.0, 190.0, 110.0, 50.0, 240.0, 10.0, 80.0, 40.0, 30.0, 190.0, 220.0, 40.0, 290.0, 30.0, 60.0, 150.0, 0.0, 30.0, 20.0, 240.0, 50.0, 40.0, 660.0, 0.0, 160.0, 20.0, 30.0, 20.0, 30.0, -40.0, 20.0, 0.0, 250.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 70.0, 10.0, 0.0, 80.0, 80.0, 20.0, 0.0, 230.0, 310.0, 10.0, 0.0, 210.0, -100.0, 310.0, 80.0, 0.0, 200.0, 50.0, 300.0, 10.0, 50.0, 10.0, 300.0, 190.0, 350.0, 10.0, 110.0, -10.0, 20.0, 20.0, 270.0, 470.0, 70.0, 165.0, 35.0, 30.0, 20.0, 360.0, 20.0, 60.0, 110.0, 110.0, 380.0, 40.0, 0.0, 290.0, 30.0, 20.0, 10.0, 0.0, 30.0, 190.0, 10.0, 50.0, 20.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.09596213051411, "mean_inference_ms": 2.015811235553412, "mean_action_processing_ms": 0.5574625466600448, "mean_env_wait_ms": 1.8012833020452905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013070821762084961, "StateBufferConnector_ms": 0.011958837509155273, "ViewRequirementAgentConnector_ms": 0.39449191093444824}, "num_episodes": 18, "episode_return_max": 2155.0, "episode_return_min": 125.0, "episode_return_mean": 1010.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.0738052716004822, "num_env_steps_trained_throughput_per_sec": 2.0738052716004822, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 1436770.42, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1436770.374, "sample_time_ms": 2814.067, "learn_time_ms": 1433931.028, "learn_throughput": 2.79, "synch_weights_time_ms": 12.13}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 60, "trial_id": "3d3a5_00000", "date": "2024-06-01_08-35-31", "timestamp": 1717245331, "time_this_iter_s": 1928.845017194748, "time_total_s": 36147.869343042374, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7e8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36147.869343042374, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 22.584300341296927, "ram_util_percent": 82.01535836177474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.023799123728491, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.027892627553564, "policy_loss": -0.007637635475823991, "vf_loss": 7.0348110374678186, "vf_explained_var": 7.911197547587597e-05, "kl": 0.007192284334159463, "entropy": 0.3637275350519136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 568095.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "env_runners": {"episode_reward_max": 2010.0, "episode_reward_min": 125.0, "episode_reward_mean": 1020.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 102.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [890.0, 1710.0, 1300.0, 1110.0, 830.0, 1410.0, 570.0, 1020.0, 900.0, 1230.0, 1640.0, 1285.0, 1355.0, 1420.0, 450.0, 780.0, 940.0, 1520.0, 910.0, 890.0, 1350.0, 270.0, 640.0, 1410.0, 1760.0, 1200.0, 880.0, 1520.0, 125.0, 1070.0, 1230.0, 855.0, 370.0, 1530.0, 360.0, 660.0, 1295.0, 1025.0, 860.0, 1135.0, 970.0, 1340.0, 465.0, 1290.0, 550.0, 1220.0, 220.0, 2010.0, 1880.0, 360.0, 735.0, 840.0, 1270.0, 595.0, 1200.0, 850.0, 790.0, 980.0, 1075.0, 1215.0, 1210.0, 1010.0, 270.0, 1670.0, 510.0, 980.0, 560.0, 1570.0, 1160.0, 910.0, 940.0, 470.0, 740.0, 1110.0, 1270.0, 1340.0, 910.0, 380.0, 220.0, 900.0, 1460.0, 860.0, 960.0, 1140.0, 1190.0, 720.0, 910.0, 1690.0, 950.0, 1090.0, 1250.0, 1250.0, 1280.0, 1090.0, 300.0, 1710.0, 320.0, 1310.0, 1510.0, 1350.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 50.0, 30.0, 20.0, 50.0, 100.0, 30.0, 60.0, 0.0, 550.0, 410.0, 10.0, 40.0, 320.0, 60.0, 220.0, 80.0, 100.0, 70.0, 400.0, 300.0, 440.0, 30.0, 20.0, 30.0, 30.0, 270.0, 40.0, 0.0, 140.0, 110.0, 90.0, 290.0, 80.0, 30.0, 80.0, 190.0, -10.0, 30.0, 220.0, 0.0, 60.0, 50.0, 320.0, 160.0, 60.0, 10.0, 110.0, 20.0, 40.0, 110.0, 260.0, 20.0, 40.0, 10.0, 0.0, 390.0, -30.0, 320.0, 290.0, 30.0, 0.0, 70.0, 10.0, 30.0, 20.0, 20.0, 200.0, 40.0, 150.0, 230.0, 150.0, 50.0, 80.0, 410.0, 60.0, 10.0, 10.0, 0.0, 20.0, 290.0, 200.0, 200.0, 30.0, 70.0, 60.0, 10.0, 160.0, -10.0, -110.0, 80.0, 30.0, 10.0, 70.0, 90.0, 470.0, 170.0, 80.0, 30.0, 200.0, 0.0, 40.0, 140.0, 30.0, 270.0, 440.0, -20.0, 60.0, 690.0, -10.0, 10.0, 60.0, 220.0, 10.0, 20.0, -75.0, 30.0, 420.0, 540.0, 50.0, 20.0, 80.0, 60.0, 40.0, 15.0, 240.0, 600.0, 60.0, 200.0, 40.0, 20.0, 0.0, 590.0, 110.0, 170.0, 340.0, 40.0, 50.0, 10.0, 90.0, 20.0, 10.0, 20.0, 40.0, 0.0, 80.0, 0.0, 50.0, 20.0, 210.0, 200.0, 30.0, 20.0, 60.0, 40.0, 210.0, 20.0, 100.0, 80.0, 20.0, 30.0, 310.0, 0.0, 30.0, 20.0, 290.0, 100.0, 110.0, 50.0, 0.0, 190.0, 220.0, 40.0, 160.0, 80.0, -20.0, 170.0, 470.0, 20.0, 190.0, 50.0, 10.0, 70.0, 40.0, 180.0, 20.0, 90.0, 400.0, 20.0, 30.0, 80.0, 20.0, 70.0, 310.0, 50.0, 40.0, 30.0, 10.0, 180.0, 100.0, 10.0, 110.0, 60.0, 390.0, 410.0, 220.0, 10.0, 90.0, 10.0, 40.0, 10.0, 0.0, 70.0, 30.0, 30.0, 20.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 20.0, 80.0, 80.0, 40.0, 30.0, 20.0, 310.0, 20.0, 20.0, 30.0, 20.0, 20.0, 170.0, 270.0, 40.0, 270.0, 300.0, 270.0, 40.0, 260.0, 40.0, 130.0, 140.0, 200.0, 110.0, 280.0, -10.0, 570.0, 40.0, 270.0, 120.0, 70.0, 10.0, 320.0, 80.0, 10.0, 120.0, 160.0, 0.0, 10.0, 500.0, 160.0, 10.0, 0.0, 80.0, 40.0, 10.0, 70.0, 180.0, 260.0, 70.0, 40.0, 60.0, 20.0, 230.0, 170.0, 170.0, 320.0, 20.0, 30.0, 30.0, 10.0, 20.0, 0.0, 10.0, 5.0, 0.0, 0.0, 30.0, 110.0, 100.0, 20.0, 100.0, 110.0, 300.0, 20.0, 110.0, 170.0, 220.0, 50.0, 100.0, 90.0, 350.0, 400.0, 30.0, 30.0, 10.0, -50.0, 40.0, 20.0, 0.0, 20.0, 180.0, 200.0, 290.0, 90.0, 30.0, -15.0, 90.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 10.0, 50.0, 0.0, 40.0, 540.0, 240.0, 160.0, 290.0, 10.0, 30.0, 60.0, 80.0, 80.0, -10.0, 50.0, 40.0, 50.0, 40.0, 20.0, 40.0, 10.0, 10.0, 110.0, 10.0, 0.0, 30.0, 150.0, 210.0, 80.0, 0.0, 0.0, 140.0, 40.0, 160.0, 30.0, 120.0, 80.0, 15.0, 70.0, 100.0, 290.0, 270.0, 160.0, 260.0, 10.0, 20.0, 100.0, 110.0, 0.0, 40.0, 40.0, 420.0, 25.0, 70.0, -20.0, 210.0, 80.0, -180.0, 230.0, 70.0, 0.0, 10.0, 390.0, 410.0, 20.0, 10.0, 310.0, 10.0, 80.0, 10.0, 15.0, 30.0, 240.0, 10.0, 90.0, 300.0, 60.0, 80.0, 150.0, -70.0, 70.0, 180.0, 100.0, 40.0, 120.0, 20.0, 50.0, 160.0, 340.0, 90.0, 100.0, 110.0, 310.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 20.0, -15.0, 330.0, 10.0, 450.0, -40.0, 30.0, 180.0, 160.0, 50.0, 70.0, 200.0, 20.0, 170.0, 70.0, 90.0, 50.0, 0.0, 20.0, 50.0, 180.0, 50.0, 40.0, 0.0, 0.0, 110.0, 290.0, 50.0, 20.0, 70.0, 350.0, -20.0, 30.0, 320.0, 40.0, 0.0, 80.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 110.0, 130.0, 370.0, 120.0, 170.0, 90.0, 20.0, 140.0, 220.0, 640.0, 90.0, 80.0, 650.0, 170.0, 170.0, 70.0, 10.0, 610.0, -20.0, 50.0, 110.0, 10.0, 10.0, 160.0, 0.0, 0.0, 60.0, 0.0, 10.0, 0.0, 40.0, 20.0, 60.0, 30.0, 160.0, 10.0, 30.0, 35.0, 30.0, 320.0, 50.0, 390.0, -30.0, 260.0, 20.0, 20.0, 40.0, 90.0, 20.0, -20.0, 30.0, 140.0, 30.0, 60.0, 40.0, 50.0, 250.0, 210.0, 290.0, 170.0, 10.0, 65.0, 30.0, 200.0, 40.0, 30.0, 10.0, 120.0, 60.0, 30.0, 70.0, 30.0, 0.0, 220.0, 80.0, 70.0, 200.0, 70.0, 420.0, 40.0, 140.0, 60.0, 180.0, 180.0, 220.0, 30.0, -110.0, 90.0, 30.0, 30.0, 80.0, 90.0, 30.0, 210.0, 10.0, 10.0, 60.0, 40.0, 90.0, 170.0, 20.0, 140.0, 170.0, 0.0, 150.0, 200.0, 20.0, 40.0, 190.0, 50.0, 0.0, 70.0, 170.0, 100.0, 20.0, 270.0, 290.0, 90.0, 35.0, 30.0, 70.0, 140.0, 0.0, 130.0, 310.0, 140.0, 60.0, 40.0, 310.0, 15.0, 90.0, -30.0, 310.0, 220.0, 70.0, 20.0, -40.0, 130.0, 20.0, 420.0, 140.0, 170.0, 130.0, 240.0, 0.0, 40.0, 60.0, 40.0, 100.0, 90.0, 50.0, 10.0, 40.0, 70.0, 20.0, 10.0, 20.0, 40.0, 0.0, 10.0, 10.0, 520.0, 170.0, 50.0, 250.0, 230.0, 20.0, 20.0, 260.0, 140.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 20.0, 40.0, 30.0, 360.0, 0.0, 20.0, 20.0, 160.0, 170.0, 0.0, 510.0, 40.0, 20.0, 40.0, 70.0, 10.0, 0.0, 10.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 80.0, 0.0, 430.0, 80.0, 550.0, 170.0, 70.0, 70.0, 60.0, 60.0, 190.0, 110.0, 50.0, 240.0, 10.0, 80.0, 40.0, 30.0, 190.0, 220.0, 40.0, 290.0, 30.0, 60.0, 150.0, 0.0, 30.0, 20.0, 240.0, 50.0, 40.0, 660.0, 0.0, 160.0, 20.0, 30.0, 20.0, 30.0, -40.0, 20.0, 0.0, 250.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 70.0, 10.0, 0.0, 80.0, 80.0, 20.0, 0.0, 230.0, 310.0, 10.0, 0.0, 210.0, -100.0, 310.0, 80.0, 0.0, 200.0, 50.0, 300.0, 10.0, 50.0, 10.0, 300.0, 190.0, 350.0, 10.0, 110.0, -10.0, 20.0, 20.0, 270.0, 470.0, 70.0, 165.0, 35.0, 30.0, 20.0, 360.0, 20.0, 60.0, 110.0, 110.0, 380.0, 40.0, 0.0, 290.0, 30.0, 20.0, 10.0, 0.0, 30.0, 190.0, 10.0, 50.0, 20.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 20.0, 10.0, 70.0, 100.0, 440.0, 40.0, 50.0, 70.0, 30.0, 70.0, 0.0, 160.0, -50.0, 120.0, 10.0, 60.0, 190.0, 340.0, 580.0, 50.0, 600.0, 20.0, 30.0, 180.0, 150.0, 60.0, 260.0, 30.0, 20.0, -490.0, 20.0, 140.0, 10.0, 60.0, 260.0, 0.0, 0.0, 40.0, 0.0, 430.0, 90.0, 150.0, -120.0, 40.0, 50.0, -50.0, 20.0, 500.0, 410.0, 50.0, 410.0, 40.0, 60.0, 520.0, 30.0, 190.0, -40.0, 90.0, -20.0, -90.0, 30.0, 190.0, 30.0, 15.0, 0.0, 35.0, -10.0, 130.0, 110.0, 190.0, 70.0, 40.0, 170.0, 160.0, 10.0, 90.0, 310.0, 10.0, 20.0, 30.0, 200.0, 480.0, 220.0, 420.0, 80.0, 20.0, 210.0, -10.0, 70.0, 0.0, -30.0, 240.0, 150.0, 270.0, -50.0, 110.0, 150.0, 30.0, 30.0, 50.0, 310.0, 110.0, 90.0, -50.0, 310.0, 70.0, 40.0, 150.0, 20.0, 40.0, 220.0, 50.0, 50.0, 40.0, 180.0, -10.0, 310.0, 80.0, 10.0, 320.0, 170.0, 170.0, 20.0, -10.0, 440.0, 310.0, 20.0, 80.0, 40.0, 10.0, 50.0, 460.0, 20.0, 80.0, 20.0, 90.0, 50.0, 230.0, 270.0, 10.0, 50.0, 80.0, 60.0, 370.0, 100.0, 0.0, 50.0, 40.0, 320.0, 20.0, 0.0, 50.0, 40.0, 30.0, 60.0, 20.0, 0.0, 90.0, 0.0, 10.0, 290.0, 160.0, 190.0, 90.0, 0.0, 650.0, 10.0, 40.0, 80.0, 200.0, 10.0, 20.0, 100.0, 40.0, 10.0, 40.0, 40.0, 0.0, 30.0, 30.0, 340.0, 30.0, -10.0, 10.0, 470.0, 260.0, 70.0, 60.0, 30.0, 50.0, 70.0, 70.0, 720.0, 290.0, 140.0, 0.0, 20.0, 150.0, 30.0, 20.0, 270.0, 40.0, 20.0, 200.0, 400.0, 220.0, 110.0, 40.0, 40.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0813359445466397, "mean_inference_ms": 2.001425508105688, "mean_action_processing_ms": 0.554418722890559, "mean_env_wait_ms": 1.791475044606377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012904882431030273, "StateBufferConnector_ms": 0.010801553726196289, "ViewRequirementAgentConnector_ms": 0.40970349311828613}, "num_episodes": 22, "episode_return_max": 2010.0, "episode_return_min": 125.0, "episode_return_mean": 1020.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.917689835305127, "num_env_steps_trained_throughput_per_sec": 5.917689835305127, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 2440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2440000, "timers": {"training_iteration_time_ms": 1362746.09, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1362746.044, "sample_time_ms": 2811.511, "learn_time_ms": 1359910.267, "learn_throughput": 2.941, "synch_weights_time_ms": 11.804}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "done": false, "training_iteration": 61, "trial_id": "3d3a5_00000", "date": "2024-06-01_08-46-47", "timestamp": 1717246007, "time_this_iter_s": 675.9767460823059, "time_total_s": 36823.84608912468, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8879d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36823.84608912468, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 21.422222222222224, "ram_util_percent": 80.21979166666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.660249463558451, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.7954858486390854, "policy_loss": -0.007864345998391191, "vf_loss": 7.802635993287205, "vf_explained_var": 0.0006914387622707314, "kl": 0.007141964418329572, "entropy": 0.3635233961847136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 577485.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 2010.0, "episode_reward_min": 125.0, "episode_reward_mean": 1014.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 830.0}, "policy_reward_mean": {"policy_0": 101.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [910.0, 890.0, 1350.0, 270.0, 640.0, 1410.0, 1760.0, 1200.0, 880.0, 1520.0, 125.0, 1070.0, 1230.0, 855.0, 370.0, 1530.0, 360.0, 660.0, 1295.0, 1025.0, 860.0, 1135.0, 970.0, 1340.0, 465.0, 1290.0, 550.0, 1220.0, 220.0, 2010.0, 1880.0, 360.0, 735.0, 840.0, 1270.0, 595.0, 1200.0, 850.0, 790.0, 980.0, 1075.0, 1215.0, 1210.0, 1010.0, 270.0, 1670.0, 510.0, 980.0, 560.0, 1570.0, 1160.0, 910.0, 940.0, 470.0, 740.0, 1110.0, 1270.0, 1340.0, 910.0, 380.0, 220.0, 900.0, 1460.0, 860.0, 960.0, 1140.0, 1190.0, 720.0, 910.0, 1690.0, 950.0, 1090.0, 1250.0, 1250.0, 1280.0, 1090.0, 300.0, 1710.0, 320.0, 1310.0, 1510.0, 1350.0, 970.0, 1390.0, 1350.0, 1300.0, 1205.0, 1160.0, 1040.0, 885.0, 960.0, 1400.0, 655.0, 1600.0, 310.0, 690.0, 1500.0, 1290.0, 1250.0, 800.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 10.0, 70.0, 40.0, 180.0, 20.0, 90.0, 400.0, 20.0, 30.0, 80.0, 20.0, 70.0, 310.0, 50.0, 40.0, 30.0, 10.0, 180.0, 100.0, 10.0, 110.0, 60.0, 390.0, 410.0, 220.0, 10.0, 90.0, 10.0, 40.0, 10.0, 0.0, 70.0, 30.0, 30.0, 20.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 20.0, 80.0, 80.0, 40.0, 30.0, 20.0, 310.0, 20.0, 20.0, 30.0, 20.0, 20.0, 170.0, 270.0, 40.0, 270.0, 300.0, 270.0, 40.0, 260.0, 40.0, 130.0, 140.0, 200.0, 110.0, 280.0, -10.0, 570.0, 40.0, 270.0, 120.0, 70.0, 10.0, 320.0, 80.0, 10.0, 120.0, 160.0, 0.0, 10.0, 500.0, 160.0, 10.0, 0.0, 80.0, 40.0, 10.0, 70.0, 180.0, 260.0, 70.0, 40.0, 60.0, 20.0, 230.0, 170.0, 170.0, 320.0, 20.0, 30.0, 30.0, 10.0, 20.0, 0.0, 10.0, 5.0, 0.0, 0.0, 30.0, 110.0, 100.0, 20.0, 100.0, 110.0, 300.0, 20.0, 110.0, 170.0, 220.0, 50.0, 100.0, 90.0, 350.0, 400.0, 30.0, 30.0, 10.0, -50.0, 40.0, 20.0, 0.0, 20.0, 180.0, 200.0, 290.0, 90.0, 30.0, -15.0, 90.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 10.0, 50.0, 0.0, 40.0, 540.0, 240.0, 160.0, 290.0, 10.0, 30.0, 60.0, 80.0, 80.0, -10.0, 50.0, 40.0, 50.0, 40.0, 20.0, 40.0, 10.0, 10.0, 110.0, 10.0, 0.0, 30.0, 150.0, 210.0, 80.0, 0.0, 0.0, 140.0, 40.0, 160.0, 30.0, 120.0, 80.0, 15.0, 70.0, 100.0, 290.0, 270.0, 160.0, 260.0, 10.0, 20.0, 100.0, 110.0, 0.0, 40.0, 40.0, 420.0, 25.0, 70.0, -20.0, 210.0, 80.0, -180.0, 230.0, 70.0, 0.0, 10.0, 390.0, 410.0, 20.0, 10.0, 310.0, 10.0, 80.0, 10.0, 15.0, 30.0, 240.0, 10.0, 90.0, 300.0, 60.0, 80.0, 150.0, -70.0, 70.0, 180.0, 100.0, 40.0, 120.0, 20.0, 50.0, 160.0, 340.0, 90.0, 100.0, 110.0, 310.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 20.0, -15.0, 330.0, 10.0, 450.0, -40.0, 30.0, 180.0, 160.0, 50.0, 70.0, 200.0, 20.0, 170.0, 70.0, 90.0, 50.0, 0.0, 20.0, 50.0, 180.0, 50.0, 40.0, 0.0, 0.0, 110.0, 290.0, 50.0, 20.0, 70.0, 350.0, -20.0, 30.0, 320.0, 40.0, 0.0, 80.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 110.0, 130.0, 370.0, 120.0, 170.0, 90.0, 20.0, 140.0, 220.0, 640.0, 90.0, 80.0, 650.0, 170.0, 170.0, 70.0, 10.0, 610.0, -20.0, 50.0, 110.0, 10.0, 10.0, 160.0, 0.0, 0.0, 60.0, 0.0, 10.0, 0.0, 40.0, 20.0, 60.0, 30.0, 160.0, 10.0, 30.0, 35.0, 30.0, 320.0, 50.0, 390.0, -30.0, 260.0, 20.0, 20.0, 40.0, 90.0, 20.0, -20.0, 30.0, 140.0, 30.0, 60.0, 40.0, 50.0, 250.0, 210.0, 290.0, 170.0, 10.0, 65.0, 30.0, 200.0, 40.0, 30.0, 10.0, 120.0, 60.0, 30.0, 70.0, 30.0, 0.0, 220.0, 80.0, 70.0, 200.0, 70.0, 420.0, 40.0, 140.0, 60.0, 180.0, 180.0, 220.0, 30.0, -110.0, 90.0, 30.0, 30.0, 80.0, 90.0, 30.0, 210.0, 10.0, 10.0, 60.0, 40.0, 90.0, 170.0, 20.0, 140.0, 170.0, 0.0, 150.0, 200.0, 20.0, 40.0, 190.0, 50.0, 0.0, 70.0, 170.0, 100.0, 20.0, 270.0, 290.0, 90.0, 35.0, 30.0, 70.0, 140.0, 0.0, 130.0, 310.0, 140.0, 60.0, 40.0, 310.0, 15.0, 90.0, -30.0, 310.0, 220.0, 70.0, 20.0, -40.0, 130.0, 20.0, 420.0, 140.0, 170.0, 130.0, 240.0, 0.0, 40.0, 60.0, 40.0, 100.0, 90.0, 50.0, 10.0, 40.0, 70.0, 20.0, 10.0, 20.0, 40.0, 0.0, 10.0, 10.0, 520.0, 170.0, 50.0, 250.0, 230.0, 20.0, 20.0, 260.0, 140.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 20.0, 40.0, 30.0, 360.0, 0.0, 20.0, 20.0, 160.0, 170.0, 0.0, 510.0, 40.0, 20.0, 40.0, 70.0, 10.0, 0.0, 10.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 80.0, 0.0, 430.0, 80.0, 550.0, 170.0, 70.0, 70.0, 60.0, 60.0, 190.0, 110.0, 50.0, 240.0, 10.0, 80.0, 40.0, 30.0, 190.0, 220.0, 40.0, 290.0, 30.0, 60.0, 150.0, 0.0, 30.0, 20.0, 240.0, 50.0, 40.0, 660.0, 0.0, 160.0, 20.0, 30.0, 20.0, 30.0, -40.0, 20.0, 0.0, 250.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 70.0, 10.0, 0.0, 80.0, 80.0, 20.0, 0.0, 230.0, 310.0, 10.0, 0.0, 210.0, -100.0, 310.0, 80.0, 0.0, 200.0, 50.0, 300.0, 10.0, 50.0, 10.0, 300.0, 190.0, 350.0, 10.0, 110.0, -10.0, 20.0, 20.0, 270.0, 470.0, 70.0, 165.0, 35.0, 30.0, 20.0, 360.0, 20.0, 60.0, 110.0, 110.0, 380.0, 40.0, 0.0, 290.0, 30.0, 20.0, 10.0, 0.0, 30.0, 190.0, 10.0, 50.0, 20.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 20.0, 10.0, 70.0, 100.0, 440.0, 40.0, 50.0, 70.0, 30.0, 70.0, 0.0, 160.0, -50.0, 120.0, 10.0, 60.0, 190.0, 340.0, 580.0, 50.0, 600.0, 20.0, 30.0, 180.0, 150.0, 60.0, 260.0, 30.0, 20.0, -490.0, 20.0, 140.0, 10.0, 60.0, 260.0, 0.0, 0.0, 40.0, 0.0, 430.0, 90.0, 150.0, -120.0, 40.0, 50.0, -50.0, 20.0, 500.0, 410.0, 50.0, 410.0, 40.0, 60.0, 520.0, 30.0, 190.0, -40.0, 90.0, -20.0, -90.0, 30.0, 190.0, 30.0, 15.0, 0.0, 35.0, -10.0, 130.0, 110.0, 190.0, 70.0, 40.0, 170.0, 160.0, 10.0, 90.0, 310.0, 10.0, 20.0, 30.0, 200.0, 480.0, 220.0, 420.0, 80.0, 20.0, 210.0, -10.0, 70.0, 0.0, -30.0, 240.0, 150.0, 270.0, -50.0, 110.0, 150.0, 30.0, 30.0, 50.0, 310.0, 110.0, 90.0, -50.0, 310.0, 70.0, 40.0, 150.0, 20.0, 40.0, 220.0, 50.0, 50.0, 40.0, 180.0, -10.0, 310.0, 80.0, 10.0, 320.0, 170.0, 170.0, 20.0, -10.0, 440.0, 310.0, 20.0, 80.0, 40.0, 10.0, 50.0, 460.0, 20.0, 80.0, 20.0, 90.0, 50.0, 230.0, 270.0, 10.0, 50.0, 80.0, 60.0, 370.0, 100.0, 0.0, 50.0, 40.0, 320.0, 20.0, 0.0, 50.0, 40.0, 30.0, 60.0, 20.0, 0.0, 90.0, 0.0, 10.0, 290.0, 160.0, 190.0, 90.0, 0.0, 650.0, 10.0, 40.0, 80.0, 200.0, 10.0, 20.0, 100.0, 40.0, 10.0, 40.0, 40.0, 0.0, 30.0, 30.0, 340.0, 30.0, -10.0, 10.0, 470.0, 260.0, 70.0, 60.0, 30.0, 50.0, 70.0, 70.0, 720.0, 290.0, 140.0, 0.0, 20.0, 150.0, 30.0, 20.0, 270.0, 40.0, 20.0, 200.0, 400.0, 220.0, 110.0, 40.0, 40.0, 10.0, 50.0, 60.0, 20.0, 260.0, 110.0, 130.0, 40.0, 90.0, 130.0, 80.0, 340.0, 230.0, 0.0, 190.0, 170.0, 50.0, 190.0, 200.0, 20.0, 0.0, 300.0, 70.0, 70.0, 30.0, 60.0, -40.0, 360.0, 10.0, 420.0, 70.0, 30.0, 80.0, 220.0, 460.0, -30.0, 70.0, 150.0, -90.0, 220.0, 190.0, 10.0, 80.0, 110.0, 60.0, 180.0, 25.0, -10.0, 30.0, 60.0, 660.0, 40.0, 20.0, 50.0, 0.0, 50.0, 390.0, 180.0, 40.0, 60.0, 330.0, 10.0, 10.0, 40.0, 30.0, 450.0, 30.0, 70.0, 50.0, 330.0, 20.0, 20.0, 30.0, 360.0, 70.0, 60.0, 0.0, -5.0, 320.0, 20.0, 10.0, 200.0, 90.0, 20.0, 220.0, 130.0, 100.0, -20.0, 140.0, 40.0, 40.0, 50.0, 30.0, 70.0, 140.0, 440.0, 160.0, 40.0, 300.0, 100.0, 70.0, 40.0, 30.0, -95.0, 20.0, 10.0, 410.0, 40.0, 170.0, 20.0, 10.0, 10.0, 90.0, -45.0, 50.0, 80.0, -65.0, 380.0, 830.0, 170.0, 100.0, 30.0, 20.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 60.0, 10.0, 30.0, 30.0, 220.0, 10.0, 0.0, 30.0, 0.0, 40.0, 190.0, 140.0, 40.0, 40.0, 230.0, 60.0, 30.0, 320.0, 280.0, 250.0, 0.0, 250.0, 140.0, 10.0, 210.0, 260.0, 100.0, -50.0, 90.0, 370.0, 120.0, 40.0, 640.0, 70.0, 30.0, 160.0, 80.0, 20.0, 40.0, 70.0, 100.0, 40.0, 20.0, 160.0, 110.0, 40.0, 190.0, 250.0, -10.0, 40.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0776634494453754, "mean_inference_ms": 2.001992718454219, "mean_action_processing_ms": 0.5523751030991424, "mean_env_wait_ms": 1.7849843431906982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012730121612548828, "StateBufferConnector_ms": 0.01050567626953125, "ViewRequirementAgentConnector_ms": 0.4286928176879883}, "num_episodes": 18, "episode_return_max": 2010.0, "episode_return_min": 125.0, "episode_return_mean": 1014.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.9968594593362676, "num_env_steps_trained_throughput_per_sec": 1.9968594593362676, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 1352101.239, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1352101.189, "sample_time_ms": 2878.732, "learn_time_ms": 1349199.111, "learn_throughput": 2.965, "synch_weights_time_ms": 11.344}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 62, "trial_id": "3d3a5_00000", "date": "2024-06-01_09-20-10", "timestamp": 1717248010, "time_this_iter_s": 2003.1867129802704, "time_total_s": 38827.03280210495, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7e8820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38827.03280210495, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 23.11632653061225, "ram_util_percent": 82.0751700680272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.350402921152572, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.76283544478452, "policy_loss": -0.00744409259399786, "vf_loss": 6.769581186174712, "vf_explained_var": 0.00041745479622334083, "kl": 0.006983504083805968, "entropy": 0.35358712729046776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 586875.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "env_runners": {"episode_reward_max": 2345.0, "episode_reward_min": 110.0, "episode_reward_mean": 1060.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 830.0}, "policy_reward_mean": {"policy_0": 106.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1340.0, 465.0, 1290.0, 550.0, 1220.0, 220.0, 2010.0, 1880.0, 360.0, 735.0, 840.0, 1270.0, 595.0, 1200.0, 850.0, 790.0, 980.0, 1075.0, 1215.0, 1210.0, 1010.0, 270.0, 1670.0, 510.0, 980.0, 560.0, 1570.0, 1160.0, 910.0, 940.0, 470.0, 740.0, 1110.0, 1270.0, 1340.0, 910.0, 380.0, 220.0, 900.0, 1460.0, 860.0, 960.0, 1140.0, 1190.0, 720.0, 910.0, 1690.0, 950.0, 1090.0, 1250.0, 1250.0, 1280.0, 1090.0, 300.0, 1710.0, 320.0, 1310.0, 1510.0, 1350.0, 970.0, 1390.0, 1350.0, 1300.0, 1205.0, 1160.0, 1040.0, 885.0, 960.0, 1400.0, 655.0, 1600.0, 310.0, 690.0, 1500.0, 1290.0, 1250.0, 800.0, 1110.0, 1090.0, 820.0, 530.0, 1000.0, 1890.0, 1430.0, 1190.0, 1350.0, 1250.0, 2345.0, 970.0, 1500.0, 110.0, 1500.0, 1480.0, 1140.0, 1280.0, 940.0, 1270.0, 890.0, 1420.0, 440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 120.0, 20.0, 50.0, 160.0, 340.0, 90.0, 100.0, 110.0, 310.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 20.0, -15.0, 330.0, 10.0, 450.0, -40.0, 30.0, 180.0, 160.0, 50.0, 70.0, 200.0, 20.0, 170.0, 70.0, 90.0, 50.0, 0.0, 20.0, 50.0, 180.0, 50.0, 40.0, 0.0, 0.0, 110.0, 290.0, 50.0, 20.0, 70.0, 350.0, -20.0, 30.0, 320.0, 40.0, 0.0, 80.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 0.0, 110.0, 130.0, 370.0, 120.0, 170.0, 90.0, 20.0, 140.0, 220.0, 640.0, 90.0, 80.0, 650.0, 170.0, 170.0, 70.0, 10.0, 610.0, -20.0, 50.0, 110.0, 10.0, 10.0, 160.0, 0.0, 0.0, 60.0, 0.0, 10.0, 0.0, 40.0, 20.0, 60.0, 30.0, 160.0, 10.0, 30.0, 35.0, 30.0, 320.0, 50.0, 390.0, -30.0, 260.0, 20.0, 20.0, 40.0, 90.0, 20.0, -20.0, 30.0, 140.0, 30.0, 60.0, 40.0, 50.0, 250.0, 210.0, 290.0, 170.0, 10.0, 65.0, 30.0, 200.0, 40.0, 30.0, 10.0, 120.0, 60.0, 30.0, 70.0, 30.0, 0.0, 220.0, 80.0, 70.0, 200.0, 70.0, 420.0, 40.0, 140.0, 60.0, 180.0, 180.0, 220.0, 30.0, -110.0, 90.0, 30.0, 30.0, 80.0, 90.0, 30.0, 210.0, 10.0, 10.0, 60.0, 40.0, 90.0, 170.0, 20.0, 140.0, 170.0, 0.0, 150.0, 200.0, 20.0, 40.0, 190.0, 50.0, 0.0, 70.0, 170.0, 100.0, 20.0, 270.0, 290.0, 90.0, 35.0, 30.0, 70.0, 140.0, 0.0, 130.0, 310.0, 140.0, 60.0, 40.0, 310.0, 15.0, 90.0, -30.0, 310.0, 220.0, 70.0, 20.0, -40.0, 130.0, 20.0, 420.0, 140.0, 170.0, 130.0, 240.0, 0.0, 40.0, 60.0, 40.0, 100.0, 90.0, 50.0, 10.0, 40.0, 70.0, 20.0, 10.0, 20.0, 40.0, 0.0, 10.0, 10.0, 520.0, 170.0, 50.0, 250.0, 230.0, 20.0, 20.0, 260.0, 140.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 20.0, 40.0, 30.0, 360.0, 0.0, 20.0, 20.0, 160.0, 170.0, 0.0, 510.0, 40.0, 20.0, 40.0, 70.0, 10.0, 0.0, 10.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 80.0, 0.0, 430.0, 80.0, 550.0, 170.0, 70.0, 70.0, 60.0, 60.0, 190.0, 110.0, 50.0, 240.0, 10.0, 80.0, 40.0, 30.0, 190.0, 220.0, 40.0, 290.0, 30.0, 60.0, 150.0, 0.0, 30.0, 20.0, 240.0, 50.0, 40.0, 660.0, 0.0, 160.0, 20.0, 30.0, 20.0, 30.0, -40.0, 20.0, 0.0, 250.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 70.0, 10.0, 0.0, 80.0, 80.0, 20.0, 0.0, 230.0, 310.0, 10.0, 0.0, 210.0, -100.0, 310.0, 80.0, 0.0, 200.0, 50.0, 300.0, 10.0, 50.0, 10.0, 300.0, 190.0, 350.0, 10.0, 110.0, -10.0, 20.0, 20.0, 270.0, 470.0, 70.0, 165.0, 35.0, 30.0, 20.0, 360.0, 20.0, 60.0, 110.0, 110.0, 380.0, 40.0, 0.0, 290.0, 30.0, 20.0, 10.0, 0.0, 30.0, 190.0, 10.0, 50.0, 20.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 20.0, 10.0, 70.0, 100.0, 440.0, 40.0, 50.0, 70.0, 30.0, 70.0, 0.0, 160.0, -50.0, 120.0, 10.0, 60.0, 190.0, 340.0, 580.0, 50.0, 600.0, 20.0, 30.0, 180.0, 150.0, 60.0, 260.0, 30.0, 20.0, -490.0, 20.0, 140.0, 10.0, 60.0, 260.0, 0.0, 0.0, 40.0, 0.0, 430.0, 90.0, 150.0, -120.0, 40.0, 50.0, -50.0, 20.0, 500.0, 410.0, 50.0, 410.0, 40.0, 60.0, 520.0, 30.0, 190.0, -40.0, 90.0, -20.0, -90.0, 30.0, 190.0, 30.0, 15.0, 0.0, 35.0, -10.0, 130.0, 110.0, 190.0, 70.0, 40.0, 170.0, 160.0, 10.0, 90.0, 310.0, 10.0, 20.0, 30.0, 200.0, 480.0, 220.0, 420.0, 80.0, 20.0, 210.0, -10.0, 70.0, 0.0, -30.0, 240.0, 150.0, 270.0, -50.0, 110.0, 150.0, 30.0, 30.0, 50.0, 310.0, 110.0, 90.0, -50.0, 310.0, 70.0, 40.0, 150.0, 20.0, 40.0, 220.0, 50.0, 50.0, 40.0, 180.0, -10.0, 310.0, 80.0, 10.0, 320.0, 170.0, 170.0, 20.0, -10.0, 440.0, 310.0, 20.0, 80.0, 40.0, 10.0, 50.0, 460.0, 20.0, 80.0, 20.0, 90.0, 50.0, 230.0, 270.0, 10.0, 50.0, 80.0, 60.0, 370.0, 100.0, 0.0, 50.0, 40.0, 320.0, 20.0, 0.0, 50.0, 40.0, 30.0, 60.0, 20.0, 0.0, 90.0, 0.0, 10.0, 290.0, 160.0, 190.0, 90.0, 0.0, 650.0, 10.0, 40.0, 80.0, 200.0, 10.0, 20.0, 100.0, 40.0, 10.0, 40.0, 40.0, 0.0, 30.0, 30.0, 340.0, 30.0, -10.0, 10.0, 470.0, 260.0, 70.0, 60.0, 30.0, 50.0, 70.0, 70.0, 720.0, 290.0, 140.0, 0.0, 20.0, 150.0, 30.0, 20.0, 270.0, 40.0, 20.0, 200.0, 400.0, 220.0, 110.0, 40.0, 40.0, 10.0, 50.0, 60.0, 20.0, 260.0, 110.0, 130.0, 40.0, 90.0, 130.0, 80.0, 340.0, 230.0, 0.0, 190.0, 170.0, 50.0, 190.0, 200.0, 20.0, 0.0, 300.0, 70.0, 70.0, 30.0, 60.0, -40.0, 360.0, 10.0, 420.0, 70.0, 30.0, 80.0, 220.0, 460.0, -30.0, 70.0, 150.0, -90.0, 220.0, 190.0, 10.0, 80.0, 110.0, 60.0, 180.0, 25.0, -10.0, 30.0, 60.0, 660.0, 40.0, 20.0, 50.0, 0.0, 50.0, 390.0, 180.0, 40.0, 60.0, 330.0, 10.0, 10.0, 40.0, 30.0, 450.0, 30.0, 70.0, 50.0, 330.0, 20.0, 20.0, 30.0, 360.0, 70.0, 60.0, 0.0, -5.0, 320.0, 20.0, 10.0, 200.0, 90.0, 20.0, 220.0, 130.0, 100.0, -20.0, 140.0, 40.0, 40.0, 50.0, 30.0, 70.0, 140.0, 440.0, 160.0, 40.0, 300.0, 100.0, 70.0, 40.0, 30.0, -95.0, 20.0, 10.0, 410.0, 40.0, 170.0, 20.0, 10.0, 10.0, 90.0, -45.0, 50.0, 80.0, -65.0, 380.0, 830.0, 170.0, 100.0, 30.0, 20.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 60.0, 10.0, 30.0, 30.0, 220.0, 10.0, 0.0, 30.0, 0.0, 40.0, 190.0, 140.0, 40.0, 40.0, 230.0, 60.0, 30.0, 320.0, 280.0, 250.0, 0.0, 250.0, 140.0, 10.0, 210.0, 260.0, 100.0, -50.0, 90.0, 370.0, 120.0, 40.0, 640.0, 70.0, 30.0, 160.0, 80.0, 20.0, 40.0, 70.0, 100.0, 40.0, 20.0, 160.0, 110.0, 40.0, 190.0, 250.0, -10.0, 40.0, 0.0, 0.0, 130.0, 30.0, 170.0, 130.0, 40.0, 100.0, 0.0, 50.0, 350.0, 110.0, 30.0, 10.0, -110.0, 260.0, 110.0, 150.0, 270.0, 40.0, 10.0, 320.0, 40.0, 140.0, 20.0, 150.0, 60.0, 0.0, 210.0, 40.0, 0.0, 160.0, 20.0, 60.0, 30.0, 20.0, 30.0, 70.0, 20.0, 90.0, 190.0, 0.0, 40.0, 100.0, 690.0, 30.0, 30.0, 50.0, 0.0, 10.0, 30.0, 20.0, 210.0, 330.0, 30.0, 400.0, 520.0, 60.0, 100.0, 130.0, 50.0, 60.0, 50.0, 320.0, 90.0, 30.0, 270.0, 10.0, 310.0, 30.0, 200.0, 120.0, 20.0, 360.0, 120.0, -30.0, 170.0, 50.0, 0.0, 110.0, 330.0, 60.0, 60.0, 70.0, 30.0, 280.0, 50.0, 210.0, 260.0, 40.0, 50.0, 300.0, 520.0, 10.0, -10.0, 60.0, 20.0, 120.0, 140.0, 40.0, 190.0, 160.0, 180.0, 180.0, 330.0, 430.0, 50.0, 15.0, 810.0, 60.0, 200.0, 90.0, 100.0, 50.0, 140.0, 50.0, 30.0, 20.0, 240.0, 40.0, 240.0, 60.0, 10.0, 330.0, 50.0, 50.0, 170.0, 510.0, 0.0, 50.0, 110.0, 220.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, -10.0, 20.0, 200.0, 50.0, 270.0, 420.0, 20.0, 190.0, 50.0, 300.0, -20.0, 410.0, 40.0, 200.0, 0.0, 70.0, 10.0, 70.0, 430.0, 30.0, 220.0, 50.0, 20.0, 260.0, 380.0, 330.0, 30.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 420.0, 180.0, 210.0, 40.0, 180.0, 80.0, 60.0, 90.0, 60.0, 20.0, 20.0, 130.0, 410.0, 20.0, 200.0, 0.0, 20.0, 60.0, 40.0, 40.0, 320.0, 60.0, -30.0, 30.0, -30.0, 100.0, 620.0, 120.0, 100.0, 60.0, 170.0, -80.0, 40.0, 40.0, 220.0, 190.0, 150.0, 0.0, 30.0, 290.0, 50.0, 210.0, 280.0, 90.0, 470.0, -70.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 140.0, 30.0, 20.0, 20.0, 40.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0707174364836174, "mean_inference_ms": 1.997414161320539, "mean_action_processing_ms": 0.5501439246159716, "mean_env_wait_ms": 1.7777005330529758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017226219177246094, "StateBufferConnector_ms": 0.012018442153930664, "ViewRequirementAgentConnector_ms": 0.47218847274780273}, "num_episodes": 23, "episode_return_max": 2345.0, "episode_return_min": 110.0, "episode_return_mean": 1060.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.5087737812697886, "num_env_steps_trained_throughput_per_sec": 2.5087737812697886, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 2520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 1455832.587, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1455832.536, "sample_time_ms": 2926.576, "learn_time_ms": 1452881.178, "learn_throughput": 2.753, "synch_weights_time_ms": 12.234}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "training_iteration": 63, "trial_id": "3d3a5_00000", "date": "2024-06-01_09-46-45", "timestamp": 1717249605, "time_this_iter_s": 1594.4537930488586, "time_total_s": 40421.48659515381, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8873a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40421.48659515381, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 22.695270270270267, "ram_util_percent": 82.61486486486487}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0025902105342595, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.098239857599504, "policy_loss": -0.007037737607994118, "vf_loss": 7.104580781609614, "vf_explained_var": -0.00016732034972681404, "kl": 0.006968123355181961, "entropy": 0.3414364739887504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 596265.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 2345.0, "episode_reward_min": 110.0, "episode_reward_mean": 1099.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 830.0}, "policy_reward_mean": {"policy_0": 109.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1215.0, 1210.0, 1010.0, 270.0, 1670.0, 510.0, 980.0, 560.0, 1570.0, 1160.0, 910.0, 940.0, 470.0, 740.0, 1110.0, 1270.0, 1340.0, 910.0, 380.0, 220.0, 900.0, 1460.0, 860.0, 960.0, 1140.0, 1190.0, 720.0, 910.0, 1690.0, 950.0, 1090.0, 1250.0, 1250.0, 1280.0, 1090.0, 300.0, 1710.0, 320.0, 1310.0, 1510.0, 1350.0, 970.0, 1390.0, 1350.0, 1300.0, 1205.0, 1160.0, 1040.0, 885.0, 960.0, 1400.0, 655.0, 1600.0, 310.0, 690.0, 1500.0, 1290.0, 1250.0, 800.0, 1110.0, 1090.0, 820.0, 530.0, 1000.0, 1890.0, 1430.0, 1190.0, 1350.0, 1250.0, 2345.0, 970.0, 1500.0, 110.0, 1500.0, 1480.0, 1140.0, 1280.0, 940.0, 1270.0, 890.0, 1420.0, 440.0, 1120.0, 1730.0, 1540.0, 1165.0, 1500.0, 580.0, 750.0, 1930.0, 450.0, 2150.0, 1770.0, 445.0, 690.0, 775.0, 1560.0, 1050.0, 1375.0, 990.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 140.0, 0.0, 130.0, 310.0, 140.0, 60.0, 40.0, 310.0, 15.0, 90.0, -30.0, 310.0, 220.0, 70.0, 20.0, -40.0, 130.0, 20.0, 420.0, 140.0, 170.0, 130.0, 240.0, 0.0, 40.0, 60.0, 40.0, 100.0, 90.0, 50.0, 10.0, 40.0, 70.0, 20.0, 10.0, 20.0, 40.0, 0.0, 10.0, 10.0, 520.0, 170.0, 50.0, 250.0, 230.0, 20.0, 20.0, 260.0, 140.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 20.0, 40.0, 30.0, 360.0, 0.0, 20.0, 20.0, 160.0, 170.0, 0.0, 510.0, 40.0, 20.0, 40.0, 70.0, 10.0, 0.0, 10.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 80.0, 0.0, 430.0, 80.0, 550.0, 170.0, 70.0, 70.0, 60.0, 60.0, 190.0, 110.0, 50.0, 240.0, 10.0, 80.0, 40.0, 30.0, 190.0, 220.0, 40.0, 290.0, 30.0, 60.0, 150.0, 0.0, 30.0, 20.0, 240.0, 50.0, 40.0, 660.0, 0.0, 160.0, 20.0, 30.0, 20.0, 30.0, -40.0, 20.0, 0.0, 250.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 30.0, 70.0, 10.0, 0.0, 80.0, 80.0, 20.0, 0.0, 230.0, 310.0, 10.0, 0.0, 210.0, -100.0, 310.0, 80.0, 0.0, 200.0, 50.0, 300.0, 10.0, 50.0, 10.0, 300.0, 190.0, 350.0, 10.0, 110.0, -10.0, 20.0, 20.0, 270.0, 470.0, 70.0, 165.0, 35.0, 30.0, 20.0, 360.0, 20.0, 60.0, 110.0, 110.0, 380.0, 40.0, 0.0, 290.0, 30.0, 20.0, 10.0, 0.0, 30.0, 190.0, 10.0, 50.0, 20.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 20.0, 10.0, 70.0, 100.0, 440.0, 40.0, 50.0, 70.0, 30.0, 70.0, 0.0, 160.0, -50.0, 120.0, 10.0, 60.0, 190.0, 340.0, 580.0, 50.0, 600.0, 20.0, 30.0, 180.0, 150.0, 60.0, 260.0, 30.0, 20.0, -490.0, 20.0, 140.0, 10.0, 60.0, 260.0, 0.0, 0.0, 40.0, 0.0, 430.0, 90.0, 150.0, -120.0, 40.0, 50.0, -50.0, 20.0, 500.0, 410.0, 50.0, 410.0, 40.0, 60.0, 520.0, 30.0, 190.0, -40.0, 90.0, -20.0, -90.0, 30.0, 190.0, 30.0, 15.0, 0.0, 35.0, -10.0, 130.0, 110.0, 190.0, 70.0, 40.0, 170.0, 160.0, 10.0, 90.0, 310.0, 10.0, 20.0, 30.0, 200.0, 480.0, 220.0, 420.0, 80.0, 20.0, 210.0, -10.0, 70.0, 0.0, -30.0, 240.0, 150.0, 270.0, -50.0, 110.0, 150.0, 30.0, 30.0, 50.0, 310.0, 110.0, 90.0, -50.0, 310.0, 70.0, 40.0, 150.0, 20.0, 40.0, 220.0, 50.0, 50.0, 40.0, 180.0, -10.0, 310.0, 80.0, 10.0, 320.0, 170.0, 170.0, 20.0, -10.0, 440.0, 310.0, 20.0, 80.0, 40.0, 10.0, 50.0, 460.0, 20.0, 80.0, 20.0, 90.0, 50.0, 230.0, 270.0, 10.0, 50.0, 80.0, 60.0, 370.0, 100.0, 0.0, 50.0, 40.0, 320.0, 20.0, 0.0, 50.0, 40.0, 30.0, 60.0, 20.0, 0.0, 90.0, 0.0, 10.0, 290.0, 160.0, 190.0, 90.0, 0.0, 650.0, 10.0, 40.0, 80.0, 200.0, 10.0, 20.0, 100.0, 40.0, 10.0, 40.0, 40.0, 0.0, 30.0, 30.0, 340.0, 30.0, -10.0, 10.0, 470.0, 260.0, 70.0, 60.0, 30.0, 50.0, 70.0, 70.0, 720.0, 290.0, 140.0, 0.0, 20.0, 150.0, 30.0, 20.0, 270.0, 40.0, 20.0, 200.0, 400.0, 220.0, 110.0, 40.0, 40.0, 10.0, 50.0, 60.0, 20.0, 260.0, 110.0, 130.0, 40.0, 90.0, 130.0, 80.0, 340.0, 230.0, 0.0, 190.0, 170.0, 50.0, 190.0, 200.0, 20.0, 0.0, 300.0, 70.0, 70.0, 30.0, 60.0, -40.0, 360.0, 10.0, 420.0, 70.0, 30.0, 80.0, 220.0, 460.0, -30.0, 70.0, 150.0, -90.0, 220.0, 190.0, 10.0, 80.0, 110.0, 60.0, 180.0, 25.0, -10.0, 30.0, 60.0, 660.0, 40.0, 20.0, 50.0, 0.0, 50.0, 390.0, 180.0, 40.0, 60.0, 330.0, 10.0, 10.0, 40.0, 30.0, 450.0, 30.0, 70.0, 50.0, 330.0, 20.0, 20.0, 30.0, 360.0, 70.0, 60.0, 0.0, -5.0, 320.0, 20.0, 10.0, 200.0, 90.0, 20.0, 220.0, 130.0, 100.0, -20.0, 140.0, 40.0, 40.0, 50.0, 30.0, 70.0, 140.0, 440.0, 160.0, 40.0, 300.0, 100.0, 70.0, 40.0, 30.0, -95.0, 20.0, 10.0, 410.0, 40.0, 170.0, 20.0, 10.0, 10.0, 90.0, -45.0, 50.0, 80.0, -65.0, 380.0, 830.0, 170.0, 100.0, 30.0, 20.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 60.0, 10.0, 30.0, 30.0, 220.0, 10.0, 0.0, 30.0, 0.0, 40.0, 190.0, 140.0, 40.0, 40.0, 230.0, 60.0, 30.0, 320.0, 280.0, 250.0, 0.0, 250.0, 140.0, 10.0, 210.0, 260.0, 100.0, -50.0, 90.0, 370.0, 120.0, 40.0, 640.0, 70.0, 30.0, 160.0, 80.0, 20.0, 40.0, 70.0, 100.0, 40.0, 20.0, 160.0, 110.0, 40.0, 190.0, 250.0, -10.0, 40.0, 0.0, 0.0, 130.0, 30.0, 170.0, 130.0, 40.0, 100.0, 0.0, 50.0, 350.0, 110.0, 30.0, 10.0, -110.0, 260.0, 110.0, 150.0, 270.0, 40.0, 10.0, 320.0, 40.0, 140.0, 20.0, 150.0, 60.0, 0.0, 210.0, 40.0, 0.0, 160.0, 20.0, 60.0, 30.0, 20.0, 30.0, 70.0, 20.0, 90.0, 190.0, 0.0, 40.0, 100.0, 690.0, 30.0, 30.0, 50.0, 0.0, 10.0, 30.0, 20.0, 210.0, 330.0, 30.0, 400.0, 520.0, 60.0, 100.0, 130.0, 50.0, 60.0, 50.0, 320.0, 90.0, 30.0, 270.0, 10.0, 310.0, 30.0, 200.0, 120.0, 20.0, 360.0, 120.0, -30.0, 170.0, 50.0, 0.0, 110.0, 330.0, 60.0, 60.0, 70.0, 30.0, 280.0, 50.0, 210.0, 260.0, 40.0, 50.0, 300.0, 520.0, 10.0, -10.0, 60.0, 20.0, 120.0, 140.0, 40.0, 190.0, 160.0, 180.0, 180.0, 330.0, 430.0, 50.0, 15.0, 810.0, 60.0, 200.0, 90.0, 100.0, 50.0, 140.0, 50.0, 30.0, 20.0, 240.0, 40.0, 240.0, 60.0, 10.0, 330.0, 50.0, 50.0, 170.0, 510.0, 0.0, 50.0, 110.0, 220.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, -10.0, 20.0, 200.0, 50.0, 270.0, 420.0, 20.0, 190.0, 50.0, 300.0, -20.0, 410.0, 40.0, 200.0, 0.0, 70.0, 10.0, 70.0, 430.0, 30.0, 220.0, 50.0, 20.0, 260.0, 380.0, 330.0, 30.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 420.0, 180.0, 210.0, 40.0, 180.0, 80.0, 60.0, 90.0, 60.0, 20.0, 20.0, 130.0, 410.0, 20.0, 200.0, 0.0, 20.0, 60.0, 40.0, 40.0, 320.0, 60.0, -30.0, 30.0, -30.0, 100.0, 620.0, 120.0, 100.0, 60.0, 170.0, -80.0, 40.0, 40.0, 220.0, 190.0, 150.0, 0.0, 30.0, 290.0, 50.0, 210.0, 280.0, 90.0, 470.0, -70.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 140.0, 30.0, 20.0, 20.0, 40.0, 60.0, 50.0, 40.0, 70.0, 260.0, 80.0, 20.0, 110.0, 120.0, 210.0, 160.0, 200.0, 40.0, 80.0, 220.0, -20.0, 160.0, 440.0, 320.0, 200.0, 90.0, 0.0, 540.0, 100.0, 380.0, 160.0, 70.0, 30.0, 180.0, 30.0, 50.0, -10.0, 200.0, 80.0, 75.0, 490.0, 40.0, 70.0, 180.0, 20.0, 20.0, 100.0, 0.0, 0.0, 760.0, 120.0, 400.0, 30.0, 30.0, 40.0, 20.0, 110.0, 20.0, 80.0, 0.0, 40.0, 30.0, -70.0, 40.0, 140.0, 190.0, 170.0, 10.0, 10.0, -50.0, 90.0, 140.0, 20.0, 20.0, 370.0, -30.0, 460.0, 150.0, 250.0, 30.0, 710.0, 20.0, 190.0, 80.0, 10.0, 30.0, 70.0, 80.0, 90.0, 0.0, 80.0, 0.0, 10.0, 30.0, 50.0, 40.0, 70.0, 60.0, 810.0, 20.0, 200.0, 200.0, 390.0, 300.0, -10.0, 110.0, 30.0, 80.0, 500.0, 160.0, 50.0, 270.0, 30.0, 460.0, 110.0, 80.0, 100.0, 40.0, 40.0, 150.0, -5.0, 0.0, 0.0, 60.0, 30.0, 30.0, 30.0, 310.0, 0.0, 40.0, 110.0, 60.0, 20.0, 10.0, 110.0, 0.0, 120.0, 50.0, 40.0, 40.0, 20.0, 100.0, 20.0, 290.0, 35.0, 60.0, 150.0, 40.0, 710.0, 80.0, 70.0, 220.0, 120.0, 0.0, 160.0, 10.0, 0.0, 60.0, 190.0, 0.0, 270.0, 260.0, 20.0, 80.0, 50.0, 120.0, 60.0, 180.0, 130.0, 20.0, 60.0, 165.0, 110.0, 250.0, 80.0, 320.0, 30.0, 40.0, 140.0, 370.0, 130.0, 100.0, -90.0, 40.0, 180.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.065485189003904, "mean_inference_ms": 1.9944739502205169, "mean_action_processing_ms": 0.5485446687170601, "mean_env_wait_ms": 1.772437552942437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017336130142211914, "StateBufferConnector_ms": 0.012803792953491211, "ViewRequirementAgentConnector_ms": 0.47939157485961914}, "num_episodes": 18, "episode_return_max": 2345.0, "episode_return_min": 110.0, "episode_return_mean": 1099.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.7133831228659, "num_env_steps_trained_throughput_per_sec": 18.7133831228659, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 1269194.86, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1269194.808, "sample_time_ms": 2933.286, "learn_time_ms": 1266236.706, "learn_throughput": 3.159, "synch_weights_time_ms": 12.154}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 64, "trial_id": "3d3a5_00000", "date": "2024-06-01_09-50-19", "timestamp": 1717249819, "time_this_iter_s": 213.7613010406494, "time_total_s": 40635.24789619446, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f87d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40635.24789619446, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 18.23543859649123, "ram_util_percent": 81.81719298245615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0717982906376085, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.418119704456756, "policy_loss": -0.006691603679720737, "vf_loss": 6.424058779004537, "vf_explained_var": 0.00030095645794853235, "kl": 0.007525338015149818, "entropy": 0.3746503211692753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 605655.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "env_runners": {"episode_reward_max": 2345.0, "episode_reward_min": 110.0, "episode_reward_mean": 1108.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -580.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 110.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 220.0, 900.0, 1460.0, 860.0, 960.0, 1140.0, 1190.0, 720.0, 910.0, 1690.0, 950.0, 1090.0, 1250.0, 1250.0, 1280.0, 1090.0, 300.0, 1710.0, 320.0, 1310.0, 1510.0, 1350.0, 970.0, 1390.0, 1350.0, 1300.0, 1205.0, 1160.0, 1040.0, 885.0, 960.0, 1400.0, 655.0, 1600.0, 310.0, 690.0, 1500.0, 1290.0, 1250.0, 800.0, 1110.0, 1090.0, 820.0, 530.0, 1000.0, 1890.0, 1430.0, 1190.0, 1350.0, 1250.0, 2345.0, 970.0, 1500.0, 110.0, 1500.0, 1480.0, 1140.0, 1280.0, 940.0, 1270.0, 890.0, 1420.0, 440.0, 1120.0, 1730.0, 1540.0, 1165.0, 1500.0, 580.0, 750.0, 1930.0, 450.0, 2150.0, 1770.0, 445.0, 690.0, 775.0, 1560.0, 1050.0, 1375.0, 990.0, 1160.0, 860.0, 1495.0, 1480.0, 1510.0, 1440.0, 1450.0, 780.0, 420.0, 680.0, 930.0, 1200.0, 1410.0, 170.0, 1265.0, 740.0, 960.0, 830.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 10.0, 50.0, 20.0, 20.0, 20.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 30.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 20.0, 10.0, 70.0, 100.0, 440.0, 40.0, 50.0, 70.0, 30.0, 70.0, 0.0, 160.0, -50.0, 120.0, 10.0, 60.0, 190.0, 340.0, 580.0, 50.0, 600.0, 20.0, 30.0, 180.0, 150.0, 60.0, 260.0, 30.0, 20.0, -490.0, 20.0, 140.0, 10.0, 60.0, 260.0, 0.0, 0.0, 40.0, 0.0, 430.0, 90.0, 150.0, -120.0, 40.0, 50.0, -50.0, 20.0, 500.0, 410.0, 50.0, 410.0, 40.0, 60.0, 520.0, 30.0, 190.0, -40.0, 90.0, -20.0, -90.0, 30.0, 190.0, 30.0, 15.0, 0.0, 35.0, -10.0, 130.0, 110.0, 190.0, 70.0, 40.0, 170.0, 160.0, 10.0, 90.0, 310.0, 10.0, 20.0, 30.0, 200.0, 480.0, 220.0, 420.0, 80.0, 20.0, 210.0, -10.0, 70.0, 0.0, -30.0, 240.0, 150.0, 270.0, -50.0, 110.0, 150.0, 30.0, 30.0, 50.0, 310.0, 110.0, 90.0, -50.0, 310.0, 70.0, 40.0, 150.0, 20.0, 40.0, 220.0, 50.0, 50.0, 40.0, 180.0, -10.0, 310.0, 80.0, 10.0, 320.0, 170.0, 170.0, 20.0, -10.0, 440.0, 310.0, 20.0, 80.0, 40.0, 10.0, 50.0, 460.0, 20.0, 80.0, 20.0, 90.0, 50.0, 230.0, 270.0, 10.0, 50.0, 80.0, 60.0, 370.0, 100.0, 0.0, 50.0, 40.0, 320.0, 20.0, 0.0, 50.0, 40.0, 30.0, 60.0, 20.0, 0.0, 90.0, 0.0, 10.0, 290.0, 160.0, 190.0, 90.0, 0.0, 650.0, 10.0, 40.0, 80.0, 200.0, 10.0, 20.0, 100.0, 40.0, 10.0, 40.0, 40.0, 0.0, 30.0, 30.0, 340.0, 30.0, -10.0, 10.0, 470.0, 260.0, 70.0, 60.0, 30.0, 50.0, 70.0, 70.0, 720.0, 290.0, 140.0, 0.0, 20.0, 150.0, 30.0, 20.0, 270.0, 40.0, 20.0, 200.0, 400.0, 220.0, 110.0, 40.0, 40.0, 10.0, 50.0, 60.0, 20.0, 260.0, 110.0, 130.0, 40.0, 90.0, 130.0, 80.0, 340.0, 230.0, 0.0, 190.0, 170.0, 50.0, 190.0, 200.0, 20.0, 0.0, 300.0, 70.0, 70.0, 30.0, 60.0, -40.0, 360.0, 10.0, 420.0, 70.0, 30.0, 80.0, 220.0, 460.0, -30.0, 70.0, 150.0, -90.0, 220.0, 190.0, 10.0, 80.0, 110.0, 60.0, 180.0, 25.0, -10.0, 30.0, 60.0, 660.0, 40.0, 20.0, 50.0, 0.0, 50.0, 390.0, 180.0, 40.0, 60.0, 330.0, 10.0, 10.0, 40.0, 30.0, 450.0, 30.0, 70.0, 50.0, 330.0, 20.0, 20.0, 30.0, 360.0, 70.0, 60.0, 0.0, -5.0, 320.0, 20.0, 10.0, 200.0, 90.0, 20.0, 220.0, 130.0, 100.0, -20.0, 140.0, 40.0, 40.0, 50.0, 30.0, 70.0, 140.0, 440.0, 160.0, 40.0, 300.0, 100.0, 70.0, 40.0, 30.0, -95.0, 20.0, 10.0, 410.0, 40.0, 170.0, 20.0, 10.0, 10.0, 90.0, -45.0, 50.0, 80.0, -65.0, 380.0, 830.0, 170.0, 100.0, 30.0, 20.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 60.0, 10.0, 30.0, 30.0, 220.0, 10.0, 0.0, 30.0, 0.0, 40.0, 190.0, 140.0, 40.0, 40.0, 230.0, 60.0, 30.0, 320.0, 280.0, 250.0, 0.0, 250.0, 140.0, 10.0, 210.0, 260.0, 100.0, -50.0, 90.0, 370.0, 120.0, 40.0, 640.0, 70.0, 30.0, 160.0, 80.0, 20.0, 40.0, 70.0, 100.0, 40.0, 20.0, 160.0, 110.0, 40.0, 190.0, 250.0, -10.0, 40.0, 0.0, 0.0, 130.0, 30.0, 170.0, 130.0, 40.0, 100.0, 0.0, 50.0, 350.0, 110.0, 30.0, 10.0, -110.0, 260.0, 110.0, 150.0, 270.0, 40.0, 10.0, 320.0, 40.0, 140.0, 20.0, 150.0, 60.0, 0.0, 210.0, 40.0, 0.0, 160.0, 20.0, 60.0, 30.0, 20.0, 30.0, 70.0, 20.0, 90.0, 190.0, 0.0, 40.0, 100.0, 690.0, 30.0, 30.0, 50.0, 0.0, 10.0, 30.0, 20.0, 210.0, 330.0, 30.0, 400.0, 520.0, 60.0, 100.0, 130.0, 50.0, 60.0, 50.0, 320.0, 90.0, 30.0, 270.0, 10.0, 310.0, 30.0, 200.0, 120.0, 20.0, 360.0, 120.0, -30.0, 170.0, 50.0, 0.0, 110.0, 330.0, 60.0, 60.0, 70.0, 30.0, 280.0, 50.0, 210.0, 260.0, 40.0, 50.0, 300.0, 520.0, 10.0, -10.0, 60.0, 20.0, 120.0, 140.0, 40.0, 190.0, 160.0, 180.0, 180.0, 330.0, 430.0, 50.0, 15.0, 810.0, 60.0, 200.0, 90.0, 100.0, 50.0, 140.0, 50.0, 30.0, 20.0, 240.0, 40.0, 240.0, 60.0, 10.0, 330.0, 50.0, 50.0, 170.0, 510.0, 0.0, 50.0, 110.0, 220.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, -10.0, 20.0, 200.0, 50.0, 270.0, 420.0, 20.0, 190.0, 50.0, 300.0, -20.0, 410.0, 40.0, 200.0, 0.0, 70.0, 10.0, 70.0, 430.0, 30.0, 220.0, 50.0, 20.0, 260.0, 380.0, 330.0, 30.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 420.0, 180.0, 210.0, 40.0, 180.0, 80.0, 60.0, 90.0, 60.0, 20.0, 20.0, 130.0, 410.0, 20.0, 200.0, 0.0, 20.0, 60.0, 40.0, 40.0, 320.0, 60.0, -30.0, 30.0, -30.0, 100.0, 620.0, 120.0, 100.0, 60.0, 170.0, -80.0, 40.0, 40.0, 220.0, 190.0, 150.0, 0.0, 30.0, 290.0, 50.0, 210.0, 280.0, 90.0, 470.0, -70.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 140.0, 30.0, 20.0, 20.0, 40.0, 60.0, 50.0, 40.0, 70.0, 260.0, 80.0, 20.0, 110.0, 120.0, 210.0, 160.0, 200.0, 40.0, 80.0, 220.0, -20.0, 160.0, 440.0, 320.0, 200.0, 90.0, 0.0, 540.0, 100.0, 380.0, 160.0, 70.0, 30.0, 180.0, 30.0, 50.0, -10.0, 200.0, 80.0, 75.0, 490.0, 40.0, 70.0, 180.0, 20.0, 20.0, 100.0, 0.0, 0.0, 760.0, 120.0, 400.0, 30.0, 30.0, 40.0, 20.0, 110.0, 20.0, 80.0, 0.0, 40.0, 30.0, -70.0, 40.0, 140.0, 190.0, 170.0, 10.0, 10.0, -50.0, 90.0, 140.0, 20.0, 20.0, 370.0, -30.0, 460.0, 150.0, 250.0, 30.0, 710.0, 20.0, 190.0, 80.0, 10.0, 30.0, 70.0, 80.0, 90.0, 0.0, 80.0, 0.0, 10.0, 30.0, 50.0, 40.0, 70.0, 60.0, 810.0, 20.0, 200.0, 200.0, 390.0, 300.0, -10.0, 110.0, 30.0, 80.0, 500.0, 160.0, 50.0, 270.0, 30.0, 460.0, 110.0, 80.0, 100.0, 40.0, 40.0, 150.0, -5.0, 0.0, 0.0, 60.0, 30.0, 30.0, 30.0, 310.0, 0.0, 40.0, 110.0, 60.0, 20.0, 10.0, 110.0, 0.0, 120.0, 50.0, 40.0, 40.0, 20.0, 100.0, 20.0, 290.0, 35.0, 60.0, 150.0, 40.0, 710.0, 80.0, 70.0, 220.0, 120.0, 0.0, 160.0, 10.0, 0.0, 60.0, 190.0, 0.0, 270.0, 260.0, 20.0, 80.0, 50.0, 120.0, 60.0, 180.0, 130.0, 20.0, 60.0, 165.0, 110.0, 250.0, 80.0, 320.0, 30.0, 40.0, 140.0, 370.0, 130.0, 100.0, -90.0, 40.0, 180.0, 50.0, 20.0, 40.0, 10.0, -10.0, -10.0, 0.0, 940.0, 20.0, 110.0, 40.0, 400.0, 70.0, 10.0, 10.0, 40.0, 170.0, 10.0, 0.0, 40.0, 110.0, 180.0, 210.0, 405.0, 400.0, -30.0, 30.0, 60.0, 120.0, 30.0, 90.0, 250.0, 210.0, 40.0, 50.0, 60.0, 500.0, 130.0, 100.0, 120.0, 20.0, 220.0, 70.0, 580.0, 100.0, 110.0, 120.0, 180.0, 50.0, 30.0, 50.0, 310.0, 30.0, 160.0, 300.0, 100.0, 90.0, 30.0, 10.0, 280.0, 130.0, 390.0, 90.0, 140.0, 50.0, 390.0, 210.0, 20.0, 40.0, 60.0, 60.0, 160.0, 190.0, 20.0, 50.0, 70.0, 20.0, 0.0, 250.0, 20.0, 0.0, 210.0, 10.0, 50.0, 0.0, 10.0, 50.0, 0.0, 30.0, -20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 20.0, 10.0, 20.0, 80.0, 30.0, 370.0, 440.0, 30.0, 140.0, -580.0, 160.0, 60.0, 240.0, 100.0, 80.0, 260.0, 690.0, -50.0, 10.0, 30.0, 80.0, 270.0, 30.0, 30.0, -10.0, 120.0, 250.0, -10.0, 30.0, 30.0, 130.0, 100.0, 40.0, 50.0, 490.0, 300.0, 10.0, 10.0, 40.0, 0.0, 30.0, 20.0, 20.0, 0.0, 20.0, 20.0, 310.0, 15.0, 100.0, 300.0, 60.0, 30.0, 80.0, 60.0, 220.0, 90.0, 50.0, 100.0, 0.0, 20.0, 60.0, 0.0, 460.0, 0.0, 50.0, 0.0, 20.0, 80.0, 20.0, 40.0, 0.0, 40.0, 300.0, 40.0, 400.0, 20.0, 0.0, 230.0, 10.0, 50.0, 50.0, 70.0, 50.0, 180.0, 70.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0606087760021996, "mean_inference_ms": 1.991633872124978, "mean_action_processing_ms": 0.5469912493421104, "mean_env_wait_ms": 1.7673241280334049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017308473587036133, "StateBufferConnector_ms": 0.012802362442016602, "ViewRequirementAgentConnector_ms": 0.48522162437438965}, "num_episodes": 18, "episode_return_max": 2345.0, "episode_return_min": 110.0, "episode_return_mean": 1108.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 13.404213119962291, "num_env_steps_trained_throughput_per_sec": 13.404213119962291, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 2600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2600000, "timers": {"training_iteration_time_ms": 1229167.264, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1229167.212, "sample_time_ms": 2901.575, "learn_time_ms": 1226240.997, "learn_throughput": 3.262, "synch_weights_time_ms": 12.251}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "done": false, "training_iteration": 65, "trial_id": "3d3a5_00000", "date": "2024-06-01_09-55-17", "timestamp": 1717250117, "time_this_iter_s": 298.42273807525635, "time_total_s": 40933.670634269714, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f887ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40933.670634269714, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 22.944444444444443, "ram_util_percent": 82.14270833333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2321530249426034, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.674240372000665, "policy_loss": -0.0075257440929274305, "vf_loss": 6.681088265621116, "vf_explained_var": 0.00030576725102588137, "kl": 0.00677847995445975, "entropy": 0.3450798542576984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 615045.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 2345.0, "episode_reward_min": 110.0, "episode_reward_mean": 1085.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -580.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 108.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1350.0, 970.0, 1390.0, 1350.0, 1300.0, 1205.0, 1160.0, 1040.0, 885.0, 960.0, 1400.0, 655.0, 1600.0, 310.0, 690.0, 1500.0, 1290.0, 1250.0, 800.0, 1110.0, 1090.0, 820.0, 530.0, 1000.0, 1890.0, 1430.0, 1190.0, 1350.0, 1250.0, 2345.0, 970.0, 1500.0, 110.0, 1500.0, 1480.0, 1140.0, 1280.0, 940.0, 1270.0, 890.0, 1420.0, 440.0, 1120.0, 1730.0, 1540.0, 1165.0, 1500.0, 580.0, 750.0, 1930.0, 450.0, 2150.0, 1770.0, 445.0, 690.0, 775.0, 1560.0, 1050.0, 1375.0, 990.0, 1160.0, 860.0, 1495.0, 1480.0, 1510.0, 1440.0, 1450.0, 780.0, 420.0, 680.0, 930.0, 1200.0, 1410.0, 170.0, 1265.0, 740.0, 960.0, 830.0, 830.0, 910.0, 1020.0, 1540.0, 640.0, 820.0, 1240.0, 1615.0, 1060.0, 610.0, 920.0, 540.0, 1180.0, 420.0, 860.0, 245.0, 1020.0, 1280.0, 1390.0, 990.0, 740.0, 240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [270.0, 40.0, 20.0, 200.0, 400.0, 220.0, 110.0, 40.0, 40.0, 10.0, 50.0, 60.0, 20.0, 260.0, 110.0, 130.0, 40.0, 90.0, 130.0, 80.0, 340.0, 230.0, 0.0, 190.0, 170.0, 50.0, 190.0, 200.0, 20.0, 0.0, 300.0, 70.0, 70.0, 30.0, 60.0, -40.0, 360.0, 10.0, 420.0, 70.0, 30.0, 80.0, 220.0, 460.0, -30.0, 70.0, 150.0, -90.0, 220.0, 190.0, 10.0, 80.0, 110.0, 60.0, 180.0, 25.0, -10.0, 30.0, 60.0, 660.0, 40.0, 20.0, 50.0, 0.0, 50.0, 390.0, 180.0, 40.0, 60.0, 330.0, 10.0, 10.0, 40.0, 30.0, 450.0, 30.0, 70.0, 50.0, 330.0, 20.0, 20.0, 30.0, 360.0, 70.0, 60.0, 0.0, -5.0, 320.0, 20.0, 10.0, 200.0, 90.0, 20.0, 220.0, 130.0, 100.0, -20.0, 140.0, 40.0, 40.0, 50.0, 30.0, 70.0, 140.0, 440.0, 160.0, 40.0, 300.0, 100.0, 70.0, 40.0, 30.0, -95.0, 20.0, 10.0, 410.0, 40.0, 170.0, 20.0, 10.0, 10.0, 90.0, -45.0, 50.0, 80.0, -65.0, 380.0, 830.0, 170.0, 100.0, 30.0, 20.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 60.0, 10.0, 30.0, 30.0, 220.0, 10.0, 0.0, 30.0, 0.0, 40.0, 190.0, 140.0, 40.0, 40.0, 230.0, 60.0, 30.0, 320.0, 280.0, 250.0, 0.0, 250.0, 140.0, 10.0, 210.0, 260.0, 100.0, -50.0, 90.0, 370.0, 120.0, 40.0, 640.0, 70.0, 30.0, 160.0, 80.0, 20.0, 40.0, 70.0, 100.0, 40.0, 20.0, 160.0, 110.0, 40.0, 190.0, 250.0, -10.0, 40.0, 0.0, 0.0, 130.0, 30.0, 170.0, 130.0, 40.0, 100.0, 0.0, 50.0, 350.0, 110.0, 30.0, 10.0, -110.0, 260.0, 110.0, 150.0, 270.0, 40.0, 10.0, 320.0, 40.0, 140.0, 20.0, 150.0, 60.0, 0.0, 210.0, 40.0, 0.0, 160.0, 20.0, 60.0, 30.0, 20.0, 30.0, 70.0, 20.0, 90.0, 190.0, 0.0, 40.0, 100.0, 690.0, 30.0, 30.0, 50.0, 0.0, 10.0, 30.0, 20.0, 210.0, 330.0, 30.0, 400.0, 520.0, 60.0, 100.0, 130.0, 50.0, 60.0, 50.0, 320.0, 90.0, 30.0, 270.0, 10.0, 310.0, 30.0, 200.0, 120.0, 20.0, 360.0, 120.0, -30.0, 170.0, 50.0, 0.0, 110.0, 330.0, 60.0, 60.0, 70.0, 30.0, 280.0, 50.0, 210.0, 260.0, 40.0, 50.0, 300.0, 520.0, 10.0, -10.0, 60.0, 20.0, 120.0, 140.0, 40.0, 190.0, 160.0, 180.0, 180.0, 330.0, 430.0, 50.0, 15.0, 810.0, 60.0, 200.0, 90.0, 100.0, 50.0, 140.0, 50.0, 30.0, 20.0, 240.0, 40.0, 240.0, 60.0, 10.0, 330.0, 50.0, 50.0, 170.0, 510.0, 0.0, 50.0, 110.0, 220.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, -10.0, 20.0, 200.0, 50.0, 270.0, 420.0, 20.0, 190.0, 50.0, 300.0, -20.0, 410.0, 40.0, 200.0, 0.0, 70.0, 10.0, 70.0, 430.0, 30.0, 220.0, 50.0, 20.0, 260.0, 380.0, 330.0, 30.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 420.0, 180.0, 210.0, 40.0, 180.0, 80.0, 60.0, 90.0, 60.0, 20.0, 20.0, 130.0, 410.0, 20.0, 200.0, 0.0, 20.0, 60.0, 40.0, 40.0, 320.0, 60.0, -30.0, 30.0, -30.0, 100.0, 620.0, 120.0, 100.0, 60.0, 170.0, -80.0, 40.0, 40.0, 220.0, 190.0, 150.0, 0.0, 30.0, 290.0, 50.0, 210.0, 280.0, 90.0, 470.0, -70.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 140.0, 30.0, 20.0, 20.0, 40.0, 60.0, 50.0, 40.0, 70.0, 260.0, 80.0, 20.0, 110.0, 120.0, 210.0, 160.0, 200.0, 40.0, 80.0, 220.0, -20.0, 160.0, 440.0, 320.0, 200.0, 90.0, 0.0, 540.0, 100.0, 380.0, 160.0, 70.0, 30.0, 180.0, 30.0, 50.0, -10.0, 200.0, 80.0, 75.0, 490.0, 40.0, 70.0, 180.0, 20.0, 20.0, 100.0, 0.0, 0.0, 760.0, 120.0, 400.0, 30.0, 30.0, 40.0, 20.0, 110.0, 20.0, 80.0, 0.0, 40.0, 30.0, -70.0, 40.0, 140.0, 190.0, 170.0, 10.0, 10.0, -50.0, 90.0, 140.0, 20.0, 20.0, 370.0, -30.0, 460.0, 150.0, 250.0, 30.0, 710.0, 20.0, 190.0, 80.0, 10.0, 30.0, 70.0, 80.0, 90.0, 0.0, 80.0, 0.0, 10.0, 30.0, 50.0, 40.0, 70.0, 60.0, 810.0, 20.0, 200.0, 200.0, 390.0, 300.0, -10.0, 110.0, 30.0, 80.0, 500.0, 160.0, 50.0, 270.0, 30.0, 460.0, 110.0, 80.0, 100.0, 40.0, 40.0, 150.0, -5.0, 0.0, 0.0, 60.0, 30.0, 30.0, 30.0, 310.0, 0.0, 40.0, 110.0, 60.0, 20.0, 10.0, 110.0, 0.0, 120.0, 50.0, 40.0, 40.0, 20.0, 100.0, 20.0, 290.0, 35.0, 60.0, 150.0, 40.0, 710.0, 80.0, 70.0, 220.0, 120.0, 0.0, 160.0, 10.0, 0.0, 60.0, 190.0, 0.0, 270.0, 260.0, 20.0, 80.0, 50.0, 120.0, 60.0, 180.0, 130.0, 20.0, 60.0, 165.0, 110.0, 250.0, 80.0, 320.0, 30.0, 40.0, 140.0, 370.0, 130.0, 100.0, -90.0, 40.0, 180.0, 50.0, 20.0, 40.0, 10.0, -10.0, -10.0, 0.0, 940.0, 20.0, 110.0, 40.0, 400.0, 70.0, 10.0, 10.0, 40.0, 170.0, 10.0, 0.0, 40.0, 110.0, 180.0, 210.0, 405.0, 400.0, -30.0, 30.0, 60.0, 120.0, 30.0, 90.0, 250.0, 210.0, 40.0, 50.0, 60.0, 500.0, 130.0, 100.0, 120.0, 20.0, 220.0, 70.0, 580.0, 100.0, 110.0, 120.0, 180.0, 50.0, 30.0, 50.0, 310.0, 30.0, 160.0, 300.0, 100.0, 90.0, 30.0, 10.0, 280.0, 130.0, 390.0, 90.0, 140.0, 50.0, 390.0, 210.0, 20.0, 40.0, 60.0, 60.0, 160.0, 190.0, 20.0, 50.0, 70.0, 20.0, 0.0, 250.0, 20.0, 0.0, 210.0, 10.0, 50.0, 0.0, 10.0, 50.0, 0.0, 30.0, -20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 20.0, 10.0, 20.0, 80.0, 30.0, 370.0, 440.0, 30.0, 140.0, -580.0, 160.0, 60.0, 240.0, 100.0, 80.0, 260.0, 690.0, -50.0, 10.0, 30.0, 80.0, 270.0, 30.0, 30.0, -10.0, 120.0, 250.0, -10.0, 30.0, 30.0, 130.0, 100.0, 40.0, 50.0, 490.0, 300.0, 10.0, 10.0, 40.0, 0.0, 30.0, 20.0, 20.0, 0.0, 20.0, 20.0, 310.0, 15.0, 100.0, 300.0, 60.0, 30.0, 80.0, 60.0, 220.0, 90.0, 50.0, 100.0, 0.0, 20.0, 60.0, 0.0, 460.0, 0.0, 50.0, 0.0, 20.0, 80.0, 20.0, 40.0, 0.0, 40.0, 300.0, 40.0, 400.0, 20.0, 0.0, 230.0, 10.0, 50.0, 50.0, 70.0, 50.0, 180.0, 70.0, 120.0, 40.0, 190.0, 20.0, 210.0, 50.0, 120.0, 0.0, 0.0, 90.0, 110.0, 10.0, 100.0, 210.0, 80.0, 0.0, 60.0, 10.0, 20.0, 160.0, 260.0, 190.0, 10.0, -40.0, 50.0, 400.0, 40.0, 30.0, 40.0, 260.0, 40.0, 300.0, 40.0, 270.0, 40.0, 510.0, 80.0, 90.0, 10.0, 250.0, -50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 0.0, 190.0, 20.0, 290.0, 0.0, 40.0, 40.0, 40.0, 0.0, 70.0, 90.0, 80.0, 80.0, -30.0, 410.0, 80.0, 180.0, 40.0, 190.0, 40.0, 50.0, 80.0, 80.0, 90.0, 410.0, 175.0, 90.0, 60.0, 120.0, 20.0, 240.0, 40.0, 350.0, 390.0, 130.0, 60.0, 230.0, 230.0, 170.0, 270.0, 60.0, 30.0, 100.0, -110.0, 20.0, 160.0, 80.0, 40.0, 0.0, 0.0, 250.0, 40.0, 0.0, 30.0, 10.0, 490.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 140.0, 30.0, 0.0, 60.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 200.0, 0.0, 210.0, 420.0, 50.0, 200.0, 30.0, 40.0, 90.0, 20.0, 50.0, 200.0, 80.0, 130.0, 0.0, 30.0, 0.0, 70.0, 20.0, 120.0, 40.0, 0.0, 10.0, 80.0, 40.0, 70.0, 60.0, 10.0, 0.0, 20.0, 30.0, 180.0, 370.0, 0.0, 40.0, 20.0, 60.0, 40.0, 50.0, -5.0, 30.0, 0.0, 10.0, 310.0, 160.0, 170.0, 170.0, 140.0, 40.0, 40.0, 10.0, -20.0, 0.0, 170.0, 180.0, 70.0, 130.0, 380.0, 40.0, -50.0, 110.0, 20.0, 230.0, 20.0, 420.0, -30.0, 30.0, 30.0, 60.0, 180.0, 420.0, 30.0, 230.0, 70.0, 420.0, 80.0, 50.0, 10.0, 290.0, 10.0, 10.0, 30.0, 20.0, 20.0, 300.0, 40.0, -130.0, 80.0, 10.0, 360.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 150.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0551268894387635, "mean_inference_ms": 1.9884825047988302, "mean_action_processing_ms": 0.5451528722646661, "mean_env_wait_ms": 1.7611993824680252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016895532608032227, "StateBufferConnector_ms": 0.01229095458984375, "ViewRequirementAgentConnector_ms": 0.46430373191833496}, "num_episodes": 22, "episode_return_max": 2345.0, "episode_return_min": 110.0, "episode_return_mean": 1085.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.850705023637211, "num_env_steps_trained_throughput_per_sec": 4.850705023637211, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 1120648.676, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1120648.614, "sample_time_ms": 2957.348, "learn_time_ms": 1117667.478, "learn_throughput": 3.579, "synch_weights_time_ms": 12.512}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 66, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-09-02", "timestamp": 1717250942, "time_this_iter_s": 824.6417570114136, "time_total_s": 41758.31239128113, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7f8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41758.31239128113, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 20.03448275862069, "ram_util_percent": 80.23586206896552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9861703551551912, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.901288034207524, "policy_loss": -0.006659164894208574, "vf_loss": 6.907222028433705, "vf_explained_var": 0.0006852281804536732, "kl": 0.007251702454010935, "entropy": 0.347108282169468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 624435.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "env_runners": {"episode_reward_max": 2345.0, "episode_reward_min": 110.0, "episode_reward_mean": 1090.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -580.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 109.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1000.0, 1890.0, 1430.0, 1190.0, 1350.0, 1250.0, 2345.0, 970.0, 1500.0, 110.0, 1500.0, 1480.0, 1140.0, 1280.0, 940.0, 1270.0, 890.0, 1420.0, 440.0, 1120.0, 1730.0, 1540.0, 1165.0, 1500.0, 580.0, 750.0, 1930.0, 450.0, 2150.0, 1770.0, 445.0, 690.0, 775.0, 1560.0, 1050.0, 1375.0, 990.0, 1160.0, 860.0, 1495.0, 1480.0, 1510.0, 1440.0, 1450.0, 780.0, 420.0, 680.0, 930.0, 1200.0, 1410.0, 170.0, 1265.0, 740.0, 960.0, 830.0, 830.0, 910.0, 1020.0, 1540.0, 640.0, 820.0, 1240.0, 1615.0, 1060.0, 610.0, 920.0, 540.0, 1180.0, 420.0, 860.0, 245.0, 1020.0, 1280.0, 1390.0, 990.0, 740.0, 240.0, 1245.0, 290.0, 1610.0, 1230.0, 1240.0, 940.0, 945.0, 1260.0, 1740.0, 1070.0, 1490.0, 1690.0, 770.0, 600.0, 1410.0, 1440.0, 1335.0, 750.0, 760.0, 940.0, 810.0, 370.0, 1220.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 100.0, 690.0, 30.0, 30.0, 50.0, 0.0, 10.0, 30.0, 20.0, 210.0, 330.0, 30.0, 400.0, 520.0, 60.0, 100.0, 130.0, 50.0, 60.0, 50.0, 320.0, 90.0, 30.0, 270.0, 10.0, 310.0, 30.0, 200.0, 120.0, 20.0, 360.0, 120.0, -30.0, 170.0, 50.0, 0.0, 110.0, 330.0, 60.0, 60.0, 70.0, 30.0, 280.0, 50.0, 210.0, 260.0, 40.0, 50.0, 300.0, 520.0, 10.0, -10.0, 60.0, 20.0, 120.0, 140.0, 40.0, 190.0, 160.0, 180.0, 180.0, 330.0, 430.0, 50.0, 15.0, 810.0, 60.0, 200.0, 90.0, 100.0, 50.0, 140.0, 50.0, 30.0, 20.0, 240.0, 40.0, 240.0, 60.0, 10.0, 330.0, 50.0, 50.0, 170.0, 510.0, 0.0, 50.0, 110.0, 220.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, -10.0, 20.0, 200.0, 50.0, 270.0, 420.0, 20.0, 190.0, 50.0, 300.0, -20.0, 410.0, 40.0, 200.0, 0.0, 70.0, 10.0, 70.0, 430.0, 30.0, 220.0, 50.0, 20.0, 260.0, 380.0, 330.0, 30.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 420.0, 180.0, 210.0, 40.0, 180.0, 80.0, 60.0, 90.0, 60.0, 20.0, 20.0, 130.0, 410.0, 20.0, 200.0, 0.0, 20.0, 60.0, 40.0, 40.0, 320.0, 60.0, -30.0, 30.0, -30.0, 100.0, 620.0, 120.0, 100.0, 60.0, 170.0, -80.0, 40.0, 40.0, 220.0, 190.0, 150.0, 0.0, 30.0, 290.0, 50.0, 210.0, 280.0, 90.0, 470.0, -70.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 140.0, 30.0, 20.0, 20.0, 40.0, 60.0, 50.0, 40.0, 70.0, 260.0, 80.0, 20.0, 110.0, 120.0, 210.0, 160.0, 200.0, 40.0, 80.0, 220.0, -20.0, 160.0, 440.0, 320.0, 200.0, 90.0, 0.0, 540.0, 100.0, 380.0, 160.0, 70.0, 30.0, 180.0, 30.0, 50.0, -10.0, 200.0, 80.0, 75.0, 490.0, 40.0, 70.0, 180.0, 20.0, 20.0, 100.0, 0.0, 0.0, 760.0, 120.0, 400.0, 30.0, 30.0, 40.0, 20.0, 110.0, 20.0, 80.0, 0.0, 40.0, 30.0, -70.0, 40.0, 140.0, 190.0, 170.0, 10.0, 10.0, -50.0, 90.0, 140.0, 20.0, 20.0, 370.0, -30.0, 460.0, 150.0, 250.0, 30.0, 710.0, 20.0, 190.0, 80.0, 10.0, 30.0, 70.0, 80.0, 90.0, 0.0, 80.0, 0.0, 10.0, 30.0, 50.0, 40.0, 70.0, 60.0, 810.0, 20.0, 200.0, 200.0, 390.0, 300.0, -10.0, 110.0, 30.0, 80.0, 500.0, 160.0, 50.0, 270.0, 30.0, 460.0, 110.0, 80.0, 100.0, 40.0, 40.0, 150.0, -5.0, 0.0, 0.0, 60.0, 30.0, 30.0, 30.0, 310.0, 0.0, 40.0, 110.0, 60.0, 20.0, 10.0, 110.0, 0.0, 120.0, 50.0, 40.0, 40.0, 20.0, 100.0, 20.0, 290.0, 35.0, 60.0, 150.0, 40.0, 710.0, 80.0, 70.0, 220.0, 120.0, 0.0, 160.0, 10.0, 0.0, 60.0, 190.0, 0.0, 270.0, 260.0, 20.0, 80.0, 50.0, 120.0, 60.0, 180.0, 130.0, 20.0, 60.0, 165.0, 110.0, 250.0, 80.0, 320.0, 30.0, 40.0, 140.0, 370.0, 130.0, 100.0, -90.0, 40.0, 180.0, 50.0, 20.0, 40.0, 10.0, -10.0, -10.0, 0.0, 940.0, 20.0, 110.0, 40.0, 400.0, 70.0, 10.0, 10.0, 40.0, 170.0, 10.0, 0.0, 40.0, 110.0, 180.0, 210.0, 405.0, 400.0, -30.0, 30.0, 60.0, 120.0, 30.0, 90.0, 250.0, 210.0, 40.0, 50.0, 60.0, 500.0, 130.0, 100.0, 120.0, 20.0, 220.0, 70.0, 580.0, 100.0, 110.0, 120.0, 180.0, 50.0, 30.0, 50.0, 310.0, 30.0, 160.0, 300.0, 100.0, 90.0, 30.0, 10.0, 280.0, 130.0, 390.0, 90.0, 140.0, 50.0, 390.0, 210.0, 20.0, 40.0, 60.0, 60.0, 160.0, 190.0, 20.0, 50.0, 70.0, 20.0, 0.0, 250.0, 20.0, 0.0, 210.0, 10.0, 50.0, 0.0, 10.0, 50.0, 0.0, 30.0, -20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 20.0, 10.0, 20.0, 80.0, 30.0, 370.0, 440.0, 30.0, 140.0, -580.0, 160.0, 60.0, 240.0, 100.0, 80.0, 260.0, 690.0, -50.0, 10.0, 30.0, 80.0, 270.0, 30.0, 30.0, -10.0, 120.0, 250.0, -10.0, 30.0, 30.0, 130.0, 100.0, 40.0, 50.0, 490.0, 300.0, 10.0, 10.0, 40.0, 0.0, 30.0, 20.0, 20.0, 0.0, 20.0, 20.0, 310.0, 15.0, 100.0, 300.0, 60.0, 30.0, 80.0, 60.0, 220.0, 90.0, 50.0, 100.0, 0.0, 20.0, 60.0, 0.0, 460.0, 0.0, 50.0, 0.0, 20.0, 80.0, 20.0, 40.0, 0.0, 40.0, 300.0, 40.0, 400.0, 20.0, 0.0, 230.0, 10.0, 50.0, 50.0, 70.0, 50.0, 180.0, 70.0, 120.0, 40.0, 190.0, 20.0, 210.0, 50.0, 120.0, 0.0, 0.0, 90.0, 110.0, 10.0, 100.0, 210.0, 80.0, 0.0, 60.0, 10.0, 20.0, 160.0, 260.0, 190.0, 10.0, -40.0, 50.0, 400.0, 40.0, 30.0, 40.0, 260.0, 40.0, 300.0, 40.0, 270.0, 40.0, 510.0, 80.0, 90.0, 10.0, 250.0, -50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 0.0, 190.0, 20.0, 290.0, 0.0, 40.0, 40.0, 40.0, 0.0, 70.0, 90.0, 80.0, 80.0, -30.0, 410.0, 80.0, 180.0, 40.0, 190.0, 40.0, 50.0, 80.0, 80.0, 90.0, 410.0, 175.0, 90.0, 60.0, 120.0, 20.0, 240.0, 40.0, 350.0, 390.0, 130.0, 60.0, 230.0, 230.0, 170.0, 270.0, 60.0, 30.0, 100.0, -110.0, 20.0, 160.0, 80.0, 40.0, 0.0, 0.0, 250.0, 40.0, 0.0, 30.0, 10.0, 490.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 140.0, 30.0, 0.0, 60.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 200.0, 0.0, 210.0, 420.0, 50.0, 200.0, 30.0, 40.0, 90.0, 20.0, 50.0, 200.0, 80.0, 130.0, 0.0, 30.0, 0.0, 70.0, 20.0, 120.0, 40.0, 0.0, 10.0, 80.0, 40.0, 70.0, 60.0, 10.0, 0.0, 20.0, 30.0, 180.0, 370.0, 0.0, 40.0, 20.0, 60.0, 40.0, 50.0, -5.0, 30.0, 0.0, 10.0, 310.0, 160.0, 170.0, 170.0, 140.0, 40.0, 40.0, 10.0, -20.0, 0.0, 170.0, 180.0, 70.0, 130.0, 380.0, 40.0, -50.0, 110.0, 20.0, 230.0, 20.0, 420.0, -30.0, 30.0, 30.0, 60.0, 180.0, 420.0, 30.0, 230.0, 70.0, 420.0, 80.0, 50.0, 10.0, 290.0, 10.0, 10.0, 30.0, 20.0, 20.0, 300.0, 40.0, -130.0, 80.0, 10.0, 360.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 150.0, 0.0, 30.0, 60.0, 40.0, 390.0, 15.0, 180.0, 70.0, 40.0, 310.0, 50.0, 90.0, 30.0, 40.0, 10.0, 70.0, 10.0, 0.0, 70.0, 10.0, 20.0, 30.0, 230.0, 270.0, 180.0, 60.0, 60.0, 450.0, 110.0, 200.0, 40.0, 10.0, 160.0, 10.0, 450.0, 90.0, 120.0, 100.0, 50.0, 60.0, 10.0, 180.0, 210.0, 170.0, 120.0, 70.0, 80.0, 90.0, 180.0, 170.0, 110.0, 40.0, 70.0, 30.0, 100.0, 0.0, 200.0, 70.0, 120.0, 20.0, 130.0, 200.0, 50.0, 10.0, 5.0, 100.0, 10.0, 400.0, 100.0, 30.0, 90.0, 150.0, 10.0, 30.0, 30.0, 100.0, 390.0, 90.0, 350.0, 20.0, 200.0, 40.0, 330.0, 40.0, 140.0, 190.0, 380.0, 70.0, 420.0, 20.0, 30.0, 120.0, 40.0, 20.0, 70.0, 30.0, 640.0, 30.0, 140.0, 50.0, 10.0, 40.0, 400.0, 60.0, 90.0, 20.0, 80.0, 60.0, 20.0, -10.0, 340.0, 430.0, 180.0, 130.0, 100.0, 90.0, 340.0, 70.0, 390.0, 210.0, 10.0, 170.0, 180.0, 50.0, 30.0, 260.0, 20.0, 0.0, 160.0, 70.0, 0.0, 0.0, 40.0, 100.0, 30.0, 70.0, 20.0, 30.0, 80.0, 30.0, 170.0, 30.0, 50.0, 100.0, 170.0, -20.0, 170.0, 70.0, 350.0, 350.0, 40.0, 130.0, 70.0, 200.0, 90.0, 100.0, 520.0, 200.0, 60.0, 60.0, 60.0, 80.0, 710.0, 20.0, 60.0, 20.0, 40.0, 50.0, 280.0, 40.0, 140.0, -25.0, 0.0, 50.0, 320.0, 160.0, 160.0, 0.0, 30.0, 10.0, 0.0, 20.0, 10.0, 180.0, 60.0, 120.0, 100.0, 40.0, 100.0, 30.0, 40.0, 80.0, 30.0, 0.0, -90.0, 250.0, 210.0, 180.0, 10.0, 280.0, 50.0, 20.0, 50.0, 160.0, 200.0, 200.0, 30.0, 70.0, 420.0, -470.0, 70.0, 80.0, 50.0, 170.0, 10.0, 20.0, 10.0, 90.0, 10.0, 0.0, 0.0, 10.0, 60.0, 0.0, 40.0, 200.0, 50.0, 280.0, 60.0, 30.0, 300.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.045945440591366, "mean_inference_ms": 1.9819024722989818, "mean_action_processing_ms": 0.5424476002202084, "mean_env_wait_ms": 1.752431295858409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016649484634399414, "StateBufferConnector_ms": 0.011958599090576172, "ViewRequirementAgentConnector_ms": 0.44582343101501465}, "num_episodes": 23, "episode_return_max": 2345.0, "episode_return_min": 110.0, "episode_return_mean": 1090.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 13.207128778617504, "num_env_steps_trained_throughput_per_sec": 13.207128778617504, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 2680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2680000, "timers": {"training_iteration_time_ms": 1026533.509, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1026533.448, "sample_time_ms": 2971.279, "learn_time_ms": 1023538.638, "learn_throughput": 3.908, "synch_weights_time_ms": 12.48}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "done": false, "training_iteration": 67, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-14-05", "timestamp": 1717251245, "time_this_iter_s": 302.89703488349915, "time_total_s": 42061.20942616463, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f88a3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 42061.20942616463, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 19.62123287671233, "ram_util_percent": 82.00034246575343}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.390535898006762, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.38714767629727, "policy_loss": -0.007380456175467672, "vf_loss": 7.393881496707725, "vf_explained_var": 0.000901264231552839, "kl": 0.006466400396266742, "entropy": 0.32234748914853706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 633825.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 2150.0, "episode_reward_min": 170.0, "episode_reward_mean": 1085.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -580.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 108.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [440.0, 1120.0, 1730.0, 1540.0, 1165.0, 1500.0, 580.0, 750.0, 1930.0, 450.0, 2150.0, 1770.0, 445.0, 690.0, 775.0, 1560.0, 1050.0, 1375.0, 990.0, 1160.0, 860.0, 1495.0, 1480.0, 1510.0, 1440.0, 1450.0, 780.0, 420.0, 680.0, 930.0, 1200.0, 1410.0, 170.0, 1265.0, 740.0, 960.0, 830.0, 830.0, 910.0, 1020.0, 1540.0, 640.0, 820.0, 1240.0, 1615.0, 1060.0, 610.0, 920.0, 540.0, 1180.0, 420.0, 860.0, 245.0, 1020.0, 1280.0, 1390.0, 990.0, 740.0, 240.0, 1245.0, 290.0, 1610.0, 1230.0, 1240.0, 940.0, 945.0, 1260.0, 1740.0, 1070.0, 1490.0, 1690.0, 770.0, 600.0, 1410.0, 1440.0, 1335.0, 750.0, 760.0, 940.0, 810.0, 370.0, 1220.0, 510.0, 670.0, 1260.0, 1390.0, 1715.0, 1330.0, 1320.0, 1430.0, 1280.0, 1595.0, 1280.0, 1230.0, 1000.0, 1515.0, 930.0, 1360.0, 1910.0, 740.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 0.0, 80.0, 140.0, 30.0, 20.0, 20.0, 40.0, 60.0, 50.0, 40.0, 70.0, 260.0, 80.0, 20.0, 110.0, 120.0, 210.0, 160.0, 200.0, 40.0, 80.0, 220.0, -20.0, 160.0, 440.0, 320.0, 200.0, 90.0, 0.0, 540.0, 100.0, 380.0, 160.0, 70.0, 30.0, 180.0, 30.0, 50.0, -10.0, 200.0, 80.0, 75.0, 490.0, 40.0, 70.0, 180.0, 20.0, 20.0, 100.0, 0.0, 0.0, 760.0, 120.0, 400.0, 30.0, 30.0, 40.0, 20.0, 110.0, 20.0, 80.0, 0.0, 40.0, 30.0, -70.0, 40.0, 140.0, 190.0, 170.0, 10.0, 10.0, -50.0, 90.0, 140.0, 20.0, 20.0, 370.0, -30.0, 460.0, 150.0, 250.0, 30.0, 710.0, 20.0, 190.0, 80.0, 10.0, 30.0, 70.0, 80.0, 90.0, 0.0, 80.0, 0.0, 10.0, 30.0, 50.0, 40.0, 70.0, 60.0, 810.0, 20.0, 200.0, 200.0, 390.0, 300.0, -10.0, 110.0, 30.0, 80.0, 500.0, 160.0, 50.0, 270.0, 30.0, 460.0, 110.0, 80.0, 100.0, 40.0, 40.0, 150.0, -5.0, 0.0, 0.0, 60.0, 30.0, 30.0, 30.0, 310.0, 0.0, 40.0, 110.0, 60.0, 20.0, 10.0, 110.0, 0.0, 120.0, 50.0, 40.0, 40.0, 20.0, 100.0, 20.0, 290.0, 35.0, 60.0, 150.0, 40.0, 710.0, 80.0, 70.0, 220.0, 120.0, 0.0, 160.0, 10.0, 0.0, 60.0, 190.0, 0.0, 270.0, 260.0, 20.0, 80.0, 50.0, 120.0, 60.0, 180.0, 130.0, 20.0, 60.0, 165.0, 110.0, 250.0, 80.0, 320.0, 30.0, 40.0, 140.0, 370.0, 130.0, 100.0, -90.0, 40.0, 180.0, 50.0, 20.0, 40.0, 10.0, -10.0, -10.0, 0.0, 940.0, 20.0, 110.0, 40.0, 400.0, 70.0, 10.0, 10.0, 40.0, 170.0, 10.0, 0.0, 40.0, 110.0, 180.0, 210.0, 405.0, 400.0, -30.0, 30.0, 60.0, 120.0, 30.0, 90.0, 250.0, 210.0, 40.0, 50.0, 60.0, 500.0, 130.0, 100.0, 120.0, 20.0, 220.0, 70.0, 580.0, 100.0, 110.0, 120.0, 180.0, 50.0, 30.0, 50.0, 310.0, 30.0, 160.0, 300.0, 100.0, 90.0, 30.0, 10.0, 280.0, 130.0, 390.0, 90.0, 140.0, 50.0, 390.0, 210.0, 20.0, 40.0, 60.0, 60.0, 160.0, 190.0, 20.0, 50.0, 70.0, 20.0, 0.0, 250.0, 20.0, 0.0, 210.0, 10.0, 50.0, 0.0, 10.0, 50.0, 0.0, 30.0, -20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 20.0, 10.0, 20.0, 80.0, 30.0, 370.0, 440.0, 30.0, 140.0, -580.0, 160.0, 60.0, 240.0, 100.0, 80.0, 260.0, 690.0, -50.0, 10.0, 30.0, 80.0, 270.0, 30.0, 30.0, -10.0, 120.0, 250.0, -10.0, 30.0, 30.0, 130.0, 100.0, 40.0, 50.0, 490.0, 300.0, 10.0, 10.0, 40.0, 0.0, 30.0, 20.0, 20.0, 0.0, 20.0, 20.0, 310.0, 15.0, 100.0, 300.0, 60.0, 30.0, 80.0, 60.0, 220.0, 90.0, 50.0, 100.0, 0.0, 20.0, 60.0, 0.0, 460.0, 0.0, 50.0, 0.0, 20.0, 80.0, 20.0, 40.0, 0.0, 40.0, 300.0, 40.0, 400.0, 20.0, 0.0, 230.0, 10.0, 50.0, 50.0, 70.0, 50.0, 180.0, 70.0, 120.0, 40.0, 190.0, 20.0, 210.0, 50.0, 120.0, 0.0, 0.0, 90.0, 110.0, 10.0, 100.0, 210.0, 80.0, 0.0, 60.0, 10.0, 20.0, 160.0, 260.0, 190.0, 10.0, -40.0, 50.0, 400.0, 40.0, 30.0, 40.0, 260.0, 40.0, 300.0, 40.0, 270.0, 40.0, 510.0, 80.0, 90.0, 10.0, 250.0, -50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 0.0, 190.0, 20.0, 290.0, 0.0, 40.0, 40.0, 40.0, 0.0, 70.0, 90.0, 80.0, 80.0, -30.0, 410.0, 80.0, 180.0, 40.0, 190.0, 40.0, 50.0, 80.0, 80.0, 90.0, 410.0, 175.0, 90.0, 60.0, 120.0, 20.0, 240.0, 40.0, 350.0, 390.0, 130.0, 60.0, 230.0, 230.0, 170.0, 270.0, 60.0, 30.0, 100.0, -110.0, 20.0, 160.0, 80.0, 40.0, 0.0, 0.0, 250.0, 40.0, 0.0, 30.0, 10.0, 490.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 140.0, 30.0, 0.0, 60.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 200.0, 0.0, 210.0, 420.0, 50.0, 200.0, 30.0, 40.0, 90.0, 20.0, 50.0, 200.0, 80.0, 130.0, 0.0, 30.0, 0.0, 70.0, 20.0, 120.0, 40.0, 0.0, 10.0, 80.0, 40.0, 70.0, 60.0, 10.0, 0.0, 20.0, 30.0, 180.0, 370.0, 0.0, 40.0, 20.0, 60.0, 40.0, 50.0, -5.0, 30.0, 0.0, 10.0, 310.0, 160.0, 170.0, 170.0, 140.0, 40.0, 40.0, 10.0, -20.0, 0.0, 170.0, 180.0, 70.0, 130.0, 380.0, 40.0, -50.0, 110.0, 20.0, 230.0, 20.0, 420.0, -30.0, 30.0, 30.0, 60.0, 180.0, 420.0, 30.0, 230.0, 70.0, 420.0, 80.0, 50.0, 10.0, 290.0, 10.0, 10.0, 30.0, 20.0, 20.0, 300.0, 40.0, -130.0, 80.0, 10.0, 360.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 150.0, 0.0, 30.0, 60.0, 40.0, 390.0, 15.0, 180.0, 70.0, 40.0, 310.0, 50.0, 90.0, 30.0, 40.0, 10.0, 70.0, 10.0, 0.0, 70.0, 10.0, 20.0, 30.0, 230.0, 270.0, 180.0, 60.0, 60.0, 450.0, 110.0, 200.0, 40.0, 10.0, 160.0, 10.0, 450.0, 90.0, 120.0, 100.0, 50.0, 60.0, 10.0, 180.0, 210.0, 170.0, 120.0, 70.0, 80.0, 90.0, 180.0, 170.0, 110.0, 40.0, 70.0, 30.0, 100.0, 0.0, 200.0, 70.0, 120.0, 20.0, 130.0, 200.0, 50.0, 10.0, 5.0, 100.0, 10.0, 400.0, 100.0, 30.0, 90.0, 150.0, 10.0, 30.0, 30.0, 100.0, 390.0, 90.0, 350.0, 20.0, 200.0, 40.0, 330.0, 40.0, 140.0, 190.0, 380.0, 70.0, 420.0, 20.0, 30.0, 120.0, 40.0, 20.0, 70.0, 30.0, 640.0, 30.0, 140.0, 50.0, 10.0, 40.0, 400.0, 60.0, 90.0, 20.0, 80.0, 60.0, 20.0, -10.0, 340.0, 430.0, 180.0, 130.0, 100.0, 90.0, 340.0, 70.0, 390.0, 210.0, 10.0, 170.0, 180.0, 50.0, 30.0, 260.0, 20.0, 0.0, 160.0, 70.0, 0.0, 0.0, 40.0, 100.0, 30.0, 70.0, 20.0, 30.0, 80.0, 30.0, 170.0, 30.0, 50.0, 100.0, 170.0, -20.0, 170.0, 70.0, 350.0, 350.0, 40.0, 130.0, 70.0, 200.0, 90.0, 100.0, 520.0, 200.0, 60.0, 60.0, 60.0, 80.0, 710.0, 20.0, 60.0, 20.0, 40.0, 50.0, 280.0, 40.0, 140.0, -25.0, 0.0, 50.0, 320.0, 160.0, 160.0, 0.0, 30.0, 10.0, 0.0, 20.0, 10.0, 180.0, 60.0, 120.0, 100.0, 40.0, 100.0, 30.0, 40.0, 80.0, 30.0, 0.0, -90.0, 250.0, 210.0, 180.0, 10.0, 280.0, 50.0, 20.0, 50.0, 160.0, 200.0, 200.0, 30.0, 70.0, 420.0, -470.0, 70.0, 80.0, 50.0, 170.0, 10.0, 20.0, 10.0, 90.0, 10.0, 0.0, 0.0, 10.0, 60.0, 0.0, 40.0, 200.0, 50.0, 280.0, 60.0, 30.0, 300.0, 200.0, 50.0, 320.0, 10.0, 0.0, 10.0, 50.0, 0.0, 40.0, 30.0, 0.0, 10.0, 70.0, 20.0, 340.0, 50.0, 50.0, 20.0, 20.0, 10.0, 80.0, 370.0, 130.0, 40.0, 280.0, 30.0, 50.0, 100.0, 190.0, 40.0, 30.0, 40.0, 50.0, -50.0, 250.0, 340.0, 80.0, 260.0, 320.0, 20.0, 80.0, 10.0, 180.0, 65.0, 140.0, 80.0, 380.0, 60.0, 50.0, 190.0, 560.0, 100.0, 150.0, 90.0, 60.0, 80.0, 350.0, 90.0, 30.0, 190.0, 190.0, 90.0, 80.0, 120.0, 50.0, 520.0, 350.0, 10.0, -10.0, 10.0, 100.0, 30.0, 270.0, 20.0, 260.0, 70.0, 110.0, 520.0, 30.0, 60.0, 60.0, 30.0, 30.0, 110.0, -40.0, 220.0, 330.0, 220.0, 30.0, 230.0, 120.0, 125.0, 130.0, 100.0, 280.0, 40.0, 520.0, 100.0, 160.0, 50.0, 90.0, 40.0, 40.0, 0.0, 10.0, 100.0, 60.0, 770.0, 120.0, 120.0, 20.0, 220.0, 0.0, 50.0, 240.0, 40.0, 210.0, 40.0, 60.0, 300.0, 70.0, 40.0, 10.0, 90.0, 50.0, 0.0, 40.0, 50.0, 540.0, 140.0, 40.0, -10.0, 130.0, 240.0, 20.0, 50.0, -35.0, 190.0, 340.0, 290.0, 300.0, 20.0, 360.0, 10.0, 50.0, 30.0, 290.0, 10.0, 40.0, 20.0, 100.0, 90.0, 90.0, 40.0, 80.0, 30.0, 50.0, 20.0, 140.0, 550.0, 270.0, 50.0, 30.0, 170.0, 90.0, 480.0, 210.0, 30.0, 270.0, 360.0, 220.0, 290.0, -350.0, 0.0, 0.0, 0.0, 450.0, 50.0, 210.0, 40.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0407549327050147, "mean_inference_ms": 1.9794106525270223, "mean_action_processing_ms": 0.5409648174788247, "mean_env_wait_ms": 1.7479560917437929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012200117111206055, "StateBufferConnector_ms": 0.01020669937133789, "ViewRequirementAgentConnector_ms": 0.42020106315612793}, "num_episodes": 18, "episode_return_max": 2150.0, "episode_return_min": 170.0, "episode_return_mean": 1085.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 9.461619177935527, "num_env_steps_trained_throughput_per_sec": 9.461619177935527, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 936945.634, "restore_workers_time_ms": 0.013, "training_step_time_ms": 936945.572, "sample_time_ms": 3010.99, "learn_time_ms": 933909.575, "learn_throughput": 4.283, "synch_weights_time_ms": 12.913}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 68, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-21-07", "timestamp": 1717251667, "time_this_iter_s": 422.849858045578, "time_total_s": 42484.059284210205, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7f8670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 42484.059284210205, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 31.930340557275542, "ram_util_percent": 82.17120743034056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.390216276357476, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.839662513336815, "policy_loss": -0.007738971307425422, "vf_loss": 6.846660891889384, "vf_explained_var": 0.00042899392537288646, "kl": 0.007405986669722622, "entropy": 0.3308981348277408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 643215.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": 170.0, "episode_reward_mean": 1057.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -580.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 105.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [990.0, 1160.0, 860.0, 1495.0, 1480.0, 1510.0, 1440.0, 1450.0, 780.0, 420.0, 680.0, 930.0, 1200.0, 1410.0, 170.0, 1265.0, 740.0, 960.0, 830.0, 830.0, 910.0, 1020.0, 1540.0, 640.0, 820.0, 1240.0, 1615.0, 1060.0, 610.0, 920.0, 540.0, 1180.0, 420.0, 860.0, 245.0, 1020.0, 1280.0, 1390.0, 990.0, 740.0, 240.0, 1245.0, 290.0, 1610.0, 1230.0, 1240.0, 940.0, 945.0, 1260.0, 1740.0, 1070.0, 1490.0, 1690.0, 770.0, 600.0, 1410.0, 1440.0, 1335.0, 750.0, 760.0, 940.0, 810.0, 370.0, 1220.0, 510.0, 670.0, 1260.0, 1390.0, 1715.0, 1330.0, 1320.0, 1430.0, 1280.0, 1595.0, 1280.0, 1230.0, 1000.0, 1515.0, 930.0, 1360.0, 1910.0, 740.0, 890.0, 1240.0, 190.0, 490.0, 1265.0, 1595.0, 1035.0, 540.0, 1200.0, 1335.0, 500.0, 890.0, 1060.0, 890.0, 1650.0, 1430.0, 1150.0, 945.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 40.0, 140.0, 370.0, 130.0, 100.0, -90.0, 40.0, 180.0, 50.0, 20.0, 40.0, 10.0, -10.0, -10.0, 0.0, 940.0, 20.0, 110.0, 40.0, 400.0, 70.0, 10.0, 10.0, 40.0, 170.0, 10.0, 0.0, 40.0, 110.0, 180.0, 210.0, 405.0, 400.0, -30.0, 30.0, 60.0, 120.0, 30.0, 90.0, 250.0, 210.0, 40.0, 50.0, 60.0, 500.0, 130.0, 100.0, 120.0, 20.0, 220.0, 70.0, 580.0, 100.0, 110.0, 120.0, 180.0, 50.0, 30.0, 50.0, 310.0, 30.0, 160.0, 300.0, 100.0, 90.0, 30.0, 10.0, 280.0, 130.0, 390.0, 90.0, 140.0, 50.0, 390.0, 210.0, 20.0, 40.0, 60.0, 60.0, 160.0, 190.0, 20.0, 50.0, 70.0, 20.0, 0.0, 250.0, 20.0, 0.0, 210.0, 10.0, 50.0, 0.0, 10.0, 50.0, 0.0, 30.0, -20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 20.0, 10.0, 20.0, 80.0, 30.0, 370.0, 440.0, 30.0, 140.0, -580.0, 160.0, 60.0, 240.0, 100.0, 80.0, 260.0, 690.0, -50.0, 10.0, 30.0, 80.0, 270.0, 30.0, 30.0, -10.0, 120.0, 250.0, -10.0, 30.0, 30.0, 130.0, 100.0, 40.0, 50.0, 490.0, 300.0, 10.0, 10.0, 40.0, 0.0, 30.0, 20.0, 20.0, 0.0, 20.0, 20.0, 310.0, 15.0, 100.0, 300.0, 60.0, 30.0, 80.0, 60.0, 220.0, 90.0, 50.0, 100.0, 0.0, 20.0, 60.0, 0.0, 460.0, 0.0, 50.0, 0.0, 20.0, 80.0, 20.0, 40.0, 0.0, 40.0, 300.0, 40.0, 400.0, 20.0, 0.0, 230.0, 10.0, 50.0, 50.0, 70.0, 50.0, 180.0, 70.0, 120.0, 40.0, 190.0, 20.0, 210.0, 50.0, 120.0, 0.0, 0.0, 90.0, 110.0, 10.0, 100.0, 210.0, 80.0, 0.0, 60.0, 10.0, 20.0, 160.0, 260.0, 190.0, 10.0, -40.0, 50.0, 400.0, 40.0, 30.0, 40.0, 260.0, 40.0, 300.0, 40.0, 270.0, 40.0, 510.0, 80.0, 90.0, 10.0, 250.0, -50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 0.0, 190.0, 20.0, 290.0, 0.0, 40.0, 40.0, 40.0, 0.0, 70.0, 90.0, 80.0, 80.0, -30.0, 410.0, 80.0, 180.0, 40.0, 190.0, 40.0, 50.0, 80.0, 80.0, 90.0, 410.0, 175.0, 90.0, 60.0, 120.0, 20.0, 240.0, 40.0, 350.0, 390.0, 130.0, 60.0, 230.0, 230.0, 170.0, 270.0, 60.0, 30.0, 100.0, -110.0, 20.0, 160.0, 80.0, 40.0, 0.0, 0.0, 250.0, 40.0, 0.0, 30.0, 10.0, 490.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 140.0, 30.0, 0.0, 60.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 200.0, 0.0, 210.0, 420.0, 50.0, 200.0, 30.0, 40.0, 90.0, 20.0, 50.0, 200.0, 80.0, 130.0, 0.0, 30.0, 0.0, 70.0, 20.0, 120.0, 40.0, 0.0, 10.0, 80.0, 40.0, 70.0, 60.0, 10.0, 0.0, 20.0, 30.0, 180.0, 370.0, 0.0, 40.0, 20.0, 60.0, 40.0, 50.0, -5.0, 30.0, 0.0, 10.0, 310.0, 160.0, 170.0, 170.0, 140.0, 40.0, 40.0, 10.0, -20.0, 0.0, 170.0, 180.0, 70.0, 130.0, 380.0, 40.0, -50.0, 110.0, 20.0, 230.0, 20.0, 420.0, -30.0, 30.0, 30.0, 60.0, 180.0, 420.0, 30.0, 230.0, 70.0, 420.0, 80.0, 50.0, 10.0, 290.0, 10.0, 10.0, 30.0, 20.0, 20.0, 300.0, 40.0, -130.0, 80.0, 10.0, 360.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 150.0, 0.0, 30.0, 60.0, 40.0, 390.0, 15.0, 180.0, 70.0, 40.0, 310.0, 50.0, 90.0, 30.0, 40.0, 10.0, 70.0, 10.0, 0.0, 70.0, 10.0, 20.0, 30.0, 230.0, 270.0, 180.0, 60.0, 60.0, 450.0, 110.0, 200.0, 40.0, 10.0, 160.0, 10.0, 450.0, 90.0, 120.0, 100.0, 50.0, 60.0, 10.0, 180.0, 210.0, 170.0, 120.0, 70.0, 80.0, 90.0, 180.0, 170.0, 110.0, 40.0, 70.0, 30.0, 100.0, 0.0, 200.0, 70.0, 120.0, 20.0, 130.0, 200.0, 50.0, 10.0, 5.0, 100.0, 10.0, 400.0, 100.0, 30.0, 90.0, 150.0, 10.0, 30.0, 30.0, 100.0, 390.0, 90.0, 350.0, 20.0, 200.0, 40.0, 330.0, 40.0, 140.0, 190.0, 380.0, 70.0, 420.0, 20.0, 30.0, 120.0, 40.0, 20.0, 70.0, 30.0, 640.0, 30.0, 140.0, 50.0, 10.0, 40.0, 400.0, 60.0, 90.0, 20.0, 80.0, 60.0, 20.0, -10.0, 340.0, 430.0, 180.0, 130.0, 100.0, 90.0, 340.0, 70.0, 390.0, 210.0, 10.0, 170.0, 180.0, 50.0, 30.0, 260.0, 20.0, 0.0, 160.0, 70.0, 0.0, 0.0, 40.0, 100.0, 30.0, 70.0, 20.0, 30.0, 80.0, 30.0, 170.0, 30.0, 50.0, 100.0, 170.0, -20.0, 170.0, 70.0, 350.0, 350.0, 40.0, 130.0, 70.0, 200.0, 90.0, 100.0, 520.0, 200.0, 60.0, 60.0, 60.0, 80.0, 710.0, 20.0, 60.0, 20.0, 40.0, 50.0, 280.0, 40.0, 140.0, -25.0, 0.0, 50.0, 320.0, 160.0, 160.0, 0.0, 30.0, 10.0, 0.0, 20.0, 10.0, 180.0, 60.0, 120.0, 100.0, 40.0, 100.0, 30.0, 40.0, 80.0, 30.0, 0.0, -90.0, 250.0, 210.0, 180.0, 10.0, 280.0, 50.0, 20.0, 50.0, 160.0, 200.0, 200.0, 30.0, 70.0, 420.0, -470.0, 70.0, 80.0, 50.0, 170.0, 10.0, 20.0, 10.0, 90.0, 10.0, 0.0, 0.0, 10.0, 60.0, 0.0, 40.0, 200.0, 50.0, 280.0, 60.0, 30.0, 300.0, 200.0, 50.0, 320.0, 10.0, 0.0, 10.0, 50.0, 0.0, 40.0, 30.0, 0.0, 10.0, 70.0, 20.0, 340.0, 50.0, 50.0, 20.0, 20.0, 10.0, 80.0, 370.0, 130.0, 40.0, 280.0, 30.0, 50.0, 100.0, 190.0, 40.0, 30.0, 40.0, 50.0, -50.0, 250.0, 340.0, 80.0, 260.0, 320.0, 20.0, 80.0, 10.0, 180.0, 65.0, 140.0, 80.0, 380.0, 60.0, 50.0, 190.0, 560.0, 100.0, 150.0, 90.0, 60.0, 80.0, 350.0, 90.0, 30.0, 190.0, 190.0, 90.0, 80.0, 120.0, 50.0, 520.0, 350.0, 10.0, -10.0, 10.0, 100.0, 30.0, 270.0, 20.0, 260.0, 70.0, 110.0, 520.0, 30.0, 60.0, 60.0, 30.0, 30.0, 110.0, -40.0, 220.0, 330.0, 220.0, 30.0, 230.0, 120.0, 125.0, 130.0, 100.0, 280.0, 40.0, 520.0, 100.0, 160.0, 50.0, 90.0, 40.0, 40.0, 0.0, 10.0, 100.0, 60.0, 770.0, 120.0, 120.0, 20.0, 220.0, 0.0, 50.0, 240.0, 40.0, 210.0, 40.0, 60.0, 300.0, 70.0, 40.0, 10.0, 90.0, 50.0, 0.0, 40.0, 50.0, 540.0, 140.0, 40.0, -10.0, 130.0, 240.0, 20.0, 50.0, -35.0, 190.0, 340.0, 290.0, 300.0, 20.0, 360.0, 10.0, 50.0, 30.0, 290.0, 10.0, 40.0, 20.0, 100.0, 90.0, 90.0, 40.0, 80.0, 30.0, 50.0, 20.0, 140.0, 550.0, 270.0, 50.0, 30.0, 170.0, 90.0, 480.0, 210.0, 30.0, 270.0, 360.0, 220.0, 290.0, -350.0, 0.0, 0.0, 0.0, 450.0, 50.0, 210.0, 40.0, 50.0, 70.0, 160.0, 190.0, 140.0, 10.0, 10.0, 0.0, 20.0, 250.0, 40.0, 170.0, 100.0, 30.0, 80.0, 230.0, 150.0, 280.0, 10.0, 70.0, 120.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 70.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 140.0, 20.0, 50.0, 10.0, 190.0, 40.0, 120.0, 60.0, 160.0, 15.0, 200.0, 30.0, 580.0, 30.0, 30.0, 235.0, 60.0, 60.0, 70.0, 200.0, 550.0, 220.0, 110.0, 40.0, 50.0, 20.0, 450.0, 80.0, 40.0, 40.0, 260.0, -300.0, 70.0, 15.0, 360.0, 20.0, 10.0, 0.0, 250.0, 20.0, 50.0, 10.0, 120.0, 40.0, 20.0, 200.0, 60.0, 240.0, 60.0, 130.0, 90.0, 300.0, 100.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 40.0, 710.0, 100.0, 140.0, 150.0, 35.0, 20.0, 260.0, 40.0, 10.0, 20.0, 90.0, 0.0, 20.0, 10.0, 30.0, 210.0, 60.0, -65.0, 50.0, 30.0, 20.0, 420.0, -20.0, 180.0, 5.0, 300.0, 0.0, 90.0, 50.0, 170.0, 100.0, 130.0, 90.0, 90.0, 40.0, 60.0, 40.0, 70.0, 350.0, 70.0, 0.0, 120.0, 70.0, 110.0, 0.0, 160.0, 540.0, 50.0, 190.0, 250.0, 200.0, 50.0, 70.0, 30.0, 110.0, 60.0, 50.0, 380.0, 180.0, 240.0, 230.0, 90.0, 100.0, 80.0, 20.0, 80.0, 110.0, 20.0, 20.0, 100.0, 380.0, 40.0, 40.0, 40.0, 320.0, 40.0, 330.0, 40.0, 80.0, 20.0, 0.0, 310.0, 25.0, 70.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.038355118628618, "mean_inference_ms": 1.9791954967408893, "mean_action_processing_ms": 0.5402634657729571, "mean_env_wait_ms": 1.7458266102447657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02557063102722168, "StateBufferConnector_ms": 0.011963844299316406, "ViewRequirementAgentConnector_ms": 0.49712657928466797}, "num_episodes": 18, "episode_return_max": 1910.0, "episode_return_min": 170.0, "episode_return_mean": 1057.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.613037087709392, "num_env_steps_trained_throughput_per_sec": 14.613037087709392, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 2760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2760000, "timers": {"training_iteration_time_ms": 853845.323, "restore_workers_time_ms": 0.014, "training_step_time_ms": 853845.259, "sample_time_ms": 3393.27, "learn_time_ms": 850424.974, "learn_throughput": 4.704, "synch_weights_time_ms": 13.688}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "done": false, "training_iteration": 69, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-25-41", "timestamp": 1717251941, "time_this_iter_s": 273.7831201553345, "time_total_s": 42757.84240436554, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f87d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 42757.84240436554, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 49.51443298969072, "ram_util_percent": 83.1680412371134}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9928938884958545, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.298096267915509, "policy_loss": -0.006998444023429039, "vf_loss": 6.3043349376755655, "vf_explained_var": -1.451879009779015e-05, "kl": 0.0075976923100273324, "entropy": 0.34880901155824734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 652605.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": 150.0, "episode_reward_mean": 1039.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 970.0}, "policy_reward_mean": {"policy_0": 103.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [830.0, 830.0, 910.0, 1020.0, 1540.0, 640.0, 820.0, 1240.0, 1615.0, 1060.0, 610.0, 920.0, 540.0, 1180.0, 420.0, 860.0, 245.0, 1020.0, 1280.0, 1390.0, 990.0, 740.0, 240.0, 1245.0, 290.0, 1610.0, 1230.0, 1240.0, 940.0, 945.0, 1260.0, 1740.0, 1070.0, 1490.0, 1690.0, 770.0, 600.0, 1410.0, 1440.0, 1335.0, 750.0, 760.0, 940.0, 810.0, 370.0, 1220.0, 510.0, 670.0, 1260.0, 1390.0, 1715.0, 1330.0, 1320.0, 1430.0, 1280.0, 1595.0, 1280.0, 1230.0, 1000.0, 1515.0, 930.0, 1360.0, 1910.0, 740.0, 890.0, 1240.0, 190.0, 490.0, 1265.0, 1595.0, 1035.0, 540.0, 1200.0, 1335.0, 500.0, 890.0, 1060.0, 890.0, 1650.0, 1430.0, 1150.0, 945.0, 870.0, 150.0, 570.0, 1150.0, 770.0, 930.0, 1490.0, 900.0, 990.0, 460.0, 1515.0, 1260.0, 570.0, 900.0, 865.0, 1380.0, 1895.0, 450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 230.0, 10.0, 50.0, 50.0, 70.0, 50.0, 180.0, 70.0, 120.0, 40.0, 190.0, 20.0, 210.0, 50.0, 120.0, 0.0, 0.0, 90.0, 110.0, 10.0, 100.0, 210.0, 80.0, 0.0, 60.0, 10.0, 20.0, 160.0, 260.0, 190.0, 10.0, -40.0, 50.0, 400.0, 40.0, 30.0, 40.0, 260.0, 40.0, 300.0, 40.0, 270.0, 40.0, 510.0, 80.0, 90.0, 10.0, 250.0, -50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 0.0, 190.0, 20.0, 290.0, 0.0, 40.0, 40.0, 40.0, 0.0, 70.0, 90.0, 80.0, 80.0, -30.0, 410.0, 80.0, 180.0, 40.0, 190.0, 40.0, 50.0, 80.0, 80.0, 90.0, 410.0, 175.0, 90.0, 60.0, 120.0, 20.0, 240.0, 40.0, 350.0, 390.0, 130.0, 60.0, 230.0, 230.0, 170.0, 270.0, 60.0, 30.0, 100.0, -110.0, 20.0, 160.0, 80.0, 40.0, 0.0, 0.0, 250.0, 40.0, 0.0, 30.0, 10.0, 490.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 140.0, 30.0, 0.0, 60.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 200.0, 0.0, 210.0, 420.0, 50.0, 200.0, 30.0, 40.0, 90.0, 20.0, 50.0, 200.0, 80.0, 130.0, 0.0, 30.0, 0.0, 70.0, 20.0, 120.0, 40.0, 0.0, 10.0, 80.0, 40.0, 70.0, 60.0, 10.0, 0.0, 20.0, 30.0, 180.0, 370.0, 0.0, 40.0, 20.0, 60.0, 40.0, 50.0, -5.0, 30.0, 0.0, 10.0, 310.0, 160.0, 170.0, 170.0, 140.0, 40.0, 40.0, 10.0, -20.0, 0.0, 170.0, 180.0, 70.0, 130.0, 380.0, 40.0, -50.0, 110.0, 20.0, 230.0, 20.0, 420.0, -30.0, 30.0, 30.0, 60.0, 180.0, 420.0, 30.0, 230.0, 70.0, 420.0, 80.0, 50.0, 10.0, 290.0, 10.0, 10.0, 30.0, 20.0, 20.0, 300.0, 40.0, -130.0, 80.0, 10.0, 360.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 150.0, 0.0, 30.0, 60.0, 40.0, 390.0, 15.0, 180.0, 70.0, 40.0, 310.0, 50.0, 90.0, 30.0, 40.0, 10.0, 70.0, 10.0, 0.0, 70.0, 10.0, 20.0, 30.0, 230.0, 270.0, 180.0, 60.0, 60.0, 450.0, 110.0, 200.0, 40.0, 10.0, 160.0, 10.0, 450.0, 90.0, 120.0, 100.0, 50.0, 60.0, 10.0, 180.0, 210.0, 170.0, 120.0, 70.0, 80.0, 90.0, 180.0, 170.0, 110.0, 40.0, 70.0, 30.0, 100.0, 0.0, 200.0, 70.0, 120.0, 20.0, 130.0, 200.0, 50.0, 10.0, 5.0, 100.0, 10.0, 400.0, 100.0, 30.0, 90.0, 150.0, 10.0, 30.0, 30.0, 100.0, 390.0, 90.0, 350.0, 20.0, 200.0, 40.0, 330.0, 40.0, 140.0, 190.0, 380.0, 70.0, 420.0, 20.0, 30.0, 120.0, 40.0, 20.0, 70.0, 30.0, 640.0, 30.0, 140.0, 50.0, 10.0, 40.0, 400.0, 60.0, 90.0, 20.0, 80.0, 60.0, 20.0, -10.0, 340.0, 430.0, 180.0, 130.0, 100.0, 90.0, 340.0, 70.0, 390.0, 210.0, 10.0, 170.0, 180.0, 50.0, 30.0, 260.0, 20.0, 0.0, 160.0, 70.0, 0.0, 0.0, 40.0, 100.0, 30.0, 70.0, 20.0, 30.0, 80.0, 30.0, 170.0, 30.0, 50.0, 100.0, 170.0, -20.0, 170.0, 70.0, 350.0, 350.0, 40.0, 130.0, 70.0, 200.0, 90.0, 100.0, 520.0, 200.0, 60.0, 60.0, 60.0, 80.0, 710.0, 20.0, 60.0, 20.0, 40.0, 50.0, 280.0, 40.0, 140.0, -25.0, 0.0, 50.0, 320.0, 160.0, 160.0, 0.0, 30.0, 10.0, 0.0, 20.0, 10.0, 180.0, 60.0, 120.0, 100.0, 40.0, 100.0, 30.0, 40.0, 80.0, 30.0, 0.0, -90.0, 250.0, 210.0, 180.0, 10.0, 280.0, 50.0, 20.0, 50.0, 160.0, 200.0, 200.0, 30.0, 70.0, 420.0, -470.0, 70.0, 80.0, 50.0, 170.0, 10.0, 20.0, 10.0, 90.0, 10.0, 0.0, 0.0, 10.0, 60.0, 0.0, 40.0, 200.0, 50.0, 280.0, 60.0, 30.0, 300.0, 200.0, 50.0, 320.0, 10.0, 0.0, 10.0, 50.0, 0.0, 40.0, 30.0, 0.0, 10.0, 70.0, 20.0, 340.0, 50.0, 50.0, 20.0, 20.0, 10.0, 80.0, 370.0, 130.0, 40.0, 280.0, 30.0, 50.0, 100.0, 190.0, 40.0, 30.0, 40.0, 50.0, -50.0, 250.0, 340.0, 80.0, 260.0, 320.0, 20.0, 80.0, 10.0, 180.0, 65.0, 140.0, 80.0, 380.0, 60.0, 50.0, 190.0, 560.0, 100.0, 150.0, 90.0, 60.0, 80.0, 350.0, 90.0, 30.0, 190.0, 190.0, 90.0, 80.0, 120.0, 50.0, 520.0, 350.0, 10.0, -10.0, 10.0, 100.0, 30.0, 270.0, 20.0, 260.0, 70.0, 110.0, 520.0, 30.0, 60.0, 60.0, 30.0, 30.0, 110.0, -40.0, 220.0, 330.0, 220.0, 30.0, 230.0, 120.0, 125.0, 130.0, 100.0, 280.0, 40.0, 520.0, 100.0, 160.0, 50.0, 90.0, 40.0, 40.0, 0.0, 10.0, 100.0, 60.0, 770.0, 120.0, 120.0, 20.0, 220.0, 0.0, 50.0, 240.0, 40.0, 210.0, 40.0, 60.0, 300.0, 70.0, 40.0, 10.0, 90.0, 50.0, 0.0, 40.0, 50.0, 540.0, 140.0, 40.0, -10.0, 130.0, 240.0, 20.0, 50.0, -35.0, 190.0, 340.0, 290.0, 300.0, 20.0, 360.0, 10.0, 50.0, 30.0, 290.0, 10.0, 40.0, 20.0, 100.0, 90.0, 90.0, 40.0, 80.0, 30.0, 50.0, 20.0, 140.0, 550.0, 270.0, 50.0, 30.0, 170.0, 90.0, 480.0, 210.0, 30.0, 270.0, 360.0, 220.0, 290.0, -350.0, 0.0, 0.0, 0.0, 450.0, 50.0, 210.0, 40.0, 50.0, 70.0, 160.0, 190.0, 140.0, 10.0, 10.0, 0.0, 20.0, 250.0, 40.0, 170.0, 100.0, 30.0, 80.0, 230.0, 150.0, 280.0, 10.0, 70.0, 120.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 70.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 140.0, 20.0, 50.0, 10.0, 190.0, 40.0, 120.0, 60.0, 160.0, 15.0, 200.0, 30.0, 580.0, 30.0, 30.0, 235.0, 60.0, 60.0, 70.0, 200.0, 550.0, 220.0, 110.0, 40.0, 50.0, 20.0, 450.0, 80.0, 40.0, 40.0, 260.0, -300.0, 70.0, 15.0, 360.0, 20.0, 10.0, 0.0, 250.0, 20.0, 50.0, 10.0, 120.0, 40.0, 20.0, 200.0, 60.0, 240.0, 60.0, 130.0, 90.0, 300.0, 100.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 40.0, 710.0, 100.0, 140.0, 150.0, 35.0, 20.0, 260.0, 40.0, 10.0, 20.0, 90.0, 0.0, 20.0, 10.0, 30.0, 210.0, 60.0, -65.0, 50.0, 30.0, 20.0, 420.0, -20.0, 180.0, 5.0, 300.0, 0.0, 90.0, 50.0, 170.0, 100.0, 130.0, 90.0, 90.0, 40.0, 60.0, 40.0, 70.0, 350.0, 70.0, 0.0, 120.0, 70.0, 110.0, 0.0, 160.0, 540.0, 50.0, 190.0, 250.0, 200.0, 50.0, 70.0, 30.0, 110.0, 60.0, 50.0, 380.0, 180.0, 240.0, 230.0, 90.0, 100.0, 80.0, 20.0, 80.0, 110.0, 20.0, 20.0, 100.0, 380.0, 40.0, 40.0, 40.0, 320.0, 40.0, 330.0, 40.0, 80.0, 20.0, 0.0, 310.0, 25.0, 70.0, 30.0, 80.0, 50.0, 150.0, 20.0, 20.0, 70.0, 380.0, 40.0, 30.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 180.0, 0.0, 0.0, 50.0, 0.0, 50.0, 160.0, 50.0, 80.0, 0.0, 20.0, 40.0, 0.0, 20.0, 120.0, 310.0, 100.0, 40.0, 180.0, 320.0, 10.0, 40.0, 230.0, 40.0, 20.0, 10.0, 290.0, 30.0, 10.0, 90.0, 20.0, 70.0, 20.0, 200.0, 100.0, 20.0, 60.0, 370.0, 50.0, 20.0, 970.0, 40.0, 20.0, -10.0, 210.0, 70.0, 120.0, 20.0, 40.0, 10.0, 30.0, 60.0, 290.0, 30.0, 30.0, 20.0, 160.0, 0.0, 240.0, 40.0, 20.0, 170.0, 120.0, 20.0, 100.0, 0.0, 170.0, 320.0, 40.0, 30.0, 0.0, 230.0, 20.0, 0.0, 20.0, 10.0, 50.0, 100.0, 10.0, 20.0, 120.0, 510.0, 180.0, 170.0, 160.0, 70.0, 240.0, 50.0, 30.0, -15.0, 30.0, 20.0, 410.0, 20.0, 20.0, 450.0, 10.0, 270.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 200.0, 10.0, 280.0, 80.0, 20.0, 20.0, 80.0, 20.0, 170.0, 170.0, 30.0, 30.0, -170.0, 70.0, 70.0, 30.0, 260.0, 145.0, 20.0, 140.0, 90.0, 210.0, 85.0, 580.0, 80.0, 50.0, -10.0, -10.0, 45.0, 60.0, 280.0, 220.0, 30.0, 90.0, 60.0, 500.0, 420.0, 220.0, 530.0, 25.0, 40.0, -20.0, 160.0, 0.0, 40.0, 30.0, 20.0, 20.0, 170.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0386263882372497, "mean_inference_ms": 1.9824579948433358, "mean_action_processing_ms": 0.5403893843178933, "mean_env_wait_ms": 1.74596860025694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02637195587158203, "StateBufferConnector_ms": 0.012804031372070312, "ViewRequirementAgentConnector_ms": 0.549748420715332}, "num_episodes": 18, "episode_return_max": 1910.0, "episode_return_min": 150.0, "episode_return_mean": 1039.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.211365021109444, "num_env_steps_trained_throughput_per_sec": 15.211365021109444, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 687259.31, "restore_workers_time_ms": 0.013, "training_step_time_ms": 687259.247, "sample_time_ms": 3693.873, "learn_time_ms": 683538.745, "learn_throughput": 5.852, "synch_weights_time_ms": 13.689}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 70, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-30-04", "timestamp": 1717252204, "time_this_iter_s": 263.00363183021545, "time_total_s": 43020.846036195755, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f84f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 43020.846036195755, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 43.14704301075269, "ram_util_percent": 82.59731182795699}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.288124168947482, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.503357736041116, "policy_loss": -0.007060196240882849, "vf_loss": 6.509652582448893, "vf_explained_var": 0.0007543910298738489, "kl": 0.007653551567719841, "entropy": 0.34430484455455734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 661995.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": 20.0, "episode_reward_mean": 1061.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 970.0}, "policy_reward_mean": {"policy_0": 106.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [240.0, 1245.0, 290.0, 1610.0, 1230.0, 1240.0, 940.0, 945.0, 1260.0, 1740.0, 1070.0, 1490.0, 1690.0, 770.0, 600.0, 1410.0, 1440.0, 1335.0, 750.0, 760.0, 940.0, 810.0, 370.0, 1220.0, 510.0, 670.0, 1260.0, 1390.0, 1715.0, 1330.0, 1320.0, 1430.0, 1280.0, 1595.0, 1280.0, 1230.0, 1000.0, 1515.0, 930.0, 1360.0, 1910.0, 740.0, 890.0, 1240.0, 190.0, 490.0, 1265.0, 1595.0, 1035.0, 540.0, 1200.0, 1335.0, 500.0, 890.0, 1060.0, 890.0, 1650.0, 1430.0, 1150.0, 945.0, 870.0, 150.0, 570.0, 1150.0, 770.0, 930.0, 1490.0, 900.0, 990.0, 460.0, 1515.0, 1260.0, 570.0, 900.0, 865.0, 1380.0, 1895.0, 450.0, 1000.0, 500.0, 1310.0, 1635.0, 1150.0, 1280.0, 960.0, 1610.0, 495.0, 890.0, 1115.0, 790.0, 20.0, 800.0, 1420.0, 575.0, 1640.0, 470.0, 1390.0, 1110.0, 1030.0, 1650.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 150.0, 0.0, 30.0, 60.0, 40.0, 390.0, 15.0, 180.0, 70.0, 40.0, 310.0, 50.0, 90.0, 30.0, 40.0, 10.0, 70.0, 10.0, 0.0, 70.0, 10.0, 20.0, 30.0, 230.0, 270.0, 180.0, 60.0, 60.0, 450.0, 110.0, 200.0, 40.0, 10.0, 160.0, 10.0, 450.0, 90.0, 120.0, 100.0, 50.0, 60.0, 10.0, 180.0, 210.0, 170.0, 120.0, 70.0, 80.0, 90.0, 180.0, 170.0, 110.0, 40.0, 70.0, 30.0, 100.0, 0.0, 200.0, 70.0, 120.0, 20.0, 130.0, 200.0, 50.0, 10.0, 5.0, 100.0, 10.0, 400.0, 100.0, 30.0, 90.0, 150.0, 10.0, 30.0, 30.0, 100.0, 390.0, 90.0, 350.0, 20.0, 200.0, 40.0, 330.0, 40.0, 140.0, 190.0, 380.0, 70.0, 420.0, 20.0, 30.0, 120.0, 40.0, 20.0, 70.0, 30.0, 640.0, 30.0, 140.0, 50.0, 10.0, 40.0, 400.0, 60.0, 90.0, 20.0, 80.0, 60.0, 20.0, -10.0, 340.0, 430.0, 180.0, 130.0, 100.0, 90.0, 340.0, 70.0, 390.0, 210.0, 10.0, 170.0, 180.0, 50.0, 30.0, 260.0, 20.0, 0.0, 160.0, 70.0, 0.0, 0.0, 40.0, 100.0, 30.0, 70.0, 20.0, 30.0, 80.0, 30.0, 170.0, 30.0, 50.0, 100.0, 170.0, -20.0, 170.0, 70.0, 350.0, 350.0, 40.0, 130.0, 70.0, 200.0, 90.0, 100.0, 520.0, 200.0, 60.0, 60.0, 60.0, 80.0, 710.0, 20.0, 60.0, 20.0, 40.0, 50.0, 280.0, 40.0, 140.0, -25.0, 0.0, 50.0, 320.0, 160.0, 160.0, 0.0, 30.0, 10.0, 0.0, 20.0, 10.0, 180.0, 60.0, 120.0, 100.0, 40.0, 100.0, 30.0, 40.0, 80.0, 30.0, 0.0, -90.0, 250.0, 210.0, 180.0, 10.0, 280.0, 50.0, 20.0, 50.0, 160.0, 200.0, 200.0, 30.0, 70.0, 420.0, -470.0, 70.0, 80.0, 50.0, 170.0, 10.0, 20.0, 10.0, 90.0, 10.0, 0.0, 0.0, 10.0, 60.0, 0.0, 40.0, 200.0, 50.0, 280.0, 60.0, 30.0, 300.0, 200.0, 50.0, 320.0, 10.0, 0.0, 10.0, 50.0, 0.0, 40.0, 30.0, 0.0, 10.0, 70.0, 20.0, 340.0, 50.0, 50.0, 20.0, 20.0, 10.0, 80.0, 370.0, 130.0, 40.0, 280.0, 30.0, 50.0, 100.0, 190.0, 40.0, 30.0, 40.0, 50.0, -50.0, 250.0, 340.0, 80.0, 260.0, 320.0, 20.0, 80.0, 10.0, 180.0, 65.0, 140.0, 80.0, 380.0, 60.0, 50.0, 190.0, 560.0, 100.0, 150.0, 90.0, 60.0, 80.0, 350.0, 90.0, 30.0, 190.0, 190.0, 90.0, 80.0, 120.0, 50.0, 520.0, 350.0, 10.0, -10.0, 10.0, 100.0, 30.0, 270.0, 20.0, 260.0, 70.0, 110.0, 520.0, 30.0, 60.0, 60.0, 30.0, 30.0, 110.0, -40.0, 220.0, 330.0, 220.0, 30.0, 230.0, 120.0, 125.0, 130.0, 100.0, 280.0, 40.0, 520.0, 100.0, 160.0, 50.0, 90.0, 40.0, 40.0, 0.0, 10.0, 100.0, 60.0, 770.0, 120.0, 120.0, 20.0, 220.0, 0.0, 50.0, 240.0, 40.0, 210.0, 40.0, 60.0, 300.0, 70.0, 40.0, 10.0, 90.0, 50.0, 0.0, 40.0, 50.0, 540.0, 140.0, 40.0, -10.0, 130.0, 240.0, 20.0, 50.0, -35.0, 190.0, 340.0, 290.0, 300.0, 20.0, 360.0, 10.0, 50.0, 30.0, 290.0, 10.0, 40.0, 20.0, 100.0, 90.0, 90.0, 40.0, 80.0, 30.0, 50.0, 20.0, 140.0, 550.0, 270.0, 50.0, 30.0, 170.0, 90.0, 480.0, 210.0, 30.0, 270.0, 360.0, 220.0, 290.0, -350.0, 0.0, 0.0, 0.0, 450.0, 50.0, 210.0, 40.0, 50.0, 70.0, 160.0, 190.0, 140.0, 10.0, 10.0, 0.0, 20.0, 250.0, 40.0, 170.0, 100.0, 30.0, 80.0, 230.0, 150.0, 280.0, 10.0, 70.0, 120.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 70.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 140.0, 20.0, 50.0, 10.0, 190.0, 40.0, 120.0, 60.0, 160.0, 15.0, 200.0, 30.0, 580.0, 30.0, 30.0, 235.0, 60.0, 60.0, 70.0, 200.0, 550.0, 220.0, 110.0, 40.0, 50.0, 20.0, 450.0, 80.0, 40.0, 40.0, 260.0, -300.0, 70.0, 15.0, 360.0, 20.0, 10.0, 0.0, 250.0, 20.0, 50.0, 10.0, 120.0, 40.0, 20.0, 200.0, 60.0, 240.0, 60.0, 130.0, 90.0, 300.0, 100.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 40.0, 710.0, 100.0, 140.0, 150.0, 35.0, 20.0, 260.0, 40.0, 10.0, 20.0, 90.0, 0.0, 20.0, 10.0, 30.0, 210.0, 60.0, -65.0, 50.0, 30.0, 20.0, 420.0, -20.0, 180.0, 5.0, 300.0, 0.0, 90.0, 50.0, 170.0, 100.0, 130.0, 90.0, 90.0, 40.0, 60.0, 40.0, 70.0, 350.0, 70.0, 0.0, 120.0, 70.0, 110.0, 0.0, 160.0, 540.0, 50.0, 190.0, 250.0, 200.0, 50.0, 70.0, 30.0, 110.0, 60.0, 50.0, 380.0, 180.0, 240.0, 230.0, 90.0, 100.0, 80.0, 20.0, 80.0, 110.0, 20.0, 20.0, 100.0, 380.0, 40.0, 40.0, 40.0, 320.0, 40.0, 330.0, 40.0, 80.0, 20.0, 0.0, 310.0, 25.0, 70.0, 30.0, 80.0, 50.0, 150.0, 20.0, 20.0, 70.0, 380.0, 40.0, 30.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 180.0, 0.0, 0.0, 50.0, 0.0, 50.0, 160.0, 50.0, 80.0, 0.0, 20.0, 40.0, 0.0, 20.0, 120.0, 310.0, 100.0, 40.0, 180.0, 320.0, 10.0, 40.0, 230.0, 40.0, 20.0, 10.0, 290.0, 30.0, 10.0, 90.0, 20.0, 70.0, 20.0, 200.0, 100.0, 20.0, 60.0, 370.0, 50.0, 20.0, 970.0, 40.0, 20.0, -10.0, 210.0, 70.0, 120.0, 20.0, 40.0, 10.0, 30.0, 60.0, 290.0, 30.0, 30.0, 20.0, 160.0, 0.0, 240.0, 40.0, 20.0, 170.0, 120.0, 20.0, 100.0, 0.0, 170.0, 320.0, 40.0, 30.0, 0.0, 230.0, 20.0, 0.0, 20.0, 10.0, 50.0, 100.0, 10.0, 20.0, 120.0, 510.0, 180.0, 170.0, 160.0, 70.0, 240.0, 50.0, 30.0, -15.0, 30.0, 20.0, 410.0, 20.0, 20.0, 450.0, 10.0, 270.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 200.0, 10.0, 280.0, 80.0, 20.0, 20.0, 80.0, 20.0, 170.0, 170.0, 30.0, 30.0, -170.0, 70.0, 70.0, 30.0, 260.0, 145.0, 20.0, 140.0, 90.0, 210.0, 85.0, 580.0, 80.0, 50.0, -10.0, -10.0, 45.0, 60.0, 280.0, 220.0, 30.0, 90.0, 60.0, 500.0, 420.0, 220.0, 530.0, 25.0, 40.0, -20.0, 160.0, 0.0, 40.0, 30.0, 20.0, 20.0, 170.0, 0.0, 0.0, 10.0, 10.0, -40.0, 180.0, 20.0, 40.0, 160.0, 40.0, 50.0, 230.0, 310.0, 10.0, 10.0, 0.0, 490.0, -30.0, 80.0, 30.0, 20.0, 40.0, -150.0, 30.0, 30.0, 460.0, 110.0, 110.0, 30.0, 20.0, 150.0, 230.0, 140.0, 30.0, 170.0, 330.0, 430.0, 10.0, 120.0, 50.0, 260.0, 180.0, 55.0, 170.0, 50.0, 140.0, 300.0, 90.0, 220.0, 0.0, 140.0, 220.0, -180.0, 50.0, 60.0, 200.0, 60.0, 110.0, 160.0, 110.0, 350.0, 120.0, 60.0, 40.0, 170.0, 40.0, 20.0, 20.0, 0.0, 120.0, 460.0, 10.0, 80.0, 610.0, 70.0, 20.0, 0.0, 170.0, -80.0, 0.0, 60.0, 200.0, 560.0, -5.0, 40.0, 110.0, 20.0, 20.0, 30.0, 10.0, 20.0, 10.0, 240.0, 60.0, 80.0, 10.0, 90.0, 170.0, 260.0, 10.0, 80.0, 90.0, 40.0, 50.0, 40.0, 610.0, 80.0, 220.0, 90.0, 0.0, -15.0, 20.0, 20.0, 230.0, 260.0, 110.0, 0.0, 20.0, 30.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 50.0, 250.0, 0.0, 450.0, 30.0, 0.0, -40.0, 40.0, 20.0, 80.0, 380.0, -10.0, 80.0, 140.0, 260.0, 20.0, 40.0, 410.0, 90.0, 0.0, 30.0, 10.0, 170.0, 40.0, -30.0, -5.0, 260.0, 10.0, 190.0, 20.0, 15.0, 200.0, 600.0, 240.0, 180.0, 60.0, 95.0, 40.0, 80.0, 20.0, 70.0, 0.0, 70.0, 70.0, 30.0, 90.0, 0.0, 40.0, 30.0, 60.0, 0.0, 110.0, 210.0, 90.0, 50.0, 280.0, 310.0, 250.0, 170.0, 30.0, 190.0, 20.0, 20.0, 30.0, 40.0, 500.0, 100.0, 10.0, 370.0, 100.0, 10.0, 10.0, 20.0, 210.0, 60.0, 90.0, 80.0, 80.0, 100.0, 40.0, 380.0, 60.0, 130.0, 160.0, 350.0, 30.0, 220.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0424628191089176, "mean_inference_ms": 1.9916633588949293, "mean_action_processing_ms": 0.5417530351874721, "mean_env_wait_ms": 1.749452225283207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027864456176757812, "StateBufferConnector_ms": 0.013720035552978516, "ViewRequirementAgentConnector_ms": 0.5931944847106934}, "num_episodes": 22, "episode_return_max": 1910.0, "episode_return_min": 20.0, "episode_return_mean": 1061.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.843217755137003, "num_env_steps_trained_throughput_per_sec": 14.843217755137003, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 2840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2840000, "timers": {"training_iteration_time_ms": 646613.7, "restore_workers_time_ms": 0.013, "training_step_time_ms": 646613.635, "sample_time_ms": 3831.402, "learn_time_ms": 642754.016, "learn_throughput": 6.223, "synch_weights_time_ms": 13.691}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "done": false, "training_iteration": 71, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-34-34", "timestamp": 1717252474, "time_this_iter_s": 269.5360131263733, "time_total_s": 43290.38204932213, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x322757af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 43290.38204932213, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 45.546052631578945, "ram_util_percent": 82.45552631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4072315429219295, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.953513392904442, "policy_loss": -0.0077754942990127356, "vf_loss": 6.960550031672144, "vf_explained_var": 0.0008270221840713225, "kl": 0.007388595758433127, "entropy": 0.33023012186201234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 671385.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 2050.0, "episode_reward_min": 20.0, "episode_reward_mean": 1081.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 970.0}, "policy_reward_mean": {"policy_0": 108.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.0, 510.0, 670.0, 1260.0, 1390.0, 1715.0, 1330.0, 1320.0, 1430.0, 1280.0, 1595.0, 1280.0, 1230.0, 1000.0, 1515.0, 930.0, 1360.0, 1910.0, 740.0, 890.0, 1240.0, 190.0, 490.0, 1265.0, 1595.0, 1035.0, 540.0, 1200.0, 1335.0, 500.0, 890.0, 1060.0, 890.0, 1650.0, 1430.0, 1150.0, 945.0, 870.0, 150.0, 570.0, 1150.0, 770.0, 930.0, 1490.0, 900.0, 990.0, 460.0, 1515.0, 1260.0, 570.0, 900.0, 865.0, 1380.0, 1895.0, 450.0, 1000.0, 500.0, 1310.0, 1635.0, 1150.0, 1280.0, 960.0, 1610.0, 495.0, 890.0, 1115.0, 790.0, 20.0, 800.0, 1420.0, 575.0, 1640.0, 470.0, 1390.0, 1110.0, 1030.0, 1650.0, 1030.0, 1830.0, 385.0, 1210.0, 570.0, 1130.0, 790.0, 1060.0, 1240.0, 1595.0, 1200.0, 170.0, 720.0, 960.0, 930.0, 1320.0, 1320.0, 1430.0, 1140.0, 2050.0, 1560.0, 1110.0, 1480.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 0.0, 40.0, 200.0, 50.0, 280.0, 60.0, 30.0, 300.0, 200.0, 50.0, 320.0, 10.0, 0.0, 10.0, 50.0, 0.0, 40.0, 30.0, 0.0, 10.0, 70.0, 20.0, 340.0, 50.0, 50.0, 20.0, 20.0, 10.0, 80.0, 370.0, 130.0, 40.0, 280.0, 30.0, 50.0, 100.0, 190.0, 40.0, 30.0, 40.0, 50.0, -50.0, 250.0, 340.0, 80.0, 260.0, 320.0, 20.0, 80.0, 10.0, 180.0, 65.0, 140.0, 80.0, 380.0, 60.0, 50.0, 190.0, 560.0, 100.0, 150.0, 90.0, 60.0, 80.0, 350.0, 90.0, 30.0, 190.0, 190.0, 90.0, 80.0, 120.0, 50.0, 520.0, 350.0, 10.0, -10.0, 10.0, 100.0, 30.0, 270.0, 20.0, 260.0, 70.0, 110.0, 520.0, 30.0, 60.0, 60.0, 30.0, 30.0, 110.0, -40.0, 220.0, 330.0, 220.0, 30.0, 230.0, 120.0, 125.0, 130.0, 100.0, 280.0, 40.0, 520.0, 100.0, 160.0, 50.0, 90.0, 40.0, 40.0, 0.0, 10.0, 100.0, 60.0, 770.0, 120.0, 120.0, 20.0, 220.0, 0.0, 50.0, 240.0, 40.0, 210.0, 40.0, 60.0, 300.0, 70.0, 40.0, 10.0, 90.0, 50.0, 0.0, 40.0, 50.0, 540.0, 140.0, 40.0, -10.0, 130.0, 240.0, 20.0, 50.0, -35.0, 190.0, 340.0, 290.0, 300.0, 20.0, 360.0, 10.0, 50.0, 30.0, 290.0, 10.0, 40.0, 20.0, 100.0, 90.0, 90.0, 40.0, 80.0, 30.0, 50.0, 20.0, 140.0, 550.0, 270.0, 50.0, 30.0, 170.0, 90.0, 480.0, 210.0, 30.0, 270.0, 360.0, 220.0, 290.0, -350.0, 0.0, 0.0, 0.0, 450.0, 50.0, 210.0, 40.0, 50.0, 70.0, 160.0, 190.0, 140.0, 10.0, 10.0, 0.0, 20.0, 250.0, 40.0, 170.0, 100.0, 30.0, 80.0, 230.0, 150.0, 280.0, 10.0, 70.0, 120.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 70.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 140.0, 20.0, 50.0, 10.0, 190.0, 40.0, 120.0, 60.0, 160.0, 15.0, 200.0, 30.0, 580.0, 30.0, 30.0, 235.0, 60.0, 60.0, 70.0, 200.0, 550.0, 220.0, 110.0, 40.0, 50.0, 20.0, 450.0, 80.0, 40.0, 40.0, 260.0, -300.0, 70.0, 15.0, 360.0, 20.0, 10.0, 0.0, 250.0, 20.0, 50.0, 10.0, 120.0, 40.0, 20.0, 200.0, 60.0, 240.0, 60.0, 130.0, 90.0, 300.0, 100.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 40.0, 710.0, 100.0, 140.0, 150.0, 35.0, 20.0, 260.0, 40.0, 10.0, 20.0, 90.0, 0.0, 20.0, 10.0, 30.0, 210.0, 60.0, -65.0, 50.0, 30.0, 20.0, 420.0, -20.0, 180.0, 5.0, 300.0, 0.0, 90.0, 50.0, 170.0, 100.0, 130.0, 90.0, 90.0, 40.0, 60.0, 40.0, 70.0, 350.0, 70.0, 0.0, 120.0, 70.0, 110.0, 0.0, 160.0, 540.0, 50.0, 190.0, 250.0, 200.0, 50.0, 70.0, 30.0, 110.0, 60.0, 50.0, 380.0, 180.0, 240.0, 230.0, 90.0, 100.0, 80.0, 20.0, 80.0, 110.0, 20.0, 20.0, 100.0, 380.0, 40.0, 40.0, 40.0, 320.0, 40.0, 330.0, 40.0, 80.0, 20.0, 0.0, 310.0, 25.0, 70.0, 30.0, 80.0, 50.0, 150.0, 20.0, 20.0, 70.0, 380.0, 40.0, 30.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 180.0, 0.0, 0.0, 50.0, 0.0, 50.0, 160.0, 50.0, 80.0, 0.0, 20.0, 40.0, 0.0, 20.0, 120.0, 310.0, 100.0, 40.0, 180.0, 320.0, 10.0, 40.0, 230.0, 40.0, 20.0, 10.0, 290.0, 30.0, 10.0, 90.0, 20.0, 70.0, 20.0, 200.0, 100.0, 20.0, 60.0, 370.0, 50.0, 20.0, 970.0, 40.0, 20.0, -10.0, 210.0, 70.0, 120.0, 20.0, 40.0, 10.0, 30.0, 60.0, 290.0, 30.0, 30.0, 20.0, 160.0, 0.0, 240.0, 40.0, 20.0, 170.0, 120.0, 20.0, 100.0, 0.0, 170.0, 320.0, 40.0, 30.0, 0.0, 230.0, 20.0, 0.0, 20.0, 10.0, 50.0, 100.0, 10.0, 20.0, 120.0, 510.0, 180.0, 170.0, 160.0, 70.0, 240.0, 50.0, 30.0, -15.0, 30.0, 20.0, 410.0, 20.0, 20.0, 450.0, 10.0, 270.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 200.0, 10.0, 280.0, 80.0, 20.0, 20.0, 80.0, 20.0, 170.0, 170.0, 30.0, 30.0, -170.0, 70.0, 70.0, 30.0, 260.0, 145.0, 20.0, 140.0, 90.0, 210.0, 85.0, 580.0, 80.0, 50.0, -10.0, -10.0, 45.0, 60.0, 280.0, 220.0, 30.0, 90.0, 60.0, 500.0, 420.0, 220.0, 530.0, 25.0, 40.0, -20.0, 160.0, 0.0, 40.0, 30.0, 20.0, 20.0, 170.0, 0.0, 0.0, 10.0, 10.0, -40.0, 180.0, 20.0, 40.0, 160.0, 40.0, 50.0, 230.0, 310.0, 10.0, 10.0, 0.0, 490.0, -30.0, 80.0, 30.0, 20.0, 40.0, -150.0, 30.0, 30.0, 460.0, 110.0, 110.0, 30.0, 20.0, 150.0, 230.0, 140.0, 30.0, 170.0, 330.0, 430.0, 10.0, 120.0, 50.0, 260.0, 180.0, 55.0, 170.0, 50.0, 140.0, 300.0, 90.0, 220.0, 0.0, 140.0, 220.0, -180.0, 50.0, 60.0, 200.0, 60.0, 110.0, 160.0, 110.0, 350.0, 120.0, 60.0, 40.0, 170.0, 40.0, 20.0, 20.0, 0.0, 120.0, 460.0, 10.0, 80.0, 610.0, 70.0, 20.0, 0.0, 170.0, -80.0, 0.0, 60.0, 200.0, 560.0, -5.0, 40.0, 110.0, 20.0, 20.0, 30.0, 10.0, 20.0, 10.0, 240.0, 60.0, 80.0, 10.0, 90.0, 170.0, 260.0, 10.0, 80.0, 90.0, 40.0, 50.0, 40.0, 610.0, 80.0, 220.0, 90.0, 0.0, -15.0, 20.0, 20.0, 230.0, 260.0, 110.0, 0.0, 20.0, 30.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 50.0, 250.0, 0.0, 450.0, 30.0, 0.0, -40.0, 40.0, 20.0, 80.0, 380.0, -10.0, 80.0, 140.0, 260.0, 20.0, 40.0, 410.0, 90.0, 0.0, 30.0, 10.0, 170.0, 40.0, -30.0, -5.0, 260.0, 10.0, 190.0, 20.0, 15.0, 200.0, 600.0, 240.0, 180.0, 60.0, 95.0, 40.0, 80.0, 20.0, 70.0, 0.0, 70.0, 70.0, 30.0, 90.0, 0.0, 40.0, 30.0, 60.0, 0.0, 110.0, 210.0, 90.0, 50.0, 280.0, 310.0, 250.0, 170.0, 30.0, 190.0, 20.0, 20.0, 30.0, 40.0, 500.0, 100.0, 10.0, 370.0, 100.0, 10.0, 10.0, 20.0, 210.0, 60.0, 90.0, 80.0, 80.0, 100.0, 40.0, 380.0, 60.0, 130.0, 160.0, 350.0, 30.0, 220.0, 180.0, 50.0, 10.0, 370.0, -30.0, 60.0, 20.0, -30.0, 290.0, 270.0, 20.0, 560.0, 40.0, 40.0, 170.0, 190.0, 290.0, 80.0, 20.0, 200.0, 240.0, 20.0, 30.0, 40.0, -5.0, 0.0, 40.0, 0.0, 50.0, 0.0, 210.0, 100.0, 30.0, -20.0, 60.0, 410.0, 0.0, 260.0, 90.0, 180.0, 100.0, 10.0, 190.0, 30.0, 40.0, 40.0, 0.0, 0.0, 20.0, 170.0, 70.0, 10.0, 0.0, 50.0, 120.0, 20.0, 0.0, 10.0, 80.0, 590.0, 250.0, 20.0, 80.0, 10.0, 570.0, -10.0, 50.0, 30.0, 40.0, 0.0, 0.0, 90.0, 10.0, 110.0, 350.0, 220.0, 70.0, 80.0, 80.0, -270.0, 320.0, 60.0, 20.0, 390.0, 20.0, 10.0, 400.0, 220.0, 50.0, 20.0, 50.0, 80.0, 360.0, 85.0, 120.0, 160.0, 170.0, 280.0, 20.0, 230.0, 90.0, 20.0, -30.0, 50.0, 40.0, 30.0, 480.0, 370.0, 0.0, 170.0, 70.0, 70.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 220.0, 100.0, 120.0, 0.0, 10.0, 160.0, 40.0, 60.0, 0.0, 50.0, 210.0, -10.0, 340.0, 20.0, 10.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 40.0, 0.0, 190.0, 200.0, 30.0, 20.0, 10.0, 250.0, 70.0, 320.0, 90.0, 10.0, -40.0, 350.0, 20.0, 240.0, 80.0, 180.0, 160.0, 110.0, 50.0, 270.0, 50.0, 10.0, 90.0, 40.0, 430.0, 110.0, 30.0, 230.0, 150.0, 10.0, 580.0, 0.0, -10.0, 120.0, 220.0, 100.0, 50.0, 110.0, 310.0, 50.0, 20.0, 60.0, 150.0, 390.0, 20.0, -20.0, 260.0, 540.0, 50.0, -10.0, 300.0, 250.0, 580.0, 60.0, -30.0, 50.0, 130.0, 180.0, 180.0, 80.0, -20.0, 20.0, 430.0, 400.0, 80.0, 80.0, 430.0, 170.0, 50.0, 10.0, 50.0, 50.0, -60.0, 10.0, 290.0, 110.0, 40.0, 10.0, 30.0, 40.0, 20.0, 600.0, 110.0, 90.0, 80.0, 460.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.050235584735727, "mean_inference_ms": 2.004797694862485, "mean_action_processing_ms": 0.5440395045717945, "mean_env_wait_ms": 1.7561540345982438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03109574317932129, "StateBufferConnector_ms": 0.014425992965698242, "ViewRequirementAgentConnector_ms": 0.6162290573120117}, "num_episodes": 23, "episode_return_max": 2050.0, "episode_return_min": 20.0, "episode_return_mean": 1081.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.507947248624198, "num_env_steps_trained_throughput_per_sec": 14.507947248624198, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 473870.248, "restore_workers_time_ms": 0.014, "training_step_time_ms": 473870.187, "sample_time_ms": 3981.239, "learn_time_ms": 469860.611, "learn_throughput": 8.513, "synch_weights_time_ms": 13.707}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 72, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-39-10", "timestamp": 1717252750, "time_this_iter_s": 275.7834210395813, "time_total_s": 43566.16547036171, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321bf6af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 43566.16547036171, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 47.62051282051282, "ram_util_percent": 82.46846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3058706256274344, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.273970766849538, "policy_loss": -0.007062755384595511, "vf_loss": 7.280321940827293, "vf_explained_var": 0.0006756288619341053, "kl": 0.007115771127625578, "entropy": 0.3148574989903976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 680775.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "env_runners": {"episode_reward_max": 2050.0, "episode_reward_min": 20.0, "episode_reward_mean": 1074.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 970.0}, "policy_reward_mean": {"policy_0": 107.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [740.0, 890.0, 1240.0, 190.0, 490.0, 1265.0, 1595.0, 1035.0, 540.0, 1200.0, 1335.0, 500.0, 890.0, 1060.0, 890.0, 1650.0, 1430.0, 1150.0, 945.0, 870.0, 150.0, 570.0, 1150.0, 770.0, 930.0, 1490.0, 900.0, 990.0, 460.0, 1515.0, 1260.0, 570.0, 900.0, 865.0, 1380.0, 1895.0, 450.0, 1000.0, 500.0, 1310.0, 1635.0, 1150.0, 1280.0, 960.0, 1610.0, 495.0, 890.0, 1115.0, 790.0, 20.0, 800.0, 1420.0, 575.0, 1640.0, 470.0, 1390.0, 1110.0, 1030.0, 1650.0, 1030.0, 1830.0, 385.0, 1210.0, 570.0, 1130.0, 790.0, 1060.0, 1240.0, 1595.0, 1200.0, 170.0, 720.0, 960.0, 930.0, 1320.0, 1320.0, 1430.0, 1140.0, 2050.0, 1560.0, 1110.0, 1480.0, 730.0, 1490.0, 1010.0, 1020.0, 1390.0, 1130.0, 1120.0, 1820.0, 1875.0, 980.0, 390.0, 850.0, 1200.0, 1510.0, 1060.0, 1720.0, 1550.0, 1350.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [290.0, -350.0, 0.0, 0.0, 0.0, 450.0, 50.0, 210.0, 40.0, 50.0, 70.0, 160.0, 190.0, 140.0, 10.0, 10.0, 0.0, 20.0, 250.0, 40.0, 170.0, 100.0, 30.0, 80.0, 230.0, 150.0, 280.0, 10.0, 70.0, 120.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 70.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 140.0, 20.0, 50.0, 10.0, 190.0, 40.0, 120.0, 60.0, 160.0, 15.0, 200.0, 30.0, 580.0, 30.0, 30.0, 235.0, 60.0, 60.0, 70.0, 200.0, 550.0, 220.0, 110.0, 40.0, 50.0, 20.0, 450.0, 80.0, 40.0, 40.0, 260.0, -300.0, 70.0, 15.0, 360.0, 20.0, 10.0, 0.0, 250.0, 20.0, 50.0, 10.0, 120.0, 40.0, 20.0, 200.0, 60.0, 240.0, 60.0, 130.0, 90.0, 300.0, 100.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 40.0, 710.0, 100.0, 140.0, 150.0, 35.0, 20.0, 260.0, 40.0, 10.0, 20.0, 90.0, 0.0, 20.0, 10.0, 30.0, 210.0, 60.0, -65.0, 50.0, 30.0, 20.0, 420.0, -20.0, 180.0, 5.0, 300.0, 0.0, 90.0, 50.0, 170.0, 100.0, 130.0, 90.0, 90.0, 40.0, 60.0, 40.0, 70.0, 350.0, 70.0, 0.0, 120.0, 70.0, 110.0, 0.0, 160.0, 540.0, 50.0, 190.0, 250.0, 200.0, 50.0, 70.0, 30.0, 110.0, 60.0, 50.0, 380.0, 180.0, 240.0, 230.0, 90.0, 100.0, 80.0, 20.0, 80.0, 110.0, 20.0, 20.0, 100.0, 380.0, 40.0, 40.0, 40.0, 320.0, 40.0, 330.0, 40.0, 80.0, 20.0, 0.0, 310.0, 25.0, 70.0, 30.0, 80.0, 50.0, 150.0, 20.0, 20.0, 70.0, 380.0, 40.0, 30.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 180.0, 0.0, 0.0, 50.0, 0.0, 50.0, 160.0, 50.0, 80.0, 0.0, 20.0, 40.0, 0.0, 20.0, 120.0, 310.0, 100.0, 40.0, 180.0, 320.0, 10.0, 40.0, 230.0, 40.0, 20.0, 10.0, 290.0, 30.0, 10.0, 90.0, 20.0, 70.0, 20.0, 200.0, 100.0, 20.0, 60.0, 370.0, 50.0, 20.0, 970.0, 40.0, 20.0, -10.0, 210.0, 70.0, 120.0, 20.0, 40.0, 10.0, 30.0, 60.0, 290.0, 30.0, 30.0, 20.0, 160.0, 0.0, 240.0, 40.0, 20.0, 170.0, 120.0, 20.0, 100.0, 0.0, 170.0, 320.0, 40.0, 30.0, 0.0, 230.0, 20.0, 0.0, 20.0, 10.0, 50.0, 100.0, 10.0, 20.0, 120.0, 510.0, 180.0, 170.0, 160.0, 70.0, 240.0, 50.0, 30.0, -15.0, 30.0, 20.0, 410.0, 20.0, 20.0, 450.0, 10.0, 270.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 200.0, 10.0, 280.0, 80.0, 20.0, 20.0, 80.0, 20.0, 170.0, 170.0, 30.0, 30.0, -170.0, 70.0, 70.0, 30.0, 260.0, 145.0, 20.0, 140.0, 90.0, 210.0, 85.0, 580.0, 80.0, 50.0, -10.0, -10.0, 45.0, 60.0, 280.0, 220.0, 30.0, 90.0, 60.0, 500.0, 420.0, 220.0, 530.0, 25.0, 40.0, -20.0, 160.0, 0.0, 40.0, 30.0, 20.0, 20.0, 170.0, 0.0, 0.0, 10.0, 10.0, -40.0, 180.0, 20.0, 40.0, 160.0, 40.0, 50.0, 230.0, 310.0, 10.0, 10.0, 0.0, 490.0, -30.0, 80.0, 30.0, 20.0, 40.0, -150.0, 30.0, 30.0, 460.0, 110.0, 110.0, 30.0, 20.0, 150.0, 230.0, 140.0, 30.0, 170.0, 330.0, 430.0, 10.0, 120.0, 50.0, 260.0, 180.0, 55.0, 170.0, 50.0, 140.0, 300.0, 90.0, 220.0, 0.0, 140.0, 220.0, -180.0, 50.0, 60.0, 200.0, 60.0, 110.0, 160.0, 110.0, 350.0, 120.0, 60.0, 40.0, 170.0, 40.0, 20.0, 20.0, 0.0, 120.0, 460.0, 10.0, 80.0, 610.0, 70.0, 20.0, 0.0, 170.0, -80.0, 0.0, 60.0, 200.0, 560.0, -5.0, 40.0, 110.0, 20.0, 20.0, 30.0, 10.0, 20.0, 10.0, 240.0, 60.0, 80.0, 10.0, 90.0, 170.0, 260.0, 10.0, 80.0, 90.0, 40.0, 50.0, 40.0, 610.0, 80.0, 220.0, 90.0, 0.0, -15.0, 20.0, 20.0, 230.0, 260.0, 110.0, 0.0, 20.0, 30.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 50.0, 250.0, 0.0, 450.0, 30.0, 0.0, -40.0, 40.0, 20.0, 80.0, 380.0, -10.0, 80.0, 140.0, 260.0, 20.0, 40.0, 410.0, 90.0, 0.0, 30.0, 10.0, 170.0, 40.0, -30.0, -5.0, 260.0, 10.0, 190.0, 20.0, 15.0, 200.0, 600.0, 240.0, 180.0, 60.0, 95.0, 40.0, 80.0, 20.0, 70.0, 0.0, 70.0, 70.0, 30.0, 90.0, 0.0, 40.0, 30.0, 60.0, 0.0, 110.0, 210.0, 90.0, 50.0, 280.0, 310.0, 250.0, 170.0, 30.0, 190.0, 20.0, 20.0, 30.0, 40.0, 500.0, 100.0, 10.0, 370.0, 100.0, 10.0, 10.0, 20.0, 210.0, 60.0, 90.0, 80.0, 80.0, 100.0, 40.0, 380.0, 60.0, 130.0, 160.0, 350.0, 30.0, 220.0, 180.0, 50.0, 10.0, 370.0, -30.0, 60.0, 20.0, -30.0, 290.0, 270.0, 20.0, 560.0, 40.0, 40.0, 170.0, 190.0, 290.0, 80.0, 20.0, 200.0, 240.0, 20.0, 30.0, 40.0, -5.0, 0.0, 40.0, 0.0, 50.0, 0.0, 210.0, 100.0, 30.0, -20.0, 60.0, 410.0, 0.0, 260.0, 90.0, 180.0, 100.0, 10.0, 190.0, 30.0, 40.0, 40.0, 0.0, 0.0, 20.0, 170.0, 70.0, 10.0, 0.0, 50.0, 120.0, 20.0, 0.0, 10.0, 80.0, 590.0, 250.0, 20.0, 80.0, 10.0, 570.0, -10.0, 50.0, 30.0, 40.0, 0.0, 0.0, 90.0, 10.0, 110.0, 350.0, 220.0, 70.0, 80.0, 80.0, -270.0, 320.0, 60.0, 20.0, 390.0, 20.0, 10.0, 400.0, 220.0, 50.0, 20.0, 50.0, 80.0, 360.0, 85.0, 120.0, 160.0, 170.0, 280.0, 20.0, 230.0, 90.0, 20.0, -30.0, 50.0, 40.0, 30.0, 480.0, 370.0, 0.0, 170.0, 70.0, 70.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 220.0, 100.0, 120.0, 0.0, 10.0, 160.0, 40.0, 60.0, 0.0, 50.0, 210.0, -10.0, 340.0, 20.0, 10.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 40.0, 0.0, 190.0, 200.0, 30.0, 20.0, 10.0, 250.0, 70.0, 320.0, 90.0, 10.0, -40.0, 350.0, 20.0, 240.0, 80.0, 180.0, 160.0, 110.0, 50.0, 270.0, 50.0, 10.0, 90.0, 40.0, 430.0, 110.0, 30.0, 230.0, 150.0, 10.0, 580.0, 0.0, -10.0, 120.0, 220.0, 100.0, 50.0, 110.0, 310.0, 50.0, 20.0, 60.0, 150.0, 390.0, 20.0, -20.0, 260.0, 540.0, 50.0, -10.0, 300.0, 250.0, 580.0, 60.0, -30.0, 50.0, 130.0, 180.0, 180.0, 80.0, -20.0, 20.0, 430.0, 400.0, 80.0, 80.0, 430.0, 170.0, 50.0, 10.0, 50.0, 50.0, -60.0, 10.0, 290.0, 110.0, 40.0, 10.0, 30.0, 40.0, 20.0, 600.0, 110.0, 90.0, 80.0, 460.0, 20.0, 0.0, 30.0, 130.0, 370.0, 50.0, 30.0, 40.0, 30.0, 30.0, 0.0, -20.0, 180.0, 80.0, 700.0, 30.0, 100.0, 180.0, 20.0, 220.0, 120.0, 30.0, 20.0, 300.0, 30.0, 190.0, 20.0, 10.0, 320.0, -30.0, 120.0, 50.0, 0.0, 670.0, 30.0, 30.0, -20.0, 20.0, 80.0, 40.0, 60.0, 790.0, 50.0, 10.0, 150.0, 50.0, 0.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 40.0, 350.0, 180.0, 180.0, 20.0, 220.0, 40.0, 0.0, 50.0, 0.0, 30.0, 400.0, 90.0, 330.0, 170.0, 30.0, 20.0, 70.0, 210.0, 420.0, 0.0, 340.0, 150.0, 60.0, 130.0, 90.0, 350.0, 80.0, 320.0, 20.0, 170.0, 140.0, 940.0, 70.0, 20.0, 90.0, 25.0, 190.0, 570.0, 70.0, 30.0, 0.0, -20.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 80.0, 50.0, 10.0, 20.0, 30.0, 190.0, 0.0, 0.0, 80.0, 350.0, 40.0, 180.0, 10.0, 50.0, 30.0, 20.0, 10.0, 80.0, 10.0, -100.0, 80.0, 0.0, 80.0, 330.0, 690.0, 10.0, 80.0, 20.0, 50.0, -50.0, 100.0, 30.0, 580.0, 510.0, 110.0, -20.0, 70.0, 130.0, 370.0, 30.0, 110.0, 200.0, 70.0, 50.0, 100.0, 10.0, 40.0, 80.0, -90.0, 210.0, 80.0, 120.0, 290.0, 60.0, 460.0, 350.0, 80.0, 160.0, 450.0, 90.0, 170.0, 30.0, 460.0, 110.0, 70.0, 70.0, 10.0, 90.0, 150.0, 60.0, 30.0, 20.0, 170.0, 20.0, 60.0, 20.0, 750.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0607423899050694, "mean_inference_ms": 2.0207995140494748, "mean_action_processing_ms": 0.5472054033342679, "mean_env_wait_ms": 1.7656536909262186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038527488708496094, "StateBufferConnector_ms": 0.015441656112670898, "ViewRequirementAgentConnector_ms": 0.675804853439331}, "num_episodes": 18, "episode_return_max": 2050.0, "episode_return_min": 20.0, "episode_return_mean": 1074.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.367626121394645, "num_env_steps_trained_throughput_per_sec": 14.367626121394645, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 2920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2920000, "timers": {"training_iteration_time_ms": 342270.174, "restore_workers_time_ms": 0.014, "training_step_time_ms": 342270.112, "sample_time_ms": 4204.439, "learn_time_ms": 338036.333, "learn_throughput": 11.833, "synch_weights_time_ms": 13.083}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "done": false, "training_iteration": 73, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-43-48", "timestamp": 1717253028, "time_this_iter_s": 278.4861500263214, "time_total_s": 43844.65162038803, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dc550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 43844.65162038803, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 49.77175572519085, "ram_util_percent": 82.55368956743003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.418034597739371, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.560762284891293, "policy_loss": -0.006814416351056677, "vf_loss": 6.5668175764865895, "vf_explained_var": 0.00031586634719206756, "kl": 0.007591293947413913, "entropy": 0.3354140032245455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 690165.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 2170.0, "episode_reward_min": 20.0, "episode_reward_mean": 1083.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 970.0}, "policy_reward_mean": {"policy_0": 108.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [945.0, 870.0, 150.0, 570.0, 1150.0, 770.0, 930.0, 1490.0, 900.0, 990.0, 460.0, 1515.0, 1260.0, 570.0, 900.0, 865.0, 1380.0, 1895.0, 450.0, 1000.0, 500.0, 1310.0, 1635.0, 1150.0, 1280.0, 960.0, 1610.0, 495.0, 890.0, 1115.0, 790.0, 20.0, 800.0, 1420.0, 575.0, 1640.0, 470.0, 1390.0, 1110.0, 1030.0, 1650.0, 1030.0, 1830.0, 385.0, 1210.0, 570.0, 1130.0, 790.0, 1060.0, 1240.0, 1595.0, 1200.0, 170.0, 720.0, 960.0, 930.0, 1320.0, 1320.0, 1430.0, 1140.0, 2050.0, 1560.0, 1110.0, 1480.0, 730.0, 1490.0, 1010.0, 1020.0, 1390.0, 1130.0, 1120.0, 1820.0, 1875.0, 980.0, 390.0, 850.0, 1200.0, 1510.0, 1060.0, 1720.0, 1550.0, 1350.0, 1605.0, 490.0, 1850.0, 2170.0, 980.0, 1540.0, 1880.0, 670.0, 1420.0, 530.0, 355.0, 1250.0, 670.0, 1230.0, 390.0, 510.0, 790.0, 660.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 330.0, 40.0, 80.0, 20.0, 0.0, 310.0, 25.0, 70.0, 30.0, 80.0, 50.0, 150.0, 20.0, 20.0, 70.0, 380.0, 40.0, 30.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 180.0, 0.0, 0.0, 50.0, 0.0, 50.0, 160.0, 50.0, 80.0, 0.0, 20.0, 40.0, 0.0, 20.0, 120.0, 310.0, 100.0, 40.0, 180.0, 320.0, 10.0, 40.0, 230.0, 40.0, 20.0, 10.0, 290.0, 30.0, 10.0, 90.0, 20.0, 70.0, 20.0, 200.0, 100.0, 20.0, 60.0, 370.0, 50.0, 20.0, 970.0, 40.0, 20.0, -10.0, 210.0, 70.0, 120.0, 20.0, 40.0, 10.0, 30.0, 60.0, 290.0, 30.0, 30.0, 20.0, 160.0, 0.0, 240.0, 40.0, 20.0, 170.0, 120.0, 20.0, 100.0, 0.0, 170.0, 320.0, 40.0, 30.0, 0.0, 230.0, 20.0, 0.0, 20.0, 10.0, 50.0, 100.0, 10.0, 20.0, 120.0, 510.0, 180.0, 170.0, 160.0, 70.0, 240.0, 50.0, 30.0, -15.0, 30.0, 20.0, 410.0, 20.0, 20.0, 450.0, 10.0, 270.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 40.0, 10.0, 20.0, 200.0, 10.0, 280.0, 80.0, 20.0, 20.0, 80.0, 20.0, 170.0, 170.0, 30.0, 30.0, -170.0, 70.0, 70.0, 30.0, 260.0, 145.0, 20.0, 140.0, 90.0, 210.0, 85.0, 580.0, 80.0, 50.0, -10.0, -10.0, 45.0, 60.0, 280.0, 220.0, 30.0, 90.0, 60.0, 500.0, 420.0, 220.0, 530.0, 25.0, 40.0, -20.0, 160.0, 0.0, 40.0, 30.0, 20.0, 20.0, 170.0, 0.0, 0.0, 10.0, 10.0, -40.0, 180.0, 20.0, 40.0, 160.0, 40.0, 50.0, 230.0, 310.0, 10.0, 10.0, 0.0, 490.0, -30.0, 80.0, 30.0, 20.0, 40.0, -150.0, 30.0, 30.0, 460.0, 110.0, 110.0, 30.0, 20.0, 150.0, 230.0, 140.0, 30.0, 170.0, 330.0, 430.0, 10.0, 120.0, 50.0, 260.0, 180.0, 55.0, 170.0, 50.0, 140.0, 300.0, 90.0, 220.0, 0.0, 140.0, 220.0, -180.0, 50.0, 60.0, 200.0, 60.0, 110.0, 160.0, 110.0, 350.0, 120.0, 60.0, 40.0, 170.0, 40.0, 20.0, 20.0, 0.0, 120.0, 460.0, 10.0, 80.0, 610.0, 70.0, 20.0, 0.0, 170.0, -80.0, 0.0, 60.0, 200.0, 560.0, -5.0, 40.0, 110.0, 20.0, 20.0, 30.0, 10.0, 20.0, 10.0, 240.0, 60.0, 80.0, 10.0, 90.0, 170.0, 260.0, 10.0, 80.0, 90.0, 40.0, 50.0, 40.0, 610.0, 80.0, 220.0, 90.0, 0.0, -15.0, 20.0, 20.0, 230.0, 260.0, 110.0, 0.0, 20.0, 30.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 50.0, 250.0, 0.0, 450.0, 30.0, 0.0, -40.0, 40.0, 20.0, 80.0, 380.0, -10.0, 80.0, 140.0, 260.0, 20.0, 40.0, 410.0, 90.0, 0.0, 30.0, 10.0, 170.0, 40.0, -30.0, -5.0, 260.0, 10.0, 190.0, 20.0, 15.0, 200.0, 600.0, 240.0, 180.0, 60.0, 95.0, 40.0, 80.0, 20.0, 70.0, 0.0, 70.0, 70.0, 30.0, 90.0, 0.0, 40.0, 30.0, 60.0, 0.0, 110.0, 210.0, 90.0, 50.0, 280.0, 310.0, 250.0, 170.0, 30.0, 190.0, 20.0, 20.0, 30.0, 40.0, 500.0, 100.0, 10.0, 370.0, 100.0, 10.0, 10.0, 20.0, 210.0, 60.0, 90.0, 80.0, 80.0, 100.0, 40.0, 380.0, 60.0, 130.0, 160.0, 350.0, 30.0, 220.0, 180.0, 50.0, 10.0, 370.0, -30.0, 60.0, 20.0, -30.0, 290.0, 270.0, 20.0, 560.0, 40.0, 40.0, 170.0, 190.0, 290.0, 80.0, 20.0, 200.0, 240.0, 20.0, 30.0, 40.0, -5.0, 0.0, 40.0, 0.0, 50.0, 0.0, 210.0, 100.0, 30.0, -20.0, 60.0, 410.0, 0.0, 260.0, 90.0, 180.0, 100.0, 10.0, 190.0, 30.0, 40.0, 40.0, 0.0, 0.0, 20.0, 170.0, 70.0, 10.0, 0.0, 50.0, 120.0, 20.0, 0.0, 10.0, 80.0, 590.0, 250.0, 20.0, 80.0, 10.0, 570.0, -10.0, 50.0, 30.0, 40.0, 0.0, 0.0, 90.0, 10.0, 110.0, 350.0, 220.0, 70.0, 80.0, 80.0, -270.0, 320.0, 60.0, 20.0, 390.0, 20.0, 10.0, 400.0, 220.0, 50.0, 20.0, 50.0, 80.0, 360.0, 85.0, 120.0, 160.0, 170.0, 280.0, 20.0, 230.0, 90.0, 20.0, -30.0, 50.0, 40.0, 30.0, 480.0, 370.0, 0.0, 170.0, 70.0, 70.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 220.0, 100.0, 120.0, 0.0, 10.0, 160.0, 40.0, 60.0, 0.0, 50.0, 210.0, -10.0, 340.0, 20.0, 10.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 40.0, 0.0, 190.0, 200.0, 30.0, 20.0, 10.0, 250.0, 70.0, 320.0, 90.0, 10.0, -40.0, 350.0, 20.0, 240.0, 80.0, 180.0, 160.0, 110.0, 50.0, 270.0, 50.0, 10.0, 90.0, 40.0, 430.0, 110.0, 30.0, 230.0, 150.0, 10.0, 580.0, 0.0, -10.0, 120.0, 220.0, 100.0, 50.0, 110.0, 310.0, 50.0, 20.0, 60.0, 150.0, 390.0, 20.0, -20.0, 260.0, 540.0, 50.0, -10.0, 300.0, 250.0, 580.0, 60.0, -30.0, 50.0, 130.0, 180.0, 180.0, 80.0, -20.0, 20.0, 430.0, 400.0, 80.0, 80.0, 430.0, 170.0, 50.0, 10.0, 50.0, 50.0, -60.0, 10.0, 290.0, 110.0, 40.0, 10.0, 30.0, 40.0, 20.0, 600.0, 110.0, 90.0, 80.0, 460.0, 20.0, 0.0, 30.0, 130.0, 370.0, 50.0, 30.0, 40.0, 30.0, 30.0, 0.0, -20.0, 180.0, 80.0, 700.0, 30.0, 100.0, 180.0, 20.0, 220.0, 120.0, 30.0, 20.0, 300.0, 30.0, 190.0, 20.0, 10.0, 320.0, -30.0, 120.0, 50.0, 0.0, 670.0, 30.0, 30.0, -20.0, 20.0, 80.0, 40.0, 60.0, 790.0, 50.0, 10.0, 150.0, 50.0, 0.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 40.0, 350.0, 180.0, 180.0, 20.0, 220.0, 40.0, 0.0, 50.0, 0.0, 30.0, 400.0, 90.0, 330.0, 170.0, 30.0, 20.0, 70.0, 210.0, 420.0, 0.0, 340.0, 150.0, 60.0, 130.0, 90.0, 350.0, 80.0, 320.0, 20.0, 170.0, 140.0, 940.0, 70.0, 20.0, 90.0, 25.0, 190.0, 570.0, 70.0, 30.0, 0.0, -20.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 80.0, 50.0, 10.0, 20.0, 30.0, 190.0, 0.0, 0.0, 80.0, 350.0, 40.0, 180.0, 10.0, 50.0, 30.0, 20.0, 10.0, 80.0, 10.0, -100.0, 80.0, 0.0, 80.0, 330.0, 690.0, 10.0, 80.0, 20.0, 50.0, -50.0, 100.0, 30.0, 580.0, 510.0, 110.0, -20.0, 70.0, 130.0, 370.0, 30.0, 110.0, 200.0, 70.0, 50.0, 100.0, 10.0, 40.0, 80.0, -90.0, 210.0, 80.0, 120.0, 290.0, 60.0, 460.0, 350.0, 80.0, 160.0, 450.0, 90.0, 170.0, 30.0, 460.0, 110.0, 70.0, 70.0, 10.0, 90.0, 150.0, 60.0, 30.0, 20.0, 170.0, 20.0, 60.0, 20.0, 750.0, 70.0, 50.0, 180.0, 300.0, 40.0, 200.0, 45.0, 310.0, 170.0, 210.0, 100.0, 40.0, 10.0, 90.0, 230.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 520.0, 20.0, 70.0, 50.0, 210.0, 750.0, 60.0, 70.0, 40.0, 60.0, 160.0, 30.0, 20.0, 190.0, 240.0, 180.0, 450.0, 20.0, 220.0, 660.0, 40.0, 210.0, 10.0, 10.0, 90.0, 20.0, 320.0, 50.0, 30.0, 200.0, 60.0, 10.0, 300.0, 40.0, 520.0, 340.0, 160.0, 80.0, 30.0, 0.0, 70.0, 280.0, 150.0, 280.0, 110.0, 120.0, 90.0, 150.0, 30.0, 600.0, 190.0, 40.0, 80.0, 20.0, 20.0, 30.0, 40.0, 150.0, 100.0, 0.0, 50.0, 110.0, 10.0, 30.0, 510.0, 290.0, 50.0, 270.0, 20.0, 80.0, 40.0, 20.0, 90.0, 50.0, 10.0, 10.0, 20.0, 120.0, 10.0, 160.0, 140.0, 10.0, 30.0, -15.0, 30.0, 20.0, 90.0, 0.0, 40.0, 10.0, 30.0, 90.0, 350.0, 10.0, 70.0, 460.0, 20.0, 40.0, 180.0, 0.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 120.0, 180.0, 80.0, 170.0, 180.0, -20.0, 290.0, 60.0, 20.0, 130.0, 360.0, 90.0, 50.0, 70.0, 20.0, 40.0, 100.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 150.0, 60.0, 20.0, 30.0, 60.0, -40.0, 290.0, 20.0, 10.0, 20.0, 40.0, -60.0, 40.0, 0.0, 130.0, 10.0, 230.0, 300.0, 30.0, 20.0, 90.0, 10.0, 0.0, 390.0, 20.0, 50.0, 0.0, 0.0, 160.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.070288592747892, "mean_inference_ms": 2.0365804582847256, "mean_action_processing_ms": 0.5504312821296078, "mean_env_wait_ms": 1.7740721084618911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026621103286743164, "StateBufferConnector_ms": 0.014293193817138672, "ViewRequirementAgentConnector_ms": 0.667365312576294}, "num_episodes": 18, "episode_return_max": 2170.0, "episode_return_min": 20.0, "episode_return_mean": 1083.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.365116447959679, "num_env_steps_trained_throughput_per_sec": 14.365116447959679, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 348740.329, "restore_workers_time_ms": 0.014, "training_step_time_ms": 348740.267, "sample_time_ms": 4488.443, "learn_time_ms": 344219.142, "learn_throughput": 11.621, "synch_weights_time_ms": 14.348}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 74, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-48-27", "timestamp": 1717253307, "time_this_iter_s": 278.49546909332275, "time_total_s": 44123.147089481354, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dc790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44123.147089481354, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 48.614249363867685, "ram_util_percent": 82.11653944020357}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.182241156376716, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.278250519434611, "policy_loss": -0.006122810929181517, "vf_loss": 6.283643002555774, "vf_explained_var": 0.0002596955202892819, "kl": 0.007303305655682254, "entropy": 0.32822195961039924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 699555.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "env_runners": {"episode_reward_max": 2170.0, "episode_reward_min": 20.0, "episode_reward_mean": 1098.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 109.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1635.0, 1150.0, 1280.0, 960.0, 1610.0, 495.0, 890.0, 1115.0, 790.0, 20.0, 800.0, 1420.0, 575.0, 1640.0, 470.0, 1390.0, 1110.0, 1030.0, 1650.0, 1030.0, 1830.0, 385.0, 1210.0, 570.0, 1130.0, 790.0, 1060.0, 1240.0, 1595.0, 1200.0, 170.0, 720.0, 960.0, 930.0, 1320.0, 1320.0, 1430.0, 1140.0, 2050.0, 1560.0, 1110.0, 1480.0, 730.0, 1490.0, 1010.0, 1020.0, 1390.0, 1130.0, 1120.0, 1820.0, 1875.0, 980.0, 390.0, 850.0, 1200.0, 1510.0, 1060.0, 1720.0, 1550.0, 1350.0, 1605.0, 490.0, 1850.0, 2170.0, 980.0, 1540.0, 1880.0, 670.0, 1420.0, 530.0, 355.0, 1250.0, 670.0, 1230.0, 390.0, 510.0, 790.0, 660.0, 430.0, 800.0, 190.0, 1190.0, 1440.0, 880.0, 740.0, 460.0, 1115.0, 1140.0, 1010.0, 1690.0, 1340.0, 830.0, 925.0, 1950.0, 1510.0, 760.0, 1140.0, 1340.0, 1290.0, 260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 170.0, 330.0, 430.0, 10.0, 120.0, 50.0, 260.0, 180.0, 55.0, 170.0, 50.0, 140.0, 300.0, 90.0, 220.0, 0.0, 140.0, 220.0, -180.0, 50.0, 60.0, 200.0, 60.0, 110.0, 160.0, 110.0, 350.0, 120.0, 60.0, 40.0, 170.0, 40.0, 20.0, 20.0, 0.0, 120.0, 460.0, 10.0, 80.0, 610.0, 70.0, 20.0, 0.0, 170.0, -80.0, 0.0, 60.0, 200.0, 560.0, -5.0, 40.0, 110.0, 20.0, 20.0, 30.0, 10.0, 20.0, 10.0, 240.0, 60.0, 80.0, 10.0, 90.0, 170.0, 260.0, 10.0, 80.0, 90.0, 40.0, 50.0, 40.0, 610.0, 80.0, 220.0, 90.0, 0.0, -15.0, 20.0, 20.0, 230.0, 260.0, 110.0, 0.0, 20.0, 30.0, 40.0, 20.0, 40.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 50.0, 250.0, 0.0, 450.0, 30.0, 0.0, -40.0, 40.0, 20.0, 80.0, 380.0, -10.0, 80.0, 140.0, 260.0, 20.0, 40.0, 410.0, 90.0, 0.0, 30.0, 10.0, 170.0, 40.0, -30.0, -5.0, 260.0, 10.0, 190.0, 20.0, 15.0, 200.0, 600.0, 240.0, 180.0, 60.0, 95.0, 40.0, 80.0, 20.0, 70.0, 0.0, 70.0, 70.0, 30.0, 90.0, 0.0, 40.0, 30.0, 60.0, 0.0, 110.0, 210.0, 90.0, 50.0, 280.0, 310.0, 250.0, 170.0, 30.0, 190.0, 20.0, 20.0, 30.0, 40.0, 500.0, 100.0, 10.0, 370.0, 100.0, 10.0, 10.0, 20.0, 210.0, 60.0, 90.0, 80.0, 80.0, 100.0, 40.0, 380.0, 60.0, 130.0, 160.0, 350.0, 30.0, 220.0, 180.0, 50.0, 10.0, 370.0, -30.0, 60.0, 20.0, -30.0, 290.0, 270.0, 20.0, 560.0, 40.0, 40.0, 170.0, 190.0, 290.0, 80.0, 20.0, 200.0, 240.0, 20.0, 30.0, 40.0, -5.0, 0.0, 40.0, 0.0, 50.0, 0.0, 210.0, 100.0, 30.0, -20.0, 60.0, 410.0, 0.0, 260.0, 90.0, 180.0, 100.0, 10.0, 190.0, 30.0, 40.0, 40.0, 0.0, 0.0, 20.0, 170.0, 70.0, 10.0, 0.0, 50.0, 120.0, 20.0, 0.0, 10.0, 80.0, 590.0, 250.0, 20.0, 80.0, 10.0, 570.0, -10.0, 50.0, 30.0, 40.0, 0.0, 0.0, 90.0, 10.0, 110.0, 350.0, 220.0, 70.0, 80.0, 80.0, -270.0, 320.0, 60.0, 20.0, 390.0, 20.0, 10.0, 400.0, 220.0, 50.0, 20.0, 50.0, 80.0, 360.0, 85.0, 120.0, 160.0, 170.0, 280.0, 20.0, 230.0, 90.0, 20.0, -30.0, 50.0, 40.0, 30.0, 480.0, 370.0, 0.0, 170.0, 70.0, 70.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 220.0, 100.0, 120.0, 0.0, 10.0, 160.0, 40.0, 60.0, 0.0, 50.0, 210.0, -10.0, 340.0, 20.0, 10.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 40.0, 0.0, 190.0, 200.0, 30.0, 20.0, 10.0, 250.0, 70.0, 320.0, 90.0, 10.0, -40.0, 350.0, 20.0, 240.0, 80.0, 180.0, 160.0, 110.0, 50.0, 270.0, 50.0, 10.0, 90.0, 40.0, 430.0, 110.0, 30.0, 230.0, 150.0, 10.0, 580.0, 0.0, -10.0, 120.0, 220.0, 100.0, 50.0, 110.0, 310.0, 50.0, 20.0, 60.0, 150.0, 390.0, 20.0, -20.0, 260.0, 540.0, 50.0, -10.0, 300.0, 250.0, 580.0, 60.0, -30.0, 50.0, 130.0, 180.0, 180.0, 80.0, -20.0, 20.0, 430.0, 400.0, 80.0, 80.0, 430.0, 170.0, 50.0, 10.0, 50.0, 50.0, -60.0, 10.0, 290.0, 110.0, 40.0, 10.0, 30.0, 40.0, 20.0, 600.0, 110.0, 90.0, 80.0, 460.0, 20.0, 0.0, 30.0, 130.0, 370.0, 50.0, 30.0, 40.0, 30.0, 30.0, 0.0, -20.0, 180.0, 80.0, 700.0, 30.0, 100.0, 180.0, 20.0, 220.0, 120.0, 30.0, 20.0, 300.0, 30.0, 190.0, 20.0, 10.0, 320.0, -30.0, 120.0, 50.0, 0.0, 670.0, 30.0, 30.0, -20.0, 20.0, 80.0, 40.0, 60.0, 790.0, 50.0, 10.0, 150.0, 50.0, 0.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 40.0, 350.0, 180.0, 180.0, 20.0, 220.0, 40.0, 0.0, 50.0, 0.0, 30.0, 400.0, 90.0, 330.0, 170.0, 30.0, 20.0, 70.0, 210.0, 420.0, 0.0, 340.0, 150.0, 60.0, 130.0, 90.0, 350.0, 80.0, 320.0, 20.0, 170.0, 140.0, 940.0, 70.0, 20.0, 90.0, 25.0, 190.0, 570.0, 70.0, 30.0, 0.0, -20.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 80.0, 50.0, 10.0, 20.0, 30.0, 190.0, 0.0, 0.0, 80.0, 350.0, 40.0, 180.0, 10.0, 50.0, 30.0, 20.0, 10.0, 80.0, 10.0, -100.0, 80.0, 0.0, 80.0, 330.0, 690.0, 10.0, 80.0, 20.0, 50.0, -50.0, 100.0, 30.0, 580.0, 510.0, 110.0, -20.0, 70.0, 130.0, 370.0, 30.0, 110.0, 200.0, 70.0, 50.0, 100.0, 10.0, 40.0, 80.0, -90.0, 210.0, 80.0, 120.0, 290.0, 60.0, 460.0, 350.0, 80.0, 160.0, 450.0, 90.0, 170.0, 30.0, 460.0, 110.0, 70.0, 70.0, 10.0, 90.0, 150.0, 60.0, 30.0, 20.0, 170.0, 20.0, 60.0, 20.0, 750.0, 70.0, 50.0, 180.0, 300.0, 40.0, 200.0, 45.0, 310.0, 170.0, 210.0, 100.0, 40.0, 10.0, 90.0, 230.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 520.0, 20.0, 70.0, 50.0, 210.0, 750.0, 60.0, 70.0, 40.0, 60.0, 160.0, 30.0, 20.0, 190.0, 240.0, 180.0, 450.0, 20.0, 220.0, 660.0, 40.0, 210.0, 10.0, 10.0, 90.0, 20.0, 320.0, 50.0, 30.0, 200.0, 60.0, 10.0, 300.0, 40.0, 520.0, 340.0, 160.0, 80.0, 30.0, 0.0, 70.0, 280.0, 150.0, 280.0, 110.0, 120.0, 90.0, 150.0, 30.0, 600.0, 190.0, 40.0, 80.0, 20.0, 20.0, 30.0, 40.0, 150.0, 100.0, 0.0, 50.0, 110.0, 10.0, 30.0, 510.0, 290.0, 50.0, 270.0, 20.0, 80.0, 40.0, 20.0, 90.0, 50.0, 10.0, 10.0, 20.0, 120.0, 10.0, 160.0, 140.0, 10.0, 30.0, -15.0, 30.0, 20.0, 90.0, 0.0, 40.0, 10.0, 30.0, 90.0, 350.0, 10.0, 70.0, 460.0, 20.0, 40.0, 180.0, 0.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 120.0, 180.0, 80.0, 170.0, 180.0, -20.0, 290.0, 60.0, 20.0, 130.0, 360.0, 90.0, 50.0, 70.0, 20.0, 40.0, 100.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 150.0, 60.0, 20.0, 30.0, 60.0, -40.0, 290.0, 20.0, 10.0, 20.0, 40.0, -60.0, 40.0, 0.0, 130.0, 10.0, 230.0, 300.0, 30.0, 20.0, 90.0, 10.0, 0.0, 390.0, 20.0, 50.0, 0.0, 0.0, 160.0, 30.0, 0.0, 10.0, 360.0, 30.0, 120.0, 20.0, 0.0, -90.0, 30.0, -70.0, 20.0, 40.0, -20.0, -40.0, 30.0, 100.0, -40.0, 60.0, 580.0, 70.0, 20.0, 0.0, 70.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 10.0, 0.0, -30.0, 90.0, 30.0, 500.0, 120.0, 80.0, 20.0, 360.0, 20.0, 290.0, 30.0, 510.0, 80.0, 100.0, 10.0, 320.0, 60.0, 50.0, -10.0, 0.0, 110.0, 10.0, 650.0, 0.0, 20.0, 20.0, 30.0, 20.0, 20.0, 180.0, 30.0, 100.0, 100.0, 60.0, 40.0, 160.0, 40.0, 20.0, 10.0, 0.0, 40.0, 40.0, -40.0, 370.0, 40.0, 10.0, 0.0, -20.0, 20.0, -5.0, 80.0, 10.0, 20.0, 30.0, 50.0, 190.0, 370.0, 90.0, 280.0, 100.0, -10.0, 220.0, 20.0, 190.0, 30.0, -30.0, 360.0, 130.0, 130.0, 60.0, 30.0, 70.0, -10.0, 20.0, 30.0, 10.0, 50.0, -40.0, 790.0, 200.0, 60.0, 80.0, 50.0, 50.0, 440.0, 510.0, 100.0, 60.0, 140.0, 50.0, 50.0, 70.0, 20.0, 340.0, 290.0, 180.0, 110.0, 80.0, 150.0, 380.0, 30.0, 50.0, 60.0, 150.0, 20.0, 20.0, 20.0, 60.0, 40.0, 20.0, 250.0, 0.0, 30.0, 270.0, -40.0, 20.0, -55.0, 70.0, 360.0, 470.0, 120.0, 100.0, 60.0, 60.0, 130.0, 310.0, 620.0, 0.0, 80.0, 510.0, 100.0, 50.0, 60.0, 250.0, 70.0, 150.0, 60.0, 50.0, 210.0, 30.0, 260.0, 120.0, 10.0, 170.0, 90.0, 50.0, 0.0, 0.0, 30.0, 20.0, 210.0, 10.0, 330.0, 0.0, 100.0, 20.0, 40.0, 250.0, 160.0, 20.0, 530.0, 210.0, 240.0, 120.0, 30.0, 60.0, 40.0, 80.0, 10.0, 390.0, 70.0, 10.0, 30.0, 280.0, 170.0, 150.0, 70.0, 90.0, 30.0, 0.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 20.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0803013474773553, "mean_inference_ms": 2.051426612580301, "mean_action_processing_ms": 0.5543369469950191, "mean_env_wait_ms": 1.7857807027020458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040773868560791016, "StateBufferConnector_ms": 0.015327930450439453, "ViewRequirementAgentConnector_ms": 0.7399349212646484}, "num_episodes": 22, "episode_return_max": 2170.0, "episode_return_min": 20.0, "episode_return_mean": 1098.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.077209900262746, "num_env_steps_trained_throughput_per_sec": 14.077209900262746, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 3000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000000, "timers": {"training_iteration_time_ms": 347313.687, "restore_workers_time_ms": 0.014, "training_step_time_ms": 347313.624, "sample_time_ms": 4857.586, "learn_time_ms": 342422.444, "learn_throughput": 11.681, "synch_weights_time_ms": 14.46}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "done": false, "training_iteration": 75, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-53-11", "timestamp": 1717253591, "time_this_iter_s": 284.16330313682556, "time_total_s": 44407.31039261818, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8249d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44407.31039261818, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 51.49427860696517, "ram_util_percent": 82.53731343283582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1074348237536076, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.658275093895178, "policy_loss": -0.006718060267787661, "vf_loss": 6.664317283031151, "vf_explained_var": 5.275683281139825e-05, "kl": 0.0067586716908539625, "entropy": 0.28659272648719425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 708945.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 2170.0, "episode_reward_min": 170.0, "episode_reward_mean": 1090.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 109.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1650.0, 1030.0, 1830.0, 385.0, 1210.0, 570.0, 1130.0, 790.0, 1060.0, 1240.0, 1595.0, 1200.0, 170.0, 720.0, 960.0, 930.0, 1320.0, 1320.0, 1430.0, 1140.0, 2050.0, 1560.0, 1110.0, 1480.0, 730.0, 1490.0, 1010.0, 1020.0, 1390.0, 1130.0, 1120.0, 1820.0, 1875.0, 980.0, 390.0, 850.0, 1200.0, 1510.0, 1060.0, 1720.0, 1550.0, 1350.0, 1605.0, 490.0, 1850.0, 2170.0, 980.0, 1540.0, 1880.0, 670.0, 1420.0, 530.0, 355.0, 1250.0, 670.0, 1230.0, 390.0, 510.0, 790.0, 660.0, 430.0, 800.0, 190.0, 1190.0, 1440.0, 880.0, 740.0, 460.0, 1115.0, 1140.0, 1010.0, 1690.0, 1340.0, 830.0, 925.0, 1950.0, 1510.0, 760.0, 1140.0, 1340.0, 1290.0, 260.0, 925.0, 1040.0, 1130.0, 980.0, 240.0, 1290.0, 850.0, 770.0, 1100.0, 1280.0, 1030.0, 670.0, 620.0, 1450.0, 1100.0, 1390.0, 610.0, 1100.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 40.0, 380.0, 60.0, 130.0, 160.0, 350.0, 30.0, 220.0, 180.0, 50.0, 10.0, 370.0, -30.0, 60.0, 20.0, -30.0, 290.0, 270.0, 20.0, 560.0, 40.0, 40.0, 170.0, 190.0, 290.0, 80.0, 20.0, 200.0, 240.0, 20.0, 30.0, 40.0, -5.0, 0.0, 40.0, 0.0, 50.0, 0.0, 210.0, 100.0, 30.0, -20.0, 60.0, 410.0, 0.0, 260.0, 90.0, 180.0, 100.0, 10.0, 190.0, 30.0, 40.0, 40.0, 0.0, 0.0, 20.0, 170.0, 70.0, 10.0, 0.0, 50.0, 120.0, 20.0, 0.0, 10.0, 80.0, 590.0, 250.0, 20.0, 80.0, 10.0, 570.0, -10.0, 50.0, 30.0, 40.0, 0.0, 0.0, 90.0, 10.0, 110.0, 350.0, 220.0, 70.0, 80.0, 80.0, -270.0, 320.0, 60.0, 20.0, 390.0, 20.0, 10.0, 400.0, 220.0, 50.0, 20.0, 50.0, 80.0, 360.0, 85.0, 120.0, 160.0, 170.0, 280.0, 20.0, 230.0, 90.0, 20.0, -30.0, 50.0, 40.0, 30.0, 480.0, 370.0, 0.0, 170.0, 70.0, 70.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 220.0, 100.0, 120.0, 0.0, 10.0, 160.0, 40.0, 60.0, 0.0, 50.0, 210.0, -10.0, 340.0, 20.0, 10.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 40.0, 0.0, 190.0, 200.0, 30.0, 20.0, 10.0, 250.0, 70.0, 320.0, 90.0, 10.0, -40.0, 350.0, 20.0, 240.0, 80.0, 180.0, 160.0, 110.0, 50.0, 270.0, 50.0, 10.0, 90.0, 40.0, 430.0, 110.0, 30.0, 230.0, 150.0, 10.0, 580.0, 0.0, -10.0, 120.0, 220.0, 100.0, 50.0, 110.0, 310.0, 50.0, 20.0, 60.0, 150.0, 390.0, 20.0, -20.0, 260.0, 540.0, 50.0, -10.0, 300.0, 250.0, 580.0, 60.0, -30.0, 50.0, 130.0, 180.0, 180.0, 80.0, -20.0, 20.0, 430.0, 400.0, 80.0, 80.0, 430.0, 170.0, 50.0, 10.0, 50.0, 50.0, -60.0, 10.0, 290.0, 110.0, 40.0, 10.0, 30.0, 40.0, 20.0, 600.0, 110.0, 90.0, 80.0, 460.0, 20.0, 0.0, 30.0, 130.0, 370.0, 50.0, 30.0, 40.0, 30.0, 30.0, 0.0, -20.0, 180.0, 80.0, 700.0, 30.0, 100.0, 180.0, 20.0, 220.0, 120.0, 30.0, 20.0, 300.0, 30.0, 190.0, 20.0, 10.0, 320.0, -30.0, 120.0, 50.0, 0.0, 670.0, 30.0, 30.0, -20.0, 20.0, 80.0, 40.0, 60.0, 790.0, 50.0, 10.0, 150.0, 50.0, 0.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 40.0, 350.0, 180.0, 180.0, 20.0, 220.0, 40.0, 0.0, 50.0, 0.0, 30.0, 400.0, 90.0, 330.0, 170.0, 30.0, 20.0, 70.0, 210.0, 420.0, 0.0, 340.0, 150.0, 60.0, 130.0, 90.0, 350.0, 80.0, 320.0, 20.0, 170.0, 140.0, 940.0, 70.0, 20.0, 90.0, 25.0, 190.0, 570.0, 70.0, 30.0, 0.0, -20.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 80.0, 50.0, 10.0, 20.0, 30.0, 190.0, 0.0, 0.0, 80.0, 350.0, 40.0, 180.0, 10.0, 50.0, 30.0, 20.0, 10.0, 80.0, 10.0, -100.0, 80.0, 0.0, 80.0, 330.0, 690.0, 10.0, 80.0, 20.0, 50.0, -50.0, 100.0, 30.0, 580.0, 510.0, 110.0, -20.0, 70.0, 130.0, 370.0, 30.0, 110.0, 200.0, 70.0, 50.0, 100.0, 10.0, 40.0, 80.0, -90.0, 210.0, 80.0, 120.0, 290.0, 60.0, 460.0, 350.0, 80.0, 160.0, 450.0, 90.0, 170.0, 30.0, 460.0, 110.0, 70.0, 70.0, 10.0, 90.0, 150.0, 60.0, 30.0, 20.0, 170.0, 20.0, 60.0, 20.0, 750.0, 70.0, 50.0, 180.0, 300.0, 40.0, 200.0, 45.0, 310.0, 170.0, 210.0, 100.0, 40.0, 10.0, 90.0, 230.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 520.0, 20.0, 70.0, 50.0, 210.0, 750.0, 60.0, 70.0, 40.0, 60.0, 160.0, 30.0, 20.0, 190.0, 240.0, 180.0, 450.0, 20.0, 220.0, 660.0, 40.0, 210.0, 10.0, 10.0, 90.0, 20.0, 320.0, 50.0, 30.0, 200.0, 60.0, 10.0, 300.0, 40.0, 520.0, 340.0, 160.0, 80.0, 30.0, 0.0, 70.0, 280.0, 150.0, 280.0, 110.0, 120.0, 90.0, 150.0, 30.0, 600.0, 190.0, 40.0, 80.0, 20.0, 20.0, 30.0, 40.0, 150.0, 100.0, 0.0, 50.0, 110.0, 10.0, 30.0, 510.0, 290.0, 50.0, 270.0, 20.0, 80.0, 40.0, 20.0, 90.0, 50.0, 10.0, 10.0, 20.0, 120.0, 10.0, 160.0, 140.0, 10.0, 30.0, -15.0, 30.0, 20.0, 90.0, 0.0, 40.0, 10.0, 30.0, 90.0, 350.0, 10.0, 70.0, 460.0, 20.0, 40.0, 180.0, 0.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 120.0, 180.0, 80.0, 170.0, 180.0, -20.0, 290.0, 60.0, 20.0, 130.0, 360.0, 90.0, 50.0, 70.0, 20.0, 40.0, 100.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 150.0, 60.0, 20.0, 30.0, 60.0, -40.0, 290.0, 20.0, 10.0, 20.0, 40.0, -60.0, 40.0, 0.0, 130.0, 10.0, 230.0, 300.0, 30.0, 20.0, 90.0, 10.0, 0.0, 390.0, 20.0, 50.0, 0.0, 0.0, 160.0, 30.0, 0.0, 10.0, 360.0, 30.0, 120.0, 20.0, 0.0, -90.0, 30.0, -70.0, 20.0, 40.0, -20.0, -40.0, 30.0, 100.0, -40.0, 60.0, 580.0, 70.0, 20.0, 0.0, 70.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 10.0, 0.0, -30.0, 90.0, 30.0, 500.0, 120.0, 80.0, 20.0, 360.0, 20.0, 290.0, 30.0, 510.0, 80.0, 100.0, 10.0, 320.0, 60.0, 50.0, -10.0, 0.0, 110.0, 10.0, 650.0, 0.0, 20.0, 20.0, 30.0, 20.0, 20.0, 180.0, 30.0, 100.0, 100.0, 60.0, 40.0, 160.0, 40.0, 20.0, 10.0, 0.0, 40.0, 40.0, -40.0, 370.0, 40.0, 10.0, 0.0, -20.0, 20.0, -5.0, 80.0, 10.0, 20.0, 30.0, 50.0, 190.0, 370.0, 90.0, 280.0, 100.0, -10.0, 220.0, 20.0, 190.0, 30.0, -30.0, 360.0, 130.0, 130.0, 60.0, 30.0, 70.0, -10.0, 20.0, 30.0, 10.0, 50.0, -40.0, 790.0, 200.0, 60.0, 80.0, 50.0, 50.0, 440.0, 510.0, 100.0, 60.0, 140.0, 50.0, 50.0, 70.0, 20.0, 340.0, 290.0, 180.0, 110.0, 80.0, 150.0, 380.0, 30.0, 50.0, 60.0, 150.0, 20.0, 20.0, 20.0, 60.0, 40.0, 20.0, 250.0, 0.0, 30.0, 270.0, -40.0, 20.0, -55.0, 70.0, 360.0, 470.0, 120.0, 100.0, 60.0, 60.0, 130.0, 310.0, 620.0, 0.0, 80.0, 510.0, 100.0, 50.0, 60.0, 250.0, 70.0, 150.0, 60.0, 50.0, 210.0, 30.0, 260.0, 120.0, 10.0, 170.0, 90.0, 50.0, 0.0, 0.0, 30.0, 20.0, 210.0, 10.0, 330.0, 0.0, 100.0, 20.0, 40.0, 250.0, 160.0, 20.0, 530.0, 210.0, 240.0, 120.0, 30.0, 60.0, 40.0, 80.0, 10.0, 390.0, 70.0, 10.0, 30.0, 280.0, 170.0, 150.0, 70.0, 90.0, 30.0, 0.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 90.0, -120.0, 20.0, 20.0, 110.0, 20.0, 45.0, 80.0, 650.0, 40.0, 10.0, 50.0, 20.0, 140.0, 570.0, 0.0, 200.0, 0.0, 10.0, -30.0, 180.0, 0.0, 0.0, 170.0, 20.0, 290.0, 350.0, 20.0, 130.0, 160.0, 10.0, 20.0, 90.0, 50.0, 370.0, 60.0, 130.0, -10.0, 100.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 0.0, 20.0, 50.0, 20.0, 110.0, 210.0, 50.0, 490.0, 110.0, 10.0, 0.0, 40.0, 40.0, 230.0, 20.0, 110.0, 200.0, 120.0, 80.0, 40.0, 0.0, 220.0, 20.0, 40.0, 20.0, 20.0, 10.0, 0.0, 40.0, 10.0, 170.0, 180.0, 280.0, 40.0, 20.0, 230.0, 40.0, 470.0, 70.0, 90.0, -20.0, 20.0, 110.0, 70.0, 10.0, 370.0, 10.0, 40.0, 20.0, 210.0, -60.0, 100.0, 310.0, 270.0, 80.0, -50.0, 240.0, 340.0, 30.0, 150.0, 20.0, 50.0, 170.0, 0.0, 50.0, 30.0, 20.0, 20.0, 70.0, 30.0, 40.0, 50.0, 100.0, 260.0, 90.0, 0.0, 380.0, 0.0, 0.0, 70.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 20.0, 70.0, 470.0, 60.0, 380.0, 70.0, 260.0, 80.0, 40.0, 220.0, 60.0, 90.0, 120.0, 0.0, 150.0, 300.0, 30.0, 90.0, 30.0, 100.0, 50.0, 50.0, 320.0, 40.0, 100.0, 90.0, 380.0, 230.0, 70.0, 70.0, 20.0, 20.0, 100.0, 90.0, 50.0, 10.0, 60.0, 120.0, 70.0, 40.0, 20.0, 0.0, 10.0, 120.0, 510.0, 40.0, 40.0, 250.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0964279889057718, "mean_inference_ms": 2.076341610244618, "mean_action_processing_ms": 0.5587710676700156, "mean_env_wait_ms": 1.798133840472193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04090690612792969, "StateBufferConnector_ms": 0.015530586242675781, "ViewRequirementAgentConnector_ms": 0.7471325397491455}, "num_episodes": 18, "episode_return_max": 2170.0, "episode_return_min": 170.0, "episode_return_mean": 1090.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.289966152670178, "num_env_steps_trained_throughput_per_sec": 14.289966152670178, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 292843.117, "restore_workers_time_ms": 0.014, "training_step_time_ms": 292843.062, "sample_time_ms": 5158.608, "learn_time_ms": 287650.332, "learn_throughput": 13.906, "synch_weights_time_ms": 14.084}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 76, "trial_id": "3d3a5_00000", "date": "2024-06-01_10-57-51", "timestamp": 1717253871, "time_this_iter_s": 279.9524772167206, "time_total_s": 44687.2628698349, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f86eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44687.2628698349, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 53.27569620253165, "ram_util_percent": 82.64835443037975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1338773196688092, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.067480665070815, "policy_loss": -0.006486435998374987, "vf_loss": 6.073247071043752, "vf_explained_var": 0.00021173853082017015, "kl": 0.007200324712660253, "entropy": 0.3120054773740367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 718335.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "env_runners": {"episode_reward_max": 2170.0, "episode_reward_min": 170.0, "episode_reward_mean": 1037.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 103.765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1480.0, 730.0, 1490.0, 1010.0, 1020.0, 1390.0, 1130.0, 1120.0, 1820.0, 1875.0, 980.0, 390.0, 850.0, 1200.0, 1510.0, 1060.0, 1720.0, 1550.0, 1350.0, 1605.0, 490.0, 1850.0, 2170.0, 980.0, 1540.0, 1880.0, 670.0, 1420.0, 530.0, 355.0, 1250.0, 670.0, 1230.0, 390.0, 510.0, 790.0, 660.0, 430.0, 800.0, 190.0, 1190.0, 1440.0, 880.0, 740.0, 460.0, 1115.0, 1140.0, 1010.0, 1690.0, 1340.0, 830.0, 925.0, 1950.0, 1510.0, 760.0, 1140.0, 1340.0, 1290.0, 260.0, 925.0, 1040.0, 1130.0, 980.0, 240.0, 1290.0, 850.0, 770.0, 1100.0, 1280.0, 1030.0, 670.0, 620.0, 1450.0, 1100.0, 1390.0, 610.0, 1100.0, 1240.0, 340.0, 1580.0, 2090.0, 800.0, 1100.0, 800.0, 170.0, 560.0, 400.0, 1040.0, 1155.0, 1500.0, 390.0, 980.0, 660.0, 1390.0, 940.0, 1020.0, 280.0, 940.0, 570.0, 1150.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 30.0, 40.0, 20.0, 600.0, 110.0, 90.0, 80.0, 460.0, 20.0, 0.0, 30.0, 130.0, 370.0, 50.0, 30.0, 40.0, 30.0, 30.0, 0.0, -20.0, 180.0, 80.0, 700.0, 30.0, 100.0, 180.0, 20.0, 220.0, 120.0, 30.0, 20.0, 300.0, 30.0, 190.0, 20.0, 10.0, 320.0, -30.0, 120.0, 50.0, 0.0, 670.0, 30.0, 30.0, -20.0, 20.0, 80.0, 40.0, 60.0, 790.0, 50.0, 10.0, 150.0, 50.0, 0.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 40.0, 350.0, 180.0, 180.0, 20.0, 220.0, 40.0, 0.0, 50.0, 0.0, 30.0, 400.0, 90.0, 330.0, 170.0, 30.0, 20.0, 70.0, 210.0, 420.0, 0.0, 340.0, 150.0, 60.0, 130.0, 90.0, 350.0, 80.0, 320.0, 20.0, 170.0, 140.0, 940.0, 70.0, 20.0, 90.0, 25.0, 190.0, 570.0, 70.0, 30.0, 0.0, -20.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 80.0, 50.0, 10.0, 20.0, 30.0, 190.0, 0.0, 0.0, 80.0, 350.0, 40.0, 180.0, 10.0, 50.0, 30.0, 20.0, 10.0, 80.0, 10.0, -100.0, 80.0, 0.0, 80.0, 330.0, 690.0, 10.0, 80.0, 20.0, 50.0, -50.0, 100.0, 30.0, 580.0, 510.0, 110.0, -20.0, 70.0, 130.0, 370.0, 30.0, 110.0, 200.0, 70.0, 50.0, 100.0, 10.0, 40.0, 80.0, -90.0, 210.0, 80.0, 120.0, 290.0, 60.0, 460.0, 350.0, 80.0, 160.0, 450.0, 90.0, 170.0, 30.0, 460.0, 110.0, 70.0, 70.0, 10.0, 90.0, 150.0, 60.0, 30.0, 20.0, 170.0, 20.0, 60.0, 20.0, 750.0, 70.0, 50.0, 180.0, 300.0, 40.0, 200.0, 45.0, 310.0, 170.0, 210.0, 100.0, 40.0, 10.0, 90.0, 230.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 520.0, 20.0, 70.0, 50.0, 210.0, 750.0, 60.0, 70.0, 40.0, 60.0, 160.0, 30.0, 20.0, 190.0, 240.0, 180.0, 450.0, 20.0, 220.0, 660.0, 40.0, 210.0, 10.0, 10.0, 90.0, 20.0, 320.0, 50.0, 30.0, 200.0, 60.0, 10.0, 300.0, 40.0, 520.0, 340.0, 160.0, 80.0, 30.0, 0.0, 70.0, 280.0, 150.0, 280.0, 110.0, 120.0, 90.0, 150.0, 30.0, 600.0, 190.0, 40.0, 80.0, 20.0, 20.0, 30.0, 40.0, 150.0, 100.0, 0.0, 50.0, 110.0, 10.0, 30.0, 510.0, 290.0, 50.0, 270.0, 20.0, 80.0, 40.0, 20.0, 90.0, 50.0, 10.0, 10.0, 20.0, 120.0, 10.0, 160.0, 140.0, 10.0, 30.0, -15.0, 30.0, 20.0, 90.0, 0.0, 40.0, 10.0, 30.0, 90.0, 350.0, 10.0, 70.0, 460.0, 20.0, 40.0, 180.0, 0.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 120.0, 180.0, 80.0, 170.0, 180.0, -20.0, 290.0, 60.0, 20.0, 130.0, 360.0, 90.0, 50.0, 70.0, 20.0, 40.0, 100.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 150.0, 60.0, 20.0, 30.0, 60.0, -40.0, 290.0, 20.0, 10.0, 20.0, 40.0, -60.0, 40.0, 0.0, 130.0, 10.0, 230.0, 300.0, 30.0, 20.0, 90.0, 10.0, 0.0, 390.0, 20.0, 50.0, 0.0, 0.0, 160.0, 30.0, 0.0, 10.0, 360.0, 30.0, 120.0, 20.0, 0.0, -90.0, 30.0, -70.0, 20.0, 40.0, -20.0, -40.0, 30.0, 100.0, -40.0, 60.0, 580.0, 70.0, 20.0, 0.0, 70.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 10.0, 0.0, -30.0, 90.0, 30.0, 500.0, 120.0, 80.0, 20.0, 360.0, 20.0, 290.0, 30.0, 510.0, 80.0, 100.0, 10.0, 320.0, 60.0, 50.0, -10.0, 0.0, 110.0, 10.0, 650.0, 0.0, 20.0, 20.0, 30.0, 20.0, 20.0, 180.0, 30.0, 100.0, 100.0, 60.0, 40.0, 160.0, 40.0, 20.0, 10.0, 0.0, 40.0, 40.0, -40.0, 370.0, 40.0, 10.0, 0.0, -20.0, 20.0, -5.0, 80.0, 10.0, 20.0, 30.0, 50.0, 190.0, 370.0, 90.0, 280.0, 100.0, -10.0, 220.0, 20.0, 190.0, 30.0, -30.0, 360.0, 130.0, 130.0, 60.0, 30.0, 70.0, -10.0, 20.0, 30.0, 10.0, 50.0, -40.0, 790.0, 200.0, 60.0, 80.0, 50.0, 50.0, 440.0, 510.0, 100.0, 60.0, 140.0, 50.0, 50.0, 70.0, 20.0, 340.0, 290.0, 180.0, 110.0, 80.0, 150.0, 380.0, 30.0, 50.0, 60.0, 150.0, 20.0, 20.0, 20.0, 60.0, 40.0, 20.0, 250.0, 0.0, 30.0, 270.0, -40.0, 20.0, -55.0, 70.0, 360.0, 470.0, 120.0, 100.0, 60.0, 60.0, 130.0, 310.0, 620.0, 0.0, 80.0, 510.0, 100.0, 50.0, 60.0, 250.0, 70.0, 150.0, 60.0, 50.0, 210.0, 30.0, 260.0, 120.0, 10.0, 170.0, 90.0, 50.0, 0.0, 0.0, 30.0, 20.0, 210.0, 10.0, 330.0, 0.0, 100.0, 20.0, 40.0, 250.0, 160.0, 20.0, 530.0, 210.0, 240.0, 120.0, 30.0, 60.0, 40.0, 80.0, 10.0, 390.0, 70.0, 10.0, 30.0, 280.0, 170.0, 150.0, 70.0, 90.0, 30.0, 0.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 90.0, -120.0, 20.0, 20.0, 110.0, 20.0, 45.0, 80.0, 650.0, 40.0, 10.0, 50.0, 20.0, 140.0, 570.0, 0.0, 200.0, 0.0, 10.0, -30.0, 180.0, 0.0, 0.0, 170.0, 20.0, 290.0, 350.0, 20.0, 130.0, 160.0, 10.0, 20.0, 90.0, 50.0, 370.0, 60.0, 130.0, -10.0, 100.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 0.0, 20.0, 50.0, 20.0, 110.0, 210.0, 50.0, 490.0, 110.0, 10.0, 0.0, 40.0, 40.0, 230.0, 20.0, 110.0, 200.0, 120.0, 80.0, 40.0, 0.0, 220.0, 20.0, 40.0, 20.0, 20.0, 10.0, 0.0, 40.0, 10.0, 170.0, 180.0, 280.0, 40.0, 20.0, 230.0, 40.0, 470.0, 70.0, 90.0, -20.0, 20.0, 110.0, 70.0, 10.0, 370.0, 10.0, 40.0, 20.0, 210.0, -60.0, 100.0, 310.0, 270.0, 80.0, -50.0, 240.0, 340.0, 30.0, 150.0, 20.0, 50.0, 170.0, 0.0, 50.0, 30.0, 20.0, 20.0, 70.0, 30.0, 40.0, 50.0, 100.0, 260.0, 90.0, 0.0, 380.0, 0.0, 0.0, 70.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 20.0, 70.0, 470.0, 60.0, 380.0, 70.0, 260.0, 80.0, 40.0, 220.0, 60.0, 90.0, 120.0, 0.0, 150.0, 300.0, 30.0, 90.0, 30.0, 100.0, 50.0, 50.0, 320.0, 40.0, 100.0, 90.0, 380.0, 230.0, 70.0, 70.0, 20.0, 20.0, 100.0, 90.0, 50.0, 10.0, 60.0, 120.0, 70.0, 40.0, 20.0, 0.0, 10.0, 120.0, 510.0, 40.0, 40.0, 250.0, 350.0, 160.0, 260.0, 120.0, 70.0, 40.0, 0.0, 0.0, 90.0, 150.0, 10.0, 30.0, 10.0, 190.0, 10.0, 0.0, 60.0, 40.0, -10.0, 0.0, 50.0, 500.0, 70.0, 60.0, 30.0, 30.0, 260.0, 180.0, 310.0, 90.0, 340.0, 180.0, 60.0, 70.0, 60.0, 90.0, -40.0, 720.0, 420.0, 190.0, 30.0, 20.0, 20.0, 410.0, 0.0, 170.0, 10.0, 140.0, 0.0, 0.0, 0.0, 180.0, 70.0, 170.0, 20.0, 70.0, 70.0, 140.0, 140.0, 240.0, 150.0, 210.0, -140.0, 110.0, 400.0, 100.0, 40.0, 0.0, -140.0, 70.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 30.0, 30.0, 240.0, 20.0, 10.0, 80.0, 50.0, 180.0, 40.0, 20.0, 0.0, 90.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 280.0, 180.0, 70.0, 70.0, 60.0, 40.0, 280.0, 10.0, 30.0, 360.0, 50.0, 450.0, 50.0, 100.0, 120.0, 20.0, 0.0, -35.0, 40.0, 100.0, 10.0, 140.0, 440.0, 410.0, -10.0, 160.0, 200.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 60.0, 150.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 150.0, 10.0, 40.0, 380.0, 50.0, 30.0, 190.0, 110.0, 40.0, 50.0, 10.0, 200.0, 0.0, 70.0, 0.0, 180.0, 50.0, 60.0, 140.0, 30.0, 430.0, 100.0, 30.0, 130.0, 130.0, 60.0, 300.0, 40.0, 30.0, 460.0, 80.0, 20.0, 20.0, 30.0, 80.0, 100.0, 30.0, 90.0, 0.0, 340.0, 130.0, 40.0, 210.0, 20.0, 10.0, 100.0, 70.0, 100.0, 150.0, 20.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 480.0, 40.0, 30.0, 50.0, 190.0, 70.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 110.0, 260.0, 40.0, 20.0, 70.0, 260.0, 110.0, 10.0, 160.0, 270.0, 30.0, 20.0, 160.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.111121626878301, "mean_inference_ms": 2.101043986124377, "mean_action_processing_ms": 0.5641465996599482, "mean_env_wait_ms": 1.8138016132896673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03864455223083496, "StateBufferConnector_ms": 0.015303373336791992, "ViewRequirementAgentConnector_ms": 0.7829961776733398}, "num_episodes": 23, "episode_return_max": 2170.0, "episode_return_min": 170.0, "episode_return_mean": 1037.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 13.987713634667188, "num_env_steps_trained_throughput_per_sec": 13.987713634667188, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 3080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3080000, "timers": {"training_iteration_time_ms": 291152.968, "restore_workers_time_ms": 0.014, "training_step_time_ms": 291152.901, "sample_time_ms": 5440.267, "learn_time_ms": 285677.653, "learn_throughput": 14.002, "synch_weights_time_ms": 14.373}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "done": false, "training_iteration": 77, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-02-37", "timestamp": 1717254157, "time_this_iter_s": 286.00121212005615, "time_total_s": 44973.264081954956, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7f84c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44973.264081954956, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 55.96064356435643, "ram_util_percent": 82.33613861386138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7571773873096583, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.488498839732811, "policy_loss": -0.00624867928508447, "vf_loss": 6.494041761118003, "vf_explained_var": 0.0002304811320238855, "kl": 0.007057503212428294, "entropy": 0.31013328876897805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 727725.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 2170.0, "episode_reward_min": 100.0, "episode_reward_mean": 1013.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 101.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1350.0, 1605.0, 490.0, 1850.0, 2170.0, 980.0, 1540.0, 1880.0, 670.0, 1420.0, 530.0, 355.0, 1250.0, 670.0, 1230.0, 390.0, 510.0, 790.0, 660.0, 430.0, 800.0, 190.0, 1190.0, 1440.0, 880.0, 740.0, 460.0, 1115.0, 1140.0, 1010.0, 1690.0, 1340.0, 830.0, 925.0, 1950.0, 1510.0, 760.0, 1140.0, 1340.0, 1290.0, 260.0, 925.0, 1040.0, 1130.0, 980.0, 240.0, 1290.0, 850.0, 770.0, 1100.0, 1280.0, 1030.0, 670.0, 620.0, 1450.0, 1100.0, 1390.0, 610.0, 1100.0, 1240.0, 340.0, 1580.0, 2090.0, 800.0, 1100.0, 800.0, 170.0, 560.0, 400.0, 1040.0, 1155.0, 1500.0, 390.0, 980.0, 660.0, 1390.0, 940.0, 1020.0, 280.0, 940.0, 570.0, 1150.0, 855.0, 1710.0, 1255.0, 840.0, 1020.0, 1155.0, 1130.0, 330.0, 1250.0, 380.0, 1460.0, 100.0, 1200.0, 955.0, 1380.0, 1740.0, 1640.0, 1535.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 60.0, 30.0, 20.0, 170.0, 20.0, 60.0, 20.0, 750.0, 70.0, 50.0, 180.0, 300.0, 40.0, 200.0, 45.0, 310.0, 170.0, 210.0, 100.0, 40.0, 10.0, 90.0, 230.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 520.0, 20.0, 70.0, 50.0, 210.0, 750.0, 60.0, 70.0, 40.0, 60.0, 160.0, 30.0, 20.0, 190.0, 240.0, 180.0, 450.0, 20.0, 220.0, 660.0, 40.0, 210.0, 10.0, 10.0, 90.0, 20.0, 320.0, 50.0, 30.0, 200.0, 60.0, 10.0, 300.0, 40.0, 520.0, 340.0, 160.0, 80.0, 30.0, 0.0, 70.0, 280.0, 150.0, 280.0, 110.0, 120.0, 90.0, 150.0, 30.0, 600.0, 190.0, 40.0, 80.0, 20.0, 20.0, 30.0, 40.0, 150.0, 100.0, 0.0, 50.0, 110.0, 10.0, 30.0, 510.0, 290.0, 50.0, 270.0, 20.0, 80.0, 40.0, 20.0, 90.0, 50.0, 10.0, 10.0, 20.0, 120.0, 10.0, 160.0, 140.0, 10.0, 30.0, -15.0, 30.0, 20.0, 90.0, 0.0, 40.0, 10.0, 30.0, 90.0, 350.0, 10.0, 70.0, 460.0, 20.0, 40.0, 180.0, 0.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 120.0, 180.0, 80.0, 170.0, 180.0, -20.0, 290.0, 60.0, 20.0, 130.0, 360.0, 90.0, 50.0, 70.0, 20.0, 40.0, 100.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 150.0, 60.0, 20.0, 30.0, 60.0, -40.0, 290.0, 20.0, 10.0, 20.0, 40.0, -60.0, 40.0, 0.0, 130.0, 10.0, 230.0, 300.0, 30.0, 20.0, 90.0, 10.0, 0.0, 390.0, 20.0, 50.0, 0.0, 0.0, 160.0, 30.0, 0.0, 10.0, 360.0, 30.0, 120.0, 20.0, 0.0, -90.0, 30.0, -70.0, 20.0, 40.0, -20.0, -40.0, 30.0, 100.0, -40.0, 60.0, 580.0, 70.0, 20.0, 0.0, 70.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 10.0, 0.0, -30.0, 90.0, 30.0, 500.0, 120.0, 80.0, 20.0, 360.0, 20.0, 290.0, 30.0, 510.0, 80.0, 100.0, 10.0, 320.0, 60.0, 50.0, -10.0, 0.0, 110.0, 10.0, 650.0, 0.0, 20.0, 20.0, 30.0, 20.0, 20.0, 180.0, 30.0, 100.0, 100.0, 60.0, 40.0, 160.0, 40.0, 20.0, 10.0, 0.0, 40.0, 40.0, -40.0, 370.0, 40.0, 10.0, 0.0, -20.0, 20.0, -5.0, 80.0, 10.0, 20.0, 30.0, 50.0, 190.0, 370.0, 90.0, 280.0, 100.0, -10.0, 220.0, 20.0, 190.0, 30.0, -30.0, 360.0, 130.0, 130.0, 60.0, 30.0, 70.0, -10.0, 20.0, 30.0, 10.0, 50.0, -40.0, 790.0, 200.0, 60.0, 80.0, 50.0, 50.0, 440.0, 510.0, 100.0, 60.0, 140.0, 50.0, 50.0, 70.0, 20.0, 340.0, 290.0, 180.0, 110.0, 80.0, 150.0, 380.0, 30.0, 50.0, 60.0, 150.0, 20.0, 20.0, 20.0, 60.0, 40.0, 20.0, 250.0, 0.0, 30.0, 270.0, -40.0, 20.0, -55.0, 70.0, 360.0, 470.0, 120.0, 100.0, 60.0, 60.0, 130.0, 310.0, 620.0, 0.0, 80.0, 510.0, 100.0, 50.0, 60.0, 250.0, 70.0, 150.0, 60.0, 50.0, 210.0, 30.0, 260.0, 120.0, 10.0, 170.0, 90.0, 50.0, 0.0, 0.0, 30.0, 20.0, 210.0, 10.0, 330.0, 0.0, 100.0, 20.0, 40.0, 250.0, 160.0, 20.0, 530.0, 210.0, 240.0, 120.0, 30.0, 60.0, 40.0, 80.0, 10.0, 390.0, 70.0, 10.0, 30.0, 280.0, 170.0, 150.0, 70.0, 90.0, 30.0, 0.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 90.0, -120.0, 20.0, 20.0, 110.0, 20.0, 45.0, 80.0, 650.0, 40.0, 10.0, 50.0, 20.0, 140.0, 570.0, 0.0, 200.0, 0.0, 10.0, -30.0, 180.0, 0.0, 0.0, 170.0, 20.0, 290.0, 350.0, 20.0, 130.0, 160.0, 10.0, 20.0, 90.0, 50.0, 370.0, 60.0, 130.0, -10.0, 100.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 0.0, 20.0, 50.0, 20.0, 110.0, 210.0, 50.0, 490.0, 110.0, 10.0, 0.0, 40.0, 40.0, 230.0, 20.0, 110.0, 200.0, 120.0, 80.0, 40.0, 0.0, 220.0, 20.0, 40.0, 20.0, 20.0, 10.0, 0.0, 40.0, 10.0, 170.0, 180.0, 280.0, 40.0, 20.0, 230.0, 40.0, 470.0, 70.0, 90.0, -20.0, 20.0, 110.0, 70.0, 10.0, 370.0, 10.0, 40.0, 20.0, 210.0, -60.0, 100.0, 310.0, 270.0, 80.0, -50.0, 240.0, 340.0, 30.0, 150.0, 20.0, 50.0, 170.0, 0.0, 50.0, 30.0, 20.0, 20.0, 70.0, 30.0, 40.0, 50.0, 100.0, 260.0, 90.0, 0.0, 380.0, 0.0, 0.0, 70.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 20.0, 70.0, 470.0, 60.0, 380.0, 70.0, 260.0, 80.0, 40.0, 220.0, 60.0, 90.0, 120.0, 0.0, 150.0, 300.0, 30.0, 90.0, 30.0, 100.0, 50.0, 50.0, 320.0, 40.0, 100.0, 90.0, 380.0, 230.0, 70.0, 70.0, 20.0, 20.0, 100.0, 90.0, 50.0, 10.0, 60.0, 120.0, 70.0, 40.0, 20.0, 0.0, 10.0, 120.0, 510.0, 40.0, 40.0, 250.0, 350.0, 160.0, 260.0, 120.0, 70.0, 40.0, 0.0, 0.0, 90.0, 150.0, 10.0, 30.0, 10.0, 190.0, 10.0, 0.0, 60.0, 40.0, -10.0, 0.0, 50.0, 500.0, 70.0, 60.0, 30.0, 30.0, 260.0, 180.0, 310.0, 90.0, 340.0, 180.0, 60.0, 70.0, 60.0, 90.0, -40.0, 720.0, 420.0, 190.0, 30.0, 20.0, 20.0, 410.0, 0.0, 170.0, 10.0, 140.0, 0.0, 0.0, 0.0, 180.0, 70.0, 170.0, 20.0, 70.0, 70.0, 140.0, 140.0, 240.0, 150.0, 210.0, -140.0, 110.0, 400.0, 100.0, 40.0, 0.0, -140.0, 70.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 30.0, 30.0, 240.0, 20.0, 10.0, 80.0, 50.0, 180.0, 40.0, 20.0, 0.0, 90.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 280.0, 180.0, 70.0, 70.0, 60.0, 40.0, 280.0, 10.0, 30.0, 360.0, 50.0, 450.0, 50.0, 100.0, 120.0, 20.0, 0.0, -35.0, 40.0, 100.0, 10.0, 140.0, 440.0, 410.0, -10.0, 160.0, 200.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 60.0, 150.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 150.0, 10.0, 40.0, 380.0, 50.0, 30.0, 190.0, 110.0, 40.0, 50.0, 10.0, 200.0, 0.0, 70.0, 0.0, 180.0, 50.0, 60.0, 140.0, 30.0, 430.0, 100.0, 30.0, 130.0, 130.0, 60.0, 300.0, 40.0, 30.0, 460.0, 80.0, 20.0, 20.0, 30.0, 80.0, 100.0, 30.0, 90.0, 0.0, 340.0, 130.0, 40.0, 210.0, 20.0, 10.0, 100.0, 70.0, 100.0, 150.0, 20.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 480.0, 40.0, 30.0, 50.0, 190.0, 70.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 110.0, 260.0, 40.0, 20.0, 70.0, 260.0, 110.0, 10.0, 160.0, 270.0, 30.0, 20.0, 160.0, 60.0, 80.0, 30.0, 50.0, 90.0, 0.0, 20.0, 210.0, 170.0, 25.0, 180.0, 350.0, 50.0, 350.0, 740.0, 70.0, 60.0, 120.0, 20.0, 70.0, -120.0, 60.0, 30.0, 50.0, 170.0, 5.0, 130.0, 310.0, 30.0, 430.0, 40.0, 10.0, 10.0, 20.0, 680.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 100.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 260.0, 0.0, 530.0, 50.0, 40.0, 15.0, 50.0, 440.0, 450.0, 10.0, 40.0, 60.0, 0.0, 430.0, 30.0, 130.0, 60.0, 50.0, 120.0, 0.0, 50.0, 260.0, 0.0, 30.0, 50.0, 30.0, 80.0, 0.0, 0.0, 20.0, 70.0, 0.0, 50.0, 30.0, 370.0, 40.0, 110.0, 130.0, 0.0, 170.0, 30.0, 350.0, 20.0, 10.0, 40.0, 180.0, 10.0, -40.0, 0.0, 20.0, 140.0, 0.0, 20.0, 90.0, 230.0, 40.0, 240.0, 50.0, 60.0, 60.0, 310.0, 190.0, 190.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 100.0, 110.0, 120.0, 110.0, 360.0, 110.0, 30.0, -10.0, 280.0, -10.0, 180.0, 280.0, 120.0, 50.0, 30.0, 0.0, 35.0, 80.0, 140.0, 40.0, 80.0, 500.0, -10.0, 350.0, 420.0, 20.0, -70.0, 30.0, 20.0, 40.0, 120.0, 40.0, 70.0, 570.0, 170.0, 30.0, 200.0, 180.0, 360.0, 0.0, 40.0, 410.0, 380.0, 60.0, 30.0, 60.0, 60.0, 40.0, 150.0, 410.0, 290.0, 330.0, 10.0, 230.0, 70.0, 50.0, 110.0, 320.0, 30.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1214393460555385, "mean_inference_ms": 2.118559194628467, "mean_action_processing_ms": 0.5678480048630717, "mean_env_wait_ms": 1.824469095318134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03991198539733887, "StateBufferConnector_ms": 0.02486872673034668, "ViewRequirementAgentConnector_ms": 0.9449777603149414}, "num_episodes": 18, "episode_return_max": 2170.0, "episode_return_min": 100.0, "episode_return_mean": 1013.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.38002924010543, "num_env_steps_trained_throughput_per_sec": 15.38002924010543, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 274884.659, "restore_workers_time_ms": 0.014, "training_step_time_ms": 274884.592, "sample_time_ms": 5725.612, "learn_time_ms": 269124.069, "learn_throughput": 14.863, "synch_weights_time_ms": 14.119}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 78, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-06-57", "timestamp": 1717254417, "time_this_iter_s": 260.1453540325165, "time_total_s": 45233.40943598747, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f85a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45233.40943598747, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 48.2491847826087, "ram_util_percent": 82.32554347826087}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0126234774328013, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.841928924767735, "policy_loss": -0.008047620792197771, "vf_loss": 6.849135263075336, "vf_explained_var": 2.051850858206947e-05, "kl": 0.008412747653559084, "entropy": 0.3001618830493083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 737115.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 100.0, "episode_reward_mean": 1016.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 101.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [660.0, 430.0, 800.0, 190.0, 1190.0, 1440.0, 880.0, 740.0, 460.0, 1115.0, 1140.0, 1010.0, 1690.0, 1340.0, 830.0, 925.0, 1950.0, 1510.0, 760.0, 1140.0, 1340.0, 1290.0, 260.0, 925.0, 1040.0, 1130.0, 980.0, 240.0, 1290.0, 850.0, 770.0, 1100.0, 1280.0, 1030.0, 670.0, 620.0, 1450.0, 1100.0, 1390.0, 610.0, 1100.0, 1240.0, 340.0, 1580.0, 2090.0, 800.0, 1100.0, 800.0, 170.0, 560.0, 400.0, 1040.0, 1155.0, 1500.0, 390.0, 980.0, 660.0, 1390.0, 940.0, 1020.0, 280.0, 940.0, 570.0, 1150.0, 855.0, 1710.0, 1255.0, 840.0, 1020.0, 1155.0, 1130.0, 330.0, 1250.0, 380.0, 1460.0, 100.0, 1200.0, 955.0, 1380.0, 1740.0, 1640.0, 1535.0, 1330.0, 1240.0, 1070.0, 530.0, 1070.0, 1695.0, 680.0, 630.0, 1660.0, 1445.0, 1480.0, 1290.0, 835.0, 1490.0, 290.0, 1510.0, 1280.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 390.0, 20.0, 50.0, 0.0, 0.0, 160.0, 30.0, 0.0, 10.0, 360.0, 30.0, 120.0, 20.0, 0.0, -90.0, 30.0, -70.0, 20.0, 40.0, -20.0, -40.0, 30.0, 100.0, -40.0, 60.0, 580.0, 70.0, 20.0, 0.0, 70.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 10.0, 0.0, -30.0, 90.0, 30.0, 500.0, 120.0, 80.0, 20.0, 360.0, 20.0, 290.0, 30.0, 510.0, 80.0, 100.0, 10.0, 320.0, 60.0, 50.0, -10.0, 0.0, 110.0, 10.0, 650.0, 0.0, 20.0, 20.0, 30.0, 20.0, 20.0, 180.0, 30.0, 100.0, 100.0, 60.0, 40.0, 160.0, 40.0, 20.0, 10.0, 0.0, 40.0, 40.0, -40.0, 370.0, 40.0, 10.0, 0.0, -20.0, 20.0, -5.0, 80.0, 10.0, 20.0, 30.0, 50.0, 190.0, 370.0, 90.0, 280.0, 100.0, -10.0, 220.0, 20.0, 190.0, 30.0, -30.0, 360.0, 130.0, 130.0, 60.0, 30.0, 70.0, -10.0, 20.0, 30.0, 10.0, 50.0, -40.0, 790.0, 200.0, 60.0, 80.0, 50.0, 50.0, 440.0, 510.0, 100.0, 60.0, 140.0, 50.0, 50.0, 70.0, 20.0, 340.0, 290.0, 180.0, 110.0, 80.0, 150.0, 380.0, 30.0, 50.0, 60.0, 150.0, 20.0, 20.0, 20.0, 60.0, 40.0, 20.0, 250.0, 0.0, 30.0, 270.0, -40.0, 20.0, -55.0, 70.0, 360.0, 470.0, 120.0, 100.0, 60.0, 60.0, 130.0, 310.0, 620.0, 0.0, 80.0, 510.0, 100.0, 50.0, 60.0, 250.0, 70.0, 150.0, 60.0, 50.0, 210.0, 30.0, 260.0, 120.0, 10.0, 170.0, 90.0, 50.0, 0.0, 0.0, 30.0, 20.0, 210.0, 10.0, 330.0, 0.0, 100.0, 20.0, 40.0, 250.0, 160.0, 20.0, 530.0, 210.0, 240.0, 120.0, 30.0, 60.0, 40.0, 80.0, 10.0, 390.0, 70.0, 10.0, 30.0, 280.0, 170.0, 150.0, 70.0, 90.0, 30.0, 0.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 90.0, -120.0, 20.0, 20.0, 110.0, 20.0, 45.0, 80.0, 650.0, 40.0, 10.0, 50.0, 20.0, 140.0, 570.0, 0.0, 200.0, 0.0, 10.0, -30.0, 180.0, 0.0, 0.0, 170.0, 20.0, 290.0, 350.0, 20.0, 130.0, 160.0, 10.0, 20.0, 90.0, 50.0, 370.0, 60.0, 130.0, -10.0, 100.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 0.0, 20.0, 50.0, 20.0, 110.0, 210.0, 50.0, 490.0, 110.0, 10.0, 0.0, 40.0, 40.0, 230.0, 20.0, 110.0, 200.0, 120.0, 80.0, 40.0, 0.0, 220.0, 20.0, 40.0, 20.0, 20.0, 10.0, 0.0, 40.0, 10.0, 170.0, 180.0, 280.0, 40.0, 20.0, 230.0, 40.0, 470.0, 70.0, 90.0, -20.0, 20.0, 110.0, 70.0, 10.0, 370.0, 10.0, 40.0, 20.0, 210.0, -60.0, 100.0, 310.0, 270.0, 80.0, -50.0, 240.0, 340.0, 30.0, 150.0, 20.0, 50.0, 170.0, 0.0, 50.0, 30.0, 20.0, 20.0, 70.0, 30.0, 40.0, 50.0, 100.0, 260.0, 90.0, 0.0, 380.0, 0.0, 0.0, 70.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 20.0, 70.0, 470.0, 60.0, 380.0, 70.0, 260.0, 80.0, 40.0, 220.0, 60.0, 90.0, 120.0, 0.0, 150.0, 300.0, 30.0, 90.0, 30.0, 100.0, 50.0, 50.0, 320.0, 40.0, 100.0, 90.0, 380.0, 230.0, 70.0, 70.0, 20.0, 20.0, 100.0, 90.0, 50.0, 10.0, 60.0, 120.0, 70.0, 40.0, 20.0, 0.0, 10.0, 120.0, 510.0, 40.0, 40.0, 250.0, 350.0, 160.0, 260.0, 120.0, 70.0, 40.0, 0.0, 0.0, 90.0, 150.0, 10.0, 30.0, 10.0, 190.0, 10.0, 0.0, 60.0, 40.0, -10.0, 0.0, 50.0, 500.0, 70.0, 60.0, 30.0, 30.0, 260.0, 180.0, 310.0, 90.0, 340.0, 180.0, 60.0, 70.0, 60.0, 90.0, -40.0, 720.0, 420.0, 190.0, 30.0, 20.0, 20.0, 410.0, 0.0, 170.0, 10.0, 140.0, 0.0, 0.0, 0.0, 180.0, 70.0, 170.0, 20.0, 70.0, 70.0, 140.0, 140.0, 240.0, 150.0, 210.0, -140.0, 110.0, 400.0, 100.0, 40.0, 0.0, -140.0, 70.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 30.0, 30.0, 240.0, 20.0, 10.0, 80.0, 50.0, 180.0, 40.0, 20.0, 0.0, 90.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 280.0, 180.0, 70.0, 70.0, 60.0, 40.0, 280.0, 10.0, 30.0, 360.0, 50.0, 450.0, 50.0, 100.0, 120.0, 20.0, 0.0, -35.0, 40.0, 100.0, 10.0, 140.0, 440.0, 410.0, -10.0, 160.0, 200.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 60.0, 150.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 150.0, 10.0, 40.0, 380.0, 50.0, 30.0, 190.0, 110.0, 40.0, 50.0, 10.0, 200.0, 0.0, 70.0, 0.0, 180.0, 50.0, 60.0, 140.0, 30.0, 430.0, 100.0, 30.0, 130.0, 130.0, 60.0, 300.0, 40.0, 30.0, 460.0, 80.0, 20.0, 20.0, 30.0, 80.0, 100.0, 30.0, 90.0, 0.0, 340.0, 130.0, 40.0, 210.0, 20.0, 10.0, 100.0, 70.0, 100.0, 150.0, 20.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 480.0, 40.0, 30.0, 50.0, 190.0, 70.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 110.0, 260.0, 40.0, 20.0, 70.0, 260.0, 110.0, 10.0, 160.0, 270.0, 30.0, 20.0, 160.0, 60.0, 80.0, 30.0, 50.0, 90.0, 0.0, 20.0, 210.0, 170.0, 25.0, 180.0, 350.0, 50.0, 350.0, 740.0, 70.0, 60.0, 120.0, 20.0, 70.0, -120.0, 60.0, 30.0, 50.0, 170.0, 5.0, 130.0, 310.0, 30.0, 430.0, 40.0, 10.0, 10.0, 20.0, 680.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 100.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 260.0, 0.0, 530.0, 50.0, 40.0, 15.0, 50.0, 440.0, 450.0, 10.0, 40.0, 60.0, 0.0, 430.0, 30.0, 130.0, 60.0, 50.0, 120.0, 0.0, 50.0, 260.0, 0.0, 30.0, 50.0, 30.0, 80.0, 0.0, 0.0, 20.0, 70.0, 0.0, 50.0, 30.0, 370.0, 40.0, 110.0, 130.0, 0.0, 170.0, 30.0, 350.0, 20.0, 10.0, 40.0, 180.0, 10.0, -40.0, 0.0, 20.0, 140.0, 0.0, 20.0, 90.0, 230.0, 40.0, 240.0, 50.0, 60.0, 60.0, 310.0, 190.0, 190.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 100.0, 110.0, 120.0, 110.0, 360.0, 110.0, 30.0, -10.0, 280.0, -10.0, 180.0, 280.0, 120.0, 50.0, 30.0, 0.0, 35.0, 80.0, 140.0, 40.0, 80.0, 500.0, -10.0, 350.0, 420.0, 20.0, -70.0, 30.0, 20.0, 40.0, 120.0, 40.0, 70.0, 570.0, 170.0, 30.0, 200.0, 180.0, 360.0, 0.0, 40.0, 410.0, 380.0, 60.0, 30.0, 60.0, 60.0, 40.0, 150.0, 410.0, 290.0, 330.0, 10.0, 230.0, 70.0, 50.0, 110.0, 320.0, 30.0, 95.0, 30.0, 390.0, 260.0, 80.0, 120.0, 20.0, 60.0, 200.0, 20.0, 150.0, 180.0, 50.0, 80.0, 80.0, 130.0, 110.0, 370.0, 10.0, 90.0, 140.0, 20.0, 50.0, 70.0, 40.0, 400.0, 40.0, 30.0, 300.0, 120.0, 0.0, 0.0, 40.0, 30.0, 290.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 80.0, 200.0, 30.0, 40.0, 20.0, 420.0, 40.0, 10.0, 150.0, 80.0, 160.0, 20.0, 30.0, 260.0, 50.0, 340.0, 420.0, 85.0, 300.0, 30.0, 10.0, 160.0, 230.0, 160.0, 10.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 380.0, 80.0, 50.0, 160.0, 30.0, 20.0, 80.0, 450.0, 180.0, 420.0, 190.0, 140.0, 190.0, 60.0, 110.0, 75.0, 100.0, 370.0, 320.0, -20.0, 100.0, 130.0, 110.0, 240.0, 440.0, 70.0, 30.0, 150.0, 80.0, 60.0, 170.0, 190.0, 70.0, 30.0, 120.0, 210.0, -140.0, 230.0, 390.0, 10.0, 180.0, 10.0, 120.0, 80.0, 0.0, -40.0, 430.0, 170.0, 30.0, -5.0, 40.0, 130.0, 30.0, 70.0, 360.0, 320.0, 60.0, 100.0, 170.0, 190.0, 60.0, 0.0, 0.0, 40.0, 70.0, 30.0, 0.0, 10.0, 50.0, 70.0, 20.0, -90.0, 740.0, 170.0, 40.0, 490.0, 50.0, 60.0, 50.0, 20.0, -20.0, 20.0, 0.0, 280.0, 20.0, 150.0, 80.0, 50.0, 260.0, 40.0, 380.0, -30.0, 20.0, -20.0, 10.0, 0.0, 10.0, 40.0, 370.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.128831128333991, "mean_inference_ms": 2.1316514774414683, "mean_action_processing_ms": 0.5703400212713821, "mean_env_wait_ms": 1.8321063725477773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03804469108581543, "StateBufferConnector_ms": 0.023406267166137695, "ViewRequirementAgentConnector_ms": 0.8642551898956299}, "num_episodes": 18, "episode_return_max": 2090.0, "episode_return_min": 100.0, "episode_return_mean": 1016.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.73582220495952, "num_env_steps_trained_throughput_per_sec": 19.73582220495952, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 3160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3160000, "timers": {"training_iteration_time_ms": 267779.554, "restore_workers_time_ms": 0.013, "training_step_time_ms": 267779.49, "sample_time_ms": 5400.082, "learn_time_ms": 262347.296, "learn_throughput": 15.247, "synch_weights_time_ms": 13.324}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "done": false, "training_iteration": 79, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-10-20", "timestamp": 1717254620, "time_this_iter_s": 202.71626806259155, "time_total_s": 45436.125704050064, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8873a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45436.125704050064, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 21.51881533101045, "ram_util_percent": 82.46898954703832}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9971085347497044, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006515413919648233, "vf_loss": 6.391324447189023, "vf_explained_var": 0.00033399484281976634, "kl": Infinity, "entropy": 0.31218649240347524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 746505.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 100.0, "episode_reward_mean": 1025.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 102.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [260.0, 925.0, 1040.0, 1130.0, 980.0, 240.0, 1290.0, 850.0, 770.0, 1100.0, 1280.0, 1030.0, 670.0, 620.0, 1450.0, 1100.0, 1390.0, 610.0, 1100.0, 1240.0, 340.0, 1580.0, 2090.0, 800.0, 1100.0, 800.0, 170.0, 560.0, 400.0, 1040.0, 1155.0, 1500.0, 390.0, 980.0, 660.0, 1390.0, 940.0, 1020.0, 280.0, 940.0, 570.0, 1150.0, 855.0, 1710.0, 1255.0, 840.0, 1020.0, 1155.0, 1130.0, 330.0, 1250.0, 380.0, 1460.0, 100.0, 1200.0, 955.0, 1380.0, 1740.0, 1640.0, 1535.0, 1330.0, 1240.0, 1070.0, 530.0, 1070.0, 1695.0, 680.0, 630.0, 1660.0, 1445.0, 1480.0, 1290.0, 835.0, 1490.0, 290.0, 1510.0, 1280.0, 420.0, 765.0, 530.0, 560.0, 1260.0, 1290.0, 1550.0, 1385.0, 2030.0, 1370.0, 340.0, 1265.0, 470.0, 285.0, 1200.0, 1850.0, 570.0, 690.0, 880.0, 1775.0, 850.0, 1100.0, 1680.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 90.0, -120.0, 20.0, 20.0, 110.0, 20.0, 45.0, 80.0, 650.0, 40.0, 10.0, 50.0, 20.0, 140.0, 570.0, 0.0, 200.0, 0.0, 10.0, -30.0, 180.0, 0.0, 0.0, 170.0, 20.0, 290.0, 350.0, 20.0, 130.0, 160.0, 10.0, 20.0, 90.0, 50.0, 370.0, 60.0, 130.0, -10.0, 100.0, 0.0, 0.0, 30.0, 10.0, 100.0, 10.0, 0.0, 20.0, 50.0, 20.0, 110.0, 210.0, 50.0, 490.0, 110.0, 10.0, 0.0, 40.0, 40.0, 230.0, 20.0, 110.0, 200.0, 120.0, 80.0, 40.0, 0.0, 220.0, 20.0, 40.0, 20.0, 20.0, 10.0, 0.0, 40.0, 10.0, 170.0, 180.0, 280.0, 40.0, 20.0, 230.0, 40.0, 470.0, 70.0, 90.0, -20.0, 20.0, 110.0, 70.0, 10.0, 370.0, 10.0, 40.0, 20.0, 210.0, -60.0, 100.0, 310.0, 270.0, 80.0, -50.0, 240.0, 340.0, 30.0, 150.0, 20.0, 50.0, 170.0, 0.0, 50.0, 30.0, 20.0, 20.0, 70.0, 30.0, 40.0, 50.0, 100.0, 260.0, 90.0, 0.0, 380.0, 0.0, 0.0, 70.0, 10.0, 20.0, 30.0, 20.0, 30.0, 10.0, 20.0, 70.0, 470.0, 60.0, 380.0, 70.0, 260.0, 80.0, 40.0, 220.0, 60.0, 90.0, 120.0, 0.0, 150.0, 300.0, 30.0, 90.0, 30.0, 100.0, 50.0, 50.0, 320.0, 40.0, 100.0, 90.0, 380.0, 230.0, 70.0, 70.0, 20.0, 20.0, 100.0, 90.0, 50.0, 10.0, 60.0, 120.0, 70.0, 40.0, 20.0, 0.0, 10.0, 120.0, 510.0, 40.0, 40.0, 250.0, 350.0, 160.0, 260.0, 120.0, 70.0, 40.0, 0.0, 0.0, 90.0, 150.0, 10.0, 30.0, 10.0, 190.0, 10.0, 0.0, 60.0, 40.0, -10.0, 0.0, 50.0, 500.0, 70.0, 60.0, 30.0, 30.0, 260.0, 180.0, 310.0, 90.0, 340.0, 180.0, 60.0, 70.0, 60.0, 90.0, -40.0, 720.0, 420.0, 190.0, 30.0, 20.0, 20.0, 410.0, 0.0, 170.0, 10.0, 140.0, 0.0, 0.0, 0.0, 180.0, 70.0, 170.0, 20.0, 70.0, 70.0, 140.0, 140.0, 240.0, 150.0, 210.0, -140.0, 110.0, 400.0, 100.0, 40.0, 0.0, -140.0, 70.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 30.0, 30.0, 240.0, 20.0, 10.0, 80.0, 50.0, 180.0, 40.0, 20.0, 0.0, 90.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 280.0, 180.0, 70.0, 70.0, 60.0, 40.0, 280.0, 10.0, 30.0, 360.0, 50.0, 450.0, 50.0, 100.0, 120.0, 20.0, 0.0, -35.0, 40.0, 100.0, 10.0, 140.0, 440.0, 410.0, -10.0, 160.0, 200.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 60.0, 150.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 150.0, 10.0, 40.0, 380.0, 50.0, 30.0, 190.0, 110.0, 40.0, 50.0, 10.0, 200.0, 0.0, 70.0, 0.0, 180.0, 50.0, 60.0, 140.0, 30.0, 430.0, 100.0, 30.0, 130.0, 130.0, 60.0, 300.0, 40.0, 30.0, 460.0, 80.0, 20.0, 20.0, 30.0, 80.0, 100.0, 30.0, 90.0, 0.0, 340.0, 130.0, 40.0, 210.0, 20.0, 10.0, 100.0, 70.0, 100.0, 150.0, 20.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 480.0, 40.0, 30.0, 50.0, 190.0, 70.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 110.0, 260.0, 40.0, 20.0, 70.0, 260.0, 110.0, 10.0, 160.0, 270.0, 30.0, 20.0, 160.0, 60.0, 80.0, 30.0, 50.0, 90.0, 0.0, 20.0, 210.0, 170.0, 25.0, 180.0, 350.0, 50.0, 350.0, 740.0, 70.0, 60.0, 120.0, 20.0, 70.0, -120.0, 60.0, 30.0, 50.0, 170.0, 5.0, 130.0, 310.0, 30.0, 430.0, 40.0, 10.0, 10.0, 20.0, 680.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 100.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 260.0, 0.0, 530.0, 50.0, 40.0, 15.0, 50.0, 440.0, 450.0, 10.0, 40.0, 60.0, 0.0, 430.0, 30.0, 130.0, 60.0, 50.0, 120.0, 0.0, 50.0, 260.0, 0.0, 30.0, 50.0, 30.0, 80.0, 0.0, 0.0, 20.0, 70.0, 0.0, 50.0, 30.0, 370.0, 40.0, 110.0, 130.0, 0.0, 170.0, 30.0, 350.0, 20.0, 10.0, 40.0, 180.0, 10.0, -40.0, 0.0, 20.0, 140.0, 0.0, 20.0, 90.0, 230.0, 40.0, 240.0, 50.0, 60.0, 60.0, 310.0, 190.0, 190.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 100.0, 110.0, 120.0, 110.0, 360.0, 110.0, 30.0, -10.0, 280.0, -10.0, 180.0, 280.0, 120.0, 50.0, 30.0, 0.0, 35.0, 80.0, 140.0, 40.0, 80.0, 500.0, -10.0, 350.0, 420.0, 20.0, -70.0, 30.0, 20.0, 40.0, 120.0, 40.0, 70.0, 570.0, 170.0, 30.0, 200.0, 180.0, 360.0, 0.0, 40.0, 410.0, 380.0, 60.0, 30.0, 60.0, 60.0, 40.0, 150.0, 410.0, 290.0, 330.0, 10.0, 230.0, 70.0, 50.0, 110.0, 320.0, 30.0, 95.0, 30.0, 390.0, 260.0, 80.0, 120.0, 20.0, 60.0, 200.0, 20.0, 150.0, 180.0, 50.0, 80.0, 80.0, 130.0, 110.0, 370.0, 10.0, 90.0, 140.0, 20.0, 50.0, 70.0, 40.0, 400.0, 40.0, 30.0, 300.0, 120.0, 0.0, 0.0, 40.0, 30.0, 290.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 80.0, 200.0, 30.0, 40.0, 20.0, 420.0, 40.0, 10.0, 150.0, 80.0, 160.0, 20.0, 30.0, 260.0, 50.0, 340.0, 420.0, 85.0, 300.0, 30.0, 10.0, 160.0, 230.0, 160.0, 10.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 380.0, 80.0, 50.0, 160.0, 30.0, 20.0, 80.0, 450.0, 180.0, 420.0, 190.0, 140.0, 190.0, 60.0, 110.0, 75.0, 100.0, 370.0, 320.0, -20.0, 100.0, 130.0, 110.0, 240.0, 440.0, 70.0, 30.0, 150.0, 80.0, 60.0, 170.0, 190.0, 70.0, 30.0, 120.0, 210.0, -140.0, 230.0, 390.0, 10.0, 180.0, 10.0, 120.0, 80.0, 0.0, -40.0, 430.0, 170.0, 30.0, -5.0, 40.0, 130.0, 30.0, 70.0, 360.0, 320.0, 60.0, 100.0, 170.0, 190.0, 60.0, 0.0, 0.0, 40.0, 70.0, 30.0, 0.0, 10.0, 50.0, 70.0, 20.0, -90.0, 740.0, 170.0, 40.0, 490.0, 50.0, 60.0, 50.0, 20.0, -20.0, 20.0, 0.0, 280.0, 20.0, 150.0, 80.0, 50.0, 260.0, 40.0, 380.0, -30.0, 20.0, -20.0, 10.0, 0.0, 10.0, 40.0, 370.0, 10.0, 10.0, 285.0, -210.0, 120.0, 70.0, 40.0, 60.0, 180.0, 90.0, -50.0, 180.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 300.0, 50.0, 30.0, 70.0, 10.0, 10.0, 0.0, 320.0, 120.0, 0.0, 30.0, 0.0, 10.0, 60.0, 110.0, 10.0, 200.0, 10.0, 70.0, 380.0, 40.0, 240.0, 170.0, 30.0, 130.0, 110.0, 30.0, 110.0, 30.0, 370.0, 230.0, 20.0, 0.0, 260.0, 610.0, 170.0, 320.0, 20.0, 60.0, 50.0, 260.0, 50.0, 10.0, 0.0, 250.0, 190.0, 260.0, 30.0, 300.0, 70.0, 90.0, 55.0, 50.0, 90.0, 450.0, 190.0, 210.0, 420.0, 60.0, 30.0, 80.0, 60.0, -10.0, 540.0, 30.0, 30.0, 230.0, 330.0, 60.0, 210.0, 30.0, 150.0, 260.0, 40.0, 0.0, 20.0, 70.0, 70.0, 10.0, 10.0, 70.0, 40.0, 40.0, 10.0, 50.0, 270.0, 20.0, 0.0, 0.0, 450.0, 160.0, 175.0, 50.0, 90.0, 10.0, 20.0, 170.0, 190.0, 10.0, 30.0, 0.0, 40.0, 0.0, 0.0, 0.0, 40.0, 30.0, 100.0, 0.0, 0.0, 130.0, 0.0, 0.0, -15.0, 610.0, 40.0, 50.0, 30.0, 10.0, 130.0, -40.0, 20.0, 330.0, 20.0, 40.0, 350.0, 220.0, 140.0, 70.0, 260.0, 30.0, 440.0, 330.0, -30.0, 0.0, 20.0, 150.0, 40.0, 40.0, 20.0, 20.0, 160.0, 100.0, 20.0, 110.0, 150.0, 10.0, 80.0, 40.0, 40.0, 20.0, 20.0, 190.0, 30.0, 60.0, 420.0, 220.0, 60.0, 35.0, 100.0, 10.0, -55.0, 0.0, 30.0, 470.0, 10.0, 410.0, 120.0, 30.0, 200.0, 220.0, -5.0, 240.0, 80.0, 220.0, 70.0, 20.0, 40.0, 90.0, 240.0, 0.0, 30.0, 70.0, 70.0, 20.0, 340.0, 260.0, 10.0, 10.0, 20.0, 30.0, -30.0, 210.0, 230.0, 180.0, 20.0, 180.0, 150.0, 340.0, 190.0, 0.0, 320.0, 30.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.132132713036304, "mean_inference_ms": 2.141255715236347, "mean_action_processing_ms": 0.5719941087655117, "mean_env_wait_ms": 1.8370902681967516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022733688354492188, "StateBufferConnector_ms": 0.02159857749938965, "ViewRequirementAgentConnector_ms": 0.7447235584259033}, "num_episodes": 22, "episode_return_max": 2090.0, "episode_return_min": 100.0, "episode_return_mean": 1025.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.19267557958311, "num_env_steps_trained_throughput_per_sec": 20.19267557958311, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 261292.589, "restore_workers_time_ms": 0.013, "training_step_time_ms": 261292.526, "sample_time_ms": 5105.565, "learn_time_ms": 256156.122, "learn_throughput": 15.615, "synch_weights_time_ms": 13.243}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": false, "training_iteration": 80, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-13-38", "timestamp": 1717254818, "time_this_iter_s": 198.12588095664978, "time_total_s": 45634.251585006714, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dc3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45634.251585006714, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 20.067857142857143, "ram_util_percent": 81.10142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.120316269463751, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.770763505279573, "policy_loss": -0.006629821264033262, "vf_loss": 6.776441183790993, "vf_explained_var": 0.00041318719252483784, "kl": 0.00634757240425545, "entropy": 0.29959890729607863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 755895.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 100.0, "episode_reward_mean": 1052.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 105.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1100.0, 1240.0, 340.0, 1580.0, 2090.0, 800.0, 1100.0, 800.0, 170.0, 560.0, 400.0, 1040.0, 1155.0, 1500.0, 390.0, 980.0, 660.0, 1390.0, 940.0, 1020.0, 280.0, 940.0, 570.0, 1150.0, 855.0, 1710.0, 1255.0, 840.0, 1020.0, 1155.0, 1130.0, 330.0, 1250.0, 380.0, 1460.0, 100.0, 1200.0, 955.0, 1380.0, 1740.0, 1640.0, 1535.0, 1330.0, 1240.0, 1070.0, 530.0, 1070.0, 1695.0, 680.0, 630.0, 1660.0, 1445.0, 1480.0, 1290.0, 835.0, 1490.0, 290.0, 1510.0, 1280.0, 420.0, 765.0, 530.0, 560.0, 1260.0, 1290.0, 1550.0, 1385.0, 2030.0, 1370.0, 340.0, 1265.0, 470.0, 285.0, 1200.0, 1850.0, 570.0, 690.0, 880.0, 1775.0, 850.0, 1100.0, 1680.0, 1290.0, 530.0, 1260.0, 1600.0, 350.0, 1490.0, 920.0, 1130.0, 550.0, 1410.0, 1090.0, 1450.0, 1110.0, 1250.0, 990.0, 1300.0, 620.0, 1100.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 40.0, 20.0, 0.0, 10.0, 120.0, 510.0, 40.0, 40.0, 250.0, 350.0, 160.0, 260.0, 120.0, 70.0, 40.0, 0.0, 0.0, 90.0, 150.0, 10.0, 30.0, 10.0, 190.0, 10.0, 0.0, 60.0, 40.0, -10.0, 0.0, 50.0, 500.0, 70.0, 60.0, 30.0, 30.0, 260.0, 180.0, 310.0, 90.0, 340.0, 180.0, 60.0, 70.0, 60.0, 90.0, -40.0, 720.0, 420.0, 190.0, 30.0, 20.0, 20.0, 410.0, 0.0, 170.0, 10.0, 140.0, 0.0, 0.0, 0.0, 180.0, 70.0, 170.0, 20.0, 70.0, 70.0, 140.0, 140.0, 240.0, 150.0, 210.0, -140.0, 110.0, 400.0, 100.0, 40.0, 0.0, -140.0, 70.0, 40.0, 10.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 80.0, 0.0, 20.0, 30.0, 30.0, 240.0, 20.0, 10.0, 80.0, 50.0, 180.0, 40.0, 20.0, 0.0, 90.0, 30.0, 10.0, 10.0, 20.0, 0.0, 20.0, 280.0, 180.0, 70.0, 70.0, 60.0, 40.0, 280.0, 10.0, 30.0, 360.0, 50.0, 450.0, 50.0, 100.0, 120.0, 20.0, 0.0, -35.0, 40.0, 100.0, 10.0, 140.0, 440.0, 410.0, -10.0, 160.0, 200.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 60.0, 150.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 150.0, 10.0, 40.0, 380.0, 50.0, 30.0, 190.0, 110.0, 40.0, 50.0, 10.0, 200.0, 0.0, 70.0, 0.0, 180.0, 50.0, 60.0, 140.0, 30.0, 430.0, 100.0, 30.0, 130.0, 130.0, 60.0, 300.0, 40.0, 30.0, 460.0, 80.0, 20.0, 20.0, 30.0, 80.0, 100.0, 30.0, 90.0, 0.0, 340.0, 130.0, 40.0, 210.0, 20.0, 10.0, 100.0, 70.0, 100.0, 150.0, 20.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 480.0, 40.0, 30.0, 50.0, 190.0, 70.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 110.0, 260.0, 40.0, 20.0, 70.0, 260.0, 110.0, 10.0, 160.0, 270.0, 30.0, 20.0, 160.0, 60.0, 80.0, 30.0, 50.0, 90.0, 0.0, 20.0, 210.0, 170.0, 25.0, 180.0, 350.0, 50.0, 350.0, 740.0, 70.0, 60.0, 120.0, 20.0, 70.0, -120.0, 60.0, 30.0, 50.0, 170.0, 5.0, 130.0, 310.0, 30.0, 430.0, 40.0, 10.0, 10.0, 20.0, 680.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 100.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 260.0, 0.0, 530.0, 50.0, 40.0, 15.0, 50.0, 440.0, 450.0, 10.0, 40.0, 60.0, 0.0, 430.0, 30.0, 130.0, 60.0, 50.0, 120.0, 0.0, 50.0, 260.0, 0.0, 30.0, 50.0, 30.0, 80.0, 0.0, 0.0, 20.0, 70.0, 0.0, 50.0, 30.0, 370.0, 40.0, 110.0, 130.0, 0.0, 170.0, 30.0, 350.0, 20.0, 10.0, 40.0, 180.0, 10.0, -40.0, 0.0, 20.0, 140.0, 0.0, 20.0, 90.0, 230.0, 40.0, 240.0, 50.0, 60.0, 60.0, 310.0, 190.0, 190.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 100.0, 110.0, 120.0, 110.0, 360.0, 110.0, 30.0, -10.0, 280.0, -10.0, 180.0, 280.0, 120.0, 50.0, 30.0, 0.0, 35.0, 80.0, 140.0, 40.0, 80.0, 500.0, -10.0, 350.0, 420.0, 20.0, -70.0, 30.0, 20.0, 40.0, 120.0, 40.0, 70.0, 570.0, 170.0, 30.0, 200.0, 180.0, 360.0, 0.0, 40.0, 410.0, 380.0, 60.0, 30.0, 60.0, 60.0, 40.0, 150.0, 410.0, 290.0, 330.0, 10.0, 230.0, 70.0, 50.0, 110.0, 320.0, 30.0, 95.0, 30.0, 390.0, 260.0, 80.0, 120.0, 20.0, 60.0, 200.0, 20.0, 150.0, 180.0, 50.0, 80.0, 80.0, 130.0, 110.0, 370.0, 10.0, 90.0, 140.0, 20.0, 50.0, 70.0, 40.0, 400.0, 40.0, 30.0, 300.0, 120.0, 0.0, 0.0, 40.0, 30.0, 290.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 80.0, 200.0, 30.0, 40.0, 20.0, 420.0, 40.0, 10.0, 150.0, 80.0, 160.0, 20.0, 30.0, 260.0, 50.0, 340.0, 420.0, 85.0, 300.0, 30.0, 10.0, 160.0, 230.0, 160.0, 10.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 380.0, 80.0, 50.0, 160.0, 30.0, 20.0, 80.0, 450.0, 180.0, 420.0, 190.0, 140.0, 190.0, 60.0, 110.0, 75.0, 100.0, 370.0, 320.0, -20.0, 100.0, 130.0, 110.0, 240.0, 440.0, 70.0, 30.0, 150.0, 80.0, 60.0, 170.0, 190.0, 70.0, 30.0, 120.0, 210.0, -140.0, 230.0, 390.0, 10.0, 180.0, 10.0, 120.0, 80.0, 0.0, -40.0, 430.0, 170.0, 30.0, -5.0, 40.0, 130.0, 30.0, 70.0, 360.0, 320.0, 60.0, 100.0, 170.0, 190.0, 60.0, 0.0, 0.0, 40.0, 70.0, 30.0, 0.0, 10.0, 50.0, 70.0, 20.0, -90.0, 740.0, 170.0, 40.0, 490.0, 50.0, 60.0, 50.0, 20.0, -20.0, 20.0, 0.0, 280.0, 20.0, 150.0, 80.0, 50.0, 260.0, 40.0, 380.0, -30.0, 20.0, -20.0, 10.0, 0.0, 10.0, 40.0, 370.0, 10.0, 10.0, 285.0, -210.0, 120.0, 70.0, 40.0, 60.0, 180.0, 90.0, -50.0, 180.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 300.0, 50.0, 30.0, 70.0, 10.0, 10.0, 0.0, 320.0, 120.0, 0.0, 30.0, 0.0, 10.0, 60.0, 110.0, 10.0, 200.0, 10.0, 70.0, 380.0, 40.0, 240.0, 170.0, 30.0, 130.0, 110.0, 30.0, 110.0, 30.0, 370.0, 230.0, 20.0, 0.0, 260.0, 610.0, 170.0, 320.0, 20.0, 60.0, 50.0, 260.0, 50.0, 10.0, 0.0, 250.0, 190.0, 260.0, 30.0, 300.0, 70.0, 90.0, 55.0, 50.0, 90.0, 450.0, 190.0, 210.0, 420.0, 60.0, 30.0, 80.0, 60.0, -10.0, 540.0, 30.0, 30.0, 230.0, 330.0, 60.0, 210.0, 30.0, 150.0, 260.0, 40.0, 0.0, 20.0, 70.0, 70.0, 10.0, 10.0, 70.0, 40.0, 40.0, 10.0, 50.0, 270.0, 20.0, 0.0, 0.0, 450.0, 160.0, 175.0, 50.0, 90.0, 10.0, 20.0, 170.0, 190.0, 10.0, 30.0, 0.0, 40.0, 0.0, 0.0, 0.0, 40.0, 30.0, 100.0, 0.0, 0.0, 130.0, 0.0, 0.0, -15.0, 610.0, 40.0, 50.0, 30.0, 10.0, 130.0, -40.0, 20.0, 330.0, 20.0, 40.0, 350.0, 220.0, 140.0, 70.0, 260.0, 30.0, 440.0, 330.0, -30.0, 0.0, 20.0, 150.0, 40.0, 40.0, 20.0, 20.0, 160.0, 100.0, 20.0, 110.0, 150.0, 10.0, 80.0, 40.0, 40.0, 20.0, 20.0, 190.0, 30.0, 60.0, 420.0, 220.0, 60.0, 35.0, 100.0, 10.0, -55.0, 0.0, 30.0, 470.0, 10.0, 410.0, 120.0, 30.0, 200.0, 220.0, -5.0, 240.0, 80.0, 220.0, 70.0, 20.0, 40.0, 90.0, 240.0, 0.0, 30.0, 70.0, 70.0, 20.0, 340.0, 260.0, 10.0, 10.0, 20.0, 30.0, -30.0, 210.0, 230.0, 180.0, 20.0, 180.0, 150.0, 340.0, 190.0, 0.0, 320.0, 30.0, 270.0, 50.0, 90.0, 90.0, 700.0, 40.0, 40.0, 30.0, 180.0, 20.0, 50.0, 150.0, 60.0, -10.0, 230.0, 10.0, 70.0, 30.0, 0.0, 0.0, -10.0, 70.0, 60.0, 10.0, 280.0, 230.0, 160.0, 210.0, 60.0, 90.0, 90.0, 60.0, 220.0, 30.0, 280.0, 30.0, 270.0, 330.0, 40.0, 250.0, 90.0, 30.0, 10.0, 20.0, 30.0, 20.0, 200.0, 20.0, 0.0, 20.0, 0.0, 130.0, 10.0, 90.0, 240.0, 20.0, 40.0, 70.0, 320.0, 530.0, 40.0, 40.0, 20.0, 50.0, 70.0, 90.0, 110.0, 210.0, 0.0, 10.0, 320.0, 440.0, 10.0, -10.0, -20.0, 80.0, 40.0, 540.0, -20.0, 40.0, 30.0, 20.0, 120.0, 40.0, 160.0, 90.0, 0.0, 20.0, 30.0, 30.0, 40.0, 170.0, 100.0, 300.0, 130.0, -50.0, 260.0, 70.0, 110.0, 30.0, 290.0, 120.0, 270.0, 130.0, 40.0, 40.0, -130.0, 130.0, 110.0, 150.0, 230.0, 530.0, 40.0, 90.0, 150.0, 250.0, 40.0, 30.0, 110.0, -10.0, 220.0, 220.0, 140.0, 480.0, 40.0, 20.0, 20.0, 30.0, 110.0, -40.0, 90.0, 30.0, 40.0, 160.0, 30.0, 30.0, 600.0, 40.0, 50.0, 160.0, 110.0, 10.0, 440.0, 120.0, 50.0, 320.0, 0.0, 60.0, 30.0, -40.0, 0.0, 50.0, 150.0, 30.0, 110.0, 390.0, 20.0, 20.0, 230.0, 260.0, 40.0, 0.0, 20.0, 270.0, 30.0, 60.0, 10.0, 30.0, 170.0, 0.0, 30.0, 20.0, 20.0, 0.0, 280.0, 30.0, 490.0, 40.0, 190.0, 50.0, -20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.130733485498882, "mean_inference_ms": 2.143550462993961, "mean_action_processing_ms": 0.571862679132705, "mean_env_wait_ms": 1.8367985855959907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021739482879638672, "StateBufferConnector_ms": 0.020516395568847656, "ViewRequirementAgentConnector_ms": 0.7017655372619629}, "num_episodes": 18, "episode_return_max": 2090.0, "episode_return_min": 100.0, "episode_return_mean": 1052.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.04180539916252, "num_env_steps_trained_throughput_per_sec": 20.04180539916252, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 3240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3240000, "timers": {"training_iteration_time_ms": 254302.536, "restore_workers_time_ms": 0.013, "training_step_time_ms": 254302.475, "sample_time_ms": 4860.937, "learn_time_ms": 249412.563, "learn_throughput": 16.038, "synch_weights_time_ms": 12.933}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "done": false, "training_iteration": 81, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-16-58", "timestamp": 1717255018, "time_this_iter_s": 199.60219383239746, "time_total_s": 45833.85377883911, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7e8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45833.85377883911, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.66631205673759, "ram_util_percent": 81.3450354609929}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5637604441061312, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.981493072133984, "policy_loss": -0.007658661186349944, "vf_loss": 6.988207785643962, "vf_explained_var": 0.00019219001642050454, "kl": 0.0062929921344093255, "entropy": 0.2833812117164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 765285.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "env_runners": {"episode_reward_max": 2140.0, "episode_reward_min": 100.0, "episode_reward_mean": 1091.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 109.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1150.0, 855.0, 1710.0, 1255.0, 840.0, 1020.0, 1155.0, 1130.0, 330.0, 1250.0, 380.0, 1460.0, 100.0, 1200.0, 955.0, 1380.0, 1740.0, 1640.0, 1535.0, 1330.0, 1240.0, 1070.0, 530.0, 1070.0, 1695.0, 680.0, 630.0, 1660.0, 1445.0, 1480.0, 1290.0, 835.0, 1490.0, 290.0, 1510.0, 1280.0, 420.0, 765.0, 530.0, 560.0, 1260.0, 1290.0, 1550.0, 1385.0, 2030.0, 1370.0, 340.0, 1265.0, 470.0, 285.0, 1200.0, 1850.0, 570.0, 690.0, 880.0, 1775.0, 850.0, 1100.0, 1680.0, 1290.0, 530.0, 1260.0, 1600.0, 350.0, 1490.0, 920.0, 1130.0, 550.0, 1410.0, 1090.0, 1450.0, 1110.0, 1250.0, 990.0, 1300.0, 620.0, 1100.0, 620.0, 930.0, 1120.0, 2090.0, 1250.0, 470.0, 700.0, 820.0, 560.0, 1090.0, 1415.0, 1240.0, 2140.0, 820.0, 610.0, 1250.0, 800.0, 1310.0, 1235.0, 1010.0, 430.0, 1250.0, 1800.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 260.0, 110.0, 10.0, 160.0, 270.0, 30.0, 20.0, 160.0, 60.0, 80.0, 30.0, 50.0, 90.0, 0.0, 20.0, 210.0, 170.0, 25.0, 180.0, 350.0, 50.0, 350.0, 740.0, 70.0, 60.0, 120.0, 20.0, 70.0, -120.0, 60.0, 30.0, 50.0, 170.0, 5.0, 130.0, 310.0, 30.0, 430.0, 40.0, 10.0, 10.0, 20.0, 680.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 100.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 260.0, 0.0, 530.0, 50.0, 40.0, 15.0, 50.0, 440.0, 450.0, 10.0, 40.0, 60.0, 0.0, 430.0, 30.0, 130.0, 60.0, 50.0, 120.0, 0.0, 50.0, 260.0, 0.0, 30.0, 50.0, 30.0, 80.0, 0.0, 0.0, 20.0, 70.0, 0.0, 50.0, 30.0, 370.0, 40.0, 110.0, 130.0, 0.0, 170.0, 30.0, 350.0, 20.0, 10.0, 40.0, 180.0, 10.0, -40.0, 0.0, 20.0, 140.0, 0.0, 20.0, 90.0, 230.0, 40.0, 240.0, 50.0, 60.0, 60.0, 310.0, 190.0, 190.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 100.0, 110.0, 120.0, 110.0, 360.0, 110.0, 30.0, -10.0, 280.0, -10.0, 180.0, 280.0, 120.0, 50.0, 30.0, 0.0, 35.0, 80.0, 140.0, 40.0, 80.0, 500.0, -10.0, 350.0, 420.0, 20.0, -70.0, 30.0, 20.0, 40.0, 120.0, 40.0, 70.0, 570.0, 170.0, 30.0, 200.0, 180.0, 360.0, 0.0, 40.0, 410.0, 380.0, 60.0, 30.0, 60.0, 60.0, 40.0, 150.0, 410.0, 290.0, 330.0, 10.0, 230.0, 70.0, 50.0, 110.0, 320.0, 30.0, 95.0, 30.0, 390.0, 260.0, 80.0, 120.0, 20.0, 60.0, 200.0, 20.0, 150.0, 180.0, 50.0, 80.0, 80.0, 130.0, 110.0, 370.0, 10.0, 90.0, 140.0, 20.0, 50.0, 70.0, 40.0, 400.0, 40.0, 30.0, 300.0, 120.0, 0.0, 0.0, 40.0, 30.0, 290.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 80.0, 200.0, 30.0, 40.0, 20.0, 420.0, 40.0, 10.0, 150.0, 80.0, 160.0, 20.0, 30.0, 260.0, 50.0, 340.0, 420.0, 85.0, 300.0, 30.0, 10.0, 160.0, 230.0, 160.0, 10.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 380.0, 80.0, 50.0, 160.0, 30.0, 20.0, 80.0, 450.0, 180.0, 420.0, 190.0, 140.0, 190.0, 60.0, 110.0, 75.0, 100.0, 370.0, 320.0, -20.0, 100.0, 130.0, 110.0, 240.0, 440.0, 70.0, 30.0, 150.0, 80.0, 60.0, 170.0, 190.0, 70.0, 30.0, 120.0, 210.0, -140.0, 230.0, 390.0, 10.0, 180.0, 10.0, 120.0, 80.0, 0.0, -40.0, 430.0, 170.0, 30.0, -5.0, 40.0, 130.0, 30.0, 70.0, 360.0, 320.0, 60.0, 100.0, 170.0, 190.0, 60.0, 0.0, 0.0, 40.0, 70.0, 30.0, 0.0, 10.0, 50.0, 70.0, 20.0, -90.0, 740.0, 170.0, 40.0, 490.0, 50.0, 60.0, 50.0, 20.0, -20.0, 20.0, 0.0, 280.0, 20.0, 150.0, 80.0, 50.0, 260.0, 40.0, 380.0, -30.0, 20.0, -20.0, 10.0, 0.0, 10.0, 40.0, 370.0, 10.0, 10.0, 285.0, -210.0, 120.0, 70.0, 40.0, 60.0, 180.0, 90.0, -50.0, 180.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 300.0, 50.0, 30.0, 70.0, 10.0, 10.0, 0.0, 320.0, 120.0, 0.0, 30.0, 0.0, 10.0, 60.0, 110.0, 10.0, 200.0, 10.0, 70.0, 380.0, 40.0, 240.0, 170.0, 30.0, 130.0, 110.0, 30.0, 110.0, 30.0, 370.0, 230.0, 20.0, 0.0, 260.0, 610.0, 170.0, 320.0, 20.0, 60.0, 50.0, 260.0, 50.0, 10.0, 0.0, 250.0, 190.0, 260.0, 30.0, 300.0, 70.0, 90.0, 55.0, 50.0, 90.0, 450.0, 190.0, 210.0, 420.0, 60.0, 30.0, 80.0, 60.0, -10.0, 540.0, 30.0, 30.0, 230.0, 330.0, 60.0, 210.0, 30.0, 150.0, 260.0, 40.0, 0.0, 20.0, 70.0, 70.0, 10.0, 10.0, 70.0, 40.0, 40.0, 10.0, 50.0, 270.0, 20.0, 0.0, 0.0, 450.0, 160.0, 175.0, 50.0, 90.0, 10.0, 20.0, 170.0, 190.0, 10.0, 30.0, 0.0, 40.0, 0.0, 0.0, 0.0, 40.0, 30.0, 100.0, 0.0, 0.0, 130.0, 0.0, 0.0, -15.0, 610.0, 40.0, 50.0, 30.0, 10.0, 130.0, -40.0, 20.0, 330.0, 20.0, 40.0, 350.0, 220.0, 140.0, 70.0, 260.0, 30.0, 440.0, 330.0, -30.0, 0.0, 20.0, 150.0, 40.0, 40.0, 20.0, 20.0, 160.0, 100.0, 20.0, 110.0, 150.0, 10.0, 80.0, 40.0, 40.0, 20.0, 20.0, 190.0, 30.0, 60.0, 420.0, 220.0, 60.0, 35.0, 100.0, 10.0, -55.0, 0.0, 30.0, 470.0, 10.0, 410.0, 120.0, 30.0, 200.0, 220.0, -5.0, 240.0, 80.0, 220.0, 70.0, 20.0, 40.0, 90.0, 240.0, 0.0, 30.0, 70.0, 70.0, 20.0, 340.0, 260.0, 10.0, 10.0, 20.0, 30.0, -30.0, 210.0, 230.0, 180.0, 20.0, 180.0, 150.0, 340.0, 190.0, 0.0, 320.0, 30.0, 270.0, 50.0, 90.0, 90.0, 700.0, 40.0, 40.0, 30.0, 180.0, 20.0, 50.0, 150.0, 60.0, -10.0, 230.0, 10.0, 70.0, 30.0, 0.0, 0.0, -10.0, 70.0, 60.0, 10.0, 280.0, 230.0, 160.0, 210.0, 60.0, 90.0, 90.0, 60.0, 220.0, 30.0, 280.0, 30.0, 270.0, 330.0, 40.0, 250.0, 90.0, 30.0, 10.0, 20.0, 30.0, 20.0, 200.0, 20.0, 0.0, 20.0, 0.0, 130.0, 10.0, 90.0, 240.0, 20.0, 40.0, 70.0, 320.0, 530.0, 40.0, 40.0, 20.0, 50.0, 70.0, 90.0, 110.0, 210.0, 0.0, 10.0, 320.0, 440.0, 10.0, -10.0, -20.0, 80.0, 40.0, 540.0, -20.0, 40.0, 30.0, 20.0, 120.0, 40.0, 160.0, 90.0, 0.0, 20.0, 30.0, 30.0, 40.0, 170.0, 100.0, 300.0, 130.0, -50.0, 260.0, 70.0, 110.0, 30.0, 290.0, 120.0, 270.0, 130.0, 40.0, 40.0, -130.0, 130.0, 110.0, 150.0, 230.0, 530.0, 40.0, 90.0, 150.0, 250.0, 40.0, 30.0, 110.0, -10.0, 220.0, 220.0, 140.0, 480.0, 40.0, 20.0, 20.0, 30.0, 110.0, -40.0, 90.0, 30.0, 40.0, 160.0, 30.0, 30.0, 600.0, 40.0, 50.0, 160.0, 110.0, 10.0, 440.0, 120.0, 50.0, 320.0, 0.0, 60.0, 30.0, -40.0, 0.0, 50.0, 150.0, 30.0, 110.0, 390.0, 20.0, 20.0, 230.0, 260.0, 40.0, 0.0, 20.0, 270.0, 30.0, 60.0, 10.0, 30.0, 170.0, 0.0, 30.0, 20.0, 20.0, 0.0, 280.0, 30.0, 490.0, 40.0, 190.0, 50.0, -20.0, 70.0, 0.0, 70.0, 50.0, 60.0, 90.0, 80.0, 150.0, 20.0, 30.0, 10.0, 0.0, 20.0, 520.0, 10.0, 0.0, 100.0, 150.0, 120.0, 0.0, 60.0, 80.0, 80.0, -50.0, 10.0, -20.0, 30.0, 280.0, 610.0, 40.0, 210.0, 630.0, 30.0, 40.0, 110.0, 20.0, 50.0, 10.0, 700.0, 290.0, 0.0, 30.0, 40.0, 70.0, 100.0, 50.0, 0.0, 520.0, 350.0, 90.0, 10.0, 150.0, 20.0, 10.0, 0.0, 20.0, 140.0, 0.0, 0.0, 120.0, -720.0, 230.0, 70.0, 210.0, 190.0, 60.0, 10.0, 480.0, 130.0, 40.0, 20.0, 30.0, 270.0, 10.0, 0.0, 300.0, 80.0, 40.0, 60.0, 10.0, 20.0, 0.0, 20.0, 210.0, 0.0, 200.0, 30.0, 40.0, 20.0, 20.0, 90.0, 20.0, 410.0, 40.0, -30.0, 40.0, 0.0, 20.0, 400.0, 100.0, 50.0, 90.0, 70.0, 30.0, 160.0, 10.0, -20.0, 185.0, 650.0, 190.0, 80.0, 10.0, 590.0, 40.0, 30.0, 80.0, 220.0, 30.0, 140.0, 20.0, 70.0, 740.0, 320.0, 30.0, 40.0, 420.0, 20.0, 110.0, 100.0, 290.0, 0.0, 140.0, 40.0, 160.0, 70.0, 110.0, 60.0, 220.0, -30.0, 50.0, 300.0, 10.0, 40.0, 20.0, 50.0, 130.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 50.0, 310.0, 10.0, 300.0, 370.0, 30.0, 10.0, 40.0, 170.0, 30.0, 30.0, 140.0, 260.0, 20.0, 20.0, 30.0, 90.0, 10.0, 20.0, 40.0, 320.0, 10.0, 180.0, 30.0, 470.0, 30.0, 90.0, 120.0, 40.0, 60.0, 10.0, -55.0, 280.0, 320.0, 110.0, 60.0, 260.0, 150.0, -40.0, 70.0, 70.0, 10.0, -30.0, -45.0, 410.0, 35.0, 520.0, 10.0, 30.0, 20.0, 190.0, 40.0, 0.0, 0.0, 30.0, 0.0, 100.0, 20.0, 0.0, 160.0, 80.0, 0.0, 330.0, 430.0, 50.0, 60.0, 40.0, 100.0, 70.0, 640.0, 140.0, 90.0, 60.0, 420.0, 50.0, 80.0, 200.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1259301742987047, "mean_inference_ms": 2.141497256250073, "mean_action_processing_ms": 0.5705520715353685, "mean_env_wait_ms": 1.8325554612779498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02120375633239746, "StateBufferConnector_ms": 0.020259618759155273, "ViewRequirementAgentConnector_ms": 0.633185625076294}, "num_episodes": 23, "episode_return_max": 2140.0, "episode_return_min": 100.0, "episode_return_mean": 1091.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.926192868607036, "num_env_steps_trained_throughput_per_sec": 19.926192868607036, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 3280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3280000, "timers": {"training_iteration_time_ms": 246805.521, "restore_workers_time_ms": 0.012, "training_step_time_ms": 246805.46, "sample_time_ms": 4641.572, "learn_time_ms": 242135.772, "learn_throughput": 16.52, "synch_weights_time_ms": 12.568}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "done": false, "training_iteration": 82, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-20-18", "timestamp": 1717255218, "time_this_iter_s": 200.77151894569397, "time_total_s": 46034.625297784805, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f892790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46034.625297784805, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.380281690140844, "ram_util_percent": 81.65985915492958}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6535543701963555, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.844872423838249, "policy_loss": -0.007119006932469103, "vf_loss": 6.8510532705674665, "vf_explained_var": 0.00035156614610308405, "kl": 0.006254413388509081, "entropy": 0.27965753252704306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 774675.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "env_runners": {"episode_reward_max": 2140.0, "episode_reward_min": 140.0, "episode_reward_mean": 1093.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 109.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1535.0, 1330.0, 1240.0, 1070.0, 530.0, 1070.0, 1695.0, 680.0, 630.0, 1660.0, 1445.0, 1480.0, 1290.0, 835.0, 1490.0, 290.0, 1510.0, 1280.0, 420.0, 765.0, 530.0, 560.0, 1260.0, 1290.0, 1550.0, 1385.0, 2030.0, 1370.0, 340.0, 1265.0, 470.0, 285.0, 1200.0, 1850.0, 570.0, 690.0, 880.0, 1775.0, 850.0, 1100.0, 1680.0, 1290.0, 530.0, 1260.0, 1600.0, 350.0, 1490.0, 920.0, 1130.0, 550.0, 1410.0, 1090.0, 1450.0, 1110.0, 1250.0, 990.0, 1300.0, 620.0, 1100.0, 620.0, 930.0, 1120.0, 2090.0, 1250.0, 470.0, 700.0, 820.0, 560.0, 1090.0, 1415.0, 1240.0, 2140.0, 820.0, 610.0, 1250.0, 800.0, 1310.0, 1235.0, 1010.0, 430.0, 1250.0, 1800.0, 700.0, 750.0, 1585.0, 140.0, 690.0, 1310.0, 1260.0, 1010.0, 1250.0, 760.0, 1520.0, 1120.0, 1220.0, 1670.0, 1110.0, 1130.0, 820.0, 1710.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [290.0, 330.0, 10.0, 230.0, 70.0, 50.0, 110.0, 320.0, 30.0, 95.0, 30.0, 390.0, 260.0, 80.0, 120.0, 20.0, 60.0, 200.0, 20.0, 150.0, 180.0, 50.0, 80.0, 80.0, 130.0, 110.0, 370.0, 10.0, 90.0, 140.0, 20.0, 50.0, 70.0, 40.0, 400.0, 40.0, 30.0, 300.0, 120.0, 0.0, 0.0, 40.0, 30.0, 290.0, 40.0, 50.0, 20.0, 20.0, 20.0, 20.0, 80.0, 200.0, 30.0, 40.0, 20.0, 420.0, 40.0, 10.0, 150.0, 80.0, 160.0, 20.0, 30.0, 260.0, 50.0, 340.0, 420.0, 85.0, 300.0, 30.0, 10.0, 160.0, 230.0, 160.0, 10.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 30.0, 60.0, 50.0, 40.0, 380.0, 80.0, 50.0, 160.0, 30.0, 20.0, 80.0, 450.0, 180.0, 420.0, 190.0, 140.0, 190.0, 60.0, 110.0, 75.0, 100.0, 370.0, 320.0, -20.0, 100.0, 130.0, 110.0, 240.0, 440.0, 70.0, 30.0, 150.0, 80.0, 60.0, 170.0, 190.0, 70.0, 30.0, 120.0, 210.0, -140.0, 230.0, 390.0, 10.0, 180.0, 10.0, 120.0, 80.0, 0.0, -40.0, 430.0, 170.0, 30.0, -5.0, 40.0, 130.0, 30.0, 70.0, 360.0, 320.0, 60.0, 100.0, 170.0, 190.0, 60.0, 0.0, 0.0, 40.0, 70.0, 30.0, 0.0, 10.0, 50.0, 70.0, 20.0, -90.0, 740.0, 170.0, 40.0, 490.0, 50.0, 60.0, 50.0, 20.0, -20.0, 20.0, 0.0, 280.0, 20.0, 150.0, 80.0, 50.0, 260.0, 40.0, 380.0, -30.0, 20.0, -20.0, 10.0, 0.0, 10.0, 40.0, 370.0, 10.0, 10.0, 285.0, -210.0, 120.0, 70.0, 40.0, 60.0, 180.0, 90.0, -50.0, 180.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 300.0, 50.0, 30.0, 70.0, 10.0, 10.0, 0.0, 320.0, 120.0, 0.0, 30.0, 0.0, 10.0, 60.0, 110.0, 10.0, 200.0, 10.0, 70.0, 380.0, 40.0, 240.0, 170.0, 30.0, 130.0, 110.0, 30.0, 110.0, 30.0, 370.0, 230.0, 20.0, 0.0, 260.0, 610.0, 170.0, 320.0, 20.0, 60.0, 50.0, 260.0, 50.0, 10.0, 0.0, 250.0, 190.0, 260.0, 30.0, 300.0, 70.0, 90.0, 55.0, 50.0, 90.0, 450.0, 190.0, 210.0, 420.0, 60.0, 30.0, 80.0, 60.0, -10.0, 540.0, 30.0, 30.0, 230.0, 330.0, 60.0, 210.0, 30.0, 150.0, 260.0, 40.0, 0.0, 20.0, 70.0, 70.0, 10.0, 10.0, 70.0, 40.0, 40.0, 10.0, 50.0, 270.0, 20.0, 0.0, 0.0, 450.0, 160.0, 175.0, 50.0, 90.0, 10.0, 20.0, 170.0, 190.0, 10.0, 30.0, 0.0, 40.0, 0.0, 0.0, 0.0, 40.0, 30.0, 100.0, 0.0, 0.0, 130.0, 0.0, 0.0, -15.0, 610.0, 40.0, 50.0, 30.0, 10.0, 130.0, -40.0, 20.0, 330.0, 20.0, 40.0, 350.0, 220.0, 140.0, 70.0, 260.0, 30.0, 440.0, 330.0, -30.0, 0.0, 20.0, 150.0, 40.0, 40.0, 20.0, 20.0, 160.0, 100.0, 20.0, 110.0, 150.0, 10.0, 80.0, 40.0, 40.0, 20.0, 20.0, 190.0, 30.0, 60.0, 420.0, 220.0, 60.0, 35.0, 100.0, 10.0, -55.0, 0.0, 30.0, 470.0, 10.0, 410.0, 120.0, 30.0, 200.0, 220.0, -5.0, 240.0, 80.0, 220.0, 70.0, 20.0, 40.0, 90.0, 240.0, 0.0, 30.0, 70.0, 70.0, 20.0, 340.0, 260.0, 10.0, 10.0, 20.0, 30.0, -30.0, 210.0, 230.0, 180.0, 20.0, 180.0, 150.0, 340.0, 190.0, 0.0, 320.0, 30.0, 270.0, 50.0, 90.0, 90.0, 700.0, 40.0, 40.0, 30.0, 180.0, 20.0, 50.0, 150.0, 60.0, -10.0, 230.0, 10.0, 70.0, 30.0, 0.0, 0.0, -10.0, 70.0, 60.0, 10.0, 280.0, 230.0, 160.0, 210.0, 60.0, 90.0, 90.0, 60.0, 220.0, 30.0, 280.0, 30.0, 270.0, 330.0, 40.0, 250.0, 90.0, 30.0, 10.0, 20.0, 30.0, 20.0, 200.0, 20.0, 0.0, 20.0, 0.0, 130.0, 10.0, 90.0, 240.0, 20.0, 40.0, 70.0, 320.0, 530.0, 40.0, 40.0, 20.0, 50.0, 70.0, 90.0, 110.0, 210.0, 0.0, 10.0, 320.0, 440.0, 10.0, -10.0, -20.0, 80.0, 40.0, 540.0, -20.0, 40.0, 30.0, 20.0, 120.0, 40.0, 160.0, 90.0, 0.0, 20.0, 30.0, 30.0, 40.0, 170.0, 100.0, 300.0, 130.0, -50.0, 260.0, 70.0, 110.0, 30.0, 290.0, 120.0, 270.0, 130.0, 40.0, 40.0, -130.0, 130.0, 110.0, 150.0, 230.0, 530.0, 40.0, 90.0, 150.0, 250.0, 40.0, 30.0, 110.0, -10.0, 220.0, 220.0, 140.0, 480.0, 40.0, 20.0, 20.0, 30.0, 110.0, -40.0, 90.0, 30.0, 40.0, 160.0, 30.0, 30.0, 600.0, 40.0, 50.0, 160.0, 110.0, 10.0, 440.0, 120.0, 50.0, 320.0, 0.0, 60.0, 30.0, -40.0, 0.0, 50.0, 150.0, 30.0, 110.0, 390.0, 20.0, 20.0, 230.0, 260.0, 40.0, 0.0, 20.0, 270.0, 30.0, 60.0, 10.0, 30.0, 170.0, 0.0, 30.0, 20.0, 20.0, 0.0, 280.0, 30.0, 490.0, 40.0, 190.0, 50.0, -20.0, 70.0, 0.0, 70.0, 50.0, 60.0, 90.0, 80.0, 150.0, 20.0, 30.0, 10.0, 0.0, 20.0, 520.0, 10.0, 0.0, 100.0, 150.0, 120.0, 0.0, 60.0, 80.0, 80.0, -50.0, 10.0, -20.0, 30.0, 280.0, 610.0, 40.0, 210.0, 630.0, 30.0, 40.0, 110.0, 20.0, 50.0, 10.0, 700.0, 290.0, 0.0, 30.0, 40.0, 70.0, 100.0, 50.0, 0.0, 520.0, 350.0, 90.0, 10.0, 150.0, 20.0, 10.0, 0.0, 20.0, 140.0, 0.0, 0.0, 120.0, -720.0, 230.0, 70.0, 210.0, 190.0, 60.0, 10.0, 480.0, 130.0, 40.0, 20.0, 30.0, 270.0, 10.0, 0.0, 300.0, 80.0, 40.0, 60.0, 10.0, 20.0, 0.0, 20.0, 210.0, 0.0, 200.0, 30.0, 40.0, 20.0, 20.0, 90.0, 20.0, 410.0, 40.0, -30.0, 40.0, 0.0, 20.0, 400.0, 100.0, 50.0, 90.0, 70.0, 30.0, 160.0, 10.0, -20.0, 185.0, 650.0, 190.0, 80.0, 10.0, 590.0, 40.0, 30.0, 80.0, 220.0, 30.0, 140.0, 20.0, 70.0, 740.0, 320.0, 30.0, 40.0, 420.0, 20.0, 110.0, 100.0, 290.0, 0.0, 140.0, 40.0, 160.0, 70.0, 110.0, 60.0, 220.0, -30.0, 50.0, 300.0, 10.0, 40.0, 20.0, 50.0, 130.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 50.0, 310.0, 10.0, 300.0, 370.0, 30.0, 10.0, 40.0, 170.0, 30.0, 30.0, 140.0, 260.0, 20.0, 20.0, 30.0, 90.0, 10.0, 20.0, 40.0, 320.0, 10.0, 180.0, 30.0, 470.0, 30.0, 90.0, 120.0, 40.0, 60.0, 10.0, -55.0, 280.0, 320.0, 110.0, 60.0, 260.0, 150.0, -40.0, 70.0, 70.0, 10.0, -30.0, -45.0, 410.0, 35.0, 520.0, 10.0, 30.0, 20.0, 190.0, 40.0, 0.0, 0.0, 30.0, 0.0, 100.0, 20.0, 0.0, 160.0, 80.0, 0.0, 330.0, 430.0, 50.0, 60.0, 40.0, 100.0, 70.0, 640.0, 140.0, 90.0, 60.0, 420.0, 50.0, 80.0, 200.0, 50.0, 30.0, 20.0, 0.0, 240.0, 40.0, 140.0, 0.0, 120.0, 30.0, 80.0, 0.0, -30.0, 20.0, 220.0, 110.0, 160.0, 50.0, 160.0, 50.0, 10.0, 380.0, 90.0, 110.0, 20.0, 135.0, 200.0, 300.0, 50.0, -10.0, 310.0, 10.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 100.0, 30.0, 40.0, 140.0, 30.0, 30.0, 280.0, 30.0, 100.0, 310.0, 210.0, 190.0, 10.0, 120.0, 50.0, 20.0, 270.0, 250.0, 40.0, 10.0, 120.0, 180.0, 100.0, 40.0, 440.0, 30.0, 50.0, 110.0, 20.0, 20.0, 270.0, -10.0, 0.0, 140.0, 20.0, 410.0, 30.0, 310.0, 70.0, 40.0, 80.0, 160.0, 30.0, 220.0, -20.0, 60.0, 300.0, 160.0, 20.0, 220.0, 180.0, 90.0, 40.0, -30.0, 30.0, 10.0, 40.0, 70.0, 310.0, 180.0, 50.0, 300.0, -20.0, 40.0, 280.0, 120.0, 190.0, 40.0, 20.0, 380.0, 40.0, 10.0, 50.0, 290.0, 190.0, 40.0, 60.0, 0.0, 40.0, 20.0, 290.0, 40.0, 70.0, 10.0, 110.0, 40.0, 600.0, 430.0, 40.0, 40.0, 180.0, 30.0, 180.0, 40.0, 370.0, 40.0, 320.0, 310.0, 150.0, 220.0, 150.0, 50.0, 30.0, 40.0, 10.0, 0.0, 150.0, 10.0, 170.0, 40.0, 250.0, 10.0, 170.0, 110.0, 20.0, 290.0, 60.0, 90.0, 0.0, 10.0, 40.0, 10.0, 200.0, 30.0, 160.0, 250.0, 30.0, 330.0, 90.0, 110.0, -20.0, 10.0, 200.0, -40.0, 130.0, 590.0, 310.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1189503546205186, "mean_inference_ms": 2.1364572347757242, "mean_action_processing_ms": 0.5688296855023599, "mean_env_wait_ms": 1.827069050831675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012868404388427734, "StateBufferConnector_ms": 0.009940624237060547, "ViewRequirementAgentConnector_ms": 0.41019129753112793}, "num_episodes": 18, "episode_return_max": 2140.0, "episode_return_min": 140.0, "episode_return_mean": 1093.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.673622960044998, "num_env_steps_trained_throughput_per_sec": 19.673622960044998, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 3320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3320000, "timers": {"training_iteration_time_ms": 239296.944, "restore_workers_time_ms": 0.012, "training_step_time_ms": 239296.885, "sample_time_ms": 4299.23, "learn_time_ms": 234970.481, "learn_throughput": 17.023, "synch_weights_time_ms": 12.514}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "done": false, "training_iteration": 83, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-23-42", "timestamp": 1717255422, "time_this_iter_s": 203.35267782211304, "time_total_s": 46237.97797560692, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8929d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46237.97797560692, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 23.030313588850174, "ram_util_percent": 82.52717770034843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.288584591157901, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5789500363972495, "policy_loss": -0.006669978366389125, "vf_loss": 6.58472765048091, "vf_explained_var": -0.00037484463538351657, "kl": 0.00594909767331374, "entropy": 0.2874639491462352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 784065.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "env_runners": {"episode_reward_max": 2140.0, "episode_reward_min": 140.0, "episode_reward_mean": 1065.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 106.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 765.0, 530.0, 560.0, 1260.0, 1290.0, 1550.0, 1385.0, 2030.0, 1370.0, 340.0, 1265.0, 470.0, 285.0, 1200.0, 1850.0, 570.0, 690.0, 880.0, 1775.0, 850.0, 1100.0, 1680.0, 1290.0, 530.0, 1260.0, 1600.0, 350.0, 1490.0, 920.0, 1130.0, 550.0, 1410.0, 1090.0, 1450.0, 1110.0, 1250.0, 990.0, 1300.0, 620.0, 1100.0, 620.0, 930.0, 1120.0, 2090.0, 1250.0, 470.0, 700.0, 820.0, 560.0, 1090.0, 1415.0, 1240.0, 2140.0, 820.0, 610.0, 1250.0, 800.0, 1310.0, 1235.0, 1010.0, 430.0, 1250.0, 1800.0, 700.0, 750.0, 1585.0, 140.0, 690.0, 1310.0, 1260.0, 1010.0, 1250.0, 760.0, 1520.0, 1120.0, 1220.0, 1670.0, 1110.0, 1130.0, 820.0, 1710.0, 1200.0, 770.0, 1270.0, 1540.0, 1180.0, 355.0, 1000.0, 610.0, 290.0, 1825.0, 1545.0, 720.0, 1215.0, 425.0, 320.0, 1550.0, 1070.0, 1430.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-30.0, 20.0, -20.0, 10.0, 0.0, 10.0, 40.0, 370.0, 10.0, 10.0, 285.0, -210.0, 120.0, 70.0, 40.0, 60.0, 180.0, 90.0, -50.0, 180.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 300.0, 50.0, 30.0, 70.0, 10.0, 10.0, 0.0, 320.0, 120.0, 0.0, 30.0, 0.0, 10.0, 60.0, 110.0, 10.0, 200.0, 10.0, 70.0, 380.0, 40.0, 240.0, 170.0, 30.0, 130.0, 110.0, 30.0, 110.0, 30.0, 370.0, 230.0, 20.0, 0.0, 260.0, 610.0, 170.0, 320.0, 20.0, 60.0, 50.0, 260.0, 50.0, 10.0, 0.0, 250.0, 190.0, 260.0, 30.0, 300.0, 70.0, 90.0, 55.0, 50.0, 90.0, 450.0, 190.0, 210.0, 420.0, 60.0, 30.0, 80.0, 60.0, -10.0, 540.0, 30.0, 30.0, 230.0, 330.0, 60.0, 210.0, 30.0, 150.0, 260.0, 40.0, 0.0, 20.0, 70.0, 70.0, 10.0, 10.0, 70.0, 40.0, 40.0, 10.0, 50.0, 270.0, 20.0, 0.0, 0.0, 450.0, 160.0, 175.0, 50.0, 90.0, 10.0, 20.0, 170.0, 190.0, 10.0, 30.0, 0.0, 40.0, 0.0, 0.0, 0.0, 40.0, 30.0, 100.0, 0.0, 0.0, 130.0, 0.0, 0.0, -15.0, 610.0, 40.0, 50.0, 30.0, 10.0, 130.0, -40.0, 20.0, 330.0, 20.0, 40.0, 350.0, 220.0, 140.0, 70.0, 260.0, 30.0, 440.0, 330.0, -30.0, 0.0, 20.0, 150.0, 40.0, 40.0, 20.0, 20.0, 160.0, 100.0, 20.0, 110.0, 150.0, 10.0, 80.0, 40.0, 40.0, 20.0, 20.0, 190.0, 30.0, 60.0, 420.0, 220.0, 60.0, 35.0, 100.0, 10.0, -55.0, 0.0, 30.0, 470.0, 10.0, 410.0, 120.0, 30.0, 200.0, 220.0, -5.0, 240.0, 80.0, 220.0, 70.0, 20.0, 40.0, 90.0, 240.0, 0.0, 30.0, 70.0, 70.0, 20.0, 340.0, 260.0, 10.0, 10.0, 20.0, 30.0, -30.0, 210.0, 230.0, 180.0, 20.0, 180.0, 150.0, 340.0, 190.0, 0.0, 320.0, 30.0, 270.0, 50.0, 90.0, 90.0, 700.0, 40.0, 40.0, 30.0, 180.0, 20.0, 50.0, 150.0, 60.0, -10.0, 230.0, 10.0, 70.0, 30.0, 0.0, 0.0, -10.0, 70.0, 60.0, 10.0, 280.0, 230.0, 160.0, 210.0, 60.0, 90.0, 90.0, 60.0, 220.0, 30.0, 280.0, 30.0, 270.0, 330.0, 40.0, 250.0, 90.0, 30.0, 10.0, 20.0, 30.0, 20.0, 200.0, 20.0, 0.0, 20.0, 0.0, 130.0, 10.0, 90.0, 240.0, 20.0, 40.0, 70.0, 320.0, 530.0, 40.0, 40.0, 20.0, 50.0, 70.0, 90.0, 110.0, 210.0, 0.0, 10.0, 320.0, 440.0, 10.0, -10.0, -20.0, 80.0, 40.0, 540.0, -20.0, 40.0, 30.0, 20.0, 120.0, 40.0, 160.0, 90.0, 0.0, 20.0, 30.0, 30.0, 40.0, 170.0, 100.0, 300.0, 130.0, -50.0, 260.0, 70.0, 110.0, 30.0, 290.0, 120.0, 270.0, 130.0, 40.0, 40.0, -130.0, 130.0, 110.0, 150.0, 230.0, 530.0, 40.0, 90.0, 150.0, 250.0, 40.0, 30.0, 110.0, -10.0, 220.0, 220.0, 140.0, 480.0, 40.0, 20.0, 20.0, 30.0, 110.0, -40.0, 90.0, 30.0, 40.0, 160.0, 30.0, 30.0, 600.0, 40.0, 50.0, 160.0, 110.0, 10.0, 440.0, 120.0, 50.0, 320.0, 0.0, 60.0, 30.0, -40.0, 0.0, 50.0, 150.0, 30.0, 110.0, 390.0, 20.0, 20.0, 230.0, 260.0, 40.0, 0.0, 20.0, 270.0, 30.0, 60.0, 10.0, 30.0, 170.0, 0.0, 30.0, 20.0, 20.0, 0.0, 280.0, 30.0, 490.0, 40.0, 190.0, 50.0, -20.0, 70.0, 0.0, 70.0, 50.0, 60.0, 90.0, 80.0, 150.0, 20.0, 30.0, 10.0, 0.0, 20.0, 520.0, 10.0, 0.0, 100.0, 150.0, 120.0, 0.0, 60.0, 80.0, 80.0, -50.0, 10.0, -20.0, 30.0, 280.0, 610.0, 40.0, 210.0, 630.0, 30.0, 40.0, 110.0, 20.0, 50.0, 10.0, 700.0, 290.0, 0.0, 30.0, 40.0, 70.0, 100.0, 50.0, 0.0, 520.0, 350.0, 90.0, 10.0, 150.0, 20.0, 10.0, 0.0, 20.0, 140.0, 0.0, 0.0, 120.0, -720.0, 230.0, 70.0, 210.0, 190.0, 60.0, 10.0, 480.0, 130.0, 40.0, 20.0, 30.0, 270.0, 10.0, 0.0, 300.0, 80.0, 40.0, 60.0, 10.0, 20.0, 0.0, 20.0, 210.0, 0.0, 200.0, 30.0, 40.0, 20.0, 20.0, 90.0, 20.0, 410.0, 40.0, -30.0, 40.0, 0.0, 20.0, 400.0, 100.0, 50.0, 90.0, 70.0, 30.0, 160.0, 10.0, -20.0, 185.0, 650.0, 190.0, 80.0, 10.0, 590.0, 40.0, 30.0, 80.0, 220.0, 30.0, 140.0, 20.0, 70.0, 740.0, 320.0, 30.0, 40.0, 420.0, 20.0, 110.0, 100.0, 290.0, 0.0, 140.0, 40.0, 160.0, 70.0, 110.0, 60.0, 220.0, -30.0, 50.0, 300.0, 10.0, 40.0, 20.0, 50.0, 130.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 50.0, 310.0, 10.0, 300.0, 370.0, 30.0, 10.0, 40.0, 170.0, 30.0, 30.0, 140.0, 260.0, 20.0, 20.0, 30.0, 90.0, 10.0, 20.0, 40.0, 320.0, 10.0, 180.0, 30.0, 470.0, 30.0, 90.0, 120.0, 40.0, 60.0, 10.0, -55.0, 280.0, 320.0, 110.0, 60.0, 260.0, 150.0, -40.0, 70.0, 70.0, 10.0, -30.0, -45.0, 410.0, 35.0, 520.0, 10.0, 30.0, 20.0, 190.0, 40.0, 0.0, 0.0, 30.0, 0.0, 100.0, 20.0, 0.0, 160.0, 80.0, 0.0, 330.0, 430.0, 50.0, 60.0, 40.0, 100.0, 70.0, 640.0, 140.0, 90.0, 60.0, 420.0, 50.0, 80.0, 200.0, 50.0, 30.0, 20.0, 0.0, 240.0, 40.0, 140.0, 0.0, 120.0, 30.0, 80.0, 0.0, -30.0, 20.0, 220.0, 110.0, 160.0, 50.0, 160.0, 50.0, 10.0, 380.0, 90.0, 110.0, 20.0, 135.0, 200.0, 300.0, 50.0, -10.0, 310.0, 10.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 100.0, 30.0, 40.0, 140.0, 30.0, 30.0, 280.0, 30.0, 100.0, 310.0, 210.0, 190.0, 10.0, 120.0, 50.0, 20.0, 270.0, 250.0, 40.0, 10.0, 120.0, 180.0, 100.0, 40.0, 440.0, 30.0, 50.0, 110.0, 20.0, 20.0, 270.0, -10.0, 0.0, 140.0, 20.0, 410.0, 30.0, 310.0, 70.0, 40.0, 80.0, 160.0, 30.0, 220.0, -20.0, 60.0, 300.0, 160.0, 20.0, 220.0, 180.0, 90.0, 40.0, -30.0, 30.0, 10.0, 40.0, 70.0, 310.0, 180.0, 50.0, 300.0, -20.0, 40.0, 280.0, 120.0, 190.0, 40.0, 20.0, 380.0, 40.0, 10.0, 50.0, 290.0, 190.0, 40.0, 60.0, 0.0, 40.0, 20.0, 290.0, 40.0, 70.0, 10.0, 110.0, 40.0, 600.0, 430.0, 40.0, 40.0, 180.0, 30.0, 180.0, 40.0, 370.0, 40.0, 320.0, 310.0, 150.0, 220.0, 150.0, 50.0, 30.0, 40.0, 10.0, 0.0, 150.0, 10.0, 170.0, 40.0, 250.0, 10.0, 170.0, 110.0, 20.0, 290.0, 60.0, 90.0, 0.0, 10.0, 40.0, 10.0, 200.0, 30.0, 160.0, 250.0, 30.0, 330.0, 90.0, 110.0, -20.0, 10.0, 200.0, -40.0, 130.0, 590.0, 310.0, 510.0, 120.0, 40.0, 0.0, 170.0, -30.0, 260.0, 20.0, 30.0, 80.0, 30.0, 100.0, 20.0, 20.0, 220.0, 160.0, 10.0, 40.0, 160.0, 10.0, 80.0, 40.0, 10.0, 110.0, 10.0, 200.0, 40.0, 230.0, 310.0, 240.0, 20.0, 120.0, 30.0, -40.0, 240.0, 40.0, 520.0, 390.0, 60.0, 160.0, 60.0, 310.0, 110.0, 40.0, 40.0, 20.0, 470.0, 80.0, 20.0, 30.0, -570.0, 170.0, 20.0, 30.0, 20.0, 30.0, 180.0, 300.0, 70.0, 105.0, 0.0, 10.0, 40.0, 480.0, 160.0, 80.0, 130.0, 40.0, 80.0, -20.0, 200.0, 10.0, 20.0, 30.0, 40.0, 20.0, 160.0, 10.0, 20.0, 100.0, 80.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 30.0, 40.0, 70.0, 170.0, 90.0, 60.0, 15.0, 390.0, 70.0, 80.0, 550.0, 330.0, 200.0, 300.0, 220.0, 50.0, 170.0, 20.0, 40.0, 45.0, 470.0, 30.0, 660.0, 0.0, 30.0, 10.0, 40.0, 0.0, 0.0, 0.0, 80.0, -100.0, 100.0, 70.0, 190.0, 480.0, -55.0, 0.0, 220.0, 60.0, 40.0, 110.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 280.0, 10.0, 25.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 210.0, 20.0, 10.0, 30.0, 540.0, 50.0, 40.0, 70.0, 40.0, 180.0, 560.0, 30.0, -40.0, 80.0, 40.0, 10.0, 270.0, 90.0, 90.0, 0.0, 50.0, 260.0, 110.0, 150.0, 110.0, 70.0, 90.0, 170.0, 30.0, 60.0, 310.0, 420.0, 160.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1118856800008468, "mean_inference_ms": 2.1310502976962455, "mean_action_processing_ms": 0.5670891821075266, "mean_env_wait_ms": 1.8215622672061835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01320791244506836, "StateBufferConnector_ms": 0.010108232498168945, "ViewRequirementAgentConnector_ms": 0.41500210762023926}, "num_episodes": 18, "episode_return_max": 2140.0, "episode_return_min": 140.0, "episode_return_mean": 1065.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.96784227366776, "num_env_steps_trained_throughput_per_sec": 19.96784227366776, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 3360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3360000, "timers": {"training_iteration_time_ms": 231483.922, "restore_workers_time_ms": 0.012, "training_step_time_ms": 231483.862, "sample_time_ms": 4063.449, "learn_time_ms": 227395.328, "learn_throughput": 17.591, "synch_weights_time_ms": 11.385}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "done": false, "training_iteration": 84, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-27-02", "timestamp": 1717255622, "time_this_iter_s": 200.33551812171936, "time_total_s": 46438.31349372864, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7fe670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46438.31349372864, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 20.369718309859156, "ram_util_percent": 81.37394366197184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6509956839302986, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8681025212565165, "policy_loss": -0.006465877747139373, "vf_loss": 6.873637469254109, "vf_explained_var": -0.00011681646457749307, "kl": 0.006206154192837613, "entropy": 0.27267708132823054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 793455.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "env_runners": {"episode_reward_max": 2140.0, "episode_reward_min": 140.0, "episode_reward_mean": 1098.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 830.0}, "policy_reward_mean": {"policy_0": 109.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1680.0, 1290.0, 530.0, 1260.0, 1600.0, 350.0, 1490.0, 920.0, 1130.0, 550.0, 1410.0, 1090.0, 1450.0, 1110.0, 1250.0, 990.0, 1300.0, 620.0, 1100.0, 620.0, 930.0, 1120.0, 2090.0, 1250.0, 470.0, 700.0, 820.0, 560.0, 1090.0, 1415.0, 1240.0, 2140.0, 820.0, 610.0, 1250.0, 800.0, 1310.0, 1235.0, 1010.0, 430.0, 1250.0, 1800.0, 700.0, 750.0, 1585.0, 140.0, 690.0, 1310.0, 1260.0, 1010.0, 1250.0, 760.0, 1520.0, 1120.0, 1220.0, 1670.0, 1110.0, 1130.0, 820.0, 1710.0, 1200.0, 770.0, 1270.0, 1540.0, 1180.0, 355.0, 1000.0, 610.0, 290.0, 1825.0, 1545.0, 720.0, 1215.0, 425.0, 320.0, 1550.0, 1070.0, 1430.0, 570.0, 1955.0, 1470.0, 1490.0, 1220.0, 1050.0, 1370.0, 515.0, 1350.0, 700.0, 1520.0, 1070.0, 1820.0, 1280.0, 1460.0, 310.0, 1420.0, 1670.0, 600.0, 400.0, 1330.0, 1100.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 20.0, 180.0, 150.0, 340.0, 190.0, 0.0, 320.0, 30.0, 270.0, 50.0, 90.0, 90.0, 700.0, 40.0, 40.0, 30.0, 180.0, 20.0, 50.0, 150.0, 60.0, -10.0, 230.0, 10.0, 70.0, 30.0, 0.0, 0.0, -10.0, 70.0, 60.0, 10.0, 280.0, 230.0, 160.0, 210.0, 60.0, 90.0, 90.0, 60.0, 220.0, 30.0, 280.0, 30.0, 270.0, 330.0, 40.0, 250.0, 90.0, 30.0, 10.0, 20.0, 30.0, 20.0, 200.0, 20.0, 0.0, 20.0, 0.0, 130.0, 10.0, 90.0, 240.0, 20.0, 40.0, 70.0, 320.0, 530.0, 40.0, 40.0, 20.0, 50.0, 70.0, 90.0, 110.0, 210.0, 0.0, 10.0, 320.0, 440.0, 10.0, -10.0, -20.0, 80.0, 40.0, 540.0, -20.0, 40.0, 30.0, 20.0, 120.0, 40.0, 160.0, 90.0, 0.0, 20.0, 30.0, 30.0, 40.0, 170.0, 100.0, 300.0, 130.0, -50.0, 260.0, 70.0, 110.0, 30.0, 290.0, 120.0, 270.0, 130.0, 40.0, 40.0, -130.0, 130.0, 110.0, 150.0, 230.0, 530.0, 40.0, 90.0, 150.0, 250.0, 40.0, 30.0, 110.0, -10.0, 220.0, 220.0, 140.0, 480.0, 40.0, 20.0, 20.0, 30.0, 110.0, -40.0, 90.0, 30.0, 40.0, 160.0, 30.0, 30.0, 600.0, 40.0, 50.0, 160.0, 110.0, 10.0, 440.0, 120.0, 50.0, 320.0, 0.0, 60.0, 30.0, -40.0, 0.0, 50.0, 150.0, 30.0, 110.0, 390.0, 20.0, 20.0, 230.0, 260.0, 40.0, 0.0, 20.0, 270.0, 30.0, 60.0, 10.0, 30.0, 170.0, 0.0, 30.0, 20.0, 20.0, 0.0, 280.0, 30.0, 490.0, 40.0, 190.0, 50.0, -20.0, 70.0, 0.0, 70.0, 50.0, 60.0, 90.0, 80.0, 150.0, 20.0, 30.0, 10.0, 0.0, 20.0, 520.0, 10.0, 0.0, 100.0, 150.0, 120.0, 0.0, 60.0, 80.0, 80.0, -50.0, 10.0, -20.0, 30.0, 280.0, 610.0, 40.0, 210.0, 630.0, 30.0, 40.0, 110.0, 20.0, 50.0, 10.0, 700.0, 290.0, 0.0, 30.0, 40.0, 70.0, 100.0, 50.0, 0.0, 520.0, 350.0, 90.0, 10.0, 150.0, 20.0, 10.0, 0.0, 20.0, 140.0, 0.0, 0.0, 120.0, -720.0, 230.0, 70.0, 210.0, 190.0, 60.0, 10.0, 480.0, 130.0, 40.0, 20.0, 30.0, 270.0, 10.0, 0.0, 300.0, 80.0, 40.0, 60.0, 10.0, 20.0, 0.0, 20.0, 210.0, 0.0, 200.0, 30.0, 40.0, 20.0, 20.0, 90.0, 20.0, 410.0, 40.0, -30.0, 40.0, 0.0, 20.0, 400.0, 100.0, 50.0, 90.0, 70.0, 30.0, 160.0, 10.0, -20.0, 185.0, 650.0, 190.0, 80.0, 10.0, 590.0, 40.0, 30.0, 80.0, 220.0, 30.0, 140.0, 20.0, 70.0, 740.0, 320.0, 30.0, 40.0, 420.0, 20.0, 110.0, 100.0, 290.0, 0.0, 140.0, 40.0, 160.0, 70.0, 110.0, 60.0, 220.0, -30.0, 50.0, 300.0, 10.0, 40.0, 20.0, 50.0, 130.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 50.0, 310.0, 10.0, 300.0, 370.0, 30.0, 10.0, 40.0, 170.0, 30.0, 30.0, 140.0, 260.0, 20.0, 20.0, 30.0, 90.0, 10.0, 20.0, 40.0, 320.0, 10.0, 180.0, 30.0, 470.0, 30.0, 90.0, 120.0, 40.0, 60.0, 10.0, -55.0, 280.0, 320.0, 110.0, 60.0, 260.0, 150.0, -40.0, 70.0, 70.0, 10.0, -30.0, -45.0, 410.0, 35.0, 520.0, 10.0, 30.0, 20.0, 190.0, 40.0, 0.0, 0.0, 30.0, 0.0, 100.0, 20.0, 0.0, 160.0, 80.0, 0.0, 330.0, 430.0, 50.0, 60.0, 40.0, 100.0, 70.0, 640.0, 140.0, 90.0, 60.0, 420.0, 50.0, 80.0, 200.0, 50.0, 30.0, 20.0, 0.0, 240.0, 40.0, 140.0, 0.0, 120.0, 30.0, 80.0, 0.0, -30.0, 20.0, 220.0, 110.0, 160.0, 50.0, 160.0, 50.0, 10.0, 380.0, 90.0, 110.0, 20.0, 135.0, 200.0, 300.0, 50.0, -10.0, 310.0, 10.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 100.0, 30.0, 40.0, 140.0, 30.0, 30.0, 280.0, 30.0, 100.0, 310.0, 210.0, 190.0, 10.0, 120.0, 50.0, 20.0, 270.0, 250.0, 40.0, 10.0, 120.0, 180.0, 100.0, 40.0, 440.0, 30.0, 50.0, 110.0, 20.0, 20.0, 270.0, -10.0, 0.0, 140.0, 20.0, 410.0, 30.0, 310.0, 70.0, 40.0, 80.0, 160.0, 30.0, 220.0, -20.0, 60.0, 300.0, 160.0, 20.0, 220.0, 180.0, 90.0, 40.0, -30.0, 30.0, 10.0, 40.0, 70.0, 310.0, 180.0, 50.0, 300.0, -20.0, 40.0, 280.0, 120.0, 190.0, 40.0, 20.0, 380.0, 40.0, 10.0, 50.0, 290.0, 190.0, 40.0, 60.0, 0.0, 40.0, 20.0, 290.0, 40.0, 70.0, 10.0, 110.0, 40.0, 600.0, 430.0, 40.0, 40.0, 180.0, 30.0, 180.0, 40.0, 370.0, 40.0, 320.0, 310.0, 150.0, 220.0, 150.0, 50.0, 30.0, 40.0, 10.0, 0.0, 150.0, 10.0, 170.0, 40.0, 250.0, 10.0, 170.0, 110.0, 20.0, 290.0, 60.0, 90.0, 0.0, 10.0, 40.0, 10.0, 200.0, 30.0, 160.0, 250.0, 30.0, 330.0, 90.0, 110.0, -20.0, 10.0, 200.0, -40.0, 130.0, 590.0, 310.0, 510.0, 120.0, 40.0, 0.0, 170.0, -30.0, 260.0, 20.0, 30.0, 80.0, 30.0, 100.0, 20.0, 20.0, 220.0, 160.0, 10.0, 40.0, 160.0, 10.0, 80.0, 40.0, 10.0, 110.0, 10.0, 200.0, 40.0, 230.0, 310.0, 240.0, 20.0, 120.0, 30.0, -40.0, 240.0, 40.0, 520.0, 390.0, 60.0, 160.0, 60.0, 310.0, 110.0, 40.0, 40.0, 20.0, 470.0, 80.0, 20.0, 30.0, -570.0, 170.0, 20.0, 30.0, 20.0, 30.0, 180.0, 300.0, 70.0, 105.0, 0.0, 10.0, 40.0, 480.0, 160.0, 80.0, 130.0, 40.0, 80.0, -20.0, 200.0, 10.0, 20.0, 30.0, 40.0, 20.0, 160.0, 10.0, 20.0, 100.0, 80.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 30.0, 40.0, 70.0, 170.0, 90.0, 60.0, 15.0, 390.0, 70.0, 80.0, 550.0, 330.0, 200.0, 300.0, 220.0, 50.0, 170.0, 20.0, 40.0, 45.0, 470.0, 30.0, 660.0, 0.0, 30.0, 10.0, 40.0, 0.0, 0.0, 0.0, 80.0, -100.0, 100.0, 70.0, 190.0, 480.0, -55.0, 0.0, 220.0, 60.0, 40.0, 110.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 280.0, 10.0, 25.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 210.0, 20.0, 10.0, 30.0, 540.0, 50.0, 40.0, 70.0, 40.0, 180.0, 560.0, 30.0, -40.0, 80.0, 40.0, 10.0, 270.0, 90.0, 90.0, 0.0, 50.0, 260.0, 110.0, 150.0, 110.0, 70.0, 90.0, 170.0, 30.0, 60.0, 310.0, 420.0, 160.0, 10.0, 170.0, 20.0, 40.0, 0.0, 30.0, 10.0, 0.0, 50.0, 160.0, 90.0, 500.0, -5.0, 180.0, 170.0, 700.0, 170.0, 130.0, 10.0, 110.0, -10.0, 190.0, 0.0, 0.0, 0.0, 510.0, 220.0, 160.0, 160.0, 30.0, 200.0, 180.0, 240.0, 60.0, 90.0, 470.0, 120.0, 130.0, 30.0, 90.0, 80.0, 30.0, 30.0, 830.0, 70.0, 20.0, 110.0, 110.0, -30.0, 10.0, 40.0, 40.0, 190.0, 90.0, -10.0, 250.0, 30.0, 0.0, 40.0, 60.0, 360.0, 110.0, 80.0, 30.0, 200.0, 40.0, 210.0, 30.0, 190.0, 50.0, 430.0, 10.0, 30.0, 50.0, 15.0, 50.0, 310.0, 10.0, 30.0, 10.0, 0.0, 170.0, -10.0, 120.0, 30.0, 100.0, 10.0, 90.0, 480.0, 0.0, 360.0, 40.0, 10.0, 40.0, 120.0, 100.0, 10.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 50.0, 110.0, 330.0, 190.0, 440.0, 100.0, 110.0, 110.0, 160.0, 340.0, 370.0, 20.0, 0.0, 20.0, -40.0, 80.0, 80.0, 40.0, -70.0, 50.0, 60.0, 380.0, 0.0, 50.0, 50.0, 380.0, 390.0, 530.0, 360.0, 330.0, 10.0, 160.0, 160.0, 60.0, 30.0, 90.0, 20.0, 60.0, 430.0, 80.0, 80.0, 310.0, 60.0, 10.0, 190.0, 110.0, 130.0, 60.0, 60.0, 0.0, 70.0, 0.0, 60.0, 10.0, 20.0, 20.0, 70.0, 0.0, 80.0, -30.0, -30.0, 250.0, 440.0, 160.0, 50.0, 140.0, 340.0, 20.0, 120.0, 290.0, 30.0, 20.0, 320.0, 60.0, 600.0, 50.0, 90.0, 90.0, 20.0, 80.0, 170.0, 80.0, 0.0, 50.0, 140.0, 40.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 40.0, 100.0, 90.0, 10.0, 110.0, 20.0, 30.0, 10.0, 10.0, 0.0, 450.0, 130.0, 510.0, 90.0, 80.0, 20.0, -10.0, 360.0, 70.0, 30.0, 220.0, 60.0, 160.0, 80.0, 70.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.103512191848079, "mean_inference_ms": 2.1245578508046306, "mean_action_processing_ms": 0.5649342773611946, "mean_env_wait_ms": 1.814706901505283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016335487365722656, "StateBufferConnector_ms": 0.010895252227783203, "ViewRequirementAgentConnector_ms": 0.4186890125274658}, "num_episodes": 22, "episode_return_max": 2140.0, "episode_return_min": 140.0, "episode_return_mean": 1098.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.030677667796176, "num_env_steps_trained_throughput_per_sec": 20.030677667796176, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 3400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3400000, "timers": {"training_iteration_time_ms": 223038.569, "restore_workers_time_ms": 0.012, "training_step_time_ms": 223038.511, "sample_time_ms": 3694.571, "learn_time_ms": 219320.079, "learn_throughput": 18.238, "synch_weights_time_ms": 11.22}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "done": false, "training_iteration": 85, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-30-22", "timestamp": 1717255822, "time_this_iter_s": 199.70872807502747, "time_total_s": 46638.022221803665, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dcee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46638.022221803665, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 26.578014184397162, "ram_util_percent": 81.03971631205673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4258908914174007, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006263169400997488, "vf_loss": 7.137776740798301, "vf_explained_var": 0.0006898240032541358, "kl": Infinity, "entropy": 0.26013585102919956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 802845.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "env_runners": {"episode_reward_max": 2140.0, "episode_reward_min": 140.0, "episode_reward_mean": 1092.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 109.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1100.0, 620.0, 930.0, 1120.0, 2090.0, 1250.0, 470.0, 700.0, 820.0, 560.0, 1090.0, 1415.0, 1240.0, 2140.0, 820.0, 610.0, 1250.0, 800.0, 1310.0, 1235.0, 1010.0, 430.0, 1250.0, 1800.0, 700.0, 750.0, 1585.0, 140.0, 690.0, 1310.0, 1260.0, 1010.0, 1250.0, 760.0, 1520.0, 1120.0, 1220.0, 1670.0, 1110.0, 1130.0, 820.0, 1710.0, 1200.0, 770.0, 1270.0, 1540.0, 1180.0, 355.0, 1000.0, 610.0, 290.0, 1825.0, 1545.0, 720.0, 1215.0, 425.0, 320.0, 1550.0, 1070.0, 1430.0, 570.0, 1955.0, 1470.0, 1490.0, 1220.0, 1050.0, 1370.0, 515.0, 1350.0, 700.0, 1520.0, 1070.0, 1820.0, 1280.0, 1460.0, 310.0, 1420.0, 1670.0, 600.0, 400.0, 1330.0, 1100.0, 220.0, 1040.0, 925.0, 890.0, 1170.0, 810.0, 1280.0, 1050.0, 800.0, 1190.0, 1540.0, 1200.0, 1250.0, 1555.0, 1170.0, 1230.0, 1430.0, 720.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 20.0, 0.0, 280.0, 30.0, 490.0, 40.0, 190.0, 50.0, -20.0, 70.0, 0.0, 70.0, 50.0, 60.0, 90.0, 80.0, 150.0, 20.0, 30.0, 10.0, 0.0, 20.0, 520.0, 10.0, 0.0, 100.0, 150.0, 120.0, 0.0, 60.0, 80.0, 80.0, -50.0, 10.0, -20.0, 30.0, 280.0, 610.0, 40.0, 210.0, 630.0, 30.0, 40.0, 110.0, 20.0, 50.0, 10.0, 700.0, 290.0, 0.0, 30.0, 40.0, 70.0, 100.0, 50.0, 0.0, 520.0, 350.0, 90.0, 10.0, 150.0, 20.0, 10.0, 0.0, 20.0, 140.0, 0.0, 0.0, 120.0, -720.0, 230.0, 70.0, 210.0, 190.0, 60.0, 10.0, 480.0, 130.0, 40.0, 20.0, 30.0, 270.0, 10.0, 0.0, 300.0, 80.0, 40.0, 60.0, 10.0, 20.0, 0.0, 20.0, 210.0, 0.0, 200.0, 30.0, 40.0, 20.0, 20.0, 90.0, 20.0, 410.0, 40.0, -30.0, 40.0, 0.0, 20.0, 400.0, 100.0, 50.0, 90.0, 70.0, 30.0, 160.0, 10.0, -20.0, 185.0, 650.0, 190.0, 80.0, 10.0, 590.0, 40.0, 30.0, 80.0, 220.0, 30.0, 140.0, 20.0, 70.0, 740.0, 320.0, 30.0, 40.0, 420.0, 20.0, 110.0, 100.0, 290.0, 0.0, 140.0, 40.0, 160.0, 70.0, 110.0, 60.0, 220.0, -30.0, 50.0, 300.0, 10.0, 40.0, 20.0, 50.0, 130.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 50.0, 310.0, 10.0, 300.0, 370.0, 30.0, 10.0, 40.0, 170.0, 30.0, 30.0, 140.0, 260.0, 20.0, 20.0, 30.0, 90.0, 10.0, 20.0, 40.0, 320.0, 10.0, 180.0, 30.0, 470.0, 30.0, 90.0, 120.0, 40.0, 60.0, 10.0, -55.0, 280.0, 320.0, 110.0, 60.0, 260.0, 150.0, -40.0, 70.0, 70.0, 10.0, -30.0, -45.0, 410.0, 35.0, 520.0, 10.0, 30.0, 20.0, 190.0, 40.0, 0.0, 0.0, 30.0, 0.0, 100.0, 20.0, 0.0, 160.0, 80.0, 0.0, 330.0, 430.0, 50.0, 60.0, 40.0, 100.0, 70.0, 640.0, 140.0, 90.0, 60.0, 420.0, 50.0, 80.0, 200.0, 50.0, 30.0, 20.0, 0.0, 240.0, 40.0, 140.0, 0.0, 120.0, 30.0, 80.0, 0.0, -30.0, 20.0, 220.0, 110.0, 160.0, 50.0, 160.0, 50.0, 10.0, 380.0, 90.0, 110.0, 20.0, 135.0, 200.0, 300.0, 50.0, -10.0, 310.0, 10.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 100.0, 30.0, 40.0, 140.0, 30.0, 30.0, 280.0, 30.0, 100.0, 310.0, 210.0, 190.0, 10.0, 120.0, 50.0, 20.0, 270.0, 250.0, 40.0, 10.0, 120.0, 180.0, 100.0, 40.0, 440.0, 30.0, 50.0, 110.0, 20.0, 20.0, 270.0, -10.0, 0.0, 140.0, 20.0, 410.0, 30.0, 310.0, 70.0, 40.0, 80.0, 160.0, 30.0, 220.0, -20.0, 60.0, 300.0, 160.0, 20.0, 220.0, 180.0, 90.0, 40.0, -30.0, 30.0, 10.0, 40.0, 70.0, 310.0, 180.0, 50.0, 300.0, -20.0, 40.0, 280.0, 120.0, 190.0, 40.0, 20.0, 380.0, 40.0, 10.0, 50.0, 290.0, 190.0, 40.0, 60.0, 0.0, 40.0, 20.0, 290.0, 40.0, 70.0, 10.0, 110.0, 40.0, 600.0, 430.0, 40.0, 40.0, 180.0, 30.0, 180.0, 40.0, 370.0, 40.0, 320.0, 310.0, 150.0, 220.0, 150.0, 50.0, 30.0, 40.0, 10.0, 0.0, 150.0, 10.0, 170.0, 40.0, 250.0, 10.0, 170.0, 110.0, 20.0, 290.0, 60.0, 90.0, 0.0, 10.0, 40.0, 10.0, 200.0, 30.0, 160.0, 250.0, 30.0, 330.0, 90.0, 110.0, -20.0, 10.0, 200.0, -40.0, 130.0, 590.0, 310.0, 510.0, 120.0, 40.0, 0.0, 170.0, -30.0, 260.0, 20.0, 30.0, 80.0, 30.0, 100.0, 20.0, 20.0, 220.0, 160.0, 10.0, 40.0, 160.0, 10.0, 80.0, 40.0, 10.0, 110.0, 10.0, 200.0, 40.0, 230.0, 310.0, 240.0, 20.0, 120.0, 30.0, -40.0, 240.0, 40.0, 520.0, 390.0, 60.0, 160.0, 60.0, 310.0, 110.0, 40.0, 40.0, 20.0, 470.0, 80.0, 20.0, 30.0, -570.0, 170.0, 20.0, 30.0, 20.0, 30.0, 180.0, 300.0, 70.0, 105.0, 0.0, 10.0, 40.0, 480.0, 160.0, 80.0, 130.0, 40.0, 80.0, -20.0, 200.0, 10.0, 20.0, 30.0, 40.0, 20.0, 160.0, 10.0, 20.0, 100.0, 80.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 30.0, 40.0, 70.0, 170.0, 90.0, 60.0, 15.0, 390.0, 70.0, 80.0, 550.0, 330.0, 200.0, 300.0, 220.0, 50.0, 170.0, 20.0, 40.0, 45.0, 470.0, 30.0, 660.0, 0.0, 30.0, 10.0, 40.0, 0.0, 0.0, 0.0, 80.0, -100.0, 100.0, 70.0, 190.0, 480.0, -55.0, 0.0, 220.0, 60.0, 40.0, 110.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 280.0, 10.0, 25.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 210.0, 20.0, 10.0, 30.0, 540.0, 50.0, 40.0, 70.0, 40.0, 180.0, 560.0, 30.0, -40.0, 80.0, 40.0, 10.0, 270.0, 90.0, 90.0, 0.0, 50.0, 260.0, 110.0, 150.0, 110.0, 70.0, 90.0, 170.0, 30.0, 60.0, 310.0, 420.0, 160.0, 10.0, 170.0, 20.0, 40.0, 0.0, 30.0, 10.0, 0.0, 50.0, 160.0, 90.0, 500.0, -5.0, 180.0, 170.0, 700.0, 170.0, 130.0, 10.0, 110.0, -10.0, 190.0, 0.0, 0.0, 0.0, 510.0, 220.0, 160.0, 160.0, 30.0, 200.0, 180.0, 240.0, 60.0, 90.0, 470.0, 120.0, 130.0, 30.0, 90.0, 80.0, 30.0, 30.0, 830.0, 70.0, 20.0, 110.0, 110.0, -30.0, 10.0, 40.0, 40.0, 190.0, 90.0, -10.0, 250.0, 30.0, 0.0, 40.0, 60.0, 360.0, 110.0, 80.0, 30.0, 200.0, 40.0, 210.0, 30.0, 190.0, 50.0, 430.0, 10.0, 30.0, 50.0, 15.0, 50.0, 310.0, 10.0, 30.0, 10.0, 0.0, 170.0, -10.0, 120.0, 30.0, 100.0, 10.0, 90.0, 480.0, 0.0, 360.0, 40.0, 10.0, 40.0, 120.0, 100.0, 10.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 50.0, 110.0, 330.0, 190.0, 440.0, 100.0, 110.0, 110.0, 160.0, 340.0, 370.0, 20.0, 0.0, 20.0, -40.0, 80.0, 80.0, 40.0, -70.0, 50.0, 60.0, 380.0, 0.0, 50.0, 50.0, 380.0, 390.0, 530.0, 360.0, 330.0, 10.0, 160.0, 160.0, 60.0, 30.0, 90.0, 20.0, 60.0, 430.0, 80.0, 80.0, 310.0, 60.0, 10.0, 190.0, 110.0, 130.0, 60.0, 60.0, 0.0, 70.0, 0.0, 60.0, 10.0, 20.0, 20.0, 70.0, 0.0, 80.0, -30.0, -30.0, 250.0, 440.0, 160.0, 50.0, 140.0, 340.0, 20.0, 120.0, 290.0, 30.0, 20.0, 320.0, 60.0, 600.0, 50.0, 90.0, 90.0, 20.0, 80.0, 170.0, 80.0, 0.0, 50.0, 140.0, 40.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 40.0, 100.0, 90.0, 10.0, 110.0, 20.0, 30.0, 10.0, 10.0, 0.0, 450.0, 130.0, 510.0, 90.0, 80.0, 20.0, -10.0, 360.0, 70.0, 30.0, 220.0, 60.0, 160.0, 80.0, 70.0, 60.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 40.0, -40.0, 10.0, 420.0, 70.0, -20.0, 230.0, 40.0, 10.0, 280.0, 40.0, 50.0, 60.0, 170.0, 80.0, 660.0, -40.0, -40.0, -10.0, 30.0, -35.0, 210.0, 10.0, -30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 610.0, 40.0, 40.0, 10.0, 40.0, 0.0, 280.0, 30.0, 30.0, 700.0, 0.0, 0.0, 410.0, 60.0, 0.0, 10.0, 70.0, 50.0, 110.0, 30.0, 70.0, 390.0, 330.0, 0.0, 20.0, 30.0, 200.0, 20.0, 90.0, 90.0, 110.0, 30.0, 70.0, 90.0, 40.0, 490.0, 180.0, 40.0, 20.0, 50.0, 40.0, 40.0, 20.0, 70.0, 140.0, 120.0, 410.0, 40.0, -110.0, 20.0, 50.0, 60.0, 60.0, 50.0, 130.0, 50.0, -30.0, 430.0, 120.0, 230.0, 90.0, 180.0, 40.0, 200.0, 20.0, 60.0, 70.0, 20.0, 50.0, 40.0, 860.0, 90.0, 150.0, 170.0, 10.0, 30.0, 290.0, 210.0, 200.0, 40.0, 10.0, 100.0, 400.0, 70.0, 20.0, 90.0, 230.0, 50.0, 190.0, 0.0, 100.0, 85.0, 40.0, 100.0, 70.0, 210.0, 50.0, 290.0, 150.0, 290.0, 270.0, 100.0, 70.0, 220.0, 590.0, 20.0, 10.0, 10.0, 10.0, 40.0, 100.0, 30.0, 160.0, 40.0, 300.0, 0.0, 50.0, 60.0, 10.0, 560.0, 20.0, 20.0, 120.0, 20.0, 140.0, 720.0, 80.0, 20.0, 50.0, 220.0, 40.0, 60.0, 80.0, 10.0, 10.0, 80.0, 20.0, 350.0, 20.0, 0.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0966256653675885, "mean_inference_ms": 2.1189342742141006, "mean_action_processing_ms": 0.5632165718838276, "mean_env_wait_ms": 1.8092181688100901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01633930206298828, "StateBufferConnector_ms": 0.01086568832397461, "ViewRequirementAgentConnector_ms": 0.4133889675140381}, "num_episodes": 18, "episode_return_max": 2140.0, "episode_return_min": 140.0, "episode_return_mean": 1092.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.213607696832106, "num_env_steps_trained_throughput_per_sec": 20.213607696832106, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 3440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3440000, "timers": {"training_iteration_time_ms": 214835.549, "restore_workers_time_ms": 0.012, "training_step_time_ms": 214835.492, "sample_time_ms": 3317.047, "learn_time_ms": 211494.69, "learn_throughput": 18.913, "synch_weights_time_ms": 11.353}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "done": false, "training_iteration": 86, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-33-40", "timestamp": 1717256020, "time_this_iter_s": 197.9003357887268, "time_total_s": 46835.92255759239, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7e8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46835.92255759239, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 18.62035714285714, "ram_util_percent": 80.11571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6070122919968775, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.786913365982592, "policy_loss": -0.006506535702030927, "vf_loss": 6.792237866953158, "vf_explained_var": 0.0007081799105968211, "kl": 0.0052534708738849025, "entropy": 0.2604738882983835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 812235.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "env_runners": {"episode_reward_max": 2180.0, "episode_reward_min": 140.0, "episode_reward_mean": 1112.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -570.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 111.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1800.0, 700.0, 750.0, 1585.0, 140.0, 690.0, 1310.0, 1260.0, 1010.0, 1250.0, 760.0, 1520.0, 1120.0, 1220.0, 1670.0, 1110.0, 1130.0, 820.0, 1710.0, 1200.0, 770.0, 1270.0, 1540.0, 1180.0, 355.0, 1000.0, 610.0, 290.0, 1825.0, 1545.0, 720.0, 1215.0, 425.0, 320.0, 1550.0, 1070.0, 1430.0, 570.0, 1955.0, 1470.0, 1490.0, 1220.0, 1050.0, 1370.0, 515.0, 1350.0, 700.0, 1520.0, 1070.0, 1820.0, 1280.0, 1460.0, 310.0, 1420.0, 1670.0, 600.0, 400.0, 1330.0, 1100.0, 220.0, 1040.0, 925.0, 890.0, 1170.0, 810.0, 1280.0, 1050.0, 800.0, 1190.0, 1540.0, 1200.0, 1250.0, 1555.0, 1170.0, 1230.0, 1430.0, 720.0, 910.0, 150.0, 1050.0, 1660.0, 1510.0, 1190.0, 1410.0, 1300.0, 990.0, 990.0, 1450.0, 550.0, 1120.0, 1505.0, 1300.0, 520.0, 1660.0, 910.0, 1090.0, 2180.0, 990.0, 860.0, 980.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 640.0, 140.0, 90.0, 60.0, 420.0, 50.0, 80.0, 200.0, 50.0, 30.0, 20.0, 0.0, 240.0, 40.0, 140.0, 0.0, 120.0, 30.0, 80.0, 0.0, -30.0, 20.0, 220.0, 110.0, 160.0, 50.0, 160.0, 50.0, 10.0, 380.0, 90.0, 110.0, 20.0, 135.0, 200.0, 300.0, 50.0, -10.0, 310.0, 10.0, 40.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 100.0, 30.0, 40.0, 140.0, 30.0, 30.0, 280.0, 30.0, 100.0, 310.0, 210.0, 190.0, 10.0, 120.0, 50.0, 20.0, 270.0, 250.0, 40.0, 10.0, 120.0, 180.0, 100.0, 40.0, 440.0, 30.0, 50.0, 110.0, 20.0, 20.0, 270.0, -10.0, 0.0, 140.0, 20.0, 410.0, 30.0, 310.0, 70.0, 40.0, 80.0, 160.0, 30.0, 220.0, -20.0, 60.0, 300.0, 160.0, 20.0, 220.0, 180.0, 90.0, 40.0, -30.0, 30.0, 10.0, 40.0, 70.0, 310.0, 180.0, 50.0, 300.0, -20.0, 40.0, 280.0, 120.0, 190.0, 40.0, 20.0, 380.0, 40.0, 10.0, 50.0, 290.0, 190.0, 40.0, 60.0, 0.0, 40.0, 20.0, 290.0, 40.0, 70.0, 10.0, 110.0, 40.0, 600.0, 430.0, 40.0, 40.0, 180.0, 30.0, 180.0, 40.0, 370.0, 40.0, 320.0, 310.0, 150.0, 220.0, 150.0, 50.0, 30.0, 40.0, 10.0, 0.0, 150.0, 10.0, 170.0, 40.0, 250.0, 10.0, 170.0, 110.0, 20.0, 290.0, 60.0, 90.0, 0.0, 10.0, 40.0, 10.0, 200.0, 30.0, 160.0, 250.0, 30.0, 330.0, 90.0, 110.0, -20.0, 10.0, 200.0, -40.0, 130.0, 590.0, 310.0, 510.0, 120.0, 40.0, 0.0, 170.0, -30.0, 260.0, 20.0, 30.0, 80.0, 30.0, 100.0, 20.0, 20.0, 220.0, 160.0, 10.0, 40.0, 160.0, 10.0, 80.0, 40.0, 10.0, 110.0, 10.0, 200.0, 40.0, 230.0, 310.0, 240.0, 20.0, 120.0, 30.0, -40.0, 240.0, 40.0, 520.0, 390.0, 60.0, 160.0, 60.0, 310.0, 110.0, 40.0, 40.0, 20.0, 470.0, 80.0, 20.0, 30.0, -570.0, 170.0, 20.0, 30.0, 20.0, 30.0, 180.0, 300.0, 70.0, 105.0, 0.0, 10.0, 40.0, 480.0, 160.0, 80.0, 130.0, 40.0, 80.0, -20.0, 200.0, 10.0, 20.0, 30.0, 40.0, 20.0, 160.0, 10.0, 20.0, 100.0, 80.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 30.0, 40.0, 70.0, 170.0, 90.0, 60.0, 15.0, 390.0, 70.0, 80.0, 550.0, 330.0, 200.0, 300.0, 220.0, 50.0, 170.0, 20.0, 40.0, 45.0, 470.0, 30.0, 660.0, 0.0, 30.0, 10.0, 40.0, 0.0, 0.0, 0.0, 80.0, -100.0, 100.0, 70.0, 190.0, 480.0, -55.0, 0.0, 220.0, 60.0, 40.0, 110.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 280.0, 10.0, 25.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 210.0, 20.0, 10.0, 30.0, 540.0, 50.0, 40.0, 70.0, 40.0, 180.0, 560.0, 30.0, -40.0, 80.0, 40.0, 10.0, 270.0, 90.0, 90.0, 0.0, 50.0, 260.0, 110.0, 150.0, 110.0, 70.0, 90.0, 170.0, 30.0, 60.0, 310.0, 420.0, 160.0, 10.0, 170.0, 20.0, 40.0, 0.0, 30.0, 10.0, 0.0, 50.0, 160.0, 90.0, 500.0, -5.0, 180.0, 170.0, 700.0, 170.0, 130.0, 10.0, 110.0, -10.0, 190.0, 0.0, 0.0, 0.0, 510.0, 220.0, 160.0, 160.0, 30.0, 200.0, 180.0, 240.0, 60.0, 90.0, 470.0, 120.0, 130.0, 30.0, 90.0, 80.0, 30.0, 30.0, 830.0, 70.0, 20.0, 110.0, 110.0, -30.0, 10.0, 40.0, 40.0, 190.0, 90.0, -10.0, 250.0, 30.0, 0.0, 40.0, 60.0, 360.0, 110.0, 80.0, 30.0, 200.0, 40.0, 210.0, 30.0, 190.0, 50.0, 430.0, 10.0, 30.0, 50.0, 15.0, 50.0, 310.0, 10.0, 30.0, 10.0, 0.0, 170.0, -10.0, 120.0, 30.0, 100.0, 10.0, 90.0, 480.0, 0.0, 360.0, 40.0, 10.0, 40.0, 120.0, 100.0, 10.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 50.0, 110.0, 330.0, 190.0, 440.0, 100.0, 110.0, 110.0, 160.0, 340.0, 370.0, 20.0, 0.0, 20.0, -40.0, 80.0, 80.0, 40.0, -70.0, 50.0, 60.0, 380.0, 0.0, 50.0, 50.0, 380.0, 390.0, 530.0, 360.0, 330.0, 10.0, 160.0, 160.0, 60.0, 30.0, 90.0, 20.0, 60.0, 430.0, 80.0, 80.0, 310.0, 60.0, 10.0, 190.0, 110.0, 130.0, 60.0, 60.0, 0.0, 70.0, 0.0, 60.0, 10.0, 20.0, 20.0, 70.0, 0.0, 80.0, -30.0, -30.0, 250.0, 440.0, 160.0, 50.0, 140.0, 340.0, 20.0, 120.0, 290.0, 30.0, 20.0, 320.0, 60.0, 600.0, 50.0, 90.0, 90.0, 20.0, 80.0, 170.0, 80.0, 0.0, 50.0, 140.0, 40.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 40.0, 100.0, 90.0, 10.0, 110.0, 20.0, 30.0, 10.0, 10.0, 0.0, 450.0, 130.0, 510.0, 90.0, 80.0, 20.0, -10.0, 360.0, 70.0, 30.0, 220.0, 60.0, 160.0, 80.0, 70.0, 60.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 40.0, -40.0, 10.0, 420.0, 70.0, -20.0, 230.0, 40.0, 10.0, 280.0, 40.0, 50.0, 60.0, 170.0, 80.0, 660.0, -40.0, -40.0, -10.0, 30.0, -35.0, 210.0, 10.0, -30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 610.0, 40.0, 40.0, 10.0, 40.0, 0.0, 280.0, 30.0, 30.0, 700.0, 0.0, 0.0, 410.0, 60.0, 0.0, 10.0, 70.0, 50.0, 110.0, 30.0, 70.0, 390.0, 330.0, 0.0, 20.0, 30.0, 200.0, 20.0, 90.0, 90.0, 110.0, 30.0, 70.0, 90.0, 40.0, 490.0, 180.0, 40.0, 20.0, 50.0, 40.0, 40.0, 20.0, 70.0, 140.0, 120.0, 410.0, 40.0, -110.0, 20.0, 50.0, 60.0, 60.0, 50.0, 130.0, 50.0, -30.0, 430.0, 120.0, 230.0, 90.0, 180.0, 40.0, 200.0, 20.0, 60.0, 70.0, 20.0, 50.0, 40.0, 860.0, 90.0, 150.0, 170.0, 10.0, 30.0, 290.0, 210.0, 200.0, 40.0, 10.0, 100.0, 400.0, 70.0, 20.0, 90.0, 230.0, 50.0, 190.0, 0.0, 100.0, 85.0, 40.0, 100.0, 70.0, 210.0, 50.0, 290.0, 150.0, 290.0, 270.0, 100.0, 70.0, 220.0, 590.0, 20.0, 10.0, 10.0, 10.0, 40.0, 100.0, 30.0, 160.0, 40.0, 300.0, 0.0, 50.0, 60.0, 10.0, 560.0, 20.0, 20.0, 120.0, 20.0, 140.0, 720.0, 80.0, 20.0, 50.0, 220.0, 40.0, 60.0, 80.0, 10.0, 10.0, 80.0, 20.0, 350.0, 20.0, 0.0, 90.0, 30.0, 10.0, 10.0, 10.0, 190.0, 550.0, 60.0, 20.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 10.0, 160.0, 100.0, 30.0, 80.0, 10.0, 20.0, 160.0, 70.0, 210.0, 210.0, 40.0, 330.0, 20.0, 300.0, 90.0, 0.0, 200.0, 420.0, 40.0, 220.0, 290.0, 570.0, 50.0, 90.0, 90.0, 100.0, 220.0, 20.0, 110.0, -30.0, 0.0, 30.0, 720.0, -20.0, 270.0, 50.0, 30.0, 30.0, 80.0, 0.0, 40.0, 40.0, 180.0, 320.0, 190.0, 360.0, 160.0, 40.0, 0.0, 80.0, 20.0, 30.0, 170.0, 30.0, 60.0, 460.0, 470.0, -10.0, -40.0, 110.0, 170.0, 80.0, 30.0, 210.0, 10.0, 20.0, 50.0, 290.0, 120.0, 10.0, -10.0, 50.0, 0.0, 170.0, 50.0, 300.0, 40.0, 20.0, 350.0, 20.0, 90.0, 450.0, 20.0, 40.0, 340.0, 390.0, 30.0, 20.0, 60.0, 10.0, 30.0, 20.0, 0.0, 130.0, 90.0, 70.0, 70.0, 70.0, 10.0, 60.0, 10.0, 20.0, 410.0, 220.0, 90.0, 60.0, 80.0, 160.0, 70.0, 0.0, 560.0, -15.0, 60.0, 310.0, 170.0, 80.0, 210.0, 70.0, 40.0, 20.0, 340.0, 100.0, -40.0, 50.0, 160.0, 60.0, 20.0, 160.0, 40.0, 410.0, 0.0, 70.0, 20.0, 20.0, 320.0, 10.0, 10.0, 30.0, 10.0, 30.0, 30.0, 70.0, 60.0, 270.0, 760.0, 130.0, 170.0, 30.0, 50.0, 90.0, 280.0, 40.0, 40.0, -210.0, 200.0, 90.0, 190.0, 140.0, 60.0, 80.0, 320.0, 20.0, 200.0, 20.0, 50.0, 20.0, 300.0, 50.0, -40.0, 150.0, 340.0, 0.0, 60.0, 390.0, 30.0, 50.0, 260.0, 410.0, 530.0, 110.0, -70.0, 220.0, 50.0, 190.0, 80.0, 60.0, 150.0, 180.0, 90.0, 40.0, 170.0, 50.0, 430.0, 30.0, -30.0, 30.0, 40.0, -20.0, 50.0, 110.0, 100.0, 20.0, 30.0, 600.0, 10.0, 40.0, 40.0, 20.0, -40.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.087846644731732, "mean_inference_ms": 2.1113180702891636, "mean_action_processing_ms": 0.5609959581867462, "mean_env_wait_ms": 1.8021488764672613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016497135162353516, "StateBufferConnector_ms": 0.012209653854370117, "ViewRequirementAgentConnector_ms": 0.429431676864624}, "num_episodes": 23, "episode_return_max": 2180.0, "episode_return_min": 140.0, "episode_return_mean": 1112.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.098162536957734, "num_env_steps_trained_throughput_per_sec": 20.098162536957734, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 3480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3480000, "timers": {"training_iteration_time_ms": 206141.341, "restore_workers_time_ms": 0.012, "training_step_time_ms": 206141.296, "sample_time_ms": 3017.906, "learn_time_ms": 203100.543, "learn_throughput": 19.695, "synch_weights_time_ms": 10.922}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "done": false, "training_iteration": 87, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-36-59", "timestamp": 1717256219, "time_this_iter_s": 199.05802702903748, "time_total_s": 47034.98058462143, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 47034.98058462143, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 18.845035460992907, "ram_util_percent": 81.03226950354609}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2614009652084435, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007043825826087929, "vf_loss": 6.229079331935277, "vf_explained_var": 0.0006006695465031015, "kl": Infinity, "entropy": 0.26791299071333535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 821625.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "env_runners": {"episode_reward_max": 2180.0, "episode_reward_min": 130.0, "episode_reward_mean": 1090.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -570.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 109.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1710.0, 1200.0, 770.0, 1270.0, 1540.0, 1180.0, 355.0, 1000.0, 610.0, 290.0, 1825.0, 1545.0, 720.0, 1215.0, 425.0, 320.0, 1550.0, 1070.0, 1430.0, 570.0, 1955.0, 1470.0, 1490.0, 1220.0, 1050.0, 1370.0, 515.0, 1350.0, 700.0, 1520.0, 1070.0, 1820.0, 1280.0, 1460.0, 310.0, 1420.0, 1670.0, 600.0, 400.0, 1330.0, 1100.0, 220.0, 1040.0, 925.0, 890.0, 1170.0, 810.0, 1280.0, 1050.0, 800.0, 1190.0, 1540.0, 1200.0, 1250.0, 1555.0, 1170.0, 1230.0, 1430.0, 720.0, 910.0, 150.0, 1050.0, 1660.0, 1510.0, 1190.0, 1410.0, 1300.0, 990.0, 990.0, 1450.0, 550.0, 1120.0, 1505.0, 1300.0, 520.0, 1660.0, 910.0, 1090.0, 2180.0, 990.0, 860.0, 980.0, 425.0, 390.0, 760.0, 1080.0, 1560.0, 1420.0, 970.0, 130.0, 1470.0, 760.0, 805.0, 1240.0, 1040.0, 630.0, 1640.0, 1450.0, 280.0, 1570.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [330.0, 90.0, 110.0, -20.0, 10.0, 200.0, -40.0, 130.0, 590.0, 310.0, 510.0, 120.0, 40.0, 0.0, 170.0, -30.0, 260.0, 20.0, 30.0, 80.0, 30.0, 100.0, 20.0, 20.0, 220.0, 160.0, 10.0, 40.0, 160.0, 10.0, 80.0, 40.0, 10.0, 110.0, 10.0, 200.0, 40.0, 230.0, 310.0, 240.0, 20.0, 120.0, 30.0, -40.0, 240.0, 40.0, 520.0, 390.0, 60.0, 160.0, 60.0, 310.0, 110.0, 40.0, 40.0, 20.0, 470.0, 80.0, 20.0, 30.0, -570.0, 170.0, 20.0, 30.0, 20.0, 30.0, 180.0, 300.0, 70.0, 105.0, 0.0, 10.0, 40.0, 480.0, 160.0, 80.0, 130.0, 40.0, 80.0, -20.0, 200.0, 10.0, 20.0, 30.0, 40.0, 20.0, 160.0, 10.0, 20.0, 100.0, 80.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 30.0, 40.0, 70.0, 170.0, 90.0, 60.0, 15.0, 390.0, 70.0, 80.0, 550.0, 330.0, 200.0, 300.0, 220.0, 50.0, 170.0, 20.0, 40.0, 45.0, 470.0, 30.0, 660.0, 0.0, 30.0, 10.0, 40.0, 0.0, 0.0, 0.0, 80.0, -100.0, 100.0, 70.0, 190.0, 480.0, -55.0, 0.0, 220.0, 60.0, 40.0, 110.0, 0.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 280.0, 10.0, 25.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 210.0, 20.0, 10.0, 30.0, 540.0, 50.0, 40.0, 70.0, 40.0, 180.0, 560.0, 30.0, -40.0, 80.0, 40.0, 10.0, 270.0, 90.0, 90.0, 0.0, 50.0, 260.0, 110.0, 150.0, 110.0, 70.0, 90.0, 170.0, 30.0, 60.0, 310.0, 420.0, 160.0, 10.0, 170.0, 20.0, 40.0, 0.0, 30.0, 10.0, 0.0, 50.0, 160.0, 90.0, 500.0, -5.0, 180.0, 170.0, 700.0, 170.0, 130.0, 10.0, 110.0, -10.0, 190.0, 0.0, 0.0, 0.0, 510.0, 220.0, 160.0, 160.0, 30.0, 200.0, 180.0, 240.0, 60.0, 90.0, 470.0, 120.0, 130.0, 30.0, 90.0, 80.0, 30.0, 30.0, 830.0, 70.0, 20.0, 110.0, 110.0, -30.0, 10.0, 40.0, 40.0, 190.0, 90.0, -10.0, 250.0, 30.0, 0.0, 40.0, 60.0, 360.0, 110.0, 80.0, 30.0, 200.0, 40.0, 210.0, 30.0, 190.0, 50.0, 430.0, 10.0, 30.0, 50.0, 15.0, 50.0, 310.0, 10.0, 30.0, 10.0, 0.0, 170.0, -10.0, 120.0, 30.0, 100.0, 10.0, 90.0, 480.0, 0.0, 360.0, 40.0, 10.0, 40.0, 120.0, 100.0, 10.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 50.0, 110.0, 330.0, 190.0, 440.0, 100.0, 110.0, 110.0, 160.0, 340.0, 370.0, 20.0, 0.0, 20.0, -40.0, 80.0, 80.0, 40.0, -70.0, 50.0, 60.0, 380.0, 0.0, 50.0, 50.0, 380.0, 390.0, 530.0, 360.0, 330.0, 10.0, 160.0, 160.0, 60.0, 30.0, 90.0, 20.0, 60.0, 430.0, 80.0, 80.0, 310.0, 60.0, 10.0, 190.0, 110.0, 130.0, 60.0, 60.0, 0.0, 70.0, 0.0, 60.0, 10.0, 20.0, 20.0, 70.0, 0.0, 80.0, -30.0, -30.0, 250.0, 440.0, 160.0, 50.0, 140.0, 340.0, 20.0, 120.0, 290.0, 30.0, 20.0, 320.0, 60.0, 600.0, 50.0, 90.0, 90.0, 20.0, 80.0, 170.0, 80.0, 0.0, 50.0, 140.0, 40.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 40.0, 100.0, 90.0, 10.0, 110.0, 20.0, 30.0, 10.0, 10.0, 0.0, 450.0, 130.0, 510.0, 90.0, 80.0, 20.0, -10.0, 360.0, 70.0, 30.0, 220.0, 60.0, 160.0, 80.0, 70.0, 60.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 40.0, -40.0, 10.0, 420.0, 70.0, -20.0, 230.0, 40.0, 10.0, 280.0, 40.0, 50.0, 60.0, 170.0, 80.0, 660.0, -40.0, -40.0, -10.0, 30.0, -35.0, 210.0, 10.0, -30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 610.0, 40.0, 40.0, 10.0, 40.0, 0.0, 280.0, 30.0, 30.0, 700.0, 0.0, 0.0, 410.0, 60.0, 0.0, 10.0, 70.0, 50.0, 110.0, 30.0, 70.0, 390.0, 330.0, 0.0, 20.0, 30.0, 200.0, 20.0, 90.0, 90.0, 110.0, 30.0, 70.0, 90.0, 40.0, 490.0, 180.0, 40.0, 20.0, 50.0, 40.0, 40.0, 20.0, 70.0, 140.0, 120.0, 410.0, 40.0, -110.0, 20.0, 50.0, 60.0, 60.0, 50.0, 130.0, 50.0, -30.0, 430.0, 120.0, 230.0, 90.0, 180.0, 40.0, 200.0, 20.0, 60.0, 70.0, 20.0, 50.0, 40.0, 860.0, 90.0, 150.0, 170.0, 10.0, 30.0, 290.0, 210.0, 200.0, 40.0, 10.0, 100.0, 400.0, 70.0, 20.0, 90.0, 230.0, 50.0, 190.0, 0.0, 100.0, 85.0, 40.0, 100.0, 70.0, 210.0, 50.0, 290.0, 150.0, 290.0, 270.0, 100.0, 70.0, 220.0, 590.0, 20.0, 10.0, 10.0, 10.0, 40.0, 100.0, 30.0, 160.0, 40.0, 300.0, 0.0, 50.0, 60.0, 10.0, 560.0, 20.0, 20.0, 120.0, 20.0, 140.0, 720.0, 80.0, 20.0, 50.0, 220.0, 40.0, 60.0, 80.0, 10.0, 10.0, 80.0, 20.0, 350.0, 20.0, 0.0, 90.0, 30.0, 10.0, 10.0, 10.0, 190.0, 550.0, 60.0, 20.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 10.0, 160.0, 100.0, 30.0, 80.0, 10.0, 20.0, 160.0, 70.0, 210.0, 210.0, 40.0, 330.0, 20.0, 300.0, 90.0, 0.0, 200.0, 420.0, 40.0, 220.0, 290.0, 570.0, 50.0, 90.0, 90.0, 100.0, 220.0, 20.0, 110.0, -30.0, 0.0, 30.0, 720.0, -20.0, 270.0, 50.0, 30.0, 30.0, 80.0, 0.0, 40.0, 40.0, 180.0, 320.0, 190.0, 360.0, 160.0, 40.0, 0.0, 80.0, 20.0, 30.0, 170.0, 30.0, 60.0, 460.0, 470.0, -10.0, -40.0, 110.0, 170.0, 80.0, 30.0, 210.0, 10.0, 20.0, 50.0, 290.0, 120.0, 10.0, -10.0, 50.0, 0.0, 170.0, 50.0, 300.0, 40.0, 20.0, 350.0, 20.0, 90.0, 450.0, 20.0, 40.0, 340.0, 390.0, 30.0, 20.0, 60.0, 10.0, 30.0, 20.0, 0.0, 130.0, 90.0, 70.0, 70.0, 70.0, 10.0, 60.0, 10.0, 20.0, 410.0, 220.0, 90.0, 60.0, 80.0, 160.0, 70.0, 0.0, 560.0, -15.0, 60.0, 310.0, 170.0, 80.0, 210.0, 70.0, 40.0, 20.0, 340.0, 100.0, -40.0, 50.0, 160.0, 60.0, 20.0, 160.0, 40.0, 410.0, 0.0, 70.0, 20.0, 20.0, 320.0, 10.0, 10.0, 30.0, 10.0, 30.0, 30.0, 70.0, 60.0, 270.0, 760.0, 130.0, 170.0, 30.0, 50.0, 90.0, 280.0, 40.0, 40.0, -210.0, 200.0, 90.0, 190.0, 140.0, 60.0, 80.0, 320.0, 20.0, 200.0, 20.0, 50.0, 20.0, 300.0, 50.0, -40.0, 150.0, 340.0, 0.0, 60.0, 390.0, 30.0, 50.0, 260.0, 410.0, 530.0, 110.0, -70.0, 220.0, 50.0, 190.0, 80.0, 60.0, 150.0, 180.0, 90.0, 40.0, 170.0, 50.0, 430.0, 30.0, -30.0, 30.0, 40.0, -20.0, 50.0, 110.0, 100.0, 20.0, 30.0, 600.0, 10.0, 40.0, 40.0, 20.0, -40.0, 160.0, 10.0, 160.0, 20.0, 0.0, -5.0, 0.0, 10.0, 10.0, 220.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 310.0, 50.0, 30.0, 40.0, 40.0, 360.0, 0.0, 120.0, 40.0, 10.0, 70.0, 50.0, 40.0, 190.0, 340.0, 30.0, 200.0, 80.0, 150.0, 0.0, 0.0, 480.0, 110.0, 0.0, -50.0, 100.0, 480.0, 80.0, 350.0, 20.0, -10.0, 100.0, 60.0, 210.0, -10.0, 270.0, 90.0, 70.0, 20.0, 450.0, 160.0, 0.0, 300.0, 0.0, 100.0, 40.0, 150.0, 30.0, 230.0, 60.0, 60.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 0.0, 30.0, -40.0, 670.0, 260.0, 120.0, 30.0, 70.0, 40.0, 280.0, 10.0, 520.0, -30.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 10.0, 10.0, 70.0, -20.0, 10.0, 30.0, -25.0, 620.0, 20.0, 20.0, 80.0, 30.0, 530.0, 0.0, 30.0, 120.0, 220.0, 190.0, 20.0, 180.0, 80.0, 70.0, 60.0, 10.0, 90.0, 10.0, 360.0, 160.0, 10.0, -20.0, 30.0, 0.0, 80.0, -40.0, 380.0, 170.0, 0.0, 20.0, 150.0, -10.0, 300.0, 280.0, 100.0, 200.0, 320.0, 240.0, 40.0, 20.0, 90.0, 70.0, 220.0, -40.0, 70.0, 200.0, 40.0, 200.0, 70.0, 530.0, 150.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 40.0, 20.0, 0.0, 40.0, 30.0, 270.0, 20.0, 300.0, 180.0, 330.0, 190.0, 60.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0808560010879362, "mean_inference_ms": 2.1053223072437315, "mean_action_processing_ms": 0.5592384704271599, "mean_env_wait_ms": 1.7965321208566865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01621389389038086, "StateBufferConnector_ms": 0.01318502426147461, "ViewRequirementAgentConnector_ms": 0.41953468322753906}, "num_episodes": 18, "episode_return_max": 2180.0, "episode_return_min": 130.0, "episode_return_mean": 1090.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.90772857530768, "num_env_steps_trained_throughput_per_sec": 19.90772857530768, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 3520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3520000, "timers": {"training_iteration_time_ms": 200226.287, "restore_workers_time_ms": 0.012, "training_step_time_ms": 200226.242, "sample_time_ms": 2702.081, "learn_time_ms": 197502.295, "learn_throughput": 20.253, "synch_weights_time_ms": 10.654}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "done": false, "training_iteration": 88, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-40-20", "timestamp": 1717256420, "time_this_iter_s": 200.94338583946228, "time_total_s": 47235.92397046089, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x322757940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 47235.92397046089, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 19.762323943661972, "ram_util_percent": 81.56725352112676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0567418008693616, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006820770755709725, "vf_loss": 6.463884839970971, "vf_explained_var": -0.0002622367221072586, "kl": Infinity, "entropy": 0.2674576373510975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 831015.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "env_runners": {"episode_reward_max": 3040.0, "episode_reward_min": 130.0, "episode_reward_mean": 1078.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1340.0}, "policy_reward_mean": {"policy_0": 107.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1490.0, 1220.0, 1050.0, 1370.0, 515.0, 1350.0, 700.0, 1520.0, 1070.0, 1820.0, 1280.0, 1460.0, 310.0, 1420.0, 1670.0, 600.0, 400.0, 1330.0, 1100.0, 220.0, 1040.0, 925.0, 890.0, 1170.0, 810.0, 1280.0, 1050.0, 800.0, 1190.0, 1540.0, 1200.0, 1250.0, 1555.0, 1170.0, 1230.0, 1430.0, 720.0, 910.0, 150.0, 1050.0, 1660.0, 1510.0, 1190.0, 1410.0, 1300.0, 990.0, 990.0, 1450.0, 550.0, 1120.0, 1505.0, 1300.0, 520.0, 1660.0, 910.0, 1090.0, 2180.0, 990.0, 860.0, 980.0, 425.0, 390.0, 760.0, 1080.0, 1560.0, 1420.0, 970.0, 130.0, 1470.0, 760.0, 805.0, 1240.0, 1040.0, 630.0, 1640.0, 1450.0, 280.0, 1570.0, 830.0, 1665.0, 1110.0, 1270.0, 3040.0, 380.0, 1540.0, 1030.0, 960.0, 1430.0, 800.0, 1060.0, 860.0, 240.0, 720.0, 740.0, 750.0, 740.0, 795.0, 1280.0, 480.0, 1100.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 240.0, 60.0, 90.0, 470.0, 120.0, 130.0, 30.0, 90.0, 80.0, 30.0, 30.0, 830.0, 70.0, 20.0, 110.0, 110.0, -30.0, 10.0, 40.0, 40.0, 190.0, 90.0, -10.0, 250.0, 30.0, 0.0, 40.0, 60.0, 360.0, 110.0, 80.0, 30.0, 200.0, 40.0, 210.0, 30.0, 190.0, 50.0, 430.0, 10.0, 30.0, 50.0, 15.0, 50.0, 310.0, 10.0, 30.0, 10.0, 0.0, 170.0, -10.0, 120.0, 30.0, 100.0, 10.0, 90.0, 480.0, 0.0, 360.0, 40.0, 10.0, 40.0, 120.0, 100.0, 10.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 50.0, 110.0, 330.0, 190.0, 440.0, 100.0, 110.0, 110.0, 160.0, 340.0, 370.0, 20.0, 0.0, 20.0, -40.0, 80.0, 80.0, 40.0, -70.0, 50.0, 60.0, 380.0, 0.0, 50.0, 50.0, 380.0, 390.0, 530.0, 360.0, 330.0, 10.0, 160.0, 160.0, 60.0, 30.0, 90.0, 20.0, 60.0, 430.0, 80.0, 80.0, 310.0, 60.0, 10.0, 190.0, 110.0, 130.0, 60.0, 60.0, 0.0, 70.0, 0.0, 60.0, 10.0, 20.0, 20.0, 70.0, 0.0, 80.0, -30.0, -30.0, 250.0, 440.0, 160.0, 50.0, 140.0, 340.0, 20.0, 120.0, 290.0, 30.0, 20.0, 320.0, 60.0, 600.0, 50.0, 90.0, 90.0, 20.0, 80.0, 170.0, 80.0, 0.0, 50.0, 140.0, 40.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 40.0, 100.0, 90.0, 10.0, 110.0, 20.0, 30.0, 10.0, 10.0, 0.0, 450.0, 130.0, 510.0, 90.0, 80.0, 20.0, -10.0, 360.0, 70.0, 30.0, 220.0, 60.0, 160.0, 80.0, 70.0, 60.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 40.0, -40.0, 10.0, 420.0, 70.0, -20.0, 230.0, 40.0, 10.0, 280.0, 40.0, 50.0, 60.0, 170.0, 80.0, 660.0, -40.0, -40.0, -10.0, 30.0, -35.0, 210.0, 10.0, -30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 610.0, 40.0, 40.0, 10.0, 40.0, 0.0, 280.0, 30.0, 30.0, 700.0, 0.0, 0.0, 410.0, 60.0, 0.0, 10.0, 70.0, 50.0, 110.0, 30.0, 70.0, 390.0, 330.0, 0.0, 20.0, 30.0, 200.0, 20.0, 90.0, 90.0, 110.0, 30.0, 70.0, 90.0, 40.0, 490.0, 180.0, 40.0, 20.0, 50.0, 40.0, 40.0, 20.0, 70.0, 140.0, 120.0, 410.0, 40.0, -110.0, 20.0, 50.0, 60.0, 60.0, 50.0, 130.0, 50.0, -30.0, 430.0, 120.0, 230.0, 90.0, 180.0, 40.0, 200.0, 20.0, 60.0, 70.0, 20.0, 50.0, 40.0, 860.0, 90.0, 150.0, 170.0, 10.0, 30.0, 290.0, 210.0, 200.0, 40.0, 10.0, 100.0, 400.0, 70.0, 20.0, 90.0, 230.0, 50.0, 190.0, 0.0, 100.0, 85.0, 40.0, 100.0, 70.0, 210.0, 50.0, 290.0, 150.0, 290.0, 270.0, 100.0, 70.0, 220.0, 590.0, 20.0, 10.0, 10.0, 10.0, 40.0, 100.0, 30.0, 160.0, 40.0, 300.0, 0.0, 50.0, 60.0, 10.0, 560.0, 20.0, 20.0, 120.0, 20.0, 140.0, 720.0, 80.0, 20.0, 50.0, 220.0, 40.0, 60.0, 80.0, 10.0, 10.0, 80.0, 20.0, 350.0, 20.0, 0.0, 90.0, 30.0, 10.0, 10.0, 10.0, 190.0, 550.0, 60.0, 20.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 10.0, 160.0, 100.0, 30.0, 80.0, 10.0, 20.0, 160.0, 70.0, 210.0, 210.0, 40.0, 330.0, 20.0, 300.0, 90.0, 0.0, 200.0, 420.0, 40.0, 220.0, 290.0, 570.0, 50.0, 90.0, 90.0, 100.0, 220.0, 20.0, 110.0, -30.0, 0.0, 30.0, 720.0, -20.0, 270.0, 50.0, 30.0, 30.0, 80.0, 0.0, 40.0, 40.0, 180.0, 320.0, 190.0, 360.0, 160.0, 40.0, 0.0, 80.0, 20.0, 30.0, 170.0, 30.0, 60.0, 460.0, 470.0, -10.0, -40.0, 110.0, 170.0, 80.0, 30.0, 210.0, 10.0, 20.0, 50.0, 290.0, 120.0, 10.0, -10.0, 50.0, 0.0, 170.0, 50.0, 300.0, 40.0, 20.0, 350.0, 20.0, 90.0, 450.0, 20.0, 40.0, 340.0, 390.0, 30.0, 20.0, 60.0, 10.0, 30.0, 20.0, 0.0, 130.0, 90.0, 70.0, 70.0, 70.0, 10.0, 60.0, 10.0, 20.0, 410.0, 220.0, 90.0, 60.0, 80.0, 160.0, 70.0, 0.0, 560.0, -15.0, 60.0, 310.0, 170.0, 80.0, 210.0, 70.0, 40.0, 20.0, 340.0, 100.0, -40.0, 50.0, 160.0, 60.0, 20.0, 160.0, 40.0, 410.0, 0.0, 70.0, 20.0, 20.0, 320.0, 10.0, 10.0, 30.0, 10.0, 30.0, 30.0, 70.0, 60.0, 270.0, 760.0, 130.0, 170.0, 30.0, 50.0, 90.0, 280.0, 40.0, 40.0, -210.0, 200.0, 90.0, 190.0, 140.0, 60.0, 80.0, 320.0, 20.0, 200.0, 20.0, 50.0, 20.0, 300.0, 50.0, -40.0, 150.0, 340.0, 0.0, 60.0, 390.0, 30.0, 50.0, 260.0, 410.0, 530.0, 110.0, -70.0, 220.0, 50.0, 190.0, 80.0, 60.0, 150.0, 180.0, 90.0, 40.0, 170.0, 50.0, 430.0, 30.0, -30.0, 30.0, 40.0, -20.0, 50.0, 110.0, 100.0, 20.0, 30.0, 600.0, 10.0, 40.0, 40.0, 20.0, -40.0, 160.0, 10.0, 160.0, 20.0, 0.0, -5.0, 0.0, 10.0, 10.0, 220.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 310.0, 50.0, 30.0, 40.0, 40.0, 360.0, 0.0, 120.0, 40.0, 10.0, 70.0, 50.0, 40.0, 190.0, 340.0, 30.0, 200.0, 80.0, 150.0, 0.0, 0.0, 480.0, 110.0, 0.0, -50.0, 100.0, 480.0, 80.0, 350.0, 20.0, -10.0, 100.0, 60.0, 210.0, -10.0, 270.0, 90.0, 70.0, 20.0, 450.0, 160.0, 0.0, 300.0, 0.0, 100.0, 40.0, 150.0, 30.0, 230.0, 60.0, 60.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 0.0, 30.0, -40.0, 670.0, 260.0, 120.0, 30.0, 70.0, 40.0, 280.0, 10.0, 520.0, -30.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 10.0, 10.0, 70.0, -20.0, 10.0, 30.0, -25.0, 620.0, 20.0, 20.0, 80.0, 30.0, 530.0, 0.0, 30.0, 120.0, 220.0, 190.0, 20.0, 180.0, 80.0, 70.0, 60.0, 10.0, 90.0, 10.0, 360.0, 160.0, 10.0, -20.0, 30.0, 0.0, 80.0, -40.0, 380.0, 170.0, 0.0, 20.0, 150.0, -10.0, 300.0, 280.0, 100.0, 200.0, 320.0, 240.0, 40.0, 20.0, 90.0, 70.0, 220.0, -40.0, 70.0, 200.0, 40.0, 200.0, 70.0, 530.0, 150.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 40.0, 20.0, 0.0, 40.0, 30.0, 270.0, 20.0, 300.0, 180.0, 330.0, 190.0, 60.0, 150.0, 0.0, 30.0, 200.0, 70.0, 50.0, 60.0, 10.0, 160.0, 210.0, 40.0, 240.0, 270.0, 220.0, 140.0, 270.0, 120.0, 130.0, 100.0, 75.0, 100.0, 240.0, 180.0, 110.0, 40.0, 80.0, 190.0, 40.0, 80.0, 40.0, 110.0, 180.0, 30.0, 50.0, 230.0, 150.0, 510.0, 30.0, 20.0, -40.0, 110.0, 230.0, 1340.0, 0.0, 710.0, 160.0, 70.0, 70.0, 330.0, 80.0, 50.0, 50.0, 60.0, 100.0, 0.0, 0.0, 20.0, 0.0, 120.0, 30.0, 0.0, 80.0, 110.0, 270.0, 170.0, 170.0, 440.0, 90.0, 170.0, 50.0, -10.0, 300.0, 10.0, 110.0, 200.0, 50.0, 220.0, 180.0, 80.0, -200.0, 80.0, 40.0, 30.0, 30.0, 190.0, 80.0, 20.0, 30.0, 30.0, 220.0, 290.0, -60.0, 180.0, 0.0, -230.0, 500.0, 480.0, 150.0, 200.0, 20.0, 190.0, 0.0, 20.0, 200.0, 40.0, 80.0, 40.0, 40.0, 190.0, 90.0, 100.0, -110.0, 10.0, 120.0, 700.0, 50.0, 10.0, 10.0, 190.0, 10.0, 70.0, 290.0, 40.0, 0.0, 0.0, 30.0, 30.0, 120.0, 190.0, 70.0, 90.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 20.0, 60.0, 90.0, 10.0, 230.0, 30.0, 100.0, 160.0, 360.0, 0.0, 30.0, 20.0, 200.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 70.0, 490.0, 0.0, 210.0, 10.0, 80.0, 0.0, 190.0, 30.0, 80.0, 20.0, 30.0, 90.0, 20.0, 0.0, -5.0, 310.0, 280.0, 20.0, 100.0, 50.0, 20.0, 0.0, 30.0, 10.0, 150.0, 40.0, 110.0, 70.0, 260.0, 520.0, 70.0, 20.0, 10.0, -30.0, 30.0, 80.0, 20.0, 0.0, 100.0, 90.0, 50.0, 130.0, 180.0, 250.0, 60.0, 20.0, 130.0, 30.0, 120.0, 180.0, 100.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0688487450330326, "mean_inference_ms": 2.0921017382333718, "mean_action_processing_ms": 0.5568127273131583, "mean_env_wait_ms": 1.7892859158715526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0158388614654541, "StateBufferConnector_ms": 0.013017892837524414, "ViewRequirementAgentConnector_ms": 0.41320300102233887}, "num_episodes": 22, "episode_return_max": 3040.0, "episode_return_min": 130.0, "episode_return_mean": 1078.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.98421485333226, "num_env_steps_trained_throughput_per_sec": 19.98421485333226, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 3560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3560000, "timers": {"training_iteration_time_ms": 199974.371, "restore_workers_time_ms": 0.012, "training_step_time_ms": 199974.325, "sample_time_ms": 2605.447, "learn_time_ms": 197347.068, "learn_throughput": 20.269, "synch_weights_time_ms": 10.512}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "done": false, "training_iteration": 89, "trial_id": "3d3a5_00000", "date": "2024-06-01_11-43-40", "timestamp": 1717256620, "time_this_iter_s": 200.1666967868805, "time_total_s": 47436.09066724777, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7efdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 47436.09066724777, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 18.698586572438163, "ram_util_percent": 81.24911660777386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.297630622046697, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.649336631458026, "policy_loss": -0.0059276761931463424, "vf_loss": 6.653559835574117, "vf_explained_var": 0.00022079031180522948, "kl": 0.0033668633662413436, "entropy": 0.2627211157220621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 840405.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "env_runners": {"episode_reward_max": 3040.0, "episode_reward_min": 130.0, "episode_reward_mean": 1064.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1340.0}, "policy_reward_mean": {"policy_0": 106.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1100.0, 220.0, 1040.0, 925.0, 890.0, 1170.0, 810.0, 1280.0, 1050.0, 800.0, 1190.0, 1540.0, 1200.0, 1250.0, 1555.0, 1170.0, 1230.0, 1430.0, 720.0, 910.0, 150.0, 1050.0, 1660.0, 1510.0, 1190.0, 1410.0, 1300.0, 990.0, 990.0, 1450.0, 550.0, 1120.0, 1505.0, 1300.0, 520.0, 1660.0, 910.0, 1090.0, 2180.0, 990.0, 860.0, 980.0, 425.0, 390.0, 760.0, 1080.0, 1560.0, 1420.0, 970.0, 130.0, 1470.0, 760.0, 805.0, 1240.0, 1040.0, 630.0, 1640.0, 1450.0, 280.0, 1570.0, 830.0, 1665.0, 1110.0, 1270.0, 3040.0, 380.0, 1540.0, 1030.0, 960.0, 1430.0, 800.0, 1060.0, 860.0, 240.0, 720.0, 740.0, 750.0, 740.0, 795.0, 1280.0, 480.0, 1100.0, 1220.0, 760.0, 580.0, 170.0, 1440.0, 1485.0, 1340.0, 1880.0, 990.0, 640.0, 1435.0, 1410.0, 1050.0, 970.0, 1260.0, 380.0, 770.0, 1430.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-10.0, 360.0, 70.0, 30.0, 220.0, 60.0, 160.0, 80.0, 70.0, 60.0, 0.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 40.0, -40.0, 10.0, 420.0, 70.0, -20.0, 230.0, 40.0, 10.0, 280.0, 40.0, 50.0, 60.0, 170.0, 80.0, 660.0, -40.0, -40.0, -10.0, 30.0, -35.0, 210.0, 10.0, -30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 610.0, 40.0, 40.0, 10.0, 40.0, 0.0, 280.0, 30.0, 30.0, 700.0, 0.0, 0.0, 410.0, 60.0, 0.0, 10.0, 70.0, 50.0, 110.0, 30.0, 70.0, 390.0, 330.0, 0.0, 20.0, 30.0, 200.0, 20.0, 90.0, 90.0, 110.0, 30.0, 70.0, 90.0, 40.0, 490.0, 180.0, 40.0, 20.0, 50.0, 40.0, 40.0, 20.0, 70.0, 140.0, 120.0, 410.0, 40.0, -110.0, 20.0, 50.0, 60.0, 60.0, 50.0, 130.0, 50.0, -30.0, 430.0, 120.0, 230.0, 90.0, 180.0, 40.0, 200.0, 20.0, 60.0, 70.0, 20.0, 50.0, 40.0, 860.0, 90.0, 150.0, 170.0, 10.0, 30.0, 290.0, 210.0, 200.0, 40.0, 10.0, 100.0, 400.0, 70.0, 20.0, 90.0, 230.0, 50.0, 190.0, 0.0, 100.0, 85.0, 40.0, 100.0, 70.0, 210.0, 50.0, 290.0, 150.0, 290.0, 270.0, 100.0, 70.0, 220.0, 590.0, 20.0, 10.0, 10.0, 10.0, 40.0, 100.0, 30.0, 160.0, 40.0, 300.0, 0.0, 50.0, 60.0, 10.0, 560.0, 20.0, 20.0, 120.0, 20.0, 140.0, 720.0, 80.0, 20.0, 50.0, 220.0, 40.0, 60.0, 80.0, 10.0, 10.0, 80.0, 20.0, 350.0, 20.0, 0.0, 90.0, 30.0, 10.0, 10.0, 10.0, 190.0, 550.0, 60.0, 20.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 10.0, 160.0, 100.0, 30.0, 80.0, 10.0, 20.0, 160.0, 70.0, 210.0, 210.0, 40.0, 330.0, 20.0, 300.0, 90.0, 0.0, 200.0, 420.0, 40.0, 220.0, 290.0, 570.0, 50.0, 90.0, 90.0, 100.0, 220.0, 20.0, 110.0, -30.0, 0.0, 30.0, 720.0, -20.0, 270.0, 50.0, 30.0, 30.0, 80.0, 0.0, 40.0, 40.0, 180.0, 320.0, 190.0, 360.0, 160.0, 40.0, 0.0, 80.0, 20.0, 30.0, 170.0, 30.0, 60.0, 460.0, 470.0, -10.0, -40.0, 110.0, 170.0, 80.0, 30.0, 210.0, 10.0, 20.0, 50.0, 290.0, 120.0, 10.0, -10.0, 50.0, 0.0, 170.0, 50.0, 300.0, 40.0, 20.0, 350.0, 20.0, 90.0, 450.0, 20.0, 40.0, 340.0, 390.0, 30.0, 20.0, 60.0, 10.0, 30.0, 20.0, 0.0, 130.0, 90.0, 70.0, 70.0, 70.0, 10.0, 60.0, 10.0, 20.0, 410.0, 220.0, 90.0, 60.0, 80.0, 160.0, 70.0, 0.0, 560.0, -15.0, 60.0, 310.0, 170.0, 80.0, 210.0, 70.0, 40.0, 20.0, 340.0, 100.0, -40.0, 50.0, 160.0, 60.0, 20.0, 160.0, 40.0, 410.0, 0.0, 70.0, 20.0, 20.0, 320.0, 10.0, 10.0, 30.0, 10.0, 30.0, 30.0, 70.0, 60.0, 270.0, 760.0, 130.0, 170.0, 30.0, 50.0, 90.0, 280.0, 40.0, 40.0, -210.0, 200.0, 90.0, 190.0, 140.0, 60.0, 80.0, 320.0, 20.0, 200.0, 20.0, 50.0, 20.0, 300.0, 50.0, -40.0, 150.0, 340.0, 0.0, 60.0, 390.0, 30.0, 50.0, 260.0, 410.0, 530.0, 110.0, -70.0, 220.0, 50.0, 190.0, 80.0, 60.0, 150.0, 180.0, 90.0, 40.0, 170.0, 50.0, 430.0, 30.0, -30.0, 30.0, 40.0, -20.0, 50.0, 110.0, 100.0, 20.0, 30.0, 600.0, 10.0, 40.0, 40.0, 20.0, -40.0, 160.0, 10.0, 160.0, 20.0, 0.0, -5.0, 0.0, 10.0, 10.0, 220.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 310.0, 50.0, 30.0, 40.0, 40.0, 360.0, 0.0, 120.0, 40.0, 10.0, 70.0, 50.0, 40.0, 190.0, 340.0, 30.0, 200.0, 80.0, 150.0, 0.0, 0.0, 480.0, 110.0, 0.0, -50.0, 100.0, 480.0, 80.0, 350.0, 20.0, -10.0, 100.0, 60.0, 210.0, -10.0, 270.0, 90.0, 70.0, 20.0, 450.0, 160.0, 0.0, 300.0, 0.0, 100.0, 40.0, 150.0, 30.0, 230.0, 60.0, 60.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 0.0, 30.0, -40.0, 670.0, 260.0, 120.0, 30.0, 70.0, 40.0, 280.0, 10.0, 520.0, -30.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 10.0, 10.0, 70.0, -20.0, 10.0, 30.0, -25.0, 620.0, 20.0, 20.0, 80.0, 30.0, 530.0, 0.0, 30.0, 120.0, 220.0, 190.0, 20.0, 180.0, 80.0, 70.0, 60.0, 10.0, 90.0, 10.0, 360.0, 160.0, 10.0, -20.0, 30.0, 0.0, 80.0, -40.0, 380.0, 170.0, 0.0, 20.0, 150.0, -10.0, 300.0, 280.0, 100.0, 200.0, 320.0, 240.0, 40.0, 20.0, 90.0, 70.0, 220.0, -40.0, 70.0, 200.0, 40.0, 200.0, 70.0, 530.0, 150.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 40.0, 20.0, 0.0, 40.0, 30.0, 270.0, 20.0, 300.0, 180.0, 330.0, 190.0, 60.0, 150.0, 0.0, 30.0, 200.0, 70.0, 50.0, 60.0, 10.0, 160.0, 210.0, 40.0, 240.0, 270.0, 220.0, 140.0, 270.0, 120.0, 130.0, 100.0, 75.0, 100.0, 240.0, 180.0, 110.0, 40.0, 80.0, 190.0, 40.0, 80.0, 40.0, 110.0, 180.0, 30.0, 50.0, 230.0, 150.0, 510.0, 30.0, 20.0, -40.0, 110.0, 230.0, 1340.0, 0.0, 710.0, 160.0, 70.0, 70.0, 330.0, 80.0, 50.0, 50.0, 60.0, 100.0, 0.0, 0.0, 20.0, 0.0, 120.0, 30.0, 0.0, 80.0, 110.0, 270.0, 170.0, 170.0, 440.0, 90.0, 170.0, 50.0, -10.0, 300.0, 10.0, 110.0, 200.0, 50.0, 220.0, 180.0, 80.0, -200.0, 80.0, 40.0, 30.0, 30.0, 190.0, 80.0, 20.0, 30.0, 30.0, 220.0, 290.0, -60.0, 180.0, 0.0, -230.0, 500.0, 480.0, 150.0, 200.0, 20.0, 190.0, 0.0, 20.0, 200.0, 40.0, 80.0, 40.0, 40.0, 190.0, 90.0, 100.0, -110.0, 10.0, 120.0, 700.0, 50.0, 10.0, 10.0, 190.0, 10.0, 70.0, 290.0, 40.0, 0.0, 0.0, 30.0, 30.0, 120.0, 190.0, 70.0, 90.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 20.0, 60.0, 90.0, 10.0, 230.0, 30.0, 100.0, 160.0, 360.0, 0.0, 30.0, 20.0, 200.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 70.0, 490.0, 0.0, 210.0, 10.0, 80.0, 0.0, 190.0, 30.0, 80.0, 20.0, 30.0, 90.0, 20.0, 0.0, -5.0, 310.0, 280.0, 20.0, 100.0, 50.0, 20.0, 0.0, 30.0, 10.0, 150.0, 40.0, 110.0, 70.0, 260.0, 520.0, 70.0, 20.0, 10.0, -30.0, 30.0, 80.0, 20.0, 0.0, 100.0, 90.0, 50.0, 130.0, 180.0, 250.0, 60.0, 20.0, 130.0, 30.0, 120.0, 180.0, 100.0, 30.0, 0.0, 170.0, 150.0, 220.0, 370.0, 70.0, 90.0, 80.0, 50.0, 20.0, 0.0, 40.0, 110.0, 80.0, 30.0, 30.0, 60.0, 0.0, 20.0, 390.0, 10.0, 240.0, 30.0, 20.0, 40.0, 140.0, 0.0, 10.0, 0.0, 90.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 80.0, 10.0, 10.0, 170.0, 150.0, -20.0, 60.0, 50.0, 260.0, 160.0, 410.0, 30.0, 170.0, -40.0, 260.0, 180.0, 310.0, 75.0, 30.0, 40.0, 50.0, 170.0, 410.0, 10.0, 20.0, 670.0, 40.0, 50.0, 80.0, 150.0, 100.0, 0.0, 220.0, 300.0, 130.0, 110.0, 60.0, 60.0, 210.0, 540.0, 80.0, 30.0, 360.0, 210.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 560.0, 10.0, 60.0, 40.0, 20.0, 30.0, 110.0, 160.0, 10.0, 20.0, 170.0, 70.0, 10.0, 50.0, 145.0, 30.0, 370.0, 160.0, 90.0, 100.0, 30.0, 40.0, 420.0, 10.0, 330.0, 180.0, 180.0, 80.0, 90.0, 160.0, 330.0, 80.0, -30.0, 10.0, 0.0, 150.0, 490.0, 20.0, 390.0, -50.0, 50.0, -40.0, 30.0, 290.0, 30.0, 10.0, 10.0, 0.0, 100.0, 0.0, 40.0, 190.0, 300.0, 100.0, 230.0, 20.0, 150.0, 160.0, 170.0, 80.0, 20.0, 290.0, 40.0, 0.0, 80.0, 10.0, 30.0, 0.0, 10.0, 0.0, 150.0, 80.0, 20.0, 260.0, 220.0, 30.0, 30.0, 30.0, 0.0, 30.0, 140.0, 30.0, 0.0, 150.0, 80.0, 40.0, 560.0, 60.0, 270.0, 20.0, 30.0, 220.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.065653259001717, "mean_inference_ms": 2.092631302498698, "mean_action_processing_ms": 0.55549661387833, "mean_env_wait_ms": 1.7845654281523997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012612581253051758, "StateBufferConnector_ms": 0.012034416198730469, "ViewRequirementAgentConnector_ms": 0.4073903560638428}, "num_episodes": 18, "episode_return_max": 3040.0, "episode_return_min": 130.0, "episode_return_mean": 1064.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.4485264628841543, "num_env_steps_trained_throughput_per_sec": 3.4485264628841543, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 3600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3600000, "timers": {"training_iteration_time_ms": 296156.779, "restore_workers_time_ms": 0.012, "training_step_time_ms": 296156.732, "sample_time_ms": 2608.645, "learn_time_ms": 293526.035, "learn_throughput": 13.627, "synch_weights_time_ms": 10.672}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "done": false, "training_iteration": 90, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-03-00", "timestamp": 1717257780, "time_this_iter_s": 1159.924400806427, "time_total_s": 48596.0150680542, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dc700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 48596.0150680542, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 21.769072164948454, "ram_util_percent": 82.35601374570446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.332360325091944, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.174573625162386, "policy_loss": -0.00712628206505943, "vf_loss": 7.180357434777533, "vf_explained_var": 5.2476925844836415e-05, "kl": 0.005303586336737464, "entropy": 0.26668973492103387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 849795.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "env_runners": {"episode_reward_max": 3040.0, "episode_reward_min": 130.0, "episode_reward_mean": 1094.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1340.0}, "policy_reward_mean": {"policy_0": 109.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1510.0, 1190.0, 1410.0, 1300.0, 990.0, 990.0, 1450.0, 550.0, 1120.0, 1505.0, 1300.0, 520.0, 1660.0, 910.0, 1090.0, 2180.0, 990.0, 860.0, 980.0, 425.0, 390.0, 760.0, 1080.0, 1560.0, 1420.0, 970.0, 130.0, 1470.0, 760.0, 805.0, 1240.0, 1040.0, 630.0, 1640.0, 1450.0, 280.0, 1570.0, 830.0, 1665.0, 1110.0, 1270.0, 3040.0, 380.0, 1540.0, 1030.0, 960.0, 1430.0, 800.0, 1060.0, 860.0, 240.0, 720.0, 740.0, 750.0, 740.0, 795.0, 1280.0, 480.0, 1100.0, 1220.0, 760.0, 580.0, 170.0, 1440.0, 1485.0, 1340.0, 1880.0, 990.0, 640.0, 1435.0, 1410.0, 1050.0, 970.0, 1260.0, 380.0, 770.0, 1430.0, 800.0, 1270.0, 830.0, 1160.0, 1500.0, 1555.0, 1840.0, 970.0, 1020.0, 880.0, 1600.0, 920.0, 1750.0, 840.0, 1200.0, 1400.0, 1085.0, 1200.0, 835.0, 1595.0, 1000.0, 900.0, 1145.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [290.0, 570.0, 50.0, 90.0, 90.0, 100.0, 220.0, 20.0, 110.0, -30.0, 0.0, 30.0, 720.0, -20.0, 270.0, 50.0, 30.0, 30.0, 80.0, 0.0, 40.0, 40.0, 180.0, 320.0, 190.0, 360.0, 160.0, 40.0, 0.0, 80.0, 20.0, 30.0, 170.0, 30.0, 60.0, 460.0, 470.0, -10.0, -40.0, 110.0, 170.0, 80.0, 30.0, 210.0, 10.0, 20.0, 50.0, 290.0, 120.0, 10.0, -10.0, 50.0, 0.0, 170.0, 50.0, 300.0, 40.0, 20.0, 350.0, 20.0, 90.0, 450.0, 20.0, 40.0, 340.0, 390.0, 30.0, 20.0, 60.0, 10.0, 30.0, 20.0, 0.0, 130.0, 90.0, 70.0, 70.0, 70.0, 10.0, 60.0, 10.0, 20.0, 410.0, 220.0, 90.0, 60.0, 80.0, 160.0, 70.0, 0.0, 560.0, -15.0, 60.0, 310.0, 170.0, 80.0, 210.0, 70.0, 40.0, 20.0, 340.0, 100.0, -40.0, 50.0, 160.0, 60.0, 20.0, 160.0, 40.0, 410.0, 0.0, 70.0, 20.0, 20.0, 320.0, 10.0, 10.0, 30.0, 10.0, 30.0, 30.0, 70.0, 60.0, 270.0, 760.0, 130.0, 170.0, 30.0, 50.0, 90.0, 280.0, 40.0, 40.0, -210.0, 200.0, 90.0, 190.0, 140.0, 60.0, 80.0, 320.0, 20.0, 200.0, 20.0, 50.0, 20.0, 300.0, 50.0, -40.0, 150.0, 340.0, 0.0, 60.0, 390.0, 30.0, 50.0, 260.0, 410.0, 530.0, 110.0, -70.0, 220.0, 50.0, 190.0, 80.0, 60.0, 150.0, 180.0, 90.0, 40.0, 170.0, 50.0, 430.0, 30.0, -30.0, 30.0, 40.0, -20.0, 50.0, 110.0, 100.0, 20.0, 30.0, 600.0, 10.0, 40.0, 40.0, 20.0, -40.0, 160.0, 10.0, 160.0, 20.0, 0.0, -5.0, 0.0, 10.0, 10.0, 220.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 310.0, 50.0, 30.0, 40.0, 40.0, 360.0, 0.0, 120.0, 40.0, 10.0, 70.0, 50.0, 40.0, 190.0, 340.0, 30.0, 200.0, 80.0, 150.0, 0.0, 0.0, 480.0, 110.0, 0.0, -50.0, 100.0, 480.0, 80.0, 350.0, 20.0, -10.0, 100.0, 60.0, 210.0, -10.0, 270.0, 90.0, 70.0, 20.0, 450.0, 160.0, 0.0, 300.0, 0.0, 100.0, 40.0, 150.0, 30.0, 230.0, 60.0, 60.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 0.0, 30.0, -40.0, 670.0, 260.0, 120.0, 30.0, 70.0, 40.0, 280.0, 10.0, 520.0, -30.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 10.0, 10.0, 70.0, -20.0, 10.0, 30.0, -25.0, 620.0, 20.0, 20.0, 80.0, 30.0, 530.0, 0.0, 30.0, 120.0, 220.0, 190.0, 20.0, 180.0, 80.0, 70.0, 60.0, 10.0, 90.0, 10.0, 360.0, 160.0, 10.0, -20.0, 30.0, 0.0, 80.0, -40.0, 380.0, 170.0, 0.0, 20.0, 150.0, -10.0, 300.0, 280.0, 100.0, 200.0, 320.0, 240.0, 40.0, 20.0, 90.0, 70.0, 220.0, -40.0, 70.0, 200.0, 40.0, 200.0, 70.0, 530.0, 150.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 40.0, 20.0, 0.0, 40.0, 30.0, 270.0, 20.0, 300.0, 180.0, 330.0, 190.0, 60.0, 150.0, 0.0, 30.0, 200.0, 70.0, 50.0, 60.0, 10.0, 160.0, 210.0, 40.0, 240.0, 270.0, 220.0, 140.0, 270.0, 120.0, 130.0, 100.0, 75.0, 100.0, 240.0, 180.0, 110.0, 40.0, 80.0, 190.0, 40.0, 80.0, 40.0, 110.0, 180.0, 30.0, 50.0, 230.0, 150.0, 510.0, 30.0, 20.0, -40.0, 110.0, 230.0, 1340.0, 0.0, 710.0, 160.0, 70.0, 70.0, 330.0, 80.0, 50.0, 50.0, 60.0, 100.0, 0.0, 0.0, 20.0, 0.0, 120.0, 30.0, 0.0, 80.0, 110.0, 270.0, 170.0, 170.0, 440.0, 90.0, 170.0, 50.0, -10.0, 300.0, 10.0, 110.0, 200.0, 50.0, 220.0, 180.0, 80.0, -200.0, 80.0, 40.0, 30.0, 30.0, 190.0, 80.0, 20.0, 30.0, 30.0, 220.0, 290.0, -60.0, 180.0, 0.0, -230.0, 500.0, 480.0, 150.0, 200.0, 20.0, 190.0, 0.0, 20.0, 200.0, 40.0, 80.0, 40.0, 40.0, 190.0, 90.0, 100.0, -110.0, 10.0, 120.0, 700.0, 50.0, 10.0, 10.0, 190.0, 10.0, 70.0, 290.0, 40.0, 0.0, 0.0, 30.0, 30.0, 120.0, 190.0, 70.0, 90.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 20.0, 60.0, 90.0, 10.0, 230.0, 30.0, 100.0, 160.0, 360.0, 0.0, 30.0, 20.0, 200.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 70.0, 490.0, 0.0, 210.0, 10.0, 80.0, 0.0, 190.0, 30.0, 80.0, 20.0, 30.0, 90.0, 20.0, 0.0, -5.0, 310.0, 280.0, 20.0, 100.0, 50.0, 20.0, 0.0, 30.0, 10.0, 150.0, 40.0, 110.0, 70.0, 260.0, 520.0, 70.0, 20.0, 10.0, -30.0, 30.0, 80.0, 20.0, 0.0, 100.0, 90.0, 50.0, 130.0, 180.0, 250.0, 60.0, 20.0, 130.0, 30.0, 120.0, 180.0, 100.0, 30.0, 0.0, 170.0, 150.0, 220.0, 370.0, 70.0, 90.0, 80.0, 50.0, 20.0, 0.0, 40.0, 110.0, 80.0, 30.0, 30.0, 60.0, 0.0, 20.0, 390.0, 10.0, 240.0, 30.0, 20.0, 40.0, 140.0, 0.0, 10.0, 0.0, 90.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 80.0, 10.0, 10.0, 170.0, 150.0, -20.0, 60.0, 50.0, 260.0, 160.0, 410.0, 30.0, 170.0, -40.0, 260.0, 180.0, 310.0, 75.0, 30.0, 40.0, 50.0, 170.0, 410.0, 10.0, 20.0, 670.0, 40.0, 50.0, 80.0, 150.0, 100.0, 0.0, 220.0, 300.0, 130.0, 110.0, 60.0, 60.0, 210.0, 540.0, 80.0, 30.0, 360.0, 210.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 560.0, 10.0, 60.0, 40.0, 20.0, 30.0, 110.0, 160.0, 10.0, 20.0, 170.0, 70.0, 10.0, 50.0, 145.0, 30.0, 370.0, 160.0, 90.0, 100.0, 30.0, 40.0, 420.0, 10.0, 330.0, 180.0, 180.0, 80.0, 90.0, 160.0, 330.0, 80.0, -30.0, 10.0, 0.0, 150.0, 490.0, 20.0, 390.0, -50.0, 50.0, -40.0, 30.0, 290.0, 30.0, 10.0, 10.0, 0.0, 100.0, 0.0, 40.0, 190.0, 300.0, 100.0, 230.0, 20.0, 150.0, 160.0, 170.0, 80.0, 20.0, 290.0, 40.0, 0.0, 80.0, 10.0, 30.0, 0.0, 10.0, 0.0, 150.0, 80.0, 20.0, 260.0, 220.0, 30.0, 30.0, 30.0, 0.0, 30.0, 140.0, 30.0, 0.0, 150.0, 80.0, 40.0, 560.0, 60.0, 270.0, 20.0, 30.0, 220.0, 0.0, 70.0, 20.0, 20.0, 10.0, 20.0, 60.0, 330.0, 160.0, 10.0, 100.0, 70.0, 340.0, 10.0, 360.0, 0.0, 40.0, 0.0, 30.0, 90.0, 330.0, 80.0, 370.0, 40.0, 190.0, 0.0, -40.0, 20.0, -40.0, 130.0, 80.0, 120.0, 60.0, 0.0, 260.0, 170.0, 30.0, 120.0, 160.0, 40.0, 200.0, 100.0, 70.0, 40.0, 260.0, 540.0, 60.0, 0.0, 370.0, 40.0, 20.0, 35.0, 90.0, 60.0, 240.0, 60.0, 520.0, 410.0, 80.0, 60.0, 0.0, 60.0, 110.0, 420.0, 80.0, 80.0, 320.0, 210.0, 280.0, 220.0, 60.0, 40.0, 30.0, 10.0, 310.0, 60.0, 10.0, -20.0, 210.0, 10.0, 310.0, 10.0, 10.0, 310.0, 10.0, 40.0, 30.0, 180.0, 400.0, 10.0, 20.0, 10.0, 0.0, 380.0, 0.0, 10.0, -10.0, 60.0, 10.0, 300.0, 120.0, 340.0, 130.0, 210.0, 30.0, 310.0, -110.0, 380.0, 10.0, 80.0, 220.0, 60.0, 50.0, 280.0, 10.0, 40.0, 70.0, 100.0, 80.0, -20.0, 250.0, 100.0, 40.0, 0.0, 30.0, 440.0, 40.0, 10.0, 230.0, 680.0, 180.0, 180.0, 40.0, 100.0, 30.0, 30.0, 50.0, 20.0, 30.0, 260.0, 100.0, 60.0, 490.0, 90.0, -10.0, 50.0, 50.0, 30.0, 440.0, 10.0, -10.0, 10.0, 40.0, 80.0, 50.0, 200.0, 410.0, 200.0, 20.0, 370.0, 20.0, 270.0, 10.0, 120.0, 20.0, 370.0, 45.0, 130.0, 0.0, 40.0, 80.0, 190.0, 320.0, 60.0, 160.0, -10.0, 140.0, 0.0, 170.0, 70.0, 100.0, 120.0, 80.0, 50.0, 20.0, 40.0, -35.0, 40.0, 170.0, 210.0, 140.0, 150.0, 30.0, -15.0, 200.0, 40.0, 490.0, 50.0, 630.0, 0.0, 20.0, 70.0, 180.0, 60.0, 10.0, -10.0, 20.0, 20.0, 190.0, 300.0, 160.0, 30.0, 30.0, 20.0, 290.0, 110.0, 50.0, 10.0, 50.0, 260.0, 50.0, 10.0, 10.0, 60.0, 30.0, 50.0, 50.0, -35.0, 130.0, 570.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.054947113023242, "mean_inference_ms": 2.0821672613727498, "mean_action_processing_ms": 0.5526055321059885, "mean_env_wait_ms": 1.7757553143106402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012459993362426758, "StateBufferConnector_ms": 0.012128591537475586, "ViewRequirementAgentConnector_ms": 0.39940977096557617}, "num_episodes": 23, "episode_return_max": 3040.0, "episode_return_min": 130.0, "episode_return_mean": 1094.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.452090017517112, "num_env_steps_trained_throughput_per_sec": 5.452090017517112, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 3640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3640000, "timers": {"training_iteration_time_ms": 349564.857, "restore_workers_time_ms": 0.012, "training_step_time_ms": 349564.811, "sample_time_ms": 2646.462, "learn_time_ms": 346894.87, "learn_throughput": 11.531, "synch_weights_time_ms": 11.08}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "done": false, "training_iteration": 91, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-15-14", "timestamp": 1717258514, "time_this_iter_s": 733.7262511253357, "time_total_s": 49329.741319179535, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7ef670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49329.741319179535, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 23.552040816326528, "ram_util_percent": 81.78265306122448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1783134043280183, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006326566482482515, "vf_loss": 6.707403796117781, "vf_explained_var": 0.0002880382652099902, "kl": Infinity, "entropy": 0.2538673290270713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 859185.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "env_runners": {"episode_reward_max": 3040.0, "episode_reward_min": 130.0, "episode_reward_mean": 1071.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1340.0}, "policy_reward_mean": {"policy_0": 107.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [980.0, 425.0, 390.0, 760.0, 1080.0, 1560.0, 1420.0, 970.0, 130.0, 1470.0, 760.0, 805.0, 1240.0, 1040.0, 630.0, 1640.0, 1450.0, 280.0, 1570.0, 830.0, 1665.0, 1110.0, 1270.0, 3040.0, 380.0, 1540.0, 1030.0, 960.0, 1430.0, 800.0, 1060.0, 860.0, 240.0, 720.0, 740.0, 750.0, 740.0, 795.0, 1280.0, 480.0, 1100.0, 1220.0, 760.0, 580.0, 170.0, 1440.0, 1485.0, 1340.0, 1880.0, 990.0, 640.0, 1435.0, 1410.0, 1050.0, 970.0, 1260.0, 380.0, 770.0, 1430.0, 800.0, 1270.0, 830.0, 1160.0, 1500.0, 1555.0, 1840.0, 970.0, 1020.0, 880.0, 1600.0, 920.0, 1750.0, 840.0, 1200.0, 1400.0, 1085.0, 1200.0, 835.0, 1595.0, 1000.0, 900.0, 1145.0, 840.0, 1670.0, 1660.0, 725.0, 1330.0, 1260.0, 560.0, 1235.0, 880.0, 140.0, 1080.0, 900.0, 870.0, 1160.0, 1315.0, 1410.0, 680.0, 1465.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 20.0, 30.0, 600.0, 10.0, 40.0, 40.0, 20.0, -40.0, 160.0, 10.0, 160.0, 20.0, 0.0, -5.0, 0.0, 10.0, 10.0, 220.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 310.0, 50.0, 30.0, 40.0, 40.0, 360.0, 0.0, 120.0, 40.0, 10.0, 70.0, 50.0, 40.0, 190.0, 340.0, 30.0, 200.0, 80.0, 150.0, 0.0, 0.0, 480.0, 110.0, 0.0, -50.0, 100.0, 480.0, 80.0, 350.0, 20.0, -10.0, 100.0, 60.0, 210.0, -10.0, 270.0, 90.0, 70.0, 20.0, 450.0, 160.0, 0.0, 300.0, 0.0, 100.0, 40.0, 150.0, 30.0, 230.0, 60.0, 60.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 40.0, 0.0, 30.0, -40.0, 670.0, 260.0, 120.0, 30.0, 70.0, 40.0, 280.0, 10.0, 520.0, -30.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 10.0, 10.0, 70.0, -20.0, 10.0, 30.0, -25.0, 620.0, 20.0, 20.0, 80.0, 30.0, 530.0, 0.0, 30.0, 120.0, 220.0, 190.0, 20.0, 180.0, 80.0, 70.0, 60.0, 10.0, 90.0, 10.0, 360.0, 160.0, 10.0, -20.0, 30.0, 0.0, 80.0, -40.0, 380.0, 170.0, 0.0, 20.0, 150.0, -10.0, 300.0, 280.0, 100.0, 200.0, 320.0, 240.0, 40.0, 20.0, 90.0, 70.0, 220.0, -40.0, 70.0, 200.0, 40.0, 200.0, 70.0, 530.0, 150.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 40.0, 20.0, 0.0, 40.0, 30.0, 270.0, 20.0, 300.0, 180.0, 330.0, 190.0, 60.0, 150.0, 0.0, 30.0, 200.0, 70.0, 50.0, 60.0, 10.0, 160.0, 210.0, 40.0, 240.0, 270.0, 220.0, 140.0, 270.0, 120.0, 130.0, 100.0, 75.0, 100.0, 240.0, 180.0, 110.0, 40.0, 80.0, 190.0, 40.0, 80.0, 40.0, 110.0, 180.0, 30.0, 50.0, 230.0, 150.0, 510.0, 30.0, 20.0, -40.0, 110.0, 230.0, 1340.0, 0.0, 710.0, 160.0, 70.0, 70.0, 330.0, 80.0, 50.0, 50.0, 60.0, 100.0, 0.0, 0.0, 20.0, 0.0, 120.0, 30.0, 0.0, 80.0, 110.0, 270.0, 170.0, 170.0, 440.0, 90.0, 170.0, 50.0, -10.0, 300.0, 10.0, 110.0, 200.0, 50.0, 220.0, 180.0, 80.0, -200.0, 80.0, 40.0, 30.0, 30.0, 190.0, 80.0, 20.0, 30.0, 30.0, 220.0, 290.0, -60.0, 180.0, 0.0, -230.0, 500.0, 480.0, 150.0, 200.0, 20.0, 190.0, 0.0, 20.0, 200.0, 40.0, 80.0, 40.0, 40.0, 190.0, 90.0, 100.0, -110.0, 10.0, 120.0, 700.0, 50.0, 10.0, 10.0, 190.0, 10.0, 70.0, 290.0, 40.0, 0.0, 0.0, 30.0, 30.0, 120.0, 190.0, 70.0, 90.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 20.0, 60.0, 90.0, 10.0, 230.0, 30.0, 100.0, 160.0, 360.0, 0.0, 30.0, 20.0, 200.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 70.0, 490.0, 0.0, 210.0, 10.0, 80.0, 0.0, 190.0, 30.0, 80.0, 20.0, 30.0, 90.0, 20.0, 0.0, -5.0, 310.0, 280.0, 20.0, 100.0, 50.0, 20.0, 0.0, 30.0, 10.0, 150.0, 40.0, 110.0, 70.0, 260.0, 520.0, 70.0, 20.0, 10.0, -30.0, 30.0, 80.0, 20.0, 0.0, 100.0, 90.0, 50.0, 130.0, 180.0, 250.0, 60.0, 20.0, 130.0, 30.0, 120.0, 180.0, 100.0, 30.0, 0.0, 170.0, 150.0, 220.0, 370.0, 70.0, 90.0, 80.0, 50.0, 20.0, 0.0, 40.0, 110.0, 80.0, 30.0, 30.0, 60.0, 0.0, 20.0, 390.0, 10.0, 240.0, 30.0, 20.0, 40.0, 140.0, 0.0, 10.0, 0.0, 90.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 80.0, 10.0, 10.0, 170.0, 150.0, -20.0, 60.0, 50.0, 260.0, 160.0, 410.0, 30.0, 170.0, -40.0, 260.0, 180.0, 310.0, 75.0, 30.0, 40.0, 50.0, 170.0, 410.0, 10.0, 20.0, 670.0, 40.0, 50.0, 80.0, 150.0, 100.0, 0.0, 220.0, 300.0, 130.0, 110.0, 60.0, 60.0, 210.0, 540.0, 80.0, 30.0, 360.0, 210.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 560.0, 10.0, 60.0, 40.0, 20.0, 30.0, 110.0, 160.0, 10.0, 20.0, 170.0, 70.0, 10.0, 50.0, 145.0, 30.0, 370.0, 160.0, 90.0, 100.0, 30.0, 40.0, 420.0, 10.0, 330.0, 180.0, 180.0, 80.0, 90.0, 160.0, 330.0, 80.0, -30.0, 10.0, 0.0, 150.0, 490.0, 20.0, 390.0, -50.0, 50.0, -40.0, 30.0, 290.0, 30.0, 10.0, 10.0, 0.0, 100.0, 0.0, 40.0, 190.0, 300.0, 100.0, 230.0, 20.0, 150.0, 160.0, 170.0, 80.0, 20.0, 290.0, 40.0, 0.0, 80.0, 10.0, 30.0, 0.0, 10.0, 0.0, 150.0, 80.0, 20.0, 260.0, 220.0, 30.0, 30.0, 30.0, 0.0, 30.0, 140.0, 30.0, 0.0, 150.0, 80.0, 40.0, 560.0, 60.0, 270.0, 20.0, 30.0, 220.0, 0.0, 70.0, 20.0, 20.0, 10.0, 20.0, 60.0, 330.0, 160.0, 10.0, 100.0, 70.0, 340.0, 10.0, 360.0, 0.0, 40.0, 0.0, 30.0, 90.0, 330.0, 80.0, 370.0, 40.0, 190.0, 0.0, -40.0, 20.0, -40.0, 130.0, 80.0, 120.0, 60.0, 0.0, 260.0, 170.0, 30.0, 120.0, 160.0, 40.0, 200.0, 100.0, 70.0, 40.0, 260.0, 540.0, 60.0, 0.0, 370.0, 40.0, 20.0, 35.0, 90.0, 60.0, 240.0, 60.0, 520.0, 410.0, 80.0, 60.0, 0.0, 60.0, 110.0, 420.0, 80.0, 80.0, 320.0, 210.0, 280.0, 220.0, 60.0, 40.0, 30.0, 10.0, 310.0, 60.0, 10.0, -20.0, 210.0, 10.0, 310.0, 10.0, 10.0, 310.0, 10.0, 40.0, 30.0, 180.0, 400.0, 10.0, 20.0, 10.0, 0.0, 380.0, 0.0, 10.0, -10.0, 60.0, 10.0, 300.0, 120.0, 340.0, 130.0, 210.0, 30.0, 310.0, -110.0, 380.0, 10.0, 80.0, 220.0, 60.0, 50.0, 280.0, 10.0, 40.0, 70.0, 100.0, 80.0, -20.0, 250.0, 100.0, 40.0, 0.0, 30.0, 440.0, 40.0, 10.0, 230.0, 680.0, 180.0, 180.0, 40.0, 100.0, 30.0, 30.0, 50.0, 20.0, 30.0, 260.0, 100.0, 60.0, 490.0, 90.0, -10.0, 50.0, 50.0, 30.0, 440.0, 10.0, -10.0, 10.0, 40.0, 80.0, 50.0, 200.0, 410.0, 200.0, 20.0, 370.0, 20.0, 270.0, 10.0, 120.0, 20.0, 370.0, 45.0, 130.0, 0.0, 40.0, 80.0, 190.0, 320.0, 60.0, 160.0, -10.0, 140.0, 0.0, 170.0, 70.0, 100.0, 120.0, 80.0, 50.0, 20.0, 40.0, -35.0, 40.0, 170.0, 210.0, 140.0, 150.0, 30.0, -15.0, 200.0, 40.0, 490.0, 50.0, 630.0, 0.0, 20.0, 70.0, 180.0, 60.0, 10.0, -10.0, 20.0, 20.0, 190.0, 300.0, 160.0, 30.0, 30.0, 20.0, 290.0, 110.0, 50.0, 10.0, 50.0, 260.0, 50.0, 10.0, 10.0, 60.0, 30.0, 50.0, 50.0, -35.0, 130.0, 570.0, 270.0, 0.0, 40.0, 200.0, 90.0, 270.0, 10.0, 20.0, 160.0, 30.0, 20.0, 170.0, 0.0, 520.0, 80.0, 40.0, 140.0, 40.0, 380.0, -10.0, 310.0, 100.0, -10.0, 40.0, 220.0, 270.0, 480.0, 40.0, 50.0, 280.0, 190.0, 500.0, -10.0, 0.0, 40.0, 55.0, 10.0, 20.0, 80.0, 0.0, 30.0, 40.0, 70.0, 110.0, -10.0, 40.0, 110.0, 490.0, 120.0, 300.0, 60.0, 400.0, 180.0, 300.0, 0.0, 30.0, 10.0, 60.0, 150.0, 30.0, 100.0, 20.0, 0.0, 270.0, 30.0, 20.0, 30.0, 30.0, 60.0, 10.0, 90.0, 70.0, 30.0, 220.0, 70.0, 110.0, 295.0, 70.0, 40.0, 180.0, 150.0, 380.0, 90.0, -10.0, 80.0, 60.0, 30.0, 20.0, 10.0, 130.0, 90.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 70.0, 40.0, 10.0, 70.0, 40.0, 40.0, 40.0, 460.0, 20.0, 290.0, 70.0, 30.0, 30.0, 10.0, 40.0, 90.0, 210.0, 240.0, -10.0, 190.0, 120.0, 90.0, 0.0, 30.0, 130.0, 10.0, 10.0, 40.0, 360.0, 80.0, 180.0, 20.0, 10.0, 100.0, 20.0, 60.0, 90.0, 510.0, 60.0, 110.0, 300.0, 360.0, 155.0, 10.0, 300.0, 0.0, 10.0, 70.0, 90.0, 20.0, 120.0, 10.0, 200.0, 80.0, 50.0, 410.0, 20.0, 500.0, 10.0, 10.0, 30.0, 300.0, 60.0, 0.0, 0.0, 20.0, 0.0, 260.0, 0.0, 10.0, 0.0, 60.0, 220.0, 240.0, 120.0, 430.0, 185.0, 0.0, 120.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.052205393398047, "mean_inference_ms": 2.081439872507323, "mean_action_processing_ms": 0.5519787499851626, "mean_env_wait_ms": 1.7736639060253692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011934518814086914, "StateBufferConnector_ms": 0.010765790939331055, "ViewRequirementAgentConnector_ms": 0.38744592666625977}, "num_episodes": 18, "episode_return_max": 3040.0, "episode_return_min": 130.0, "episode_return_mean": 1071.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 9.9073049008772, "num_env_steps_trained_throughput_per_sec": 9.9073049008772, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 3680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3680000, "timers": {"training_iteration_time_ms": 369865.026, "restore_workers_time_ms": 0.011, "training_step_time_ms": 369864.98, "sample_time_ms": 2609.74, "learn_time_ms": 367227.396, "learn_throughput": 10.892, "synch_weights_time_ms": 12.864}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "done": false, "training_iteration": 92, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-21-58", "timestamp": 1717258918, "time_this_iter_s": 403.8114318847656, "time_total_s": 49733.5527510643, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x322781160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49733.5527510643, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 28.741747572815537, "ram_util_percent": 82.05987055016182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.267697396096838, "cur_kl_coeff": 0.3796875000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.98658612122297, "policy_loss": -0.006269986559592259, "vf_loss": 6.991249411707869, "vf_explained_var": 0.0011399463342782407, "kl": 0.004231609383195162, "entropy": 0.2431966365827793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 868575.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "env_runners": {"episode_reward_max": 3040.0, "episode_reward_min": 140.0, "episode_reward_mean": 1085.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1340.0}, "policy_reward_mean": {"policy_0": 108.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1570.0, 830.0, 1665.0, 1110.0, 1270.0, 3040.0, 380.0, 1540.0, 1030.0, 960.0, 1430.0, 800.0, 1060.0, 860.0, 240.0, 720.0, 740.0, 750.0, 740.0, 795.0, 1280.0, 480.0, 1100.0, 1220.0, 760.0, 580.0, 170.0, 1440.0, 1485.0, 1340.0, 1880.0, 990.0, 640.0, 1435.0, 1410.0, 1050.0, 970.0, 1260.0, 380.0, 770.0, 1430.0, 800.0, 1270.0, 830.0, 1160.0, 1500.0, 1555.0, 1840.0, 970.0, 1020.0, 880.0, 1600.0, 920.0, 1750.0, 840.0, 1200.0, 1400.0, 1085.0, 1200.0, 835.0, 1595.0, 1000.0, 900.0, 1145.0, 840.0, 1670.0, 1660.0, 725.0, 1330.0, 1260.0, 560.0, 1235.0, 880.0, 140.0, 1080.0, 900.0, 870.0, 1160.0, 1315.0, 1410.0, 680.0, 1465.0, 540.0, 1290.0, 1500.0, 290.0, 570.0, 1240.0, 575.0, 1460.0, 860.0, 1230.0, 920.0, 1170.0, 1500.0, 1590.0, 1080.0, 960.0, 300.0, 1400.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 30.0, 270.0, 20.0, 300.0, 180.0, 330.0, 190.0, 60.0, 150.0, 0.0, 30.0, 200.0, 70.0, 50.0, 60.0, 10.0, 160.0, 210.0, 40.0, 240.0, 270.0, 220.0, 140.0, 270.0, 120.0, 130.0, 100.0, 75.0, 100.0, 240.0, 180.0, 110.0, 40.0, 80.0, 190.0, 40.0, 80.0, 40.0, 110.0, 180.0, 30.0, 50.0, 230.0, 150.0, 510.0, 30.0, 20.0, -40.0, 110.0, 230.0, 1340.0, 0.0, 710.0, 160.0, 70.0, 70.0, 330.0, 80.0, 50.0, 50.0, 60.0, 100.0, 0.0, 0.0, 20.0, 0.0, 120.0, 30.0, 0.0, 80.0, 110.0, 270.0, 170.0, 170.0, 440.0, 90.0, 170.0, 50.0, -10.0, 300.0, 10.0, 110.0, 200.0, 50.0, 220.0, 180.0, 80.0, -200.0, 80.0, 40.0, 30.0, 30.0, 190.0, 80.0, 20.0, 30.0, 30.0, 220.0, 290.0, -60.0, 180.0, 0.0, -230.0, 500.0, 480.0, 150.0, 200.0, 20.0, 190.0, 0.0, 20.0, 200.0, 40.0, 80.0, 40.0, 40.0, 190.0, 90.0, 100.0, -110.0, 10.0, 120.0, 700.0, 50.0, 10.0, 10.0, 190.0, 10.0, 70.0, 290.0, 40.0, 0.0, 0.0, 30.0, 30.0, 120.0, 190.0, 70.0, 90.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 20.0, 60.0, 90.0, 10.0, 230.0, 30.0, 100.0, 160.0, 360.0, 0.0, 30.0, 20.0, 200.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 70.0, 490.0, 0.0, 210.0, 10.0, 80.0, 0.0, 190.0, 30.0, 80.0, 20.0, 30.0, 90.0, 20.0, 0.0, -5.0, 310.0, 280.0, 20.0, 100.0, 50.0, 20.0, 0.0, 30.0, 10.0, 150.0, 40.0, 110.0, 70.0, 260.0, 520.0, 70.0, 20.0, 10.0, -30.0, 30.0, 80.0, 20.0, 0.0, 100.0, 90.0, 50.0, 130.0, 180.0, 250.0, 60.0, 20.0, 130.0, 30.0, 120.0, 180.0, 100.0, 30.0, 0.0, 170.0, 150.0, 220.0, 370.0, 70.0, 90.0, 80.0, 50.0, 20.0, 0.0, 40.0, 110.0, 80.0, 30.0, 30.0, 60.0, 0.0, 20.0, 390.0, 10.0, 240.0, 30.0, 20.0, 40.0, 140.0, 0.0, 10.0, 0.0, 90.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 80.0, 10.0, 10.0, 170.0, 150.0, -20.0, 60.0, 50.0, 260.0, 160.0, 410.0, 30.0, 170.0, -40.0, 260.0, 180.0, 310.0, 75.0, 30.0, 40.0, 50.0, 170.0, 410.0, 10.0, 20.0, 670.0, 40.0, 50.0, 80.0, 150.0, 100.0, 0.0, 220.0, 300.0, 130.0, 110.0, 60.0, 60.0, 210.0, 540.0, 80.0, 30.0, 360.0, 210.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 560.0, 10.0, 60.0, 40.0, 20.0, 30.0, 110.0, 160.0, 10.0, 20.0, 170.0, 70.0, 10.0, 50.0, 145.0, 30.0, 370.0, 160.0, 90.0, 100.0, 30.0, 40.0, 420.0, 10.0, 330.0, 180.0, 180.0, 80.0, 90.0, 160.0, 330.0, 80.0, -30.0, 10.0, 0.0, 150.0, 490.0, 20.0, 390.0, -50.0, 50.0, -40.0, 30.0, 290.0, 30.0, 10.0, 10.0, 0.0, 100.0, 0.0, 40.0, 190.0, 300.0, 100.0, 230.0, 20.0, 150.0, 160.0, 170.0, 80.0, 20.0, 290.0, 40.0, 0.0, 80.0, 10.0, 30.0, 0.0, 10.0, 0.0, 150.0, 80.0, 20.0, 260.0, 220.0, 30.0, 30.0, 30.0, 0.0, 30.0, 140.0, 30.0, 0.0, 150.0, 80.0, 40.0, 560.0, 60.0, 270.0, 20.0, 30.0, 220.0, 0.0, 70.0, 20.0, 20.0, 10.0, 20.0, 60.0, 330.0, 160.0, 10.0, 100.0, 70.0, 340.0, 10.0, 360.0, 0.0, 40.0, 0.0, 30.0, 90.0, 330.0, 80.0, 370.0, 40.0, 190.0, 0.0, -40.0, 20.0, -40.0, 130.0, 80.0, 120.0, 60.0, 0.0, 260.0, 170.0, 30.0, 120.0, 160.0, 40.0, 200.0, 100.0, 70.0, 40.0, 260.0, 540.0, 60.0, 0.0, 370.0, 40.0, 20.0, 35.0, 90.0, 60.0, 240.0, 60.0, 520.0, 410.0, 80.0, 60.0, 0.0, 60.0, 110.0, 420.0, 80.0, 80.0, 320.0, 210.0, 280.0, 220.0, 60.0, 40.0, 30.0, 10.0, 310.0, 60.0, 10.0, -20.0, 210.0, 10.0, 310.0, 10.0, 10.0, 310.0, 10.0, 40.0, 30.0, 180.0, 400.0, 10.0, 20.0, 10.0, 0.0, 380.0, 0.0, 10.0, -10.0, 60.0, 10.0, 300.0, 120.0, 340.0, 130.0, 210.0, 30.0, 310.0, -110.0, 380.0, 10.0, 80.0, 220.0, 60.0, 50.0, 280.0, 10.0, 40.0, 70.0, 100.0, 80.0, -20.0, 250.0, 100.0, 40.0, 0.0, 30.0, 440.0, 40.0, 10.0, 230.0, 680.0, 180.0, 180.0, 40.0, 100.0, 30.0, 30.0, 50.0, 20.0, 30.0, 260.0, 100.0, 60.0, 490.0, 90.0, -10.0, 50.0, 50.0, 30.0, 440.0, 10.0, -10.0, 10.0, 40.0, 80.0, 50.0, 200.0, 410.0, 200.0, 20.0, 370.0, 20.0, 270.0, 10.0, 120.0, 20.0, 370.0, 45.0, 130.0, 0.0, 40.0, 80.0, 190.0, 320.0, 60.0, 160.0, -10.0, 140.0, 0.0, 170.0, 70.0, 100.0, 120.0, 80.0, 50.0, 20.0, 40.0, -35.0, 40.0, 170.0, 210.0, 140.0, 150.0, 30.0, -15.0, 200.0, 40.0, 490.0, 50.0, 630.0, 0.0, 20.0, 70.0, 180.0, 60.0, 10.0, -10.0, 20.0, 20.0, 190.0, 300.0, 160.0, 30.0, 30.0, 20.0, 290.0, 110.0, 50.0, 10.0, 50.0, 260.0, 50.0, 10.0, 10.0, 60.0, 30.0, 50.0, 50.0, -35.0, 130.0, 570.0, 270.0, 0.0, 40.0, 200.0, 90.0, 270.0, 10.0, 20.0, 160.0, 30.0, 20.0, 170.0, 0.0, 520.0, 80.0, 40.0, 140.0, 40.0, 380.0, -10.0, 310.0, 100.0, -10.0, 40.0, 220.0, 270.0, 480.0, 40.0, 50.0, 280.0, 190.0, 500.0, -10.0, 0.0, 40.0, 55.0, 10.0, 20.0, 80.0, 0.0, 30.0, 40.0, 70.0, 110.0, -10.0, 40.0, 110.0, 490.0, 120.0, 300.0, 60.0, 400.0, 180.0, 300.0, 0.0, 30.0, 10.0, 60.0, 150.0, 30.0, 100.0, 20.0, 0.0, 270.0, 30.0, 20.0, 30.0, 30.0, 60.0, 10.0, 90.0, 70.0, 30.0, 220.0, 70.0, 110.0, 295.0, 70.0, 40.0, 180.0, 150.0, 380.0, 90.0, -10.0, 80.0, 60.0, 30.0, 20.0, 10.0, 130.0, 90.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 70.0, 40.0, 10.0, 70.0, 40.0, 40.0, 40.0, 460.0, 20.0, 290.0, 70.0, 30.0, 30.0, 10.0, 40.0, 90.0, 210.0, 240.0, -10.0, 190.0, 120.0, 90.0, 0.0, 30.0, 130.0, 10.0, 10.0, 40.0, 360.0, 80.0, 180.0, 20.0, 10.0, 100.0, 20.0, 60.0, 90.0, 510.0, 60.0, 110.0, 300.0, 360.0, 155.0, 10.0, 300.0, 0.0, 10.0, 70.0, 90.0, 20.0, 120.0, 10.0, 200.0, 80.0, 50.0, 410.0, 20.0, 500.0, 10.0, 10.0, 30.0, 300.0, 60.0, 0.0, 0.0, 20.0, 0.0, 260.0, 0.0, 10.0, 0.0, 60.0, 220.0, 240.0, 120.0, 430.0, 185.0, 0.0, 120.0, 90.0, 20.0, 0.0, 0.0, 30.0, 30.0, 40.0, 0.0, 330.0, 20.0, 70.0, 90.0, 130.0, -10.0, 170.0, 90.0, 480.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 170.0, 90.0, 80.0, 240.0, 530.0, 30.0, 190.0, -20.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 30.0, 80.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 310.0, 70.0, 90.0, 10.0, 20.0, 10.0, 160.0, 60.0, 110.0, 270.0, 120.0, 60.0, 80.0, 40.0, 330.0, 10.0, 40.0, 20.0, 10.0, 510.0, -30.0, -155.0, 60.0, 30.0, 60.0, 30.0, 380.0, 180.0, 50.0, 220.0, 80.0, 280.0, 60.0, 60.0, 60.0, 90.0, 0.0, 30.0, 90.0, 50.0, 20.0, 300.0, 0.0, 300.0, 30.0, 40.0, 200.0, 70.0, 10.0, 40.0, 200.0, 70.0, -40.0, 110.0, 600.0, -30.0, 330.0, 30.0, 90.0, 50.0, 130.0, 50.0, 30.0, 50.0, 50.0, 110.0, 110.0, 30.0, 40.0, 80.0, 200.0, 10.0, 200.0, 170.0, 290.0, 40.0, 60.0, 30.0, 600.0, 120.0, 100.0, 200.0, 100.0, 150.0, 60.0, 80.0, 110.0, -30.0, 200.0, 15.0, 50.0, 5.0, 310.0, 190.0, 120.0, 620.0, 20.0, 410.0, 140.0, 20.0, 120.0, 40.0, 290.0, 40.0, -40.0, 40.0, 30.0, 110.0, 100.0, 370.0, 10.0, 320.0, 10.0, 0.0, -20.0, 30.0, 40.0, 30.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 90.0, 400.0, 40.0, 10.0, 40.0, 170.0, 170.0, 110.0, 270.0, 90.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.047247599059587, "mean_inference_ms": 2.0771998676389676, "mean_action_processing_ms": 0.5506627287852693, "mean_env_wait_ms": 1.7694520870414585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012390851974487305, "StateBufferConnector_ms": 0.010458707809448242, "ViewRequirementAgentConnector_ms": 0.40100812911987305}, "num_episodes": 18, "episode_return_max": 3040.0, "episode_return_min": 140.0, "episode_return_mean": 1085.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.35595009930252, "num_env_steps_trained_throughput_per_sec": 19.35595009930252, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 3720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3720000, "timers": {"training_iteration_time_ms": 370198.714, "restore_workers_time_ms": 0.012, "training_step_time_ms": 370198.668, "sample_time_ms": 2694.61, "learn_time_ms": 367475.976, "learn_throughput": 10.885, "synch_weights_time_ms": 13.084}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "done": false, "training_iteration": 93, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-25-24", "timestamp": 1717259124, "time_this_iter_s": 206.68645095825195, "time_total_s": 49940.23920202255, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7fe790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49940.23920202255, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 27.453242320819115, "ram_util_percent": 82.8184300341297}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2287030545667337, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006773746585328612, "vf_loss": 6.658836842548098, "vf_explained_var": 0.0001385788186289632, "kl": Infinity, "entropy": 0.2651469265087979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 877965.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "env_runners": {"episode_reward_max": 1880.0, "episode_reward_min": 140.0, "episode_reward_mean": 1093.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -155.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 109.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1100.0, 1220.0, 760.0, 580.0, 170.0, 1440.0, 1485.0, 1340.0, 1880.0, 990.0, 640.0, 1435.0, 1410.0, 1050.0, 970.0, 1260.0, 380.0, 770.0, 1430.0, 800.0, 1270.0, 830.0, 1160.0, 1500.0, 1555.0, 1840.0, 970.0, 1020.0, 880.0, 1600.0, 920.0, 1750.0, 840.0, 1200.0, 1400.0, 1085.0, 1200.0, 835.0, 1595.0, 1000.0, 900.0, 1145.0, 840.0, 1670.0, 1660.0, 725.0, 1330.0, 1260.0, 560.0, 1235.0, 880.0, 140.0, 1080.0, 900.0, 870.0, 1160.0, 1315.0, 1410.0, 680.0, 1465.0, 540.0, 1290.0, 1500.0, 290.0, 570.0, 1240.0, 575.0, 1460.0, 860.0, 1230.0, 920.0, 1170.0, 1500.0, 1590.0, 1080.0, 960.0, 300.0, 1400.0, 520.0, 850.0, 1600.0, 370.0, 1820.0, 550.0, 1250.0, 860.0, 440.0, 1030.0, 990.0, 1570.0, 1710.0, 1640.0, 1200.0, 1010.0, 990.0, 1380.0, 900.0, 1280.0, 1280.0, 865.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 250.0, 60.0, 20.0, 130.0, 30.0, 120.0, 180.0, 100.0, 30.0, 0.0, 170.0, 150.0, 220.0, 370.0, 70.0, 90.0, 80.0, 50.0, 20.0, 0.0, 40.0, 110.0, 80.0, 30.0, 30.0, 60.0, 0.0, 20.0, 390.0, 10.0, 240.0, 30.0, 20.0, 40.0, 140.0, 0.0, 10.0, 0.0, 90.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 80.0, 10.0, 10.0, 170.0, 150.0, -20.0, 60.0, 50.0, 260.0, 160.0, 410.0, 30.0, 170.0, -40.0, 260.0, 180.0, 310.0, 75.0, 30.0, 40.0, 50.0, 170.0, 410.0, 10.0, 20.0, 670.0, 40.0, 50.0, 80.0, 150.0, 100.0, 0.0, 220.0, 300.0, 130.0, 110.0, 60.0, 60.0, 210.0, 540.0, 80.0, 30.0, 360.0, 210.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 560.0, 10.0, 60.0, 40.0, 20.0, 30.0, 110.0, 160.0, 10.0, 20.0, 170.0, 70.0, 10.0, 50.0, 145.0, 30.0, 370.0, 160.0, 90.0, 100.0, 30.0, 40.0, 420.0, 10.0, 330.0, 180.0, 180.0, 80.0, 90.0, 160.0, 330.0, 80.0, -30.0, 10.0, 0.0, 150.0, 490.0, 20.0, 390.0, -50.0, 50.0, -40.0, 30.0, 290.0, 30.0, 10.0, 10.0, 0.0, 100.0, 0.0, 40.0, 190.0, 300.0, 100.0, 230.0, 20.0, 150.0, 160.0, 170.0, 80.0, 20.0, 290.0, 40.0, 0.0, 80.0, 10.0, 30.0, 0.0, 10.0, 0.0, 150.0, 80.0, 20.0, 260.0, 220.0, 30.0, 30.0, 30.0, 0.0, 30.0, 140.0, 30.0, 0.0, 150.0, 80.0, 40.0, 560.0, 60.0, 270.0, 20.0, 30.0, 220.0, 0.0, 70.0, 20.0, 20.0, 10.0, 20.0, 60.0, 330.0, 160.0, 10.0, 100.0, 70.0, 340.0, 10.0, 360.0, 0.0, 40.0, 0.0, 30.0, 90.0, 330.0, 80.0, 370.0, 40.0, 190.0, 0.0, -40.0, 20.0, -40.0, 130.0, 80.0, 120.0, 60.0, 0.0, 260.0, 170.0, 30.0, 120.0, 160.0, 40.0, 200.0, 100.0, 70.0, 40.0, 260.0, 540.0, 60.0, 0.0, 370.0, 40.0, 20.0, 35.0, 90.0, 60.0, 240.0, 60.0, 520.0, 410.0, 80.0, 60.0, 0.0, 60.0, 110.0, 420.0, 80.0, 80.0, 320.0, 210.0, 280.0, 220.0, 60.0, 40.0, 30.0, 10.0, 310.0, 60.0, 10.0, -20.0, 210.0, 10.0, 310.0, 10.0, 10.0, 310.0, 10.0, 40.0, 30.0, 180.0, 400.0, 10.0, 20.0, 10.0, 0.0, 380.0, 0.0, 10.0, -10.0, 60.0, 10.0, 300.0, 120.0, 340.0, 130.0, 210.0, 30.0, 310.0, -110.0, 380.0, 10.0, 80.0, 220.0, 60.0, 50.0, 280.0, 10.0, 40.0, 70.0, 100.0, 80.0, -20.0, 250.0, 100.0, 40.0, 0.0, 30.0, 440.0, 40.0, 10.0, 230.0, 680.0, 180.0, 180.0, 40.0, 100.0, 30.0, 30.0, 50.0, 20.0, 30.0, 260.0, 100.0, 60.0, 490.0, 90.0, -10.0, 50.0, 50.0, 30.0, 440.0, 10.0, -10.0, 10.0, 40.0, 80.0, 50.0, 200.0, 410.0, 200.0, 20.0, 370.0, 20.0, 270.0, 10.0, 120.0, 20.0, 370.0, 45.0, 130.0, 0.0, 40.0, 80.0, 190.0, 320.0, 60.0, 160.0, -10.0, 140.0, 0.0, 170.0, 70.0, 100.0, 120.0, 80.0, 50.0, 20.0, 40.0, -35.0, 40.0, 170.0, 210.0, 140.0, 150.0, 30.0, -15.0, 200.0, 40.0, 490.0, 50.0, 630.0, 0.0, 20.0, 70.0, 180.0, 60.0, 10.0, -10.0, 20.0, 20.0, 190.0, 300.0, 160.0, 30.0, 30.0, 20.0, 290.0, 110.0, 50.0, 10.0, 50.0, 260.0, 50.0, 10.0, 10.0, 60.0, 30.0, 50.0, 50.0, -35.0, 130.0, 570.0, 270.0, 0.0, 40.0, 200.0, 90.0, 270.0, 10.0, 20.0, 160.0, 30.0, 20.0, 170.0, 0.0, 520.0, 80.0, 40.0, 140.0, 40.0, 380.0, -10.0, 310.0, 100.0, -10.0, 40.0, 220.0, 270.0, 480.0, 40.0, 50.0, 280.0, 190.0, 500.0, -10.0, 0.0, 40.0, 55.0, 10.0, 20.0, 80.0, 0.0, 30.0, 40.0, 70.0, 110.0, -10.0, 40.0, 110.0, 490.0, 120.0, 300.0, 60.0, 400.0, 180.0, 300.0, 0.0, 30.0, 10.0, 60.0, 150.0, 30.0, 100.0, 20.0, 0.0, 270.0, 30.0, 20.0, 30.0, 30.0, 60.0, 10.0, 90.0, 70.0, 30.0, 220.0, 70.0, 110.0, 295.0, 70.0, 40.0, 180.0, 150.0, 380.0, 90.0, -10.0, 80.0, 60.0, 30.0, 20.0, 10.0, 130.0, 90.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 70.0, 40.0, 10.0, 70.0, 40.0, 40.0, 40.0, 460.0, 20.0, 290.0, 70.0, 30.0, 30.0, 10.0, 40.0, 90.0, 210.0, 240.0, -10.0, 190.0, 120.0, 90.0, 0.0, 30.0, 130.0, 10.0, 10.0, 40.0, 360.0, 80.0, 180.0, 20.0, 10.0, 100.0, 20.0, 60.0, 90.0, 510.0, 60.0, 110.0, 300.0, 360.0, 155.0, 10.0, 300.0, 0.0, 10.0, 70.0, 90.0, 20.0, 120.0, 10.0, 200.0, 80.0, 50.0, 410.0, 20.0, 500.0, 10.0, 10.0, 30.0, 300.0, 60.0, 0.0, 0.0, 20.0, 0.0, 260.0, 0.0, 10.0, 0.0, 60.0, 220.0, 240.0, 120.0, 430.0, 185.0, 0.0, 120.0, 90.0, 20.0, 0.0, 0.0, 30.0, 30.0, 40.0, 0.0, 330.0, 20.0, 70.0, 90.0, 130.0, -10.0, 170.0, 90.0, 480.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 170.0, 90.0, 80.0, 240.0, 530.0, 30.0, 190.0, -20.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 30.0, 80.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 310.0, 70.0, 90.0, 10.0, 20.0, 10.0, 160.0, 60.0, 110.0, 270.0, 120.0, 60.0, 80.0, 40.0, 330.0, 10.0, 40.0, 20.0, 10.0, 510.0, -30.0, -155.0, 60.0, 30.0, 60.0, 30.0, 380.0, 180.0, 50.0, 220.0, 80.0, 280.0, 60.0, 60.0, 60.0, 90.0, 0.0, 30.0, 90.0, 50.0, 20.0, 300.0, 0.0, 300.0, 30.0, 40.0, 200.0, 70.0, 10.0, 40.0, 200.0, 70.0, -40.0, 110.0, 600.0, -30.0, 330.0, 30.0, 90.0, 50.0, 130.0, 50.0, 30.0, 50.0, 50.0, 110.0, 110.0, 30.0, 40.0, 80.0, 200.0, 10.0, 200.0, 170.0, 290.0, 40.0, 60.0, 30.0, 600.0, 120.0, 100.0, 200.0, 100.0, 150.0, 60.0, 80.0, 110.0, -30.0, 200.0, 15.0, 50.0, 5.0, 310.0, 190.0, 120.0, 620.0, 20.0, 410.0, 140.0, 20.0, 120.0, 40.0, 290.0, 40.0, -40.0, 40.0, 30.0, 110.0, 100.0, 370.0, 10.0, 320.0, 10.0, 0.0, -20.0, 30.0, 40.0, 30.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 90.0, 400.0, 40.0, 10.0, 40.0, 170.0, 170.0, 110.0, 270.0, 90.0, 100.0, 20.0, 40.0, 0.0, 40.0, 30.0, 50.0, 280.0, 10.0, 50.0, 0.0, 50.0, 260.0, 300.0, 10.0, 10.0, 10.0, 100.0, 80.0, 10.0, 20.0, 410.0, 290.0, 20.0, 260.0, 180.0, 0.0, 60.0, 280.0, 70.0, 30.0, -140.0, 60.0, 30.0, 50.0, 0.0, 10.0, -40.0, 380.0, 30.0, -10.0, 180.0, 140.0, 10.0, 220.0, -30.0, 70.0, 330.0, 250.0, 450.0, 200.0, 0.0, 20.0, 30.0, 20.0, 310.0, 80.0, 50.0, 20.0, 10.0, 10.0, 470.0, 40.0, 90.0, 10.0, 180.0, 20.0, 70.0, 80.0, 280.0, 10.0, 10.0, 40.0, 180.0, 120.0, 20.0, 350.0, 50.0, 30.0, 10.0, 50.0, 40.0, 40.0, 160.0, 120.0, 0.0, 0.0, 0.0, 30.0, 10.0, 40.0, 150.0, 130.0, 70.0, 170.0, 40.0, 120.0, 10.0, 10.0, 0.0, 330.0, 60.0, 470.0, 160.0, 100.0, 40.0, 0.0, -50.0, -30.0, 230.0, 10.0, 160.0, 90.0, 230.0, 660.0, 170.0, 30.0, 110.0, 70.0, 40.0, 10.0, 350.0, 50.0, 70.0, 120.0, 90.0, 440.0, 430.0, 90.0, -20.0, 90.0, 210.0, 30.0, 30.0, 220.0, 70.0, 60.0, 140.0, 300.0, 260.0, 320.0, 610.0, 30.0, 0.0, 20.0, 270.0, 30.0, 70.0, 80.0, 30.0, 60.0, 160.0, 320.0, 20.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 350.0, 20.0, 180.0, 140.0, 290.0, 90.0, 40.0, 90.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 310.0, 340.0, 0.0, 370.0, 50.0, 160.0, 0.0, 10.0, 220.0, 40.0, 40.0, 80.0, 0.0, 20.0, 430.0, 20.0, 40.0, 140.0, 160.0, -20.0, 360.0, 30.0, 90.0, 80.0, 350.0, 20.0, 70.0, 40.0, 60.0, 10.0, 150.0, 30.0, 120.0, 130.0, 260.0, 460.0, 20.0, 30.0, 80.0, 0.0, 230.0, 20.0, 40.0, 260.0, 80.0, 100.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.041976161097011, "mean_inference_ms": 2.073028030364879, "mean_action_processing_ms": 0.5492574945249692, "mean_env_wait_ms": 1.7648562174638764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014492273330688477, "StateBufferConnector_ms": 0.010894060134887695, "ViewRequirementAgentConnector_ms": 0.4191865921020508}, "num_episodes": 22, "episode_return_max": 1880.0, "episode_return_min": 140.0, "episode_return_mean": 1093.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.587069701876274, "num_env_steps_trained_throughput_per_sec": 19.587069701876274, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 3760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3760000, "timers": {"training_iteration_time_ms": 370588.14, "restore_workers_time_ms": 0.012, "training_step_time_ms": 370588.095, "sample_time_ms": 2674.832, "learn_time_ms": 367886.711, "learn_throughput": 10.873, "synch_weights_time_ms": 13.047}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "done": false, "training_iteration": 94, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-28-49", "timestamp": 1717259329, "time_this_iter_s": 204.2688171863556, "time_total_s": 50144.50801920891, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x322781f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50144.50801920891, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 23.069072164948455, "ram_util_percent": 82.02920962199313}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1537801762421926, "cur_kl_coeff": 0.28476562499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.324556651892372, "policy_loss": -0.0067591795189002645, "vf_loss": 7.329898045288996, "vf_explained_var": 0.0007058527015141659, "kl": 0.0049787774819241145, "entropy": 0.2477724455225582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 887355.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 140.0, "episode_reward_mean": 1129.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -155.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 112.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1430.0, 800.0, 1270.0, 830.0, 1160.0, 1500.0, 1555.0, 1840.0, 970.0, 1020.0, 880.0, 1600.0, 920.0, 1750.0, 840.0, 1200.0, 1400.0, 1085.0, 1200.0, 835.0, 1595.0, 1000.0, 900.0, 1145.0, 840.0, 1670.0, 1660.0, 725.0, 1330.0, 1260.0, 560.0, 1235.0, 880.0, 140.0, 1080.0, 900.0, 870.0, 1160.0, 1315.0, 1410.0, 680.0, 1465.0, 540.0, 1290.0, 1500.0, 290.0, 570.0, 1240.0, 575.0, 1460.0, 860.0, 1230.0, 920.0, 1170.0, 1500.0, 1590.0, 1080.0, 960.0, 300.0, 1400.0, 520.0, 850.0, 1600.0, 370.0, 1820.0, 550.0, 1250.0, 860.0, 440.0, 1030.0, 990.0, 1570.0, 1710.0, 1640.0, 1200.0, 1010.0, 990.0, 1380.0, 900.0, 1280.0, 1280.0, 865.0, 1310.0, 1730.0, 1760.0, 1280.0, 1480.0, 1300.0, 800.0, 1800.0, 430.0, 1430.0, 1240.0, 1370.0, 705.0, 1980.0, 1190.0, 215.0, 1520.0, 930.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 80.0, 40.0, 560.0, 60.0, 270.0, 20.0, 30.0, 220.0, 0.0, 70.0, 20.0, 20.0, 10.0, 20.0, 60.0, 330.0, 160.0, 10.0, 100.0, 70.0, 340.0, 10.0, 360.0, 0.0, 40.0, 0.0, 30.0, 90.0, 330.0, 80.0, 370.0, 40.0, 190.0, 0.0, -40.0, 20.0, -40.0, 130.0, 80.0, 120.0, 60.0, 0.0, 260.0, 170.0, 30.0, 120.0, 160.0, 40.0, 200.0, 100.0, 70.0, 40.0, 260.0, 540.0, 60.0, 0.0, 370.0, 40.0, 20.0, 35.0, 90.0, 60.0, 240.0, 60.0, 520.0, 410.0, 80.0, 60.0, 0.0, 60.0, 110.0, 420.0, 80.0, 80.0, 320.0, 210.0, 280.0, 220.0, 60.0, 40.0, 30.0, 10.0, 310.0, 60.0, 10.0, -20.0, 210.0, 10.0, 310.0, 10.0, 10.0, 310.0, 10.0, 40.0, 30.0, 180.0, 400.0, 10.0, 20.0, 10.0, 0.0, 380.0, 0.0, 10.0, -10.0, 60.0, 10.0, 300.0, 120.0, 340.0, 130.0, 210.0, 30.0, 310.0, -110.0, 380.0, 10.0, 80.0, 220.0, 60.0, 50.0, 280.0, 10.0, 40.0, 70.0, 100.0, 80.0, -20.0, 250.0, 100.0, 40.0, 0.0, 30.0, 440.0, 40.0, 10.0, 230.0, 680.0, 180.0, 180.0, 40.0, 100.0, 30.0, 30.0, 50.0, 20.0, 30.0, 260.0, 100.0, 60.0, 490.0, 90.0, -10.0, 50.0, 50.0, 30.0, 440.0, 10.0, -10.0, 10.0, 40.0, 80.0, 50.0, 200.0, 410.0, 200.0, 20.0, 370.0, 20.0, 270.0, 10.0, 120.0, 20.0, 370.0, 45.0, 130.0, 0.0, 40.0, 80.0, 190.0, 320.0, 60.0, 160.0, -10.0, 140.0, 0.0, 170.0, 70.0, 100.0, 120.0, 80.0, 50.0, 20.0, 40.0, -35.0, 40.0, 170.0, 210.0, 140.0, 150.0, 30.0, -15.0, 200.0, 40.0, 490.0, 50.0, 630.0, 0.0, 20.0, 70.0, 180.0, 60.0, 10.0, -10.0, 20.0, 20.0, 190.0, 300.0, 160.0, 30.0, 30.0, 20.0, 290.0, 110.0, 50.0, 10.0, 50.0, 260.0, 50.0, 10.0, 10.0, 60.0, 30.0, 50.0, 50.0, -35.0, 130.0, 570.0, 270.0, 0.0, 40.0, 200.0, 90.0, 270.0, 10.0, 20.0, 160.0, 30.0, 20.0, 170.0, 0.0, 520.0, 80.0, 40.0, 140.0, 40.0, 380.0, -10.0, 310.0, 100.0, -10.0, 40.0, 220.0, 270.0, 480.0, 40.0, 50.0, 280.0, 190.0, 500.0, -10.0, 0.0, 40.0, 55.0, 10.0, 20.0, 80.0, 0.0, 30.0, 40.0, 70.0, 110.0, -10.0, 40.0, 110.0, 490.0, 120.0, 300.0, 60.0, 400.0, 180.0, 300.0, 0.0, 30.0, 10.0, 60.0, 150.0, 30.0, 100.0, 20.0, 0.0, 270.0, 30.0, 20.0, 30.0, 30.0, 60.0, 10.0, 90.0, 70.0, 30.0, 220.0, 70.0, 110.0, 295.0, 70.0, 40.0, 180.0, 150.0, 380.0, 90.0, -10.0, 80.0, 60.0, 30.0, 20.0, 10.0, 130.0, 90.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 70.0, 40.0, 10.0, 70.0, 40.0, 40.0, 40.0, 460.0, 20.0, 290.0, 70.0, 30.0, 30.0, 10.0, 40.0, 90.0, 210.0, 240.0, -10.0, 190.0, 120.0, 90.0, 0.0, 30.0, 130.0, 10.0, 10.0, 40.0, 360.0, 80.0, 180.0, 20.0, 10.0, 100.0, 20.0, 60.0, 90.0, 510.0, 60.0, 110.0, 300.0, 360.0, 155.0, 10.0, 300.0, 0.0, 10.0, 70.0, 90.0, 20.0, 120.0, 10.0, 200.0, 80.0, 50.0, 410.0, 20.0, 500.0, 10.0, 10.0, 30.0, 300.0, 60.0, 0.0, 0.0, 20.0, 0.0, 260.0, 0.0, 10.0, 0.0, 60.0, 220.0, 240.0, 120.0, 430.0, 185.0, 0.0, 120.0, 90.0, 20.0, 0.0, 0.0, 30.0, 30.0, 40.0, 0.0, 330.0, 20.0, 70.0, 90.0, 130.0, -10.0, 170.0, 90.0, 480.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 170.0, 90.0, 80.0, 240.0, 530.0, 30.0, 190.0, -20.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 30.0, 80.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 310.0, 70.0, 90.0, 10.0, 20.0, 10.0, 160.0, 60.0, 110.0, 270.0, 120.0, 60.0, 80.0, 40.0, 330.0, 10.0, 40.0, 20.0, 10.0, 510.0, -30.0, -155.0, 60.0, 30.0, 60.0, 30.0, 380.0, 180.0, 50.0, 220.0, 80.0, 280.0, 60.0, 60.0, 60.0, 90.0, 0.0, 30.0, 90.0, 50.0, 20.0, 300.0, 0.0, 300.0, 30.0, 40.0, 200.0, 70.0, 10.0, 40.0, 200.0, 70.0, -40.0, 110.0, 600.0, -30.0, 330.0, 30.0, 90.0, 50.0, 130.0, 50.0, 30.0, 50.0, 50.0, 110.0, 110.0, 30.0, 40.0, 80.0, 200.0, 10.0, 200.0, 170.0, 290.0, 40.0, 60.0, 30.0, 600.0, 120.0, 100.0, 200.0, 100.0, 150.0, 60.0, 80.0, 110.0, -30.0, 200.0, 15.0, 50.0, 5.0, 310.0, 190.0, 120.0, 620.0, 20.0, 410.0, 140.0, 20.0, 120.0, 40.0, 290.0, 40.0, -40.0, 40.0, 30.0, 110.0, 100.0, 370.0, 10.0, 320.0, 10.0, 0.0, -20.0, 30.0, 40.0, 30.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 90.0, 400.0, 40.0, 10.0, 40.0, 170.0, 170.0, 110.0, 270.0, 90.0, 100.0, 20.0, 40.0, 0.0, 40.0, 30.0, 50.0, 280.0, 10.0, 50.0, 0.0, 50.0, 260.0, 300.0, 10.0, 10.0, 10.0, 100.0, 80.0, 10.0, 20.0, 410.0, 290.0, 20.0, 260.0, 180.0, 0.0, 60.0, 280.0, 70.0, 30.0, -140.0, 60.0, 30.0, 50.0, 0.0, 10.0, -40.0, 380.0, 30.0, -10.0, 180.0, 140.0, 10.0, 220.0, -30.0, 70.0, 330.0, 250.0, 450.0, 200.0, 0.0, 20.0, 30.0, 20.0, 310.0, 80.0, 50.0, 20.0, 10.0, 10.0, 470.0, 40.0, 90.0, 10.0, 180.0, 20.0, 70.0, 80.0, 280.0, 10.0, 10.0, 40.0, 180.0, 120.0, 20.0, 350.0, 50.0, 30.0, 10.0, 50.0, 40.0, 40.0, 160.0, 120.0, 0.0, 0.0, 0.0, 30.0, 10.0, 40.0, 150.0, 130.0, 70.0, 170.0, 40.0, 120.0, 10.0, 10.0, 0.0, 330.0, 60.0, 470.0, 160.0, 100.0, 40.0, 0.0, -50.0, -30.0, 230.0, 10.0, 160.0, 90.0, 230.0, 660.0, 170.0, 30.0, 110.0, 70.0, 40.0, 10.0, 350.0, 50.0, 70.0, 120.0, 90.0, 440.0, 430.0, 90.0, -20.0, 90.0, 210.0, 30.0, 30.0, 220.0, 70.0, 60.0, 140.0, 300.0, 260.0, 320.0, 610.0, 30.0, 0.0, 20.0, 270.0, 30.0, 70.0, 80.0, 30.0, 60.0, 160.0, 320.0, 20.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 350.0, 20.0, 180.0, 140.0, 290.0, 90.0, 40.0, 90.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 310.0, 340.0, 0.0, 370.0, 50.0, 160.0, 0.0, 10.0, 220.0, 40.0, 40.0, 80.0, 0.0, 20.0, 430.0, 20.0, 40.0, 140.0, 160.0, -20.0, 360.0, 30.0, 90.0, 80.0, 350.0, 20.0, 70.0, 40.0, 60.0, 10.0, 150.0, 30.0, 120.0, 130.0, 260.0, 460.0, 20.0, 30.0, 80.0, 0.0, 230.0, 20.0, 40.0, 260.0, 80.0, 100.0, 25.0, 490.0, 20.0, 440.0, 30.0, 120.0, 30.0, 20.0, 30.0, 40.0, 90.0, 370.0, 20.0, 170.0, 20.0, 70.0, 120.0, 80.0, 460.0, 110.0, 310.0, 260.0, 300.0, 470.0, 220.0, 30.0, 40.0, 50.0, 300.0, 50.0, 40.0, 60.0, 80.0, 200.0, 280.0, -10.0, 110.0, 40.0, 170.0, 30.0, 320.0, 60.0, 20.0, 130.0, 30.0, 500.0, 70.0, 120.0, 220.0, 30.0, 300.0, 20.0, 460.0, 200.0, 50.0, 40.0, 0.0, 280.0, 190.0, 100.0, -40.0, 20.0, 0.0, 190.0, 220.0, 320.0, 10.0, 0.0, 0.0, 20.0, 20.0, 140.0, 90.0, 180.0, 610.0, 120.0, 190.0, 70.0, 80.0, 30.0, 290.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 200.0, 40.0, 30.0, 0.0, 60.0, 150.0, 190.0, 300.0, 260.0, 30.0, 30.0, 40.0, 10.0, 360.0, 120.0, 40.0, 40.0, 180.0, 20.0, 60.0, 120.0, 270.0, 140.0, 250.0, 320.0, 130.0, 60.0, 430.0, 250.0, 60.0, 30.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 35.0, 130.0, 60.0, 300.0, 10.0, 110.0, 0.0, 150.0, 370.0, 500.0, 40.0, 440.0, 30.0, 50.0, 90.0, 190.0, 120.0, 80.0, 20.0, 520.0, 0.0, 40.0, 10.0, 0.0, 80.0, 430.0, 10.0, 0.0, -5.0, 10.0, 40.0, 70.0, 10.0, 10.0, 10.0, 70.0, 0.0, 570.0, 40.0, 280.0, 130.0, 50.0, 10.0, 190.0, 30.0, 210.0, 10.0, 40.0, 30.0, 190.0, 10.0, 250.0, 40.0, 120.0, 90.0, 60.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.03777347858837, "mean_inference_ms": 2.0696124362879056, "mean_action_processing_ms": 0.5481483854746023, "mean_env_wait_ms": 1.7613111694583097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014644145965576172, "StateBufferConnector_ms": 0.011129140853881836, "ViewRequirementAgentConnector_ms": 0.42764925956726074}, "num_episodes": 18, "episode_return_max": 1980.0, "episode_return_min": 140.0, "episode_return_mean": 1129.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.882251326751966, "num_env_steps_trained_throughput_per_sec": 19.882251326751966, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 3800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3800000, "timers": {"training_iteration_time_ms": 370737.217, "restore_workers_time_ms": 0.012, "training_step_time_ms": 370737.17, "sample_time_ms": 2678.881, "learn_time_ms": 368030.45, "learn_throughput": 10.869, "synch_weights_time_ms": 13.597}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "done": false, "training_iteration": 95, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-32-10", "timestamp": 1717259530, "time_this_iter_s": 201.48268389701843, "time_total_s": 50345.99070310593, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7ef670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50345.99070310593, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 22.283216783216783, "ram_util_percent": 80.57517482517483}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.092540797981591, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006976127291705233, "vf_loss": 6.841365581630264, "vf_explained_var": 0.00021351094063097676, "kl": Infinity, "entropy": 0.25004412416325084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 896745.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 140.0, "episode_reward_mean": 1127.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -155.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 112.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1145.0, 840.0, 1670.0, 1660.0, 725.0, 1330.0, 1260.0, 560.0, 1235.0, 880.0, 140.0, 1080.0, 900.0, 870.0, 1160.0, 1315.0, 1410.0, 680.0, 1465.0, 540.0, 1290.0, 1500.0, 290.0, 570.0, 1240.0, 575.0, 1460.0, 860.0, 1230.0, 920.0, 1170.0, 1500.0, 1590.0, 1080.0, 960.0, 300.0, 1400.0, 520.0, 850.0, 1600.0, 370.0, 1820.0, 550.0, 1250.0, 860.0, 440.0, 1030.0, 990.0, 1570.0, 1710.0, 1640.0, 1200.0, 1010.0, 990.0, 1380.0, 900.0, 1280.0, 1280.0, 865.0, 1310.0, 1730.0, 1760.0, 1280.0, 1480.0, 1300.0, 800.0, 1800.0, 430.0, 1430.0, 1240.0, 1370.0, 705.0, 1980.0, 1190.0, 215.0, 1520.0, 930.0, 1350.0, 1800.0, 700.0, 560.0, 1350.0, 1445.0, 1570.0, 1410.0, 240.0, 1720.0, 1280.0, 1800.0, 1440.0, 1390.0, 1330.0, 1145.0, 700.0, 860.0, 220.0, 1570.0, 1470.0, 1260.0, 810.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 60.0, 30.0, 50.0, 50.0, -35.0, 130.0, 570.0, 270.0, 0.0, 40.0, 200.0, 90.0, 270.0, 10.0, 20.0, 160.0, 30.0, 20.0, 170.0, 0.0, 520.0, 80.0, 40.0, 140.0, 40.0, 380.0, -10.0, 310.0, 100.0, -10.0, 40.0, 220.0, 270.0, 480.0, 40.0, 50.0, 280.0, 190.0, 500.0, -10.0, 0.0, 40.0, 55.0, 10.0, 20.0, 80.0, 0.0, 30.0, 40.0, 70.0, 110.0, -10.0, 40.0, 110.0, 490.0, 120.0, 300.0, 60.0, 400.0, 180.0, 300.0, 0.0, 30.0, 10.0, 60.0, 150.0, 30.0, 100.0, 20.0, 0.0, 270.0, 30.0, 20.0, 30.0, 30.0, 60.0, 10.0, 90.0, 70.0, 30.0, 220.0, 70.0, 110.0, 295.0, 70.0, 40.0, 180.0, 150.0, 380.0, 90.0, -10.0, 80.0, 60.0, 30.0, 20.0, 10.0, 130.0, 90.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 70.0, 40.0, 10.0, 70.0, 40.0, 40.0, 40.0, 460.0, 20.0, 290.0, 70.0, 30.0, 30.0, 10.0, 40.0, 90.0, 210.0, 240.0, -10.0, 190.0, 120.0, 90.0, 0.0, 30.0, 130.0, 10.0, 10.0, 40.0, 360.0, 80.0, 180.0, 20.0, 10.0, 100.0, 20.0, 60.0, 90.0, 510.0, 60.0, 110.0, 300.0, 360.0, 155.0, 10.0, 300.0, 0.0, 10.0, 70.0, 90.0, 20.0, 120.0, 10.0, 200.0, 80.0, 50.0, 410.0, 20.0, 500.0, 10.0, 10.0, 30.0, 300.0, 60.0, 0.0, 0.0, 20.0, 0.0, 260.0, 0.0, 10.0, 0.0, 60.0, 220.0, 240.0, 120.0, 430.0, 185.0, 0.0, 120.0, 90.0, 20.0, 0.0, 0.0, 30.0, 30.0, 40.0, 0.0, 330.0, 20.0, 70.0, 90.0, 130.0, -10.0, 170.0, 90.0, 480.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 170.0, 90.0, 80.0, 240.0, 530.0, 30.0, 190.0, -20.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 30.0, 80.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 310.0, 70.0, 90.0, 10.0, 20.0, 10.0, 160.0, 60.0, 110.0, 270.0, 120.0, 60.0, 80.0, 40.0, 330.0, 10.0, 40.0, 20.0, 10.0, 510.0, -30.0, -155.0, 60.0, 30.0, 60.0, 30.0, 380.0, 180.0, 50.0, 220.0, 80.0, 280.0, 60.0, 60.0, 60.0, 90.0, 0.0, 30.0, 90.0, 50.0, 20.0, 300.0, 0.0, 300.0, 30.0, 40.0, 200.0, 70.0, 10.0, 40.0, 200.0, 70.0, -40.0, 110.0, 600.0, -30.0, 330.0, 30.0, 90.0, 50.0, 130.0, 50.0, 30.0, 50.0, 50.0, 110.0, 110.0, 30.0, 40.0, 80.0, 200.0, 10.0, 200.0, 170.0, 290.0, 40.0, 60.0, 30.0, 600.0, 120.0, 100.0, 200.0, 100.0, 150.0, 60.0, 80.0, 110.0, -30.0, 200.0, 15.0, 50.0, 5.0, 310.0, 190.0, 120.0, 620.0, 20.0, 410.0, 140.0, 20.0, 120.0, 40.0, 290.0, 40.0, -40.0, 40.0, 30.0, 110.0, 100.0, 370.0, 10.0, 320.0, 10.0, 0.0, -20.0, 30.0, 40.0, 30.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 90.0, 400.0, 40.0, 10.0, 40.0, 170.0, 170.0, 110.0, 270.0, 90.0, 100.0, 20.0, 40.0, 0.0, 40.0, 30.0, 50.0, 280.0, 10.0, 50.0, 0.0, 50.0, 260.0, 300.0, 10.0, 10.0, 10.0, 100.0, 80.0, 10.0, 20.0, 410.0, 290.0, 20.0, 260.0, 180.0, 0.0, 60.0, 280.0, 70.0, 30.0, -140.0, 60.0, 30.0, 50.0, 0.0, 10.0, -40.0, 380.0, 30.0, -10.0, 180.0, 140.0, 10.0, 220.0, -30.0, 70.0, 330.0, 250.0, 450.0, 200.0, 0.0, 20.0, 30.0, 20.0, 310.0, 80.0, 50.0, 20.0, 10.0, 10.0, 470.0, 40.0, 90.0, 10.0, 180.0, 20.0, 70.0, 80.0, 280.0, 10.0, 10.0, 40.0, 180.0, 120.0, 20.0, 350.0, 50.0, 30.0, 10.0, 50.0, 40.0, 40.0, 160.0, 120.0, 0.0, 0.0, 0.0, 30.0, 10.0, 40.0, 150.0, 130.0, 70.0, 170.0, 40.0, 120.0, 10.0, 10.0, 0.0, 330.0, 60.0, 470.0, 160.0, 100.0, 40.0, 0.0, -50.0, -30.0, 230.0, 10.0, 160.0, 90.0, 230.0, 660.0, 170.0, 30.0, 110.0, 70.0, 40.0, 10.0, 350.0, 50.0, 70.0, 120.0, 90.0, 440.0, 430.0, 90.0, -20.0, 90.0, 210.0, 30.0, 30.0, 220.0, 70.0, 60.0, 140.0, 300.0, 260.0, 320.0, 610.0, 30.0, 0.0, 20.0, 270.0, 30.0, 70.0, 80.0, 30.0, 60.0, 160.0, 320.0, 20.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 350.0, 20.0, 180.0, 140.0, 290.0, 90.0, 40.0, 90.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 310.0, 340.0, 0.0, 370.0, 50.0, 160.0, 0.0, 10.0, 220.0, 40.0, 40.0, 80.0, 0.0, 20.0, 430.0, 20.0, 40.0, 140.0, 160.0, -20.0, 360.0, 30.0, 90.0, 80.0, 350.0, 20.0, 70.0, 40.0, 60.0, 10.0, 150.0, 30.0, 120.0, 130.0, 260.0, 460.0, 20.0, 30.0, 80.0, 0.0, 230.0, 20.0, 40.0, 260.0, 80.0, 100.0, 25.0, 490.0, 20.0, 440.0, 30.0, 120.0, 30.0, 20.0, 30.0, 40.0, 90.0, 370.0, 20.0, 170.0, 20.0, 70.0, 120.0, 80.0, 460.0, 110.0, 310.0, 260.0, 300.0, 470.0, 220.0, 30.0, 40.0, 50.0, 300.0, 50.0, 40.0, 60.0, 80.0, 200.0, 280.0, -10.0, 110.0, 40.0, 170.0, 30.0, 320.0, 60.0, 20.0, 130.0, 30.0, 500.0, 70.0, 120.0, 220.0, 30.0, 300.0, 20.0, 460.0, 200.0, 50.0, 40.0, 0.0, 280.0, 190.0, 100.0, -40.0, 20.0, 0.0, 190.0, 220.0, 320.0, 10.0, 0.0, 0.0, 20.0, 20.0, 140.0, 90.0, 180.0, 610.0, 120.0, 190.0, 70.0, 80.0, 30.0, 290.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 200.0, 40.0, 30.0, 0.0, 60.0, 150.0, 190.0, 300.0, 260.0, 30.0, 30.0, 40.0, 10.0, 360.0, 120.0, 40.0, 40.0, 180.0, 20.0, 60.0, 120.0, 270.0, 140.0, 250.0, 320.0, 130.0, 60.0, 430.0, 250.0, 60.0, 30.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 35.0, 130.0, 60.0, 300.0, 10.0, 110.0, 0.0, 150.0, 370.0, 500.0, 40.0, 440.0, 30.0, 50.0, 90.0, 190.0, 120.0, 80.0, 20.0, 520.0, 0.0, 40.0, 10.0, 0.0, 80.0, 430.0, 10.0, 0.0, -5.0, 10.0, 40.0, 70.0, 10.0, 10.0, 10.0, 70.0, 0.0, 570.0, 40.0, 280.0, 130.0, 50.0, 10.0, 190.0, 30.0, 210.0, 10.0, 40.0, 30.0, 190.0, 10.0, 250.0, 40.0, 120.0, 90.0, 60.0, 100.0, 660.0, 20.0, 270.0, 90.0, -20.0, 0.0, 40.0, 50.0, 10.0, 230.0, 540.0, 130.0, 80.0, 80.0, 20.0, 310.0, -30.0, 200.0, 430.0, 40.0, 90.0, 20.0, 90.0, 20.0, 80.0, 20.0, 10.0, 120.0, 220.0, 30.0, 50.0, 20.0, 380.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 190.0, 30.0, 160.0, 90.0, 320.0, 70.0, 290.0, 60.0, 120.0, 70.0, 500.0, 270.0, -20.0, 140.0, 65.0, 60.0, 300.0, 50.0, 10.0, 210.0, 10.0, 460.0, 70.0, 30.0, 80.0, 30.0, 160.0, 300.0, 220.0, 20.0, 130.0, 100.0, 20.0, 360.0, 350.0, 270.0, 110.0, 50.0, 0.0, 40.0, 30.0, 30.0, 30.0, 10.0, 80.0, 20.0, 0.0, 0.0, 0.0, 140.0, 110.0, 290.0, 190.0, 210.0, 440.0, 40.0, 110.0, 40.0, 150.0, 260.0, 100.0, 40.0, 40.0, 40.0, 80.0, 410.0, 240.0, 10.0, 60.0, 80.0, 110.0, 280.0, 150.0, 410.0, 400.0, 70.0, -30.0, 320.0, 10.0, -20.0, 510.0, 140.0, 250.0, 40.0, 110.0, 40.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 230.0, 50.0, 300.0, 570.0, 170.0, 30.0, -50.0, 70.0, 60.0, 230.0, 190.0, 60.0, 130.0, 50.0, 300.0, 10.0, 230.0, -25.0, 20.0, 160.0, 410.0, 80.0, 30.0, 340.0, 60.0, 20.0, 50.0, 40.0, 20.0, 30.0, 20.0, 80.0, 30.0, 20.0, 210.0, 230.0, 20.0, 320.0, 70.0, 20.0, 30.0, 40.0, 130.0, 170.0, 70.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 110.0, 0.0, 10.0, 50.0, 80.0, 70.0, 90.0, 30.0, 300.0, 500.0, 380.0, 30.0, 40.0, 300.0, 350.0, 170.0, 120.0, 50.0, 170.0, 40.0, 70.0, 90.0, 110.0, 0.0, 580.0, 60.0, 40.0, 10.0, 40.0, 290.0, 30.0, 30.0, 180.0, 30.0, 0.0, 190.0, 30.0, 150.0, 170.0, 70.0, 0.0, 130.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.032790961258804, "mean_inference_ms": 2.066637093778273, "mean_action_processing_ms": 0.546956175110576, "mean_env_wait_ms": 1.7575868743775205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014967918395996094, "StateBufferConnector_ms": 0.011092185974121094, "ViewRequirementAgentConnector_ms": 0.4460132122039795}, "num_episodes": 23, "episode_return_max": 1980.0, "episode_return_min": 140.0, "episode_return_mean": 1127.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.777340683913256, "num_env_steps_trained_throughput_per_sec": 19.777340683913256, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 3840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3840000, "timers": {"training_iteration_time_ms": 371173.733, "restore_workers_time_ms": 0.012, "training_step_time_ms": 371173.686, "sample_time_ms": 2764.291, "learn_time_ms": 368381.629, "learn_throughput": 10.858, "synch_weights_time_ms": 13.971}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "done": false, "training_iteration": 96, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-35-32", "timestamp": 1717259732, "time_this_iter_s": 202.27509927749634, "time_total_s": 50548.26580238342, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x322781d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50548.26580238342, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 23.93275261324042, "ram_util_percent": 80.1390243902439}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.017533522139723, "cur_kl_coeff": 0.21357421874999996, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007690337827950875, "vf_loss": 6.869203161050717, "vf_explained_var": 0.00017114724721898413, "kl": Infinity, "entropy": 0.23153950750304106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 906135.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 215.0, "episode_reward_mean": 1145.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -155.0}, "policy_reward_max": {"policy_0": 745.0}, "policy_reward_mean": {"policy_0": 114.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1465.0, 540.0, 1290.0, 1500.0, 290.0, 570.0, 1240.0, 575.0, 1460.0, 860.0, 1230.0, 920.0, 1170.0, 1500.0, 1590.0, 1080.0, 960.0, 300.0, 1400.0, 520.0, 850.0, 1600.0, 370.0, 1820.0, 550.0, 1250.0, 860.0, 440.0, 1030.0, 990.0, 1570.0, 1710.0, 1640.0, 1200.0, 1010.0, 990.0, 1380.0, 900.0, 1280.0, 1280.0, 865.0, 1310.0, 1730.0, 1760.0, 1280.0, 1480.0, 1300.0, 800.0, 1800.0, 430.0, 1430.0, 1240.0, 1370.0, 705.0, 1980.0, 1190.0, 215.0, 1520.0, 930.0, 1350.0, 1800.0, 700.0, 560.0, 1350.0, 1445.0, 1570.0, 1410.0, 240.0, 1720.0, 1280.0, 1800.0, 1440.0, 1390.0, 1330.0, 1145.0, 700.0, 860.0, 220.0, 1570.0, 1470.0, 1260.0, 810.0, 545.0, 1210.0, 1770.0, 930.0, 1240.0, 1270.0, 1430.0, 1090.0, 1770.0, 730.0, 1100.0, 1835.0, 220.0, 520.0, 460.0, 1620.0, 900.0, 1980.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 60.0, 220.0, 240.0, 120.0, 430.0, 185.0, 0.0, 120.0, 90.0, 20.0, 0.0, 0.0, 30.0, 30.0, 40.0, 0.0, 330.0, 20.0, 70.0, 90.0, 130.0, -10.0, 170.0, 90.0, 480.0, 210.0, 60.0, 30.0, 40.0, 40.0, 150.0, 170.0, 90.0, 80.0, 240.0, 530.0, 30.0, 190.0, -20.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 30.0, 80.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 310.0, 70.0, 90.0, 10.0, 20.0, 10.0, 160.0, 60.0, 110.0, 270.0, 120.0, 60.0, 80.0, 40.0, 330.0, 10.0, 40.0, 20.0, 10.0, 510.0, -30.0, -155.0, 60.0, 30.0, 60.0, 30.0, 380.0, 180.0, 50.0, 220.0, 80.0, 280.0, 60.0, 60.0, 60.0, 90.0, 0.0, 30.0, 90.0, 50.0, 20.0, 300.0, 0.0, 300.0, 30.0, 40.0, 200.0, 70.0, 10.0, 40.0, 200.0, 70.0, -40.0, 110.0, 600.0, -30.0, 330.0, 30.0, 90.0, 50.0, 130.0, 50.0, 30.0, 50.0, 50.0, 110.0, 110.0, 30.0, 40.0, 80.0, 200.0, 10.0, 200.0, 170.0, 290.0, 40.0, 60.0, 30.0, 600.0, 120.0, 100.0, 200.0, 100.0, 150.0, 60.0, 80.0, 110.0, -30.0, 200.0, 15.0, 50.0, 5.0, 310.0, 190.0, 120.0, 620.0, 20.0, 410.0, 140.0, 20.0, 120.0, 40.0, 290.0, 40.0, -40.0, 40.0, 30.0, 110.0, 100.0, 370.0, 10.0, 320.0, 10.0, 0.0, -20.0, 30.0, 40.0, 30.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 90.0, 400.0, 40.0, 10.0, 40.0, 170.0, 170.0, 110.0, 270.0, 90.0, 100.0, 20.0, 40.0, 0.0, 40.0, 30.0, 50.0, 280.0, 10.0, 50.0, 0.0, 50.0, 260.0, 300.0, 10.0, 10.0, 10.0, 100.0, 80.0, 10.0, 20.0, 410.0, 290.0, 20.0, 260.0, 180.0, 0.0, 60.0, 280.0, 70.0, 30.0, -140.0, 60.0, 30.0, 50.0, 0.0, 10.0, -40.0, 380.0, 30.0, -10.0, 180.0, 140.0, 10.0, 220.0, -30.0, 70.0, 330.0, 250.0, 450.0, 200.0, 0.0, 20.0, 30.0, 20.0, 310.0, 80.0, 50.0, 20.0, 10.0, 10.0, 470.0, 40.0, 90.0, 10.0, 180.0, 20.0, 70.0, 80.0, 280.0, 10.0, 10.0, 40.0, 180.0, 120.0, 20.0, 350.0, 50.0, 30.0, 10.0, 50.0, 40.0, 40.0, 160.0, 120.0, 0.0, 0.0, 0.0, 30.0, 10.0, 40.0, 150.0, 130.0, 70.0, 170.0, 40.0, 120.0, 10.0, 10.0, 0.0, 330.0, 60.0, 470.0, 160.0, 100.0, 40.0, 0.0, -50.0, -30.0, 230.0, 10.0, 160.0, 90.0, 230.0, 660.0, 170.0, 30.0, 110.0, 70.0, 40.0, 10.0, 350.0, 50.0, 70.0, 120.0, 90.0, 440.0, 430.0, 90.0, -20.0, 90.0, 210.0, 30.0, 30.0, 220.0, 70.0, 60.0, 140.0, 300.0, 260.0, 320.0, 610.0, 30.0, 0.0, 20.0, 270.0, 30.0, 70.0, 80.0, 30.0, 60.0, 160.0, 320.0, 20.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 350.0, 20.0, 180.0, 140.0, 290.0, 90.0, 40.0, 90.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 310.0, 340.0, 0.0, 370.0, 50.0, 160.0, 0.0, 10.0, 220.0, 40.0, 40.0, 80.0, 0.0, 20.0, 430.0, 20.0, 40.0, 140.0, 160.0, -20.0, 360.0, 30.0, 90.0, 80.0, 350.0, 20.0, 70.0, 40.0, 60.0, 10.0, 150.0, 30.0, 120.0, 130.0, 260.0, 460.0, 20.0, 30.0, 80.0, 0.0, 230.0, 20.0, 40.0, 260.0, 80.0, 100.0, 25.0, 490.0, 20.0, 440.0, 30.0, 120.0, 30.0, 20.0, 30.0, 40.0, 90.0, 370.0, 20.0, 170.0, 20.0, 70.0, 120.0, 80.0, 460.0, 110.0, 310.0, 260.0, 300.0, 470.0, 220.0, 30.0, 40.0, 50.0, 300.0, 50.0, 40.0, 60.0, 80.0, 200.0, 280.0, -10.0, 110.0, 40.0, 170.0, 30.0, 320.0, 60.0, 20.0, 130.0, 30.0, 500.0, 70.0, 120.0, 220.0, 30.0, 300.0, 20.0, 460.0, 200.0, 50.0, 40.0, 0.0, 280.0, 190.0, 100.0, -40.0, 20.0, 0.0, 190.0, 220.0, 320.0, 10.0, 0.0, 0.0, 20.0, 20.0, 140.0, 90.0, 180.0, 610.0, 120.0, 190.0, 70.0, 80.0, 30.0, 290.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 200.0, 40.0, 30.0, 0.0, 60.0, 150.0, 190.0, 300.0, 260.0, 30.0, 30.0, 40.0, 10.0, 360.0, 120.0, 40.0, 40.0, 180.0, 20.0, 60.0, 120.0, 270.0, 140.0, 250.0, 320.0, 130.0, 60.0, 430.0, 250.0, 60.0, 30.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 35.0, 130.0, 60.0, 300.0, 10.0, 110.0, 0.0, 150.0, 370.0, 500.0, 40.0, 440.0, 30.0, 50.0, 90.0, 190.0, 120.0, 80.0, 20.0, 520.0, 0.0, 40.0, 10.0, 0.0, 80.0, 430.0, 10.0, 0.0, -5.0, 10.0, 40.0, 70.0, 10.0, 10.0, 10.0, 70.0, 0.0, 570.0, 40.0, 280.0, 130.0, 50.0, 10.0, 190.0, 30.0, 210.0, 10.0, 40.0, 30.0, 190.0, 10.0, 250.0, 40.0, 120.0, 90.0, 60.0, 100.0, 660.0, 20.0, 270.0, 90.0, -20.0, 0.0, 40.0, 50.0, 10.0, 230.0, 540.0, 130.0, 80.0, 80.0, 20.0, 310.0, -30.0, 200.0, 430.0, 40.0, 90.0, 20.0, 90.0, 20.0, 80.0, 20.0, 10.0, 120.0, 220.0, 30.0, 50.0, 20.0, 380.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 190.0, 30.0, 160.0, 90.0, 320.0, 70.0, 290.0, 60.0, 120.0, 70.0, 500.0, 270.0, -20.0, 140.0, 65.0, 60.0, 300.0, 50.0, 10.0, 210.0, 10.0, 460.0, 70.0, 30.0, 80.0, 30.0, 160.0, 300.0, 220.0, 20.0, 130.0, 100.0, 20.0, 360.0, 350.0, 270.0, 110.0, 50.0, 0.0, 40.0, 30.0, 30.0, 30.0, 10.0, 80.0, 20.0, 0.0, 0.0, 0.0, 140.0, 110.0, 290.0, 190.0, 210.0, 440.0, 40.0, 110.0, 40.0, 150.0, 260.0, 100.0, 40.0, 40.0, 40.0, 80.0, 410.0, 240.0, 10.0, 60.0, 80.0, 110.0, 280.0, 150.0, 410.0, 400.0, 70.0, -30.0, 320.0, 10.0, -20.0, 510.0, 140.0, 250.0, 40.0, 110.0, 40.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 230.0, 50.0, 300.0, 570.0, 170.0, 30.0, -50.0, 70.0, 60.0, 230.0, 190.0, 60.0, 130.0, 50.0, 300.0, 10.0, 230.0, -25.0, 20.0, 160.0, 410.0, 80.0, 30.0, 340.0, 60.0, 20.0, 50.0, 40.0, 20.0, 30.0, 20.0, 80.0, 30.0, 20.0, 210.0, 230.0, 20.0, 320.0, 70.0, 20.0, 30.0, 40.0, 130.0, 170.0, 70.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 110.0, 0.0, 10.0, 50.0, 80.0, 70.0, 90.0, 30.0, 300.0, 500.0, 380.0, 30.0, 40.0, 300.0, 350.0, 170.0, 120.0, 50.0, 170.0, 40.0, 70.0, 90.0, 110.0, 0.0, 580.0, 60.0, 40.0, 10.0, 40.0, 290.0, 30.0, 30.0, 180.0, 30.0, 0.0, 190.0, 30.0, 150.0, 170.0, 70.0, 0.0, 130.0, 40.0, 10.0, 120.0, 40.0, 10.0, 25.0, 190.0, 0.0, 10.0, 100.0, 40.0, -50.0, 30.0, 150.0, -110.0, 40.0, 10.0, 30.0, 10.0, 480.0, 620.0, 120.0, 100.0, 500.0, 100.0, 110.0, 230.0, 240.0, 90.0, 240.0, 40.0, 400.0, 100.0, 90.0, 50.0, 20.0, 0.0, 50.0, 70.0, 90.0, 60.0, 400.0, 30.0, 90.0, 430.0, 110.0, 50.0, 100.0, 0.0, 0.0, 30.0, -40.0, 50.0, 30.0, 580.0, 120.0, 140.0, 400.0, 10.0, 0.0, -20.0, 10.0, 0.0, 70.0, 170.0, -50.0, 0.0, 670.0, 160.0, 70.0, 330.0, 240.0, 0.0, 30.0, 30.0, 30.0, 100.0, 50.0, 180.0, 60.0, 370.0, 40.0, 330.0, 10.0, 290.0, 490.0, 270.0, 90.0, 140.0, 110.0, 0.0, 10.0, 30.0, 10.0, 0.0, 260.0, 0.0, 50.0, 220.0, 20.0, 130.0, 120.0, 110.0, 20.0, -20.0, 210.0, 80.0, 540.0, 20.0, 20.0, 0.0, 40.0, 70.0, 260.0, 110.0, 390.0, 745.0, 60.0, 150.0, 110.0, -100.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 40.0, 110.0, 0.0, 10.0, 10.0, 20.0, 30.0, 50.0, 80.0, 0.0, 90.0, 20.0, 190.0, 30.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 50.0, 150.0, 110.0, 510.0, 210.0, 320.0, 20.0, 130.0, 50.0, 80.0, 100.0, 70.0, 130.0, 0.0, 80.0, 20.0, 310.0, 120.0, 0.0, -30.0, 0.0, 180.0, 220.0, -50.0, 400.0, 130.0, 70.0, 40.0, 140.0, 110.0, 330.0, 470.0, 340.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0293765151225083, "mean_inference_ms": 2.064579332880553, "mean_action_processing_ms": 0.5461289247338335, "mean_env_wait_ms": 1.7550330357300878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015840530395507812, "StateBufferConnector_ms": 0.011339426040649414, "ViewRequirementAgentConnector_ms": 0.4497036933898926}, "num_episodes": 18, "episode_return_max": 1980.0, "episode_return_min": 215.0, "episode_return_mean": 1145.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.110318736340982, "num_env_steps_trained_throughput_per_sec": 19.110318736340982, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 3880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3880000, "timers": {"training_iteration_time_ms": 372202.517, "restore_workers_time_ms": 0.012, "training_step_time_ms": 372202.47, "sample_time_ms": 2795.194, "learn_time_ms": 369378.655, "learn_throughput": 10.829, "synch_weights_time_ms": 14.521}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "done": false, "training_iteration": 97, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-39-02", "timestamp": 1717259942, "time_this_iter_s": 209.35398483276367, "time_total_s": 50757.61978721619, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7fe040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50757.61978721619, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 25.706375838926174, "ram_util_percent": 83.09328859060403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.288979150318363, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006180024343563583, "vf_loss": 6.899343587999272, "vf_explained_var": 0.0006931544873661126, "kl": Infinity, "entropy": 0.23219110018417985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 915525.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 215.0, "episode_reward_mean": 1158.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 115.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1400.0, 520.0, 850.0, 1600.0, 370.0, 1820.0, 550.0, 1250.0, 860.0, 440.0, 1030.0, 990.0, 1570.0, 1710.0, 1640.0, 1200.0, 1010.0, 990.0, 1380.0, 900.0, 1280.0, 1280.0, 865.0, 1310.0, 1730.0, 1760.0, 1280.0, 1480.0, 1300.0, 800.0, 1800.0, 430.0, 1430.0, 1240.0, 1370.0, 705.0, 1980.0, 1190.0, 215.0, 1520.0, 930.0, 1350.0, 1800.0, 700.0, 560.0, 1350.0, 1445.0, 1570.0, 1410.0, 240.0, 1720.0, 1280.0, 1800.0, 1440.0, 1390.0, 1330.0, 1145.0, 700.0, 860.0, 220.0, 1570.0, 1470.0, 1260.0, 810.0, 545.0, 1210.0, 1770.0, 930.0, 1240.0, 1270.0, 1430.0, 1090.0, 1770.0, 730.0, 1100.0, 1835.0, 220.0, 520.0, 460.0, 1620.0, 900.0, 1980.0, 1960.0, 1000.0, 1250.0, 1880.0, 820.0, 1240.0, 1260.0, 860.0, 500.0, 1430.0, 900.0, 760.0, 1220.0, 450.0, 1010.0, 390.0, 1520.0, 1430.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [400.0, 40.0, 10.0, 40.0, 170.0, 170.0, 110.0, 270.0, 90.0, 100.0, 20.0, 40.0, 0.0, 40.0, 30.0, 50.0, 280.0, 10.0, 50.0, 0.0, 50.0, 260.0, 300.0, 10.0, 10.0, 10.0, 100.0, 80.0, 10.0, 20.0, 410.0, 290.0, 20.0, 260.0, 180.0, 0.0, 60.0, 280.0, 70.0, 30.0, -140.0, 60.0, 30.0, 50.0, 0.0, 10.0, -40.0, 380.0, 30.0, -10.0, 180.0, 140.0, 10.0, 220.0, -30.0, 70.0, 330.0, 250.0, 450.0, 200.0, 0.0, 20.0, 30.0, 20.0, 310.0, 80.0, 50.0, 20.0, 10.0, 10.0, 470.0, 40.0, 90.0, 10.0, 180.0, 20.0, 70.0, 80.0, 280.0, 10.0, 10.0, 40.0, 180.0, 120.0, 20.0, 350.0, 50.0, 30.0, 10.0, 50.0, 40.0, 40.0, 160.0, 120.0, 0.0, 0.0, 0.0, 30.0, 10.0, 40.0, 150.0, 130.0, 70.0, 170.0, 40.0, 120.0, 10.0, 10.0, 0.0, 330.0, 60.0, 470.0, 160.0, 100.0, 40.0, 0.0, -50.0, -30.0, 230.0, 10.0, 160.0, 90.0, 230.0, 660.0, 170.0, 30.0, 110.0, 70.0, 40.0, 10.0, 350.0, 50.0, 70.0, 120.0, 90.0, 440.0, 430.0, 90.0, -20.0, 90.0, 210.0, 30.0, 30.0, 220.0, 70.0, 60.0, 140.0, 300.0, 260.0, 320.0, 610.0, 30.0, 0.0, 20.0, 270.0, 30.0, 70.0, 80.0, 30.0, 60.0, 160.0, 320.0, 20.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 350.0, 20.0, 180.0, 140.0, 290.0, 90.0, 40.0, 90.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 310.0, 340.0, 0.0, 370.0, 50.0, 160.0, 0.0, 10.0, 220.0, 40.0, 40.0, 80.0, 0.0, 20.0, 430.0, 20.0, 40.0, 140.0, 160.0, -20.0, 360.0, 30.0, 90.0, 80.0, 350.0, 20.0, 70.0, 40.0, 60.0, 10.0, 150.0, 30.0, 120.0, 130.0, 260.0, 460.0, 20.0, 30.0, 80.0, 0.0, 230.0, 20.0, 40.0, 260.0, 80.0, 100.0, 25.0, 490.0, 20.0, 440.0, 30.0, 120.0, 30.0, 20.0, 30.0, 40.0, 90.0, 370.0, 20.0, 170.0, 20.0, 70.0, 120.0, 80.0, 460.0, 110.0, 310.0, 260.0, 300.0, 470.0, 220.0, 30.0, 40.0, 50.0, 300.0, 50.0, 40.0, 60.0, 80.0, 200.0, 280.0, -10.0, 110.0, 40.0, 170.0, 30.0, 320.0, 60.0, 20.0, 130.0, 30.0, 500.0, 70.0, 120.0, 220.0, 30.0, 300.0, 20.0, 460.0, 200.0, 50.0, 40.0, 0.0, 280.0, 190.0, 100.0, -40.0, 20.0, 0.0, 190.0, 220.0, 320.0, 10.0, 0.0, 0.0, 20.0, 20.0, 140.0, 90.0, 180.0, 610.0, 120.0, 190.0, 70.0, 80.0, 30.0, 290.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 200.0, 40.0, 30.0, 0.0, 60.0, 150.0, 190.0, 300.0, 260.0, 30.0, 30.0, 40.0, 10.0, 360.0, 120.0, 40.0, 40.0, 180.0, 20.0, 60.0, 120.0, 270.0, 140.0, 250.0, 320.0, 130.0, 60.0, 430.0, 250.0, 60.0, 30.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 35.0, 130.0, 60.0, 300.0, 10.0, 110.0, 0.0, 150.0, 370.0, 500.0, 40.0, 440.0, 30.0, 50.0, 90.0, 190.0, 120.0, 80.0, 20.0, 520.0, 0.0, 40.0, 10.0, 0.0, 80.0, 430.0, 10.0, 0.0, -5.0, 10.0, 40.0, 70.0, 10.0, 10.0, 10.0, 70.0, 0.0, 570.0, 40.0, 280.0, 130.0, 50.0, 10.0, 190.0, 30.0, 210.0, 10.0, 40.0, 30.0, 190.0, 10.0, 250.0, 40.0, 120.0, 90.0, 60.0, 100.0, 660.0, 20.0, 270.0, 90.0, -20.0, 0.0, 40.0, 50.0, 10.0, 230.0, 540.0, 130.0, 80.0, 80.0, 20.0, 310.0, -30.0, 200.0, 430.0, 40.0, 90.0, 20.0, 90.0, 20.0, 80.0, 20.0, 10.0, 120.0, 220.0, 30.0, 50.0, 20.0, 380.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 190.0, 30.0, 160.0, 90.0, 320.0, 70.0, 290.0, 60.0, 120.0, 70.0, 500.0, 270.0, -20.0, 140.0, 65.0, 60.0, 300.0, 50.0, 10.0, 210.0, 10.0, 460.0, 70.0, 30.0, 80.0, 30.0, 160.0, 300.0, 220.0, 20.0, 130.0, 100.0, 20.0, 360.0, 350.0, 270.0, 110.0, 50.0, 0.0, 40.0, 30.0, 30.0, 30.0, 10.0, 80.0, 20.0, 0.0, 0.0, 0.0, 140.0, 110.0, 290.0, 190.0, 210.0, 440.0, 40.0, 110.0, 40.0, 150.0, 260.0, 100.0, 40.0, 40.0, 40.0, 80.0, 410.0, 240.0, 10.0, 60.0, 80.0, 110.0, 280.0, 150.0, 410.0, 400.0, 70.0, -30.0, 320.0, 10.0, -20.0, 510.0, 140.0, 250.0, 40.0, 110.0, 40.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 230.0, 50.0, 300.0, 570.0, 170.0, 30.0, -50.0, 70.0, 60.0, 230.0, 190.0, 60.0, 130.0, 50.0, 300.0, 10.0, 230.0, -25.0, 20.0, 160.0, 410.0, 80.0, 30.0, 340.0, 60.0, 20.0, 50.0, 40.0, 20.0, 30.0, 20.0, 80.0, 30.0, 20.0, 210.0, 230.0, 20.0, 320.0, 70.0, 20.0, 30.0, 40.0, 130.0, 170.0, 70.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 110.0, 0.0, 10.0, 50.0, 80.0, 70.0, 90.0, 30.0, 300.0, 500.0, 380.0, 30.0, 40.0, 300.0, 350.0, 170.0, 120.0, 50.0, 170.0, 40.0, 70.0, 90.0, 110.0, 0.0, 580.0, 60.0, 40.0, 10.0, 40.0, 290.0, 30.0, 30.0, 180.0, 30.0, 0.0, 190.0, 30.0, 150.0, 170.0, 70.0, 0.0, 130.0, 40.0, 10.0, 120.0, 40.0, 10.0, 25.0, 190.0, 0.0, 10.0, 100.0, 40.0, -50.0, 30.0, 150.0, -110.0, 40.0, 10.0, 30.0, 10.0, 480.0, 620.0, 120.0, 100.0, 500.0, 100.0, 110.0, 230.0, 240.0, 90.0, 240.0, 40.0, 400.0, 100.0, 90.0, 50.0, 20.0, 0.0, 50.0, 70.0, 90.0, 60.0, 400.0, 30.0, 90.0, 430.0, 110.0, 50.0, 100.0, 0.0, 0.0, 30.0, -40.0, 50.0, 30.0, 580.0, 120.0, 140.0, 400.0, 10.0, 0.0, -20.0, 10.0, 0.0, 70.0, 170.0, -50.0, 0.0, 670.0, 160.0, 70.0, 330.0, 240.0, 0.0, 30.0, 30.0, 30.0, 100.0, 50.0, 180.0, 60.0, 370.0, 40.0, 330.0, 10.0, 290.0, 490.0, 270.0, 90.0, 140.0, 110.0, 0.0, 10.0, 30.0, 10.0, 0.0, 260.0, 0.0, 50.0, 220.0, 20.0, 130.0, 120.0, 110.0, 20.0, -20.0, 210.0, 80.0, 540.0, 20.0, 20.0, 0.0, 40.0, 70.0, 260.0, 110.0, 390.0, 745.0, 60.0, 150.0, 110.0, -100.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 40.0, 110.0, 0.0, 10.0, 10.0, 20.0, 30.0, 50.0, 80.0, 0.0, 90.0, 20.0, 190.0, 30.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 50.0, 150.0, 110.0, 510.0, 210.0, 320.0, 20.0, 130.0, 50.0, 80.0, 100.0, 70.0, 130.0, 0.0, 80.0, 20.0, 310.0, 120.0, 0.0, -30.0, 0.0, 180.0, 220.0, -50.0, 400.0, 130.0, 70.0, 40.0, 140.0, 110.0, 330.0, 470.0, 340.0, 90.0, 330.0, 380.0, 110.0, 50.0, 80.0, 60.0, 60.0, 170.0, 630.0, 40.0, 40.0, 180.0, 60.0, 280.0, 30.0, 20.0, 40.0, 290.0, 20.0, 30.0, 200.0, 30.0, 330.0, 200.0, 70.0, 220.0, 160.0, 0.0, 10.0, 20.0, -10.0, 700.0, -50.0, 50.0, 10.0, 110.0, 300.0, 330.0, 420.0, 90.0, 110.0, 30.0, 170.0, 40.0, 0.0, 40.0, 290.0, 0.0, 50.0, 350.0, 30.0, 40.0, 20.0, 270.0, 250.0, 40.0, 100.0, 0.0, 140.0, 40.0, 40.0, 140.0, 100.0, 190.0, 150.0, 170.0, 50.0, 350.0, 30.0, 150.0, 200.0, 240.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 210.0, 40.0, -150.0, 30.0, 30.0, 0.0, 290.0, 0.0, 50.0, 160.0, 50.0, 260.0, 10.0, 260.0, 70.0, 10.0, 100.0, 210.0, 330.0, 0.0, 180.0, 120.0, 280.0, 110.0, 100.0, 150.0, 40.0, 30.0, -5.0, 60.0, 15.0, 10.0, 30.0, 10.0, 90.0, 220.0, 40.0, 20.0, 10.0, 30.0, 300.0, 100.0, 80.0, 280.0, 120.0, 30.0, 80.0, 90.0, 370.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 40.0, 290.0, 30.0, 0.0, -50.0, 40.0, 260.0, 0.0, -100.0, 10.0, 0.0, 30.0, 750.0, 80.0, -40.0, 20.0, 0.0, 90.0, 50.0, 50.0, 40.0, 70.0, 40.0, 10.0, 0.0, 40.0, 90.0, 10.0, 120.0, 30.0, 380.0, 380.0, 80.0, 190.0, 170.0, 70.0, 30.0, 40.0, 370.0, 80.0, 40.0, 60.0, 190.0, 160.0, 450.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0251769838453884, "mean_inference_ms": 2.0622404900318103, "mean_action_processing_ms": 0.5451565897970984, "mean_env_wait_ms": 1.7521894362400194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016085147857666016, "StateBufferConnector_ms": 0.010838747024536133, "ViewRequirementAgentConnector_ms": 0.4526634216308594}, "num_episodes": 18, "episode_return_max": 1980.0, "episode_return_min": 215.0, "episode_return_mean": 1158.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.351340930081918, "num_env_steps_trained_throughput_per_sec": 19.351340930081918, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 3920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3920000, "timers": {"training_iteration_time_ms": 372780.221, "restore_workers_time_ms": 0.012, "training_step_time_ms": 372780.168, "sample_time_ms": 2800.087, "learn_time_ms": 369951.126, "learn_throughput": 10.812, "synch_weights_time_ms": 14.447}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "done": false, "training_iteration": 98, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-42-29", "timestamp": 1717260149, "time_this_iter_s": 206.9947099685669, "time_total_s": 50964.61449718475, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321bff8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50964.61449718475, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 26.799319727891156, "ram_util_percent": 82.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2582509790238734, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.691267927563863, "policy_loss": -0.006255658661834578, "vf_loss": 6.695860027581358, "vf_explained_var": 0.0002476486725548205, "kl": 0.0034618317379326346, "entropy": 0.21963169350426673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 924915.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "env_runners": {"episode_reward_max": 2895.0, "episode_reward_min": 180.0, "episode_reward_mean": 1182.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 118.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [865.0, 1310.0, 1730.0, 1760.0, 1280.0, 1480.0, 1300.0, 800.0, 1800.0, 430.0, 1430.0, 1240.0, 1370.0, 705.0, 1980.0, 1190.0, 215.0, 1520.0, 930.0, 1350.0, 1800.0, 700.0, 560.0, 1350.0, 1445.0, 1570.0, 1410.0, 240.0, 1720.0, 1280.0, 1800.0, 1440.0, 1390.0, 1330.0, 1145.0, 700.0, 860.0, 220.0, 1570.0, 1470.0, 1260.0, 810.0, 545.0, 1210.0, 1770.0, 930.0, 1240.0, 1270.0, 1430.0, 1090.0, 1770.0, 730.0, 1100.0, 1835.0, 220.0, 520.0, 460.0, 1620.0, 900.0, 1980.0, 1960.0, 1000.0, 1250.0, 1880.0, 820.0, 1240.0, 1260.0, 860.0, 500.0, 1430.0, 900.0, 760.0, 1220.0, 450.0, 1010.0, 390.0, 1520.0, 1430.0, 950.0, 2895.0, 1630.0, 1340.0, 740.0, 1200.0, 1170.0, 1810.0, 1470.0, 1280.0, 780.0, 930.0, 1045.0, 1550.0, 1565.0, 1150.0, 820.0, 310.0, 1380.0, 890.0, 180.0, 1900.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 80.0, 0.0, 230.0, 20.0, 40.0, 260.0, 80.0, 100.0, 25.0, 490.0, 20.0, 440.0, 30.0, 120.0, 30.0, 20.0, 30.0, 40.0, 90.0, 370.0, 20.0, 170.0, 20.0, 70.0, 120.0, 80.0, 460.0, 110.0, 310.0, 260.0, 300.0, 470.0, 220.0, 30.0, 40.0, 50.0, 300.0, 50.0, 40.0, 60.0, 80.0, 200.0, 280.0, -10.0, 110.0, 40.0, 170.0, 30.0, 320.0, 60.0, 20.0, 130.0, 30.0, 500.0, 70.0, 120.0, 220.0, 30.0, 300.0, 20.0, 460.0, 200.0, 50.0, 40.0, 0.0, 280.0, 190.0, 100.0, -40.0, 20.0, 0.0, 190.0, 220.0, 320.0, 10.0, 0.0, 0.0, 20.0, 20.0, 140.0, 90.0, 180.0, 610.0, 120.0, 190.0, 70.0, 80.0, 30.0, 290.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 200.0, 40.0, 30.0, 0.0, 60.0, 150.0, 190.0, 300.0, 260.0, 30.0, 30.0, 40.0, 10.0, 360.0, 120.0, 40.0, 40.0, 180.0, 20.0, 60.0, 120.0, 270.0, 140.0, 250.0, 320.0, 130.0, 60.0, 430.0, 250.0, 60.0, 30.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 35.0, 130.0, 60.0, 300.0, 10.0, 110.0, 0.0, 150.0, 370.0, 500.0, 40.0, 440.0, 30.0, 50.0, 90.0, 190.0, 120.0, 80.0, 20.0, 520.0, 0.0, 40.0, 10.0, 0.0, 80.0, 430.0, 10.0, 0.0, -5.0, 10.0, 40.0, 70.0, 10.0, 10.0, 10.0, 70.0, 0.0, 570.0, 40.0, 280.0, 130.0, 50.0, 10.0, 190.0, 30.0, 210.0, 10.0, 40.0, 30.0, 190.0, 10.0, 250.0, 40.0, 120.0, 90.0, 60.0, 100.0, 660.0, 20.0, 270.0, 90.0, -20.0, 0.0, 40.0, 50.0, 10.0, 230.0, 540.0, 130.0, 80.0, 80.0, 20.0, 310.0, -30.0, 200.0, 430.0, 40.0, 90.0, 20.0, 90.0, 20.0, 80.0, 20.0, 10.0, 120.0, 220.0, 30.0, 50.0, 20.0, 380.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 190.0, 30.0, 160.0, 90.0, 320.0, 70.0, 290.0, 60.0, 120.0, 70.0, 500.0, 270.0, -20.0, 140.0, 65.0, 60.0, 300.0, 50.0, 10.0, 210.0, 10.0, 460.0, 70.0, 30.0, 80.0, 30.0, 160.0, 300.0, 220.0, 20.0, 130.0, 100.0, 20.0, 360.0, 350.0, 270.0, 110.0, 50.0, 0.0, 40.0, 30.0, 30.0, 30.0, 10.0, 80.0, 20.0, 0.0, 0.0, 0.0, 140.0, 110.0, 290.0, 190.0, 210.0, 440.0, 40.0, 110.0, 40.0, 150.0, 260.0, 100.0, 40.0, 40.0, 40.0, 80.0, 410.0, 240.0, 10.0, 60.0, 80.0, 110.0, 280.0, 150.0, 410.0, 400.0, 70.0, -30.0, 320.0, 10.0, -20.0, 510.0, 140.0, 250.0, 40.0, 110.0, 40.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 230.0, 50.0, 300.0, 570.0, 170.0, 30.0, -50.0, 70.0, 60.0, 230.0, 190.0, 60.0, 130.0, 50.0, 300.0, 10.0, 230.0, -25.0, 20.0, 160.0, 410.0, 80.0, 30.0, 340.0, 60.0, 20.0, 50.0, 40.0, 20.0, 30.0, 20.0, 80.0, 30.0, 20.0, 210.0, 230.0, 20.0, 320.0, 70.0, 20.0, 30.0, 40.0, 130.0, 170.0, 70.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 110.0, 0.0, 10.0, 50.0, 80.0, 70.0, 90.0, 30.0, 300.0, 500.0, 380.0, 30.0, 40.0, 300.0, 350.0, 170.0, 120.0, 50.0, 170.0, 40.0, 70.0, 90.0, 110.0, 0.0, 580.0, 60.0, 40.0, 10.0, 40.0, 290.0, 30.0, 30.0, 180.0, 30.0, 0.0, 190.0, 30.0, 150.0, 170.0, 70.0, 0.0, 130.0, 40.0, 10.0, 120.0, 40.0, 10.0, 25.0, 190.0, 0.0, 10.0, 100.0, 40.0, -50.0, 30.0, 150.0, -110.0, 40.0, 10.0, 30.0, 10.0, 480.0, 620.0, 120.0, 100.0, 500.0, 100.0, 110.0, 230.0, 240.0, 90.0, 240.0, 40.0, 400.0, 100.0, 90.0, 50.0, 20.0, 0.0, 50.0, 70.0, 90.0, 60.0, 400.0, 30.0, 90.0, 430.0, 110.0, 50.0, 100.0, 0.0, 0.0, 30.0, -40.0, 50.0, 30.0, 580.0, 120.0, 140.0, 400.0, 10.0, 0.0, -20.0, 10.0, 0.0, 70.0, 170.0, -50.0, 0.0, 670.0, 160.0, 70.0, 330.0, 240.0, 0.0, 30.0, 30.0, 30.0, 100.0, 50.0, 180.0, 60.0, 370.0, 40.0, 330.0, 10.0, 290.0, 490.0, 270.0, 90.0, 140.0, 110.0, 0.0, 10.0, 30.0, 10.0, 0.0, 260.0, 0.0, 50.0, 220.0, 20.0, 130.0, 120.0, 110.0, 20.0, -20.0, 210.0, 80.0, 540.0, 20.0, 20.0, 0.0, 40.0, 70.0, 260.0, 110.0, 390.0, 745.0, 60.0, 150.0, 110.0, -100.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 40.0, 110.0, 0.0, 10.0, 10.0, 20.0, 30.0, 50.0, 80.0, 0.0, 90.0, 20.0, 190.0, 30.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 50.0, 150.0, 110.0, 510.0, 210.0, 320.0, 20.0, 130.0, 50.0, 80.0, 100.0, 70.0, 130.0, 0.0, 80.0, 20.0, 310.0, 120.0, 0.0, -30.0, 0.0, 180.0, 220.0, -50.0, 400.0, 130.0, 70.0, 40.0, 140.0, 110.0, 330.0, 470.0, 340.0, 90.0, 330.0, 380.0, 110.0, 50.0, 80.0, 60.0, 60.0, 170.0, 630.0, 40.0, 40.0, 180.0, 60.0, 280.0, 30.0, 20.0, 40.0, 290.0, 20.0, 30.0, 200.0, 30.0, 330.0, 200.0, 70.0, 220.0, 160.0, 0.0, 10.0, 20.0, -10.0, 700.0, -50.0, 50.0, 10.0, 110.0, 300.0, 330.0, 420.0, 90.0, 110.0, 30.0, 170.0, 40.0, 0.0, 40.0, 290.0, 0.0, 50.0, 350.0, 30.0, 40.0, 20.0, 270.0, 250.0, 40.0, 100.0, 0.0, 140.0, 40.0, 40.0, 140.0, 100.0, 190.0, 150.0, 170.0, 50.0, 350.0, 30.0, 150.0, 200.0, 240.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 210.0, 40.0, -150.0, 30.0, 30.0, 0.0, 290.0, 0.0, 50.0, 160.0, 50.0, 260.0, 10.0, 260.0, 70.0, 10.0, 100.0, 210.0, 330.0, 0.0, 180.0, 120.0, 280.0, 110.0, 100.0, 150.0, 40.0, 30.0, -5.0, 60.0, 15.0, 10.0, 30.0, 10.0, 90.0, 220.0, 40.0, 20.0, 10.0, 30.0, 300.0, 100.0, 80.0, 280.0, 120.0, 30.0, 80.0, 90.0, 370.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 40.0, 290.0, 30.0, 0.0, -50.0, 40.0, 260.0, 0.0, -100.0, 10.0, 0.0, 30.0, 750.0, 80.0, -40.0, 20.0, 0.0, 90.0, 50.0, 50.0, 40.0, 70.0, 40.0, 10.0, 0.0, 40.0, 90.0, 10.0, 120.0, 30.0, 380.0, 380.0, 80.0, 190.0, 170.0, 70.0, 30.0, 40.0, 370.0, 80.0, 40.0, 60.0, 190.0, 160.0, 450.0, 10.0, -10.0, -10.0, 10.0, 0.0, -10.0, 50.0, 580.0, 340.0, 50.0, -50.0, 140.0, 80.0, 40.0, 100.0, 110.0, 930.0, 380.0, 175.0, 500.0, 440.0, 70.0, 360.0, 340.0, 230.0, 60.0, 250.0, 150.0, 50.0, 90.0, 30.0, 230.0, 260.0, 50.0, 170.0, 250.0, 100.0, 80.0, 10.0, 160.0, 30.0, 290.0, 10.0, 60.0, -20.0, 190.0, 90.0, 20.0, 40.0, 50.0, 10.0, 180.0, -40.0, 180.0, 20.0, 440.0, 20.0, 30.0, 280.0, 80.0, 10.0, 40.0, 90.0, 30.0, 50.0, 0.0, 110.0, 20.0, 0.0, 120.0, 710.0, 40.0, 190.0, 50.0, 50.0, 70.0, 70.0, 660.0, 60.0, 570.0, 50.0, 70.0, 10.0, 40.0, 420.0, 40.0, 330.0, 360.0, 130.0, 110.0, -40.0, 90.0, 320.0, 90.0, 70.0, 50.0, 240.0, 20.0, 160.0, 220.0, 20.0, 50.0, 100.0, 110.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 380.0, 10.0, 20.0, -340.0, 0.0, 80.0, 110.0, 40.0, 250.0, 690.0, 70.0, 90.0, 360.0, 130.0, 30.0, 350.0, 35.0, 30.0, 20.0, 0.0, 0.0, 300.0, 260.0, 120.0, 20.0, 30.0, 10.0, 380.0, 20.0, 380.0, 30.0, 130.0, 90.0, 40.0, 40.0, 20.0, 10.0, 200.0, 450.0, -75.0, 660.0, 50.0, 30.0, 10.0, 0.0, 70.0, 330.0, 60.0, 150.0, 40.0, 410.0, 450.0, 60.0, 30.0, 20.0, 20.0, 20.0, 0.0, 70.0, 160.0, -10.0, 100.0, 150.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 110.0, -50.0, 80.0, 410.0, 80.0, 590.0, 20.0, 60.0, 30.0, 50.0, 0.0, 0.0, 460.0, -10.0, 40.0, 30.0, 30.0, 100.0, 180.0, 60.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 50.0, 30.0, 30.0, 310.0, 60.0, 20.0, 100.0, 170.0, 500.0, 30.0, 60.0, 210.0, 440.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0204047514550383, "mean_inference_ms": 2.0599626773292097, "mean_action_processing_ms": 0.5440026094706379, "mean_env_wait_ms": 1.7490852854080492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026608943939208984, "StateBufferConnector_ms": 0.013066768646240234, "ViewRequirementAgentConnector_ms": 0.4944283962249756}, "num_episodes": 22, "episode_return_max": 2895.0, "episode_return_min": 180.0, "episode_return_mean": 1182.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.063687065522338, "num_env_steps_trained_throughput_per_sec": 20.063687065522338, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 3960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3960000, "timers": {"training_iteration_time_ms": 372700.946, "restore_workers_time_ms": 0.018, "training_step_time_ms": 372700.877, "sample_time_ms": 2874.262, "learn_time_ms": 369797.601, "learn_throughput": 10.817, "synch_weights_time_ms": 14.493}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "done": false, "training_iteration": 99, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-45-48", "timestamp": 1717260348, "time_this_iter_s": 199.3745470046997, "time_total_s": 51163.98904418945, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c19dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51163.98904418945, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 22.096466431095404, "ram_util_percent": 81.34911660777387}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9996844101447266, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006346784468915778, "vf_loss": 7.642071510351504, "vf_explained_var": 0.00017810455018592972, "kl": Infinity, "entropy": 0.24810924441161883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 934305.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "env_runners": {"episode_reward_max": 2895.0, "episode_reward_min": 180.0, "episode_reward_mean": 1181.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 118.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [930.0, 1350.0, 1800.0, 700.0, 560.0, 1350.0, 1445.0, 1570.0, 1410.0, 240.0, 1720.0, 1280.0, 1800.0, 1440.0, 1390.0, 1330.0, 1145.0, 700.0, 860.0, 220.0, 1570.0, 1470.0, 1260.0, 810.0, 545.0, 1210.0, 1770.0, 930.0, 1240.0, 1270.0, 1430.0, 1090.0, 1770.0, 730.0, 1100.0, 1835.0, 220.0, 520.0, 460.0, 1620.0, 900.0, 1980.0, 1960.0, 1000.0, 1250.0, 1880.0, 820.0, 1240.0, 1260.0, 860.0, 500.0, 1430.0, 900.0, 760.0, 1220.0, 450.0, 1010.0, 390.0, 1520.0, 1430.0, 950.0, 2895.0, 1630.0, 1340.0, 740.0, 1200.0, 1170.0, 1810.0, 1470.0, 1280.0, 780.0, 930.0, 1045.0, 1550.0, 1565.0, 1150.0, 820.0, 310.0, 1380.0, 890.0, 180.0, 1900.0, 1250.0, 925.0, 570.0, 1330.0, 1355.0, 1300.0, 1300.0, 1360.0, 1170.0, 1280.0, 1050.0, 880.0, 1270.0, 1100.0, 1800.0, 2350.0, 490.0, 1560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 30.0, 190.0, 10.0, 250.0, 40.0, 120.0, 90.0, 60.0, 100.0, 660.0, 20.0, 270.0, 90.0, -20.0, 0.0, 40.0, 50.0, 10.0, 230.0, 540.0, 130.0, 80.0, 80.0, 20.0, 310.0, -30.0, 200.0, 430.0, 40.0, 90.0, 20.0, 90.0, 20.0, 80.0, 20.0, 10.0, 120.0, 220.0, 30.0, 50.0, 20.0, 380.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 190.0, 30.0, 160.0, 90.0, 320.0, 70.0, 290.0, 60.0, 120.0, 70.0, 500.0, 270.0, -20.0, 140.0, 65.0, 60.0, 300.0, 50.0, 10.0, 210.0, 10.0, 460.0, 70.0, 30.0, 80.0, 30.0, 160.0, 300.0, 220.0, 20.0, 130.0, 100.0, 20.0, 360.0, 350.0, 270.0, 110.0, 50.0, 0.0, 40.0, 30.0, 30.0, 30.0, 10.0, 80.0, 20.0, 0.0, 0.0, 0.0, 140.0, 110.0, 290.0, 190.0, 210.0, 440.0, 40.0, 110.0, 40.0, 150.0, 260.0, 100.0, 40.0, 40.0, 40.0, 80.0, 410.0, 240.0, 10.0, 60.0, 80.0, 110.0, 280.0, 150.0, 410.0, 400.0, 70.0, -30.0, 320.0, 10.0, -20.0, 510.0, 140.0, 250.0, 40.0, 110.0, 40.0, 0.0, 350.0, 20.0, 10.0, 10.0, 70.0, 230.0, 50.0, 300.0, 570.0, 170.0, 30.0, -50.0, 70.0, 60.0, 230.0, 190.0, 60.0, 130.0, 50.0, 300.0, 10.0, 230.0, -25.0, 20.0, 160.0, 410.0, 80.0, 30.0, 340.0, 60.0, 20.0, 50.0, 40.0, 20.0, 30.0, 20.0, 80.0, 30.0, 20.0, 210.0, 230.0, 20.0, 320.0, 70.0, 20.0, 30.0, 40.0, 130.0, 170.0, 70.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 110.0, 0.0, 10.0, 50.0, 80.0, 70.0, 90.0, 30.0, 300.0, 500.0, 380.0, 30.0, 40.0, 300.0, 350.0, 170.0, 120.0, 50.0, 170.0, 40.0, 70.0, 90.0, 110.0, 0.0, 580.0, 60.0, 40.0, 10.0, 40.0, 290.0, 30.0, 30.0, 180.0, 30.0, 0.0, 190.0, 30.0, 150.0, 170.0, 70.0, 0.0, 130.0, 40.0, 10.0, 120.0, 40.0, 10.0, 25.0, 190.0, 0.0, 10.0, 100.0, 40.0, -50.0, 30.0, 150.0, -110.0, 40.0, 10.0, 30.0, 10.0, 480.0, 620.0, 120.0, 100.0, 500.0, 100.0, 110.0, 230.0, 240.0, 90.0, 240.0, 40.0, 400.0, 100.0, 90.0, 50.0, 20.0, 0.0, 50.0, 70.0, 90.0, 60.0, 400.0, 30.0, 90.0, 430.0, 110.0, 50.0, 100.0, 0.0, 0.0, 30.0, -40.0, 50.0, 30.0, 580.0, 120.0, 140.0, 400.0, 10.0, 0.0, -20.0, 10.0, 0.0, 70.0, 170.0, -50.0, 0.0, 670.0, 160.0, 70.0, 330.0, 240.0, 0.0, 30.0, 30.0, 30.0, 100.0, 50.0, 180.0, 60.0, 370.0, 40.0, 330.0, 10.0, 290.0, 490.0, 270.0, 90.0, 140.0, 110.0, 0.0, 10.0, 30.0, 10.0, 0.0, 260.0, 0.0, 50.0, 220.0, 20.0, 130.0, 120.0, 110.0, 20.0, -20.0, 210.0, 80.0, 540.0, 20.0, 20.0, 0.0, 40.0, 70.0, 260.0, 110.0, 390.0, 745.0, 60.0, 150.0, 110.0, -100.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 40.0, 110.0, 0.0, 10.0, 10.0, 20.0, 30.0, 50.0, 80.0, 0.0, 90.0, 20.0, 190.0, 30.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 50.0, 150.0, 110.0, 510.0, 210.0, 320.0, 20.0, 130.0, 50.0, 80.0, 100.0, 70.0, 130.0, 0.0, 80.0, 20.0, 310.0, 120.0, 0.0, -30.0, 0.0, 180.0, 220.0, -50.0, 400.0, 130.0, 70.0, 40.0, 140.0, 110.0, 330.0, 470.0, 340.0, 90.0, 330.0, 380.0, 110.0, 50.0, 80.0, 60.0, 60.0, 170.0, 630.0, 40.0, 40.0, 180.0, 60.0, 280.0, 30.0, 20.0, 40.0, 290.0, 20.0, 30.0, 200.0, 30.0, 330.0, 200.0, 70.0, 220.0, 160.0, 0.0, 10.0, 20.0, -10.0, 700.0, -50.0, 50.0, 10.0, 110.0, 300.0, 330.0, 420.0, 90.0, 110.0, 30.0, 170.0, 40.0, 0.0, 40.0, 290.0, 0.0, 50.0, 350.0, 30.0, 40.0, 20.0, 270.0, 250.0, 40.0, 100.0, 0.0, 140.0, 40.0, 40.0, 140.0, 100.0, 190.0, 150.0, 170.0, 50.0, 350.0, 30.0, 150.0, 200.0, 240.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 210.0, 40.0, -150.0, 30.0, 30.0, 0.0, 290.0, 0.0, 50.0, 160.0, 50.0, 260.0, 10.0, 260.0, 70.0, 10.0, 100.0, 210.0, 330.0, 0.0, 180.0, 120.0, 280.0, 110.0, 100.0, 150.0, 40.0, 30.0, -5.0, 60.0, 15.0, 10.0, 30.0, 10.0, 90.0, 220.0, 40.0, 20.0, 10.0, 30.0, 300.0, 100.0, 80.0, 280.0, 120.0, 30.0, 80.0, 90.0, 370.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 40.0, 290.0, 30.0, 0.0, -50.0, 40.0, 260.0, 0.0, -100.0, 10.0, 0.0, 30.0, 750.0, 80.0, -40.0, 20.0, 0.0, 90.0, 50.0, 50.0, 40.0, 70.0, 40.0, 10.0, 0.0, 40.0, 90.0, 10.0, 120.0, 30.0, 380.0, 380.0, 80.0, 190.0, 170.0, 70.0, 30.0, 40.0, 370.0, 80.0, 40.0, 60.0, 190.0, 160.0, 450.0, 10.0, -10.0, -10.0, 10.0, 0.0, -10.0, 50.0, 580.0, 340.0, 50.0, -50.0, 140.0, 80.0, 40.0, 100.0, 110.0, 930.0, 380.0, 175.0, 500.0, 440.0, 70.0, 360.0, 340.0, 230.0, 60.0, 250.0, 150.0, 50.0, 90.0, 30.0, 230.0, 260.0, 50.0, 170.0, 250.0, 100.0, 80.0, 10.0, 160.0, 30.0, 290.0, 10.0, 60.0, -20.0, 190.0, 90.0, 20.0, 40.0, 50.0, 10.0, 180.0, -40.0, 180.0, 20.0, 440.0, 20.0, 30.0, 280.0, 80.0, 10.0, 40.0, 90.0, 30.0, 50.0, 0.0, 110.0, 20.0, 0.0, 120.0, 710.0, 40.0, 190.0, 50.0, 50.0, 70.0, 70.0, 660.0, 60.0, 570.0, 50.0, 70.0, 10.0, 40.0, 420.0, 40.0, 330.0, 360.0, 130.0, 110.0, -40.0, 90.0, 320.0, 90.0, 70.0, 50.0, 240.0, 20.0, 160.0, 220.0, 20.0, 50.0, 100.0, 110.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 380.0, 10.0, 20.0, -340.0, 0.0, 80.0, 110.0, 40.0, 250.0, 690.0, 70.0, 90.0, 360.0, 130.0, 30.0, 350.0, 35.0, 30.0, 20.0, 0.0, 0.0, 300.0, 260.0, 120.0, 20.0, 30.0, 10.0, 380.0, 20.0, 380.0, 30.0, 130.0, 90.0, 40.0, 40.0, 20.0, 10.0, 200.0, 450.0, -75.0, 660.0, 50.0, 30.0, 10.0, 0.0, 70.0, 330.0, 60.0, 150.0, 40.0, 410.0, 450.0, 60.0, 30.0, 20.0, 20.0, 20.0, 0.0, 70.0, 160.0, -10.0, 100.0, 150.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 110.0, -50.0, 80.0, 410.0, 80.0, 590.0, 20.0, 60.0, 30.0, 50.0, 0.0, 0.0, 460.0, -10.0, 40.0, 30.0, 30.0, 100.0, 180.0, 60.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 50.0, 30.0, 30.0, 310.0, 60.0, 20.0, 100.0, 170.0, 500.0, 30.0, 60.0, 210.0, 440.0, 50.0, 160.0, 10.0, 350.0, 0.0, 0.0, -40.0, -50.0, 710.0, 60.0, 10.0, 20.0, 20.0, 35.0, 30.0, 280.0, 180.0, 50.0, 160.0, 140.0, 0.0, 190.0, 40.0, 30.0, 0.0, 170.0, 60.0, 30.0, 20.0, 30.0, 120.0, 0.0, 50.0, 330.0, 110.0, 360.0, 40.0, 60.0, 20.0, 240.0, 270.0, 110.0, 40.0, 200.0, 130.0, -35.0, 30.0, 20.0, 600.0, -10.0, 170.0, 10.0, 310.0, 30.0, 60.0, 30.0, 130.0, 270.0, 120.0, 170.0, 80.0, 40.0, 180.0, 70.0, -100.0, 40.0, 30.0, 270.0, 170.0, 520.0, -10.0, 170.0, 20.0, 410.0, -20.0, 60.0, 230.0, 400.0, 70.0, 30.0, 50.0, 80.0, 70.0, 30.0, -120.0, 10.0, 50.0, -40.0, 10.0, 1030.0, 30.0, 40.0, 20.0, 0.0, 400.0, 20.0, 290.0, 40.0, 10.0, 430.0, -10.0, 0.0, 70.0, 460.0, 20.0, -20.0, 40.0, 210.0, 10.0, 270.0, 20.0, 150.0, 30.0, 90.0, 10.0, 0.0, 310.0, 160.0, 80.0, 30.0, 60.0, 80.0, 20.0, 180.0, 40.0, 370.0, 390.0, 120.0, 10.0, 0.0, -110.0, 50.0, -40.0, 90.0, 80.0, 160.0, 160.0, 600.0, 30.0, 80.0, 340.0, 100.0, 170.0, 190.0, 500.0, 60.0, 120.0, 190.0, 10.0, 120.0, 1010.0, 230.0, 290.0, 100.0, 150.0, 0.0, 180.0, 30.0, 320.0, 40.0, 200.0, 20.0, 0.0, 50.0, 20.0, 90.0, 0.0, 60.0, 10.0, 40.0, 40.0, 70.0, 290.0, 20.0, 220.0, 220.0, 40.0, 350.0, 20.0, 290.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0164125237953265, "mean_inference_ms": 2.0578755828432387, "mean_action_processing_ms": 0.5430553008338724, "mean_env_wait_ms": 1.7464184165491168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02721381187438965, "StateBufferConnector_ms": 0.01285552978515625, "ViewRequirementAgentConnector_ms": 0.4797821044921875}, "num_episodes": 18, "episode_return_max": 2895.0, "episode_return_min": 180.0, "episode_return_mean": 1181.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.1442223328524, "num_env_steps_trained_throughput_per_sec": 19.1442223328524, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 4000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000000, "timers": {"training_iteration_time_ms": 277603.407, "restore_workers_time_ms": 0.019, "training_step_time_ms": 277603.339, "sample_time_ms": 2861.977, "learn_time_ms": 274711.055, "learn_throughput": 14.561, "synch_weights_time_ms": 14.679}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "done": false, "training_iteration": 100, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-49-17", "timestamp": 1717260557, "time_this_iter_s": 208.96693396568298, "time_total_s": 51372.955978155136, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321bff040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51372.955978155136, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 26.25892255892256, "ram_util_percent": 82.79191919191919}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3651347297956895, "cur_kl_coeff": 0.360406494140625, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.808358964523949, "policy_loss": -0.006689691493194451, "vf_loss": 6.813515916850747, "vf_explained_var": 0.0004964815986296113, "kl": 0.004252795208720564, "entropy": 0.2430332253995541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 943695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "env_runners": {"episode_reward_max": 2895.0, "episode_reward_min": 180.0, "episode_reward_mean": 1165.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -520.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 116.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [810.0, 545.0, 1210.0, 1770.0, 930.0, 1240.0, 1270.0, 1430.0, 1090.0, 1770.0, 730.0, 1100.0, 1835.0, 220.0, 520.0, 460.0, 1620.0, 900.0, 1980.0, 1960.0, 1000.0, 1250.0, 1880.0, 820.0, 1240.0, 1260.0, 860.0, 500.0, 1430.0, 900.0, 760.0, 1220.0, 450.0, 1010.0, 390.0, 1520.0, 1430.0, 950.0, 2895.0, 1630.0, 1340.0, 740.0, 1200.0, 1170.0, 1810.0, 1470.0, 1280.0, 780.0, 930.0, 1045.0, 1550.0, 1565.0, 1150.0, 820.0, 310.0, 1380.0, 890.0, 180.0, 1900.0, 1250.0, 925.0, 570.0, 1330.0, 1355.0, 1300.0, 1300.0, 1360.0, 1170.0, 1280.0, 1050.0, 880.0, 1270.0, 1100.0, 1800.0, 2350.0, 490.0, 1560.0, 1450.0, 1400.0, 1370.0, 750.0, 190.0, 470.0, 1500.0, 1100.0, 1180.0, 550.0, 1150.0, 1270.0, 570.0, 1665.0, 1070.0, 1335.0, 1410.0, 1290.0, 1700.0, 670.0, 1430.0, 835.0, 1530.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 0.0, 190.0, 30.0, 150.0, 170.0, 70.0, 0.0, 130.0, 40.0, 10.0, 120.0, 40.0, 10.0, 25.0, 190.0, 0.0, 10.0, 100.0, 40.0, -50.0, 30.0, 150.0, -110.0, 40.0, 10.0, 30.0, 10.0, 480.0, 620.0, 120.0, 100.0, 500.0, 100.0, 110.0, 230.0, 240.0, 90.0, 240.0, 40.0, 400.0, 100.0, 90.0, 50.0, 20.0, 0.0, 50.0, 70.0, 90.0, 60.0, 400.0, 30.0, 90.0, 430.0, 110.0, 50.0, 100.0, 0.0, 0.0, 30.0, -40.0, 50.0, 30.0, 580.0, 120.0, 140.0, 400.0, 10.0, 0.0, -20.0, 10.0, 0.0, 70.0, 170.0, -50.0, 0.0, 670.0, 160.0, 70.0, 330.0, 240.0, 0.0, 30.0, 30.0, 30.0, 100.0, 50.0, 180.0, 60.0, 370.0, 40.0, 330.0, 10.0, 290.0, 490.0, 270.0, 90.0, 140.0, 110.0, 0.0, 10.0, 30.0, 10.0, 0.0, 260.0, 0.0, 50.0, 220.0, 20.0, 130.0, 120.0, 110.0, 20.0, -20.0, 210.0, 80.0, 540.0, 20.0, 20.0, 0.0, 40.0, 70.0, 260.0, 110.0, 390.0, 745.0, 60.0, 150.0, 110.0, -100.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 40.0, 110.0, 0.0, 10.0, 10.0, 20.0, 30.0, 50.0, 80.0, 0.0, 90.0, 20.0, 190.0, 30.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 50.0, 150.0, 110.0, 510.0, 210.0, 320.0, 20.0, 130.0, 50.0, 80.0, 100.0, 70.0, 130.0, 0.0, 80.0, 20.0, 310.0, 120.0, 0.0, -30.0, 0.0, 180.0, 220.0, -50.0, 400.0, 130.0, 70.0, 40.0, 140.0, 110.0, 330.0, 470.0, 340.0, 90.0, 330.0, 380.0, 110.0, 50.0, 80.0, 60.0, 60.0, 170.0, 630.0, 40.0, 40.0, 180.0, 60.0, 280.0, 30.0, 20.0, 40.0, 290.0, 20.0, 30.0, 200.0, 30.0, 330.0, 200.0, 70.0, 220.0, 160.0, 0.0, 10.0, 20.0, -10.0, 700.0, -50.0, 50.0, 10.0, 110.0, 300.0, 330.0, 420.0, 90.0, 110.0, 30.0, 170.0, 40.0, 0.0, 40.0, 290.0, 0.0, 50.0, 350.0, 30.0, 40.0, 20.0, 270.0, 250.0, 40.0, 100.0, 0.0, 140.0, 40.0, 40.0, 140.0, 100.0, 190.0, 150.0, 170.0, 50.0, 350.0, 30.0, 150.0, 200.0, 240.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 210.0, 40.0, -150.0, 30.0, 30.0, 0.0, 290.0, 0.0, 50.0, 160.0, 50.0, 260.0, 10.0, 260.0, 70.0, 10.0, 100.0, 210.0, 330.0, 0.0, 180.0, 120.0, 280.0, 110.0, 100.0, 150.0, 40.0, 30.0, -5.0, 60.0, 15.0, 10.0, 30.0, 10.0, 90.0, 220.0, 40.0, 20.0, 10.0, 30.0, 300.0, 100.0, 80.0, 280.0, 120.0, 30.0, 80.0, 90.0, 370.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 40.0, 290.0, 30.0, 0.0, -50.0, 40.0, 260.0, 0.0, -100.0, 10.0, 0.0, 30.0, 750.0, 80.0, -40.0, 20.0, 0.0, 90.0, 50.0, 50.0, 40.0, 70.0, 40.0, 10.0, 0.0, 40.0, 90.0, 10.0, 120.0, 30.0, 380.0, 380.0, 80.0, 190.0, 170.0, 70.0, 30.0, 40.0, 370.0, 80.0, 40.0, 60.0, 190.0, 160.0, 450.0, 10.0, -10.0, -10.0, 10.0, 0.0, -10.0, 50.0, 580.0, 340.0, 50.0, -50.0, 140.0, 80.0, 40.0, 100.0, 110.0, 930.0, 380.0, 175.0, 500.0, 440.0, 70.0, 360.0, 340.0, 230.0, 60.0, 250.0, 150.0, 50.0, 90.0, 30.0, 230.0, 260.0, 50.0, 170.0, 250.0, 100.0, 80.0, 10.0, 160.0, 30.0, 290.0, 10.0, 60.0, -20.0, 190.0, 90.0, 20.0, 40.0, 50.0, 10.0, 180.0, -40.0, 180.0, 20.0, 440.0, 20.0, 30.0, 280.0, 80.0, 10.0, 40.0, 90.0, 30.0, 50.0, 0.0, 110.0, 20.0, 0.0, 120.0, 710.0, 40.0, 190.0, 50.0, 50.0, 70.0, 70.0, 660.0, 60.0, 570.0, 50.0, 70.0, 10.0, 40.0, 420.0, 40.0, 330.0, 360.0, 130.0, 110.0, -40.0, 90.0, 320.0, 90.0, 70.0, 50.0, 240.0, 20.0, 160.0, 220.0, 20.0, 50.0, 100.0, 110.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 380.0, 10.0, 20.0, -340.0, 0.0, 80.0, 110.0, 40.0, 250.0, 690.0, 70.0, 90.0, 360.0, 130.0, 30.0, 350.0, 35.0, 30.0, 20.0, 0.0, 0.0, 300.0, 260.0, 120.0, 20.0, 30.0, 10.0, 380.0, 20.0, 380.0, 30.0, 130.0, 90.0, 40.0, 40.0, 20.0, 10.0, 200.0, 450.0, -75.0, 660.0, 50.0, 30.0, 10.0, 0.0, 70.0, 330.0, 60.0, 150.0, 40.0, 410.0, 450.0, 60.0, 30.0, 20.0, 20.0, 20.0, 0.0, 70.0, 160.0, -10.0, 100.0, 150.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 110.0, -50.0, 80.0, 410.0, 80.0, 590.0, 20.0, 60.0, 30.0, 50.0, 0.0, 0.0, 460.0, -10.0, 40.0, 30.0, 30.0, 100.0, 180.0, 60.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 50.0, 30.0, 30.0, 310.0, 60.0, 20.0, 100.0, 170.0, 500.0, 30.0, 60.0, 210.0, 440.0, 50.0, 160.0, 10.0, 350.0, 0.0, 0.0, -40.0, -50.0, 710.0, 60.0, 10.0, 20.0, 20.0, 35.0, 30.0, 280.0, 180.0, 50.0, 160.0, 140.0, 0.0, 190.0, 40.0, 30.0, 0.0, 170.0, 60.0, 30.0, 20.0, 30.0, 120.0, 0.0, 50.0, 330.0, 110.0, 360.0, 40.0, 60.0, 20.0, 240.0, 270.0, 110.0, 40.0, 200.0, 130.0, -35.0, 30.0, 20.0, 600.0, -10.0, 170.0, 10.0, 310.0, 30.0, 60.0, 30.0, 130.0, 270.0, 120.0, 170.0, 80.0, 40.0, 180.0, 70.0, -100.0, 40.0, 30.0, 270.0, 170.0, 520.0, -10.0, 170.0, 20.0, 410.0, -20.0, 60.0, 230.0, 400.0, 70.0, 30.0, 50.0, 80.0, 70.0, 30.0, -120.0, 10.0, 50.0, -40.0, 10.0, 1030.0, 30.0, 40.0, 20.0, 0.0, 400.0, 20.0, 290.0, 40.0, 10.0, 430.0, -10.0, 0.0, 70.0, 460.0, 20.0, -20.0, 40.0, 210.0, 10.0, 270.0, 20.0, 150.0, 30.0, 90.0, 10.0, 0.0, 310.0, 160.0, 80.0, 30.0, 60.0, 80.0, 20.0, 180.0, 40.0, 370.0, 390.0, 120.0, 10.0, 0.0, -110.0, 50.0, -40.0, 90.0, 80.0, 160.0, 160.0, 600.0, 30.0, 80.0, 340.0, 100.0, 170.0, 190.0, 500.0, 60.0, 120.0, 190.0, 10.0, 120.0, 1010.0, 230.0, 290.0, 100.0, 150.0, 0.0, 180.0, 30.0, 320.0, 40.0, 200.0, 20.0, 0.0, 50.0, 20.0, 90.0, 0.0, 60.0, 10.0, 40.0, 40.0, 70.0, 290.0, 20.0, 220.0, 220.0, 40.0, 350.0, 20.0, 290.0, 170.0, 130.0, 530.0, 50.0, 280.0, 90.0, 30.0, 10.0, 100.0, 60.0, 190.0, 150.0, 370.0, 20.0, 80.0, 40.0, 60.0, 60.0, 190.0, 240.0, 270.0, 220.0, 50.0, 70.0, 170.0, 370.0, -30.0, 40.0, 180.0, 30.0, 330.0, 0.0, 330.0, 30.0, 230.0, -520.0, 110.0, 50.0, 90.0, 100.0, 10.0, 30.0, 0.0, 20.0, 40.0, 50.0, 40.0, 0.0, 0.0, 0.0, 220.0, 120.0, 40.0, 10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 70.0, 130.0, 160.0, 630.0, 40.0, 70.0, 50.0, 130.0, 180.0, 410.0, 110.0, 300.0, 20.0, 50.0, 210.0, -10.0, 0.0, 10.0, 0.0, 330.0, 10.0, 50.0, 50.0, 50.0, 50.0, 0.0, 320.0, 180.0, 140.0, 30.0, 30.0, 50.0, 170.0, 30.0, 20.0, 10.0, 100.0, 20.0, 90.0, 60.0, 170.0, 130.0, 30.0, 50.0, 180.0, 390.0, 0.0, 120.0, 20.0, 80.0, 120.0, 20.0, 0.0, 50.0, 20.0, 510.0, 460.0, 40.0, -30.0, 10.0, 30.0, 180.0, 20.0, 30.0, 30.0, 0.0, 60.0, 140.0, 70.0, -25.0, 540.0, 60.0, 100.0, 20.0, 180.0, 260.0, 40.0, -10.0, 500.0, 20.0, 360.0, 40.0, 30.0, -10.0, 20.0, 40.0, 310.0, 240.0, 20.0, 25.0, 370.0, 280.0, 270.0, 20.0, 20.0, 210.0, 10.0, 10.0, 120.0, 140.0, 10.0, -10.0, 440.0, 30.0, 290.0, 10.0, 170.0, 40.0, 290.0, 290.0, 60.0, 140.0, 290.0, 170.0, 90.0, 30.0, 80.0, 30.0, 110.0, 510.0, 400.0, 80.0, 40.0, 80.0, 140.0, 100.0, 80.0, 40.0, 230.0, 80.0, 40.0, 0.0, 30.0, 0.0, 160.0, 250.0, 0.0, 10.0, 100.0, 110.0, 10.0, -30.0, 140.0, 170.0, 260.0, 30.0, 330.0, 380.0, 30.0, -10.0, 50.0, 75.0, 55.0, -15.0, 510.0, 30.0, 110.0, 30.0, 0.0, 100.0, 210.0, 40.0, 30.0, 30.0, 90.0, 440.0, 100.0, 190.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.010976522638618, "mean_inference_ms": 2.054937877107885, "mean_action_processing_ms": 0.541881825047333, "mean_env_wait_ms": 1.7429160337084655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027454137802124023, "StateBufferConnector_ms": 0.013380765914916992, "ViewRequirementAgentConnector_ms": 0.48256349563598633}, "num_episodes": 23, "episode_return_max": 2895.0, "episode_return_min": 180.0, "episode_return_mean": 1165.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.381438870055476, "num_env_steps_trained_throughput_per_sec": 19.381438870055476, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 4040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4040000, "timers": {"training_iteration_time_ms": 224875.35, "restore_workers_time_ms": 0.019, "training_step_time_ms": 224875.281, "sample_time_ms": 2872.243, "learn_time_ms": 221973.732, "learn_throughput": 18.02, "synch_weights_time_ms": 14.494}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "done": false, "training_iteration": 101, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-52-44", "timestamp": 1717260764, "time_this_iter_s": 206.40993881225586, "time_total_s": 51579.36591696739, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a61ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51579.36591696739, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 26.29419795221843, "ram_util_percent": 82.9382252559727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9375785443729485, "cur_kl_coeff": 0.1802032470703125, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004716285388654889, "vf_loss": 6.941190292837774, "vf_explained_var": 0.0011912907464816547, "kl": Infinity, "entropy": 0.2412327972321084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 953085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "env_runners": {"episode_reward_max": 2895.0, "episode_reward_min": -1480.0, "episode_reward_mean": 1147.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -2440.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 114.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1980.0, 1960.0, 1000.0, 1250.0, 1880.0, 820.0, 1240.0, 1260.0, 860.0, 500.0, 1430.0, 900.0, 760.0, 1220.0, 450.0, 1010.0, 390.0, 1520.0, 1430.0, 950.0, 2895.0, 1630.0, 1340.0, 740.0, 1200.0, 1170.0, 1810.0, 1470.0, 1280.0, 780.0, 930.0, 1045.0, 1550.0, 1565.0, 1150.0, 820.0, 310.0, 1380.0, 890.0, 180.0, 1900.0, 1250.0, 925.0, 570.0, 1330.0, 1355.0, 1300.0, 1300.0, 1360.0, 1170.0, 1280.0, 1050.0, 880.0, 1270.0, 1100.0, 1800.0, 2350.0, 490.0, 1560.0, 1450.0, 1400.0, 1370.0, 750.0, 190.0, 470.0, 1500.0, 1100.0, 1180.0, 550.0, 1150.0, 1270.0, 570.0, 1665.0, 1070.0, 1335.0, 1410.0, 1290.0, 1700.0, 670.0, 1430.0, 835.0, 1530.0, 990.0, 1555.0, 1130.0, 930.0, 1020.0, 520.0, -1480.0, 1180.0, 1240.0, 920.0, 560.0, 1350.0, 1320.0, 1460.0, 1330.0, 880.0, 1370.0, 1370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-50.0, 400.0, 130.0, 70.0, 40.0, 140.0, 110.0, 330.0, 470.0, 340.0, 90.0, 330.0, 380.0, 110.0, 50.0, 80.0, 60.0, 60.0, 170.0, 630.0, 40.0, 40.0, 180.0, 60.0, 280.0, 30.0, 20.0, 40.0, 290.0, 20.0, 30.0, 200.0, 30.0, 330.0, 200.0, 70.0, 220.0, 160.0, 0.0, 10.0, 20.0, -10.0, 700.0, -50.0, 50.0, 10.0, 110.0, 300.0, 330.0, 420.0, 90.0, 110.0, 30.0, 170.0, 40.0, 0.0, 40.0, 290.0, 0.0, 50.0, 350.0, 30.0, 40.0, 20.0, 270.0, 250.0, 40.0, 100.0, 0.0, 140.0, 40.0, 40.0, 140.0, 100.0, 190.0, 150.0, 170.0, 50.0, 350.0, 30.0, 150.0, 200.0, 240.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 210.0, 40.0, -150.0, 30.0, 30.0, 0.0, 290.0, 0.0, 50.0, 160.0, 50.0, 260.0, 10.0, 260.0, 70.0, 10.0, 100.0, 210.0, 330.0, 0.0, 180.0, 120.0, 280.0, 110.0, 100.0, 150.0, 40.0, 30.0, -5.0, 60.0, 15.0, 10.0, 30.0, 10.0, 90.0, 220.0, 40.0, 20.0, 10.0, 30.0, 300.0, 100.0, 80.0, 280.0, 120.0, 30.0, 80.0, 90.0, 370.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 40.0, 290.0, 30.0, 0.0, -50.0, 40.0, 260.0, 0.0, -100.0, 10.0, 0.0, 30.0, 750.0, 80.0, -40.0, 20.0, 0.0, 90.0, 50.0, 50.0, 40.0, 70.0, 40.0, 10.0, 0.0, 40.0, 90.0, 10.0, 120.0, 30.0, 380.0, 380.0, 80.0, 190.0, 170.0, 70.0, 30.0, 40.0, 370.0, 80.0, 40.0, 60.0, 190.0, 160.0, 450.0, 10.0, -10.0, -10.0, 10.0, 0.0, -10.0, 50.0, 580.0, 340.0, 50.0, -50.0, 140.0, 80.0, 40.0, 100.0, 110.0, 930.0, 380.0, 175.0, 500.0, 440.0, 70.0, 360.0, 340.0, 230.0, 60.0, 250.0, 150.0, 50.0, 90.0, 30.0, 230.0, 260.0, 50.0, 170.0, 250.0, 100.0, 80.0, 10.0, 160.0, 30.0, 290.0, 10.0, 60.0, -20.0, 190.0, 90.0, 20.0, 40.0, 50.0, 10.0, 180.0, -40.0, 180.0, 20.0, 440.0, 20.0, 30.0, 280.0, 80.0, 10.0, 40.0, 90.0, 30.0, 50.0, 0.0, 110.0, 20.0, 0.0, 120.0, 710.0, 40.0, 190.0, 50.0, 50.0, 70.0, 70.0, 660.0, 60.0, 570.0, 50.0, 70.0, 10.0, 40.0, 420.0, 40.0, 330.0, 360.0, 130.0, 110.0, -40.0, 90.0, 320.0, 90.0, 70.0, 50.0, 240.0, 20.0, 160.0, 220.0, 20.0, 50.0, 100.0, 110.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 380.0, 10.0, 20.0, -340.0, 0.0, 80.0, 110.0, 40.0, 250.0, 690.0, 70.0, 90.0, 360.0, 130.0, 30.0, 350.0, 35.0, 30.0, 20.0, 0.0, 0.0, 300.0, 260.0, 120.0, 20.0, 30.0, 10.0, 380.0, 20.0, 380.0, 30.0, 130.0, 90.0, 40.0, 40.0, 20.0, 10.0, 200.0, 450.0, -75.0, 660.0, 50.0, 30.0, 10.0, 0.0, 70.0, 330.0, 60.0, 150.0, 40.0, 410.0, 450.0, 60.0, 30.0, 20.0, 20.0, 20.0, 0.0, 70.0, 160.0, -10.0, 100.0, 150.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 110.0, -50.0, 80.0, 410.0, 80.0, 590.0, 20.0, 60.0, 30.0, 50.0, 0.0, 0.0, 460.0, -10.0, 40.0, 30.0, 30.0, 100.0, 180.0, 60.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 50.0, 30.0, 30.0, 310.0, 60.0, 20.0, 100.0, 170.0, 500.0, 30.0, 60.0, 210.0, 440.0, 50.0, 160.0, 10.0, 350.0, 0.0, 0.0, -40.0, -50.0, 710.0, 60.0, 10.0, 20.0, 20.0, 35.0, 30.0, 280.0, 180.0, 50.0, 160.0, 140.0, 0.0, 190.0, 40.0, 30.0, 0.0, 170.0, 60.0, 30.0, 20.0, 30.0, 120.0, 0.0, 50.0, 330.0, 110.0, 360.0, 40.0, 60.0, 20.0, 240.0, 270.0, 110.0, 40.0, 200.0, 130.0, -35.0, 30.0, 20.0, 600.0, -10.0, 170.0, 10.0, 310.0, 30.0, 60.0, 30.0, 130.0, 270.0, 120.0, 170.0, 80.0, 40.0, 180.0, 70.0, -100.0, 40.0, 30.0, 270.0, 170.0, 520.0, -10.0, 170.0, 20.0, 410.0, -20.0, 60.0, 230.0, 400.0, 70.0, 30.0, 50.0, 80.0, 70.0, 30.0, -120.0, 10.0, 50.0, -40.0, 10.0, 1030.0, 30.0, 40.0, 20.0, 0.0, 400.0, 20.0, 290.0, 40.0, 10.0, 430.0, -10.0, 0.0, 70.0, 460.0, 20.0, -20.0, 40.0, 210.0, 10.0, 270.0, 20.0, 150.0, 30.0, 90.0, 10.0, 0.0, 310.0, 160.0, 80.0, 30.0, 60.0, 80.0, 20.0, 180.0, 40.0, 370.0, 390.0, 120.0, 10.0, 0.0, -110.0, 50.0, -40.0, 90.0, 80.0, 160.0, 160.0, 600.0, 30.0, 80.0, 340.0, 100.0, 170.0, 190.0, 500.0, 60.0, 120.0, 190.0, 10.0, 120.0, 1010.0, 230.0, 290.0, 100.0, 150.0, 0.0, 180.0, 30.0, 320.0, 40.0, 200.0, 20.0, 0.0, 50.0, 20.0, 90.0, 0.0, 60.0, 10.0, 40.0, 40.0, 70.0, 290.0, 20.0, 220.0, 220.0, 40.0, 350.0, 20.0, 290.0, 170.0, 130.0, 530.0, 50.0, 280.0, 90.0, 30.0, 10.0, 100.0, 60.0, 190.0, 150.0, 370.0, 20.0, 80.0, 40.0, 60.0, 60.0, 190.0, 240.0, 270.0, 220.0, 50.0, 70.0, 170.0, 370.0, -30.0, 40.0, 180.0, 30.0, 330.0, 0.0, 330.0, 30.0, 230.0, -520.0, 110.0, 50.0, 90.0, 100.0, 10.0, 30.0, 0.0, 20.0, 40.0, 50.0, 40.0, 0.0, 0.0, 0.0, 220.0, 120.0, 40.0, 10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 70.0, 130.0, 160.0, 630.0, 40.0, 70.0, 50.0, 130.0, 180.0, 410.0, 110.0, 300.0, 20.0, 50.0, 210.0, -10.0, 0.0, 10.0, 0.0, 330.0, 10.0, 50.0, 50.0, 50.0, 50.0, 0.0, 320.0, 180.0, 140.0, 30.0, 30.0, 50.0, 170.0, 30.0, 20.0, 10.0, 100.0, 20.0, 90.0, 60.0, 170.0, 130.0, 30.0, 50.0, 180.0, 390.0, 0.0, 120.0, 20.0, 80.0, 120.0, 20.0, 0.0, 50.0, 20.0, 510.0, 460.0, 40.0, -30.0, 10.0, 30.0, 180.0, 20.0, 30.0, 30.0, 0.0, 60.0, 140.0, 70.0, -25.0, 540.0, 60.0, 100.0, 20.0, 180.0, 260.0, 40.0, -10.0, 500.0, 20.0, 360.0, 40.0, 30.0, -10.0, 20.0, 40.0, 310.0, 240.0, 20.0, 25.0, 370.0, 280.0, 270.0, 20.0, 20.0, 210.0, 10.0, 10.0, 120.0, 140.0, 10.0, -10.0, 440.0, 30.0, 290.0, 10.0, 170.0, 40.0, 290.0, 290.0, 60.0, 140.0, 290.0, 170.0, 90.0, 30.0, 80.0, 30.0, 110.0, 510.0, 400.0, 80.0, 40.0, 80.0, 140.0, 100.0, 80.0, 40.0, 230.0, 80.0, 40.0, 0.0, 30.0, 0.0, 160.0, 250.0, 0.0, 10.0, 100.0, 110.0, 10.0, -30.0, 140.0, 170.0, 260.0, 30.0, 330.0, 380.0, 30.0, -10.0, 50.0, 75.0, 55.0, -15.0, 510.0, 30.0, 110.0, 30.0, 0.0, 100.0, 210.0, 40.0, 30.0, 30.0, 90.0, 440.0, 100.0, 190.0, 300.0, 30.0, 40.0, 10.0, 100.0, 60.0, 20.0, 30.0, 0.0, 120.0, 580.0, 160.0, 60.0, 370.0, 100.0, 60.0, -45.0, 510.0, 120.0, 50.0, 170.0, 290.0, 60.0, 100.0, 190.0, 0.0, 230.0, 20.0, 60.0, 100.0, 80.0, 150.0, 80.0, 0.0, 100.0, 310.0, 100.0, 10.0, 50.0, 40.0, 90.0, 270.0, 300.0, 80.0, 40.0, 100.0, 130.0, 30.0, 0.0, 30.0, 40.0, 0.0, 80.0, 280.0, 40.0, 10.0, 40.0, 20.0, 40.0, 10.0, 0.0, 50.0, 0.0, 190.0, 50.0, 120.0, 10.0, -2440.0, 290.0, 160.0, 90.0, 210.0, 100.0, 120.0, 485.0, 190.0, -30.0, 20.0, 60.0, 20.0, 5.0, 20.0, 150.0, 310.0, 70.0, 70.0, 50.0, 450.0, 60.0, 30.0, 30.0, 10.0, 20.0, 50.0, 30.0, 10.0, 80.0, 40.0, 600.0, 70.0, 10.0, 0.0, 0.0, 220.0, 140.0, 0.0, 30.0, 30.0, 40.0, 80.0, 20.0, 180.0, 460.0, 10.0, 30.0, 300.0, 20.0, 150.0, 20.0, 110.0, 70.0, 430.0, 300.0, 20.0, 100.0, 20.0, 40.0, 40.0, 50.0, 280.0, 40.0, 10.0, 270.0, 110.0, 70.0, 460.0, 70.0, 40.0, 190.0, 140.0, 100.0, 10.0, 100.0, 210.0, 60.0, 10.0, 280.0, 510.0, 70.0, 60.0, 20.0, 60.0, 220.0, 30.0, 180.0, 20.0, 20.0, 40.0, 40.0, 10.0, 260.0, 70.0, 10.0, 280.0, 50.0, 220.0, 50.0, 280.0, 200.0, 110.0, 100.0, 180.0, 510.0, 190.0, 60.0, 40.0, 10.0, 70.0, 20.0, 140.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.007290348549368, "mean_inference_ms": 2.0528306602851605, "mean_action_processing_ms": 0.5410449841712092, "mean_env_wait_ms": 1.7403504888100327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02702188491821289, "StateBufferConnector_ms": 0.01900792121887207, "ViewRequirementAgentConnector_ms": 0.5200526714324951}, "num_episodes": 18, "episode_return_max": 2895.0, "episode_return_min": -1480.0, "episode_return_mean": 1147.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.977237221361612, "num_env_steps_trained_throughput_per_sec": 19.977237221361612, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 4080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4080000, "timers": {"training_iteration_time_ms": 204523.889, "restore_workers_time_ms": 0.019, "training_step_time_ms": 204523.82, "sample_time_ms": 2965.02, "learn_time_ms": 201533.872, "learn_throughput": 19.848, "synch_weights_time_ms": 12.733}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "done": false, "training_iteration": 102, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-56-04", "timestamp": 1717260964, "time_this_iter_s": 200.25917196273804, "time_total_s": 51779.62508893013, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321bff820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51779.62508893013, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 26.052982456140352, "ram_util_percent": 80.16842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.214965976731846, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007817203487260654, "vf_loss": 7.447426315770743, "vf_explained_var": -7.181564332070315e-05, "kl": Infinity, "entropy": 0.23312249134619015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 962475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "env_runners": {"episode_reward_max": 2350.0, "episode_reward_min": -1480.0, "episode_reward_mean": 1127.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -2440.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 112.755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1340.0, 740.0, 1200.0, 1170.0, 1810.0, 1470.0, 1280.0, 780.0, 930.0, 1045.0, 1550.0, 1565.0, 1150.0, 820.0, 310.0, 1380.0, 890.0, 180.0, 1900.0, 1250.0, 925.0, 570.0, 1330.0, 1355.0, 1300.0, 1300.0, 1360.0, 1170.0, 1280.0, 1050.0, 880.0, 1270.0, 1100.0, 1800.0, 2350.0, 490.0, 1560.0, 1450.0, 1400.0, 1370.0, 750.0, 190.0, 470.0, 1500.0, 1100.0, 1180.0, 550.0, 1150.0, 1270.0, 570.0, 1665.0, 1070.0, 1335.0, 1410.0, 1290.0, 1700.0, 670.0, 1430.0, 835.0, 1530.0, 990.0, 1555.0, 1130.0, 930.0, 1020.0, 520.0, -1480.0, 1180.0, 1240.0, 920.0, 560.0, 1350.0, 1320.0, 1460.0, 1330.0, 880.0, 1370.0, 1370.0, 820.0, 1750.0, 1660.0, 465.0, 970.0, 760.0, 1100.0, 1370.0, 1660.0, 590.0, 1570.0, 935.0, 1550.0, 1845.0, 760.0, 700.0, 2010.0, 1470.0, 725.0, 900.0, 1455.0, 310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [230.0, 260.0, 50.0, 170.0, 250.0, 100.0, 80.0, 10.0, 160.0, 30.0, 290.0, 10.0, 60.0, -20.0, 190.0, 90.0, 20.0, 40.0, 50.0, 10.0, 180.0, -40.0, 180.0, 20.0, 440.0, 20.0, 30.0, 280.0, 80.0, 10.0, 40.0, 90.0, 30.0, 50.0, 0.0, 110.0, 20.0, 0.0, 120.0, 710.0, 40.0, 190.0, 50.0, 50.0, 70.0, 70.0, 660.0, 60.0, 570.0, 50.0, 70.0, 10.0, 40.0, 420.0, 40.0, 330.0, 360.0, 130.0, 110.0, -40.0, 90.0, 320.0, 90.0, 70.0, 50.0, 240.0, 20.0, 160.0, 220.0, 20.0, 50.0, 100.0, 110.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 380.0, 10.0, 20.0, -340.0, 0.0, 80.0, 110.0, 40.0, 250.0, 690.0, 70.0, 90.0, 360.0, 130.0, 30.0, 350.0, 35.0, 30.0, 20.0, 0.0, 0.0, 300.0, 260.0, 120.0, 20.0, 30.0, 10.0, 380.0, 20.0, 380.0, 30.0, 130.0, 90.0, 40.0, 40.0, 20.0, 10.0, 200.0, 450.0, -75.0, 660.0, 50.0, 30.0, 10.0, 0.0, 70.0, 330.0, 60.0, 150.0, 40.0, 410.0, 450.0, 60.0, 30.0, 20.0, 20.0, 20.0, 0.0, 70.0, 160.0, -10.0, 100.0, 150.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 110.0, -50.0, 80.0, 410.0, 80.0, 590.0, 20.0, 60.0, 30.0, 50.0, 0.0, 0.0, 460.0, -10.0, 40.0, 30.0, 30.0, 100.0, 180.0, 60.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 50.0, 30.0, 30.0, 310.0, 60.0, 20.0, 100.0, 170.0, 500.0, 30.0, 60.0, 210.0, 440.0, 50.0, 160.0, 10.0, 350.0, 0.0, 0.0, -40.0, -50.0, 710.0, 60.0, 10.0, 20.0, 20.0, 35.0, 30.0, 280.0, 180.0, 50.0, 160.0, 140.0, 0.0, 190.0, 40.0, 30.0, 0.0, 170.0, 60.0, 30.0, 20.0, 30.0, 120.0, 0.0, 50.0, 330.0, 110.0, 360.0, 40.0, 60.0, 20.0, 240.0, 270.0, 110.0, 40.0, 200.0, 130.0, -35.0, 30.0, 20.0, 600.0, -10.0, 170.0, 10.0, 310.0, 30.0, 60.0, 30.0, 130.0, 270.0, 120.0, 170.0, 80.0, 40.0, 180.0, 70.0, -100.0, 40.0, 30.0, 270.0, 170.0, 520.0, -10.0, 170.0, 20.0, 410.0, -20.0, 60.0, 230.0, 400.0, 70.0, 30.0, 50.0, 80.0, 70.0, 30.0, -120.0, 10.0, 50.0, -40.0, 10.0, 1030.0, 30.0, 40.0, 20.0, 0.0, 400.0, 20.0, 290.0, 40.0, 10.0, 430.0, -10.0, 0.0, 70.0, 460.0, 20.0, -20.0, 40.0, 210.0, 10.0, 270.0, 20.0, 150.0, 30.0, 90.0, 10.0, 0.0, 310.0, 160.0, 80.0, 30.0, 60.0, 80.0, 20.0, 180.0, 40.0, 370.0, 390.0, 120.0, 10.0, 0.0, -110.0, 50.0, -40.0, 90.0, 80.0, 160.0, 160.0, 600.0, 30.0, 80.0, 340.0, 100.0, 170.0, 190.0, 500.0, 60.0, 120.0, 190.0, 10.0, 120.0, 1010.0, 230.0, 290.0, 100.0, 150.0, 0.0, 180.0, 30.0, 320.0, 40.0, 200.0, 20.0, 0.0, 50.0, 20.0, 90.0, 0.0, 60.0, 10.0, 40.0, 40.0, 70.0, 290.0, 20.0, 220.0, 220.0, 40.0, 350.0, 20.0, 290.0, 170.0, 130.0, 530.0, 50.0, 280.0, 90.0, 30.0, 10.0, 100.0, 60.0, 190.0, 150.0, 370.0, 20.0, 80.0, 40.0, 60.0, 60.0, 190.0, 240.0, 270.0, 220.0, 50.0, 70.0, 170.0, 370.0, -30.0, 40.0, 180.0, 30.0, 330.0, 0.0, 330.0, 30.0, 230.0, -520.0, 110.0, 50.0, 90.0, 100.0, 10.0, 30.0, 0.0, 20.0, 40.0, 50.0, 40.0, 0.0, 0.0, 0.0, 220.0, 120.0, 40.0, 10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 70.0, 130.0, 160.0, 630.0, 40.0, 70.0, 50.0, 130.0, 180.0, 410.0, 110.0, 300.0, 20.0, 50.0, 210.0, -10.0, 0.0, 10.0, 0.0, 330.0, 10.0, 50.0, 50.0, 50.0, 50.0, 0.0, 320.0, 180.0, 140.0, 30.0, 30.0, 50.0, 170.0, 30.0, 20.0, 10.0, 100.0, 20.0, 90.0, 60.0, 170.0, 130.0, 30.0, 50.0, 180.0, 390.0, 0.0, 120.0, 20.0, 80.0, 120.0, 20.0, 0.0, 50.0, 20.0, 510.0, 460.0, 40.0, -30.0, 10.0, 30.0, 180.0, 20.0, 30.0, 30.0, 0.0, 60.0, 140.0, 70.0, -25.0, 540.0, 60.0, 100.0, 20.0, 180.0, 260.0, 40.0, -10.0, 500.0, 20.0, 360.0, 40.0, 30.0, -10.0, 20.0, 40.0, 310.0, 240.0, 20.0, 25.0, 370.0, 280.0, 270.0, 20.0, 20.0, 210.0, 10.0, 10.0, 120.0, 140.0, 10.0, -10.0, 440.0, 30.0, 290.0, 10.0, 170.0, 40.0, 290.0, 290.0, 60.0, 140.0, 290.0, 170.0, 90.0, 30.0, 80.0, 30.0, 110.0, 510.0, 400.0, 80.0, 40.0, 80.0, 140.0, 100.0, 80.0, 40.0, 230.0, 80.0, 40.0, 0.0, 30.0, 0.0, 160.0, 250.0, 0.0, 10.0, 100.0, 110.0, 10.0, -30.0, 140.0, 170.0, 260.0, 30.0, 330.0, 380.0, 30.0, -10.0, 50.0, 75.0, 55.0, -15.0, 510.0, 30.0, 110.0, 30.0, 0.0, 100.0, 210.0, 40.0, 30.0, 30.0, 90.0, 440.0, 100.0, 190.0, 300.0, 30.0, 40.0, 10.0, 100.0, 60.0, 20.0, 30.0, 0.0, 120.0, 580.0, 160.0, 60.0, 370.0, 100.0, 60.0, -45.0, 510.0, 120.0, 50.0, 170.0, 290.0, 60.0, 100.0, 190.0, 0.0, 230.0, 20.0, 60.0, 100.0, 80.0, 150.0, 80.0, 0.0, 100.0, 310.0, 100.0, 10.0, 50.0, 40.0, 90.0, 270.0, 300.0, 80.0, 40.0, 100.0, 130.0, 30.0, 0.0, 30.0, 40.0, 0.0, 80.0, 280.0, 40.0, 10.0, 40.0, 20.0, 40.0, 10.0, 0.0, 50.0, 0.0, 190.0, 50.0, 120.0, 10.0, -2440.0, 290.0, 160.0, 90.0, 210.0, 100.0, 120.0, 485.0, 190.0, -30.0, 20.0, 60.0, 20.0, 5.0, 20.0, 150.0, 310.0, 70.0, 70.0, 50.0, 450.0, 60.0, 30.0, 30.0, 10.0, 20.0, 50.0, 30.0, 10.0, 80.0, 40.0, 600.0, 70.0, 10.0, 0.0, 0.0, 220.0, 140.0, 0.0, 30.0, 30.0, 40.0, 80.0, 20.0, 180.0, 460.0, 10.0, 30.0, 300.0, 20.0, 150.0, 20.0, 110.0, 70.0, 430.0, 300.0, 20.0, 100.0, 20.0, 40.0, 40.0, 50.0, 280.0, 40.0, 10.0, 270.0, 110.0, 70.0, 460.0, 70.0, 40.0, 190.0, 140.0, 100.0, 10.0, 100.0, 210.0, 60.0, 10.0, 280.0, 510.0, 70.0, 60.0, 20.0, 60.0, 220.0, 30.0, 180.0, 20.0, 20.0, 40.0, 40.0, 10.0, 260.0, 70.0, 10.0, 280.0, 50.0, 220.0, 50.0, 280.0, 200.0, 110.0, 100.0, 180.0, 510.0, 190.0, 60.0, 40.0, 10.0, 70.0, 20.0, 140.0, 150.0, 40.0, 30.0, 20.0, 80.0, 10.0, 310.0, 0.0, 20.0, 20.0, 290.0, 170.0, 20.0, 70.0, 150.0, 190.0, 510.0, 60.0, 310.0, 80.0, 190.0, 10.0, 130.0, 220.0, 320.0, 110.0, 420.0, 50.0, 20.0, 290.0, 90.0, 60.0, 80.0, 120.0, 30.0, 0.0, 50.0, 80.0, 20.0, 10.0, 15.0, 10.0, 40.0, 20.0, 190.0, 180.0, 20.0, 40.0, 330.0, 20.0, 120.0, 50.0, 20.0, 10.0, 110.0, 40.0, 290.0, 30.0, 100.0, 20.0, 90.0, 100.0, 140.0, 45.0, 20.0, 30.0, -70.0, 600.0, 190.0, 35.0, 10.0, 310.0, 170.0, 30.0, 110.0, 230.0, 50.0, 70.0, 70.0, 130.0, 200.0, 30.0, 470.0, 110.0, 200.0, 40.0, 240.0, 30.0, 80.0, 30.0, 430.0, 0.0, 20.0, 40.0, 170.0, 20.0, 40.0, 20.0, 90.0, 0.0, 190.0, 20.0, 20.0, 20.0, 40.0, 120.0, 240.0, 460.0, 300.0, 290.0, 60.0, 30.0, 140.0, 20.0, 50.0, 350.0, -5.0, 10.0, 70.0, 20.0, 250.0, 420.0, 90.0, 650.0, -10.0, 160.0, 100.0, 50.0, 130.0, -50.0, 10.0, 220.0, 65.0, 60.0, 80.0, 30.0, 150.0, 30.0, 440.0, 610.0, 160.0, 20.0, 60.0, 50.0, 40.0, 40.0, 390.0, 130.0, 10.0, 20.0, 0.0, 0.0, -30.0, 20.0, 280.0, 20.0, 20.0, 280.0, 60.0, 50.0, 0.0, 150.0, 60.0, 120.0, -20.0, 210.0, 700.0, 110.0, 300.0, 290.0, 90.0, 250.0, 10.0, 650.0, 130.0, 50.0, 90.0, 30.0, 50.0, 170.0, 40.0, 35.0, 30.0, 70.0, 170.0, 30.0, 30.0, 0.0, 40.0, 320.0, 0.0, 0.0, 40.0, 40.0, 0.0, 180.0, 340.0, 150.0, 60.0, 50.0, 40.0, 110.0, 390.0, 40.0, 150.0, 70.0, 330.0, 160.0, 190.0, -55.0, 70.0, 170.0, -80.0, 40.0, 20.0, 70.0, 50.0, 80.0, -140.0, 20.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9996636735892708, "mean_inference_ms": 2.0439834708695774, "mean_action_processing_ms": 0.539696113748303, "mean_env_wait_ms": 1.7368008190139772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01992344856262207, "StateBufferConnector_ms": 0.016994953155517578, "ViewRequirementAgentConnector_ms": 0.5051314830780029}, "num_episodes": 22, "episode_return_max": 2350.0, "episode_return_min": -1480.0, "episode_return_mean": 1127.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.034442102609088, "num_env_steps_trained_throughput_per_sec": 20.034442102609088, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 4120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4120000, "timers": {"training_iteration_time_ms": 203824.027, "restore_workers_time_ms": 0.019, "training_step_time_ms": 203823.958, "sample_time_ms": 2875.894, "learn_time_ms": 200923.614, "learn_throughput": 19.908, "synch_weights_time_ms": 12.608}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "done": false, "training_iteration": 103, "trial_id": "3d3a5_00000", "date": "2024-06-01_12-59-24", "timestamp": 1717261164, "time_this_iter_s": 199.6698021888733, "time_total_s": 51979.294891119, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c32550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51979.294891119, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 22.782394366197185, "ram_util_percent": 81.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2403178815135814, "cur_kl_coeff": 0.405457305908203, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006366618138765747, "vf_loss": 6.816357265874601, "vf_explained_var": 0.0001421662247853792, "kl": Infinity, "entropy": 0.24068884745129127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 971865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "env_runners": {"episode_reward_max": 2350.0, "episode_reward_min": -1480.0, "episode_reward_mean": 1110.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -2440.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 111.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1900.0, 1250.0, 925.0, 570.0, 1330.0, 1355.0, 1300.0, 1300.0, 1360.0, 1170.0, 1280.0, 1050.0, 880.0, 1270.0, 1100.0, 1800.0, 2350.0, 490.0, 1560.0, 1450.0, 1400.0, 1370.0, 750.0, 190.0, 470.0, 1500.0, 1100.0, 1180.0, 550.0, 1150.0, 1270.0, 570.0, 1665.0, 1070.0, 1335.0, 1410.0, 1290.0, 1700.0, 670.0, 1430.0, 835.0, 1530.0, 990.0, 1555.0, 1130.0, 930.0, 1020.0, 520.0, -1480.0, 1180.0, 1240.0, 920.0, 560.0, 1350.0, 1320.0, 1460.0, 1330.0, 880.0, 1370.0, 1370.0, 820.0, 1750.0, 1660.0, 465.0, 970.0, 760.0, 1100.0, 1370.0, 1660.0, 590.0, 1570.0, 935.0, 1550.0, 1845.0, 760.0, 700.0, 2010.0, 1470.0, 725.0, 900.0, 1455.0, 310.0, 800.0, 480.0, 510.0, 1160.0, 650.0, 1420.0, 700.0, 1140.0, 1140.0, 850.0, 1220.0, 650.0, 1590.0, 860.0, 1065.0, 330.0, 1620.0, 1730.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [310.0, 60.0, 20.0, 100.0, 170.0, 500.0, 30.0, 60.0, 210.0, 440.0, 50.0, 160.0, 10.0, 350.0, 0.0, 0.0, -40.0, -50.0, 710.0, 60.0, 10.0, 20.0, 20.0, 35.0, 30.0, 280.0, 180.0, 50.0, 160.0, 140.0, 0.0, 190.0, 40.0, 30.0, 0.0, 170.0, 60.0, 30.0, 20.0, 30.0, 120.0, 0.0, 50.0, 330.0, 110.0, 360.0, 40.0, 60.0, 20.0, 240.0, 270.0, 110.0, 40.0, 200.0, 130.0, -35.0, 30.0, 20.0, 600.0, -10.0, 170.0, 10.0, 310.0, 30.0, 60.0, 30.0, 130.0, 270.0, 120.0, 170.0, 80.0, 40.0, 180.0, 70.0, -100.0, 40.0, 30.0, 270.0, 170.0, 520.0, -10.0, 170.0, 20.0, 410.0, -20.0, 60.0, 230.0, 400.0, 70.0, 30.0, 50.0, 80.0, 70.0, 30.0, -120.0, 10.0, 50.0, -40.0, 10.0, 1030.0, 30.0, 40.0, 20.0, 0.0, 400.0, 20.0, 290.0, 40.0, 10.0, 430.0, -10.0, 0.0, 70.0, 460.0, 20.0, -20.0, 40.0, 210.0, 10.0, 270.0, 20.0, 150.0, 30.0, 90.0, 10.0, 0.0, 310.0, 160.0, 80.0, 30.0, 60.0, 80.0, 20.0, 180.0, 40.0, 370.0, 390.0, 120.0, 10.0, 0.0, -110.0, 50.0, -40.0, 90.0, 80.0, 160.0, 160.0, 600.0, 30.0, 80.0, 340.0, 100.0, 170.0, 190.0, 500.0, 60.0, 120.0, 190.0, 10.0, 120.0, 1010.0, 230.0, 290.0, 100.0, 150.0, 0.0, 180.0, 30.0, 320.0, 40.0, 200.0, 20.0, 0.0, 50.0, 20.0, 90.0, 0.0, 60.0, 10.0, 40.0, 40.0, 70.0, 290.0, 20.0, 220.0, 220.0, 40.0, 350.0, 20.0, 290.0, 170.0, 130.0, 530.0, 50.0, 280.0, 90.0, 30.0, 10.0, 100.0, 60.0, 190.0, 150.0, 370.0, 20.0, 80.0, 40.0, 60.0, 60.0, 190.0, 240.0, 270.0, 220.0, 50.0, 70.0, 170.0, 370.0, -30.0, 40.0, 180.0, 30.0, 330.0, 0.0, 330.0, 30.0, 230.0, -520.0, 110.0, 50.0, 90.0, 100.0, 10.0, 30.0, 0.0, 20.0, 40.0, 50.0, 40.0, 0.0, 0.0, 0.0, 220.0, 120.0, 40.0, 10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 70.0, 130.0, 160.0, 630.0, 40.0, 70.0, 50.0, 130.0, 180.0, 410.0, 110.0, 300.0, 20.0, 50.0, 210.0, -10.0, 0.0, 10.0, 0.0, 330.0, 10.0, 50.0, 50.0, 50.0, 50.0, 0.0, 320.0, 180.0, 140.0, 30.0, 30.0, 50.0, 170.0, 30.0, 20.0, 10.0, 100.0, 20.0, 90.0, 60.0, 170.0, 130.0, 30.0, 50.0, 180.0, 390.0, 0.0, 120.0, 20.0, 80.0, 120.0, 20.0, 0.0, 50.0, 20.0, 510.0, 460.0, 40.0, -30.0, 10.0, 30.0, 180.0, 20.0, 30.0, 30.0, 0.0, 60.0, 140.0, 70.0, -25.0, 540.0, 60.0, 100.0, 20.0, 180.0, 260.0, 40.0, -10.0, 500.0, 20.0, 360.0, 40.0, 30.0, -10.0, 20.0, 40.0, 310.0, 240.0, 20.0, 25.0, 370.0, 280.0, 270.0, 20.0, 20.0, 210.0, 10.0, 10.0, 120.0, 140.0, 10.0, -10.0, 440.0, 30.0, 290.0, 10.0, 170.0, 40.0, 290.0, 290.0, 60.0, 140.0, 290.0, 170.0, 90.0, 30.0, 80.0, 30.0, 110.0, 510.0, 400.0, 80.0, 40.0, 80.0, 140.0, 100.0, 80.0, 40.0, 230.0, 80.0, 40.0, 0.0, 30.0, 0.0, 160.0, 250.0, 0.0, 10.0, 100.0, 110.0, 10.0, -30.0, 140.0, 170.0, 260.0, 30.0, 330.0, 380.0, 30.0, -10.0, 50.0, 75.0, 55.0, -15.0, 510.0, 30.0, 110.0, 30.0, 0.0, 100.0, 210.0, 40.0, 30.0, 30.0, 90.0, 440.0, 100.0, 190.0, 300.0, 30.0, 40.0, 10.0, 100.0, 60.0, 20.0, 30.0, 0.0, 120.0, 580.0, 160.0, 60.0, 370.0, 100.0, 60.0, -45.0, 510.0, 120.0, 50.0, 170.0, 290.0, 60.0, 100.0, 190.0, 0.0, 230.0, 20.0, 60.0, 100.0, 80.0, 150.0, 80.0, 0.0, 100.0, 310.0, 100.0, 10.0, 50.0, 40.0, 90.0, 270.0, 300.0, 80.0, 40.0, 100.0, 130.0, 30.0, 0.0, 30.0, 40.0, 0.0, 80.0, 280.0, 40.0, 10.0, 40.0, 20.0, 40.0, 10.0, 0.0, 50.0, 0.0, 190.0, 50.0, 120.0, 10.0, -2440.0, 290.0, 160.0, 90.0, 210.0, 100.0, 120.0, 485.0, 190.0, -30.0, 20.0, 60.0, 20.0, 5.0, 20.0, 150.0, 310.0, 70.0, 70.0, 50.0, 450.0, 60.0, 30.0, 30.0, 10.0, 20.0, 50.0, 30.0, 10.0, 80.0, 40.0, 600.0, 70.0, 10.0, 0.0, 0.0, 220.0, 140.0, 0.0, 30.0, 30.0, 40.0, 80.0, 20.0, 180.0, 460.0, 10.0, 30.0, 300.0, 20.0, 150.0, 20.0, 110.0, 70.0, 430.0, 300.0, 20.0, 100.0, 20.0, 40.0, 40.0, 50.0, 280.0, 40.0, 10.0, 270.0, 110.0, 70.0, 460.0, 70.0, 40.0, 190.0, 140.0, 100.0, 10.0, 100.0, 210.0, 60.0, 10.0, 280.0, 510.0, 70.0, 60.0, 20.0, 60.0, 220.0, 30.0, 180.0, 20.0, 20.0, 40.0, 40.0, 10.0, 260.0, 70.0, 10.0, 280.0, 50.0, 220.0, 50.0, 280.0, 200.0, 110.0, 100.0, 180.0, 510.0, 190.0, 60.0, 40.0, 10.0, 70.0, 20.0, 140.0, 150.0, 40.0, 30.0, 20.0, 80.0, 10.0, 310.0, 0.0, 20.0, 20.0, 290.0, 170.0, 20.0, 70.0, 150.0, 190.0, 510.0, 60.0, 310.0, 80.0, 190.0, 10.0, 130.0, 220.0, 320.0, 110.0, 420.0, 50.0, 20.0, 290.0, 90.0, 60.0, 80.0, 120.0, 30.0, 0.0, 50.0, 80.0, 20.0, 10.0, 15.0, 10.0, 40.0, 20.0, 190.0, 180.0, 20.0, 40.0, 330.0, 20.0, 120.0, 50.0, 20.0, 10.0, 110.0, 40.0, 290.0, 30.0, 100.0, 20.0, 90.0, 100.0, 140.0, 45.0, 20.0, 30.0, -70.0, 600.0, 190.0, 35.0, 10.0, 310.0, 170.0, 30.0, 110.0, 230.0, 50.0, 70.0, 70.0, 130.0, 200.0, 30.0, 470.0, 110.0, 200.0, 40.0, 240.0, 30.0, 80.0, 30.0, 430.0, 0.0, 20.0, 40.0, 170.0, 20.0, 40.0, 20.0, 90.0, 0.0, 190.0, 20.0, 20.0, 20.0, 40.0, 120.0, 240.0, 460.0, 300.0, 290.0, 60.0, 30.0, 140.0, 20.0, 50.0, 350.0, -5.0, 10.0, 70.0, 20.0, 250.0, 420.0, 90.0, 650.0, -10.0, 160.0, 100.0, 50.0, 130.0, -50.0, 10.0, 220.0, 65.0, 60.0, 80.0, 30.0, 150.0, 30.0, 440.0, 610.0, 160.0, 20.0, 60.0, 50.0, 40.0, 40.0, 390.0, 130.0, 10.0, 20.0, 0.0, 0.0, -30.0, 20.0, 280.0, 20.0, 20.0, 280.0, 60.0, 50.0, 0.0, 150.0, 60.0, 120.0, -20.0, 210.0, 700.0, 110.0, 300.0, 290.0, 90.0, 250.0, 10.0, 650.0, 130.0, 50.0, 90.0, 30.0, 50.0, 170.0, 40.0, 35.0, 30.0, 70.0, 170.0, 30.0, 30.0, 0.0, 40.0, 320.0, 0.0, 0.0, 40.0, 40.0, 0.0, 180.0, 340.0, 150.0, 60.0, 50.0, 40.0, 110.0, 390.0, 40.0, 150.0, 70.0, 330.0, 160.0, 190.0, -55.0, 70.0, 170.0, -80.0, 40.0, 20.0, 70.0, 50.0, 80.0, -140.0, 20.0, 80.0, 80.0, 240.0, 0.0, 20.0, 20.0, 40.0, 10.0, 240.0, 130.0, 20.0, 10.0, 30.0, 10.0, 110.0, 210.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 100.0, 10.0, 110.0, 180.0, 10.0, 300.0, 100.0, 180.0, 50.0, -20.0, 390.0, 0.0, 130.0, 20.0, 60.0, 20.0, 30.0, 290.0, 20.0, 20.0, 10.0, 120.0, 10.0, 70.0, 30.0, 730.0, 80.0, 100.0, 140.0, 30.0, 40.0, 50.0, 60.0, 160.0, 100.0, 300.0, 40.0, 20.0, 20.0, 20.0, 110.0, 0.0, 0.0, 90.0, 10.0, 90.0, 10.0, 100.0, 290.0, 30.0, 160.0, 160.0, 280.0, 10.0, 50.0, 220.0, 140.0, 110.0, 40.0, 50.0, 120.0, 280.0, 40.0, 90.0, -20.0, -20.0, 90.0, 120.0, 80.0, 30.0, -30.0, 290.0, -30.0, 340.0, 110.0, 70.0, 130.0, 90.0, 80.0, 180.0, 20.0, 350.0, 60.0, 130.0, 20.0, 10.0, 150.0, 170.0, 80.0, 10.0, 50.0, 0.0, 120.0, 40.0, 60.0, -150.0, 100.0, 60.0, 180.0, 240.0, 10.0, 620.0, 270.0, 200.0, 180.0, 10.0, 200.0, 70.0, 30.0, 250.0, 20.0, 20.0, 50.0, 30.0, 130.0, 5.0, 170.0, 20.0, -240.0, 100.0, 370.0, 110.0, 120.0, 280.0, 30.0, 0.0, 10.0, 70.0, 40.0, 30.0, 110.0, 40.0, 0.0, 0.0, 30.0, 300.0, 60.0, 510.0, 40.0, 320.0, 190.0, 60.0, 20.0, 90.0, 270.0, 160.0, 140.0, 80.0, 40.0, 350.0, 20.0, 130.0, 60.0, 480.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9989043340093195, "mean_inference_ms": 2.047237885363757, "mean_action_processing_ms": 0.5392007226572033, "mean_env_wait_ms": 1.7344326660700489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013820409774780273, "StateBufferConnector_ms": 0.0157163143157959, "ViewRequirementAgentConnector_ms": 0.4473085403442383}, "num_episodes": 18, "episode_return_max": 2350.0, "episode_return_min": -1480.0, "episode_return_mean": 1110.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.060272888629147, "num_env_steps_trained_throughput_per_sec": 19.060272888629147, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 4160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4160000, "timers": {"training_iteration_time_ms": 204388.45, "restore_workers_time_ms": 0.019, "training_step_time_ms": 204388.38, "sample_time_ms": 2835.056, "learn_time_ms": 201527.819, "learn_throughput": 19.848, "synch_weights_time_ms": 13.495}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "done": false, "training_iteration": 104, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-02-54", "timestamp": 1717261374, "time_this_iter_s": 209.90189385414124, "time_total_s": 52189.196784973145, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c32820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52189.196784973145, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 26.216551724137933, "ram_util_percent": 81.83862068965516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3517542940168714, "cur_kl_coeff": 0.6081859588623046, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006358122684089298, "vf_loss": 7.023702500041681, "vf_explained_var": 0.00018685034796579703, "kl": Infinity, "entropy": 0.22657828570538943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 981255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": -1480.0, "episode_reward_mean": 1079.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -2440.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 107.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1560.0, 1450.0, 1400.0, 1370.0, 750.0, 190.0, 470.0, 1500.0, 1100.0, 1180.0, 550.0, 1150.0, 1270.0, 570.0, 1665.0, 1070.0, 1335.0, 1410.0, 1290.0, 1700.0, 670.0, 1430.0, 835.0, 1530.0, 990.0, 1555.0, 1130.0, 930.0, 1020.0, 520.0, -1480.0, 1180.0, 1240.0, 920.0, 560.0, 1350.0, 1320.0, 1460.0, 1330.0, 880.0, 1370.0, 1370.0, 820.0, 1750.0, 1660.0, 465.0, 970.0, 760.0, 1100.0, 1370.0, 1660.0, 590.0, 1570.0, 935.0, 1550.0, 1845.0, 760.0, 700.0, 2010.0, 1470.0, 725.0, 900.0, 1455.0, 310.0, 800.0, 480.0, 510.0, 1160.0, 650.0, 1420.0, 700.0, 1140.0, 1140.0, 850.0, 1220.0, 650.0, 1590.0, 860.0, 1065.0, 330.0, 1620.0, 1730.0, 1500.0, 1030.0, 960.0, 450.0, 1000.0, 770.0, 540.0, 1295.0, 1540.0, 1050.0, 1120.0, 2090.0, 1900.0, 1260.0, 430.0, 1060.0, 765.0, 760.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 70.0, 290.0, 20.0, 220.0, 220.0, 40.0, 350.0, 20.0, 290.0, 170.0, 130.0, 530.0, 50.0, 280.0, 90.0, 30.0, 10.0, 100.0, 60.0, 190.0, 150.0, 370.0, 20.0, 80.0, 40.0, 60.0, 60.0, 190.0, 240.0, 270.0, 220.0, 50.0, 70.0, 170.0, 370.0, -30.0, 40.0, 180.0, 30.0, 330.0, 0.0, 330.0, 30.0, 230.0, -520.0, 110.0, 50.0, 90.0, 100.0, 10.0, 30.0, 0.0, 20.0, 40.0, 50.0, 40.0, 0.0, 0.0, 0.0, 220.0, 120.0, 40.0, 10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 70.0, 130.0, 160.0, 630.0, 40.0, 70.0, 50.0, 130.0, 180.0, 410.0, 110.0, 300.0, 20.0, 50.0, 210.0, -10.0, 0.0, 10.0, 0.0, 330.0, 10.0, 50.0, 50.0, 50.0, 50.0, 0.0, 320.0, 180.0, 140.0, 30.0, 30.0, 50.0, 170.0, 30.0, 20.0, 10.0, 100.0, 20.0, 90.0, 60.0, 170.0, 130.0, 30.0, 50.0, 180.0, 390.0, 0.0, 120.0, 20.0, 80.0, 120.0, 20.0, 0.0, 50.0, 20.0, 510.0, 460.0, 40.0, -30.0, 10.0, 30.0, 180.0, 20.0, 30.0, 30.0, 0.0, 60.0, 140.0, 70.0, -25.0, 540.0, 60.0, 100.0, 20.0, 180.0, 260.0, 40.0, -10.0, 500.0, 20.0, 360.0, 40.0, 30.0, -10.0, 20.0, 40.0, 310.0, 240.0, 20.0, 25.0, 370.0, 280.0, 270.0, 20.0, 20.0, 210.0, 10.0, 10.0, 120.0, 140.0, 10.0, -10.0, 440.0, 30.0, 290.0, 10.0, 170.0, 40.0, 290.0, 290.0, 60.0, 140.0, 290.0, 170.0, 90.0, 30.0, 80.0, 30.0, 110.0, 510.0, 400.0, 80.0, 40.0, 80.0, 140.0, 100.0, 80.0, 40.0, 230.0, 80.0, 40.0, 0.0, 30.0, 0.0, 160.0, 250.0, 0.0, 10.0, 100.0, 110.0, 10.0, -30.0, 140.0, 170.0, 260.0, 30.0, 330.0, 380.0, 30.0, -10.0, 50.0, 75.0, 55.0, -15.0, 510.0, 30.0, 110.0, 30.0, 0.0, 100.0, 210.0, 40.0, 30.0, 30.0, 90.0, 440.0, 100.0, 190.0, 300.0, 30.0, 40.0, 10.0, 100.0, 60.0, 20.0, 30.0, 0.0, 120.0, 580.0, 160.0, 60.0, 370.0, 100.0, 60.0, -45.0, 510.0, 120.0, 50.0, 170.0, 290.0, 60.0, 100.0, 190.0, 0.0, 230.0, 20.0, 60.0, 100.0, 80.0, 150.0, 80.0, 0.0, 100.0, 310.0, 100.0, 10.0, 50.0, 40.0, 90.0, 270.0, 300.0, 80.0, 40.0, 100.0, 130.0, 30.0, 0.0, 30.0, 40.0, 0.0, 80.0, 280.0, 40.0, 10.0, 40.0, 20.0, 40.0, 10.0, 0.0, 50.0, 0.0, 190.0, 50.0, 120.0, 10.0, -2440.0, 290.0, 160.0, 90.0, 210.0, 100.0, 120.0, 485.0, 190.0, -30.0, 20.0, 60.0, 20.0, 5.0, 20.0, 150.0, 310.0, 70.0, 70.0, 50.0, 450.0, 60.0, 30.0, 30.0, 10.0, 20.0, 50.0, 30.0, 10.0, 80.0, 40.0, 600.0, 70.0, 10.0, 0.0, 0.0, 220.0, 140.0, 0.0, 30.0, 30.0, 40.0, 80.0, 20.0, 180.0, 460.0, 10.0, 30.0, 300.0, 20.0, 150.0, 20.0, 110.0, 70.0, 430.0, 300.0, 20.0, 100.0, 20.0, 40.0, 40.0, 50.0, 280.0, 40.0, 10.0, 270.0, 110.0, 70.0, 460.0, 70.0, 40.0, 190.0, 140.0, 100.0, 10.0, 100.0, 210.0, 60.0, 10.0, 280.0, 510.0, 70.0, 60.0, 20.0, 60.0, 220.0, 30.0, 180.0, 20.0, 20.0, 40.0, 40.0, 10.0, 260.0, 70.0, 10.0, 280.0, 50.0, 220.0, 50.0, 280.0, 200.0, 110.0, 100.0, 180.0, 510.0, 190.0, 60.0, 40.0, 10.0, 70.0, 20.0, 140.0, 150.0, 40.0, 30.0, 20.0, 80.0, 10.0, 310.0, 0.0, 20.0, 20.0, 290.0, 170.0, 20.0, 70.0, 150.0, 190.0, 510.0, 60.0, 310.0, 80.0, 190.0, 10.0, 130.0, 220.0, 320.0, 110.0, 420.0, 50.0, 20.0, 290.0, 90.0, 60.0, 80.0, 120.0, 30.0, 0.0, 50.0, 80.0, 20.0, 10.0, 15.0, 10.0, 40.0, 20.0, 190.0, 180.0, 20.0, 40.0, 330.0, 20.0, 120.0, 50.0, 20.0, 10.0, 110.0, 40.0, 290.0, 30.0, 100.0, 20.0, 90.0, 100.0, 140.0, 45.0, 20.0, 30.0, -70.0, 600.0, 190.0, 35.0, 10.0, 310.0, 170.0, 30.0, 110.0, 230.0, 50.0, 70.0, 70.0, 130.0, 200.0, 30.0, 470.0, 110.0, 200.0, 40.0, 240.0, 30.0, 80.0, 30.0, 430.0, 0.0, 20.0, 40.0, 170.0, 20.0, 40.0, 20.0, 90.0, 0.0, 190.0, 20.0, 20.0, 20.0, 40.0, 120.0, 240.0, 460.0, 300.0, 290.0, 60.0, 30.0, 140.0, 20.0, 50.0, 350.0, -5.0, 10.0, 70.0, 20.0, 250.0, 420.0, 90.0, 650.0, -10.0, 160.0, 100.0, 50.0, 130.0, -50.0, 10.0, 220.0, 65.0, 60.0, 80.0, 30.0, 150.0, 30.0, 440.0, 610.0, 160.0, 20.0, 60.0, 50.0, 40.0, 40.0, 390.0, 130.0, 10.0, 20.0, 0.0, 0.0, -30.0, 20.0, 280.0, 20.0, 20.0, 280.0, 60.0, 50.0, 0.0, 150.0, 60.0, 120.0, -20.0, 210.0, 700.0, 110.0, 300.0, 290.0, 90.0, 250.0, 10.0, 650.0, 130.0, 50.0, 90.0, 30.0, 50.0, 170.0, 40.0, 35.0, 30.0, 70.0, 170.0, 30.0, 30.0, 0.0, 40.0, 320.0, 0.0, 0.0, 40.0, 40.0, 0.0, 180.0, 340.0, 150.0, 60.0, 50.0, 40.0, 110.0, 390.0, 40.0, 150.0, 70.0, 330.0, 160.0, 190.0, -55.0, 70.0, 170.0, -80.0, 40.0, 20.0, 70.0, 50.0, 80.0, -140.0, 20.0, 80.0, 80.0, 240.0, 0.0, 20.0, 20.0, 40.0, 10.0, 240.0, 130.0, 20.0, 10.0, 30.0, 10.0, 110.0, 210.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 100.0, 10.0, 110.0, 180.0, 10.0, 300.0, 100.0, 180.0, 50.0, -20.0, 390.0, 0.0, 130.0, 20.0, 60.0, 20.0, 30.0, 290.0, 20.0, 20.0, 10.0, 120.0, 10.0, 70.0, 30.0, 730.0, 80.0, 100.0, 140.0, 30.0, 40.0, 50.0, 60.0, 160.0, 100.0, 300.0, 40.0, 20.0, 20.0, 20.0, 110.0, 0.0, 0.0, 90.0, 10.0, 90.0, 10.0, 100.0, 290.0, 30.0, 160.0, 160.0, 280.0, 10.0, 50.0, 220.0, 140.0, 110.0, 40.0, 50.0, 120.0, 280.0, 40.0, 90.0, -20.0, -20.0, 90.0, 120.0, 80.0, 30.0, -30.0, 290.0, -30.0, 340.0, 110.0, 70.0, 130.0, 90.0, 80.0, 180.0, 20.0, 350.0, 60.0, 130.0, 20.0, 10.0, 150.0, 170.0, 80.0, 10.0, 50.0, 0.0, 120.0, 40.0, 60.0, -150.0, 100.0, 60.0, 180.0, 240.0, 10.0, 620.0, 270.0, 200.0, 180.0, 10.0, 200.0, 70.0, 30.0, 250.0, 20.0, 20.0, 50.0, 30.0, 130.0, 5.0, 170.0, 20.0, -240.0, 100.0, 370.0, 110.0, 120.0, 280.0, 30.0, 0.0, 10.0, 70.0, 40.0, 30.0, 110.0, 40.0, 0.0, 0.0, 30.0, 300.0, 60.0, 510.0, 40.0, 320.0, 190.0, 60.0, 20.0, 90.0, 270.0, 160.0, 140.0, 80.0, 40.0, 350.0, 20.0, 130.0, 60.0, 480.0, 80.0, 120.0, 50.0, 110.0, 300.0, 100.0, 150.0, 0.0, 280.0, 310.0, 70.0, 100.0, 180.0, -30.0, 50.0, 400.0, 10.0, 80.0, 10.0, 160.0, 40.0, 50.0, 240.0, 0.0, 470.0, 40.0, 50.0, 0.0, 0.0, 70.0, 30.0, 170.0, 10.0, 0.0, 0.0, 90.0, 10.0, -40.0, 0.0, 180.0, 70.0, 0.0, 150.0, 290.0, 230.0, 90.0, 100.0, 40.0, 0.0, 30.0, 10.0, 110.0, 30.0, 370.0, 20.0, 100.0, 10.0, 30.0, 40.0, 50.0, 190.0, 20.0, 60.0, 0.0, 180.0, 10.0, 10.0, 40.0, 0.0, 30.0, 10.0, 120.0, 320.0, 40.0, 20.0, 300.0, 20.0, 35.0, 50.0, 380.0, 60.0, 180.0, 50.0, 80.0, 0.0, 90.0, 30.0, 180.0, 810.0, 60.0, 60.0, 160.0, 120.0, 370.0, 10.0, 80.0, 40.0, 100.0, 70.0, 40.0, 170.0, 390.0, 30.0, 170.0, 70.0, 30.0, 40.0, 70.0, 60.0, 90.0, 340.0, 60.0, 430.0, 180.0, 30.0, 50.0, 290.0, 120.0, 180.0, 410.0, 210.0, 170.0, 90.0, 70.0, 30.0, 30.0, 160.0, 740.0, 320.0, 80.0, 20.0, 120.0, 280.0, 50.0, 470.0, -90.0, 50.0, 120.0, 40.0, 200.0, 130.0, 90.0, 0.0, 20.0, 80.0, 0.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 180.0, 40.0, 780.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 120.0, 60.0, 20.0, 20.0, 30.0, 55.0, 200.0, 230.0, 10.0, 40.0, 20.0, 20.0, -10.0, 130.0, 180.0, 80.0, 60.0, 230.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9959725257339227, "mean_inference_ms": 2.045611088030415, "mean_action_processing_ms": 0.5385899700674794, "mean_env_wait_ms": 1.7324882729556748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013742446899414062, "StateBufferConnector_ms": 0.016215801239013672, "ViewRequirementAgentConnector_ms": 0.4779813289642334}, "num_episodes": 18, "episode_return_max": 2090.0, "episode_return_min": -1480.0, "episode_return_mean": 1079.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.43851731060743, "num_env_steps_trained_throughput_per_sec": 12.43851731060743, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 4200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4200000, "timers": {"training_iteration_time_ms": 216428.178, "restore_workers_time_ms": 0.02, "training_step_time_ms": 216428.109, "sample_time_ms": 2970.896, "learn_time_ms": 213431.512, "learn_throughput": 18.741, "synch_weights_time_ms": 13.34}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "done": false, "training_iteration": 105, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-08-15", "timestamp": 1717261695, "time_this_iter_s": 321.6056880950928, "time_total_s": 52510.80247306824, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c19790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52510.80247306824, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 21.646020761245673, "ram_util_percent": 82.39861591695502}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.096576002490914, "cur_kl_coeff": 0.9122789382934572, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006490600073146728, "vf_loss": 7.3185363798476635, "vf_explained_var": 2.6257813802034583e-05, "kl": Infinity, "entropy": 0.23449338561239333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 990645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": -1480.0, "episode_reward_mean": 1092.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -2440.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 109.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1530.0, 990.0, 1555.0, 1130.0, 930.0, 1020.0, 520.0, -1480.0, 1180.0, 1240.0, 920.0, 560.0, 1350.0, 1320.0, 1460.0, 1330.0, 880.0, 1370.0, 1370.0, 820.0, 1750.0, 1660.0, 465.0, 970.0, 760.0, 1100.0, 1370.0, 1660.0, 590.0, 1570.0, 935.0, 1550.0, 1845.0, 760.0, 700.0, 2010.0, 1470.0, 725.0, 900.0, 1455.0, 310.0, 800.0, 480.0, 510.0, 1160.0, 650.0, 1420.0, 700.0, 1140.0, 1140.0, 850.0, 1220.0, 650.0, 1590.0, 860.0, 1065.0, 330.0, 1620.0, 1730.0, 1500.0, 1030.0, 960.0, 450.0, 1000.0, 770.0, 540.0, 1295.0, 1540.0, 1050.0, 1120.0, 2090.0, 1900.0, 1260.0, 430.0, 1060.0, 765.0, 760.0, 1150.0, 800.0, 1300.0, 870.0, 1440.0, 1660.0, 1160.0, 1320.0, 850.0, 730.0, 1040.0, 920.0, 1300.0, 1605.0, 1220.0, 880.0, 1800.0, 1320.0, 1840.0, 1660.0, 630.0, 650.0, 1110.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 210.0, 40.0, 30.0, 30.0, 90.0, 440.0, 100.0, 190.0, 300.0, 30.0, 40.0, 10.0, 100.0, 60.0, 20.0, 30.0, 0.0, 120.0, 580.0, 160.0, 60.0, 370.0, 100.0, 60.0, -45.0, 510.0, 120.0, 50.0, 170.0, 290.0, 60.0, 100.0, 190.0, 0.0, 230.0, 20.0, 60.0, 100.0, 80.0, 150.0, 80.0, 0.0, 100.0, 310.0, 100.0, 10.0, 50.0, 40.0, 90.0, 270.0, 300.0, 80.0, 40.0, 100.0, 130.0, 30.0, 0.0, 30.0, 40.0, 0.0, 80.0, 280.0, 40.0, 10.0, 40.0, 20.0, 40.0, 10.0, 0.0, 50.0, 0.0, 190.0, 50.0, 120.0, 10.0, -2440.0, 290.0, 160.0, 90.0, 210.0, 100.0, 120.0, 485.0, 190.0, -30.0, 20.0, 60.0, 20.0, 5.0, 20.0, 150.0, 310.0, 70.0, 70.0, 50.0, 450.0, 60.0, 30.0, 30.0, 10.0, 20.0, 50.0, 30.0, 10.0, 80.0, 40.0, 600.0, 70.0, 10.0, 0.0, 0.0, 220.0, 140.0, 0.0, 30.0, 30.0, 40.0, 80.0, 20.0, 180.0, 460.0, 10.0, 30.0, 300.0, 20.0, 150.0, 20.0, 110.0, 70.0, 430.0, 300.0, 20.0, 100.0, 20.0, 40.0, 40.0, 50.0, 280.0, 40.0, 10.0, 270.0, 110.0, 70.0, 460.0, 70.0, 40.0, 190.0, 140.0, 100.0, 10.0, 100.0, 210.0, 60.0, 10.0, 280.0, 510.0, 70.0, 60.0, 20.0, 60.0, 220.0, 30.0, 180.0, 20.0, 20.0, 40.0, 40.0, 10.0, 260.0, 70.0, 10.0, 280.0, 50.0, 220.0, 50.0, 280.0, 200.0, 110.0, 100.0, 180.0, 510.0, 190.0, 60.0, 40.0, 10.0, 70.0, 20.0, 140.0, 150.0, 40.0, 30.0, 20.0, 80.0, 10.0, 310.0, 0.0, 20.0, 20.0, 290.0, 170.0, 20.0, 70.0, 150.0, 190.0, 510.0, 60.0, 310.0, 80.0, 190.0, 10.0, 130.0, 220.0, 320.0, 110.0, 420.0, 50.0, 20.0, 290.0, 90.0, 60.0, 80.0, 120.0, 30.0, 0.0, 50.0, 80.0, 20.0, 10.0, 15.0, 10.0, 40.0, 20.0, 190.0, 180.0, 20.0, 40.0, 330.0, 20.0, 120.0, 50.0, 20.0, 10.0, 110.0, 40.0, 290.0, 30.0, 100.0, 20.0, 90.0, 100.0, 140.0, 45.0, 20.0, 30.0, -70.0, 600.0, 190.0, 35.0, 10.0, 310.0, 170.0, 30.0, 110.0, 230.0, 50.0, 70.0, 70.0, 130.0, 200.0, 30.0, 470.0, 110.0, 200.0, 40.0, 240.0, 30.0, 80.0, 30.0, 430.0, 0.0, 20.0, 40.0, 170.0, 20.0, 40.0, 20.0, 90.0, 0.0, 190.0, 20.0, 20.0, 20.0, 40.0, 120.0, 240.0, 460.0, 300.0, 290.0, 60.0, 30.0, 140.0, 20.0, 50.0, 350.0, -5.0, 10.0, 70.0, 20.0, 250.0, 420.0, 90.0, 650.0, -10.0, 160.0, 100.0, 50.0, 130.0, -50.0, 10.0, 220.0, 65.0, 60.0, 80.0, 30.0, 150.0, 30.0, 440.0, 610.0, 160.0, 20.0, 60.0, 50.0, 40.0, 40.0, 390.0, 130.0, 10.0, 20.0, 0.0, 0.0, -30.0, 20.0, 280.0, 20.0, 20.0, 280.0, 60.0, 50.0, 0.0, 150.0, 60.0, 120.0, -20.0, 210.0, 700.0, 110.0, 300.0, 290.0, 90.0, 250.0, 10.0, 650.0, 130.0, 50.0, 90.0, 30.0, 50.0, 170.0, 40.0, 35.0, 30.0, 70.0, 170.0, 30.0, 30.0, 0.0, 40.0, 320.0, 0.0, 0.0, 40.0, 40.0, 0.0, 180.0, 340.0, 150.0, 60.0, 50.0, 40.0, 110.0, 390.0, 40.0, 150.0, 70.0, 330.0, 160.0, 190.0, -55.0, 70.0, 170.0, -80.0, 40.0, 20.0, 70.0, 50.0, 80.0, -140.0, 20.0, 80.0, 80.0, 240.0, 0.0, 20.0, 20.0, 40.0, 10.0, 240.0, 130.0, 20.0, 10.0, 30.0, 10.0, 110.0, 210.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 100.0, 10.0, 110.0, 180.0, 10.0, 300.0, 100.0, 180.0, 50.0, -20.0, 390.0, 0.0, 130.0, 20.0, 60.0, 20.0, 30.0, 290.0, 20.0, 20.0, 10.0, 120.0, 10.0, 70.0, 30.0, 730.0, 80.0, 100.0, 140.0, 30.0, 40.0, 50.0, 60.0, 160.0, 100.0, 300.0, 40.0, 20.0, 20.0, 20.0, 110.0, 0.0, 0.0, 90.0, 10.0, 90.0, 10.0, 100.0, 290.0, 30.0, 160.0, 160.0, 280.0, 10.0, 50.0, 220.0, 140.0, 110.0, 40.0, 50.0, 120.0, 280.0, 40.0, 90.0, -20.0, -20.0, 90.0, 120.0, 80.0, 30.0, -30.0, 290.0, -30.0, 340.0, 110.0, 70.0, 130.0, 90.0, 80.0, 180.0, 20.0, 350.0, 60.0, 130.0, 20.0, 10.0, 150.0, 170.0, 80.0, 10.0, 50.0, 0.0, 120.0, 40.0, 60.0, -150.0, 100.0, 60.0, 180.0, 240.0, 10.0, 620.0, 270.0, 200.0, 180.0, 10.0, 200.0, 70.0, 30.0, 250.0, 20.0, 20.0, 50.0, 30.0, 130.0, 5.0, 170.0, 20.0, -240.0, 100.0, 370.0, 110.0, 120.0, 280.0, 30.0, 0.0, 10.0, 70.0, 40.0, 30.0, 110.0, 40.0, 0.0, 0.0, 30.0, 300.0, 60.0, 510.0, 40.0, 320.0, 190.0, 60.0, 20.0, 90.0, 270.0, 160.0, 140.0, 80.0, 40.0, 350.0, 20.0, 130.0, 60.0, 480.0, 80.0, 120.0, 50.0, 110.0, 300.0, 100.0, 150.0, 0.0, 280.0, 310.0, 70.0, 100.0, 180.0, -30.0, 50.0, 400.0, 10.0, 80.0, 10.0, 160.0, 40.0, 50.0, 240.0, 0.0, 470.0, 40.0, 50.0, 0.0, 0.0, 70.0, 30.0, 170.0, 10.0, 0.0, 0.0, 90.0, 10.0, -40.0, 0.0, 180.0, 70.0, 0.0, 150.0, 290.0, 230.0, 90.0, 100.0, 40.0, 0.0, 30.0, 10.0, 110.0, 30.0, 370.0, 20.0, 100.0, 10.0, 30.0, 40.0, 50.0, 190.0, 20.0, 60.0, 0.0, 180.0, 10.0, 10.0, 40.0, 0.0, 30.0, 10.0, 120.0, 320.0, 40.0, 20.0, 300.0, 20.0, 35.0, 50.0, 380.0, 60.0, 180.0, 50.0, 80.0, 0.0, 90.0, 30.0, 180.0, 810.0, 60.0, 60.0, 160.0, 120.0, 370.0, 10.0, 80.0, 40.0, 100.0, 70.0, 40.0, 170.0, 390.0, 30.0, 170.0, 70.0, 30.0, 40.0, 70.0, 60.0, 90.0, 340.0, 60.0, 430.0, 180.0, 30.0, 50.0, 290.0, 120.0, 180.0, 410.0, 210.0, 170.0, 90.0, 70.0, 30.0, 30.0, 160.0, 740.0, 320.0, 80.0, 20.0, 120.0, 280.0, 50.0, 470.0, -90.0, 50.0, 120.0, 40.0, 200.0, 130.0, 90.0, 0.0, 20.0, 80.0, 0.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 180.0, 40.0, 780.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 120.0, 60.0, 20.0, 20.0, 30.0, 55.0, 200.0, 230.0, 10.0, 40.0, 20.0, 20.0, -10.0, 130.0, 180.0, 80.0, 60.0, 230.0, 40.0, 540.0, 40.0, 20.0, 60.0, 40.0, 80.0, 90.0, 190.0, 50.0, 360.0, 100.0, 5.0, -20.0, 300.0, -5.0, 60.0, 30.0, 30.0, -60.0, 180.0, 50.0, 20.0, 450.0, 60.0, 120.0, 40.0, 90.0, 130.0, 160.0, -30.0, 400.0, 190.0, -90.0, -290.0, 110.0, 20.0, 10.0, 30.0, 520.0, 210.0, 260.0, 40.0, -110.0, 690.0, 20.0, 150.0, 140.0, 30.0, 10.0, 160.0, 600.0, 220.0, 230.0, 50.0, 210.0, 70.0, 60.0, 60.0, 0.0, 20.0, 100.0, 30.0, 130.0, 190.0, 310.0, 70.0, 100.0, 190.0, 20.0, 20.0, 300.0, 270.0, 160.0, 70.0, 100.0, 70.0, 110.0, 190.0, 30.0, -20.0, 30.0, 200.0, 20.0, 40.0, 40.0, 370.0, -30.0, 10.0, 190.0, 30.0, 0.0, 130.0, 50.0, 110.0, 130.0, 40.0, 30.0, 30.0, 180.0, 510.0, 30.0, 300.0, -40.0, 40.0, 40.0, -10.0, 100.0, 0.0, 70.0, 30.0, 0.0, 20.0, 50.0, 40.0, 0.0, 360.0, 370.0, 20.0, 30.0, 150.0, 80.0, 80.0, 30.0, 20.0, 430.0, 60.0, 300.0, 90.0, 60.0, 320.0, 55.0, 70.0, 20.0, 220.0, 230.0, 200.0, 450.0, 0.0, 40.0, 180.0, 180.0, 60.0, 350.0, 90.0, -110.0, 10.0, 250.0, 30.0, 180.0, 0.0, 70.0, 10.0, 20.0, 10.0, 0.0, 350.0, 320.0, 40.0, 60.0, 440.0, 40.0, 320.0, 170.0, 470.0, 110.0, 60.0, 90.0, 30.0, 70.0, 90.0, 260.0, 90.0, 50.0, 80.0, 160.0, 60.0, 320.0, 210.0, 0.0, 70.0, 130.0, 230.0, 500.0, 190.0, 290.0, 190.0, 130.0, 40.0, 70.0, 10.0, 380.0, 100.0, 30.0, -40.0, 40.0, 60.0, 100.0, 940.0, 40.0, 120.0, 0.0, 60.0, 20.0, 40.0, 150.0, 50.0, 40.0, 40.0, 110.0, 170.0, 230.0, 50.0, 10.0, 30.0, 40.0, 20.0, 50.0, 10.0, 40.0, 40.0, 60.0, 290.0, 190.0, -20.0, 70.0, 110.0, 280.0, 70.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9919803320699, "mean_inference_ms": 2.042756549135812, "mean_action_processing_ms": 0.5376745734860264, "mean_env_wait_ms": 1.7295141589662648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013742208480834961, "StateBufferConnector_ms": 0.015710115432739258, "ViewRequirementAgentConnector_ms": 0.46088433265686035}, "num_episodes": 23, "episode_return_max": 2090.0, "episode_return_min": -1480.0, "episode_return_mean": 1092.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 7.712566323067596, "num_env_steps_trained_throughput_per_sec": 7.712566323067596, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 4240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4240000, "timers": {"training_iteration_time_ms": 248066.423, "restore_workers_time_ms": 0.02, "training_step_time_ms": 248066.355, "sample_time_ms": 2901.262, "learn_time_ms": 245140.01, "learn_throughput": 16.317, "synch_weights_time_ms": 12.904}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "done": false, "training_iteration": 106, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-16-54", "timestamp": 1717262214, "time_this_iter_s": 518.656580209732, "time_total_s": 53029.45905327797, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c14d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53029.45905327797, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.88888888888889, "ram_util_percent": 82.44006734006734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.449897284236071, "cur_kl_coeff": 1.3684184074401853, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0058155704319429475, "vf_loss": 6.471902398534984, "vf_explained_var": 0.0008137156343815552, "kl": Infinity, "entropy": 0.25189840537481034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1000035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 190.0, "episode_reward_mean": 1092.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 109.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1370.0, 820.0, 1750.0, 1660.0, 465.0, 970.0, 760.0, 1100.0, 1370.0, 1660.0, 590.0, 1570.0, 935.0, 1550.0, 1845.0, 760.0, 700.0, 2010.0, 1470.0, 725.0, 900.0, 1455.0, 310.0, 800.0, 480.0, 510.0, 1160.0, 650.0, 1420.0, 700.0, 1140.0, 1140.0, 850.0, 1220.0, 650.0, 1590.0, 860.0, 1065.0, 330.0, 1620.0, 1730.0, 1500.0, 1030.0, 960.0, 450.0, 1000.0, 770.0, 540.0, 1295.0, 1540.0, 1050.0, 1120.0, 2090.0, 1900.0, 1260.0, 430.0, 1060.0, 765.0, 760.0, 1150.0, 800.0, 1300.0, 870.0, 1440.0, 1660.0, 1160.0, 1320.0, 850.0, 730.0, 1040.0, 920.0, 1300.0, 1605.0, 1220.0, 880.0, 1800.0, 1320.0, 1840.0, 1660.0, 630.0, 650.0, 1110.0, 1690.0, 420.0, 930.0, 1020.0, 1070.0, 1220.0, 190.0, 820.0, 1485.0, 880.0, 1060.0, 670.0, 1240.0, 800.0, 1130.0, 1460.0, 800.0, 880.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 510.0, 190.0, 60.0, 40.0, 10.0, 70.0, 20.0, 140.0, 150.0, 40.0, 30.0, 20.0, 80.0, 10.0, 310.0, 0.0, 20.0, 20.0, 290.0, 170.0, 20.0, 70.0, 150.0, 190.0, 510.0, 60.0, 310.0, 80.0, 190.0, 10.0, 130.0, 220.0, 320.0, 110.0, 420.0, 50.0, 20.0, 290.0, 90.0, 60.0, 80.0, 120.0, 30.0, 0.0, 50.0, 80.0, 20.0, 10.0, 15.0, 10.0, 40.0, 20.0, 190.0, 180.0, 20.0, 40.0, 330.0, 20.0, 120.0, 50.0, 20.0, 10.0, 110.0, 40.0, 290.0, 30.0, 100.0, 20.0, 90.0, 100.0, 140.0, 45.0, 20.0, 30.0, -70.0, 600.0, 190.0, 35.0, 10.0, 310.0, 170.0, 30.0, 110.0, 230.0, 50.0, 70.0, 70.0, 130.0, 200.0, 30.0, 470.0, 110.0, 200.0, 40.0, 240.0, 30.0, 80.0, 30.0, 430.0, 0.0, 20.0, 40.0, 170.0, 20.0, 40.0, 20.0, 90.0, 0.0, 190.0, 20.0, 20.0, 20.0, 40.0, 120.0, 240.0, 460.0, 300.0, 290.0, 60.0, 30.0, 140.0, 20.0, 50.0, 350.0, -5.0, 10.0, 70.0, 20.0, 250.0, 420.0, 90.0, 650.0, -10.0, 160.0, 100.0, 50.0, 130.0, -50.0, 10.0, 220.0, 65.0, 60.0, 80.0, 30.0, 150.0, 30.0, 440.0, 610.0, 160.0, 20.0, 60.0, 50.0, 40.0, 40.0, 390.0, 130.0, 10.0, 20.0, 0.0, 0.0, -30.0, 20.0, 280.0, 20.0, 20.0, 280.0, 60.0, 50.0, 0.0, 150.0, 60.0, 120.0, -20.0, 210.0, 700.0, 110.0, 300.0, 290.0, 90.0, 250.0, 10.0, 650.0, 130.0, 50.0, 90.0, 30.0, 50.0, 170.0, 40.0, 35.0, 30.0, 70.0, 170.0, 30.0, 30.0, 0.0, 40.0, 320.0, 0.0, 0.0, 40.0, 40.0, 0.0, 180.0, 340.0, 150.0, 60.0, 50.0, 40.0, 110.0, 390.0, 40.0, 150.0, 70.0, 330.0, 160.0, 190.0, -55.0, 70.0, 170.0, -80.0, 40.0, 20.0, 70.0, 50.0, 80.0, -140.0, 20.0, 80.0, 80.0, 240.0, 0.0, 20.0, 20.0, 40.0, 10.0, 240.0, 130.0, 20.0, 10.0, 30.0, 10.0, 110.0, 210.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 100.0, 10.0, 110.0, 180.0, 10.0, 300.0, 100.0, 180.0, 50.0, -20.0, 390.0, 0.0, 130.0, 20.0, 60.0, 20.0, 30.0, 290.0, 20.0, 20.0, 10.0, 120.0, 10.0, 70.0, 30.0, 730.0, 80.0, 100.0, 140.0, 30.0, 40.0, 50.0, 60.0, 160.0, 100.0, 300.0, 40.0, 20.0, 20.0, 20.0, 110.0, 0.0, 0.0, 90.0, 10.0, 90.0, 10.0, 100.0, 290.0, 30.0, 160.0, 160.0, 280.0, 10.0, 50.0, 220.0, 140.0, 110.0, 40.0, 50.0, 120.0, 280.0, 40.0, 90.0, -20.0, -20.0, 90.0, 120.0, 80.0, 30.0, -30.0, 290.0, -30.0, 340.0, 110.0, 70.0, 130.0, 90.0, 80.0, 180.0, 20.0, 350.0, 60.0, 130.0, 20.0, 10.0, 150.0, 170.0, 80.0, 10.0, 50.0, 0.0, 120.0, 40.0, 60.0, -150.0, 100.0, 60.0, 180.0, 240.0, 10.0, 620.0, 270.0, 200.0, 180.0, 10.0, 200.0, 70.0, 30.0, 250.0, 20.0, 20.0, 50.0, 30.0, 130.0, 5.0, 170.0, 20.0, -240.0, 100.0, 370.0, 110.0, 120.0, 280.0, 30.0, 0.0, 10.0, 70.0, 40.0, 30.0, 110.0, 40.0, 0.0, 0.0, 30.0, 300.0, 60.0, 510.0, 40.0, 320.0, 190.0, 60.0, 20.0, 90.0, 270.0, 160.0, 140.0, 80.0, 40.0, 350.0, 20.0, 130.0, 60.0, 480.0, 80.0, 120.0, 50.0, 110.0, 300.0, 100.0, 150.0, 0.0, 280.0, 310.0, 70.0, 100.0, 180.0, -30.0, 50.0, 400.0, 10.0, 80.0, 10.0, 160.0, 40.0, 50.0, 240.0, 0.0, 470.0, 40.0, 50.0, 0.0, 0.0, 70.0, 30.0, 170.0, 10.0, 0.0, 0.0, 90.0, 10.0, -40.0, 0.0, 180.0, 70.0, 0.0, 150.0, 290.0, 230.0, 90.0, 100.0, 40.0, 0.0, 30.0, 10.0, 110.0, 30.0, 370.0, 20.0, 100.0, 10.0, 30.0, 40.0, 50.0, 190.0, 20.0, 60.0, 0.0, 180.0, 10.0, 10.0, 40.0, 0.0, 30.0, 10.0, 120.0, 320.0, 40.0, 20.0, 300.0, 20.0, 35.0, 50.0, 380.0, 60.0, 180.0, 50.0, 80.0, 0.0, 90.0, 30.0, 180.0, 810.0, 60.0, 60.0, 160.0, 120.0, 370.0, 10.0, 80.0, 40.0, 100.0, 70.0, 40.0, 170.0, 390.0, 30.0, 170.0, 70.0, 30.0, 40.0, 70.0, 60.0, 90.0, 340.0, 60.0, 430.0, 180.0, 30.0, 50.0, 290.0, 120.0, 180.0, 410.0, 210.0, 170.0, 90.0, 70.0, 30.0, 30.0, 160.0, 740.0, 320.0, 80.0, 20.0, 120.0, 280.0, 50.0, 470.0, -90.0, 50.0, 120.0, 40.0, 200.0, 130.0, 90.0, 0.0, 20.0, 80.0, 0.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 180.0, 40.0, 780.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 120.0, 60.0, 20.0, 20.0, 30.0, 55.0, 200.0, 230.0, 10.0, 40.0, 20.0, 20.0, -10.0, 130.0, 180.0, 80.0, 60.0, 230.0, 40.0, 540.0, 40.0, 20.0, 60.0, 40.0, 80.0, 90.0, 190.0, 50.0, 360.0, 100.0, 5.0, -20.0, 300.0, -5.0, 60.0, 30.0, 30.0, -60.0, 180.0, 50.0, 20.0, 450.0, 60.0, 120.0, 40.0, 90.0, 130.0, 160.0, -30.0, 400.0, 190.0, -90.0, -290.0, 110.0, 20.0, 10.0, 30.0, 520.0, 210.0, 260.0, 40.0, -110.0, 690.0, 20.0, 150.0, 140.0, 30.0, 10.0, 160.0, 600.0, 220.0, 230.0, 50.0, 210.0, 70.0, 60.0, 60.0, 0.0, 20.0, 100.0, 30.0, 130.0, 190.0, 310.0, 70.0, 100.0, 190.0, 20.0, 20.0, 300.0, 270.0, 160.0, 70.0, 100.0, 70.0, 110.0, 190.0, 30.0, -20.0, 30.0, 200.0, 20.0, 40.0, 40.0, 370.0, -30.0, 10.0, 190.0, 30.0, 0.0, 130.0, 50.0, 110.0, 130.0, 40.0, 30.0, 30.0, 180.0, 510.0, 30.0, 300.0, -40.0, 40.0, 40.0, -10.0, 100.0, 0.0, 70.0, 30.0, 0.0, 20.0, 50.0, 40.0, 0.0, 360.0, 370.0, 20.0, 30.0, 150.0, 80.0, 80.0, 30.0, 20.0, 430.0, 60.0, 300.0, 90.0, 60.0, 320.0, 55.0, 70.0, 20.0, 220.0, 230.0, 200.0, 450.0, 0.0, 40.0, 180.0, 180.0, 60.0, 350.0, 90.0, -110.0, 10.0, 250.0, 30.0, 180.0, 0.0, 70.0, 10.0, 20.0, 10.0, 0.0, 350.0, 320.0, 40.0, 60.0, 440.0, 40.0, 320.0, 170.0, 470.0, 110.0, 60.0, 90.0, 30.0, 70.0, 90.0, 260.0, 90.0, 50.0, 80.0, 160.0, 60.0, 320.0, 210.0, 0.0, 70.0, 130.0, 230.0, 500.0, 190.0, 290.0, 190.0, 130.0, 40.0, 70.0, 10.0, 380.0, 100.0, 30.0, -40.0, 40.0, 60.0, 100.0, 940.0, 40.0, 120.0, 0.0, 60.0, 20.0, 40.0, 150.0, 50.0, 40.0, 40.0, 110.0, 170.0, 230.0, 50.0, 10.0, 30.0, 40.0, 20.0, 50.0, 10.0, 40.0, 40.0, 60.0, 290.0, 190.0, -20.0, 70.0, 110.0, 280.0, 70.0, 20.0, -20.0, 40.0, 170.0, 130.0, 0.0, 580.0, 150.0, 40.0, 540.0, 60.0, 0.0, 160.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 60.0, 110.0, 10.0, 0.0, 40.0, 5.0, 10.0, 0.0, 545.0, 100.0, 110.0, 0.0, 180.0, 60.0, 380.0, 50.0, 30.0, 170.0, 20.0, 50.0, 80.0, 80.0, -120.0, 490.0, 30.0, 80.0, 210.0, 40.0, 10.0, 60.0, 190.0, 100.0, 310.0, 110.0, 480.0, 60.0, 80.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 90.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 320.0, 0.0, 20.0, 0.0, 60.0, 200.0, 160.0, 40.0, 60.0, 40.0, 310.0, 430.0, 310.0, 50.0, -5.0, 30.0, 220.0, 40.0, 270.0, 200.0, 40.0, 80.0, 100.0, 80.0, 40.0, 20.0, 10.0, 40.0, 10.0, 20.0, 380.0, 70.0, 80.0, 20.0, 10.0, 10.0, 420.0, 10.0, 10.0, 10.0, 120.0, 10.0, 60.0, 40.0, 260.0, 80.0, 70.0, 30.0, 70.0, 40.0, 200.0, 30.0, 30.0, 550.0, 130.0, 130.0, 30.0, 40.0, 40.0, 40.0, 10.0, 160.0, 110.0, 10.0, 170.0, 180.0, 40.0, 120.0, 40.0, 30.0, 550.0, 0.0, 10.0, 30.0, 50.0, 300.0, 0.0, 30.0, 110.0, -40.0, 200.0, 170.0, -90.0, 440.0, 430.0, 170.0, 40.0, 330.0, 70.0, 270.0, 100.0, -110.0, 80.0, 0.0, 90.0, -50.0, 20.0, 0.0, 20.0, 180.0, 50.0, 40.0, 20.0, 0.0, 180.0, 80.0, 310.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.988722886143136, "mean_inference_ms": 2.040619859313229, "mean_action_processing_ms": 0.5369267793978524, "mean_env_wait_ms": 1.7271440023161668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01409769058227539, "StateBufferConnector_ms": 0.010608673095703125, "ViewRequirementAgentConnector_ms": 0.46088314056396484}, "num_episodes": 18, "episode_return_max": 2090.0, "episode_return_min": 190.0, "episode_return_mean": 1092.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.403605542039735, "num_env_steps_trained_throughput_per_sec": 19.403605542039735, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 4280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4280000, "timers": {"training_iteration_time_ms": 247750.048, "restore_workers_time_ms": 0.02, "training_step_time_ms": 247749.98, "sample_time_ms": 2965.949, "learn_time_ms": 244759.666, "learn_throughput": 16.343, "synch_weights_time_ms": 12.665}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "done": false, "training_iteration": 107, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-20-20", "timestamp": 1717262420, "time_this_iter_s": 206.18758010864258, "time_total_s": 53235.64663338661, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c19700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53235.64663338661, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 26.583959044368598, "ram_util_percent": 82.30068259385665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4421959284522408, "cur_kl_coeff": 2.0526276111602786, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004148775763280047, "vf_loss": 6.602772385878557, "vf_explained_var": 0.0006668201460244175, "kl": Infinity, "entropy": 0.2285651534002302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1009425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 190.0, "episode_reward_mean": 1045.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 104.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.0, 800.0, 480.0, 510.0, 1160.0, 650.0, 1420.0, 700.0, 1140.0, 1140.0, 850.0, 1220.0, 650.0, 1590.0, 860.0, 1065.0, 330.0, 1620.0, 1730.0, 1500.0, 1030.0, 960.0, 450.0, 1000.0, 770.0, 540.0, 1295.0, 1540.0, 1050.0, 1120.0, 2090.0, 1900.0, 1260.0, 430.0, 1060.0, 765.0, 760.0, 1150.0, 800.0, 1300.0, 870.0, 1440.0, 1660.0, 1160.0, 1320.0, 850.0, 730.0, 1040.0, 920.0, 1300.0, 1605.0, 1220.0, 880.0, 1800.0, 1320.0, 1840.0, 1660.0, 630.0, 650.0, 1110.0, 1690.0, 420.0, 930.0, 1020.0, 1070.0, 1220.0, 190.0, 820.0, 1485.0, 880.0, 1060.0, 670.0, 1240.0, 800.0, 1130.0, 1460.0, 800.0, 880.0, 550.0, 530.0, 1085.0, 1050.0, 1670.0, 835.0, 395.0, 630.0, 860.0, 580.0, 1190.0, 1090.0, 1510.0, 660.0, 600.0, 1650.0, 1140.0, 900.0, 1310.0, 730.0, 1580.0, 1270.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, -80.0, 40.0, 20.0, 70.0, 50.0, 80.0, -140.0, 20.0, 80.0, 80.0, 240.0, 0.0, 20.0, 20.0, 40.0, 10.0, 240.0, 130.0, 20.0, 10.0, 30.0, 10.0, 110.0, 210.0, 20.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 20.0, 30.0, 100.0, 10.0, 110.0, 180.0, 10.0, 300.0, 100.0, 180.0, 50.0, -20.0, 390.0, 0.0, 130.0, 20.0, 60.0, 20.0, 30.0, 290.0, 20.0, 20.0, 10.0, 120.0, 10.0, 70.0, 30.0, 730.0, 80.0, 100.0, 140.0, 30.0, 40.0, 50.0, 60.0, 160.0, 100.0, 300.0, 40.0, 20.0, 20.0, 20.0, 110.0, 0.0, 0.0, 90.0, 10.0, 90.0, 10.0, 100.0, 290.0, 30.0, 160.0, 160.0, 280.0, 10.0, 50.0, 220.0, 140.0, 110.0, 40.0, 50.0, 120.0, 280.0, 40.0, 90.0, -20.0, -20.0, 90.0, 120.0, 80.0, 30.0, -30.0, 290.0, -30.0, 340.0, 110.0, 70.0, 130.0, 90.0, 80.0, 180.0, 20.0, 350.0, 60.0, 130.0, 20.0, 10.0, 150.0, 170.0, 80.0, 10.0, 50.0, 0.0, 120.0, 40.0, 60.0, -150.0, 100.0, 60.0, 180.0, 240.0, 10.0, 620.0, 270.0, 200.0, 180.0, 10.0, 200.0, 70.0, 30.0, 250.0, 20.0, 20.0, 50.0, 30.0, 130.0, 5.0, 170.0, 20.0, -240.0, 100.0, 370.0, 110.0, 120.0, 280.0, 30.0, 0.0, 10.0, 70.0, 40.0, 30.0, 110.0, 40.0, 0.0, 0.0, 30.0, 300.0, 60.0, 510.0, 40.0, 320.0, 190.0, 60.0, 20.0, 90.0, 270.0, 160.0, 140.0, 80.0, 40.0, 350.0, 20.0, 130.0, 60.0, 480.0, 80.0, 120.0, 50.0, 110.0, 300.0, 100.0, 150.0, 0.0, 280.0, 310.0, 70.0, 100.0, 180.0, -30.0, 50.0, 400.0, 10.0, 80.0, 10.0, 160.0, 40.0, 50.0, 240.0, 0.0, 470.0, 40.0, 50.0, 0.0, 0.0, 70.0, 30.0, 170.0, 10.0, 0.0, 0.0, 90.0, 10.0, -40.0, 0.0, 180.0, 70.0, 0.0, 150.0, 290.0, 230.0, 90.0, 100.0, 40.0, 0.0, 30.0, 10.0, 110.0, 30.0, 370.0, 20.0, 100.0, 10.0, 30.0, 40.0, 50.0, 190.0, 20.0, 60.0, 0.0, 180.0, 10.0, 10.0, 40.0, 0.0, 30.0, 10.0, 120.0, 320.0, 40.0, 20.0, 300.0, 20.0, 35.0, 50.0, 380.0, 60.0, 180.0, 50.0, 80.0, 0.0, 90.0, 30.0, 180.0, 810.0, 60.0, 60.0, 160.0, 120.0, 370.0, 10.0, 80.0, 40.0, 100.0, 70.0, 40.0, 170.0, 390.0, 30.0, 170.0, 70.0, 30.0, 40.0, 70.0, 60.0, 90.0, 340.0, 60.0, 430.0, 180.0, 30.0, 50.0, 290.0, 120.0, 180.0, 410.0, 210.0, 170.0, 90.0, 70.0, 30.0, 30.0, 160.0, 740.0, 320.0, 80.0, 20.0, 120.0, 280.0, 50.0, 470.0, -90.0, 50.0, 120.0, 40.0, 200.0, 130.0, 90.0, 0.0, 20.0, 80.0, 0.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 180.0, 40.0, 780.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 120.0, 60.0, 20.0, 20.0, 30.0, 55.0, 200.0, 230.0, 10.0, 40.0, 20.0, 20.0, -10.0, 130.0, 180.0, 80.0, 60.0, 230.0, 40.0, 540.0, 40.0, 20.0, 60.0, 40.0, 80.0, 90.0, 190.0, 50.0, 360.0, 100.0, 5.0, -20.0, 300.0, -5.0, 60.0, 30.0, 30.0, -60.0, 180.0, 50.0, 20.0, 450.0, 60.0, 120.0, 40.0, 90.0, 130.0, 160.0, -30.0, 400.0, 190.0, -90.0, -290.0, 110.0, 20.0, 10.0, 30.0, 520.0, 210.0, 260.0, 40.0, -110.0, 690.0, 20.0, 150.0, 140.0, 30.0, 10.0, 160.0, 600.0, 220.0, 230.0, 50.0, 210.0, 70.0, 60.0, 60.0, 0.0, 20.0, 100.0, 30.0, 130.0, 190.0, 310.0, 70.0, 100.0, 190.0, 20.0, 20.0, 300.0, 270.0, 160.0, 70.0, 100.0, 70.0, 110.0, 190.0, 30.0, -20.0, 30.0, 200.0, 20.0, 40.0, 40.0, 370.0, -30.0, 10.0, 190.0, 30.0, 0.0, 130.0, 50.0, 110.0, 130.0, 40.0, 30.0, 30.0, 180.0, 510.0, 30.0, 300.0, -40.0, 40.0, 40.0, -10.0, 100.0, 0.0, 70.0, 30.0, 0.0, 20.0, 50.0, 40.0, 0.0, 360.0, 370.0, 20.0, 30.0, 150.0, 80.0, 80.0, 30.0, 20.0, 430.0, 60.0, 300.0, 90.0, 60.0, 320.0, 55.0, 70.0, 20.0, 220.0, 230.0, 200.0, 450.0, 0.0, 40.0, 180.0, 180.0, 60.0, 350.0, 90.0, -110.0, 10.0, 250.0, 30.0, 180.0, 0.0, 70.0, 10.0, 20.0, 10.0, 0.0, 350.0, 320.0, 40.0, 60.0, 440.0, 40.0, 320.0, 170.0, 470.0, 110.0, 60.0, 90.0, 30.0, 70.0, 90.0, 260.0, 90.0, 50.0, 80.0, 160.0, 60.0, 320.0, 210.0, 0.0, 70.0, 130.0, 230.0, 500.0, 190.0, 290.0, 190.0, 130.0, 40.0, 70.0, 10.0, 380.0, 100.0, 30.0, -40.0, 40.0, 60.0, 100.0, 940.0, 40.0, 120.0, 0.0, 60.0, 20.0, 40.0, 150.0, 50.0, 40.0, 40.0, 110.0, 170.0, 230.0, 50.0, 10.0, 30.0, 40.0, 20.0, 50.0, 10.0, 40.0, 40.0, 60.0, 290.0, 190.0, -20.0, 70.0, 110.0, 280.0, 70.0, 20.0, -20.0, 40.0, 170.0, 130.0, 0.0, 580.0, 150.0, 40.0, 540.0, 60.0, 0.0, 160.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 60.0, 110.0, 10.0, 0.0, 40.0, 5.0, 10.0, 0.0, 545.0, 100.0, 110.0, 0.0, 180.0, 60.0, 380.0, 50.0, 30.0, 170.0, 20.0, 50.0, 80.0, 80.0, -120.0, 490.0, 30.0, 80.0, 210.0, 40.0, 10.0, 60.0, 190.0, 100.0, 310.0, 110.0, 480.0, 60.0, 80.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 90.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 320.0, 0.0, 20.0, 0.0, 60.0, 200.0, 160.0, 40.0, 60.0, 40.0, 310.0, 430.0, 310.0, 50.0, -5.0, 30.0, 220.0, 40.0, 270.0, 200.0, 40.0, 80.0, 100.0, 80.0, 40.0, 20.0, 10.0, 40.0, 10.0, 20.0, 380.0, 70.0, 80.0, 20.0, 10.0, 10.0, 420.0, 10.0, 10.0, 10.0, 120.0, 10.0, 60.0, 40.0, 260.0, 80.0, 70.0, 30.0, 70.0, 40.0, 200.0, 30.0, 30.0, 550.0, 130.0, 130.0, 30.0, 40.0, 40.0, 40.0, 10.0, 160.0, 110.0, 10.0, 170.0, 180.0, 40.0, 120.0, 40.0, 30.0, 550.0, 0.0, 10.0, 30.0, 50.0, 300.0, 0.0, 30.0, 110.0, -40.0, 200.0, 170.0, -90.0, 440.0, 430.0, 170.0, 40.0, 330.0, 70.0, 270.0, 100.0, -110.0, 80.0, 0.0, 90.0, -50.0, 20.0, 0.0, 20.0, 180.0, 50.0, 40.0, 20.0, 0.0, 180.0, 80.0, 310.0, 380.0, -100.0, 140.0, -35.0, 80.0, 40.0, 10.0, 10.0, 70.0, -45.0, 180.0, 30.0, -5.0, 50.0, 40.0, 80.0, 60.0, 100.0, 0.0, -5.0, 20.0, 300.0, 190.0, 290.0, 35.0, 30.0, 30.0, 0.0, 190.0, 0.0, 80.0, 420.0, 90.0, 60.0, 320.0, 50.0, 20.0, 0.0, 20.0, -10.0, 130.0, 70.0, 310.0, 120.0, 230.0, 40.0, 130.0, 300.0, 320.0, 20.0, 195.0, 0.0, 70.0, -65.0, 40.0, 160.0, 30.0, -35.0, 380.0, 60.0, 40.0, 40.0, 200.0, 15.0, 0.0, 40.0, 0.0, 40.0, 0.0, 20.0, 90.0, 60.0, 40.0, 40.0, 20.0, 10.0, 270.0, 80.0, 20.0, 0.0, 0.0, 190.0, 30.0, 0.0, 110.0, 0.0, 50.0, 110.0, 20.0, 350.0, 110.0, 100.0, 20.0, 20.0, 20.0, 20.0, 60.0, 90.0, 120.0, 20.0, 10.0, 70.0, 90.0, 620.0, 30.0, 30.0, 200.0, 10.0, 30.0, 100.0, 60.0, 210.0, 160.0, 0.0, 10.0, 50.0, 0.0, 40.0, 510.0, 50.0, 40.0, 110.0, 220.0, 60.0, 200.0, 90.0, 360.0, 40.0, 380.0, 10.0, 90.0, 20.0, 40.0, 290.0, 30.0, 90.0, 30.0, 20.0, 40.0, 10.0, 0.0, 210.0, 180.0, 180.0, 0.0, 50.0, 10.0, 50.0, 10.0, -90.0, 70.0, 110.0, 60.0, 680.0, -10.0, 150.0, 80.0, 410.0, 80.0, 20.0, 70.0, 310.0, 170.0, 160.0, 30.0, 40.0, 60.0, 260.0, 30.0, 10.0, 150.0, 220.0, 80.0, 20.0, 10.0, 20.0, 100.0, 80.0, 90.0, 130.0, 150.0, 60.0, 20.0, 50.0, 100.0, 200.0, 640.0, 40.0, 20.0, 30.0, 30.0, 40.0, 10.0, 360.0, 40.0, 120.0, 80.0, 0.0, 10.0, 40.0, 20.0, 220.0, 30.0, 470.0, 60.0, 540.0, -20.0, 190.0, 60.0, 10.0, 140.0, 0.0, -10.0, 40.0, 40.0, 20.0, 0.0, 1030.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.985146682964072, "mean_inference_ms": 2.038625841167363, "mean_action_processing_ms": 0.5361372629038865, "mean_env_wait_ms": 1.724669821938611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014141321182250977, "StateBufferConnector_ms": 0.011806964874267578, "ViewRequirementAgentConnector_ms": 0.478302001953125}, "num_episodes": 22, "episode_return_max": 2090.0, "episode_return_min": 190.0, "episode_return_mean": 1045.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.628283420720665, "num_env_steps_trained_throughput_per_sec": 5.628283420720665, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 4320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4320000, "timers": {"training_iteration_time_ms": 298149.272, "restore_workers_time_ms": 0.02, "training_step_time_ms": 298149.207, "sample_time_ms": 3013.822, "learn_time_ms": 295111.16, "learn_throughput": 13.554, "synch_weights_time_ms": 12.81}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "done": false, "training_iteration": 108, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-32-11", "timestamp": 1717263131, "time_this_iter_s": 710.7378628253937, "time_total_s": 53946.384496212006, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c328b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53946.384496212006, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 25.693174061433446, "ram_util_percent": 82.19897610921501}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.63951265632281, "cur_kl_coeff": 3.0789414167404177, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0036648449512035907, "vf_loss": 6.130181453834834, "vf_explained_var": 0.000362162284069041, "kl": Infinity, "entropy": 0.22774704354830064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1018815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 90.0, "episode_reward_mean": 1050.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 105.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1730.0, 1500.0, 1030.0, 960.0, 450.0, 1000.0, 770.0, 540.0, 1295.0, 1540.0, 1050.0, 1120.0, 2090.0, 1900.0, 1260.0, 430.0, 1060.0, 765.0, 760.0, 1150.0, 800.0, 1300.0, 870.0, 1440.0, 1660.0, 1160.0, 1320.0, 850.0, 730.0, 1040.0, 920.0, 1300.0, 1605.0, 1220.0, 880.0, 1800.0, 1320.0, 1840.0, 1660.0, 630.0, 650.0, 1110.0, 1690.0, 420.0, 930.0, 1020.0, 1070.0, 1220.0, 190.0, 820.0, 1485.0, 880.0, 1060.0, 670.0, 1240.0, 800.0, 1130.0, 1460.0, 800.0, 880.0, 550.0, 530.0, 1085.0, 1050.0, 1670.0, 835.0, 395.0, 630.0, 860.0, 580.0, 1190.0, 1090.0, 1510.0, 660.0, 600.0, 1650.0, 1140.0, 900.0, 1310.0, 730.0, 1580.0, 1270.0, 1510.0, 550.0, 1650.0, 1050.0, 620.0, 90.0, 1350.0, 920.0, 960.0, 980.0, 1380.0, 1320.0, 1340.0, 1260.0, 510.0, 330.0, 510.0, 600.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [270.0, 160.0, 140.0, 80.0, 40.0, 350.0, 20.0, 130.0, 60.0, 480.0, 80.0, 120.0, 50.0, 110.0, 300.0, 100.0, 150.0, 0.0, 280.0, 310.0, 70.0, 100.0, 180.0, -30.0, 50.0, 400.0, 10.0, 80.0, 10.0, 160.0, 40.0, 50.0, 240.0, 0.0, 470.0, 40.0, 50.0, 0.0, 0.0, 70.0, 30.0, 170.0, 10.0, 0.0, 0.0, 90.0, 10.0, -40.0, 0.0, 180.0, 70.0, 0.0, 150.0, 290.0, 230.0, 90.0, 100.0, 40.0, 0.0, 30.0, 10.0, 110.0, 30.0, 370.0, 20.0, 100.0, 10.0, 30.0, 40.0, 50.0, 190.0, 20.0, 60.0, 0.0, 180.0, 10.0, 10.0, 40.0, 0.0, 30.0, 10.0, 120.0, 320.0, 40.0, 20.0, 300.0, 20.0, 35.0, 50.0, 380.0, 60.0, 180.0, 50.0, 80.0, 0.0, 90.0, 30.0, 180.0, 810.0, 60.0, 60.0, 160.0, 120.0, 370.0, 10.0, 80.0, 40.0, 100.0, 70.0, 40.0, 170.0, 390.0, 30.0, 170.0, 70.0, 30.0, 40.0, 70.0, 60.0, 90.0, 340.0, 60.0, 430.0, 180.0, 30.0, 50.0, 290.0, 120.0, 180.0, 410.0, 210.0, 170.0, 90.0, 70.0, 30.0, 30.0, 160.0, 740.0, 320.0, 80.0, 20.0, 120.0, 280.0, 50.0, 470.0, -90.0, 50.0, 120.0, 40.0, 200.0, 130.0, 90.0, 0.0, 20.0, 80.0, 0.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 180.0, 40.0, 780.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 20.0, 120.0, 60.0, 20.0, 20.0, 30.0, 55.0, 200.0, 230.0, 10.0, 40.0, 20.0, 20.0, -10.0, 130.0, 180.0, 80.0, 60.0, 230.0, 40.0, 540.0, 40.0, 20.0, 60.0, 40.0, 80.0, 90.0, 190.0, 50.0, 360.0, 100.0, 5.0, -20.0, 300.0, -5.0, 60.0, 30.0, 30.0, -60.0, 180.0, 50.0, 20.0, 450.0, 60.0, 120.0, 40.0, 90.0, 130.0, 160.0, -30.0, 400.0, 190.0, -90.0, -290.0, 110.0, 20.0, 10.0, 30.0, 520.0, 210.0, 260.0, 40.0, -110.0, 690.0, 20.0, 150.0, 140.0, 30.0, 10.0, 160.0, 600.0, 220.0, 230.0, 50.0, 210.0, 70.0, 60.0, 60.0, 0.0, 20.0, 100.0, 30.0, 130.0, 190.0, 310.0, 70.0, 100.0, 190.0, 20.0, 20.0, 300.0, 270.0, 160.0, 70.0, 100.0, 70.0, 110.0, 190.0, 30.0, -20.0, 30.0, 200.0, 20.0, 40.0, 40.0, 370.0, -30.0, 10.0, 190.0, 30.0, 0.0, 130.0, 50.0, 110.0, 130.0, 40.0, 30.0, 30.0, 180.0, 510.0, 30.0, 300.0, -40.0, 40.0, 40.0, -10.0, 100.0, 0.0, 70.0, 30.0, 0.0, 20.0, 50.0, 40.0, 0.0, 360.0, 370.0, 20.0, 30.0, 150.0, 80.0, 80.0, 30.0, 20.0, 430.0, 60.0, 300.0, 90.0, 60.0, 320.0, 55.0, 70.0, 20.0, 220.0, 230.0, 200.0, 450.0, 0.0, 40.0, 180.0, 180.0, 60.0, 350.0, 90.0, -110.0, 10.0, 250.0, 30.0, 180.0, 0.0, 70.0, 10.0, 20.0, 10.0, 0.0, 350.0, 320.0, 40.0, 60.0, 440.0, 40.0, 320.0, 170.0, 470.0, 110.0, 60.0, 90.0, 30.0, 70.0, 90.0, 260.0, 90.0, 50.0, 80.0, 160.0, 60.0, 320.0, 210.0, 0.0, 70.0, 130.0, 230.0, 500.0, 190.0, 290.0, 190.0, 130.0, 40.0, 70.0, 10.0, 380.0, 100.0, 30.0, -40.0, 40.0, 60.0, 100.0, 940.0, 40.0, 120.0, 0.0, 60.0, 20.0, 40.0, 150.0, 50.0, 40.0, 40.0, 110.0, 170.0, 230.0, 50.0, 10.0, 30.0, 40.0, 20.0, 50.0, 10.0, 40.0, 40.0, 60.0, 290.0, 190.0, -20.0, 70.0, 110.0, 280.0, 70.0, 20.0, -20.0, 40.0, 170.0, 130.0, 0.0, 580.0, 150.0, 40.0, 540.0, 60.0, 0.0, 160.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 60.0, 110.0, 10.0, 0.0, 40.0, 5.0, 10.0, 0.0, 545.0, 100.0, 110.0, 0.0, 180.0, 60.0, 380.0, 50.0, 30.0, 170.0, 20.0, 50.0, 80.0, 80.0, -120.0, 490.0, 30.0, 80.0, 210.0, 40.0, 10.0, 60.0, 190.0, 100.0, 310.0, 110.0, 480.0, 60.0, 80.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 90.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 320.0, 0.0, 20.0, 0.0, 60.0, 200.0, 160.0, 40.0, 60.0, 40.0, 310.0, 430.0, 310.0, 50.0, -5.0, 30.0, 220.0, 40.0, 270.0, 200.0, 40.0, 80.0, 100.0, 80.0, 40.0, 20.0, 10.0, 40.0, 10.0, 20.0, 380.0, 70.0, 80.0, 20.0, 10.0, 10.0, 420.0, 10.0, 10.0, 10.0, 120.0, 10.0, 60.0, 40.0, 260.0, 80.0, 70.0, 30.0, 70.0, 40.0, 200.0, 30.0, 30.0, 550.0, 130.0, 130.0, 30.0, 40.0, 40.0, 40.0, 10.0, 160.0, 110.0, 10.0, 170.0, 180.0, 40.0, 120.0, 40.0, 30.0, 550.0, 0.0, 10.0, 30.0, 50.0, 300.0, 0.0, 30.0, 110.0, -40.0, 200.0, 170.0, -90.0, 440.0, 430.0, 170.0, 40.0, 330.0, 70.0, 270.0, 100.0, -110.0, 80.0, 0.0, 90.0, -50.0, 20.0, 0.0, 20.0, 180.0, 50.0, 40.0, 20.0, 0.0, 180.0, 80.0, 310.0, 380.0, -100.0, 140.0, -35.0, 80.0, 40.0, 10.0, 10.0, 70.0, -45.0, 180.0, 30.0, -5.0, 50.0, 40.0, 80.0, 60.0, 100.0, 0.0, -5.0, 20.0, 300.0, 190.0, 290.0, 35.0, 30.0, 30.0, 0.0, 190.0, 0.0, 80.0, 420.0, 90.0, 60.0, 320.0, 50.0, 20.0, 0.0, 20.0, -10.0, 130.0, 70.0, 310.0, 120.0, 230.0, 40.0, 130.0, 300.0, 320.0, 20.0, 195.0, 0.0, 70.0, -65.0, 40.0, 160.0, 30.0, -35.0, 380.0, 60.0, 40.0, 40.0, 200.0, 15.0, 0.0, 40.0, 0.0, 40.0, 0.0, 20.0, 90.0, 60.0, 40.0, 40.0, 20.0, 10.0, 270.0, 80.0, 20.0, 0.0, 0.0, 190.0, 30.0, 0.0, 110.0, 0.0, 50.0, 110.0, 20.0, 350.0, 110.0, 100.0, 20.0, 20.0, 20.0, 20.0, 60.0, 90.0, 120.0, 20.0, 10.0, 70.0, 90.0, 620.0, 30.0, 30.0, 200.0, 10.0, 30.0, 100.0, 60.0, 210.0, 160.0, 0.0, 10.0, 50.0, 0.0, 40.0, 510.0, 50.0, 40.0, 110.0, 220.0, 60.0, 200.0, 90.0, 360.0, 40.0, 380.0, 10.0, 90.0, 20.0, 40.0, 290.0, 30.0, 90.0, 30.0, 20.0, 40.0, 10.0, 0.0, 210.0, 180.0, 180.0, 0.0, 50.0, 10.0, 50.0, 10.0, -90.0, 70.0, 110.0, 60.0, 680.0, -10.0, 150.0, 80.0, 410.0, 80.0, 20.0, 70.0, 310.0, 170.0, 160.0, 30.0, 40.0, 60.0, 260.0, 30.0, 10.0, 150.0, 220.0, 80.0, 20.0, 10.0, 20.0, 100.0, 80.0, 90.0, 130.0, 150.0, 60.0, 20.0, 50.0, 100.0, 200.0, 640.0, 40.0, 20.0, 30.0, 30.0, 40.0, 10.0, 360.0, 40.0, 120.0, 80.0, 0.0, 10.0, 40.0, 20.0, 220.0, 30.0, 470.0, 60.0, 540.0, -20.0, 190.0, 60.0, 10.0, 140.0, 0.0, -10.0, 40.0, 40.0, 20.0, 0.0, 1030.0, 0.0, 10.0, 470.0, 90.0, 30.0, 40.0, -50.0, 80.0, 10.0, 0.0, 210.0, 630.0, 0.0, 20.0, 20.0, 10.0, 20.0, 170.0, 160.0, 50.0, 100.0, 0.0, 40.0, 560.0, 20.0, 200.0, 40.0, 100.0, 310.0, 300.0, 100.0, -20.0, 40.0, 210.0, 50.0, 430.0, 10.0, 100.0, 10.0, -10.0, 20.0, 190.0, 80.0, 0.0, 0.0, 20.0, 210.0, 10.0, 10.0, 150.0, 60.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 270.0, 150.0, 30.0, 20.0, 30.0, 460.0, 0.0, 80.0, 20.0, 290.0, 40.0, 70.0, 290.0, 0.0, 30.0, 60.0, 40.0, 350.0, 60.0, -20.0, 250.0, 160.0, 40.0, 0.0, 0.0, 160.0, 70.0, 180.0, 0.0, 100.0, 580.0, 30.0, 35.0, 0.0, 10.0, 30.0, 10.0, 0.0, 270.0, 15.0, 270.0, 190.0, 350.0, 40.0, 30.0, 60.0, 80.0, 160.0, 90.0, 110.0, 510.0, 20.0, 30.0, 140.0, 390.0, 100.0, 10.0, 90.0, 30.0, 0.0, 270.0, 100.0, 50.0, 50.0, 330.0, 110.0, 60.0, 90.0, 60.0, 220.0, 30.0, 120.0, 110.0, -10.0, 170.0, 260.0, 30.0, 380.0, 120.0, 50.0, 50.0, 10.0, 40.0, 20.0, 20.0, 40.0, 170.0, 10.0, 130.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 30.0, 60.0, 20.0, 40.0, 20.0, 20.0, 0.0, 10.0, 170.0, 0.0, 40.0, 40.0, 0.0, 210.0, 30.0, 50.0, 40.0, 40.0, 0.0, 180.0, 160.0, 0.0, 10.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.982622966188628, "mean_inference_ms": 2.037268235307831, "mean_action_processing_ms": 0.5355641671967473, "mean_env_wait_ms": 1.7229278325378403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014320611953735352, "StateBufferConnector_ms": 0.011951684951782227, "ViewRequirementAgentConnector_ms": 0.4821755886077881}, "num_episodes": 18, "episode_return_max": 2090.0, "episode_return_min": 90.0, "episode_return_mean": 1050.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 11.027500852732247, "num_env_steps_trained_throughput_per_sec": 11.027500852732247, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 4360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4360000, "timers": {"training_iteration_time_ms": 314485.72, "restore_workers_time_ms": 0.014, "training_step_time_ms": 314485.647, "sample_time_ms": 2965.364, "learn_time_ms": 311495.728, "learn_throughput": 12.841, "synch_weights_time_ms": 12.949}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "done": false, "training_iteration": 109, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-38-14", "timestamp": 1717263494, "time_this_iter_s": 362.7612338066101, "time_total_s": 54309.145730018616, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dc430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54309.145730018616, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 29.382119205298018, "ram_util_percent": 82.67781456953641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.771287640272238, "cur_kl_coeff": 4.618412125110625, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0036673868360410466, "vf_loss": 6.812490440760684, "vf_explained_var": 0.0002212814312265577, "kl": Infinity, "entropy": 0.213278987611762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1028205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "env_runners": {"episode_reward_max": 2010.0, "episode_reward_min": 90.0, "episode_reward_mean": 1047.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 104.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [760.0, 1150.0, 800.0, 1300.0, 870.0, 1440.0, 1660.0, 1160.0, 1320.0, 850.0, 730.0, 1040.0, 920.0, 1300.0, 1605.0, 1220.0, 880.0, 1800.0, 1320.0, 1840.0, 1660.0, 630.0, 650.0, 1110.0, 1690.0, 420.0, 930.0, 1020.0, 1070.0, 1220.0, 190.0, 820.0, 1485.0, 880.0, 1060.0, 670.0, 1240.0, 800.0, 1130.0, 1460.0, 800.0, 880.0, 550.0, 530.0, 1085.0, 1050.0, 1670.0, 835.0, 395.0, 630.0, 860.0, 580.0, 1190.0, 1090.0, 1510.0, 660.0, 600.0, 1650.0, 1140.0, 900.0, 1310.0, 730.0, 1580.0, 1270.0, 1510.0, 550.0, 1650.0, 1050.0, 620.0, 90.0, 1350.0, 920.0, 960.0, 980.0, 1380.0, 1320.0, 1340.0, 1260.0, 510.0, 330.0, 510.0, 600.0, 970.0, 1410.0, 1470.0, 1100.0, 1530.0, 820.0, 930.0, 750.0, 890.0, 1440.0, 620.0, 855.0, 750.0, 1365.0, 2010.0, 1200.0, 1000.0, 1080.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 20.0, 20.0, -10.0, 130.0, 180.0, 80.0, 60.0, 230.0, 40.0, 540.0, 40.0, 20.0, 60.0, 40.0, 80.0, 90.0, 190.0, 50.0, 360.0, 100.0, 5.0, -20.0, 300.0, -5.0, 60.0, 30.0, 30.0, -60.0, 180.0, 50.0, 20.0, 450.0, 60.0, 120.0, 40.0, 90.0, 130.0, 160.0, -30.0, 400.0, 190.0, -90.0, -290.0, 110.0, 20.0, 10.0, 30.0, 520.0, 210.0, 260.0, 40.0, -110.0, 690.0, 20.0, 150.0, 140.0, 30.0, 10.0, 160.0, 600.0, 220.0, 230.0, 50.0, 210.0, 70.0, 60.0, 60.0, 0.0, 20.0, 100.0, 30.0, 130.0, 190.0, 310.0, 70.0, 100.0, 190.0, 20.0, 20.0, 300.0, 270.0, 160.0, 70.0, 100.0, 70.0, 110.0, 190.0, 30.0, -20.0, 30.0, 200.0, 20.0, 40.0, 40.0, 370.0, -30.0, 10.0, 190.0, 30.0, 0.0, 130.0, 50.0, 110.0, 130.0, 40.0, 30.0, 30.0, 180.0, 510.0, 30.0, 300.0, -40.0, 40.0, 40.0, -10.0, 100.0, 0.0, 70.0, 30.0, 0.0, 20.0, 50.0, 40.0, 0.0, 360.0, 370.0, 20.0, 30.0, 150.0, 80.0, 80.0, 30.0, 20.0, 430.0, 60.0, 300.0, 90.0, 60.0, 320.0, 55.0, 70.0, 20.0, 220.0, 230.0, 200.0, 450.0, 0.0, 40.0, 180.0, 180.0, 60.0, 350.0, 90.0, -110.0, 10.0, 250.0, 30.0, 180.0, 0.0, 70.0, 10.0, 20.0, 10.0, 0.0, 350.0, 320.0, 40.0, 60.0, 440.0, 40.0, 320.0, 170.0, 470.0, 110.0, 60.0, 90.0, 30.0, 70.0, 90.0, 260.0, 90.0, 50.0, 80.0, 160.0, 60.0, 320.0, 210.0, 0.0, 70.0, 130.0, 230.0, 500.0, 190.0, 290.0, 190.0, 130.0, 40.0, 70.0, 10.0, 380.0, 100.0, 30.0, -40.0, 40.0, 60.0, 100.0, 940.0, 40.0, 120.0, 0.0, 60.0, 20.0, 40.0, 150.0, 50.0, 40.0, 40.0, 110.0, 170.0, 230.0, 50.0, 10.0, 30.0, 40.0, 20.0, 50.0, 10.0, 40.0, 40.0, 60.0, 290.0, 190.0, -20.0, 70.0, 110.0, 280.0, 70.0, 20.0, -20.0, 40.0, 170.0, 130.0, 0.0, 580.0, 150.0, 40.0, 540.0, 60.0, 0.0, 160.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 60.0, 110.0, 10.0, 0.0, 40.0, 5.0, 10.0, 0.0, 545.0, 100.0, 110.0, 0.0, 180.0, 60.0, 380.0, 50.0, 30.0, 170.0, 20.0, 50.0, 80.0, 80.0, -120.0, 490.0, 30.0, 80.0, 210.0, 40.0, 10.0, 60.0, 190.0, 100.0, 310.0, 110.0, 480.0, 60.0, 80.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 90.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 320.0, 0.0, 20.0, 0.0, 60.0, 200.0, 160.0, 40.0, 60.0, 40.0, 310.0, 430.0, 310.0, 50.0, -5.0, 30.0, 220.0, 40.0, 270.0, 200.0, 40.0, 80.0, 100.0, 80.0, 40.0, 20.0, 10.0, 40.0, 10.0, 20.0, 380.0, 70.0, 80.0, 20.0, 10.0, 10.0, 420.0, 10.0, 10.0, 10.0, 120.0, 10.0, 60.0, 40.0, 260.0, 80.0, 70.0, 30.0, 70.0, 40.0, 200.0, 30.0, 30.0, 550.0, 130.0, 130.0, 30.0, 40.0, 40.0, 40.0, 10.0, 160.0, 110.0, 10.0, 170.0, 180.0, 40.0, 120.0, 40.0, 30.0, 550.0, 0.0, 10.0, 30.0, 50.0, 300.0, 0.0, 30.0, 110.0, -40.0, 200.0, 170.0, -90.0, 440.0, 430.0, 170.0, 40.0, 330.0, 70.0, 270.0, 100.0, -110.0, 80.0, 0.0, 90.0, -50.0, 20.0, 0.0, 20.0, 180.0, 50.0, 40.0, 20.0, 0.0, 180.0, 80.0, 310.0, 380.0, -100.0, 140.0, -35.0, 80.0, 40.0, 10.0, 10.0, 70.0, -45.0, 180.0, 30.0, -5.0, 50.0, 40.0, 80.0, 60.0, 100.0, 0.0, -5.0, 20.0, 300.0, 190.0, 290.0, 35.0, 30.0, 30.0, 0.0, 190.0, 0.0, 80.0, 420.0, 90.0, 60.0, 320.0, 50.0, 20.0, 0.0, 20.0, -10.0, 130.0, 70.0, 310.0, 120.0, 230.0, 40.0, 130.0, 300.0, 320.0, 20.0, 195.0, 0.0, 70.0, -65.0, 40.0, 160.0, 30.0, -35.0, 380.0, 60.0, 40.0, 40.0, 200.0, 15.0, 0.0, 40.0, 0.0, 40.0, 0.0, 20.0, 90.0, 60.0, 40.0, 40.0, 20.0, 10.0, 270.0, 80.0, 20.0, 0.0, 0.0, 190.0, 30.0, 0.0, 110.0, 0.0, 50.0, 110.0, 20.0, 350.0, 110.0, 100.0, 20.0, 20.0, 20.0, 20.0, 60.0, 90.0, 120.0, 20.0, 10.0, 70.0, 90.0, 620.0, 30.0, 30.0, 200.0, 10.0, 30.0, 100.0, 60.0, 210.0, 160.0, 0.0, 10.0, 50.0, 0.0, 40.0, 510.0, 50.0, 40.0, 110.0, 220.0, 60.0, 200.0, 90.0, 360.0, 40.0, 380.0, 10.0, 90.0, 20.0, 40.0, 290.0, 30.0, 90.0, 30.0, 20.0, 40.0, 10.0, 0.0, 210.0, 180.0, 180.0, 0.0, 50.0, 10.0, 50.0, 10.0, -90.0, 70.0, 110.0, 60.0, 680.0, -10.0, 150.0, 80.0, 410.0, 80.0, 20.0, 70.0, 310.0, 170.0, 160.0, 30.0, 40.0, 60.0, 260.0, 30.0, 10.0, 150.0, 220.0, 80.0, 20.0, 10.0, 20.0, 100.0, 80.0, 90.0, 130.0, 150.0, 60.0, 20.0, 50.0, 100.0, 200.0, 640.0, 40.0, 20.0, 30.0, 30.0, 40.0, 10.0, 360.0, 40.0, 120.0, 80.0, 0.0, 10.0, 40.0, 20.0, 220.0, 30.0, 470.0, 60.0, 540.0, -20.0, 190.0, 60.0, 10.0, 140.0, 0.0, -10.0, 40.0, 40.0, 20.0, 0.0, 1030.0, 0.0, 10.0, 470.0, 90.0, 30.0, 40.0, -50.0, 80.0, 10.0, 0.0, 210.0, 630.0, 0.0, 20.0, 20.0, 10.0, 20.0, 170.0, 160.0, 50.0, 100.0, 0.0, 40.0, 560.0, 20.0, 200.0, 40.0, 100.0, 310.0, 300.0, 100.0, -20.0, 40.0, 210.0, 50.0, 430.0, 10.0, 100.0, 10.0, -10.0, 20.0, 190.0, 80.0, 0.0, 0.0, 20.0, 210.0, 10.0, 10.0, 150.0, 60.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 270.0, 150.0, 30.0, 20.0, 30.0, 460.0, 0.0, 80.0, 20.0, 290.0, 40.0, 70.0, 290.0, 0.0, 30.0, 60.0, 40.0, 350.0, 60.0, -20.0, 250.0, 160.0, 40.0, 0.0, 0.0, 160.0, 70.0, 180.0, 0.0, 100.0, 580.0, 30.0, 35.0, 0.0, 10.0, 30.0, 10.0, 0.0, 270.0, 15.0, 270.0, 190.0, 350.0, 40.0, 30.0, 60.0, 80.0, 160.0, 90.0, 110.0, 510.0, 20.0, 30.0, 140.0, 390.0, 100.0, 10.0, 90.0, 30.0, 0.0, 270.0, 100.0, 50.0, 50.0, 330.0, 110.0, 60.0, 90.0, 60.0, 220.0, 30.0, 120.0, 110.0, -10.0, 170.0, 260.0, 30.0, 380.0, 120.0, 50.0, 50.0, 10.0, 40.0, 20.0, 20.0, 40.0, 170.0, 10.0, 130.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 30.0, 60.0, 20.0, 40.0, 20.0, 20.0, 0.0, 10.0, 170.0, 0.0, 40.0, 40.0, 0.0, 210.0, 30.0, 50.0, 40.0, 40.0, 0.0, 180.0, 160.0, 0.0, 10.0, 90.0, 180.0, 0.0, 110.0, 260.0, 20.0, 20.0, 160.0, 70.0, 60.0, 90.0, 40.0, 140.0, 510.0, 210.0, 60.0, 130.0, 30.0, 0.0, 210.0, 80.0, 400.0, 10.0, 20.0, 30.0, 330.0, -20.0, 310.0, 120.0, 190.0, 80.0, 30.0, 180.0, 0.0, 20.0, 260.0, 30.0, 20.0, 120.0, 170.0, 270.0, 80.0, 0.0, 620.0, 50.0, 50.0, 410.0, 110.0, 90.0, 100.0, 20.0, 120.0, 10.0, 0.0, 20.0, 40.0, 180.0, 20.0, 180.0, 50.0, 200.0, 40.0, 40.0, 0.0, 30.0, 270.0, 170.0, 0.0, 80.0, 80.0, 220.0, 0.0, 50.0, 190.0, 20.0, 50.0, 290.0, 50.0, 10.0, 80.0, 10.0, 30.0, 60.0, 40.0, -40.0, -100.0, -40.0, -60.0, 300.0, 580.0, 120.0, 390.0, 250.0, 260.0, 340.0, 10.0, 20.0, 30.0, 20.0, 70.0, 50.0, 30.0, 10.0, 20.0, 10.0, 50.0, 40.0, 360.0, 70.0, 20.0, 10.0, 25.0, 20.0, 50.0, 50.0, 150.0, 100.0, 50.0, 20.0, 0.0, 390.0, 0.0, 10.0, 30.0, 0.0, 40.0, 260.0, 0.0, 10.0, 380.0, 20.0, 195.0, 20.0, 305.0, 20.0, 310.0, 100.0, 140.0, 170.0, 45.0, 60.0, 350.0, 60.0, 130.0, 90.0, 80.0, 160.0, -10.0, 620.0, 40.0, 490.0, 390.0, 20.0, 270.0, 30.0, 20.0, -10.0, 270.0, 200.0, 10.0, 0.0, 0.0, 0.0, 170.0, 20.0, 520.0, 30.0, 130.0, 30.0, 20.0, 80.0, 0.0, 420.0, 180.0, 80.0, 90.0, 80.0, 20.0, 10.0, 30.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9796573597313307, "mean_inference_ms": 2.035655394724454, "mean_action_processing_ms": 0.5349851941977056, "mean_env_wait_ms": 1.7211054555815186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014052152633666992, "StateBufferConnector_ms": 0.01164102554321289, "ViewRequirementAgentConnector_ms": 0.45484232902526855}, "num_episodes": 18, "episode_return_max": 2010.0, "episode_return_min": 90.0, "episode_return_mean": 1047.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.933351823536597, "num_env_steps_trained_throughput_per_sec": 18.933351823536597, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 4400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4400000, "timers": {"training_iteration_time_ms": 314718.428, "restore_workers_time_ms": 0.014, "training_step_time_ms": 314718.355, "sample_time_ms": 3095.252, "learn_time_ms": 311600.248, "learn_throughput": 12.837, "synch_weights_time_ms": 12.596}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "done": false, "training_iteration": 110, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-41-45", "timestamp": 1717263705, "time_this_iter_s": 211.29835534095764, "time_total_s": 54520.44408535957, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a4b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54520.44408535957, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 29.769000000000002, "ram_util_percent": 82.86366666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.635094736667233, "cur_kl_coeff": 6.927618187665941, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.608890964073368, "policy_loss": -0.0030393459547273377, "vf_loss": 6.609418679807133, "vf_explained_var": 3.193218233232427e-05, "kl": 0.0003625537610856474, "entropy": 0.2257163107839509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1037595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "env_runners": {"episode_reward_max": 2010.0, "episode_reward_min": 90.0, "episode_reward_mean": 1006.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -520.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 100.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1110.0, 1690.0, 420.0, 930.0, 1020.0, 1070.0, 1220.0, 190.0, 820.0, 1485.0, 880.0, 1060.0, 670.0, 1240.0, 800.0, 1130.0, 1460.0, 800.0, 880.0, 550.0, 530.0, 1085.0, 1050.0, 1670.0, 835.0, 395.0, 630.0, 860.0, 580.0, 1190.0, 1090.0, 1510.0, 660.0, 600.0, 1650.0, 1140.0, 900.0, 1310.0, 730.0, 1580.0, 1270.0, 1510.0, 550.0, 1650.0, 1050.0, 620.0, 90.0, 1350.0, 920.0, 960.0, 980.0, 1380.0, 1320.0, 1340.0, 1260.0, 510.0, 330.0, 510.0, 600.0, 970.0, 1410.0, 1470.0, 1100.0, 1530.0, 820.0, 930.0, 750.0, 890.0, 1440.0, 620.0, 855.0, 750.0, 1365.0, 2010.0, 1200.0, 1000.0, 1080.0, 990.0, 1670.0, 340.0, 430.0, 1825.0, 1770.0, 780.0, 290.0, 1230.0, 250.0, 1715.0, 700.0, 1165.0, 1380.0, 340.0, 395.0, 450.0, 1300.0, 1670.0, 570.0, 470.0, 1560.0, 1545.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 60.0, 290.0, 190.0, -20.0, 70.0, 110.0, 280.0, 70.0, 20.0, -20.0, 40.0, 170.0, 130.0, 0.0, 580.0, 150.0, 40.0, 540.0, 60.0, 0.0, 160.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 60.0, 110.0, 10.0, 0.0, 40.0, 5.0, 10.0, 0.0, 545.0, 100.0, 110.0, 0.0, 180.0, 60.0, 380.0, 50.0, 30.0, 170.0, 20.0, 50.0, 80.0, 80.0, -120.0, 490.0, 30.0, 80.0, 210.0, 40.0, 10.0, 60.0, 190.0, 100.0, 310.0, 110.0, 480.0, 60.0, 80.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 90.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 320.0, 0.0, 20.0, 0.0, 60.0, 200.0, 160.0, 40.0, 60.0, 40.0, 310.0, 430.0, 310.0, 50.0, -5.0, 30.0, 220.0, 40.0, 270.0, 200.0, 40.0, 80.0, 100.0, 80.0, 40.0, 20.0, 10.0, 40.0, 10.0, 20.0, 380.0, 70.0, 80.0, 20.0, 10.0, 10.0, 420.0, 10.0, 10.0, 10.0, 120.0, 10.0, 60.0, 40.0, 260.0, 80.0, 70.0, 30.0, 70.0, 40.0, 200.0, 30.0, 30.0, 550.0, 130.0, 130.0, 30.0, 40.0, 40.0, 40.0, 10.0, 160.0, 110.0, 10.0, 170.0, 180.0, 40.0, 120.0, 40.0, 30.0, 550.0, 0.0, 10.0, 30.0, 50.0, 300.0, 0.0, 30.0, 110.0, -40.0, 200.0, 170.0, -90.0, 440.0, 430.0, 170.0, 40.0, 330.0, 70.0, 270.0, 100.0, -110.0, 80.0, 0.0, 90.0, -50.0, 20.0, 0.0, 20.0, 180.0, 50.0, 40.0, 20.0, 0.0, 180.0, 80.0, 310.0, 380.0, -100.0, 140.0, -35.0, 80.0, 40.0, 10.0, 10.0, 70.0, -45.0, 180.0, 30.0, -5.0, 50.0, 40.0, 80.0, 60.0, 100.0, 0.0, -5.0, 20.0, 300.0, 190.0, 290.0, 35.0, 30.0, 30.0, 0.0, 190.0, 0.0, 80.0, 420.0, 90.0, 60.0, 320.0, 50.0, 20.0, 0.0, 20.0, -10.0, 130.0, 70.0, 310.0, 120.0, 230.0, 40.0, 130.0, 300.0, 320.0, 20.0, 195.0, 0.0, 70.0, -65.0, 40.0, 160.0, 30.0, -35.0, 380.0, 60.0, 40.0, 40.0, 200.0, 15.0, 0.0, 40.0, 0.0, 40.0, 0.0, 20.0, 90.0, 60.0, 40.0, 40.0, 20.0, 10.0, 270.0, 80.0, 20.0, 0.0, 0.0, 190.0, 30.0, 0.0, 110.0, 0.0, 50.0, 110.0, 20.0, 350.0, 110.0, 100.0, 20.0, 20.0, 20.0, 20.0, 60.0, 90.0, 120.0, 20.0, 10.0, 70.0, 90.0, 620.0, 30.0, 30.0, 200.0, 10.0, 30.0, 100.0, 60.0, 210.0, 160.0, 0.0, 10.0, 50.0, 0.0, 40.0, 510.0, 50.0, 40.0, 110.0, 220.0, 60.0, 200.0, 90.0, 360.0, 40.0, 380.0, 10.0, 90.0, 20.0, 40.0, 290.0, 30.0, 90.0, 30.0, 20.0, 40.0, 10.0, 0.0, 210.0, 180.0, 180.0, 0.0, 50.0, 10.0, 50.0, 10.0, -90.0, 70.0, 110.0, 60.0, 680.0, -10.0, 150.0, 80.0, 410.0, 80.0, 20.0, 70.0, 310.0, 170.0, 160.0, 30.0, 40.0, 60.0, 260.0, 30.0, 10.0, 150.0, 220.0, 80.0, 20.0, 10.0, 20.0, 100.0, 80.0, 90.0, 130.0, 150.0, 60.0, 20.0, 50.0, 100.0, 200.0, 640.0, 40.0, 20.0, 30.0, 30.0, 40.0, 10.0, 360.0, 40.0, 120.0, 80.0, 0.0, 10.0, 40.0, 20.0, 220.0, 30.0, 470.0, 60.0, 540.0, -20.0, 190.0, 60.0, 10.0, 140.0, 0.0, -10.0, 40.0, 40.0, 20.0, 0.0, 1030.0, 0.0, 10.0, 470.0, 90.0, 30.0, 40.0, -50.0, 80.0, 10.0, 0.0, 210.0, 630.0, 0.0, 20.0, 20.0, 10.0, 20.0, 170.0, 160.0, 50.0, 100.0, 0.0, 40.0, 560.0, 20.0, 200.0, 40.0, 100.0, 310.0, 300.0, 100.0, -20.0, 40.0, 210.0, 50.0, 430.0, 10.0, 100.0, 10.0, -10.0, 20.0, 190.0, 80.0, 0.0, 0.0, 20.0, 210.0, 10.0, 10.0, 150.0, 60.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 270.0, 150.0, 30.0, 20.0, 30.0, 460.0, 0.0, 80.0, 20.0, 290.0, 40.0, 70.0, 290.0, 0.0, 30.0, 60.0, 40.0, 350.0, 60.0, -20.0, 250.0, 160.0, 40.0, 0.0, 0.0, 160.0, 70.0, 180.0, 0.0, 100.0, 580.0, 30.0, 35.0, 0.0, 10.0, 30.0, 10.0, 0.0, 270.0, 15.0, 270.0, 190.0, 350.0, 40.0, 30.0, 60.0, 80.0, 160.0, 90.0, 110.0, 510.0, 20.0, 30.0, 140.0, 390.0, 100.0, 10.0, 90.0, 30.0, 0.0, 270.0, 100.0, 50.0, 50.0, 330.0, 110.0, 60.0, 90.0, 60.0, 220.0, 30.0, 120.0, 110.0, -10.0, 170.0, 260.0, 30.0, 380.0, 120.0, 50.0, 50.0, 10.0, 40.0, 20.0, 20.0, 40.0, 170.0, 10.0, 130.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 30.0, 60.0, 20.0, 40.0, 20.0, 20.0, 0.0, 10.0, 170.0, 0.0, 40.0, 40.0, 0.0, 210.0, 30.0, 50.0, 40.0, 40.0, 0.0, 180.0, 160.0, 0.0, 10.0, 90.0, 180.0, 0.0, 110.0, 260.0, 20.0, 20.0, 160.0, 70.0, 60.0, 90.0, 40.0, 140.0, 510.0, 210.0, 60.0, 130.0, 30.0, 0.0, 210.0, 80.0, 400.0, 10.0, 20.0, 30.0, 330.0, -20.0, 310.0, 120.0, 190.0, 80.0, 30.0, 180.0, 0.0, 20.0, 260.0, 30.0, 20.0, 120.0, 170.0, 270.0, 80.0, 0.0, 620.0, 50.0, 50.0, 410.0, 110.0, 90.0, 100.0, 20.0, 120.0, 10.0, 0.0, 20.0, 40.0, 180.0, 20.0, 180.0, 50.0, 200.0, 40.0, 40.0, 0.0, 30.0, 270.0, 170.0, 0.0, 80.0, 80.0, 220.0, 0.0, 50.0, 190.0, 20.0, 50.0, 290.0, 50.0, 10.0, 80.0, 10.0, 30.0, 60.0, 40.0, -40.0, -100.0, -40.0, -60.0, 300.0, 580.0, 120.0, 390.0, 250.0, 260.0, 340.0, 10.0, 20.0, 30.0, 20.0, 70.0, 50.0, 30.0, 10.0, 20.0, 10.0, 50.0, 40.0, 360.0, 70.0, 20.0, 10.0, 25.0, 20.0, 50.0, 50.0, 150.0, 100.0, 50.0, 20.0, 0.0, 390.0, 0.0, 10.0, 30.0, 0.0, 40.0, 260.0, 0.0, 10.0, 380.0, 20.0, 195.0, 20.0, 305.0, 20.0, 310.0, 100.0, 140.0, 170.0, 45.0, 60.0, 350.0, 60.0, 130.0, 90.0, 80.0, 160.0, -10.0, 620.0, 40.0, 490.0, 390.0, 20.0, 270.0, 30.0, 20.0, -10.0, 270.0, 200.0, 10.0, 0.0, 0.0, 0.0, 170.0, 20.0, 520.0, 30.0, 130.0, 30.0, 20.0, 80.0, 0.0, 420.0, 180.0, 80.0, 90.0, 80.0, 20.0, 10.0, 30.0, 170.0, 350.0, 20.0, 50.0, 20.0, 0.0, 30.0, 180.0, 70.0, 0.0, 270.0, 30.0, 140.0, 990.0, 160.0, 30.0, 0.0, 90.0, 40.0, 100.0, 90.0, 20.0, 40.0, 0.0, 60.0, 30.0, 120.0, 10.0, 10.0, 10.0, 40.0, 180.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 40.0, 10.0, 90.0, 60.0, 130.0, 220.0, 60.0, 180.0, 380.0, 110.0, 40.0, 15.0, 630.0, 120.0, 280.0, 30.0, 410.0, 130.0, 90.0, 40.0, 400.0, 210.0, 60.0, 30.0, 30.0, 510.0, 0.0, 130.0, 10.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 120.0, 30.0, 0.0, 0.0, 40.0, 410.0, 290.0, 100.0, 110.0, 30.0, 30.0, 70.0, 20.0, 50.0, 120.0, 110.0, 210.0, 30.0, 180.0, -520.0, 40.0, 10.0, 210.0, -30.0, 10.0, 510.0, 70.0, 350.0, -5.0, 60.0, 460.0, 80.0, 240.0, 70.0, -120.0, 0.0, 30.0, 50.0, 380.0, 0.0, 0.0, 20.0, 70.0, -30.0, 180.0, 370.0, 270.0, 50.0, 80.0, 30.0, 0.0, 70.0, 275.0, -20.0, 40.0, 60.0, 70.0, 110.0, 30.0, 70.0, 50.0, 530.0, 130.0, 240.0, 90.0, 0.0, 30.0, 40.0, 10.0, 90.0, 10.0, 30.0, 110.0, 20.0, 0.0, 10.0, 40.0, 10.0, 10.0, 80.0, 180.0, 35.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 20.0, 220.0, 80.0, 20.0, 70.0, 35.0, 5.0, 130.0, 50.0, 100.0, 410.0, 100.0, 70.0, 330.0, -50.0, 370.0, -10.0, 120.0, 330.0, 380.0, 40.0, 50.0, 430.0, 10.0, 210.0, 40.0, 0.0, 40.0, 30.0, 40.0, 0.0, 40.0, 150.0, 20.0, 50.0, 20.0, 0.0, 30.0, 40.0, 0.0, 130.0, 30.0, 20.0, 150.0, 190.0, 340.0, 60.0, 190.0, 90.0, 90.0, 80.0, 30.0, 40.0, 450.0, 30.0, 490.0, 50.0, 200.0, 160.0, 295.0, 40.0, 140.0, 80.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9764945965270084, "mean_inference_ms": 2.033834724872356, "mean_action_processing_ms": 0.5342958532708556, "mean_env_wait_ms": 1.7189782646739886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014251232147216797, "StateBufferConnector_ms": 0.012063264846801758, "ViewRequirementAgentConnector_ms": 0.47384166717529297}, "num_episodes": 23, "episode_return_max": 2010.0, "episode_return_min": 90.0, "episode_return_mean": 1006.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.45651088422717, "num_env_steps_trained_throughput_per_sec": 19.45651088422717, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 4440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4440000, "timers": {"training_iteration_time_ms": 314638.796, "restore_workers_time_ms": 0.014, "training_step_time_ms": 314638.723, "sample_time_ms": 3080.292, "learn_time_ms": 311535.813, "learn_throughput": 12.84, "synch_weights_time_ms": 12.866}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "done": false, "training_iteration": 111, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-45-11", "timestamp": 1717263911, "time_this_iter_s": 205.61201786994934, "time_total_s": 54726.05610322952, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a4bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54726.05610322952, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 26.041638225255976, "ram_util_percent": 81.73993174061434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5947485606573895, "cur_kl_coeff": 3.4638090938329706, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004015094158785166, "vf_loss": 6.8129480175063, "vf_explained_var": 2.2324338888588803e-05, "kl": Infinity, "entropy": 0.23440813280094547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1046985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "env_runners": {"episode_reward_max": 2010.0, "episode_reward_min": 90.0, "episode_reward_mean": 1003.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -520.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 100.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [880.0, 550.0, 530.0, 1085.0, 1050.0, 1670.0, 835.0, 395.0, 630.0, 860.0, 580.0, 1190.0, 1090.0, 1510.0, 660.0, 600.0, 1650.0, 1140.0, 900.0, 1310.0, 730.0, 1580.0, 1270.0, 1510.0, 550.0, 1650.0, 1050.0, 620.0, 90.0, 1350.0, 920.0, 960.0, 980.0, 1380.0, 1320.0, 1340.0, 1260.0, 510.0, 330.0, 510.0, 600.0, 970.0, 1410.0, 1470.0, 1100.0, 1530.0, 820.0, 930.0, 750.0, 890.0, 1440.0, 620.0, 855.0, 750.0, 1365.0, 2010.0, 1200.0, 1000.0, 1080.0, 990.0, 1670.0, 340.0, 430.0, 1825.0, 1770.0, 780.0, 290.0, 1230.0, 250.0, 1715.0, 700.0, 1165.0, 1380.0, 340.0, 395.0, 450.0, 1300.0, 1670.0, 570.0, 470.0, 1560.0, 1545.0, 765.0, 1040.0, 830.0, 180.0, 1400.0, 1310.0, 210.0, 860.0, 1200.0, 1520.0, 1190.0, 1260.0, 1085.0, 990.0, 1300.0, 1420.0, 620.0, 530.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 180.0, 50.0, 40.0, 20.0, 0.0, 180.0, 80.0, 310.0, 380.0, -100.0, 140.0, -35.0, 80.0, 40.0, 10.0, 10.0, 70.0, -45.0, 180.0, 30.0, -5.0, 50.0, 40.0, 80.0, 60.0, 100.0, 0.0, -5.0, 20.0, 300.0, 190.0, 290.0, 35.0, 30.0, 30.0, 0.0, 190.0, 0.0, 80.0, 420.0, 90.0, 60.0, 320.0, 50.0, 20.0, 0.0, 20.0, -10.0, 130.0, 70.0, 310.0, 120.0, 230.0, 40.0, 130.0, 300.0, 320.0, 20.0, 195.0, 0.0, 70.0, -65.0, 40.0, 160.0, 30.0, -35.0, 380.0, 60.0, 40.0, 40.0, 200.0, 15.0, 0.0, 40.0, 0.0, 40.0, 0.0, 20.0, 90.0, 60.0, 40.0, 40.0, 20.0, 10.0, 270.0, 80.0, 20.0, 0.0, 0.0, 190.0, 30.0, 0.0, 110.0, 0.0, 50.0, 110.0, 20.0, 350.0, 110.0, 100.0, 20.0, 20.0, 20.0, 20.0, 60.0, 90.0, 120.0, 20.0, 10.0, 70.0, 90.0, 620.0, 30.0, 30.0, 200.0, 10.0, 30.0, 100.0, 60.0, 210.0, 160.0, 0.0, 10.0, 50.0, 0.0, 40.0, 510.0, 50.0, 40.0, 110.0, 220.0, 60.0, 200.0, 90.0, 360.0, 40.0, 380.0, 10.0, 90.0, 20.0, 40.0, 290.0, 30.0, 90.0, 30.0, 20.0, 40.0, 10.0, 0.0, 210.0, 180.0, 180.0, 0.0, 50.0, 10.0, 50.0, 10.0, -90.0, 70.0, 110.0, 60.0, 680.0, -10.0, 150.0, 80.0, 410.0, 80.0, 20.0, 70.0, 310.0, 170.0, 160.0, 30.0, 40.0, 60.0, 260.0, 30.0, 10.0, 150.0, 220.0, 80.0, 20.0, 10.0, 20.0, 100.0, 80.0, 90.0, 130.0, 150.0, 60.0, 20.0, 50.0, 100.0, 200.0, 640.0, 40.0, 20.0, 30.0, 30.0, 40.0, 10.0, 360.0, 40.0, 120.0, 80.0, 0.0, 10.0, 40.0, 20.0, 220.0, 30.0, 470.0, 60.0, 540.0, -20.0, 190.0, 60.0, 10.0, 140.0, 0.0, -10.0, 40.0, 40.0, 20.0, 0.0, 1030.0, 0.0, 10.0, 470.0, 90.0, 30.0, 40.0, -50.0, 80.0, 10.0, 0.0, 210.0, 630.0, 0.0, 20.0, 20.0, 10.0, 20.0, 170.0, 160.0, 50.0, 100.0, 0.0, 40.0, 560.0, 20.0, 200.0, 40.0, 100.0, 310.0, 300.0, 100.0, -20.0, 40.0, 210.0, 50.0, 430.0, 10.0, 100.0, 10.0, -10.0, 20.0, 190.0, 80.0, 0.0, 0.0, 20.0, 210.0, 10.0, 10.0, 150.0, 60.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 270.0, 150.0, 30.0, 20.0, 30.0, 460.0, 0.0, 80.0, 20.0, 290.0, 40.0, 70.0, 290.0, 0.0, 30.0, 60.0, 40.0, 350.0, 60.0, -20.0, 250.0, 160.0, 40.0, 0.0, 0.0, 160.0, 70.0, 180.0, 0.0, 100.0, 580.0, 30.0, 35.0, 0.0, 10.0, 30.0, 10.0, 0.0, 270.0, 15.0, 270.0, 190.0, 350.0, 40.0, 30.0, 60.0, 80.0, 160.0, 90.0, 110.0, 510.0, 20.0, 30.0, 140.0, 390.0, 100.0, 10.0, 90.0, 30.0, 0.0, 270.0, 100.0, 50.0, 50.0, 330.0, 110.0, 60.0, 90.0, 60.0, 220.0, 30.0, 120.0, 110.0, -10.0, 170.0, 260.0, 30.0, 380.0, 120.0, 50.0, 50.0, 10.0, 40.0, 20.0, 20.0, 40.0, 170.0, 10.0, 130.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 30.0, 60.0, 20.0, 40.0, 20.0, 20.0, 0.0, 10.0, 170.0, 0.0, 40.0, 40.0, 0.0, 210.0, 30.0, 50.0, 40.0, 40.0, 0.0, 180.0, 160.0, 0.0, 10.0, 90.0, 180.0, 0.0, 110.0, 260.0, 20.0, 20.0, 160.0, 70.0, 60.0, 90.0, 40.0, 140.0, 510.0, 210.0, 60.0, 130.0, 30.0, 0.0, 210.0, 80.0, 400.0, 10.0, 20.0, 30.0, 330.0, -20.0, 310.0, 120.0, 190.0, 80.0, 30.0, 180.0, 0.0, 20.0, 260.0, 30.0, 20.0, 120.0, 170.0, 270.0, 80.0, 0.0, 620.0, 50.0, 50.0, 410.0, 110.0, 90.0, 100.0, 20.0, 120.0, 10.0, 0.0, 20.0, 40.0, 180.0, 20.0, 180.0, 50.0, 200.0, 40.0, 40.0, 0.0, 30.0, 270.0, 170.0, 0.0, 80.0, 80.0, 220.0, 0.0, 50.0, 190.0, 20.0, 50.0, 290.0, 50.0, 10.0, 80.0, 10.0, 30.0, 60.0, 40.0, -40.0, -100.0, -40.0, -60.0, 300.0, 580.0, 120.0, 390.0, 250.0, 260.0, 340.0, 10.0, 20.0, 30.0, 20.0, 70.0, 50.0, 30.0, 10.0, 20.0, 10.0, 50.0, 40.0, 360.0, 70.0, 20.0, 10.0, 25.0, 20.0, 50.0, 50.0, 150.0, 100.0, 50.0, 20.0, 0.0, 390.0, 0.0, 10.0, 30.0, 0.0, 40.0, 260.0, 0.0, 10.0, 380.0, 20.0, 195.0, 20.0, 305.0, 20.0, 310.0, 100.0, 140.0, 170.0, 45.0, 60.0, 350.0, 60.0, 130.0, 90.0, 80.0, 160.0, -10.0, 620.0, 40.0, 490.0, 390.0, 20.0, 270.0, 30.0, 20.0, -10.0, 270.0, 200.0, 10.0, 0.0, 0.0, 0.0, 170.0, 20.0, 520.0, 30.0, 130.0, 30.0, 20.0, 80.0, 0.0, 420.0, 180.0, 80.0, 90.0, 80.0, 20.0, 10.0, 30.0, 170.0, 350.0, 20.0, 50.0, 20.0, 0.0, 30.0, 180.0, 70.0, 0.0, 270.0, 30.0, 140.0, 990.0, 160.0, 30.0, 0.0, 90.0, 40.0, 100.0, 90.0, 20.0, 40.0, 0.0, 60.0, 30.0, 120.0, 10.0, 10.0, 10.0, 40.0, 180.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 40.0, 10.0, 90.0, 60.0, 130.0, 220.0, 60.0, 180.0, 380.0, 110.0, 40.0, 15.0, 630.0, 120.0, 280.0, 30.0, 410.0, 130.0, 90.0, 40.0, 400.0, 210.0, 60.0, 30.0, 30.0, 510.0, 0.0, 130.0, 10.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 120.0, 30.0, 0.0, 0.0, 40.0, 410.0, 290.0, 100.0, 110.0, 30.0, 30.0, 70.0, 20.0, 50.0, 120.0, 110.0, 210.0, 30.0, 180.0, -520.0, 40.0, 10.0, 210.0, -30.0, 10.0, 510.0, 70.0, 350.0, -5.0, 60.0, 460.0, 80.0, 240.0, 70.0, -120.0, 0.0, 30.0, 50.0, 380.0, 0.0, 0.0, 20.0, 70.0, -30.0, 180.0, 370.0, 270.0, 50.0, 80.0, 30.0, 0.0, 70.0, 275.0, -20.0, 40.0, 60.0, 70.0, 110.0, 30.0, 70.0, 50.0, 530.0, 130.0, 240.0, 90.0, 0.0, 30.0, 40.0, 10.0, 90.0, 10.0, 30.0, 110.0, 20.0, 0.0, 10.0, 40.0, 10.0, 10.0, 80.0, 180.0, 35.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 20.0, 220.0, 80.0, 20.0, 70.0, 35.0, 5.0, 130.0, 50.0, 100.0, 410.0, 100.0, 70.0, 330.0, -50.0, 370.0, -10.0, 120.0, 330.0, 380.0, 40.0, 50.0, 430.0, 10.0, 210.0, 40.0, 0.0, 40.0, 30.0, 40.0, 0.0, 40.0, 150.0, 20.0, 50.0, 20.0, 0.0, 30.0, 40.0, 0.0, 130.0, 30.0, 20.0, 150.0, 190.0, 340.0, 60.0, 190.0, 90.0, 90.0, 80.0, 30.0, 40.0, 450.0, 30.0, 490.0, 50.0, 200.0, 160.0, 295.0, 40.0, 140.0, 80.0, 60.0, 35.0, 150.0, 80.0, 60.0, -90.0, 40.0, 50.0, 50.0, 210.0, 180.0, -20.0, 280.0, 20.0, 20.0, 690.0, 20.0, -30.0, -50.0, 70.0, 40.0, 50.0, 150.0, 0.0, 160.0, 220.0, 70.0, 30.0, 50.0, 20.0, 80.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 0.0, 560.0, 100.0, 270.0, 60.0, 70.0, 200.0, 40.0, 20.0, 30.0, 50.0, 60.0, 140.0, 160.0, 150.0, 80.0, -20.0, 110.0, 100.0, 510.0, 20.0, 0.0, 10.0, 60.0, 10.0, 10.0, 80.0, 10.0, 20.0, 10.0, 0.0, 0.0, 40.0, 120.0, -50.0, 0.0, 540.0, 0.0, 180.0, 50.0, -20.0, 40.0, 50.0, 110.0, 40.0, 60.0, 80.0, 350.0, 110.0, 70.0, 290.0, 150.0, 20.0, 70.0, 30.0, 20.0, 80.0, 30.0, 230.0, 530.0, 360.0, 20.0, 160.0, 270.0, 10.0, 270.0, 30.0, 0.0, 220.0, 190.0, 20.0, 210.0, 50.0, 90.0, 50.0, 390.0, 210.0, 60.0, 160.0, 10.0, 30.0, 160.0, 50.0, 80.0, 180.0, 10.0, 210.0, 35.0, -80.0, 380.0, 60.0, 420.0, 80.0, 80.0, 40.0, 50.0, 200.0, 0.0, 70.0, 0.0, 50.0, 100.0, 120.0, 20.0, 40.0, 20.0, 40.0, 160.0, 420.0, 170.0, 210.0, 80.0, 310.0, 150.0, 130.0, 420.0, 20.0, 30.0, 50.0, 60.0, 170.0, 110.0, 190.0, 20.0, 80.0, 170.0, -80.0, -80.0, 160.0, 30.0, 20.0, 50.0, 20.0, -20.0, 40.0, 320.0, 80.0, 0.0, 0.0, 40.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9733402560007354, "mean_inference_ms": 2.0318050441113833, "mean_action_processing_ms": 0.5336952705673383, "mean_env_wait_ms": 1.7170828865232175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015130758285522461, "StateBufferConnector_ms": 0.011436223983764648, "ViewRequirementAgentConnector_ms": 0.44064760208129883}, "num_episodes": 18, "episode_return_max": 2010.0, "episode_return_min": 90.0, "episode_return_mean": 1003.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.27439718499129, "num_env_steps_trained_throughput_per_sec": 19.27439718499129, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 4480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4480000, "timers": {"training_iteration_time_ms": 315368.926, "restore_workers_time_ms": 0.014, "training_step_time_ms": 315368.853, "sample_time_ms": 3003.127, "learn_time_ms": 312343.311, "learn_throughput": 12.806, "synch_weights_time_ms": 12.758}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "done": false, "training_iteration": 112, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-48-38", "timestamp": 1717264118, "time_this_iter_s": 207.55240106582642, "time_total_s": 54933.60850429535, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f887ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54933.60850429535, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 27.091525423728815, "ram_util_percent": 82.20033898305084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.587061149021561, "cur_kl_coeff": 5.195713640749455, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0035567910786613, "vf_loss": 6.83547895861129, "vf_explained_var": -0.000551600628894485, "kl": Infinity, "entropy": 0.2289020788690216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1056375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "env_runners": {"episode_reward_max": 2010.0, "episode_reward_min": 90.0, "episode_reward_mean": 1033.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -520.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 103.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1270.0, 1510.0, 550.0, 1650.0, 1050.0, 620.0, 90.0, 1350.0, 920.0, 960.0, 980.0, 1380.0, 1320.0, 1340.0, 1260.0, 510.0, 330.0, 510.0, 600.0, 970.0, 1410.0, 1470.0, 1100.0, 1530.0, 820.0, 930.0, 750.0, 890.0, 1440.0, 620.0, 855.0, 750.0, 1365.0, 2010.0, 1200.0, 1000.0, 1080.0, 990.0, 1670.0, 340.0, 430.0, 1825.0, 1770.0, 780.0, 290.0, 1230.0, 250.0, 1715.0, 700.0, 1165.0, 1380.0, 340.0, 395.0, 450.0, 1300.0, 1670.0, 570.0, 470.0, 1560.0, 1545.0, 765.0, 1040.0, 830.0, 180.0, 1400.0, 1310.0, 210.0, 860.0, 1200.0, 1520.0, 1190.0, 1260.0, 1085.0, 990.0, 1300.0, 1420.0, 620.0, 530.0, 1190.0, 1270.0, 1220.0, 1120.0, 1520.0, 1130.0, 1615.0, 200.0, 400.0, 1480.0, 1780.0, 290.0, 1375.0, 1100.0, 1240.0, 1235.0, 1290.0, 710.0, 1290.0, 1300.0, 1260.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 0.0, -10.0, 40.0, 40.0, 20.0, 0.0, 1030.0, 0.0, 10.0, 470.0, 90.0, 30.0, 40.0, -50.0, 80.0, 10.0, 0.0, 210.0, 630.0, 0.0, 20.0, 20.0, 10.0, 20.0, 170.0, 160.0, 50.0, 100.0, 0.0, 40.0, 560.0, 20.0, 200.0, 40.0, 100.0, 310.0, 300.0, 100.0, -20.0, 40.0, 210.0, 50.0, 430.0, 10.0, 100.0, 10.0, -10.0, 20.0, 190.0, 80.0, 0.0, 0.0, 20.0, 210.0, 10.0, 10.0, 150.0, 60.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 270.0, 150.0, 30.0, 20.0, 30.0, 460.0, 0.0, 80.0, 20.0, 290.0, 40.0, 70.0, 290.0, 0.0, 30.0, 60.0, 40.0, 350.0, 60.0, -20.0, 250.0, 160.0, 40.0, 0.0, 0.0, 160.0, 70.0, 180.0, 0.0, 100.0, 580.0, 30.0, 35.0, 0.0, 10.0, 30.0, 10.0, 0.0, 270.0, 15.0, 270.0, 190.0, 350.0, 40.0, 30.0, 60.0, 80.0, 160.0, 90.0, 110.0, 510.0, 20.0, 30.0, 140.0, 390.0, 100.0, 10.0, 90.0, 30.0, 0.0, 270.0, 100.0, 50.0, 50.0, 330.0, 110.0, 60.0, 90.0, 60.0, 220.0, 30.0, 120.0, 110.0, -10.0, 170.0, 260.0, 30.0, 380.0, 120.0, 50.0, 50.0, 10.0, 40.0, 20.0, 20.0, 40.0, 170.0, 10.0, 130.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 30.0, 60.0, 20.0, 40.0, 20.0, 20.0, 0.0, 10.0, 170.0, 0.0, 40.0, 40.0, 0.0, 210.0, 30.0, 50.0, 40.0, 40.0, 0.0, 180.0, 160.0, 0.0, 10.0, 90.0, 180.0, 0.0, 110.0, 260.0, 20.0, 20.0, 160.0, 70.0, 60.0, 90.0, 40.0, 140.0, 510.0, 210.0, 60.0, 130.0, 30.0, 0.0, 210.0, 80.0, 400.0, 10.0, 20.0, 30.0, 330.0, -20.0, 310.0, 120.0, 190.0, 80.0, 30.0, 180.0, 0.0, 20.0, 260.0, 30.0, 20.0, 120.0, 170.0, 270.0, 80.0, 0.0, 620.0, 50.0, 50.0, 410.0, 110.0, 90.0, 100.0, 20.0, 120.0, 10.0, 0.0, 20.0, 40.0, 180.0, 20.0, 180.0, 50.0, 200.0, 40.0, 40.0, 0.0, 30.0, 270.0, 170.0, 0.0, 80.0, 80.0, 220.0, 0.0, 50.0, 190.0, 20.0, 50.0, 290.0, 50.0, 10.0, 80.0, 10.0, 30.0, 60.0, 40.0, -40.0, -100.0, -40.0, -60.0, 300.0, 580.0, 120.0, 390.0, 250.0, 260.0, 340.0, 10.0, 20.0, 30.0, 20.0, 70.0, 50.0, 30.0, 10.0, 20.0, 10.0, 50.0, 40.0, 360.0, 70.0, 20.0, 10.0, 25.0, 20.0, 50.0, 50.0, 150.0, 100.0, 50.0, 20.0, 0.0, 390.0, 0.0, 10.0, 30.0, 0.0, 40.0, 260.0, 0.0, 10.0, 380.0, 20.0, 195.0, 20.0, 305.0, 20.0, 310.0, 100.0, 140.0, 170.0, 45.0, 60.0, 350.0, 60.0, 130.0, 90.0, 80.0, 160.0, -10.0, 620.0, 40.0, 490.0, 390.0, 20.0, 270.0, 30.0, 20.0, -10.0, 270.0, 200.0, 10.0, 0.0, 0.0, 0.0, 170.0, 20.0, 520.0, 30.0, 130.0, 30.0, 20.0, 80.0, 0.0, 420.0, 180.0, 80.0, 90.0, 80.0, 20.0, 10.0, 30.0, 170.0, 350.0, 20.0, 50.0, 20.0, 0.0, 30.0, 180.0, 70.0, 0.0, 270.0, 30.0, 140.0, 990.0, 160.0, 30.0, 0.0, 90.0, 40.0, 100.0, 90.0, 20.0, 40.0, 0.0, 60.0, 30.0, 120.0, 10.0, 10.0, 10.0, 40.0, 180.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 40.0, 10.0, 90.0, 60.0, 130.0, 220.0, 60.0, 180.0, 380.0, 110.0, 40.0, 15.0, 630.0, 120.0, 280.0, 30.0, 410.0, 130.0, 90.0, 40.0, 400.0, 210.0, 60.0, 30.0, 30.0, 510.0, 0.0, 130.0, 10.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 120.0, 30.0, 0.0, 0.0, 40.0, 410.0, 290.0, 100.0, 110.0, 30.0, 30.0, 70.0, 20.0, 50.0, 120.0, 110.0, 210.0, 30.0, 180.0, -520.0, 40.0, 10.0, 210.0, -30.0, 10.0, 510.0, 70.0, 350.0, -5.0, 60.0, 460.0, 80.0, 240.0, 70.0, -120.0, 0.0, 30.0, 50.0, 380.0, 0.0, 0.0, 20.0, 70.0, -30.0, 180.0, 370.0, 270.0, 50.0, 80.0, 30.0, 0.0, 70.0, 275.0, -20.0, 40.0, 60.0, 70.0, 110.0, 30.0, 70.0, 50.0, 530.0, 130.0, 240.0, 90.0, 0.0, 30.0, 40.0, 10.0, 90.0, 10.0, 30.0, 110.0, 20.0, 0.0, 10.0, 40.0, 10.0, 10.0, 80.0, 180.0, 35.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 20.0, 220.0, 80.0, 20.0, 70.0, 35.0, 5.0, 130.0, 50.0, 100.0, 410.0, 100.0, 70.0, 330.0, -50.0, 370.0, -10.0, 120.0, 330.0, 380.0, 40.0, 50.0, 430.0, 10.0, 210.0, 40.0, 0.0, 40.0, 30.0, 40.0, 0.0, 40.0, 150.0, 20.0, 50.0, 20.0, 0.0, 30.0, 40.0, 0.0, 130.0, 30.0, 20.0, 150.0, 190.0, 340.0, 60.0, 190.0, 90.0, 90.0, 80.0, 30.0, 40.0, 450.0, 30.0, 490.0, 50.0, 200.0, 160.0, 295.0, 40.0, 140.0, 80.0, 60.0, 35.0, 150.0, 80.0, 60.0, -90.0, 40.0, 50.0, 50.0, 210.0, 180.0, -20.0, 280.0, 20.0, 20.0, 690.0, 20.0, -30.0, -50.0, 70.0, 40.0, 50.0, 150.0, 0.0, 160.0, 220.0, 70.0, 30.0, 50.0, 20.0, 80.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 0.0, 560.0, 100.0, 270.0, 60.0, 70.0, 200.0, 40.0, 20.0, 30.0, 50.0, 60.0, 140.0, 160.0, 150.0, 80.0, -20.0, 110.0, 100.0, 510.0, 20.0, 0.0, 10.0, 60.0, 10.0, 10.0, 80.0, 10.0, 20.0, 10.0, 0.0, 0.0, 40.0, 120.0, -50.0, 0.0, 540.0, 0.0, 180.0, 50.0, -20.0, 40.0, 50.0, 110.0, 40.0, 60.0, 80.0, 350.0, 110.0, 70.0, 290.0, 150.0, 20.0, 70.0, 30.0, 20.0, 80.0, 30.0, 230.0, 530.0, 360.0, 20.0, 160.0, 270.0, 10.0, 270.0, 30.0, 0.0, 220.0, 190.0, 20.0, 210.0, 50.0, 90.0, 50.0, 390.0, 210.0, 60.0, 160.0, 10.0, 30.0, 160.0, 50.0, 80.0, 180.0, 10.0, 210.0, 35.0, -80.0, 380.0, 60.0, 420.0, 80.0, 80.0, 40.0, 50.0, 200.0, 0.0, 70.0, 0.0, 50.0, 100.0, 120.0, 20.0, 40.0, 20.0, 40.0, 160.0, 420.0, 170.0, 210.0, 80.0, 310.0, 150.0, 130.0, 420.0, 20.0, 30.0, 50.0, 60.0, 170.0, 110.0, 190.0, 20.0, 80.0, 170.0, -80.0, -80.0, 160.0, 30.0, 20.0, 50.0, 20.0, -20.0, 40.0, 320.0, 80.0, 0.0, 0.0, 40.0, 0.0, 0.0, 570.0, 30.0, 0.0, 70.0, 70.0, 0.0, 400.0, 10.0, 40.0, 160.0, 30.0, 120.0, 20.0, 170.0, 330.0, 100.0, 50.0, 270.0, 20.0, 270.0, -30.0, 200.0, 80.0, 220.0, 10.0, 70.0, 110.0, 280.0, 10.0, 40.0, 90.0, 480.0, 50.0, 30.0, 20.0, 100.0, 260.0, 20.0, 30.0, 200.0, -10.0, 190.0, 40.0, 80.0, 250.0, 40.0, 130.0, 280.0, 320.0, 20.0, 320.0, 350.0, 30.0, 20.0, 50.0, 0.0, 200.0, 90.0, 50.0, 290.0, 240.0, 330.0, 330.0, 20.0, 10.0, 50.0, 40.0, 55.0, 250.0, 0.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 60.0, 0.0, 30.0, -130.0, 40.0, 10.0, 120.0, 0.0, 100.0, 220.0, 40.0, -40.0, 40.0, 200.0, 30.0, -30.0, 110.0, 180.0, 250.0, 20.0, 610.0, 150.0, -40.0, 190.0, 70.0, 210.0, 460.0, 100.0, 90.0, 60.0, 280.0, 130.0, 190.0, 0.0, 40.0, 0.0, 50.0, 10.0, 0.0, 130.0, 20.0, 0.0, 40.0, 120.0, 180.0, 230.0, 40.0, 170.0, -5.0, 90.0, 80.0, 230.0, 240.0, 240.0, 150.0, 70.0, 60.0, -10.0, 30.0, 20.0, 70.0, 90.0, 380.0, 320.0, 130.0, 0.0, 410.0, 60.0, 70.0, 10.0, 150.0, 40.0, 50.0, 40.0, 70.0, 70.0, 410.0, 210.0, 50.0, 80.0, 160.0, 25.0, 120.0, 130.0, 360.0, 50.0, 170.0, 30.0, 10.0, 170.0, 310.0, 20.0, 40.0, 90.0, 30.0, 20.0, 0.0, 60.0, 130.0, 30.0, 70.0, 20.0, 260.0, 10.0, 140.0, 10.0, 50.0, 40.0, 50.0, 720.0, 50.0, 160.0, 60.0, 190.0, 50.0, 60.0, 20.0, 150.0, 80.0, 110.0, 140.0, 430.0, 70.0, 80.0, 70.0, 310.0, 70.0, 260.0, 60.0, 200.0, 50.0, 50.0, 110.0, 20.0, 10.0, 80.0, 20.0, 120.0, 0.0, 10.0, 10.0, 20.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.969031521891131, "mean_inference_ms": 2.0284863191767872, "mean_action_processing_ms": 0.5327911327363316, "mean_env_wait_ms": 1.7142403598775866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01722884178161621, "StateBufferConnector_ms": 0.011096954345703125, "ViewRequirementAgentConnector_ms": 0.44106030464172363}, "num_episodes": 22, "episode_return_max": 2010.0, "episode_return_min": 90.0, "episode_return_mean": 1033.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.175957361353888, "num_env_steps_trained_throughput_per_sec": 20.175957361353888, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 4520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4520000, "timers": {"training_iteration_time_ms": 315228.886, "restore_workers_time_ms": 0.013, "training_step_time_ms": 315228.814, "sample_time_ms": 2988.421, "learn_time_ms": 312218.992, "learn_throughput": 12.812, "synch_weights_time_ms": 12.617}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "done": false, "training_iteration": 113, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-51-57", "timestamp": 1717264317, "time_this_iter_s": 198.26471781730652, "time_total_s": 55131.873222112656, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a4bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 55131.873222112656, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 20.359430604982208, "ram_util_percent": 80.27686832740213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7652527124546586, "cur_kl_coeff": 7.7935704611241805, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002652924498483634, "vf_loss": 6.452791368212309, "vf_explained_var": 0.0006238157185502707, "kl": Infinity, "entropy": 0.23510705781217836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1065765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "env_runners": {"episode_reward_max": 2010.0, "episode_reward_min": 180.0, "episode_reward_mean": 1049.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -520.0}, "policy_reward_max": {"policy_0": 990.0}, "policy_reward_mean": {"policy_0": 104.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.0, 970.0, 1410.0, 1470.0, 1100.0, 1530.0, 820.0, 930.0, 750.0, 890.0, 1440.0, 620.0, 855.0, 750.0, 1365.0, 2010.0, 1200.0, 1000.0, 1080.0, 990.0, 1670.0, 340.0, 430.0, 1825.0, 1770.0, 780.0, 290.0, 1230.0, 250.0, 1715.0, 700.0, 1165.0, 1380.0, 340.0, 395.0, 450.0, 1300.0, 1670.0, 570.0, 470.0, 1560.0, 1545.0, 765.0, 1040.0, 830.0, 180.0, 1400.0, 1310.0, 210.0, 860.0, 1200.0, 1520.0, 1190.0, 1260.0, 1085.0, 990.0, 1300.0, 1420.0, 620.0, 530.0, 1190.0, 1270.0, 1220.0, 1120.0, 1520.0, 1130.0, 1615.0, 200.0, 400.0, 1480.0, 1780.0, 290.0, 1375.0, 1100.0, 1240.0, 1235.0, 1290.0, 710.0, 1290.0, 1300.0, 1260.0, 370.0, 860.0, 1435.0, 305.0, 740.0, 1420.0, 1550.0, 620.0, 1260.0, 1090.0, 1540.0, 1060.0, 1300.0, 440.0, 1130.0, 1830.0, 660.0, 1445.0, 560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 50.0, 40.0, 40.0, 0.0, 180.0, 160.0, 0.0, 10.0, 90.0, 180.0, 0.0, 110.0, 260.0, 20.0, 20.0, 160.0, 70.0, 60.0, 90.0, 40.0, 140.0, 510.0, 210.0, 60.0, 130.0, 30.0, 0.0, 210.0, 80.0, 400.0, 10.0, 20.0, 30.0, 330.0, -20.0, 310.0, 120.0, 190.0, 80.0, 30.0, 180.0, 0.0, 20.0, 260.0, 30.0, 20.0, 120.0, 170.0, 270.0, 80.0, 0.0, 620.0, 50.0, 50.0, 410.0, 110.0, 90.0, 100.0, 20.0, 120.0, 10.0, 0.0, 20.0, 40.0, 180.0, 20.0, 180.0, 50.0, 200.0, 40.0, 40.0, 0.0, 30.0, 270.0, 170.0, 0.0, 80.0, 80.0, 220.0, 0.0, 50.0, 190.0, 20.0, 50.0, 290.0, 50.0, 10.0, 80.0, 10.0, 30.0, 60.0, 40.0, -40.0, -100.0, -40.0, -60.0, 300.0, 580.0, 120.0, 390.0, 250.0, 260.0, 340.0, 10.0, 20.0, 30.0, 20.0, 70.0, 50.0, 30.0, 10.0, 20.0, 10.0, 50.0, 40.0, 360.0, 70.0, 20.0, 10.0, 25.0, 20.0, 50.0, 50.0, 150.0, 100.0, 50.0, 20.0, 0.0, 390.0, 0.0, 10.0, 30.0, 0.0, 40.0, 260.0, 0.0, 10.0, 380.0, 20.0, 195.0, 20.0, 305.0, 20.0, 310.0, 100.0, 140.0, 170.0, 45.0, 60.0, 350.0, 60.0, 130.0, 90.0, 80.0, 160.0, -10.0, 620.0, 40.0, 490.0, 390.0, 20.0, 270.0, 30.0, 20.0, -10.0, 270.0, 200.0, 10.0, 0.0, 0.0, 0.0, 170.0, 20.0, 520.0, 30.0, 130.0, 30.0, 20.0, 80.0, 0.0, 420.0, 180.0, 80.0, 90.0, 80.0, 20.0, 10.0, 30.0, 170.0, 350.0, 20.0, 50.0, 20.0, 0.0, 30.0, 180.0, 70.0, 0.0, 270.0, 30.0, 140.0, 990.0, 160.0, 30.0, 0.0, 90.0, 40.0, 100.0, 90.0, 20.0, 40.0, 0.0, 60.0, 30.0, 120.0, 10.0, 10.0, 10.0, 40.0, 180.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 40.0, 10.0, 90.0, 60.0, 130.0, 220.0, 60.0, 180.0, 380.0, 110.0, 40.0, 15.0, 630.0, 120.0, 280.0, 30.0, 410.0, 130.0, 90.0, 40.0, 400.0, 210.0, 60.0, 30.0, 30.0, 510.0, 0.0, 130.0, 10.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 120.0, 30.0, 0.0, 0.0, 40.0, 410.0, 290.0, 100.0, 110.0, 30.0, 30.0, 70.0, 20.0, 50.0, 120.0, 110.0, 210.0, 30.0, 180.0, -520.0, 40.0, 10.0, 210.0, -30.0, 10.0, 510.0, 70.0, 350.0, -5.0, 60.0, 460.0, 80.0, 240.0, 70.0, -120.0, 0.0, 30.0, 50.0, 380.0, 0.0, 0.0, 20.0, 70.0, -30.0, 180.0, 370.0, 270.0, 50.0, 80.0, 30.0, 0.0, 70.0, 275.0, -20.0, 40.0, 60.0, 70.0, 110.0, 30.0, 70.0, 50.0, 530.0, 130.0, 240.0, 90.0, 0.0, 30.0, 40.0, 10.0, 90.0, 10.0, 30.0, 110.0, 20.0, 0.0, 10.0, 40.0, 10.0, 10.0, 80.0, 180.0, 35.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 20.0, 220.0, 80.0, 20.0, 70.0, 35.0, 5.0, 130.0, 50.0, 100.0, 410.0, 100.0, 70.0, 330.0, -50.0, 370.0, -10.0, 120.0, 330.0, 380.0, 40.0, 50.0, 430.0, 10.0, 210.0, 40.0, 0.0, 40.0, 30.0, 40.0, 0.0, 40.0, 150.0, 20.0, 50.0, 20.0, 0.0, 30.0, 40.0, 0.0, 130.0, 30.0, 20.0, 150.0, 190.0, 340.0, 60.0, 190.0, 90.0, 90.0, 80.0, 30.0, 40.0, 450.0, 30.0, 490.0, 50.0, 200.0, 160.0, 295.0, 40.0, 140.0, 80.0, 60.0, 35.0, 150.0, 80.0, 60.0, -90.0, 40.0, 50.0, 50.0, 210.0, 180.0, -20.0, 280.0, 20.0, 20.0, 690.0, 20.0, -30.0, -50.0, 70.0, 40.0, 50.0, 150.0, 0.0, 160.0, 220.0, 70.0, 30.0, 50.0, 20.0, 80.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 0.0, 560.0, 100.0, 270.0, 60.0, 70.0, 200.0, 40.0, 20.0, 30.0, 50.0, 60.0, 140.0, 160.0, 150.0, 80.0, -20.0, 110.0, 100.0, 510.0, 20.0, 0.0, 10.0, 60.0, 10.0, 10.0, 80.0, 10.0, 20.0, 10.0, 0.0, 0.0, 40.0, 120.0, -50.0, 0.0, 540.0, 0.0, 180.0, 50.0, -20.0, 40.0, 50.0, 110.0, 40.0, 60.0, 80.0, 350.0, 110.0, 70.0, 290.0, 150.0, 20.0, 70.0, 30.0, 20.0, 80.0, 30.0, 230.0, 530.0, 360.0, 20.0, 160.0, 270.0, 10.0, 270.0, 30.0, 0.0, 220.0, 190.0, 20.0, 210.0, 50.0, 90.0, 50.0, 390.0, 210.0, 60.0, 160.0, 10.0, 30.0, 160.0, 50.0, 80.0, 180.0, 10.0, 210.0, 35.0, -80.0, 380.0, 60.0, 420.0, 80.0, 80.0, 40.0, 50.0, 200.0, 0.0, 70.0, 0.0, 50.0, 100.0, 120.0, 20.0, 40.0, 20.0, 40.0, 160.0, 420.0, 170.0, 210.0, 80.0, 310.0, 150.0, 130.0, 420.0, 20.0, 30.0, 50.0, 60.0, 170.0, 110.0, 190.0, 20.0, 80.0, 170.0, -80.0, -80.0, 160.0, 30.0, 20.0, 50.0, 20.0, -20.0, 40.0, 320.0, 80.0, 0.0, 0.0, 40.0, 0.0, 0.0, 570.0, 30.0, 0.0, 70.0, 70.0, 0.0, 400.0, 10.0, 40.0, 160.0, 30.0, 120.0, 20.0, 170.0, 330.0, 100.0, 50.0, 270.0, 20.0, 270.0, -30.0, 200.0, 80.0, 220.0, 10.0, 70.0, 110.0, 280.0, 10.0, 40.0, 90.0, 480.0, 50.0, 30.0, 20.0, 100.0, 260.0, 20.0, 30.0, 200.0, -10.0, 190.0, 40.0, 80.0, 250.0, 40.0, 130.0, 280.0, 320.0, 20.0, 320.0, 350.0, 30.0, 20.0, 50.0, 0.0, 200.0, 90.0, 50.0, 290.0, 240.0, 330.0, 330.0, 20.0, 10.0, 50.0, 40.0, 55.0, 250.0, 0.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 60.0, 0.0, 30.0, -130.0, 40.0, 10.0, 120.0, 0.0, 100.0, 220.0, 40.0, -40.0, 40.0, 200.0, 30.0, -30.0, 110.0, 180.0, 250.0, 20.0, 610.0, 150.0, -40.0, 190.0, 70.0, 210.0, 460.0, 100.0, 90.0, 60.0, 280.0, 130.0, 190.0, 0.0, 40.0, 0.0, 50.0, 10.0, 0.0, 130.0, 20.0, 0.0, 40.0, 120.0, 180.0, 230.0, 40.0, 170.0, -5.0, 90.0, 80.0, 230.0, 240.0, 240.0, 150.0, 70.0, 60.0, -10.0, 30.0, 20.0, 70.0, 90.0, 380.0, 320.0, 130.0, 0.0, 410.0, 60.0, 70.0, 10.0, 150.0, 40.0, 50.0, 40.0, 70.0, 70.0, 410.0, 210.0, 50.0, 80.0, 160.0, 25.0, 120.0, 130.0, 360.0, 50.0, 170.0, 30.0, 10.0, 170.0, 310.0, 20.0, 40.0, 90.0, 30.0, 20.0, 0.0, 60.0, 130.0, 30.0, 70.0, 20.0, 260.0, 10.0, 140.0, 10.0, 50.0, 40.0, 50.0, 720.0, 50.0, 160.0, 60.0, 190.0, 50.0, 60.0, 20.0, 150.0, 80.0, 110.0, 140.0, 430.0, 70.0, 80.0, 70.0, 310.0, 70.0, 260.0, 60.0, 200.0, 50.0, 50.0, 110.0, 20.0, 10.0, 80.0, 20.0, 120.0, 0.0, 10.0, 10.0, 20.0, 80.0, 60.0, 90.0, 70.0, 90.0, 50.0, 150.0, 0.0, 160.0, 190.0, 0.0, 350.0, 20.0, 20.0, 210.0, 70.0, 260.0, -105.0, 100.0, 50.0, 460.0, 40.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 15.0, 160.0, 20.0, 10.0, 230.0, 10.0, 160.0, 30.0, 70.0, 30.0, 60.0, 50.0, 90.0, 0.0, 20.0, 300.0, 240.0, 20.0, 260.0, 460.0, 20.0, 50.0, 50.0, 140.0, 60.0, 30.0, 250.0, 50.0, 80.0, 40.0, 110.0, 570.0, 220.0, 10.0, 0.0, 50.0, 170.0, 30.0, 30.0, 160.0, 120.0, 10.0, 40.0, 490.0, 200.0, 40.0, 70.0, 20.0, 60.0, 130.0, 60.0, 90.0, 100.0, 90.0, -10.0, 40.0, 10.0, 300.0, 100.0, 240.0, 70.0, 160.0, 90.0, 360.0, 110.0, 490.0, 380.0, 40.0, 10.0, 20.0, 0.0, 120.0, 10.0, 160.0, 50.0, 220.0, 60.0, 200.0, 30.0, 30.0, 50.0, 200.0, 60.0, 30.0, 230.0, 200.0, 420.0, 30.0, 150.0, -10.0, 40.0, 120.0, 90.0, 30.0, 20.0, 0.0, 0.0, 60.0, 10.0, 270.0, 10.0, 10.0, 30.0, 10.0, 60.0, 490.0, 50.0, -80.0, 90.0, 40.0, 350.0, 60.0, 60.0, 140.0, 100.0, 10.0, 30.0, 520.0, 290.0, 240.0, 310.0, 70.0, 120.0, 60.0, 40.0, 110.0, 350.0, 20.0, 40.0, 0.0, 0.0, 20.0, 20.0, -15.0, 270.0, 70.0, 30.0, 290.0, 470.0, 0.0, 310.0, 20.0, 0.0, 180.0, 30.0, 50.0, 20.0, 20.0, 50.0, 0.0, 50.0, -20.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9654410579582413, "mean_inference_ms": 2.0257910774775554, "mean_action_processing_ms": 0.532010766057781, "mean_env_wait_ms": 1.7117611650964386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016991138458251953, "StateBufferConnector_ms": 0.013491392135620117, "ViewRequirementAgentConnector_ms": 0.43988895416259766}, "num_episodes": 18, "episode_return_max": 2010.0, "episode_return_min": 180.0, "episode_return_mean": 1049.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.120906224546292, "num_env_steps_trained_throughput_per_sec": 20.120906224546292, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 4560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4560000, "timers": {"training_iteration_time_ms": 314122.648, "restore_workers_time_ms": 0.013, "training_step_time_ms": 314122.576, "sample_time_ms": 2993.88, "learn_time_ms": 311108.338, "learn_throughput": 12.857, "synch_weights_time_ms": 11.618}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "done": false, "training_iteration": 114, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-55-15", "timestamp": 1717264515, "time_this_iter_s": 198.8328559398651, "time_total_s": 55330.70607805252, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a58ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 55330.70607805252, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 19.569858156028367, "ram_util_percent": 81.02730496453901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5609424305609623, "cur_kl_coeff": 11.690355691686277, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.385498170933912, "policy_loss": -0.0029515654452172873, "vf_loss": 6.385447533062091, "vf_explained_var": 1.1130662771840446e-05, "kl": 0.00025681032728592173, "entropy": 0.2405124815539938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1075155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "env_runners": {"episode_reward_max": 1830.0, "episode_reward_min": 100.0, "episode_reward_mean": 1025.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -520.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 102.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1825.0, 1770.0, 780.0, 290.0, 1230.0, 250.0, 1715.0, 700.0, 1165.0, 1380.0, 340.0, 395.0, 450.0, 1300.0, 1670.0, 570.0, 470.0, 1560.0, 1545.0, 765.0, 1040.0, 830.0, 180.0, 1400.0, 1310.0, 210.0, 860.0, 1200.0, 1520.0, 1190.0, 1260.0, 1085.0, 990.0, 1300.0, 1420.0, 620.0, 530.0, 1190.0, 1270.0, 1220.0, 1120.0, 1520.0, 1130.0, 1615.0, 200.0, 400.0, 1480.0, 1780.0, 290.0, 1375.0, 1100.0, 1240.0, 1235.0, 1290.0, 710.0, 1290.0, 1300.0, 1260.0, 370.0, 860.0, 1435.0, 305.0, 740.0, 1420.0, 1550.0, 620.0, 1260.0, 1090.0, 1540.0, 1060.0, 1300.0, 440.0, 1130.0, 1830.0, 660.0, 1445.0, 560.0, 530.0, 675.0, 1230.0, 1320.0, 510.0, 1240.0, 990.0, 1120.0, 560.0, 1540.0, 230.0, 1280.0, 1050.0, 100.0, 1260.0, 800.0, 530.0, 610.0, 1110.0, 1310.0, 420.0, 1605.0, 1750.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 130.0, 220.0, 60.0, 180.0, 380.0, 110.0, 40.0, 15.0, 630.0, 120.0, 280.0, 30.0, 410.0, 130.0, 90.0, 40.0, 400.0, 210.0, 60.0, 30.0, 30.0, 510.0, 0.0, 130.0, 10.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 120.0, 30.0, 0.0, 0.0, 40.0, 410.0, 290.0, 100.0, 110.0, 30.0, 30.0, 70.0, 20.0, 50.0, 120.0, 110.0, 210.0, 30.0, 180.0, -520.0, 40.0, 10.0, 210.0, -30.0, 10.0, 510.0, 70.0, 350.0, -5.0, 60.0, 460.0, 80.0, 240.0, 70.0, -120.0, 0.0, 30.0, 50.0, 380.0, 0.0, 0.0, 20.0, 70.0, -30.0, 180.0, 370.0, 270.0, 50.0, 80.0, 30.0, 0.0, 70.0, 275.0, -20.0, 40.0, 60.0, 70.0, 110.0, 30.0, 70.0, 50.0, 530.0, 130.0, 240.0, 90.0, 0.0, 30.0, 40.0, 10.0, 90.0, 10.0, 30.0, 110.0, 20.0, 0.0, 10.0, 40.0, 10.0, 10.0, 80.0, 180.0, 35.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 20.0, 220.0, 80.0, 20.0, 70.0, 35.0, 5.0, 130.0, 50.0, 100.0, 410.0, 100.0, 70.0, 330.0, -50.0, 370.0, -10.0, 120.0, 330.0, 380.0, 40.0, 50.0, 430.0, 10.0, 210.0, 40.0, 0.0, 40.0, 30.0, 40.0, 0.0, 40.0, 150.0, 20.0, 50.0, 20.0, 0.0, 30.0, 40.0, 0.0, 130.0, 30.0, 20.0, 150.0, 190.0, 340.0, 60.0, 190.0, 90.0, 90.0, 80.0, 30.0, 40.0, 450.0, 30.0, 490.0, 50.0, 200.0, 160.0, 295.0, 40.0, 140.0, 80.0, 60.0, 35.0, 150.0, 80.0, 60.0, -90.0, 40.0, 50.0, 50.0, 210.0, 180.0, -20.0, 280.0, 20.0, 20.0, 690.0, 20.0, -30.0, -50.0, 70.0, 40.0, 50.0, 150.0, 0.0, 160.0, 220.0, 70.0, 30.0, 50.0, 20.0, 80.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 0.0, 560.0, 100.0, 270.0, 60.0, 70.0, 200.0, 40.0, 20.0, 30.0, 50.0, 60.0, 140.0, 160.0, 150.0, 80.0, -20.0, 110.0, 100.0, 510.0, 20.0, 0.0, 10.0, 60.0, 10.0, 10.0, 80.0, 10.0, 20.0, 10.0, 0.0, 0.0, 40.0, 120.0, -50.0, 0.0, 540.0, 0.0, 180.0, 50.0, -20.0, 40.0, 50.0, 110.0, 40.0, 60.0, 80.0, 350.0, 110.0, 70.0, 290.0, 150.0, 20.0, 70.0, 30.0, 20.0, 80.0, 30.0, 230.0, 530.0, 360.0, 20.0, 160.0, 270.0, 10.0, 270.0, 30.0, 0.0, 220.0, 190.0, 20.0, 210.0, 50.0, 90.0, 50.0, 390.0, 210.0, 60.0, 160.0, 10.0, 30.0, 160.0, 50.0, 80.0, 180.0, 10.0, 210.0, 35.0, -80.0, 380.0, 60.0, 420.0, 80.0, 80.0, 40.0, 50.0, 200.0, 0.0, 70.0, 0.0, 50.0, 100.0, 120.0, 20.0, 40.0, 20.0, 40.0, 160.0, 420.0, 170.0, 210.0, 80.0, 310.0, 150.0, 130.0, 420.0, 20.0, 30.0, 50.0, 60.0, 170.0, 110.0, 190.0, 20.0, 80.0, 170.0, -80.0, -80.0, 160.0, 30.0, 20.0, 50.0, 20.0, -20.0, 40.0, 320.0, 80.0, 0.0, 0.0, 40.0, 0.0, 0.0, 570.0, 30.0, 0.0, 70.0, 70.0, 0.0, 400.0, 10.0, 40.0, 160.0, 30.0, 120.0, 20.0, 170.0, 330.0, 100.0, 50.0, 270.0, 20.0, 270.0, -30.0, 200.0, 80.0, 220.0, 10.0, 70.0, 110.0, 280.0, 10.0, 40.0, 90.0, 480.0, 50.0, 30.0, 20.0, 100.0, 260.0, 20.0, 30.0, 200.0, -10.0, 190.0, 40.0, 80.0, 250.0, 40.0, 130.0, 280.0, 320.0, 20.0, 320.0, 350.0, 30.0, 20.0, 50.0, 0.0, 200.0, 90.0, 50.0, 290.0, 240.0, 330.0, 330.0, 20.0, 10.0, 50.0, 40.0, 55.0, 250.0, 0.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 60.0, 0.0, 30.0, -130.0, 40.0, 10.0, 120.0, 0.0, 100.0, 220.0, 40.0, -40.0, 40.0, 200.0, 30.0, -30.0, 110.0, 180.0, 250.0, 20.0, 610.0, 150.0, -40.0, 190.0, 70.0, 210.0, 460.0, 100.0, 90.0, 60.0, 280.0, 130.0, 190.0, 0.0, 40.0, 0.0, 50.0, 10.0, 0.0, 130.0, 20.0, 0.0, 40.0, 120.0, 180.0, 230.0, 40.0, 170.0, -5.0, 90.0, 80.0, 230.0, 240.0, 240.0, 150.0, 70.0, 60.0, -10.0, 30.0, 20.0, 70.0, 90.0, 380.0, 320.0, 130.0, 0.0, 410.0, 60.0, 70.0, 10.0, 150.0, 40.0, 50.0, 40.0, 70.0, 70.0, 410.0, 210.0, 50.0, 80.0, 160.0, 25.0, 120.0, 130.0, 360.0, 50.0, 170.0, 30.0, 10.0, 170.0, 310.0, 20.0, 40.0, 90.0, 30.0, 20.0, 0.0, 60.0, 130.0, 30.0, 70.0, 20.0, 260.0, 10.0, 140.0, 10.0, 50.0, 40.0, 50.0, 720.0, 50.0, 160.0, 60.0, 190.0, 50.0, 60.0, 20.0, 150.0, 80.0, 110.0, 140.0, 430.0, 70.0, 80.0, 70.0, 310.0, 70.0, 260.0, 60.0, 200.0, 50.0, 50.0, 110.0, 20.0, 10.0, 80.0, 20.0, 120.0, 0.0, 10.0, 10.0, 20.0, 80.0, 60.0, 90.0, 70.0, 90.0, 50.0, 150.0, 0.0, 160.0, 190.0, 0.0, 350.0, 20.0, 20.0, 210.0, 70.0, 260.0, -105.0, 100.0, 50.0, 460.0, 40.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 15.0, 160.0, 20.0, 10.0, 230.0, 10.0, 160.0, 30.0, 70.0, 30.0, 60.0, 50.0, 90.0, 0.0, 20.0, 300.0, 240.0, 20.0, 260.0, 460.0, 20.0, 50.0, 50.0, 140.0, 60.0, 30.0, 250.0, 50.0, 80.0, 40.0, 110.0, 570.0, 220.0, 10.0, 0.0, 50.0, 170.0, 30.0, 30.0, 160.0, 120.0, 10.0, 40.0, 490.0, 200.0, 40.0, 70.0, 20.0, 60.0, 130.0, 60.0, 90.0, 100.0, 90.0, -10.0, 40.0, 10.0, 300.0, 100.0, 240.0, 70.0, 160.0, 90.0, 360.0, 110.0, 490.0, 380.0, 40.0, 10.0, 20.0, 0.0, 120.0, 10.0, 160.0, 50.0, 220.0, 60.0, 200.0, 30.0, 30.0, 50.0, 200.0, 60.0, 30.0, 230.0, 200.0, 420.0, 30.0, 150.0, -10.0, 40.0, 120.0, 90.0, 30.0, 20.0, 0.0, 0.0, 60.0, 10.0, 270.0, 10.0, 10.0, 30.0, 10.0, 60.0, 490.0, 50.0, -80.0, 90.0, 40.0, 350.0, 60.0, 60.0, 140.0, 100.0, 10.0, 30.0, 520.0, 290.0, 240.0, 310.0, 70.0, 120.0, 60.0, 40.0, 110.0, 350.0, 20.0, 40.0, 0.0, 0.0, 20.0, 20.0, -15.0, 270.0, 70.0, 30.0, 290.0, 470.0, 0.0, 310.0, 20.0, 0.0, 180.0, 30.0, 50.0, 20.0, 20.0, 50.0, 0.0, 50.0, -20.0, 180.0, 10.0, 60.0, 10.0, 30.0, 10.0, 20.0, 290.0, 20.0, 10.0, 70.0, 60.0, 30.0, 80.0, 330.0, 0.0, 10.0, -5.0, 40.0, 90.0, 40.0, 150.0, 240.0, 280.0, 50.0, 150.0, 30.0, 10.0, 20.0, 30.0, 270.0, 280.0, 330.0, 40.0, 200.0, 20.0, 100.0, 30.0, 160.0, 130.0, 30.0, 30.0, 10.0, 20.0, 30.0, 80.0, 280.0, 10.0, 0.0, 30.0, 20.0, 270.0, 150.0, 50.0, 50.0, 10.0, 190.0, 180.0, 70.0, 110.0, 160.0, 30.0, 0.0, 160.0, 100.0, 20.0, 190.0, 40.0, 400.0, 40.0, 10.0, 60.0, 90.0, 220.0, 130.0, 170.0, 0.0, 180.0, 10.0, 250.0, 10.0, 360.0, 50.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 450.0, 90.0, 30.0, 220.0, 370.0, 30.0, 40.0, 70.0, 190.0, 60.0, 0.0, 10.0, -50.0, 0.0, 30.0, 0.0, 10.0, 0.0, 170.0, 490.0, 80.0, 210.0, 120.0, 20.0, 30.0, 80.0, 120.0, 90.0, 40.0, 190.0, 60.0, -10.0, -20.0, 210.0, 450.0, 80.0, -10.0, 0.0, 100.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 80.0, 90.0, 70.0, 20.0, 10.0, 480.0, 390.0, 20.0, 40.0, 60.0, 10.0, 160.0, 350.0, 170.0, 20.0, 20.0, 0.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 40.0, 0.0, 140.0, 130.0, 10.0, 40.0, 120.0, 170.0, 180.0, 90.0, 40.0, 70.0, 0.0, 30.0, 10.0, 20.0, 0.0, 160.0, 10.0, 30.0, 10.0, 50.0, 460.0, 280.0, 190.0, -80.0, 0.0, 140.0, 100.0, 90.0, 370.0, 80.0, 50.0, 50.0, 50.0, 30.0, 350.0, 140.0, 40.0, 80.0, 20.0, 100.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, 50.0, 110.0, 670.0, 300.0, 60.0, -35.0, 210.0, 20.0, 170.0, 90.0, 210.0, 30.0, 610.0, 240.0, 260.0, 40.0, 20.0, 210.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9571718888872511, "mean_inference_ms": 2.0168395752827526, "mean_action_processing_ms": 0.5298272760894327, "mean_env_wait_ms": 1.70508184261907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01680302619934082, "StateBufferConnector_ms": 0.013495206832885742, "ViewRequirementAgentConnector_ms": 0.4387495517730713}, "num_episodes": 23, "episode_return_max": 1830.0, "episode_return_min": 100.0, "episode_return_mean": 1025.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.600070139706794, "num_env_steps_trained_throughput_per_sec": 19.600070139706794, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 4600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4600000, "timers": {"training_iteration_time_ms": 302372.564, "restore_workers_time_ms": 0.013, "training_step_time_ms": 302372.492, "sample_time_ms": 2841.766, "learn_time_ms": 299511.876, "learn_throughput": 13.355, "synch_weights_time_ms": 11.121}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "done": false, "training_iteration": 115, "trial_id": "3d3a5_00000", "date": "2024-06-01_13-58-39", "timestamp": 1717264719, "time_this_iter_s": 204.09077095985413, "time_total_s": 55534.796849012375, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c19820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 55534.796849012375, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 24.275172413793104, "ram_util_percent": 81.66758620689654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.666478065014901, "cur_kl_coeff": 5.845177845843138, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0033845546234203693, "vf_loss": 7.173066550499588, "vf_explained_var": 0.0001531842417610339, "kl": Infinity, "entropy": 0.21644668241484732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1084545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 100.0, "episode_reward_mean": 1069.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 106.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1545.0, 765.0, 1040.0, 830.0, 180.0, 1400.0, 1310.0, 210.0, 860.0, 1200.0, 1520.0, 1190.0, 1260.0, 1085.0, 990.0, 1300.0, 1420.0, 620.0, 530.0, 1190.0, 1270.0, 1220.0, 1120.0, 1520.0, 1130.0, 1615.0, 200.0, 400.0, 1480.0, 1780.0, 290.0, 1375.0, 1100.0, 1240.0, 1235.0, 1290.0, 710.0, 1290.0, 1300.0, 1260.0, 370.0, 860.0, 1435.0, 305.0, 740.0, 1420.0, 1550.0, 620.0, 1260.0, 1090.0, 1540.0, 1060.0, 1300.0, 440.0, 1130.0, 1830.0, 660.0, 1445.0, 560.0, 530.0, 675.0, 1230.0, 1320.0, 510.0, 1240.0, 990.0, 1120.0, 560.0, 1540.0, 230.0, 1280.0, 1050.0, 100.0, 1260.0, 800.0, 530.0, 610.0, 1110.0, 1310.0, 420.0, 1605.0, 1750.0, 840.0, 810.0, 300.0, 1850.0, 875.0, 1190.0, 1120.0, 1200.0, 1280.0, 1380.0, 1830.0, 1270.0, 1745.0, 1195.0, 1100.0, 1320.0, 2090.0, 900.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 490.0, 50.0, 200.0, 160.0, 295.0, 40.0, 140.0, 80.0, 60.0, 35.0, 150.0, 80.0, 60.0, -90.0, 40.0, 50.0, 50.0, 210.0, 180.0, -20.0, 280.0, 20.0, 20.0, 690.0, 20.0, -30.0, -50.0, 70.0, 40.0, 50.0, 150.0, 0.0, 160.0, 220.0, 70.0, 30.0, 50.0, 20.0, 80.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 60.0, 0.0, 560.0, 100.0, 270.0, 60.0, 70.0, 200.0, 40.0, 20.0, 30.0, 50.0, 60.0, 140.0, 160.0, 150.0, 80.0, -20.0, 110.0, 100.0, 510.0, 20.0, 0.0, 10.0, 60.0, 10.0, 10.0, 80.0, 10.0, 20.0, 10.0, 0.0, 0.0, 40.0, 120.0, -50.0, 0.0, 540.0, 0.0, 180.0, 50.0, -20.0, 40.0, 50.0, 110.0, 40.0, 60.0, 80.0, 350.0, 110.0, 70.0, 290.0, 150.0, 20.0, 70.0, 30.0, 20.0, 80.0, 30.0, 230.0, 530.0, 360.0, 20.0, 160.0, 270.0, 10.0, 270.0, 30.0, 0.0, 220.0, 190.0, 20.0, 210.0, 50.0, 90.0, 50.0, 390.0, 210.0, 60.0, 160.0, 10.0, 30.0, 160.0, 50.0, 80.0, 180.0, 10.0, 210.0, 35.0, -80.0, 380.0, 60.0, 420.0, 80.0, 80.0, 40.0, 50.0, 200.0, 0.0, 70.0, 0.0, 50.0, 100.0, 120.0, 20.0, 40.0, 20.0, 40.0, 160.0, 420.0, 170.0, 210.0, 80.0, 310.0, 150.0, 130.0, 420.0, 20.0, 30.0, 50.0, 60.0, 170.0, 110.0, 190.0, 20.0, 80.0, 170.0, -80.0, -80.0, 160.0, 30.0, 20.0, 50.0, 20.0, -20.0, 40.0, 320.0, 80.0, 0.0, 0.0, 40.0, 0.0, 0.0, 570.0, 30.0, 0.0, 70.0, 70.0, 0.0, 400.0, 10.0, 40.0, 160.0, 30.0, 120.0, 20.0, 170.0, 330.0, 100.0, 50.0, 270.0, 20.0, 270.0, -30.0, 200.0, 80.0, 220.0, 10.0, 70.0, 110.0, 280.0, 10.0, 40.0, 90.0, 480.0, 50.0, 30.0, 20.0, 100.0, 260.0, 20.0, 30.0, 200.0, -10.0, 190.0, 40.0, 80.0, 250.0, 40.0, 130.0, 280.0, 320.0, 20.0, 320.0, 350.0, 30.0, 20.0, 50.0, 0.0, 200.0, 90.0, 50.0, 290.0, 240.0, 330.0, 330.0, 20.0, 10.0, 50.0, 40.0, 55.0, 250.0, 0.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 60.0, 0.0, 30.0, -130.0, 40.0, 10.0, 120.0, 0.0, 100.0, 220.0, 40.0, -40.0, 40.0, 200.0, 30.0, -30.0, 110.0, 180.0, 250.0, 20.0, 610.0, 150.0, -40.0, 190.0, 70.0, 210.0, 460.0, 100.0, 90.0, 60.0, 280.0, 130.0, 190.0, 0.0, 40.0, 0.0, 50.0, 10.0, 0.0, 130.0, 20.0, 0.0, 40.0, 120.0, 180.0, 230.0, 40.0, 170.0, -5.0, 90.0, 80.0, 230.0, 240.0, 240.0, 150.0, 70.0, 60.0, -10.0, 30.0, 20.0, 70.0, 90.0, 380.0, 320.0, 130.0, 0.0, 410.0, 60.0, 70.0, 10.0, 150.0, 40.0, 50.0, 40.0, 70.0, 70.0, 410.0, 210.0, 50.0, 80.0, 160.0, 25.0, 120.0, 130.0, 360.0, 50.0, 170.0, 30.0, 10.0, 170.0, 310.0, 20.0, 40.0, 90.0, 30.0, 20.0, 0.0, 60.0, 130.0, 30.0, 70.0, 20.0, 260.0, 10.0, 140.0, 10.0, 50.0, 40.0, 50.0, 720.0, 50.0, 160.0, 60.0, 190.0, 50.0, 60.0, 20.0, 150.0, 80.0, 110.0, 140.0, 430.0, 70.0, 80.0, 70.0, 310.0, 70.0, 260.0, 60.0, 200.0, 50.0, 50.0, 110.0, 20.0, 10.0, 80.0, 20.0, 120.0, 0.0, 10.0, 10.0, 20.0, 80.0, 60.0, 90.0, 70.0, 90.0, 50.0, 150.0, 0.0, 160.0, 190.0, 0.0, 350.0, 20.0, 20.0, 210.0, 70.0, 260.0, -105.0, 100.0, 50.0, 460.0, 40.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 15.0, 160.0, 20.0, 10.0, 230.0, 10.0, 160.0, 30.0, 70.0, 30.0, 60.0, 50.0, 90.0, 0.0, 20.0, 300.0, 240.0, 20.0, 260.0, 460.0, 20.0, 50.0, 50.0, 140.0, 60.0, 30.0, 250.0, 50.0, 80.0, 40.0, 110.0, 570.0, 220.0, 10.0, 0.0, 50.0, 170.0, 30.0, 30.0, 160.0, 120.0, 10.0, 40.0, 490.0, 200.0, 40.0, 70.0, 20.0, 60.0, 130.0, 60.0, 90.0, 100.0, 90.0, -10.0, 40.0, 10.0, 300.0, 100.0, 240.0, 70.0, 160.0, 90.0, 360.0, 110.0, 490.0, 380.0, 40.0, 10.0, 20.0, 0.0, 120.0, 10.0, 160.0, 50.0, 220.0, 60.0, 200.0, 30.0, 30.0, 50.0, 200.0, 60.0, 30.0, 230.0, 200.0, 420.0, 30.0, 150.0, -10.0, 40.0, 120.0, 90.0, 30.0, 20.0, 0.0, 0.0, 60.0, 10.0, 270.0, 10.0, 10.0, 30.0, 10.0, 60.0, 490.0, 50.0, -80.0, 90.0, 40.0, 350.0, 60.0, 60.0, 140.0, 100.0, 10.0, 30.0, 520.0, 290.0, 240.0, 310.0, 70.0, 120.0, 60.0, 40.0, 110.0, 350.0, 20.0, 40.0, 0.0, 0.0, 20.0, 20.0, -15.0, 270.0, 70.0, 30.0, 290.0, 470.0, 0.0, 310.0, 20.0, 0.0, 180.0, 30.0, 50.0, 20.0, 20.0, 50.0, 0.0, 50.0, -20.0, 180.0, 10.0, 60.0, 10.0, 30.0, 10.0, 20.0, 290.0, 20.0, 10.0, 70.0, 60.0, 30.0, 80.0, 330.0, 0.0, 10.0, -5.0, 40.0, 90.0, 40.0, 150.0, 240.0, 280.0, 50.0, 150.0, 30.0, 10.0, 20.0, 30.0, 270.0, 280.0, 330.0, 40.0, 200.0, 20.0, 100.0, 30.0, 160.0, 130.0, 30.0, 30.0, 10.0, 20.0, 30.0, 80.0, 280.0, 10.0, 0.0, 30.0, 20.0, 270.0, 150.0, 50.0, 50.0, 10.0, 190.0, 180.0, 70.0, 110.0, 160.0, 30.0, 0.0, 160.0, 100.0, 20.0, 190.0, 40.0, 400.0, 40.0, 10.0, 60.0, 90.0, 220.0, 130.0, 170.0, 0.0, 180.0, 10.0, 250.0, 10.0, 360.0, 50.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 450.0, 90.0, 30.0, 220.0, 370.0, 30.0, 40.0, 70.0, 190.0, 60.0, 0.0, 10.0, -50.0, 0.0, 30.0, 0.0, 10.0, 0.0, 170.0, 490.0, 80.0, 210.0, 120.0, 20.0, 30.0, 80.0, 120.0, 90.0, 40.0, 190.0, 60.0, -10.0, -20.0, 210.0, 450.0, 80.0, -10.0, 0.0, 100.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 80.0, 90.0, 70.0, 20.0, 10.0, 480.0, 390.0, 20.0, 40.0, 60.0, 10.0, 160.0, 350.0, 170.0, 20.0, 20.0, 0.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 40.0, 0.0, 140.0, 130.0, 10.0, 40.0, 120.0, 170.0, 180.0, 90.0, 40.0, 70.0, 0.0, 30.0, 10.0, 20.0, 0.0, 160.0, 10.0, 30.0, 10.0, 50.0, 460.0, 280.0, 190.0, -80.0, 0.0, 140.0, 100.0, 90.0, 370.0, 80.0, 50.0, 50.0, 50.0, 30.0, 350.0, 140.0, 40.0, 80.0, 20.0, 100.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, 50.0, 110.0, 670.0, 300.0, 60.0, -35.0, 210.0, 20.0, 170.0, 90.0, 210.0, 30.0, 610.0, 240.0, 260.0, 40.0, 20.0, 210.0, 40.0, 190.0, -30.0, 100.0, 0.0, 10.0, 40.0, 10.0, 260.0, 220.0, 40.0, 30.0, 20.0, 200.0, 150.0, 10.0, 40.0, 20.0, 30.0, 10.0, 300.0, 80.0, 20.0, 30.0, 60.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 450.0, 60.0, 430.0, 550.0, 90.0, 180.0, 30.0, 230.0, 40.0, 0.0, 130.0, 50.0, 40.0, 75.0, 60.0, 20.0, 230.0, 350.0, 40.0, 90.0, 90.0, 60.0, 440.0, 0.0, 70.0, 40.0, 10.0, 70.0, 160.0, 70.0, 30.0, 30.0, 150.0, 80.0, 130.0, 310.0, 90.0, 210.0, 20.0, 40.0, 40.0, 180.0, 30.0, 220.0, 310.0, 80.0, 70.0, 50.0, 20.0, 310.0, 120.0, 30.0, 20.0, 30.0, 430.0, 180.0, 90.0, 0.0, 430.0, -40.0, 150.0, -40.0, 220.0, 280.0, 40.0, 50.0, 290.0, 20.0, 50.0, 70.0, 60.0, 110.0, 10.0, 770.0, 320.0, 120.0, 300.0, 40.0, 350.0, 120.0, -20.0, 90.0, 110.0, 470.0, 10.0, 0.0, 100.0, 110.0, 150.0, 60.0, 10.0, 590.0, 10.0, 150.0, 75.0, 270.0, 320.0, 250.0, 220.0, 10.0, 120.0, -170.0, 220.0, 65.0, 120.0, 90.0, 270.0, 20.0, 90.0, 80.0, 150.0, 170.0, 30.0, 40.0, 20.0, 130.0, 370.0, 60.0, 90.0, 200.0, 60.0, 80.0, 30.0, 50.0, 30.0, 340.0, 380.0, 250.0, 210.0, 70.0, 240.0, 70.0, 70.0, -40.0, 680.0, 50.0, 490.0, 10.0, 80.0, 80.0, 10.0, 300.0, 0.0, 130.0, 30.0, 30.0, 230.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.956197721904357, "mean_inference_ms": 2.0179774130529156, "mean_action_processing_ms": 0.5299332562931635, "mean_env_wait_ms": 1.704925262382818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01644587516784668, "StateBufferConnector_ms": 0.013313770294189453, "ViewRequirementAgentConnector_ms": 0.427034854888916}, "num_episodes": 18, "episode_return_max": 2090.0, "episode_return_min": 100.0, "episode_return_mean": 1069.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.2685529134629, "num_env_steps_trained_throughput_per_sec": 19.2685529134629, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 4640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4640000, "timers": {"training_iteration_time_ms": 271268.366, "restore_workers_time_ms": 0.013, "training_step_time_ms": 271268.293, "sample_time_ms": 2866.006, "learn_time_ms": 268383.462, "learn_throughput": 14.904, "synch_weights_time_ms": 11.3}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "done": false, "training_iteration": 116, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-02-07", "timestamp": 1717264927, "time_this_iter_s": 207.6526427268982, "time_total_s": 55742.44949173927, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a61a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 55742.44949173927, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 27.386101694915254, "ram_util_percent": 81.92305084745763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.001311450593642, "cur_kl_coeff": 8.767766768764703, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002666864283824254, "vf_loss": 6.866945841518073, "vf_explained_var": 0.0007049852920670351, "kl": Infinity, "entropy": 0.2207874341593129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1093935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 100.0, "episode_reward_mean": 1085.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 108.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1120.0, 1520.0, 1130.0, 1615.0, 200.0, 400.0, 1480.0, 1780.0, 290.0, 1375.0, 1100.0, 1240.0, 1235.0, 1290.0, 710.0, 1290.0, 1300.0, 1260.0, 370.0, 860.0, 1435.0, 305.0, 740.0, 1420.0, 1550.0, 620.0, 1260.0, 1090.0, 1540.0, 1060.0, 1300.0, 440.0, 1130.0, 1830.0, 660.0, 1445.0, 560.0, 530.0, 675.0, 1230.0, 1320.0, 510.0, 1240.0, 990.0, 1120.0, 560.0, 1540.0, 230.0, 1280.0, 1050.0, 100.0, 1260.0, 800.0, 530.0, 610.0, 1110.0, 1310.0, 420.0, 1605.0, 1750.0, 840.0, 810.0, 300.0, 1850.0, 875.0, 1190.0, 1120.0, 1200.0, 1280.0, 1380.0, 1830.0, 1270.0, 1745.0, 1195.0, 1100.0, 1320.0, 2090.0, 900.0, 1170.0, 1390.0, 1265.0, 920.0, 1930.0, 630.0, 1255.0, 1520.0, 1005.0, 755.0, 130.0, 1500.0, 230.0, 1490.0, 680.0, 1370.0, 1460.0, 980.0, 1210.0, 1280.0, 1220.0, 1130.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 90.0, 480.0, 50.0, 30.0, 20.0, 100.0, 260.0, 20.0, 30.0, 200.0, -10.0, 190.0, 40.0, 80.0, 250.0, 40.0, 130.0, 280.0, 320.0, 20.0, 320.0, 350.0, 30.0, 20.0, 50.0, 0.0, 200.0, 90.0, 50.0, 290.0, 240.0, 330.0, 330.0, 20.0, 10.0, 50.0, 40.0, 55.0, 250.0, 0.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 60.0, 0.0, 30.0, -130.0, 40.0, 10.0, 120.0, 0.0, 100.0, 220.0, 40.0, -40.0, 40.0, 200.0, 30.0, -30.0, 110.0, 180.0, 250.0, 20.0, 610.0, 150.0, -40.0, 190.0, 70.0, 210.0, 460.0, 100.0, 90.0, 60.0, 280.0, 130.0, 190.0, 0.0, 40.0, 0.0, 50.0, 10.0, 0.0, 130.0, 20.0, 0.0, 40.0, 120.0, 180.0, 230.0, 40.0, 170.0, -5.0, 90.0, 80.0, 230.0, 240.0, 240.0, 150.0, 70.0, 60.0, -10.0, 30.0, 20.0, 70.0, 90.0, 380.0, 320.0, 130.0, 0.0, 410.0, 60.0, 70.0, 10.0, 150.0, 40.0, 50.0, 40.0, 70.0, 70.0, 410.0, 210.0, 50.0, 80.0, 160.0, 25.0, 120.0, 130.0, 360.0, 50.0, 170.0, 30.0, 10.0, 170.0, 310.0, 20.0, 40.0, 90.0, 30.0, 20.0, 0.0, 60.0, 130.0, 30.0, 70.0, 20.0, 260.0, 10.0, 140.0, 10.0, 50.0, 40.0, 50.0, 720.0, 50.0, 160.0, 60.0, 190.0, 50.0, 60.0, 20.0, 150.0, 80.0, 110.0, 140.0, 430.0, 70.0, 80.0, 70.0, 310.0, 70.0, 260.0, 60.0, 200.0, 50.0, 50.0, 110.0, 20.0, 10.0, 80.0, 20.0, 120.0, 0.0, 10.0, 10.0, 20.0, 80.0, 60.0, 90.0, 70.0, 90.0, 50.0, 150.0, 0.0, 160.0, 190.0, 0.0, 350.0, 20.0, 20.0, 210.0, 70.0, 260.0, -105.0, 100.0, 50.0, 460.0, 40.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 15.0, 160.0, 20.0, 10.0, 230.0, 10.0, 160.0, 30.0, 70.0, 30.0, 60.0, 50.0, 90.0, 0.0, 20.0, 300.0, 240.0, 20.0, 260.0, 460.0, 20.0, 50.0, 50.0, 140.0, 60.0, 30.0, 250.0, 50.0, 80.0, 40.0, 110.0, 570.0, 220.0, 10.0, 0.0, 50.0, 170.0, 30.0, 30.0, 160.0, 120.0, 10.0, 40.0, 490.0, 200.0, 40.0, 70.0, 20.0, 60.0, 130.0, 60.0, 90.0, 100.0, 90.0, -10.0, 40.0, 10.0, 300.0, 100.0, 240.0, 70.0, 160.0, 90.0, 360.0, 110.0, 490.0, 380.0, 40.0, 10.0, 20.0, 0.0, 120.0, 10.0, 160.0, 50.0, 220.0, 60.0, 200.0, 30.0, 30.0, 50.0, 200.0, 60.0, 30.0, 230.0, 200.0, 420.0, 30.0, 150.0, -10.0, 40.0, 120.0, 90.0, 30.0, 20.0, 0.0, 0.0, 60.0, 10.0, 270.0, 10.0, 10.0, 30.0, 10.0, 60.0, 490.0, 50.0, -80.0, 90.0, 40.0, 350.0, 60.0, 60.0, 140.0, 100.0, 10.0, 30.0, 520.0, 290.0, 240.0, 310.0, 70.0, 120.0, 60.0, 40.0, 110.0, 350.0, 20.0, 40.0, 0.0, 0.0, 20.0, 20.0, -15.0, 270.0, 70.0, 30.0, 290.0, 470.0, 0.0, 310.0, 20.0, 0.0, 180.0, 30.0, 50.0, 20.0, 20.0, 50.0, 0.0, 50.0, -20.0, 180.0, 10.0, 60.0, 10.0, 30.0, 10.0, 20.0, 290.0, 20.0, 10.0, 70.0, 60.0, 30.0, 80.0, 330.0, 0.0, 10.0, -5.0, 40.0, 90.0, 40.0, 150.0, 240.0, 280.0, 50.0, 150.0, 30.0, 10.0, 20.0, 30.0, 270.0, 280.0, 330.0, 40.0, 200.0, 20.0, 100.0, 30.0, 160.0, 130.0, 30.0, 30.0, 10.0, 20.0, 30.0, 80.0, 280.0, 10.0, 0.0, 30.0, 20.0, 270.0, 150.0, 50.0, 50.0, 10.0, 190.0, 180.0, 70.0, 110.0, 160.0, 30.0, 0.0, 160.0, 100.0, 20.0, 190.0, 40.0, 400.0, 40.0, 10.0, 60.0, 90.0, 220.0, 130.0, 170.0, 0.0, 180.0, 10.0, 250.0, 10.0, 360.0, 50.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 450.0, 90.0, 30.0, 220.0, 370.0, 30.0, 40.0, 70.0, 190.0, 60.0, 0.0, 10.0, -50.0, 0.0, 30.0, 0.0, 10.0, 0.0, 170.0, 490.0, 80.0, 210.0, 120.0, 20.0, 30.0, 80.0, 120.0, 90.0, 40.0, 190.0, 60.0, -10.0, -20.0, 210.0, 450.0, 80.0, -10.0, 0.0, 100.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 80.0, 90.0, 70.0, 20.0, 10.0, 480.0, 390.0, 20.0, 40.0, 60.0, 10.0, 160.0, 350.0, 170.0, 20.0, 20.0, 0.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 40.0, 0.0, 140.0, 130.0, 10.0, 40.0, 120.0, 170.0, 180.0, 90.0, 40.0, 70.0, 0.0, 30.0, 10.0, 20.0, 0.0, 160.0, 10.0, 30.0, 10.0, 50.0, 460.0, 280.0, 190.0, -80.0, 0.0, 140.0, 100.0, 90.0, 370.0, 80.0, 50.0, 50.0, 50.0, 30.0, 350.0, 140.0, 40.0, 80.0, 20.0, 100.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, 50.0, 110.0, 670.0, 300.0, 60.0, -35.0, 210.0, 20.0, 170.0, 90.0, 210.0, 30.0, 610.0, 240.0, 260.0, 40.0, 20.0, 210.0, 40.0, 190.0, -30.0, 100.0, 0.0, 10.0, 40.0, 10.0, 260.0, 220.0, 40.0, 30.0, 20.0, 200.0, 150.0, 10.0, 40.0, 20.0, 30.0, 10.0, 300.0, 80.0, 20.0, 30.0, 60.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 450.0, 60.0, 430.0, 550.0, 90.0, 180.0, 30.0, 230.0, 40.0, 0.0, 130.0, 50.0, 40.0, 75.0, 60.0, 20.0, 230.0, 350.0, 40.0, 90.0, 90.0, 60.0, 440.0, 0.0, 70.0, 40.0, 10.0, 70.0, 160.0, 70.0, 30.0, 30.0, 150.0, 80.0, 130.0, 310.0, 90.0, 210.0, 20.0, 40.0, 40.0, 180.0, 30.0, 220.0, 310.0, 80.0, 70.0, 50.0, 20.0, 310.0, 120.0, 30.0, 20.0, 30.0, 430.0, 180.0, 90.0, 0.0, 430.0, -40.0, 150.0, -40.0, 220.0, 280.0, 40.0, 50.0, 290.0, 20.0, 50.0, 70.0, 60.0, 110.0, 10.0, 770.0, 320.0, 120.0, 300.0, 40.0, 350.0, 120.0, -20.0, 90.0, 110.0, 470.0, 10.0, 0.0, 100.0, 110.0, 150.0, 60.0, 10.0, 590.0, 10.0, 150.0, 75.0, 270.0, 320.0, 250.0, 220.0, 10.0, 120.0, -170.0, 220.0, 65.0, 120.0, 90.0, 270.0, 20.0, 90.0, 80.0, 150.0, 170.0, 30.0, 40.0, 20.0, 130.0, 370.0, 60.0, 90.0, 200.0, 60.0, 80.0, 30.0, 50.0, 30.0, 340.0, 380.0, 250.0, 210.0, 70.0, 240.0, 70.0, 70.0, -40.0, 680.0, 50.0, 490.0, 10.0, 80.0, 80.0, 10.0, 300.0, 0.0, 130.0, 30.0, 30.0, 230.0, 130.0, 10.0, 0.0, -20.0, 290.0, 430.0, 0.0, 30.0, 120.0, 180.0, -10.0, 0.0, 10.0, 300.0, 140.0, 90.0, 70.0, 710.0, 50.0, 30.0, 10.0, 30.0, 30.0, 140.0, 45.0, 0.0, 370.0, 190.0, 20.0, 430.0, 90.0, 30.0, -30.0, 40.0, 290.0, 290.0, 60.0, 10.0, 30.0, 110.0, 600.0, -40.0, 80.0, 130.0, 320.0, 80.0, 620.0, -50.0, 170.0, 20.0, 10.0, 70.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, 360.0, 30.0, 100.0, 50.0, 150.0, 0.0, 60.0, 450.0, 160.0, 35.0, -30.0, 280.0, 60.0, 60.0, 520.0, 280.0, 80.0, 30.0, 20.0, 10.0, 320.0, 140.0, 20.0, 5.0, 60.0, 300.0, 390.0, 30.0, 60.0, 0.0, 70.0, 70.0, 10.0, 460.0, 10.0, -40.0, 40.0, 80.0, 20.0, 50.0, -25.0, 150.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 50.0, 270.0, 100.0, 300.0, 240.0, 0.0, 210.0, 40.0, 190.0, 100.0, 40.0, 20.0, 0.0, 30.0, 20.0, 60.0, 30.0, 10.0, 0.0, 20.0, 70.0, -5.0, 20.0, 70.0, 60.0, 50.0, 920.0, 80.0, 155.0, 70.0, 10.0, 90.0, 270.0, -10.0, 50.0, 10.0, 10.0, 220.0, 20.0, 10.0, 20.0, 440.0, 170.0, 300.0, 240.0, 60.0, -30.0, 60.0, 80.0, 30.0, 70.0, 0.0, 110.0, 20.0, 150.0, 0.0, 410.0, 410.0, 100.0, 190.0, 60.0, 20.0, 10.0, 380.0, 20.0, 70.0, 20.0, 250.0, 60.0, 90.0, 290.0, 70.0, 10.0, 0.0, 250.0, 240.0, -40.0, 10.0, 60.0, 320.0, 460.0, 60.0, 10.0, 0.0, 90.0, 50.0, 440.0, 80.0, 50.0, 40.0, 90.0, 60.0, 110.0, 520.0, 100.0, 70.0, 20.0, 40.0, 50.0, 160.0, 30.0, 10.0, 130.0, 60.0, 90.0, 130.0, 40.0, 60.0, 330.0, 250.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9480973804713206, "mean_inference_ms": 2.0080120232113297, "mean_action_processing_ms": 0.5285473045937039, "mean_env_wait_ms": 1.7010737283702997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01466989517211914, "StateBufferConnector_ms": 0.013400793075561523, "ViewRequirementAgentConnector_ms": 0.43506312370300293}, "num_episodes": 22, "episode_return_max": 2090.0, "episode_return_min": 100.0, "episode_return_mean": 1085.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.97369373278324, "num_env_steps_trained_throughput_per_sec": 19.97369373278324, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 4680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4680000, "timers": {"training_iteration_time_ms": 270679.981, "restore_workers_time_ms": 0.013, "training_step_time_ms": 270679.909, "sample_time_ms": 2821.065, "learn_time_ms": 267839.808, "learn_throughput": 14.934, "synch_weights_time_ms": 11.268}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "done": false, "training_iteration": 117, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-05-27", "timestamp": 1717265127, "time_this_iter_s": 200.27507615089417, "time_total_s": 55942.72456789017, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f87d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 55942.72456789017, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 22.972535211267605, "ram_util_percent": 80.55669014084508}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1871330965822118, "cur_kl_coeff": 13.151650153147054, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0024569997237276196, "vf_loss": 7.511587538480505, "vf_explained_var": 0.0007012397209549356, "kl": Infinity, "entropy": 0.20391005104738938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1103325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 100.0, "episode_reward_mean": 1100.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 110.085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 860.0, 1435.0, 305.0, 740.0, 1420.0, 1550.0, 620.0, 1260.0, 1090.0, 1540.0, 1060.0, 1300.0, 440.0, 1130.0, 1830.0, 660.0, 1445.0, 560.0, 530.0, 675.0, 1230.0, 1320.0, 510.0, 1240.0, 990.0, 1120.0, 560.0, 1540.0, 230.0, 1280.0, 1050.0, 100.0, 1260.0, 800.0, 530.0, 610.0, 1110.0, 1310.0, 420.0, 1605.0, 1750.0, 840.0, 810.0, 300.0, 1850.0, 875.0, 1190.0, 1120.0, 1200.0, 1280.0, 1380.0, 1830.0, 1270.0, 1745.0, 1195.0, 1100.0, 1320.0, 2090.0, 900.0, 1170.0, 1390.0, 1265.0, 920.0, 1930.0, 630.0, 1255.0, 1520.0, 1005.0, 755.0, 130.0, 1500.0, 230.0, 1490.0, 680.0, 1370.0, 1460.0, 980.0, 1210.0, 1280.0, 1220.0, 1130.0, 1200.0, 1310.0, 1680.0, 1560.0, 870.0, 1235.0, 600.0, 960.0, 1655.0, 1010.0, 930.0, 1680.0, 1430.0, 730.0, 1040.0, 1450.0, 1025.0, 1520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 80.0, 20.0, 120.0, 0.0, 10.0, 10.0, 20.0, 80.0, 60.0, 90.0, 70.0, 90.0, 50.0, 150.0, 0.0, 160.0, 190.0, 0.0, 350.0, 20.0, 20.0, 210.0, 70.0, 260.0, -105.0, 100.0, 50.0, 460.0, 40.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 15.0, 160.0, 20.0, 10.0, 230.0, 10.0, 160.0, 30.0, 70.0, 30.0, 60.0, 50.0, 90.0, 0.0, 20.0, 300.0, 240.0, 20.0, 260.0, 460.0, 20.0, 50.0, 50.0, 140.0, 60.0, 30.0, 250.0, 50.0, 80.0, 40.0, 110.0, 570.0, 220.0, 10.0, 0.0, 50.0, 170.0, 30.0, 30.0, 160.0, 120.0, 10.0, 40.0, 490.0, 200.0, 40.0, 70.0, 20.0, 60.0, 130.0, 60.0, 90.0, 100.0, 90.0, -10.0, 40.0, 10.0, 300.0, 100.0, 240.0, 70.0, 160.0, 90.0, 360.0, 110.0, 490.0, 380.0, 40.0, 10.0, 20.0, 0.0, 120.0, 10.0, 160.0, 50.0, 220.0, 60.0, 200.0, 30.0, 30.0, 50.0, 200.0, 60.0, 30.0, 230.0, 200.0, 420.0, 30.0, 150.0, -10.0, 40.0, 120.0, 90.0, 30.0, 20.0, 0.0, 0.0, 60.0, 10.0, 270.0, 10.0, 10.0, 30.0, 10.0, 60.0, 490.0, 50.0, -80.0, 90.0, 40.0, 350.0, 60.0, 60.0, 140.0, 100.0, 10.0, 30.0, 520.0, 290.0, 240.0, 310.0, 70.0, 120.0, 60.0, 40.0, 110.0, 350.0, 20.0, 40.0, 0.0, 0.0, 20.0, 20.0, -15.0, 270.0, 70.0, 30.0, 290.0, 470.0, 0.0, 310.0, 20.0, 0.0, 180.0, 30.0, 50.0, 20.0, 20.0, 50.0, 0.0, 50.0, -20.0, 180.0, 10.0, 60.0, 10.0, 30.0, 10.0, 20.0, 290.0, 20.0, 10.0, 70.0, 60.0, 30.0, 80.0, 330.0, 0.0, 10.0, -5.0, 40.0, 90.0, 40.0, 150.0, 240.0, 280.0, 50.0, 150.0, 30.0, 10.0, 20.0, 30.0, 270.0, 280.0, 330.0, 40.0, 200.0, 20.0, 100.0, 30.0, 160.0, 130.0, 30.0, 30.0, 10.0, 20.0, 30.0, 80.0, 280.0, 10.0, 0.0, 30.0, 20.0, 270.0, 150.0, 50.0, 50.0, 10.0, 190.0, 180.0, 70.0, 110.0, 160.0, 30.0, 0.0, 160.0, 100.0, 20.0, 190.0, 40.0, 400.0, 40.0, 10.0, 60.0, 90.0, 220.0, 130.0, 170.0, 0.0, 180.0, 10.0, 250.0, 10.0, 360.0, 50.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 450.0, 90.0, 30.0, 220.0, 370.0, 30.0, 40.0, 70.0, 190.0, 60.0, 0.0, 10.0, -50.0, 0.0, 30.0, 0.0, 10.0, 0.0, 170.0, 490.0, 80.0, 210.0, 120.0, 20.0, 30.0, 80.0, 120.0, 90.0, 40.0, 190.0, 60.0, -10.0, -20.0, 210.0, 450.0, 80.0, -10.0, 0.0, 100.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 80.0, 90.0, 70.0, 20.0, 10.0, 480.0, 390.0, 20.0, 40.0, 60.0, 10.0, 160.0, 350.0, 170.0, 20.0, 20.0, 0.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 40.0, 0.0, 140.0, 130.0, 10.0, 40.0, 120.0, 170.0, 180.0, 90.0, 40.0, 70.0, 0.0, 30.0, 10.0, 20.0, 0.0, 160.0, 10.0, 30.0, 10.0, 50.0, 460.0, 280.0, 190.0, -80.0, 0.0, 140.0, 100.0, 90.0, 370.0, 80.0, 50.0, 50.0, 50.0, 30.0, 350.0, 140.0, 40.0, 80.0, 20.0, 100.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, 50.0, 110.0, 670.0, 300.0, 60.0, -35.0, 210.0, 20.0, 170.0, 90.0, 210.0, 30.0, 610.0, 240.0, 260.0, 40.0, 20.0, 210.0, 40.0, 190.0, -30.0, 100.0, 0.0, 10.0, 40.0, 10.0, 260.0, 220.0, 40.0, 30.0, 20.0, 200.0, 150.0, 10.0, 40.0, 20.0, 30.0, 10.0, 300.0, 80.0, 20.0, 30.0, 60.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 450.0, 60.0, 430.0, 550.0, 90.0, 180.0, 30.0, 230.0, 40.0, 0.0, 130.0, 50.0, 40.0, 75.0, 60.0, 20.0, 230.0, 350.0, 40.0, 90.0, 90.0, 60.0, 440.0, 0.0, 70.0, 40.0, 10.0, 70.0, 160.0, 70.0, 30.0, 30.0, 150.0, 80.0, 130.0, 310.0, 90.0, 210.0, 20.0, 40.0, 40.0, 180.0, 30.0, 220.0, 310.0, 80.0, 70.0, 50.0, 20.0, 310.0, 120.0, 30.0, 20.0, 30.0, 430.0, 180.0, 90.0, 0.0, 430.0, -40.0, 150.0, -40.0, 220.0, 280.0, 40.0, 50.0, 290.0, 20.0, 50.0, 70.0, 60.0, 110.0, 10.0, 770.0, 320.0, 120.0, 300.0, 40.0, 350.0, 120.0, -20.0, 90.0, 110.0, 470.0, 10.0, 0.0, 100.0, 110.0, 150.0, 60.0, 10.0, 590.0, 10.0, 150.0, 75.0, 270.0, 320.0, 250.0, 220.0, 10.0, 120.0, -170.0, 220.0, 65.0, 120.0, 90.0, 270.0, 20.0, 90.0, 80.0, 150.0, 170.0, 30.0, 40.0, 20.0, 130.0, 370.0, 60.0, 90.0, 200.0, 60.0, 80.0, 30.0, 50.0, 30.0, 340.0, 380.0, 250.0, 210.0, 70.0, 240.0, 70.0, 70.0, -40.0, 680.0, 50.0, 490.0, 10.0, 80.0, 80.0, 10.0, 300.0, 0.0, 130.0, 30.0, 30.0, 230.0, 130.0, 10.0, 0.0, -20.0, 290.0, 430.0, 0.0, 30.0, 120.0, 180.0, -10.0, 0.0, 10.0, 300.0, 140.0, 90.0, 70.0, 710.0, 50.0, 30.0, 10.0, 30.0, 30.0, 140.0, 45.0, 0.0, 370.0, 190.0, 20.0, 430.0, 90.0, 30.0, -30.0, 40.0, 290.0, 290.0, 60.0, 10.0, 30.0, 110.0, 600.0, -40.0, 80.0, 130.0, 320.0, 80.0, 620.0, -50.0, 170.0, 20.0, 10.0, 70.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, 360.0, 30.0, 100.0, 50.0, 150.0, 0.0, 60.0, 450.0, 160.0, 35.0, -30.0, 280.0, 60.0, 60.0, 520.0, 280.0, 80.0, 30.0, 20.0, 10.0, 320.0, 140.0, 20.0, 5.0, 60.0, 300.0, 390.0, 30.0, 60.0, 0.0, 70.0, 70.0, 10.0, 460.0, 10.0, -40.0, 40.0, 80.0, 20.0, 50.0, -25.0, 150.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 50.0, 270.0, 100.0, 300.0, 240.0, 0.0, 210.0, 40.0, 190.0, 100.0, 40.0, 20.0, 0.0, 30.0, 20.0, 60.0, 30.0, 10.0, 0.0, 20.0, 70.0, -5.0, 20.0, 70.0, 60.0, 50.0, 920.0, 80.0, 155.0, 70.0, 10.0, 90.0, 270.0, -10.0, 50.0, 10.0, 10.0, 220.0, 20.0, 10.0, 20.0, 440.0, 170.0, 300.0, 240.0, 60.0, -30.0, 60.0, 80.0, 30.0, 70.0, 0.0, 110.0, 20.0, 150.0, 0.0, 410.0, 410.0, 100.0, 190.0, 60.0, 20.0, 10.0, 380.0, 20.0, 70.0, 20.0, 250.0, 60.0, 90.0, 290.0, 70.0, 10.0, 0.0, 250.0, 240.0, -40.0, 10.0, 60.0, 320.0, 460.0, 60.0, 10.0, 0.0, 90.0, 50.0, 440.0, 80.0, 50.0, 40.0, 90.0, 60.0, 110.0, 520.0, 100.0, 70.0, 20.0, 40.0, 50.0, 160.0, 30.0, 10.0, 130.0, 60.0, 90.0, 130.0, 40.0, 60.0, 330.0, 250.0, 40.0, 1000.0, 40.0, -105.0, -140.0, 430.0, 60.0, 50.0, -130.0, -45.0, 170.0, 40.0, 20.0, 50.0, 540.0, 10.0, 30.0, 0.0, 70.0, 380.0, 60.0, 260.0, 80.0, 90.0, 180.0, 60.0, 570.0, 90.0, 180.0, 110.0, 20.0, 60.0, 210.0, 340.0, 290.0, 110.0, 240.0, 180.0, 140.0, -30.0, 0.0, 150.0, 70.0, 50.0, 10.0, 60.0, 20.0, 60.0, 330.0, 120.0, 130.0, 380.0, 440.0, 80.0, 70.0, 30.0, 50.0, 10.0, -85.0, 130.0, 370.0, 70.0, 130.0, 70.0, 60.0, 110.0, -390.0, -30.0, 60.0, 150.0, 250.0, 10.0, 50.0, 260.0, 100.0, 170.0, 20.0, 0.0, 40.0, 60.0, 10.0, 430.0, 30.0, 85.0, 390.0, 0.0, 220.0, 120.0, 360.0, 10.0, 320.0, 10.0, -20.0, 250.0, 10.0, 280.0, 0.0, 20.0, 40.0, 100.0, 0.0, 180.0, 80.0, 20.0, 30.0, 330.0, 50.0, 240.0, 0.0, 0.0, 60.0, 100.0, 100.0, 30.0, 80.0, 50.0, 120.0, 570.0, 60.0, 510.0, 190.0, 70.0, 240.0, 40.0, 60.0, 130.0, 60.0, 340.0, 200.0, 100.0, 20.0, 30.0, 10.0, 40.0, 10.0, 30.0, 260.0, 30.0, 110.0, 190.0, 210.0, 70.0, 160.0, 50.0, 200.0, 20.0, 90.0, 40.0, 80.0, 120.0, 40.0, 50.0, 100.0, 70.0, 300.0, 250.0, 80.0, 40.0, 410.0, 110.0, -10.0, 30.0, 0.0, -135.0, 10.0, 520.0, 160.0, 50.0, 300.0, 100.0, 10.0, 100.0, 320.0, 110.0, 80.0, 110.0, 20.0, 250.0, 500.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9479534250067718, "mean_inference_ms": 2.0117298299632616, "mean_action_processing_ms": 0.5282849268924786, "mean_env_wait_ms": 1.6992840372824054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012825489044189453, "StateBufferConnector_ms": 0.012688875198364258, "ViewRequirementAgentConnector_ms": 0.4224843978881836}, "num_episodes": 18, "episode_return_max": 2090.0, "episode_return_min": 100.0, "episode_return_mean": 1100.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.49084164246247, "num_env_steps_trained_throughput_per_sec": 19.49084164246247, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 4720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4720000, "timers": {"training_iteration_time_ms": 220132.825, "restore_workers_time_ms": 0.013, "training_step_time_ms": 220132.742, "sample_time_ms": 2773.947, "learn_time_ms": 217340.223, "learn_throughput": 18.404, "synch_weights_time_ms": 11.404}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "done": false, "training_iteration": 118, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-08-53", "timestamp": 1717265333, "time_this_iter_s": 205.2769033908844, "time_total_s": 56148.00147128105, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c32310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56148.00147128105, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 24.123630136986304, "ram_util_percent": 82.41986301369863}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.76997211414912, "cur_kl_coeff": 19.72747522972059, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0019951822016243373, "vf_loss": 7.265352591564353, "vf_explained_var": 0.001475140150870505, "kl": Infinity, "entropy": 0.23395970908407204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1112715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 100.0, "episode_reward_mean": 1131.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 113.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [560.0, 530.0, 675.0, 1230.0, 1320.0, 510.0, 1240.0, 990.0, 1120.0, 560.0, 1540.0, 230.0, 1280.0, 1050.0, 100.0, 1260.0, 800.0, 530.0, 610.0, 1110.0, 1310.0, 420.0, 1605.0, 1750.0, 840.0, 810.0, 300.0, 1850.0, 875.0, 1190.0, 1120.0, 1200.0, 1280.0, 1380.0, 1830.0, 1270.0, 1745.0, 1195.0, 1100.0, 1320.0, 2090.0, 900.0, 1170.0, 1390.0, 1265.0, 920.0, 1930.0, 630.0, 1255.0, 1520.0, 1005.0, 755.0, 130.0, 1500.0, 230.0, 1490.0, 680.0, 1370.0, 1460.0, 980.0, 1210.0, 1280.0, 1220.0, 1130.0, 1200.0, 1310.0, 1680.0, 1560.0, 870.0, 1235.0, 600.0, 960.0, 1655.0, 1010.0, 930.0, 1680.0, 1430.0, 730.0, 1040.0, 1450.0, 1025.0, 1520.0, 1190.0, 1220.0, 430.0, 1720.0, 385.0, 1950.0, 1350.0, 420.0, 1140.0, 1630.0, 1845.0, 1525.0, 1290.0, 1020.0, 1570.0, 1080.0, 790.0, 1580.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 30.0, 50.0, 20.0, 20.0, 50.0, 0.0, 50.0, -20.0, 180.0, 10.0, 60.0, 10.0, 30.0, 10.0, 20.0, 290.0, 20.0, 10.0, 70.0, 60.0, 30.0, 80.0, 330.0, 0.0, 10.0, -5.0, 40.0, 90.0, 40.0, 150.0, 240.0, 280.0, 50.0, 150.0, 30.0, 10.0, 20.0, 30.0, 270.0, 280.0, 330.0, 40.0, 200.0, 20.0, 100.0, 30.0, 160.0, 130.0, 30.0, 30.0, 10.0, 20.0, 30.0, 80.0, 280.0, 10.0, 0.0, 30.0, 20.0, 270.0, 150.0, 50.0, 50.0, 10.0, 190.0, 180.0, 70.0, 110.0, 160.0, 30.0, 0.0, 160.0, 100.0, 20.0, 190.0, 40.0, 400.0, 40.0, 10.0, 60.0, 90.0, 220.0, 130.0, 170.0, 0.0, 180.0, 10.0, 250.0, 10.0, 360.0, 50.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 450.0, 90.0, 30.0, 220.0, 370.0, 30.0, 40.0, 70.0, 190.0, 60.0, 0.0, 10.0, -50.0, 0.0, 30.0, 0.0, 10.0, 0.0, 170.0, 490.0, 80.0, 210.0, 120.0, 20.0, 30.0, 80.0, 120.0, 90.0, 40.0, 190.0, 60.0, -10.0, -20.0, 210.0, 450.0, 80.0, -10.0, 0.0, 100.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 80.0, 90.0, 70.0, 20.0, 10.0, 480.0, 390.0, 20.0, 40.0, 60.0, 10.0, 160.0, 350.0, 170.0, 20.0, 20.0, 0.0, -60.0, 120.0, 10.0, 0.0, 30.0, 20.0, 40.0, 0.0, 140.0, 130.0, 10.0, 40.0, 120.0, 170.0, 180.0, 90.0, 40.0, 70.0, 0.0, 30.0, 10.0, 20.0, 0.0, 160.0, 10.0, 30.0, 10.0, 50.0, 460.0, 280.0, 190.0, -80.0, 0.0, 140.0, 100.0, 90.0, 370.0, 80.0, 50.0, 50.0, 50.0, 30.0, 350.0, 140.0, 40.0, 80.0, 20.0, 100.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, 50.0, 110.0, 670.0, 300.0, 60.0, -35.0, 210.0, 20.0, 170.0, 90.0, 210.0, 30.0, 610.0, 240.0, 260.0, 40.0, 20.0, 210.0, 40.0, 190.0, -30.0, 100.0, 0.0, 10.0, 40.0, 10.0, 260.0, 220.0, 40.0, 30.0, 20.0, 200.0, 150.0, 10.0, 40.0, 20.0, 30.0, 10.0, 300.0, 80.0, 20.0, 30.0, 60.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 450.0, 60.0, 430.0, 550.0, 90.0, 180.0, 30.0, 230.0, 40.0, 0.0, 130.0, 50.0, 40.0, 75.0, 60.0, 20.0, 230.0, 350.0, 40.0, 90.0, 90.0, 60.0, 440.0, 0.0, 70.0, 40.0, 10.0, 70.0, 160.0, 70.0, 30.0, 30.0, 150.0, 80.0, 130.0, 310.0, 90.0, 210.0, 20.0, 40.0, 40.0, 180.0, 30.0, 220.0, 310.0, 80.0, 70.0, 50.0, 20.0, 310.0, 120.0, 30.0, 20.0, 30.0, 430.0, 180.0, 90.0, 0.0, 430.0, -40.0, 150.0, -40.0, 220.0, 280.0, 40.0, 50.0, 290.0, 20.0, 50.0, 70.0, 60.0, 110.0, 10.0, 770.0, 320.0, 120.0, 300.0, 40.0, 350.0, 120.0, -20.0, 90.0, 110.0, 470.0, 10.0, 0.0, 100.0, 110.0, 150.0, 60.0, 10.0, 590.0, 10.0, 150.0, 75.0, 270.0, 320.0, 250.0, 220.0, 10.0, 120.0, -170.0, 220.0, 65.0, 120.0, 90.0, 270.0, 20.0, 90.0, 80.0, 150.0, 170.0, 30.0, 40.0, 20.0, 130.0, 370.0, 60.0, 90.0, 200.0, 60.0, 80.0, 30.0, 50.0, 30.0, 340.0, 380.0, 250.0, 210.0, 70.0, 240.0, 70.0, 70.0, -40.0, 680.0, 50.0, 490.0, 10.0, 80.0, 80.0, 10.0, 300.0, 0.0, 130.0, 30.0, 30.0, 230.0, 130.0, 10.0, 0.0, -20.0, 290.0, 430.0, 0.0, 30.0, 120.0, 180.0, -10.0, 0.0, 10.0, 300.0, 140.0, 90.0, 70.0, 710.0, 50.0, 30.0, 10.0, 30.0, 30.0, 140.0, 45.0, 0.0, 370.0, 190.0, 20.0, 430.0, 90.0, 30.0, -30.0, 40.0, 290.0, 290.0, 60.0, 10.0, 30.0, 110.0, 600.0, -40.0, 80.0, 130.0, 320.0, 80.0, 620.0, -50.0, 170.0, 20.0, 10.0, 70.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, 360.0, 30.0, 100.0, 50.0, 150.0, 0.0, 60.0, 450.0, 160.0, 35.0, -30.0, 280.0, 60.0, 60.0, 520.0, 280.0, 80.0, 30.0, 20.0, 10.0, 320.0, 140.0, 20.0, 5.0, 60.0, 300.0, 390.0, 30.0, 60.0, 0.0, 70.0, 70.0, 10.0, 460.0, 10.0, -40.0, 40.0, 80.0, 20.0, 50.0, -25.0, 150.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 50.0, 270.0, 100.0, 300.0, 240.0, 0.0, 210.0, 40.0, 190.0, 100.0, 40.0, 20.0, 0.0, 30.0, 20.0, 60.0, 30.0, 10.0, 0.0, 20.0, 70.0, -5.0, 20.0, 70.0, 60.0, 50.0, 920.0, 80.0, 155.0, 70.0, 10.0, 90.0, 270.0, -10.0, 50.0, 10.0, 10.0, 220.0, 20.0, 10.0, 20.0, 440.0, 170.0, 300.0, 240.0, 60.0, -30.0, 60.0, 80.0, 30.0, 70.0, 0.0, 110.0, 20.0, 150.0, 0.0, 410.0, 410.0, 100.0, 190.0, 60.0, 20.0, 10.0, 380.0, 20.0, 70.0, 20.0, 250.0, 60.0, 90.0, 290.0, 70.0, 10.0, 0.0, 250.0, 240.0, -40.0, 10.0, 60.0, 320.0, 460.0, 60.0, 10.0, 0.0, 90.0, 50.0, 440.0, 80.0, 50.0, 40.0, 90.0, 60.0, 110.0, 520.0, 100.0, 70.0, 20.0, 40.0, 50.0, 160.0, 30.0, 10.0, 130.0, 60.0, 90.0, 130.0, 40.0, 60.0, 330.0, 250.0, 40.0, 1000.0, 40.0, -105.0, -140.0, 430.0, 60.0, 50.0, -130.0, -45.0, 170.0, 40.0, 20.0, 50.0, 540.0, 10.0, 30.0, 0.0, 70.0, 380.0, 60.0, 260.0, 80.0, 90.0, 180.0, 60.0, 570.0, 90.0, 180.0, 110.0, 20.0, 60.0, 210.0, 340.0, 290.0, 110.0, 240.0, 180.0, 140.0, -30.0, 0.0, 150.0, 70.0, 50.0, 10.0, 60.0, 20.0, 60.0, 330.0, 120.0, 130.0, 380.0, 440.0, 80.0, 70.0, 30.0, 50.0, 10.0, -85.0, 130.0, 370.0, 70.0, 130.0, 70.0, 60.0, 110.0, -390.0, -30.0, 60.0, 150.0, 250.0, 10.0, 50.0, 260.0, 100.0, 170.0, 20.0, 0.0, 40.0, 60.0, 10.0, 430.0, 30.0, 85.0, 390.0, 0.0, 220.0, 120.0, 360.0, 10.0, 320.0, 10.0, -20.0, 250.0, 10.0, 280.0, 0.0, 20.0, 40.0, 100.0, 0.0, 180.0, 80.0, 20.0, 30.0, 330.0, 50.0, 240.0, 0.0, 0.0, 60.0, 100.0, 100.0, 30.0, 80.0, 50.0, 120.0, 570.0, 60.0, 510.0, 190.0, 70.0, 240.0, 40.0, 60.0, 130.0, 60.0, 340.0, 200.0, 100.0, 20.0, 30.0, 10.0, 40.0, 10.0, 30.0, 260.0, 30.0, 110.0, 190.0, 210.0, 70.0, 160.0, 50.0, 200.0, 20.0, 90.0, 40.0, 80.0, 120.0, 40.0, 50.0, 100.0, 70.0, 300.0, 250.0, 80.0, 40.0, 410.0, 110.0, -10.0, 30.0, 0.0, -135.0, 10.0, 520.0, 160.0, 50.0, 300.0, 100.0, 10.0, 100.0, 320.0, 110.0, 80.0, 110.0, 20.0, 250.0, 500.0, 20.0, 30.0, 20.0, 350.0, 330.0, 20.0, 10.0, 0.0, 40.0, 210.0, 180.0, 20.0, 20.0, 490.0, 70.0, 70.0, 40.0, 210.0, 190.0, 110.0, 0.0, 0.0, 30.0, 120.0, 30.0, 0.0, 10.0, 110.0, 10.0, 10.0, 110.0, 180.0, 390.0, 30.0, 50.0, 40.0, 520.0, 50.0, -30.0, 380.0, 110.0, 0.0, 10.0, 0.0, 160.0, 55.0, 0.0, 90.0, 20.0, 0.0, 50.0, 50.0, 90.0, 20.0, 170.0, 50.0, 40.0, 820.0, 260.0, 130.0, 320.0, 100.0, 50.0, 320.0, 100.0, 160.0, 380.0, 40.0, 20.0, 160.0, 20.0, 10.0, 10.0, 30.0, 160.0, 170.0, 10.0, -20.0, 0.0, 20.0, 30.0, 160.0, 290.0, 0.0, 40.0, 30.0, 180.0, 10.0, 40.0, 30.0, 360.0, 90.0, 380.0, -40.0, 20.0, 470.0, 300.0, 240.0, 50.0, 50.0, 70.0, -40.0, 70.0, 55.0, 430.0, 390.0, 100.0, 610.0, 20.0, 150.0, 60.0, 370.0, 145.0, 40.0, 70.0, 540.0, 30.0, 50.0, 50.0, 50.0, 180.0, 80.0, 370.0, 130.0, 20.0, 10.0, 30.0, 150.0, 230.0, 190.0, 80.0, 40.0, 30.0, 0.0, 80.0, 60.0, 10.0, 600.0, 30.0, 150.0, 20.0, 40.0, 730.0, 100.0, 60.0, 40.0, 60.0, 10.0, 130.0, 160.0, 240.0, 230.0, 10.0, 20.0, 210.0, 70.0, 30.0, 370.0, 40.0, 50.0, 50.0, 250.0, 30.0, 0.0, 90.0, 10.0, 20.0, 50.0, 50.0, 40.0, 250.0, 280.0, 20.0, 430.0, 20.0, 40.0, 440.0, 50.0, 80.0, 40.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9444084563909838, "mean_inference_ms": 2.0090745055114234, "mean_action_processing_ms": 0.5276048129627854, "mean_env_wait_ms": 1.6968880946009972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013404369354248047, "StateBufferConnector_ms": 0.010609626770019531, "ViewRequirementAgentConnector_ms": 0.42815136909484863}, "num_episodes": 18, "episode_return_max": 2090.0, "episode_return_min": 100.0, "episode_return_mean": 1131.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.390156983345744, "num_env_steps_trained_throughput_per_sec": 19.390156983345744, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 4760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4760000, "timers": {"training_iteration_time_ms": 204488.878, "restore_workers_time_ms": 0.013, "training_step_time_ms": 204488.82, "sample_time_ms": 2782.976, "learn_time_ms": 201687.341, "learn_throughput": 19.833, "synch_weights_time_ms": 11.625}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "done": false, "training_iteration": 119, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-12-19", "timestamp": 1717265539, "time_this_iter_s": 206.32827806472778, "time_total_s": 56354.32974934578, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c199d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56354.32974934578, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 25.60136518771331, "ram_util_percent": 82.33549488054608}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.143290058530558, "cur_kl_coeff": 29.59121284458087, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.001299455808748365, "vf_loss": 6.968778817112835, "vf_explained_var": 0.0011903120369449083, "kl": Infinity, "entropy": 0.21858968854870914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1122105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "env_runners": {"episode_reward_max": 2090.0, "episode_reward_min": 130.0, "episode_reward_mean": 1200.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 120.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1750.0, 840.0, 810.0, 300.0, 1850.0, 875.0, 1190.0, 1120.0, 1200.0, 1280.0, 1380.0, 1830.0, 1270.0, 1745.0, 1195.0, 1100.0, 1320.0, 2090.0, 900.0, 1170.0, 1390.0, 1265.0, 920.0, 1930.0, 630.0, 1255.0, 1520.0, 1005.0, 755.0, 130.0, 1500.0, 230.0, 1490.0, 680.0, 1370.0, 1460.0, 980.0, 1210.0, 1280.0, 1220.0, 1130.0, 1200.0, 1310.0, 1680.0, 1560.0, 870.0, 1235.0, 600.0, 960.0, 1655.0, 1010.0, 930.0, 1680.0, 1430.0, 730.0, 1040.0, 1450.0, 1025.0, 1520.0, 1190.0, 1220.0, 430.0, 1720.0, 385.0, 1950.0, 1350.0, 420.0, 1140.0, 1630.0, 1845.0, 1525.0, 1290.0, 1020.0, 1570.0, 1080.0, 790.0, 1580.0, 1930.0, 1240.0, 770.0, 940.0, 1580.0, 990.0, 1270.0, 1620.0, 1380.0, 1705.0, 1040.0, 835.0, 460.0, 1040.0, 1590.0, 890.0, 700.0, 1060.0, 620.0, 1650.0, 1140.0, 1925.0, 1090.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 210.0, 30.0, 610.0, 240.0, 260.0, 40.0, 20.0, 210.0, 40.0, 190.0, -30.0, 100.0, 0.0, 10.0, 40.0, 10.0, 260.0, 220.0, 40.0, 30.0, 20.0, 200.0, 150.0, 10.0, 40.0, 20.0, 30.0, 10.0, 300.0, 80.0, 20.0, 30.0, 60.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 450.0, 60.0, 430.0, 550.0, 90.0, 180.0, 30.0, 230.0, 40.0, 0.0, 130.0, 50.0, 40.0, 75.0, 60.0, 20.0, 230.0, 350.0, 40.0, 90.0, 90.0, 60.0, 440.0, 0.0, 70.0, 40.0, 10.0, 70.0, 160.0, 70.0, 30.0, 30.0, 150.0, 80.0, 130.0, 310.0, 90.0, 210.0, 20.0, 40.0, 40.0, 180.0, 30.0, 220.0, 310.0, 80.0, 70.0, 50.0, 20.0, 310.0, 120.0, 30.0, 20.0, 30.0, 430.0, 180.0, 90.0, 0.0, 430.0, -40.0, 150.0, -40.0, 220.0, 280.0, 40.0, 50.0, 290.0, 20.0, 50.0, 70.0, 60.0, 110.0, 10.0, 770.0, 320.0, 120.0, 300.0, 40.0, 350.0, 120.0, -20.0, 90.0, 110.0, 470.0, 10.0, 0.0, 100.0, 110.0, 150.0, 60.0, 10.0, 590.0, 10.0, 150.0, 75.0, 270.0, 320.0, 250.0, 220.0, 10.0, 120.0, -170.0, 220.0, 65.0, 120.0, 90.0, 270.0, 20.0, 90.0, 80.0, 150.0, 170.0, 30.0, 40.0, 20.0, 130.0, 370.0, 60.0, 90.0, 200.0, 60.0, 80.0, 30.0, 50.0, 30.0, 340.0, 380.0, 250.0, 210.0, 70.0, 240.0, 70.0, 70.0, -40.0, 680.0, 50.0, 490.0, 10.0, 80.0, 80.0, 10.0, 300.0, 0.0, 130.0, 30.0, 30.0, 230.0, 130.0, 10.0, 0.0, -20.0, 290.0, 430.0, 0.0, 30.0, 120.0, 180.0, -10.0, 0.0, 10.0, 300.0, 140.0, 90.0, 70.0, 710.0, 50.0, 30.0, 10.0, 30.0, 30.0, 140.0, 45.0, 0.0, 370.0, 190.0, 20.0, 430.0, 90.0, 30.0, -30.0, 40.0, 290.0, 290.0, 60.0, 10.0, 30.0, 110.0, 600.0, -40.0, 80.0, 130.0, 320.0, 80.0, 620.0, -50.0, 170.0, 20.0, 10.0, 70.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, 360.0, 30.0, 100.0, 50.0, 150.0, 0.0, 60.0, 450.0, 160.0, 35.0, -30.0, 280.0, 60.0, 60.0, 520.0, 280.0, 80.0, 30.0, 20.0, 10.0, 320.0, 140.0, 20.0, 5.0, 60.0, 300.0, 390.0, 30.0, 60.0, 0.0, 70.0, 70.0, 10.0, 460.0, 10.0, -40.0, 40.0, 80.0, 20.0, 50.0, -25.0, 150.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 50.0, 270.0, 100.0, 300.0, 240.0, 0.0, 210.0, 40.0, 190.0, 100.0, 40.0, 20.0, 0.0, 30.0, 20.0, 60.0, 30.0, 10.0, 0.0, 20.0, 70.0, -5.0, 20.0, 70.0, 60.0, 50.0, 920.0, 80.0, 155.0, 70.0, 10.0, 90.0, 270.0, -10.0, 50.0, 10.0, 10.0, 220.0, 20.0, 10.0, 20.0, 440.0, 170.0, 300.0, 240.0, 60.0, -30.0, 60.0, 80.0, 30.0, 70.0, 0.0, 110.0, 20.0, 150.0, 0.0, 410.0, 410.0, 100.0, 190.0, 60.0, 20.0, 10.0, 380.0, 20.0, 70.0, 20.0, 250.0, 60.0, 90.0, 290.0, 70.0, 10.0, 0.0, 250.0, 240.0, -40.0, 10.0, 60.0, 320.0, 460.0, 60.0, 10.0, 0.0, 90.0, 50.0, 440.0, 80.0, 50.0, 40.0, 90.0, 60.0, 110.0, 520.0, 100.0, 70.0, 20.0, 40.0, 50.0, 160.0, 30.0, 10.0, 130.0, 60.0, 90.0, 130.0, 40.0, 60.0, 330.0, 250.0, 40.0, 1000.0, 40.0, -105.0, -140.0, 430.0, 60.0, 50.0, -130.0, -45.0, 170.0, 40.0, 20.0, 50.0, 540.0, 10.0, 30.0, 0.0, 70.0, 380.0, 60.0, 260.0, 80.0, 90.0, 180.0, 60.0, 570.0, 90.0, 180.0, 110.0, 20.0, 60.0, 210.0, 340.0, 290.0, 110.0, 240.0, 180.0, 140.0, -30.0, 0.0, 150.0, 70.0, 50.0, 10.0, 60.0, 20.0, 60.0, 330.0, 120.0, 130.0, 380.0, 440.0, 80.0, 70.0, 30.0, 50.0, 10.0, -85.0, 130.0, 370.0, 70.0, 130.0, 70.0, 60.0, 110.0, -390.0, -30.0, 60.0, 150.0, 250.0, 10.0, 50.0, 260.0, 100.0, 170.0, 20.0, 0.0, 40.0, 60.0, 10.0, 430.0, 30.0, 85.0, 390.0, 0.0, 220.0, 120.0, 360.0, 10.0, 320.0, 10.0, -20.0, 250.0, 10.0, 280.0, 0.0, 20.0, 40.0, 100.0, 0.0, 180.0, 80.0, 20.0, 30.0, 330.0, 50.0, 240.0, 0.0, 0.0, 60.0, 100.0, 100.0, 30.0, 80.0, 50.0, 120.0, 570.0, 60.0, 510.0, 190.0, 70.0, 240.0, 40.0, 60.0, 130.0, 60.0, 340.0, 200.0, 100.0, 20.0, 30.0, 10.0, 40.0, 10.0, 30.0, 260.0, 30.0, 110.0, 190.0, 210.0, 70.0, 160.0, 50.0, 200.0, 20.0, 90.0, 40.0, 80.0, 120.0, 40.0, 50.0, 100.0, 70.0, 300.0, 250.0, 80.0, 40.0, 410.0, 110.0, -10.0, 30.0, 0.0, -135.0, 10.0, 520.0, 160.0, 50.0, 300.0, 100.0, 10.0, 100.0, 320.0, 110.0, 80.0, 110.0, 20.0, 250.0, 500.0, 20.0, 30.0, 20.0, 350.0, 330.0, 20.0, 10.0, 0.0, 40.0, 210.0, 180.0, 20.0, 20.0, 490.0, 70.0, 70.0, 40.0, 210.0, 190.0, 110.0, 0.0, 0.0, 30.0, 120.0, 30.0, 0.0, 10.0, 110.0, 10.0, 10.0, 110.0, 180.0, 390.0, 30.0, 50.0, 40.0, 520.0, 50.0, -30.0, 380.0, 110.0, 0.0, 10.0, 0.0, 160.0, 55.0, 0.0, 90.0, 20.0, 0.0, 50.0, 50.0, 90.0, 20.0, 170.0, 50.0, 40.0, 820.0, 260.0, 130.0, 320.0, 100.0, 50.0, 320.0, 100.0, 160.0, 380.0, 40.0, 20.0, 160.0, 20.0, 10.0, 10.0, 30.0, 160.0, 170.0, 10.0, -20.0, 0.0, 20.0, 30.0, 160.0, 290.0, 0.0, 40.0, 30.0, 180.0, 10.0, 40.0, 30.0, 360.0, 90.0, 380.0, -40.0, 20.0, 470.0, 300.0, 240.0, 50.0, 50.0, 70.0, -40.0, 70.0, 55.0, 430.0, 390.0, 100.0, 610.0, 20.0, 150.0, 60.0, 370.0, 145.0, 40.0, 70.0, 540.0, 30.0, 50.0, 50.0, 50.0, 180.0, 80.0, 370.0, 130.0, 20.0, 10.0, 30.0, 150.0, 230.0, 190.0, 80.0, 40.0, 30.0, 0.0, 80.0, 60.0, 10.0, 600.0, 30.0, 150.0, 20.0, 40.0, 730.0, 100.0, 60.0, 40.0, 60.0, 10.0, 130.0, 160.0, 240.0, 230.0, 10.0, 20.0, 210.0, 70.0, 30.0, 370.0, 40.0, 50.0, 50.0, 250.0, 30.0, 0.0, 90.0, 10.0, 20.0, 50.0, 50.0, 40.0, 250.0, 280.0, 20.0, 430.0, 20.0, 40.0, 440.0, 50.0, 80.0, 40.0, 180.0, 370.0, 0.0, 60.0, 550.0, 40.0, 40.0, 640.0, 150.0, 10.0, 70.0, 40.0, -110.0, 360.0, 20.0, 30.0, -20.0, 360.0, 520.0, 10.0, 30.0, 40.0, 30.0, 290.0, 60.0, 100.0, 10.0, 20.0, 10.0, -50.0, 260.0, 20.0, 40.0, 50.0, 0.0, 20.0, 40.0, 70.0, 40.0, 660.0, 0.0, 240.0, 500.0, 60.0, 270.0, 130.0, 0.0, 220.0, 20.0, 20.0, 120.0, 170.0, 10.0, 250.0, 110.0, 180.0, 50.0, 100.0, 40.0, 50.0, 30.0, 200.0, 230.0, 160.0, 50.0, 200.0, 20.0, 40.0, 0.0, 20.0, 350.0, 490.0, 120.0, 170.0, 150.0, 190.0, 280.0, 30.0, 30.0, 80.0, 80.0, 90.0, 200.0, 380.0, 0.0, 350.0, 20.0, 10.0, 10.0, 280.0, 40.0, 20.0, -190.0, 90.0, 250.0, 250.0, 300.0, 60.0, 710.0, 210.0, 5.0, 250.0, 30.0, 310.0, 130.0, 30.0, 70.0, 100.0, 10.0, 50.0, 60.0, 50.0, 55.0, 55.0, -5.0, 90.0, 30.0, 220.0, 210.0, 70.0, 60.0, 20.0, 150.0, 0.0, 50.0, 60.0, 80.0, 60.0, 30.0, 0.0, 10.0, 30.0, 90.0, 10.0, 410.0, 20.0, 40.0, 30.0, 310.0, 0.0, 100.0, 290.0, 40.0, 60.0, 110.0, -40.0, 80.0, 380.0, 570.0, 50.0, 50.0, 190.0, 110.0, 40.0, 40.0, 30.0, 290.0, 40.0, 0.0, 90.0, 60.0, 330.0, 10.0, 0.0, 10.0, 40.0, 40.0, 50.0, 10.0, 200.0, 10.0, 370.0, -140.0, 20.0, 180.0, 170.0, 110.0, 130.0, 180.0, 10.0, 30.0, 0.0, 40.0, 10.0, 130.0, 0.0, 70.0, 260.0, 30.0, 40.0, 40.0, 80.0, 80.0, 270.0, 80.0, 320.0, 380.0, 160.0, 50.0, 170.0, 60.0, 30.0, 160.0, 90.0, 50.0, 130.0, 380.0, 70.0, 10.0, 20.0, 200.0, 750.0, 140.0, 265.0, 30.0, 260.0, 190.0, 240.0, 10.0, 80.0, -40.0, 90.0, 330.0, 360.0, 20.0, 30.0, 40.0, 30.0, 110.0, 70.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9404629620474148, "mean_inference_ms": 2.006747298827886, "mean_action_processing_ms": 0.5269249793433266, "mean_env_wait_ms": 1.6944902781967153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0139312744140625, "StateBufferConnector_ms": 0.01140451431274414, "ViewRequirementAgentConnector_ms": 0.4426238536834717}, "num_episodes": 23, "episode_return_max": 2090.0, "episode_return_min": 130.0, "episode_return_mean": 1200.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.52456980054861, "num_env_steps_trained_throughput_per_sec": 19.52456980054861, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 4800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4800000, "timers": {"training_iteration_time_ms": 203849.145, "restore_workers_time_ms": 0.013, "training_step_time_ms": 203849.087, "sample_time_ms": 2717.484, "learn_time_ms": 201112.647, "learn_throughput": 19.889, "synch_weights_time_ms": 11.783}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "done": false, "training_iteration": 120, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-15-44", "timestamp": 1717265744, "time_this_iter_s": 204.87778306007385, "time_total_s": 56559.20753240585, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a4b040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56559.20753240585, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 25.535616438356165, "ram_util_percent": 82.30034246575342}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.596116114068971, "cur_kl_coeff": 44.38681926687131, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.112135572606128, "policy_loss": -0.0012546672322613776, "vf_loss": 7.110635205909721, "vf_explained_var": 0.0004431342608885516, "kl": 6.206865454929136e-05, "entropy": 0.21747355898395895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1131495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "env_runners": {"episode_reward_max": 1950.0, "episode_reward_min": 130.0, "episode_reward_mean": 1184.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 118.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [900.0, 1170.0, 1390.0, 1265.0, 920.0, 1930.0, 630.0, 1255.0, 1520.0, 1005.0, 755.0, 130.0, 1500.0, 230.0, 1490.0, 680.0, 1370.0, 1460.0, 980.0, 1210.0, 1280.0, 1220.0, 1130.0, 1200.0, 1310.0, 1680.0, 1560.0, 870.0, 1235.0, 600.0, 960.0, 1655.0, 1010.0, 930.0, 1680.0, 1430.0, 730.0, 1040.0, 1450.0, 1025.0, 1520.0, 1190.0, 1220.0, 430.0, 1720.0, 385.0, 1950.0, 1350.0, 420.0, 1140.0, 1630.0, 1845.0, 1525.0, 1290.0, 1020.0, 1570.0, 1080.0, 790.0, 1580.0, 1930.0, 1240.0, 770.0, 940.0, 1580.0, 990.0, 1270.0, 1620.0, 1380.0, 1705.0, 1040.0, 835.0, 460.0, 1040.0, 1590.0, 890.0, 700.0, 1060.0, 620.0, 1650.0, 1140.0, 1925.0, 1090.0, 1270.0, 600.0, 1360.0, 1770.0, 1290.0, 1320.0, 420.0, 1130.0, 1465.0, 1615.0, 400.0, 1855.0, 780.0, 1585.0, 1580.0, 1000.0, 940.0, 1115.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 80.0, 80.0, 10.0, 300.0, 0.0, 130.0, 30.0, 30.0, 230.0, 130.0, 10.0, 0.0, -20.0, 290.0, 430.0, 0.0, 30.0, 120.0, 180.0, -10.0, 0.0, 10.0, 300.0, 140.0, 90.0, 70.0, 710.0, 50.0, 30.0, 10.0, 30.0, 30.0, 140.0, 45.0, 0.0, 370.0, 190.0, 20.0, 430.0, 90.0, 30.0, -30.0, 40.0, 290.0, 290.0, 60.0, 10.0, 30.0, 110.0, 600.0, -40.0, 80.0, 130.0, 320.0, 80.0, 620.0, -50.0, 170.0, 20.0, 10.0, 70.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, 360.0, 30.0, 100.0, 50.0, 150.0, 0.0, 60.0, 450.0, 160.0, 35.0, -30.0, 280.0, 60.0, 60.0, 520.0, 280.0, 80.0, 30.0, 20.0, 10.0, 320.0, 140.0, 20.0, 5.0, 60.0, 300.0, 390.0, 30.0, 60.0, 0.0, 70.0, 70.0, 10.0, 460.0, 10.0, -40.0, 40.0, 80.0, 20.0, 50.0, -25.0, 150.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 50.0, 270.0, 100.0, 300.0, 240.0, 0.0, 210.0, 40.0, 190.0, 100.0, 40.0, 20.0, 0.0, 30.0, 20.0, 60.0, 30.0, 10.0, 0.0, 20.0, 70.0, -5.0, 20.0, 70.0, 60.0, 50.0, 920.0, 80.0, 155.0, 70.0, 10.0, 90.0, 270.0, -10.0, 50.0, 10.0, 10.0, 220.0, 20.0, 10.0, 20.0, 440.0, 170.0, 300.0, 240.0, 60.0, -30.0, 60.0, 80.0, 30.0, 70.0, 0.0, 110.0, 20.0, 150.0, 0.0, 410.0, 410.0, 100.0, 190.0, 60.0, 20.0, 10.0, 380.0, 20.0, 70.0, 20.0, 250.0, 60.0, 90.0, 290.0, 70.0, 10.0, 0.0, 250.0, 240.0, -40.0, 10.0, 60.0, 320.0, 460.0, 60.0, 10.0, 0.0, 90.0, 50.0, 440.0, 80.0, 50.0, 40.0, 90.0, 60.0, 110.0, 520.0, 100.0, 70.0, 20.0, 40.0, 50.0, 160.0, 30.0, 10.0, 130.0, 60.0, 90.0, 130.0, 40.0, 60.0, 330.0, 250.0, 40.0, 1000.0, 40.0, -105.0, -140.0, 430.0, 60.0, 50.0, -130.0, -45.0, 170.0, 40.0, 20.0, 50.0, 540.0, 10.0, 30.0, 0.0, 70.0, 380.0, 60.0, 260.0, 80.0, 90.0, 180.0, 60.0, 570.0, 90.0, 180.0, 110.0, 20.0, 60.0, 210.0, 340.0, 290.0, 110.0, 240.0, 180.0, 140.0, -30.0, 0.0, 150.0, 70.0, 50.0, 10.0, 60.0, 20.0, 60.0, 330.0, 120.0, 130.0, 380.0, 440.0, 80.0, 70.0, 30.0, 50.0, 10.0, -85.0, 130.0, 370.0, 70.0, 130.0, 70.0, 60.0, 110.0, -390.0, -30.0, 60.0, 150.0, 250.0, 10.0, 50.0, 260.0, 100.0, 170.0, 20.0, 0.0, 40.0, 60.0, 10.0, 430.0, 30.0, 85.0, 390.0, 0.0, 220.0, 120.0, 360.0, 10.0, 320.0, 10.0, -20.0, 250.0, 10.0, 280.0, 0.0, 20.0, 40.0, 100.0, 0.0, 180.0, 80.0, 20.0, 30.0, 330.0, 50.0, 240.0, 0.0, 0.0, 60.0, 100.0, 100.0, 30.0, 80.0, 50.0, 120.0, 570.0, 60.0, 510.0, 190.0, 70.0, 240.0, 40.0, 60.0, 130.0, 60.0, 340.0, 200.0, 100.0, 20.0, 30.0, 10.0, 40.0, 10.0, 30.0, 260.0, 30.0, 110.0, 190.0, 210.0, 70.0, 160.0, 50.0, 200.0, 20.0, 90.0, 40.0, 80.0, 120.0, 40.0, 50.0, 100.0, 70.0, 300.0, 250.0, 80.0, 40.0, 410.0, 110.0, -10.0, 30.0, 0.0, -135.0, 10.0, 520.0, 160.0, 50.0, 300.0, 100.0, 10.0, 100.0, 320.0, 110.0, 80.0, 110.0, 20.0, 250.0, 500.0, 20.0, 30.0, 20.0, 350.0, 330.0, 20.0, 10.0, 0.0, 40.0, 210.0, 180.0, 20.0, 20.0, 490.0, 70.0, 70.0, 40.0, 210.0, 190.0, 110.0, 0.0, 0.0, 30.0, 120.0, 30.0, 0.0, 10.0, 110.0, 10.0, 10.0, 110.0, 180.0, 390.0, 30.0, 50.0, 40.0, 520.0, 50.0, -30.0, 380.0, 110.0, 0.0, 10.0, 0.0, 160.0, 55.0, 0.0, 90.0, 20.0, 0.0, 50.0, 50.0, 90.0, 20.0, 170.0, 50.0, 40.0, 820.0, 260.0, 130.0, 320.0, 100.0, 50.0, 320.0, 100.0, 160.0, 380.0, 40.0, 20.0, 160.0, 20.0, 10.0, 10.0, 30.0, 160.0, 170.0, 10.0, -20.0, 0.0, 20.0, 30.0, 160.0, 290.0, 0.0, 40.0, 30.0, 180.0, 10.0, 40.0, 30.0, 360.0, 90.0, 380.0, -40.0, 20.0, 470.0, 300.0, 240.0, 50.0, 50.0, 70.0, -40.0, 70.0, 55.0, 430.0, 390.0, 100.0, 610.0, 20.0, 150.0, 60.0, 370.0, 145.0, 40.0, 70.0, 540.0, 30.0, 50.0, 50.0, 50.0, 180.0, 80.0, 370.0, 130.0, 20.0, 10.0, 30.0, 150.0, 230.0, 190.0, 80.0, 40.0, 30.0, 0.0, 80.0, 60.0, 10.0, 600.0, 30.0, 150.0, 20.0, 40.0, 730.0, 100.0, 60.0, 40.0, 60.0, 10.0, 130.0, 160.0, 240.0, 230.0, 10.0, 20.0, 210.0, 70.0, 30.0, 370.0, 40.0, 50.0, 50.0, 250.0, 30.0, 0.0, 90.0, 10.0, 20.0, 50.0, 50.0, 40.0, 250.0, 280.0, 20.0, 430.0, 20.0, 40.0, 440.0, 50.0, 80.0, 40.0, 180.0, 370.0, 0.0, 60.0, 550.0, 40.0, 40.0, 640.0, 150.0, 10.0, 70.0, 40.0, -110.0, 360.0, 20.0, 30.0, -20.0, 360.0, 520.0, 10.0, 30.0, 40.0, 30.0, 290.0, 60.0, 100.0, 10.0, 20.0, 10.0, -50.0, 260.0, 20.0, 40.0, 50.0, 0.0, 20.0, 40.0, 70.0, 40.0, 660.0, 0.0, 240.0, 500.0, 60.0, 270.0, 130.0, 0.0, 220.0, 20.0, 20.0, 120.0, 170.0, 10.0, 250.0, 110.0, 180.0, 50.0, 100.0, 40.0, 50.0, 30.0, 200.0, 230.0, 160.0, 50.0, 200.0, 20.0, 40.0, 0.0, 20.0, 350.0, 490.0, 120.0, 170.0, 150.0, 190.0, 280.0, 30.0, 30.0, 80.0, 80.0, 90.0, 200.0, 380.0, 0.0, 350.0, 20.0, 10.0, 10.0, 280.0, 40.0, 20.0, -190.0, 90.0, 250.0, 250.0, 300.0, 60.0, 710.0, 210.0, 5.0, 250.0, 30.0, 310.0, 130.0, 30.0, 70.0, 100.0, 10.0, 50.0, 60.0, 50.0, 55.0, 55.0, -5.0, 90.0, 30.0, 220.0, 210.0, 70.0, 60.0, 20.0, 150.0, 0.0, 50.0, 60.0, 80.0, 60.0, 30.0, 0.0, 10.0, 30.0, 90.0, 10.0, 410.0, 20.0, 40.0, 30.0, 310.0, 0.0, 100.0, 290.0, 40.0, 60.0, 110.0, -40.0, 80.0, 380.0, 570.0, 50.0, 50.0, 190.0, 110.0, 40.0, 40.0, 30.0, 290.0, 40.0, 0.0, 90.0, 60.0, 330.0, 10.0, 0.0, 10.0, 40.0, 40.0, 50.0, 10.0, 200.0, 10.0, 370.0, -140.0, 20.0, 180.0, 170.0, 110.0, 130.0, 180.0, 10.0, 30.0, 0.0, 40.0, 10.0, 130.0, 0.0, 70.0, 260.0, 30.0, 40.0, 40.0, 80.0, 80.0, 270.0, 80.0, 320.0, 380.0, 160.0, 50.0, 170.0, 60.0, 30.0, 160.0, 90.0, 50.0, 130.0, 380.0, 70.0, 10.0, 20.0, 200.0, 750.0, 140.0, 265.0, 30.0, 260.0, 190.0, 240.0, 10.0, 80.0, -40.0, 90.0, 330.0, 360.0, 20.0, 30.0, 40.0, 30.0, 110.0, 70.0, 10.0, 90.0, 20.0, 40.0, 120.0, 230.0, 100.0, 20.0, 570.0, 50.0, 30.0, 250.0, 0.0, 20.0, 10.0, 30.0, 20.0, 30.0, 30.0, 180.0, 30.0, 130.0, 730.0, 30.0, 30.0, 30.0, 30.0, 330.0, 60.0, -50.0, 40.0, 50.0, 40.0, 80.0, 140.0, 300.0, 10.0, 420.0, 600.0, 90.0, 40.0, 210.0, 160.0, 190.0, 10.0, 380.0, 100.0, 70.0, 110.0, 30.0, 30.0, 110.0, 110.0, 0.0, 80.0, 90.0, 140.0, 0.0, 160.0, 110.0, 520.0, 40.0, 0.0, 80.0, 30.0, 210.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 180.0, 190.0, 60.0, -60.0, 70.0, 170.0, 200.0, 190.0, 100.0, 315.0, 60.0, 330.0, 70.0, 70.0, 90.0, -20.0, 50.0, 380.0, 120.0, 440.0, 90.0, 200.0, 100.0, -30.0, 500.0, 330.0, 50.0, -10.0, -55.0, 30.0, 0.0, 10.0, 100.0, 0.0, 20.0, 20.0, 160.0, 40.0, 20.0, -35.0, 70.0, 480.0, 50.0, 360.0, 210.0, 70.0, 190.0, 280.0, 180.0, -10.0, 80.0, 60.0, 0.0, 80.0, 360.0, 10.0, 160.0, 20.0, 20.0, 130.0, 80.0, 300.0, -15.0, 420.0, 20.0, 80.0, 80.0, 460.0, 30.0, 120.0, 300.0, 100.0, 30.0, 210.0, 240.0, 150.0, 120.0, 180.0, 130.0, 0.0, 300.0, 10.0, 0.0, 0.0, 390.0, 160.0, 70.0, 40.0, 30.0, 100.0, 100.0, 20.0, 30.0, 100.0, 0.0, 10.0, 280.0, 20.0, 280.0, 40.0, 105.0, 40.0, 180.0, 60.0, 480.0, 40.0, 40.0, 100.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.937258014658103, "mean_inference_ms": 2.0047907722191427, "mean_action_processing_ms": 0.526310851607176, "mean_env_wait_ms": 1.6924337433072327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013490915298461914, "StateBufferConnector_ms": 0.011127471923828125, "ViewRequirementAgentConnector_ms": 0.42856788635253906}, "num_episodes": 18, "episode_return_max": 1950.0, "episode_return_min": 130.0, "episode_return_mean": 1184.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.010227925107092, "num_env_steps_trained_throughput_per_sec": 20.010227925107092, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 4840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4840000, "timers": {"training_iteration_time_ms": 203280.251, "restore_workers_time_ms": 0.013, "training_step_time_ms": 203280.193, "sample_time_ms": 2685.186, "learn_time_ms": 200574.57, "learn_throughput": 19.943, "synch_weights_time_ms": 11.644}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "done": false, "training_iteration": 121, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-19-04", "timestamp": 1717265944, "time_this_iter_s": 199.93144416809082, "time_total_s": 56759.138976573944, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f887ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56759.138976573944, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 19.61725352112676, "ram_util_percent": 81.57218309859157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.746257399820799, "cur_kl_coeff": 22.193409633435657, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0014477435495710363, "vf_loss": 6.9624677679409235, "vf_explained_var": -0.0005610116056233042, "kl": Infinity, "entropy": 0.20386086367189693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1140885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "env_runners": {"episode_reward_max": 1950.0, "episode_reward_min": 385.0, "episode_reward_mean": 1185.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 118.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1130.0, 1200.0, 1310.0, 1680.0, 1560.0, 870.0, 1235.0, 600.0, 960.0, 1655.0, 1010.0, 930.0, 1680.0, 1430.0, 730.0, 1040.0, 1450.0, 1025.0, 1520.0, 1190.0, 1220.0, 430.0, 1720.0, 385.0, 1950.0, 1350.0, 420.0, 1140.0, 1630.0, 1845.0, 1525.0, 1290.0, 1020.0, 1570.0, 1080.0, 790.0, 1580.0, 1930.0, 1240.0, 770.0, 940.0, 1580.0, 990.0, 1270.0, 1620.0, 1380.0, 1705.0, 1040.0, 835.0, 460.0, 1040.0, 1590.0, 890.0, 700.0, 1060.0, 620.0, 1650.0, 1140.0, 1925.0, 1090.0, 1270.0, 600.0, 1360.0, 1770.0, 1290.0, 1320.0, 420.0, 1130.0, 1465.0, 1615.0, 400.0, 1855.0, 780.0, 1585.0, 1580.0, 1000.0, 940.0, 1115.0, 1240.0, 1630.0, 1190.0, 610.0, 765.0, 1280.0, 1460.0, 1400.0, 1000.0, 1160.0, 1290.0, 1020.0, 1570.0, 810.0, 1710.0, 850.0, 410.0, 510.0, 970.0, 1710.0, 1290.0, 610.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 10.0, 130.0, 60.0, 90.0, 130.0, 40.0, 60.0, 330.0, 250.0, 40.0, 1000.0, 40.0, -105.0, -140.0, 430.0, 60.0, 50.0, -130.0, -45.0, 170.0, 40.0, 20.0, 50.0, 540.0, 10.0, 30.0, 0.0, 70.0, 380.0, 60.0, 260.0, 80.0, 90.0, 180.0, 60.0, 570.0, 90.0, 180.0, 110.0, 20.0, 60.0, 210.0, 340.0, 290.0, 110.0, 240.0, 180.0, 140.0, -30.0, 0.0, 150.0, 70.0, 50.0, 10.0, 60.0, 20.0, 60.0, 330.0, 120.0, 130.0, 380.0, 440.0, 80.0, 70.0, 30.0, 50.0, 10.0, -85.0, 130.0, 370.0, 70.0, 130.0, 70.0, 60.0, 110.0, -390.0, -30.0, 60.0, 150.0, 250.0, 10.0, 50.0, 260.0, 100.0, 170.0, 20.0, 0.0, 40.0, 60.0, 10.0, 430.0, 30.0, 85.0, 390.0, 0.0, 220.0, 120.0, 360.0, 10.0, 320.0, 10.0, -20.0, 250.0, 10.0, 280.0, 0.0, 20.0, 40.0, 100.0, 0.0, 180.0, 80.0, 20.0, 30.0, 330.0, 50.0, 240.0, 0.0, 0.0, 60.0, 100.0, 100.0, 30.0, 80.0, 50.0, 120.0, 570.0, 60.0, 510.0, 190.0, 70.0, 240.0, 40.0, 60.0, 130.0, 60.0, 340.0, 200.0, 100.0, 20.0, 30.0, 10.0, 40.0, 10.0, 30.0, 260.0, 30.0, 110.0, 190.0, 210.0, 70.0, 160.0, 50.0, 200.0, 20.0, 90.0, 40.0, 80.0, 120.0, 40.0, 50.0, 100.0, 70.0, 300.0, 250.0, 80.0, 40.0, 410.0, 110.0, -10.0, 30.0, 0.0, -135.0, 10.0, 520.0, 160.0, 50.0, 300.0, 100.0, 10.0, 100.0, 320.0, 110.0, 80.0, 110.0, 20.0, 250.0, 500.0, 20.0, 30.0, 20.0, 350.0, 330.0, 20.0, 10.0, 0.0, 40.0, 210.0, 180.0, 20.0, 20.0, 490.0, 70.0, 70.0, 40.0, 210.0, 190.0, 110.0, 0.0, 0.0, 30.0, 120.0, 30.0, 0.0, 10.0, 110.0, 10.0, 10.0, 110.0, 180.0, 390.0, 30.0, 50.0, 40.0, 520.0, 50.0, -30.0, 380.0, 110.0, 0.0, 10.0, 0.0, 160.0, 55.0, 0.0, 90.0, 20.0, 0.0, 50.0, 50.0, 90.0, 20.0, 170.0, 50.0, 40.0, 820.0, 260.0, 130.0, 320.0, 100.0, 50.0, 320.0, 100.0, 160.0, 380.0, 40.0, 20.0, 160.0, 20.0, 10.0, 10.0, 30.0, 160.0, 170.0, 10.0, -20.0, 0.0, 20.0, 30.0, 160.0, 290.0, 0.0, 40.0, 30.0, 180.0, 10.0, 40.0, 30.0, 360.0, 90.0, 380.0, -40.0, 20.0, 470.0, 300.0, 240.0, 50.0, 50.0, 70.0, -40.0, 70.0, 55.0, 430.0, 390.0, 100.0, 610.0, 20.0, 150.0, 60.0, 370.0, 145.0, 40.0, 70.0, 540.0, 30.0, 50.0, 50.0, 50.0, 180.0, 80.0, 370.0, 130.0, 20.0, 10.0, 30.0, 150.0, 230.0, 190.0, 80.0, 40.0, 30.0, 0.0, 80.0, 60.0, 10.0, 600.0, 30.0, 150.0, 20.0, 40.0, 730.0, 100.0, 60.0, 40.0, 60.0, 10.0, 130.0, 160.0, 240.0, 230.0, 10.0, 20.0, 210.0, 70.0, 30.0, 370.0, 40.0, 50.0, 50.0, 250.0, 30.0, 0.0, 90.0, 10.0, 20.0, 50.0, 50.0, 40.0, 250.0, 280.0, 20.0, 430.0, 20.0, 40.0, 440.0, 50.0, 80.0, 40.0, 180.0, 370.0, 0.0, 60.0, 550.0, 40.0, 40.0, 640.0, 150.0, 10.0, 70.0, 40.0, -110.0, 360.0, 20.0, 30.0, -20.0, 360.0, 520.0, 10.0, 30.0, 40.0, 30.0, 290.0, 60.0, 100.0, 10.0, 20.0, 10.0, -50.0, 260.0, 20.0, 40.0, 50.0, 0.0, 20.0, 40.0, 70.0, 40.0, 660.0, 0.0, 240.0, 500.0, 60.0, 270.0, 130.0, 0.0, 220.0, 20.0, 20.0, 120.0, 170.0, 10.0, 250.0, 110.0, 180.0, 50.0, 100.0, 40.0, 50.0, 30.0, 200.0, 230.0, 160.0, 50.0, 200.0, 20.0, 40.0, 0.0, 20.0, 350.0, 490.0, 120.0, 170.0, 150.0, 190.0, 280.0, 30.0, 30.0, 80.0, 80.0, 90.0, 200.0, 380.0, 0.0, 350.0, 20.0, 10.0, 10.0, 280.0, 40.0, 20.0, -190.0, 90.0, 250.0, 250.0, 300.0, 60.0, 710.0, 210.0, 5.0, 250.0, 30.0, 310.0, 130.0, 30.0, 70.0, 100.0, 10.0, 50.0, 60.0, 50.0, 55.0, 55.0, -5.0, 90.0, 30.0, 220.0, 210.0, 70.0, 60.0, 20.0, 150.0, 0.0, 50.0, 60.0, 80.0, 60.0, 30.0, 0.0, 10.0, 30.0, 90.0, 10.0, 410.0, 20.0, 40.0, 30.0, 310.0, 0.0, 100.0, 290.0, 40.0, 60.0, 110.0, -40.0, 80.0, 380.0, 570.0, 50.0, 50.0, 190.0, 110.0, 40.0, 40.0, 30.0, 290.0, 40.0, 0.0, 90.0, 60.0, 330.0, 10.0, 0.0, 10.0, 40.0, 40.0, 50.0, 10.0, 200.0, 10.0, 370.0, -140.0, 20.0, 180.0, 170.0, 110.0, 130.0, 180.0, 10.0, 30.0, 0.0, 40.0, 10.0, 130.0, 0.0, 70.0, 260.0, 30.0, 40.0, 40.0, 80.0, 80.0, 270.0, 80.0, 320.0, 380.0, 160.0, 50.0, 170.0, 60.0, 30.0, 160.0, 90.0, 50.0, 130.0, 380.0, 70.0, 10.0, 20.0, 200.0, 750.0, 140.0, 265.0, 30.0, 260.0, 190.0, 240.0, 10.0, 80.0, -40.0, 90.0, 330.0, 360.0, 20.0, 30.0, 40.0, 30.0, 110.0, 70.0, 10.0, 90.0, 20.0, 40.0, 120.0, 230.0, 100.0, 20.0, 570.0, 50.0, 30.0, 250.0, 0.0, 20.0, 10.0, 30.0, 20.0, 30.0, 30.0, 180.0, 30.0, 130.0, 730.0, 30.0, 30.0, 30.0, 30.0, 330.0, 60.0, -50.0, 40.0, 50.0, 40.0, 80.0, 140.0, 300.0, 10.0, 420.0, 600.0, 90.0, 40.0, 210.0, 160.0, 190.0, 10.0, 380.0, 100.0, 70.0, 110.0, 30.0, 30.0, 110.0, 110.0, 0.0, 80.0, 90.0, 140.0, 0.0, 160.0, 110.0, 520.0, 40.0, 0.0, 80.0, 30.0, 210.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 180.0, 190.0, 60.0, -60.0, 70.0, 170.0, 200.0, 190.0, 100.0, 315.0, 60.0, 330.0, 70.0, 70.0, 90.0, -20.0, 50.0, 380.0, 120.0, 440.0, 90.0, 200.0, 100.0, -30.0, 500.0, 330.0, 50.0, -10.0, -55.0, 30.0, 0.0, 10.0, 100.0, 0.0, 20.0, 20.0, 160.0, 40.0, 20.0, -35.0, 70.0, 480.0, 50.0, 360.0, 210.0, 70.0, 190.0, 280.0, 180.0, -10.0, 80.0, 60.0, 0.0, 80.0, 360.0, 10.0, 160.0, 20.0, 20.0, 130.0, 80.0, 300.0, -15.0, 420.0, 20.0, 80.0, 80.0, 460.0, 30.0, 120.0, 300.0, 100.0, 30.0, 210.0, 240.0, 150.0, 120.0, 180.0, 130.0, 0.0, 300.0, 10.0, 0.0, 0.0, 390.0, 160.0, 70.0, 40.0, 30.0, 100.0, 100.0, 20.0, 30.0, 100.0, 0.0, 10.0, 280.0, 20.0, 280.0, 40.0, 105.0, 40.0, 180.0, 60.0, 480.0, 40.0, 40.0, 100.0, 30.0, 20.0, -30.0, 40.0, -65.0, 15.0, 0.0, 330.0, 370.0, 0.0, 560.0, 410.0, 40.0, 70.0, 120.0, 20.0, 180.0, 160.0, 190.0, 410.0, 30.0, 20.0, 320.0, 60.0, 40.0, 100.0, 490.0, 40.0, 50.0, 100.0, -30.0, 0.0, 0.0, 60.0, 310.0, 130.0, 30.0, 20.0, 20.0, 20.0, 20.0, 100.0, 40.0, 25.0, 20.0, 240.0, 0.0, 290.0, 140.0, -130.0, 40.0, 80.0, 90.0, 40.0, 220.0, 490.0, 80.0, -30.0, 20.0, 50.0, 240.0, 330.0, 60.0, 20.0, 90.0, 170.0, 220.0, 80.0, 400.0, 70.0, 20.0, 80.0, 40.0, 380.0, 100.0, 140.0, 50.0, -60.0, 370.0, 300.0, 0.0, 40.0, 30.0, 390.0, 320.0, 40.0, 20.0, 20.0, 20.0, 100.0, 20.0, 110.0, 20.0, 650.0, 0.0, 30.0, 180.0, 60.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 50.0, 110.0, 150.0, 190.0, 380.0, 340.0, 30.0, 30.0, 80.0, 70.0, 70.0, 110.0, 0.0, 460.0, 40.0, 150.0, 10.0, 370.0, 80.0, 60.0, 80.0, 20.0, 220.0, 350.0, 30.0, 300.0, 60.0, 90.0, 0.0, 60.0, 350.0, -390.0, 180.0, 100.0, 50.0, 300.0, 70.0, 110.0, 740.0, 20.0, 370.0, 170.0, 50.0, 30.0, 50.0, 80.0, 90.0, 0.0, 20.0, 30.0, 300.0, 0.0, -100.0, 370.0, 30.0, 100.0, 100.0, 20.0, 20.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 150.0, 190.0, 0.0, 20.0, 10.0, 110.0, 30.0, 50.0, 10.0, 80.0, 10.0, 60.0, 20.0, 20.0, 20.0, 40.0, 260.0, 90.0, 60.0, 380.0, 20.0, 50.0, 20.0, 270.0, 0.0, 30.0, 600.0, 300.0, 130.0, 310.0, 0.0, 30.0, 130.0, 220.0, 80.0, 50.0, 10.0, 170.0, 180.0, 30.0, 390.0, 140.0, 360.0, 30.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9330538459750413, "mean_inference_ms": 2.0022033402885393, "mean_action_processing_ms": 0.5254144505941137, "mean_env_wait_ms": 1.6895198403729232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013107538223266602, "StateBufferConnector_ms": 0.010768413543701172, "ViewRequirementAgentConnector_ms": 0.39903879165649414}, "num_episodes": 22, "episode_return_max": 1950.0, "episode_return_min": 385.0, "episode_return_mean": 1185.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.071078313754008, "num_env_steps_trained_throughput_per_sec": 20.071078313754008, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 4880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4880000, "timers": {"training_iteration_time_ms": 202456.506, "restore_workers_time_ms": 0.013, "training_step_time_ms": 202456.447, "sample_time_ms": 2694.238, "learn_time_ms": 199741.398, "learn_throughput": 20.026, "synch_weights_time_ms": 11.71}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "done": false, "training_iteration": 122, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-22-23", "timestamp": 1717266143, "time_this_iter_s": 199.30364298820496, "time_total_s": 56958.44261956215, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a580d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56958.44261956215, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 18.49964539007092, "ram_util_percent": 80.84964539007092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.602144348430938, "cur_kl_coeff": 33.290114450153496, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0013074162833469983, "vf_loss": 6.565907907130493, "vf_explained_var": 0.0005074529538647181, "kl": Infinity, "entropy": 0.22089435400340124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1150275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "env_runners": {"episode_reward_max": 1950.0, "episode_reward_min": 280.0, "episode_reward_mean": 1148.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 114.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1520.0, 1190.0, 1220.0, 430.0, 1720.0, 385.0, 1950.0, 1350.0, 420.0, 1140.0, 1630.0, 1845.0, 1525.0, 1290.0, 1020.0, 1570.0, 1080.0, 790.0, 1580.0, 1930.0, 1240.0, 770.0, 940.0, 1580.0, 990.0, 1270.0, 1620.0, 1380.0, 1705.0, 1040.0, 835.0, 460.0, 1040.0, 1590.0, 890.0, 700.0, 1060.0, 620.0, 1650.0, 1140.0, 1925.0, 1090.0, 1270.0, 600.0, 1360.0, 1770.0, 1290.0, 1320.0, 420.0, 1130.0, 1465.0, 1615.0, 400.0, 1855.0, 780.0, 1585.0, 1580.0, 1000.0, 940.0, 1115.0, 1240.0, 1630.0, 1190.0, 610.0, 765.0, 1280.0, 1460.0, 1400.0, 1000.0, 1160.0, 1290.0, 1020.0, 1570.0, 810.0, 1710.0, 850.0, 410.0, 510.0, 970.0, 1710.0, 1290.0, 610.0, 1470.0, 410.0, 280.0, 620.0, 890.0, 1260.0, 990.0, 1085.0, 390.0, 1485.0, 1730.0, 1420.0, 750.0, 1330.0, 1200.0, 840.0, 450.0, 1120.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 100.0, 320.0, 110.0, 80.0, 110.0, 20.0, 250.0, 500.0, 20.0, 30.0, 20.0, 350.0, 330.0, 20.0, 10.0, 0.0, 40.0, 210.0, 180.0, 20.0, 20.0, 490.0, 70.0, 70.0, 40.0, 210.0, 190.0, 110.0, 0.0, 0.0, 30.0, 120.0, 30.0, 0.0, 10.0, 110.0, 10.0, 10.0, 110.0, 180.0, 390.0, 30.0, 50.0, 40.0, 520.0, 50.0, -30.0, 380.0, 110.0, 0.0, 10.0, 0.0, 160.0, 55.0, 0.0, 90.0, 20.0, 0.0, 50.0, 50.0, 90.0, 20.0, 170.0, 50.0, 40.0, 820.0, 260.0, 130.0, 320.0, 100.0, 50.0, 320.0, 100.0, 160.0, 380.0, 40.0, 20.0, 160.0, 20.0, 10.0, 10.0, 30.0, 160.0, 170.0, 10.0, -20.0, 0.0, 20.0, 30.0, 160.0, 290.0, 0.0, 40.0, 30.0, 180.0, 10.0, 40.0, 30.0, 360.0, 90.0, 380.0, -40.0, 20.0, 470.0, 300.0, 240.0, 50.0, 50.0, 70.0, -40.0, 70.0, 55.0, 430.0, 390.0, 100.0, 610.0, 20.0, 150.0, 60.0, 370.0, 145.0, 40.0, 70.0, 540.0, 30.0, 50.0, 50.0, 50.0, 180.0, 80.0, 370.0, 130.0, 20.0, 10.0, 30.0, 150.0, 230.0, 190.0, 80.0, 40.0, 30.0, 0.0, 80.0, 60.0, 10.0, 600.0, 30.0, 150.0, 20.0, 40.0, 730.0, 100.0, 60.0, 40.0, 60.0, 10.0, 130.0, 160.0, 240.0, 230.0, 10.0, 20.0, 210.0, 70.0, 30.0, 370.0, 40.0, 50.0, 50.0, 250.0, 30.0, 0.0, 90.0, 10.0, 20.0, 50.0, 50.0, 40.0, 250.0, 280.0, 20.0, 430.0, 20.0, 40.0, 440.0, 50.0, 80.0, 40.0, 180.0, 370.0, 0.0, 60.0, 550.0, 40.0, 40.0, 640.0, 150.0, 10.0, 70.0, 40.0, -110.0, 360.0, 20.0, 30.0, -20.0, 360.0, 520.0, 10.0, 30.0, 40.0, 30.0, 290.0, 60.0, 100.0, 10.0, 20.0, 10.0, -50.0, 260.0, 20.0, 40.0, 50.0, 0.0, 20.0, 40.0, 70.0, 40.0, 660.0, 0.0, 240.0, 500.0, 60.0, 270.0, 130.0, 0.0, 220.0, 20.0, 20.0, 120.0, 170.0, 10.0, 250.0, 110.0, 180.0, 50.0, 100.0, 40.0, 50.0, 30.0, 200.0, 230.0, 160.0, 50.0, 200.0, 20.0, 40.0, 0.0, 20.0, 350.0, 490.0, 120.0, 170.0, 150.0, 190.0, 280.0, 30.0, 30.0, 80.0, 80.0, 90.0, 200.0, 380.0, 0.0, 350.0, 20.0, 10.0, 10.0, 280.0, 40.0, 20.0, -190.0, 90.0, 250.0, 250.0, 300.0, 60.0, 710.0, 210.0, 5.0, 250.0, 30.0, 310.0, 130.0, 30.0, 70.0, 100.0, 10.0, 50.0, 60.0, 50.0, 55.0, 55.0, -5.0, 90.0, 30.0, 220.0, 210.0, 70.0, 60.0, 20.0, 150.0, 0.0, 50.0, 60.0, 80.0, 60.0, 30.0, 0.0, 10.0, 30.0, 90.0, 10.0, 410.0, 20.0, 40.0, 30.0, 310.0, 0.0, 100.0, 290.0, 40.0, 60.0, 110.0, -40.0, 80.0, 380.0, 570.0, 50.0, 50.0, 190.0, 110.0, 40.0, 40.0, 30.0, 290.0, 40.0, 0.0, 90.0, 60.0, 330.0, 10.0, 0.0, 10.0, 40.0, 40.0, 50.0, 10.0, 200.0, 10.0, 370.0, -140.0, 20.0, 180.0, 170.0, 110.0, 130.0, 180.0, 10.0, 30.0, 0.0, 40.0, 10.0, 130.0, 0.0, 70.0, 260.0, 30.0, 40.0, 40.0, 80.0, 80.0, 270.0, 80.0, 320.0, 380.0, 160.0, 50.0, 170.0, 60.0, 30.0, 160.0, 90.0, 50.0, 130.0, 380.0, 70.0, 10.0, 20.0, 200.0, 750.0, 140.0, 265.0, 30.0, 260.0, 190.0, 240.0, 10.0, 80.0, -40.0, 90.0, 330.0, 360.0, 20.0, 30.0, 40.0, 30.0, 110.0, 70.0, 10.0, 90.0, 20.0, 40.0, 120.0, 230.0, 100.0, 20.0, 570.0, 50.0, 30.0, 250.0, 0.0, 20.0, 10.0, 30.0, 20.0, 30.0, 30.0, 180.0, 30.0, 130.0, 730.0, 30.0, 30.0, 30.0, 30.0, 330.0, 60.0, -50.0, 40.0, 50.0, 40.0, 80.0, 140.0, 300.0, 10.0, 420.0, 600.0, 90.0, 40.0, 210.0, 160.0, 190.0, 10.0, 380.0, 100.0, 70.0, 110.0, 30.0, 30.0, 110.0, 110.0, 0.0, 80.0, 90.0, 140.0, 0.0, 160.0, 110.0, 520.0, 40.0, 0.0, 80.0, 30.0, 210.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 180.0, 190.0, 60.0, -60.0, 70.0, 170.0, 200.0, 190.0, 100.0, 315.0, 60.0, 330.0, 70.0, 70.0, 90.0, -20.0, 50.0, 380.0, 120.0, 440.0, 90.0, 200.0, 100.0, -30.0, 500.0, 330.0, 50.0, -10.0, -55.0, 30.0, 0.0, 10.0, 100.0, 0.0, 20.0, 20.0, 160.0, 40.0, 20.0, -35.0, 70.0, 480.0, 50.0, 360.0, 210.0, 70.0, 190.0, 280.0, 180.0, -10.0, 80.0, 60.0, 0.0, 80.0, 360.0, 10.0, 160.0, 20.0, 20.0, 130.0, 80.0, 300.0, -15.0, 420.0, 20.0, 80.0, 80.0, 460.0, 30.0, 120.0, 300.0, 100.0, 30.0, 210.0, 240.0, 150.0, 120.0, 180.0, 130.0, 0.0, 300.0, 10.0, 0.0, 0.0, 390.0, 160.0, 70.0, 40.0, 30.0, 100.0, 100.0, 20.0, 30.0, 100.0, 0.0, 10.0, 280.0, 20.0, 280.0, 40.0, 105.0, 40.0, 180.0, 60.0, 480.0, 40.0, 40.0, 100.0, 30.0, 20.0, -30.0, 40.0, -65.0, 15.0, 0.0, 330.0, 370.0, 0.0, 560.0, 410.0, 40.0, 70.0, 120.0, 20.0, 180.0, 160.0, 190.0, 410.0, 30.0, 20.0, 320.0, 60.0, 40.0, 100.0, 490.0, 40.0, 50.0, 100.0, -30.0, 0.0, 0.0, 60.0, 310.0, 130.0, 30.0, 20.0, 20.0, 20.0, 20.0, 100.0, 40.0, 25.0, 20.0, 240.0, 0.0, 290.0, 140.0, -130.0, 40.0, 80.0, 90.0, 40.0, 220.0, 490.0, 80.0, -30.0, 20.0, 50.0, 240.0, 330.0, 60.0, 20.0, 90.0, 170.0, 220.0, 80.0, 400.0, 70.0, 20.0, 80.0, 40.0, 380.0, 100.0, 140.0, 50.0, -60.0, 370.0, 300.0, 0.0, 40.0, 30.0, 390.0, 320.0, 40.0, 20.0, 20.0, 20.0, 100.0, 20.0, 110.0, 20.0, 650.0, 0.0, 30.0, 180.0, 60.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 50.0, 110.0, 150.0, 190.0, 380.0, 340.0, 30.0, 30.0, 80.0, 70.0, 70.0, 110.0, 0.0, 460.0, 40.0, 150.0, 10.0, 370.0, 80.0, 60.0, 80.0, 20.0, 220.0, 350.0, 30.0, 300.0, 60.0, 90.0, 0.0, 60.0, 350.0, -390.0, 180.0, 100.0, 50.0, 300.0, 70.0, 110.0, 740.0, 20.0, 370.0, 170.0, 50.0, 30.0, 50.0, 80.0, 90.0, 0.0, 20.0, 30.0, 300.0, 0.0, -100.0, 370.0, 30.0, 100.0, 100.0, 20.0, 20.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 150.0, 190.0, 0.0, 20.0, 10.0, 110.0, 30.0, 50.0, 10.0, 80.0, 10.0, 60.0, 20.0, 20.0, 20.0, 40.0, 260.0, 90.0, 60.0, 380.0, 20.0, 50.0, 20.0, 270.0, 0.0, 30.0, 600.0, 300.0, 130.0, 310.0, 0.0, 30.0, 130.0, 220.0, 80.0, 50.0, 10.0, 170.0, 180.0, 30.0, 390.0, 140.0, 360.0, 30.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 190.0, 270.0, 30.0, 20.0, 750.0, 30.0, -40.0, 140.0, 20.0, 60.0, 100.0, -310.0, 10.0, 70.0, 35.0, 30.0, 30.0, 255.0, 0.0, 190.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 100.0, 20.0, 200.0, 20.0, 40.0, 30.0, 0.0, 0.0, 200.0, 350.0, 50.0, 30.0, 20.0, 150.0, -30.0, 40.0, 220.0, 60.0, 0.0, 180.0, 20.0, 400.0, 40.0, -20.0, 70.0, 240.0, 120.0, 40.0, 170.0, 360.0, 30.0, 20.0, 170.0, 100.0, 230.0, 40.0, 20.0, 10.0, 10.0, 380.0, 70.0, -10.0, 30.0, 180.0, 40.0, 55.0, 30.0, 50.0, 260.0, 30.0, 70.0, 20.0, 10.0, 10.0, 0.0, 20.0, 220.0, 0.0, 10.0, 190.0, 190.0, 10.0, 25.0, 250.0, 710.0, 30.0, -30.0, 60.0, 50.0, 340.0, 60.0, 140.0, 40.0, 100.0, 320.0, 370.0, 280.0, 60.0, 20.0, 30.0, 120.0, 110.0, 280.0, 310.0, 90.0, -20.0, 70.0, 250.0, 180.0, 280.0, 40.0, 20.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 320.0, 30.0, 30.0, 0.0, 20.0, 150.0, 130.0, 60.0, 470.0, 0.0, 440.0, 20.0, 80.0, -30.0, 200.0, 450.0, 30.0, 360.0, 30.0, 20.0, 40.0, 30.0, 40.0, 30.0, 10.0, 10.0, 130.0, 30.0, 70.0, 0.0, 490.0, 50.0, 0.0, 0.0, 110.0, 50.0, 40.0, 40.0, 120.0, 20.0, 20.0, 10.0, 60.0, 90.0, 290.0, 50.0, 10.0, 300.0, 210.0, 60.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9294684801168522, "mean_inference_ms": 2.0001292123419137, "mean_action_processing_ms": 0.5246951943826358, "mean_env_wait_ms": 1.6871816604469654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013226032257080078, "StateBufferConnector_ms": 0.010827779769897461, "ViewRequirementAgentConnector_ms": 0.4034593105316162}, "num_episodes": 18, "episode_return_max": 1950.0, "episode_return_min": 280.0, "episode_return_mean": 1148.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.382908013173903, "num_env_steps_trained_throughput_per_sec": 20.382908013173903, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 4920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4920000, "timers": {"training_iteration_time_ms": 202255.214, "restore_workers_time_ms": 0.013, "training_step_time_ms": 202255.155, "sample_time_ms": 2692.664, "learn_time_ms": 199541.39, "learn_throughput": 20.046, "synch_weights_time_ms": 11.975}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "done": false, "training_iteration": 123, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-25-40", "timestamp": 1717266340, "time_this_iter_s": 196.25013709068298, "time_total_s": 57154.69275665283, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8879d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 57154.69275665283, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 17.53176895306859, "ram_util_percent": 79.42563176895307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.060672930876414, "cur_kl_coeff": 49.93517167523022, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.744003009643799, "policy_loss": -0.001078245964539024, "vf_loss": 6.742315966227311, "vf_explained_var": 8.601102585228868e-05, "kl": 5.5377487789313074e-05, "entropy": 0.23447623998085404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1159665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 280.0, "episode_reward_mean": 1141.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 114.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1580.0, 1930.0, 1240.0, 770.0, 940.0, 1580.0, 990.0, 1270.0, 1620.0, 1380.0, 1705.0, 1040.0, 835.0, 460.0, 1040.0, 1590.0, 890.0, 700.0, 1060.0, 620.0, 1650.0, 1140.0, 1925.0, 1090.0, 1270.0, 600.0, 1360.0, 1770.0, 1290.0, 1320.0, 420.0, 1130.0, 1465.0, 1615.0, 400.0, 1855.0, 780.0, 1585.0, 1580.0, 1000.0, 940.0, 1115.0, 1240.0, 1630.0, 1190.0, 610.0, 765.0, 1280.0, 1460.0, 1400.0, 1000.0, 1160.0, 1290.0, 1020.0, 1570.0, 810.0, 1710.0, 850.0, 410.0, 510.0, 970.0, 1710.0, 1290.0, 610.0, 1470.0, 410.0, 280.0, 620.0, 890.0, 1260.0, 990.0, 1085.0, 390.0, 1485.0, 1730.0, 1420.0, 750.0, 1330.0, 1200.0, 840.0, 450.0, 1120.0, 1575.0, 940.0, 1420.0, 960.0, 550.0, 1750.0, 660.0, 1030.0, 605.0, 800.0, 1500.0, 950.0, 1280.0, 1170.0, 1980.0, 1870.0, 910.0, 1495.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [280.0, 20.0, 430.0, 20.0, 40.0, 440.0, 50.0, 80.0, 40.0, 180.0, 370.0, 0.0, 60.0, 550.0, 40.0, 40.0, 640.0, 150.0, 10.0, 70.0, 40.0, -110.0, 360.0, 20.0, 30.0, -20.0, 360.0, 520.0, 10.0, 30.0, 40.0, 30.0, 290.0, 60.0, 100.0, 10.0, 20.0, 10.0, -50.0, 260.0, 20.0, 40.0, 50.0, 0.0, 20.0, 40.0, 70.0, 40.0, 660.0, 0.0, 240.0, 500.0, 60.0, 270.0, 130.0, 0.0, 220.0, 20.0, 20.0, 120.0, 170.0, 10.0, 250.0, 110.0, 180.0, 50.0, 100.0, 40.0, 50.0, 30.0, 200.0, 230.0, 160.0, 50.0, 200.0, 20.0, 40.0, 0.0, 20.0, 350.0, 490.0, 120.0, 170.0, 150.0, 190.0, 280.0, 30.0, 30.0, 80.0, 80.0, 90.0, 200.0, 380.0, 0.0, 350.0, 20.0, 10.0, 10.0, 280.0, 40.0, 20.0, -190.0, 90.0, 250.0, 250.0, 300.0, 60.0, 710.0, 210.0, 5.0, 250.0, 30.0, 310.0, 130.0, 30.0, 70.0, 100.0, 10.0, 50.0, 60.0, 50.0, 55.0, 55.0, -5.0, 90.0, 30.0, 220.0, 210.0, 70.0, 60.0, 20.0, 150.0, 0.0, 50.0, 60.0, 80.0, 60.0, 30.0, 0.0, 10.0, 30.0, 90.0, 10.0, 410.0, 20.0, 40.0, 30.0, 310.0, 0.0, 100.0, 290.0, 40.0, 60.0, 110.0, -40.0, 80.0, 380.0, 570.0, 50.0, 50.0, 190.0, 110.0, 40.0, 40.0, 30.0, 290.0, 40.0, 0.0, 90.0, 60.0, 330.0, 10.0, 0.0, 10.0, 40.0, 40.0, 50.0, 10.0, 200.0, 10.0, 370.0, -140.0, 20.0, 180.0, 170.0, 110.0, 130.0, 180.0, 10.0, 30.0, 0.0, 40.0, 10.0, 130.0, 0.0, 70.0, 260.0, 30.0, 40.0, 40.0, 80.0, 80.0, 270.0, 80.0, 320.0, 380.0, 160.0, 50.0, 170.0, 60.0, 30.0, 160.0, 90.0, 50.0, 130.0, 380.0, 70.0, 10.0, 20.0, 200.0, 750.0, 140.0, 265.0, 30.0, 260.0, 190.0, 240.0, 10.0, 80.0, -40.0, 90.0, 330.0, 360.0, 20.0, 30.0, 40.0, 30.0, 110.0, 70.0, 10.0, 90.0, 20.0, 40.0, 120.0, 230.0, 100.0, 20.0, 570.0, 50.0, 30.0, 250.0, 0.0, 20.0, 10.0, 30.0, 20.0, 30.0, 30.0, 180.0, 30.0, 130.0, 730.0, 30.0, 30.0, 30.0, 30.0, 330.0, 60.0, -50.0, 40.0, 50.0, 40.0, 80.0, 140.0, 300.0, 10.0, 420.0, 600.0, 90.0, 40.0, 210.0, 160.0, 190.0, 10.0, 380.0, 100.0, 70.0, 110.0, 30.0, 30.0, 110.0, 110.0, 0.0, 80.0, 90.0, 140.0, 0.0, 160.0, 110.0, 520.0, 40.0, 0.0, 80.0, 30.0, 210.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 180.0, 190.0, 60.0, -60.0, 70.0, 170.0, 200.0, 190.0, 100.0, 315.0, 60.0, 330.0, 70.0, 70.0, 90.0, -20.0, 50.0, 380.0, 120.0, 440.0, 90.0, 200.0, 100.0, -30.0, 500.0, 330.0, 50.0, -10.0, -55.0, 30.0, 0.0, 10.0, 100.0, 0.0, 20.0, 20.0, 160.0, 40.0, 20.0, -35.0, 70.0, 480.0, 50.0, 360.0, 210.0, 70.0, 190.0, 280.0, 180.0, -10.0, 80.0, 60.0, 0.0, 80.0, 360.0, 10.0, 160.0, 20.0, 20.0, 130.0, 80.0, 300.0, -15.0, 420.0, 20.0, 80.0, 80.0, 460.0, 30.0, 120.0, 300.0, 100.0, 30.0, 210.0, 240.0, 150.0, 120.0, 180.0, 130.0, 0.0, 300.0, 10.0, 0.0, 0.0, 390.0, 160.0, 70.0, 40.0, 30.0, 100.0, 100.0, 20.0, 30.0, 100.0, 0.0, 10.0, 280.0, 20.0, 280.0, 40.0, 105.0, 40.0, 180.0, 60.0, 480.0, 40.0, 40.0, 100.0, 30.0, 20.0, -30.0, 40.0, -65.0, 15.0, 0.0, 330.0, 370.0, 0.0, 560.0, 410.0, 40.0, 70.0, 120.0, 20.0, 180.0, 160.0, 190.0, 410.0, 30.0, 20.0, 320.0, 60.0, 40.0, 100.0, 490.0, 40.0, 50.0, 100.0, -30.0, 0.0, 0.0, 60.0, 310.0, 130.0, 30.0, 20.0, 20.0, 20.0, 20.0, 100.0, 40.0, 25.0, 20.0, 240.0, 0.0, 290.0, 140.0, -130.0, 40.0, 80.0, 90.0, 40.0, 220.0, 490.0, 80.0, -30.0, 20.0, 50.0, 240.0, 330.0, 60.0, 20.0, 90.0, 170.0, 220.0, 80.0, 400.0, 70.0, 20.0, 80.0, 40.0, 380.0, 100.0, 140.0, 50.0, -60.0, 370.0, 300.0, 0.0, 40.0, 30.0, 390.0, 320.0, 40.0, 20.0, 20.0, 20.0, 100.0, 20.0, 110.0, 20.0, 650.0, 0.0, 30.0, 180.0, 60.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 50.0, 110.0, 150.0, 190.0, 380.0, 340.0, 30.0, 30.0, 80.0, 70.0, 70.0, 110.0, 0.0, 460.0, 40.0, 150.0, 10.0, 370.0, 80.0, 60.0, 80.0, 20.0, 220.0, 350.0, 30.0, 300.0, 60.0, 90.0, 0.0, 60.0, 350.0, -390.0, 180.0, 100.0, 50.0, 300.0, 70.0, 110.0, 740.0, 20.0, 370.0, 170.0, 50.0, 30.0, 50.0, 80.0, 90.0, 0.0, 20.0, 30.0, 300.0, 0.0, -100.0, 370.0, 30.0, 100.0, 100.0, 20.0, 20.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 150.0, 190.0, 0.0, 20.0, 10.0, 110.0, 30.0, 50.0, 10.0, 80.0, 10.0, 60.0, 20.0, 20.0, 20.0, 40.0, 260.0, 90.0, 60.0, 380.0, 20.0, 50.0, 20.0, 270.0, 0.0, 30.0, 600.0, 300.0, 130.0, 310.0, 0.0, 30.0, 130.0, 220.0, 80.0, 50.0, 10.0, 170.0, 180.0, 30.0, 390.0, 140.0, 360.0, 30.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 190.0, 270.0, 30.0, 20.0, 750.0, 30.0, -40.0, 140.0, 20.0, 60.0, 100.0, -310.0, 10.0, 70.0, 35.0, 30.0, 30.0, 255.0, 0.0, 190.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 100.0, 20.0, 200.0, 20.0, 40.0, 30.0, 0.0, 0.0, 200.0, 350.0, 50.0, 30.0, 20.0, 150.0, -30.0, 40.0, 220.0, 60.0, 0.0, 180.0, 20.0, 400.0, 40.0, -20.0, 70.0, 240.0, 120.0, 40.0, 170.0, 360.0, 30.0, 20.0, 170.0, 100.0, 230.0, 40.0, 20.0, 10.0, 10.0, 380.0, 70.0, -10.0, 30.0, 180.0, 40.0, 55.0, 30.0, 50.0, 260.0, 30.0, 70.0, 20.0, 10.0, 10.0, 0.0, 20.0, 220.0, 0.0, 10.0, 190.0, 190.0, 10.0, 25.0, 250.0, 710.0, 30.0, -30.0, 60.0, 50.0, 340.0, 60.0, 140.0, 40.0, 100.0, 320.0, 370.0, 280.0, 60.0, 20.0, 30.0, 120.0, 110.0, 280.0, 310.0, 90.0, -20.0, 70.0, 250.0, 180.0, 280.0, 40.0, 20.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 320.0, 30.0, 30.0, 0.0, 20.0, 150.0, 130.0, 60.0, 470.0, 0.0, 440.0, 20.0, 80.0, -30.0, 200.0, 450.0, 30.0, 360.0, 30.0, 20.0, 40.0, 30.0, 40.0, 30.0, 10.0, 10.0, 130.0, 30.0, 70.0, 0.0, 490.0, 50.0, 0.0, 0.0, 110.0, 50.0, 40.0, 40.0, 120.0, 20.0, 20.0, 10.0, 60.0, 90.0, 290.0, 50.0, 10.0, 300.0, 210.0, 60.0, 40.0, 10.0, -30.0, 220.0, 70.0, 30.0, 510.0, 5.0, 200.0, 520.0, 40.0, 240.0, 80.0, 0.0, 150.0, 290.0, 0.0, 0.0, 40.0, 20.0, 120.0, 120.0, 60.0, 130.0, 210.0, 30.0, 80.0, 80.0, 40.0, 170.0, 500.0, -20.0, 60.0, 270.0, -40.0, 40.0, 120.0, 250.0, 40.0, 70.0, 170.0, 10.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 360.0, 0.0, 30.0, 30.0, 50.0, 260.0, 250.0, 120.0, 340.0, 440.0, 50.0, 40.0, 170.0, 120.0, 0.0, 120.0, 50.0, 220.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 700.0, 90.0, 100.0, 60.0, 10.0, 30.0, 0.0, 0.0, 20.0, 140.0, 10.0, 20.0, 150.0, 70.0, 50.0, 190.0, 50.0, 20.0, -95.0, 60.0, 20.0, 70.0, 20.0, 50.0, 250.0, 280.0, 0.0, 50.0, 0.0, 20.0, 60.0, 560.0, 30.0, 30.0, 150.0, 10.0, 550.0, -10.0, 100.0, 30.0, 150.0, 40.0, 330.0, 20.0, 30.0, 10.0, 140.0, 190.0, 10.0, 210.0, -50.0, 110.0, 0.0, 160.0, 170.0, 330.0, 20.0, 20.0, 310.0, -30.0, -30.0, 220.0, 30.0, 50.0, 10.0, -60.0, 360.0, 600.0, 20.0, 50.0, 50.0, 160.0, 140.0, 320.0, 80.0, 780.0, 20.0, 300.0, 80.0, 30.0, 60.0, 780.0, 290.0, -10.0, 30.0, 60.0, 60.0, 390.0, 180.0, 160.0, 70.0, 20.0, 350.0, 40.0, 70.0, 70.0, 20.0, 30.0, 80.0, 60.0, 240.0, 410.0, -25.0, 290.0, 10.0, 210.0, 80.0, 180.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9257671626510415, "mean_inference_ms": 1.9977887844931923, "mean_action_processing_ms": 0.523916625813244, "mean_env_wait_ms": 1.6846745218900576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012662649154663086, "StateBufferConnector_ms": 0.010724544525146484, "ViewRequirementAgentConnector_ms": 0.39536595344543457}, "num_episodes": 18, "episode_return_max": 1980.0, "episode_return_min": 280.0, "episode_return_mean": 1141.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.1445942440605035, "num_env_steps_trained_throughput_per_sec": 3.1445942440605035, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 4960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4960000, "timers": {"training_iteration_time_ms": 309577.814, "restore_workers_time_ms": 0.013, "training_step_time_ms": 309577.754, "sample_time_ms": 2676.423, "learn_time_ms": 306875.155, "learn_throughput": 13.035, "synch_weights_time_ms": 15.678}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "done": false, "training_iteration": 124, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-46-52", "timestamp": 1717267612, "time_this_iter_s": 1272.2270047664642, "time_total_s": 58426.919761419296, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321c19310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 58426.919761419296, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 20.879310344827587, "ram_util_percent": 82.0796551724138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8625509454419436, "cur_kl_coeff": 24.96758583761511, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.280953962175737, "policy_loss": -0.0015946423722911105, "vf_loss": 7.280194121199294, "vf_explained_var": 0.0004291639223901101, "kl": 9.430164164132993e-05, "entropy": 0.21839083175039012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1169055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "env_runners": {"episode_reward_max": 2040.0, "episode_reward_min": 160.0, "episode_reward_mean": 1132.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 113.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1090.0, 1270.0, 600.0, 1360.0, 1770.0, 1290.0, 1320.0, 420.0, 1130.0, 1465.0, 1615.0, 400.0, 1855.0, 780.0, 1585.0, 1580.0, 1000.0, 940.0, 1115.0, 1240.0, 1630.0, 1190.0, 610.0, 765.0, 1280.0, 1460.0, 1400.0, 1000.0, 1160.0, 1290.0, 1020.0, 1570.0, 810.0, 1710.0, 850.0, 410.0, 510.0, 970.0, 1710.0, 1290.0, 610.0, 1470.0, 410.0, 280.0, 620.0, 890.0, 1260.0, 990.0, 1085.0, 390.0, 1485.0, 1730.0, 1420.0, 750.0, 1330.0, 1200.0, 840.0, 450.0, 1120.0, 1575.0, 940.0, 1420.0, 960.0, 550.0, 1750.0, 660.0, 1030.0, 605.0, 800.0, 1500.0, 950.0, 1280.0, 1170.0, 1980.0, 1870.0, 910.0, 1495.0, 1390.0, 1210.0, 1270.0, 1200.0, 195.0, 1530.0, 680.0, 1645.0, 2040.0, 1040.0, 1520.0, 1540.0, 570.0, 1230.0, 1340.0, 1400.0, 1160.0, 1040.0, 1735.0, 980.0, 160.0, 1280.0, 845.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 330.0, 360.0, 20.0, 30.0, 40.0, 30.0, 110.0, 70.0, 10.0, 90.0, 20.0, 40.0, 120.0, 230.0, 100.0, 20.0, 570.0, 50.0, 30.0, 250.0, 0.0, 20.0, 10.0, 30.0, 20.0, 30.0, 30.0, 180.0, 30.0, 130.0, 730.0, 30.0, 30.0, 30.0, 30.0, 330.0, 60.0, -50.0, 40.0, 50.0, 40.0, 80.0, 140.0, 300.0, 10.0, 420.0, 600.0, 90.0, 40.0, 210.0, 160.0, 190.0, 10.0, 380.0, 100.0, 70.0, 110.0, 30.0, 30.0, 110.0, 110.0, 0.0, 80.0, 90.0, 140.0, 0.0, 160.0, 110.0, 520.0, 40.0, 0.0, 80.0, 30.0, 210.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 180.0, 190.0, 60.0, -60.0, 70.0, 170.0, 200.0, 190.0, 100.0, 315.0, 60.0, 330.0, 70.0, 70.0, 90.0, -20.0, 50.0, 380.0, 120.0, 440.0, 90.0, 200.0, 100.0, -30.0, 500.0, 330.0, 50.0, -10.0, -55.0, 30.0, 0.0, 10.0, 100.0, 0.0, 20.0, 20.0, 160.0, 40.0, 20.0, -35.0, 70.0, 480.0, 50.0, 360.0, 210.0, 70.0, 190.0, 280.0, 180.0, -10.0, 80.0, 60.0, 0.0, 80.0, 360.0, 10.0, 160.0, 20.0, 20.0, 130.0, 80.0, 300.0, -15.0, 420.0, 20.0, 80.0, 80.0, 460.0, 30.0, 120.0, 300.0, 100.0, 30.0, 210.0, 240.0, 150.0, 120.0, 180.0, 130.0, 0.0, 300.0, 10.0, 0.0, 0.0, 390.0, 160.0, 70.0, 40.0, 30.0, 100.0, 100.0, 20.0, 30.0, 100.0, 0.0, 10.0, 280.0, 20.0, 280.0, 40.0, 105.0, 40.0, 180.0, 60.0, 480.0, 40.0, 40.0, 100.0, 30.0, 20.0, -30.0, 40.0, -65.0, 15.0, 0.0, 330.0, 370.0, 0.0, 560.0, 410.0, 40.0, 70.0, 120.0, 20.0, 180.0, 160.0, 190.0, 410.0, 30.0, 20.0, 320.0, 60.0, 40.0, 100.0, 490.0, 40.0, 50.0, 100.0, -30.0, 0.0, 0.0, 60.0, 310.0, 130.0, 30.0, 20.0, 20.0, 20.0, 20.0, 100.0, 40.0, 25.0, 20.0, 240.0, 0.0, 290.0, 140.0, -130.0, 40.0, 80.0, 90.0, 40.0, 220.0, 490.0, 80.0, -30.0, 20.0, 50.0, 240.0, 330.0, 60.0, 20.0, 90.0, 170.0, 220.0, 80.0, 400.0, 70.0, 20.0, 80.0, 40.0, 380.0, 100.0, 140.0, 50.0, -60.0, 370.0, 300.0, 0.0, 40.0, 30.0, 390.0, 320.0, 40.0, 20.0, 20.0, 20.0, 100.0, 20.0, 110.0, 20.0, 650.0, 0.0, 30.0, 180.0, 60.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 50.0, 110.0, 150.0, 190.0, 380.0, 340.0, 30.0, 30.0, 80.0, 70.0, 70.0, 110.0, 0.0, 460.0, 40.0, 150.0, 10.0, 370.0, 80.0, 60.0, 80.0, 20.0, 220.0, 350.0, 30.0, 300.0, 60.0, 90.0, 0.0, 60.0, 350.0, -390.0, 180.0, 100.0, 50.0, 300.0, 70.0, 110.0, 740.0, 20.0, 370.0, 170.0, 50.0, 30.0, 50.0, 80.0, 90.0, 0.0, 20.0, 30.0, 300.0, 0.0, -100.0, 370.0, 30.0, 100.0, 100.0, 20.0, 20.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 150.0, 190.0, 0.0, 20.0, 10.0, 110.0, 30.0, 50.0, 10.0, 80.0, 10.0, 60.0, 20.0, 20.0, 20.0, 40.0, 260.0, 90.0, 60.0, 380.0, 20.0, 50.0, 20.0, 270.0, 0.0, 30.0, 600.0, 300.0, 130.0, 310.0, 0.0, 30.0, 130.0, 220.0, 80.0, 50.0, 10.0, 170.0, 180.0, 30.0, 390.0, 140.0, 360.0, 30.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 190.0, 270.0, 30.0, 20.0, 750.0, 30.0, -40.0, 140.0, 20.0, 60.0, 100.0, -310.0, 10.0, 70.0, 35.0, 30.0, 30.0, 255.0, 0.0, 190.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 100.0, 20.0, 200.0, 20.0, 40.0, 30.0, 0.0, 0.0, 200.0, 350.0, 50.0, 30.0, 20.0, 150.0, -30.0, 40.0, 220.0, 60.0, 0.0, 180.0, 20.0, 400.0, 40.0, -20.0, 70.0, 240.0, 120.0, 40.0, 170.0, 360.0, 30.0, 20.0, 170.0, 100.0, 230.0, 40.0, 20.0, 10.0, 10.0, 380.0, 70.0, -10.0, 30.0, 180.0, 40.0, 55.0, 30.0, 50.0, 260.0, 30.0, 70.0, 20.0, 10.0, 10.0, 0.0, 20.0, 220.0, 0.0, 10.0, 190.0, 190.0, 10.0, 25.0, 250.0, 710.0, 30.0, -30.0, 60.0, 50.0, 340.0, 60.0, 140.0, 40.0, 100.0, 320.0, 370.0, 280.0, 60.0, 20.0, 30.0, 120.0, 110.0, 280.0, 310.0, 90.0, -20.0, 70.0, 250.0, 180.0, 280.0, 40.0, 20.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 320.0, 30.0, 30.0, 0.0, 20.0, 150.0, 130.0, 60.0, 470.0, 0.0, 440.0, 20.0, 80.0, -30.0, 200.0, 450.0, 30.0, 360.0, 30.0, 20.0, 40.0, 30.0, 40.0, 30.0, 10.0, 10.0, 130.0, 30.0, 70.0, 0.0, 490.0, 50.0, 0.0, 0.0, 110.0, 50.0, 40.0, 40.0, 120.0, 20.0, 20.0, 10.0, 60.0, 90.0, 290.0, 50.0, 10.0, 300.0, 210.0, 60.0, 40.0, 10.0, -30.0, 220.0, 70.0, 30.0, 510.0, 5.0, 200.0, 520.0, 40.0, 240.0, 80.0, 0.0, 150.0, 290.0, 0.0, 0.0, 40.0, 20.0, 120.0, 120.0, 60.0, 130.0, 210.0, 30.0, 80.0, 80.0, 40.0, 170.0, 500.0, -20.0, 60.0, 270.0, -40.0, 40.0, 120.0, 250.0, 40.0, 70.0, 170.0, 10.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 360.0, 0.0, 30.0, 30.0, 50.0, 260.0, 250.0, 120.0, 340.0, 440.0, 50.0, 40.0, 170.0, 120.0, 0.0, 120.0, 50.0, 220.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 700.0, 90.0, 100.0, 60.0, 10.0, 30.0, 0.0, 0.0, 20.0, 140.0, 10.0, 20.0, 150.0, 70.0, 50.0, 190.0, 50.0, 20.0, -95.0, 60.0, 20.0, 70.0, 20.0, 50.0, 250.0, 280.0, 0.0, 50.0, 0.0, 20.0, 60.0, 560.0, 30.0, 30.0, 150.0, 10.0, 550.0, -10.0, 100.0, 30.0, 150.0, 40.0, 330.0, 20.0, 30.0, 10.0, 140.0, 190.0, 10.0, 210.0, -50.0, 110.0, 0.0, 160.0, 170.0, 330.0, 20.0, 20.0, 310.0, -30.0, -30.0, 220.0, 30.0, 50.0, 10.0, -60.0, 360.0, 600.0, 20.0, 50.0, 50.0, 160.0, 140.0, 320.0, 80.0, 780.0, 20.0, 300.0, 80.0, 30.0, 60.0, 780.0, 290.0, -10.0, 30.0, 60.0, 60.0, 390.0, 180.0, 160.0, 70.0, 20.0, 350.0, 40.0, 70.0, 70.0, 20.0, 30.0, 80.0, 60.0, 240.0, 410.0, -25.0, 290.0, 10.0, 210.0, 80.0, 180.0, 40.0, 390.0, 70.0, 310.0, 30.0, 20.0, 10.0, 120.0, 20.0, 320.0, 100.0, 190.0, 70.0, 90.0, 0.0, 70.0, 70.0, 520.0, 60.0, 50.0, 90.0, 110.0, 180.0, 210.0, 230.0, 70.0, 190.0, 40.0, 0.0, 190.0, 50.0, -50.0, 260.0, 290.0, 70.0, 370.0, 50.0, 30.0, 90.0, -20.0, 110.0, -380.0, 0.0, 40.0, 10.0, 275.0, 0.0, 170.0, 10.0, 0.0, 70.0, 280.0, 40.0, 510.0, 50.0, 200.0, 30.0, 10.0, 330.0, 50.0, 30.0, 110.0, 10.0, 0.0, 20.0, 220.0, 270.0, 0.0, 40.0, -10.0, 20.0, -15.0, 10.0, 60.0, 50.0, 140.0, 510.0, 330.0, 120.0, 90.0, 350.0, 280.0, 0.0, 170.0, 140.0, 110.0, 40.0, 250.0, 530.0, 490.0, 30.0, 80.0, 30.0, 10.0, 60.0, 50.0, 10.0, 20.0, 210.0, 350.0, 220.0, 30.0, -20.0, 70.0, 350.0, 50.0, 230.0, 570.0, 40.0, 160.0, 40.0, 410.0, 140.0, 110.0, 80.0, 30.0, 170.0, -40.0, 410.0, 180.0, 50.0, 40.0, 10.0, 170.0, 20.0, 100.0, 40.0, 50.0, 10.0, 10.0, 120.0, 180.0, 100.0, 50.0, 130.0, 100.0, 30.0, 160.0, 430.0, 40.0, 10.0, 30.0, 90.0, 30.0, 250.0, 130.0, 230.0, 90.0, 30.0, 420.0, 40.0, 510.0, 60.0, 200.0, 0.0, 450.0, -190.0, 120.0, 190.0, 20.0, 40.0, 60.0, 290.0, 40.0, 50.0, 380.0, 240.0, -100.0, 90.0, 30.0, 80.0, 180.0, 0.0, 50.0, 260.0, 20.0, 10.0, 90.0, 240.0, 20.0, 170.0, 290.0, 590.0, -125.0, 570.0, -10.0, 50.0, -90.0, -100.0, 150.0, 410.0, 40.0, 50.0, 110.0, 280.0, 190.0, 210.0, -30.0, 140.0, 10.0, -20.0, 20.0, 50.0, 0.0, 10.0, 30.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 30.0, 130.0, 230.0, 0.0, 70.0, 60.0, 370.0, 220.0, 130.0, 0.0, 300.0, 30.0, 25.0, 0.0, 90.0, 290.0, 70.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9234837909521112, "mean_inference_ms": 1.9977964524275384, "mean_action_processing_ms": 0.5238725101474165, "mean_env_wait_ms": 1.684130282786568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013514995574951172, "StateBufferConnector_ms": 0.0124969482421875, "ViewRequirementAgentConnector_ms": 0.5544469356536865}, "num_episodes": 23, "episode_return_max": 2040.0, "episode_return_min": 160.0, "episode_return_mean": 1132.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 7.025045401906617, "num_env_steps_trained_throughput_per_sec": 7.025045401906617, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 5000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000000, "timers": {"training_iteration_time_ms": 346108.86, "restore_workers_time_ms": 0.014, "training_step_time_ms": 346108.796, "sample_time_ms": 2970.68, "learn_time_ms": 343111.497, "learn_throughput": 11.658, "synch_weights_time_ms": 15.604}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "done": false, "training_iteration": 125, "trial_id": "3d3a5_00000", "date": "2024-06-01_14-56-21", "timestamp": 1717268181, "time_this_iter_s": 569.4309930801392, "time_total_s": 58996.350754499435, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a58d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 58996.350754499435, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 21.441496598639453, "ram_util_percent": 82.53877551020409}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.221801206364799, "cur_kl_coeff": 12.483792918807556, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00251985794757478, "vf_loss": 7.027067462425516, "vf_explained_var": -5.783610704480903e-05, "kl": Infinity, "entropy": 0.23139868266523456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1178445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "env_runners": {"episode_reward_max": 2040.0, "episode_reward_min": 100.0, "episode_reward_mean": 1096.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -810.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 109.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1115.0, 1240.0, 1630.0, 1190.0, 610.0, 765.0, 1280.0, 1460.0, 1400.0, 1000.0, 1160.0, 1290.0, 1020.0, 1570.0, 810.0, 1710.0, 850.0, 410.0, 510.0, 970.0, 1710.0, 1290.0, 610.0, 1470.0, 410.0, 280.0, 620.0, 890.0, 1260.0, 990.0, 1085.0, 390.0, 1485.0, 1730.0, 1420.0, 750.0, 1330.0, 1200.0, 840.0, 450.0, 1120.0, 1575.0, 940.0, 1420.0, 960.0, 550.0, 1750.0, 660.0, 1030.0, 605.0, 800.0, 1500.0, 950.0, 1280.0, 1170.0, 1980.0, 1870.0, 910.0, 1495.0, 1390.0, 1210.0, 1270.0, 1200.0, 195.0, 1530.0, 680.0, 1645.0, 2040.0, 1040.0, 1520.0, 1540.0, 570.0, 1230.0, 1340.0, 1400.0, 1160.0, 1040.0, 1735.0, 980.0, 160.0, 1280.0, 845.0, 140.0, 1790.0, 620.0, 1820.0, 540.0, 730.0, 1515.0, 880.0, 420.0, 820.0, 100.0, 1135.0, 1290.0, 1420.0, 1370.0, 1185.0, 1440.0, 650.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 105.0, 40.0, 180.0, 60.0, 480.0, 40.0, 40.0, 100.0, 30.0, 20.0, -30.0, 40.0, -65.0, 15.0, 0.0, 330.0, 370.0, 0.0, 560.0, 410.0, 40.0, 70.0, 120.0, 20.0, 180.0, 160.0, 190.0, 410.0, 30.0, 20.0, 320.0, 60.0, 40.0, 100.0, 490.0, 40.0, 50.0, 100.0, -30.0, 0.0, 0.0, 60.0, 310.0, 130.0, 30.0, 20.0, 20.0, 20.0, 20.0, 100.0, 40.0, 25.0, 20.0, 240.0, 0.0, 290.0, 140.0, -130.0, 40.0, 80.0, 90.0, 40.0, 220.0, 490.0, 80.0, -30.0, 20.0, 50.0, 240.0, 330.0, 60.0, 20.0, 90.0, 170.0, 220.0, 80.0, 400.0, 70.0, 20.0, 80.0, 40.0, 380.0, 100.0, 140.0, 50.0, -60.0, 370.0, 300.0, 0.0, 40.0, 30.0, 390.0, 320.0, 40.0, 20.0, 20.0, 20.0, 100.0, 20.0, 110.0, 20.0, 650.0, 0.0, 30.0, 180.0, 60.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 50.0, 110.0, 150.0, 190.0, 380.0, 340.0, 30.0, 30.0, 80.0, 70.0, 70.0, 110.0, 0.0, 460.0, 40.0, 150.0, 10.0, 370.0, 80.0, 60.0, 80.0, 20.0, 220.0, 350.0, 30.0, 300.0, 60.0, 90.0, 0.0, 60.0, 350.0, -390.0, 180.0, 100.0, 50.0, 300.0, 70.0, 110.0, 740.0, 20.0, 370.0, 170.0, 50.0, 30.0, 50.0, 80.0, 90.0, 0.0, 20.0, 30.0, 300.0, 0.0, -100.0, 370.0, 30.0, 100.0, 100.0, 20.0, 20.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 150.0, 190.0, 0.0, 20.0, 10.0, 110.0, 30.0, 50.0, 10.0, 80.0, 10.0, 60.0, 20.0, 20.0, 20.0, 40.0, 260.0, 90.0, 60.0, 380.0, 20.0, 50.0, 20.0, 270.0, 0.0, 30.0, 600.0, 300.0, 130.0, 310.0, 0.0, 30.0, 130.0, 220.0, 80.0, 50.0, 10.0, 170.0, 180.0, 30.0, 390.0, 140.0, 360.0, 30.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 190.0, 270.0, 30.0, 20.0, 750.0, 30.0, -40.0, 140.0, 20.0, 60.0, 100.0, -310.0, 10.0, 70.0, 35.0, 30.0, 30.0, 255.0, 0.0, 190.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 100.0, 20.0, 200.0, 20.0, 40.0, 30.0, 0.0, 0.0, 200.0, 350.0, 50.0, 30.0, 20.0, 150.0, -30.0, 40.0, 220.0, 60.0, 0.0, 180.0, 20.0, 400.0, 40.0, -20.0, 70.0, 240.0, 120.0, 40.0, 170.0, 360.0, 30.0, 20.0, 170.0, 100.0, 230.0, 40.0, 20.0, 10.0, 10.0, 380.0, 70.0, -10.0, 30.0, 180.0, 40.0, 55.0, 30.0, 50.0, 260.0, 30.0, 70.0, 20.0, 10.0, 10.0, 0.0, 20.0, 220.0, 0.0, 10.0, 190.0, 190.0, 10.0, 25.0, 250.0, 710.0, 30.0, -30.0, 60.0, 50.0, 340.0, 60.0, 140.0, 40.0, 100.0, 320.0, 370.0, 280.0, 60.0, 20.0, 30.0, 120.0, 110.0, 280.0, 310.0, 90.0, -20.0, 70.0, 250.0, 180.0, 280.0, 40.0, 20.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 320.0, 30.0, 30.0, 0.0, 20.0, 150.0, 130.0, 60.0, 470.0, 0.0, 440.0, 20.0, 80.0, -30.0, 200.0, 450.0, 30.0, 360.0, 30.0, 20.0, 40.0, 30.0, 40.0, 30.0, 10.0, 10.0, 130.0, 30.0, 70.0, 0.0, 490.0, 50.0, 0.0, 0.0, 110.0, 50.0, 40.0, 40.0, 120.0, 20.0, 20.0, 10.0, 60.0, 90.0, 290.0, 50.0, 10.0, 300.0, 210.0, 60.0, 40.0, 10.0, -30.0, 220.0, 70.0, 30.0, 510.0, 5.0, 200.0, 520.0, 40.0, 240.0, 80.0, 0.0, 150.0, 290.0, 0.0, 0.0, 40.0, 20.0, 120.0, 120.0, 60.0, 130.0, 210.0, 30.0, 80.0, 80.0, 40.0, 170.0, 500.0, -20.0, 60.0, 270.0, -40.0, 40.0, 120.0, 250.0, 40.0, 70.0, 170.0, 10.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 360.0, 0.0, 30.0, 30.0, 50.0, 260.0, 250.0, 120.0, 340.0, 440.0, 50.0, 40.0, 170.0, 120.0, 0.0, 120.0, 50.0, 220.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 700.0, 90.0, 100.0, 60.0, 10.0, 30.0, 0.0, 0.0, 20.0, 140.0, 10.0, 20.0, 150.0, 70.0, 50.0, 190.0, 50.0, 20.0, -95.0, 60.0, 20.0, 70.0, 20.0, 50.0, 250.0, 280.0, 0.0, 50.0, 0.0, 20.0, 60.0, 560.0, 30.0, 30.0, 150.0, 10.0, 550.0, -10.0, 100.0, 30.0, 150.0, 40.0, 330.0, 20.0, 30.0, 10.0, 140.0, 190.0, 10.0, 210.0, -50.0, 110.0, 0.0, 160.0, 170.0, 330.0, 20.0, 20.0, 310.0, -30.0, -30.0, 220.0, 30.0, 50.0, 10.0, -60.0, 360.0, 600.0, 20.0, 50.0, 50.0, 160.0, 140.0, 320.0, 80.0, 780.0, 20.0, 300.0, 80.0, 30.0, 60.0, 780.0, 290.0, -10.0, 30.0, 60.0, 60.0, 390.0, 180.0, 160.0, 70.0, 20.0, 350.0, 40.0, 70.0, 70.0, 20.0, 30.0, 80.0, 60.0, 240.0, 410.0, -25.0, 290.0, 10.0, 210.0, 80.0, 180.0, 40.0, 390.0, 70.0, 310.0, 30.0, 20.0, 10.0, 120.0, 20.0, 320.0, 100.0, 190.0, 70.0, 90.0, 0.0, 70.0, 70.0, 520.0, 60.0, 50.0, 90.0, 110.0, 180.0, 210.0, 230.0, 70.0, 190.0, 40.0, 0.0, 190.0, 50.0, -50.0, 260.0, 290.0, 70.0, 370.0, 50.0, 30.0, 90.0, -20.0, 110.0, -380.0, 0.0, 40.0, 10.0, 275.0, 0.0, 170.0, 10.0, 0.0, 70.0, 280.0, 40.0, 510.0, 50.0, 200.0, 30.0, 10.0, 330.0, 50.0, 30.0, 110.0, 10.0, 0.0, 20.0, 220.0, 270.0, 0.0, 40.0, -10.0, 20.0, -15.0, 10.0, 60.0, 50.0, 140.0, 510.0, 330.0, 120.0, 90.0, 350.0, 280.0, 0.0, 170.0, 140.0, 110.0, 40.0, 250.0, 530.0, 490.0, 30.0, 80.0, 30.0, 10.0, 60.0, 50.0, 10.0, 20.0, 210.0, 350.0, 220.0, 30.0, -20.0, 70.0, 350.0, 50.0, 230.0, 570.0, 40.0, 160.0, 40.0, 410.0, 140.0, 110.0, 80.0, 30.0, 170.0, -40.0, 410.0, 180.0, 50.0, 40.0, 10.0, 170.0, 20.0, 100.0, 40.0, 50.0, 10.0, 10.0, 120.0, 180.0, 100.0, 50.0, 130.0, 100.0, 30.0, 160.0, 430.0, 40.0, 10.0, 30.0, 90.0, 30.0, 250.0, 130.0, 230.0, 90.0, 30.0, 420.0, 40.0, 510.0, 60.0, 200.0, 0.0, 450.0, -190.0, 120.0, 190.0, 20.0, 40.0, 60.0, 290.0, 40.0, 50.0, 380.0, 240.0, -100.0, 90.0, 30.0, 80.0, 180.0, 0.0, 50.0, 260.0, 20.0, 10.0, 90.0, 240.0, 20.0, 170.0, 290.0, 590.0, -125.0, 570.0, -10.0, 50.0, -90.0, -100.0, 150.0, 410.0, 40.0, 50.0, 110.0, 280.0, 190.0, 210.0, -30.0, 140.0, 10.0, -20.0, 20.0, 50.0, 0.0, 10.0, 30.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 30.0, 130.0, 230.0, 0.0, 70.0, 60.0, 370.0, 220.0, 130.0, 0.0, 300.0, 30.0, 25.0, 0.0, 90.0, 290.0, 70.0, 0.0, 40.0, 90.0, 90.0, 350.0, 10.0, 30.0, 300.0, 0.0, -810.0, 30.0, 50.0, 20.0, 440.0, 170.0, 50.0, 180.0, 310.0, 380.0, 40.0, 30.0, 170.0, 80.0, 70.0, 20.0, 50.0, 10.0, 360.0, 0.0, 20.0, 0.0, 10.0, 50.0, 260.0, 360.0, -50.0, 10.0, 150.0, 50.0, 380.0, 160.0, 450.0, 190.0, 50.0, 20.0, 20.0, 0.0, 90.0, 30.0, 30.0, 70.0, 40.0, 20.0, 10.0, 30.0, 50.0, 350.0, 20.0, 80.0, 30.0, 90.0, 50.0, 190.0, 240.0, 440.0, 10.0, 120.0, -5.0, 100.0, 60.0, 210.0, 150.0, 430.0, 80.0, 180.0, -210.0, 10.0, 70.0, 10.0, 70.0, 20.0, 220.0, 20.0, 0.0, 70.0, 30.0, 140.0, 40.0, 0.0, 30.0, 90.0, 0.0, 20.0, 50.0, 60.0, 0.0, -40.0, 0.0, 200.0, 140.0, 370.0, 20.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 160.0, 55.0, 20.0, 150.0, 440.0, 30.0, 80.0, 30.0, 70.0, 100.0, 70.0, 80.0, 30.0, 110.0, 20.0, 330.0, 300.0, 80.0, 150.0, 120.0, 140.0, 20.0, 240.0, 80.0, 90.0, 470.0, 170.0, 70.0, 90.0, 50.0, 120.0, 310.0, 0.0, 230.0, 210.0, 100.0, 150.0, 30.0, 200.0, 20.0, 20.0, 120.0, 180.0, 50.0, 10.0, 15.0, 290.0, 200.0, 210.0, 90.0, 90.0, 50.0, 10.0, 670.0, 160.0, 80.0, 120.0, 190.0, -40.0, 110.0, 10.0, -10.0, 60.0, 240.0, 10.0, 100.0, 30.0, 20.0, 180.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9218139207331182, "mean_inference_ms": 1.9978599655464182, "mean_action_processing_ms": 0.5238652000325961, "mean_env_wait_ms": 1.683776884530548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013758659362792969, "StateBufferConnector_ms": 0.012573957443237305, "ViewRequirementAgentConnector_ms": 0.5792906284332275}, "num_episodes": 18, "episode_return_max": 2040.0, "episode_return_min": 100.0, "episode_return_mean": 1096.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.400509506920031, "num_env_steps_trained_throughput_per_sec": 4.400509506920031, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 5040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5040000, "timers": {"training_iteration_time_ms": 416248.212, "restore_workers_time_ms": 0.014, "training_step_time_ms": 416248.148, "sample_time_ms": 2958.752, "learn_time_ms": 413263.002, "learn_throughput": 9.679, "synch_weights_time_ms": 15.481}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "done": false, "training_iteration": 126, "trial_id": "3d3a5_00000", "date": "2024-06-01_15-11-30", "timestamp": 1717269090, "time_this_iter_s": 908.9946870803833, "time_total_s": 59905.34544157982, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118023040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 59905.34544157982, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 20.22352941176471, "ram_util_percent": 81.3826989619377}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.780988106350548, "cur_kl_coeff": 18.725689378211335, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.341247391319884, "policy_loss": -0.0021794316172401426, "vf_loss": 7.340784086942419, "vf_explained_var": 0.0005100386528669201, "kl": 0.0001411290881698055, "entropy": 0.227298527430739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1187835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "env_runners": {"episode_reward_max": 2040.0, "episode_reward_min": 100.0, "episode_reward_mean": 1111.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -810.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 111.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [610.0, 1470.0, 410.0, 280.0, 620.0, 890.0, 1260.0, 990.0, 1085.0, 390.0, 1485.0, 1730.0, 1420.0, 750.0, 1330.0, 1200.0, 840.0, 450.0, 1120.0, 1575.0, 940.0, 1420.0, 960.0, 550.0, 1750.0, 660.0, 1030.0, 605.0, 800.0, 1500.0, 950.0, 1280.0, 1170.0, 1980.0, 1870.0, 910.0, 1495.0, 1390.0, 1210.0, 1270.0, 1200.0, 195.0, 1530.0, 680.0, 1645.0, 2040.0, 1040.0, 1520.0, 1540.0, 570.0, 1230.0, 1340.0, 1400.0, 1160.0, 1040.0, 1735.0, 980.0, 160.0, 1280.0, 845.0, 140.0, 1790.0, 620.0, 1820.0, 540.0, 730.0, 1515.0, 880.0, 420.0, 820.0, 100.0, 1135.0, 1290.0, 1420.0, 1370.0, 1185.0, 1440.0, 650.0, 1210.0, 1100.0, 1475.0, 1790.0, 1430.0, 940.0, 705.0, 1490.0, 1210.0, 910.0, 1130.0, 1155.0, 1400.0, 1055.0, 1345.0, 830.0, 1360.0, 1470.0, 925.0, 890.0, 1790.0, 945.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 360.0, 30.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 190.0, 270.0, 30.0, 20.0, 750.0, 30.0, -40.0, 140.0, 20.0, 60.0, 100.0, -310.0, 10.0, 70.0, 35.0, 30.0, 30.0, 255.0, 0.0, 190.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, 0.0, 20.0, 80.0, 20.0, 10.0, 100.0, 20.0, 200.0, 20.0, 40.0, 30.0, 0.0, 0.0, 200.0, 350.0, 50.0, 30.0, 20.0, 150.0, -30.0, 40.0, 220.0, 60.0, 0.0, 180.0, 20.0, 400.0, 40.0, -20.0, 70.0, 240.0, 120.0, 40.0, 170.0, 360.0, 30.0, 20.0, 170.0, 100.0, 230.0, 40.0, 20.0, 10.0, 10.0, 380.0, 70.0, -10.0, 30.0, 180.0, 40.0, 55.0, 30.0, 50.0, 260.0, 30.0, 70.0, 20.0, 10.0, 10.0, 0.0, 20.0, 220.0, 0.0, 10.0, 190.0, 190.0, 10.0, 25.0, 250.0, 710.0, 30.0, -30.0, 60.0, 50.0, 340.0, 60.0, 140.0, 40.0, 100.0, 320.0, 370.0, 280.0, 60.0, 20.0, 30.0, 120.0, 110.0, 280.0, 310.0, 90.0, -20.0, 70.0, 250.0, 180.0, 280.0, 40.0, 20.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 320.0, 30.0, 30.0, 0.0, 20.0, 150.0, 130.0, 60.0, 470.0, 0.0, 440.0, 20.0, 80.0, -30.0, 200.0, 450.0, 30.0, 360.0, 30.0, 20.0, 40.0, 30.0, 40.0, 30.0, 10.0, 10.0, 130.0, 30.0, 70.0, 0.0, 490.0, 50.0, 0.0, 0.0, 110.0, 50.0, 40.0, 40.0, 120.0, 20.0, 20.0, 10.0, 60.0, 90.0, 290.0, 50.0, 10.0, 300.0, 210.0, 60.0, 40.0, 10.0, -30.0, 220.0, 70.0, 30.0, 510.0, 5.0, 200.0, 520.0, 40.0, 240.0, 80.0, 0.0, 150.0, 290.0, 0.0, 0.0, 40.0, 20.0, 120.0, 120.0, 60.0, 130.0, 210.0, 30.0, 80.0, 80.0, 40.0, 170.0, 500.0, -20.0, 60.0, 270.0, -40.0, 40.0, 120.0, 250.0, 40.0, 70.0, 170.0, 10.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 360.0, 0.0, 30.0, 30.0, 50.0, 260.0, 250.0, 120.0, 340.0, 440.0, 50.0, 40.0, 170.0, 120.0, 0.0, 120.0, 50.0, 220.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 700.0, 90.0, 100.0, 60.0, 10.0, 30.0, 0.0, 0.0, 20.0, 140.0, 10.0, 20.0, 150.0, 70.0, 50.0, 190.0, 50.0, 20.0, -95.0, 60.0, 20.0, 70.0, 20.0, 50.0, 250.0, 280.0, 0.0, 50.0, 0.0, 20.0, 60.0, 560.0, 30.0, 30.0, 150.0, 10.0, 550.0, -10.0, 100.0, 30.0, 150.0, 40.0, 330.0, 20.0, 30.0, 10.0, 140.0, 190.0, 10.0, 210.0, -50.0, 110.0, 0.0, 160.0, 170.0, 330.0, 20.0, 20.0, 310.0, -30.0, -30.0, 220.0, 30.0, 50.0, 10.0, -60.0, 360.0, 600.0, 20.0, 50.0, 50.0, 160.0, 140.0, 320.0, 80.0, 780.0, 20.0, 300.0, 80.0, 30.0, 60.0, 780.0, 290.0, -10.0, 30.0, 60.0, 60.0, 390.0, 180.0, 160.0, 70.0, 20.0, 350.0, 40.0, 70.0, 70.0, 20.0, 30.0, 80.0, 60.0, 240.0, 410.0, -25.0, 290.0, 10.0, 210.0, 80.0, 180.0, 40.0, 390.0, 70.0, 310.0, 30.0, 20.0, 10.0, 120.0, 20.0, 320.0, 100.0, 190.0, 70.0, 90.0, 0.0, 70.0, 70.0, 520.0, 60.0, 50.0, 90.0, 110.0, 180.0, 210.0, 230.0, 70.0, 190.0, 40.0, 0.0, 190.0, 50.0, -50.0, 260.0, 290.0, 70.0, 370.0, 50.0, 30.0, 90.0, -20.0, 110.0, -380.0, 0.0, 40.0, 10.0, 275.0, 0.0, 170.0, 10.0, 0.0, 70.0, 280.0, 40.0, 510.0, 50.0, 200.0, 30.0, 10.0, 330.0, 50.0, 30.0, 110.0, 10.0, 0.0, 20.0, 220.0, 270.0, 0.0, 40.0, -10.0, 20.0, -15.0, 10.0, 60.0, 50.0, 140.0, 510.0, 330.0, 120.0, 90.0, 350.0, 280.0, 0.0, 170.0, 140.0, 110.0, 40.0, 250.0, 530.0, 490.0, 30.0, 80.0, 30.0, 10.0, 60.0, 50.0, 10.0, 20.0, 210.0, 350.0, 220.0, 30.0, -20.0, 70.0, 350.0, 50.0, 230.0, 570.0, 40.0, 160.0, 40.0, 410.0, 140.0, 110.0, 80.0, 30.0, 170.0, -40.0, 410.0, 180.0, 50.0, 40.0, 10.0, 170.0, 20.0, 100.0, 40.0, 50.0, 10.0, 10.0, 120.0, 180.0, 100.0, 50.0, 130.0, 100.0, 30.0, 160.0, 430.0, 40.0, 10.0, 30.0, 90.0, 30.0, 250.0, 130.0, 230.0, 90.0, 30.0, 420.0, 40.0, 510.0, 60.0, 200.0, 0.0, 450.0, -190.0, 120.0, 190.0, 20.0, 40.0, 60.0, 290.0, 40.0, 50.0, 380.0, 240.0, -100.0, 90.0, 30.0, 80.0, 180.0, 0.0, 50.0, 260.0, 20.0, 10.0, 90.0, 240.0, 20.0, 170.0, 290.0, 590.0, -125.0, 570.0, -10.0, 50.0, -90.0, -100.0, 150.0, 410.0, 40.0, 50.0, 110.0, 280.0, 190.0, 210.0, -30.0, 140.0, 10.0, -20.0, 20.0, 50.0, 0.0, 10.0, 30.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 30.0, 130.0, 230.0, 0.0, 70.0, 60.0, 370.0, 220.0, 130.0, 0.0, 300.0, 30.0, 25.0, 0.0, 90.0, 290.0, 70.0, 0.0, 40.0, 90.0, 90.0, 350.0, 10.0, 30.0, 300.0, 0.0, -810.0, 30.0, 50.0, 20.0, 440.0, 170.0, 50.0, 180.0, 310.0, 380.0, 40.0, 30.0, 170.0, 80.0, 70.0, 20.0, 50.0, 10.0, 360.0, 0.0, 20.0, 0.0, 10.0, 50.0, 260.0, 360.0, -50.0, 10.0, 150.0, 50.0, 380.0, 160.0, 450.0, 190.0, 50.0, 20.0, 20.0, 0.0, 90.0, 30.0, 30.0, 70.0, 40.0, 20.0, 10.0, 30.0, 50.0, 350.0, 20.0, 80.0, 30.0, 90.0, 50.0, 190.0, 240.0, 440.0, 10.0, 120.0, -5.0, 100.0, 60.0, 210.0, 150.0, 430.0, 80.0, 180.0, -210.0, 10.0, 70.0, 10.0, 70.0, 20.0, 220.0, 20.0, 0.0, 70.0, 30.0, 140.0, 40.0, 0.0, 30.0, 90.0, 0.0, 20.0, 50.0, 60.0, 0.0, -40.0, 0.0, 200.0, 140.0, 370.0, 20.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 160.0, 55.0, 20.0, 150.0, 440.0, 30.0, 80.0, 30.0, 70.0, 100.0, 70.0, 80.0, 30.0, 110.0, 20.0, 330.0, 300.0, 80.0, 150.0, 120.0, 140.0, 20.0, 240.0, 80.0, 90.0, 470.0, 170.0, 70.0, 90.0, 50.0, 120.0, 310.0, 0.0, 230.0, 210.0, 100.0, 150.0, 30.0, 200.0, 20.0, 20.0, 120.0, 180.0, 50.0, 10.0, 15.0, 290.0, 200.0, 210.0, 90.0, 90.0, 50.0, 10.0, 670.0, 160.0, 80.0, 120.0, 190.0, -40.0, 110.0, 10.0, -10.0, 60.0, 240.0, 10.0, 100.0, 30.0, 20.0, 180.0, 10.0, 40.0, 480.0, 20.0, 60.0, 160.0, 50.0, 40.0, 10.0, 60.0, 290.0, 370.0, 240.0, 20.0, 0.0, 390.0, -30.0, 10.0, -40.0, -90.0, 230.0, 30.0, 210.0, 610.0, 230.0, 40.0, 110.0, 30.0, 75.0, 100.0, 40.0, 370.0, -100.0, 60.0, 380.0, 70.0, 270.0, 370.0, 250.0, 80.0, 40.0, 40.0, 60.0, 50.0, 60.0, 320.0, 550.0, 20.0, 190.0, 120.0, 20.0, 50.0, 10.0, 380.0, 40.0, 0.0, 210.0, 20.0, 150.0, 50.0, 30.0, 290.0, 0.0, 100.0, 0.0, 20.0, 20.0, -5.0, 0.0, 30.0, 250.0, 100.0, 700.0, 10.0, 50.0, 10.0, 290.0, 20.0, 50.0, -30.0, 290.0, 20.0, -10.0, 480.0, 30.0, -50.0, 20.0, 500.0, 0.0, 110.0, 110.0, 210.0, 30.0, 40.0, 40.0, 10.0, 50.0, 80.0, 440.0, 10.0, 0.0, 10.0, 230.0, 70.0, 170.0, 80.0, 60.0, 120.0, 90.0, 150.0, 150.0, 40.0, 55.0, 660.0, 170.0, 80.0, 40.0, 30.0, 40.0, 0.0, 40.0, 70.0, 0.0, 60.0, 260.0, 270.0, 0.0, 150.0, 170.0, 130.0, 290.0, 10.0, 30.0, 110.0, 40.0, 20.0, 20.0, 170.0, 75.0, 300.0, 280.0, 110.0, 410.0, 210.0, 90.0, 70.0, 100.0, 40.0, 180.0, 80.0, 55.0, 200.0, 80.0, 20.0, 60.0, 340.0, 0.0, 20.0, 70.0, 10.0, 30.0, 290.0, 310.0, 20.0, 440.0, -180.0, 100.0, 70.0, 90.0, 280.0, -60.0, 220.0, 110.0, 210.0, 190.0, 40.0, 320.0, 20.0, 20.0, 240.0, 100.0, 0.0, 90.0, 5.0, 170.0, 40.0, 20.0, 100.0, 430.0, 60.0, 10.0, 0.0, 0.0, 40.0, 30.0, 360.0, 70.0, 100.0, 60.0, 200.0, 30.0, 0.0, 540.0, 0.0, 40.0, 150.0, 100.0, 80.0, 800.0, 90.0, -10.0, 40.0, 190.0, 130.0, 0.0, 190.0, -20.0, -35.0, 300.0, -20.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9197483139050349, "mean_inference_ms": 1.9976394845467766, "mean_action_processing_ms": 0.5238089989413464, "mean_env_wait_ms": 1.6830816479447857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014311790466308594, "StateBufferConnector_ms": 0.013494729995727539, "ViewRequirementAgentConnector_ms": 0.5881438255310059}, "num_episodes": 22, "episode_return_max": 2040.0, "episode_return_min": 100.0, "episode_return_mean": 1111.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.8703156847258756, "num_env_steps_trained_throughput_per_sec": 0.8703156847258756, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 5080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5080000, "timers": {"training_iteration_time_ms": 855825.217, "restore_workers_time_ms": 0.014, "training_step_time_ms": 855825.152, "sample_time_ms": 2901.174, "learn_time_ms": 852897.872, "learn_throughput": 4.69, "synch_weights_time_ms": 15.635}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "done": false, "training_iteration": 127, "trial_id": "3d3a5_00000", "date": "2024-06-01_16-28-07", "timestamp": 1717273687, "time_this_iter_s": 4596.143435001373, "time_total_s": 64501.48887658119, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7fed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64501.48887658119, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 29.874679487179485, "ram_util_percent": 82.08910256410257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.832591508536801, "cur_kl_coeff": 9.362844689105668, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.603833160004296, "policy_loss": -0.0028857847425989465, "vf_loss": 6.6042512674301195, "vf_explained_var": 0.0006418882340541917, "kl": 0.00026356118741707827, "entropy": 0.21752083459283852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1197225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "env_runners": {"episode_reward_max": 2040.0, "episode_reward_min": 100.0, "episode_reward_mean": 1127.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -810.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 112.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1120.0, 1575.0, 940.0, 1420.0, 960.0, 550.0, 1750.0, 660.0, 1030.0, 605.0, 800.0, 1500.0, 950.0, 1280.0, 1170.0, 1980.0, 1870.0, 910.0, 1495.0, 1390.0, 1210.0, 1270.0, 1200.0, 195.0, 1530.0, 680.0, 1645.0, 2040.0, 1040.0, 1520.0, 1540.0, 570.0, 1230.0, 1340.0, 1400.0, 1160.0, 1040.0, 1735.0, 980.0, 160.0, 1280.0, 845.0, 140.0, 1790.0, 620.0, 1820.0, 540.0, 730.0, 1515.0, 880.0, 420.0, 820.0, 100.0, 1135.0, 1290.0, 1420.0, 1370.0, 1185.0, 1440.0, 650.0, 1210.0, 1100.0, 1475.0, 1790.0, 1430.0, 940.0, 705.0, 1490.0, 1210.0, 910.0, 1130.0, 1155.0, 1400.0, 1055.0, 1345.0, 830.0, 1360.0, 1470.0, 925.0, 890.0, 1790.0, 945.0, 1160.0, 460.0, 1720.0, 1175.0, 1115.0, 660.0, 800.0, 1060.0, 1160.0, 290.0, 780.0, 1495.0, 1220.0, 1860.0, 930.0, 1280.0, 1435.0, 120.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 60.0, 90.0, 290.0, 50.0, 10.0, 300.0, 210.0, 60.0, 40.0, 10.0, -30.0, 220.0, 70.0, 30.0, 510.0, 5.0, 200.0, 520.0, 40.0, 240.0, 80.0, 0.0, 150.0, 290.0, 0.0, 0.0, 40.0, 20.0, 120.0, 120.0, 60.0, 130.0, 210.0, 30.0, 80.0, 80.0, 40.0, 170.0, 500.0, -20.0, 60.0, 270.0, -40.0, 40.0, 120.0, 250.0, 40.0, 70.0, 170.0, 10.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 360.0, 0.0, 30.0, 30.0, 50.0, 260.0, 250.0, 120.0, 340.0, 440.0, 50.0, 40.0, 170.0, 120.0, 0.0, 120.0, 50.0, 220.0, 30.0, 20.0, 40.0, 20.0, 40.0, 20.0, 700.0, 90.0, 100.0, 60.0, 10.0, 30.0, 0.0, 0.0, 20.0, 140.0, 10.0, 20.0, 150.0, 70.0, 50.0, 190.0, 50.0, 20.0, -95.0, 60.0, 20.0, 70.0, 20.0, 50.0, 250.0, 280.0, 0.0, 50.0, 0.0, 20.0, 60.0, 560.0, 30.0, 30.0, 150.0, 10.0, 550.0, -10.0, 100.0, 30.0, 150.0, 40.0, 330.0, 20.0, 30.0, 10.0, 140.0, 190.0, 10.0, 210.0, -50.0, 110.0, 0.0, 160.0, 170.0, 330.0, 20.0, 20.0, 310.0, -30.0, -30.0, 220.0, 30.0, 50.0, 10.0, -60.0, 360.0, 600.0, 20.0, 50.0, 50.0, 160.0, 140.0, 320.0, 80.0, 780.0, 20.0, 300.0, 80.0, 30.0, 60.0, 780.0, 290.0, -10.0, 30.0, 60.0, 60.0, 390.0, 180.0, 160.0, 70.0, 20.0, 350.0, 40.0, 70.0, 70.0, 20.0, 30.0, 80.0, 60.0, 240.0, 410.0, -25.0, 290.0, 10.0, 210.0, 80.0, 180.0, 40.0, 390.0, 70.0, 310.0, 30.0, 20.0, 10.0, 120.0, 20.0, 320.0, 100.0, 190.0, 70.0, 90.0, 0.0, 70.0, 70.0, 520.0, 60.0, 50.0, 90.0, 110.0, 180.0, 210.0, 230.0, 70.0, 190.0, 40.0, 0.0, 190.0, 50.0, -50.0, 260.0, 290.0, 70.0, 370.0, 50.0, 30.0, 90.0, -20.0, 110.0, -380.0, 0.0, 40.0, 10.0, 275.0, 0.0, 170.0, 10.0, 0.0, 70.0, 280.0, 40.0, 510.0, 50.0, 200.0, 30.0, 10.0, 330.0, 50.0, 30.0, 110.0, 10.0, 0.0, 20.0, 220.0, 270.0, 0.0, 40.0, -10.0, 20.0, -15.0, 10.0, 60.0, 50.0, 140.0, 510.0, 330.0, 120.0, 90.0, 350.0, 280.0, 0.0, 170.0, 140.0, 110.0, 40.0, 250.0, 530.0, 490.0, 30.0, 80.0, 30.0, 10.0, 60.0, 50.0, 10.0, 20.0, 210.0, 350.0, 220.0, 30.0, -20.0, 70.0, 350.0, 50.0, 230.0, 570.0, 40.0, 160.0, 40.0, 410.0, 140.0, 110.0, 80.0, 30.0, 170.0, -40.0, 410.0, 180.0, 50.0, 40.0, 10.0, 170.0, 20.0, 100.0, 40.0, 50.0, 10.0, 10.0, 120.0, 180.0, 100.0, 50.0, 130.0, 100.0, 30.0, 160.0, 430.0, 40.0, 10.0, 30.0, 90.0, 30.0, 250.0, 130.0, 230.0, 90.0, 30.0, 420.0, 40.0, 510.0, 60.0, 200.0, 0.0, 450.0, -190.0, 120.0, 190.0, 20.0, 40.0, 60.0, 290.0, 40.0, 50.0, 380.0, 240.0, -100.0, 90.0, 30.0, 80.0, 180.0, 0.0, 50.0, 260.0, 20.0, 10.0, 90.0, 240.0, 20.0, 170.0, 290.0, 590.0, -125.0, 570.0, -10.0, 50.0, -90.0, -100.0, 150.0, 410.0, 40.0, 50.0, 110.0, 280.0, 190.0, 210.0, -30.0, 140.0, 10.0, -20.0, 20.0, 50.0, 0.0, 10.0, 30.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 30.0, 130.0, 230.0, 0.0, 70.0, 60.0, 370.0, 220.0, 130.0, 0.0, 300.0, 30.0, 25.0, 0.0, 90.0, 290.0, 70.0, 0.0, 40.0, 90.0, 90.0, 350.0, 10.0, 30.0, 300.0, 0.0, -810.0, 30.0, 50.0, 20.0, 440.0, 170.0, 50.0, 180.0, 310.0, 380.0, 40.0, 30.0, 170.0, 80.0, 70.0, 20.0, 50.0, 10.0, 360.0, 0.0, 20.0, 0.0, 10.0, 50.0, 260.0, 360.0, -50.0, 10.0, 150.0, 50.0, 380.0, 160.0, 450.0, 190.0, 50.0, 20.0, 20.0, 0.0, 90.0, 30.0, 30.0, 70.0, 40.0, 20.0, 10.0, 30.0, 50.0, 350.0, 20.0, 80.0, 30.0, 90.0, 50.0, 190.0, 240.0, 440.0, 10.0, 120.0, -5.0, 100.0, 60.0, 210.0, 150.0, 430.0, 80.0, 180.0, -210.0, 10.0, 70.0, 10.0, 70.0, 20.0, 220.0, 20.0, 0.0, 70.0, 30.0, 140.0, 40.0, 0.0, 30.0, 90.0, 0.0, 20.0, 50.0, 60.0, 0.0, -40.0, 0.0, 200.0, 140.0, 370.0, 20.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 160.0, 55.0, 20.0, 150.0, 440.0, 30.0, 80.0, 30.0, 70.0, 100.0, 70.0, 80.0, 30.0, 110.0, 20.0, 330.0, 300.0, 80.0, 150.0, 120.0, 140.0, 20.0, 240.0, 80.0, 90.0, 470.0, 170.0, 70.0, 90.0, 50.0, 120.0, 310.0, 0.0, 230.0, 210.0, 100.0, 150.0, 30.0, 200.0, 20.0, 20.0, 120.0, 180.0, 50.0, 10.0, 15.0, 290.0, 200.0, 210.0, 90.0, 90.0, 50.0, 10.0, 670.0, 160.0, 80.0, 120.0, 190.0, -40.0, 110.0, 10.0, -10.0, 60.0, 240.0, 10.0, 100.0, 30.0, 20.0, 180.0, 10.0, 40.0, 480.0, 20.0, 60.0, 160.0, 50.0, 40.0, 10.0, 60.0, 290.0, 370.0, 240.0, 20.0, 0.0, 390.0, -30.0, 10.0, -40.0, -90.0, 230.0, 30.0, 210.0, 610.0, 230.0, 40.0, 110.0, 30.0, 75.0, 100.0, 40.0, 370.0, -100.0, 60.0, 380.0, 70.0, 270.0, 370.0, 250.0, 80.0, 40.0, 40.0, 60.0, 50.0, 60.0, 320.0, 550.0, 20.0, 190.0, 120.0, 20.0, 50.0, 10.0, 380.0, 40.0, 0.0, 210.0, 20.0, 150.0, 50.0, 30.0, 290.0, 0.0, 100.0, 0.0, 20.0, 20.0, -5.0, 0.0, 30.0, 250.0, 100.0, 700.0, 10.0, 50.0, 10.0, 290.0, 20.0, 50.0, -30.0, 290.0, 20.0, -10.0, 480.0, 30.0, -50.0, 20.0, 500.0, 0.0, 110.0, 110.0, 210.0, 30.0, 40.0, 40.0, 10.0, 50.0, 80.0, 440.0, 10.0, 0.0, 10.0, 230.0, 70.0, 170.0, 80.0, 60.0, 120.0, 90.0, 150.0, 150.0, 40.0, 55.0, 660.0, 170.0, 80.0, 40.0, 30.0, 40.0, 0.0, 40.0, 70.0, 0.0, 60.0, 260.0, 270.0, 0.0, 150.0, 170.0, 130.0, 290.0, 10.0, 30.0, 110.0, 40.0, 20.0, 20.0, 170.0, 75.0, 300.0, 280.0, 110.0, 410.0, 210.0, 90.0, 70.0, 100.0, 40.0, 180.0, 80.0, 55.0, 200.0, 80.0, 20.0, 60.0, 340.0, 0.0, 20.0, 70.0, 10.0, 30.0, 290.0, 310.0, 20.0, 440.0, -180.0, 100.0, 70.0, 90.0, 280.0, -60.0, 220.0, 110.0, 210.0, 190.0, 40.0, 320.0, 20.0, 20.0, 240.0, 100.0, 0.0, 90.0, 5.0, 170.0, 40.0, 20.0, 100.0, 430.0, 60.0, 10.0, 0.0, 0.0, 40.0, 30.0, 360.0, 70.0, 100.0, 60.0, 200.0, 30.0, 0.0, 540.0, 0.0, 40.0, 150.0, 100.0, 80.0, 800.0, 90.0, -10.0, 40.0, 190.0, 130.0, 0.0, 190.0, -20.0, -35.0, 300.0, -20.0, 170.0, 90.0, 210.0, 10.0, 10.0, 80.0, 320.0, 190.0, 30.0, 60.0, 160.0, 10.0, 10.0, 50.0, 180.0, 0.0, 20.0, 20.0, 20.0, 90.0, 60.0, 80.0, 30.0, 180.0, 620.0, 180.0, 50.0, 450.0, 60.0, -50.0, 120.0, 80.0, 20.0, 530.0, 130.0, 170.0, 50.0, -155.0, 210.0, 70.0, 70.0, 40.0, 20.0, 50.0, 70.0, 40.0, 50.0, 45.0, 310.0, 20.0, 470.0, 40.0, 30.0, 20.0, 120.0, 30.0, 40.0, 300.0, 60.0, 20.0, 0.0, 0.0, 0.0, 20.0, 170.0, 30.0, 80.0, 210.0, 210.0, 10.0, 70.0, 40.0, 30.0, 60.0, 50.0, 30.0, 250.0, 20.0, 130.0, 380.0, 70.0, 140.0, 350.0, 60.0, 100.0, 50.0, 40.0, 40.0, 40.0, 320.0, 20.0, 40.0, 40.0, 0.0, 40.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 40.0, 100.0, 210.0, 40.0, 40.0, 30.0, 0.0, 180.0, 100.0, 40.0, 190.0, 70.0, 220.0, -40.0, 70.0, 0.0, 750.0, 110.0, 95.0, 30.0, 160.0, 180.0, 20.0, 30.0, 330.0, 190.0, 80.0, 130.0, -20.0, 120.0, 120.0, 70.0, 90.0, 50.0, 160.0, 70.0, 560.0, 140.0, 380.0, 220.0, 150.0, 70.0, 40.0, 50.0, 0.0, 170.0, 110.0, 10.0, 270.0, 60.0, 430.0, 60.0, 110.0, 40.0, 40.0, 90.0, 80.0, 210.0, 10.0, 210.0, 120.0, 270.0, 700.0, 20.0, 90.0, 110.0, 50.0, 20.0, -15.0, 70.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9183774870345036, "mean_inference_ms": 1.9978902188117331, "mean_action_processing_ms": 0.5238570115572735, "mean_env_wait_ms": 1.6828236313679015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01416778564453125, "StateBufferConnector_ms": 0.013400793075561523, "ViewRequirementAgentConnector_ms": 0.5814931392669678}, "num_episodes": 18, "episode_return_max": 2040.0, "episode_return_min": 100.0, "episode_return_mean": 1127.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.7286700770838777, "num_env_steps_trained_throughput_per_sec": 1.7286700770838777, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 5120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5120000, "timers": {"training_iteration_time_ms": 1066694.5, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1066694.444, "sample_time_ms": 2993.525, "learn_time_ms": 1063674.502, "learn_throughput": 3.761, "synch_weights_time_ms": 15.511}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "done": false, "training_iteration": 128, "trial_id": "3d3a5_00000", "date": "2024-06-01_17-06-41", "timestamp": 1717276001, "time_this_iter_s": 2313.956059217453, "time_total_s": 66815.44493579865, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dc040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 66815.44493579865, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 24.999331103678927, "ram_util_percent": 82.23545150501673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.431226217816559, "cur_kl_coeff": 4.681422344552834, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0035843165609955835, "vf_loss": 6.048758767689633, "vf_explained_var": 0.0004267279713298566, "kl": Infinity, "entropy": 0.22940056340033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1206615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "env_runners": {"episode_reward_max": 2040.0, "episode_reward_min": 100.0, "episode_reward_mean": 1096.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -810.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 109.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1495.0, 1390.0, 1210.0, 1270.0, 1200.0, 195.0, 1530.0, 680.0, 1645.0, 2040.0, 1040.0, 1520.0, 1540.0, 570.0, 1230.0, 1340.0, 1400.0, 1160.0, 1040.0, 1735.0, 980.0, 160.0, 1280.0, 845.0, 140.0, 1790.0, 620.0, 1820.0, 540.0, 730.0, 1515.0, 880.0, 420.0, 820.0, 100.0, 1135.0, 1290.0, 1420.0, 1370.0, 1185.0, 1440.0, 650.0, 1210.0, 1100.0, 1475.0, 1790.0, 1430.0, 940.0, 705.0, 1490.0, 1210.0, 910.0, 1130.0, 1155.0, 1400.0, 1055.0, 1345.0, 830.0, 1360.0, 1470.0, 925.0, 890.0, 1790.0, 945.0, 1160.0, 460.0, 1720.0, 1175.0, 1115.0, 660.0, 800.0, 1060.0, 1160.0, 290.0, 780.0, 1495.0, 1220.0, 1860.0, 930.0, 1280.0, 1435.0, 120.0, 1515.0, 650.0, 865.0, 1580.0, 1420.0, 150.0, 1525.0, 1340.0, 1170.0, 370.0, 1460.0, 580.0, 120.0, 350.0, 1670.0, 1210.0, 870.0, 1130.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 240.0, 410.0, -25.0, 290.0, 10.0, 210.0, 80.0, 180.0, 40.0, 390.0, 70.0, 310.0, 30.0, 20.0, 10.0, 120.0, 20.0, 320.0, 100.0, 190.0, 70.0, 90.0, 0.0, 70.0, 70.0, 520.0, 60.0, 50.0, 90.0, 110.0, 180.0, 210.0, 230.0, 70.0, 190.0, 40.0, 0.0, 190.0, 50.0, -50.0, 260.0, 290.0, 70.0, 370.0, 50.0, 30.0, 90.0, -20.0, 110.0, -380.0, 0.0, 40.0, 10.0, 275.0, 0.0, 170.0, 10.0, 0.0, 70.0, 280.0, 40.0, 510.0, 50.0, 200.0, 30.0, 10.0, 330.0, 50.0, 30.0, 110.0, 10.0, 0.0, 20.0, 220.0, 270.0, 0.0, 40.0, -10.0, 20.0, -15.0, 10.0, 60.0, 50.0, 140.0, 510.0, 330.0, 120.0, 90.0, 350.0, 280.0, 0.0, 170.0, 140.0, 110.0, 40.0, 250.0, 530.0, 490.0, 30.0, 80.0, 30.0, 10.0, 60.0, 50.0, 10.0, 20.0, 210.0, 350.0, 220.0, 30.0, -20.0, 70.0, 350.0, 50.0, 230.0, 570.0, 40.0, 160.0, 40.0, 410.0, 140.0, 110.0, 80.0, 30.0, 170.0, -40.0, 410.0, 180.0, 50.0, 40.0, 10.0, 170.0, 20.0, 100.0, 40.0, 50.0, 10.0, 10.0, 120.0, 180.0, 100.0, 50.0, 130.0, 100.0, 30.0, 160.0, 430.0, 40.0, 10.0, 30.0, 90.0, 30.0, 250.0, 130.0, 230.0, 90.0, 30.0, 420.0, 40.0, 510.0, 60.0, 200.0, 0.0, 450.0, -190.0, 120.0, 190.0, 20.0, 40.0, 60.0, 290.0, 40.0, 50.0, 380.0, 240.0, -100.0, 90.0, 30.0, 80.0, 180.0, 0.0, 50.0, 260.0, 20.0, 10.0, 90.0, 240.0, 20.0, 170.0, 290.0, 590.0, -125.0, 570.0, -10.0, 50.0, -90.0, -100.0, 150.0, 410.0, 40.0, 50.0, 110.0, 280.0, 190.0, 210.0, -30.0, 140.0, 10.0, -20.0, 20.0, 50.0, 0.0, 10.0, 30.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 30.0, 130.0, 230.0, 0.0, 70.0, 60.0, 370.0, 220.0, 130.0, 0.0, 300.0, 30.0, 25.0, 0.0, 90.0, 290.0, 70.0, 0.0, 40.0, 90.0, 90.0, 350.0, 10.0, 30.0, 300.0, 0.0, -810.0, 30.0, 50.0, 20.0, 440.0, 170.0, 50.0, 180.0, 310.0, 380.0, 40.0, 30.0, 170.0, 80.0, 70.0, 20.0, 50.0, 10.0, 360.0, 0.0, 20.0, 0.0, 10.0, 50.0, 260.0, 360.0, -50.0, 10.0, 150.0, 50.0, 380.0, 160.0, 450.0, 190.0, 50.0, 20.0, 20.0, 0.0, 90.0, 30.0, 30.0, 70.0, 40.0, 20.0, 10.0, 30.0, 50.0, 350.0, 20.0, 80.0, 30.0, 90.0, 50.0, 190.0, 240.0, 440.0, 10.0, 120.0, -5.0, 100.0, 60.0, 210.0, 150.0, 430.0, 80.0, 180.0, -210.0, 10.0, 70.0, 10.0, 70.0, 20.0, 220.0, 20.0, 0.0, 70.0, 30.0, 140.0, 40.0, 0.0, 30.0, 90.0, 0.0, 20.0, 50.0, 60.0, 0.0, -40.0, 0.0, 200.0, 140.0, 370.0, 20.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 160.0, 55.0, 20.0, 150.0, 440.0, 30.0, 80.0, 30.0, 70.0, 100.0, 70.0, 80.0, 30.0, 110.0, 20.0, 330.0, 300.0, 80.0, 150.0, 120.0, 140.0, 20.0, 240.0, 80.0, 90.0, 470.0, 170.0, 70.0, 90.0, 50.0, 120.0, 310.0, 0.0, 230.0, 210.0, 100.0, 150.0, 30.0, 200.0, 20.0, 20.0, 120.0, 180.0, 50.0, 10.0, 15.0, 290.0, 200.0, 210.0, 90.0, 90.0, 50.0, 10.0, 670.0, 160.0, 80.0, 120.0, 190.0, -40.0, 110.0, 10.0, -10.0, 60.0, 240.0, 10.0, 100.0, 30.0, 20.0, 180.0, 10.0, 40.0, 480.0, 20.0, 60.0, 160.0, 50.0, 40.0, 10.0, 60.0, 290.0, 370.0, 240.0, 20.0, 0.0, 390.0, -30.0, 10.0, -40.0, -90.0, 230.0, 30.0, 210.0, 610.0, 230.0, 40.0, 110.0, 30.0, 75.0, 100.0, 40.0, 370.0, -100.0, 60.0, 380.0, 70.0, 270.0, 370.0, 250.0, 80.0, 40.0, 40.0, 60.0, 50.0, 60.0, 320.0, 550.0, 20.0, 190.0, 120.0, 20.0, 50.0, 10.0, 380.0, 40.0, 0.0, 210.0, 20.0, 150.0, 50.0, 30.0, 290.0, 0.0, 100.0, 0.0, 20.0, 20.0, -5.0, 0.0, 30.0, 250.0, 100.0, 700.0, 10.0, 50.0, 10.0, 290.0, 20.0, 50.0, -30.0, 290.0, 20.0, -10.0, 480.0, 30.0, -50.0, 20.0, 500.0, 0.0, 110.0, 110.0, 210.0, 30.0, 40.0, 40.0, 10.0, 50.0, 80.0, 440.0, 10.0, 0.0, 10.0, 230.0, 70.0, 170.0, 80.0, 60.0, 120.0, 90.0, 150.0, 150.0, 40.0, 55.0, 660.0, 170.0, 80.0, 40.0, 30.0, 40.0, 0.0, 40.0, 70.0, 0.0, 60.0, 260.0, 270.0, 0.0, 150.0, 170.0, 130.0, 290.0, 10.0, 30.0, 110.0, 40.0, 20.0, 20.0, 170.0, 75.0, 300.0, 280.0, 110.0, 410.0, 210.0, 90.0, 70.0, 100.0, 40.0, 180.0, 80.0, 55.0, 200.0, 80.0, 20.0, 60.0, 340.0, 0.0, 20.0, 70.0, 10.0, 30.0, 290.0, 310.0, 20.0, 440.0, -180.0, 100.0, 70.0, 90.0, 280.0, -60.0, 220.0, 110.0, 210.0, 190.0, 40.0, 320.0, 20.0, 20.0, 240.0, 100.0, 0.0, 90.0, 5.0, 170.0, 40.0, 20.0, 100.0, 430.0, 60.0, 10.0, 0.0, 0.0, 40.0, 30.0, 360.0, 70.0, 100.0, 60.0, 200.0, 30.0, 0.0, 540.0, 0.0, 40.0, 150.0, 100.0, 80.0, 800.0, 90.0, -10.0, 40.0, 190.0, 130.0, 0.0, 190.0, -20.0, -35.0, 300.0, -20.0, 170.0, 90.0, 210.0, 10.0, 10.0, 80.0, 320.0, 190.0, 30.0, 60.0, 160.0, 10.0, 10.0, 50.0, 180.0, 0.0, 20.0, 20.0, 20.0, 90.0, 60.0, 80.0, 30.0, 180.0, 620.0, 180.0, 50.0, 450.0, 60.0, -50.0, 120.0, 80.0, 20.0, 530.0, 130.0, 170.0, 50.0, -155.0, 210.0, 70.0, 70.0, 40.0, 20.0, 50.0, 70.0, 40.0, 50.0, 45.0, 310.0, 20.0, 470.0, 40.0, 30.0, 20.0, 120.0, 30.0, 40.0, 300.0, 60.0, 20.0, 0.0, 0.0, 0.0, 20.0, 170.0, 30.0, 80.0, 210.0, 210.0, 10.0, 70.0, 40.0, 30.0, 60.0, 50.0, 30.0, 250.0, 20.0, 130.0, 380.0, 70.0, 140.0, 350.0, 60.0, 100.0, 50.0, 40.0, 40.0, 40.0, 320.0, 20.0, 40.0, 40.0, 0.0, 40.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 40.0, 100.0, 210.0, 40.0, 40.0, 30.0, 0.0, 180.0, 100.0, 40.0, 190.0, 70.0, 220.0, -40.0, 70.0, 0.0, 750.0, 110.0, 95.0, 30.0, 160.0, 180.0, 20.0, 30.0, 330.0, 190.0, 80.0, 130.0, -20.0, 120.0, 120.0, 70.0, 90.0, 50.0, 160.0, 70.0, 560.0, 140.0, 380.0, 220.0, 150.0, 70.0, 40.0, 50.0, 0.0, 170.0, 110.0, 10.0, 270.0, 60.0, 430.0, 60.0, 110.0, 40.0, 40.0, 90.0, 80.0, 210.0, 10.0, 210.0, 120.0, 270.0, 700.0, 20.0, 90.0, 110.0, 50.0, 20.0, -15.0, 70.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 0.0, 920.0, 10.0, 30.0, 60.0, 40.0, 140.0, 65.0, 10.0, 40.0, 200.0, 120.0, 0.0, 190.0, 110.0, 40.0, 10.0, 90.0, 20.0, 30.0, 40.0, 0.0, 40.0, 260.0, 370.0, 70.0, -15.0, -30.0, 10.0, 60.0, 100.0, 50.0, 90.0, 350.0, 160.0, 70.0, 100.0, 30.0, 40.0, 500.0, 190.0, 210.0, 30.0, 300.0, 210.0, 0.0, 80.0, 170.0, 290.0, 90.0, 40.0, 60.0, 10.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 60.0, 470.0, -40.0, 10.0, 460.0, 10.0, 60.0, 290.0, 220.0, 80.0, 370.0, 120.0, 20.0, 140.0, 60.0, 150.0, 60.0, 220.0, 120.0, 240.0, 610.0, 70.0, 80.0, 100.0, 0.0, -50.0, 70.0, 30.0, 20.0, 20.0, 0.0, 0.0, 80.0, 30.0, 50.0, 20.0, 110.0, 20.0, 40.0, 70.0, 180.0, 20.0, 30.0, 70.0, 400.0, 10.0, 600.0, 40.0, 40.0, 20.0, 10.0, -30.0, 0.0, 0.0, 440.0, 20.0, 50.0, 10.0, 60.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 160.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 350.0, 90.0, 50.0, 270.0, 50.0, 230.0, 150.0, -70.0, 180.0, 370.0, 200.0, 250.0, 80.0, 50.0, 30.0, 40.0, 380.0, 130.0, 40.0, 10.0, 90.0, 70.0, 50.0, 290.0, 50.0, 100.0, 60.0, 10.0, 80.0, 70.0, 40.0, 70.0, 330.0, 60.0, 0.0, 250.0, 30.0, 10.0, 270.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9174643610947009, "mean_inference_ms": 1.9985236516425045, "mean_action_processing_ms": 0.5239837288115642, "mean_env_wait_ms": 1.6828846031999873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014516115188598633, "StateBufferConnector_ms": 0.0190737247467041, "ViewRequirementAgentConnector_ms": 0.5904200077056885}, "num_episodes": 18, "episode_return_max": 2040.0, "episode_return_min": 100.0, "episode_return_mean": 1096.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.279550967056883, "num_env_steps_trained_throughput_per_sec": 14.279550967056883, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 5160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5160000, "timers": {"training_iteration_time_ms": 1074077.562, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1074077.506, "sample_time_ms": 3030.122, "learn_time_ms": 1071021.295, "learn_throughput": 3.735, "synch_weights_time_ms": 15.025}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "done": false, "training_iteration": 129, "trial_id": "3d3a5_00000", "date": "2024-06-01_17-11-21", "timestamp": 1717276281, "time_this_iter_s": 280.1411249637604, "time_total_s": 67095.5860607624, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118023040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 67095.5860607624, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 18.22801418439716, "ram_util_percent": 79.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.60550221675755, "cur_kl_coeff": 7.022133516829253, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0032675729448340745, "vf_loss": 7.678159841206381, "vf_explained_var": 0.0005370778905443998, "kl": Infinity, "entropy": 0.21445350088377477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1216005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "env_runners": {"episode_reward_max": 2100.0, "episode_reward_min": 100.0, "episode_reward_mean": 1078.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -810.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 107.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [845.0, 140.0, 1790.0, 620.0, 1820.0, 540.0, 730.0, 1515.0, 880.0, 420.0, 820.0, 100.0, 1135.0, 1290.0, 1420.0, 1370.0, 1185.0, 1440.0, 650.0, 1210.0, 1100.0, 1475.0, 1790.0, 1430.0, 940.0, 705.0, 1490.0, 1210.0, 910.0, 1130.0, 1155.0, 1400.0, 1055.0, 1345.0, 830.0, 1360.0, 1470.0, 925.0, 890.0, 1790.0, 945.0, 1160.0, 460.0, 1720.0, 1175.0, 1115.0, 660.0, 800.0, 1060.0, 1160.0, 290.0, 780.0, 1495.0, 1220.0, 1860.0, 930.0, 1280.0, 1435.0, 120.0, 1515.0, 650.0, 865.0, 1580.0, 1420.0, 150.0, 1525.0, 1340.0, 1170.0, 370.0, 1460.0, 580.0, 120.0, 350.0, 1670.0, 1210.0, 870.0, 1130.0, 450.0, 660.0, 1520.0, 1600.0, 920.0, 2100.0, 730.0, 1410.0, 1390.0, 875.0, 1350.0, 425.0, 1080.0, 1100.0, 1360.0, 1750.0, 1150.0, 400.0, 1460.0, 890.0, 820.0, 1015.0, 1460.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 300.0, 30.0, 25.0, 0.0, 90.0, 290.0, 70.0, 0.0, 40.0, 90.0, 90.0, 350.0, 10.0, 30.0, 300.0, 0.0, -810.0, 30.0, 50.0, 20.0, 440.0, 170.0, 50.0, 180.0, 310.0, 380.0, 40.0, 30.0, 170.0, 80.0, 70.0, 20.0, 50.0, 10.0, 360.0, 0.0, 20.0, 0.0, 10.0, 50.0, 260.0, 360.0, -50.0, 10.0, 150.0, 50.0, 380.0, 160.0, 450.0, 190.0, 50.0, 20.0, 20.0, 0.0, 90.0, 30.0, 30.0, 70.0, 40.0, 20.0, 10.0, 30.0, 50.0, 350.0, 20.0, 80.0, 30.0, 90.0, 50.0, 190.0, 240.0, 440.0, 10.0, 120.0, -5.0, 100.0, 60.0, 210.0, 150.0, 430.0, 80.0, 180.0, -210.0, 10.0, 70.0, 10.0, 70.0, 20.0, 220.0, 20.0, 0.0, 70.0, 30.0, 140.0, 40.0, 0.0, 30.0, 90.0, 0.0, 20.0, 50.0, 60.0, 0.0, -40.0, 0.0, 200.0, 140.0, 370.0, 20.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 160.0, 55.0, 20.0, 150.0, 440.0, 30.0, 80.0, 30.0, 70.0, 100.0, 70.0, 80.0, 30.0, 110.0, 20.0, 330.0, 300.0, 80.0, 150.0, 120.0, 140.0, 20.0, 240.0, 80.0, 90.0, 470.0, 170.0, 70.0, 90.0, 50.0, 120.0, 310.0, 0.0, 230.0, 210.0, 100.0, 150.0, 30.0, 200.0, 20.0, 20.0, 120.0, 180.0, 50.0, 10.0, 15.0, 290.0, 200.0, 210.0, 90.0, 90.0, 50.0, 10.0, 670.0, 160.0, 80.0, 120.0, 190.0, -40.0, 110.0, 10.0, -10.0, 60.0, 240.0, 10.0, 100.0, 30.0, 20.0, 180.0, 10.0, 40.0, 480.0, 20.0, 60.0, 160.0, 50.0, 40.0, 10.0, 60.0, 290.0, 370.0, 240.0, 20.0, 0.0, 390.0, -30.0, 10.0, -40.0, -90.0, 230.0, 30.0, 210.0, 610.0, 230.0, 40.0, 110.0, 30.0, 75.0, 100.0, 40.0, 370.0, -100.0, 60.0, 380.0, 70.0, 270.0, 370.0, 250.0, 80.0, 40.0, 40.0, 60.0, 50.0, 60.0, 320.0, 550.0, 20.0, 190.0, 120.0, 20.0, 50.0, 10.0, 380.0, 40.0, 0.0, 210.0, 20.0, 150.0, 50.0, 30.0, 290.0, 0.0, 100.0, 0.0, 20.0, 20.0, -5.0, 0.0, 30.0, 250.0, 100.0, 700.0, 10.0, 50.0, 10.0, 290.0, 20.0, 50.0, -30.0, 290.0, 20.0, -10.0, 480.0, 30.0, -50.0, 20.0, 500.0, 0.0, 110.0, 110.0, 210.0, 30.0, 40.0, 40.0, 10.0, 50.0, 80.0, 440.0, 10.0, 0.0, 10.0, 230.0, 70.0, 170.0, 80.0, 60.0, 120.0, 90.0, 150.0, 150.0, 40.0, 55.0, 660.0, 170.0, 80.0, 40.0, 30.0, 40.0, 0.0, 40.0, 70.0, 0.0, 60.0, 260.0, 270.0, 0.0, 150.0, 170.0, 130.0, 290.0, 10.0, 30.0, 110.0, 40.0, 20.0, 20.0, 170.0, 75.0, 300.0, 280.0, 110.0, 410.0, 210.0, 90.0, 70.0, 100.0, 40.0, 180.0, 80.0, 55.0, 200.0, 80.0, 20.0, 60.0, 340.0, 0.0, 20.0, 70.0, 10.0, 30.0, 290.0, 310.0, 20.0, 440.0, -180.0, 100.0, 70.0, 90.0, 280.0, -60.0, 220.0, 110.0, 210.0, 190.0, 40.0, 320.0, 20.0, 20.0, 240.0, 100.0, 0.0, 90.0, 5.0, 170.0, 40.0, 20.0, 100.0, 430.0, 60.0, 10.0, 0.0, 0.0, 40.0, 30.0, 360.0, 70.0, 100.0, 60.0, 200.0, 30.0, 0.0, 540.0, 0.0, 40.0, 150.0, 100.0, 80.0, 800.0, 90.0, -10.0, 40.0, 190.0, 130.0, 0.0, 190.0, -20.0, -35.0, 300.0, -20.0, 170.0, 90.0, 210.0, 10.0, 10.0, 80.0, 320.0, 190.0, 30.0, 60.0, 160.0, 10.0, 10.0, 50.0, 180.0, 0.0, 20.0, 20.0, 20.0, 90.0, 60.0, 80.0, 30.0, 180.0, 620.0, 180.0, 50.0, 450.0, 60.0, -50.0, 120.0, 80.0, 20.0, 530.0, 130.0, 170.0, 50.0, -155.0, 210.0, 70.0, 70.0, 40.0, 20.0, 50.0, 70.0, 40.0, 50.0, 45.0, 310.0, 20.0, 470.0, 40.0, 30.0, 20.0, 120.0, 30.0, 40.0, 300.0, 60.0, 20.0, 0.0, 0.0, 0.0, 20.0, 170.0, 30.0, 80.0, 210.0, 210.0, 10.0, 70.0, 40.0, 30.0, 60.0, 50.0, 30.0, 250.0, 20.0, 130.0, 380.0, 70.0, 140.0, 350.0, 60.0, 100.0, 50.0, 40.0, 40.0, 40.0, 320.0, 20.0, 40.0, 40.0, 0.0, 40.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 40.0, 100.0, 210.0, 40.0, 40.0, 30.0, 0.0, 180.0, 100.0, 40.0, 190.0, 70.0, 220.0, -40.0, 70.0, 0.0, 750.0, 110.0, 95.0, 30.0, 160.0, 180.0, 20.0, 30.0, 330.0, 190.0, 80.0, 130.0, -20.0, 120.0, 120.0, 70.0, 90.0, 50.0, 160.0, 70.0, 560.0, 140.0, 380.0, 220.0, 150.0, 70.0, 40.0, 50.0, 0.0, 170.0, 110.0, 10.0, 270.0, 60.0, 430.0, 60.0, 110.0, 40.0, 40.0, 90.0, 80.0, 210.0, 10.0, 210.0, 120.0, 270.0, 700.0, 20.0, 90.0, 110.0, 50.0, 20.0, -15.0, 70.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 0.0, 920.0, 10.0, 30.0, 60.0, 40.0, 140.0, 65.0, 10.0, 40.0, 200.0, 120.0, 0.0, 190.0, 110.0, 40.0, 10.0, 90.0, 20.0, 30.0, 40.0, 0.0, 40.0, 260.0, 370.0, 70.0, -15.0, -30.0, 10.0, 60.0, 100.0, 50.0, 90.0, 350.0, 160.0, 70.0, 100.0, 30.0, 40.0, 500.0, 190.0, 210.0, 30.0, 300.0, 210.0, 0.0, 80.0, 170.0, 290.0, 90.0, 40.0, 60.0, 10.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 60.0, 470.0, -40.0, 10.0, 460.0, 10.0, 60.0, 290.0, 220.0, 80.0, 370.0, 120.0, 20.0, 140.0, 60.0, 150.0, 60.0, 220.0, 120.0, 240.0, 610.0, 70.0, 80.0, 100.0, 0.0, -50.0, 70.0, 30.0, 20.0, 20.0, 0.0, 0.0, 80.0, 30.0, 50.0, 20.0, 110.0, 20.0, 40.0, 70.0, 180.0, 20.0, 30.0, 70.0, 400.0, 10.0, 600.0, 40.0, 40.0, 20.0, 10.0, -30.0, 0.0, 0.0, 440.0, 20.0, 50.0, 10.0, 60.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 160.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 350.0, 90.0, 50.0, 270.0, 50.0, 230.0, 150.0, -70.0, 180.0, 370.0, 200.0, 250.0, 80.0, 50.0, 30.0, 40.0, 380.0, 130.0, 40.0, 10.0, 90.0, 70.0, 50.0, 290.0, 50.0, 100.0, 60.0, 10.0, 80.0, 70.0, 40.0, 70.0, 330.0, 60.0, 0.0, 250.0, 30.0, 10.0, 270.0, 70.0, 100.0, 30.0, 10.0, 0.0, 70.0, 20.0, 20.0, 0.0, 20.0, 180.0, 30.0, 100.0, 10.0, 40.0, 160.0, 0.0, 90.0, 130.0, 40.0, 60.0, 90.0, 200.0, 580.0, 70.0, 50.0, 30.0, 130.0, 230.0, -60.0, 200.0, 40.0, 250.0, -40.0, 360.0, 220.0, 200.0, 170.0, 290.0, 20.0, 90.0, 110.0, 20.0, 20.0, 100.0, 70.0, 500.0, 40.0, 60.0, 0.0, 0.0, 110.0, 360.0, 430.0, 90.0, 130.0, -30.0, 480.0, 400.0, 110.0, 20.0, 10.0, 0.0, 350.0, 30.0, 40.0, 0.0, 0.0, 210.0, 20.0, 70.0, 50.0, 60.0, 60.0, 330.0, 400.0, 50.0, 350.0, 40.0, 70.0, 0.0, 100.0, 90.0, 80.0, 0.0, 0.0, 230.0, 600.0, 60.0, 50.0, 180.0, 190.0, 10.0, 30.0, 35.0, 370.0, 20.0, 40.0, 100.0, 30.0, 50.0, 60.0, 30.0, 50.0, 0.0, 160.0, 240.0, 50.0, 20.0, 650.0, 90.0, 10.0, 10.0, 40.0, 0.0, 240.0, 30.0, 100.0, 30.0, -65.0, 30.0, 40.0, 10.0, 40.0, 260.0, -60.0, 40.0, 290.0, 30.0, 400.0, 30.0, 360.0, 150.0, 70.0, 10.0, 220.0, 50.0, 10.0, 30.0, 170.0, 30.0, 110.0, 180.0, 40.0, 50.0, 260.0, 30.0, 200.0, 280.0, 100.0, 110.0, 500.0, 30.0, 290.0, 100.0, 150.0, 60.0, 160.0, 50.0, 340.0, 70.0, 50.0, 120.0, 280.0, -70.0, 180.0, 60.0, -60.0, 410.0, 20.0, 160.0, 20.0, 0.0, 40.0, 50.0, 0.0, 0.0, 20.0, 190.0, 30.0, 50.0, 0.0, 160.0, 80.0, 510.0, 30.0, 220.0, 70.0, 340.0, 0.0, 50.0, 10.0, -60.0, 50.0, 20.0, 170.0, 0.0, 10.0, 260.0, 80.0, 350.0, 240.0, 0.0, 380.0, 20.0, 10.0, 0.0, 10.0, 110.0, 40.0, 10.0, 70.0, -20.0, 65.0, 180.0, 220.0, 90.0, 170.0, 170.0, 40.0, 30.0, 40.0, 250.0, 580.0, 100.0, 110.0, 310.0, 40.0, 20.0, 20.0, -10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.913861222122665, "mean_inference_ms": 1.9961406018443193, "mean_action_processing_ms": 0.5231122294104074, "mean_env_wait_ms": 1.6800294939792233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014040946960449219, "StateBufferConnector_ms": 0.016646623611450195, "ViewRequirementAgentConnector_ms": 0.43412256240844727}, "num_episodes": 23, "episode_return_max": 2100.0, "episode_return_min": 100.0, "episode_return_mean": 1078.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 13.426888938795194, "num_env_steps_trained_throughput_per_sec": 13.426888938795194, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 5200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5200000, "timers": {"training_iteration_time_ms": 1083381.522, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1083381.466, "sample_time_ms": 2975.682, "learn_time_ms": 1080379.699, "learn_throughput": 3.702, "synch_weights_time_ms": 15.177}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "done": false, "training_iteration": 130, "trial_id": "3d3a5_00000", "date": "2024-06-01_17-16-19", "timestamp": 1717276579, "time_this_iter_s": 297.9233651161194, "time_total_s": 67393.50942587852, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dc430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 67393.50942587852, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 19.179298245614035, "ram_util_percent": 81.65719298245615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8237192125873953, "cur_kl_coeff": 10.533200275243875, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0025347452243260397, "vf_loss": 6.893219238348282, "vf_explained_var": 0.0002024539933798793, "kl": Infinity, "entropy": 0.2358265374415218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1225395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 120.0, "episode_reward_mean": 1114.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 111.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1790.0, 1430.0, 940.0, 705.0, 1490.0, 1210.0, 910.0, 1130.0, 1155.0, 1400.0, 1055.0, 1345.0, 830.0, 1360.0, 1470.0, 925.0, 890.0, 1790.0, 945.0, 1160.0, 460.0, 1720.0, 1175.0, 1115.0, 660.0, 800.0, 1060.0, 1160.0, 290.0, 780.0, 1495.0, 1220.0, 1860.0, 930.0, 1280.0, 1435.0, 120.0, 1515.0, 650.0, 865.0, 1580.0, 1420.0, 150.0, 1525.0, 1340.0, 1170.0, 370.0, 1460.0, 580.0, 120.0, 350.0, 1670.0, 1210.0, 870.0, 1130.0, 450.0, 660.0, 1520.0, 1600.0, 920.0, 2100.0, 730.0, 1410.0, 1390.0, 875.0, 1350.0, 425.0, 1080.0, 1100.0, 1360.0, 1750.0, 1150.0, 400.0, 1460.0, 890.0, 820.0, 1015.0, 1460.0, 1180.0, 960.0, 1110.0, 1450.0, 1740.0, 950.0, 1300.0, 1390.0, 1170.0, 570.0, 940.0, 1130.0, 1310.0, 2270.0, 600.0, 1310.0, 970.0, 895.0, 310.0, 1645.0, 1580.0, 1330.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [370.0, -100.0, 60.0, 380.0, 70.0, 270.0, 370.0, 250.0, 80.0, 40.0, 40.0, 60.0, 50.0, 60.0, 320.0, 550.0, 20.0, 190.0, 120.0, 20.0, 50.0, 10.0, 380.0, 40.0, 0.0, 210.0, 20.0, 150.0, 50.0, 30.0, 290.0, 0.0, 100.0, 0.0, 20.0, 20.0, -5.0, 0.0, 30.0, 250.0, 100.0, 700.0, 10.0, 50.0, 10.0, 290.0, 20.0, 50.0, -30.0, 290.0, 20.0, -10.0, 480.0, 30.0, -50.0, 20.0, 500.0, 0.0, 110.0, 110.0, 210.0, 30.0, 40.0, 40.0, 10.0, 50.0, 80.0, 440.0, 10.0, 0.0, 10.0, 230.0, 70.0, 170.0, 80.0, 60.0, 120.0, 90.0, 150.0, 150.0, 40.0, 55.0, 660.0, 170.0, 80.0, 40.0, 30.0, 40.0, 0.0, 40.0, 70.0, 0.0, 60.0, 260.0, 270.0, 0.0, 150.0, 170.0, 130.0, 290.0, 10.0, 30.0, 110.0, 40.0, 20.0, 20.0, 170.0, 75.0, 300.0, 280.0, 110.0, 410.0, 210.0, 90.0, 70.0, 100.0, 40.0, 180.0, 80.0, 55.0, 200.0, 80.0, 20.0, 60.0, 340.0, 0.0, 20.0, 70.0, 10.0, 30.0, 290.0, 310.0, 20.0, 440.0, -180.0, 100.0, 70.0, 90.0, 280.0, -60.0, 220.0, 110.0, 210.0, 190.0, 40.0, 320.0, 20.0, 20.0, 240.0, 100.0, 0.0, 90.0, 5.0, 170.0, 40.0, 20.0, 100.0, 430.0, 60.0, 10.0, 0.0, 0.0, 40.0, 30.0, 360.0, 70.0, 100.0, 60.0, 200.0, 30.0, 0.0, 540.0, 0.0, 40.0, 150.0, 100.0, 80.0, 800.0, 90.0, -10.0, 40.0, 190.0, 130.0, 0.0, 190.0, -20.0, -35.0, 300.0, -20.0, 170.0, 90.0, 210.0, 10.0, 10.0, 80.0, 320.0, 190.0, 30.0, 60.0, 160.0, 10.0, 10.0, 50.0, 180.0, 0.0, 20.0, 20.0, 20.0, 90.0, 60.0, 80.0, 30.0, 180.0, 620.0, 180.0, 50.0, 450.0, 60.0, -50.0, 120.0, 80.0, 20.0, 530.0, 130.0, 170.0, 50.0, -155.0, 210.0, 70.0, 70.0, 40.0, 20.0, 50.0, 70.0, 40.0, 50.0, 45.0, 310.0, 20.0, 470.0, 40.0, 30.0, 20.0, 120.0, 30.0, 40.0, 300.0, 60.0, 20.0, 0.0, 0.0, 0.0, 20.0, 170.0, 30.0, 80.0, 210.0, 210.0, 10.0, 70.0, 40.0, 30.0, 60.0, 50.0, 30.0, 250.0, 20.0, 130.0, 380.0, 70.0, 140.0, 350.0, 60.0, 100.0, 50.0, 40.0, 40.0, 40.0, 320.0, 20.0, 40.0, 40.0, 0.0, 40.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 40.0, 100.0, 210.0, 40.0, 40.0, 30.0, 0.0, 180.0, 100.0, 40.0, 190.0, 70.0, 220.0, -40.0, 70.0, 0.0, 750.0, 110.0, 95.0, 30.0, 160.0, 180.0, 20.0, 30.0, 330.0, 190.0, 80.0, 130.0, -20.0, 120.0, 120.0, 70.0, 90.0, 50.0, 160.0, 70.0, 560.0, 140.0, 380.0, 220.0, 150.0, 70.0, 40.0, 50.0, 0.0, 170.0, 110.0, 10.0, 270.0, 60.0, 430.0, 60.0, 110.0, 40.0, 40.0, 90.0, 80.0, 210.0, 10.0, 210.0, 120.0, 270.0, 700.0, 20.0, 90.0, 110.0, 50.0, 20.0, -15.0, 70.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 0.0, 920.0, 10.0, 30.0, 60.0, 40.0, 140.0, 65.0, 10.0, 40.0, 200.0, 120.0, 0.0, 190.0, 110.0, 40.0, 10.0, 90.0, 20.0, 30.0, 40.0, 0.0, 40.0, 260.0, 370.0, 70.0, -15.0, -30.0, 10.0, 60.0, 100.0, 50.0, 90.0, 350.0, 160.0, 70.0, 100.0, 30.0, 40.0, 500.0, 190.0, 210.0, 30.0, 300.0, 210.0, 0.0, 80.0, 170.0, 290.0, 90.0, 40.0, 60.0, 10.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 60.0, 470.0, -40.0, 10.0, 460.0, 10.0, 60.0, 290.0, 220.0, 80.0, 370.0, 120.0, 20.0, 140.0, 60.0, 150.0, 60.0, 220.0, 120.0, 240.0, 610.0, 70.0, 80.0, 100.0, 0.0, -50.0, 70.0, 30.0, 20.0, 20.0, 0.0, 0.0, 80.0, 30.0, 50.0, 20.0, 110.0, 20.0, 40.0, 70.0, 180.0, 20.0, 30.0, 70.0, 400.0, 10.0, 600.0, 40.0, 40.0, 20.0, 10.0, -30.0, 0.0, 0.0, 440.0, 20.0, 50.0, 10.0, 60.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 160.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 350.0, 90.0, 50.0, 270.0, 50.0, 230.0, 150.0, -70.0, 180.0, 370.0, 200.0, 250.0, 80.0, 50.0, 30.0, 40.0, 380.0, 130.0, 40.0, 10.0, 90.0, 70.0, 50.0, 290.0, 50.0, 100.0, 60.0, 10.0, 80.0, 70.0, 40.0, 70.0, 330.0, 60.0, 0.0, 250.0, 30.0, 10.0, 270.0, 70.0, 100.0, 30.0, 10.0, 0.0, 70.0, 20.0, 20.0, 0.0, 20.0, 180.0, 30.0, 100.0, 10.0, 40.0, 160.0, 0.0, 90.0, 130.0, 40.0, 60.0, 90.0, 200.0, 580.0, 70.0, 50.0, 30.0, 130.0, 230.0, -60.0, 200.0, 40.0, 250.0, -40.0, 360.0, 220.0, 200.0, 170.0, 290.0, 20.0, 90.0, 110.0, 20.0, 20.0, 100.0, 70.0, 500.0, 40.0, 60.0, 0.0, 0.0, 110.0, 360.0, 430.0, 90.0, 130.0, -30.0, 480.0, 400.0, 110.0, 20.0, 10.0, 0.0, 350.0, 30.0, 40.0, 0.0, 0.0, 210.0, 20.0, 70.0, 50.0, 60.0, 60.0, 330.0, 400.0, 50.0, 350.0, 40.0, 70.0, 0.0, 100.0, 90.0, 80.0, 0.0, 0.0, 230.0, 600.0, 60.0, 50.0, 180.0, 190.0, 10.0, 30.0, 35.0, 370.0, 20.0, 40.0, 100.0, 30.0, 50.0, 60.0, 30.0, 50.0, 0.0, 160.0, 240.0, 50.0, 20.0, 650.0, 90.0, 10.0, 10.0, 40.0, 0.0, 240.0, 30.0, 100.0, 30.0, -65.0, 30.0, 40.0, 10.0, 40.0, 260.0, -60.0, 40.0, 290.0, 30.0, 400.0, 30.0, 360.0, 150.0, 70.0, 10.0, 220.0, 50.0, 10.0, 30.0, 170.0, 30.0, 110.0, 180.0, 40.0, 50.0, 260.0, 30.0, 200.0, 280.0, 100.0, 110.0, 500.0, 30.0, 290.0, 100.0, 150.0, 60.0, 160.0, 50.0, 340.0, 70.0, 50.0, 120.0, 280.0, -70.0, 180.0, 60.0, -60.0, 410.0, 20.0, 160.0, 20.0, 0.0, 40.0, 50.0, 0.0, 0.0, 20.0, 190.0, 30.0, 50.0, 0.0, 160.0, 80.0, 510.0, 30.0, 220.0, 70.0, 340.0, 0.0, 50.0, 10.0, -60.0, 50.0, 20.0, 170.0, 0.0, 10.0, 260.0, 80.0, 350.0, 240.0, 0.0, 380.0, 20.0, 10.0, 0.0, 10.0, 110.0, 40.0, 10.0, 70.0, -20.0, 65.0, 180.0, 220.0, 90.0, 170.0, 170.0, 40.0, 30.0, 40.0, 250.0, 580.0, 100.0, 110.0, 310.0, 40.0, 20.0, 20.0, -10.0, 90.0, 70.0, -30.0, 90.0, 40.0, 300.0, 70.0, 340.0, 60.0, 150.0, 40.0, 230.0, 70.0, 40.0, 70.0, 180.0, 60.0, -10.0, 20.0, 260.0, 90.0, 0.0, 10.0, 20.0, 50.0, 30.0, 430.0, 140.0, 280.0, 60.0, 390.0, 270.0, -10.0, 240.0, 30.0, 20.0, 330.0, 70.0, 70.0, 40.0, 120.0, 20.0, 60.0, 50.0, 310.0, 360.0, 40.0, 620.0, 90.0, 70.0, 20.0, 70.0, 60.0, 100.0, 0.0, 60.0, 20.0, 10.0, 40.0, 570.0, 170.0, 270.0, 40.0, 570.0, -10.0, 60.0, 80.0, 30.0, 30.0, 60.0, 60.0, 80.0, 330.0, 50.0, 10.0, 460.0, 40.0, 10.0, 60.0, 290.0, 510.0, 20.0, 230.0, 20.0, 30.0, 180.0, 90.0, 10.0, 20.0, 60.0, 10.0, 120.0, 100.0, 40.0, 10.0, 60.0, 20.0, 50.0, 10.0, 150.0, 120.0, 110.0, 20.0, 0.0, 200.0, 30.0, 0.0, 20.0, 80.0, 360.0, 420.0, 280.0, 40.0, 40.0, 10.0, 40.0, 70.0, 40.0, 30.0, 160.0, 350.0, 30.0, -10.0, 20.0, 160.0, 350.0, 200.0, 0.0, 140.0, 70.0, 150.0, 20.0, 420.0, 190.0, 580.0, 270.0, 90.0, 650.0, -60.0, -40.0, 30.0, 20.0, 10.0, 240.0, 180.0, 30.0, 50.0, 20.0, 20.0, 0.0, 200.0, 10.0, 10.0, 300.0, 50.0, 280.0, 20.0, 150.0, 10.0, 280.0, 90.0, 160.0, 120.0, 40.0, 60.0, 20.0, 300.0, 150.0, 10.0, 20.0, 400.0, 10.0, 50.0, 190.0, 5.0, 70.0, 0.0, 40.0, 100.0, 30.0, 20.0, 20.0, 10.0, 40.0, 0.0, 110.0, 30.0, 20.0, 30.0, 30.0, -30.0, 40.0, 480.0, 610.0, 80.0, 40.0, 250.0, 80.0, 75.0, 20.0, 40.0, -10.0, 390.0, 290.0, 30.0, 590.0, 10.0, 150.0, 20.0, 70.0, 70.0, 440.0, 170.0, 60.0, 590.0, -40.0, 0.0, -40.0, 10.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9065351828594437, "mean_inference_ms": 1.987115982908644, "mean_action_processing_ms": 0.5217142484206881, "mean_env_wait_ms": 1.6763559416404659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013942241668701172, "StateBufferConnector_ms": 0.016458988189697266, "ViewRequirementAgentConnector_ms": 0.41191935539245605}, "num_episodes": 22, "episode_return_max": 2270.0, "episode_return_min": 120.0, "episode_return_mean": 1114.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.611409129761975, "num_env_steps_trained_throughput_per_sec": 5.611409129761975, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 5240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5240000, "timers": {"training_iteration_time_ms": 1134675.088, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1134675.031, "sample_time_ms": 2982.491, "learn_time_ms": 1131668.057, "learn_throughput": 3.535, "synch_weights_time_ms": 15.031}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "done": false, "training_iteration": 131, "trial_id": "3d3a5_00000", "date": "2024-06-01_17-28-12", "timestamp": 1717277292, "time_this_iter_s": 712.8484880924225, "time_total_s": 68106.35791397095, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x11802f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 68106.35791397095, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 24.144329896907216, "ram_util_percent": 82.52577319587628}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1430764608553297, "cur_kl_coeff": 15.799800412865814, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0016403203789706127, "vf_loss": 6.496727844701407, "vf_explained_var": 0.00019437684037814886, "kl": Infinity, "entropy": 0.21296433150942842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1234785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 120.0, "episode_reward_mean": 1105.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -155.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 110.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [945.0, 1160.0, 460.0, 1720.0, 1175.0, 1115.0, 660.0, 800.0, 1060.0, 1160.0, 290.0, 780.0, 1495.0, 1220.0, 1860.0, 930.0, 1280.0, 1435.0, 120.0, 1515.0, 650.0, 865.0, 1580.0, 1420.0, 150.0, 1525.0, 1340.0, 1170.0, 370.0, 1460.0, 580.0, 120.0, 350.0, 1670.0, 1210.0, 870.0, 1130.0, 450.0, 660.0, 1520.0, 1600.0, 920.0, 2100.0, 730.0, 1410.0, 1390.0, 875.0, 1350.0, 425.0, 1080.0, 1100.0, 1360.0, 1750.0, 1150.0, 400.0, 1460.0, 890.0, 820.0, 1015.0, 1460.0, 1180.0, 960.0, 1110.0, 1450.0, 1740.0, 950.0, 1300.0, 1390.0, 1170.0, 570.0, 940.0, 1130.0, 1310.0, 2270.0, 600.0, 1310.0, 970.0, 895.0, 310.0, 1645.0, 1580.0, 1330.0, 1660.0, 1550.0, 1250.0, 1300.0, 1625.0, 1870.0, 825.0, 600.0, 250.0, 340.0, 1490.0, 1470.0, 1550.0, 1355.0, 490.0, 1190.0, 670.0, 1365.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 190.0, 130.0, 0.0, 190.0, -20.0, -35.0, 300.0, -20.0, 170.0, 90.0, 210.0, 10.0, 10.0, 80.0, 320.0, 190.0, 30.0, 60.0, 160.0, 10.0, 10.0, 50.0, 180.0, 0.0, 20.0, 20.0, 20.0, 90.0, 60.0, 80.0, 30.0, 180.0, 620.0, 180.0, 50.0, 450.0, 60.0, -50.0, 120.0, 80.0, 20.0, 530.0, 130.0, 170.0, 50.0, -155.0, 210.0, 70.0, 70.0, 40.0, 20.0, 50.0, 70.0, 40.0, 50.0, 45.0, 310.0, 20.0, 470.0, 40.0, 30.0, 20.0, 120.0, 30.0, 40.0, 300.0, 60.0, 20.0, 0.0, 0.0, 0.0, 20.0, 170.0, 30.0, 80.0, 210.0, 210.0, 10.0, 70.0, 40.0, 30.0, 60.0, 50.0, 30.0, 250.0, 20.0, 130.0, 380.0, 70.0, 140.0, 350.0, 60.0, 100.0, 50.0, 40.0, 40.0, 40.0, 320.0, 20.0, 40.0, 40.0, 0.0, 40.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 40.0, 100.0, 210.0, 40.0, 40.0, 30.0, 0.0, 180.0, 100.0, 40.0, 190.0, 70.0, 220.0, -40.0, 70.0, 0.0, 750.0, 110.0, 95.0, 30.0, 160.0, 180.0, 20.0, 30.0, 330.0, 190.0, 80.0, 130.0, -20.0, 120.0, 120.0, 70.0, 90.0, 50.0, 160.0, 70.0, 560.0, 140.0, 380.0, 220.0, 150.0, 70.0, 40.0, 50.0, 0.0, 170.0, 110.0, 10.0, 270.0, 60.0, 430.0, 60.0, 110.0, 40.0, 40.0, 90.0, 80.0, 210.0, 10.0, 210.0, 120.0, 270.0, 700.0, 20.0, 90.0, 110.0, 50.0, 20.0, -15.0, 70.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 0.0, 920.0, 10.0, 30.0, 60.0, 40.0, 140.0, 65.0, 10.0, 40.0, 200.0, 120.0, 0.0, 190.0, 110.0, 40.0, 10.0, 90.0, 20.0, 30.0, 40.0, 0.0, 40.0, 260.0, 370.0, 70.0, -15.0, -30.0, 10.0, 60.0, 100.0, 50.0, 90.0, 350.0, 160.0, 70.0, 100.0, 30.0, 40.0, 500.0, 190.0, 210.0, 30.0, 300.0, 210.0, 0.0, 80.0, 170.0, 290.0, 90.0, 40.0, 60.0, 10.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 60.0, 470.0, -40.0, 10.0, 460.0, 10.0, 60.0, 290.0, 220.0, 80.0, 370.0, 120.0, 20.0, 140.0, 60.0, 150.0, 60.0, 220.0, 120.0, 240.0, 610.0, 70.0, 80.0, 100.0, 0.0, -50.0, 70.0, 30.0, 20.0, 20.0, 0.0, 0.0, 80.0, 30.0, 50.0, 20.0, 110.0, 20.0, 40.0, 70.0, 180.0, 20.0, 30.0, 70.0, 400.0, 10.0, 600.0, 40.0, 40.0, 20.0, 10.0, -30.0, 0.0, 0.0, 440.0, 20.0, 50.0, 10.0, 60.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 160.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 350.0, 90.0, 50.0, 270.0, 50.0, 230.0, 150.0, -70.0, 180.0, 370.0, 200.0, 250.0, 80.0, 50.0, 30.0, 40.0, 380.0, 130.0, 40.0, 10.0, 90.0, 70.0, 50.0, 290.0, 50.0, 100.0, 60.0, 10.0, 80.0, 70.0, 40.0, 70.0, 330.0, 60.0, 0.0, 250.0, 30.0, 10.0, 270.0, 70.0, 100.0, 30.0, 10.0, 0.0, 70.0, 20.0, 20.0, 0.0, 20.0, 180.0, 30.0, 100.0, 10.0, 40.0, 160.0, 0.0, 90.0, 130.0, 40.0, 60.0, 90.0, 200.0, 580.0, 70.0, 50.0, 30.0, 130.0, 230.0, -60.0, 200.0, 40.0, 250.0, -40.0, 360.0, 220.0, 200.0, 170.0, 290.0, 20.0, 90.0, 110.0, 20.0, 20.0, 100.0, 70.0, 500.0, 40.0, 60.0, 0.0, 0.0, 110.0, 360.0, 430.0, 90.0, 130.0, -30.0, 480.0, 400.0, 110.0, 20.0, 10.0, 0.0, 350.0, 30.0, 40.0, 0.0, 0.0, 210.0, 20.0, 70.0, 50.0, 60.0, 60.0, 330.0, 400.0, 50.0, 350.0, 40.0, 70.0, 0.0, 100.0, 90.0, 80.0, 0.0, 0.0, 230.0, 600.0, 60.0, 50.0, 180.0, 190.0, 10.0, 30.0, 35.0, 370.0, 20.0, 40.0, 100.0, 30.0, 50.0, 60.0, 30.0, 50.0, 0.0, 160.0, 240.0, 50.0, 20.0, 650.0, 90.0, 10.0, 10.0, 40.0, 0.0, 240.0, 30.0, 100.0, 30.0, -65.0, 30.0, 40.0, 10.0, 40.0, 260.0, -60.0, 40.0, 290.0, 30.0, 400.0, 30.0, 360.0, 150.0, 70.0, 10.0, 220.0, 50.0, 10.0, 30.0, 170.0, 30.0, 110.0, 180.0, 40.0, 50.0, 260.0, 30.0, 200.0, 280.0, 100.0, 110.0, 500.0, 30.0, 290.0, 100.0, 150.0, 60.0, 160.0, 50.0, 340.0, 70.0, 50.0, 120.0, 280.0, -70.0, 180.0, 60.0, -60.0, 410.0, 20.0, 160.0, 20.0, 0.0, 40.0, 50.0, 0.0, 0.0, 20.0, 190.0, 30.0, 50.0, 0.0, 160.0, 80.0, 510.0, 30.0, 220.0, 70.0, 340.0, 0.0, 50.0, 10.0, -60.0, 50.0, 20.0, 170.0, 0.0, 10.0, 260.0, 80.0, 350.0, 240.0, 0.0, 380.0, 20.0, 10.0, 0.0, 10.0, 110.0, 40.0, 10.0, 70.0, -20.0, 65.0, 180.0, 220.0, 90.0, 170.0, 170.0, 40.0, 30.0, 40.0, 250.0, 580.0, 100.0, 110.0, 310.0, 40.0, 20.0, 20.0, -10.0, 90.0, 70.0, -30.0, 90.0, 40.0, 300.0, 70.0, 340.0, 60.0, 150.0, 40.0, 230.0, 70.0, 40.0, 70.0, 180.0, 60.0, -10.0, 20.0, 260.0, 90.0, 0.0, 10.0, 20.0, 50.0, 30.0, 430.0, 140.0, 280.0, 60.0, 390.0, 270.0, -10.0, 240.0, 30.0, 20.0, 330.0, 70.0, 70.0, 40.0, 120.0, 20.0, 60.0, 50.0, 310.0, 360.0, 40.0, 620.0, 90.0, 70.0, 20.0, 70.0, 60.0, 100.0, 0.0, 60.0, 20.0, 10.0, 40.0, 570.0, 170.0, 270.0, 40.0, 570.0, -10.0, 60.0, 80.0, 30.0, 30.0, 60.0, 60.0, 80.0, 330.0, 50.0, 10.0, 460.0, 40.0, 10.0, 60.0, 290.0, 510.0, 20.0, 230.0, 20.0, 30.0, 180.0, 90.0, 10.0, 20.0, 60.0, 10.0, 120.0, 100.0, 40.0, 10.0, 60.0, 20.0, 50.0, 10.0, 150.0, 120.0, 110.0, 20.0, 0.0, 200.0, 30.0, 0.0, 20.0, 80.0, 360.0, 420.0, 280.0, 40.0, 40.0, 10.0, 40.0, 70.0, 40.0, 30.0, 160.0, 350.0, 30.0, -10.0, 20.0, 160.0, 350.0, 200.0, 0.0, 140.0, 70.0, 150.0, 20.0, 420.0, 190.0, 580.0, 270.0, 90.0, 650.0, -60.0, -40.0, 30.0, 20.0, 10.0, 240.0, 180.0, 30.0, 50.0, 20.0, 20.0, 0.0, 200.0, 10.0, 10.0, 300.0, 50.0, 280.0, 20.0, 150.0, 10.0, 280.0, 90.0, 160.0, 120.0, 40.0, 60.0, 20.0, 300.0, 150.0, 10.0, 20.0, 400.0, 10.0, 50.0, 190.0, 5.0, 70.0, 0.0, 40.0, 100.0, 30.0, 20.0, 20.0, 10.0, 40.0, 0.0, 110.0, 30.0, 20.0, 30.0, 30.0, -30.0, 40.0, 480.0, 610.0, 80.0, 40.0, 250.0, 80.0, 75.0, 20.0, 40.0, -10.0, 390.0, 290.0, 30.0, 590.0, 10.0, 150.0, 20.0, 70.0, 70.0, 440.0, 170.0, 60.0, 590.0, -40.0, 0.0, -40.0, 10.0, 70.0, 40.0, 290.0, 320.0, 40.0, 240.0, 160.0, 40.0, 170.0, 40.0, 320.0, 230.0, 220.0, 40.0, 10.0, 140.0, 160.0, 170.0, 300.0, 90.0, 190.0, 60.0, 80.0, 50.0, 10.0, 180.0, 690.0, 0.0, 130.0, 20.0, 30.0, 30.0, 400.0, 50.0, 0.0, 30.0, 60.0, 140.0, 260.0, 70.0, 260.0, 0.0, 50.0, 40.0, 165.0, 90.0, 610.0, 460.0, 150.0, 30.0, 30.0, 90.0, 300.0, 50.0, 20.0, 700.0, 90.0, 210.0, 300.0, 20.0, 90.0, 290.0, -5.0, 0.0, 20.0, 10.0, 150.0, 110.0, 30.0, 70.0, 150.0, 30.0, 80.0, 60.0, 30.0, 90.0, 160.0, 20.0, 30.0, 10.0, 90.0, 120.0, 10.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 180.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 230.0, -40.0, 460.0, 60.0, 0.0, 40.0, 590.0, 30.0, 10.0, 110.0, 50.0, 30.0, 170.0, 170.0, 460.0, 90.0, 180.0, 90.0, 50.0, 180.0, 320.0, 10.0, 0.0, 50.0, 280.0, 190.0, 510.0, 20.0, 10.0, 160.0, 30.0, 5.0, 100.0, -10.0, 520.0, 20.0, 380.0, 20.0, 200.0, 90.0, 10.0, 50.0, 10.0, 0.0, 140.0, 200.0, 20.0, 0.0, 20.0, 40.0, 90.0, 160.0, 120.0, 100.0, 50.0, -10.0, -50.0, 170.0, 520.0, 40.0, 80.0, 20.0, 0.0, 30.0, -50.0, -30.0, -50.0, 10.0, 350.0, 310.0, 80.0, 420.0, 10.0, 315.0, 160.0, 90.0, 70.0, 100.0, 40.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9072833575722314, "mean_inference_ms": 1.9917647964710412, "mean_action_processing_ms": 0.5215248459799775, "mean_env_wait_ms": 1.674937252084596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013773918151855469, "StateBufferConnector_ms": 0.015847444534301758, "ViewRequirementAgentConnector_ms": 0.4180004596710205}, "num_episodes": 18, "episode_return_max": 2270.0, "episode_return_min": 120.0, "episode_return_mean": 1105.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.774391857674148, "num_env_steps_trained_throughput_per_sec": 2.774391857674148, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 5280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5280000, "timers": {"training_iteration_time_ms": 1258921.655, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1258921.597, "sample_time_ms": 2971.203, "learn_time_ms": 1255924.805, "learn_throughput": 3.185, "synch_weights_time_ms": 14.965}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "done": false, "training_iteration": 132, "trial_id": "3d3a5_00000", "date": "2024-06-01_17-52-13", "timestamp": 1717278733, "time_this_iter_s": 1441.7926199436188, "time_total_s": 69548.15053391457, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a778b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 69548.15053391457, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 21.35171232876712, "ram_util_percent": 81.66712328767125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.116006313688077, "cur_kl_coeff": 23.699700619298717, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.344849676572984, "policy_loss": -0.0016230644906907719, "vf_loss": 7.344009685414795, "vf_explained_var": 0.0007639589020238517, "kl": 0.00010392755397616363, "entropy": 0.22633861795908855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1244175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 120.0, "episode_reward_mean": 1105.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -70.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 110.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 1515.0, 650.0, 865.0, 1580.0, 1420.0, 150.0, 1525.0, 1340.0, 1170.0, 370.0, 1460.0, 580.0, 120.0, 350.0, 1670.0, 1210.0, 870.0, 1130.0, 450.0, 660.0, 1520.0, 1600.0, 920.0, 2100.0, 730.0, 1410.0, 1390.0, 875.0, 1350.0, 425.0, 1080.0, 1100.0, 1360.0, 1750.0, 1150.0, 400.0, 1460.0, 890.0, 820.0, 1015.0, 1460.0, 1180.0, 960.0, 1110.0, 1450.0, 1740.0, 950.0, 1300.0, 1390.0, 1170.0, 570.0, 940.0, 1130.0, 1310.0, 2270.0, 600.0, 1310.0, 970.0, 895.0, 310.0, 1645.0, 1580.0, 1330.0, 1660.0, 1550.0, 1250.0, 1300.0, 1625.0, 1870.0, 825.0, 600.0, 250.0, 340.0, 1490.0, 1470.0, 1550.0, 1355.0, 490.0, 1190.0, 670.0, 1365.0, 1865.0, 1080.0, 170.0, 1060.0, 1125.0, 1070.0, 930.0, 1540.0, 960.0, 440.0, 1470.0, 1280.0, 980.0, 1470.0, 1200.0, 1285.0, 470.0, 1215.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 0.0, 920.0, 10.0, 30.0, 60.0, 40.0, 140.0, 65.0, 10.0, 40.0, 200.0, 120.0, 0.0, 190.0, 110.0, 40.0, 10.0, 90.0, 20.0, 30.0, 40.0, 0.0, 40.0, 260.0, 370.0, 70.0, -15.0, -30.0, 10.0, 60.0, 100.0, 50.0, 90.0, 350.0, 160.0, 70.0, 100.0, 30.0, 40.0, 500.0, 190.0, 210.0, 30.0, 300.0, 210.0, 0.0, 80.0, 170.0, 290.0, 90.0, 40.0, 60.0, 10.0, 30.0, 0.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 60.0, 470.0, -40.0, 10.0, 460.0, 10.0, 60.0, 290.0, 220.0, 80.0, 370.0, 120.0, 20.0, 140.0, 60.0, 150.0, 60.0, 220.0, 120.0, 240.0, 610.0, 70.0, 80.0, 100.0, 0.0, -50.0, 70.0, 30.0, 20.0, 20.0, 0.0, 0.0, 80.0, 30.0, 50.0, 20.0, 110.0, 20.0, 40.0, 70.0, 180.0, 20.0, 30.0, 70.0, 400.0, 10.0, 600.0, 40.0, 40.0, 20.0, 10.0, -30.0, 0.0, 0.0, 440.0, 20.0, 50.0, 10.0, 60.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 160.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 350.0, 90.0, 50.0, 270.0, 50.0, 230.0, 150.0, -70.0, 180.0, 370.0, 200.0, 250.0, 80.0, 50.0, 30.0, 40.0, 380.0, 130.0, 40.0, 10.0, 90.0, 70.0, 50.0, 290.0, 50.0, 100.0, 60.0, 10.0, 80.0, 70.0, 40.0, 70.0, 330.0, 60.0, 0.0, 250.0, 30.0, 10.0, 270.0, 70.0, 100.0, 30.0, 10.0, 0.0, 70.0, 20.0, 20.0, 0.0, 20.0, 180.0, 30.0, 100.0, 10.0, 40.0, 160.0, 0.0, 90.0, 130.0, 40.0, 60.0, 90.0, 200.0, 580.0, 70.0, 50.0, 30.0, 130.0, 230.0, -60.0, 200.0, 40.0, 250.0, -40.0, 360.0, 220.0, 200.0, 170.0, 290.0, 20.0, 90.0, 110.0, 20.0, 20.0, 100.0, 70.0, 500.0, 40.0, 60.0, 0.0, 0.0, 110.0, 360.0, 430.0, 90.0, 130.0, -30.0, 480.0, 400.0, 110.0, 20.0, 10.0, 0.0, 350.0, 30.0, 40.0, 0.0, 0.0, 210.0, 20.0, 70.0, 50.0, 60.0, 60.0, 330.0, 400.0, 50.0, 350.0, 40.0, 70.0, 0.0, 100.0, 90.0, 80.0, 0.0, 0.0, 230.0, 600.0, 60.0, 50.0, 180.0, 190.0, 10.0, 30.0, 35.0, 370.0, 20.0, 40.0, 100.0, 30.0, 50.0, 60.0, 30.0, 50.0, 0.0, 160.0, 240.0, 50.0, 20.0, 650.0, 90.0, 10.0, 10.0, 40.0, 0.0, 240.0, 30.0, 100.0, 30.0, -65.0, 30.0, 40.0, 10.0, 40.0, 260.0, -60.0, 40.0, 290.0, 30.0, 400.0, 30.0, 360.0, 150.0, 70.0, 10.0, 220.0, 50.0, 10.0, 30.0, 170.0, 30.0, 110.0, 180.0, 40.0, 50.0, 260.0, 30.0, 200.0, 280.0, 100.0, 110.0, 500.0, 30.0, 290.0, 100.0, 150.0, 60.0, 160.0, 50.0, 340.0, 70.0, 50.0, 120.0, 280.0, -70.0, 180.0, 60.0, -60.0, 410.0, 20.0, 160.0, 20.0, 0.0, 40.0, 50.0, 0.0, 0.0, 20.0, 190.0, 30.0, 50.0, 0.0, 160.0, 80.0, 510.0, 30.0, 220.0, 70.0, 340.0, 0.0, 50.0, 10.0, -60.0, 50.0, 20.0, 170.0, 0.0, 10.0, 260.0, 80.0, 350.0, 240.0, 0.0, 380.0, 20.0, 10.0, 0.0, 10.0, 110.0, 40.0, 10.0, 70.0, -20.0, 65.0, 180.0, 220.0, 90.0, 170.0, 170.0, 40.0, 30.0, 40.0, 250.0, 580.0, 100.0, 110.0, 310.0, 40.0, 20.0, 20.0, -10.0, 90.0, 70.0, -30.0, 90.0, 40.0, 300.0, 70.0, 340.0, 60.0, 150.0, 40.0, 230.0, 70.0, 40.0, 70.0, 180.0, 60.0, -10.0, 20.0, 260.0, 90.0, 0.0, 10.0, 20.0, 50.0, 30.0, 430.0, 140.0, 280.0, 60.0, 390.0, 270.0, -10.0, 240.0, 30.0, 20.0, 330.0, 70.0, 70.0, 40.0, 120.0, 20.0, 60.0, 50.0, 310.0, 360.0, 40.0, 620.0, 90.0, 70.0, 20.0, 70.0, 60.0, 100.0, 0.0, 60.0, 20.0, 10.0, 40.0, 570.0, 170.0, 270.0, 40.0, 570.0, -10.0, 60.0, 80.0, 30.0, 30.0, 60.0, 60.0, 80.0, 330.0, 50.0, 10.0, 460.0, 40.0, 10.0, 60.0, 290.0, 510.0, 20.0, 230.0, 20.0, 30.0, 180.0, 90.0, 10.0, 20.0, 60.0, 10.0, 120.0, 100.0, 40.0, 10.0, 60.0, 20.0, 50.0, 10.0, 150.0, 120.0, 110.0, 20.0, 0.0, 200.0, 30.0, 0.0, 20.0, 80.0, 360.0, 420.0, 280.0, 40.0, 40.0, 10.0, 40.0, 70.0, 40.0, 30.0, 160.0, 350.0, 30.0, -10.0, 20.0, 160.0, 350.0, 200.0, 0.0, 140.0, 70.0, 150.0, 20.0, 420.0, 190.0, 580.0, 270.0, 90.0, 650.0, -60.0, -40.0, 30.0, 20.0, 10.0, 240.0, 180.0, 30.0, 50.0, 20.0, 20.0, 0.0, 200.0, 10.0, 10.0, 300.0, 50.0, 280.0, 20.0, 150.0, 10.0, 280.0, 90.0, 160.0, 120.0, 40.0, 60.0, 20.0, 300.0, 150.0, 10.0, 20.0, 400.0, 10.0, 50.0, 190.0, 5.0, 70.0, 0.0, 40.0, 100.0, 30.0, 20.0, 20.0, 10.0, 40.0, 0.0, 110.0, 30.0, 20.0, 30.0, 30.0, -30.0, 40.0, 480.0, 610.0, 80.0, 40.0, 250.0, 80.0, 75.0, 20.0, 40.0, -10.0, 390.0, 290.0, 30.0, 590.0, 10.0, 150.0, 20.0, 70.0, 70.0, 440.0, 170.0, 60.0, 590.0, -40.0, 0.0, -40.0, 10.0, 70.0, 40.0, 290.0, 320.0, 40.0, 240.0, 160.0, 40.0, 170.0, 40.0, 320.0, 230.0, 220.0, 40.0, 10.0, 140.0, 160.0, 170.0, 300.0, 90.0, 190.0, 60.0, 80.0, 50.0, 10.0, 180.0, 690.0, 0.0, 130.0, 20.0, 30.0, 30.0, 400.0, 50.0, 0.0, 30.0, 60.0, 140.0, 260.0, 70.0, 260.0, 0.0, 50.0, 40.0, 165.0, 90.0, 610.0, 460.0, 150.0, 30.0, 30.0, 90.0, 300.0, 50.0, 20.0, 700.0, 90.0, 210.0, 300.0, 20.0, 90.0, 290.0, -5.0, 0.0, 20.0, 10.0, 150.0, 110.0, 30.0, 70.0, 150.0, 30.0, 80.0, 60.0, 30.0, 90.0, 160.0, 20.0, 30.0, 10.0, 90.0, 120.0, 10.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 180.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 230.0, -40.0, 460.0, 60.0, 0.0, 40.0, 590.0, 30.0, 10.0, 110.0, 50.0, 30.0, 170.0, 170.0, 460.0, 90.0, 180.0, 90.0, 50.0, 180.0, 320.0, 10.0, 0.0, 50.0, 280.0, 190.0, 510.0, 20.0, 10.0, 160.0, 30.0, 5.0, 100.0, -10.0, 520.0, 20.0, 380.0, 20.0, 200.0, 90.0, 10.0, 50.0, 10.0, 0.0, 140.0, 200.0, 20.0, 0.0, 20.0, 40.0, 90.0, 160.0, 120.0, 100.0, 50.0, -10.0, -50.0, 170.0, 520.0, 40.0, 80.0, 20.0, 0.0, 30.0, -50.0, -30.0, -50.0, 10.0, 350.0, 310.0, 80.0, 420.0, 10.0, 315.0, 160.0, 90.0, 70.0, 100.0, 40.0, 80.0, 90.0, 950.0, 70.0, 90.0, 230.0, 180.0, 55.0, 40.0, 80.0, 80.0, 50.0, 180.0, 40.0, 190.0, 0.0, 30.0, 20.0, 490.0, 40.0, 40.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 50.0, 0.0, 60.0, 200.0, 40.0, 0.0, 390.0, 100.0, 50.0, 40.0, 170.0, 10.0, 280.0, 200.0, 20.0, 20.0, 60.0, 80.0, 230.0, -45.0, 250.0, 30.0, 190.0, 40.0, 260.0, 160.0, 20.0, 230.0, 60.0, 50.0, 40.0, 20.0, 40.0, 10.0, 220.0, 0.0, 380.0, 100.0, -60.0, 160.0, 100.0, -20.0, 110.0, 50.0, -30.0, 130.0, 30.0, 230.0, 50.0, 470.0, 370.0, 130.0, 20.0, 60.0, 10.0, 100.0, 80.0, 0.0, 320.0, 100.0, 10.0, 260.0, 20.0, 20.0, 50.0, 50.0, 30.0, 0.0, 40.0, 180.0, 30.0, 20.0, 70.0, 180.0, 30.0, 150.0, 90.0, 550.0, 280.0, 50.0, 30.0, 40.0, 280.0, 260.0, 90.0, 100.0, 280.0, 30.0, 150.0, 10.0, 40.0, 40.0, 110.0, 0.0, 0.0, 40.0, 50.0, 20.0, 150.0, 550.0, 60.0, 0.0, 170.0, 180.0, 320.0, 10.0, 360.0, 100.0, 220.0, 50.0, -30.0, 90.0, 40.0, 10.0, 30.0, 110.0, 310.0, 80.0, 80.0, 80.0, 380.0, 80.0, -15.0, 380.0, 200.0, 60.0, 420.0, 70.0, 10.0, 100.0, 40.0, 20.0, 10.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 10.0, 50.0, 300.0, 20.0, 420.0, 20.0, 10.0, 60.0, 60.0, 275.0, 70.0, 20.0, 260.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.904156528801878, "mean_inference_ms": 1.9895101986163122, "mean_action_processing_ms": 0.5207425729506091, "mean_env_wait_ms": 1.6725501777713783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014086246490478516, "StateBufferConnector_ms": 0.015967607498168945, "ViewRequirementAgentConnector_ms": 0.427600622177124}, "num_episodes": 18, "episode_return_max": 2270.0, "episode_return_min": 120.0, "episode_return_mean": 1105.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.7626157431042522, "num_env_steps_trained_throughput_per_sec": 1.7626157431042522, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 5320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5320000, "timers": {"training_iteration_time_ms": 1466232.822, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1466232.763, "sample_time_ms": 2974.836, "learn_time_ms": 1463232.352, "learn_throughput": 2.734, "synch_weights_time_ms": 14.983}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "done": false, "training_iteration": 133, "trial_id": "3d3a5_00000", "date": "2024-06-01_18-30-03", "timestamp": 1717281003, "time_this_iter_s": 2269.380218029022, "time_total_s": 71817.53075194359, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f8873a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71817.53075194359, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 26.594666666666665, "ram_util_percent": 82.368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9316741465760496, "cur_kl_coeff": 11.849850309649359, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.318457315016351, "policy_loss": -0.002619890917635089, "vf_loss": 6.318597941403699, "vf_explained_var": 0.0004413598642562525, "kl": 0.00020922350266798555, "entropy": 0.22617743696077183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1253565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 40.0, "episode_reward_mean": 1122.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 112.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [920.0, 2100.0, 730.0, 1410.0, 1390.0, 875.0, 1350.0, 425.0, 1080.0, 1100.0, 1360.0, 1750.0, 1150.0, 400.0, 1460.0, 890.0, 820.0, 1015.0, 1460.0, 1180.0, 960.0, 1110.0, 1450.0, 1740.0, 950.0, 1300.0, 1390.0, 1170.0, 570.0, 940.0, 1130.0, 1310.0, 2270.0, 600.0, 1310.0, 970.0, 895.0, 310.0, 1645.0, 1580.0, 1330.0, 1660.0, 1550.0, 1250.0, 1300.0, 1625.0, 1870.0, 825.0, 600.0, 250.0, 340.0, 1490.0, 1470.0, 1550.0, 1355.0, 490.0, 1190.0, 670.0, 1365.0, 1865.0, 1080.0, 170.0, 1060.0, 1125.0, 1070.0, 930.0, 1540.0, 960.0, 440.0, 1470.0, 1280.0, 980.0, 1470.0, 1200.0, 1285.0, 470.0, 1215.0, 1040.0, 1700.0, 1450.0, 1510.0, 800.0, 720.0, 390.0, 1485.0, 1490.0, 880.0, 1460.0, 1230.0, 530.0, 1870.0, 1180.0, 1300.0, 685.0, 1480.0, 1050.0, 200.0, 750.0, 710.0, 40.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 20.0, 20.0, 100.0, 70.0, 500.0, 40.0, 60.0, 0.0, 0.0, 110.0, 360.0, 430.0, 90.0, 130.0, -30.0, 480.0, 400.0, 110.0, 20.0, 10.0, 0.0, 350.0, 30.0, 40.0, 0.0, 0.0, 210.0, 20.0, 70.0, 50.0, 60.0, 60.0, 330.0, 400.0, 50.0, 350.0, 40.0, 70.0, 0.0, 100.0, 90.0, 80.0, 0.0, 0.0, 230.0, 600.0, 60.0, 50.0, 180.0, 190.0, 10.0, 30.0, 35.0, 370.0, 20.0, 40.0, 100.0, 30.0, 50.0, 60.0, 30.0, 50.0, 0.0, 160.0, 240.0, 50.0, 20.0, 650.0, 90.0, 10.0, 10.0, 40.0, 0.0, 240.0, 30.0, 100.0, 30.0, -65.0, 30.0, 40.0, 10.0, 40.0, 260.0, -60.0, 40.0, 290.0, 30.0, 400.0, 30.0, 360.0, 150.0, 70.0, 10.0, 220.0, 50.0, 10.0, 30.0, 170.0, 30.0, 110.0, 180.0, 40.0, 50.0, 260.0, 30.0, 200.0, 280.0, 100.0, 110.0, 500.0, 30.0, 290.0, 100.0, 150.0, 60.0, 160.0, 50.0, 340.0, 70.0, 50.0, 120.0, 280.0, -70.0, 180.0, 60.0, -60.0, 410.0, 20.0, 160.0, 20.0, 0.0, 40.0, 50.0, 0.0, 0.0, 20.0, 190.0, 30.0, 50.0, 0.0, 160.0, 80.0, 510.0, 30.0, 220.0, 70.0, 340.0, 0.0, 50.0, 10.0, -60.0, 50.0, 20.0, 170.0, 0.0, 10.0, 260.0, 80.0, 350.0, 240.0, 0.0, 380.0, 20.0, 10.0, 0.0, 10.0, 110.0, 40.0, 10.0, 70.0, -20.0, 65.0, 180.0, 220.0, 90.0, 170.0, 170.0, 40.0, 30.0, 40.0, 250.0, 580.0, 100.0, 110.0, 310.0, 40.0, 20.0, 20.0, -10.0, 90.0, 70.0, -30.0, 90.0, 40.0, 300.0, 70.0, 340.0, 60.0, 150.0, 40.0, 230.0, 70.0, 40.0, 70.0, 180.0, 60.0, -10.0, 20.0, 260.0, 90.0, 0.0, 10.0, 20.0, 50.0, 30.0, 430.0, 140.0, 280.0, 60.0, 390.0, 270.0, -10.0, 240.0, 30.0, 20.0, 330.0, 70.0, 70.0, 40.0, 120.0, 20.0, 60.0, 50.0, 310.0, 360.0, 40.0, 620.0, 90.0, 70.0, 20.0, 70.0, 60.0, 100.0, 0.0, 60.0, 20.0, 10.0, 40.0, 570.0, 170.0, 270.0, 40.0, 570.0, -10.0, 60.0, 80.0, 30.0, 30.0, 60.0, 60.0, 80.0, 330.0, 50.0, 10.0, 460.0, 40.0, 10.0, 60.0, 290.0, 510.0, 20.0, 230.0, 20.0, 30.0, 180.0, 90.0, 10.0, 20.0, 60.0, 10.0, 120.0, 100.0, 40.0, 10.0, 60.0, 20.0, 50.0, 10.0, 150.0, 120.0, 110.0, 20.0, 0.0, 200.0, 30.0, 0.0, 20.0, 80.0, 360.0, 420.0, 280.0, 40.0, 40.0, 10.0, 40.0, 70.0, 40.0, 30.0, 160.0, 350.0, 30.0, -10.0, 20.0, 160.0, 350.0, 200.0, 0.0, 140.0, 70.0, 150.0, 20.0, 420.0, 190.0, 580.0, 270.0, 90.0, 650.0, -60.0, -40.0, 30.0, 20.0, 10.0, 240.0, 180.0, 30.0, 50.0, 20.0, 20.0, 0.0, 200.0, 10.0, 10.0, 300.0, 50.0, 280.0, 20.0, 150.0, 10.0, 280.0, 90.0, 160.0, 120.0, 40.0, 60.0, 20.0, 300.0, 150.0, 10.0, 20.0, 400.0, 10.0, 50.0, 190.0, 5.0, 70.0, 0.0, 40.0, 100.0, 30.0, 20.0, 20.0, 10.0, 40.0, 0.0, 110.0, 30.0, 20.0, 30.0, 30.0, -30.0, 40.0, 480.0, 610.0, 80.0, 40.0, 250.0, 80.0, 75.0, 20.0, 40.0, -10.0, 390.0, 290.0, 30.0, 590.0, 10.0, 150.0, 20.0, 70.0, 70.0, 440.0, 170.0, 60.0, 590.0, -40.0, 0.0, -40.0, 10.0, 70.0, 40.0, 290.0, 320.0, 40.0, 240.0, 160.0, 40.0, 170.0, 40.0, 320.0, 230.0, 220.0, 40.0, 10.0, 140.0, 160.0, 170.0, 300.0, 90.0, 190.0, 60.0, 80.0, 50.0, 10.0, 180.0, 690.0, 0.0, 130.0, 20.0, 30.0, 30.0, 400.0, 50.0, 0.0, 30.0, 60.0, 140.0, 260.0, 70.0, 260.0, 0.0, 50.0, 40.0, 165.0, 90.0, 610.0, 460.0, 150.0, 30.0, 30.0, 90.0, 300.0, 50.0, 20.0, 700.0, 90.0, 210.0, 300.0, 20.0, 90.0, 290.0, -5.0, 0.0, 20.0, 10.0, 150.0, 110.0, 30.0, 70.0, 150.0, 30.0, 80.0, 60.0, 30.0, 90.0, 160.0, 20.0, 30.0, 10.0, 90.0, 120.0, 10.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 180.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 230.0, -40.0, 460.0, 60.0, 0.0, 40.0, 590.0, 30.0, 10.0, 110.0, 50.0, 30.0, 170.0, 170.0, 460.0, 90.0, 180.0, 90.0, 50.0, 180.0, 320.0, 10.0, 0.0, 50.0, 280.0, 190.0, 510.0, 20.0, 10.0, 160.0, 30.0, 5.0, 100.0, -10.0, 520.0, 20.0, 380.0, 20.0, 200.0, 90.0, 10.0, 50.0, 10.0, 0.0, 140.0, 200.0, 20.0, 0.0, 20.0, 40.0, 90.0, 160.0, 120.0, 100.0, 50.0, -10.0, -50.0, 170.0, 520.0, 40.0, 80.0, 20.0, 0.0, 30.0, -50.0, -30.0, -50.0, 10.0, 350.0, 310.0, 80.0, 420.0, 10.0, 315.0, 160.0, 90.0, 70.0, 100.0, 40.0, 80.0, 90.0, 950.0, 70.0, 90.0, 230.0, 180.0, 55.0, 40.0, 80.0, 80.0, 50.0, 180.0, 40.0, 190.0, 0.0, 30.0, 20.0, 490.0, 40.0, 40.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 50.0, 0.0, 60.0, 200.0, 40.0, 0.0, 390.0, 100.0, 50.0, 40.0, 170.0, 10.0, 280.0, 200.0, 20.0, 20.0, 60.0, 80.0, 230.0, -45.0, 250.0, 30.0, 190.0, 40.0, 260.0, 160.0, 20.0, 230.0, 60.0, 50.0, 40.0, 20.0, 40.0, 10.0, 220.0, 0.0, 380.0, 100.0, -60.0, 160.0, 100.0, -20.0, 110.0, 50.0, -30.0, 130.0, 30.0, 230.0, 50.0, 470.0, 370.0, 130.0, 20.0, 60.0, 10.0, 100.0, 80.0, 0.0, 320.0, 100.0, 10.0, 260.0, 20.0, 20.0, 50.0, 50.0, 30.0, 0.0, 40.0, 180.0, 30.0, 20.0, 70.0, 180.0, 30.0, 150.0, 90.0, 550.0, 280.0, 50.0, 30.0, 40.0, 280.0, 260.0, 90.0, 100.0, 280.0, 30.0, 150.0, 10.0, 40.0, 40.0, 110.0, 0.0, 0.0, 40.0, 50.0, 20.0, 150.0, 550.0, 60.0, 0.0, 170.0, 180.0, 320.0, 10.0, 360.0, 100.0, 220.0, 50.0, -30.0, 90.0, 40.0, 10.0, 30.0, 110.0, 310.0, 80.0, 80.0, 80.0, 380.0, 80.0, -15.0, 380.0, 200.0, 60.0, 420.0, 70.0, 10.0, 100.0, 40.0, 20.0, 10.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 10.0, 50.0, 300.0, 20.0, 420.0, 20.0, 10.0, 60.0, 60.0, 275.0, 70.0, 20.0, 260.0, 190.0, 260.0, -20.0, 30.0, 110.0, 10.0, 70.0, 10.0, 200.0, 180.0, 40.0, 160.0, 0.0, 60.0, 70.0, 170.0, 40.0, 20.0, 840.0, 300.0, 280.0, 390.0, 190.0, 220.0, 20.0, 120.0, 130.0, 30.0, 30.0, 40.0, 110.0, 70.0, 90.0, 310.0, 160.0, 180.0, 10.0, 10.0, 490.0, 80.0, 100.0, 180.0, 80.0, 100.0, 15.0, -25.0, 70.0, 90.0, 180.0, 10.0, 420.0, -20.0, 0.0, 220.0, 20.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 40.0, 10.0, 40.0, 30.0, -30.0, 260.0, -50.0, 10.0, 50.0, 150.0, 30.0, 60.0, -75.0, 760.0, 20.0, 30.0, -10.0, 40.0, 480.0, 220.0, 170.0, 70.0, 70.0, 70.0, 60.0, 80.0, 630.0, 50.0, 70.0, 20.0, 10.0, 0.0, 140.0, -120.0, 20.0, 630.0, 100.0, 70.0, 10.0, 270.0, 40.0, 120.0, 20.0, 100.0, 80.0, 30.0, 80.0, 660.0, 60.0, 90.0, 40.0, 80.0, 390.0, 40.0, 480.0, 40.0, 80.0, 0.0, -10.0, 0.0, 50.0, 30.0, 10.0, 50.0, 170.0, 160.0, 50.0, 0.0, 10.0, 720.0, 60.0, 500.0, 100.0, -30.0, 70.0, 130.0, 60.0, 260.0, 0.0, 20.0, 430.0, 80.0, 30.0, 30.0, 10.0, 50.0, 240.0, -20.0, 310.0, 160.0, 130.0, 100.0, 30.0, 280.0, 10.0, 170.0, 160.0, 130.0, 130.0, 60.0, 110.0, 20.0, 40.0, 160.0, 0.0, 5.0, 160.0, 0.0, 130.0, 50.0, 60.0, 650.0, 100.0, 190.0, 30.0, 280.0, 70.0, 10.0, 40.0, 80.0, -260.0, -20.0, 120.0, 180.0, 160.0, 0.0, 160.0, 120.0, 510.0, 20.0, 40.0, 0.0, 0.0, 0.0, 40.0, 70.0, 20.0, 0.0, 10.0, 0.0, 280.0, 50.0, 140.0, 20.0, 80.0, 50.0, 60.0, 70.0, 0.0, 30.0, 300.0, 0.0, 120.0, 180.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8967091030843712, "mean_inference_ms": 1.9816696814538814, "mean_action_processing_ms": 0.5187484045307169, "mean_env_wait_ms": 1.6667746091711257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013996362686157227, "StateBufferConnector_ms": 0.010595321655273438, "ViewRequirementAgentConnector_ms": 0.4421970844268799}, "num_episodes": 23, "episode_return_max": 2270.0, "episode_return_min": 40.0, "episode_return_mean": 1122.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.843827080750271, "num_env_steps_trained_throughput_per_sec": 12.843827080750271, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 5360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5360000, "timers": {"training_iteration_time_ms": 1370173.767, "restore_workers_time_ms": 0.014, "training_step_time_ms": 1370173.708, "sample_time_ms": 2981.309, "learn_time_ms": 1367170.524, "learn_throughput": 2.926, "synch_weights_time_ms": 11.26}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "done": false, "training_iteration": 134, "trial_id": "3d3a5_00000", "date": "2024-06-01_18-35-14", "timestamp": 1717281314, "time_this_iter_s": 311.4595320224762, "time_total_s": 72128.99028396606, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a77700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72128.99028396606, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 18.694736842105264, "ram_util_percent": 82.13543859649123}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.739500730404585, "cur_kl_coeff": 5.924925154824679, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0039360836107101334, "vf_loss": 7.3581167161655125, "vf_explained_var": 0.0003884048063280229, "kl": Infinity, "entropy": 0.21150605561443792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1262955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 40.0, "episode_reward_mean": 1144.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 114.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1460.0, 1180.0, 960.0, 1110.0, 1450.0, 1740.0, 950.0, 1300.0, 1390.0, 1170.0, 570.0, 940.0, 1130.0, 1310.0, 2270.0, 600.0, 1310.0, 970.0, 895.0, 310.0, 1645.0, 1580.0, 1330.0, 1660.0, 1550.0, 1250.0, 1300.0, 1625.0, 1870.0, 825.0, 600.0, 250.0, 340.0, 1490.0, 1470.0, 1550.0, 1355.0, 490.0, 1190.0, 670.0, 1365.0, 1865.0, 1080.0, 170.0, 1060.0, 1125.0, 1070.0, 930.0, 1540.0, 960.0, 440.0, 1470.0, 1280.0, 980.0, 1470.0, 1200.0, 1285.0, 470.0, 1215.0, 1040.0, 1700.0, 1450.0, 1510.0, 800.0, 720.0, 390.0, 1485.0, 1490.0, 880.0, 1460.0, 1230.0, 530.0, 1870.0, 1180.0, 1300.0, 685.0, 1480.0, 1050.0, 200.0, 750.0, 710.0, 40.0, 1400.0, 1565.0, 1700.0, 1120.0, 1240.0, 640.0, 1860.0, 1050.0, 1130.0, 1195.0, 1170.0, 815.0, 1300.0, 1680.0, 1620.0, 1210.0, 1440.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 250.0, 580.0, 100.0, 110.0, 310.0, 40.0, 20.0, 20.0, -10.0, 90.0, 70.0, -30.0, 90.0, 40.0, 300.0, 70.0, 340.0, 60.0, 150.0, 40.0, 230.0, 70.0, 40.0, 70.0, 180.0, 60.0, -10.0, 20.0, 260.0, 90.0, 0.0, 10.0, 20.0, 50.0, 30.0, 430.0, 140.0, 280.0, 60.0, 390.0, 270.0, -10.0, 240.0, 30.0, 20.0, 330.0, 70.0, 70.0, 40.0, 120.0, 20.0, 60.0, 50.0, 310.0, 360.0, 40.0, 620.0, 90.0, 70.0, 20.0, 70.0, 60.0, 100.0, 0.0, 60.0, 20.0, 10.0, 40.0, 570.0, 170.0, 270.0, 40.0, 570.0, -10.0, 60.0, 80.0, 30.0, 30.0, 60.0, 60.0, 80.0, 330.0, 50.0, 10.0, 460.0, 40.0, 10.0, 60.0, 290.0, 510.0, 20.0, 230.0, 20.0, 30.0, 180.0, 90.0, 10.0, 20.0, 60.0, 10.0, 120.0, 100.0, 40.0, 10.0, 60.0, 20.0, 50.0, 10.0, 150.0, 120.0, 110.0, 20.0, 0.0, 200.0, 30.0, 0.0, 20.0, 80.0, 360.0, 420.0, 280.0, 40.0, 40.0, 10.0, 40.0, 70.0, 40.0, 30.0, 160.0, 350.0, 30.0, -10.0, 20.0, 160.0, 350.0, 200.0, 0.0, 140.0, 70.0, 150.0, 20.0, 420.0, 190.0, 580.0, 270.0, 90.0, 650.0, -60.0, -40.0, 30.0, 20.0, 10.0, 240.0, 180.0, 30.0, 50.0, 20.0, 20.0, 0.0, 200.0, 10.0, 10.0, 300.0, 50.0, 280.0, 20.0, 150.0, 10.0, 280.0, 90.0, 160.0, 120.0, 40.0, 60.0, 20.0, 300.0, 150.0, 10.0, 20.0, 400.0, 10.0, 50.0, 190.0, 5.0, 70.0, 0.0, 40.0, 100.0, 30.0, 20.0, 20.0, 10.0, 40.0, 0.0, 110.0, 30.0, 20.0, 30.0, 30.0, -30.0, 40.0, 480.0, 610.0, 80.0, 40.0, 250.0, 80.0, 75.0, 20.0, 40.0, -10.0, 390.0, 290.0, 30.0, 590.0, 10.0, 150.0, 20.0, 70.0, 70.0, 440.0, 170.0, 60.0, 590.0, -40.0, 0.0, -40.0, 10.0, 70.0, 40.0, 290.0, 320.0, 40.0, 240.0, 160.0, 40.0, 170.0, 40.0, 320.0, 230.0, 220.0, 40.0, 10.0, 140.0, 160.0, 170.0, 300.0, 90.0, 190.0, 60.0, 80.0, 50.0, 10.0, 180.0, 690.0, 0.0, 130.0, 20.0, 30.0, 30.0, 400.0, 50.0, 0.0, 30.0, 60.0, 140.0, 260.0, 70.0, 260.0, 0.0, 50.0, 40.0, 165.0, 90.0, 610.0, 460.0, 150.0, 30.0, 30.0, 90.0, 300.0, 50.0, 20.0, 700.0, 90.0, 210.0, 300.0, 20.0, 90.0, 290.0, -5.0, 0.0, 20.0, 10.0, 150.0, 110.0, 30.0, 70.0, 150.0, 30.0, 80.0, 60.0, 30.0, 90.0, 160.0, 20.0, 30.0, 10.0, 90.0, 120.0, 10.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 180.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 230.0, -40.0, 460.0, 60.0, 0.0, 40.0, 590.0, 30.0, 10.0, 110.0, 50.0, 30.0, 170.0, 170.0, 460.0, 90.0, 180.0, 90.0, 50.0, 180.0, 320.0, 10.0, 0.0, 50.0, 280.0, 190.0, 510.0, 20.0, 10.0, 160.0, 30.0, 5.0, 100.0, -10.0, 520.0, 20.0, 380.0, 20.0, 200.0, 90.0, 10.0, 50.0, 10.0, 0.0, 140.0, 200.0, 20.0, 0.0, 20.0, 40.0, 90.0, 160.0, 120.0, 100.0, 50.0, -10.0, -50.0, 170.0, 520.0, 40.0, 80.0, 20.0, 0.0, 30.0, -50.0, -30.0, -50.0, 10.0, 350.0, 310.0, 80.0, 420.0, 10.0, 315.0, 160.0, 90.0, 70.0, 100.0, 40.0, 80.0, 90.0, 950.0, 70.0, 90.0, 230.0, 180.0, 55.0, 40.0, 80.0, 80.0, 50.0, 180.0, 40.0, 190.0, 0.0, 30.0, 20.0, 490.0, 40.0, 40.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 50.0, 0.0, 60.0, 200.0, 40.0, 0.0, 390.0, 100.0, 50.0, 40.0, 170.0, 10.0, 280.0, 200.0, 20.0, 20.0, 60.0, 80.0, 230.0, -45.0, 250.0, 30.0, 190.0, 40.0, 260.0, 160.0, 20.0, 230.0, 60.0, 50.0, 40.0, 20.0, 40.0, 10.0, 220.0, 0.0, 380.0, 100.0, -60.0, 160.0, 100.0, -20.0, 110.0, 50.0, -30.0, 130.0, 30.0, 230.0, 50.0, 470.0, 370.0, 130.0, 20.0, 60.0, 10.0, 100.0, 80.0, 0.0, 320.0, 100.0, 10.0, 260.0, 20.0, 20.0, 50.0, 50.0, 30.0, 0.0, 40.0, 180.0, 30.0, 20.0, 70.0, 180.0, 30.0, 150.0, 90.0, 550.0, 280.0, 50.0, 30.0, 40.0, 280.0, 260.0, 90.0, 100.0, 280.0, 30.0, 150.0, 10.0, 40.0, 40.0, 110.0, 0.0, 0.0, 40.0, 50.0, 20.0, 150.0, 550.0, 60.0, 0.0, 170.0, 180.0, 320.0, 10.0, 360.0, 100.0, 220.0, 50.0, -30.0, 90.0, 40.0, 10.0, 30.0, 110.0, 310.0, 80.0, 80.0, 80.0, 380.0, 80.0, -15.0, 380.0, 200.0, 60.0, 420.0, 70.0, 10.0, 100.0, 40.0, 20.0, 10.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 10.0, 50.0, 300.0, 20.0, 420.0, 20.0, 10.0, 60.0, 60.0, 275.0, 70.0, 20.0, 260.0, 190.0, 260.0, -20.0, 30.0, 110.0, 10.0, 70.0, 10.0, 200.0, 180.0, 40.0, 160.0, 0.0, 60.0, 70.0, 170.0, 40.0, 20.0, 840.0, 300.0, 280.0, 390.0, 190.0, 220.0, 20.0, 120.0, 130.0, 30.0, 30.0, 40.0, 110.0, 70.0, 90.0, 310.0, 160.0, 180.0, 10.0, 10.0, 490.0, 80.0, 100.0, 180.0, 80.0, 100.0, 15.0, -25.0, 70.0, 90.0, 180.0, 10.0, 420.0, -20.0, 0.0, 220.0, 20.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 40.0, 10.0, 40.0, 30.0, -30.0, 260.0, -50.0, 10.0, 50.0, 150.0, 30.0, 60.0, -75.0, 760.0, 20.0, 30.0, -10.0, 40.0, 480.0, 220.0, 170.0, 70.0, 70.0, 70.0, 60.0, 80.0, 630.0, 50.0, 70.0, 20.0, 10.0, 0.0, 140.0, -120.0, 20.0, 630.0, 100.0, 70.0, 10.0, 270.0, 40.0, 120.0, 20.0, 100.0, 80.0, 30.0, 80.0, 660.0, 60.0, 90.0, 40.0, 80.0, 390.0, 40.0, 480.0, 40.0, 80.0, 0.0, -10.0, 0.0, 50.0, 30.0, 10.0, 50.0, 170.0, 160.0, 50.0, 0.0, 10.0, 720.0, 60.0, 500.0, 100.0, -30.0, 70.0, 130.0, 60.0, 260.0, 0.0, 20.0, 430.0, 80.0, 30.0, 30.0, 10.0, 50.0, 240.0, -20.0, 310.0, 160.0, 130.0, 100.0, 30.0, 280.0, 10.0, 170.0, 160.0, 130.0, 130.0, 60.0, 110.0, 20.0, 40.0, 160.0, 0.0, 5.0, 160.0, 0.0, 130.0, 50.0, 60.0, 650.0, 100.0, 190.0, 30.0, 280.0, 70.0, 10.0, 40.0, 80.0, -260.0, -20.0, 120.0, 180.0, 160.0, 0.0, 160.0, 120.0, 510.0, 20.0, 40.0, 0.0, 0.0, 0.0, 40.0, 70.0, 20.0, 0.0, 10.0, 0.0, 280.0, 50.0, 140.0, 20.0, 80.0, 50.0, 60.0, 70.0, 0.0, 30.0, 300.0, 0.0, 120.0, 180.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 290.0, 90.0, 10.0, 70.0, 480.0, 90.0, 20.0, 70.0, 20.0, 260.0, 100.0, 150.0, 240.0, 15.0, 190.0, 260.0, 270.0, 60.0, 230.0, 50.0, 50.0, 30.0, 310.0, 340.0, 430.0, 240.0, 20.0, 20.0, 10.0, 250.0, 40.0, 200.0, 90.0, 170.0, 100.0, 10.0, 510.0, 10.0, -30.0, 20.0, 120.0, 310.0, 90.0, 230.0, 100.0, 70.0, 10.0, 80.0, 90.0, 140.0, 0.0, 40.0, 50.0, 130.0, 30.0, 60.0, 200.0, 10.0, 40.0, 80.0, 560.0, 90.0, -20.0, 60.0, -40.0, 160.0, 360.0, 50.0, 550.0, 90.0, 10.0, 30.0, -30.0, 80.0, 10.0, -40.0, 40.0, 370.0, 560.0, 20.0, 10.0, -170.0, 300.0, 320.0, 390.0, 50.0, 40.0, 60.0, 100.0, 30.0, 30.0, 170.0, 15.0, 20.0, 50.0, 0.0, 160.0, 90.0, 200.0, 460.0, -30.0, 60.0, 490.0, 70.0, -50.0, 150.0, 130.0, 20.0, 60.0, 270.0, 65.0, 100.0, 80.0, 40.0, 40.0, 40.0, 10.0, 390.0, 50.0, 0.0, 40.0, 30.0, 20.0, 190.0, 160.0, 80.0, 120.0, 160.0, 60.0, 440.0, 250.0, 510.0, 40.0, 30.0, 140.0, 30.0, 90.0, 270.0, 60.0, 260.0, 100.0, 180.0, 240.0, 90.0, 340.0, 100.0, 410.0, 20.0, 90.0, 50.0, 70.0, 70.0, 60.0, 150.0, 330.0, 240.0, 20.0, 70.0, 50.0, 150.0, 470.0, 230.0, 370.0, 80.0, 20.0, 40.0, 120.0, 80.0, 30.0, 0.0, 0.0, 60.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 160.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8966733047178526, "mean_inference_ms": 1.983988415961474, "mean_action_processing_ms": 0.5189152312080789, "mean_env_wait_ms": 1.6669961389352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013346195220947266, "StateBufferConnector_ms": 0.010404825210571289, "ViewRequirementAgentConnector_ms": 0.43644094467163086}, "num_episodes": 18, "episode_return_max": 2270.0, "episode_return_min": 40.0, "episode_return_mean": 1144.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 10.666164737161518, "num_env_steps_trained_throughput_per_sec": 10.666164737161518, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 5400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5400000, "timers": {"training_iteration_time_ms": 1350736.395, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1350736.342, "sample_time_ms": 2703.407, "learn_time_ms": 1348010.288, "learn_throughput": 2.967, "synch_weights_time_ms": 11.364}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "done": false, "training_iteration": 135, "trial_id": "3d3a5_00000", "date": "2024-06-01_18-41-29", "timestamp": 1717281689, "time_this_iter_s": 375.04997181892395, "time_total_s": 72504.04025578499, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7dc040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72504.04025578499, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 20.26159169550173, "ram_util_percent": 82.4159169550173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9292056578734176, "cur_kl_coeff": 8.88738773223702, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0026780084982817877, "vf_loss": 7.036620702073216, "vf_explained_var": 0.0006937811295953168, "kl": Infinity, "entropy": 0.2238942998024031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1272345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "env_runners": {"episode_reward_max": 2120.0, "episode_reward_min": 40.0, "episode_reward_mean": 1141.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 114.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1330.0, 1660.0, 1550.0, 1250.0, 1300.0, 1625.0, 1870.0, 825.0, 600.0, 250.0, 340.0, 1490.0, 1470.0, 1550.0, 1355.0, 490.0, 1190.0, 670.0, 1365.0, 1865.0, 1080.0, 170.0, 1060.0, 1125.0, 1070.0, 930.0, 1540.0, 960.0, 440.0, 1470.0, 1280.0, 980.0, 1470.0, 1200.0, 1285.0, 470.0, 1215.0, 1040.0, 1700.0, 1450.0, 1510.0, 800.0, 720.0, 390.0, 1485.0, 1490.0, 880.0, 1460.0, 1230.0, 530.0, 1870.0, 1180.0, 1300.0, 685.0, 1480.0, 1050.0, 200.0, 750.0, 710.0, 40.0, 1400.0, 1565.0, 1700.0, 1120.0, 1240.0, 640.0, 1860.0, 1050.0, 1130.0, 1195.0, 1170.0, 815.0, 1300.0, 1680.0, 1620.0, 1210.0, 1440.0, 370.0, 1360.0, 2120.0, 360.0, 440.0, 1290.0, 1320.0, 1780.0, 1520.0, 760.0, 1370.0, 1010.0, 1460.0, 1555.0, 985.0, 1270.0, 850.0, 1170.0, 1090.0, 480.0, 1170.0, 1320.0, 1180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 440.0, 170.0, 60.0, 590.0, -40.0, 0.0, -40.0, 10.0, 70.0, 40.0, 290.0, 320.0, 40.0, 240.0, 160.0, 40.0, 170.0, 40.0, 320.0, 230.0, 220.0, 40.0, 10.0, 140.0, 160.0, 170.0, 300.0, 90.0, 190.0, 60.0, 80.0, 50.0, 10.0, 180.0, 690.0, 0.0, 130.0, 20.0, 30.0, 30.0, 400.0, 50.0, 0.0, 30.0, 60.0, 140.0, 260.0, 70.0, 260.0, 0.0, 50.0, 40.0, 165.0, 90.0, 610.0, 460.0, 150.0, 30.0, 30.0, 90.0, 300.0, 50.0, 20.0, 700.0, 90.0, 210.0, 300.0, 20.0, 90.0, 290.0, -5.0, 0.0, 20.0, 10.0, 150.0, 110.0, 30.0, 70.0, 150.0, 30.0, 80.0, 60.0, 30.0, 90.0, 160.0, 20.0, 30.0, 10.0, 90.0, 120.0, 10.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 180.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 230.0, -40.0, 460.0, 60.0, 0.0, 40.0, 590.0, 30.0, 10.0, 110.0, 50.0, 30.0, 170.0, 170.0, 460.0, 90.0, 180.0, 90.0, 50.0, 180.0, 320.0, 10.0, 0.0, 50.0, 280.0, 190.0, 510.0, 20.0, 10.0, 160.0, 30.0, 5.0, 100.0, -10.0, 520.0, 20.0, 380.0, 20.0, 200.0, 90.0, 10.0, 50.0, 10.0, 0.0, 140.0, 200.0, 20.0, 0.0, 20.0, 40.0, 90.0, 160.0, 120.0, 100.0, 50.0, -10.0, -50.0, 170.0, 520.0, 40.0, 80.0, 20.0, 0.0, 30.0, -50.0, -30.0, -50.0, 10.0, 350.0, 310.0, 80.0, 420.0, 10.0, 315.0, 160.0, 90.0, 70.0, 100.0, 40.0, 80.0, 90.0, 950.0, 70.0, 90.0, 230.0, 180.0, 55.0, 40.0, 80.0, 80.0, 50.0, 180.0, 40.0, 190.0, 0.0, 30.0, 20.0, 490.0, 40.0, 40.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 50.0, 0.0, 60.0, 200.0, 40.0, 0.0, 390.0, 100.0, 50.0, 40.0, 170.0, 10.0, 280.0, 200.0, 20.0, 20.0, 60.0, 80.0, 230.0, -45.0, 250.0, 30.0, 190.0, 40.0, 260.0, 160.0, 20.0, 230.0, 60.0, 50.0, 40.0, 20.0, 40.0, 10.0, 220.0, 0.0, 380.0, 100.0, -60.0, 160.0, 100.0, -20.0, 110.0, 50.0, -30.0, 130.0, 30.0, 230.0, 50.0, 470.0, 370.0, 130.0, 20.0, 60.0, 10.0, 100.0, 80.0, 0.0, 320.0, 100.0, 10.0, 260.0, 20.0, 20.0, 50.0, 50.0, 30.0, 0.0, 40.0, 180.0, 30.0, 20.0, 70.0, 180.0, 30.0, 150.0, 90.0, 550.0, 280.0, 50.0, 30.0, 40.0, 280.0, 260.0, 90.0, 100.0, 280.0, 30.0, 150.0, 10.0, 40.0, 40.0, 110.0, 0.0, 0.0, 40.0, 50.0, 20.0, 150.0, 550.0, 60.0, 0.0, 170.0, 180.0, 320.0, 10.0, 360.0, 100.0, 220.0, 50.0, -30.0, 90.0, 40.0, 10.0, 30.0, 110.0, 310.0, 80.0, 80.0, 80.0, 380.0, 80.0, -15.0, 380.0, 200.0, 60.0, 420.0, 70.0, 10.0, 100.0, 40.0, 20.0, 10.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 10.0, 50.0, 300.0, 20.0, 420.0, 20.0, 10.0, 60.0, 60.0, 275.0, 70.0, 20.0, 260.0, 190.0, 260.0, -20.0, 30.0, 110.0, 10.0, 70.0, 10.0, 200.0, 180.0, 40.0, 160.0, 0.0, 60.0, 70.0, 170.0, 40.0, 20.0, 840.0, 300.0, 280.0, 390.0, 190.0, 220.0, 20.0, 120.0, 130.0, 30.0, 30.0, 40.0, 110.0, 70.0, 90.0, 310.0, 160.0, 180.0, 10.0, 10.0, 490.0, 80.0, 100.0, 180.0, 80.0, 100.0, 15.0, -25.0, 70.0, 90.0, 180.0, 10.0, 420.0, -20.0, 0.0, 220.0, 20.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 40.0, 10.0, 40.0, 30.0, -30.0, 260.0, -50.0, 10.0, 50.0, 150.0, 30.0, 60.0, -75.0, 760.0, 20.0, 30.0, -10.0, 40.0, 480.0, 220.0, 170.0, 70.0, 70.0, 70.0, 60.0, 80.0, 630.0, 50.0, 70.0, 20.0, 10.0, 0.0, 140.0, -120.0, 20.0, 630.0, 100.0, 70.0, 10.0, 270.0, 40.0, 120.0, 20.0, 100.0, 80.0, 30.0, 80.0, 660.0, 60.0, 90.0, 40.0, 80.0, 390.0, 40.0, 480.0, 40.0, 80.0, 0.0, -10.0, 0.0, 50.0, 30.0, 10.0, 50.0, 170.0, 160.0, 50.0, 0.0, 10.0, 720.0, 60.0, 500.0, 100.0, -30.0, 70.0, 130.0, 60.0, 260.0, 0.0, 20.0, 430.0, 80.0, 30.0, 30.0, 10.0, 50.0, 240.0, -20.0, 310.0, 160.0, 130.0, 100.0, 30.0, 280.0, 10.0, 170.0, 160.0, 130.0, 130.0, 60.0, 110.0, 20.0, 40.0, 160.0, 0.0, 5.0, 160.0, 0.0, 130.0, 50.0, 60.0, 650.0, 100.0, 190.0, 30.0, 280.0, 70.0, 10.0, 40.0, 80.0, -260.0, -20.0, 120.0, 180.0, 160.0, 0.0, 160.0, 120.0, 510.0, 20.0, 40.0, 0.0, 0.0, 0.0, 40.0, 70.0, 20.0, 0.0, 10.0, 0.0, 280.0, 50.0, 140.0, 20.0, 80.0, 50.0, 60.0, 70.0, 0.0, 30.0, 300.0, 0.0, 120.0, 180.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 290.0, 90.0, 10.0, 70.0, 480.0, 90.0, 20.0, 70.0, 20.0, 260.0, 100.0, 150.0, 240.0, 15.0, 190.0, 260.0, 270.0, 60.0, 230.0, 50.0, 50.0, 30.0, 310.0, 340.0, 430.0, 240.0, 20.0, 20.0, 10.0, 250.0, 40.0, 200.0, 90.0, 170.0, 100.0, 10.0, 510.0, 10.0, -30.0, 20.0, 120.0, 310.0, 90.0, 230.0, 100.0, 70.0, 10.0, 80.0, 90.0, 140.0, 0.0, 40.0, 50.0, 130.0, 30.0, 60.0, 200.0, 10.0, 40.0, 80.0, 560.0, 90.0, -20.0, 60.0, -40.0, 160.0, 360.0, 50.0, 550.0, 90.0, 10.0, 30.0, -30.0, 80.0, 10.0, -40.0, 40.0, 370.0, 560.0, 20.0, 10.0, -170.0, 300.0, 320.0, 390.0, 50.0, 40.0, 60.0, 100.0, 30.0, 30.0, 170.0, 15.0, 20.0, 50.0, 0.0, 160.0, 90.0, 200.0, 460.0, -30.0, 60.0, 490.0, 70.0, -50.0, 150.0, 130.0, 20.0, 60.0, 270.0, 65.0, 100.0, 80.0, 40.0, 40.0, 40.0, 10.0, 390.0, 50.0, 0.0, 40.0, 30.0, 20.0, 190.0, 160.0, 80.0, 120.0, 160.0, 60.0, 440.0, 250.0, 510.0, 40.0, 30.0, 140.0, 30.0, 90.0, 270.0, 60.0, 260.0, 100.0, 180.0, 240.0, 90.0, 340.0, 100.0, 410.0, 20.0, 90.0, 50.0, 70.0, 70.0, 60.0, 150.0, 330.0, 240.0, 20.0, 70.0, 50.0, 150.0, 470.0, 230.0, 370.0, 80.0, 20.0, 40.0, 120.0, 80.0, 30.0, 0.0, 0.0, 60.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 160.0, 20.0, 320.0, 70.0, 50.0, 210.0, 110.0, 290.0, 40.0, 160.0, 40.0, 70.0, 520.0, 100.0, 600.0, 200.0, 110.0, 60.0, 310.0, 130.0, 40.0, 50.0, 50.0, 10.0, 40.0, 10.0, 10.0, 140.0, 20.0, 30.0, 0.0, 50.0, -80.0, 70.0, 40.0, 190.0, 50.0, 150.0, 0.0, 10.0, 10.0, 0.0, -30.0, 30.0, 190.0, 60.0, 160.0, 440.0, 20.0, 70.0, 10.0, 340.0, 80.0, 300.0, 20.0, 110.0, 40.0, 10.0, 180.0, 450.0, 50.0, 80.0, 50.0, 180.0, 80.0, 0.0, 390.0, 120.0, 190.0, 620.0, 40.0, 110.0, 330.0, 20.0, 20.0, 430.0, -20.0, 90.0, 410.0, 140.0, 10.0, 90.0, 20.0, 0.0, 250.0, 40.0, 10.0, 10.0, -40.0, 0.0, 0.0, 470.0, 80.0, 110.0, 20.0, 60.0, 110.0, 60.0, 810.0, -10.0, 70.0, 60.0, 40.0, 10.0, 110.0, 10.0, 20.0, 260.0, 40.0, 0.0, 260.0, 260.0, 40.0, 310.0, 70.0, 280.0, 80.0, 210.0, 20.0, 50.0, 40.0, 360.0, 90.0, 140.0, 30.0, 760.0, 165.0, 10.0, 80.0, 40.0, 230.0, 10.0, 0.0, 260.0, 30.0, 120.0, -25.0, 0.0, 150.0, 230.0, 110.0, 110.0, 10.0, 90.0, 30.0, 250.0, 70.0, 130.0, 70.0, 170.0, 70.0, 380.0, 200.0, 20.0, 40.0, 40.0, 30.0, 50.0, 340.0, 10.0, 110.0, 10.0, 300.0, -40.0, 30.0, 150.0, 270.0, 30.0, 60.0, 110.0, 20.0, 240.0, 30.0, 40.0, 110.0, 90.0, 100.0, 30.0, 90.0, 560.0, 10.0, 30.0, 0.0, 40.0, 120.0, -20.0, 20.0, 0.0, 0.0, 20.0, 290.0, 10.0, 20.0, 130.0, 30.0, 60.0, 20.0, 220.0, 10.0, 40.0, 90.0, 550.0, 40.0, 70.0, 90.0, 110.0, -50.0, 70.0, 50.0, 170.0, 20.0, 750.0, 40.0, 20.0, 50.0, 20.0, 140.0, 50.0, 480.0, 270.0, 70.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8929980961775434, "mean_inference_ms": 1.9813553340301462, "mean_action_processing_ms": 0.5179850930121366, "mean_env_wait_ms": 1.6642412122320938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013315916061401367, "StateBufferConnector_ms": 0.010376453399658203, "ViewRequirementAgentConnector_ms": 0.4472968578338623}, "num_episodes": 22, "episode_return_max": 2120.0, "episode_return_min": 40.0, "episode_return_mean": 1141.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 10.93878886758226, "num_env_steps_trained_throughput_per_sec": 10.93878886758226, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 5440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5440000, "timers": {"training_iteration_time_ms": 1296404.949, "restore_workers_time_ms": 0.013, "training_step_time_ms": 1296404.896, "sample_time_ms": 2733.812, "learn_time_ms": 1293648.381, "learn_throughput": 3.092, "synch_weights_time_ms": 11.656}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "done": false, "training_iteration": 136, "trial_id": "3d3a5_00000", "date": "2024-06-01_18-47-35", "timestamp": 1717282055, "time_this_iter_s": 365.73353815078735, "time_total_s": 72869.77379393578, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x31f7fed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72869.77379393578, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 21.230344827586208, "ram_util_percent": 82.30896551724138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0418104634307825, "cur_kl_coeff": 13.331081598355526, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0025446708409087903, "vf_loss": 6.044844629817877, "vf_explained_var": 0.0004448747101683205, "kl": Infinity, "entropy": 0.20510236014065525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1281735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "env_runners": {"episode_reward_max": 2120.0, "episode_reward_min": 40.0, "episode_reward_mean": 1108.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 110.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1365.0, 1865.0, 1080.0, 170.0, 1060.0, 1125.0, 1070.0, 930.0, 1540.0, 960.0, 440.0, 1470.0, 1280.0, 980.0, 1470.0, 1200.0, 1285.0, 470.0, 1215.0, 1040.0, 1700.0, 1450.0, 1510.0, 800.0, 720.0, 390.0, 1485.0, 1490.0, 880.0, 1460.0, 1230.0, 530.0, 1870.0, 1180.0, 1300.0, 685.0, 1480.0, 1050.0, 200.0, 750.0, 710.0, 40.0, 1400.0, 1565.0, 1700.0, 1120.0, 1240.0, 640.0, 1860.0, 1050.0, 1130.0, 1195.0, 1170.0, 815.0, 1300.0, 1680.0, 1620.0, 1210.0, 1440.0, 370.0, 1360.0, 2120.0, 360.0, 440.0, 1290.0, 1320.0, 1780.0, 1520.0, 760.0, 1370.0, 1010.0, 1460.0, 1555.0, 985.0, 1270.0, 850.0, 1170.0, 1090.0, 480.0, 1170.0, 1320.0, 1180.0, 960.0, 1350.0, 1700.0, 420.0, 410.0, 1290.0, 1550.0, 410.0, 1050.0, 1460.0, 870.0, 800.0, 990.0, 270.0, 1150.0, 1260.0, 850.0, 810.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 420.0, 10.0, 315.0, 160.0, 90.0, 70.0, 100.0, 40.0, 80.0, 90.0, 950.0, 70.0, 90.0, 230.0, 180.0, 55.0, 40.0, 80.0, 80.0, 50.0, 180.0, 40.0, 190.0, 0.0, 30.0, 20.0, 490.0, 40.0, 40.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 50.0, 0.0, 60.0, 200.0, 40.0, 0.0, 390.0, 100.0, 50.0, 40.0, 170.0, 10.0, 280.0, 200.0, 20.0, 20.0, 60.0, 80.0, 230.0, -45.0, 250.0, 30.0, 190.0, 40.0, 260.0, 160.0, 20.0, 230.0, 60.0, 50.0, 40.0, 20.0, 40.0, 10.0, 220.0, 0.0, 380.0, 100.0, -60.0, 160.0, 100.0, -20.0, 110.0, 50.0, -30.0, 130.0, 30.0, 230.0, 50.0, 470.0, 370.0, 130.0, 20.0, 60.0, 10.0, 100.0, 80.0, 0.0, 320.0, 100.0, 10.0, 260.0, 20.0, 20.0, 50.0, 50.0, 30.0, 0.0, 40.0, 180.0, 30.0, 20.0, 70.0, 180.0, 30.0, 150.0, 90.0, 550.0, 280.0, 50.0, 30.0, 40.0, 280.0, 260.0, 90.0, 100.0, 280.0, 30.0, 150.0, 10.0, 40.0, 40.0, 110.0, 0.0, 0.0, 40.0, 50.0, 20.0, 150.0, 550.0, 60.0, 0.0, 170.0, 180.0, 320.0, 10.0, 360.0, 100.0, 220.0, 50.0, -30.0, 90.0, 40.0, 10.0, 30.0, 110.0, 310.0, 80.0, 80.0, 80.0, 380.0, 80.0, -15.0, 380.0, 200.0, 60.0, 420.0, 70.0, 10.0, 100.0, 40.0, 20.0, 10.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 10.0, 50.0, 300.0, 20.0, 420.0, 20.0, 10.0, 60.0, 60.0, 275.0, 70.0, 20.0, 260.0, 190.0, 260.0, -20.0, 30.0, 110.0, 10.0, 70.0, 10.0, 200.0, 180.0, 40.0, 160.0, 0.0, 60.0, 70.0, 170.0, 40.0, 20.0, 840.0, 300.0, 280.0, 390.0, 190.0, 220.0, 20.0, 120.0, 130.0, 30.0, 30.0, 40.0, 110.0, 70.0, 90.0, 310.0, 160.0, 180.0, 10.0, 10.0, 490.0, 80.0, 100.0, 180.0, 80.0, 100.0, 15.0, -25.0, 70.0, 90.0, 180.0, 10.0, 420.0, -20.0, 0.0, 220.0, 20.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 40.0, 10.0, 40.0, 30.0, -30.0, 260.0, -50.0, 10.0, 50.0, 150.0, 30.0, 60.0, -75.0, 760.0, 20.0, 30.0, -10.0, 40.0, 480.0, 220.0, 170.0, 70.0, 70.0, 70.0, 60.0, 80.0, 630.0, 50.0, 70.0, 20.0, 10.0, 0.0, 140.0, -120.0, 20.0, 630.0, 100.0, 70.0, 10.0, 270.0, 40.0, 120.0, 20.0, 100.0, 80.0, 30.0, 80.0, 660.0, 60.0, 90.0, 40.0, 80.0, 390.0, 40.0, 480.0, 40.0, 80.0, 0.0, -10.0, 0.0, 50.0, 30.0, 10.0, 50.0, 170.0, 160.0, 50.0, 0.0, 10.0, 720.0, 60.0, 500.0, 100.0, -30.0, 70.0, 130.0, 60.0, 260.0, 0.0, 20.0, 430.0, 80.0, 30.0, 30.0, 10.0, 50.0, 240.0, -20.0, 310.0, 160.0, 130.0, 100.0, 30.0, 280.0, 10.0, 170.0, 160.0, 130.0, 130.0, 60.0, 110.0, 20.0, 40.0, 160.0, 0.0, 5.0, 160.0, 0.0, 130.0, 50.0, 60.0, 650.0, 100.0, 190.0, 30.0, 280.0, 70.0, 10.0, 40.0, 80.0, -260.0, -20.0, 120.0, 180.0, 160.0, 0.0, 160.0, 120.0, 510.0, 20.0, 40.0, 0.0, 0.0, 0.0, 40.0, 70.0, 20.0, 0.0, 10.0, 0.0, 280.0, 50.0, 140.0, 20.0, 80.0, 50.0, 60.0, 70.0, 0.0, 30.0, 300.0, 0.0, 120.0, 180.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 290.0, 90.0, 10.0, 70.0, 480.0, 90.0, 20.0, 70.0, 20.0, 260.0, 100.0, 150.0, 240.0, 15.0, 190.0, 260.0, 270.0, 60.0, 230.0, 50.0, 50.0, 30.0, 310.0, 340.0, 430.0, 240.0, 20.0, 20.0, 10.0, 250.0, 40.0, 200.0, 90.0, 170.0, 100.0, 10.0, 510.0, 10.0, -30.0, 20.0, 120.0, 310.0, 90.0, 230.0, 100.0, 70.0, 10.0, 80.0, 90.0, 140.0, 0.0, 40.0, 50.0, 130.0, 30.0, 60.0, 200.0, 10.0, 40.0, 80.0, 560.0, 90.0, -20.0, 60.0, -40.0, 160.0, 360.0, 50.0, 550.0, 90.0, 10.0, 30.0, -30.0, 80.0, 10.0, -40.0, 40.0, 370.0, 560.0, 20.0, 10.0, -170.0, 300.0, 320.0, 390.0, 50.0, 40.0, 60.0, 100.0, 30.0, 30.0, 170.0, 15.0, 20.0, 50.0, 0.0, 160.0, 90.0, 200.0, 460.0, -30.0, 60.0, 490.0, 70.0, -50.0, 150.0, 130.0, 20.0, 60.0, 270.0, 65.0, 100.0, 80.0, 40.0, 40.0, 40.0, 10.0, 390.0, 50.0, 0.0, 40.0, 30.0, 20.0, 190.0, 160.0, 80.0, 120.0, 160.0, 60.0, 440.0, 250.0, 510.0, 40.0, 30.0, 140.0, 30.0, 90.0, 270.0, 60.0, 260.0, 100.0, 180.0, 240.0, 90.0, 340.0, 100.0, 410.0, 20.0, 90.0, 50.0, 70.0, 70.0, 60.0, 150.0, 330.0, 240.0, 20.0, 70.0, 50.0, 150.0, 470.0, 230.0, 370.0, 80.0, 20.0, 40.0, 120.0, 80.0, 30.0, 0.0, 0.0, 60.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 160.0, 20.0, 320.0, 70.0, 50.0, 210.0, 110.0, 290.0, 40.0, 160.0, 40.0, 70.0, 520.0, 100.0, 600.0, 200.0, 110.0, 60.0, 310.0, 130.0, 40.0, 50.0, 50.0, 10.0, 40.0, 10.0, 10.0, 140.0, 20.0, 30.0, 0.0, 50.0, -80.0, 70.0, 40.0, 190.0, 50.0, 150.0, 0.0, 10.0, 10.0, 0.0, -30.0, 30.0, 190.0, 60.0, 160.0, 440.0, 20.0, 70.0, 10.0, 340.0, 80.0, 300.0, 20.0, 110.0, 40.0, 10.0, 180.0, 450.0, 50.0, 80.0, 50.0, 180.0, 80.0, 0.0, 390.0, 120.0, 190.0, 620.0, 40.0, 110.0, 330.0, 20.0, 20.0, 430.0, -20.0, 90.0, 410.0, 140.0, 10.0, 90.0, 20.0, 0.0, 250.0, 40.0, 10.0, 10.0, -40.0, 0.0, 0.0, 470.0, 80.0, 110.0, 20.0, 60.0, 110.0, 60.0, 810.0, -10.0, 70.0, 60.0, 40.0, 10.0, 110.0, 10.0, 20.0, 260.0, 40.0, 0.0, 260.0, 260.0, 40.0, 310.0, 70.0, 280.0, 80.0, 210.0, 20.0, 50.0, 40.0, 360.0, 90.0, 140.0, 30.0, 760.0, 165.0, 10.0, 80.0, 40.0, 230.0, 10.0, 0.0, 260.0, 30.0, 120.0, -25.0, 0.0, 150.0, 230.0, 110.0, 110.0, 10.0, 90.0, 30.0, 250.0, 70.0, 130.0, 70.0, 170.0, 70.0, 380.0, 200.0, 20.0, 40.0, 40.0, 30.0, 50.0, 340.0, 10.0, 110.0, 10.0, 300.0, -40.0, 30.0, 150.0, 270.0, 30.0, 60.0, 110.0, 20.0, 240.0, 30.0, 40.0, 110.0, 90.0, 100.0, 30.0, 90.0, 560.0, 10.0, 30.0, 0.0, 40.0, 120.0, -20.0, 20.0, 0.0, 0.0, 20.0, 290.0, 10.0, 20.0, 130.0, 30.0, 60.0, 20.0, 220.0, 10.0, 40.0, 90.0, 550.0, 40.0, 70.0, 90.0, 110.0, -50.0, 70.0, 50.0, 170.0, 20.0, 750.0, 40.0, 20.0, 50.0, 20.0, 140.0, 50.0, 480.0, 270.0, 70.0, 40.0, 20.0, 220.0, 10.0, 10.0, 10.0, 30.0, 130.0, 280.0, 0.0, 250.0, 40.0, 20.0, 40.0, 310.0, 160.0, 50.0, 60.0, 240.0, 330.0, 100.0, 60.0, 170.0, 380.0, 30.0, 200.0, 60.0, 400.0, 10.0, 70.0, 320.0, 30.0, 40.0, 0.0, 0.0, 240.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 240.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 40.0, 330.0, 50.0, 140.0, 180.0, 30.0, 40.0, 20.0, 90.0, 10.0, 400.0, 0.0, 110.0, -30.0, 170.0, 390.0, 30.0, 20.0, 610.0, 60.0, 190.0, 0.0, 200.0, 60.0, 20.0, 0.0, 90.0, 0.0, 0.0, 20.0, 20.0, 40.0, 30.0, 20.0, 500.0, 40.0, 200.0, 10.0, 20.0, 20.0, 170.0, -20.0, 60.0, 30.0, 130.0, 490.0, 110.0, 40.0, 120.0, 200.0, 300.0, 70.0, 60.0, 20.0, 120.0, 240.0, 0.0, 10.0, 100.0, 160.0, 90.0, 40.0, 160.0, 40.0, 350.0, -15.0, 50.0, -5.0, 70.0, 110.0, 0.0, 50.0, 330.0, 0.0, 10.0, 140.0, 20.0, 20.0, 90.0, 30.0, 300.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 20.0, 100.0, 40.0, 20.0, 160.0, 300.0, 30.0, 50.0, 30.0, 60.0, 10.0, 100.0, 340.0, 70.0, 80.0, 40.0, 20.0, 270.0, 160.0, 170.0, 210.0, 130.0, 50.0, 130.0, 0.0, 40.0, 100.0, 50.0, 0.0, 40.0, 110.0, 100.0, 350.0, 60.0, 20.0, 160.0, 280.0, 140.0, 10.0, 20.0, 0.0, 0.0, 80.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8900741500635783, "mean_inference_ms": 1.979125556287553, "mean_action_processing_ms": 0.5172410795965325, "mean_env_wait_ms": 1.661994227607741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013086318969726562, "StateBufferConnector_ms": 0.010140419006347656, "ViewRequirementAgentConnector_ms": 0.4375753402709961}, "num_episodes": 18, "episode_return_max": 2120.0, "episode_return_min": 40.0, "episode_return_mean": 1108.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.763274209400433, "num_env_steps_trained_throughput_per_sec": 3.763274209400433, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 5480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5480000, "timers": {"training_iteration_time_ms": 943092.025, "restore_workers_time_ms": 0.013, "training_step_time_ms": 943091.971, "sample_time_ms": 2734.97, "learn_time_ms": 940332.786, "learn_throughput": 4.254, "synch_weights_time_ms": 11.471}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "done": false, "training_iteration": 137, "trial_id": "3d3a5_00000", "date": "2024-06-01_19-05-18", "timestamp": 1717283118, "time_this_iter_s": 1062.9268889427185, "time_total_s": 73932.7006828785, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a61dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 73932.7006828785, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 21.500340136054422, "ram_util_percent": 82.42755102040816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5510707837831985, "cur_kl_coeff": 19.996622397533297, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.704500368278755, "policy_loss": -0.0018624023658831439, "vf_loss": 6.703769077965246, "vf_explained_var": -7.180345578950307e-05, "kl": 0.00012970636665854044, "entropy": 0.21541358492673396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1291125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "env_runners": {"episode_reward_max": 2120.0, "episode_reward_min": 40.0, "episode_reward_mean": 1087.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 840.0}, "policy_reward_mean": {"policy_0": 108.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1215.0, 1040.0, 1700.0, 1450.0, 1510.0, 800.0, 720.0, 390.0, 1485.0, 1490.0, 880.0, 1460.0, 1230.0, 530.0, 1870.0, 1180.0, 1300.0, 685.0, 1480.0, 1050.0, 200.0, 750.0, 710.0, 40.0, 1400.0, 1565.0, 1700.0, 1120.0, 1240.0, 640.0, 1860.0, 1050.0, 1130.0, 1195.0, 1170.0, 815.0, 1300.0, 1680.0, 1620.0, 1210.0, 1440.0, 370.0, 1360.0, 2120.0, 360.0, 440.0, 1290.0, 1320.0, 1780.0, 1520.0, 760.0, 1370.0, 1010.0, 1460.0, 1555.0, 985.0, 1270.0, 850.0, 1170.0, 1090.0, 480.0, 1170.0, 1320.0, 1180.0, 960.0, 1350.0, 1700.0, 420.0, 410.0, 1290.0, 1550.0, 410.0, 1050.0, 1460.0, 870.0, 800.0, 990.0, 270.0, 1150.0, 1260.0, 850.0, 810.0, 900.0, 630.0, 910.0, 1670.0, 700.0, 990.0, 1400.0, 1020.0, 980.0, 1380.0, 40.0, 935.0, 360.0, 1050.0, 1960.0, 590.0, 1260.0, 870.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 420.0, 20.0, 10.0, 60.0, 60.0, 275.0, 70.0, 20.0, 260.0, 190.0, 260.0, -20.0, 30.0, 110.0, 10.0, 70.0, 10.0, 200.0, 180.0, 40.0, 160.0, 0.0, 60.0, 70.0, 170.0, 40.0, 20.0, 840.0, 300.0, 280.0, 390.0, 190.0, 220.0, 20.0, 120.0, 130.0, 30.0, 30.0, 40.0, 110.0, 70.0, 90.0, 310.0, 160.0, 180.0, 10.0, 10.0, 490.0, 80.0, 100.0, 180.0, 80.0, 100.0, 15.0, -25.0, 70.0, 90.0, 180.0, 10.0, 420.0, -20.0, 0.0, 220.0, 20.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 40.0, 10.0, 40.0, 30.0, -30.0, 260.0, -50.0, 10.0, 50.0, 150.0, 30.0, 60.0, -75.0, 760.0, 20.0, 30.0, -10.0, 40.0, 480.0, 220.0, 170.0, 70.0, 70.0, 70.0, 60.0, 80.0, 630.0, 50.0, 70.0, 20.0, 10.0, 0.0, 140.0, -120.0, 20.0, 630.0, 100.0, 70.0, 10.0, 270.0, 40.0, 120.0, 20.0, 100.0, 80.0, 30.0, 80.0, 660.0, 60.0, 90.0, 40.0, 80.0, 390.0, 40.0, 480.0, 40.0, 80.0, 0.0, -10.0, 0.0, 50.0, 30.0, 10.0, 50.0, 170.0, 160.0, 50.0, 0.0, 10.0, 720.0, 60.0, 500.0, 100.0, -30.0, 70.0, 130.0, 60.0, 260.0, 0.0, 20.0, 430.0, 80.0, 30.0, 30.0, 10.0, 50.0, 240.0, -20.0, 310.0, 160.0, 130.0, 100.0, 30.0, 280.0, 10.0, 170.0, 160.0, 130.0, 130.0, 60.0, 110.0, 20.0, 40.0, 160.0, 0.0, 5.0, 160.0, 0.0, 130.0, 50.0, 60.0, 650.0, 100.0, 190.0, 30.0, 280.0, 70.0, 10.0, 40.0, 80.0, -260.0, -20.0, 120.0, 180.0, 160.0, 0.0, 160.0, 120.0, 510.0, 20.0, 40.0, 0.0, 0.0, 0.0, 40.0, 70.0, 20.0, 0.0, 10.0, 0.0, 280.0, 50.0, 140.0, 20.0, 80.0, 50.0, 60.0, 70.0, 0.0, 30.0, 300.0, 0.0, 120.0, 180.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 290.0, 90.0, 10.0, 70.0, 480.0, 90.0, 20.0, 70.0, 20.0, 260.0, 100.0, 150.0, 240.0, 15.0, 190.0, 260.0, 270.0, 60.0, 230.0, 50.0, 50.0, 30.0, 310.0, 340.0, 430.0, 240.0, 20.0, 20.0, 10.0, 250.0, 40.0, 200.0, 90.0, 170.0, 100.0, 10.0, 510.0, 10.0, -30.0, 20.0, 120.0, 310.0, 90.0, 230.0, 100.0, 70.0, 10.0, 80.0, 90.0, 140.0, 0.0, 40.0, 50.0, 130.0, 30.0, 60.0, 200.0, 10.0, 40.0, 80.0, 560.0, 90.0, -20.0, 60.0, -40.0, 160.0, 360.0, 50.0, 550.0, 90.0, 10.0, 30.0, -30.0, 80.0, 10.0, -40.0, 40.0, 370.0, 560.0, 20.0, 10.0, -170.0, 300.0, 320.0, 390.0, 50.0, 40.0, 60.0, 100.0, 30.0, 30.0, 170.0, 15.0, 20.0, 50.0, 0.0, 160.0, 90.0, 200.0, 460.0, -30.0, 60.0, 490.0, 70.0, -50.0, 150.0, 130.0, 20.0, 60.0, 270.0, 65.0, 100.0, 80.0, 40.0, 40.0, 40.0, 10.0, 390.0, 50.0, 0.0, 40.0, 30.0, 20.0, 190.0, 160.0, 80.0, 120.0, 160.0, 60.0, 440.0, 250.0, 510.0, 40.0, 30.0, 140.0, 30.0, 90.0, 270.0, 60.0, 260.0, 100.0, 180.0, 240.0, 90.0, 340.0, 100.0, 410.0, 20.0, 90.0, 50.0, 70.0, 70.0, 60.0, 150.0, 330.0, 240.0, 20.0, 70.0, 50.0, 150.0, 470.0, 230.0, 370.0, 80.0, 20.0, 40.0, 120.0, 80.0, 30.0, 0.0, 0.0, 60.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 160.0, 20.0, 320.0, 70.0, 50.0, 210.0, 110.0, 290.0, 40.0, 160.0, 40.0, 70.0, 520.0, 100.0, 600.0, 200.0, 110.0, 60.0, 310.0, 130.0, 40.0, 50.0, 50.0, 10.0, 40.0, 10.0, 10.0, 140.0, 20.0, 30.0, 0.0, 50.0, -80.0, 70.0, 40.0, 190.0, 50.0, 150.0, 0.0, 10.0, 10.0, 0.0, -30.0, 30.0, 190.0, 60.0, 160.0, 440.0, 20.0, 70.0, 10.0, 340.0, 80.0, 300.0, 20.0, 110.0, 40.0, 10.0, 180.0, 450.0, 50.0, 80.0, 50.0, 180.0, 80.0, 0.0, 390.0, 120.0, 190.0, 620.0, 40.0, 110.0, 330.0, 20.0, 20.0, 430.0, -20.0, 90.0, 410.0, 140.0, 10.0, 90.0, 20.0, 0.0, 250.0, 40.0, 10.0, 10.0, -40.0, 0.0, 0.0, 470.0, 80.0, 110.0, 20.0, 60.0, 110.0, 60.0, 810.0, -10.0, 70.0, 60.0, 40.0, 10.0, 110.0, 10.0, 20.0, 260.0, 40.0, 0.0, 260.0, 260.0, 40.0, 310.0, 70.0, 280.0, 80.0, 210.0, 20.0, 50.0, 40.0, 360.0, 90.0, 140.0, 30.0, 760.0, 165.0, 10.0, 80.0, 40.0, 230.0, 10.0, 0.0, 260.0, 30.0, 120.0, -25.0, 0.0, 150.0, 230.0, 110.0, 110.0, 10.0, 90.0, 30.0, 250.0, 70.0, 130.0, 70.0, 170.0, 70.0, 380.0, 200.0, 20.0, 40.0, 40.0, 30.0, 50.0, 340.0, 10.0, 110.0, 10.0, 300.0, -40.0, 30.0, 150.0, 270.0, 30.0, 60.0, 110.0, 20.0, 240.0, 30.0, 40.0, 110.0, 90.0, 100.0, 30.0, 90.0, 560.0, 10.0, 30.0, 0.0, 40.0, 120.0, -20.0, 20.0, 0.0, 0.0, 20.0, 290.0, 10.0, 20.0, 130.0, 30.0, 60.0, 20.0, 220.0, 10.0, 40.0, 90.0, 550.0, 40.0, 70.0, 90.0, 110.0, -50.0, 70.0, 50.0, 170.0, 20.0, 750.0, 40.0, 20.0, 50.0, 20.0, 140.0, 50.0, 480.0, 270.0, 70.0, 40.0, 20.0, 220.0, 10.0, 10.0, 10.0, 30.0, 130.0, 280.0, 0.0, 250.0, 40.0, 20.0, 40.0, 310.0, 160.0, 50.0, 60.0, 240.0, 330.0, 100.0, 60.0, 170.0, 380.0, 30.0, 200.0, 60.0, 400.0, 10.0, 70.0, 320.0, 30.0, 40.0, 0.0, 0.0, 240.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 240.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 40.0, 330.0, 50.0, 140.0, 180.0, 30.0, 40.0, 20.0, 90.0, 10.0, 400.0, 0.0, 110.0, -30.0, 170.0, 390.0, 30.0, 20.0, 610.0, 60.0, 190.0, 0.0, 200.0, 60.0, 20.0, 0.0, 90.0, 0.0, 0.0, 20.0, 20.0, 40.0, 30.0, 20.0, 500.0, 40.0, 200.0, 10.0, 20.0, 20.0, 170.0, -20.0, 60.0, 30.0, 130.0, 490.0, 110.0, 40.0, 120.0, 200.0, 300.0, 70.0, 60.0, 20.0, 120.0, 240.0, 0.0, 10.0, 100.0, 160.0, 90.0, 40.0, 160.0, 40.0, 350.0, -15.0, 50.0, -5.0, 70.0, 110.0, 0.0, 50.0, 330.0, 0.0, 10.0, 140.0, 20.0, 20.0, 90.0, 30.0, 300.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 20.0, 100.0, 40.0, 20.0, 160.0, 300.0, 30.0, 50.0, 30.0, 60.0, 10.0, 100.0, 340.0, 70.0, 80.0, 40.0, 20.0, 270.0, 160.0, 170.0, 210.0, 130.0, 50.0, 130.0, 0.0, 40.0, 100.0, 50.0, 0.0, 40.0, 110.0, 100.0, 350.0, 60.0, 20.0, 160.0, 280.0, 140.0, 10.0, 20.0, 0.0, 0.0, 80.0, 100.0, 170.0, 20.0, 20.0, 70.0, 180.0, 80.0, 160.0, 10.0, 110.0, 80.0, 150.0, 10.0, 230.0, 0.0, 10.0, 50.0, 70.0, 80.0, 30.0, 0.0, 50.0, 120.0, 90.0, 10.0, 0.0, 20.0, 10.0, 140.0, 380.0, 90.0, 130.0, 20.0, 60.0, 260.0, 60.0, 170.0, 190.0, 430.0, 330.0, 20.0, 10.0, 130.0, 20.0, 130.0, 10.0, 200.0, 0.0, 30.0, 70.0, 100.0, 230.0, 80.0, 390.0, -210.0, 120.0, 40.0, 120.0, 120.0, 70.0, 30.0, 70.0, 380.0, 560.0, 60.0, 30.0, 0.0, 10.0, 100.0, 170.0, 20.0, 60.0, 10.0, 600.0, 130.0, 10.0, 120.0, 0.0, 50.0, 10.0, 30.0, 270.0, 100.0, 20.0, 180.0, 20.0, 20.0, 390.0, 0.0, 10.0, -30.0, 150.0, 560.0, 190.0, 230.0, 0.0, 10.0, 80.0, 20.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 40.0, 40.0, 300.0, 190.0, 0.0, 50.0, 45.0, 30.0, 210.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 200.0, 50.0, 20.0, 450.0, 30.0, 140.0, 90.0, 50.0, 30.0, 10.0, 270.0, -40.0, 450.0, 50.0, 100.0, 150.0, 110.0, 10.0, 30.0, 660.0, 170.0, 230.0, 160.0, 20.0, -40.0, 370.0, 40.0, 0.0, -5.0, 10.0, 0.0, 35.0, 50.0, 10.0, 240.0, 160.0, 20.0, 0.0, 360.0, 420.0, 30.0, -30.0, 50.0, 40.0, 0.0, 40.0, 50.0, 60.0, 140.0, 40.0, -40.0, 490.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8872568011086452, "mean_inference_ms": 1.9769521146415616, "mean_action_processing_ms": 0.5165183053253962, "mean_env_wait_ms": 1.6598119194736203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01275777816772461, "StateBufferConnector_ms": 0.010568857192993164, "ViewRequirementAgentConnector_ms": 0.4398012161254883}, "num_episodes": 18, "episode_return_max": 2120.0, "episode_return_min": 40.0, "episode_return_mean": 1087.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 10.277115321498341, "num_env_steps_trained_throughput_per_sec": 10.277115321498341, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 5520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5520000, "timers": {"training_iteration_time_ms": 750621.698, "restore_workers_time_ms": 0.013, "training_step_time_ms": 750621.647, "sample_time_ms": 2633.407, "learn_time_ms": 747963.326, "learn_throughput": 5.348, "synch_weights_time_ms": 11.83}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "done": false, "training_iteration": 138, "trial_id": "3d3a5_00000", "date": "2024-06-01_19-11-47", "timestamp": 1717283507, "time_this_iter_s": 389.2247211933136, "time_total_s": 74321.92540407181, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a56670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74321.92540407181, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 18.957142857142856, "ram_util_percent": 81.58118466898955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7090158792603383, "cur_kl_coeff": 9.998311198766649, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6819504634259985, "policy_loss": -0.0028709571274479454, "vf_loss": 6.682150038464255, "vf_explained_var": 0.0001524180078658814, "kl": 0.00026718372341969887, "entropy": 0.22842597676415285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1300515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "env_runners": {"episode_reward_max": 2240.0, "episode_reward_min": 40.0, "episode_reward_mean": 1107.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 110.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 1400.0, 1565.0, 1700.0, 1120.0, 1240.0, 640.0, 1860.0, 1050.0, 1130.0, 1195.0, 1170.0, 815.0, 1300.0, 1680.0, 1620.0, 1210.0, 1440.0, 370.0, 1360.0, 2120.0, 360.0, 440.0, 1290.0, 1320.0, 1780.0, 1520.0, 760.0, 1370.0, 1010.0, 1460.0, 1555.0, 985.0, 1270.0, 850.0, 1170.0, 1090.0, 480.0, 1170.0, 1320.0, 1180.0, 960.0, 1350.0, 1700.0, 420.0, 410.0, 1290.0, 1550.0, 410.0, 1050.0, 1460.0, 870.0, 800.0, 990.0, 270.0, 1150.0, 1260.0, 850.0, 810.0, 900.0, 630.0, 910.0, 1670.0, 700.0, 990.0, 1400.0, 1020.0, 980.0, 1380.0, 40.0, 935.0, 360.0, 1050.0, 1960.0, 590.0, 1260.0, 870.0, 530.0, 1180.0, 850.0, 1485.0, 1110.0, 1420.0, 1090.0, 1190.0, 830.0, 600.0, 1300.0, 1900.0, 1185.0, 120.0, 1480.0, 1200.0, 1515.0, 115.0, 1020.0, 1870.0, 1650.0, 1190.0, 2240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 290.0, 90.0, 10.0, 70.0, 480.0, 90.0, 20.0, 70.0, 20.0, 260.0, 100.0, 150.0, 240.0, 15.0, 190.0, 260.0, 270.0, 60.0, 230.0, 50.0, 50.0, 30.0, 310.0, 340.0, 430.0, 240.0, 20.0, 20.0, 10.0, 250.0, 40.0, 200.0, 90.0, 170.0, 100.0, 10.0, 510.0, 10.0, -30.0, 20.0, 120.0, 310.0, 90.0, 230.0, 100.0, 70.0, 10.0, 80.0, 90.0, 140.0, 0.0, 40.0, 50.0, 130.0, 30.0, 60.0, 200.0, 10.0, 40.0, 80.0, 560.0, 90.0, -20.0, 60.0, -40.0, 160.0, 360.0, 50.0, 550.0, 90.0, 10.0, 30.0, -30.0, 80.0, 10.0, -40.0, 40.0, 370.0, 560.0, 20.0, 10.0, -170.0, 300.0, 320.0, 390.0, 50.0, 40.0, 60.0, 100.0, 30.0, 30.0, 170.0, 15.0, 20.0, 50.0, 0.0, 160.0, 90.0, 200.0, 460.0, -30.0, 60.0, 490.0, 70.0, -50.0, 150.0, 130.0, 20.0, 60.0, 270.0, 65.0, 100.0, 80.0, 40.0, 40.0, 40.0, 10.0, 390.0, 50.0, 0.0, 40.0, 30.0, 20.0, 190.0, 160.0, 80.0, 120.0, 160.0, 60.0, 440.0, 250.0, 510.0, 40.0, 30.0, 140.0, 30.0, 90.0, 270.0, 60.0, 260.0, 100.0, 180.0, 240.0, 90.0, 340.0, 100.0, 410.0, 20.0, 90.0, 50.0, 70.0, 70.0, 60.0, 150.0, 330.0, 240.0, 20.0, 70.0, 50.0, 150.0, 470.0, 230.0, 370.0, 80.0, 20.0, 40.0, 120.0, 80.0, 30.0, 0.0, 0.0, 60.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 160.0, 20.0, 320.0, 70.0, 50.0, 210.0, 110.0, 290.0, 40.0, 160.0, 40.0, 70.0, 520.0, 100.0, 600.0, 200.0, 110.0, 60.0, 310.0, 130.0, 40.0, 50.0, 50.0, 10.0, 40.0, 10.0, 10.0, 140.0, 20.0, 30.0, 0.0, 50.0, -80.0, 70.0, 40.0, 190.0, 50.0, 150.0, 0.0, 10.0, 10.0, 0.0, -30.0, 30.0, 190.0, 60.0, 160.0, 440.0, 20.0, 70.0, 10.0, 340.0, 80.0, 300.0, 20.0, 110.0, 40.0, 10.0, 180.0, 450.0, 50.0, 80.0, 50.0, 180.0, 80.0, 0.0, 390.0, 120.0, 190.0, 620.0, 40.0, 110.0, 330.0, 20.0, 20.0, 430.0, -20.0, 90.0, 410.0, 140.0, 10.0, 90.0, 20.0, 0.0, 250.0, 40.0, 10.0, 10.0, -40.0, 0.0, 0.0, 470.0, 80.0, 110.0, 20.0, 60.0, 110.0, 60.0, 810.0, -10.0, 70.0, 60.0, 40.0, 10.0, 110.0, 10.0, 20.0, 260.0, 40.0, 0.0, 260.0, 260.0, 40.0, 310.0, 70.0, 280.0, 80.0, 210.0, 20.0, 50.0, 40.0, 360.0, 90.0, 140.0, 30.0, 760.0, 165.0, 10.0, 80.0, 40.0, 230.0, 10.0, 0.0, 260.0, 30.0, 120.0, -25.0, 0.0, 150.0, 230.0, 110.0, 110.0, 10.0, 90.0, 30.0, 250.0, 70.0, 130.0, 70.0, 170.0, 70.0, 380.0, 200.0, 20.0, 40.0, 40.0, 30.0, 50.0, 340.0, 10.0, 110.0, 10.0, 300.0, -40.0, 30.0, 150.0, 270.0, 30.0, 60.0, 110.0, 20.0, 240.0, 30.0, 40.0, 110.0, 90.0, 100.0, 30.0, 90.0, 560.0, 10.0, 30.0, 0.0, 40.0, 120.0, -20.0, 20.0, 0.0, 0.0, 20.0, 290.0, 10.0, 20.0, 130.0, 30.0, 60.0, 20.0, 220.0, 10.0, 40.0, 90.0, 550.0, 40.0, 70.0, 90.0, 110.0, -50.0, 70.0, 50.0, 170.0, 20.0, 750.0, 40.0, 20.0, 50.0, 20.0, 140.0, 50.0, 480.0, 270.0, 70.0, 40.0, 20.0, 220.0, 10.0, 10.0, 10.0, 30.0, 130.0, 280.0, 0.0, 250.0, 40.0, 20.0, 40.0, 310.0, 160.0, 50.0, 60.0, 240.0, 330.0, 100.0, 60.0, 170.0, 380.0, 30.0, 200.0, 60.0, 400.0, 10.0, 70.0, 320.0, 30.0, 40.0, 0.0, 0.0, 240.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 240.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 40.0, 330.0, 50.0, 140.0, 180.0, 30.0, 40.0, 20.0, 90.0, 10.0, 400.0, 0.0, 110.0, -30.0, 170.0, 390.0, 30.0, 20.0, 610.0, 60.0, 190.0, 0.0, 200.0, 60.0, 20.0, 0.0, 90.0, 0.0, 0.0, 20.0, 20.0, 40.0, 30.0, 20.0, 500.0, 40.0, 200.0, 10.0, 20.0, 20.0, 170.0, -20.0, 60.0, 30.0, 130.0, 490.0, 110.0, 40.0, 120.0, 200.0, 300.0, 70.0, 60.0, 20.0, 120.0, 240.0, 0.0, 10.0, 100.0, 160.0, 90.0, 40.0, 160.0, 40.0, 350.0, -15.0, 50.0, -5.0, 70.0, 110.0, 0.0, 50.0, 330.0, 0.0, 10.0, 140.0, 20.0, 20.0, 90.0, 30.0, 300.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 20.0, 100.0, 40.0, 20.0, 160.0, 300.0, 30.0, 50.0, 30.0, 60.0, 10.0, 100.0, 340.0, 70.0, 80.0, 40.0, 20.0, 270.0, 160.0, 170.0, 210.0, 130.0, 50.0, 130.0, 0.0, 40.0, 100.0, 50.0, 0.0, 40.0, 110.0, 100.0, 350.0, 60.0, 20.0, 160.0, 280.0, 140.0, 10.0, 20.0, 0.0, 0.0, 80.0, 100.0, 170.0, 20.0, 20.0, 70.0, 180.0, 80.0, 160.0, 10.0, 110.0, 80.0, 150.0, 10.0, 230.0, 0.0, 10.0, 50.0, 70.0, 80.0, 30.0, 0.0, 50.0, 120.0, 90.0, 10.0, 0.0, 20.0, 10.0, 140.0, 380.0, 90.0, 130.0, 20.0, 60.0, 260.0, 60.0, 170.0, 190.0, 430.0, 330.0, 20.0, 10.0, 130.0, 20.0, 130.0, 10.0, 200.0, 0.0, 30.0, 70.0, 100.0, 230.0, 80.0, 390.0, -210.0, 120.0, 40.0, 120.0, 120.0, 70.0, 30.0, 70.0, 380.0, 560.0, 60.0, 30.0, 0.0, 10.0, 100.0, 170.0, 20.0, 60.0, 10.0, 600.0, 130.0, 10.0, 120.0, 0.0, 50.0, 10.0, 30.0, 270.0, 100.0, 20.0, 180.0, 20.0, 20.0, 390.0, 0.0, 10.0, -30.0, 150.0, 560.0, 190.0, 230.0, 0.0, 10.0, 80.0, 20.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 40.0, 40.0, 300.0, 190.0, 0.0, 50.0, 45.0, 30.0, 210.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 200.0, 50.0, 20.0, 450.0, 30.0, 140.0, 90.0, 50.0, 30.0, 10.0, 270.0, -40.0, 450.0, 50.0, 100.0, 150.0, 110.0, 10.0, 30.0, 660.0, 170.0, 230.0, 160.0, 20.0, -40.0, 370.0, 40.0, 0.0, -5.0, 10.0, 0.0, 35.0, 50.0, 10.0, 240.0, 160.0, 20.0, 0.0, 360.0, 420.0, 30.0, -30.0, 50.0, 40.0, 0.0, 40.0, 50.0, 60.0, 140.0, 40.0, -40.0, 490.0, 90.0, 50.0, 180.0, 10.0, 40.0, 80.0, 0.0, 40.0, 40.0, 0.0, 90.0, 150.0, 130.0, 40.0, 510.0, 10.0, 10.0, 120.0, 20.0, 100.0, 130.0, 170.0, 50.0, 130.0, 160.0, 70.0, 20.0, 100.0, 20.0, 0.0, 20.0, 690.0, 110.0, 50.0, 80.0, -10.0, 310.0, 280.0, -50.0, 5.0, 40.0, 150.0, 420.0, -50.0, 50.0, 180.0, 60.0, 70.0, 10.0, 180.0, 0.0, 100.0, 60.0, 0.0, 20.0, 190.0, 160.0, 370.0, 20.0, 500.0, 80.0, 60.0, 50.0, 60.0, 330.0, 190.0, 20.0, 230.0, 30.0, 40.0, 80.0, 30.0, 270.0, 80.0, 30.0, -30.0, 140.0, 70.0, 40.0, 480.0, 20.0, 10.0, 30.0, 370.0, 20.0, 40.0, 30.0, 30.0, 20.0, 260.0, 30.0, 190.0, 30.0, 40.0, 40.0, -30.0, 10.0, 230.0, 20.0, 40.0, 170.0, 70.0, 100.0, 180.0, 110.0, 370.0, 190.0, 20.0, 30.0, 60.0, 300.0, 360.0, 80.0, 20.0, 90.0, 330.0, 210.0, 250.0, 180.0, 80.0, 50.0, 470.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 380.0, 35.0, 0.0, 0.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 210.0, 190.0, -30.0, 10.0, 290.0, 110.0, 70.0, 280.0, 350.0, 430.0, 70.0, 140.0, 40.0, 260.0, 0.0, 50.0, 20.0, 170.0, 20.0, 60.0, 130.0, 30.0, -95.0, 10.0, 0.0, 170.0, 280.0, 640.0, 290.0, 0.0, 0.0, 0.0, 60.0, 10.0, 0.0, 0.0, 30.0, 0.0, 15.0, 50.0, 230.0, 0.0, -100.0, 90.0, 30.0, 10.0, 30.0, 170.0, 510.0, 610.0, 70.0, 810.0, 20.0, 120.0, 100.0, 20.0, -40.0, 10.0, 150.0, 270.0, 30.0, 480.0, 30.0, 90.0, 340.0, 70.0, 160.0, 70.0, 110.0, 10.0, 100.0, 30.0, 100.0, 30.0, 60.0, 210.0, 440.0, 170.0, 40.0, 720.0, 60.0, 150.0, 90.0, 60.0, 30.0, 140.0, 400.0, 370.0, 220.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.883758457287639, "mean_inference_ms": 1.9741885100988525, "mean_action_processing_ms": 0.5156260020761719, "mean_env_wait_ms": 1.6570677073859912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012559175491333008, "StateBufferConnector_ms": 0.010334968566894531, "ViewRequirementAgentConnector_ms": 0.4225442409515381}, "num_episodes": 23, "episode_return_max": 2240.0, "episode_return_min": 40.0, "episode_return_mean": 1107.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 7.544535924600894, "num_env_steps_trained_throughput_per_sec": 7.544535924600894, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 5560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5560000, "timers": {"training_iteration_time_ms": 775628.117, "restore_workers_time_ms": 0.013, "training_step_time_ms": 775628.065, "sample_time_ms": 2561.146, "learn_time_ms": 773040.65, "learn_throughput": 5.174, "synch_weights_time_ms": 12.186}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "done": false, "training_iteration": 139, "trial_id": "3d3a5_00000", "date": "2024-06-01_19-20-38", "timestamp": 1717284038, "time_this_iter_s": 530.2360298633575, "time_total_s": 74852.16143393517, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a4bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74852.16143393517, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 24.416095890410958, "ram_util_percent": 82.54794520547945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.763385025755412, "cur_kl_coeff": 4.999155599383324, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003661376220661119, "vf_loss": 6.965947729126968, "vf_explained_var": 0.00018001793545528976, "kl": Infinity, "entropy": 0.23037045043957627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1309905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "env_runners": {"episode_reward_max": 2240.0, "episode_reward_min": 40.0, "episode_reward_mean": 1059.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 105.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 1360.0, 2120.0, 360.0, 440.0, 1290.0, 1320.0, 1780.0, 1520.0, 760.0, 1370.0, 1010.0, 1460.0, 1555.0, 985.0, 1270.0, 850.0, 1170.0, 1090.0, 480.0, 1170.0, 1320.0, 1180.0, 960.0, 1350.0, 1700.0, 420.0, 410.0, 1290.0, 1550.0, 410.0, 1050.0, 1460.0, 870.0, 800.0, 990.0, 270.0, 1150.0, 1260.0, 850.0, 810.0, 900.0, 630.0, 910.0, 1670.0, 700.0, 990.0, 1400.0, 1020.0, 980.0, 1380.0, 40.0, 935.0, 360.0, 1050.0, 1960.0, 590.0, 1260.0, 870.0, 530.0, 1180.0, 850.0, 1485.0, 1110.0, 1420.0, 1090.0, 1190.0, 830.0, 600.0, 1300.0, 1900.0, 1185.0, 120.0, 1480.0, 1200.0, 1515.0, 115.0, 1020.0, 1870.0, 1650.0, 1190.0, 2240.0, 540.0, 530.0, 730.0, 1715.0, 1205.0, 1140.0, 450.0, 350.0, 890.0, 1065.0, 1350.0, 1030.0, 1330.0, 680.0, 710.0, 980.0, 1560.0, 1190.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 60.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 160.0, 20.0, 320.0, 70.0, 50.0, 210.0, 110.0, 290.0, 40.0, 160.0, 40.0, 70.0, 520.0, 100.0, 600.0, 200.0, 110.0, 60.0, 310.0, 130.0, 40.0, 50.0, 50.0, 10.0, 40.0, 10.0, 10.0, 140.0, 20.0, 30.0, 0.0, 50.0, -80.0, 70.0, 40.0, 190.0, 50.0, 150.0, 0.0, 10.0, 10.0, 0.0, -30.0, 30.0, 190.0, 60.0, 160.0, 440.0, 20.0, 70.0, 10.0, 340.0, 80.0, 300.0, 20.0, 110.0, 40.0, 10.0, 180.0, 450.0, 50.0, 80.0, 50.0, 180.0, 80.0, 0.0, 390.0, 120.0, 190.0, 620.0, 40.0, 110.0, 330.0, 20.0, 20.0, 430.0, -20.0, 90.0, 410.0, 140.0, 10.0, 90.0, 20.0, 0.0, 250.0, 40.0, 10.0, 10.0, -40.0, 0.0, 0.0, 470.0, 80.0, 110.0, 20.0, 60.0, 110.0, 60.0, 810.0, -10.0, 70.0, 60.0, 40.0, 10.0, 110.0, 10.0, 20.0, 260.0, 40.0, 0.0, 260.0, 260.0, 40.0, 310.0, 70.0, 280.0, 80.0, 210.0, 20.0, 50.0, 40.0, 360.0, 90.0, 140.0, 30.0, 760.0, 165.0, 10.0, 80.0, 40.0, 230.0, 10.0, 0.0, 260.0, 30.0, 120.0, -25.0, 0.0, 150.0, 230.0, 110.0, 110.0, 10.0, 90.0, 30.0, 250.0, 70.0, 130.0, 70.0, 170.0, 70.0, 380.0, 200.0, 20.0, 40.0, 40.0, 30.0, 50.0, 340.0, 10.0, 110.0, 10.0, 300.0, -40.0, 30.0, 150.0, 270.0, 30.0, 60.0, 110.0, 20.0, 240.0, 30.0, 40.0, 110.0, 90.0, 100.0, 30.0, 90.0, 560.0, 10.0, 30.0, 0.0, 40.0, 120.0, -20.0, 20.0, 0.0, 0.0, 20.0, 290.0, 10.0, 20.0, 130.0, 30.0, 60.0, 20.0, 220.0, 10.0, 40.0, 90.0, 550.0, 40.0, 70.0, 90.0, 110.0, -50.0, 70.0, 50.0, 170.0, 20.0, 750.0, 40.0, 20.0, 50.0, 20.0, 140.0, 50.0, 480.0, 270.0, 70.0, 40.0, 20.0, 220.0, 10.0, 10.0, 10.0, 30.0, 130.0, 280.0, 0.0, 250.0, 40.0, 20.0, 40.0, 310.0, 160.0, 50.0, 60.0, 240.0, 330.0, 100.0, 60.0, 170.0, 380.0, 30.0, 200.0, 60.0, 400.0, 10.0, 70.0, 320.0, 30.0, 40.0, 0.0, 0.0, 240.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 240.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 40.0, 330.0, 50.0, 140.0, 180.0, 30.0, 40.0, 20.0, 90.0, 10.0, 400.0, 0.0, 110.0, -30.0, 170.0, 390.0, 30.0, 20.0, 610.0, 60.0, 190.0, 0.0, 200.0, 60.0, 20.0, 0.0, 90.0, 0.0, 0.0, 20.0, 20.0, 40.0, 30.0, 20.0, 500.0, 40.0, 200.0, 10.0, 20.0, 20.0, 170.0, -20.0, 60.0, 30.0, 130.0, 490.0, 110.0, 40.0, 120.0, 200.0, 300.0, 70.0, 60.0, 20.0, 120.0, 240.0, 0.0, 10.0, 100.0, 160.0, 90.0, 40.0, 160.0, 40.0, 350.0, -15.0, 50.0, -5.0, 70.0, 110.0, 0.0, 50.0, 330.0, 0.0, 10.0, 140.0, 20.0, 20.0, 90.0, 30.0, 300.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 20.0, 100.0, 40.0, 20.0, 160.0, 300.0, 30.0, 50.0, 30.0, 60.0, 10.0, 100.0, 340.0, 70.0, 80.0, 40.0, 20.0, 270.0, 160.0, 170.0, 210.0, 130.0, 50.0, 130.0, 0.0, 40.0, 100.0, 50.0, 0.0, 40.0, 110.0, 100.0, 350.0, 60.0, 20.0, 160.0, 280.0, 140.0, 10.0, 20.0, 0.0, 0.0, 80.0, 100.0, 170.0, 20.0, 20.0, 70.0, 180.0, 80.0, 160.0, 10.0, 110.0, 80.0, 150.0, 10.0, 230.0, 0.0, 10.0, 50.0, 70.0, 80.0, 30.0, 0.0, 50.0, 120.0, 90.0, 10.0, 0.0, 20.0, 10.0, 140.0, 380.0, 90.0, 130.0, 20.0, 60.0, 260.0, 60.0, 170.0, 190.0, 430.0, 330.0, 20.0, 10.0, 130.0, 20.0, 130.0, 10.0, 200.0, 0.0, 30.0, 70.0, 100.0, 230.0, 80.0, 390.0, -210.0, 120.0, 40.0, 120.0, 120.0, 70.0, 30.0, 70.0, 380.0, 560.0, 60.0, 30.0, 0.0, 10.0, 100.0, 170.0, 20.0, 60.0, 10.0, 600.0, 130.0, 10.0, 120.0, 0.0, 50.0, 10.0, 30.0, 270.0, 100.0, 20.0, 180.0, 20.0, 20.0, 390.0, 0.0, 10.0, -30.0, 150.0, 560.0, 190.0, 230.0, 0.0, 10.0, 80.0, 20.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 40.0, 40.0, 300.0, 190.0, 0.0, 50.0, 45.0, 30.0, 210.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 200.0, 50.0, 20.0, 450.0, 30.0, 140.0, 90.0, 50.0, 30.0, 10.0, 270.0, -40.0, 450.0, 50.0, 100.0, 150.0, 110.0, 10.0, 30.0, 660.0, 170.0, 230.0, 160.0, 20.0, -40.0, 370.0, 40.0, 0.0, -5.0, 10.0, 0.0, 35.0, 50.0, 10.0, 240.0, 160.0, 20.0, 0.0, 360.0, 420.0, 30.0, -30.0, 50.0, 40.0, 0.0, 40.0, 50.0, 60.0, 140.0, 40.0, -40.0, 490.0, 90.0, 50.0, 180.0, 10.0, 40.0, 80.0, 0.0, 40.0, 40.0, 0.0, 90.0, 150.0, 130.0, 40.0, 510.0, 10.0, 10.0, 120.0, 20.0, 100.0, 130.0, 170.0, 50.0, 130.0, 160.0, 70.0, 20.0, 100.0, 20.0, 0.0, 20.0, 690.0, 110.0, 50.0, 80.0, -10.0, 310.0, 280.0, -50.0, 5.0, 40.0, 150.0, 420.0, -50.0, 50.0, 180.0, 60.0, 70.0, 10.0, 180.0, 0.0, 100.0, 60.0, 0.0, 20.0, 190.0, 160.0, 370.0, 20.0, 500.0, 80.0, 60.0, 50.0, 60.0, 330.0, 190.0, 20.0, 230.0, 30.0, 40.0, 80.0, 30.0, 270.0, 80.0, 30.0, -30.0, 140.0, 70.0, 40.0, 480.0, 20.0, 10.0, 30.0, 370.0, 20.0, 40.0, 30.0, 30.0, 20.0, 260.0, 30.0, 190.0, 30.0, 40.0, 40.0, -30.0, 10.0, 230.0, 20.0, 40.0, 170.0, 70.0, 100.0, 180.0, 110.0, 370.0, 190.0, 20.0, 30.0, 60.0, 300.0, 360.0, 80.0, 20.0, 90.0, 330.0, 210.0, 250.0, 180.0, 80.0, 50.0, 470.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 380.0, 35.0, 0.0, 0.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 210.0, 190.0, -30.0, 10.0, 290.0, 110.0, 70.0, 280.0, 350.0, 430.0, 70.0, 140.0, 40.0, 260.0, 0.0, 50.0, 20.0, 170.0, 20.0, 60.0, 130.0, 30.0, -95.0, 10.0, 0.0, 170.0, 280.0, 640.0, 290.0, 0.0, 0.0, 0.0, 60.0, 10.0, 0.0, 0.0, 30.0, 0.0, 15.0, 50.0, 230.0, 0.0, -100.0, 90.0, 30.0, 10.0, 30.0, 170.0, 510.0, 610.0, 70.0, 810.0, 20.0, 120.0, 100.0, 20.0, -40.0, 10.0, 150.0, 270.0, 30.0, 480.0, 30.0, 90.0, 340.0, 70.0, 160.0, 70.0, 110.0, 10.0, 100.0, 30.0, 100.0, 30.0, 60.0, 210.0, 440.0, 170.0, 40.0, 720.0, 60.0, 150.0, 90.0, 60.0, 30.0, 140.0, 400.0, 370.0, 220.0, 10.0, 160.0, 70.0, 60.0, 30.0, 80.0, 10.0, 10.0, 40.0, 70.0, 30.0, 40.0, 50.0, 10.0, 50.0, 0.0, 70.0, 0.0, 110.0, 170.0, 40.0, 190.0, 30.0, 40.0, 40.0, 60.0, 190.0, 20.0, 90.0, 30.0, 70.0, 570.0, 170.0, 360.0, 60.0, 80.0, 60.0, 120.0, -5.0, 230.0, 20.0, 570.0, 100.0, 30.0, 10.0, -20.0, 280.0, 160.0, 45.0, 10.0, 440.0, 40.0, 50.0, 60.0, 60.0, 0.0, 60.0, 30.0, 190.0, 210.0, 0.0, 10.0, 20.0, 20.0, 40.0, 10.0, 130.0, 20.0, 180.0, 20.0, 30.0, 30.0, 20.0, 20.0, 80.0, 100.0, 0.0, 20.0, 50.0, 0.0, 170.0, 170.0, 0.0, 30.0, 40.0, 10.0, 160.0, 30.0, 230.0, 50.0, -20.0, 30.0, 240.0, 110.0, -10.0, 55.0, 70.0, 30.0, 30.0, 530.0, 340.0, 90.0, 0.0, 140.0, 100.0, 200.0, 90.0, -10.0, 410.0, -10.0, 460.0, 10.0, 20.0, 0.0, 30.0, 20.0, 460.0, 0.0, 10.0, 20.0, 230.0, 50.0, 160.0, 60.0, 160.0, 50.0, 300.0, 60.0, 80.0, 180.0, 10.0, 110.0, 170.0, 50.0, 290.0, 50.0, 40.0, 0.0, 0.0, -40.0, 50.0, 40.0, 240.0, 10.0, 390.0, 60.0, 0.0, -30.0, 0.0, -50.0, 40.0, 60.0, 40.0, 70.0, 160.0, 70.0, 20.0, 90.0, 10.0, 420.0, 330.0, 160.0, 20.0, 60.0, 0.0, 310.0, 380.0, 60.0, 170.0, 70.0, 330.0, 210.0, 130.0, 60.0, 10.0, 320.0, 30.0, 30.0, 40.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8810976496100278, "mean_inference_ms": 1.9723780314621706, "mean_action_processing_ms": 0.5150050251710119, "mean_env_wait_ms": 1.6551638854512003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012274742126464844, "StateBufferConnector_ms": 0.010077476501464844, "ViewRequirementAgentConnector_ms": 0.4198274612426758}, "num_episodes": 18, "episode_return_max": 2240.0, "episode_return_min": 40.0, "episode_return_mean": 1059.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.909036983753248, "num_env_steps_trained_throughput_per_sec": 6.909036983753248, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 5600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5600000, "timers": {"training_iteration_time_ms": 803732.339, "restore_workers_time_ms": 0.013, "training_step_time_ms": 803732.287, "sample_time_ms": 2607.533, "learn_time_ms": 801098.728, "learn_throughput": 4.993, "synch_weights_time_ms": 12.0}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "done": false, "training_iteration": 140, "trial_id": "3d3a5_00000", "date": "2024-06-01_19-30-17", "timestamp": 1717284617, "time_this_iter_s": 578.9858419895172, "time_total_s": 75431.14727592468, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x11802fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75431.14727592468, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 19.097909407665504, "ram_util_percent": 81.06480836236933}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4699607476195333, "cur_kl_coeff": 7.4987333990749825, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.165417813543821, "policy_loss": -0.0023993363467325816, "vf_loss": 6.165570863291098, "vf_explained_var": 0.0003141471499198288, "kl": 0.0002995563128504055, "entropy": 0.21636201306003225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1319295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "env_runners": {"episode_reward_max": 2240.0, "episode_reward_min": 40.0, "episode_reward_mean": 1045.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 104.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1180.0, 960.0, 1350.0, 1700.0, 420.0, 410.0, 1290.0, 1550.0, 410.0, 1050.0, 1460.0, 870.0, 800.0, 990.0, 270.0, 1150.0, 1260.0, 850.0, 810.0, 900.0, 630.0, 910.0, 1670.0, 700.0, 990.0, 1400.0, 1020.0, 980.0, 1380.0, 40.0, 935.0, 360.0, 1050.0, 1960.0, 590.0, 1260.0, 870.0, 530.0, 1180.0, 850.0, 1485.0, 1110.0, 1420.0, 1090.0, 1190.0, 830.0, 600.0, 1300.0, 1900.0, 1185.0, 120.0, 1480.0, 1200.0, 1515.0, 115.0, 1020.0, 1870.0, 1650.0, 1190.0, 2240.0, 540.0, 530.0, 730.0, 1715.0, 1205.0, 1140.0, 450.0, 350.0, 890.0, 1065.0, 1350.0, 1030.0, 1330.0, 680.0, 710.0, 980.0, 1560.0, 1190.0, 1135.0, 870.0, 1250.0, 1220.0, 520.0, 1250.0, 1780.0, 1330.0, 1510.0, 1270.0, 420.0, 530.0, 230.0, 1280.0, 890.0, 710.0, 1605.0, 1130.0, 1510.0, 1530.0, 85.0, 1540.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 20.0, 50.0, 20.0, 140.0, 50.0, 480.0, 270.0, 70.0, 40.0, 20.0, 220.0, 10.0, 10.0, 10.0, 30.0, 130.0, 280.0, 0.0, 250.0, 40.0, 20.0, 40.0, 310.0, 160.0, 50.0, 60.0, 240.0, 330.0, 100.0, 60.0, 170.0, 380.0, 30.0, 200.0, 60.0, 400.0, 10.0, 70.0, 320.0, 30.0, 40.0, 0.0, 0.0, 240.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 240.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 40.0, 330.0, 50.0, 140.0, 180.0, 30.0, 40.0, 20.0, 90.0, 10.0, 400.0, 0.0, 110.0, -30.0, 170.0, 390.0, 30.0, 20.0, 610.0, 60.0, 190.0, 0.0, 200.0, 60.0, 20.0, 0.0, 90.0, 0.0, 0.0, 20.0, 20.0, 40.0, 30.0, 20.0, 500.0, 40.0, 200.0, 10.0, 20.0, 20.0, 170.0, -20.0, 60.0, 30.0, 130.0, 490.0, 110.0, 40.0, 120.0, 200.0, 300.0, 70.0, 60.0, 20.0, 120.0, 240.0, 0.0, 10.0, 100.0, 160.0, 90.0, 40.0, 160.0, 40.0, 350.0, -15.0, 50.0, -5.0, 70.0, 110.0, 0.0, 50.0, 330.0, 0.0, 10.0, 140.0, 20.0, 20.0, 90.0, 30.0, 300.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 20.0, 100.0, 40.0, 20.0, 160.0, 300.0, 30.0, 50.0, 30.0, 60.0, 10.0, 100.0, 340.0, 70.0, 80.0, 40.0, 20.0, 270.0, 160.0, 170.0, 210.0, 130.0, 50.0, 130.0, 0.0, 40.0, 100.0, 50.0, 0.0, 40.0, 110.0, 100.0, 350.0, 60.0, 20.0, 160.0, 280.0, 140.0, 10.0, 20.0, 0.0, 0.0, 80.0, 100.0, 170.0, 20.0, 20.0, 70.0, 180.0, 80.0, 160.0, 10.0, 110.0, 80.0, 150.0, 10.0, 230.0, 0.0, 10.0, 50.0, 70.0, 80.0, 30.0, 0.0, 50.0, 120.0, 90.0, 10.0, 0.0, 20.0, 10.0, 140.0, 380.0, 90.0, 130.0, 20.0, 60.0, 260.0, 60.0, 170.0, 190.0, 430.0, 330.0, 20.0, 10.0, 130.0, 20.0, 130.0, 10.0, 200.0, 0.0, 30.0, 70.0, 100.0, 230.0, 80.0, 390.0, -210.0, 120.0, 40.0, 120.0, 120.0, 70.0, 30.0, 70.0, 380.0, 560.0, 60.0, 30.0, 0.0, 10.0, 100.0, 170.0, 20.0, 60.0, 10.0, 600.0, 130.0, 10.0, 120.0, 0.0, 50.0, 10.0, 30.0, 270.0, 100.0, 20.0, 180.0, 20.0, 20.0, 390.0, 0.0, 10.0, -30.0, 150.0, 560.0, 190.0, 230.0, 0.0, 10.0, 80.0, 20.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 40.0, 40.0, 300.0, 190.0, 0.0, 50.0, 45.0, 30.0, 210.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 200.0, 50.0, 20.0, 450.0, 30.0, 140.0, 90.0, 50.0, 30.0, 10.0, 270.0, -40.0, 450.0, 50.0, 100.0, 150.0, 110.0, 10.0, 30.0, 660.0, 170.0, 230.0, 160.0, 20.0, -40.0, 370.0, 40.0, 0.0, -5.0, 10.0, 0.0, 35.0, 50.0, 10.0, 240.0, 160.0, 20.0, 0.0, 360.0, 420.0, 30.0, -30.0, 50.0, 40.0, 0.0, 40.0, 50.0, 60.0, 140.0, 40.0, -40.0, 490.0, 90.0, 50.0, 180.0, 10.0, 40.0, 80.0, 0.0, 40.0, 40.0, 0.0, 90.0, 150.0, 130.0, 40.0, 510.0, 10.0, 10.0, 120.0, 20.0, 100.0, 130.0, 170.0, 50.0, 130.0, 160.0, 70.0, 20.0, 100.0, 20.0, 0.0, 20.0, 690.0, 110.0, 50.0, 80.0, -10.0, 310.0, 280.0, -50.0, 5.0, 40.0, 150.0, 420.0, -50.0, 50.0, 180.0, 60.0, 70.0, 10.0, 180.0, 0.0, 100.0, 60.0, 0.0, 20.0, 190.0, 160.0, 370.0, 20.0, 500.0, 80.0, 60.0, 50.0, 60.0, 330.0, 190.0, 20.0, 230.0, 30.0, 40.0, 80.0, 30.0, 270.0, 80.0, 30.0, -30.0, 140.0, 70.0, 40.0, 480.0, 20.0, 10.0, 30.0, 370.0, 20.0, 40.0, 30.0, 30.0, 20.0, 260.0, 30.0, 190.0, 30.0, 40.0, 40.0, -30.0, 10.0, 230.0, 20.0, 40.0, 170.0, 70.0, 100.0, 180.0, 110.0, 370.0, 190.0, 20.0, 30.0, 60.0, 300.0, 360.0, 80.0, 20.0, 90.0, 330.0, 210.0, 250.0, 180.0, 80.0, 50.0, 470.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 380.0, 35.0, 0.0, 0.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 210.0, 190.0, -30.0, 10.0, 290.0, 110.0, 70.0, 280.0, 350.0, 430.0, 70.0, 140.0, 40.0, 260.0, 0.0, 50.0, 20.0, 170.0, 20.0, 60.0, 130.0, 30.0, -95.0, 10.0, 0.0, 170.0, 280.0, 640.0, 290.0, 0.0, 0.0, 0.0, 60.0, 10.0, 0.0, 0.0, 30.0, 0.0, 15.0, 50.0, 230.0, 0.0, -100.0, 90.0, 30.0, 10.0, 30.0, 170.0, 510.0, 610.0, 70.0, 810.0, 20.0, 120.0, 100.0, 20.0, -40.0, 10.0, 150.0, 270.0, 30.0, 480.0, 30.0, 90.0, 340.0, 70.0, 160.0, 70.0, 110.0, 10.0, 100.0, 30.0, 100.0, 30.0, 60.0, 210.0, 440.0, 170.0, 40.0, 720.0, 60.0, 150.0, 90.0, 60.0, 30.0, 140.0, 400.0, 370.0, 220.0, 10.0, 160.0, 70.0, 60.0, 30.0, 80.0, 10.0, 10.0, 40.0, 70.0, 30.0, 40.0, 50.0, 10.0, 50.0, 0.0, 70.0, 0.0, 110.0, 170.0, 40.0, 190.0, 30.0, 40.0, 40.0, 60.0, 190.0, 20.0, 90.0, 30.0, 70.0, 570.0, 170.0, 360.0, 60.0, 80.0, 60.0, 120.0, -5.0, 230.0, 20.0, 570.0, 100.0, 30.0, 10.0, -20.0, 280.0, 160.0, 45.0, 10.0, 440.0, 40.0, 50.0, 60.0, 60.0, 0.0, 60.0, 30.0, 190.0, 210.0, 0.0, 10.0, 20.0, 20.0, 40.0, 10.0, 130.0, 20.0, 180.0, 20.0, 30.0, 30.0, 20.0, 20.0, 80.0, 100.0, 0.0, 20.0, 50.0, 0.0, 170.0, 170.0, 0.0, 30.0, 40.0, 10.0, 160.0, 30.0, 230.0, 50.0, -20.0, 30.0, 240.0, 110.0, -10.0, 55.0, 70.0, 30.0, 30.0, 530.0, 340.0, 90.0, 0.0, 140.0, 100.0, 200.0, 90.0, -10.0, 410.0, -10.0, 460.0, 10.0, 20.0, 0.0, 30.0, 20.0, 460.0, 0.0, 10.0, 20.0, 230.0, 50.0, 160.0, 60.0, 160.0, 50.0, 300.0, 60.0, 80.0, 180.0, 10.0, 110.0, 170.0, 50.0, 290.0, 50.0, 40.0, 0.0, 0.0, -40.0, 50.0, 40.0, 240.0, 10.0, 390.0, 60.0, 0.0, -30.0, 0.0, -50.0, 40.0, 60.0, 40.0, 70.0, 160.0, 70.0, 20.0, 90.0, 10.0, 420.0, 330.0, 160.0, 20.0, 60.0, 0.0, 310.0, 380.0, 60.0, 170.0, 70.0, 330.0, 210.0, 130.0, 60.0, 10.0, 320.0, 30.0, 30.0, 40.0, 30.0, 350.0, 30.0, 180.0, 30.0, 60.0, 80.0, 70.0, 310.0, 5.0, 20.0, 50.0, 40.0, 0.0, 20.0, 10.0, 0.0, 100.0, 140.0, 500.0, 10.0, 90.0, 220.0, 140.0, 0.0, 210.0, 0.0, 120.0, 120.0, 20.0, 330.0, 40.0, 50.0, 140.0, 40.0, 290.0, 90.0, 50.0, 160.0, 40.0, 320.0, 10.0, 20.0, 20.0, 320.0, 20.0, 0.0, 90.0, 30.0, 10.0, 0.0, 30.0, 0.0, 470.0, 370.0, 10.0, 40.0, 60.0, 50.0, 110.0, 110.0, 60.0, 60.0, 60.0, 350.0, 200.0, 170.0, 150.0, 180.0, -60.0, 610.0, 150.0, 200.0, 180.0, 60.0, 300.0, 70.0, 80.0, 60.0, 160.0, 70.0, 160.0, 200.0, 50.0, 180.0, 0.0, 20.0, 0.0, 30.0, 720.0, 150.0, 370.0, 110.0, 90.0, 30.0, 370.0, 150.0, 60.0, 20.0, 30.0, 40.0, 0.0, 30.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 220.0, 0.0, 50.0, 20.0, 0.0, 0.0, 230.0, 150.0, 30.0, 0.0, 50.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 10.0, 20.0, 30.0, 350.0, 20.0, 110.0, 20.0, 20.0, 190.0, 390.0, 30.0, 120.0, -150.0, 50.0, 50.0, -140.0, 470.0, 340.0, 0.0, -20.0, 200.0, 90.0, -60.0, 90.0, 40.0, 80.0, 20.0, 30.0, 300.0, 20.0, 30.0, 160.0, 80.0, 35.0, 80.0, 130.0, 340.0, 250.0, 330.0, 90.0, 200.0, 70.0, 170.0, 50.0, 60.0, 230.0, 60.0, 10.0, 60.0, 410.0, 70.0, 10.0, 20.0, 20.0, 280.0, 100.0, 350.0, 190.0, 90.0, 160.0, 60.0, 240.0, 20.0, 80.0, 80.0, 140.0, 290.0, 150.0, 150.0, 10.0, 90.0, 520.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 20.0, 140.0, 390.0, 250.0, 70.0, 100.0, 260.0, 200.0, 60.0, 20.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8777074707846735, "mean_inference_ms": 1.9698663311068816, "mean_action_processing_ms": 0.5141739222761679, "mean_env_wait_ms": 1.6525557744017636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01427316665649414, "StateBufferConnector_ms": 0.010937213897705078, "ViewRequirementAgentConnector_ms": 0.42749571800231934}, "num_episodes": 22, "episode_return_max": 2240.0, "episode_return_min": 40.0, "episode_return_mean": 1045.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.056222327491233, "num_env_steps_trained_throughput_per_sec": 6.056222327491233, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 5640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5640000, "timers": {"training_iteration_time_ms": 798496.77, "restore_workers_time_ms": 0.013, "training_step_time_ms": 798496.718, "sample_time_ms": 2616.391, "learn_time_ms": 795853.077, "learn_throughput": 5.026, "synch_weights_time_ms": 12.567}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "done": false, "training_iteration": 141, "trial_id": "3d3a5_00000", "date": "2024-06-01_19-41-17", "timestamp": 1717285277, "time_this_iter_s": 660.4880249500275, "time_total_s": 76091.63530087471, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a56430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76091.63530087471, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 21.554827586206894, "ram_util_percent": 82.16758620689654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4492193043803256, "cur_kl_coeff": 3.7493666995374912, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003731259771005803, "vf_loss": 6.183990600594062, "vf_explained_var": 0.00111159312204558, "kl": Infinity, "entropy": 0.2288953361245263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1328685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "env_runners": {"episode_reward_max": 2240.0, "episode_reward_min": 40.0, "episode_reward_mean": 1063.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 106.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [810.0, 900.0, 630.0, 910.0, 1670.0, 700.0, 990.0, 1400.0, 1020.0, 980.0, 1380.0, 40.0, 935.0, 360.0, 1050.0, 1960.0, 590.0, 1260.0, 870.0, 530.0, 1180.0, 850.0, 1485.0, 1110.0, 1420.0, 1090.0, 1190.0, 830.0, 600.0, 1300.0, 1900.0, 1185.0, 120.0, 1480.0, 1200.0, 1515.0, 115.0, 1020.0, 1870.0, 1650.0, 1190.0, 2240.0, 540.0, 530.0, 730.0, 1715.0, 1205.0, 1140.0, 450.0, 350.0, 890.0, 1065.0, 1350.0, 1030.0, 1330.0, 680.0, 710.0, 980.0, 1560.0, 1190.0, 1135.0, 870.0, 1250.0, 1220.0, 520.0, 1250.0, 1780.0, 1330.0, 1510.0, 1270.0, 420.0, 530.0, 230.0, 1280.0, 890.0, 710.0, 1605.0, 1130.0, 1510.0, 1530.0, 85.0, 1540.0, 350.0, 1450.0, 1350.0, 1150.0, 1475.0, 1260.0, 1650.0, 425.0, 590.0, 1405.0, 1570.0, 550.0, 1270.0, 915.0, 1070.0, 1430.0, 135.0, 1750.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 160.0, 280.0, 140.0, 10.0, 20.0, 0.0, 0.0, 80.0, 100.0, 170.0, 20.0, 20.0, 70.0, 180.0, 80.0, 160.0, 10.0, 110.0, 80.0, 150.0, 10.0, 230.0, 0.0, 10.0, 50.0, 70.0, 80.0, 30.0, 0.0, 50.0, 120.0, 90.0, 10.0, 0.0, 20.0, 10.0, 140.0, 380.0, 90.0, 130.0, 20.0, 60.0, 260.0, 60.0, 170.0, 190.0, 430.0, 330.0, 20.0, 10.0, 130.0, 20.0, 130.0, 10.0, 200.0, 0.0, 30.0, 70.0, 100.0, 230.0, 80.0, 390.0, -210.0, 120.0, 40.0, 120.0, 120.0, 70.0, 30.0, 70.0, 380.0, 560.0, 60.0, 30.0, 0.0, 10.0, 100.0, 170.0, 20.0, 60.0, 10.0, 600.0, 130.0, 10.0, 120.0, 0.0, 50.0, 10.0, 30.0, 270.0, 100.0, 20.0, 180.0, 20.0, 20.0, 390.0, 0.0, 10.0, -30.0, 150.0, 560.0, 190.0, 230.0, 0.0, 10.0, 80.0, 20.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 40.0, 40.0, 300.0, 190.0, 0.0, 50.0, 45.0, 30.0, 210.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 200.0, 50.0, 20.0, 450.0, 30.0, 140.0, 90.0, 50.0, 30.0, 10.0, 270.0, -40.0, 450.0, 50.0, 100.0, 150.0, 110.0, 10.0, 30.0, 660.0, 170.0, 230.0, 160.0, 20.0, -40.0, 370.0, 40.0, 0.0, -5.0, 10.0, 0.0, 35.0, 50.0, 10.0, 240.0, 160.0, 20.0, 0.0, 360.0, 420.0, 30.0, -30.0, 50.0, 40.0, 0.0, 40.0, 50.0, 60.0, 140.0, 40.0, -40.0, 490.0, 90.0, 50.0, 180.0, 10.0, 40.0, 80.0, 0.0, 40.0, 40.0, 0.0, 90.0, 150.0, 130.0, 40.0, 510.0, 10.0, 10.0, 120.0, 20.0, 100.0, 130.0, 170.0, 50.0, 130.0, 160.0, 70.0, 20.0, 100.0, 20.0, 0.0, 20.0, 690.0, 110.0, 50.0, 80.0, -10.0, 310.0, 280.0, -50.0, 5.0, 40.0, 150.0, 420.0, -50.0, 50.0, 180.0, 60.0, 70.0, 10.0, 180.0, 0.0, 100.0, 60.0, 0.0, 20.0, 190.0, 160.0, 370.0, 20.0, 500.0, 80.0, 60.0, 50.0, 60.0, 330.0, 190.0, 20.0, 230.0, 30.0, 40.0, 80.0, 30.0, 270.0, 80.0, 30.0, -30.0, 140.0, 70.0, 40.0, 480.0, 20.0, 10.0, 30.0, 370.0, 20.0, 40.0, 30.0, 30.0, 20.0, 260.0, 30.0, 190.0, 30.0, 40.0, 40.0, -30.0, 10.0, 230.0, 20.0, 40.0, 170.0, 70.0, 100.0, 180.0, 110.0, 370.0, 190.0, 20.0, 30.0, 60.0, 300.0, 360.0, 80.0, 20.0, 90.0, 330.0, 210.0, 250.0, 180.0, 80.0, 50.0, 470.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 380.0, 35.0, 0.0, 0.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 210.0, 190.0, -30.0, 10.0, 290.0, 110.0, 70.0, 280.0, 350.0, 430.0, 70.0, 140.0, 40.0, 260.0, 0.0, 50.0, 20.0, 170.0, 20.0, 60.0, 130.0, 30.0, -95.0, 10.0, 0.0, 170.0, 280.0, 640.0, 290.0, 0.0, 0.0, 0.0, 60.0, 10.0, 0.0, 0.0, 30.0, 0.0, 15.0, 50.0, 230.0, 0.0, -100.0, 90.0, 30.0, 10.0, 30.0, 170.0, 510.0, 610.0, 70.0, 810.0, 20.0, 120.0, 100.0, 20.0, -40.0, 10.0, 150.0, 270.0, 30.0, 480.0, 30.0, 90.0, 340.0, 70.0, 160.0, 70.0, 110.0, 10.0, 100.0, 30.0, 100.0, 30.0, 60.0, 210.0, 440.0, 170.0, 40.0, 720.0, 60.0, 150.0, 90.0, 60.0, 30.0, 140.0, 400.0, 370.0, 220.0, 10.0, 160.0, 70.0, 60.0, 30.0, 80.0, 10.0, 10.0, 40.0, 70.0, 30.0, 40.0, 50.0, 10.0, 50.0, 0.0, 70.0, 0.0, 110.0, 170.0, 40.0, 190.0, 30.0, 40.0, 40.0, 60.0, 190.0, 20.0, 90.0, 30.0, 70.0, 570.0, 170.0, 360.0, 60.0, 80.0, 60.0, 120.0, -5.0, 230.0, 20.0, 570.0, 100.0, 30.0, 10.0, -20.0, 280.0, 160.0, 45.0, 10.0, 440.0, 40.0, 50.0, 60.0, 60.0, 0.0, 60.0, 30.0, 190.0, 210.0, 0.0, 10.0, 20.0, 20.0, 40.0, 10.0, 130.0, 20.0, 180.0, 20.0, 30.0, 30.0, 20.0, 20.0, 80.0, 100.0, 0.0, 20.0, 50.0, 0.0, 170.0, 170.0, 0.0, 30.0, 40.0, 10.0, 160.0, 30.0, 230.0, 50.0, -20.0, 30.0, 240.0, 110.0, -10.0, 55.0, 70.0, 30.0, 30.0, 530.0, 340.0, 90.0, 0.0, 140.0, 100.0, 200.0, 90.0, -10.0, 410.0, -10.0, 460.0, 10.0, 20.0, 0.0, 30.0, 20.0, 460.0, 0.0, 10.0, 20.0, 230.0, 50.0, 160.0, 60.0, 160.0, 50.0, 300.0, 60.0, 80.0, 180.0, 10.0, 110.0, 170.0, 50.0, 290.0, 50.0, 40.0, 0.0, 0.0, -40.0, 50.0, 40.0, 240.0, 10.0, 390.0, 60.0, 0.0, -30.0, 0.0, -50.0, 40.0, 60.0, 40.0, 70.0, 160.0, 70.0, 20.0, 90.0, 10.0, 420.0, 330.0, 160.0, 20.0, 60.0, 0.0, 310.0, 380.0, 60.0, 170.0, 70.0, 330.0, 210.0, 130.0, 60.0, 10.0, 320.0, 30.0, 30.0, 40.0, 30.0, 350.0, 30.0, 180.0, 30.0, 60.0, 80.0, 70.0, 310.0, 5.0, 20.0, 50.0, 40.0, 0.0, 20.0, 10.0, 0.0, 100.0, 140.0, 500.0, 10.0, 90.0, 220.0, 140.0, 0.0, 210.0, 0.0, 120.0, 120.0, 20.0, 330.0, 40.0, 50.0, 140.0, 40.0, 290.0, 90.0, 50.0, 160.0, 40.0, 320.0, 10.0, 20.0, 20.0, 320.0, 20.0, 0.0, 90.0, 30.0, 10.0, 0.0, 30.0, 0.0, 470.0, 370.0, 10.0, 40.0, 60.0, 50.0, 110.0, 110.0, 60.0, 60.0, 60.0, 350.0, 200.0, 170.0, 150.0, 180.0, -60.0, 610.0, 150.0, 200.0, 180.0, 60.0, 300.0, 70.0, 80.0, 60.0, 160.0, 70.0, 160.0, 200.0, 50.0, 180.0, 0.0, 20.0, 0.0, 30.0, 720.0, 150.0, 370.0, 110.0, 90.0, 30.0, 370.0, 150.0, 60.0, 20.0, 30.0, 40.0, 0.0, 30.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 220.0, 0.0, 50.0, 20.0, 0.0, 0.0, 230.0, 150.0, 30.0, 0.0, 50.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 10.0, 20.0, 30.0, 350.0, 20.0, 110.0, 20.0, 20.0, 190.0, 390.0, 30.0, 120.0, -150.0, 50.0, 50.0, -140.0, 470.0, 340.0, 0.0, -20.0, 200.0, 90.0, -60.0, 90.0, 40.0, 80.0, 20.0, 30.0, 300.0, 20.0, 30.0, 160.0, 80.0, 35.0, 80.0, 130.0, 340.0, 250.0, 330.0, 90.0, 200.0, 70.0, 170.0, 50.0, 60.0, 230.0, 60.0, 10.0, 60.0, 410.0, 70.0, 10.0, 20.0, 20.0, 280.0, 100.0, 350.0, 190.0, 90.0, 160.0, 60.0, 240.0, 20.0, 80.0, 80.0, 140.0, 290.0, 150.0, 150.0, 10.0, 90.0, 520.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 20.0, 140.0, 390.0, 250.0, 70.0, 100.0, 260.0, 200.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 30.0, 200.0, 30.0, 280.0, 300.0, 20.0, 40.0, 350.0, 90.0, 0.0, 60.0, 160.0, 150.0, 50.0, 90.0, 130.0, 30.0, 110.0, 720.0, 160.0, 20.0, 40.0, 0.0, 200.0, 300.0, 40.0, 40.0, 230.0, -30.0, 150.0, 20.0, 190.0, 10.0, 35.0, 150.0, 0.0, 190.0, 110.0, 210.0, 50.0, 460.0, 30.0, 240.0, 10.0, 10.0, 10.0, -30.0, 60.0, 70.0, 20.0, 180.0, 550.0, 380.0, -20.0, 390.0, -30.0, 740.0, 60.0, 60.0, 270.0, 10.0, 50.0, 120.0, -20.0, 140.0, -45.0, 0.0, 40.0, 0.0, 120.0, 80.0, 30.0, 80.0, 0.0, 50.0, 30.0, 0.0, 30.0, 90.0, 30.0, 40.0, 80.0, 240.0, 30.0, 30.0, 30.0, 450.0, 430.0, 50.0, 160.0, 90.0, 75.0, 60.0, 60.0, 40.0, 410.0, 20.0, 210.0, 20.0, 80.0, 650.0, 20.0, 60.0, 0.0, 0.0, 350.0, 50.0, 30.0, 10.0, 0.0, 30.0, 0.0, 80.0, 190.0, 50.0, 30.0, 60.0, 530.0, 10.0, 40.0, 100.0, 110.0, 150.0, 5.0, 110.0, 270.0, 300.0, 120.0, 40.0, 50.0, -20.0, 20.0, 20.0, 80.0, 60.0, 40.0, 130.0, 40.0, 420.0, 50.0, 190.0, 40.0, 20.0, 490.0, 10.0, 30.0, 60.0, 180.0, 390.0, 30.0, 60.0, 80.0, 100.0, 0.0, 10.0, 20.0, 10.0, 0.0, 40.0, 20.0, 0.0, 30.0, 5.0, 340.0, 160.0, 90.0, 0.0, 480.0, 60.0, 290.0, 360.0, 50.0, -80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8749148257796129, "mean_inference_ms": 1.9677626357191738, "mean_action_processing_ms": 0.5135032901521803, "mean_env_wait_ms": 1.6504862478385283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014399528503417969, "StateBufferConnector_ms": 0.010954618453979492, "ViewRequirementAgentConnector_ms": 0.4307682514190674}, "num_episodes": 18, "episode_return_max": 2240.0, "episode_return_min": 40.0, "episode_return_mean": 1063.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 11.453098834960484, "num_env_steps_trained_throughput_per_sec": 11.453098834960484, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 5680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5680000, "timers": {"training_iteration_time_ms": 689246.076, "restore_workers_time_ms": 0.013, "training_step_time_ms": 689246.025, "sample_time_ms": 2598.72, "learn_time_ms": 686621.05, "learn_throughput": 5.826, "synch_weights_time_ms": 12.759}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "done": false, "training_iteration": 142, "trial_id": "3d3a5_00000", "date": "2024-06-01_19-47-06", "timestamp": 1717285626, "time_this_iter_s": 349.28256011009216, "time_total_s": 76440.9178609848, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x11802f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76440.9178609848, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 18.80104895104895, "ram_util_percent": 81.85804195804197}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5245467916019937, "cur_kl_coeff": 5.624050049306239, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003656968064554119, "vf_loss": 6.83473780381159, "vf_explained_var": 0.00027851215439736525, "kl": Infinity, "entropy": 0.215290394893533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1338075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "env_runners": {"episode_reward_max": 2240.0, "episode_reward_min": 85.0, "episode_reward_mean": 1077.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 107.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [870.0, 530.0, 1180.0, 850.0, 1485.0, 1110.0, 1420.0, 1090.0, 1190.0, 830.0, 600.0, 1300.0, 1900.0, 1185.0, 120.0, 1480.0, 1200.0, 1515.0, 115.0, 1020.0, 1870.0, 1650.0, 1190.0, 2240.0, 540.0, 530.0, 730.0, 1715.0, 1205.0, 1140.0, 450.0, 350.0, 890.0, 1065.0, 1350.0, 1030.0, 1330.0, 680.0, 710.0, 980.0, 1560.0, 1190.0, 1135.0, 870.0, 1250.0, 1220.0, 520.0, 1250.0, 1780.0, 1330.0, 1510.0, 1270.0, 420.0, 530.0, 230.0, 1280.0, 890.0, 710.0, 1605.0, 1130.0, 1510.0, 1530.0, 85.0, 1540.0, 350.0, 1450.0, 1350.0, 1150.0, 1475.0, 1260.0, 1650.0, 425.0, 590.0, 1405.0, 1570.0, 550.0, 1270.0, 915.0, 1070.0, 1430.0, 135.0, 1750.0, 1160.0, 1175.0, 1755.0, 1615.0, 1650.0, 660.0, 810.0, 1250.0, 990.0, 1185.0, 1220.0, 950.0, 400.0, 1925.0, 400.0, 540.0, 330.0, 935.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 40.0, 0.0, 40.0, 50.0, 60.0, 140.0, 40.0, -40.0, 490.0, 90.0, 50.0, 180.0, 10.0, 40.0, 80.0, 0.0, 40.0, 40.0, 0.0, 90.0, 150.0, 130.0, 40.0, 510.0, 10.0, 10.0, 120.0, 20.0, 100.0, 130.0, 170.0, 50.0, 130.0, 160.0, 70.0, 20.0, 100.0, 20.0, 0.0, 20.0, 690.0, 110.0, 50.0, 80.0, -10.0, 310.0, 280.0, -50.0, 5.0, 40.0, 150.0, 420.0, -50.0, 50.0, 180.0, 60.0, 70.0, 10.0, 180.0, 0.0, 100.0, 60.0, 0.0, 20.0, 190.0, 160.0, 370.0, 20.0, 500.0, 80.0, 60.0, 50.0, 60.0, 330.0, 190.0, 20.0, 230.0, 30.0, 40.0, 80.0, 30.0, 270.0, 80.0, 30.0, -30.0, 140.0, 70.0, 40.0, 480.0, 20.0, 10.0, 30.0, 370.0, 20.0, 40.0, 30.0, 30.0, 20.0, 260.0, 30.0, 190.0, 30.0, 40.0, 40.0, -30.0, 10.0, 230.0, 20.0, 40.0, 170.0, 70.0, 100.0, 180.0, 110.0, 370.0, 190.0, 20.0, 30.0, 60.0, 300.0, 360.0, 80.0, 20.0, 90.0, 330.0, 210.0, 250.0, 180.0, 80.0, 50.0, 470.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 380.0, 35.0, 0.0, 0.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 210.0, 190.0, -30.0, 10.0, 290.0, 110.0, 70.0, 280.0, 350.0, 430.0, 70.0, 140.0, 40.0, 260.0, 0.0, 50.0, 20.0, 170.0, 20.0, 60.0, 130.0, 30.0, -95.0, 10.0, 0.0, 170.0, 280.0, 640.0, 290.0, 0.0, 0.0, 0.0, 60.0, 10.0, 0.0, 0.0, 30.0, 0.0, 15.0, 50.0, 230.0, 0.0, -100.0, 90.0, 30.0, 10.0, 30.0, 170.0, 510.0, 610.0, 70.0, 810.0, 20.0, 120.0, 100.0, 20.0, -40.0, 10.0, 150.0, 270.0, 30.0, 480.0, 30.0, 90.0, 340.0, 70.0, 160.0, 70.0, 110.0, 10.0, 100.0, 30.0, 100.0, 30.0, 60.0, 210.0, 440.0, 170.0, 40.0, 720.0, 60.0, 150.0, 90.0, 60.0, 30.0, 140.0, 400.0, 370.0, 220.0, 10.0, 160.0, 70.0, 60.0, 30.0, 80.0, 10.0, 10.0, 40.0, 70.0, 30.0, 40.0, 50.0, 10.0, 50.0, 0.0, 70.0, 0.0, 110.0, 170.0, 40.0, 190.0, 30.0, 40.0, 40.0, 60.0, 190.0, 20.0, 90.0, 30.0, 70.0, 570.0, 170.0, 360.0, 60.0, 80.0, 60.0, 120.0, -5.0, 230.0, 20.0, 570.0, 100.0, 30.0, 10.0, -20.0, 280.0, 160.0, 45.0, 10.0, 440.0, 40.0, 50.0, 60.0, 60.0, 0.0, 60.0, 30.0, 190.0, 210.0, 0.0, 10.0, 20.0, 20.0, 40.0, 10.0, 130.0, 20.0, 180.0, 20.0, 30.0, 30.0, 20.0, 20.0, 80.0, 100.0, 0.0, 20.0, 50.0, 0.0, 170.0, 170.0, 0.0, 30.0, 40.0, 10.0, 160.0, 30.0, 230.0, 50.0, -20.0, 30.0, 240.0, 110.0, -10.0, 55.0, 70.0, 30.0, 30.0, 530.0, 340.0, 90.0, 0.0, 140.0, 100.0, 200.0, 90.0, -10.0, 410.0, -10.0, 460.0, 10.0, 20.0, 0.0, 30.0, 20.0, 460.0, 0.0, 10.0, 20.0, 230.0, 50.0, 160.0, 60.0, 160.0, 50.0, 300.0, 60.0, 80.0, 180.0, 10.0, 110.0, 170.0, 50.0, 290.0, 50.0, 40.0, 0.0, 0.0, -40.0, 50.0, 40.0, 240.0, 10.0, 390.0, 60.0, 0.0, -30.0, 0.0, -50.0, 40.0, 60.0, 40.0, 70.0, 160.0, 70.0, 20.0, 90.0, 10.0, 420.0, 330.0, 160.0, 20.0, 60.0, 0.0, 310.0, 380.0, 60.0, 170.0, 70.0, 330.0, 210.0, 130.0, 60.0, 10.0, 320.0, 30.0, 30.0, 40.0, 30.0, 350.0, 30.0, 180.0, 30.0, 60.0, 80.0, 70.0, 310.0, 5.0, 20.0, 50.0, 40.0, 0.0, 20.0, 10.0, 0.0, 100.0, 140.0, 500.0, 10.0, 90.0, 220.0, 140.0, 0.0, 210.0, 0.0, 120.0, 120.0, 20.0, 330.0, 40.0, 50.0, 140.0, 40.0, 290.0, 90.0, 50.0, 160.0, 40.0, 320.0, 10.0, 20.0, 20.0, 320.0, 20.0, 0.0, 90.0, 30.0, 10.0, 0.0, 30.0, 0.0, 470.0, 370.0, 10.0, 40.0, 60.0, 50.0, 110.0, 110.0, 60.0, 60.0, 60.0, 350.0, 200.0, 170.0, 150.0, 180.0, -60.0, 610.0, 150.0, 200.0, 180.0, 60.0, 300.0, 70.0, 80.0, 60.0, 160.0, 70.0, 160.0, 200.0, 50.0, 180.0, 0.0, 20.0, 0.0, 30.0, 720.0, 150.0, 370.0, 110.0, 90.0, 30.0, 370.0, 150.0, 60.0, 20.0, 30.0, 40.0, 0.0, 30.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 220.0, 0.0, 50.0, 20.0, 0.0, 0.0, 230.0, 150.0, 30.0, 0.0, 50.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 10.0, 20.0, 30.0, 350.0, 20.0, 110.0, 20.0, 20.0, 190.0, 390.0, 30.0, 120.0, -150.0, 50.0, 50.0, -140.0, 470.0, 340.0, 0.0, -20.0, 200.0, 90.0, -60.0, 90.0, 40.0, 80.0, 20.0, 30.0, 300.0, 20.0, 30.0, 160.0, 80.0, 35.0, 80.0, 130.0, 340.0, 250.0, 330.0, 90.0, 200.0, 70.0, 170.0, 50.0, 60.0, 230.0, 60.0, 10.0, 60.0, 410.0, 70.0, 10.0, 20.0, 20.0, 280.0, 100.0, 350.0, 190.0, 90.0, 160.0, 60.0, 240.0, 20.0, 80.0, 80.0, 140.0, 290.0, 150.0, 150.0, 10.0, 90.0, 520.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 20.0, 140.0, 390.0, 250.0, 70.0, 100.0, 260.0, 200.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 30.0, 200.0, 30.0, 280.0, 300.0, 20.0, 40.0, 350.0, 90.0, 0.0, 60.0, 160.0, 150.0, 50.0, 90.0, 130.0, 30.0, 110.0, 720.0, 160.0, 20.0, 40.0, 0.0, 200.0, 300.0, 40.0, 40.0, 230.0, -30.0, 150.0, 20.0, 190.0, 10.0, 35.0, 150.0, 0.0, 190.0, 110.0, 210.0, 50.0, 460.0, 30.0, 240.0, 10.0, 10.0, 10.0, -30.0, 60.0, 70.0, 20.0, 180.0, 550.0, 380.0, -20.0, 390.0, -30.0, 740.0, 60.0, 60.0, 270.0, 10.0, 50.0, 120.0, -20.0, 140.0, -45.0, 0.0, 40.0, 0.0, 120.0, 80.0, 30.0, 80.0, 0.0, 50.0, 30.0, 0.0, 30.0, 90.0, 30.0, 40.0, 80.0, 240.0, 30.0, 30.0, 30.0, 450.0, 430.0, 50.0, 160.0, 90.0, 75.0, 60.0, 60.0, 40.0, 410.0, 20.0, 210.0, 20.0, 80.0, 650.0, 20.0, 60.0, 0.0, 0.0, 350.0, 50.0, 30.0, 10.0, 0.0, 30.0, 0.0, 80.0, 190.0, 50.0, 30.0, 60.0, 530.0, 10.0, 40.0, 100.0, 110.0, 150.0, 5.0, 110.0, 270.0, 300.0, 120.0, 40.0, 50.0, -20.0, 20.0, 20.0, 80.0, 60.0, 40.0, 130.0, 40.0, 420.0, 50.0, 190.0, 40.0, 20.0, 490.0, 10.0, 30.0, 60.0, 180.0, 390.0, 30.0, 60.0, 80.0, 100.0, 0.0, 10.0, 20.0, 10.0, 0.0, 40.0, 20.0, 0.0, 30.0, 5.0, 340.0, 160.0, 90.0, 0.0, 480.0, 60.0, 290.0, 360.0, 50.0, -80.0, 100.0, 180.0, -30.0, 20.0, 180.0, 410.0, 210.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 170.0, 60.0, 50.0, 130.0, 35.0, 200.0, 430.0, 270.0, 80.0, 350.0, 50.0, 10.0, 250.0, 520.0, 150.0, 70.0, 5.0, 160.0, 90.0, 30.0, 170.0, 540.0, 300.0, 90.0, 105.0, 30.0, 100.0, 90.0, 80.0, -40.0, 310.0, 260.0, 70.0, 10.0, 340.0, 80.0, 450.0, 40.0, 30.0, 0.0, 0.0, 40.0, 100.0, 10.0, 10.0, 350.0, 80.0, 0.0, 90.0, 40.0, 80.0, 90.0, 10.0, 170.0, 40.0, 260.0, 30.0, 310.0, 70.0, 20.0, 40.0, 60.0, 50.0, 600.0, 30.0, 70.0, 0.0, 20.0, 20.0, 240.0, 40.0, 180.0, 70.0, 260.0, 90.0, 20.0, 50.0, 0.0, 170.0, 10.0, 20.0, 100.0, 320.0, 60.0, 235.0, 70.0, 200.0, 190.0, 220.0, 210.0, 40.0, 210.0, 50.0, 40.0, 30.0, 220.0, 10.0, 50.0, 50.0, 60.0, 0.0, 130.0, 480.0, 20.0, 50.0, 90.0, 20.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 20.0, 0.0, 200.0, 0.0, 280.0, 500.0, 110.0, 50.0, 80.0, 350.0, 105.0, 50.0, 60.0, 340.0, 100.0, 10.0, 10.0, 190.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 0.0, 250.0, 40.0, -20.0, 80.0, 50.0, 20.0, 60.0, 10.0, 30.0, 60.0, 40.0, 20.0, 0.0, 30.0, 10.0, 10.0, 100.0, 30.0, 20.0, 10.0, 10.0, 210.0, 200.0, 220.0, 115.0, 60.0, 10.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8720945394503263, "mean_inference_ms": 1.9656808422721468, "mean_action_processing_ms": 0.5128458699752737, "mean_env_wait_ms": 1.6484160806956965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014341592788696289, "StateBufferConnector_ms": 0.010387182235717773, "ViewRequirementAgentConnector_ms": 0.4293971061706543}, "num_episodes": 18, "episode_return_max": 2240.0, "episode_return_min": 85.0, "episode_return_mean": 1077.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.542107864995706, "num_env_steps_trained_throughput_per_sec": 6.542107864995706, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 5720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5720000, "timers": {"training_iteration_time_ms": 523452.997, "restore_workers_time_ms": 0.014, "training_step_time_ms": 523452.946, "sample_time_ms": 2595.175, "learn_time_ms": 520831.707, "learn_throughput": 7.68, "synch_weights_time_ms": 12.471}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "done": false, "training_iteration": 143, "trial_id": "3d3a5_00000", "date": "2024-06-01_19-57-18", "timestamp": 1717286238, "time_this_iter_s": 611.4311249256134, "time_total_s": 77052.34898591042, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a565e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77052.34898591042, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 20.59581881533101, "ram_util_percent": 81.95052264808362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1458105515430783, "cur_kl_coeff": 8.436075073959358, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0032486445198075587, "vf_loss": 7.397325988166249, "vf_explained_var": 0.0002110261315354905, "kl": Infinity, "entropy": 0.22446902944003178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1347465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "env_runners": {"episode_reward_max": 2240.0, "episode_reward_min": 85.0, "episode_reward_mean": 1059.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 105.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2240.0, 540.0, 530.0, 730.0, 1715.0, 1205.0, 1140.0, 450.0, 350.0, 890.0, 1065.0, 1350.0, 1030.0, 1330.0, 680.0, 710.0, 980.0, 1560.0, 1190.0, 1135.0, 870.0, 1250.0, 1220.0, 520.0, 1250.0, 1780.0, 1330.0, 1510.0, 1270.0, 420.0, 530.0, 230.0, 1280.0, 890.0, 710.0, 1605.0, 1130.0, 1510.0, 1530.0, 85.0, 1540.0, 350.0, 1450.0, 1350.0, 1150.0, 1475.0, 1260.0, 1650.0, 425.0, 590.0, 1405.0, 1570.0, 550.0, 1270.0, 915.0, 1070.0, 1430.0, 135.0, 1750.0, 1160.0, 1175.0, 1755.0, 1615.0, 1650.0, 660.0, 810.0, 1250.0, 990.0, 1185.0, 1220.0, 950.0, 400.0, 1925.0, 400.0, 540.0, 330.0, 935.0, 905.0, 1560.0, 1610.0, 1590.0, 160.0, 1200.0, 900.0, 1060.0, 1140.0, 790.0, 1400.0, 1045.0, 1550.0, 1200.0, 900.0, 1630.0, 980.0, 180.0, 870.0, 795.0, 450.0, 1140.0, 870.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [720.0, 60.0, 150.0, 90.0, 60.0, 30.0, 140.0, 400.0, 370.0, 220.0, 10.0, 160.0, 70.0, 60.0, 30.0, 80.0, 10.0, 10.0, 40.0, 70.0, 30.0, 40.0, 50.0, 10.0, 50.0, 0.0, 70.0, 0.0, 110.0, 170.0, 40.0, 190.0, 30.0, 40.0, 40.0, 60.0, 190.0, 20.0, 90.0, 30.0, 70.0, 570.0, 170.0, 360.0, 60.0, 80.0, 60.0, 120.0, -5.0, 230.0, 20.0, 570.0, 100.0, 30.0, 10.0, -20.0, 280.0, 160.0, 45.0, 10.0, 440.0, 40.0, 50.0, 60.0, 60.0, 0.0, 60.0, 30.0, 190.0, 210.0, 0.0, 10.0, 20.0, 20.0, 40.0, 10.0, 130.0, 20.0, 180.0, 20.0, 30.0, 30.0, 20.0, 20.0, 80.0, 100.0, 0.0, 20.0, 50.0, 0.0, 170.0, 170.0, 0.0, 30.0, 40.0, 10.0, 160.0, 30.0, 230.0, 50.0, -20.0, 30.0, 240.0, 110.0, -10.0, 55.0, 70.0, 30.0, 30.0, 530.0, 340.0, 90.0, 0.0, 140.0, 100.0, 200.0, 90.0, -10.0, 410.0, -10.0, 460.0, 10.0, 20.0, 0.0, 30.0, 20.0, 460.0, 0.0, 10.0, 20.0, 230.0, 50.0, 160.0, 60.0, 160.0, 50.0, 300.0, 60.0, 80.0, 180.0, 10.0, 110.0, 170.0, 50.0, 290.0, 50.0, 40.0, 0.0, 0.0, -40.0, 50.0, 40.0, 240.0, 10.0, 390.0, 60.0, 0.0, -30.0, 0.0, -50.0, 40.0, 60.0, 40.0, 70.0, 160.0, 70.0, 20.0, 90.0, 10.0, 420.0, 330.0, 160.0, 20.0, 60.0, 0.0, 310.0, 380.0, 60.0, 170.0, 70.0, 330.0, 210.0, 130.0, 60.0, 10.0, 320.0, 30.0, 30.0, 40.0, 30.0, 350.0, 30.0, 180.0, 30.0, 60.0, 80.0, 70.0, 310.0, 5.0, 20.0, 50.0, 40.0, 0.0, 20.0, 10.0, 0.0, 100.0, 140.0, 500.0, 10.0, 90.0, 220.0, 140.0, 0.0, 210.0, 0.0, 120.0, 120.0, 20.0, 330.0, 40.0, 50.0, 140.0, 40.0, 290.0, 90.0, 50.0, 160.0, 40.0, 320.0, 10.0, 20.0, 20.0, 320.0, 20.0, 0.0, 90.0, 30.0, 10.0, 0.0, 30.0, 0.0, 470.0, 370.0, 10.0, 40.0, 60.0, 50.0, 110.0, 110.0, 60.0, 60.0, 60.0, 350.0, 200.0, 170.0, 150.0, 180.0, -60.0, 610.0, 150.0, 200.0, 180.0, 60.0, 300.0, 70.0, 80.0, 60.0, 160.0, 70.0, 160.0, 200.0, 50.0, 180.0, 0.0, 20.0, 0.0, 30.0, 720.0, 150.0, 370.0, 110.0, 90.0, 30.0, 370.0, 150.0, 60.0, 20.0, 30.0, 40.0, 0.0, 30.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 220.0, 0.0, 50.0, 20.0, 0.0, 0.0, 230.0, 150.0, 30.0, 0.0, 50.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 10.0, 20.0, 30.0, 350.0, 20.0, 110.0, 20.0, 20.0, 190.0, 390.0, 30.0, 120.0, -150.0, 50.0, 50.0, -140.0, 470.0, 340.0, 0.0, -20.0, 200.0, 90.0, -60.0, 90.0, 40.0, 80.0, 20.0, 30.0, 300.0, 20.0, 30.0, 160.0, 80.0, 35.0, 80.0, 130.0, 340.0, 250.0, 330.0, 90.0, 200.0, 70.0, 170.0, 50.0, 60.0, 230.0, 60.0, 10.0, 60.0, 410.0, 70.0, 10.0, 20.0, 20.0, 280.0, 100.0, 350.0, 190.0, 90.0, 160.0, 60.0, 240.0, 20.0, 80.0, 80.0, 140.0, 290.0, 150.0, 150.0, 10.0, 90.0, 520.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 20.0, 140.0, 390.0, 250.0, 70.0, 100.0, 260.0, 200.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 30.0, 200.0, 30.0, 280.0, 300.0, 20.0, 40.0, 350.0, 90.0, 0.0, 60.0, 160.0, 150.0, 50.0, 90.0, 130.0, 30.0, 110.0, 720.0, 160.0, 20.0, 40.0, 0.0, 200.0, 300.0, 40.0, 40.0, 230.0, -30.0, 150.0, 20.0, 190.0, 10.0, 35.0, 150.0, 0.0, 190.0, 110.0, 210.0, 50.0, 460.0, 30.0, 240.0, 10.0, 10.0, 10.0, -30.0, 60.0, 70.0, 20.0, 180.0, 550.0, 380.0, -20.0, 390.0, -30.0, 740.0, 60.0, 60.0, 270.0, 10.0, 50.0, 120.0, -20.0, 140.0, -45.0, 0.0, 40.0, 0.0, 120.0, 80.0, 30.0, 80.0, 0.0, 50.0, 30.0, 0.0, 30.0, 90.0, 30.0, 40.0, 80.0, 240.0, 30.0, 30.0, 30.0, 450.0, 430.0, 50.0, 160.0, 90.0, 75.0, 60.0, 60.0, 40.0, 410.0, 20.0, 210.0, 20.0, 80.0, 650.0, 20.0, 60.0, 0.0, 0.0, 350.0, 50.0, 30.0, 10.0, 0.0, 30.0, 0.0, 80.0, 190.0, 50.0, 30.0, 60.0, 530.0, 10.0, 40.0, 100.0, 110.0, 150.0, 5.0, 110.0, 270.0, 300.0, 120.0, 40.0, 50.0, -20.0, 20.0, 20.0, 80.0, 60.0, 40.0, 130.0, 40.0, 420.0, 50.0, 190.0, 40.0, 20.0, 490.0, 10.0, 30.0, 60.0, 180.0, 390.0, 30.0, 60.0, 80.0, 100.0, 0.0, 10.0, 20.0, 10.0, 0.0, 40.0, 20.0, 0.0, 30.0, 5.0, 340.0, 160.0, 90.0, 0.0, 480.0, 60.0, 290.0, 360.0, 50.0, -80.0, 100.0, 180.0, -30.0, 20.0, 180.0, 410.0, 210.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 170.0, 60.0, 50.0, 130.0, 35.0, 200.0, 430.0, 270.0, 80.0, 350.0, 50.0, 10.0, 250.0, 520.0, 150.0, 70.0, 5.0, 160.0, 90.0, 30.0, 170.0, 540.0, 300.0, 90.0, 105.0, 30.0, 100.0, 90.0, 80.0, -40.0, 310.0, 260.0, 70.0, 10.0, 340.0, 80.0, 450.0, 40.0, 30.0, 0.0, 0.0, 40.0, 100.0, 10.0, 10.0, 350.0, 80.0, 0.0, 90.0, 40.0, 80.0, 90.0, 10.0, 170.0, 40.0, 260.0, 30.0, 310.0, 70.0, 20.0, 40.0, 60.0, 50.0, 600.0, 30.0, 70.0, 0.0, 20.0, 20.0, 240.0, 40.0, 180.0, 70.0, 260.0, 90.0, 20.0, 50.0, 0.0, 170.0, 10.0, 20.0, 100.0, 320.0, 60.0, 235.0, 70.0, 200.0, 190.0, 220.0, 210.0, 40.0, 210.0, 50.0, 40.0, 30.0, 220.0, 10.0, 50.0, 50.0, 60.0, 0.0, 130.0, 480.0, 20.0, 50.0, 90.0, 20.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 20.0, 0.0, 200.0, 0.0, 280.0, 500.0, 110.0, 50.0, 80.0, 350.0, 105.0, 50.0, 60.0, 340.0, 100.0, 10.0, 10.0, 190.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 0.0, 250.0, 40.0, -20.0, 80.0, 50.0, 20.0, 60.0, 10.0, 30.0, 60.0, 40.0, 20.0, 0.0, 30.0, 10.0, 10.0, 100.0, 30.0, 20.0, 10.0, 10.0, 210.0, 200.0, 220.0, 115.0, 60.0, 10.0, 80.0, 150.0, 220.0, -25.0, 90.0, 180.0, 30.0, 90.0, 150.0, -50.0, 70.0, 160.0, 360.0, 40.0, 340.0, 40.0, 60.0, 210.0, 280.0, -20.0, 90.0, 80.0, 30.0, 850.0, 50.0, 130.0, 50.0, 20.0, 70.0, 50.0, 280.0, 730.0, 50.0, 110.0, 260.0, 10.0, -40.0, 10.0, 270.0, 140.0, 50.0, 0.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 360.0, 40.0, 300.0, 80.0, 180.0, 120.0, 20.0, 40.0, 30.0, 200.0, -30.0, 30.0, 50.0, 190.0, 0.0, 350.0, 10.0, 0.0, 100.0, 170.0, 120.0, 50.0, -20.0, -20.0, 270.0, 430.0, -40.0, 90.0, 10.0, 130.0, 330.0, 80.0, 50.0, 110.0, 110.0, 130.0, 110.0, 20.0, 70.0, 80.0, 30.0, 100.0, 80.0, 60.0, 250.0, 80.0, 0.0, 0.0, 110.0, 190.0, 60.0, 150.0, 300.0, -10.0, 390.0, 90.0, -40.0, 230.0, 40.0, 30.0, 80.0, 160.0, 330.0, 100.0, 20.0, 70.0, 180.0, 45.0, 30.0, 20.0, -20.0, 300.0, 20.0, 20.0, 60.0, 20.0, 540.0, 130.0, 460.0, 20.0, 170.0, 390.0, -20.0, 20.0, 20.0, 0.0, 170.0, 410.0, 20.0, 40.0, 150.0, 60.0, 10.0, 220.0, 230.0, -30.0, 30.0, 110.0, 80.0, 390.0, 210.0, 220.0, 50.0, 30.0, 20.0, 190.0, 40.0, 170.0, 310.0, 90.0, 250.0, 10.0, 120.0, 80.0, 40.0, 170.0, 280.0, 70.0, -130.0, 50.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 60.0, 0.0, 10.0, 130.0, 40.0, 0.0, 60.0, 90.0, 160.0, 20.0, 300.0, 40.0, 30.0, 300.0, 180.0, 20.0, -15.0, 40.0, 60.0, 10.0, 140.0, 0.0, 60.0, 20.0, 20.0, 80.0, 20.0, 120.0, 110.0, 20.0, 20.0, 40.0, 0.0, 430.0, 60.0, 380.0, 0.0, 50.0, 100.0, 10.0, 20.0, 70.0, 20.0, 20.0, 450.0, 20.0, 40.0, 40.0, 0.0, 40.0, 240.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8685196745410375, "mean_inference_ms": 1.9630606735298448, "mean_action_processing_ms": 0.5120129086047424, "mean_env_wait_ms": 1.6458005614212845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014679193496704102, "StateBufferConnector_ms": 0.010334968566894531, "ViewRequirementAgentConnector_ms": 0.4453613758087158}, "num_episodes": 23, "episode_return_max": 2240.0, "episode_return_min": 85.0, "episode_return_mean": 1059.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 10.152130927417515, "num_env_steps_trained_throughput_per_sec": 10.152130927417515, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 5760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5760000, "timers": {"training_iteration_time_ms": 531710.226, "restore_workers_time_ms": 0.013, "training_step_time_ms": 531710.176, "sample_time_ms": 2592.789, "learn_time_ms": 529091.402, "learn_throughput": 7.56, "synch_weights_time_ms": 12.512}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "done": false, "training_iteration": 144, "trial_id": "3d3a5_00000", "date": "2024-06-01_20-03-52", "timestamp": 1717286632, "time_this_iter_s": 394.0283532142639, "time_total_s": 77446.37733912468, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a568b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77446.37733912468, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 20.1151724137931, "ram_util_percent": 82.26758620689655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1823198095995524, "cur_kl_coeff": 12.654112610939034, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002181749783864957, "vf_loss": 6.781962452351221, "vf_explained_var": 0.000139999281738005, "kl": Infinity, "entropy": 0.2206135780492022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1356855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "env_runners": {"episode_reward_max": 1930.0, "episode_reward_min": 85.0, "episode_reward_mean": 1069.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 106.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.0, 520.0, 1250.0, 1780.0, 1330.0, 1510.0, 1270.0, 420.0, 530.0, 230.0, 1280.0, 890.0, 710.0, 1605.0, 1130.0, 1510.0, 1530.0, 85.0, 1540.0, 350.0, 1450.0, 1350.0, 1150.0, 1475.0, 1260.0, 1650.0, 425.0, 590.0, 1405.0, 1570.0, 550.0, 1270.0, 915.0, 1070.0, 1430.0, 135.0, 1750.0, 1160.0, 1175.0, 1755.0, 1615.0, 1650.0, 660.0, 810.0, 1250.0, 990.0, 1185.0, 1220.0, 950.0, 400.0, 1925.0, 400.0, 540.0, 330.0, 935.0, 905.0, 1560.0, 1610.0, 1590.0, 160.0, 1200.0, 900.0, 1060.0, 1140.0, 790.0, 1400.0, 1045.0, 1550.0, 1200.0, 900.0, 1630.0, 980.0, 180.0, 870.0, 795.0, 450.0, 1140.0, 870.0, 1540.0, 730.0, 1930.0, 1880.0, 1005.0, 410.0, 695.0, 1310.0, 1230.0, 1030.0, 330.0, 760.0, 1520.0, 460.0, 1000.0, 1450.0, 1210.0, 1580.0, 1040.0, 950.0, 1040.0, 810.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 50.0, 140.0, 40.0, 290.0, 90.0, 50.0, 160.0, 40.0, 320.0, 10.0, 20.0, 20.0, 320.0, 20.0, 0.0, 90.0, 30.0, 10.0, 0.0, 30.0, 0.0, 470.0, 370.0, 10.0, 40.0, 60.0, 50.0, 110.0, 110.0, 60.0, 60.0, 60.0, 350.0, 200.0, 170.0, 150.0, 180.0, -60.0, 610.0, 150.0, 200.0, 180.0, 60.0, 300.0, 70.0, 80.0, 60.0, 160.0, 70.0, 160.0, 200.0, 50.0, 180.0, 0.0, 20.0, 0.0, 30.0, 720.0, 150.0, 370.0, 110.0, 90.0, 30.0, 370.0, 150.0, 60.0, 20.0, 30.0, 40.0, 0.0, 30.0, 50.0, 20.0, 20.0, 10.0, 20.0, 30.0, 20.0, 220.0, 0.0, 50.0, 20.0, 0.0, 0.0, 230.0, 150.0, 30.0, 0.0, 50.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 10.0, 20.0, 30.0, 350.0, 20.0, 110.0, 20.0, 20.0, 190.0, 390.0, 30.0, 120.0, -150.0, 50.0, 50.0, -140.0, 470.0, 340.0, 0.0, -20.0, 200.0, 90.0, -60.0, 90.0, 40.0, 80.0, 20.0, 30.0, 300.0, 20.0, 30.0, 160.0, 80.0, 35.0, 80.0, 130.0, 340.0, 250.0, 330.0, 90.0, 200.0, 70.0, 170.0, 50.0, 60.0, 230.0, 60.0, 10.0, 60.0, 410.0, 70.0, 10.0, 20.0, 20.0, 280.0, 100.0, 350.0, 190.0, 90.0, 160.0, 60.0, 240.0, 20.0, 80.0, 80.0, 140.0, 290.0, 150.0, 150.0, 10.0, 90.0, 520.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 20.0, 140.0, 390.0, 250.0, 70.0, 100.0, 260.0, 200.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 30.0, 200.0, 30.0, 280.0, 300.0, 20.0, 40.0, 350.0, 90.0, 0.0, 60.0, 160.0, 150.0, 50.0, 90.0, 130.0, 30.0, 110.0, 720.0, 160.0, 20.0, 40.0, 0.0, 200.0, 300.0, 40.0, 40.0, 230.0, -30.0, 150.0, 20.0, 190.0, 10.0, 35.0, 150.0, 0.0, 190.0, 110.0, 210.0, 50.0, 460.0, 30.0, 240.0, 10.0, 10.0, 10.0, -30.0, 60.0, 70.0, 20.0, 180.0, 550.0, 380.0, -20.0, 390.0, -30.0, 740.0, 60.0, 60.0, 270.0, 10.0, 50.0, 120.0, -20.0, 140.0, -45.0, 0.0, 40.0, 0.0, 120.0, 80.0, 30.0, 80.0, 0.0, 50.0, 30.0, 0.0, 30.0, 90.0, 30.0, 40.0, 80.0, 240.0, 30.0, 30.0, 30.0, 450.0, 430.0, 50.0, 160.0, 90.0, 75.0, 60.0, 60.0, 40.0, 410.0, 20.0, 210.0, 20.0, 80.0, 650.0, 20.0, 60.0, 0.0, 0.0, 350.0, 50.0, 30.0, 10.0, 0.0, 30.0, 0.0, 80.0, 190.0, 50.0, 30.0, 60.0, 530.0, 10.0, 40.0, 100.0, 110.0, 150.0, 5.0, 110.0, 270.0, 300.0, 120.0, 40.0, 50.0, -20.0, 20.0, 20.0, 80.0, 60.0, 40.0, 130.0, 40.0, 420.0, 50.0, 190.0, 40.0, 20.0, 490.0, 10.0, 30.0, 60.0, 180.0, 390.0, 30.0, 60.0, 80.0, 100.0, 0.0, 10.0, 20.0, 10.0, 0.0, 40.0, 20.0, 0.0, 30.0, 5.0, 340.0, 160.0, 90.0, 0.0, 480.0, 60.0, 290.0, 360.0, 50.0, -80.0, 100.0, 180.0, -30.0, 20.0, 180.0, 410.0, 210.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 170.0, 60.0, 50.0, 130.0, 35.0, 200.0, 430.0, 270.0, 80.0, 350.0, 50.0, 10.0, 250.0, 520.0, 150.0, 70.0, 5.0, 160.0, 90.0, 30.0, 170.0, 540.0, 300.0, 90.0, 105.0, 30.0, 100.0, 90.0, 80.0, -40.0, 310.0, 260.0, 70.0, 10.0, 340.0, 80.0, 450.0, 40.0, 30.0, 0.0, 0.0, 40.0, 100.0, 10.0, 10.0, 350.0, 80.0, 0.0, 90.0, 40.0, 80.0, 90.0, 10.0, 170.0, 40.0, 260.0, 30.0, 310.0, 70.0, 20.0, 40.0, 60.0, 50.0, 600.0, 30.0, 70.0, 0.0, 20.0, 20.0, 240.0, 40.0, 180.0, 70.0, 260.0, 90.0, 20.0, 50.0, 0.0, 170.0, 10.0, 20.0, 100.0, 320.0, 60.0, 235.0, 70.0, 200.0, 190.0, 220.0, 210.0, 40.0, 210.0, 50.0, 40.0, 30.0, 220.0, 10.0, 50.0, 50.0, 60.0, 0.0, 130.0, 480.0, 20.0, 50.0, 90.0, 20.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 20.0, 0.0, 200.0, 0.0, 280.0, 500.0, 110.0, 50.0, 80.0, 350.0, 105.0, 50.0, 60.0, 340.0, 100.0, 10.0, 10.0, 190.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 0.0, 250.0, 40.0, -20.0, 80.0, 50.0, 20.0, 60.0, 10.0, 30.0, 60.0, 40.0, 20.0, 0.0, 30.0, 10.0, 10.0, 100.0, 30.0, 20.0, 10.0, 10.0, 210.0, 200.0, 220.0, 115.0, 60.0, 10.0, 80.0, 150.0, 220.0, -25.0, 90.0, 180.0, 30.0, 90.0, 150.0, -50.0, 70.0, 160.0, 360.0, 40.0, 340.0, 40.0, 60.0, 210.0, 280.0, -20.0, 90.0, 80.0, 30.0, 850.0, 50.0, 130.0, 50.0, 20.0, 70.0, 50.0, 280.0, 730.0, 50.0, 110.0, 260.0, 10.0, -40.0, 10.0, 270.0, 140.0, 50.0, 0.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 360.0, 40.0, 300.0, 80.0, 180.0, 120.0, 20.0, 40.0, 30.0, 200.0, -30.0, 30.0, 50.0, 190.0, 0.0, 350.0, 10.0, 0.0, 100.0, 170.0, 120.0, 50.0, -20.0, -20.0, 270.0, 430.0, -40.0, 90.0, 10.0, 130.0, 330.0, 80.0, 50.0, 110.0, 110.0, 130.0, 110.0, 20.0, 70.0, 80.0, 30.0, 100.0, 80.0, 60.0, 250.0, 80.0, 0.0, 0.0, 110.0, 190.0, 60.0, 150.0, 300.0, -10.0, 390.0, 90.0, -40.0, 230.0, 40.0, 30.0, 80.0, 160.0, 330.0, 100.0, 20.0, 70.0, 180.0, 45.0, 30.0, 20.0, -20.0, 300.0, 20.0, 20.0, 60.0, 20.0, 540.0, 130.0, 460.0, 20.0, 170.0, 390.0, -20.0, 20.0, 20.0, 0.0, 170.0, 410.0, 20.0, 40.0, 150.0, 60.0, 10.0, 220.0, 230.0, -30.0, 30.0, 110.0, 80.0, 390.0, 210.0, 220.0, 50.0, 30.0, 20.0, 190.0, 40.0, 170.0, 310.0, 90.0, 250.0, 10.0, 120.0, 80.0, 40.0, 170.0, 280.0, 70.0, -130.0, 50.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 60.0, 0.0, 10.0, 130.0, 40.0, 0.0, 60.0, 90.0, 160.0, 20.0, 300.0, 40.0, 30.0, 300.0, 180.0, 20.0, -15.0, 40.0, 60.0, 10.0, 140.0, 0.0, 60.0, 20.0, 20.0, 80.0, 20.0, 120.0, 110.0, 20.0, 20.0, 40.0, 0.0, 430.0, 60.0, 380.0, 0.0, 50.0, 100.0, 10.0, 20.0, 70.0, 20.0, 20.0, 450.0, 20.0, 40.0, 40.0, 0.0, 40.0, 240.0, 0.0, 20.0, 170.0, 340.0, 40.0, 40.0, 560.0, 40.0, 180.0, 20.0, 40.0, 110.0, 0.0, 80.0, 10.0, 160.0, 240.0, 40.0, 30.0, 140.0, 30.0, 0.0, 50.0, 280.0, 140.0, 490.0, 340.0, 10.0, 270.0, 240.0, 0.0, 110.0, 130.0, 90.0, 50.0, 260.0, 140.0, 120.0, 660.0, 220.0, 80.0, 130.0, 175.0, 70.0, 150.0, -260.0, 170.0, 230.0, 50.0, -40.0, 110.0, 350.0, 30.0, 0.0, 20.0, 10.0, 210.0, 10.0, 0.0, 70.0, 30.0, 30.0, 50.0, 50.0, 310.0, 50.0, 15.0, 30.0, 30.0, -120.0, 270.0, 10.0, 60.0, 410.0, 270.0, 80.0, 10.0, 190.0, 130.0, 70.0, 310.0, -220.0, 20.0, 20.0, 220.0, 10.0, 290.0, 90.0, 70.0, 30.0, 180.0, 300.0, 60.0, 80.0, 60.0, 20.0, 10.0, 220.0, 160.0, 110.0, 50.0, 260.0, 30.0, 0.0, 0.0, 0.0, 190.0, 60.0, 10.0, 0.0, 40.0, 0.0, 390.0, 0.0, 160.0, 30.0, -10.0, 30.0, 10.0, -30.0, 130.0, 50.0, 0.0, -100.0, 585.0, 510.0, 220.0, 15.0, 270.0, -40.0, 40.0, 20.0, 30.0, 60.0, 260.0, 50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 0.0, 140.0, 170.0, 50.0, 50.0, 0.0, 20.0, 70.0, 260.0, 200.0, 40.0, 60.0, 110.0, 40.0, 120.0, 170.0, 60.0, 310.0, 50.0, 160.0, 370.0, 490.0, 70.0, -30.0, 190.0, 10.0, 70.0, 40.0, 220.0, 120.0, 30.0, 40.0, 310.0, 160.0, 60.0, 20.0, 130.0, 40.0, 830.0, -40.0, 30.0, 350.0, 200.0, 120.0, 60.0, 20.0, 0.0, 70.0, 110.0, 60.0, 50.0, -10.0, 290.0, 40.0, 0.0, 30.0, 470.0, 20.0, 20.0, 80.0, 10.0, 50.0, 450.0, 170.0, 40.0, 10.0, 40.0, 60.0, 30.0, 170.0, 20.0, 50.0, 280.0, -10.0, 50.0, 130.0, 60.0, 40.0, 10.0, 40.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8614730115092426, "mean_inference_ms": 1.9536439167855417, "mean_action_processing_ms": 0.5106408655019075, "mean_env_wait_ms": 1.6422583947195253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014118671417236328, "StateBufferConnector_ms": 0.010123729705810547, "ViewRequirementAgentConnector_ms": 0.43187546730041504}, "num_episodes": 22, "episode_return_max": 1930.0, "episode_return_min": 85.0, "episode_return_mean": 1069.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.9515183297602252, "num_env_steps_trained_throughput_per_sec": 1.9515183297602252, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 5800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5800000, "timers": {"training_iteration_time_ms": 699177.072, "restore_workers_time_ms": 0.013, "training_step_time_ms": 699177.022, "sample_time_ms": 2603.679, "learn_time_ms": 696547.32, "learn_throughput": 5.743, "synch_weights_time_ms": 12.779}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "done": false, "training_iteration": 145, "trial_id": "3d3a5_00000", "date": "2024-06-01_20-38-02", "timestamp": 1717288682, "time_this_iter_s": 2049.70818400383, "time_total_s": 79496.08552312851, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a581f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 79496.08552312851, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 28.795751633986928, "ram_util_percent": 82.88202614379084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5314193157405773, "cur_kl_coeff": 18.98116891640856, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.213233173540987, "policy_loss": -0.002142047251007372, "vf_loss": 7.212757786241964, "vf_explained_var": 0.0010308568152629784, "kl": 0.0001378967537208546, "entropy": 0.21806707278576395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1366245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "env_runners": {"episode_reward_max": 2390.0, "episode_reward_min": 135.0, "episode_reward_mean": 1090.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 1060.0}, "policy_reward_mean": {"policy_0": 109.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1540.0, 350.0, 1450.0, 1350.0, 1150.0, 1475.0, 1260.0, 1650.0, 425.0, 590.0, 1405.0, 1570.0, 550.0, 1270.0, 915.0, 1070.0, 1430.0, 135.0, 1750.0, 1160.0, 1175.0, 1755.0, 1615.0, 1650.0, 660.0, 810.0, 1250.0, 990.0, 1185.0, 1220.0, 950.0, 400.0, 1925.0, 400.0, 540.0, 330.0, 935.0, 905.0, 1560.0, 1610.0, 1590.0, 160.0, 1200.0, 900.0, 1060.0, 1140.0, 790.0, 1400.0, 1045.0, 1550.0, 1200.0, 900.0, 1630.0, 980.0, 180.0, 870.0, 795.0, 450.0, 1140.0, 870.0, 1540.0, 730.0, 1930.0, 1880.0, 1005.0, 410.0, 695.0, 1310.0, 1230.0, 1030.0, 330.0, 760.0, 1520.0, 460.0, 1000.0, 1450.0, 1210.0, 1580.0, 1040.0, 950.0, 1040.0, 810.0, 905.0, 1020.0, 1225.0, 735.0, 490.0, 1050.0, 1295.0, 1190.0, 845.0, 1335.0, 1395.0, 2390.0, 1400.0, 1390.0, 885.0, 580.0, 1470.0, 1350.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 390.0, 250.0, 70.0, 100.0, 260.0, 200.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 30.0, 200.0, 30.0, 280.0, 300.0, 20.0, 40.0, 350.0, 90.0, 0.0, 60.0, 160.0, 150.0, 50.0, 90.0, 130.0, 30.0, 110.0, 720.0, 160.0, 20.0, 40.0, 0.0, 200.0, 300.0, 40.0, 40.0, 230.0, -30.0, 150.0, 20.0, 190.0, 10.0, 35.0, 150.0, 0.0, 190.0, 110.0, 210.0, 50.0, 460.0, 30.0, 240.0, 10.0, 10.0, 10.0, -30.0, 60.0, 70.0, 20.0, 180.0, 550.0, 380.0, -20.0, 390.0, -30.0, 740.0, 60.0, 60.0, 270.0, 10.0, 50.0, 120.0, -20.0, 140.0, -45.0, 0.0, 40.0, 0.0, 120.0, 80.0, 30.0, 80.0, 0.0, 50.0, 30.0, 0.0, 30.0, 90.0, 30.0, 40.0, 80.0, 240.0, 30.0, 30.0, 30.0, 450.0, 430.0, 50.0, 160.0, 90.0, 75.0, 60.0, 60.0, 40.0, 410.0, 20.0, 210.0, 20.0, 80.0, 650.0, 20.0, 60.0, 0.0, 0.0, 350.0, 50.0, 30.0, 10.0, 0.0, 30.0, 0.0, 80.0, 190.0, 50.0, 30.0, 60.0, 530.0, 10.0, 40.0, 100.0, 110.0, 150.0, 5.0, 110.0, 270.0, 300.0, 120.0, 40.0, 50.0, -20.0, 20.0, 20.0, 80.0, 60.0, 40.0, 130.0, 40.0, 420.0, 50.0, 190.0, 40.0, 20.0, 490.0, 10.0, 30.0, 60.0, 180.0, 390.0, 30.0, 60.0, 80.0, 100.0, 0.0, 10.0, 20.0, 10.0, 0.0, 40.0, 20.0, 0.0, 30.0, 5.0, 340.0, 160.0, 90.0, 0.0, 480.0, 60.0, 290.0, 360.0, 50.0, -80.0, 100.0, 180.0, -30.0, 20.0, 180.0, 410.0, 210.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 170.0, 60.0, 50.0, 130.0, 35.0, 200.0, 430.0, 270.0, 80.0, 350.0, 50.0, 10.0, 250.0, 520.0, 150.0, 70.0, 5.0, 160.0, 90.0, 30.0, 170.0, 540.0, 300.0, 90.0, 105.0, 30.0, 100.0, 90.0, 80.0, -40.0, 310.0, 260.0, 70.0, 10.0, 340.0, 80.0, 450.0, 40.0, 30.0, 0.0, 0.0, 40.0, 100.0, 10.0, 10.0, 350.0, 80.0, 0.0, 90.0, 40.0, 80.0, 90.0, 10.0, 170.0, 40.0, 260.0, 30.0, 310.0, 70.0, 20.0, 40.0, 60.0, 50.0, 600.0, 30.0, 70.0, 0.0, 20.0, 20.0, 240.0, 40.0, 180.0, 70.0, 260.0, 90.0, 20.0, 50.0, 0.0, 170.0, 10.0, 20.0, 100.0, 320.0, 60.0, 235.0, 70.0, 200.0, 190.0, 220.0, 210.0, 40.0, 210.0, 50.0, 40.0, 30.0, 220.0, 10.0, 50.0, 50.0, 60.0, 0.0, 130.0, 480.0, 20.0, 50.0, 90.0, 20.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 20.0, 0.0, 200.0, 0.0, 280.0, 500.0, 110.0, 50.0, 80.0, 350.0, 105.0, 50.0, 60.0, 340.0, 100.0, 10.0, 10.0, 190.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 0.0, 250.0, 40.0, -20.0, 80.0, 50.0, 20.0, 60.0, 10.0, 30.0, 60.0, 40.0, 20.0, 0.0, 30.0, 10.0, 10.0, 100.0, 30.0, 20.0, 10.0, 10.0, 210.0, 200.0, 220.0, 115.0, 60.0, 10.0, 80.0, 150.0, 220.0, -25.0, 90.0, 180.0, 30.0, 90.0, 150.0, -50.0, 70.0, 160.0, 360.0, 40.0, 340.0, 40.0, 60.0, 210.0, 280.0, -20.0, 90.0, 80.0, 30.0, 850.0, 50.0, 130.0, 50.0, 20.0, 70.0, 50.0, 280.0, 730.0, 50.0, 110.0, 260.0, 10.0, -40.0, 10.0, 270.0, 140.0, 50.0, 0.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 360.0, 40.0, 300.0, 80.0, 180.0, 120.0, 20.0, 40.0, 30.0, 200.0, -30.0, 30.0, 50.0, 190.0, 0.0, 350.0, 10.0, 0.0, 100.0, 170.0, 120.0, 50.0, -20.0, -20.0, 270.0, 430.0, -40.0, 90.0, 10.0, 130.0, 330.0, 80.0, 50.0, 110.0, 110.0, 130.0, 110.0, 20.0, 70.0, 80.0, 30.0, 100.0, 80.0, 60.0, 250.0, 80.0, 0.0, 0.0, 110.0, 190.0, 60.0, 150.0, 300.0, -10.0, 390.0, 90.0, -40.0, 230.0, 40.0, 30.0, 80.0, 160.0, 330.0, 100.0, 20.0, 70.0, 180.0, 45.0, 30.0, 20.0, -20.0, 300.0, 20.0, 20.0, 60.0, 20.0, 540.0, 130.0, 460.0, 20.0, 170.0, 390.0, -20.0, 20.0, 20.0, 0.0, 170.0, 410.0, 20.0, 40.0, 150.0, 60.0, 10.0, 220.0, 230.0, -30.0, 30.0, 110.0, 80.0, 390.0, 210.0, 220.0, 50.0, 30.0, 20.0, 190.0, 40.0, 170.0, 310.0, 90.0, 250.0, 10.0, 120.0, 80.0, 40.0, 170.0, 280.0, 70.0, -130.0, 50.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 60.0, 0.0, 10.0, 130.0, 40.0, 0.0, 60.0, 90.0, 160.0, 20.0, 300.0, 40.0, 30.0, 300.0, 180.0, 20.0, -15.0, 40.0, 60.0, 10.0, 140.0, 0.0, 60.0, 20.0, 20.0, 80.0, 20.0, 120.0, 110.0, 20.0, 20.0, 40.0, 0.0, 430.0, 60.0, 380.0, 0.0, 50.0, 100.0, 10.0, 20.0, 70.0, 20.0, 20.0, 450.0, 20.0, 40.0, 40.0, 0.0, 40.0, 240.0, 0.0, 20.0, 170.0, 340.0, 40.0, 40.0, 560.0, 40.0, 180.0, 20.0, 40.0, 110.0, 0.0, 80.0, 10.0, 160.0, 240.0, 40.0, 30.0, 140.0, 30.0, 0.0, 50.0, 280.0, 140.0, 490.0, 340.0, 10.0, 270.0, 240.0, 0.0, 110.0, 130.0, 90.0, 50.0, 260.0, 140.0, 120.0, 660.0, 220.0, 80.0, 130.0, 175.0, 70.0, 150.0, -260.0, 170.0, 230.0, 50.0, -40.0, 110.0, 350.0, 30.0, 0.0, 20.0, 10.0, 210.0, 10.0, 0.0, 70.0, 30.0, 30.0, 50.0, 50.0, 310.0, 50.0, 15.0, 30.0, 30.0, -120.0, 270.0, 10.0, 60.0, 410.0, 270.0, 80.0, 10.0, 190.0, 130.0, 70.0, 310.0, -220.0, 20.0, 20.0, 220.0, 10.0, 290.0, 90.0, 70.0, 30.0, 180.0, 300.0, 60.0, 80.0, 60.0, 20.0, 10.0, 220.0, 160.0, 110.0, 50.0, 260.0, 30.0, 0.0, 0.0, 0.0, 190.0, 60.0, 10.0, 0.0, 40.0, 0.0, 390.0, 0.0, 160.0, 30.0, -10.0, 30.0, 10.0, -30.0, 130.0, 50.0, 0.0, -100.0, 585.0, 510.0, 220.0, 15.0, 270.0, -40.0, 40.0, 20.0, 30.0, 60.0, 260.0, 50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 0.0, 140.0, 170.0, 50.0, 50.0, 0.0, 20.0, 70.0, 260.0, 200.0, 40.0, 60.0, 110.0, 40.0, 120.0, 170.0, 60.0, 310.0, 50.0, 160.0, 370.0, 490.0, 70.0, -30.0, 190.0, 10.0, 70.0, 40.0, 220.0, 120.0, 30.0, 40.0, 310.0, 160.0, 60.0, 20.0, 130.0, 40.0, 830.0, -40.0, 30.0, 350.0, 200.0, 120.0, 60.0, 20.0, 0.0, 70.0, 110.0, 60.0, 50.0, -10.0, 290.0, 40.0, 0.0, 30.0, 470.0, 20.0, 20.0, 80.0, 10.0, 50.0, 450.0, 170.0, 40.0, 10.0, 40.0, 60.0, 30.0, 170.0, 20.0, 50.0, 280.0, -10.0, 50.0, 130.0, 60.0, 40.0, 10.0, 40.0, 160.0, 110.0, 10.0, 200.0, 70.0, 10.0, -95.0, 540.0, 130.0, -110.0, 40.0, 80.0, 10.0, 140.0, 180.0, 100.0, 170.0, 20.0, 70.0, 70.0, 180.0, 520.0, 140.0, 170.0, 40.0, 10.0, 55.0, 40.0, 170.0, 60.0, 20.0, 40.0, 30.0, 20.0, 30.0, -15.0, 90.0, 30.0, 20.0, 100.0, 390.0, 90.0, 20.0, 50.0, 40.0, 70.0, 30.0, 0.0, 20.0, 0.0, 170.0, 70.0, 320.0, 10.0, 70.0, 30.0, -10.0, 330.0, 30.0, 200.0, 0.0, 20.0, 110.0, 25.0, 300.0, 60.0, 70.0, 280.0, 50.0, 350.0, 30.0, 80.0, 150.0, 60.0, 150.0, 170.0, 0.0, 500.0, 10.0, 0.0, 70.0, 40.0, 75.0, 10.0, 20.0, 20.0, 90.0, -20.0, 70.0, 60.0, 480.0, 590.0, 70.0, 20.0, 0.0, 20.0, 15.0, 70.0, 280.0, 200.0, 70.0, 210.0, 130.0, 370.0, 30.0, 330.0, 65.0, 30.0, 80.0, 130.0, 20.0, 70.0, 60.0, 630.0, 150.0, 140.0, 1060.0, 130.0, 30.0, 50.0, 70.0, 50.0, 140.0, 150.0, 260.0, 180.0, 50.0, -10.0, 530.0, 50.0, 0.0, 240.0, 240.0, 50.0, 50.0, 250.0, 60.0, 270.0, 60.0, 40.0, 130.0, 150.0, 20.0, 310.0, 90.0, 90.0, 40.0, 120.0, 50.0, -45.0, 60.0, 70.0, 0.0, 60.0, 30.0, 10.0, 70.0, 50.0, 10.0, 270.0, 10.0, 30.0, 45.0, 100.0, 370.0, 140.0, 0.0, 670.0, -135.0, 50.0, 200.0, 10.0, 30.0, 170.0, 220.0, 60.0, 70.0, 80.0, 620.0, 40.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8628815275753576, "mean_inference_ms": 1.9590458999324805, "mean_action_processing_ms": 0.5106743744113746, "mean_env_wait_ms": 1.6415195010413839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012988567352294922, "StateBufferConnector_ms": 0.010015726089477539, "ViewRequirementAgentConnector_ms": 0.46978163719177246}, "num_episodes": 18, "episode_return_max": 2390.0, "episode_return_min": 135.0, "episode_return_mean": 1090.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 7.466941761572684, "num_env_steps_trained_throughput_per_sec": 7.466941761572684, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 5840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5840000, "timers": {"training_iteration_time_ms": 716179.407, "restore_workers_time_ms": 0.013, "training_step_time_ms": 716179.358, "sample_time_ms": 2682.83, "learn_time_ms": 713471.073, "learn_throughput": 5.606, "synch_weights_time_ms": 12.43}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "done": false, "training_iteration": 146, "trial_id": "3d3a5_00000", "date": "2024-06-01_20-46-57", "timestamp": 1717289217, "time_this_iter_s": 535.7737867832184, "time_total_s": 80031.85930991173, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118afb430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80031.85930991173, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 34.68480243161094, "ram_util_percent": 82.57841945288754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9411211546046285, "cur_kl_coeff": 9.49058445820428, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002597429182036275, "vf_loss": 6.850134836802213, "vf_explained_var": 0.0011069665892055622, "kl": Infinity, "entropy": 0.21630665193509244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1375635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "env_runners": {"episode_reward_max": 2390.0, "episode_reward_min": 160.0, "episode_reward_mean": 1101.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 1060.0}, "policy_reward_mean": {"policy_0": 110.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1750.0, 1160.0, 1175.0, 1755.0, 1615.0, 1650.0, 660.0, 810.0, 1250.0, 990.0, 1185.0, 1220.0, 950.0, 400.0, 1925.0, 400.0, 540.0, 330.0, 935.0, 905.0, 1560.0, 1610.0, 1590.0, 160.0, 1200.0, 900.0, 1060.0, 1140.0, 790.0, 1400.0, 1045.0, 1550.0, 1200.0, 900.0, 1630.0, 980.0, 180.0, 870.0, 795.0, 450.0, 1140.0, 870.0, 1540.0, 730.0, 1930.0, 1880.0, 1005.0, 410.0, 695.0, 1310.0, 1230.0, 1030.0, 330.0, 760.0, 1520.0, 460.0, 1000.0, 1450.0, 1210.0, 1580.0, 1040.0, 950.0, 1040.0, 810.0, 905.0, 1020.0, 1225.0, 735.0, 490.0, 1050.0, 1295.0, 1190.0, 845.0, 1335.0, 1395.0, 2390.0, 1400.0, 1390.0, 885.0, 580.0, 1470.0, 1350.0, 1150.0, 1300.0, 1310.0, 1100.0, 1260.0, 1320.0, 300.0, 810.0, 840.0, 1960.0, 1050.0, 1770.0, 1510.0, 730.0, 730.0, 1500.0, 1150.0, 840.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [340.0, 160.0, 90.0, 0.0, 480.0, 60.0, 290.0, 360.0, 50.0, -80.0, 100.0, 180.0, -30.0, 20.0, 180.0, 410.0, 210.0, 30.0, 0.0, 60.0, 30.0, 30.0, 40.0, 170.0, 60.0, 50.0, 130.0, 35.0, 200.0, 430.0, 270.0, 80.0, 350.0, 50.0, 10.0, 250.0, 520.0, 150.0, 70.0, 5.0, 160.0, 90.0, 30.0, 170.0, 540.0, 300.0, 90.0, 105.0, 30.0, 100.0, 90.0, 80.0, -40.0, 310.0, 260.0, 70.0, 10.0, 340.0, 80.0, 450.0, 40.0, 30.0, 0.0, 0.0, 40.0, 100.0, 10.0, 10.0, 350.0, 80.0, 0.0, 90.0, 40.0, 80.0, 90.0, 10.0, 170.0, 40.0, 260.0, 30.0, 310.0, 70.0, 20.0, 40.0, 60.0, 50.0, 600.0, 30.0, 70.0, 0.0, 20.0, 20.0, 240.0, 40.0, 180.0, 70.0, 260.0, 90.0, 20.0, 50.0, 0.0, 170.0, 10.0, 20.0, 100.0, 320.0, 60.0, 235.0, 70.0, 200.0, 190.0, 220.0, 210.0, 40.0, 210.0, 50.0, 40.0, 30.0, 220.0, 10.0, 50.0, 50.0, 60.0, 0.0, 130.0, 480.0, 20.0, 50.0, 90.0, 20.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 20.0, 0.0, 200.0, 0.0, 280.0, 500.0, 110.0, 50.0, 80.0, 350.0, 105.0, 50.0, 60.0, 340.0, 100.0, 10.0, 10.0, 190.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 0.0, 250.0, 40.0, -20.0, 80.0, 50.0, 20.0, 60.0, 10.0, 30.0, 60.0, 40.0, 20.0, 0.0, 30.0, 10.0, 10.0, 100.0, 30.0, 20.0, 10.0, 10.0, 210.0, 200.0, 220.0, 115.0, 60.0, 10.0, 80.0, 150.0, 220.0, -25.0, 90.0, 180.0, 30.0, 90.0, 150.0, -50.0, 70.0, 160.0, 360.0, 40.0, 340.0, 40.0, 60.0, 210.0, 280.0, -20.0, 90.0, 80.0, 30.0, 850.0, 50.0, 130.0, 50.0, 20.0, 70.0, 50.0, 280.0, 730.0, 50.0, 110.0, 260.0, 10.0, -40.0, 10.0, 270.0, 140.0, 50.0, 0.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 360.0, 40.0, 300.0, 80.0, 180.0, 120.0, 20.0, 40.0, 30.0, 200.0, -30.0, 30.0, 50.0, 190.0, 0.0, 350.0, 10.0, 0.0, 100.0, 170.0, 120.0, 50.0, -20.0, -20.0, 270.0, 430.0, -40.0, 90.0, 10.0, 130.0, 330.0, 80.0, 50.0, 110.0, 110.0, 130.0, 110.0, 20.0, 70.0, 80.0, 30.0, 100.0, 80.0, 60.0, 250.0, 80.0, 0.0, 0.0, 110.0, 190.0, 60.0, 150.0, 300.0, -10.0, 390.0, 90.0, -40.0, 230.0, 40.0, 30.0, 80.0, 160.0, 330.0, 100.0, 20.0, 70.0, 180.0, 45.0, 30.0, 20.0, -20.0, 300.0, 20.0, 20.0, 60.0, 20.0, 540.0, 130.0, 460.0, 20.0, 170.0, 390.0, -20.0, 20.0, 20.0, 0.0, 170.0, 410.0, 20.0, 40.0, 150.0, 60.0, 10.0, 220.0, 230.0, -30.0, 30.0, 110.0, 80.0, 390.0, 210.0, 220.0, 50.0, 30.0, 20.0, 190.0, 40.0, 170.0, 310.0, 90.0, 250.0, 10.0, 120.0, 80.0, 40.0, 170.0, 280.0, 70.0, -130.0, 50.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 60.0, 0.0, 10.0, 130.0, 40.0, 0.0, 60.0, 90.0, 160.0, 20.0, 300.0, 40.0, 30.0, 300.0, 180.0, 20.0, -15.0, 40.0, 60.0, 10.0, 140.0, 0.0, 60.0, 20.0, 20.0, 80.0, 20.0, 120.0, 110.0, 20.0, 20.0, 40.0, 0.0, 430.0, 60.0, 380.0, 0.0, 50.0, 100.0, 10.0, 20.0, 70.0, 20.0, 20.0, 450.0, 20.0, 40.0, 40.0, 0.0, 40.0, 240.0, 0.0, 20.0, 170.0, 340.0, 40.0, 40.0, 560.0, 40.0, 180.0, 20.0, 40.0, 110.0, 0.0, 80.0, 10.0, 160.0, 240.0, 40.0, 30.0, 140.0, 30.0, 0.0, 50.0, 280.0, 140.0, 490.0, 340.0, 10.0, 270.0, 240.0, 0.0, 110.0, 130.0, 90.0, 50.0, 260.0, 140.0, 120.0, 660.0, 220.0, 80.0, 130.0, 175.0, 70.0, 150.0, -260.0, 170.0, 230.0, 50.0, -40.0, 110.0, 350.0, 30.0, 0.0, 20.0, 10.0, 210.0, 10.0, 0.0, 70.0, 30.0, 30.0, 50.0, 50.0, 310.0, 50.0, 15.0, 30.0, 30.0, -120.0, 270.0, 10.0, 60.0, 410.0, 270.0, 80.0, 10.0, 190.0, 130.0, 70.0, 310.0, -220.0, 20.0, 20.0, 220.0, 10.0, 290.0, 90.0, 70.0, 30.0, 180.0, 300.0, 60.0, 80.0, 60.0, 20.0, 10.0, 220.0, 160.0, 110.0, 50.0, 260.0, 30.0, 0.0, 0.0, 0.0, 190.0, 60.0, 10.0, 0.0, 40.0, 0.0, 390.0, 0.0, 160.0, 30.0, -10.0, 30.0, 10.0, -30.0, 130.0, 50.0, 0.0, -100.0, 585.0, 510.0, 220.0, 15.0, 270.0, -40.0, 40.0, 20.0, 30.0, 60.0, 260.0, 50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 0.0, 140.0, 170.0, 50.0, 50.0, 0.0, 20.0, 70.0, 260.0, 200.0, 40.0, 60.0, 110.0, 40.0, 120.0, 170.0, 60.0, 310.0, 50.0, 160.0, 370.0, 490.0, 70.0, -30.0, 190.0, 10.0, 70.0, 40.0, 220.0, 120.0, 30.0, 40.0, 310.0, 160.0, 60.0, 20.0, 130.0, 40.0, 830.0, -40.0, 30.0, 350.0, 200.0, 120.0, 60.0, 20.0, 0.0, 70.0, 110.0, 60.0, 50.0, -10.0, 290.0, 40.0, 0.0, 30.0, 470.0, 20.0, 20.0, 80.0, 10.0, 50.0, 450.0, 170.0, 40.0, 10.0, 40.0, 60.0, 30.0, 170.0, 20.0, 50.0, 280.0, -10.0, 50.0, 130.0, 60.0, 40.0, 10.0, 40.0, 160.0, 110.0, 10.0, 200.0, 70.0, 10.0, -95.0, 540.0, 130.0, -110.0, 40.0, 80.0, 10.0, 140.0, 180.0, 100.0, 170.0, 20.0, 70.0, 70.0, 180.0, 520.0, 140.0, 170.0, 40.0, 10.0, 55.0, 40.0, 170.0, 60.0, 20.0, 40.0, 30.0, 20.0, 30.0, -15.0, 90.0, 30.0, 20.0, 100.0, 390.0, 90.0, 20.0, 50.0, 40.0, 70.0, 30.0, 0.0, 20.0, 0.0, 170.0, 70.0, 320.0, 10.0, 70.0, 30.0, -10.0, 330.0, 30.0, 200.0, 0.0, 20.0, 110.0, 25.0, 300.0, 60.0, 70.0, 280.0, 50.0, 350.0, 30.0, 80.0, 150.0, 60.0, 150.0, 170.0, 0.0, 500.0, 10.0, 0.0, 70.0, 40.0, 75.0, 10.0, 20.0, 20.0, 90.0, -20.0, 70.0, 60.0, 480.0, 590.0, 70.0, 20.0, 0.0, 20.0, 15.0, 70.0, 280.0, 200.0, 70.0, 210.0, 130.0, 370.0, 30.0, 330.0, 65.0, 30.0, 80.0, 130.0, 20.0, 70.0, 60.0, 630.0, 150.0, 140.0, 1060.0, 130.0, 30.0, 50.0, 70.0, 50.0, 140.0, 150.0, 260.0, 180.0, 50.0, -10.0, 530.0, 50.0, 0.0, 240.0, 240.0, 50.0, 50.0, 250.0, 60.0, 270.0, 60.0, 40.0, 130.0, 150.0, 20.0, 310.0, 90.0, 90.0, 40.0, 120.0, 50.0, -45.0, 60.0, 70.0, 0.0, 60.0, 30.0, 10.0, 70.0, 50.0, 10.0, 270.0, 10.0, 30.0, 45.0, 100.0, 370.0, 140.0, 0.0, 670.0, -135.0, 50.0, 200.0, 10.0, 30.0, 170.0, 220.0, 60.0, 70.0, 80.0, 620.0, 40.0, 50.0, 100.0, 10.0, 150.0, 10.0, 70.0, 110.0, 100.0, 390.0, 170.0, 40.0, 180.0, -20.0, 790.0, 40.0, 100.0, 40.0, 100.0, 20.0, 50.0, 0.0, 80.0, 30.0, 510.0, 60.0, 10.0, 440.0, 100.0, -10.0, 60.0, 30.0, 20.0, 620.0, 70.0, 70.0, 20.0, 10.0, 40.0, 30.0, 110.0, 110.0, 460.0, 10.0, 50.0, 30.0, 10.0, 90.0, 190.0, 10.0, 330.0, 80.0, 80.0, 30.0, 220.0, 0.0, 370.0, 300.0, 150.0, 40.0, 40.0, 90.0, 20.0, 20.0, 180.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 80.0, 20.0, 30.0, 30.0, 30.0, 20.0, 10.0, 250.0, 300.0, 40.0, 30.0, 140.0, 50.0, 10.0, 40.0, 30.0, 340.0, 40.0, 200.0, -40.0, 130.0, 450.0, 100.0, 150.0, 640.0, 140.0, 20.0, 120.0, 60.0, 150.0, 370.0, 30.0, 20.0, 120.0, 10.0, 190.0, 60.0, 80.0, 10.0, 160.0, 30.0, 0.0, 30.0, 80.0, 40.0, 550.0, 130.0, 530.0, 170.0, 210.0, 160.0, 230.0, 60.0, 130.0, 100.0, 60.0, 40.0, 400.0, 270.0, 60.0, 40.0, 300.0, 30.0, 50.0, 10.0, 30.0, 90.0, 100.0, 30.0, 50.0, 10.0, 40.0, 20.0, 160.0, 50.0, 90.0, 30.0, 190.0, 40.0, 100.0, 30.0, 110.0, 180.0, 40.0, 250.0, 0.0, 180.0, 50.0, 50.0, 610.0, 80.0, 50.0, 80.0, 50.0, 130.0, 180.0, 360.0, -40.0, 30.0, 230.0, 0.0, 20.0, 50.0, 380.0, 40.0, 170.0, 60.0, 30.0, 80.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.861242889850178, "mean_inference_ms": 1.9583005479329403, "mean_action_processing_ms": 0.5103401005405709, "mean_env_wait_ms": 1.6403734054992898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013002395629882812, "StateBufferConnector_ms": 0.01128840446472168, "ViewRequirementAgentConnector_ms": 0.4760096073150635}, "num_episodes": 18, "episode_return_max": 2390.0, "episode_return_min": 160.0, "episode_return_mean": 1101.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.567315910088539, "num_env_steps_trained_throughput_per_sec": 15.567315910088539, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 5880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5880000, "timers": {"training_iteration_time_ms": 635583.847, "restore_workers_time_ms": 0.014, "training_step_time_ms": 635583.794, "sample_time_ms": 2806.32, "learn_time_ms": 632753.211, "learn_throughput": 6.322, "synch_weights_time_ms": 12.424}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "done": false, "training_iteration": 147, "trial_id": "3d3a5_00000", "date": "2024-06-01_20-51-14", "timestamp": 1717289474, "time_this_iter_s": 256.9964487552643, "time_total_s": 80288.85575866699, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118afb550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80288.85575866699, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 46.24109589041096, "ram_util_percent": 82.93178082191781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3591529183557873, "cur_kl_coeff": 14.235876687306419, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.711796702262058, "policy_loss": -0.0021056392706168916, "vf_loss": 6.711299722517134, "vf_explained_var": 0.0009834566309302251, "kl": 0.0001828207673814708, "entropy": 0.22201111227020034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1385025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "env_runners": {"episode_reward_max": 2390.0, "episode_reward_min": 160.0, "episode_reward_mean": 1079.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 1060.0}, "policy_reward_mean": {"policy_0": 107.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [935.0, 905.0, 1560.0, 1610.0, 1590.0, 160.0, 1200.0, 900.0, 1060.0, 1140.0, 790.0, 1400.0, 1045.0, 1550.0, 1200.0, 900.0, 1630.0, 980.0, 180.0, 870.0, 795.0, 450.0, 1140.0, 870.0, 1540.0, 730.0, 1930.0, 1880.0, 1005.0, 410.0, 695.0, 1310.0, 1230.0, 1030.0, 330.0, 760.0, 1520.0, 460.0, 1000.0, 1450.0, 1210.0, 1580.0, 1040.0, 950.0, 1040.0, 810.0, 905.0, 1020.0, 1225.0, 735.0, 490.0, 1050.0, 1295.0, 1190.0, 845.0, 1335.0, 1395.0, 2390.0, 1400.0, 1390.0, 885.0, 580.0, 1470.0, 1350.0, 1150.0, 1300.0, 1310.0, 1100.0, 1260.0, 1320.0, 300.0, 810.0, 840.0, 1960.0, 1050.0, 1770.0, 1510.0, 730.0, 730.0, 1500.0, 1150.0, 840.0, 1490.0, 370.0, 925.0, 1070.0, 495.0, 660.0, 1420.0, 1080.0, 1170.0, 1690.0, 750.0, 1440.0, 620.0, 1230.0, 500.0, 490.0, 1100.0, 1065.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 10.0, 210.0, 200.0, 220.0, 115.0, 60.0, 10.0, 80.0, 150.0, 220.0, -25.0, 90.0, 180.0, 30.0, 90.0, 150.0, -50.0, 70.0, 160.0, 360.0, 40.0, 340.0, 40.0, 60.0, 210.0, 280.0, -20.0, 90.0, 80.0, 30.0, 850.0, 50.0, 130.0, 50.0, 20.0, 70.0, 50.0, 280.0, 730.0, 50.0, 110.0, 260.0, 10.0, -40.0, 10.0, 270.0, 140.0, 50.0, 0.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 360.0, 40.0, 300.0, 80.0, 180.0, 120.0, 20.0, 40.0, 30.0, 200.0, -30.0, 30.0, 50.0, 190.0, 0.0, 350.0, 10.0, 0.0, 100.0, 170.0, 120.0, 50.0, -20.0, -20.0, 270.0, 430.0, -40.0, 90.0, 10.0, 130.0, 330.0, 80.0, 50.0, 110.0, 110.0, 130.0, 110.0, 20.0, 70.0, 80.0, 30.0, 100.0, 80.0, 60.0, 250.0, 80.0, 0.0, 0.0, 110.0, 190.0, 60.0, 150.0, 300.0, -10.0, 390.0, 90.0, -40.0, 230.0, 40.0, 30.0, 80.0, 160.0, 330.0, 100.0, 20.0, 70.0, 180.0, 45.0, 30.0, 20.0, -20.0, 300.0, 20.0, 20.0, 60.0, 20.0, 540.0, 130.0, 460.0, 20.0, 170.0, 390.0, -20.0, 20.0, 20.0, 0.0, 170.0, 410.0, 20.0, 40.0, 150.0, 60.0, 10.0, 220.0, 230.0, -30.0, 30.0, 110.0, 80.0, 390.0, 210.0, 220.0, 50.0, 30.0, 20.0, 190.0, 40.0, 170.0, 310.0, 90.0, 250.0, 10.0, 120.0, 80.0, 40.0, 170.0, 280.0, 70.0, -130.0, 50.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 60.0, 0.0, 10.0, 130.0, 40.0, 0.0, 60.0, 90.0, 160.0, 20.0, 300.0, 40.0, 30.0, 300.0, 180.0, 20.0, -15.0, 40.0, 60.0, 10.0, 140.0, 0.0, 60.0, 20.0, 20.0, 80.0, 20.0, 120.0, 110.0, 20.0, 20.0, 40.0, 0.0, 430.0, 60.0, 380.0, 0.0, 50.0, 100.0, 10.0, 20.0, 70.0, 20.0, 20.0, 450.0, 20.0, 40.0, 40.0, 0.0, 40.0, 240.0, 0.0, 20.0, 170.0, 340.0, 40.0, 40.0, 560.0, 40.0, 180.0, 20.0, 40.0, 110.0, 0.0, 80.0, 10.0, 160.0, 240.0, 40.0, 30.0, 140.0, 30.0, 0.0, 50.0, 280.0, 140.0, 490.0, 340.0, 10.0, 270.0, 240.0, 0.0, 110.0, 130.0, 90.0, 50.0, 260.0, 140.0, 120.0, 660.0, 220.0, 80.0, 130.0, 175.0, 70.0, 150.0, -260.0, 170.0, 230.0, 50.0, -40.0, 110.0, 350.0, 30.0, 0.0, 20.0, 10.0, 210.0, 10.0, 0.0, 70.0, 30.0, 30.0, 50.0, 50.0, 310.0, 50.0, 15.0, 30.0, 30.0, -120.0, 270.0, 10.0, 60.0, 410.0, 270.0, 80.0, 10.0, 190.0, 130.0, 70.0, 310.0, -220.0, 20.0, 20.0, 220.0, 10.0, 290.0, 90.0, 70.0, 30.0, 180.0, 300.0, 60.0, 80.0, 60.0, 20.0, 10.0, 220.0, 160.0, 110.0, 50.0, 260.0, 30.0, 0.0, 0.0, 0.0, 190.0, 60.0, 10.0, 0.0, 40.0, 0.0, 390.0, 0.0, 160.0, 30.0, -10.0, 30.0, 10.0, -30.0, 130.0, 50.0, 0.0, -100.0, 585.0, 510.0, 220.0, 15.0, 270.0, -40.0, 40.0, 20.0, 30.0, 60.0, 260.0, 50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 0.0, 140.0, 170.0, 50.0, 50.0, 0.0, 20.0, 70.0, 260.0, 200.0, 40.0, 60.0, 110.0, 40.0, 120.0, 170.0, 60.0, 310.0, 50.0, 160.0, 370.0, 490.0, 70.0, -30.0, 190.0, 10.0, 70.0, 40.0, 220.0, 120.0, 30.0, 40.0, 310.0, 160.0, 60.0, 20.0, 130.0, 40.0, 830.0, -40.0, 30.0, 350.0, 200.0, 120.0, 60.0, 20.0, 0.0, 70.0, 110.0, 60.0, 50.0, -10.0, 290.0, 40.0, 0.0, 30.0, 470.0, 20.0, 20.0, 80.0, 10.0, 50.0, 450.0, 170.0, 40.0, 10.0, 40.0, 60.0, 30.0, 170.0, 20.0, 50.0, 280.0, -10.0, 50.0, 130.0, 60.0, 40.0, 10.0, 40.0, 160.0, 110.0, 10.0, 200.0, 70.0, 10.0, -95.0, 540.0, 130.0, -110.0, 40.0, 80.0, 10.0, 140.0, 180.0, 100.0, 170.0, 20.0, 70.0, 70.0, 180.0, 520.0, 140.0, 170.0, 40.0, 10.0, 55.0, 40.0, 170.0, 60.0, 20.0, 40.0, 30.0, 20.0, 30.0, -15.0, 90.0, 30.0, 20.0, 100.0, 390.0, 90.0, 20.0, 50.0, 40.0, 70.0, 30.0, 0.0, 20.0, 0.0, 170.0, 70.0, 320.0, 10.0, 70.0, 30.0, -10.0, 330.0, 30.0, 200.0, 0.0, 20.0, 110.0, 25.0, 300.0, 60.0, 70.0, 280.0, 50.0, 350.0, 30.0, 80.0, 150.0, 60.0, 150.0, 170.0, 0.0, 500.0, 10.0, 0.0, 70.0, 40.0, 75.0, 10.0, 20.0, 20.0, 90.0, -20.0, 70.0, 60.0, 480.0, 590.0, 70.0, 20.0, 0.0, 20.0, 15.0, 70.0, 280.0, 200.0, 70.0, 210.0, 130.0, 370.0, 30.0, 330.0, 65.0, 30.0, 80.0, 130.0, 20.0, 70.0, 60.0, 630.0, 150.0, 140.0, 1060.0, 130.0, 30.0, 50.0, 70.0, 50.0, 140.0, 150.0, 260.0, 180.0, 50.0, -10.0, 530.0, 50.0, 0.0, 240.0, 240.0, 50.0, 50.0, 250.0, 60.0, 270.0, 60.0, 40.0, 130.0, 150.0, 20.0, 310.0, 90.0, 90.0, 40.0, 120.0, 50.0, -45.0, 60.0, 70.0, 0.0, 60.0, 30.0, 10.0, 70.0, 50.0, 10.0, 270.0, 10.0, 30.0, 45.0, 100.0, 370.0, 140.0, 0.0, 670.0, -135.0, 50.0, 200.0, 10.0, 30.0, 170.0, 220.0, 60.0, 70.0, 80.0, 620.0, 40.0, 50.0, 100.0, 10.0, 150.0, 10.0, 70.0, 110.0, 100.0, 390.0, 170.0, 40.0, 180.0, -20.0, 790.0, 40.0, 100.0, 40.0, 100.0, 20.0, 50.0, 0.0, 80.0, 30.0, 510.0, 60.0, 10.0, 440.0, 100.0, -10.0, 60.0, 30.0, 20.0, 620.0, 70.0, 70.0, 20.0, 10.0, 40.0, 30.0, 110.0, 110.0, 460.0, 10.0, 50.0, 30.0, 10.0, 90.0, 190.0, 10.0, 330.0, 80.0, 80.0, 30.0, 220.0, 0.0, 370.0, 300.0, 150.0, 40.0, 40.0, 90.0, 20.0, 20.0, 180.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 80.0, 20.0, 30.0, 30.0, 30.0, 20.0, 10.0, 250.0, 300.0, 40.0, 30.0, 140.0, 50.0, 10.0, 40.0, 30.0, 340.0, 40.0, 200.0, -40.0, 130.0, 450.0, 100.0, 150.0, 640.0, 140.0, 20.0, 120.0, 60.0, 150.0, 370.0, 30.0, 20.0, 120.0, 10.0, 190.0, 60.0, 80.0, 10.0, 160.0, 30.0, 0.0, 30.0, 80.0, 40.0, 550.0, 130.0, 530.0, 170.0, 210.0, 160.0, 230.0, 60.0, 130.0, 100.0, 60.0, 40.0, 400.0, 270.0, 60.0, 40.0, 300.0, 30.0, 50.0, 10.0, 30.0, 90.0, 100.0, 30.0, 50.0, 10.0, 40.0, 20.0, 160.0, 50.0, 90.0, 30.0, 190.0, 40.0, 100.0, 30.0, 110.0, 180.0, 40.0, 250.0, 0.0, 180.0, 50.0, 50.0, 610.0, 80.0, 50.0, 80.0, 50.0, 130.0, 180.0, 360.0, -40.0, 30.0, 230.0, 0.0, 20.0, 50.0, 380.0, 40.0, 170.0, 60.0, 30.0, 80.0, 10.0, 200.0, 260.0, 150.0, 160.0, 510.0, 30.0, -90.0, 180.0, 50.0, 40.0, 20.0, 50.0, 30.0, 40.0, -30.0, 20.0, 10.0, 20.0, 260.0, -50.0, 30.0, 320.0, 30.0, 30.0, 80.0, 80.0, 5.0, 320.0, 10.0, 20.0, 270.0, 10.0, 260.0, 30.0, 240.0, 10.0, 40.0, 80.0, 100.0, 30.0, 10.0, 460.0, 20.0, -90.0, 0.0, -75.0, 30.0, -70.0, 200.0, 10.0, 140.0, 120.0, -10.0, 30.0, 20.0, 0.0, 360.0, 0.0, 0.0, 0.0, -10.0, 160.0, 50.0, 60.0, 30.0, 520.0, 380.0, 80.0, 60.0, 90.0, 0.0, 60.0, 70.0, 110.0, 660.0, 10.0, 60.0, 60.0, 40.0, 10.0, 30.0, 580.0, 330.0, 130.0, -25.0, 170.0, 100.0, 40.0, -205.0, 20.0, 40.0, -20.0, 200.0, 50.0, 600.0, 150.0, 390.0, 50.0, 210.0, 20.0, 0.0, 20.0, 30.0, 10.0, 40.0, 50.0, 180.0, 50.0, 40.0, 330.0, 50.0, 530.0, 40.0, 300.0, 30.0, 80.0, 180.0, 80.0, 120.0, 30.0, -200.0, 160.0, 20.0, 60.0, 10.0, 0.0, 400.0, 100.0, -10.0, 80.0, 220.0, 70.0, 120.0, 60.0, 280.0, 20.0, 120.0, 300.0, 80.0, -40.0, 360.0, 30.0, 10.0, 30.0, 50.0, -40.0, 10.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 170.0, 20.0, 40.0, 40.0, 0.0, 60.0, 90.0, 80.0, 40.0, 350.0, 320.0, 70.0, 30.0, 170.0, 0.0, 20.0, 20.0, 40.0, -30.0, 20.0, 80.0, 50.0, 560.0, -50.0, 0.0, 5.0, 390.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8598939999155653, "mean_inference_ms": 1.9578625966273038, "mean_action_processing_ms": 0.5100761139215386, "mean_env_wait_ms": 1.6394778640595544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013295650482177734, "StateBufferConnector_ms": 0.011529207229614258, "ViewRequirementAgentConnector_ms": 0.4867684841156006}, "num_episodes": 18, "episode_return_max": 2390.0, "episode_return_min": 160.0, "episode_return_mean": 1079.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.817299847998957, "num_env_steps_trained_throughput_per_sec": 18.817299847998957, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 5920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5920000, "timers": {"training_iteration_time_ms": 617919.455, "restore_workers_time_ms": 0.014, "training_step_time_ms": 617919.399, "sample_time_ms": 2864.75, "learn_time_ms": 615029.2, "learn_throughput": 6.504, "synch_weights_time_ms": 13.233}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "done": false, "training_iteration": 148, "trial_id": "3d3a5_00000", "date": "2024-06-01_20-54-47", "timestamp": 1717289687, "time_this_iter_s": 212.62988686561584, "time_total_s": 80501.48564553261, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118023ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80501.48564553261, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 27.425082508250824, "ram_util_percent": 81.92904290429043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.439099920786227, "cur_kl_coeff": 7.1179383436532095, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003155940118383644, "vf_loss": 6.452007353724763, "vf_explained_var": 0.0003097070799594997, "kl": Infinity, "entropy": 0.22761406197874182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1394415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "env_runners": {"episode_reward_max": 2390.0, "episode_reward_min": 135.0, "episode_reward_mean": 1056.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 1060.0}, "policy_reward_mean": {"policy_0": 105.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [870.0, 1540.0, 730.0, 1930.0, 1880.0, 1005.0, 410.0, 695.0, 1310.0, 1230.0, 1030.0, 330.0, 760.0, 1520.0, 460.0, 1000.0, 1450.0, 1210.0, 1580.0, 1040.0, 950.0, 1040.0, 810.0, 905.0, 1020.0, 1225.0, 735.0, 490.0, 1050.0, 1295.0, 1190.0, 845.0, 1335.0, 1395.0, 2390.0, 1400.0, 1390.0, 885.0, 580.0, 1470.0, 1350.0, 1150.0, 1300.0, 1310.0, 1100.0, 1260.0, 1320.0, 300.0, 810.0, 840.0, 1960.0, 1050.0, 1770.0, 1510.0, 730.0, 730.0, 1500.0, 1150.0, 840.0, 1490.0, 370.0, 925.0, 1070.0, 495.0, 660.0, 1420.0, 1080.0, 1170.0, 1690.0, 750.0, 1440.0, 620.0, 1230.0, 500.0, 490.0, 1100.0, 1065.0, 190.0, 695.0, 875.0, 1120.0, 1510.0, 135.0, 840.0, 1350.0, 1150.0, 860.0, 1500.0, 1330.0, 930.0, 1550.0, 1175.0, 480.0, 790.0, 1470.0, 525.0, 950.0, 1340.0, 550.0, 425.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 450.0, 20.0, 40.0, 40.0, 0.0, 40.0, 240.0, 0.0, 20.0, 170.0, 340.0, 40.0, 40.0, 560.0, 40.0, 180.0, 20.0, 40.0, 110.0, 0.0, 80.0, 10.0, 160.0, 240.0, 40.0, 30.0, 140.0, 30.0, 0.0, 50.0, 280.0, 140.0, 490.0, 340.0, 10.0, 270.0, 240.0, 0.0, 110.0, 130.0, 90.0, 50.0, 260.0, 140.0, 120.0, 660.0, 220.0, 80.0, 130.0, 175.0, 70.0, 150.0, -260.0, 170.0, 230.0, 50.0, -40.0, 110.0, 350.0, 30.0, 0.0, 20.0, 10.0, 210.0, 10.0, 0.0, 70.0, 30.0, 30.0, 50.0, 50.0, 310.0, 50.0, 15.0, 30.0, 30.0, -120.0, 270.0, 10.0, 60.0, 410.0, 270.0, 80.0, 10.0, 190.0, 130.0, 70.0, 310.0, -220.0, 20.0, 20.0, 220.0, 10.0, 290.0, 90.0, 70.0, 30.0, 180.0, 300.0, 60.0, 80.0, 60.0, 20.0, 10.0, 220.0, 160.0, 110.0, 50.0, 260.0, 30.0, 0.0, 0.0, 0.0, 190.0, 60.0, 10.0, 0.0, 40.0, 0.0, 390.0, 0.0, 160.0, 30.0, -10.0, 30.0, 10.0, -30.0, 130.0, 50.0, 0.0, -100.0, 585.0, 510.0, 220.0, 15.0, 270.0, -40.0, 40.0, 20.0, 30.0, 60.0, 260.0, 50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 0.0, 140.0, 170.0, 50.0, 50.0, 0.0, 20.0, 70.0, 260.0, 200.0, 40.0, 60.0, 110.0, 40.0, 120.0, 170.0, 60.0, 310.0, 50.0, 160.0, 370.0, 490.0, 70.0, -30.0, 190.0, 10.0, 70.0, 40.0, 220.0, 120.0, 30.0, 40.0, 310.0, 160.0, 60.0, 20.0, 130.0, 40.0, 830.0, -40.0, 30.0, 350.0, 200.0, 120.0, 60.0, 20.0, 0.0, 70.0, 110.0, 60.0, 50.0, -10.0, 290.0, 40.0, 0.0, 30.0, 470.0, 20.0, 20.0, 80.0, 10.0, 50.0, 450.0, 170.0, 40.0, 10.0, 40.0, 60.0, 30.0, 170.0, 20.0, 50.0, 280.0, -10.0, 50.0, 130.0, 60.0, 40.0, 10.0, 40.0, 160.0, 110.0, 10.0, 200.0, 70.0, 10.0, -95.0, 540.0, 130.0, -110.0, 40.0, 80.0, 10.0, 140.0, 180.0, 100.0, 170.0, 20.0, 70.0, 70.0, 180.0, 520.0, 140.0, 170.0, 40.0, 10.0, 55.0, 40.0, 170.0, 60.0, 20.0, 40.0, 30.0, 20.0, 30.0, -15.0, 90.0, 30.0, 20.0, 100.0, 390.0, 90.0, 20.0, 50.0, 40.0, 70.0, 30.0, 0.0, 20.0, 0.0, 170.0, 70.0, 320.0, 10.0, 70.0, 30.0, -10.0, 330.0, 30.0, 200.0, 0.0, 20.0, 110.0, 25.0, 300.0, 60.0, 70.0, 280.0, 50.0, 350.0, 30.0, 80.0, 150.0, 60.0, 150.0, 170.0, 0.0, 500.0, 10.0, 0.0, 70.0, 40.0, 75.0, 10.0, 20.0, 20.0, 90.0, -20.0, 70.0, 60.0, 480.0, 590.0, 70.0, 20.0, 0.0, 20.0, 15.0, 70.0, 280.0, 200.0, 70.0, 210.0, 130.0, 370.0, 30.0, 330.0, 65.0, 30.0, 80.0, 130.0, 20.0, 70.0, 60.0, 630.0, 150.0, 140.0, 1060.0, 130.0, 30.0, 50.0, 70.0, 50.0, 140.0, 150.0, 260.0, 180.0, 50.0, -10.0, 530.0, 50.0, 0.0, 240.0, 240.0, 50.0, 50.0, 250.0, 60.0, 270.0, 60.0, 40.0, 130.0, 150.0, 20.0, 310.0, 90.0, 90.0, 40.0, 120.0, 50.0, -45.0, 60.0, 70.0, 0.0, 60.0, 30.0, 10.0, 70.0, 50.0, 10.0, 270.0, 10.0, 30.0, 45.0, 100.0, 370.0, 140.0, 0.0, 670.0, -135.0, 50.0, 200.0, 10.0, 30.0, 170.0, 220.0, 60.0, 70.0, 80.0, 620.0, 40.0, 50.0, 100.0, 10.0, 150.0, 10.0, 70.0, 110.0, 100.0, 390.0, 170.0, 40.0, 180.0, -20.0, 790.0, 40.0, 100.0, 40.0, 100.0, 20.0, 50.0, 0.0, 80.0, 30.0, 510.0, 60.0, 10.0, 440.0, 100.0, -10.0, 60.0, 30.0, 20.0, 620.0, 70.0, 70.0, 20.0, 10.0, 40.0, 30.0, 110.0, 110.0, 460.0, 10.0, 50.0, 30.0, 10.0, 90.0, 190.0, 10.0, 330.0, 80.0, 80.0, 30.0, 220.0, 0.0, 370.0, 300.0, 150.0, 40.0, 40.0, 90.0, 20.0, 20.0, 180.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 80.0, 20.0, 30.0, 30.0, 30.0, 20.0, 10.0, 250.0, 300.0, 40.0, 30.0, 140.0, 50.0, 10.0, 40.0, 30.0, 340.0, 40.0, 200.0, -40.0, 130.0, 450.0, 100.0, 150.0, 640.0, 140.0, 20.0, 120.0, 60.0, 150.0, 370.0, 30.0, 20.0, 120.0, 10.0, 190.0, 60.0, 80.0, 10.0, 160.0, 30.0, 0.0, 30.0, 80.0, 40.0, 550.0, 130.0, 530.0, 170.0, 210.0, 160.0, 230.0, 60.0, 130.0, 100.0, 60.0, 40.0, 400.0, 270.0, 60.0, 40.0, 300.0, 30.0, 50.0, 10.0, 30.0, 90.0, 100.0, 30.0, 50.0, 10.0, 40.0, 20.0, 160.0, 50.0, 90.0, 30.0, 190.0, 40.0, 100.0, 30.0, 110.0, 180.0, 40.0, 250.0, 0.0, 180.0, 50.0, 50.0, 610.0, 80.0, 50.0, 80.0, 50.0, 130.0, 180.0, 360.0, -40.0, 30.0, 230.0, 0.0, 20.0, 50.0, 380.0, 40.0, 170.0, 60.0, 30.0, 80.0, 10.0, 200.0, 260.0, 150.0, 160.0, 510.0, 30.0, -90.0, 180.0, 50.0, 40.0, 20.0, 50.0, 30.0, 40.0, -30.0, 20.0, 10.0, 20.0, 260.0, -50.0, 30.0, 320.0, 30.0, 30.0, 80.0, 80.0, 5.0, 320.0, 10.0, 20.0, 270.0, 10.0, 260.0, 30.0, 240.0, 10.0, 40.0, 80.0, 100.0, 30.0, 10.0, 460.0, 20.0, -90.0, 0.0, -75.0, 30.0, -70.0, 200.0, 10.0, 140.0, 120.0, -10.0, 30.0, 20.0, 0.0, 360.0, 0.0, 0.0, 0.0, -10.0, 160.0, 50.0, 60.0, 30.0, 520.0, 380.0, 80.0, 60.0, 90.0, 0.0, 60.0, 70.0, 110.0, 660.0, 10.0, 60.0, 60.0, 40.0, 10.0, 30.0, 580.0, 330.0, 130.0, -25.0, 170.0, 100.0, 40.0, -205.0, 20.0, 40.0, -20.0, 200.0, 50.0, 600.0, 150.0, 390.0, 50.0, 210.0, 20.0, 0.0, 20.0, 30.0, 10.0, 40.0, 50.0, 180.0, 50.0, 40.0, 330.0, 50.0, 530.0, 40.0, 300.0, 30.0, 80.0, 180.0, 80.0, 120.0, 30.0, -200.0, 160.0, 20.0, 60.0, 10.0, 0.0, 400.0, 100.0, -10.0, 80.0, 220.0, 70.0, 120.0, 60.0, 280.0, 20.0, 120.0, 300.0, 80.0, -40.0, 360.0, 30.0, 10.0, 30.0, 50.0, -40.0, 10.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 170.0, 20.0, 40.0, 40.0, 0.0, 60.0, 90.0, 80.0, 40.0, 350.0, 320.0, 70.0, 30.0, 170.0, 0.0, 20.0, 20.0, 40.0, -30.0, 20.0, 80.0, 50.0, 560.0, -50.0, 0.0, 5.0, 390.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 20.0, 40.0, 40.0, 10.0, 0.0, 10.0, 350.0, 0.0, 70.0, 30.0, 150.0, 0.0, 60.0, 25.0, 0.0, 40.0, 170.0, 190.0, 30.0, 60.0, 280.0, 5.0, 100.0, 0.0, -40.0, 490.0, 30.0, 90.0, 20.0, 80.0, 0.0, 100.0, 150.0, 200.0, 90.0, 210.0, 90.0, 50.0, 220.0, 40.0, 390.0, 130.0, 260.0, 30.0, -5.0, 40.0, 0.0, 20.0, 0.0, 0.0, 20.0, 40.0, 10.0, 10.0, 410.0, 10.0, 30.0, 70.0, 10.0, 190.0, 20.0, 80.0, 10.0, 10.0, 360.0, 240.0, 70.0, 150.0, 110.0, 160.0, 30.0, 100.0, 30.0, 100.0, 50.0, 90.0, 40.0, 360.0, 30.0, 40.0, 30.0, 80.0, 280.0, 150.0, 40.0, 30.0, 410.0, 160.0, 10.0, 70.0, 30.0, 0.0, 30.0, 80.0, 80.0, -90.0, 110.0, 380.0, 530.0, 110.0, 80.0, 80.0, 40.0, 180.0, 20.0, 150.0, 0.0, 90.0, 350.0, 270.0, -20.0, 330.0, 60.0, 80.0, 70.0, 200.0, -80.0, 90.0, 0.0, 90.0, 30.0, 240.0, 210.0, 80.0, 60.0, 590.0, 70.0, 60.0, 130.0, 20.0, 10.0, 140.0, 290.0, 180.0, 70.0, 70.0, 205.0, 190.0, 50.0, 210.0, 180.0, 80.0, 40.0, 80.0, 20.0, -50.0, 770.0, 20.0, -30.0, -30.0, 0.0, 0.0, 10.0, -230.0, 100.0, 20.0, 10.0, -20.0, 210.0, 30.0, 330.0, 60.0, 30.0, 20.0, 210.0, 520.0, 80.0, 40.0, 130.0, 80.0, 110.0, 90.0, 190.0, 20.0, 40.0, -40.0, 40.0, 0.0, 420.0, 0.0, 20.0, 10.0, 30.0, 5.0, 0.0, 0.0, 130.0, 390.0, 20.0, 120.0, 40.0, 140.0, 100.0, 10.0, 30.0, 100.0, 340.0, 290.0, 120.0, 100.0, 60.0, 20.0, 90.0, 190.0, 150.0, 100.0, 110.0, 0.0, 20.0, 10.0, 20.0, 30.0, 70.0, 40.0, 90.0, 20.0, 60.0, 0.0, 60.0, 20.0, 70.0, 80.0, 10.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8586685432738594, "mean_inference_ms": 1.9579368419479692, "mean_action_processing_ms": 0.509942938365297, "mean_env_wait_ms": 1.6390040962172716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013552188873291016, "StateBufferConnector_ms": 0.01250004768371582, "ViewRequirementAgentConnector_ms": 0.49845266342163086}, "num_episodes": 23, "episode_return_max": 2390.0, "episode_return_min": 135.0, "episode_return_mean": 1056.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 16.770668512993836, "num_env_steps_trained_throughput_per_sec": 16.770668512993836, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 5960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5960000, "timers": {"training_iteration_time_ms": 588752.117, "restore_workers_time_ms": 0.014, "training_step_time_ms": 588752.061, "sample_time_ms": 2926.464, "learn_time_ms": 585798.356, "learn_throughput": 6.828, "synch_weights_time_ms": 14.492}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "done": false, "training_iteration": 149, "trial_id": "3d3a5_00000", "date": "2024-06-01_20-58-46", "timestamp": 1717289926, "time_this_iter_s": 238.6566219329834, "time_total_s": 80740.14226746559, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x118a56940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80740.14226746559, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 37.27278106508876, "ram_util_percent": 82.41804733727811}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.600809643713557, "cur_kl_coeff": 10.676907515479815, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.567726487473558, "policy_loss": -0.0021756300808568273, "vf_loss": 6.567495694886635, "vf_explained_var": 0.0006551965547445863, "kl": 0.00022538472703331126, "entropy": 0.2031939566127472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1403805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "env_runners": {"episode_reward_max": 2390.0, "episode_reward_min": 135.0, "episode_reward_mean": 1056.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1060.0}, "policy_reward_mean": {"policy_0": 105.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [810.0, 905.0, 1020.0, 1225.0, 735.0, 490.0, 1050.0, 1295.0, 1190.0, 845.0, 1335.0, 1395.0, 2390.0, 1400.0, 1390.0, 885.0, 580.0, 1470.0, 1350.0, 1150.0, 1300.0, 1310.0, 1100.0, 1260.0, 1320.0, 300.0, 810.0, 840.0, 1960.0, 1050.0, 1770.0, 1510.0, 730.0, 730.0, 1500.0, 1150.0, 840.0, 1490.0, 370.0, 925.0, 1070.0, 495.0, 660.0, 1420.0, 1080.0, 1170.0, 1690.0, 750.0, 1440.0, 620.0, 1230.0, 500.0, 490.0, 1100.0, 1065.0, 190.0, 695.0, 875.0, 1120.0, 1510.0, 135.0, 840.0, 1350.0, 1150.0, 860.0, 1500.0, 1330.0, 930.0, 1550.0, 1175.0, 480.0, 790.0, 1470.0, 525.0, 950.0, 1340.0, 550.0, 425.0, 1115.0, 1190.0, 870.0, 1580.0, 850.0, 270.0, 1950.0, 1675.0, 930.0, 1130.0, 1370.0, 1100.0, 1225.0, 590.0, 730.0, 1260.0, 1330.0, 890.0, 550.0, 1330.0, 990.0, 1070.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 280.0, -10.0, 50.0, 130.0, 60.0, 40.0, 10.0, 40.0, 160.0, 110.0, 10.0, 200.0, 70.0, 10.0, -95.0, 540.0, 130.0, -110.0, 40.0, 80.0, 10.0, 140.0, 180.0, 100.0, 170.0, 20.0, 70.0, 70.0, 180.0, 520.0, 140.0, 170.0, 40.0, 10.0, 55.0, 40.0, 170.0, 60.0, 20.0, 40.0, 30.0, 20.0, 30.0, -15.0, 90.0, 30.0, 20.0, 100.0, 390.0, 90.0, 20.0, 50.0, 40.0, 70.0, 30.0, 0.0, 20.0, 0.0, 170.0, 70.0, 320.0, 10.0, 70.0, 30.0, -10.0, 330.0, 30.0, 200.0, 0.0, 20.0, 110.0, 25.0, 300.0, 60.0, 70.0, 280.0, 50.0, 350.0, 30.0, 80.0, 150.0, 60.0, 150.0, 170.0, 0.0, 500.0, 10.0, 0.0, 70.0, 40.0, 75.0, 10.0, 20.0, 20.0, 90.0, -20.0, 70.0, 60.0, 480.0, 590.0, 70.0, 20.0, 0.0, 20.0, 15.0, 70.0, 280.0, 200.0, 70.0, 210.0, 130.0, 370.0, 30.0, 330.0, 65.0, 30.0, 80.0, 130.0, 20.0, 70.0, 60.0, 630.0, 150.0, 140.0, 1060.0, 130.0, 30.0, 50.0, 70.0, 50.0, 140.0, 150.0, 260.0, 180.0, 50.0, -10.0, 530.0, 50.0, 0.0, 240.0, 240.0, 50.0, 50.0, 250.0, 60.0, 270.0, 60.0, 40.0, 130.0, 150.0, 20.0, 310.0, 90.0, 90.0, 40.0, 120.0, 50.0, -45.0, 60.0, 70.0, 0.0, 60.0, 30.0, 10.0, 70.0, 50.0, 10.0, 270.0, 10.0, 30.0, 45.0, 100.0, 370.0, 140.0, 0.0, 670.0, -135.0, 50.0, 200.0, 10.0, 30.0, 170.0, 220.0, 60.0, 70.0, 80.0, 620.0, 40.0, 50.0, 100.0, 10.0, 150.0, 10.0, 70.0, 110.0, 100.0, 390.0, 170.0, 40.0, 180.0, -20.0, 790.0, 40.0, 100.0, 40.0, 100.0, 20.0, 50.0, 0.0, 80.0, 30.0, 510.0, 60.0, 10.0, 440.0, 100.0, -10.0, 60.0, 30.0, 20.0, 620.0, 70.0, 70.0, 20.0, 10.0, 40.0, 30.0, 110.0, 110.0, 460.0, 10.0, 50.0, 30.0, 10.0, 90.0, 190.0, 10.0, 330.0, 80.0, 80.0, 30.0, 220.0, 0.0, 370.0, 300.0, 150.0, 40.0, 40.0, 90.0, 20.0, 20.0, 180.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 80.0, 20.0, 30.0, 30.0, 30.0, 20.0, 10.0, 250.0, 300.0, 40.0, 30.0, 140.0, 50.0, 10.0, 40.0, 30.0, 340.0, 40.0, 200.0, -40.0, 130.0, 450.0, 100.0, 150.0, 640.0, 140.0, 20.0, 120.0, 60.0, 150.0, 370.0, 30.0, 20.0, 120.0, 10.0, 190.0, 60.0, 80.0, 10.0, 160.0, 30.0, 0.0, 30.0, 80.0, 40.0, 550.0, 130.0, 530.0, 170.0, 210.0, 160.0, 230.0, 60.0, 130.0, 100.0, 60.0, 40.0, 400.0, 270.0, 60.0, 40.0, 300.0, 30.0, 50.0, 10.0, 30.0, 90.0, 100.0, 30.0, 50.0, 10.0, 40.0, 20.0, 160.0, 50.0, 90.0, 30.0, 190.0, 40.0, 100.0, 30.0, 110.0, 180.0, 40.0, 250.0, 0.0, 180.0, 50.0, 50.0, 610.0, 80.0, 50.0, 80.0, 50.0, 130.0, 180.0, 360.0, -40.0, 30.0, 230.0, 0.0, 20.0, 50.0, 380.0, 40.0, 170.0, 60.0, 30.0, 80.0, 10.0, 200.0, 260.0, 150.0, 160.0, 510.0, 30.0, -90.0, 180.0, 50.0, 40.0, 20.0, 50.0, 30.0, 40.0, -30.0, 20.0, 10.0, 20.0, 260.0, -50.0, 30.0, 320.0, 30.0, 30.0, 80.0, 80.0, 5.0, 320.0, 10.0, 20.0, 270.0, 10.0, 260.0, 30.0, 240.0, 10.0, 40.0, 80.0, 100.0, 30.0, 10.0, 460.0, 20.0, -90.0, 0.0, -75.0, 30.0, -70.0, 200.0, 10.0, 140.0, 120.0, -10.0, 30.0, 20.0, 0.0, 360.0, 0.0, 0.0, 0.0, -10.0, 160.0, 50.0, 60.0, 30.0, 520.0, 380.0, 80.0, 60.0, 90.0, 0.0, 60.0, 70.0, 110.0, 660.0, 10.0, 60.0, 60.0, 40.0, 10.0, 30.0, 580.0, 330.0, 130.0, -25.0, 170.0, 100.0, 40.0, -205.0, 20.0, 40.0, -20.0, 200.0, 50.0, 600.0, 150.0, 390.0, 50.0, 210.0, 20.0, 0.0, 20.0, 30.0, 10.0, 40.0, 50.0, 180.0, 50.0, 40.0, 330.0, 50.0, 530.0, 40.0, 300.0, 30.0, 80.0, 180.0, 80.0, 120.0, 30.0, -200.0, 160.0, 20.0, 60.0, 10.0, 0.0, 400.0, 100.0, -10.0, 80.0, 220.0, 70.0, 120.0, 60.0, 280.0, 20.0, 120.0, 300.0, 80.0, -40.0, 360.0, 30.0, 10.0, 30.0, 50.0, -40.0, 10.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 170.0, 20.0, 40.0, 40.0, 0.0, 60.0, 90.0, 80.0, 40.0, 350.0, 320.0, 70.0, 30.0, 170.0, 0.0, 20.0, 20.0, 40.0, -30.0, 20.0, 80.0, 50.0, 560.0, -50.0, 0.0, 5.0, 390.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 20.0, 40.0, 40.0, 10.0, 0.0, 10.0, 350.0, 0.0, 70.0, 30.0, 150.0, 0.0, 60.0, 25.0, 0.0, 40.0, 170.0, 190.0, 30.0, 60.0, 280.0, 5.0, 100.0, 0.0, -40.0, 490.0, 30.0, 90.0, 20.0, 80.0, 0.0, 100.0, 150.0, 200.0, 90.0, 210.0, 90.0, 50.0, 220.0, 40.0, 390.0, 130.0, 260.0, 30.0, -5.0, 40.0, 0.0, 20.0, 0.0, 0.0, 20.0, 40.0, 10.0, 10.0, 410.0, 10.0, 30.0, 70.0, 10.0, 190.0, 20.0, 80.0, 10.0, 10.0, 360.0, 240.0, 70.0, 150.0, 110.0, 160.0, 30.0, 100.0, 30.0, 100.0, 50.0, 90.0, 40.0, 360.0, 30.0, 40.0, 30.0, 80.0, 280.0, 150.0, 40.0, 30.0, 410.0, 160.0, 10.0, 70.0, 30.0, 0.0, 30.0, 80.0, 80.0, -90.0, 110.0, 380.0, 530.0, 110.0, 80.0, 80.0, 40.0, 180.0, 20.0, 150.0, 0.0, 90.0, 350.0, 270.0, -20.0, 330.0, 60.0, 80.0, 70.0, 200.0, -80.0, 90.0, 0.0, 90.0, 30.0, 240.0, 210.0, 80.0, 60.0, 590.0, 70.0, 60.0, 130.0, 20.0, 10.0, 140.0, 290.0, 180.0, 70.0, 70.0, 205.0, 190.0, 50.0, 210.0, 180.0, 80.0, 40.0, 80.0, 20.0, -50.0, 770.0, 20.0, -30.0, -30.0, 0.0, 0.0, 10.0, -230.0, 100.0, 20.0, 10.0, -20.0, 210.0, 30.0, 330.0, 60.0, 30.0, 20.0, 210.0, 520.0, 80.0, 40.0, 130.0, 80.0, 110.0, 90.0, 190.0, 20.0, 40.0, -40.0, 40.0, 0.0, 420.0, 0.0, 20.0, 10.0, 30.0, 5.0, 0.0, 0.0, 130.0, 390.0, 20.0, 120.0, 40.0, 140.0, 100.0, 10.0, 30.0, 100.0, 340.0, 290.0, 120.0, 100.0, 60.0, 20.0, 90.0, 190.0, 150.0, 100.0, 110.0, 0.0, 20.0, 10.0, 20.0, 30.0, 70.0, 40.0, 90.0, 20.0, 60.0, 0.0, 60.0, 20.0, 70.0, 80.0, 10.0, 15.0, 20.0, 90.0, 350.0, 60.0, 100.0, 90.0, -40.0, 155.0, 270.0, 20.0, 20.0, 20.0, 50.0, 800.0, 10.0, 40.0, 0.0, 20.0, 0.0, 230.0, 30.0, 10.0, 350.0, 120.0, 0.0, 40.0, -40.0, 370.0, 10.0, -20.0, 160.0, -10.0, 80.0, 140.0, 30.0, 560.0, 90.0, 30.0, 440.0, 60.0, 30.0, 310.0, 0.0, 30.0, 40.0, 10.0, 100.0, 80.0, 210.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 90.0, 10.0, 50.0, 30.0, 520.0, 320.0, 180.0, 40.0, 210.0, 50.0, 470.0, 30.0, 100.0, -35.0, 60.0, 100.0, 460.0, 50.0, 400.0, 0.0, 180.0, 180.0, 280.0, 30.0, 130.0, 390.0, 190.0, 0.0, 70.0, 10.0, 0.0, 0.0, 110.0, 160.0, -40.0, -50.0, 100.0, 40.0, 40.0, 460.0, 80.0, 290.0, 50.0, 20.0, 440.0, 200.0, 100.0, 30.0, 130.0, 160.0, 110.0, 120.0, 60.0, 190.0, 10.0, 50.0, 10.0, 100.0, 110.0, 90.0, 40.0, 100.0, 400.0, 30.0, 300.0, 40.0, 70.0, 190.0, 130.0, 80.0, 60.0, 150.0, 175.0, 0.0, 50.0, 40.0, 20.0, 320.0, 40.0, 0.0, 40.0, 10.0, 70.0, 20.0, 10.0, 290.0, 10.0, 10.0, 180.0, 10.0, 20.0, 180.0, 0.0, 70.0, 300.0, 10.0, 160.0, 260.0, 140.0, 10.0, 0.0, 130.0, 180.0, 150.0, 30.0, 370.0, 210.0, -80.0, 140.0, 60.0, 120.0, 260.0, 70.0, 30.0, 40.0, 20.0, 40.0, 70.0, 60.0, 40.0, 270.0, 290.0, 30.0, 80.0, 80.0, 30.0, 70.0, 120.0, 70.0, 20.0, 70.0, 60.0, -50.0, 40.0, 60.0, 50.0, 50.0, 360.0, 40.0, 380.0, 300.0, 10.0, 40.0, 50.0, 10.0, 230.0, 90.0, 300.0, 10.0, 200.0, 30.0, 40.0, 30.0, 50.0, 240.0, 70.0, 0.0, 90.0, 350.0, 40.0, 120.0, 90.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8627320884083505, "mean_inference_ms": 1.96460517262244, "mean_action_processing_ms": 0.5113410262697198, "mean_env_wait_ms": 1.6429939543698098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019318580627441406, "StateBufferConnector_ms": 0.014381170272827148, "ViewRequirementAgentConnector_ms": 0.60555100440979}, "num_episodes": 22, "episode_return_max": 2390.0, "episode_return_min": 135.0, "episode_return_mean": 1056.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 16.924488737570105, "num_env_steps_trained_throughput_per_sec": 16.924488737570105, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 6000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000000, "timers": {"training_iteration_time_ms": 554491.32, "restore_workers_time_ms": 0.015, "training_step_time_ms": 554491.262, "sample_time_ms": 3632.324, "learn_time_ms": 550831.112, "learn_throughput": 7.262, "synch_weights_time_ms": 14.544}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "done": true, "training_iteration": 150, "trial_id": "3d3a5_00000", "date": "2024-06-01_21-02-42", "timestamp": 1717290162, "time_this_iter_s": 236.38249588012695, "time_total_s": 80976.52476334572, "pid": 63938, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x11802f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80976.52476334572, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 40.58537313432836, "ram_util_percent": 82.90507462686567}}
