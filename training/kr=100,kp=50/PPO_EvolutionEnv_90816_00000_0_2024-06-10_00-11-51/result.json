{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6395606670723047, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.122576054368918, "policy_loss": -0.014488519020616627, "vf_loss": 3.1344778290444926, "vf_explained_var": 0.0008353416277323795, "kl": 0.012933736512551567, "entropy": 1.580502732709066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 4695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -40.0, "episode_reward_min": -885.0, "episode_reward_mean": -424.44444444444446, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3618, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -42.44444444444444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.0, -255.0, -215.0, -500.0, -125.0, -465.0, -605.0, -610.0, -385.0, -885.0, -40.0, -305.0, -515.0, -430.0, -355.0, -270.0, -455.0, -485.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-250.0, 0.0, 20.0, -100.0, -135.0, 15.0, 10.0, -300.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, -230.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, -10.0, -330.0, -210.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -280.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -205.0, 0.0, 0.0, 0.0, -285.0, 0.0, -60.0, 0.0, 10.0, 0.0, 0.0, -270.0, 0.0, 10.0, 0.0, -290.0, 10.0, 0.0, 0.0, 30.0, 0.0, -370.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, -240.0, 30.0, 10.0, -215.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, -355.0, -195.0, -115.0, 10.0, 0.0, 30.0, 10.0, 0.0, -70.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, -85.0, -20.0, 0.0, -260.0, 0.0, -35.0, -215.0, -185.0, 0.0, -90.0, 0.0, 0.0, 10.0, 0.0, 0.0, -280.0, -5.0, 0.0, 0.0, 0.0, -165.0, 20.0, 0.0, 0.0, 0.0, 0.0, -235.0, 10.0, 0.0, 0.0, 0.0, 0.0, -130.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -135.0, -45.0, -140.0, 20.0, 10.0, -325.0, -160.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -290.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, -245.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9715060828587307, "mean_inference_ms": 1.4376969580736474, "mean_action_processing_ms": 0.4842542887493487, "mean_env_wait_ms": 1.5502081058682637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012425581614176432, "StateBufferConnector_ms": 0.009247991773817275, "ViewRequirementAgentConnector_ms": 0.45239925384521484}, "num_episodes": 18, "episode_return_max": -40.0, "episode_return_min": -885.0, "episode_return_mean": -424.44444444444446}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 16.531569702715732, "num_env_steps_trained_throughput_per_sec": 16.531569702715732, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 241961.302, "restore_workers_time_ms": 0.017, "training_step_time_ms": 241961.217, "sample_time_ms": 3413.187, "learn_time_ms": 238509.211, "learn_throughput": 16.771, "synch_weights_time_ms": 15.431}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "90816_00000", "date": "2024-06-10_00-16-02", "timestamp": 1717992962, "time_this_iter_s": 242.00729489326477, "time_total_s": 242.00729489326477, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f561f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 242.00729489326477, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.63381924198251, "ram_util_percent": 82.57551020408164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1696113687893326, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2014232789841703, "policy_loss": -0.011127753184597019, "vf_loss": 1.2113334651762686, "vf_explained_var": 0.009430187140790799, "kl": 0.006087827839772667, "entropy": 1.5740014176780042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 14085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 90.0, "episode_reward_min": -885.0, "episode_reward_mean": -230.27777777777777, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7236, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -23.02777777777778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.0, -255.0, -215.0, -500.0, -125.0, -465.0, -605.0, -610.0, -385.0, -885.0, -40.0, -305.0, -515.0, -430.0, -355.0, -270.0, -455.0, -485.0, -130.0, 70.0, -135.0, 20.0, -50.0, 35.0, -290.0, 10.0, 70.0, 40.0, -20.0, -65.0, -85.0, -45.0, -160.0, 10.0, 90.0, -15.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-250.0, 0.0, 20.0, -100.0, -135.0, 15.0, 10.0, -300.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, -230.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, -10.0, -330.0, -210.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -280.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -205.0, 0.0, 0.0, 0.0, -285.0, 0.0, -60.0, 0.0, 10.0, 0.0, 0.0, -270.0, 0.0, 10.0, 0.0, -290.0, 10.0, 0.0, 0.0, 30.0, 0.0, -370.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, -240.0, 30.0, 10.0, -215.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, -355.0, -195.0, -115.0, 10.0, 0.0, 30.0, 10.0, 0.0, -70.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, -85.0, -20.0, 0.0, -260.0, 0.0, -35.0, -215.0, -185.0, 0.0, -90.0, 0.0, 0.0, 10.0, 0.0, 0.0, -280.0, -5.0, 0.0, 0.0, 0.0, -165.0, 20.0, 0.0, 0.0, 0.0, 0.0, -235.0, 10.0, 0.0, 0.0, 0.0, 0.0, -130.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -135.0, -45.0, -140.0, 20.0, 10.0, -325.0, -160.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -290.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, -245.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 0.0, -55.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, -35.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -60.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, -155.0, 0.0, 0.0, 20.0, 0.0, 0.0, -30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -45.0, 10.0, 10.0, -95.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 20.0, 0.0, 0.0, 0.0, -135.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -85.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, -85.0, 10.0, 0.0, 20.0, 0.0, -125.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, -25.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0955874454750405, "mean_inference_ms": 1.5866871055177234, "mean_action_processing_ms": 0.5218689970062482, "mean_env_wait_ms": 1.666398830950409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0162151124742296, "StateBufferConnector_ms": 0.01153217421637641, "ViewRequirementAgentConnector_ms": 0.46383804745144314}, "num_episodes": 18, "episode_return_max": 90.0, "episode_return_min": -885.0, "episode_return_mean": -230.27777777777777}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 17.48830452248091, "num_env_steps_trained_throughput_per_sec": 17.48830452248091, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 235342.799, "restore_workers_time_ms": 0.015, "training_step_time_ms": 235342.735, "sample_time_ms": 3812.943, "learn_time_ms": 231481.53, "learn_throughput": 17.28, "synch_weights_time_ms": 27.436}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "90816_00000", "date": "2024-06-10_00-19-51", "timestamp": 1717993191, "time_this_iter_s": 228.75844311714172, "time_total_s": 470.7657380104065, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00295e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 470.7657380104065, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.14104938271605, "ram_util_percent": 82.220987654321}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5779339160718604, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2466617179373964, "policy_loss": -0.007836733531768218, "vf_loss": 1.2531488478564607, "vf_explained_var": 0.022309591563237995, "kl": 0.0067480253128915, "entropy": 1.5599878798150661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 23475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 100.0, "episode_reward_min": -885.0, "episode_reward_mean": -142.77777777777777, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10854, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -14.277777777777779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.0, -255.0, -215.0, -500.0, -125.0, -465.0, -605.0, -610.0, -385.0, -885.0, -40.0, -305.0, -515.0, -430.0, -355.0, -270.0, -455.0, -485.0, -130.0, 70.0, -135.0, 20.0, -50.0, 35.0, -290.0, 10.0, 70.0, 40.0, -20.0, -65.0, -85.0, -45.0, -160.0, 10.0, 90.0, -15.0, -50.0, 40.0, 10.0, 40.0, 50.0, 10.0, -40.0, 15.0, 55.0, 30.0, 25.0, 10.0, 30.0, 0.0, 85.0, 90.0, 100.0, 80.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-250.0, 0.0, 20.0, -100.0, -135.0, 15.0, 10.0, -300.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, -230.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, -10.0, -330.0, -210.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -280.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -205.0, 0.0, 0.0, 0.0, -285.0, 0.0, -60.0, 0.0, 10.0, 0.0, 0.0, -270.0, 0.0, 10.0, 0.0, -290.0, 10.0, 0.0, 0.0, 30.0, 0.0, -370.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, -240.0, 30.0, 10.0, -215.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, -355.0, -195.0, -115.0, 10.0, 0.0, 30.0, 10.0, 0.0, -70.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, -85.0, -20.0, 0.0, -260.0, 0.0, -35.0, -215.0, -185.0, 0.0, -90.0, 0.0, 0.0, 10.0, 0.0, 0.0, -280.0, -5.0, 0.0, 0.0, 0.0, -165.0, 20.0, 0.0, 0.0, 0.0, 0.0, -235.0, 10.0, 0.0, 0.0, 0.0, 0.0, -130.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -135.0, -45.0, -140.0, 20.0, 10.0, -325.0, -160.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -290.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, -245.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 0.0, -55.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, -35.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -60.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, -155.0, 0.0, 0.0, 20.0, 0.0, 0.0, -30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -45.0, 10.0, 10.0, -95.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 20.0, 0.0, 0.0, 0.0, -135.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -85.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, -85.0, 10.0, 0.0, 20.0, 0.0, -125.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, -25.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, -80.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -35.0, 0.0, 10.0, 5.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 20.0, -30.0, 10.0, 20.0, 0.0, -5.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.140933154074533, "mean_inference_ms": 1.6350774757533222, "mean_action_processing_ms": 0.5319428886905775, "mean_env_wait_ms": 1.7038927051429655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015453056052879052, "StateBufferConnector_ms": 0.011949185971860532, "ViewRequirementAgentConnector_ms": 0.5101393770288538}, "num_episodes": 18, "episode_return_max": 100.0, "episode_return_min": -885.0, "episode_return_mean": -142.77777777777777}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.87741125506808, "num_env_steps_trained_throughput_per_sec": 19.87741125506808, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 223973.018, "restore_workers_time_ms": 0.015, "training_step_time_ms": 223972.963, "sample_time_ms": 3807.594, "learn_time_ms": 220127.684, "learn_throughput": 18.171, "synch_weights_time_ms": 21.706}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "90816_00000", "date": "2024-06-10_00-23-12", "timestamp": 1717993392, "time_this_iter_s": 201.2597849369049, "time_total_s": 672.0255229473114, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f56f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 672.0255229473114, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.30210526315789, "ram_util_percent": 80.70982456140351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0930821862654945, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.683120655404112, "policy_loss": -0.006649846437633141, "vf_loss": 2.688586279924431, "vf_explained_var": 0.01446130063714057, "kl": 0.005921113008262628, "entropy": 1.5300125195703314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 32865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 130.0, "episode_reward_min": -885.0, "episode_reward_mean": -90.55555555555556, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 14472, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -9.055555555555555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.0, -255.0, -215.0, -500.0, -125.0, -465.0, -605.0, -610.0, -385.0, -885.0, -40.0, -305.0, -515.0, -430.0, -355.0, -270.0, -455.0, -485.0, -130.0, 70.0, -135.0, 20.0, -50.0, 35.0, -290.0, 10.0, 70.0, 40.0, -20.0, -65.0, -85.0, -45.0, -160.0, 10.0, 90.0, -15.0, -50.0, 40.0, 10.0, 40.0, 50.0, 10.0, -40.0, 15.0, 55.0, 30.0, 25.0, 10.0, 30.0, 0.0, 85.0, 90.0, 100.0, 80.0, 60.0, 130.0, 80.0, 120.0, 40.0, 120.0, 80.0, 70.0, 35.0, 20.0, 110.0, 70.0, 20.0, 70.0, 20.0, 15.0, 60.0, 70.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-250.0, 0.0, 20.0, -100.0, -135.0, 15.0, 10.0, -300.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, -230.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, -10.0, -330.0, -210.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -280.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -205.0, 0.0, 0.0, 0.0, -285.0, 0.0, -60.0, 0.0, 10.0, 0.0, 0.0, -270.0, 0.0, 10.0, 0.0, -290.0, 10.0, 0.0, 0.0, 30.0, 0.0, -370.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, -240.0, 30.0, 10.0, -215.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, -355.0, -195.0, -115.0, 10.0, 0.0, 30.0, 10.0, 0.0, -70.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, -85.0, -20.0, 0.0, -260.0, 0.0, -35.0, -215.0, -185.0, 0.0, -90.0, 0.0, 0.0, 10.0, 0.0, 0.0, -280.0, -5.0, 0.0, 0.0, 0.0, -165.0, 20.0, 0.0, 0.0, 0.0, 0.0, -235.0, 10.0, 0.0, 0.0, 0.0, 0.0, -130.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -135.0, -45.0, -140.0, 20.0, 10.0, -325.0, -160.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -290.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, -245.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 0.0, -55.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, -35.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -60.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, -155.0, 0.0, 0.0, 20.0, 0.0, 0.0, -30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -45.0, 10.0, 10.0, -95.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 20.0, 0.0, 0.0, 0.0, -135.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -85.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, -85.0, 10.0, 0.0, 20.0, 0.0, -125.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, -25.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, -80.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -35.0, 0.0, 10.0, 5.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 20.0, -30.0, 10.0, 20.0, 0.0, -5.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, -20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 30.0, 0.0, 0.0, -85.0, 30.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1269164365310167, "mean_inference_ms": 1.6236428137231802, "mean_action_processing_ms": 0.5271229196983107, "mean_env_wait_ms": 1.6907549722130155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014969044261508517, "StateBufferConnector_ms": 0.01157489087846544, "ViewRequirementAgentConnector_ms": 0.4926913314395481}, "num_episodes": 18, "episode_return_max": 130.0, "episode_return_min": -885.0, "episode_return_mean": -90.55555555555556}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.776139706125814, "num_env_steps_trained_throughput_per_sec": 21.776139706125814, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 213901.588, "restore_workers_time_ms": 0.014, "training_step_time_ms": 213901.535, "sample_time_ms": 3505.208, "learn_time_ms": 210363.236, "learn_throughput": 19.015, "synch_weights_time_ms": 19.428}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "90816_00000", "date": "2024-06-10_00-26-16", "timestamp": 1717993576, "time_this_iter_s": 183.7047770023346, "time_total_s": 855.730299949646, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f6c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 855.730299949646, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.442857142857143, "ram_util_percent": 79.36602316602318}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.982320176996489, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6727822865794897, "policy_loss": -0.010096421897762452, "vf_loss": 2.6812800020836414, "vf_explained_var": 0.01921363425965761, "kl": 0.00799355263203696, "entropy": 1.5191321067408885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 42255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 195.0, "episode_reward_min": -885.0, "episode_reward_mean": -39.54545454545455, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 19899, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": -3.9545454545454546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.0, -255.0, -215.0, -500.0, -125.0, -465.0, -605.0, -610.0, -385.0, -885.0, -40.0, -305.0, -515.0, -430.0, -355.0, -270.0, -455.0, -485.0, -130.0, 70.0, -135.0, 20.0, -50.0, 35.0, -290.0, 10.0, 70.0, 40.0, -20.0, -65.0, -85.0, -45.0, -160.0, 10.0, 90.0, -15.0, -50.0, 40.0, 10.0, 40.0, 50.0, 10.0, -40.0, 15.0, 55.0, 30.0, 25.0, 10.0, 30.0, 0.0, 85.0, 90.0, 100.0, 80.0, 60.0, 130.0, 80.0, 120.0, 40.0, 120.0, 80.0, 70.0, 35.0, 20.0, 110.0, 70.0, 20.0, 70.0, 20.0, 15.0, 60.0, 70.0, 100.0, 100.0, 50.0, 60.0, 130.0, 100.0, 100.0, 130.0, 90.0, 80.0, 155.0, 50.0, 195.0, 100.0, 85.0, 120.0, 130.0, 45.0, 50.0, 80.0, 110.0, 110.0, 160.0, 40.0, 75.0, 110.0, 50.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-250.0, 0.0, 20.0, -100.0, -135.0, 15.0, 10.0, -300.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, -230.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, -10.0, -330.0, -210.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, -280.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -205.0, 0.0, 0.0, 0.0, -285.0, 0.0, -60.0, 0.0, 10.0, 0.0, 0.0, -270.0, 0.0, 10.0, 0.0, -290.0, 10.0, 0.0, 0.0, 30.0, 0.0, -370.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, -240.0, 30.0, 10.0, -215.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, -355.0, -195.0, -115.0, 10.0, 0.0, 30.0, 10.0, 0.0, -70.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, 10.0, 0.0, -85.0, -20.0, 0.0, -260.0, 0.0, -35.0, -215.0, -185.0, 0.0, -90.0, 0.0, 0.0, 10.0, 0.0, 0.0, -280.0, -5.0, 0.0, 0.0, 0.0, -165.0, 20.0, 0.0, 0.0, 0.0, 0.0, -235.0, 10.0, 0.0, 0.0, 0.0, 0.0, -130.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -135.0, -45.0, -140.0, 20.0, 10.0, -325.0, -160.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -290.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, -245.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 0.0, -55.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, -35.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -60.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, -155.0, 0.0, 0.0, 20.0, 0.0, 0.0, -30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -45.0, 10.0, 10.0, -95.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 20.0, 0.0, 0.0, 0.0, -135.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -85.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, -85.0, 10.0, 0.0, 20.0, 0.0, -125.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, -25.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, -80.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -35.0, 0.0, 10.0, 5.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 20.0, -30.0, 10.0, 20.0, 0.0, -5.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, -20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 30.0, 0.0, 0.0, -85.0, 30.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, -10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, -20.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 5.0, 10.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 170.0, -5.0, 20.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, -100.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, -20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, -5.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.09405934471904, "mean_inference_ms": 1.6098741663582057, "mean_action_processing_ms": 0.5164926265708101, "mean_env_wait_ms": 1.658627639903505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014200595894245186, "StateBufferConnector_ms": 0.012275185247864386, "ViewRequirementAgentConnector_ms": 0.45780220417061235}, "num_episodes": 27, "episode_return_max": 195.0, "episode_return_min": -885.0, "episode_return_mean": -39.54545454545455}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.17474463813291, "num_env_steps_trained_throughput_per_sec": 21.17474463813291, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 208902.13, "restore_workers_time_ms": 0.014, "training_step_time_ms": 208902.079, "sample_time_ms": 3343.154, "learn_time_ms": 205528.764, "learn_throughput": 19.462, "synch_weights_time_ms": 17.382}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "90816_00000", "date": "2024-06-10_00-29-25", "timestamp": 1717993765, "time_this_iter_s": 188.91036796569824, "time_total_s": 1044.6406679153442, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f6cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1044.6406679153442, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.225373134328358, "ram_util_percent": 80.80149253731345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.908185648353209, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2315891125458625, "policy_loss": -0.010355965428860685, "vf_loss": 3.2403211463881503, "vf_explained_var": 0.02126706005793156, "kl": 0.008119674505928836, "entropy": 1.5044553297396286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 51645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 220.0, "episode_reward_min": -485.0, "episode_reward_mean": 54.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 5.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-485.0, -130.0, 70.0, -135.0, 20.0, -50.0, 35.0, -290.0, 10.0, 70.0, 40.0, -20.0, -65.0, -85.0, -45.0, -160.0, 10.0, 90.0, -15.0, -50.0, 40.0, 10.0, 40.0, 50.0, 10.0, -40.0, 15.0, 55.0, 30.0, 25.0, 10.0, 30.0, 0.0, 85.0, 90.0, 100.0, 80.0, 60.0, 130.0, 80.0, 120.0, 40.0, 120.0, 80.0, 70.0, 35.0, 20.0, 110.0, 70.0, 20.0, 70.0, 20.0, 15.0, 60.0, 70.0, 100.0, 100.0, 50.0, 60.0, 130.0, 100.0, 100.0, 130.0, 90.0, 80.0, 155.0, 50.0, 195.0, 100.0, 85.0, 120.0, 130.0, 45.0, 50.0, 80.0, 110.0, 110.0, 160.0, 40.0, 75.0, 110.0, 50.0, 120.0, 70.0, 90.0, 70.0, 100.0, 190.0, 110.0, 135.0, 220.0, 100.0, 170.0, 60.0, 100.0, 95.0, 120.0, 115.0, 150.0, 150.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-290.0, 0.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, -245.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -75.0, 0.0, 0.0, -55.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, -35.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -60.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -155.0, -155.0, 0.0, 0.0, 20.0, 0.0, 0.0, -30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -45.0, 10.0, 10.0, -95.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 20.0, 0.0, 0.0, 0.0, -135.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -85.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, -85.0, 10.0, 0.0, 20.0, 0.0, -125.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, -25.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, -80.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -35.0, 0.0, 10.0, 5.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 20.0, -30.0, 10.0, 20.0, 0.0, -5.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, -20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 30.0, 0.0, 0.0, -85.0, 30.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, -10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, -20.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 5.0, 10.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 170.0, -5.0, 20.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, -100.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, -20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, -5.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 0.0, 20.0, 30.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 5.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, 50.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 5.0, 50.0, 20.0, 20.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 15.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, -35.0, 10.0, 30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.084083620487543, "mean_inference_ms": 1.6247514465498467, "mean_action_processing_ms": 0.5136303509675701, "mean_env_wait_ms": 1.6493538587871293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014065742492675781, "StateBufferConnector_ms": 0.012305498123168945, "ViewRequirementAgentConnector_ms": 0.44005393981933594}, "num_episodes": 18, "episode_return_max": 220.0, "episode_return_min": -485.0, "episode_return_mean": 54.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.251836209047738, "num_env_steps_trained_throughput_per_sec": 21.251836209047738, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 205454.949, "restore_workers_time_ms": 0.014, "training_step_time_ms": 205454.898, "sample_time_ms": 3193.869, "learn_time_ms": 202230.867, "learn_throughput": 19.779, "synch_weights_time_ms": 17.225}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "90816_00000", "date": "2024-06-10_00-32-33", "timestamp": 1717993953, "time_this_iter_s": 188.22786402702332, "time_total_s": 1232.8685319423676, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0029820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1232.8685319423676, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.105263157894736, "ram_util_percent": 80.31090225563909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1814508909996326, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1303122730935597, "policy_loss": -0.009313118866698358, "vf_loss": 3.1381621807401046, "vf_explained_var": 0.016253858087415765, "kl": 0.007316042399606386, "entropy": 1.4747322948088153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 61035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 290.0, "episode_reward_min": -50.0, "episode_reward_mean": 90.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 9.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, -50.0, 40.0, 10.0, 40.0, 50.0, 10.0, -40.0, 15.0, 55.0, 30.0, 25.0, 10.0, 30.0, 0.0, 85.0, 90.0, 100.0, 80.0, 60.0, 130.0, 80.0, 120.0, 40.0, 120.0, 80.0, 70.0, 35.0, 20.0, 110.0, 70.0, 20.0, 70.0, 20.0, 15.0, 60.0, 70.0, 100.0, 100.0, 50.0, 60.0, 130.0, 100.0, 100.0, 130.0, 90.0, 80.0, 155.0, 50.0, 195.0, 100.0, 85.0, 120.0, 130.0, 45.0, 50.0, 80.0, 110.0, 110.0, 160.0, 40.0, 75.0, 110.0, 50.0, 120.0, 70.0, 90.0, 70.0, 100.0, 190.0, 110.0, 135.0, 220.0, 100.0, 170.0, 60.0, 100.0, 95.0, 120.0, 115.0, 150.0, 150.0, 120.0, 200.0, 90.0, 165.0, 60.0, 40.0, 90.0, 150.0, 170.0, 160.0, 130.0, 150.0, 115.0, 100.0, 160.0, 290.0, 260.0, 90.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-25.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, -80.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -35.0, 0.0, 10.0, 5.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 20.0, -30.0, 10.0, 20.0, 0.0, -5.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, -20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 30.0, 0.0, 0.0, -85.0, 30.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, -10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, -20.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 5.0, 10.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 170.0, -5.0, 20.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, -100.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, -20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, -5.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 0.0, 20.0, 30.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 5.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, 50.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 5.0, 50.0, 20.0, 20.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 15.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, -35.0, 10.0, 30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 40.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 5.0, 30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, -15.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, -5.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 20.0, 150.0, 30.0, 0.0, -10.0, 20.0, 0.0, 30.0, 30.0, 20.0, 10.0, -30.0, 20.0, 10.0, 10.0, 160.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.023757467358097, "mean_inference_ms": 1.5903876836967406, "mean_action_processing_ms": 0.4956144007665148, "mean_env_wait_ms": 1.5959430285653615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012657642364501953, "StateBufferConnector_ms": 0.011451482772827148, "ViewRequirementAgentConnector_ms": 0.4227774143218994}, "num_episodes": 18, "episode_return_max": 290.0, "episode_return_min": -50.0, "episode_return_mean": 90.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.606927280503637, "num_env_steps_trained_throughput_per_sec": 21.606927280503637, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 202550.788, "restore_workers_time_ms": 0.014, "training_step_time_ms": 202550.739, "sample_time_ms": 3103.822, "learn_time_ms": 199417.954, "learn_throughput": 20.058, "synch_weights_time_ms": 16.781}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "90816_00000", "date": "2024-06-10_00-35-38", "timestamp": 1717994138, "time_this_iter_s": 185.13365626335144, "time_total_s": 1418.002188205719, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327ecd0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1418.002188205719, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.930268199233716, "ram_util_percent": 79.3455938697318}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7887825705055485, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.230284035574006, "policy_loss": -0.009772737298326426, "vf_loss": 3.2384235210565966, "vf_explained_var": 0.0034548303062796465, "kl": 0.008166257820822392, "entropy": 1.4650975332981226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 70425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": 15.0, "episode_reward_mean": 119.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 11.905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.0, 60.0, 130.0, 80.0, 120.0, 40.0, 120.0, 80.0, 70.0, 35.0, 20.0, 110.0, 70.0, 20.0, 70.0, 20.0, 15.0, 60.0, 70.0, 100.0, 100.0, 50.0, 60.0, 130.0, 100.0, 100.0, 130.0, 90.0, 80.0, 155.0, 50.0, 195.0, 100.0, 85.0, 120.0, 130.0, 45.0, 50.0, 80.0, 110.0, 110.0, 160.0, 40.0, 75.0, 110.0, 50.0, 120.0, 70.0, 90.0, 70.0, 100.0, 190.0, 110.0, 135.0, 220.0, 100.0, 170.0, 60.0, 100.0, 95.0, 120.0, 115.0, 150.0, 150.0, 120.0, 200.0, 90.0, 165.0, 60.0, 40.0, 90.0, 150.0, 170.0, 160.0, 130.0, 150.0, 115.0, 100.0, 160.0, 290.0, 260.0, 90.0, 130.0, 170.0, 120.0, 110.0, 230.0, 225.0, 155.0, 240.0, 40.0, 310.0, 250.0, 280.0, 190.0, 270.0, 115.0, 160.0, 190.0, 140.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, -20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 0.0, 0.0, 30.0, 0.0, 0.0, -85.0, 30.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, -10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, -20.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 5.0, 10.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 170.0, -5.0, 20.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, -100.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, -20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, -5.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 0.0, 20.0, 30.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 5.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, 50.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 5.0, 50.0, 20.0, 20.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 15.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, -35.0, 10.0, 30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 40.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 5.0, 30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, -15.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, -5.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 20.0, 150.0, 30.0, 0.0, -10.0, 20.0, 0.0, 30.0, 30.0, 20.0, 10.0, -30.0, 20.0, 10.0, 10.0, 160.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 40.0, 50.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, 0.0, 70.0, 0.0, 70.0, 20.0, 10.0, 0.0, 15.0, 30.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 70.0, 50.0, 10.0, 50.0, 0.0, 10.0, 0.0, -5.0, 0.0, 30.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 50.0, 150.0, 0.0, 30.0, 20.0, 30.0, 40.0, 40.0, 40.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 20.0, 0.0, -30.0, 160.0, 30.0, 30.0, 40.0, 10.0, 0.0, 20.0, 20.0, 20.0, 60.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 35.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 50.0, 0.0, 30.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9499901523546364, "mean_inference_ms": 1.5506792342466134, "mean_action_processing_ms": 0.4767833042331448, "mean_env_wait_ms": 1.5351290939646418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012413263320922852, "StateBufferConnector_ms": 0.01105809211730957, "ViewRequirementAgentConnector_ms": 0.3913578987121582}, "num_episodes": 18, "episode_return_max": 310.0, "episode_return_min": 15.0, "episode_return_mean": 119.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.305882130105893, "num_env_steps_trained_throughput_per_sec": 21.305882130105893, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 200699.639, "restore_workers_time_ms": 0.014, "training_step_time_ms": 200699.59, "sample_time_ms": 3023.207, "learn_time_ms": 197648.469, "learn_throughput": 20.238, "synch_weights_time_ms": 16.195}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "90816_00000", "date": "2024-06-10_00-38-46", "timestamp": 1717994326, "time_this_iter_s": 187.7492458820343, "time_total_s": 1605.7514340877533, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f6ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1605.7514340877533, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.712406015037594, "ram_util_percent": 80.31315789473685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.211667991306581, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7892290131606488, "policy_loss": -0.01076214390192419, "vf_loss": 3.798398684896727, "vf_explained_var": 0.009152175957402482, "kl": 0.007962358085912162, "entropy": 1.4340843380703585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 79815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 550.0, "episode_reward_min": 40.0, "episode_reward_mean": 143.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 260.0}, "policy_reward_mean": {"policy_0": 14.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.0, 100.0, 100.0, 50.0, 60.0, 130.0, 100.0, 100.0, 130.0, 90.0, 80.0, 155.0, 50.0, 195.0, 100.0, 85.0, 120.0, 130.0, 45.0, 50.0, 80.0, 110.0, 110.0, 160.0, 40.0, 75.0, 110.0, 50.0, 120.0, 70.0, 90.0, 70.0, 100.0, 190.0, 110.0, 135.0, 220.0, 100.0, 170.0, 60.0, 100.0, 95.0, 120.0, 115.0, 150.0, 150.0, 120.0, 200.0, 90.0, 165.0, 60.0, 40.0, 90.0, 150.0, 170.0, 160.0, 130.0, 150.0, 115.0, 100.0, 160.0, 290.0, 260.0, 90.0, 130.0, 170.0, 120.0, 110.0, 230.0, 225.0, 155.0, 240.0, 40.0, 310.0, 250.0, 280.0, 190.0, 270.0, 115.0, 160.0, 190.0, 140.0, 140.0, 160.0, 150.0, 220.0, 60.0, 350.0, 140.0, 120.0, 190.0, 195.0, 240.0, 550.0, 300.0, 220.0, 80.0, 145.0, 170.0, 210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, -10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, -20.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 5.0, 10.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 170.0, -5.0, 20.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, -100.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 0.0, -5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, -20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, -5.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 0.0, 20.0, 30.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 5.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, 50.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 5.0, 50.0, 20.0, 20.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 15.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, -35.0, 10.0, 30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 40.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 5.0, 30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, -15.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, -5.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 20.0, 150.0, 30.0, 0.0, -10.0, 20.0, 0.0, 30.0, 30.0, 20.0, 10.0, -30.0, 20.0, 10.0, 10.0, 160.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 40.0, 50.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, 0.0, 70.0, 0.0, 70.0, 20.0, 10.0, 0.0, 15.0, 30.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 70.0, 50.0, 10.0, 50.0, 0.0, 10.0, 0.0, -5.0, 0.0, 30.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 50.0, 150.0, 0.0, 30.0, 20.0, 30.0, 40.0, 40.0, 40.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 20.0, 0.0, -30.0, 160.0, 30.0, 30.0, 40.0, 10.0, 0.0, 20.0, 20.0, 20.0, 60.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 35.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 50.0, 0.0, 30.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 60.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 50.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 260.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 20.0, 0.0, 10.0, 40.0, 40.0, 40.0, 10.0, 20.0, 80.0, -115.0, 40.0, 30.0, 40.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 260.0, 50.0, 20.0, 30.0, 50.0, 40.0, 40.0, 10.0, 100.0, 10.0, 10.0, 30.0, 30.0, 10.0, 40.0, 10.0, 20.0, 40.0, 10.0, 40.0, 0.0, 10.0, 50.0, 30.0, 10.0, 10.0, 10.0, 50.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 60.0, 40.0, 10.0, -35.0, 0.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, -5.0, -5.0, 10.0, 70.0, 40.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 30.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8945942114719827, "mean_inference_ms": 1.5314296979046083, "mean_action_processing_ms": 0.4629437534127651, "mean_env_wait_ms": 1.4904197508737593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011793375015258789, "StateBufferConnector_ms": 0.010388612747192383, "ViewRequirementAgentConnector_ms": 0.3644833564758301}, "num_episodes": 18, "episode_return_max": 550.0, "episode_return_min": 40.0, "episode_return_mean": 143.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.584915348717328, "num_env_steps_trained_throughput_per_sec": 21.584915348717328, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 198990.191, "restore_workers_time_ms": 0.013, "training_step_time_ms": 198990.143, "sample_time_ms": 2954.852, "learn_time_ms": 196008.484, "learn_throughput": 20.407, "synch_weights_time_ms": 15.454}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "90816_00000", "date": "2024-06-10_00-41-52", "timestamp": 1717994512, "time_this_iter_s": 185.3254039287567, "time_total_s": 1791.07683801651, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f6b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1791.07683801651, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 16.869847328244273, "ram_util_percent": 79.36259541984732}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.00018862757566, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.720726006607405, "policy_loss": -0.01123053892046963, "vf_loss": 3.7302477871140227, "vf_explained_var": 0.015167210562922322, "kl": 0.008543774720874643, "entropy": 1.4096378027694547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 89205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 550.0, "episode_reward_min": -50.0, "episode_reward_mean": 168.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 260.0}, "policy_reward_mean": {"policy_0": 16.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 120.0, 70.0, 90.0, 70.0, 100.0, 190.0, 110.0, 135.0, 220.0, 100.0, 170.0, 60.0, 100.0, 95.0, 120.0, 115.0, 150.0, 150.0, 120.0, 200.0, 90.0, 165.0, 60.0, 40.0, 90.0, 150.0, 170.0, 160.0, 130.0, 150.0, 115.0, 100.0, 160.0, 290.0, 260.0, 90.0, 130.0, 170.0, 120.0, 110.0, 230.0, 225.0, 155.0, 240.0, 40.0, 310.0, 250.0, 280.0, 190.0, 270.0, 115.0, 160.0, 190.0, 140.0, 140.0, 160.0, 150.0, 220.0, 60.0, 350.0, 140.0, 120.0, 190.0, 195.0, 240.0, 550.0, 300.0, 220.0, 80.0, 145.0, 170.0, 210.0, 170.0, 220.0, 95.0, 260.0, 130.0, 90.0, 175.0, 170.0, 270.0, 220.0, 150.0, 420.0, -50.0, 120.0, 180.0, 65.0, 360.0, 260.0, 170.0, 210.0, 170.0, 150.0, 200.0, 225.0, 160.0, 160.0, 410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, -10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 0.0, 20.0, 30.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 5.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, 50.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 5.0, 50.0, 20.0, 20.0, 10.0, 30.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 15.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, -35.0, 10.0, 30.0, 20.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 40.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 5.0, 30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, -15.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, -5.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 20.0, 150.0, 30.0, 0.0, -10.0, 20.0, 0.0, 30.0, 30.0, 20.0, 10.0, -30.0, 20.0, 10.0, 10.0, 160.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 40.0, 50.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, 0.0, 70.0, 0.0, 70.0, 20.0, 10.0, 0.0, 15.0, 30.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 70.0, 50.0, 10.0, 50.0, 0.0, 10.0, 0.0, -5.0, 0.0, 30.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 50.0, 150.0, 0.0, 30.0, 20.0, 30.0, 40.0, 40.0, 40.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 20.0, 0.0, -30.0, 160.0, 30.0, 30.0, 40.0, 10.0, 0.0, 20.0, 20.0, 20.0, 60.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 35.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 50.0, 0.0, 30.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 60.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 50.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 260.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 20.0, 0.0, 10.0, 40.0, 40.0, 40.0, 10.0, 20.0, 80.0, -115.0, 40.0, 30.0, 40.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 260.0, 50.0, 20.0, 30.0, 50.0, 40.0, 40.0, 10.0, 100.0, 10.0, 10.0, 30.0, 30.0, 10.0, 40.0, 10.0, 20.0, 40.0, 10.0, 40.0, 0.0, 10.0, 50.0, 30.0, 10.0, 10.0, 10.0, 50.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 60.0, 40.0, 10.0, -35.0, 0.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, -5.0, -5.0, 10.0, 70.0, 40.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, -15.0, 20.0, 20.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 15.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 30.0, 0.0, 30.0, 40.0, 50.0, 70.0, 30.0, 0.0, 10.0, 40.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 70.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 20.0, 180.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 30.0, -250.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 30.0, 0.0, 0.0, 20.0, 0.0, -15.0, 20.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 40.0, 70.0, 10.0, 10.0, 70.0, 50.0, 0.0, 10.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 0.0, 30.0, 40.0, 80.0, 10.0, 0.0, -40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 20.0, 40.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 50.0, 0.0, 180.0, 70.0, -50.0, 10.0, -65.0, 30.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 50.0, 0.0, 170.0, 40.0, 10.0, -30.0, 10.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8259375963494284, "mean_inference_ms": 1.5083256773476865, "mean_action_processing_ms": 0.4474802589046949, "mean_env_wait_ms": 1.4401825997610096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01198124885559082, "StateBufferConnector_ms": 0.00902700424194336, "ViewRequirementAgentConnector_ms": 0.36409687995910645}, "num_episodes": 27, "episode_return_max": 550.0, "episode_return_min": -50.0, "episode_return_mean": 168.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.31393231906814, "num_env_steps_trained_throughput_per_sec": 21.31393231906814, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 197858.24, "restore_workers_time_ms": 0.013, "training_step_time_ms": 197858.193, "sample_time_ms": 2902.892, "learn_time_ms": 194929.179, "learn_throughput": 20.52, "synch_weights_time_ms": 15.075}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 10, "trial_id": "90816_00000", "date": "2024-06-10_00-44-59", "timestamp": 1717994699, "time_this_iter_s": 187.67898273468018, "time_total_s": 1978.7558207511902, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f6160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1978.7558207511902, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.067924528301887, "ram_util_percent": 79.42641509433962}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.300650116721916, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.01159906273071, "policy_loss": -0.009659730210797158, "vf_loss": 4.019482767467681, "vf_explained_var": 0.006259820395257399, "kl": 0.00888012372127246, "entropy": 1.3917800853681515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 98595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 550.0, "episode_reward_min": -50.0, "episode_reward_mean": 191.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 260.0}, "policy_reward_mean": {"policy_0": 19.16}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 120.0, 200.0, 90.0, 165.0, 60.0, 40.0, 90.0, 150.0, 170.0, 160.0, 130.0, 150.0, 115.0, 100.0, 160.0, 290.0, 260.0, 90.0, 130.0, 170.0, 120.0, 110.0, 230.0, 225.0, 155.0, 240.0, 40.0, 310.0, 250.0, 280.0, 190.0, 270.0, 115.0, 160.0, 190.0, 140.0, 140.0, 160.0, 150.0, 220.0, 60.0, 350.0, 140.0, 120.0, 190.0, 195.0, 240.0, 550.0, 300.0, 220.0, 80.0, 145.0, 170.0, 210.0, 170.0, 220.0, 95.0, 260.0, 130.0, 90.0, 175.0, 170.0, 270.0, 220.0, 150.0, 420.0, -50.0, 120.0, 180.0, 65.0, 360.0, 260.0, 170.0, 210.0, 170.0, 150.0, 200.0, 225.0, 160.0, 160.0, 410.0, 350.0, 80.0, 195.0, 210.0, 320.0, 190.0, 230.0, 140.0, 180.0, 245.0, 180.0, 300.0, 390.0, 270.0, 320.0, 305.0, 190.0, 250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 40.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 5.0, 30.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, -15.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 20.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, -5.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 20.0, 150.0, 30.0, 0.0, -10.0, 20.0, 0.0, 30.0, 30.0, 20.0, 10.0, -30.0, 20.0, 10.0, 10.0, 160.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 40.0, 50.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, 0.0, 70.0, 0.0, 70.0, 20.0, 10.0, 0.0, 15.0, 30.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 70.0, 50.0, 10.0, 50.0, 0.0, 10.0, 0.0, -5.0, 0.0, 30.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 50.0, 150.0, 0.0, 30.0, 20.0, 30.0, 40.0, 40.0, 40.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 20.0, 0.0, -30.0, 160.0, 30.0, 30.0, 40.0, 10.0, 0.0, 20.0, 20.0, 20.0, 60.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 35.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 50.0, 0.0, 30.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 60.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 50.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 260.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 20.0, 0.0, 10.0, 40.0, 40.0, 40.0, 10.0, 20.0, 80.0, -115.0, 40.0, 30.0, 40.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 260.0, 50.0, 20.0, 30.0, 50.0, 40.0, 40.0, 10.0, 100.0, 10.0, 10.0, 30.0, 30.0, 10.0, 40.0, 10.0, 20.0, 40.0, 10.0, 40.0, 0.0, 10.0, 50.0, 30.0, 10.0, 10.0, 10.0, 50.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 60.0, 40.0, 10.0, -35.0, 0.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, -5.0, -5.0, 10.0, 70.0, 40.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, -15.0, 20.0, 20.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 15.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 30.0, 0.0, 30.0, 40.0, 50.0, 70.0, 30.0, 0.0, 10.0, 40.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 70.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 20.0, 180.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 30.0, -250.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 30.0, 0.0, 0.0, 20.0, 0.0, -15.0, 20.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 40.0, 70.0, 10.0, 10.0, 70.0, 50.0, 0.0, 10.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 0.0, 30.0, 40.0, 80.0, 10.0, 0.0, -40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 20.0, 40.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 50.0, 0.0, 180.0, 70.0, -50.0, 10.0, -65.0, 30.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 50.0, 0.0, 170.0, 40.0, 10.0, -30.0, 10.0, 100.0, 0.0, 60.0, 30.0, 0.0, 50.0, 40.0, 30.0, -60.0, 170.0, 30.0, 0.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -10.0, 30.0, 20.0, 40.0, 40.0, 10.0, 10.0, 10.0, 15.0, 30.0, 50.0, 70.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 50.0, 50.0, 0.0, 170.0, 10.0, 10.0, -100.0, 30.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 30.0, 0.0, 30.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 25.0, 0.0, 30.0, 10.0, 70.0, 50.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 10.0, 60.0, 30.0, 30.0, 20.0, 40.0, 60.0, 180.0, -40.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 30.0, 60.0, 30.0, 0.0, 15.0, 10.0, 0.0, 70.0, -15.0, 170.0, 20.0, 40.0, 10.0, 5.0, 60.0, 10.0, 70.0, 80.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 70.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 40.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.790456103343609, "mean_inference_ms": 1.4989128203073574, "mean_action_processing_ms": 0.44000019624527925, "mean_env_wait_ms": 1.4158752167680873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012080192565917969, "StateBufferConnector_ms": 0.00908660888671875, "ViewRequirementAgentConnector_ms": 0.3759880065917969}, "num_episodes": 18, "episode_return_max": 550.0, "episode_return_min": -50.0, "episode_return_mean": 191.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.336279676611074, "num_env_steps_trained_throughput_per_sec": 21.336279676611074, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 192409.522, "restore_workers_time_ms": 0.013, "training_step_time_ms": 192409.479, "sample_time_ms": 2802.659, "learn_time_ms": 189582.575, "learn_throughput": 21.099, "synch_weights_time_ms": 14.825}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 11, "trial_id": "90816_00000", "date": "2024-06-10_00-48-07", "timestamp": 1717994887, "time_this_iter_s": 187.4813380241394, "time_total_s": 2166.2371587753296, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f6bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2166.2371587753296, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.809774436090223, "ram_util_percent": 79.36992481203008}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6128930956601333, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.100984010097191, "policy_loss": -0.009994961460581183, "vf_loss": 4.109228530960976, "vf_explained_var": 0.0038294999426800097, "kl": 0.008752204665282788, "entropy": 1.3582836735108916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 107985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 580.0, "episode_reward_min": -50.0, "episode_reward_mean": 220.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 260.0}, "policy_reward_mean": {"policy_0": 22.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 130.0, 170.0, 120.0, 110.0, 230.0, 225.0, 155.0, 240.0, 40.0, 310.0, 250.0, 280.0, 190.0, 270.0, 115.0, 160.0, 190.0, 140.0, 140.0, 160.0, 150.0, 220.0, 60.0, 350.0, 140.0, 120.0, 190.0, 195.0, 240.0, 550.0, 300.0, 220.0, 80.0, 145.0, 170.0, 210.0, 170.0, 220.0, 95.0, 260.0, 130.0, 90.0, 175.0, 170.0, 270.0, 220.0, 150.0, 420.0, -50.0, 120.0, 180.0, 65.0, 360.0, 260.0, 170.0, 210.0, 170.0, 150.0, 200.0, 225.0, 160.0, 160.0, 410.0, 350.0, 80.0, 195.0, 210.0, 320.0, 190.0, 230.0, 140.0, 180.0, 245.0, 180.0, 300.0, 390.0, 270.0, 320.0, 305.0, 190.0, 250.0, 150.0, 410.0, 160.0, 310.0, 580.0, 535.0, 120.0, 230.0, 220.0, 485.0, 205.0, 205.0, 340.0, 250.0, 390.0, 200.0, 290.0, 360.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 20.0, 10.0, 0.0, 0.0, -20.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 40.0, 50.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, 0.0, 70.0, 0.0, 70.0, 20.0, 10.0, 0.0, 15.0, 30.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 70.0, 50.0, 10.0, 50.0, 0.0, 10.0, 0.0, -5.0, 0.0, 30.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 50.0, 150.0, 0.0, 30.0, 20.0, 30.0, 40.0, 40.0, 40.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 20.0, 0.0, -30.0, 160.0, 30.0, 30.0, 40.0, 10.0, 0.0, 20.0, 20.0, 20.0, 60.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 10.0, 0.0, 35.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 50.0, 0.0, 30.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 60.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 50.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 260.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 20.0, 0.0, 10.0, 40.0, 40.0, 40.0, 10.0, 20.0, 80.0, -115.0, 40.0, 30.0, 40.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 260.0, 50.0, 20.0, 30.0, 50.0, 40.0, 40.0, 10.0, 100.0, 10.0, 10.0, 30.0, 30.0, 10.0, 40.0, 10.0, 20.0, 40.0, 10.0, 40.0, 0.0, 10.0, 50.0, 30.0, 10.0, 10.0, 10.0, 50.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 60.0, 40.0, 10.0, -35.0, 0.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, -5.0, -5.0, 10.0, 70.0, 40.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, -15.0, 20.0, 20.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 15.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 30.0, 0.0, 30.0, 40.0, 50.0, 70.0, 30.0, 0.0, 10.0, 40.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 70.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 20.0, 180.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 30.0, -250.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 30.0, 0.0, 0.0, 20.0, 0.0, -15.0, 20.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 40.0, 70.0, 10.0, 10.0, 70.0, 50.0, 0.0, 10.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 0.0, 30.0, 40.0, 80.0, 10.0, 0.0, -40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 20.0, 40.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 50.0, 0.0, 180.0, 70.0, -50.0, 10.0, -65.0, 30.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 50.0, 0.0, 170.0, 40.0, 10.0, -30.0, 10.0, 100.0, 0.0, 60.0, 30.0, 0.0, 50.0, 40.0, 30.0, -60.0, 170.0, 30.0, 0.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -10.0, 30.0, 20.0, 40.0, 40.0, 10.0, 10.0, 10.0, 15.0, 30.0, 50.0, 70.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 50.0, 50.0, 0.0, 170.0, 10.0, 10.0, -100.0, 30.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 30.0, 0.0, 30.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 25.0, 0.0, 30.0, 10.0, 70.0, 50.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 10.0, 60.0, 30.0, 30.0, 20.0, 40.0, 60.0, 180.0, -40.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 30.0, 60.0, 30.0, 0.0, 15.0, 10.0, 0.0, 70.0, -15.0, 170.0, 20.0, 40.0, 10.0, 5.0, 60.0, 10.0, 70.0, 80.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 70.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 50.0, 160.0, 20.0, 0.0, 20.0, 60.0, 30.0, 0.0, 30.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 50.0, 20.0, 20.0, 70.0, 20.0, 0.0, 50.0, 20.0, 40.0, 30.0, 40.0, 30.0, 30.0, 10.0, -30.0, 180.0, 90.0, 10.0, -20.0, 30.0, 250.0, 10.0, 180.0, 10.0, 10.0, 40.0, 160.0, 20.0, 20.0, 10.0, 75.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 50.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 40.0, 10.0, -20.0, 10.0, 40.0, 10.0, 60.0, 20.0, 5.0, 30.0, 250.0, 80.0, 30.0, 20.0, 20.0, 0.0, 30.0, 50.0, 0.0, 10.0, 40.0, 5.0, 40.0, 20.0, 20.0, 10.0, 5.0, 40.0, 20.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 10.0, 30.0, 0.0, 160.0, 30.0, 20.0, 0.0, 0.0, 60.0, 40.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 10.0, 40.0, 30.0, 20.0, 50.0, 110.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 60.0, 30.0, 0.0, 150.0, 10.0, 40.0, 10.0, 50.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7615897272208516, "mean_inference_ms": 1.489446086800882, "mean_action_processing_ms": 0.43393857123939333, "mean_env_wait_ms": 1.39580415462426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011942386627197266, "StateBufferConnector_ms": 0.009049654006958008, "ViewRequirementAgentConnector_ms": 0.38085508346557617}, "num_episodes": 18, "episode_return_max": 580.0, "episode_return_min": -50.0, "episode_return_mean": 220.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.425786581045674, "num_env_steps_trained_throughput_per_sec": 21.425786581045674, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 188206.186, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188206.143, "sample_time_ms": 2633.513, "learn_time_ms": 185551.972, "learn_throughput": 21.557, "synch_weights_time_ms": 12.227}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 12, "trial_id": "90816_00000", "date": "2024-06-10_00-51-13", "timestamp": 1717995073, "time_this_iter_s": 186.70587801933289, "time_total_s": 2352.9430367946625, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f65e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2352.9430367946625, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.7030303030303, "ram_util_percent": 80.03484848484848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7639617266175085, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9585851905698846, "policy_loss": -0.011060127197304608, "vf_loss": 3.967773091272551, "vf_explained_var": 0.04044065845533174, "kl": 0.009361097447978436, "entropy": 1.3412019806548048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 117375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 580.0, "episode_reward_min": -50.0, "episode_reward_mean": 237.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 260.0}, "policy_reward_mean": {"policy_0": 23.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [140.0, 140.0, 160.0, 150.0, 220.0, 60.0, 350.0, 140.0, 120.0, 190.0, 195.0, 240.0, 550.0, 300.0, 220.0, 80.0, 145.0, 170.0, 210.0, 170.0, 220.0, 95.0, 260.0, 130.0, 90.0, 175.0, 170.0, 270.0, 220.0, 150.0, 420.0, -50.0, 120.0, 180.0, 65.0, 360.0, 260.0, 170.0, 210.0, 170.0, 150.0, 200.0, 225.0, 160.0, 160.0, 410.0, 350.0, 80.0, 195.0, 210.0, 320.0, 190.0, 230.0, 140.0, 180.0, 245.0, 180.0, 300.0, 390.0, 270.0, 320.0, 305.0, 190.0, 250.0, 150.0, 410.0, 160.0, 310.0, 580.0, 535.0, 120.0, 230.0, 220.0, 485.0, 205.0, 205.0, 340.0, 250.0, 390.0, 200.0, 290.0, 360.0, 345.0, 380.0, 410.0, 410.0, 240.0, 240.0, 320.0, 220.0, 240.0, 240.0, 300.0, 290.0, 370.0, 85.0, 305.0, 140.0, 240.0, 250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 60.0, 10.0, 10.0, 20.0, 30.0, 10.0, 20.0, 10.0, 50.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 260.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 20.0, 0.0, 10.0, 40.0, 40.0, 40.0, 10.0, 20.0, 80.0, -115.0, 40.0, 30.0, 40.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 0.0, 10.0, 40.0, 260.0, 50.0, 20.0, 30.0, 50.0, 40.0, 40.0, 10.0, 100.0, 10.0, 10.0, 30.0, 30.0, 10.0, 40.0, 10.0, 20.0, 40.0, 10.0, 40.0, 0.0, 10.0, 50.0, 30.0, 10.0, 10.0, 10.0, 50.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 60.0, 40.0, 10.0, -35.0, 0.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, -5.0, -5.0, 10.0, 70.0, 40.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, -15.0, 20.0, 20.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 15.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 30.0, 0.0, 30.0, 40.0, 50.0, 70.0, 30.0, 0.0, 10.0, 40.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 70.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 20.0, 180.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 30.0, -250.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 30.0, 0.0, 0.0, 20.0, 0.0, -15.0, 20.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 40.0, 70.0, 10.0, 10.0, 70.0, 50.0, 0.0, 10.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 0.0, 30.0, 40.0, 80.0, 10.0, 0.0, -40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 20.0, 40.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 50.0, 0.0, 180.0, 70.0, -50.0, 10.0, -65.0, 30.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 50.0, 0.0, 170.0, 40.0, 10.0, -30.0, 10.0, 100.0, 0.0, 60.0, 30.0, 0.0, 50.0, 40.0, 30.0, -60.0, 170.0, 30.0, 0.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -10.0, 30.0, 20.0, 40.0, 40.0, 10.0, 10.0, 10.0, 15.0, 30.0, 50.0, 70.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 50.0, 50.0, 0.0, 170.0, 10.0, 10.0, -100.0, 30.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 30.0, 0.0, 30.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 25.0, 0.0, 30.0, 10.0, 70.0, 50.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 10.0, 60.0, 30.0, 30.0, 20.0, 40.0, 60.0, 180.0, -40.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 30.0, 60.0, 30.0, 0.0, 15.0, 10.0, 0.0, 70.0, -15.0, 170.0, 20.0, 40.0, 10.0, 5.0, 60.0, 10.0, 70.0, 80.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 70.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 50.0, 160.0, 20.0, 0.0, 20.0, 60.0, 30.0, 0.0, 30.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 50.0, 20.0, 20.0, 70.0, 20.0, 0.0, 50.0, 20.0, 40.0, 30.0, 40.0, 30.0, 30.0, 10.0, -30.0, 180.0, 90.0, 10.0, -20.0, 30.0, 250.0, 10.0, 180.0, 10.0, 10.0, 40.0, 160.0, 20.0, 20.0, 10.0, 75.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 50.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 40.0, 10.0, -20.0, 10.0, 40.0, 10.0, 60.0, 20.0, 5.0, 30.0, 250.0, 80.0, 30.0, 20.0, 20.0, 0.0, 30.0, 50.0, 0.0, 10.0, 40.0, 5.0, 40.0, 20.0, 20.0, 10.0, 5.0, 40.0, 20.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 10.0, 30.0, 0.0, 160.0, 30.0, 20.0, 0.0, 0.0, 60.0, 40.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 10.0, 40.0, 30.0, 20.0, 50.0, 110.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 60.0, 30.0, 0.0, 150.0, 10.0, 40.0, 10.0, 50.0, 0.0, 10.0, 50.0, 10.0, 50.0, 20.0, -5.0, 10.0, 150.0, 40.0, 10.0, 30.0, 20.0, 70.0, 70.0, 60.0, 20.0, 70.0, 10.0, 0.0, 30.0, 60.0, -30.0, 0.0, 30.0, 260.0, 30.0, 0.0, 0.0, 30.0, 30.0, 20.0, 70.0, 20.0, 40.0, 20.0, 20.0, 170.0, 0.0, 40.0, 10.0, 50.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 0.0, 10.0, 40.0, 20.0, 30.0, 0.0, 50.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 40.0, 60.0, 10.0, 20.0, 50.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 60.0, 30.0, 10.0, 80.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 40.0, 40.0, 60.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 170.0, 30.0, 10.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 80.0, 50.0, 30.0, 90.0, 70.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, -5.0, 20.0, 0.0, 20.0, 30.0, 40.0, 5.0, 50.0, -20.0, 20.0, 160.0, 0.0, 20.0, 40.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 70.0, 30.0, 20.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 60.0, 20.0, 0.0, 60.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7426930307062636, "mean_inference_ms": 1.4898984635674062, "mean_action_processing_ms": 0.4305490797643929, "mean_env_wait_ms": 1.3844888669342696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013350248336791992, "StateBufferConnector_ms": 0.009480476379394531, "ViewRequirementAgentConnector_ms": 0.4069688320159912}, "num_episodes": 18, "episode_return_max": 580.0, "episode_return_min": -50.0, "episode_return_mean": 237.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.2334838873047, "num_env_steps_trained_throughput_per_sec": 21.2334838873047, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 186921.012, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186920.968, "sample_time_ms": 2549.142, "learn_time_ms": 184350.845, "learn_throughput": 21.698, "synch_weights_time_ms": 12.533}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 13, "trial_id": "90816_00000", "date": "2024-06-10_00-54-22", "timestamp": 1717995262, "time_this_iter_s": 188.3886752128601, "time_total_s": 2541.3317120075226, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00c0700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2541.3317120075226, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.23233082706767, "ram_util_percent": 79.77631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3553674010042185, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.210244012056702, "policy_loss": -0.00972492739247531, "vf_loss": 4.218416884024176, "vf_explained_var": 0.013328501426627715, "kl": 0.007760268786313152, "entropy": 1.326561322532142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 126765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 900.0, "episode_reward_min": -50.0, "episode_reward_mean": 257.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 25.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 170.0, 220.0, 95.0, 260.0, 130.0, 90.0, 175.0, 170.0, 270.0, 220.0, 150.0, 420.0, -50.0, 120.0, 180.0, 65.0, 360.0, 260.0, 170.0, 210.0, 170.0, 150.0, 200.0, 225.0, 160.0, 160.0, 410.0, 350.0, 80.0, 195.0, 210.0, 320.0, 190.0, 230.0, 140.0, 180.0, 245.0, 180.0, 300.0, 390.0, 270.0, 320.0, 305.0, 190.0, 250.0, 150.0, 410.0, 160.0, 310.0, 580.0, 535.0, 120.0, 230.0, 220.0, 485.0, 205.0, 205.0, 340.0, 250.0, 390.0, 200.0, 290.0, 360.0, 345.0, 380.0, 410.0, 410.0, 240.0, 240.0, 320.0, 220.0, 240.0, 240.0, 300.0, 290.0, 370.0, 85.0, 305.0, 140.0, 240.0, 250.0, 270.0, 170.0, 250.0, 330.0, 900.0, 720.0, 270.0, 190.0, 170.0, 460.0, 160.0, 250.0, 390.0, 240.0, 260.0, 135.0, 130.0, 230.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 30.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 40.0, 50.0, 0.0, 50.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, -15.0, 20.0, 20.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 15.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 30.0, 0.0, 30.0, 40.0, 50.0, 70.0, 30.0, 0.0, 10.0, 40.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 70.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 20.0, 180.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 30.0, -250.0, 0.0, 30.0, 10.0, 60.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 30.0, 0.0, 0.0, 20.0, 0.0, -15.0, 20.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 40.0, 70.0, 10.0, 10.0, 70.0, 50.0, 0.0, 10.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 0.0, 30.0, 40.0, 80.0, 10.0, 0.0, -40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 20.0, 40.0, 50.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 50.0, 0.0, 180.0, 70.0, -50.0, 10.0, -65.0, 30.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 30.0, 50.0, 0.0, 170.0, 40.0, 10.0, -30.0, 10.0, 100.0, 0.0, 60.0, 30.0, 0.0, 50.0, 40.0, 30.0, -60.0, 170.0, 30.0, 0.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -10.0, 30.0, 20.0, 40.0, 40.0, 10.0, 10.0, 10.0, 15.0, 30.0, 50.0, 70.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 50.0, 50.0, 0.0, 170.0, 10.0, 10.0, -100.0, 30.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 30.0, 0.0, 30.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 25.0, 0.0, 30.0, 10.0, 70.0, 50.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 10.0, 60.0, 30.0, 30.0, 20.0, 40.0, 60.0, 180.0, -40.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 30.0, 60.0, 30.0, 0.0, 15.0, 10.0, 0.0, 70.0, -15.0, 170.0, 20.0, 40.0, 10.0, 5.0, 60.0, 10.0, 70.0, 80.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 70.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 50.0, 160.0, 20.0, 0.0, 20.0, 60.0, 30.0, 0.0, 30.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 50.0, 20.0, 20.0, 70.0, 20.0, 0.0, 50.0, 20.0, 40.0, 30.0, 40.0, 30.0, 30.0, 10.0, -30.0, 180.0, 90.0, 10.0, -20.0, 30.0, 250.0, 10.0, 180.0, 10.0, 10.0, 40.0, 160.0, 20.0, 20.0, 10.0, 75.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 50.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 40.0, 10.0, -20.0, 10.0, 40.0, 10.0, 60.0, 20.0, 5.0, 30.0, 250.0, 80.0, 30.0, 20.0, 20.0, 0.0, 30.0, 50.0, 0.0, 10.0, 40.0, 5.0, 40.0, 20.0, 20.0, 10.0, 5.0, 40.0, 20.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 10.0, 30.0, 0.0, 160.0, 30.0, 20.0, 0.0, 0.0, 60.0, 40.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 10.0, 40.0, 30.0, 20.0, 50.0, 110.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 60.0, 30.0, 0.0, 150.0, 10.0, 40.0, 10.0, 50.0, 0.0, 10.0, 50.0, 10.0, 50.0, 20.0, -5.0, 10.0, 150.0, 40.0, 10.0, 30.0, 20.0, 70.0, 70.0, 60.0, 20.0, 70.0, 10.0, 0.0, 30.0, 60.0, -30.0, 0.0, 30.0, 260.0, 30.0, 0.0, 0.0, 30.0, 30.0, 20.0, 70.0, 20.0, 40.0, 20.0, 20.0, 170.0, 0.0, 40.0, 10.0, 50.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 0.0, 10.0, 40.0, 20.0, 30.0, 0.0, 50.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 40.0, 60.0, 10.0, 20.0, 50.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 60.0, 30.0, 10.0, 80.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 40.0, 40.0, 60.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 170.0, 30.0, 10.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 80.0, 50.0, 30.0, 90.0, 70.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, -5.0, 20.0, 0.0, 20.0, 30.0, 40.0, 5.0, 50.0, -20.0, 20.0, 160.0, 0.0, 20.0, 40.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 70.0, 30.0, 20.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 60.0, 20.0, 0.0, 60.0, 20.0, 10.0, 10.0, 90.0, 10.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 30.0, 10.0, 50.0, 10.0, 20.0, 30.0, 30.0, 110.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 40.0, 50.0, 40.0, 20.0, 10.0, 30.0, 40.0, 60.0, 10.0, 30.0, 20.0, 40.0, 70.0, 40.0, 10.0, 90.0, 130.0, 60.0, 380.0, 60.0, 50.0, 40.0, 30.0, -20.0, -90.0, 180.0, 20.0, 460.0, 40.0, 10.0, 0.0, 40.0, 10.0, 20.0, 50.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 30.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 40.0, 0.0, 10.0, 30.0, 70.0, 80.0, 10.0, 50.0, 30.0, 60.0, 50.0, 20.0, 70.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 10.0, 10.0, 30.0, 90.0, 180.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 15.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7279825438915537, "mean_inference_ms": 1.4912665536105385, "mean_action_processing_ms": 0.42804560683052756, "mean_env_wait_ms": 1.3758714979320985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013405561447143555, "StateBufferConnector_ms": 0.009548664093017578, "ViewRequirementAgentConnector_ms": 0.4112825393676758}, "num_episodes": 18, "episode_return_max": 900.0, "episode_return_min": -50.0, "episode_return_mean": 257.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.14127428469444, "num_env_steps_trained_throughput_per_sec": 21.14127428469444, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 187472.619, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187472.576, "sample_time_ms": 2547.514, "learn_time_ms": 184903.717, "learn_throughput": 21.633, "synch_weights_time_ms": 12.663}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 14, "trial_id": "90816_00000", "date": "2024-06-10_00-57-31", "timestamp": 1717995451, "time_this_iter_s": 189.21006298065186, "time_total_s": 2730.5417749881744, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00c5820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2730.5417749881744, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.8044776119403, "ram_util_percent": 79.29440298507463}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.260390793350431, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.6034756291788606, "policy_loss": -0.010813429307007093, "vf_loss": 4.612600086469112, "vf_explained_var": 0.0008759916273041909, "kl": 0.008444862958257854, "entropy": 1.2838458726962154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 136155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 900.0, "episode_reward_min": 80.0, "episode_reward_mean": 297.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 29.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.0, 350.0, 80.0, 195.0, 210.0, 320.0, 190.0, 230.0, 140.0, 180.0, 245.0, 180.0, 300.0, 390.0, 270.0, 320.0, 305.0, 190.0, 250.0, 150.0, 410.0, 160.0, 310.0, 580.0, 535.0, 120.0, 230.0, 220.0, 485.0, 205.0, 205.0, 340.0, 250.0, 390.0, 200.0, 290.0, 360.0, 345.0, 380.0, 410.0, 410.0, 240.0, 240.0, 320.0, 220.0, 240.0, 240.0, 300.0, 290.0, 370.0, 85.0, 305.0, 140.0, 240.0, 250.0, 270.0, 170.0, 250.0, 330.0, 900.0, 720.0, 270.0, 190.0, 170.0, 460.0, 160.0, 250.0, 390.0, 240.0, 260.0, 135.0, 130.0, 230.0, 220.0, 300.0, 180.0, 440.0, 270.0, 395.0, 160.0, 310.0, 540.0, 455.0, 410.0, 275.0, 145.0, 510.0, 230.0, 145.0, 780.0, 220.0, 240.0, 120.0, 645.0, 270.0, 620.0, 390.0, 215.0, 280.0, 240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 50.0, 0.0, 170.0, 40.0, 10.0, -30.0, 10.0, 100.0, 0.0, 60.0, 30.0, 0.0, 50.0, 40.0, 30.0, -60.0, 170.0, 30.0, 0.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -10.0, 30.0, 20.0, 40.0, 40.0, 10.0, 10.0, 10.0, 15.0, 30.0, 50.0, 70.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 50.0, 50.0, 0.0, 170.0, 10.0, 10.0, -100.0, 30.0, 40.0, 60.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 30.0, 0.0, 30.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 10.0, 30.0, 20.0, 25.0, 0.0, 30.0, 10.0, 70.0, 50.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 10.0, 60.0, 30.0, 30.0, 20.0, 40.0, 60.0, 180.0, -40.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 30.0, 60.0, 30.0, 0.0, 15.0, 10.0, 0.0, 70.0, -15.0, 170.0, 20.0, 40.0, 10.0, 5.0, 60.0, 10.0, 70.0, 80.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 70.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 50.0, 160.0, 20.0, 0.0, 20.0, 60.0, 30.0, 0.0, 30.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 50.0, 20.0, 20.0, 70.0, 20.0, 0.0, 50.0, 20.0, 40.0, 30.0, 40.0, 30.0, 30.0, 10.0, -30.0, 180.0, 90.0, 10.0, -20.0, 30.0, 250.0, 10.0, 180.0, 10.0, 10.0, 40.0, 160.0, 20.0, 20.0, 10.0, 75.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 50.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 40.0, 10.0, -20.0, 10.0, 40.0, 10.0, 60.0, 20.0, 5.0, 30.0, 250.0, 80.0, 30.0, 20.0, 20.0, 0.0, 30.0, 50.0, 0.0, 10.0, 40.0, 5.0, 40.0, 20.0, 20.0, 10.0, 5.0, 40.0, 20.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 10.0, 30.0, 0.0, 160.0, 30.0, 20.0, 0.0, 0.0, 60.0, 40.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 10.0, 40.0, 30.0, 20.0, 50.0, 110.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 60.0, 30.0, 0.0, 150.0, 10.0, 40.0, 10.0, 50.0, 0.0, 10.0, 50.0, 10.0, 50.0, 20.0, -5.0, 10.0, 150.0, 40.0, 10.0, 30.0, 20.0, 70.0, 70.0, 60.0, 20.0, 70.0, 10.0, 0.0, 30.0, 60.0, -30.0, 0.0, 30.0, 260.0, 30.0, 0.0, 0.0, 30.0, 30.0, 20.0, 70.0, 20.0, 40.0, 20.0, 20.0, 170.0, 0.0, 40.0, 10.0, 50.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 0.0, 10.0, 40.0, 20.0, 30.0, 0.0, 50.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 40.0, 60.0, 10.0, 20.0, 50.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 60.0, 30.0, 10.0, 80.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 40.0, 40.0, 60.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 170.0, 30.0, 10.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 80.0, 50.0, 30.0, 90.0, 70.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, -5.0, 20.0, 0.0, 20.0, 30.0, 40.0, 5.0, 50.0, -20.0, 20.0, 160.0, 0.0, 20.0, 40.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 70.0, 30.0, 20.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 60.0, 20.0, 0.0, 60.0, 20.0, 10.0, 10.0, 90.0, 10.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 30.0, 10.0, 50.0, 10.0, 20.0, 30.0, 30.0, 110.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 40.0, 50.0, 40.0, 20.0, 10.0, 30.0, 40.0, 60.0, 10.0, 30.0, 20.0, 40.0, 70.0, 40.0, 10.0, 90.0, 130.0, 60.0, 380.0, 60.0, 50.0, 40.0, 30.0, -20.0, -90.0, 180.0, 20.0, 460.0, 40.0, 10.0, 0.0, 40.0, 10.0, 20.0, 50.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 30.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 40.0, 0.0, 10.0, 30.0, 70.0, 80.0, 10.0, 50.0, 30.0, 60.0, 50.0, 20.0, 70.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 10.0, 10.0, 30.0, 90.0, 180.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 15.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 50.0, 40.0, 20.0, 0.0, 0.0, 0.0, 0.0, 70.0, 20.0, 40.0, 50.0, 20.0, 40.0, 60.0, 0.0, 20.0, 60.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 180.0, 20.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 60.0, 0.0, 0.0, 40.0, 30.0, 10.0, 100.0, 15.0, 50.0, 0.0, 0.0, 140.0, 0.0, 0.0, 80.0, 10.0, 20.0, 20.0, 10.0, -90.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, 80.0, 30.0, 40.0, 20.0, 0.0, 10.0, 90.0, 0.0, 30.0, 60.0, 30.0, 180.0, 20.0, 0.0, 50.0, 150.0, 20.0, 0.0, 30.0, 70.0, 30.0, 270.0, 0.0, 20.0, 30.0, 0.0, 20.0, -5.0, 20.0, 20.0, 40.0, 160.0, 40.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 10.0, 10.0, 45.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, -5.0, 0.0, 30.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 50.0, 190.0, 0.0, 30.0, 40.0, 40.0, -20.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 5.0, 30.0, 10.0, 40.0, 40.0, 40.0, 370.0, 40.0, 40.0, 10.0, 0.0, 150.0, 70.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 50.0, 0.0, 20.0, 10.0, 20.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 170.0, 30.0, -15.0, 20.0, 160.0, 30.0, 50.0, 160.0, 0.0, 40.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 40.0, 160.0, 50.0, 90.0, 160.0, 50.0, 20.0, 40.0, 20.0, -10.0, 0.0, 20.0, 50.0, 100.0, 50.0, 20.0, 10.0, 0.0, 50.0, 90.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, -5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 80.0, 30.0, 10.0, 80.0, 10.0, 50.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 40.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7109545668544717, "mean_inference_ms": 1.490927920855977, "mean_action_processing_ms": 0.42517390201903943, "mean_env_wait_ms": 1.3659720924012546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013926982879638672, "StateBufferConnector_ms": 0.010178804397583008, "ViewRequirementAgentConnector_ms": 0.4209325313568115}, "num_episodes": 27, "episode_return_max": 900.0, "episode_return_min": 80.0, "episode_return_mean": 297.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.2234527840384, "num_env_steps_trained_throughput_per_sec": 21.2234527840384, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 187429.265, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187429.222, "sample_time_ms": 2590.77, "learn_time_ms": 184817.093, "learn_throughput": 21.643, "synch_weights_time_ms": 12.938}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 15, "trial_id": "90816_00000", "date": "2024-06-10_01-00-40", "timestamp": 1717995640, "time_this_iter_s": 188.4784619808197, "time_total_s": 2919.020236968994, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f29ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2919.020236968994, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.02105263157895, "ram_util_percent": 79.26203007518798}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8505447333359237, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.321259540008406, "policy_loss": -0.011189920053919241, "vf_loss": 4.330604020830668, "vf_explained_var": 0.013120119843366173, "kl": 0.009227192582825202, "entropy": 1.266098134383099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 900.0, "episode_reward_min": 85.0, "episode_reward_mean": 311.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 31.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 150.0, 410.0, 160.0, 310.0, 580.0, 535.0, 120.0, 230.0, 220.0, 485.0, 205.0, 205.0, 340.0, 250.0, 390.0, 200.0, 290.0, 360.0, 345.0, 380.0, 410.0, 410.0, 240.0, 240.0, 320.0, 220.0, 240.0, 240.0, 300.0, 290.0, 370.0, 85.0, 305.0, 140.0, 240.0, 250.0, 270.0, 170.0, 250.0, 330.0, 900.0, 720.0, 270.0, 190.0, 170.0, 460.0, 160.0, 250.0, 390.0, 240.0, 260.0, 135.0, 130.0, 230.0, 220.0, 300.0, 180.0, 440.0, 270.0, 395.0, 160.0, 310.0, 540.0, 455.0, 410.0, 275.0, 145.0, 510.0, 230.0, 145.0, 780.0, 220.0, 240.0, 120.0, 645.0, 270.0, 620.0, 390.0, 215.0, 280.0, 240.0, 380.0, 180.0, 180.0, 370.0, 200.0, 360.0, 300.0, 390.0, 320.0, 330.0, 480.0, 370.0, 360.0, 180.0, 340.0, 420.0, 360.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 70.0, 20.0, 0.0, 0.0, 0.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 50.0, 160.0, 20.0, 0.0, 20.0, 60.0, 30.0, 0.0, 30.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 50.0, 20.0, 20.0, 70.0, 20.0, 0.0, 50.0, 20.0, 40.0, 30.0, 40.0, 30.0, 30.0, 10.0, -30.0, 180.0, 90.0, 10.0, -20.0, 30.0, 250.0, 10.0, 180.0, 10.0, 10.0, 40.0, 160.0, 20.0, 20.0, 10.0, 75.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 50.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 40.0, 10.0, -20.0, 10.0, 40.0, 10.0, 60.0, 20.0, 5.0, 30.0, 250.0, 80.0, 30.0, 20.0, 20.0, 0.0, 30.0, 50.0, 0.0, 10.0, 40.0, 5.0, 40.0, 20.0, 20.0, 10.0, 5.0, 40.0, 20.0, -30.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 10.0, 30.0, 0.0, 160.0, 30.0, 20.0, 0.0, 0.0, 60.0, 40.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 10.0, 40.0, 30.0, 20.0, 50.0, 110.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 30.0, 10.0, 30.0, 10.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 60.0, 30.0, 0.0, 150.0, 10.0, 40.0, 10.0, 50.0, 0.0, 10.0, 50.0, 10.0, 50.0, 20.0, -5.0, 10.0, 150.0, 40.0, 10.0, 30.0, 20.0, 70.0, 70.0, 60.0, 20.0, 70.0, 10.0, 0.0, 30.0, 60.0, -30.0, 0.0, 30.0, 260.0, 30.0, 0.0, 0.0, 30.0, 30.0, 20.0, 70.0, 20.0, 40.0, 20.0, 20.0, 170.0, 0.0, 40.0, 10.0, 50.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 0.0, 10.0, 40.0, 20.0, 30.0, 0.0, 50.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 40.0, 60.0, 10.0, 20.0, 50.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 60.0, 30.0, 10.0, 80.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 40.0, 40.0, 60.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 170.0, 30.0, 10.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 80.0, 50.0, 30.0, 90.0, 70.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, -5.0, 20.0, 0.0, 20.0, 30.0, 40.0, 5.0, 50.0, -20.0, 20.0, 160.0, 0.0, 20.0, 40.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 70.0, 30.0, 20.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 60.0, 20.0, 0.0, 60.0, 20.0, 10.0, 10.0, 90.0, 10.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 30.0, 10.0, 50.0, 10.0, 20.0, 30.0, 30.0, 110.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 40.0, 50.0, 40.0, 20.0, 10.0, 30.0, 40.0, 60.0, 10.0, 30.0, 20.0, 40.0, 70.0, 40.0, 10.0, 90.0, 130.0, 60.0, 380.0, 60.0, 50.0, 40.0, 30.0, -20.0, -90.0, 180.0, 20.0, 460.0, 40.0, 10.0, 0.0, 40.0, 10.0, 20.0, 50.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 30.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 40.0, 0.0, 10.0, 30.0, 70.0, 80.0, 10.0, 50.0, 30.0, 60.0, 50.0, 20.0, 70.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 10.0, 10.0, 30.0, 90.0, 180.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 15.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 50.0, 40.0, 20.0, 0.0, 0.0, 0.0, 0.0, 70.0, 20.0, 40.0, 50.0, 20.0, 40.0, 60.0, 0.0, 20.0, 60.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 180.0, 20.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 60.0, 0.0, 0.0, 40.0, 30.0, 10.0, 100.0, 15.0, 50.0, 0.0, 0.0, 140.0, 0.0, 0.0, 80.0, 10.0, 20.0, 20.0, 10.0, -90.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, 80.0, 30.0, 40.0, 20.0, 0.0, 10.0, 90.0, 0.0, 30.0, 60.0, 30.0, 180.0, 20.0, 0.0, 50.0, 150.0, 20.0, 0.0, 30.0, 70.0, 30.0, 270.0, 0.0, 20.0, 30.0, 0.0, 20.0, -5.0, 20.0, 20.0, 40.0, 160.0, 40.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 10.0, 10.0, 45.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, -5.0, 0.0, 30.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 50.0, 190.0, 0.0, 30.0, 40.0, 40.0, -20.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 5.0, 30.0, 10.0, 40.0, 40.0, 40.0, 370.0, 40.0, 40.0, 10.0, 0.0, 150.0, 70.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 50.0, 0.0, 20.0, 10.0, 20.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 170.0, 30.0, -15.0, 20.0, 160.0, 30.0, 50.0, 160.0, 0.0, 40.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 40.0, 160.0, 50.0, 90.0, 160.0, 50.0, 20.0, 40.0, 20.0, -10.0, 0.0, 20.0, 50.0, 100.0, 50.0, 20.0, 10.0, 0.0, 50.0, 90.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, -5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 80.0, 30.0, 10.0, 80.0, 10.0, 50.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 40.0, 30.0, 50.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 60.0, 90.0, 30.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 60.0, 60.0, 0.0, 10.0, 40.0, 10.0, -20.0, 20.0, 20.0, 170.0, 0.0, 50.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 50.0, 80.0, 40.0, 50.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 160.0, 30.0, 30.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 60.0, 40.0, 60.0, 30.0, 10.0, 60.0, 80.0, 20.0, 90.0, 10.0, 20.0, 70.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 80.0, 10.0, 0.0, 20.0, 20.0, 140.0, 20.0, 120.0, 70.0, 0.0, 0.0, -10.0, 40.0, 160.0, 60.0, 20.0, 10.0, 50.0, 60.0, 10.0, 170.0, 0.0, 0.0, 20.0, 10.0, 40.0, 70.0, 20.0, 10.0, 10.0, 40.0, 50.0, 40.0, 0.0, 90.0, 30.0, 0.0, 60.0, 50.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 10.0, 20.0, 30.0, 20.0, 160.0, 20.0, 90.0, 0.0, 10.0, 50.0, 30.0, 0.0, 40.0, 20.0, 20.0, 40.0, 30.0, 20.0, 40.0, 0.0, 40.0, 100.0, 70.0, 0.0, 0.0, 60.0, 0.0, 170.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.702803026452446, "mean_inference_ms": 1.4901727713706827, "mean_action_processing_ms": 0.4235663028234935, "mean_env_wait_ms": 1.3601724896866298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013681411743164062, "StateBufferConnector_ms": 0.009974479675292969, "ViewRequirementAgentConnector_ms": 0.4163038730621338}, "num_episodes": 18, "episode_return_max": 900.0, "episode_return_min": 85.0, "episode_return_mean": 311.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.27922644527769, "num_env_steps_trained_throughput_per_sec": 21.27922644527769, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 187405.037, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187404.995, "sample_time_ms": 2593.2, "learn_time_ms": 184791.435, "learn_throughput": 21.646, "synch_weights_time_ms": 12.384}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 16, "trial_id": "90816_00000", "date": "2024-06-10_01-03-48", "timestamp": 1717995828, "time_this_iter_s": 187.98407411575317, "time_total_s": 3107.0043110847473, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f6b550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3107.0043110847473, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.0796992481203, "ram_util_percent": 80.0484962406015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0064175849651504, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.681033309402303, "policy_loss": -0.009400460007005392, "vf_loss": 4.688813730804557, "vf_explained_var": 0.008237547488512196, "kl": 0.008100158961785448, "entropy": 1.2438470415286997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 154935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 900.0, "episode_reward_min": 85.0, "episode_reward_mean": 321.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 32.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.0, 345.0, 380.0, 410.0, 410.0, 240.0, 240.0, 320.0, 220.0, 240.0, 240.0, 300.0, 290.0, 370.0, 85.0, 305.0, 140.0, 240.0, 250.0, 270.0, 170.0, 250.0, 330.0, 900.0, 720.0, 270.0, 190.0, 170.0, 460.0, 160.0, 250.0, 390.0, 240.0, 260.0, 135.0, 130.0, 230.0, 220.0, 300.0, 180.0, 440.0, 270.0, 395.0, 160.0, 310.0, 540.0, 455.0, 410.0, 275.0, 145.0, 510.0, 230.0, 145.0, 780.0, 220.0, 240.0, 120.0, 645.0, 270.0, 620.0, 390.0, 215.0, 280.0, 240.0, 380.0, 180.0, 180.0, 370.0, 200.0, 360.0, 300.0, 390.0, 320.0, 330.0, 480.0, 370.0, 360.0, 180.0, 340.0, 420.0, 360.0, 420.0, 290.0, 310.0, 290.0, 300.0, 220.0, 400.0, 350.0, 520.0, 530.0, 340.0, 180.0, 580.0, 210.0, 505.0, 120.0, 320.0, 500.0, 355.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 60.0, 30.0, 0.0, 150.0, 10.0, 40.0, 10.0, 50.0, 0.0, 10.0, 50.0, 10.0, 50.0, 20.0, -5.0, 10.0, 150.0, 40.0, 10.0, 30.0, 20.0, 70.0, 70.0, 60.0, 20.0, 70.0, 10.0, 0.0, 30.0, 60.0, -30.0, 0.0, 30.0, 260.0, 30.0, 0.0, 0.0, 30.0, 30.0, 20.0, 70.0, 20.0, 40.0, 20.0, 20.0, 170.0, 0.0, 40.0, 10.0, 50.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 40.0, 10.0, 60.0, 0.0, 10.0, 40.0, 20.0, 30.0, 0.0, 50.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 40.0, 60.0, 10.0, 20.0, 50.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 60.0, 30.0, 10.0, 80.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 40.0, 40.0, 60.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 170.0, 30.0, 10.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 80.0, 50.0, 30.0, 90.0, 70.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, -5.0, 20.0, 0.0, 20.0, 30.0, 40.0, 5.0, 50.0, -20.0, 20.0, 160.0, 0.0, 20.0, 40.0, 20.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 70.0, 30.0, 20.0, 20.0, 10.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 60.0, 20.0, 0.0, 60.0, 20.0, 10.0, 10.0, 90.0, 10.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 30.0, 10.0, 50.0, 10.0, 20.0, 30.0, 30.0, 110.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 40.0, 50.0, 40.0, 20.0, 10.0, 30.0, 40.0, 60.0, 10.0, 30.0, 20.0, 40.0, 70.0, 40.0, 10.0, 90.0, 130.0, 60.0, 380.0, 60.0, 50.0, 40.0, 30.0, -20.0, -90.0, 180.0, 20.0, 460.0, 40.0, 10.0, 0.0, 40.0, 10.0, 20.0, 50.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 30.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 40.0, 0.0, 10.0, 30.0, 70.0, 80.0, 10.0, 50.0, 30.0, 60.0, 50.0, 20.0, 70.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 10.0, 10.0, 30.0, 90.0, 180.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 15.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 50.0, 40.0, 20.0, 0.0, 0.0, 0.0, 0.0, 70.0, 20.0, 40.0, 50.0, 20.0, 40.0, 60.0, 0.0, 20.0, 60.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 180.0, 20.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 60.0, 0.0, 0.0, 40.0, 30.0, 10.0, 100.0, 15.0, 50.0, 0.0, 0.0, 140.0, 0.0, 0.0, 80.0, 10.0, 20.0, 20.0, 10.0, -90.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, 80.0, 30.0, 40.0, 20.0, 0.0, 10.0, 90.0, 0.0, 30.0, 60.0, 30.0, 180.0, 20.0, 0.0, 50.0, 150.0, 20.0, 0.0, 30.0, 70.0, 30.0, 270.0, 0.0, 20.0, 30.0, 0.0, 20.0, -5.0, 20.0, 20.0, 40.0, 160.0, 40.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 10.0, 10.0, 45.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, -5.0, 0.0, 30.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 50.0, 190.0, 0.0, 30.0, 40.0, 40.0, -20.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 5.0, 30.0, 10.0, 40.0, 40.0, 40.0, 370.0, 40.0, 40.0, 10.0, 0.0, 150.0, 70.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 50.0, 0.0, 20.0, 10.0, 20.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 170.0, 30.0, -15.0, 20.0, 160.0, 30.0, 50.0, 160.0, 0.0, 40.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 40.0, 160.0, 50.0, 90.0, 160.0, 50.0, 20.0, 40.0, 20.0, -10.0, 0.0, 20.0, 50.0, 100.0, 50.0, 20.0, 10.0, 0.0, 50.0, 90.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, -5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 80.0, 30.0, 10.0, 80.0, 10.0, 50.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 40.0, 30.0, 50.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 60.0, 90.0, 30.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 60.0, 60.0, 0.0, 10.0, 40.0, 10.0, -20.0, 20.0, 20.0, 170.0, 0.0, 50.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 50.0, 80.0, 40.0, 50.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 160.0, 30.0, 30.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 60.0, 40.0, 60.0, 30.0, 10.0, 60.0, 80.0, 20.0, 90.0, 10.0, 20.0, 70.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 80.0, 10.0, 0.0, 20.0, 20.0, 140.0, 20.0, 120.0, 70.0, 0.0, 0.0, -10.0, 40.0, 160.0, 60.0, 20.0, 10.0, 50.0, 60.0, 10.0, 170.0, 0.0, 0.0, 20.0, 10.0, 40.0, 70.0, 20.0, 10.0, 10.0, 40.0, 50.0, 40.0, 0.0, 90.0, 30.0, 0.0, 60.0, 50.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 10.0, 20.0, 30.0, 20.0, 160.0, 20.0, 90.0, 0.0, 10.0, 50.0, 30.0, 0.0, 40.0, 20.0, 20.0, 40.0, 30.0, 20.0, 40.0, 0.0, 40.0, 100.0, 70.0, 0.0, 0.0, 60.0, 0.0, 170.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 0.0, 50.0, 20.0, 80.0, 40.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 150.0, -40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 20.0, -40.0, 180.0, 40.0, 40.0, 60.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 0.0, 10.0, 15.0, 20.0, 170.0, 15.0, 50.0, 40.0, 80.0, 0.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 20.0, 40.0, 170.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 90.0, 190.0, 20.0, 20.0, 30.0, -10.0, 450.0, -30.0, 10.0, -10.0, 10.0, 10.0, 30.0, 40.0, 80.0, 60.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 30.0, 170.0, 0.0, 50.0, -30.0, 200.0, 60.0, 20.0, 50.0, 20.0, 40.0, 10.0, 0.0, 70.0, 50.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 40.0, 80.0, 50.0, 85.0, 40.0, 70.0, 20.0, 60.0, 60.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 30.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 50.0, 150.0, 30.0, 40.0, 60.0, 70.0, 50.0, 20.0, 30.0, 0.0, 20.0, 45.0, 30.0, 20.0, 30.0, 160.0, 20.0, 0.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6954507711101061, "mean_inference_ms": 1.4894034150894715, "mean_action_processing_ms": 0.4224358718326647, "mean_env_wait_ms": 1.355701046268881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013676881790161133, "StateBufferConnector_ms": 0.009977340698242188, "ViewRequirementAgentConnector_ms": 0.40582871437072754}, "num_episodes": 18, "episode_return_max": 900.0, "episode_return_min": 85.0, "episode_return_mean": 321.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.386302252949164, "num_env_steps_trained_throughput_per_sec": 21.386302252949164, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 187596.016, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187595.972, "sample_time_ms": 2654.369, "learn_time_ms": 184921.113, "learn_throughput": 21.631, "synch_weights_time_ms": 12.268}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 17, "trial_id": "90816_00000", "date": "2024-06-10_01-06-55", "timestamp": 1717996015, "time_this_iter_s": 187.04312896728516, "time_total_s": 3294.0474400520325, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f568b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3294.0474400520325, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.546792452830186, "ram_util_percent": 78.51169811320754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4818715766595956, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.008976127875372, "policy_loss": -0.009929147767621124, "vf_loss": 5.017214093116906, "vf_explained_var": -0.03313695846782071, "kl": 0.008455905426186195, "entropy": 1.2227801219342997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 164325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 900.0, "episode_reward_min": 120.0, "episode_reward_mean": 352.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 35.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 270.0, 170.0, 250.0, 330.0, 900.0, 720.0, 270.0, 190.0, 170.0, 460.0, 160.0, 250.0, 390.0, 240.0, 260.0, 135.0, 130.0, 230.0, 220.0, 300.0, 180.0, 440.0, 270.0, 395.0, 160.0, 310.0, 540.0, 455.0, 410.0, 275.0, 145.0, 510.0, 230.0, 145.0, 780.0, 220.0, 240.0, 120.0, 645.0, 270.0, 620.0, 390.0, 215.0, 280.0, 240.0, 380.0, 180.0, 180.0, 370.0, 200.0, 360.0, 300.0, 390.0, 320.0, 330.0, 480.0, 370.0, 360.0, 180.0, 340.0, 420.0, 360.0, 420.0, 290.0, 310.0, 290.0, 300.0, 220.0, 400.0, 350.0, 520.0, 530.0, 340.0, 180.0, 580.0, 210.0, 505.0, 120.0, 320.0, 500.0, 355.0, 680.0, 240.0, 400.0, 400.0, 360.0, 650.0, 340.0, 300.0, 605.0, 770.0, 490.0, 260.0, 570.0, 410.0, 725.0, 270.0, 450.0, 280.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 30.0, 20.0, 60.0, 20.0, 0.0, 60.0, 20.0, 10.0, 10.0, 90.0, 10.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 30.0, 10.0, 50.0, 10.0, 20.0, 30.0, 30.0, 110.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 40.0, 50.0, 40.0, 20.0, 10.0, 30.0, 40.0, 60.0, 10.0, 30.0, 20.0, 40.0, 70.0, 40.0, 10.0, 90.0, 130.0, 60.0, 380.0, 60.0, 50.0, 40.0, 30.0, -20.0, -90.0, 180.0, 20.0, 460.0, 40.0, 10.0, 0.0, 40.0, 10.0, 20.0, 50.0, 20.0, 20.0, 50.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 30.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 40.0, 0.0, 10.0, 30.0, 70.0, 80.0, 10.0, 50.0, 30.0, 60.0, 50.0, 20.0, 70.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 10.0, 10.0, 30.0, 90.0, 180.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 30.0, 15.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 50.0, 40.0, 20.0, 0.0, 0.0, 0.0, 0.0, 70.0, 20.0, 40.0, 50.0, 20.0, 40.0, 60.0, 0.0, 20.0, 60.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 20.0, 30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 180.0, 20.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 60.0, 0.0, 0.0, 40.0, 30.0, 10.0, 100.0, 15.0, 50.0, 0.0, 0.0, 140.0, 0.0, 0.0, 80.0, 10.0, 20.0, 20.0, 10.0, -90.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, 80.0, 30.0, 40.0, 20.0, 0.0, 10.0, 90.0, 0.0, 30.0, 60.0, 30.0, 180.0, 20.0, 0.0, 50.0, 150.0, 20.0, 0.0, 30.0, 70.0, 30.0, 270.0, 0.0, 20.0, 30.0, 0.0, 20.0, -5.0, 20.0, 20.0, 40.0, 160.0, 40.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 10.0, 10.0, 45.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, -5.0, 0.0, 30.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 50.0, 190.0, 0.0, 30.0, 40.0, 40.0, -20.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 5.0, 30.0, 10.0, 40.0, 40.0, 40.0, 370.0, 40.0, 40.0, 10.0, 0.0, 150.0, 70.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 50.0, 0.0, 20.0, 10.0, 20.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 170.0, 30.0, -15.0, 20.0, 160.0, 30.0, 50.0, 160.0, 0.0, 40.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 40.0, 160.0, 50.0, 90.0, 160.0, 50.0, 20.0, 40.0, 20.0, -10.0, 0.0, 20.0, 50.0, 100.0, 50.0, 20.0, 10.0, 0.0, 50.0, 90.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, -5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 80.0, 30.0, 10.0, 80.0, 10.0, 50.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 40.0, 30.0, 50.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 60.0, 90.0, 30.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 60.0, 60.0, 0.0, 10.0, 40.0, 10.0, -20.0, 20.0, 20.0, 170.0, 0.0, 50.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 50.0, 80.0, 40.0, 50.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 160.0, 30.0, 30.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 60.0, 40.0, 60.0, 30.0, 10.0, 60.0, 80.0, 20.0, 90.0, 10.0, 20.0, 70.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 80.0, 10.0, 0.0, 20.0, 20.0, 140.0, 20.0, 120.0, 70.0, 0.0, 0.0, -10.0, 40.0, 160.0, 60.0, 20.0, 10.0, 50.0, 60.0, 10.0, 170.0, 0.0, 0.0, 20.0, 10.0, 40.0, 70.0, 20.0, 10.0, 10.0, 40.0, 50.0, 40.0, 0.0, 90.0, 30.0, 0.0, 60.0, 50.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 10.0, 20.0, 30.0, 20.0, 160.0, 20.0, 90.0, 0.0, 10.0, 50.0, 30.0, 0.0, 40.0, 20.0, 20.0, 40.0, 30.0, 20.0, 40.0, 0.0, 40.0, 100.0, 70.0, 0.0, 0.0, 60.0, 0.0, 170.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 0.0, 50.0, 20.0, 80.0, 40.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 150.0, -40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 20.0, -40.0, 180.0, 40.0, 40.0, 60.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 0.0, 10.0, 15.0, 20.0, 170.0, 15.0, 50.0, 40.0, 80.0, 0.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 20.0, 40.0, 170.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 90.0, 190.0, 20.0, 20.0, 30.0, -10.0, 450.0, -30.0, 10.0, -10.0, 10.0, 10.0, 30.0, 40.0, 80.0, 60.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 30.0, 170.0, 0.0, 50.0, -30.0, 200.0, 60.0, 20.0, 50.0, 20.0, 40.0, 10.0, 0.0, 70.0, 50.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 40.0, 80.0, 50.0, 85.0, 40.0, 70.0, 20.0, 60.0, 60.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 30.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 50.0, 150.0, 30.0, 40.0, 60.0, 70.0, 50.0, 20.0, 30.0, 0.0, 20.0, 45.0, 30.0, 20.0, 30.0, 160.0, 20.0, 0.0, 10.0, 20.0, 30.0, 40.0, 30.0, 70.0, 10.0, 90.0, 20.0, 170.0, 190.0, 30.0, 50.0, 10.0, 10.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 70.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 200.0, 40.0, 40.0, 10.0, 20.0, 10.0, 30.0, 70.0, -20.0, 20.0, 40.0, 10.0, 210.0, 30.0, 20.0, 20.0, 50.0, 0.0, 60.0, 30.0, 30.0, 90.0, 30.0, 0.0, 60.0, 30.0, 20.0, 30.0, 20.0, 80.0, 10.0, 40.0, 360.0, 10.0, 20.0, 10.0, 150.0, 40.0, 0.0, 0.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 100.0, 20.0, 30.0, 40.0, 20.0, 50.0, 50.0, 80.0, 100.0, 10.0, 65.0, 40.0, 150.0, 40.0, 180.0, 30.0, 30.0, 20.0, 350.0, 0.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 60.0, 0.0, 0.0, 50.0, 160.0, 70.0, 30.0, 70.0, 0.0, 20.0, 30.0, 60.0, 20.0, 20.0, 40.0, 30.0, 40.0, 0.0, 40.0, 50.0, 50.0, 240.0, 70.0, 50.0, -30.0, 40.0, 10.0, 50.0, 50.0, 70.0, 70.0, 40.0, 30.0, 40.0, 60.0, 0.0, 50.0, 0.0, 160.0, 70.0, 50.0, 30.0, 40.0, 155.0, 60.0, 120.0, 40.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 0.0, 10.0, 30.0, 70.0, 0.0, 20.0, 180.0, 50.0, 30.0, 10.0, 20.0, 60.0, 10.0, 0.0, 10.0, 80.0, 30.0, 60.0, 10.0, 30.0, 20.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6858892667052916, "mean_inference_ms": 1.4814901980173212, "mean_action_processing_ms": 0.42017063967112395, "mean_env_wait_ms": 1.3475333608713986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01239156723022461, "StateBufferConnector_ms": 0.009840250015258789, "ViewRequirementAgentConnector_ms": 0.38069891929626465}, "num_episodes": 18, "episode_return_max": 900.0, "episode_return_min": 120.0, "episode_return_mean": 352.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.42057931103009, "num_env_steps_trained_throughput_per_sec": 21.42057931103009, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 187495.49, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187495.445, "sample_time_ms": 2659.659, "learn_time_ms": 184815.46, "learn_throughput": 21.643, "synch_weights_time_ms": 12.175}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 18, "trial_id": "90816_00000", "date": "2024-06-10_01-10-01", "timestamp": 1717996201, "time_this_iter_s": 186.74463391304016, "time_total_s": 3480.7920739650726, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f6b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3480.7920739650726, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.525000000000002, "ram_util_percent": 78.73143939393938}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0587292400729287, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.816949722942072, "policy_loss": -0.011443963067390865, "vf_loss": 4.826814734999237, "vf_explained_var": -0.007952360839000779, "kl": 0.007894755548229104, "entropy": 1.201509436301657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 173715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 1030.0, "episode_reward_min": -15.0, "episode_reward_mean": 370.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -220.0}, "policy_reward_max": {"policy_0": 450.0}, "policy_reward_mean": {"policy_0": 37.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [440.0, 270.0, 395.0, 160.0, 310.0, 540.0, 455.0, 410.0, 275.0, 145.0, 510.0, 230.0, 145.0, 780.0, 220.0, 240.0, 120.0, 645.0, 270.0, 620.0, 390.0, 215.0, 280.0, 240.0, 380.0, 180.0, 180.0, 370.0, 200.0, 360.0, 300.0, 390.0, 320.0, 330.0, 480.0, 370.0, 360.0, 180.0, 340.0, 420.0, 360.0, 420.0, 290.0, 310.0, 290.0, 300.0, 220.0, 400.0, 350.0, 520.0, 530.0, 340.0, 180.0, 580.0, 210.0, 505.0, 120.0, 320.0, 500.0, 355.0, 680.0, 240.0, 400.0, 400.0, 360.0, 650.0, 340.0, 300.0, 605.0, 770.0, 490.0, 260.0, 570.0, 410.0, 725.0, 270.0, 450.0, 280.0, 430.0, 200.0, 445.0, 240.0, 250.0, 320.0, 435.0, 490.0, 550.0, -15.0, 510.0, 430.0, 320.0, 320.0, 1030.0, 240.0, 230.0, 430.0, 380.0, 540.0, 180.0, 375.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 180.0, 20.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 60.0, 0.0, 0.0, 40.0, 30.0, 10.0, 100.0, 15.0, 50.0, 0.0, 0.0, 140.0, 0.0, 0.0, 80.0, 10.0, 20.0, 20.0, 10.0, -90.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, 80.0, 30.0, 40.0, 20.0, 0.0, 10.0, 90.0, 0.0, 30.0, 60.0, 30.0, 180.0, 20.0, 0.0, 50.0, 150.0, 20.0, 0.0, 30.0, 70.0, 30.0, 270.0, 0.0, 20.0, 30.0, 0.0, 20.0, -5.0, 20.0, 20.0, 40.0, 160.0, 40.0, 70.0, 10.0, 40.0, 10.0, 0.0, 20.0, 30.0, 10.0, 10.0, 45.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, -5.0, 0.0, 30.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 50.0, 190.0, 0.0, 30.0, 40.0, 40.0, -20.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 20.0, 20.0, 40.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 5.0, 30.0, 10.0, 40.0, 40.0, 40.0, 370.0, 40.0, 40.0, 10.0, 0.0, 150.0, 70.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 50.0, 0.0, 20.0, 10.0, 20.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 170.0, 30.0, -15.0, 20.0, 160.0, 30.0, 50.0, 160.0, 0.0, 40.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 20.0, 10.0, 40.0, 30.0, 40.0, 160.0, 50.0, 90.0, 160.0, 50.0, 20.0, 40.0, 20.0, -10.0, 0.0, 20.0, 50.0, 100.0, 50.0, 20.0, 10.0, 0.0, 50.0, 90.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, -5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 80.0, 30.0, 10.0, 80.0, 10.0, 50.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 40.0, 30.0, 50.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 60.0, 90.0, 30.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 60.0, 60.0, 0.0, 10.0, 40.0, 10.0, -20.0, 20.0, 20.0, 170.0, 0.0, 50.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 50.0, 80.0, 40.0, 50.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 160.0, 30.0, 30.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 60.0, 40.0, 60.0, 30.0, 10.0, 60.0, 80.0, 20.0, 90.0, 10.0, 20.0, 70.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 80.0, 10.0, 0.0, 20.0, 20.0, 140.0, 20.0, 120.0, 70.0, 0.0, 0.0, -10.0, 40.0, 160.0, 60.0, 20.0, 10.0, 50.0, 60.0, 10.0, 170.0, 0.0, 0.0, 20.0, 10.0, 40.0, 70.0, 20.0, 10.0, 10.0, 40.0, 50.0, 40.0, 0.0, 90.0, 30.0, 0.0, 60.0, 50.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 10.0, 20.0, 30.0, 20.0, 160.0, 20.0, 90.0, 0.0, 10.0, 50.0, 30.0, 0.0, 40.0, 20.0, 20.0, 40.0, 30.0, 20.0, 40.0, 0.0, 40.0, 100.0, 70.0, 0.0, 0.0, 60.0, 0.0, 170.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 0.0, 50.0, 20.0, 80.0, 40.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 150.0, -40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 20.0, -40.0, 180.0, 40.0, 40.0, 60.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 0.0, 10.0, 15.0, 20.0, 170.0, 15.0, 50.0, 40.0, 80.0, 0.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 20.0, 40.0, 170.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 90.0, 190.0, 20.0, 20.0, 30.0, -10.0, 450.0, -30.0, 10.0, -10.0, 10.0, 10.0, 30.0, 40.0, 80.0, 60.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 30.0, 170.0, 0.0, 50.0, -30.0, 200.0, 60.0, 20.0, 50.0, 20.0, 40.0, 10.0, 0.0, 70.0, 50.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 40.0, 80.0, 50.0, 85.0, 40.0, 70.0, 20.0, 60.0, 60.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 30.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 50.0, 150.0, 30.0, 40.0, 60.0, 70.0, 50.0, 20.0, 30.0, 0.0, 20.0, 45.0, 30.0, 20.0, 30.0, 160.0, 20.0, 0.0, 10.0, 20.0, 30.0, 40.0, 30.0, 70.0, 10.0, 90.0, 20.0, 170.0, 190.0, 30.0, 50.0, 10.0, 10.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 70.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 200.0, 40.0, 40.0, 10.0, 20.0, 10.0, 30.0, 70.0, -20.0, 20.0, 40.0, 10.0, 210.0, 30.0, 20.0, 20.0, 50.0, 0.0, 60.0, 30.0, 30.0, 90.0, 30.0, 0.0, 60.0, 30.0, 20.0, 30.0, 20.0, 80.0, 10.0, 40.0, 360.0, 10.0, 20.0, 10.0, 150.0, 40.0, 0.0, 0.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 100.0, 20.0, 30.0, 40.0, 20.0, 50.0, 50.0, 80.0, 100.0, 10.0, 65.0, 40.0, 150.0, 40.0, 180.0, 30.0, 30.0, 20.0, 350.0, 0.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 60.0, 0.0, 0.0, 50.0, 160.0, 70.0, 30.0, 70.0, 0.0, 20.0, 30.0, 60.0, 20.0, 20.0, 40.0, 30.0, 40.0, 0.0, 40.0, 50.0, 50.0, 240.0, 70.0, 50.0, -30.0, 40.0, 10.0, 50.0, 50.0, 70.0, 70.0, 40.0, 30.0, 40.0, 60.0, 0.0, 50.0, 0.0, 160.0, 70.0, 50.0, 30.0, 40.0, 155.0, 60.0, 120.0, 40.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 0.0, 10.0, 30.0, 70.0, 0.0, 20.0, 180.0, 50.0, 30.0, 10.0, 20.0, 60.0, 10.0, 0.0, 10.0, 80.0, 30.0, 60.0, 10.0, 30.0, 20.0, 20.0, 20.0, 10.0, 80.0, 50.0, 100.0, 50.0, 5.0, 45.0, 10.0, 60.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 65.0, 60.0, 70.0, 30.0, 50.0, 70.0, 20.0, 50.0, 80.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 10.0, 40.0, 10.0, 10.0, 30.0, 20.0, 50.0, 20.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 160.0, 0.0, 40.0, 50.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 20.0, 30.0, 100.0, 30.0, 20.0, 60.0, 40.0, 40.0, 140.0, 30.0, 150.0, 20.0, 20.0, 50.0, 10.0, 20.0, 100.0, 130.0, 20.0, 40.0, 30.0, 40.0, 0.0, -15.0, 0.0, -220.0, 40.0, 30.0, 40.0, 40.0, 90.0, 40.0, 10.0, 80.0, 10.0, 20.0, 180.0, 20.0, 20.0, 20.0, 50.0, 70.0, 30.0, 160.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 80.0, 0.0, 30.0, 70.0, 40.0, 40.0, 0.0, 40.0, 0.0, 20.0, 170.0, 50.0, 0.0, 110.0, 50.0, 70.0, 160.0, 180.0, -10.0, 250.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 80.0, 30.0, 20.0, 0.0, 60.0, 30.0, 10.0, 0.0, 80.0, 0.0, 20.0, 10.0, 10.0, 160.0, 50.0, -160.0, 10.0, 30.0, 110.0, 40.0, 160.0, 20.0, 0.0, 20.0, 120.0, 20.0, 50.0, 0.0, 80.0, 50.0, 20.0, 20.0, 60.0, 50.0, 0.0, 70.0, 50.0, 60.0, 90.0, 50.0, 40.0, 70.0, 20.0, 50.0, 10.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 40.0, 40.0, 15.0, 100.0, 30.0, 0.0, 50.0, 50.0, 20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6754990589405088, "mean_inference_ms": 1.4723514126239536, "mean_action_processing_ms": 0.41735828230189037, "mean_env_wait_ms": 1.3375662335805112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012028932571411133, "StateBufferConnector_ms": 0.009727239608764648, "ViewRequirementAgentConnector_ms": 0.37041330337524414}, "num_episodes": 22, "episode_return_max": 1030.0, "episode_return_min": -15.0, "episode_return_mean": 370.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.396427426467806, "num_env_steps_trained_throughput_per_sec": 21.396427426467806, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 187658.74, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187658.694, "sample_time_ms": 2649.659, "learn_time_ms": 184988.432, "learn_throughput": 21.623, "synch_weights_time_ms": 12.529}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 19, "trial_id": "90816_00000", "date": "2024-06-10_01-13-08", "timestamp": 1717996388, "time_this_iter_s": 186.9568612575531, "time_total_s": 3667.7489352226257, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f56280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3667.7489352226257, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.02159090909091, "ram_util_percent": 79.52234848484848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9968259270643145, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.222293848554674, "policy_loss": -0.011532237958505203, "vf_loss": 4.231917323243504, "vf_explained_var": 0.016946912433900518, "kl": 0.009543812630185463, "entropy": 1.1770723872672255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 183105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 1030.0, "episode_reward_min": -15.0, "episode_reward_mean": 371.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -220.0}, "policy_reward_max": {"policy_0": 450.0}, "policy_reward_mean": {"policy_0": 37.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [240.0, 380.0, 180.0, 180.0, 370.0, 200.0, 360.0, 300.0, 390.0, 320.0, 330.0, 480.0, 370.0, 360.0, 180.0, 340.0, 420.0, 360.0, 420.0, 290.0, 310.0, 290.0, 300.0, 220.0, 400.0, 350.0, 520.0, 530.0, 340.0, 180.0, 580.0, 210.0, 505.0, 120.0, 320.0, 500.0, 355.0, 680.0, 240.0, 400.0, 400.0, 360.0, 650.0, 340.0, 300.0, 605.0, 770.0, 490.0, 260.0, 570.0, 410.0, 725.0, 270.0, 450.0, 280.0, 430.0, 200.0, 445.0, 240.0, 250.0, 320.0, 435.0, 490.0, 550.0, -15.0, 510.0, 430.0, 320.0, 320.0, 1030.0, 240.0, 230.0, 430.0, 380.0, 540.0, 180.0, 375.0, 380.0, 95.0, 310.0, 480.0, 260.0, 260.0, 620.0, 475.0, 370.0, 265.0, 180.0, 400.0, 130.0, 435.0, 580.0, 595.0, 240.0, 600.0, 340.0, 315.0, 335.0, 320.0, 170.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 50.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 40.0, 30.0, 50.0, 0.0, 70.0, 40.0, 0.0, 0.0, 40.0, 60.0, 90.0, 30.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 10.0, 0.0, 50.0, 10.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 60.0, 60.0, 0.0, 10.0, 40.0, 10.0, -20.0, 20.0, 20.0, 170.0, 0.0, 50.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 50.0, 80.0, 40.0, 50.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 160.0, 30.0, 30.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 60.0, 40.0, 60.0, 30.0, 10.0, 60.0, 80.0, 20.0, 90.0, 10.0, 20.0, 70.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, 20.0, 80.0, 10.0, 0.0, 20.0, 20.0, 140.0, 20.0, 120.0, 70.0, 0.0, 0.0, -10.0, 40.0, 160.0, 60.0, 20.0, 10.0, 50.0, 60.0, 10.0, 170.0, 0.0, 0.0, 20.0, 10.0, 40.0, 70.0, 20.0, 10.0, 10.0, 40.0, 50.0, 40.0, 0.0, 90.0, 30.0, 0.0, 60.0, 50.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 120.0, 20.0, 30.0, 40.0, 30.0, 20.0, 10.0, 20.0, 30.0, 20.0, 160.0, 20.0, 90.0, 0.0, 10.0, 50.0, 30.0, 0.0, 40.0, 20.0, 20.0, 40.0, 30.0, 20.0, 40.0, 0.0, 40.0, 100.0, 70.0, 0.0, 0.0, 60.0, 0.0, 170.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 0.0, 50.0, 20.0, 80.0, 40.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 150.0, -40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 20.0, -40.0, 180.0, 40.0, 40.0, 60.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 0.0, 10.0, 15.0, 20.0, 170.0, 15.0, 50.0, 40.0, 80.0, 0.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 20.0, 40.0, 170.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 90.0, 190.0, 20.0, 20.0, 30.0, -10.0, 450.0, -30.0, 10.0, -10.0, 10.0, 10.0, 30.0, 40.0, 80.0, 60.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 30.0, 170.0, 0.0, 50.0, -30.0, 200.0, 60.0, 20.0, 50.0, 20.0, 40.0, 10.0, 0.0, 70.0, 50.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 40.0, 80.0, 50.0, 85.0, 40.0, 70.0, 20.0, 60.0, 60.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 30.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 50.0, 150.0, 30.0, 40.0, 60.0, 70.0, 50.0, 20.0, 30.0, 0.0, 20.0, 45.0, 30.0, 20.0, 30.0, 160.0, 20.0, 0.0, 10.0, 20.0, 30.0, 40.0, 30.0, 70.0, 10.0, 90.0, 20.0, 170.0, 190.0, 30.0, 50.0, 10.0, 10.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 70.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 200.0, 40.0, 40.0, 10.0, 20.0, 10.0, 30.0, 70.0, -20.0, 20.0, 40.0, 10.0, 210.0, 30.0, 20.0, 20.0, 50.0, 0.0, 60.0, 30.0, 30.0, 90.0, 30.0, 0.0, 60.0, 30.0, 20.0, 30.0, 20.0, 80.0, 10.0, 40.0, 360.0, 10.0, 20.0, 10.0, 150.0, 40.0, 0.0, 0.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 100.0, 20.0, 30.0, 40.0, 20.0, 50.0, 50.0, 80.0, 100.0, 10.0, 65.0, 40.0, 150.0, 40.0, 180.0, 30.0, 30.0, 20.0, 350.0, 0.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 60.0, 0.0, 0.0, 50.0, 160.0, 70.0, 30.0, 70.0, 0.0, 20.0, 30.0, 60.0, 20.0, 20.0, 40.0, 30.0, 40.0, 0.0, 40.0, 50.0, 50.0, 240.0, 70.0, 50.0, -30.0, 40.0, 10.0, 50.0, 50.0, 70.0, 70.0, 40.0, 30.0, 40.0, 60.0, 0.0, 50.0, 0.0, 160.0, 70.0, 50.0, 30.0, 40.0, 155.0, 60.0, 120.0, 40.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 0.0, 10.0, 30.0, 70.0, 0.0, 20.0, 180.0, 50.0, 30.0, 10.0, 20.0, 60.0, 10.0, 0.0, 10.0, 80.0, 30.0, 60.0, 10.0, 30.0, 20.0, 20.0, 20.0, 10.0, 80.0, 50.0, 100.0, 50.0, 5.0, 45.0, 10.0, 60.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 65.0, 60.0, 70.0, 30.0, 50.0, 70.0, 20.0, 50.0, 80.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 10.0, 40.0, 10.0, 10.0, 30.0, 20.0, 50.0, 20.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 160.0, 0.0, 40.0, 50.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 20.0, 30.0, 100.0, 30.0, 20.0, 60.0, 40.0, 40.0, 140.0, 30.0, 150.0, 20.0, 20.0, 50.0, 10.0, 20.0, 100.0, 130.0, 20.0, 40.0, 30.0, 40.0, 0.0, -15.0, 0.0, -220.0, 40.0, 30.0, 40.0, 40.0, 90.0, 40.0, 10.0, 80.0, 10.0, 20.0, 180.0, 20.0, 20.0, 20.0, 50.0, 70.0, 30.0, 160.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 80.0, 0.0, 30.0, 70.0, 40.0, 40.0, 0.0, 40.0, 0.0, 20.0, 170.0, 50.0, 0.0, 110.0, 50.0, 70.0, 160.0, 180.0, -10.0, 250.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 80.0, 30.0, 20.0, 0.0, 60.0, 30.0, 10.0, 0.0, 80.0, 0.0, 20.0, 10.0, 10.0, 160.0, 50.0, -160.0, 10.0, 30.0, 110.0, 40.0, 160.0, 20.0, 0.0, 20.0, 120.0, 20.0, 50.0, 0.0, 80.0, 50.0, 20.0, 20.0, 60.0, 50.0, 0.0, 70.0, 50.0, 60.0, 90.0, 50.0, 40.0, 70.0, 20.0, 50.0, 10.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 40.0, 40.0, 15.0, 100.0, 30.0, 0.0, 50.0, 50.0, 20.0, 30.0, 40.0, 80.0, 110.0, 10.0, 40.0, 10.0, 30.0, 10.0, 20.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, -15.0, 30.0, 20.0, 60.0, 30.0, 40.0, 20.0, 30.0, 80.0, 10.0, 20.0, 20.0, 0.0, 20.0, 70.0, 130.0, 0.0, 30.0, 30.0, 80.0, 50.0, 20.0, 50.0, 60.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 110.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 60.0, 0.0, 60.0, 0.0, 120.0, 30.0, 10.0, 40.0, 40.0, 20.0, 20.0, 40.0, 260.0, 40.0, 0.0, 0.0, 95.0, 40.0, 40.0, 20.0, 70.0, 30.0, 180.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 110.0, 20.0, 0.0, 20.0, 70.0, 60.0, 5.0, 30.0, 20.0, 0.0, 70.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 20.0, 40.0, 210.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, -10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 40.0, 160.0, 20.0, 20.0, 30.0, 0.0, 20.0, 50.0, 60.0, 35.0, 20.0, 15.0, 30.0, 35.0, 40.0, 30.0, 40.0, -20.0, 10.0, 380.0, 40.0, 40.0, 35.0, 250.0, 150.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 80.0, 40.0, 0.0, 20.0, 80.0, 40.0, 20.0, 80.0, 10.0, 210.0, 50.0, 30.0, 60.0, 30.0, 0.0, 50.0, 50.0, 30.0, 80.0, 10.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 65.0, 10.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 110.0, 25.0, 10.0, 70.0, 50.0, 20.0, 20.0, 0.0, 10.0, 30.0, -40.0, 40.0, 170.0, 10.0, 10.0, 40.0, 40.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 40.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.663585445063363, "mean_inference_ms": 1.4626252107782205, "mean_action_processing_ms": 0.4152990389720312, "mean_env_wait_ms": 1.3299992411659936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012264728546142578, "StateBufferConnector_ms": 0.009413480758666992, "ViewRequirementAgentConnector_ms": 0.36857056617736816}, "num_episodes": 23, "episode_return_max": 1030.0, "episode_return_min": -15.0, "episode_return_mean": 371.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.473017876862926, "num_env_steps_trained_throughput_per_sec": 21.473017876862926, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 187519.702, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187519.656, "sample_time_ms": 2665.677, "learn_time_ms": 184833.124, "learn_throughput": 21.641, "synch_weights_time_ms": 12.707}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 20, "trial_id": "90816_00000", "date": "2024-06-10_01-16-15", "timestamp": 1717996575, "time_this_iter_s": 186.28913688659668, "time_total_s": 3854.0380721092224, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f69d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3854.0380721092224, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.296969696969697, "ram_util_percent": 79.21098484848484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0943179093229887, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.378040107751426, "policy_loss": -0.010707864191986152, "vf_loss": 4.387114530604995, "vf_explained_var": 0.006820142567475129, "kl": 0.008167230741589272, "entropy": 1.1684512524559094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 192495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 1030.0, "episode_reward_min": -15.0, "episode_reward_mean": 380.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 450.0}, "policy_reward_mean": {"policy_0": 38.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 290.0, 310.0, 290.0, 300.0, 220.0, 400.0, 350.0, 520.0, 530.0, 340.0, 180.0, 580.0, 210.0, 505.0, 120.0, 320.0, 500.0, 355.0, 680.0, 240.0, 400.0, 400.0, 360.0, 650.0, 340.0, 300.0, 605.0, 770.0, 490.0, 260.0, 570.0, 410.0, 725.0, 270.0, 450.0, 280.0, 430.0, 200.0, 445.0, 240.0, 250.0, 320.0, 435.0, 490.0, 550.0, -15.0, 510.0, 430.0, 320.0, 320.0, 1030.0, 240.0, 230.0, 430.0, 380.0, 540.0, 180.0, 375.0, 380.0, 95.0, 310.0, 480.0, 260.0, 260.0, 620.0, 475.0, 370.0, 265.0, 180.0, 400.0, 130.0, 435.0, 580.0, 595.0, 240.0, 600.0, 340.0, 315.0, 335.0, 320.0, 170.0, 250.0, 780.0, 150.0, 135.0, 305.0, 340.0, 370.0, 385.0, 590.0, 500.0, 225.0, 195.0, 180.0, 620.0, 200.0, 170.0, 640.0, 580.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 60.0, 0.0, 170.0, 10.0, 20.0, 60.0, 40.0, 20.0, 40.0, 0.0, 50.0, 20.0, 80.0, 40.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 150.0, -40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 30.0, 40.0, 20.0, -40.0, 180.0, 40.0, 40.0, 60.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 40.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 0.0, 10.0, 15.0, 20.0, 170.0, 15.0, 50.0, 40.0, 80.0, 0.0, 20.0, 10.0, 20.0, 10.0, 50.0, 10.0, 20.0, 40.0, 170.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 90.0, 190.0, 20.0, 20.0, 30.0, -10.0, 450.0, -30.0, 10.0, -10.0, 10.0, 10.0, 30.0, 40.0, 80.0, 60.0, 30.0, 20.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 30.0, 170.0, 0.0, 50.0, -30.0, 200.0, 60.0, 20.0, 50.0, 20.0, 40.0, 10.0, 0.0, 70.0, 50.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 40.0, 80.0, 50.0, 85.0, 40.0, 70.0, 20.0, 60.0, 60.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 30.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 40.0, 20.0, 30.0, 60.0, 50.0, 150.0, 30.0, 40.0, 60.0, 70.0, 50.0, 20.0, 30.0, 0.0, 20.0, 45.0, 30.0, 20.0, 30.0, 160.0, 20.0, 0.0, 10.0, 20.0, 30.0, 40.0, 30.0, 70.0, 10.0, 90.0, 20.0, 170.0, 190.0, 30.0, 50.0, 10.0, 10.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 70.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 200.0, 40.0, 40.0, 10.0, 20.0, 10.0, 30.0, 70.0, -20.0, 20.0, 40.0, 10.0, 210.0, 30.0, 20.0, 20.0, 50.0, 0.0, 60.0, 30.0, 30.0, 90.0, 30.0, 0.0, 60.0, 30.0, 20.0, 30.0, 20.0, 80.0, 10.0, 40.0, 360.0, 10.0, 20.0, 10.0, 150.0, 40.0, 0.0, 0.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 100.0, 20.0, 30.0, 40.0, 20.0, 50.0, 50.0, 80.0, 100.0, 10.0, 65.0, 40.0, 150.0, 40.0, 180.0, 30.0, 30.0, 20.0, 350.0, 0.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 60.0, 0.0, 0.0, 50.0, 160.0, 70.0, 30.0, 70.0, 0.0, 20.0, 30.0, 60.0, 20.0, 20.0, 40.0, 30.0, 40.0, 0.0, 40.0, 50.0, 50.0, 240.0, 70.0, 50.0, -30.0, 40.0, 10.0, 50.0, 50.0, 70.0, 70.0, 40.0, 30.0, 40.0, 60.0, 0.0, 50.0, 0.0, 160.0, 70.0, 50.0, 30.0, 40.0, 155.0, 60.0, 120.0, 40.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 0.0, 10.0, 30.0, 70.0, 0.0, 20.0, 180.0, 50.0, 30.0, 10.0, 20.0, 60.0, 10.0, 0.0, 10.0, 80.0, 30.0, 60.0, 10.0, 30.0, 20.0, 20.0, 20.0, 10.0, 80.0, 50.0, 100.0, 50.0, 5.0, 45.0, 10.0, 60.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 65.0, 60.0, 70.0, 30.0, 50.0, 70.0, 20.0, 50.0, 80.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 10.0, 40.0, 10.0, 10.0, 30.0, 20.0, 50.0, 20.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 160.0, 0.0, 40.0, 50.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 20.0, 30.0, 100.0, 30.0, 20.0, 60.0, 40.0, 40.0, 140.0, 30.0, 150.0, 20.0, 20.0, 50.0, 10.0, 20.0, 100.0, 130.0, 20.0, 40.0, 30.0, 40.0, 0.0, -15.0, 0.0, -220.0, 40.0, 30.0, 40.0, 40.0, 90.0, 40.0, 10.0, 80.0, 10.0, 20.0, 180.0, 20.0, 20.0, 20.0, 50.0, 70.0, 30.0, 160.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 80.0, 0.0, 30.0, 70.0, 40.0, 40.0, 0.0, 40.0, 0.0, 20.0, 170.0, 50.0, 0.0, 110.0, 50.0, 70.0, 160.0, 180.0, -10.0, 250.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 80.0, 30.0, 20.0, 0.0, 60.0, 30.0, 10.0, 0.0, 80.0, 0.0, 20.0, 10.0, 10.0, 160.0, 50.0, -160.0, 10.0, 30.0, 110.0, 40.0, 160.0, 20.0, 0.0, 20.0, 120.0, 20.0, 50.0, 0.0, 80.0, 50.0, 20.0, 20.0, 60.0, 50.0, 0.0, 70.0, 50.0, 60.0, 90.0, 50.0, 40.0, 70.0, 20.0, 50.0, 10.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 40.0, 40.0, 15.0, 100.0, 30.0, 0.0, 50.0, 50.0, 20.0, 30.0, 40.0, 80.0, 110.0, 10.0, 40.0, 10.0, 30.0, 10.0, 20.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, -15.0, 30.0, 20.0, 60.0, 30.0, 40.0, 20.0, 30.0, 80.0, 10.0, 20.0, 20.0, 0.0, 20.0, 70.0, 130.0, 0.0, 30.0, 30.0, 80.0, 50.0, 20.0, 50.0, 60.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 110.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 60.0, 0.0, 60.0, 0.0, 120.0, 30.0, 10.0, 40.0, 40.0, 20.0, 20.0, 40.0, 260.0, 40.0, 0.0, 0.0, 95.0, 40.0, 40.0, 20.0, 70.0, 30.0, 180.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 110.0, 20.0, 0.0, 20.0, 70.0, 60.0, 5.0, 30.0, 20.0, 0.0, 70.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 20.0, 40.0, 210.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, -10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 40.0, 160.0, 20.0, 20.0, 30.0, 0.0, 20.0, 50.0, 60.0, 35.0, 20.0, 15.0, 30.0, 35.0, 40.0, 30.0, 40.0, -20.0, 10.0, 380.0, 40.0, 40.0, 35.0, 250.0, 150.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 80.0, 40.0, 0.0, 20.0, 80.0, 40.0, 20.0, 80.0, 10.0, 210.0, 50.0, 30.0, 60.0, 30.0, 0.0, 50.0, 50.0, 30.0, 80.0, 10.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 65.0, 10.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 110.0, 25.0, 10.0, 70.0, 50.0, 20.0, 20.0, 0.0, 10.0, 30.0, -40.0, 40.0, 170.0, 10.0, 10.0, 40.0, 40.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 60.0, 20.0, 40.0, 30.0, 40.0, 60.0, 50.0, 200.0, 30.0, 30.0, 0.0, 50.0, 50.0, 270.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 30.0, -5.0, 10.0, 20.0, 40.0, 0.0, 10.0, 0.0, 45.0, 40.0, 40.0, 20.0, 40.0, 50.0, 20.0, 10.0, 0.0, 40.0, 50.0, 40.0, 20.0, 20.0, 60.0, 50.0, 30.0, 20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 20.0, 80.0, 10.0, 30.0, 30.0, 50.0, 30.0, -20.0, 40.0, 20.0, 10.0, 10.0, 40.0, 75.0, 40.0, 20.0, 150.0, 0.0, 90.0, 10.0, 100.0, 50.0, 90.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, 180.0, 40.0, -40.0, 30.0, 20.0, 0.0, 260.0, -10.0, 10.0, 50.0, 10.0, 70.0, 40.0, 0.0, 10.0, 20.0, 0.0, 15.0, 45.0, 60.0, -260.0, 40.0, -30.0, 30.0, 170.0, 30.0, 20.0, 90.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 70.0, 10.0, 260.0, 40.0, -20.0, 30.0, 40.0, 40.0, 20.0, 30.0, 80.0, 100.0, 20.0, 70.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 30.0, 50.0, 10.0, 150.0, 50.0, 250.0, 40.0, 10.0, 30.0, 220.0, 0.0, 100.0, -110.0, 30.0, 230.0, 0.0, -10.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6542942720415845, "mean_inference_ms": 1.4565096874843853, "mean_action_processing_ms": 0.4136763199295646, "mean_env_wait_ms": 1.3240430639345058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012373208999633789, "StateBufferConnector_ms": 0.010607004165649414, "ViewRequirementAgentConnector_ms": 0.3763554096221924}, "num_episodes": 18, "episode_return_max": 1030.0, "episode_return_min": -15.0, "episode_return_mean": 380.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.4737830895832, "num_env_steps_trained_throughput_per_sec": 21.4737830895832, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 187399.656, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187399.61, "sample_time_ms": 2656.796, "learn_time_ms": 184722.025, "learn_throughput": 21.654, "synch_weights_time_ms": 12.686}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 21, "trial_id": "90816_00000", "date": "2024-06-10_01-19-21", "timestamp": 1717996761, "time_this_iter_s": 186.28216195106506, "time_total_s": 4040.3202340602875, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00cc820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4040.3202340602875, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.466159695817492, "ram_util_percent": 78.82585551330797}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0114759818179664, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.479030576072181, "policy_loss": -0.010580390269165865, "vf_loss": 4.487969510776166, "vf_explained_var": 0.016249951609153462, "kl": 0.008207244047487012, "entropy": 1.1347633244955755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 201885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 1030.0, "episode_reward_min": -15.0, "episode_reward_mean": 386.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 380.0}, "policy_reward_mean": {"policy_0": 38.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [355.0, 680.0, 240.0, 400.0, 400.0, 360.0, 650.0, 340.0, 300.0, 605.0, 770.0, 490.0, 260.0, 570.0, 410.0, 725.0, 270.0, 450.0, 280.0, 430.0, 200.0, 445.0, 240.0, 250.0, 320.0, 435.0, 490.0, 550.0, -15.0, 510.0, 430.0, 320.0, 320.0, 1030.0, 240.0, 230.0, 430.0, 380.0, 540.0, 180.0, 375.0, 380.0, 95.0, 310.0, 480.0, 260.0, 260.0, 620.0, 475.0, 370.0, 265.0, 180.0, 400.0, 130.0, 435.0, 580.0, 595.0, 240.0, 600.0, 340.0, 315.0, 335.0, 320.0, 170.0, 250.0, 780.0, 150.0, 135.0, 305.0, 340.0, 370.0, 385.0, 590.0, 500.0, 225.0, 195.0, 180.0, 620.0, 200.0, 170.0, 640.0, 580.0, 460.0, 420.0, 200.0, 485.0, 885.0, 730.0, 200.0, 285.0, 170.0, 320.0, 300.0, 540.0, 290.0, 400.0, 470.0, 270.0, 240.0, 285.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 45.0, 30.0, 20.0, 30.0, 160.0, 20.0, 0.0, 10.0, 20.0, 30.0, 40.0, 30.0, 70.0, 10.0, 90.0, 20.0, 170.0, 190.0, 30.0, 50.0, 10.0, 10.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 70.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 200.0, 40.0, 40.0, 10.0, 20.0, 10.0, 30.0, 70.0, -20.0, 20.0, 40.0, 10.0, 210.0, 30.0, 20.0, 20.0, 50.0, 0.0, 60.0, 30.0, 30.0, 90.0, 30.0, 0.0, 60.0, 30.0, 20.0, 30.0, 20.0, 80.0, 10.0, 40.0, 360.0, 10.0, 20.0, 10.0, 150.0, 40.0, 0.0, 0.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 100.0, 20.0, 30.0, 40.0, 20.0, 50.0, 50.0, 80.0, 100.0, 10.0, 65.0, 40.0, 150.0, 40.0, 180.0, 30.0, 30.0, 20.0, 350.0, 0.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 60.0, 0.0, 0.0, 50.0, 160.0, 70.0, 30.0, 70.0, 0.0, 20.0, 30.0, 60.0, 20.0, 20.0, 40.0, 30.0, 40.0, 0.0, 40.0, 50.0, 50.0, 240.0, 70.0, 50.0, -30.0, 40.0, 10.0, 50.0, 50.0, 70.0, 70.0, 40.0, 30.0, 40.0, 60.0, 0.0, 50.0, 0.0, 160.0, 70.0, 50.0, 30.0, 40.0, 155.0, 60.0, 120.0, 40.0, 0.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 0.0, 10.0, 30.0, 70.0, 0.0, 20.0, 180.0, 50.0, 30.0, 10.0, 20.0, 60.0, 10.0, 0.0, 10.0, 80.0, 30.0, 60.0, 10.0, 30.0, 20.0, 20.0, 20.0, 10.0, 80.0, 50.0, 100.0, 50.0, 5.0, 45.0, 10.0, 60.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 65.0, 60.0, 70.0, 30.0, 50.0, 70.0, 20.0, 50.0, 80.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 10.0, 40.0, 10.0, 10.0, 30.0, 20.0, 50.0, 20.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 160.0, 0.0, 40.0, 50.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 20.0, 30.0, 100.0, 30.0, 20.0, 60.0, 40.0, 40.0, 140.0, 30.0, 150.0, 20.0, 20.0, 50.0, 10.0, 20.0, 100.0, 130.0, 20.0, 40.0, 30.0, 40.0, 0.0, -15.0, 0.0, -220.0, 40.0, 30.0, 40.0, 40.0, 90.0, 40.0, 10.0, 80.0, 10.0, 20.0, 180.0, 20.0, 20.0, 20.0, 50.0, 70.0, 30.0, 160.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 80.0, 0.0, 30.0, 70.0, 40.0, 40.0, 0.0, 40.0, 0.0, 20.0, 170.0, 50.0, 0.0, 110.0, 50.0, 70.0, 160.0, 180.0, -10.0, 250.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 80.0, 30.0, 20.0, 0.0, 60.0, 30.0, 10.0, 0.0, 80.0, 0.0, 20.0, 10.0, 10.0, 160.0, 50.0, -160.0, 10.0, 30.0, 110.0, 40.0, 160.0, 20.0, 0.0, 20.0, 120.0, 20.0, 50.0, 0.0, 80.0, 50.0, 20.0, 20.0, 60.0, 50.0, 0.0, 70.0, 50.0, 60.0, 90.0, 50.0, 40.0, 70.0, 20.0, 50.0, 10.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 40.0, 40.0, 15.0, 100.0, 30.0, 0.0, 50.0, 50.0, 20.0, 30.0, 40.0, 80.0, 110.0, 10.0, 40.0, 10.0, 30.0, 10.0, 20.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, -15.0, 30.0, 20.0, 60.0, 30.0, 40.0, 20.0, 30.0, 80.0, 10.0, 20.0, 20.0, 0.0, 20.0, 70.0, 130.0, 0.0, 30.0, 30.0, 80.0, 50.0, 20.0, 50.0, 60.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 110.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 60.0, 0.0, 60.0, 0.0, 120.0, 30.0, 10.0, 40.0, 40.0, 20.0, 20.0, 40.0, 260.0, 40.0, 0.0, 0.0, 95.0, 40.0, 40.0, 20.0, 70.0, 30.0, 180.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 110.0, 20.0, 0.0, 20.0, 70.0, 60.0, 5.0, 30.0, 20.0, 0.0, 70.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 20.0, 40.0, 210.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, -10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 40.0, 160.0, 20.0, 20.0, 30.0, 0.0, 20.0, 50.0, 60.0, 35.0, 20.0, 15.0, 30.0, 35.0, 40.0, 30.0, 40.0, -20.0, 10.0, 380.0, 40.0, 40.0, 35.0, 250.0, 150.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 80.0, 40.0, 0.0, 20.0, 80.0, 40.0, 20.0, 80.0, 10.0, 210.0, 50.0, 30.0, 60.0, 30.0, 0.0, 50.0, 50.0, 30.0, 80.0, 10.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 65.0, 10.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 110.0, 25.0, 10.0, 70.0, 50.0, 20.0, 20.0, 0.0, 10.0, 30.0, -40.0, 40.0, 170.0, 10.0, 10.0, 40.0, 40.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 60.0, 20.0, 40.0, 30.0, 40.0, 60.0, 50.0, 200.0, 30.0, 30.0, 0.0, 50.0, 50.0, 270.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 30.0, -5.0, 10.0, 20.0, 40.0, 0.0, 10.0, 0.0, 45.0, 40.0, 40.0, 20.0, 40.0, 50.0, 20.0, 10.0, 0.0, 40.0, 50.0, 40.0, 20.0, 20.0, 60.0, 50.0, 30.0, 20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 20.0, 80.0, 10.0, 30.0, 30.0, 50.0, 30.0, -20.0, 40.0, 20.0, 10.0, 10.0, 40.0, 75.0, 40.0, 20.0, 150.0, 0.0, 90.0, 10.0, 100.0, 50.0, 90.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, 180.0, 40.0, -40.0, 30.0, 20.0, 0.0, 260.0, -10.0, 10.0, 50.0, 10.0, 70.0, 40.0, 0.0, 10.0, 20.0, 0.0, 15.0, 45.0, 60.0, -260.0, 40.0, -30.0, 30.0, 170.0, 30.0, 20.0, 90.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 70.0, 10.0, 260.0, 40.0, -20.0, 30.0, 40.0, 40.0, 20.0, 30.0, 80.0, 100.0, 20.0, 70.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 30.0, 50.0, 10.0, 150.0, 50.0, 250.0, 40.0, 10.0, 30.0, 220.0, 0.0, 100.0, -110.0, 30.0, 230.0, 0.0, -10.0, 90.0, 60.0, 30.0, 160.0, 40.0, 40.0, 0.0, 50.0, 10.0, 50.0, 20.0, 100.0, 50.0, 20.0, 30.0, 10.0, 20.0, 60.0, 0.0, 80.0, 50.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 30.0, 90.0, 0.0, 30.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 75.0, 10.0, 40.0, 20.0, 270.0, -25.0, 30.0, 50.0, 50.0, 80.0, 30.0, 310.0, 70.0, 0.0, 160.0, 20.0, 300.0, 20.0, 130.0, 40.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 50.0, 0.0, 20.0, 30.0, 25.0, 70.0, 20.0, 30.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 50.0, 50.0, 40.0, 10.0, 10.0, 80.0, 10.0, 0.0, 20.0, 80.0, 10.0, 40.0, 40.0, 40.0, 40.0, 150.0, 10.0, 80.0, 50.0, 80.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 10.0, 60.0, 20.0, 40.0, 30.0, 110.0, 30.0, 30.0, 30.0, 70.0, 0.0, 60.0, 0.0, 90.0, 40.0, 0.0, 40.0, 30.0, 70.0, 30.0, 20.0, 150.0, 0.0, 0.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 60.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 40.0, 80.0, 20.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 20.0, 20.0, 25.0, 70.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6459266636288303, "mean_inference_ms": 1.450982401179907, "mean_action_processing_ms": 0.41217902047481547, "mean_env_wait_ms": 1.318802896496389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012382030487060547, "StateBufferConnector_ms": 0.010572195053100586, "ViewRequirementAgentConnector_ms": 0.36577677726745605}, "num_episodes": 18, "episode_return_max": 1030.0, "episode_return_min": -15.0, "episode_return_mean": 386.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.318585289396253, "num_env_steps_trained_throughput_per_sec": 21.318585289396253, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 187493.534, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187493.488, "sample_time_ms": 2669.999, "learn_time_ms": 184802.973, "learn_throughput": 21.645, "synch_weights_time_ms": 12.436}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 22, "trial_id": "90816_00000", "date": "2024-06-10_01-22-29", "timestamp": 1717996949, "time_this_iter_s": 187.63986802101135, "time_total_s": 4227.960102081299, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f6a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4227.960102081299, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.08233082706767, "ram_util_percent": 79.18458646616541}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.836484626122811, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.071145556478328, "policy_loss": -0.00923944094272368, "vf_loss": 5.0787295989969925, "vf_explained_var": 0.010236457545663349, "kl": 0.008276972392398297, "entropy": 1.0809308132614952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 211275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 1175.0, "episode_reward_min": -15.0, "episode_reward_mean": 392.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 39.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 430.0, 200.0, 445.0, 240.0, 250.0, 320.0, 435.0, 490.0, 550.0, -15.0, 510.0, 430.0, 320.0, 320.0, 1030.0, 240.0, 230.0, 430.0, 380.0, 540.0, 180.0, 375.0, 380.0, 95.0, 310.0, 480.0, 260.0, 260.0, 620.0, 475.0, 370.0, 265.0, 180.0, 400.0, 130.0, 435.0, 580.0, 595.0, 240.0, 600.0, 340.0, 315.0, 335.0, 320.0, 170.0, 250.0, 780.0, 150.0, 135.0, 305.0, 340.0, 370.0, 385.0, 590.0, 500.0, 225.0, 195.0, 180.0, 620.0, 200.0, 170.0, 640.0, 580.0, 460.0, 420.0, 200.0, 485.0, 885.0, 730.0, 200.0, 285.0, 170.0, 320.0, 300.0, 540.0, 290.0, 400.0, 470.0, 270.0, 240.0, 285.0, 350.0, 140.0, 380.0, 540.0, 530.0, 520.0, 350.0, 1175.0, 640.0, 1070.0, 720.0, 380.0, 300.0, 220.0, 210.0, 460.0, 335.0, 585.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 80.0, 30.0, 60.0, 10.0, 30.0, 20.0, 20.0, 20.0, 10.0, 80.0, 50.0, 100.0, 50.0, 5.0, 45.0, 10.0, 60.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 65.0, 60.0, 70.0, 30.0, 50.0, 70.0, 20.0, 50.0, 80.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 10.0, 20.0, 50.0, 10.0, 40.0, 10.0, 10.0, 30.0, 20.0, 50.0, 20.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 160.0, 0.0, 40.0, 50.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 20.0, 30.0, 100.0, 30.0, 20.0, 60.0, 40.0, 40.0, 140.0, 30.0, 150.0, 20.0, 20.0, 50.0, 10.0, 20.0, 100.0, 130.0, 20.0, 40.0, 30.0, 40.0, 0.0, -15.0, 0.0, -220.0, 40.0, 30.0, 40.0, 40.0, 90.0, 40.0, 10.0, 80.0, 10.0, 20.0, 180.0, 20.0, 20.0, 20.0, 50.0, 70.0, 30.0, 160.0, 20.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 80.0, 0.0, 30.0, 70.0, 40.0, 40.0, 0.0, 40.0, 0.0, 20.0, 170.0, 50.0, 0.0, 110.0, 50.0, 70.0, 160.0, 180.0, -10.0, 250.0, 20.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 10.0, 80.0, 30.0, 20.0, 0.0, 60.0, 30.0, 10.0, 0.0, 80.0, 0.0, 20.0, 10.0, 10.0, 160.0, 50.0, -160.0, 10.0, 30.0, 110.0, 40.0, 160.0, 20.0, 0.0, 20.0, 120.0, 20.0, 50.0, 0.0, 80.0, 50.0, 20.0, 20.0, 60.0, 50.0, 0.0, 70.0, 50.0, 60.0, 90.0, 50.0, 40.0, 70.0, 20.0, 50.0, 10.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 40.0, 40.0, 15.0, 100.0, 30.0, 0.0, 50.0, 50.0, 20.0, 30.0, 40.0, 80.0, 110.0, 10.0, 40.0, 10.0, 30.0, 10.0, 20.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, -15.0, 30.0, 20.0, 60.0, 30.0, 40.0, 20.0, 30.0, 80.0, 10.0, 20.0, 20.0, 0.0, 20.0, 70.0, 130.0, 0.0, 30.0, 30.0, 80.0, 50.0, 20.0, 50.0, 60.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 110.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 60.0, 0.0, 60.0, 0.0, 120.0, 30.0, 10.0, 40.0, 40.0, 20.0, 20.0, 40.0, 260.0, 40.0, 0.0, 0.0, 95.0, 40.0, 40.0, 20.0, 70.0, 30.0, 180.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 110.0, 20.0, 0.0, 20.0, 70.0, 60.0, 5.0, 30.0, 20.0, 0.0, 70.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 20.0, 40.0, 210.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, -10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 40.0, 160.0, 20.0, 20.0, 30.0, 0.0, 20.0, 50.0, 60.0, 35.0, 20.0, 15.0, 30.0, 35.0, 40.0, 30.0, 40.0, -20.0, 10.0, 380.0, 40.0, 40.0, 35.0, 250.0, 150.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 80.0, 40.0, 0.0, 20.0, 80.0, 40.0, 20.0, 80.0, 10.0, 210.0, 50.0, 30.0, 60.0, 30.0, 0.0, 50.0, 50.0, 30.0, 80.0, 10.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 65.0, 10.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 110.0, 25.0, 10.0, 70.0, 50.0, 20.0, 20.0, 0.0, 10.0, 30.0, -40.0, 40.0, 170.0, 10.0, 10.0, 40.0, 40.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 60.0, 20.0, 40.0, 30.0, 40.0, 60.0, 50.0, 200.0, 30.0, 30.0, 0.0, 50.0, 50.0, 270.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 30.0, -5.0, 10.0, 20.0, 40.0, 0.0, 10.0, 0.0, 45.0, 40.0, 40.0, 20.0, 40.0, 50.0, 20.0, 10.0, 0.0, 40.0, 50.0, 40.0, 20.0, 20.0, 60.0, 50.0, 30.0, 20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 20.0, 80.0, 10.0, 30.0, 30.0, 50.0, 30.0, -20.0, 40.0, 20.0, 10.0, 10.0, 40.0, 75.0, 40.0, 20.0, 150.0, 0.0, 90.0, 10.0, 100.0, 50.0, 90.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, 180.0, 40.0, -40.0, 30.0, 20.0, 0.0, 260.0, -10.0, 10.0, 50.0, 10.0, 70.0, 40.0, 0.0, 10.0, 20.0, 0.0, 15.0, 45.0, 60.0, -260.0, 40.0, -30.0, 30.0, 170.0, 30.0, 20.0, 90.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 70.0, 10.0, 260.0, 40.0, -20.0, 30.0, 40.0, 40.0, 20.0, 30.0, 80.0, 100.0, 20.0, 70.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 30.0, 50.0, 10.0, 150.0, 50.0, 250.0, 40.0, 10.0, 30.0, 220.0, 0.0, 100.0, -110.0, 30.0, 230.0, 0.0, -10.0, 90.0, 60.0, 30.0, 160.0, 40.0, 40.0, 0.0, 50.0, 10.0, 50.0, 20.0, 100.0, 50.0, 20.0, 30.0, 10.0, 20.0, 60.0, 0.0, 80.0, 50.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 30.0, 90.0, 0.0, 30.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 75.0, 10.0, 40.0, 20.0, 270.0, -25.0, 30.0, 50.0, 50.0, 80.0, 30.0, 310.0, 70.0, 0.0, 160.0, 20.0, 300.0, 20.0, 130.0, 40.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 50.0, 0.0, 20.0, 30.0, 25.0, 70.0, 20.0, 30.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 50.0, 50.0, 40.0, 10.0, 10.0, 80.0, 10.0, 0.0, 20.0, 80.0, 10.0, 40.0, 40.0, 40.0, 40.0, 150.0, 10.0, 80.0, 50.0, 80.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 10.0, 60.0, 20.0, 40.0, 30.0, 110.0, 30.0, 30.0, 30.0, 70.0, 0.0, 60.0, 0.0, 90.0, 40.0, 0.0, 40.0, 30.0, 70.0, 30.0, 20.0, 150.0, 0.0, 0.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 60.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 40.0, 80.0, 20.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 20.0, 20.0, 25.0, 70.0, 20.0, 20.0, 30.0, 10.0, 30.0, 70.0, 0.0, 150.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 0.0, 150.0, 0.0, 20.0, 50.0, 60.0, 30.0, 110.0, 60.0, 20.0, 30.0, 40.0, 40.0, 100.0, 40.0, 20.0, 110.0, 40.0, 50.0, 10.0, 60.0, 150.0, 60.0, -10.0, 60.0, 30.0, 90.0, 20.0, 190.0, 10.0, 0.0, 40.0, 40.0, 40.0, 100.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 200.0, 50.0, 310.0, 90.0, 30.0, 240.0, 160.0, 20.0, 60.0, 15.0, 130.0, 70.0, 70.0, 60.0, 10.0, 60.0, 60.0, 30.0, 10.0, 140.0, 190.0, 160.0, 20.0, 60.0, 10.0, 70.0, -10.0, 30.0, 480.0, 60.0, 90.0, 20.0, 30.0, 80.0, 20.0, 30.0, 270.0, 70.0, 40.0, 70.0, 30.0, 70.0, 10.0, 40.0, 40.0, -40.0, 70.0, 30.0, 40.0, 90.0, 20.0, 90.0, 10.0, 10.0, 0.0, 0.0, 50.0, 40.0, 10.0, 70.0, 50.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 30.0, 10.0, 30.0, 0.0, 40.0, 30.0, 70.0, -30.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 160.0, 40.0, 60.0, 80.0, 40.0, 10.0, 0.0, 30.0, 40.0, 5.0, 60.0, 10.0, 30.0, 20.0, 110.0, 30.0, 10.0, 10.0, 50.0, 65.0, 0.0, 200.0, 150.0, 20.0, 50.0, 0.0, 40.0, 60.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6376504063653592, "mean_inference_ms": 1.445908464429114, "mean_action_processing_ms": 0.41089616106325044, "mean_env_wait_ms": 1.3141246877346506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01237344741821289, "StateBufferConnector_ms": 0.010552167892456055, "ViewRequirementAgentConnector_ms": 0.3803062438964844}, "num_episodes": 18, "episode_return_max": 1175.0, "episode_return_min": -15.0, "episode_return_mean": 392.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.27860136423871, "num_env_steps_trained_throughput_per_sec": 21.27860136423871, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 187453.591, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187453.545, "sample_time_ms": 2631.938, "learn_time_ms": 184801.296, "learn_throughput": 21.645, "synch_weights_time_ms": 12.252}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 23, "trial_id": "90816_00000", "date": "2024-06-10_01-25-37", "timestamp": 1717997137, "time_this_iter_s": 187.98961734771729, "time_total_s": 4415.949719429016, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00ccb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4415.949719429016, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.71203007518797, "ram_util_percent": 79.4921052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.251587161355125, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.50553072679538, "policy_loss": -0.008870483568549171, "vf_loss": 4.512881182100826, "vf_explained_var": 0.0031075059605863526, "kl": 0.007600135634283416, "entropy": 1.0920783214421825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 220665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 1175.0, "episode_reward_min": 95.0, "episode_reward_mean": 411.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 570.0}, "policy_reward_mean": {"policy_0": 41.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [260.0, 260.0, 620.0, 475.0, 370.0, 265.0, 180.0, 400.0, 130.0, 435.0, 580.0, 595.0, 240.0, 600.0, 340.0, 315.0, 335.0, 320.0, 170.0, 250.0, 780.0, 150.0, 135.0, 305.0, 340.0, 370.0, 385.0, 590.0, 500.0, 225.0, 195.0, 180.0, 620.0, 200.0, 170.0, 640.0, 580.0, 460.0, 420.0, 200.0, 485.0, 885.0, 730.0, 200.0, 285.0, 170.0, 320.0, 300.0, 540.0, 290.0, 400.0, 470.0, 270.0, 240.0, 285.0, 350.0, 140.0, 380.0, 540.0, 530.0, 520.0, 350.0, 1175.0, 640.0, 1070.0, 720.0, 380.0, 300.0, 220.0, 210.0, 460.0, 335.0, 585.0, 590.0, 415.0, 950.0, 410.0, 375.0, 360.0, 410.0, 570.0, 490.0, 480.0, 390.0, 95.0, 455.0, 490.0, 940.0, 475.0, 360.0, 410.0, 330.0, 500.0, 430.0, 540.0, 300.0, 205.0, 340.0, 270.0, 215.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 110.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 60.0, 0.0, 60.0, 0.0, 120.0, 30.0, 10.0, 40.0, 40.0, 20.0, 20.0, 40.0, 260.0, 40.0, 0.0, 0.0, 95.0, 40.0, 40.0, 20.0, 70.0, 30.0, 180.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 110.0, 20.0, 0.0, 20.0, 70.0, 60.0, 5.0, 30.0, 20.0, 0.0, 70.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 30.0, 20.0, 40.0, 210.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, -10.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 40.0, 160.0, 20.0, 20.0, 30.0, 0.0, 20.0, 50.0, 60.0, 35.0, 20.0, 15.0, 30.0, 35.0, 40.0, 30.0, 40.0, -20.0, 10.0, 380.0, 40.0, 40.0, 35.0, 250.0, 150.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 80.0, 40.0, 0.0, 20.0, 80.0, 40.0, 20.0, 80.0, 10.0, 210.0, 50.0, 30.0, 60.0, 30.0, 0.0, 50.0, 50.0, 30.0, 80.0, 10.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 65.0, 10.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 110.0, 25.0, 10.0, 70.0, 50.0, 20.0, 20.0, 0.0, 10.0, 30.0, -40.0, 40.0, 170.0, 10.0, 10.0, 40.0, 40.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 60.0, 20.0, 40.0, 30.0, 40.0, 60.0, 50.0, 200.0, 30.0, 30.0, 0.0, 50.0, 50.0, 270.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 30.0, -5.0, 10.0, 20.0, 40.0, 0.0, 10.0, 0.0, 45.0, 40.0, 40.0, 20.0, 40.0, 50.0, 20.0, 10.0, 0.0, 40.0, 50.0, 40.0, 20.0, 20.0, 60.0, 50.0, 30.0, 20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 20.0, 80.0, 10.0, 30.0, 30.0, 50.0, 30.0, -20.0, 40.0, 20.0, 10.0, 10.0, 40.0, 75.0, 40.0, 20.0, 150.0, 0.0, 90.0, 10.0, 100.0, 50.0, 90.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, 180.0, 40.0, -40.0, 30.0, 20.0, 0.0, 260.0, -10.0, 10.0, 50.0, 10.0, 70.0, 40.0, 0.0, 10.0, 20.0, 0.0, 15.0, 45.0, 60.0, -260.0, 40.0, -30.0, 30.0, 170.0, 30.0, 20.0, 90.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 70.0, 10.0, 260.0, 40.0, -20.0, 30.0, 40.0, 40.0, 20.0, 30.0, 80.0, 100.0, 20.0, 70.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 30.0, 50.0, 10.0, 150.0, 50.0, 250.0, 40.0, 10.0, 30.0, 220.0, 0.0, 100.0, -110.0, 30.0, 230.0, 0.0, -10.0, 90.0, 60.0, 30.0, 160.0, 40.0, 40.0, 0.0, 50.0, 10.0, 50.0, 20.0, 100.0, 50.0, 20.0, 30.0, 10.0, 20.0, 60.0, 0.0, 80.0, 50.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 30.0, 90.0, 0.0, 30.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 75.0, 10.0, 40.0, 20.0, 270.0, -25.0, 30.0, 50.0, 50.0, 80.0, 30.0, 310.0, 70.0, 0.0, 160.0, 20.0, 300.0, 20.0, 130.0, 40.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 50.0, 0.0, 20.0, 30.0, 25.0, 70.0, 20.0, 30.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 50.0, 50.0, 40.0, 10.0, 10.0, 80.0, 10.0, 0.0, 20.0, 80.0, 10.0, 40.0, 40.0, 40.0, 40.0, 150.0, 10.0, 80.0, 50.0, 80.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 10.0, 60.0, 20.0, 40.0, 30.0, 110.0, 30.0, 30.0, 30.0, 70.0, 0.0, 60.0, 0.0, 90.0, 40.0, 0.0, 40.0, 30.0, 70.0, 30.0, 20.0, 150.0, 0.0, 0.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 60.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 40.0, 80.0, 20.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 20.0, 20.0, 25.0, 70.0, 20.0, 20.0, 30.0, 10.0, 30.0, 70.0, 0.0, 150.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 0.0, 150.0, 0.0, 20.0, 50.0, 60.0, 30.0, 110.0, 60.0, 20.0, 30.0, 40.0, 40.0, 100.0, 40.0, 20.0, 110.0, 40.0, 50.0, 10.0, 60.0, 150.0, 60.0, -10.0, 60.0, 30.0, 90.0, 20.0, 190.0, 10.0, 0.0, 40.0, 40.0, 40.0, 100.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 200.0, 50.0, 310.0, 90.0, 30.0, 240.0, 160.0, 20.0, 60.0, 15.0, 130.0, 70.0, 70.0, 60.0, 10.0, 60.0, 60.0, 30.0, 10.0, 140.0, 190.0, 160.0, 20.0, 60.0, 10.0, 70.0, -10.0, 30.0, 480.0, 60.0, 90.0, 20.0, 30.0, 80.0, 20.0, 30.0, 270.0, 70.0, 40.0, 70.0, 30.0, 70.0, 10.0, 40.0, 40.0, -40.0, 70.0, 30.0, 40.0, 90.0, 20.0, 90.0, 10.0, 10.0, 0.0, 0.0, 50.0, 40.0, 10.0, 70.0, 50.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 30.0, 10.0, 30.0, 0.0, 40.0, 30.0, 70.0, -30.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 160.0, 40.0, 60.0, 80.0, 40.0, 10.0, 0.0, 30.0, 40.0, 5.0, 60.0, 10.0, 30.0, 20.0, 110.0, 30.0, 10.0, 10.0, 50.0, 65.0, 0.0, 200.0, 150.0, 20.0, 50.0, 0.0, 40.0, 60.0, 0.0, 10.0, 120.0, 60.0, 10.0, 50.0, 120.0, 70.0, 40.0, 100.0, 10.0, 10.0, 5.0, 100.0, 10.0, 40.0, 170.0, 20.0, 20.0, 0.0, 40.0, 80.0, 170.0, 40.0, 250.0, -50.0, 40.0, 10.0, 310.0, 40.0, 60.0, 100.0, 10.0, 170.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 145.0, 30.0, 10.0, 30.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 80.0, 40.0, 40.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 30.0, 50.0, 90.0, 40.0, 10.0, 110.0, 50.0, 30.0, 90.0, 20.0, 150.0, 60.0, 10.0, 20.0, 40.0, 20.0, 160.0, 60.0, 60.0, 70.0, 20.0, 20.0, 20.0, 20.0, 80.0, 50.0, 80.0, 40.0, 40.0, 90.0, 20.0, 20.0, 40.0, 110.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 150.0, 20.0, 20.0, -20.0, 10.0, 20.0, 0.0, 20.0, -5.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 40.0, 10.0, 40.0, 70.0, 55.0, 40.0, 30.0, 80.0, 60.0, 80.0, 20.0, 30.0, 10.0, 150.0, 30.0, 20.0, 10.0, 80.0, 30.0, 50.0, 570.0, 60.0, 80.0, 50.0, 30.0, 60.0, 30.0, -20.0, 20.0, 10.0, 60.0, 110.0, 120.0, 20.0, 35.0, 20.0, 50.0, 30.0, 40.0, 30.0, 50.0, 70.0, 10.0, 40.0, 20.0, 50.0, 30.0, 20.0, 40.0, 40.0, 10.0, 40.0, 150.0, 0.0, 10.0, 10.0, 100.0, 10.0, 30.0, 30.0, 80.0, 10.0, 40.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 60.0, 50.0, 180.0, 50.0, 50.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 50.0, 20.0, 10.0, 10.0, 40.0, 40.0, 90.0, 160.0, 80.0, 0.0, -10.0, 0.0, 60.0, 80.0, 20.0, 270.0, 10.0, 30.0, 30.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 20.0, 40.0, 90.0, 20.0, 20.0, 35.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 150.0, 0.0, 0.0, 60.0, 40.0, 10.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 70.0, 20.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 60.0, 10.0, 0.0, 15.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.628270720516039, "mean_inference_ms": 1.4418747557364755, "mean_action_processing_ms": 0.4091172211193673, "mean_env_wait_ms": 1.3070692476840031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012398004531860352, "StateBufferConnector_ms": 0.010637760162353516, "ViewRequirementAgentConnector_ms": 0.39775681495666504}, "num_episodes": 27, "episode_return_max": 1175.0, "episode_return_min": 95.0, "episode_return_mean": 411.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.244443515285486, "num_env_steps_trained_throughput_per_sec": 21.244443515285486, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 187361.708, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187361.662, "sample_time_ms": 2616.537, "learn_time_ms": 184725.232, "learn_throughput": 21.654, "synch_weights_time_ms": 12.023}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 24, "trial_id": "90816_00000", "date": "2024-06-10_01-28-45", "timestamp": 1717997325, "time_this_iter_s": 188.2943720817566, "time_total_s": 4604.244091510773, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00cbd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4604.244091510773, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.580827067669173, "ram_util_percent": 78.75639097744362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0567800316757285, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.992919521336865, "policy_loss": -0.01058768449833218, "vf_loss": 5.001814045794348, "vf_explained_var": 0.005178543369863995, "kl": 0.008465831521319512, "entropy": 1.0759407709518307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 230055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 1175.0, "episode_reward_min": 90.0, "episode_reward_mean": 422.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 570.0}, "policy_reward_mean": {"policy_0": 42.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 250.0, 780.0, 150.0, 135.0, 305.0, 340.0, 370.0, 385.0, 590.0, 500.0, 225.0, 195.0, 180.0, 620.0, 200.0, 170.0, 640.0, 580.0, 460.0, 420.0, 200.0, 485.0, 885.0, 730.0, 200.0, 285.0, 170.0, 320.0, 300.0, 540.0, 290.0, 400.0, 470.0, 270.0, 240.0, 285.0, 350.0, 140.0, 380.0, 540.0, 530.0, 520.0, 350.0, 1175.0, 640.0, 1070.0, 720.0, 380.0, 300.0, 220.0, 210.0, 460.0, 335.0, 585.0, 590.0, 415.0, 950.0, 410.0, 375.0, 360.0, 410.0, 570.0, 490.0, 480.0, 390.0, 95.0, 455.0, 490.0, 940.0, 475.0, 360.0, 410.0, 330.0, 500.0, 430.0, 540.0, 300.0, 205.0, 340.0, 270.0, 215.0, 530.0, 350.0, 410.0, 470.0, 400.0, 690.0, 380.0, 90.0, 350.0, 760.0, 180.0, 485.0, 520.0, 130.0, 830.0, 245.0, 400.0, 545.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 60.0, 20.0, 40.0, 30.0, 40.0, 60.0, 50.0, 200.0, 30.0, 30.0, 0.0, 50.0, 50.0, 270.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 10.0, 30.0, -5.0, 10.0, 20.0, 40.0, 0.0, 10.0, 0.0, 45.0, 40.0, 40.0, 20.0, 40.0, 50.0, 20.0, 10.0, 0.0, 40.0, 50.0, 40.0, 20.0, 20.0, 60.0, 50.0, 30.0, 20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 20.0, 80.0, 10.0, 30.0, 30.0, 50.0, 30.0, -20.0, 40.0, 20.0, 10.0, 10.0, 40.0, 75.0, 40.0, 20.0, 150.0, 0.0, 90.0, 10.0, 100.0, 50.0, 90.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, 180.0, 40.0, -40.0, 30.0, 20.0, 0.0, 260.0, -10.0, 10.0, 50.0, 10.0, 70.0, 40.0, 0.0, 10.0, 20.0, 0.0, 15.0, 45.0, 60.0, -260.0, 40.0, -30.0, 30.0, 170.0, 30.0, 20.0, 90.0, 10.0, 10.0, 10.0, 10.0, 40.0, 0.0, 0.0, 20.0, 70.0, 10.0, 260.0, 40.0, -20.0, 30.0, 40.0, 40.0, 20.0, 30.0, 80.0, 100.0, 20.0, 70.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 30.0, 50.0, 10.0, 150.0, 50.0, 250.0, 40.0, 10.0, 30.0, 220.0, 0.0, 100.0, -110.0, 30.0, 230.0, 0.0, -10.0, 90.0, 60.0, 30.0, 160.0, 40.0, 40.0, 0.0, 50.0, 10.0, 50.0, 20.0, 100.0, 50.0, 20.0, 30.0, 10.0, 20.0, 60.0, 0.0, 80.0, 50.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 30.0, 90.0, 0.0, 30.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 75.0, 10.0, 40.0, 20.0, 270.0, -25.0, 30.0, 50.0, 50.0, 80.0, 30.0, 310.0, 70.0, 0.0, 160.0, 20.0, 300.0, 20.0, 130.0, 40.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 50.0, 0.0, 20.0, 30.0, 25.0, 70.0, 20.0, 30.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 50.0, 50.0, 40.0, 10.0, 10.0, 80.0, 10.0, 0.0, 20.0, 80.0, 10.0, 40.0, 40.0, 40.0, 40.0, 150.0, 10.0, 80.0, 50.0, 80.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 10.0, 60.0, 20.0, 40.0, 30.0, 110.0, 30.0, 30.0, 30.0, 70.0, 0.0, 60.0, 0.0, 90.0, 40.0, 0.0, 40.0, 30.0, 70.0, 30.0, 20.0, 150.0, 0.0, 0.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 60.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 40.0, 80.0, 20.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 20.0, 20.0, 25.0, 70.0, 20.0, 20.0, 30.0, 10.0, 30.0, 70.0, 0.0, 150.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 0.0, 150.0, 0.0, 20.0, 50.0, 60.0, 30.0, 110.0, 60.0, 20.0, 30.0, 40.0, 40.0, 100.0, 40.0, 20.0, 110.0, 40.0, 50.0, 10.0, 60.0, 150.0, 60.0, -10.0, 60.0, 30.0, 90.0, 20.0, 190.0, 10.0, 0.0, 40.0, 40.0, 40.0, 100.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 200.0, 50.0, 310.0, 90.0, 30.0, 240.0, 160.0, 20.0, 60.0, 15.0, 130.0, 70.0, 70.0, 60.0, 10.0, 60.0, 60.0, 30.0, 10.0, 140.0, 190.0, 160.0, 20.0, 60.0, 10.0, 70.0, -10.0, 30.0, 480.0, 60.0, 90.0, 20.0, 30.0, 80.0, 20.0, 30.0, 270.0, 70.0, 40.0, 70.0, 30.0, 70.0, 10.0, 40.0, 40.0, -40.0, 70.0, 30.0, 40.0, 90.0, 20.0, 90.0, 10.0, 10.0, 0.0, 0.0, 50.0, 40.0, 10.0, 70.0, 50.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 30.0, 10.0, 30.0, 0.0, 40.0, 30.0, 70.0, -30.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 160.0, 40.0, 60.0, 80.0, 40.0, 10.0, 0.0, 30.0, 40.0, 5.0, 60.0, 10.0, 30.0, 20.0, 110.0, 30.0, 10.0, 10.0, 50.0, 65.0, 0.0, 200.0, 150.0, 20.0, 50.0, 0.0, 40.0, 60.0, 0.0, 10.0, 120.0, 60.0, 10.0, 50.0, 120.0, 70.0, 40.0, 100.0, 10.0, 10.0, 5.0, 100.0, 10.0, 40.0, 170.0, 20.0, 20.0, 0.0, 40.0, 80.0, 170.0, 40.0, 250.0, -50.0, 40.0, 10.0, 310.0, 40.0, 60.0, 100.0, 10.0, 170.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 145.0, 30.0, 10.0, 30.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 80.0, 40.0, 40.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 30.0, 50.0, 90.0, 40.0, 10.0, 110.0, 50.0, 30.0, 90.0, 20.0, 150.0, 60.0, 10.0, 20.0, 40.0, 20.0, 160.0, 60.0, 60.0, 70.0, 20.0, 20.0, 20.0, 20.0, 80.0, 50.0, 80.0, 40.0, 40.0, 90.0, 20.0, 20.0, 40.0, 110.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 150.0, 20.0, 20.0, -20.0, 10.0, 20.0, 0.0, 20.0, -5.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 40.0, 10.0, 40.0, 70.0, 55.0, 40.0, 30.0, 80.0, 60.0, 80.0, 20.0, 30.0, 10.0, 150.0, 30.0, 20.0, 10.0, 80.0, 30.0, 50.0, 570.0, 60.0, 80.0, 50.0, 30.0, 60.0, 30.0, -20.0, 20.0, 10.0, 60.0, 110.0, 120.0, 20.0, 35.0, 20.0, 50.0, 30.0, 40.0, 30.0, 50.0, 70.0, 10.0, 40.0, 20.0, 50.0, 30.0, 20.0, 40.0, 40.0, 10.0, 40.0, 150.0, 0.0, 10.0, 10.0, 100.0, 10.0, 30.0, 30.0, 80.0, 10.0, 40.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 60.0, 50.0, 180.0, 50.0, 50.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 50.0, 20.0, 10.0, 10.0, 40.0, 40.0, 90.0, 160.0, 80.0, 0.0, -10.0, 0.0, 60.0, 80.0, 20.0, 270.0, 10.0, 30.0, 30.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 20.0, 40.0, 90.0, 20.0, 20.0, 35.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 150.0, 0.0, 0.0, 60.0, 40.0, 10.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 70.0, 20.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 60.0, 10.0, 0.0, 15.0, 40.0, 10.0, 30.0, 60.0, 50.0, 100.0, 20.0, 40.0, 40.0, 160.0, 20.0, 30.0, 10.0, 20.0, 20.0, 50.0, 50.0, 20.0, 10.0, 120.0, 20.0, 20.0, 0.0, 150.0, 20.0, 40.0, 30.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 60.0, 60.0, 20.0, 50.0, 80.0, 20.0, 40.0, 60.0, 160.0, 40.0, 20.0, 10.0, 50.0, 50.0, 70.0, 20.0, -40.0, 20.0, 120.0, 30.0, 170.0, 0.0, 20.0, 80.0, 0.0, 50.0, 60.0, 160.0, 30.0, -20.0, 60.0, 30.0, 190.0, 40.0, -20.0, 0.0, 70.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 60.0, 30.0, 30.0, 40.0, 80.0, 10.0, 50.0, 10.0, 20.0, 20.0, 190.0, 90.0, 160.0, 0.0, 10.0, 40.0, 220.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 90.0, 0.0, 0.0, 30.0, 60.0, 270.0, 20.0, 110.0, 90.0, 10.0, -30.0, -75.0, 120.0, 70.0, 30.0, -40.0, 20.0, 130.0, 10.0, 0.0, 180.0, 0.0, 50.0, 40.0, 0.0, 30.0, 40.0, 30.0, 0.0, -110.0, 30.0, 20.0, 0.0, 50.0, 390.0, -40.0, 60.0, 170.0, 90.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 35.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 20.0, 10.0, 70.0, 270.0, -20.0, 30.0, 60.0, 15.0, 40.0, 40.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6214697052360492, "mean_inference_ms": 1.4361326555326934, "mean_action_processing_ms": 0.40828646652619743, "mean_env_wait_ms": 1.304564463480839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011592388153076172, "StateBufferConnector_ms": 0.010350465774536133, "ViewRequirementAgentConnector_ms": 0.39104342460632324}, "num_episodes": 18, "episode_return_max": 1175.0, "episode_return_min": 90.0, "episode_return_mean": 422.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.654011122560874, "num_env_steps_trained_throughput_per_sec": 21.654011122560874, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 186986.962, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186986.916, "sample_time_ms": 2562.333, "learn_time_ms": 184404.364, "learn_throughput": 21.691, "synch_weights_time_ms": 12.156}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 25, "trial_id": "90816_00000", "date": "2024-06-10_01-31-50", "timestamp": 1717997510, "time_this_iter_s": 184.73151683807373, "time_total_s": 4788.975608348846, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00d55e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4788.975608348846, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.034865900383142, "ram_util_percent": 78.6616858237548}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.273347940663306, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.600073643461965, "policy_loss": -0.01092548864810302, "vf_loss": 5.609514605656218, "vf_explained_var": 0.00481071861280293, "kl": 0.007422637909962128, "entropy": 1.0341564158662058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 239445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 1175.0, "episode_reward_min": 90.0, "episode_reward_mean": 454.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 570.0}, "policy_reward_mean": {"policy_0": 45.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [580.0, 460.0, 420.0, 200.0, 485.0, 885.0, 730.0, 200.0, 285.0, 170.0, 320.0, 300.0, 540.0, 290.0, 400.0, 470.0, 270.0, 240.0, 285.0, 350.0, 140.0, 380.0, 540.0, 530.0, 520.0, 350.0, 1175.0, 640.0, 1070.0, 720.0, 380.0, 300.0, 220.0, 210.0, 460.0, 335.0, 585.0, 590.0, 415.0, 950.0, 410.0, 375.0, 360.0, 410.0, 570.0, 490.0, 480.0, 390.0, 95.0, 455.0, 490.0, 940.0, 475.0, 360.0, 410.0, 330.0, 500.0, 430.0, 540.0, 300.0, 205.0, 340.0, 270.0, 215.0, 530.0, 350.0, 410.0, 470.0, 400.0, 690.0, 380.0, 90.0, 350.0, 760.0, 180.0, 485.0, 520.0, 130.0, 830.0, 245.0, 400.0, 545.0, 745.0, 530.0, 630.0, 830.0, 435.0, 340.0, 430.0, 295.0, 720.0, 545.0, 390.0, 310.0, 470.0, 560.0, 190.0, 575.0, 1000.0, 450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 220.0, 0.0, 100.0, -110.0, 30.0, 230.0, 0.0, -10.0, 90.0, 60.0, 30.0, 160.0, 40.0, 40.0, 0.0, 50.0, 10.0, 50.0, 20.0, 100.0, 50.0, 20.0, 30.0, 10.0, 20.0, 60.0, 0.0, 80.0, 50.0, 10.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 30.0, 90.0, 0.0, 30.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 75.0, 10.0, 40.0, 20.0, 270.0, -25.0, 30.0, 50.0, 50.0, 80.0, 30.0, 310.0, 70.0, 0.0, 160.0, 20.0, 300.0, 20.0, 130.0, 40.0, 0.0, 30.0, 30.0, 40.0, 20.0, 20.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 50.0, 0.0, 20.0, 30.0, 25.0, 70.0, 20.0, 30.0, 30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 50.0, 50.0, 40.0, 10.0, 10.0, 80.0, 10.0, 0.0, 20.0, 80.0, 10.0, 40.0, 40.0, 40.0, 40.0, 150.0, 10.0, 80.0, 50.0, 80.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 20.0, 70.0, 10.0, 60.0, 20.0, 40.0, 30.0, 110.0, 30.0, 30.0, 30.0, 70.0, 0.0, 60.0, 0.0, 90.0, 40.0, 0.0, 40.0, 30.0, 70.0, 30.0, 20.0, 150.0, 0.0, 0.0, 30.0, 10.0, 40.0, 30.0, 40.0, 40.0, 60.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 40.0, 80.0, 20.0, 0.0, 20.0, 30.0, 40.0, 0.0, 40.0, 20.0, 20.0, 25.0, 70.0, 20.0, 20.0, 30.0, 10.0, 30.0, 70.0, 0.0, 150.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 0.0, 150.0, 0.0, 20.0, 50.0, 60.0, 30.0, 110.0, 60.0, 20.0, 30.0, 40.0, 40.0, 100.0, 40.0, 20.0, 110.0, 40.0, 50.0, 10.0, 60.0, 150.0, 60.0, -10.0, 60.0, 30.0, 90.0, 20.0, 190.0, 10.0, 0.0, 40.0, 40.0, 40.0, 100.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 200.0, 50.0, 310.0, 90.0, 30.0, 240.0, 160.0, 20.0, 60.0, 15.0, 130.0, 70.0, 70.0, 60.0, 10.0, 60.0, 60.0, 30.0, 10.0, 140.0, 190.0, 160.0, 20.0, 60.0, 10.0, 70.0, -10.0, 30.0, 480.0, 60.0, 90.0, 20.0, 30.0, 80.0, 20.0, 30.0, 270.0, 70.0, 40.0, 70.0, 30.0, 70.0, 10.0, 40.0, 40.0, -40.0, 70.0, 30.0, 40.0, 90.0, 20.0, 90.0, 10.0, 10.0, 0.0, 0.0, 50.0, 40.0, 10.0, 70.0, 50.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 30.0, 10.0, 30.0, 0.0, 40.0, 30.0, 70.0, -30.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 160.0, 40.0, 60.0, 80.0, 40.0, 10.0, 0.0, 30.0, 40.0, 5.0, 60.0, 10.0, 30.0, 20.0, 110.0, 30.0, 10.0, 10.0, 50.0, 65.0, 0.0, 200.0, 150.0, 20.0, 50.0, 0.0, 40.0, 60.0, 0.0, 10.0, 120.0, 60.0, 10.0, 50.0, 120.0, 70.0, 40.0, 100.0, 10.0, 10.0, 5.0, 100.0, 10.0, 40.0, 170.0, 20.0, 20.0, 0.0, 40.0, 80.0, 170.0, 40.0, 250.0, -50.0, 40.0, 10.0, 310.0, 40.0, 60.0, 100.0, 10.0, 170.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 145.0, 30.0, 10.0, 30.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 80.0, 40.0, 40.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 30.0, 50.0, 90.0, 40.0, 10.0, 110.0, 50.0, 30.0, 90.0, 20.0, 150.0, 60.0, 10.0, 20.0, 40.0, 20.0, 160.0, 60.0, 60.0, 70.0, 20.0, 20.0, 20.0, 20.0, 80.0, 50.0, 80.0, 40.0, 40.0, 90.0, 20.0, 20.0, 40.0, 110.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 150.0, 20.0, 20.0, -20.0, 10.0, 20.0, 0.0, 20.0, -5.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 40.0, 10.0, 40.0, 70.0, 55.0, 40.0, 30.0, 80.0, 60.0, 80.0, 20.0, 30.0, 10.0, 150.0, 30.0, 20.0, 10.0, 80.0, 30.0, 50.0, 570.0, 60.0, 80.0, 50.0, 30.0, 60.0, 30.0, -20.0, 20.0, 10.0, 60.0, 110.0, 120.0, 20.0, 35.0, 20.0, 50.0, 30.0, 40.0, 30.0, 50.0, 70.0, 10.0, 40.0, 20.0, 50.0, 30.0, 20.0, 40.0, 40.0, 10.0, 40.0, 150.0, 0.0, 10.0, 10.0, 100.0, 10.0, 30.0, 30.0, 80.0, 10.0, 40.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 60.0, 50.0, 180.0, 50.0, 50.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 50.0, 20.0, 10.0, 10.0, 40.0, 40.0, 90.0, 160.0, 80.0, 0.0, -10.0, 0.0, 60.0, 80.0, 20.0, 270.0, 10.0, 30.0, 30.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 20.0, 40.0, 90.0, 20.0, 20.0, 35.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 150.0, 0.0, 0.0, 60.0, 40.0, 10.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 70.0, 20.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 60.0, 10.0, 0.0, 15.0, 40.0, 10.0, 30.0, 60.0, 50.0, 100.0, 20.0, 40.0, 40.0, 160.0, 20.0, 30.0, 10.0, 20.0, 20.0, 50.0, 50.0, 20.0, 10.0, 120.0, 20.0, 20.0, 0.0, 150.0, 20.0, 40.0, 30.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 60.0, 60.0, 20.0, 50.0, 80.0, 20.0, 40.0, 60.0, 160.0, 40.0, 20.0, 10.0, 50.0, 50.0, 70.0, 20.0, -40.0, 20.0, 120.0, 30.0, 170.0, 0.0, 20.0, 80.0, 0.0, 50.0, 60.0, 160.0, 30.0, -20.0, 60.0, 30.0, 190.0, 40.0, -20.0, 0.0, 70.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 60.0, 30.0, 30.0, 40.0, 80.0, 10.0, 50.0, 10.0, 20.0, 20.0, 190.0, 90.0, 160.0, 0.0, 10.0, 40.0, 220.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 90.0, 0.0, 0.0, 30.0, 60.0, 270.0, 20.0, 110.0, 90.0, 10.0, -30.0, -75.0, 120.0, 70.0, 30.0, -40.0, 20.0, 130.0, 10.0, 0.0, 180.0, 0.0, 50.0, 40.0, 0.0, 30.0, 40.0, 30.0, 0.0, -110.0, 30.0, 20.0, 0.0, 50.0, 390.0, -40.0, 60.0, 170.0, 90.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 35.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 20.0, 10.0, 70.0, 270.0, -20.0, 30.0, 60.0, 15.0, 40.0, 40.0, 20.0, 20.0, 40.0, 50.0, 100.0, 10.0, 280.0, 0.0, 25.0, 40.0, 160.0, 40.0, 80.0, 70.0, 0.0, 0.0, 160.0, 50.0, 10.0, 50.0, 80.0, 30.0, 70.0, 310.0, 10.0, 20.0, 10.0, 100.0, 30.0, 30.0, 10.0, 40.0, 340.0, 110.0, 40.0, 150.0, 100.0, 10.0, 50.0, 40.0, -20.0, 10.0, 20.0, 50.0, 40.0, 260.0, 10.0, -50.0, 60.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 60.0, 30.0, 20.0, 80.0, 30.0, 50.0, 90.0, 0.0, 40.0, 60.0, 30.0, 40.0, 40.0, 20.0, 70.0, 20.0, 40.0, 10.0, 35.0, 0.0, 20.0, 0.0, 180.0, 50.0, 10.0, 40.0, 20.0, 70.0, 40.0, 50.0, 260.0, 160.0, 30.0, 55.0, 100.0, -40.0, -40.0, 0.0, 190.0, 40.0, 50.0, 20.0, 20.0, 40.0, 90.0, 50.0, 10.0, 50.0, 40.0, 40.0, 30.0, 70.0, 20.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 70.0, 40.0, -50.0, 200.0, 100.0, 30.0, 10.0, 30.0, 20.0, 20.0, 40.0, 60.0, 70.0, 60.0, 0.0, 160.0, 10.0, 70.0, 70.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 30.0, 30.0, 10.0, 65.0, 50.0, 40.0, 30.0, 40.0, 180.0, 20.0, 30.0, 80.0, 40.0, 5.0, 275.0, -20.0, 30.0, 80.0, 70.0, 270.0, 30.0, 110.0, 150.0, 20.0, 110.0, 50.0, 40.0, 0.0, 30.0, 80.0, 20.0, 90.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6172455363020248, "mean_inference_ms": 1.4329758551640088, "mean_action_processing_ms": 0.4194362766645173, "mean_env_wait_ms": 1.301190664610025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012222528457641602, "StateBufferConnector_ms": 0.009279251098632812, "ViewRequirementAgentConnector_ms": 0.3831202983856201}, "num_episodes": 18, "episode_return_max": 1175.0, "episode_return_min": 90.0, "episode_return_mean": 454.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.21782212851292, "num_env_steps_trained_throughput_per_sec": 21.21782212851292, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 187041.362, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187041.315, "sample_time_ms": 2654.207, "learn_time_ms": 184366.885, "learn_throughput": 21.696, "synch_weights_time_ms": 12.303}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 26, "trial_id": "90816_00000", "date": "2024-06-10_01-34-58", "timestamp": 1717997698, "time_this_iter_s": 188.53192496299744, "time_total_s": 4977.507533311844, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00d59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4977.507533311844, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.981647940074907, "ram_util_percent": 79.44831460674158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7532618457707354, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.11698226156834, "policy_loss": -0.010229008519316352, "vf_loss": 5.125561511859345, "vf_explained_var": 0.0029339223433607303, "kl": 0.008248767565676576, "entropy": 1.0446458605595164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 248835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 1175.0, "episode_reward_min": 90.0, "episode_reward_mean": 467.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 570.0}, "policy_reward_mean": {"policy_0": 46.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.0, 350.0, 140.0, 380.0, 540.0, 530.0, 520.0, 350.0, 1175.0, 640.0, 1070.0, 720.0, 380.0, 300.0, 220.0, 210.0, 460.0, 335.0, 585.0, 590.0, 415.0, 950.0, 410.0, 375.0, 360.0, 410.0, 570.0, 490.0, 480.0, 390.0, 95.0, 455.0, 490.0, 940.0, 475.0, 360.0, 410.0, 330.0, 500.0, 430.0, 540.0, 300.0, 205.0, 340.0, 270.0, 215.0, 530.0, 350.0, 410.0, 470.0, 400.0, 690.0, 380.0, 90.0, 350.0, 760.0, 180.0, 485.0, 520.0, 130.0, 830.0, 245.0, 400.0, 545.0, 745.0, 530.0, 630.0, 830.0, 435.0, 340.0, 430.0, 295.0, 720.0, 545.0, 390.0, 310.0, 470.0, 560.0, 190.0, 575.0, 1000.0, 450.0, 380.0, 620.0, 710.0, 330.0, 265.0, 580.0, 360.0, 470.0, 165.0, 585.0, 530.0, 280.0, 640.0, 620.0, 520.0, 680.0, 450.0, 340.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 40.0, 0.0, 40.0, 20.0, 20.0, 25.0, 70.0, 20.0, 20.0, 30.0, 10.0, 30.0, 70.0, 0.0, 150.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 150.0, 0.0, 0.0, 0.0, 150.0, 0.0, 20.0, 50.0, 60.0, 30.0, 110.0, 60.0, 20.0, 30.0, 40.0, 40.0, 100.0, 40.0, 20.0, 110.0, 40.0, 50.0, 10.0, 60.0, 150.0, 60.0, -10.0, 60.0, 30.0, 90.0, 20.0, 190.0, 10.0, 0.0, 40.0, 40.0, 40.0, 100.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 30.0, 30.0, 200.0, 50.0, 310.0, 90.0, 30.0, 240.0, 160.0, 20.0, 60.0, 15.0, 130.0, 70.0, 70.0, 60.0, 10.0, 60.0, 60.0, 30.0, 10.0, 140.0, 190.0, 160.0, 20.0, 60.0, 10.0, 70.0, -10.0, 30.0, 480.0, 60.0, 90.0, 20.0, 30.0, 80.0, 20.0, 30.0, 270.0, 70.0, 40.0, 70.0, 30.0, 70.0, 10.0, 40.0, 40.0, -40.0, 70.0, 30.0, 40.0, 90.0, 20.0, 90.0, 10.0, 10.0, 0.0, 0.0, 50.0, 40.0, 10.0, 70.0, 50.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 30.0, 10.0, 30.0, 0.0, 40.0, 30.0, 70.0, -30.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 160.0, 40.0, 60.0, 80.0, 40.0, 10.0, 0.0, 30.0, 40.0, 5.0, 60.0, 10.0, 30.0, 20.0, 110.0, 30.0, 10.0, 10.0, 50.0, 65.0, 0.0, 200.0, 150.0, 20.0, 50.0, 0.0, 40.0, 60.0, 0.0, 10.0, 120.0, 60.0, 10.0, 50.0, 120.0, 70.0, 40.0, 100.0, 10.0, 10.0, 5.0, 100.0, 10.0, 40.0, 170.0, 20.0, 20.0, 0.0, 40.0, 80.0, 170.0, 40.0, 250.0, -50.0, 40.0, 10.0, 310.0, 40.0, 60.0, 100.0, 10.0, 170.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 145.0, 30.0, 10.0, 30.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 80.0, 40.0, 40.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 30.0, 50.0, 90.0, 40.0, 10.0, 110.0, 50.0, 30.0, 90.0, 20.0, 150.0, 60.0, 10.0, 20.0, 40.0, 20.0, 160.0, 60.0, 60.0, 70.0, 20.0, 20.0, 20.0, 20.0, 80.0, 50.0, 80.0, 40.0, 40.0, 90.0, 20.0, 20.0, 40.0, 110.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 150.0, 20.0, 20.0, -20.0, 10.0, 20.0, 0.0, 20.0, -5.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 40.0, 10.0, 40.0, 70.0, 55.0, 40.0, 30.0, 80.0, 60.0, 80.0, 20.0, 30.0, 10.0, 150.0, 30.0, 20.0, 10.0, 80.0, 30.0, 50.0, 570.0, 60.0, 80.0, 50.0, 30.0, 60.0, 30.0, -20.0, 20.0, 10.0, 60.0, 110.0, 120.0, 20.0, 35.0, 20.0, 50.0, 30.0, 40.0, 30.0, 50.0, 70.0, 10.0, 40.0, 20.0, 50.0, 30.0, 20.0, 40.0, 40.0, 10.0, 40.0, 150.0, 0.0, 10.0, 10.0, 100.0, 10.0, 30.0, 30.0, 80.0, 10.0, 40.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 60.0, 50.0, 180.0, 50.0, 50.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 50.0, 20.0, 10.0, 10.0, 40.0, 40.0, 90.0, 160.0, 80.0, 0.0, -10.0, 0.0, 60.0, 80.0, 20.0, 270.0, 10.0, 30.0, 30.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 20.0, 40.0, 90.0, 20.0, 20.0, 35.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 150.0, 0.0, 0.0, 60.0, 40.0, 10.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 70.0, 20.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 60.0, 10.0, 0.0, 15.0, 40.0, 10.0, 30.0, 60.0, 50.0, 100.0, 20.0, 40.0, 40.0, 160.0, 20.0, 30.0, 10.0, 20.0, 20.0, 50.0, 50.0, 20.0, 10.0, 120.0, 20.0, 20.0, 0.0, 150.0, 20.0, 40.0, 30.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 60.0, 60.0, 20.0, 50.0, 80.0, 20.0, 40.0, 60.0, 160.0, 40.0, 20.0, 10.0, 50.0, 50.0, 70.0, 20.0, -40.0, 20.0, 120.0, 30.0, 170.0, 0.0, 20.0, 80.0, 0.0, 50.0, 60.0, 160.0, 30.0, -20.0, 60.0, 30.0, 190.0, 40.0, -20.0, 0.0, 70.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 60.0, 30.0, 30.0, 40.0, 80.0, 10.0, 50.0, 10.0, 20.0, 20.0, 190.0, 90.0, 160.0, 0.0, 10.0, 40.0, 220.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 90.0, 0.0, 0.0, 30.0, 60.0, 270.0, 20.0, 110.0, 90.0, 10.0, -30.0, -75.0, 120.0, 70.0, 30.0, -40.0, 20.0, 130.0, 10.0, 0.0, 180.0, 0.0, 50.0, 40.0, 0.0, 30.0, 40.0, 30.0, 0.0, -110.0, 30.0, 20.0, 0.0, 50.0, 390.0, -40.0, 60.0, 170.0, 90.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 35.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 20.0, 10.0, 70.0, 270.0, -20.0, 30.0, 60.0, 15.0, 40.0, 40.0, 20.0, 20.0, 40.0, 50.0, 100.0, 10.0, 280.0, 0.0, 25.0, 40.0, 160.0, 40.0, 80.0, 70.0, 0.0, 0.0, 160.0, 50.0, 10.0, 50.0, 80.0, 30.0, 70.0, 310.0, 10.0, 20.0, 10.0, 100.0, 30.0, 30.0, 10.0, 40.0, 340.0, 110.0, 40.0, 150.0, 100.0, 10.0, 50.0, 40.0, -20.0, 10.0, 20.0, 50.0, 40.0, 260.0, 10.0, -50.0, 60.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 60.0, 30.0, 20.0, 80.0, 30.0, 50.0, 90.0, 0.0, 40.0, 60.0, 30.0, 40.0, 40.0, 20.0, 70.0, 20.0, 40.0, 10.0, 35.0, 0.0, 20.0, 0.0, 180.0, 50.0, 10.0, 40.0, 20.0, 70.0, 40.0, 50.0, 260.0, 160.0, 30.0, 55.0, 100.0, -40.0, -40.0, 0.0, 190.0, 40.0, 50.0, 20.0, 20.0, 40.0, 90.0, 50.0, 10.0, 50.0, 40.0, 40.0, 30.0, 70.0, 20.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 70.0, 40.0, -50.0, 200.0, 100.0, 30.0, 10.0, 30.0, 20.0, 20.0, 40.0, 60.0, 70.0, 60.0, 0.0, 160.0, 10.0, 70.0, 70.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 30.0, 30.0, 10.0, 65.0, 50.0, 40.0, 30.0, 40.0, 180.0, 20.0, 30.0, 80.0, 40.0, 5.0, 275.0, -20.0, 30.0, 80.0, 70.0, 270.0, 30.0, 110.0, 150.0, 20.0, 110.0, 50.0, 40.0, 0.0, 30.0, 80.0, 20.0, 90.0, 10.0, 30.0, 40.0, 90.0, 30.0, 70.0, 30.0, 20.0, 30.0, 20.0, 20.0, 120.0, 20.0, 120.0, 190.0, 10.0, 10.0, 30.0, 20.0, 60.0, 40.0, 50.0, 50.0, 20.0, 90.0, 30.0, 10.0, 110.0, 140.0, 20.0, 190.0, 0.0, 30.0, 30.0, 30.0, 20.0, 20.0, 120.0, 60.0, 20.0, 0.0, 80.0, 30.0, 20.0, 20.0, 50.0, 0.0, 30.0, 10.0, -5.0, 30.0, 40.0, 0.0, 60.0, 60.0, 70.0, 70.0, 30.0, 30.0, 80.0, 140.0, 10.0, 30.0, 50.0, 50.0, 40.0, 50.0, 30.0, 40.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 40.0, 20.0, 210.0, 20.0, 10.0, 50.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 40.0, 60.0, 270.0, 50.0, 40.0, 5.0, 40.0, 20.0, 40.0, 70.0, 20.0, -30.0, 50.0, 30.0, 80.0, 210.0, -10.0, 90.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 10.0, 0.0, 60.0, 40.0, 20.0, 50.0, 80.0, 250.0, 50.0, 10.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 70.0, 60.0, 20.0, 50.0, 50.0, 70.0, 30.0, 50.0, 200.0, 30.0, 40.0, 110.0, 10.0, 30.0, 40.0, 80.0, 60.0, 60.0, 60.0, 110.0, 130.0, 270.0, 40.0, 20.0, 0.0, 50.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 90.0, 40.0, 20.0, 140.0, 10.0, 40.0, 70.0, 0.0, 20.0, 100.0, 30.0, 0.0, 20.0, 80.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6131445201009915, "mean_inference_ms": 1.4303098086941803, "mean_action_processing_ms": 0.43020310290332064, "mean_env_wait_ms": 1.2979713340694885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012249469757080078, "StateBufferConnector_ms": 0.00948023796081543, "ViewRequirementAgentConnector_ms": 0.39890146255493164}, "num_episodes": 18, "episode_return_max": 1175.0, "episode_return_min": 90.0, "episode_return_mean": 467.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.441828168104283, "num_env_steps_trained_throughput_per_sec": 21.441828168104283, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 186992.927, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186992.881, "sample_time_ms": 2597.24, "learn_time_ms": 184375.828, "learn_throughput": 21.695, "synch_weights_time_ms": 12.122}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 27, "trial_id": "90816_00000", "date": "2024-06-10_01-38-05", "timestamp": 1717997885, "time_this_iter_s": 186.56251215934753, "time_total_s": 5164.070045471191, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00d5280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5164.070045471191, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.525378787878786, "ram_util_percent": 79.11931818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0294700523725333, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4537673531756745, "policy_loss": -0.010689233719553258, "vf_loss": 5.462945244538264, "vf_explained_var": 0.006803799722903072, "kl": 0.007556693527037377, "entropy": 1.016334864881219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 258225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1000.0, "episode_reward_min": 90.0, "episode_reward_mean": 465.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 570.0}, "policy_reward_mean": {"policy_0": 46.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [585.0, 590.0, 415.0, 950.0, 410.0, 375.0, 360.0, 410.0, 570.0, 490.0, 480.0, 390.0, 95.0, 455.0, 490.0, 940.0, 475.0, 360.0, 410.0, 330.0, 500.0, 430.0, 540.0, 300.0, 205.0, 340.0, 270.0, 215.0, 530.0, 350.0, 410.0, 470.0, 400.0, 690.0, 380.0, 90.0, 350.0, 760.0, 180.0, 485.0, 520.0, 130.0, 830.0, 245.0, 400.0, 545.0, 745.0, 530.0, 630.0, 830.0, 435.0, 340.0, 430.0, 295.0, 720.0, 545.0, 390.0, 310.0, 470.0, 560.0, 190.0, 575.0, 1000.0, 450.0, 380.0, 620.0, 710.0, 330.0, 265.0, 580.0, 360.0, 470.0, 165.0, 585.0, 530.0, 280.0, 640.0, 620.0, 520.0, 680.0, 450.0, 340.0, 310.0, 175.0, 610.0, 420.0, 470.0, 220.0, 500.0, 685.0, 340.0, 870.0, 415.0, 185.0, 790.0, 830.0, 150.0, 540.0, 420.0, 510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [65.0, 0.0, 200.0, 150.0, 20.0, 50.0, 0.0, 40.0, 60.0, 0.0, 10.0, 120.0, 60.0, 10.0, 50.0, 120.0, 70.0, 40.0, 100.0, 10.0, 10.0, 5.0, 100.0, 10.0, 40.0, 170.0, 20.0, 20.0, 0.0, 40.0, 80.0, 170.0, 40.0, 250.0, -50.0, 40.0, 10.0, 310.0, 40.0, 60.0, 100.0, 10.0, 170.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 145.0, 30.0, 10.0, 30.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 80.0, 40.0, 40.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 30.0, 50.0, 90.0, 40.0, 10.0, 110.0, 50.0, 30.0, 90.0, 20.0, 150.0, 60.0, 10.0, 20.0, 40.0, 20.0, 160.0, 60.0, 60.0, 70.0, 20.0, 20.0, 20.0, 20.0, 80.0, 50.0, 80.0, 40.0, 40.0, 90.0, 20.0, 20.0, 40.0, 110.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 150.0, 20.0, 20.0, -20.0, 10.0, 20.0, 0.0, 20.0, -5.0, 0.0, 20.0, 10.0, 40.0, 40.0, 50.0, 40.0, 10.0, 40.0, 70.0, 55.0, 40.0, 30.0, 80.0, 60.0, 80.0, 20.0, 30.0, 10.0, 150.0, 30.0, 20.0, 10.0, 80.0, 30.0, 50.0, 570.0, 60.0, 80.0, 50.0, 30.0, 60.0, 30.0, -20.0, 20.0, 10.0, 60.0, 110.0, 120.0, 20.0, 35.0, 20.0, 50.0, 30.0, 40.0, 30.0, 50.0, 70.0, 10.0, 40.0, 20.0, 50.0, 30.0, 20.0, 40.0, 40.0, 10.0, 40.0, 150.0, 0.0, 10.0, 10.0, 100.0, 10.0, 30.0, 30.0, 80.0, 10.0, 40.0, 30.0, 70.0, 20.0, 10.0, 10.0, 20.0, 60.0, 50.0, 180.0, 50.0, 50.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 50.0, 20.0, 10.0, 10.0, 40.0, 40.0, 90.0, 160.0, 80.0, 0.0, -10.0, 0.0, 60.0, 80.0, 20.0, 270.0, 10.0, 30.0, 30.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 20.0, 40.0, 90.0, 20.0, 20.0, 35.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 150.0, 0.0, 0.0, 60.0, 40.0, 10.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 70.0, 20.0, 20.0, 40.0, 10.0, 10.0, 20.0, 10.0, 60.0, 10.0, 0.0, 15.0, 40.0, 10.0, 30.0, 60.0, 50.0, 100.0, 20.0, 40.0, 40.0, 160.0, 20.0, 30.0, 10.0, 20.0, 20.0, 50.0, 50.0, 20.0, 10.0, 120.0, 20.0, 20.0, 0.0, 150.0, 20.0, 40.0, 30.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 60.0, 60.0, 20.0, 50.0, 80.0, 20.0, 40.0, 60.0, 160.0, 40.0, 20.0, 10.0, 50.0, 50.0, 70.0, 20.0, -40.0, 20.0, 120.0, 30.0, 170.0, 0.0, 20.0, 80.0, 0.0, 50.0, 60.0, 160.0, 30.0, -20.0, 60.0, 30.0, 190.0, 40.0, -20.0, 0.0, 70.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 60.0, 30.0, 30.0, 40.0, 80.0, 10.0, 50.0, 10.0, 20.0, 20.0, 190.0, 90.0, 160.0, 0.0, 10.0, 40.0, 220.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 90.0, 0.0, 0.0, 30.0, 60.0, 270.0, 20.0, 110.0, 90.0, 10.0, -30.0, -75.0, 120.0, 70.0, 30.0, -40.0, 20.0, 130.0, 10.0, 0.0, 180.0, 0.0, 50.0, 40.0, 0.0, 30.0, 40.0, 30.0, 0.0, -110.0, 30.0, 20.0, 0.0, 50.0, 390.0, -40.0, 60.0, 170.0, 90.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 35.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 20.0, 10.0, 70.0, 270.0, -20.0, 30.0, 60.0, 15.0, 40.0, 40.0, 20.0, 20.0, 40.0, 50.0, 100.0, 10.0, 280.0, 0.0, 25.0, 40.0, 160.0, 40.0, 80.0, 70.0, 0.0, 0.0, 160.0, 50.0, 10.0, 50.0, 80.0, 30.0, 70.0, 310.0, 10.0, 20.0, 10.0, 100.0, 30.0, 30.0, 10.0, 40.0, 340.0, 110.0, 40.0, 150.0, 100.0, 10.0, 50.0, 40.0, -20.0, 10.0, 20.0, 50.0, 40.0, 260.0, 10.0, -50.0, 60.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 60.0, 30.0, 20.0, 80.0, 30.0, 50.0, 90.0, 0.0, 40.0, 60.0, 30.0, 40.0, 40.0, 20.0, 70.0, 20.0, 40.0, 10.0, 35.0, 0.0, 20.0, 0.0, 180.0, 50.0, 10.0, 40.0, 20.0, 70.0, 40.0, 50.0, 260.0, 160.0, 30.0, 55.0, 100.0, -40.0, -40.0, 0.0, 190.0, 40.0, 50.0, 20.0, 20.0, 40.0, 90.0, 50.0, 10.0, 50.0, 40.0, 40.0, 30.0, 70.0, 20.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 70.0, 40.0, -50.0, 200.0, 100.0, 30.0, 10.0, 30.0, 20.0, 20.0, 40.0, 60.0, 70.0, 60.0, 0.0, 160.0, 10.0, 70.0, 70.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 30.0, 30.0, 10.0, 65.0, 50.0, 40.0, 30.0, 40.0, 180.0, 20.0, 30.0, 80.0, 40.0, 5.0, 275.0, -20.0, 30.0, 80.0, 70.0, 270.0, 30.0, 110.0, 150.0, 20.0, 110.0, 50.0, 40.0, 0.0, 30.0, 80.0, 20.0, 90.0, 10.0, 30.0, 40.0, 90.0, 30.0, 70.0, 30.0, 20.0, 30.0, 20.0, 20.0, 120.0, 20.0, 120.0, 190.0, 10.0, 10.0, 30.0, 20.0, 60.0, 40.0, 50.0, 50.0, 20.0, 90.0, 30.0, 10.0, 110.0, 140.0, 20.0, 190.0, 0.0, 30.0, 30.0, 30.0, 20.0, 20.0, 120.0, 60.0, 20.0, 0.0, 80.0, 30.0, 20.0, 20.0, 50.0, 0.0, 30.0, 10.0, -5.0, 30.0, 40.0, 0.0, 60.0, 60.0, 70.0, 70.0, 30.0, 30.0, 80.0, 140.0, 10.0, 30.0, 50.0, 50.0, 40.0, 50.0, 30.0, 40.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 40.0, 20.0, 210.0, 20.0, 10.0, 50.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 40.0, 60.0, 270.0, 50.0, 40.0, 5.0, 40.0, 20.0, 40.0, 70.0, 20.0, -30.0, 50.0, 30.0, 80.0, 210.0, -10.0, 90.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 10.0, 0.0, 60.0, 40.0, 20.0, 50.0, 80.0, 250.0, 50.0, 10.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 70.0, 60.0, 20.0, 50.0, 50.0, 70.0, 30.0, 50.0, 200.0, 30.0, 40.0, 110.0, 10.0, 30.0, 40.0, 80.0, 60.0, 60.0, 60.0, 110.0, 130.0, 270.0, 40.0, 20.0, 0.0, 50.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 90.0, 40.0, 20.0, 140.0, 10.0, 40.0, 70.0, 0.0, 20.0, 100.0, 30.0, 0.0, 20.0, 80.0, 20.0, 0.0, 10.0, 60.0, 20.0, 60.0, 0.0, 30.0, 50.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 10.0, -5.0, 0.0, 30.0, 20.0, 30.0, 40.0, 180.0, 30.0, 20.0, 150.0, 40.0, 30.0, 100.0, 20.0, 10.0, 30.0, 20.0, -50.0, 0.0, 40.0, -10.0, 40.0, 40.0, 0.0, 280.0, 60.0, 10.0, 40.0, 40.0, 90.0, 10.0, 80.0, 60.0, 30.0, 100.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 10.0, 20.0, 10.0, -40.0, 260.0, 40.0, 30.0, 10.0, 60.0, 40.0, 30.0, 60.0, 180.0, 30.0, 40.0, 35.0, 90.0, 200.0, -10.0, -20.0, 60.0, 80.0, 10.0, 80.0, 20.0, 100.0, 50.0, 30.0, 30.0, 60.0, -40.0, 0.0, 140.0, 40.0, 10.0, 210.0, 10.0, 100.0, 200.0, 120.0, 30.0, 10.0, 110.0, 15.0, 110.0, 70.0, 60.0, -5.0, 10.0, -5.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 80.0, 35.0, 20.0, 40.0, 90.0, -30.0, -20.0, 110.0, 40.0, 20.0, 480.0, 40.0, 160.0, 90.0, 110.0, 60.0, 70.0, 80.0, 10.0, 0.0, 190.0, 60.0, 20.0, 10.0, 30.0, 10.0, 15.0, 0.0, 0.0, 20.0, 5.0, 40.0, 10.0, 10.0, 0.0, 170.0, 0.0, 10.0, 130.0, -10.0, 70.0, 150.0, 10.0, 10.0, 30.0, 90.0, 50.0, -20.0, 120.0, 50.0, 40.0, 40.0, 80.0, 50.0, 0.0, 80.0, 30.0, 40.0, 170.0, 20.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6086866799006565, "mean_inference_ms": 1.428085954298255, "mean_action_processing_ms": 0.440539837330422, "mean_env_wait_ms": 1.2948917951303085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01208806037902832, "StateBufferConnector_ms": 0.009299755096435547, "ViewRequirementAgentConnector_ms": 0.38410162925720215}, "num_episodes": 18, "episode_return_max": 1000.0, "episode_return_min": 90.0, "episode_return_mean": 465.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.475327725544684, "num_env_steps_trained_throughput_per_sec": 21.475327725544684, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 186945.321, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186945.274, "sample_time_ms": 2573.247, "learn_time_ms": 184352.171, "learn_throughput": 21.698, "synch_weights_time_ms": 12.118}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 28, "trial_id": "90816_00000", "date": "2024-06-10_01-41-11", "timestamp": 1717998071, "time_this_iter_s": 186.27075290679932, "time_total_s": 5350.340798377991, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5350.340798377991, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.367300380228134, "ram_util_percent": 79.47870722433461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7812104585833444, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.125990026014935, "policy_loss": -0.010261655279908317, "vf_loss": 5.134642829478612, "vf_explained_var": 0.005546716417367466, "kl": 0.00804427004020875, "entropy": 0.9787309500419548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 267615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 1000.0, "episode_reward_min": 90.0, "episode_reward_mean": 479.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 47.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [215.0, 530.0, 350.0, 410.0, 470.0, 400.0, 690.0, 380.0, 90.0, 350.0, 760.0, 180.0, 485.0, 520.0, 130.0, 830.0, 245.0, 400.0, 545.0, 745.0, 530.0, 630.0, 830.0, 435.0, 340.0, 430.0, 295.0, 720.0, 545.0, 390.0, 310.0, 470.0, 560.0, 190.0, 575.0, 1000.0, 450.0, 380.0, 620.0, 710.0, 330.0, 265.0, 580.0, 360.0, 470.0, 165.0, 585.0, 530.0, 280.0, 640.0, 620.0, 520.0, 680.0, 450.0, 340.0, 310.0, 175.0, 610.0, 420.0, 470.0, 220.0, 500.0, 685.0, 340.0, 870.0, 415.0, 185.0, 790.0, 830.0, 150.0, 540.0, 420.0, 510.0, 455.0, 495.0, 390.0, 210.0, 660.0, 480.0, 360.0, 425.0, 90.0, 940.0, 900.0, 470.0, 610.0, 735.0, 560.0, 670.0, 910.0, 215.0, 570.0, 460.0, 730.0, 320.0, 270.0, 520.0, 235.0, 650.0, 270.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 10.0, 20.0, 10.0, 60.0, 10.0, 0.0, 15.0, 40.0, 10.0, 30.0, 60.0, 50.0, 100.0, 20.0, 40.0, 40.0, 160.0, 20.0, 30.0, 10.0, 20.0, 20.0, 50.0, 50.0, 20.0, 10.0, 120.0, 20.0, 20.0, 0.0, 150.0, 20.0, 40.0, 30.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 60.0, 60.0, 20.0, 50.0, 80.0, 20.0, 40.0, 60.0, 160.0, 40.0, 20.0, 10.0, 50.0, 50.0, 70.0, 20.0, -40.0, 20.0, 120.0, 30.0, 170.0, 0.0, 20.0, 80.0, 0.0, 50.0, 60.0, 160.0, 30.0, -20.0, 60.0, 30.0, 190.0, 40.0, -20.0, 0.0, 70.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 60.0, 30.0, 30.0, 40.0, 80.0, 10.0, 50.0, 10.0, 20.0, 20.0, 190.0, 90.0, 160.0, 0.0, 10.0, 40.0, 220.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 90.0, 0.0, 0.0, 30.0, 60.0, 270.0, 20.0, 110.0, 90.0, 10.0, -30.0, -75.0, 120.0, 70.0, 30.0, -40.0, 20.0, 130.0, 10.0, 0.0, 180.0, 0.0, 50.0, 40.0, 0.0, 30.0, 40.0, 30.0, 0.0, -110.0, 30.0, 20.0, 0.0, 50.0, 390.0, -40.0, 60.0, 170.0, 90.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 35.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 0.0, 30.0, 200.0, 20.0, 50.0, 20.0, 0.0, 20.0, 10.0, 70.0, 270.0, -20.0, 30.0, 60.0, 15.0, 40.0, 40.0, 20.0, 20.0, 40.0, 50.0, 100.0, 10.0, 280.0, 0.0, 25.0, 40.0, 160.0, 40.0, 80.0, 70.0, 0.0, 0.0, 160.0, 50.0, 10.0, 50.0, 80.0, 30.0, 70.0, 310.0, 10.0, 20.0, 10.0, 100.0, 30.0, 30.0, 10.0, 40.0, 340.0, 110.0, 40.0, 150.0, 100.0, 10.0, 50.0, 40.0, -20.0, 10.0, 20.0, 50.0, 40.0, 260.0, 10.0, -50.0, 60.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 60.0, 30.0, 20.0, 80.0, 30.0, 50.0, 90.0, 0.0, 40.0, 60.0, 30.0, 40.0, 40.0, 20.0, 70.0, 20.0, 40.0, 10.0, 35.0, 0.0, 20.0, 0.0, 180.0, 50.0, 10.0, 40.0, 20.0, 70.0, 40.0, 50.0, 260.0, 160.0, 30.0, 55.0, 100.0, -40.0, -40.0, 0.0, 190.0, 40.0, 50.0, 20.0, 20.0, 40.0, 90.0, 50.0, 10.0, 50.0, 40.0, 40.0, 30.0, 70.0, 20.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 70.0, 40.0, -50.0, 200.0, 100.0, 30.0, 10.0, 30.0, 20.0, 20.0, 40.0, 60.0, 70.0, 60.0, 0.0, 160.0, 10.0, 70.0, 70.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 30.0, 30.0, 10.0, 65.0, 50.0, 40.0, 30.0, 40.0, 180.0, 20.0, 30.0, 80.0, 40.0, 5.0, 275.0, -20.0, 30.0, 80.0, 70.0, 270.0, 30.0, 110.0, 150.0, 20.0, 110.0, 50.0, 40.0, 0.0, 30.0, 80.0, 20.0, 90.0, 10.0, 30.0, 40.0, 90.0, 30.0, 70.0, 30.0, 20.0, 30.0, 20.0, 20.0, 120.0, 20.0, 120.0, 190.0, 10.0, 10.0, 30.0, 20.0, 60.0, 40.0, 50.0, 50.0, 20.0, 90.0, 30.0, 10.0, 110.0, 140.0, 20.0, 190.0, 0.0, 30.0, 30.0, 30.0, 20.0, 20.0, 120.0, 60.0, 20.0, 0.0, 80.0, 30.0, 20.0, 20.0, 50.0, 0.0, 30.0, 10.0, -5.0, 30.0, 40.0, 0.0, 60.0, 60.0, 70.0, 70.0, 30.0, 30.0, 80.0, 140.0, 10.0, 30.0, 50.0, 50.0, 40.0, 50.0, 30.0, 40.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 40.0, 20.0, 210.0, 20.0, 10.0, 50.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 40.0, 60.0, 270.0, 50.0, 40.0, 5.0, 40.0, 20.0, 40.0, 70.0, 20.0, -30.0, 50.0, 30.0, 80.0, 210.0, -10.0, 90.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 10.0, 0.0, 60.0, 40.0, 20.0, 50.0, 80.0, 250.0, 50.0, 10.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 70.0, 60.0, 20.0, 50.0, 50.0, 70.0, 30.0, 50.0, 200.0, 30.0, 40.0, 110.0, 10.0, 30.0, 40.0, 80.0, 60.0, 60.0, 60.0, 110.0, 130.0, 270.0, 40.0, 20.0, 0.0, 50.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 90.0, 40.0, 20.0, 140.0, 10.0, 40.0, 70.0, 0.0, 20.0, 100.0, 30.0, 0.0, 20.0, 80.0, 20.0, 0.0, 10.0, 60.0, 20.0, 60.0, 0.0, 30.0, 50.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 10.0, -5.0, 0.0, 30.0, 20.0, 30.0, 40.0, 180.0, 30.0, 20.0, 150.0, 40.0, 30.0, 100.0, 20.0, 10.0, 30.0, 20.0, -50.0, 0.0, 40.0, -10.0, 40.0, 40.0, 0.0, 280.0, 60.0, 10.0, 40.0, 40.0, 90.0, 10.0, 80.0, 60.0, 30.0, 100.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 10.0, 20.0, 10.0, -40.0, 260.0, 40.0, 30.0, 10.0, 60.0, 40.0, 30.0, 60.0, 180.0, 30.0, 40.0, 35.0, 90.0, 200.0, -10.0, -20.0, 60.0, 80.0, 10.0, 80.0, 20.0, 100.0, 50.0, 30.0, 30.0, 60.0, -40.0, 0.0, 140.0, 40.0, 10.0, 210.0, 10.0, 100.0, 200.0, 120.0, 30.0, 10.0, 110.0, 15.0, 110.0, 70.0, 60.0, -5.0, 10.0, -5.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 80.0, 35.0, 20.0, 40.0, 90.0, -30.0, -20.0, 110.0, 40.0, 20.0, 480.0, 40.0, 160.0, 90.0, 110.0, 60.0, 70.0, 80.0, 10.0, 0.0, 190.0, 60.0, 20.0, 10.0, 30.0, 10.0, 15.0, 0.0, 0.0, 20.0, 5.0, 40.0, 10.0, 10.0, 0.0, 170.0, 0.0, 10.0, 130.0, -10.0, 70.0, 150.0, 10.0, 10.0, 30.0, 90.0, 50.0, -20.0, 120.0, 50.0, 40.0, 40.0, 80.0, 50.0, 0.0, 80.0, 30.0, 40.0, 170.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 25.0, 70.0, 170.0, 110.0, 30.0, 20.0, 0.0, 0.0, 40.0, 40.0, 70.0, 130.0, 20.0, 40.0, 20.0, 20.0, 115.0, 10.0, 50.0, 40.0, 0.0, 0.0, 0.0, 10.0, 90.0, 30.0, 160.0, 10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, -80.0, 80.0, -60.0, 570.0, 40.0, -30.0, 0.0, 80.0, 20.0, 40.0, 10.0, 160.0, 30.0, 10.0, 70.0, 20.0, 0.0, 0.0, 20.0, 160.0, 0.0, 10.0, 40.0, 10.0, 50.0, 20.0, 10.0, 0.0, 180.0, 40.0, 50.0, 25.0, 30.0, 50.0, 110.0, 30.0, 10.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 130.0, 40.0, 130.0, 170.0, 20.0, 80.0, 60.0, 170.0, 80.0, 60.0, 80.0, 10.0, 200.0, 20.0, 220.0, 50.0, 200.0, 60.0, 30.0, 30.0, 90.0, 10.0, 90.0, 30.0, 20.0, 10.0, 60.0, 60.0, 10.0, 90.0, 20.0, 40.0, 80.0, 80.0, 80.0, 20.0, 40.0, 40.0, 150.0, 60.0, 110.0, 110.0, 45.0, 20.0, 20.0, 230.0, 30.0, 40.0, 130.0, 0.0, 20.0, 0.0, 10.0, 20.0, 110.0, 30.0, 120.0, 30.0, 200.0, 20.0, 110.0, 160.0, 120.0, 20.0, 20.0, 30.0, 40.0, 30.0, 40.0, 100.0, 40.0, 170.0, 260.0, 10.0, 60.0, 70.0, 40.0, 30.0, 70.0, 160.0, 40.0, 20.0, 0.0, 10.0, -25.0, 40.0, 0.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, -90.0, 20.0, -50.0, 10.0, 600.0, 20.0, 90.0, 30.0, 30.0, 10.0, 50.0, 40.0, 10.0, 50.0, 80.0, 70.0, 20.0, 0.0, 40.0, 20.0, 110.0, 30.0, 160.0, 160.0, 80.0, 110.0, 30.0, 40.0, 40.0, 0.0, 0.0, 90.0, 40.0, 60.0, 20.0, 0.0, 50.0, 20.0, 50.0, 20.0, 10.0, 60.0, 0.0, 10.0, 0.0, 50.0, 20.0, 60.0, 20.0, 70.0, 40.0, 160.0, 0.0, 60.0, 40.0, 50.0, 20.0, 30.0, 40.0, 10.0, 40.0, 30.0, 40.0, 0.0, 30.0, -5.0, 50.0, 160.0, 260.0, 0.0, 80.0, 70.0, -10.0, 0.0, 0.0, 40.0, 90.0, 0.0, 10.0, 40.0, 80.0, 0.0, 0.0, 0.0, 20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6031127426287204, "mean_inference_ms": 1.4262881614501135, "mean_action_processing_ms": 0.45573211470639285, "mean_env_wait_ms": 1.2910874156104173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012679815292358398, "StateBufferConnector_ms": 0.009602546691894531, "ViewRequirementAgentConnector_ms": 0.37581634521484375}, "num_episodes": 27, "episode_return_max": 1000.0, "episode_return_min": 90.0, "episode_return_mean": 479.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.283418548835005, "num_env_steps_trained_throughput_per_sec": 21.283418548835005, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 187044.584, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187044.537, "sample_time_ms": 2582.36, "learn_time_ms": 184442.463, "learn_throughput": 21.687, "synch_weights_time_ms": 12.087}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 29, "trial_id": "90816_00000", "date": "2024-06-10_01-44-19", "timestamp": 1717998259, "time_this_iter_s": 187.94740509986877, "time_total_s": 5538.2882034778595, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00cbaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5538.2882034778595, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.122932330827066, "ram_util_percent": 80.06278195488721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5491988170578583, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.270754712102766, "policy_loss": -0.010418131148033003, "vf_loss": 5.2795668909471, "vf_explained_var": 0.0010631403983972325, "kl": 0.008029758273975637, "entropy": 0.9628196132703584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 277005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 1000.0, "episode_reward_min": 90.0, "episode_reward_mean": 507.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 50.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [545.0, 745.0, 530.0, 630.0, 830.0, 435.0, 340.0, 430.0, 295.0, 720.0, 545.0, 390.0, 310.0, 470.0, 560.0, 190.0, 575.0, 1000.0, 450.0, 380.0, 620.0, 710.0, 330.0, 265.0, 580.0, 360.0, 470.0, 165.0, 585.0, 530.0, 280.0, 640.0, 620.0, 520.0, 680.0, 450.0, 340.0, 310.0, 175.0, 610.0, 420.0, 470.0, 220.0, 500.0, 685.0, 340.0, 870.0, 415.0, 185.0, 790.0, 830.0, 150.0, 540.0, 420.0, 510.0, 455.0, 495.0, 390.0, 210.0, 660.0, 480.0, 360.0, 425.0, 90.0, 940.0, 900.0, 470.0, 610.0, 735.0, 560.0, 670.0, 910.0, 215.0, 570.0, 460.0, 730.0, 320.0, 270.0, 520.0, 235.0, 650.0, 270.0, 385.0, 250.0, 470.0, 335.0, 790.0, 800.0, 320.0, 510.0, 430.0, 590.0, 775.0, 290.0, 920.0, 710.0, 515.0, 820.0, 710.0, 555.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 270.0, -20.0, 30.0, 60.0, 15.0, 40.0, 40.0, 20.0, 20.0, 40.0, 50.0, 100.0, 10.0, 280.0, 0.0, 25.0, 40.0, 160.0, 40.0, 80.0, 70.0, 0.0, 0.0, 160.0, 50.0, 10.0, 50.0, 80.0, 30.0, 70.0, 310.0, 10.0, 20.0, 10.0, 100.0, 30.0, 30.0, 10.0, 40.0, 340.0, 110.0, 40.0, 150.0, 100.0, 10.0, 50.0, 40.0, -20.0, 10.0, 20.0, 50.0, 40.0, 260.0, 10.0, -50.0, 60.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 80.0, 20.0, 80.0, 60.0, 30.0, 20.0, 80.0, 30.0, 50.0, 90.0, 0.0, 40.0, 60.0, 30.0, 40.0, 40.0, 20.0, 70.0, 20.0, 40.0, 10.0, 35.0, 0.0, 20.0, 0.0, 180.0, 50.0, 10.0, 40.0, 20.0, 70.0, 40.0, 50.0, 260.0, 160.0, 30.0, 55.0, 100.0, -40.0, -40.0, 0.0, 190.0, 40.0, 50.0, 20.0, 20.0, 40.0, 90.0, 50.0, 10.0, 50.0, 40.0, 40.0, 30.0, 70.0, 20.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 20.0, 90.0, 20.0, 70.0, 40.0, -50.0, 200.0, 100.0, 30.0, 10.0, 30.0, 20.0, 20.0, 40.0, 60.0, 70.0, 60.0, 0.0, 160.0, 10.0, 70.0, 70.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 40.0, 30.0, 30.0, 10.0, 65.0, 50.0, 40.0, 30.0, 40.0, 180.0, 20.0, 30.0, 80.0, 40.0, 5.0, 275.0, -20.0, 30.0, 80.0, 70.0, 270.0, 30.0, 110.0, 150.0, 20.0, 110.0, 50.0, 40.0, 0.0, 30.0, 80.0, 20.0, 90.0, 10.0, 30.0, 40.0, 90.0, 30.0, 70.0, 30.0, 20.0, 30.0, 20.0, 20.0, 120.0, 20.0, 120.0, 190.0, 10.0, 10.0, 30.0, 20.0, 60.0, 40.0, 50.0, 50.0, 20.0, 90.0, 30.0, 10.0, 110.0, 140.0, 20.0, 190.0, 0.0, 30.0, 30.0, 30.0, 20.0, 20.0, 120.0, 60.0, 20.0, 0.0, 80.0, 30.0, 20.0, 20.0, 50.0, 0.0, 30.0, 10.0, -5.0, 30.0, 40.0, 0.0, 60.0, 60.0, 70.0, 70.0, 30.0, 30.0, 80.0, 140.0, 10.0, 30.0, 50.0, 50.0, 40.0, 50.0, 30.0, 40.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 40.0, 20.0, 210.0, 20.0, 10.0, 50.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 40.0, 60.0, 270.0, 50.0, 40.0, 5.0, 40.0, 20.0, 40.0, 70.0, 20.0, -30.0, 50.0, 30.0, 80.0, 210.0, -10.0, 90.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 10.0, 0.0, 60.0, 40.0, 20.0, 50.0, 80.0, 250.0, 50.0, 10.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 70.0, 60.0, 20.0, 50.0, 50.0, 70.0, 30.0, 50.0, 200.0, 30.0, 40.0, 110.0, 10.0, 30.0, 40.0, 80.0, 60.0, 60.0, 60.0, 110.0, 130.0, 270.0, 40.0, 20.0, 0.0, 50.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 90.0, 40.0, 20.0, 140.0, 10.0, 40.0, 70.0, 0.0, 20.0, 100.0, 30.0, 0.0, 20.0, 80.0, 20.0, 0.0, 10.0, 60.0, 20.0, 60.0, 0.0, 30.0, 50.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 10.0, -5.0, 0.0, 30.0, 20.0, 30.0, 40.0, 180.0, 30.0, 20.0, 150.0, 40.0, 30.0, 100.0, 20.0, 10.0, 30.0, 20.0, -50.0, 0.0, 40.0, -10.0, 40.0, 40.0, 0.0, 280.0, 60.0, 10.0, 40.0, 40.0, 90.0, 10.0, 80.0, 60.0, 30.0, 100.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 10.0, 20.0, 10.0, -40.0, 260.0, 40.0, 30.0, 10.0, 60.0, 40.0, 30.0, 60.0, 180.0, 30.0, 40.0, 35.0, 90.0, 200.0, -10.0, -20.0, 60.0, 80.0, 10.0, 80.0, 20.0, 100.0, 50.0, 30.0, 30.0, 60.0, -40.0, 0.0, 140.0, 40.0, 10.0, 210.0, 10.0, 100.0, 200.0, 120.0, 30.0, 10.0, 110.0, 15.0, 110.0, 70.0, 60.0, -5.0, 10.0, -5.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 80.0, 35.0, 20.0, 40.0, 90.0, -30.0, -20.0, 110.0, 40.0, 20.0, 480.0, 40.0, 160.0, 90.0, 110.0, 60.0, 70.0, 80.0, 10.0, 0.0, 190.0, 60.0, 20.0, 10.0, 30.0, 10.0, 15.0, 0.0, 0.0, 20.0, 5.0, 40.0, 10.0, 10.0, 0.0, 170.0, 0.0, 10.0, 130.0, -10.0, 70.0, 150.0, 10.0, 10.0, 30.0, 90.0, 50.0, -20.0, 120.0, 50.0, 40.0, 40.0, 80.0, 50.0, 0.0, 80.0, 30.0, 40.0, 170.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 25.0, 70.0, 170.0, 110.0, 30.0, 20.0, 0.0, 0.0, 40.0, 40.0, 70.0, 130.0, 20.0, 40.0, 20.0, 20.0, 115.0, 10.0, 50.0, 40.0, 0.0, 0.0, 0.0, 10.0, 90.0, 30.0, 160.0, 10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, -80.0, 80.0, -60.0, 570.0, 40.0, -30.0, 0.0, 80.0, 20.0, 40.0, 10.0, 160.0, 30.0, 10.0, 70.0, 20.0, 0.0, 0.0, 20.0, 160.0, 0.0, 10.0, 40.0, 10.0, 50.0, 20.0, 10.0, 0.0, 180.0, 40.0, 50.0, 25.0, 30.0, 50.0, 110.0, 30.0, 10.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 130.0, 40.0, 130.0, 170.0, 20.0, 80.0, 60.0, 170.0, 80.0, 60.0, 80.0, 10.0, 200.0, 20.0, 220.0, 50.0, 200.0, 60.0, 30.0, 30.0, 90.0, 10.0, 90.0, 30.0, 20.0, 10.0, 60.0, 60.0, 10.0, 90.0, 20.0, 40.0, 80.0, 80.0, 80.0, 20.0, 40.0, 40.0, 150.0, 60.0, 110.0, 110.0, 45.0, 20.0, 20.0, 230.0, 30.0, 40.0, 130.0, 0.0, 20.0, 0.0, 10.0, 20.0, 110.0, 30.0, 120.0, 30.0, 200.0, 20.0, 110.0, 160.0, 120.0, 20.0, 20.0, 30.0, 40.0, 30.0, 40.0, 100.0, 40.0, 170.0, 260.0, 10.0, 60.0, 70.0, 40.0, 30.0, 70.0, 160.0, 40.0, 20.0, 0.0, 10.0, -25.0, 40.0, 0.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, -90.0, 20.0, -50.0, 10.0, 600.0, 20.0, 90.0, 30.0, 30.0, 10.0, 50.0, 40.0, 10.0, 50.0, 80.0, 70.0, 20.0, 0.0, 40.0, 20.0, 110.0, 30.0, 160.0, 160.0, 80.0, 110.0, 30.0, 40.0, 40.0, 0.0, 0.0, 90.0, 40.0, 60.0, 20.0, 0.0, 50.0, 20.0, 50.0, 20.0, 10.0, 60.0, 0.0, 10.0, 0.0, 50.0, 20.0, 60.0, 20.0, 70.0, 40.0, 160.0, 0.0, 60.0, 40.0, 50.0, 20.0, 30.0, 40.0, 10.0, 40.0, 30.0, 40.0, 0.0, 30.0, -5.0, 50.0, 160.0, 260.0, 0.0, 80.0, 70.0, -10.0, 0.0, 0.0, 40.0, 90.0, 0.0, 10.0, 40.0, 80.0, 0.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 45.0, 20.0, 20.0, 20.0, 170.0, 60.0, 30.0, 0.0, 30.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 100.0, 90.0, 40.0, 50.0, 40.0, 20.0, 50.0, 20.0, 10.0, 30.0, 120.0, 10.0, 80.0, 30.0, 20.0, 50.0, 50.0, 40.0, 20.0, 40.0, -5.0, 170.0, 30.0, 70.0, 150.0, 10.0, 100.0, 70.0, 100.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 80.0, 350.0, 50.0, 70.0, 110.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 60.0, 30.0, 40.0, 90.0, 10.0, 30.0, 60.0, 80.0, 30.0, 80.0, 20.0, 70.0, 70.0, 60.0, 30.0, 110.0, 70.0, 40.0, 50.0, 70.0, 20.0, 0.0, 30.0, 10.0, 40.0, 240.0, 30.0, 0.0, 10.0, 40.0, 150.0, 20.0, 40.0, 20.0, 30.0, 50.0, 50.0, -5.0, 50.0, 250.0, 70.0, 0.0, 250.0, 30.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 90.0, 10.0, 20.0, 130.0, 80.0, 70.0, 80.0, 30.0, 60.0, 50.0, 100.0, 60.0, 260.0, 260.0, 80.0, 170.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 0.0, -5.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 30.0, 290.0, 60.0, 20.0, 370.0, -10.0, 190.0, 160.0, -20.0, 0.0, 150.0, -40.0, 0.0, 50.0, 90.0, 180.0, 40.0, 100.0, 10.0, -5.0, 170.0, 20.0, 55.0, -10.0, 80.0, 0.0, 60.0, 210.0, 20.0, 70.0, -5.0, 50.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5992415708890695, "mean_inference_ms": 1.425744830075281, "mean_action_processing_ms": 0.46543191416679436, "mean_env_wait_ms": 1.2888483535280637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01276087760925293, "StateBufferConnector_ms": 0.009669780731201172, "ViewRequirementAgentConnector_ms": 0.37874293327331543}, "num_episodes": 18, "episode_return_max": 1000.0, "episode_return_min": 90.0, "episode_return_mean": 507.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.54793095075554, "num_env_steps_trained_throughput_per_sec": 21.54793095075554, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 186979.822, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186979.775, "sample_time_ms": 2568.249, "learn_time_ms": 184391.674, "learn_throughput": 21.693, "synch_weights_time_ms": 12.376}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 30, "trial_id": "90816_00000", "date": "2024-06-10_01-47-25", "timestamp": 1717998445, "time_this_iter_s": 185.6402268409729, "time_total_s": 5723.928430318832, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00c0670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5723.928430318832, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.9293893129771, "ram_util_percent": 78.78435114503817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.317620251861751, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4115480147484645, "policy_loss": -0.010531223008852487, "vf_loss": 5.4205520560820135, "vf_explained_var": 0.009985725503886978, "kl": 0.007635928619507372, "entropy": 0.9544347807685661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 286395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 1160.0, "episode_reward_min": 90.0, "episode_reward_mean": 508.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 50.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [450.0, 380.0, 620.0, 710.0, 330.0, 265.0, 580.0, 360.0, 470.0, 165.0, 585.0, 530.0, 280.0, 640.0, 620.0, 520.0, 680.0, 450.0, 340.0, 310.0, 175.0, 610.0, 420.0, 470.0, 220.0, 500.0, 685.0, 340.0, 870.0, 415.0, 185.0, 790.0, 830.0, 150.0, 540.0, 420.0, 510.0, 455.0, 495.0, 390.0, 210.0, 660.0, 480.0, 360.0, 425.0, 90.0, 940.0, 900.0, 470.0, 610.0, 735.0, 560.0, 670.0, 910.0, 215.0, 570.0, 460.0, 730.0, 320.0, 270.0, 520.0, 235.0, 650.0, 270.0, 385.0, 250.0, 470.0, 335.0, 790.0, 800.0, 320.0, 510.0, 430.0, 590.0, 775.0, 290.0, 920.0, 710.0, 515.0, 820.0, 710.0, 555.0, 150.0, 315.0, 640.0, 800.0, 600.0, 500.0, 530.0, 520.0, 1160.0, 540.0, 220.0, 410.0, 640.0, 325.0, 900.0, 730.0, 315.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 110.0, 50.0, 40.0, 0.0, 30.0, 80.0, 20.0, 90.0, 10.0, 30.0, 40.0, 90.0, 30.0, 70.0, 30.0, 20.0, 30.0, 20.0, 20.0, 120.0, 20.0, 120.0, 190.0, 10.0, 10.0, 30.0, 20.0, 60.0, 40.0, 50.0, 50.0, 20.0, 90.0, 30.0, 10.0, 110.0, 140.0, 20.0, 190.0, 0.0, 30.0, 30.0, 30.0, 20.0, 20.0, 120.0, 60.0, 20.0, 0.0, 80.0, 30.0, 20.0, 20.0, 50.0, 0.0, 30.0, 10.0, -5.0, 30.0, 40.0, 0.0, 60.0, 60.0, 70.0, 70.0, 30.0, 30.0, 80.0, 140.0, 10.0, 30.0, 50.0, 50.0, 40.0, 50.0, 30.0, 40.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 40.0, 20.0, 210.0, 20.0, 10.0, 50.0, 30.0, 60.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 5.0, 0.0, 20.0, 40.0, 60.0, 270.0, 50.0, 40.0, 5.0, 40.0, 20.0, 40.0, 70.0, 20.0, -30.0, 50.0, 30.0, 80.0, 210.0, -10.0, 90.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 10.0, 0.0, 60.0, 40.0, 20.0, 50.0, 80.0, 250.0, 50.0, 10.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 70.0, 60.0, 20.0, 50.0, 50.0, 70.0, 30.0, 50.0, 200.0, 30.0, 40.0, 110.0, 10.0, 30.0, 40.0, 80.0, 60.0, 60.0, 60.0, 110.0, 130.0, 270.0, 40.0, 20.0, 0.0, 50.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 90.0, 40.0, 20.0, 140.0, 10.0, 40.0, 70.0, 0.0, 20.0, 100.0, 30.0, 0.0, 20.0, 80.0, 20.0, 0.0, 10.0, 60.0, 20.0, 60.0, 0.0, 30.0, 50.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 10.0, -5.0, 0.0, 30.0, 20.0, 30.0, 40.0, 180.0, 30.0, 20.0, 150.0, 40.0, 30.0, 100.0, 20.0, 10.0, 30.0, 20.0, -50.0, 0.0, 40.0, -10.0, 40.0, 40.0, 0.0, 280.0, 60.0, 10.0, 40.0, 40.0, 90.0, 10.0, 80.0, 60.0, 30.0, 100.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 10.0, 20.0, 10.0, -40.0, 260.0, 40.0, 30.0, 10.0, 60.0, 40.0, 30.0, 60.0, 180.0, 30.0, 40.0, 35.0, 90.0, 200.0, -10.0, -20.0, 60.0, 80.0, 10.0, 80.0, 20.0, 100.0, 50.0, 30.0, 30.0, 60.0, -40.0, 0.0, 140.0, 40.0, 10.0, 210.0, 10.0, 100.0, 200.0, 120.0, 30.0, 10.0, 110.0, 15.0, 110.0, 70.0, 60.0, -5.0, 10.0, -5.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 80.0, 35.0, 20.0, 40.0, 90.0, -30.0, -20.0, 110.0, 40.0, 20.0, 480.0, 40.0, 160.0, 90.0, 110.0, 60.0, 70.0, 80.0, 10.0, 0.0, 190.0, 60.0, 20.0, 10.0, 30.0, 10.0, 15.0, 0.0, 0.0, 20.0, 5.0, 40.0, 10.0, 10.0, 0.0, 170.0, 0.0, 10.0, 130.0, -10.0, 70.0, 150.0, 10.0, 10.0, 30.0, 90.0, 50.0, -20.0, 120.0, 50.0, 40.0, 40.0, 80.0, 50.0, 0.0, 80.0, 30.0, 40.0, 170.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 25.0, 70.0, 170.0, 110.0, 30.0, 20.0, 0.0, 0.0, 40.0, 40.0, 70.0, 130.0, 20.0, 40.0, 20.0, 20.0, 115.0, 10.0, 50.0, 40.0, 0.0, 0.0, 0.0, 10.0, 90.0, 30.0, 160.0, 10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, -80.0, 80.0, -60.0, 570.0, 40.0, -30.0, 0.0, 80.0, 20.0, 40.0, 10.0, 160.0, 30.0, 10.0, 70.0, 20.0, 0.0, 0.0, 20.0, 160.0, 0.0, 10.0, 40.0, 10.0, 50.0, 20.0, 10.0, 0.0, 180.0, 40.0, 50.0, 25.0, 30.0, 50.0, 110.0, 30.0, 10.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 130.0, 40.0, 130.0, 170.0, 20.0, 80.0, 60.0, 170.0, 80.0, 60.0, 80.0, 10.0, 200.0, 20.0, 220.0, 50.0, 200.0, 60.0, 30.0, 30.0, 90.0, 10.0, 90.0, 30.0, 20.0, 10.0, 60.0, 60.0, 10.0, 90.0, 20.0, 40.0, 80.0, 80.0, 80.0, 20.0, 40.0, 40.0, 150.0, 60.0, 110.0, 110.0, 45.0, 20.0, 20.0, 230.0, 30.0, 40.0, 130.0, 0.0, 20.0, 0.0, 10.0, 20.0, 110.0, 30.0, 120.0, 30.0, 200.0, 20.0, 110.0, 160.0, 120.0, 20.0, 20.0, 30.0, 40.0, 30.0, 40.0, 100.0, 40.0, 170.0, 260.0, 10.0, 60.0, 70.0, 40.0, 30.0, 70.0, 160.0, 40.0, 20.0, 0.0, 10.0, -25.0, 40.0, 0.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, -90.0, 20.0, -50.0, 10.0, 600.0, 20.0, 90.0, 30.0, 30.0, 10.0, 50.0, 40.0, 10.0, 50.0, 80.0, 70.0, 20.0, 0.0, 40.0, 20.0, 110.0, 30.0, 160.0, 160.0, 80.0, 110.0, 30.0, 40.0, 40.0, 0.0, 0.0, 90.0, 40.0, 60.0, 20.0, 0.0, 50.0, 20.0, 50.0, 20.0, 10.0, 60.0, 0.0, 10.0, 0.0, 50.0, 20.0, 60.0, 20.0, 70.0, 40.0, 160.0, 0.0, 60.0, 40.0, 50.0, 20.0, 30.0, 40.0, 10.0, 40.0, 30.0, 40.0, 0.0, 30.0, -5.0, 50.0, 160.0, 260.0, 0.0, 80.0, 70.0, -10.0, 0.0, 0.0, 40.0, 90.0, 0.0, 10.0, 40.0, 80.0, 0.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 45.0, 20.0, 20.0, 20.0, 170.0, 60.0, 30.0, 0.0, 30.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 100.0, 90.0, 40.0, 50.0, 40.0, 20.0, 50.0, 20.0, 10.0, 30.0, 120.0, 10.0, 80.0, 30.0, 20.0, 50.0, 50.0, 40.0, 20.0, 40.0, -5.0, 170.0, 30.0, 70.0, 150.0, 10.0, 100.0, 70.0, 100.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 80.0, 350.0, 50.0, 70.0, 110.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 60.0, 30.0, 40.0, 90.0, 10.0, 30.0, 60.0, 80.0, 30.0, 80.0, 20.0, 70.0, 70.0, 60.0, 30.0, 110.0, 70.0, 40.0, 50.0, 70.0, 20.0, 0.0, 30.0, 10.0, 40.0, 240.0, 30.0, 0.0, 10.0, 40.0, 150.0, 20.0, 40.0, 20.0, 30.0, 50.0, 50.0, -5.0, 50.0, 250.0, 70.0, 0.0, 250.0, 30.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 90.0, 10.0, 20.0, 130.0, 80.0, 70.0, 80.0, 30.0, 60.0, 50.0, 100.0, 60.0, 260.0, 260.0, 80.0, 170.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 0.0, -5.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 30.0, 290.0, 60.0, 20.0, 370.0, -10.0, 190.0, 160.0, -20.0, 0.0, 150.0, -40.0, 0.0, 50.0, 90.0, 180.0, 40.0, 100.0, 10.0, -5.0, 170.0, 20.0, 55.0, -10.0, 80.0, 0.0, 60.0, 210.0, 20.0, 70.0, -5.0, 50.0, 80.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 20.0, 15.0, 40.0, 40.0, 50.0, 50.0, 20.0, 40.0, 30.0, 90.0, 70.0, 110.0, 50.0, 60.0, 70.0, 60.0, 30.0, 80.0, 20.0, 50.0, 120.0, 10.0, 160.0, 30.0, 50.0, 70.0, 140.0, 70.0, 100.0, 40.0, 170.0, 60.0, 10.0, 50.0, 40.0, 30.0, 20.0, 150.0, 30.0, 60.0, 50.0, 40.0, 100.0, 0.0, 40.0, 50.0, 50.0, 20.0, 90.0, 60.0, 30.0, 30.0, 40.0, 20.0, 70.0, 20.0, 20.0, 210.0, 30.0, 0.0, 60.0, 70.0, 140.0, 70.0, 90.0, 0.0, -30.0, 40.0, 80.0, 540.0, 160.0, -30.0, 30.0, 70.0, 70.0, 70.0, 70.0, 90.0, 90.0, 40.0, 50.0, 250.0, 0.0, 10.0, -10.0, 40.0, 0.0, 150.0, 10.0, 90.0, 10.0, 30.0, 0.0, 0.0, -10.0, 70.0, 0.0, 10.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 10.0, 0.0, 190.0, 20.0, -30.0, -160.0, 180.0, 170.0, 60.0, 90.0, 120.0, 10.0, 40.0, 160.0, -40.0, 10.0, -50.0, 30.0, 60.0, 45.0, 180.0, 40.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 80.0, 340.0, 40.0, 140.0, 230.0, 40.0, 0.0, 20.0, 60.0, 200.0, 90.0, 90.0, 130.0, 40.0, 40.0, 60.0, 130.0, 10.0, 20.0, -5.0, 50.0, 70.0, 30.0, 0.0, 10.0, 0.0, 20.0, 80.0, 40.0, 20.0, 110.0, 30.0, 10.0, 10.0, 40.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5947678872531716, "mean_inference_ms": 1.4247537708481082, "mean_action_processing_ms": 0.46334184686190055, "mean_env_wait_ms": 1.2868166468548818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012901067733764648, "StateBufferConnector_ms": 0.009712934494018555, "ViewRequirementAgentConnector_ms": 0.38962841033935547}, "num_episodes": 18, "episode_return_max": 1160.0, "episode_return_min": 90.0, "episode_return_mean": 508.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.743861751992142, "num_env_steps_trained_throughput_per_sec": 21.743861751992142, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 186748.453, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186748.406, "sample_time_ms": 2568.781, "learn_time_ms": 184159.492, "learn_throughput": 21.72, "synch_weights_time_ms": 12.525}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 31, "trial_id": "90816_00000", "date": "2024-06-10_01-50-29", "timestamp": 1717998629, "time_this_iter_s": 183.9684600830078, "time_total_s": 5907.89689040184, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f29820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5907.89689040184, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 17.001923076923077, "ram_util_percent": 78.17884615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4786934532867835, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4053645321101556, "policy_loss": -0.009711171662052091, "vf_loss": 5.413587037214456, "vf_explained_var": 0.0014955625874292864, "kl": 0.007443299984732084, "entropy": 0.9560010637782507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 1180.0, "episode_reward_min": 90.0, "episode_reward_mean": 523.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 52.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0, 310.0, 175.0, 610.0, 420.0, 470.0, 220.0, 500.0, 685.0, 340.0, 870.0, 415.0, 185.0, 790.0, 830.0, 150.0, 540.0, 420.0, 510.0, 455.0, 495.0, 390.0, 210.0, 660.0, 480.0, 360.0, 425.0, 90.0, 940.0, 900.0, 470.0, 610.0, 735.0, 560.0, 670.0, 910.0, 215.0, 570.0, 460.0, 730.0, 320.0, 270.0, 520.0, 235.0, 650.0, 270.0, 385.0, 250.0, 470.0, 335.0, 790.0, 800.0, 320.0, 510.0, 430.0, 590.0, 775.0, 290.0, 920.0, 710.0, 515.0, 820.0, 710.0, 555.0, 150.0, 315.0, 640.0, 800.0, 600.0, 500.0, 530.0, 520.0, 1160.0, 540.0, 220.0, 410.0, 640.0, 325.0, 900.0, 730.0, 315.0, 370.0, 980.0, 990.0, 190.0, 490.0, 210.0, 1180.0, 350.0, 705.0, 360.0, 235.0, 1035.0, 265.0, 680.0, 490.0, 565.0, 230.0, 965.0, 240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 0.0, 20.0, 100.0, 30.0, 0.0, 20.0, 80.0, 20.0, 0.0, 10.0, 60.0, 20.0, 60.0, 0.0, 30.0, 50.0, 30.0, 30.0, 20.0, 10.0, 10.0, 30.0, 10.0, -5.0, 0.0, 30.0, 20.0, 30.0, 40.0, 180.0, 30.0, 20.0, 150.0, 40.0, 30.0, 100.0, 20.0, 10.0, 30.0, 20.0, -50.0, 0.0, 40.0, -10.0, 40.0, 40.0, 0.0, 280.0, 60.0, 10.0, 40.0, 40.0, 90.0, 10.0, 80.0, 60.0, 30.0, 100.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 10.0, 20.0, 10.0, -40.0, 260.0, 40.0, 30.0, 10.0, 60.0, 40.0, 30.0, 60.0, 180.0, 30.0, 40.0, 35.0, 90.0, 200.0, -10.0, -20.0, 60.0, 80.0, 10.0, 80.0, 20.0, 100.0, 50.0, 30.0, 30.0, 60.0, -40.0, 0.0, 140.0, 40.0, 10.0, 210.0, 10.0, 100.0, 200.0, 120.0, 30.0, 10.0, 110.0, 15.0, 110.0, 70.0, 60.0, -5.0, 10.0, -5.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 80.0, 35.0, 20.0, 40.0, 90.0, -30.0, -20.0, 110.0, 40.0, 20.0, 480.0, 40.0, 160.0, 90.0, 110.0, 60.0, 70.0, 80.0, 10.0, 0.0, 190.0, 60.0, 20.0, 10.0, 30.0, 10.0, 15.0, 0.0, 0.0, 20.0, 5.0, 40.0, 10.0, 10.0, 0.0, 170.0, 0.0, 10.0, 130.0, -10.0, 70.0, 150.0, 10.0, 10.0, 30.0, 90.0, 50.0, -20.0, 120.0, 50.0, 40.0, 40.0, 80.0, 50.0, 0.0, 80.0, 30.0, 40.0, 170.0, 20.0, 20.0, 20.0, 10.0, 20.0, 0.0, 25.0, 70.0, 170.0, 110.0, 30.0, 20.0, 0.0, 0.0, 40.0, 40.0, 70.0, 130.0, 20.0, 40.0, 20.0, 20.0, 115.0, 10.0, 50.0, 40.0, 0.0, 0.0, 0.0, 10.0, 90.0, 30.0, 160.0, 10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, -80.0, 80.0, -60.0, 570.0, 40.0, -30.0, 0.0, 80.0, 20.0, 40.0, 10.0, 160.0, 30.0, 10.0, 70.0, 20.0, 0.0, 0.0, 20.0, 160.0, 0.0, 10.0, 40.0, 10.0, 50.0, 20.0, 10.0, 0.0, 180.0, 40.0, 50.0, 25.0, 30.0, 50.0, 110.0, 30.0, 10.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 130.0, 40.0, 130.0, 170.0, 20.0, 80.0, 60.0, 170.0, 80.0, 60.0, 80.0, 10.0, 200.0, 20.0, 220.0, 50.0, 200.0, 60.0, 30.0, 30.0, 90.0, 10.0, 90.0, 30.0, 20.0, 10.0, 60.0, 60.0, 10.0, 90.0, 20.0, 40.0, 80.0, 80.0, 80.0, 20.0, 40.0, 40.0, 150.0, 60.0, 110.0, 110.0, 45.0, 20.0, 20.0, 230.0, 30.0, 40.0, 130.0, 0.0, 20.0, 0.0, 10.0, 20.0, 110.0, 30.0, 120.0, 30.0, 200.0, 20.0, 110.0, 160.0, 120.0, 20.0, 20.0, 30.0, 40.0, 30.0, 40.0, 100.0, 40.0, 170.0, 260.0, 10.0, 60.0, 70.0, 40.0, 30.0, 70.0, 160.0, 40.0, 20.0, 0.0, 10.0, -25.0, 40.0, 0.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, -90.0, 20.0, -50.0, 10.0, 600.0, 20.0, 90.0, 30.0, 30.0, 10.0, 50.0, 40.0, 10.0, 50.0, 80.0, 70.0, 20.0, 0.0, 40.0, 20.0, 110.0, 30.0, 160.0, 160.0, 80.0, 110.0, 30.0, 40.0, 40.0, 0.0, 0.0, 90.0, 40.0, 60.0, 20.0, 0.0, 50.0, 20.0, 50.0, 20.0, 10.0, 60.0, 0.0, 10.0, 0.0, 50.0, 20.0, 60.0, 20.0, 70.0, 40.0, 160.0, 0.0, 60.0, 40.0, 50.0, 20.0, 30.0, 40.0, 10.0, 40.0, 30.0, 40.0, 0.0, 30.0, -5.0, 50.0, 160.0, 260.0, 0.0, 80.0, 70.0, -10.0, 0.0, 0.0, 40.0, 90.0, 0.0, 10.0, 40.0, 80.0, 0.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 45.0, 20.0, 20.0, 20.0, 170.0, 60.0, 30.0, 0.0, 30.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 100.0, 90.0, 40.0, 50.0, 40.0, 20.0, 50.0, 20.0, 10.0, 30.0, 120.0, 10.0, 80.0, 30.0, 20.0, 50.0, 50.0, 40.0, 20.0, 40.0, -5.0, 170.0, 30.0, 70.0, 150.0, 10.0, 100.0, 70.0, 100.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 80.0, 350.0, 50.0, 70.0, 110.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 60.0, 30.0, 40.0, 90.0, 10.0, 30.0, 60.0, 80.0, 30.0, 80.0, 20.0, 70.0, 70.0, 60.0, 30.0, 110.0, 70.0, 40.0, 50.0, 70.0, 20.0, 0.0, 30.0, 10.0, 40.0, 240.0, 30.0, 0.0, 10.0, 40.0, 150.0, 20.0, 40.0, 20.0, 30.0, 50.0, 50.0, -5.0, 50.0, 250.0, 70.0, 0.0, 250.0, 30.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 90.0, 10.0, 20.0, 130.0, 80.0, 70.0, 80.0, 30.0, 60.0, 50.0, 100.0, 60.0, 260.0, 260.0, 80.0, 170.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 0.0, -5.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 30.0, 290.0, 60.0, 20.0, 370.0, -10.0, 190.0, 160.0, -20.0, 0.0, 150.0, -40.0, 0.0, 50.0, 90.0, 180.0, 40.0, 100.0, 10.0, -5.0, 170.0, 20.0, 55.0, -10.0, 80.0, 0.0, 60.0, 210.0, 20.0, 70.0, -5.0, 50.0, 80.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 20.0, 15.0, 40.0, 40.0, 50.0, 50.0, 20.0, 40.0, 30.0, 90.0, 70.0, 110.0, 50.0, 60.0, 70.0, 60.0, 30.0, 80.0, 20.0, 50.0, 120.0, 10.0, 160.0, 30.0, 50.0, 70.0, 140.0, 70.0, 100.0, 40.0, 170.0, 60.0, 10.0, 50.0, 40.0, 30.0, 20.0, 150.0, 30.0, 60.0, 50.0, 40.0, 100.0, 0.0, 40.0, 50.0, 50.0, 20.0, 90.0, 60.0, 30.0, 30.0, 40.0, 20.0, 70.0, 20.0, 20.0, 210.0, 30.0, 0.0, 60.0, 70.0, 140.0, 70.0, 90.0, 0.0, -30.0, 40.0, 80.0, 540.0, 160.0, -30.0, 30.0, 70.0, 70.0, 70.0, 70.0, 90.0, 90.0, 40.0, 50.0, 250.0, 0.0, 10.0, -10.0, 40.0, 0.0, 150.0, 10.0, 90.0, 10.0, 30.0, 0.0, 0.0, -10.0, 70.0, 0.0, 10.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 10.0, 0.0, 190.0, 20.0, -30.0, -160.0, 180.0, 170.0, 60.0, 90.0, 120.0, 10.0, 40.0, 160.0, -40.0, 10.0, -50.0, 30.0, 60.0, 45.0, 180.0, 40.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 80.0, 340.0, 40.0, 140.0, 230.0, 40.0, 0.0, 20.0, 60.0, 200.0, 90.0, 90.0, 130.0, 40.0, 40.0, 60.0, 130.0, 10.0, 20.0, -5.0, 50.0, 70.0, 30.0, 0.0, 10.0, 0.0, 20.0, 80.0, 40.0, 20.0, 110.0, 30.0, 10.0, 10.0, 40.0, 10.0, 70.0, 20.0, 0.0, 300.0, 170.0, 70.0, 70.0, 180.0, 70.0, 30.0, 490.0, -40.0, 80.0, 100.0, 30.0, 40.0, 30.0, 60.0, 160.0, 40.0, 10.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 90.0, 10.0, 70.0, 60.0, 40.0, 70.0, 30.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 80.0, 20.0, 20.0, 110.0, 20.0, -30.0, 110.0, 320.0, 20.0, 110.0, 170.0, 310.0, 40.0, 10.0, 20.0, -10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 10.0, 210.0, 0.0, 0.0, 40.0, 310.0, 30.0, 5.0, 30.0, 90.0, 20.0, 70.0, 40.0, 20.0, 40.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 50.0, 15.0, 20.0, 310.0, 30.0, 100.0, 35.0, 190.0, 180.0, 70.0, 10.0, 70.0, 40.0, 120.0, 20.0, 30.0, 30.0, -5.0, 0.0, 0.0, 40.0, 20.0, 10.0, 80.0, 70.0, 70.0, 50.0, 100.0, 60.0, 60.0, 110.0, 20.0, 60.0, 230.0, 50.0, 30.0, 160.0, 20.0, 30.0, -50.0, 20.0, 0.0, 0.0, -5.0, 70.0, -10.0, 80.0, 30.0, 70.0, -10.0, 60.0, 260.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 70.0, -40.0, 160.0, 30.0, 35.0, 10.0, 180.0, 40.0, 160.0, 100.0, 200.0, 50.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 20.0, 50.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.590098428215107, "mean_inference_ms": 1.4239767990850956, "mean_action_processing_ms": 0.4608943210432195, "mean_env_wait_ms": 1.2849224242267743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012218713760375977, "StateBufferConnector_ms": 0.009534358978271484, "ViewRequirementAgentConnector_ms": 0.37824344635009766}, "num_episodes": 18, "episode_return_max": 1180.0, "episode_return_min": 90.0, "episode_return_mean": 523.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.458648844389767, "num_env_steps_trained_throughput_per_sec": 21.458648844389767, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 186625.985, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186625.938, "sample_time_ms": 2533.946, "learn_time_ms": 184071.617, "learn_throughput": 21.731, "synch_weights_time_ms": 12.593}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 32, "trial_id": "90816_00000", "date": "2024-06-10_01-53-35", "timestamp": 1717998815, "time_this_iter_s": 186.4127299785614, "time_total_s": 6094.309620380402, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00c0040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6094.309620380402, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.08030303030303, "ram_util_percent": 78.00416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5008970506846335, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4608299296504015, "policy_loss": -0.01067483300370183, "vf_loss": 5.46993571952763, "vf_explained_var": 0.0008531646416210138, "kl": 0.007845198216707127, "entropy": 0.9082405061196215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 305175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 1180.0, "episode_reward_min": 90.0, "episode_reward_mean": 557.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 55.77}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 660.0, 480.0, 360.0, 425.0, 90.0, 940.0, 900.0, 470.0, 610.0, 735.0, 560.0, 670.0, 910.0, 215.0, 570.0, 460.0, 730.0, 320.0, 270.0, 520.0, 235.0, 650.0, 270.0, 385.0, 250.0, 470.0, 335.0, 790.0, 800.0, 320.0, 510.0, 430.0, 590.0, 775.0, 290.0, 920.0, 710.0, 515.0, 820.0, 710.0, 555.0, 150.0, 315.0, 640.0, 800.0, 600.0, 500.0, 530.0, 520.0, 1160.0, 540.0, 220.0, 410.0, 640.0, 325.0, 900.0, 730.0, 315.0, 370.0, 980.0, 990.0, 190.0, 490.0, 210.0, 1180.0, 350.0, 705.0, 360.0, 235.0, 1035.0, 265.0, 680.0, 490.0, 565.0, 230.0, 965.0, 240.0, 940.0, 430.0, 750.0, 535.0, 800.0, 280.0, 560.0, 570.0, 1160.0, 670.0, 690.0, 460.0, 280.0, 870.0, 970.0, 750.0, 190.0, 545.0, 465.0, 245.0, 650.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, -80.0, 80.0, -60.0, 570.0, 40.0, -30.0, 0.0, 80.0, 20.0, 40.0, 10.0, 160.0, 30.0, 10.0, 70.0, 20.0, 0.0, 0.0, 20.0, 160.0, 0.0, 10.0, 40.0, 10.0, 50.0, 20.0, 10.0, 0.0, 180.0, 40.0, 50.0, 25.0, 30.0, 50.0, 110.0, 30.0, 10.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 130.0, 40.0, 130.0, 170.0, 20.0, 80.0, 60.0, 170.0, 80.0, 60.0, 80.0, 10.0, 200.0, 20.0, 220.0, 50.0, 200.0, 60.0, 30.0, 30.0, 90.0, 10.0, 90.0, 30.0, 20.0, 10.0, 60.0, 60.0, 10.0, 90.0, 20.0, 40.0, 80.0, 80.0, 80.0, 20.0, 40.0, 40.0, 150.0, 60.0, 110.0, 110.0, 45.0, 20.0, 20.0, 230.0, 30.0, 40.0, 130.0, 0.0, 20.0, 0.0, 10.0, 20.0, 110.0, 30.0, 120.0, 30.0, 200.0, 20.0, 110.0, 160.0, 120.0, 20.0, 20.0, 30.0, 40.0, 30.0, 40.0, 100.0, 40.0, 170.0, 260.0, 10.0, 60.0, 70.0, 40.0, 30.0, 70.0, 160.0, 40.0, 20.0, 0.0, 10.0, -25.0, 40.0, 0.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 0.0, -90.0, 20.0, -50.0, 10.0, 600.0, 20.0, 90.0, 30.0, 30.0, 10.0, 50.0, 40.0, 10.0, 50.0, 80.0, 70.0, 20.0, 0.0, 40.0, 20.0, 110.0, 30.0, 160.0, 160.0, 80.0, 110.0, 30.0, 40.0, 40.0, 0.0, 0.0, 90.0, 40.0, 60.0, 20.0, 0.0, 50.0, 20.0, 50.0, 20.0, 10.0, 60.0, 0.0, 10.0, 0.0, 50.0, 20.0, 60.0, 20.0, 70.0, 40.0, 160.0, 0.0, 60.0, 40.0, 50.0, 20.0, 30.0, 40.0, 10.0, 40.0, 30.0, 40.0, 0.0, 30.0, -5.0, 50.0, 160.0, 260.0, 0.0, 80.0, 70.0, -10.0, 0.0, 0.0, 40.0, 90.0, 0.0, 10.0, 40.0, 80.0, 0.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 45.0, 20.0, 20.0, 20.0, 170.0, 60.0, 30.0, 0.0, 30.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 100.0, 90.0, 40.0, 50.0, 40.0, 20.0, 50.0, 20.0, 10.0, 30.0, 120.0, 10.0, 80.0, 30.0, 20.0, 50.0, 50.0, 40.0, 20.0, 40.0, -5.0, 170.0, 30.0, 70.0, 150.0, 10.0, 100.0, 70.0, 100.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 80.0, 350.0, 50.0, 70.0, 110.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 60.0, 30.0, 40.0, 90.0, 10.0, 30.0, 60.0, 80.0, 30.0, 80.0, 20.0, 70.0, 70.0, 60.0, 30.0, 110.0, 70.0, 40.0, 50.0, 70.0, 20.0, 0.0, 30.0, 10.0, 40.0, 240.0, 30.0, 0.0, 10.0, 40.0, 150.0, 20.0, 40.0, 20.0, 30.0, 50.0, 50.0, -5.0, 50.0, 250.0, 70.0, 0.0, 250.0, 30.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 90.0, 10.0, 20.0, 130.0, 80.0, 70.0, 80.0, 30.0, 60.0, 50.0, 100.0, 60.0, 260.0, 260.0, 80.0, 170.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 0.0, -5.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 30.0, 290.0, 60.0, 20.0, 370.0, -10.0, 190.0, 160.0, -20.0, 0.0, 150.0, -40.0, 0.0, 50.0, 90.0, 180.0, 40.0, 100.0, 10.0, -5.0, 170.0, 20.0, 55.0, -10.0, 80.0, 0.0, 60.0, 210.0, 20.0, 70.0, -5.0, 50.0, 80.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 20.0, 15.0, 40.0, 40.0, 50.0, 50.0, 20.0, 40.0, 30.0, 90.0, 70.0, 110.0, 50.0, 60.0, 70.0, 60.0, 30.0, 80.0, 20.0, 50.0, 120.0, 10.0, 160.0, 30.0, 50.0, 70.0, 140.0, 70.0, 100.0, 40.0, 170.0, 60.0, 10.0, 50.0, 40.0, 30.0, 20.0, 150.0, 30.0, 60.0, 50.0, 40.0, 100.0, 0.0, 40.0, 50.0, 50.0, 20.0, 90.0, 60.0, 30.0, 30.0, 40.0, 20.0, 70.0, 20.0, 20.0, 210.0, 30.0, 0.0, 60.0, 70.0, 140.0, 70.0, 90.0, 0.0, -30.0, 40.0, 80.0, 540.0, 160.0, -30.0, 30.0, 70.0, 70.0, 70.0, 70.0, 90.0, 90.0, 40.0, 50.0, 250.0, 0.0, 10.0, -10.0, 40.0, 0.0, 150.0, 10.0, 90.0, 10.0, 30.0, 0.0, 0.0, -10.0, 70.0, 0.0, 10.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 10.0, 0.0, 190.0, 20.0, -30.0, -160.0, 180.0, 170.0, 60.0, 90.0, 120.0, 10.0, 40.0, 160.0, -40.0, 10.0, -50.0, 30.0, 60.0, 45.0, 180.0, 40.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 80.0, 340.0, 40.0, 140.0, 230.0, 40.0, 0.0, 20.0, 60.0, 200.0, 90.0, 90.0, 130.0, 40.0, 40.0, 60.0, 130.0, 10.0, 20.0, -5.0, 50.0, 70.0, 30.0, 0.0, 10.0, 0.0, 20.0, 80.0, 40.0, 20.0, 110.0, 30.0, 10.0, 10.0, 40.0, 10.0, 70.0, 20.0, 0.0, 300.0, 170.0, 70.0, 70.0, 180.0, 70.0, 30.0, 490.0, -40.0, 80.0, 100.0, 30.0, 40.0, 30.0, 60.0, 160.0, 40.0, 10.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 90.0, 10.0, 70.0, 60.0, 40.0, 70.0, 30.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 80.0, 20.0, 20.0, 110.0, 20.0, -30.0, 110.0, 320.0, 20.0, 110.0, 170.0, 310.0, 40.0, 10.0, 20.0, -10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 10.0, 210.0, 0.0, 0.0, 40.0, 310.0, 30.0, 5.0, 30.0, 90.0, 20.0, 70.0, 40.0, 20.0, 40.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 50.0, 15.0, 20.0, 310.0, 30.0, 100.0, 35.0, 190.0, 180.0, 70.0, 10.0, 70.0, 40.0, 120.0, 20.0, 30.0, 30.0, -5.0, 0.0, 0.0, 40.0, 20.0, 10.0, 80.0, 70.0, 70.0, 50.0, 100.0, 60.0, 60.0, 110.0, 20.0, 60.0, 230.0, 50.0, 30.0, 160.0, 20.0, 30.0, -50.0, 20.0, 0.0, 0.0, -5.0, 70.0, -10.0, 80.0, 30.0, 70.0, -10.0, 60.0, 260.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 70.0, -40.0, 160.0, 30.0, 35.0, 10.0, 180.0, 40.0, 160.0, 100.0, 200.0, 50.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 20.0, 50.0, 0.0, 0.0, 340.0, 90.0, 110.0, 150.0, -150.0, 10.0, 240.0, 110.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 150.0, 60.0, 50.0, 20.0, 40.0, 50.0, 30.0, 10.0, 90.0, 20.0, 290.0, 180.0, 20.0, 40.0, 40.0, 30.0, 30.0, 160.0, 70.0, 40.0, 80.0, 90.0, 30.0, 10.0, 15.0, 10.0, 0.0, 70.0, 100.0, 200.0, 100.0, -10.0, 90.0, 160.0, 10.0, 80.0, 10.0, 40.0, 10.0, 80.0, 0.0, 60.0, 10.0, 40.0, 0.0, 30.0, 50.0, 20.0, 170.0, 150.0, 10.0, 20.0, 40.0, 30.0, 70.0, 0.0, 50.0, 10.0, 40.0, 150.0, 80.0, 20.0, 150.0, 0.0, 60.0, 10.0, 290.0, 50.0, 50.0, 70.0, 90.0, 40.0, 160.0, 190.0, 160.0, 60.0, 60.0, 280.0, 70.0, 50.0, 30.0, 10.0, 20.0, 80.0, 40.0, 30.0, 20.0, 130.0, 60.0, 120.0, 40.0, 50.0, 50.0, 0.0, 180.0, 40.0, 20.0, 40.0, 190.0, 30.0, 30.0, 20.0, 20.0, 30.0, 50.0, 30.0, 50.0, 10.0, 50.0, 20.0, 110.0, 0.0, 15.0, 0.0, 5.0, 20.0, 20.0, 50.0, 50.0, 70.0, 160.0, 150.0, 50.0, 370.0, -50.0, 0.0, 270.0, 40.0, 80.0, 50.0, 40.0, 50.0, 90.0, 170.0, 100.0, 80.0, 10.0, 80.0, 120.0, 70.0, 250.0, 50.0, 50.0, 80.0, -50.0, 90.0, 30.0, 40.0, 70.0, 20.0, -370.0, 10.0, 190.0, 80.0, 20.0, 100.0, 30.0, 50.0, 80.0, 40.0, 20.0, 40.0, 155.0, 30.0, 80.0, 20.0, 0.0, 35.0, 40.0, 0.0, 110.0, 100.0, 30.0, 50.0, 40.0, 60.0, 20.0, 90.0, 50.0, 0.0, 10.0, 0.0, 0.0, 10.0, 35.0, 30.0, 30.0, 20.0, 80.0, 90.0, 200.0, 20.0, 20.0, 100.0, 80.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 0.0, -10.0, 80.0, 470.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5853866513020867, "mean_inference_ms": 1.4238908455399502, "mean_action_processing_ms": 0.4583511305599035, "mean_env_wait_ms": 1.2825438540485843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012155771255493164, "StateBufferConnector_ms": 0.009451866149902344, "ViewRequirementAgentConnector_ms": 0.37732410430908203}, "num_episodes": 22, "episode_return_max": 1180.0, "episode_return_min": 90.0, "episode_return_mean": 557.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.484413234543187, "num_env_steps_trained_throughput_per_sec": 21.484413234543187, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 186445.905, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186445.859, "sample_time_ms": 2503.9, "learn_time_ms": 183921.009, "learn_throughput": 21.748, "synch_weights_time_ms": 13.137}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 33, "trial_id": "90816_00000", "date": "2024-06-10_01-56-41", "timestamp": 1717999001, "time_this_iter_s": 186.19199204444885, "time_total_s": 6280.5016124248505, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00cc790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6280.5016124248505, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 19.216730038022813, "ram_util_percent": 78.39201520912547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.640370337999921, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.996575630917209, "policy_loss": -0.009669052435137744, "vf_loss": 5.004647828824223, "vf_explained_var": 0.00548210680421295, "kl": 0.00798426237812511, "entropy": 0.9193678119058172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 314565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 1180.0, "episode_reward_min": 150.0, "episode_reward_mean": 558.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 540.0}, "policy_reward_mean": {"policy_0": 55.845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.0, 385.0, 250.0, 470.0, 335.0, 790.0, 800.0, 320.0, 510.0, 430.0, 590.0, 775.0, 290.0, 920.0, 710.0, 515.0, 820.0, 710.0, 555.0, 150.0, 315.0, 640.0, 800.0, 600.0, 500.0, 530.0, 520.0, 1160.0, 540.0, 220.0, 410.0, 640.0, 325.0, 900.0, 730.0, 315.0, 370.0, 980.0, 990.0, 190.0, 490.0, 210.0, 1180.0, 350.0, 705.0, 360.0, 235.0, 1035.0, 265.0, 680.0, 490.0, 565.0, 230.0, 965.0, 240.0, 940.0, 430.0, 750.0, 535.0, 800.0, 280.0, 560.0, 570.0, 1160.0, 670.0, 690.0, 460.0, 280.0, 870.0, 970.0, 750.0, 190.0, 545.0, 465.0, 245.0, 650.0, 700.0, 600.0, 970.0, 415.0, 235.0, 170.0, 330.0, 920.0, 860.0, 580.0, 715.0, 490.0, 375.0, 500.0, 170.0, 1180.0, 330.0, 530.0, 290.0, 340.0, 635.0, 500.0, 660.0, 270.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 0.0, 10.0, 40.0, 80.0, 0.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 45.0, 20.0, 20.0, 20.0, 170.0, 60.0, 30.0, 0.0, 30.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 100.0, 90.0, 40.0, 50.0, 40.0, 20.0, 50.0, 20.0, 10.0, 30.0, 120.0, 10.0, 80.0, 30.0, 20.0, 50.0, 50.0, 40.0, 20.0, 40.0, -5.0, 170.0, 30.0, 70.0, 150.0, 10.0, 100.0, 70.0, 100.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 80.0, 350.0, 50.0, 70.0, 110.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 60.0, 30.0, 40.0, 90.0, 10.0, 30.0, 60.0, 80.0, 30.0, 80.0, 20.0, 70.0, 70.0, 60.0, 30.0, 110.0, 70.0, 40.0, 50.0, 70.0, 20.0, 0.0, 30.0, 10.0, 40.0, 240.0, 30.0, 0.0, 10.0, 40.0, 150.0, 20.0, 40.0, 20.0, 30.0, 50.0, 50.0, -5.0, 50.0, 250.0, 70.0, 0.0, 250.0, 30.0, 40.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 90.0, 10.0, 20.0, 130.0, 80.0, 70.0, 80.0, 30.0, 60.0, 50.0, 100.0, 60.0, 260.0, 260.0, 80.0, 170.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 0.0, -5.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 30.0, 290.0, 60.0, 20.0, 370.0, -10.0, 190.0, 160.0, -20.0, 0.0, 150.0, -40.0, 0.0, 50.0, 90.0, 180.0, 40.0, 100.0, 10.0, -5.0, 170.0, 20.0, 55.0, -10.0, 80.0, 0.0, 60.0, 210.0, 20.0, 70.0, -5.0, 50.0, 80.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 20.0, 15.0, 40.0, 40.0, 50.0, 50.0, 20.0, 40.0, 30.0, 90.0, 70.0, 110.0, 50.0, 60.0, 70.0, 60.0, 30.0, 80.0, 20.0, 50.0, 120.0, 10.0, 160.0, 30.0, 50.0, 70.0, 140.0, 70.0, 100.0, 40.0, 170.0, 60.0, 10.0, 50.0, 40.0, 30.0, 20.0, 150.0, 30.0, 60.0, 50.0, 40.0, 100.0, 0.0, 40.0, 50.0, 50.0, 20.0, 90.0, 60.0, 30.0, 30.0, 40.0, 20.0, 70.0, 20.0, 20.0, 210.0, 30.0, 0.0, 60.0, 70.0, 140.0, 70.0, 90.0, 0.0, -30.0, 40.0, 80.0, 540.0, 160.0, -30.0, 30.0, 70.0, 70.0, 70.0, 70.0, 90.0, 90.0, 40.0, 50.0, 250.0, 0.0, 10.0, -10.0, 40.0, 0.0, 150.0, 10.0, 90.0, 10.0, 30.0, 0.0, 0.0, -10.0, 70.0, 0.0, 10.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 10.0, 0.0, 190.0, 20.0, -30.0, -160.0, 180.0, 170.0, 60.0, 90.0, 120.0, 10.0, 40.0, 160.0, -40.0, 10.0, -50.0, 30.0, 60.0, 45.0, 180.0, 40.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 80.0, 340.0, 40.0, 140.0, 230.0, 40.0, 0.0, 20.0, 60.0, 200.0, 90.0, 90.0, 130.0, 40.0, 40.0, 60.0, 130.0, 10.0, 20.0, -5.0, 50.0, 70.0, 30.0, 0.0, 10.0, 0.0, 20.0, 80.0, 40.0, 20.0, 110.0, 30.0, 10.0, 10.0, 40.0, 10.0, 70.0, 20.0, 0.0, 300.0, 170.0, 70.0, 70.0, 180.0, 70.0, 30.0, 490.0, -40.0, 80.0, 100.0, 30.0, 40.0, 30.0, 60.0, 160.0, 40.0, 10.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 90.0, 10.0, 70.0, 60.0, 40.0, 70.0, 30.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 80.0, 20.0, 20.0, 110.0, 20.0, -30.0, 110.0, 320.0, 20.0, 110.0, 170.0, 310.0, 40.0, 10.0, 20.0, -10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 10.0, 210.0, 0.0, 0.0, 40.0, 310.0, 30.0, 5.0, 30.0, 90.0, 20.0, 70.0, 40.0, 20.0, 40.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 50.0, 15.0, 20.0, 310.0, 30.0, 100.0, 35.0, 190.0, 180.0, 70.0, 10.0, 70.0, 40.0, 120.0, 20.0, 30.0, 30.0, -5.0, 0.0, 0.0, 40.0, 20.0, 10.0, 80.0, 70.0, 70.0, 50.0, 100.0, 60.0, 60.0, 110.0, 20.0, 60.0, 230.0, 50.0, 30.0, 160.0, 20.0, 30.0, -50.0, 20.0, 0.0, 0.0, -5.0, 70.0, -10.0, 80.0, 30.0, 70.0, -10.0, 60.0, 260.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 70.0, -40.0, 160.0, 30.0, 35.0, 10.0, 180.0, 40.0, 160.0, 100.0, 200.0, 50.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 20.0, 50.0, 0.0, 0.0, 340.0, 90.0, 110.0, 150.0, -150.0, 10.0, 240.0, 110.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 150.0, 60.0, 50.0, 20.0, 40.0, 50.0, 30.0, 10.0, 90.0, 20.0, 290.0, 180.0, 20.0, 40.0, 40.0, 30.0, 30.0, 160.0, 70.0, 40.0, 80.0, 90.0, 30.0, 10.0, 15.0, 10.0, 0.0, 70.0, 100.0, 200.0, 100.0, -10.0, 90.0, 160.0, 10.0, 80.0, 10.0, 40.0, 10.0, 80.0, 0.0, 60.0, 10.0, 40.0, 0.0, 30.0, 50.0, 20.0, 170.0, 150.0, 10.0, 20.0, 40.0, 30.0, 70.0, 0.0, 50.0, 10.0, 40.0, 150.0, 80.0, 20.0, 150.0, 0.0, 60.0, 10.0, 290.0, 50.0, 50.0, 70.0, 90.0, 40.0, 160.0, 190.0, 160.0, 60.0, 60.0, 280.0, 70.0, 50.0, 30.0, 10.0, 20.0, 80.0, 40.0, 30.0, 20.0, 130.0, 60.0, 120.0, 40.0, 50.0, 50.0, 0.0, 180.0, 40.0, 20.0, 40.0, 190.0, 30.0, 30.0, 20.0, 20.0, 30.0, 50.0, 30.0, 50.0, 10.0, 50.0, 20.0, 110.0, 0.0, 15.0, 0.0, 5.0, 20.0, 20.0, 50.0, 50.0, 70.0, 160.0, 150.0, 50.0, 370.0, -50.0, 0.0, 270.0, 40.0, 80.0, 50.0, 40.0, 50.0, 90.0, 170.0, 100.0, 80.0, 10.0, 80.0, 120.0, 70.0, 250.0, 50.0, 50.0, 80.0, -50.0, 90.0, 30.0, 40.0, 70.0, 20.0, -370.0, 10.0, 190.0, 80.0, 20.0, 100.0, 30.0, 50.0, 80.0, 40.0, 20.0, 40.0, 155.0, 30.0, 80.0, 20.0, 0.0, 35.0, 40.0, 0.0, 110.0, 100.0, 30.0, 50.0, 40.0, 60.0, 20.0, 90.0, 50.0, 0.0, 10.0, 0.0, 0.0, 10.0, 35.0, 30.0, 30.0, 20.0, 80.0, 90.0, 200.0, 20.0, 20.0, 100.0, 80.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 0.0, -10.0, 80.0, 470.0, 60.0, 70.0, 40.0, 30.0, 0.0, 160.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 0.0, 40.0, 30.0, 90.0, 30.0, 290.0, 80.0, 290.0, 40.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 10.0, 25.0, 100.0, 60.0, 30.0, 30.0, 10.0, 60.0, 30.0, -5.0, 20.0, 30.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 10.0, 10.0, 50.0, 20.0, 10.0, 40.0, 60.0, 20.0, 30.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 20.0, 60.0, 160.0, 100.0, 70.0, 370.0, 50.0, 170.0, 30.0, 30.0, 70.0, 30.0, 0.0, 30.0, 300.0, 40.0, 160.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 40.0, 70.0, 240.0, 60.0, 60.0, 10.0, 300.0, 40.0, 120.0, 30.0, 20.0, 90.0, 25.0, 20.0, 60.0, 30.0, 20.0, 10.0, 40.0, 0.0, 220.0, 80.0, 0.0, 30.0, 20.0, 20.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 25.0, 40.0, 70.0, 20.0, 0.0, 50.0, 10.0, 80.0, 40.0, 70.0, 40.0, 120.0, 20.0, 30.0, 0.0, 15.0, 20.0, -15.0, 40.0, 0.0, 50.0, 10.0, 30.0, 60.0, 60.0, -30.0, 230.0, 380.0, 20.0, 370.0, 20.0, 40.0, 10.0, 0.0, 0.0, 30.0, 70.0, 10.0, 50.0, 90.0, 30.0, 40.0, 10.0, 90.0, 250.0, 50.0, 0.0, -50.0, 80.0, 30.0, 60.0, 10.0, 60.0, 30.0, 60.0, 40.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 20.0, 70.0, 30.0, 30.0, 50.0, 20.0, 30.0, 40.0, 160.0, 160.0, 30.0, 160.0, 0.0, 30.0, 10.0, 15.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, -20.0, 40.0, 40.0, 50.0, 320.0, 50.0, 180.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 170.0, 0.0, 130.0, 10.0, 0.0, 20.0, 40.0, 0.0, 60.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5794032558460538, "mean_inference_ms": 1.4223536022772065, "mean_action_processing_ms": 0.4556712154124674, "mean_env_wait_ms": 1.2808725344431642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011777400970458984, "StateBufferConnector_ms": 0.009136676788330078, "ViewRequirementAgentConnector_ms": 0.37333226203918457}, "num_episodes": 23, "episode_return_max": 1180.0, "episode_return_min": 150.0, "episode_return_mean": 558.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.533727593520457, "num_env_steps_trained_throughput_per_sec": 21.533727593520457, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 186192.964, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186192.918, "sample_time_ms": 2515.039, "learn_time_ms": 183656.992, "learn_throughput": 21.78, "synch_weights_time_ms": 12.949}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 34, "trial_id": "90816_00000", "date": "2024-06-10_01-59-47", "timestamp": 1717999187, "time_this_iter_s": 185.7626268863678, "time_total_s": 6466.264239311218, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b000d670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6466.264239311218, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.47490494296578, "ram_util_percent": 78.38783269961978}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6894068396193025, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.658048602745048, "policy_loss": -0.010146089138909957, "vf_loss": 5.666621198999488, "vf_explained_var": 0.0010230477815999772, "kl": 0.007867470132286397, "entropy": 0.884091980604572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 323955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 1180.0, "episode_reward_min": 150.0, "episode_reward_mean": 553.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 540.0}, "policy_reward_mean": {"policy_0": 55.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [555.0, 150.0, 315.0, 640.0, 800.0, 600.0, 500.0, 530.0, 520.0, 1160.0, 540.0, 220.0, 410.0, 640.0, 325.0, 900.0, 730.0, 315.0, 370.0, 980.0, 990.0, 190.0, 490.0, 210.0, 1180.0, 350.0, 705.0, 360.0, 235.0, 1035.0, 265.0, 680.0, 490.0, 565.0, 230.0, 965.0, 240.0, 940.0, 430.0, 750.0, 535.0, 800.0, 280.0, 560.0, 570.0, 1160.0, 670.0, 690.0, 460.0, 280.0, 870.0, 970.0, 750.0, 190.0, 545.0, 465.0, 245.0, 650.0, 700.0, 600.0, 970.0, 415.0, 235.0, 170.0, 330.0, 920.0, 860.0, 580.0, 715.0, 490.0, 375.0, 500.0, 170.0, 1180.0, 330.0, 530.0, 290.0, 340.0, 635.0, 500.0, 660.0, 270.0, 595.0, 540.0, 480.0, 450.0, 530.0, 340.0, 360.0, 520.0, 810.0, 465.0, 780.0, 680.0, 500.0, 310.0, 555.0, 830.0, 195.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-10.0, 80.0, 0.0, 60.0, 210.0, 20.0, 70.0, -5.0, 50.0, 80.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 20.0, 15.0, 40.0, 40.0, 50.0, 50.0, 20.0, 40.0, 30.0, 90.0, 70.0, 110.0, 50.0, 60.0, 70.0, 60.0, 30.0, 80.0, 20.0, 50.0, 120.0, 10.0, 160.0, 30.0, 50.0, 70.0, 140.0, 70.0, 100.0, 40.0, 170.0, 60.0, 10.0, 50.0, 40.0, 30.0, 20.0, 150.0, 30.0, 60.0, 50.0, 40.0, 100.0, 0.0, 40.0, 50.0, 50.0, 20.0, 90.0, 60.0, 30.0, 30.0, 40.0, 20.0, 70.0, 20.0, 20.0, 210.0, 30.0, 0.0, 60.0, 70.0, 140.0, 70.0, 90.0, 0.0, -30.0, 40.0, 80.0, 540.0, 160.0, -30.0, 30.0, 70.0, 70.0, 70.0, 70.0, 90.0, 90.0, 40.0, 50.0, 250.0, 0.0, 10.0, -10.0, 40.0, 0.0, 150.0, 10.0, 90.0, 10.0, 30.0, 0.0, 0.0, -10.0, 70.0, 0.0, 10.0, 20.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 10.0, 0.0, 190.0, 20.0, -30.0, -160.0, 180.0, 170.0, 60.0, 90.0, 120.0, 10.0, 40.0, 160.0, -40.0, 10.0, -50.0, 30.0, 60.0, 45.0, 180.0, 40.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 80.0, 340.0, 40.0, 140.0, 230.0, 40.0, 0.0, 20.0, 60.0, 200.0, 90.0, 90.0, 130.0, 40.0, 40.0, 60.0, 130.0, 10.0, 20.0, -5.0, 50.0, 70.0, 30.0, 0.0, 10.0, 0.0, 20.0, 80.0, 40.0, 20.0, 110.0, 30.0, 10.0, 10.0, 40.0, 10.0, 70.0, 20.0, 0.0, 300.0, 170.0, 70.0, 70.0, 180.0, 70.0, 30.0, 490.0, -40.0, 80.0, 100.0, 30.0, 40.0, 30.0, 60.0, 160.0, 40.0, 10.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 90.0, 10.0, 70.0, 60.0, 40.0, 70.0, 30.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 80.0, 20.0, 20.0, 110.0, 20.0, -30.0, 110.0, 320.0, 20.0, 110.0, 170.0, 310.0, 40.0, 10.0, 20.0, -10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 10.0, 210.0, 0.0, 0.0, 40.0, 310.0, 30.0, 5.0, 30.0, 90.0, 20.0, 70.0, 40.0, 20.0, 40.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 50.0, 15.0, 20.0, 310.0, 30.0, 100.0, 35.0, 190.0, 180.0, 70.0, 10.0, 70.0, 40.0, 120.0, 20.0, 30.0, 30.0, -5.0, 0.0, 0.0, 40.0, 20.0, 10.0, 80.0, 70.0, 70.0, 50.0, 100.0, 60.0, 60.0, 110.0, 20.0, 60.0, 230.0, 50.0, 30.0, 160.0, 20.0, 30.0, -50.0, 20.0, 0.0, 0.0, -5.0, 70.0, -10.0, 80.0, 30.0, 70.0, -10.0, 60.0, 260.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 70.0, -40.0, 160.0, 30.0, 35.0, 10.0, 180.0, 40.0, 160.0, 100.0, 200.0, 50.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 20.0, 50.0, 0.0, 0.0, 340.0, 90.0, 110.0, 150.0, -150.0, 10.0, 240.0, 110.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 150.0, 60.0, 50.0, 20.0, 40.0, 50.0, 30.0, 10.0, 90.0, 20.0, 290.0, 180.0, 20.0, 40.0, 40.0, 30.0, 30.0, 160.0, 70.0, 40.0, 80.0, 90.0, 30.0, 10.0, 15.0, 10.0, 0.0, 70.0, 100.0, 200.0, 100.0, -10.0, 90.0, 160.0, 10.0, 80.0, 10.0, 40.0, 10.0, 80.0, 0.0, 60.0, 10.0, 40.0, 0.0, 30.0, 50.0, 20.0, 170.0, 150.0, 10.0, 20.0, 40.0, 30.0, 70.0, 0.0, 50.0, 10.0, 40.0, 150.0, 80.0, 20.0, 150.0, 0.0, 60.0, 10.0, 290.0, 50.0, 50.0, 70.0, 90.0, 40.0, 160.0, 190.0, 160.0, 60.0, 60.0, 280.0, 70.0, 50.0, 30.0, 10.0, 20.0, 80.0, 40.0, 30.0, 20.0, 130.0, 60.0, 120.0, 40.0, 50.0, 50.0, 0.0, 180.0, 40.0, 20.0, 40.0, 190.0, 30.0, 30.0, 20.0, 20.0, 30.0, 50.0, 30.0, 50.0, 10.0, 50.0, 20.0, 110.0, 0.0, 15.0, 0.0, 5.0, 20.0, 20.0, 50.0, 50.0, 70.0, 160.0, 150.0, 50.0, 370.0, -50.0, 0.0, 270.0, 40.0, 80.0, 50.0, 40.0, 50.0, 90.0, 170.0, 100.0, 80.0, 10.0, 80.0, 120.0, 70.0, 250.0, 50.0, 50.0, 80.0, -50.0, 90.0, 30.0, 40.0, 70.0, 20.0, -370.0, 10.0, 190.0, 80.0, 20.0, 100.0, 30.0, 50.0, 80.0, 40.0, 20.0, 40.0, 155.0, 30.0, 80.0, 20.0, 0.0, 35.0, 40.0, 0.0, 110.0, 100.0, 30.0, 50.0, 40.0, 60.0, 20.0, 90.0, 50.0, 0.0, 10.0, 0.0, 0.0, 10.0, 35.0, 30.0, 30.0, 20.0, 80.0, 90.0, 200.0, 20.0, 20.0, 100.0, 80.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 0.0, -10.0, 80.0, 470.0, 60.0, 70.0, 40.0, 30.0, 0.0, 160.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 0.0, 40.0, 30.0, 90.0, 30.0, 290.0, 80.0, 290.0, 40.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 10.0, 25.0, 100.0, 60.0, 30.0, 30.0, 10.0, 60.0, 30.0, -5.0, 20.0, 30.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 10.0, 10.0, 50.0, 20.0, 10.0, 40.0, 60.0, 20.0, 30.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 20.0, 60.0, 160.0, 100.0, 70.0, 370.0, 50.0, 170.0, 30.0, 30.0, 70.0, 30.0, 0.0, 30.0, 300.0, 40.0, 160.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 40.0, 70.0, 240.0, 60.0, 60.0, 10.0, 300.0, 40.0, 120.0, 30.0, 20.0, 90.0, 25.0, 20.0, 60.0, 30.0, 20.0, 10.0, 40.0, 0.0, 220.0, 80.0, 0.0, 30.0, 20.0, 20.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 25.0, 40.0, 70.0, 20.0, 0.0, 50.0, 10.0, 80.0, 40.0, 70.0, 40.0, 120.0, 20.0, 30.0, 0.0, 15.0, 20.0, -15.0, 40.0, 0.0, 50.0, 10.0, 30.0, 60.0, 60.0, -30.0, 230.0, 380.0, 20.0, 370.0, 20.0, 40.0, 10.0, 0.0, 0.0, 30.0, 70.0, 10.0, 50.0, 90.0, 30.0, 40.0, 10.0, 90.0, 250.0, 50.0, 0.0, -50.0, 80.0, 30.0, 60.0, 10.0, 60.0, 30.0, 60.0, 40.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 20.0, 70.0, 30.0, 30.0, 50.0, 20.0, 30.0, 40.0, 160.0, 160.0, 30.0, 160.0, 0.0, 30.0, 10.0, 15.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, -20.0, 40.0, 40.0, 50.0, 320.0, 50.0, 180.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 170.0, 0.0, 130.0, 10.0, 0.0, 20.0, 40.0, 0.0, 60.0, 0.0, 0.0, 10.0, 40.0, 50.0, 55.0, 20.0, -50.0, 20.0, 180.0, 190.0, 80.0, 10.0, 70.0, 10.0, 40.0, 40.0, 190.0, 70.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 80.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 20.0, 10.0, 30.0, 270.0, 0.0, 10.0, 30.0, 40.0, 40.0, 30.0, 70.0, 0.0, 70.0, 40.0, 40.0, 20.0, 30.0, 200.0, 30.0, 90.0, -20.0, 0.0, 40.0, 80.0, -25.0, 60.0, 15.0, 90.0, 10.0, 190.0, 10.0, 0.0, 80.0, 20.0, 10.0, 20.0, 60.0, -30.0, 0.0, 20.0, 30.0, 10.0, 70.0, 20.0, 220.0, 30.0, 0.0, 120.0, 0.0, 80.0, 0.0, 110.0, 230.0, 120.0, 10.0, 80.0, 70.0, 40.0, 70.0, 30.0, 5.0, 30.0, 10.0, 30.0, 80.0, 0.0, 0.0, 0.0, 280.0, 0.0, 30.0, 280.0, 0.0, 50.0, 10.0, 150.0, 50.0, 30.0, 180.0, 70.0, -40.0, 30.0, 370.0, 90.0, -30.0, 30.0, 60.0, 60.0, 40.0, 50.0, 120.0, 30.0, 30.0, 0.0, 30.0, 20.0, 10.0, 170.0, 40.0, 50.0, 40.0, 0.0, 10.0, 50.0, 70.0, 60.0, 10.0, 20.0, 0.0, 80.0, 30.0, 190.0, 80.0, 0.0, 45.0, 60.0, 10.0, 40.0, 20.0, 40.0, 40.0, 110.0, 160.0, 400.0, 20.0, -10.0, -10.0, 40.0, 40.0, 80.0, -10.0, -45.0, -140.0, 0.0, 20.0, 250.0, 0.0, 20.0, 20.0, 10.0, 10.0, 60.0, 260.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5757026990814091, "mean_inference_ms": 1.4210009738791662, "mean_action_processing_ms": 0.4536689577351543, "mean_env_wait_ms": 1.2790532483152757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011714935302734375, "StateBufferConnector_ms": 0.009181737899780273, "ViewRequirementAgentConnector_ms": 0.3679943084716797}, "num_episodes": 18, "episode_return_max": 1180.0, "episode_return_min": 150.0, "episode_return_mean": 553.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.304075743563907, "num_env_steps_trained_throughput_per_sec": 21.304075743563907, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 186496.385, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186496.339, "sample_time_ms": 2489.874, "learn_time_ms": 183985.977, "learn_throughput": 21.741, "synch_weights_time_ms": 12.794}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 35, "trial_id": "90816_00000", "date": "2024-06-10_02-02-55", "timestamp": 1717999375, "time_this_iter_s": 187.8102343082428, "time_total_s": 6654.074473619461, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f29820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6654.074473619461, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.38383458646617, "ram_util_percent": 78.72969924812031}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.287971828489131, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.77738230555964, "policy_loss": -0.009887773782601014, "vf_loss": 4.785646297781866, "vf_explained_var": 0.0032055173311243677, "kl": 0.008118944243110363, "entropy": 0.8938727289787369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 333345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 1235.0, "episode_reward_min": 170.0, "episode_reward_mean": 557.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 490.0}, "policy_reward_mean": {"policy_0": 55.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 980.0, 990.0, 190.0, 490.0, 210.0, 1180.0, 350.0, 705.0, 360.0, 235.0, 1035.0, 265.0, 680.0, 490.0, 565.0, 230.0, 965.0, 240.0, 940.0, 430.0, 750.0, 535.0, 800.0, 280.0, 560.0, 570.0, 1160.0, 670.0, 690.0, 460.0, 280.0, 870.0, 970.0, 750.0, 190.0, 545.0, 465.0, 245.0, 650.0, 700.0, 600.0, 970.0, 415.0, 235.0, 170.0, 330.0, 920.0, 860.0, 580.0, 715.0, 490.0, 375.0, 500.0, 170.0, 1180.0, 330.0, 530.0, 290.0, 340.0, 635.0, 500.0, 660.0, 270.0, 595.0, 540.0, 480.0, 450.0, 530.0, 340.0, 360.0, 520.0, 810.0, 465.0, 780.0, 680.0, 500.0, 310.0, 555.0, 830.0, 195.0, 420.0, 220.0, 550.0, 230.0, 445.0, 310.0, 520.0, 455.0, 670.0, 1235.0, 1110.0, 1000.0, 530.0, 730.0, 650.0, 475.0, 600.0, 310.0, 210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 80.0, 40.0, 20.0, 110.0, 30.0, 10.0, 10.0, 40.0, 10.0, 70.0, 20.0, 0.0, 300.0, 170.0, 70.0, 70.0, 180.0, 70.0, 30.0, 490.0, -40.0, 80.0, 100.0, 30.0, 40.0, 30.0, 60.0, 160.0, 40.0, 10.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 90.0, 10.0, 70.0, 60.0, 40.0, 70.0, 30.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 80.0, 20.0, 20.0, 110.0, 20.0, -30.0, 110.0, 320.0, 20.0, 110.0, 170.0, 310.0, 40.0, 10.0, 20.0, -10.0, 40.0, 20.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 10.0, 210.0, 0.0, 0.0, 40.0, 310.0, 30.0, 5.0, 30.0, 90.0, 20.0, 70.0, 40.0, 20.0, 40.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 30.0, 20.0, 20.0, 30.0, 50.0, 15.0, 20.0, 310.0, 30.0, 100.0, 35.0, 190.0, 180.0, 70.0, 10.0, 70.0, 40.0, 120.0, 20.0, 30.0, 30.0, -5.0, 0.0, 0.0, 40.0, 20.0, 10.0, 80.0, 70.0, 70.0, 50.0, 100.0, 60.0, 60.0, 110.0, 20.0, 60.0, 230.0, 50.0, 30.0, 160.0, 20.0, 30.0, -50.0, 20.0, 0.0, 0.0, -5.0, 70.0, -10.0, 80.0, 30.0, 70.0, -10.0, 60.0, 260.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 40.0, 40.0, 30.0, 70.0, -40.0, 160.0, 30.0, 35.0, 10.0, 180.0, 40.0, 160.0, 100.0, 200.0, 50.0, 10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 20.0, 50.0, 0.0, 0.0, 340.0, 90.0, 110.0, 150.0, -150.0, 10.0, 240.0, 110.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 150.0, 60.0, 50.0, 20.0, 40.0, 50.0, 30.0, 10.0, 90.0, 20.0, 290.0, 180.0, 20.0, 40.0, 40.0, 30.0, 30.0, 160.0, 70.0, 40.0, 80.0, 90.0, 30.0, 10.0, 15.0, 10.0, 0.0, 70.0, 100.0, 200.0, 100.0, -10.0, 90.0, 160.0, 10.0, 80.0, 10.0, 40.0, 10.0, 80.0, 0.0, 60.0, 10.0, 40.0, 0.0, 30.0, 50.0, 20.0, 170.0, 150.0, 10.0, 20.0, 40.0, 30.0, 70.0, 0.0, 50.0, 10.0, 40.0, 150.0, 80.0, 20.0, 150.0, 0.0, 60.0, 10.0, 290.0, 50.0, 50.0, 70.0, 90.0, 40.0, 160.0, 190.0, 160.0, 60.0, 60.0, 280.0, 70.0, 50.0, 30.0, 10.0, 20.0, 80.0, 40.0, 30.0, 20.0, 130.0, 60.0, 120.0, 40.0, 50.0, 50.0, 0.0, 180.0, 40.0, 20.0, 40.0, 190.0, 30.0, 30.0, 20.0, 20.0, 30.0, 50.0, 30.0, 50.0, 10.0, 50.0, 20.0, 110.0, 0.0, 15.0, 0.0, 5.0, 20.0, 20.0, 50.0, 50.0, 70.0, 160.0, 150.0, 50.0, 370.0, -50.0, 0.0, 270.0, 40.0, 80.0, 50.0, 40.0, 50.0, 90.0, 170.0, 100.0, 80.0, 10.0, 80.0, 120.0, 70.0, 250.0, 50.0, 50.0, 80.0, -50.0, 90.0, 30.0, 40.0, 70.0, 20.0, -370.0, 10.0, 190.0, 80.0, 20.0, 100.0, 30.0, 50.0, 80.0, 40.0, 20.0, 40.0, 155.0, 30.0, 80.0, 20.0, 0.0, 35.0, 40.0, 0.0, 110.0, 100.0, 30.0, 50.0, 40.0, 60.0, 20.0, 90.0, 50.0, 0.0, 10.0, 0.0, 0.0, 10.0, 35.0, 30.0, 30.0, 20.0, 80.0, 90.0, 200.0, 20.0, 20.0, 100.0, 80.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 0.0, -10.0, 80.0, 470.0, 60.0, 70.0, 40.0, 30.0, 0.0, 160.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 0.0, 40.0, 30.0, 90.0, 30.0, 290.0, 80.0, 290.0, 40.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 10.0, 25.0, 100.0, 60.0, 30.0, 30.0, 10.0, 60.0, 30.0, -5.0, 20.0, 30.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 10.0, 10.0, 50.0, 20.0, 10.0, 40.0, 60.0, 20.0, 30.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 20.0, 60.0, 160.0, 100.0, 70.0, 370.0, 50.0, 170.0, 30.0, 30.0, 70.0, 30.0, 0.0, 30.0, 300.0, 40.0, 160.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 40.0, 70.0, 240.0, 60.0, 60.0, 10.0, 300.0, 40.0, 120.0, 30.0, 20.0, 90.0, 25.0, 20.0, 60.0, 30.0, 20.0, 10.0, 40.0, 0.0, 220.0, 80.0, 0.0, 30.0, 20.0, 20.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 25.0, 40.0, 70.0, 20.0, 0.0, 50.0, 10.0, 80.0, 40.0, 70.0, 40.0, 120.0, 20.0, 30.0, 0.0, 15.0, 20.0, -15.0, 40.0, 0.0, 50.0, 10.0, 30.0, 60.0, 60.0, -30.0, 230.0, 380.0, 20.0, 370.0, 20.0, 40.0, 10.0, 0.0, 0.0, 30.0, 70.0, 10.0, 50.0, 90.0, 30.0, 40.0, 10.0, 90.0, 250.0, 50.0, 0.0, -50.0, 80.0, 30.0, 60.0, 10.0, 60.0, 30.0, 60.0, 40.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 20.0, 70.0, 30.0, 30.0, 50.0, 20.0, 30.0, 40.0, 160.0, 160.0, 30.0, 160.0, 0.0, 30.0, 10.0, 15.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, -20.0, 40.0, 40.0, 50.0, 320.0, 50.0, 180.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 170.0, 0.0, 130.0, 10.0, 0.0, 20.0, 40.0, 0.0, 60.0, 0.0, 0.0, 10.0, 40.0, 50.0, 55.0, 20.0, -50.0, 20.0, 180.0, 190.0, 80.0, 10.0, 70.0, 10.0, 40.0, 40.0, 190.0, 70.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 80.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 20.0, 10.0, 30.0, 270.0, 0.0, 10.0, 30.0, 40.0, 40.0, 30.0, 70.0, 0.0, 70.0, 40.0, 40.0, 20.0, 30.0, 200.0, 30.0, 90.0, -20.0, 0.0, 40.0, 80.0, -25.0, 60.0, 15.0, 90.0, 10.0, 190.0, 10.0, 0.0, 80.0, 20.0, 10.0, 20.0, 60.0, -30.0, 0.0, 20.0, 30.0, 10.0, 70.0, 20.0, 220.0, 30.0, 0.0, 120.0, 0.0, 80.0, 0.0, 110.0, 230.0, 120.0, 10.0, 80.0, 70.0, 40.0, 70.0, 30.0, 5.0, 30.0, 10.0, 30.0, 80.0, 0.0, 0.0, 0.0, 280.0, 0.0, 30.0, 280.0, 0.0, 50.0, 10.0, 150.0, 50.0, 30.0, 180.0, 70.0, -40.0, 30.0, 370.0, 90.0, -30.0, 30.0, 60.0, 60.0, 40.0, 50.0, 120.0, 30.0, 30.0, 0.0, 30.0, 20.0, 10.0, 170.0, 40.0, 50.0, 40.0, 0.0, 10.0, 50.0, 70.0, 60.0, 10.0, 20.0, 0.0, 80.0, 30.0, 190.0, 80.0, 0.0, 45.0, 60.0, 10.0, 40.0, 20.0, 40.0, 40.0, 110.0, 160.0, 400.0, 20.0, -10.0, -10.0, 40.0, 40.0, 80.0, -10.0, -45.0, -140.0, 0.0, 20.0, 250.0, 0.0, 20.0, 20.0, 10.0, 10.0, 60.0, 260.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 70.0, 110.0, 30.0, 60.0, 10.0, 10.0, 0.0, 190.0, 0.0, 110.0, 30.0, 30.0, 60.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 60.0, 40.0, 40.0, 10.0, 15.0, 10.0, 160.0, 20.0, 20.0, 70.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 150.0, 40.0, 60.0, 30.0, 120.0, 40.0, 170.0, 10.0, 0.0, 40.0, 20.0, 30.0, -25.0, 40.0, 40.0, 230.0, 90.0, 20.0, -250.0, 160.0, 60.0, 90.0, 10.0, 40.0, 20.0, 80.0, 250.0, 170.0, 30.0, 50.0, 20.0, 0.0, 70.0, 120.0, 70.0, 90.0, 40.0, 440.0, 30.0, 170.0, 155.0, 50.0, 350.0, 80.0, 140.0, 40.0, 30.0, 90.0, 90.0, -10.0, 120.0, 180.0, 30.0, 40.0, 190.0, 210.0, 20.0, 50.0, 50.0, 30.0, 90.0, 290.0, 40.0, 310.0, 50.0, 20.0, 80.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 150.0, 30.0, 20.0, 40.0, 40.0, 130.0, 0.0, 270.0, 30.0, 0.0, -10.0, 50.0, 60.0, 460.0, 30.0, 10.0, 10.0, 30.0, 10.0, 10.0, 0.0, 5.0, 60.0, 60.0, 160.0, 10.0, 30.0, 60.0, 80.0, 20.0, 20.0, 20.0, 30.0, 40.0, 50.0, 90.0, 10.0, 0.0, 320.0, 10.0, 30.0, 30.0, 20.0, 60.0, 30.0, 10.0, 50.0, 10.0, 60.0, 20.0, 10.0, 50.0, 10.0, 10.0, 60.0, 0.0, 30.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5724896769807761, "mean_inference_ms": 1.4199897037463587, "mean_action_processing_ms": 0.4517064920251035, "mean_env_wait_ms": 1.2772246458819374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01162099838256836, "StateBufferConnector_ms": 0.009327173233032227, "ViewRequirementAgentConnector_ms": 0.35804057121276855}, "num_episodes": 18, "episode_return_max": 1235.0, "episode_return_min": 170.0, "episode_return_mean": 557.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.419354963249024, "num_env_steps_trained_throughput_per_sec": 21.419354963249024, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 186319.008, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186318.962, "sample_time_ms": 2397.895, "learn_time_ms": 183900.741, "learn_throughput": 21.751, "synch_weights_time_ms": 12.779}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 36, "trial_id": "90816_00000", "date": "2024-06-10_02-06-02", "timestamp": 1717999562, "time_this_iter_s": 186.75741815567017, "time_total_s": 6840.831891775131, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f56280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6840.831891775131, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 19.431818181818183, "ram_util_percent": 79.4034090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.881424325780747, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.812728296326626, "policy_loss": -0.010956800936525877, "vf_loss": 5.822034310380491, "vf_explained_var": 3.7977045463423884e-05, "kl": 0.008253978312560835, "entropy": 0.8454882866214005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 342735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 1435.0, "episode_reward_min": 40.0, "episode_reward_mean": 562.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 470.0}, "policy_reward_mean": {"policy_0": 56.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [240.0, 940.0, 430.0, 750.0, 535.0, 800.0, 280.0, 560.0, 570.0, 1160.0, 670.0, 690.0, 460.0, 280.0, 870.0, 970.0, 750.0, 190.0, 545.0, 465.0, 245.0, 650.0, 700.0, 600.0, 970.0, 415.0, 235.0, 170.0, 330.0, 920.0, 860.0, 580.0, 715.0, 490.0, 375.0, 500.0, 170.0, 1180.0, 330.0, 530.0, 290.0, 340.0, 635.0, 500.0, 660.0, 270.0, 595.0, 540.0, 480.0, 450.0, 530.0, 340.0, 360.0, 520.0, 810.0, 465.0, 780.0, 680.0, 500.0, 310.0, 555.0, 830.0, 195.0, 420.0, 220.0, 550.0, 230.0, 445.0, 310.0, 520.0, 455.0, 670.0, 1235.0, 1110.0, 1000.0, 530.0, 730.0, 650.0, 475.0, 600.0, 310.0, 210.0, 380.0, 855.0, 315.0, 520.0, 1200.0, 600.0, 280.0, 595.0, 1165.0, 335.0, 195.0, 560.0, 340.0, 1435.0, 40.0, 680.0, 670.0, 690.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 20.0, 10.0, 60.0, 30.0, 20.0, 50.0, 0.0, 0.0, 340.0, 90.0, 110.0, 150.0, -150.0, 10.0, 240.0, 110.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 150.0, 60.0, 50.0, 20.0, 40.0, 50.0, 30.0, 10.0, 90.0, 20.0, 290.0, 180.0, 20.0, 40.0, 40.0, 30.0, 30.0, 160.0, 70.0, 40.0, 80.0, 90.0, 30.0, 10.0, 15.0, 10.0, 0.0, 70.0, 100.0, 200.0, 100.0, -10.0, 90.0, 160.0, 10.0, 80.0, 10.0, 40.0, 10.0, 80.0, 0.0, 60.0, 10.0, 40.0, 0.0, 30.0, 50.0, 20.0, 170.0, 150.0, 10.0, 20.0, 40.0, 30.0, 70.0, 0.0, 50.0, 10.0, 40.0, 150.0, 80.0, 20.0, 150.0, 0.0, 60.0, 10.0, 290.0, 50.0, 50.0, 70.0, 90.0, 40.0, 160.0, 190.0, 160.0, 60.0, 60.0, 280.0, 70.0, 50.0, 30.0, 10.0, 20.0, 80.0, 40.0, 30.0, 20.0, 130.0, 60.0, 120.0, 40.0, 50.0, 50.0, 0.0, 180.0, 40.0, 20.0, 40.0, 190.0, 30.0, 30.0, 20.0, 20.0, 30.0, 50.0, 30.0, 50.0, 10.0, 50.0, 20.0, 110.0, 0.0, 15.0, 0.0, 5.0, 20.0, 20.0, 50.0, 50.0, 70.0, 160.0, 150.0, 50.0, 370.0, -50.0, 0.0, 270.0, 40.0, 80.0, 50.0, 40.0, 50.0, 90.0, 170.0, 100.0, 80.0, 10.0, 80.0, 120.0, 70.0, 250.0, 50.0, 50.0, 80.0, -50.0, 90.0, 30.0, 40.0, 70.0, 20.0, -370.0, 10.0, 190.0, 80.0, 20.0, 100.0, 30.0, 50.0, 80.0, 40.0, 20.0, 40.0, 155.0, 30.0, 80.0, 20.0, 0.0, 35.0, 40.0, 0.0, 110.0, 100.0, 30.0, 50.0, 40.0, 60.0, 20.0, 90.0, 50.0, 0.0, 10.0, 0.0, 0.0, 10.0, 35.0, 30.0, 30.0, 20.0, 80.0, 90.0, 200.0, 20.0, 20.0, 100.0, 80.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 0.0, -10.0, 80.0, 470.0, 60.0, 70.0, 40.0, 30.0, 0.0, 160.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 0.0, 40.0, 30.0, 90.0, 30.0, 290.0, 80.0, 290.0, 40.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 10.0, 25.0, 100.0, 60.0, 30.0, 30.0, 10.0, 60.0, 30.0, -5.0, 20.0, 30.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 10.0, 10.0, 50.0, 20.0, 10.0, 40.0, 60.0, 20.0, 30.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 20.0, 60.0, 160.0, 100.0, 70.0, 370.0, 50.0, 170.0, 30.0, 30.0, 70.0, 30.0, 0.0, 30.0, 300.0, 40.0, 160.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 40.0, 70.0, 240.0, 60.0, 60.0, 10.0, 300.0, 40.0, 120.0, 30.0, 20.0, 90.0, 25.0, 20.0, 60.0, 30.0, 20.0, 10.0, 40.0, 0.0, 220.0, 80.0, 0.0, 30.0, 20.0, 20.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 25.0, 40.0, 70.0, 20.0, 0.0, 50.0, 10.0, 80.0, 40.0, 70.0, 40.0, 120.0, 20.0, 30.0, 0.0, 15.0, 20.0, -15.0, 40.0, 0.0, 50.0, 10.0, 30.0, 60.0, 60.0, -30.0, 230.0, 380.0, 20.0, 370.0, 20.0, 40.0, 10.0, 0.0, 0.0, 30.0, 70.0, 10.0, 50.0, 90.0, 30.0, 40.0, 10.0, 90.0, 250.0, 50.0, 0.0, -50.0, 80.0, 30.0, 60.0, 10.0, 60.0, 30.0, 60.0, 40.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 20.0, 70.0, 30.0, 30.0, 50.0, 20.0, 30.0, 40.0, 160.0, 160.0, 30.0, 160.0, 0.0, 30.0, 10.0, 15.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, -20.0, 40.0, 40.0, 50.0, 320.0, 50.0, 180.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 170.0, 0.0, 130.0, 10.0, 0.0, 20.0, 40.0, 0.0, 60.0, 0.0, 0.0, 10.0, 40.0, 50.0, 55.0, 20.0, -50.0, 20.0, 180.0, 190.0, 80.0, 10.0, 70.0, 10.0, 40.0, 40.0, 190.0, 70.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 80.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 20.0, 10.0, 30.0, 270.0, 0.0, 10.0, 30.0, 40.0, 40.0, 30.0, 70.0, 0.0, 70.0, 40.0, 40.0, 20.0, 30.0, 200.0, 30.0, 90.0, -20.0, 0.0, 40.0, 80.0, -25.0, 60.0, 15.0, 90.0, 10.0, 190.0, 10.0, 0.0, 80.0, 20.0, 10.0, 20.0, 60.0, -30.0, 0.0, 20.0, 30.0, 10.0, 70.0, 20.0, 220.0, 30.0, 0.0, 120.0, 0.0, 80.0, 0.0, 110.0, 230.0, 120.0, 10.0, 80.0, 70.0, 40.0, 70.0, 30.0, 5.0, 30.0, 10.0, 30.0, 80.0, 0.0, 0.0, 0.0, 280.0, 0.0, 30.0, 280.0, 0.0, 50.0, 10.0, 150.0, 50.0, 30.0, 180.0, 70.0, -40.0, 30.0, 370.0, 90.0, -30.0, 30.0, 60.0, 60.0, 40.0, 50.0, 120.0, 30.0, 30.0, 0.0, 30.0, 20.0, 10.0, 170.0, 40.0, 50.0, 40.0, 0.0, 10.0, 50.0, 70.0, 60.0, 10.0, 20.0, 0.0, 80.0, 30.0, 190.0, 80.0, 0.0, 45.0, 60.0, 10.0, 40.0, 20.0, 40.0, 40.0, 110.0, 160.0, 400.0, 20.0, -10.0, -10.0, 40.0, 40.0, 80.0, -10.0, -45.0, -140.0, 0.0, 20.0, 250.0, 0.0, 20.0, 20.0, 10.0, 10.0, 60.0, 260.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 70.0, 110.0, 30.0, 60.0, 10.0, 10.0, 0.0, 190.0, 0.0, 110.0, 30.0, 30.0, 60.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 60.0, 40.0, 40.0, 10.0, 15.0, 10.0, 160.0, 20.0, 20.0, 70.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 150.0, 40.0, 60.0, 30.0, 120.0, 40.0, 170.0, 10.0, 0.0, 40.0, 20.0, 30.0, -25.0, 40.0, 40.0, 230.0, 90.0, 20.0, -250.0, 160.0, 60.0, 90.0, 10.0, 40.0, 20.0, 80.0, 250.0, 170.0, 30.0, 50.0, 20.0, 0.0, 70.0, 120.0, 70.0, 90.0, 40.0, 440.0, 30.0, 170.0, 155.0, 50.0, 350.0, 80.0, 140.0, 40.0, 30.0, 90.0, 90.0, -10.0, 120.0, 180.0, 30.0, 40.0, 190.0, 210.0, 20.0, 50.0, 50.0, 30.0, 90.0, 290.0, 40.0, 310.0, 50.0, 20.0, 80.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 150.0, 30.0, 20.0, 40.0, 40.0, 130.0, 0.0, 270.0, 30.0, 0.0, -10.0, 50.0, 60.0, 460.0, 30.0, 10.0, 10.0, 30.0, 10.0, 10.0, 0.0, 5.0, 60.0, 60.0, 160.0, 10.0, 30.0, 60.0, 80.0, 20.0, 20.0, 20.0, 30.0, 40.0, 50.0, 90.0, 10.0, 0.0, 320.0, 10.0, 30.0, 30.0, 20.0, 60.0, 30.0, 10.0, 50.0, 10.0, 60.0, 20.0, 10.0, 50.0, 10.0, 10.0, 60.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 70.0, 30.0, 10.0, 170.0, 20.0, 0.0, 10.0, 70.0, 220.0, 40.0, 70.0, 50.0, 150.0, 155.0, -50.0, 70.0, 80.0, 35.0, 20.0, 30.0, 50.0, 0.0, 100.0, 50.0, 0.0, 10.0, 20.0, 80.0, 30.0, 60.0, -10.0, 60.0, 0.0, 40.0, 30.0, 40.0, 190.0, 80.0, 80.0, 90.0, 40.0, 80.0, 150.0, 40.0, 460.0, 40.0, 140.0, 120.0, 70.0, 60.0, 50.0, 30.0, 30.0, 30.0, 0.0, 40.0, 170.0, 0.0, 0.0, 10.0, 90.0, 30.0, 30.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 110.0, 30.0, 160.0, 120.0, 40.0, 20.0, 30.0, 45.0, 230.0, 190.0, 20.0, 110.0, 200.0, 85.0, 50.0, 50.0, 20.0, 210.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, -55.0, 30.0, 190.0, 40.0, 20.0, 20.0, 30.0, 70.0, 0.0, 0.0, 30.0, 15.0, 0.0, 10.0, 30.0, 50.0, 180.0, 10.0, 130.0, 20.0, 0.0, 20.0, 80.0, 40.0, 30.0, 30.0, 90.0, 30.0, 20.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 380.0, 20.0, 330.0, 50.0, 240.0, 120.0, -40.0, 245.0, 70.0, -90.0, 0.0, 50.0, 20.0, -50.0, 160.0, -20.0, 60.0, -40.0, -50.0, -50.0, 150.0, 120.0, 30.0, 110.0, 170.0, 70.0, 20.0, 60.0, 0.0, 70.0, 260.0, 110.0, 40.0, 0.0, 90.0, 10.0, 20.0, 10.0, 60.0, 140.0, 60.0, 90.0, 150.0, 0.0, 10.0, 10.0, 70.0, 120.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.569553603505045, "mean_inference_ms": 1.4193746520162278, "mean_action_processing_ms": 0.44993515711286236, "mean_env_wait_ms": 1.2756679815853216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011658191680908203, "StateBufferConnector_ms": 0.009372234344482422, "ViewRequirementAgentConnector_ms": 0.35871148109436035}, "num_episodes": 18, "episode_return_max": 1435.0, "episode_return_min": 40.0, "episode_return_mean": 562.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.291967274663822, "num_env_steps_trained_throughput_per_sec": 21.291967274663822, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 186450.31, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186450.264, "sample_time_ms": 2388.004, "learn_time_ms": 184042.022, "learn_throughput": 21.734, "synch_weights_time_ms": 12.56}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 37, "trial_id": "90816_00000", "date": "2024-06-10_02-09-10", "timestamp": 1717999750, "time_this_iter_s": 187.87457489967346, "time_total_s": 7028.706466674805, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00cbf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7028.706466674805, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.762641509433962, "ram_util_percent": 79.22867924528302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.936283795584759, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.532507534225147, "policy_loss": -0.01031682444947124, "vf_loss": 5.54139091808575, "vf_explained_var": -0.002348946585568884, "kl": 0.0071671979391282215, "entropy": 0.8412195172807533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 352125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 1435.0, "episode_reward_min": 40.0, "episode_reward_mean": 569.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 470.0}, "policy_reward_mean": {"policy_0": 56.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 600.0, 970.0, 415.0, 235.0, 170.0, 330.0, 920.0, 860.0, 580.0, 715.0, 490.0, 375.0, 500.0, 170.0, 1180.0, 330.0, 530.0, 290.0, 340.0, 635.0, 500.0, 660.0, 270.0, 595.0, 540.0, 480.0, 450.0, 530.0, 340.0, 360.0, 520.0, 810.0, 465.0, 780.0, 680.0, 500.0, 310.0, 555.0, 830.0, 195.0, 420.0, 220.0, 550.0, 230.0, 445.0, 310.0, 520.0, 455.0, 670.0, 1235.0, 1110.0, 1000.0, 530.0, 730.0, 650.0, 475.0, 600.0, 310.0, 210.0, 380.0, 855.0, 315.0, 520.0, 1200.0, 600.0, 280.0, 595.0, 1165.0, 335.0, 195.0, 560.0, 340.0, 1435.0, 40.0, 680.0, 670.0, 690.0, 810.0, 550.0, 190.0, 700.0, 270.0, 440.0, 410.0, 775.0, 690.0, 920.0, 1020.0, 590.0, 660.0, 465.0, 1020.0, 745.0, 510.0, 750.0, 300.0, 925.0, 210.0, 790.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 20.0, 20.0, 0.0, 0.0, -10.0, 80.0, 470.0, 60.0, 70.0, 40.0, 30.0, 0.0, 160.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 0.0, 40.0, 30.0, 90.0, 30.0, 290.0, 80.0, 290.0, 40.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 10.0, 25.0, 100.0, 60.0, 30.0, 30.0, 10.0, 60.0, 30.0, -5.0, 20.0, 30.0, 0.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 10.0, 10.0, 50.0, 20.0, 10.0, 40.0, 60.0, 20.0, 30.0, 30.0, 60.0, 10.0, 20.0, 30.0, 40.0, 20.0, 60.0, 160.0, 100.0, 70.0, 370.0, 50.0, 170.0, 30.0, 30.0, 70.0, 30.0, 0.0, 30.0, 300.0, 40.0, 160.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 40.0, 70.0, 240.0, 60.0, 60.0, 10.0, 300.0, 40.0, 120.0, 30.0, 20.0, 90.0, 25.0, 20.0, 60.0, 30.0, 20.0, 10.0, 40.0, 0.0, 220.0, 80.0, 0.0, 30.0, 20.0, 20.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 25.0, 40.0, 70.0, 20.0, 0.0, 50.0, 10.0, 80.0, 40.0, 70.0, 40.0, 120.0, 20.0, 30.0, 0.0, 15.0, 20.0, -15.0, 40.0, 0.0, 50.0, 10.0, 30.0, 60.0, 60.0, -30.0, 230.0, 380.0, 20.0, 370.0, 20.0, 40.0, 10.0, 0.0, 0.0, 30.0, 70.0, 10.0, 50.0, 90.0, 30.0, 40.0, 10.0, 90.0, 250.0, 50.0, 0.0, -50.0, 80.0, 30.0, 60.0, 10.0, 60.0, 30.0, 60.0, 40.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 20.0, 70.0, 30.0, 30.0, 50.0, 20.0, 30.0, 40.0, 160.0, 160.0, 30.0, 160.0, 0.0, 30.0, 10.0, 15.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, -20.0, 40.0, 40.0, 50.0, 320.0, 50.0, 180.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 170.0, 0.0, 130.0, 10.0, 0.0, 20.0, 40.0, 0.0, 60.0, 0.0, 0.0, 10.0, 40.0, 50.0, 55.0, 20.0, -50.0, 20.0, 180.0, 190.0, 80.0, 10.0, 70.0, 10.0, 40.0, 40.0, 190.0, 70.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 80.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 20.0, 10.0, 30.0, 270.0, 0.0, 10.0, 30.0, 40.0, 40.0, 30.0, 70.0, 0.0, 70.0, 40.0, 40.0, 20.0, 30.0, 200.0, 30.0, 90.0, -20.0, 0.0, 40.0, 80.0, -25.0, 60.0, 15.0, 90.0, 10.0, 190.0, 10.0, 0.0, 80.0, 20.0, 10.0, 20.0, 60.0, -30.0, 0.0, 20.0, 30.0, 10.0, 70.0, 20.0, 220.0, 30.0, 0.0, 120.0, 0.0, 80.0, 0.0, 110.0, 230.0, 120.0, 10.0, 80.0, 70.0, 40.0, 70.0, 30.0, 5.0, 30.0, 10.0, 30.0, 80.0, 0.0, 0.0, 0.0, 280.0, 0.0, 30.0, 280.0, 0.0, 50.0, 10.0, 150.0, 50.0, 30.0, 180.0, 70.0, -40.0, 30.0, 370.0, 90.0, -30.0, 30.0, 60.0, 60.0, 40.0, 50.0, 120.0, 30.0, 30.0, 0.0, 30.0, 20.0, 10.0, 170.0, 40.0, 50.0, 40.0, 0.0, 10.0, 50.0, 70.0, 60.0, 10.0, 20.0, 0.0, 80.0, 30.0, 190.0, 80.0, 0.0, 45.0, 60.0, 10.0, 40.0, 20.0, 40.0, 40.0, 110.0, 160.0, 400.0, 20.0, -10.0, -10.0, 40.0, 40.0, 80.0, -10.0, -45.0, -140.0, 0.0, 20.0, 250.0, 0.0, 20.0, 20.0, 10.0, 10.0, 60.0, 260.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 70.0, 110.0, 30.0, 60.0, 10.0, 10.0, 0.0, 190.0, 0.0, 110.0, 30.0, 30.0, 60.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 60.0, 40.0, 40.0, 10.0, 15.0, 10.0, 160.0, 20.0, 20.0, 70.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 150.0, 40.0, 60.0, 30.0, 120.0, 40.0, 170.0, 10.0, 0.0, 40.0, 20.0, 30.0, -25.0, 40.0, 40.0, 230.0, 90.0, 20.0, -250.0, 160.0, 60.0, 90.0, 10.0, 40.0, 20.0, 80.0, 250.0, 170.0, 30.0, 50.0, 20.0, 0.0, 70.0, 120.0, 70.0, 90.0, 40.0, 440.0, 30.0, 170.0, 155.0, 50.0, 350.0, 80.0, 140.0, 40.0, 30.0, 90.0, 90.0, -10.0, 120.0, 180.0, 30.0, 40.0, 190.0, 210.0, 20.0, 50.0, 50.0, 30.0, 90.0, 290.0, 40.0, 310.0, 50.0, 20.0, 80.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 150.0, 30.0, 20.0, 40.0, 40.0, 130.0, 0.0, 270.0, 30.0, 0.0, -10.0, 50.0, 60.0, 460.0, 30.0, 10.0, 10.0, 30.0, 10.0, 10.0, 0.0, 5.0, 60.0, 60.0, 160.0, 10.0, 30.0, 60.0, 80.0, 20.0, 20.0, 20.0, 30.0, 40.0, 50.0, 90.0, 10.0, 0.0, 320.0, 10.0, 30.0, 30.0, 20.0, 60.0, 30.0, 10.0, 50.0, 10.0, 60.0, 20.0, 10.0, 50.0, 10.0, 10.0, 60.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 70.0, 30.0, 10.0, 170.0, 20.0, 0.0, 10.0, 70.0, 220.0, 40.0, 70.0, 50.0, 150.0, 155.0, -50.0, 70.0, 80.0, 35.0, 20.0, 30.0, 50.0, 0.0, 100.0, 50.0, 0.0, 10.0, 20.0, 80.0, 30.0, 60.0, -10.0, 60.0, 0.0, 40.0, 30.0, 40.0, 190.0, 80.0, 80.0, 90.0, 40.0, 80.0, 150.0, 40.0, 460.0, 40.0, 140.0, 120.0, 70.0, 60.0, 50.0, 30.0, 30.0, 30.0, 0.0, 40.0, 170.0, 0.0, 0.0, 10.0, 90.0, 30.0, 30.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 110.0, 30.0, 160.0, 120.0, 40.0, 20.0, 30.0, 45.0, 230.0, 190.0, 20.0, 110.0, 200.0, 85.0, 50.0, 50.0, 20.0, 210.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, -55.0, 30.0, 190.0, 40.0, 20.0, 20.0, 30.0, 70.0, 0.0, 0.0, 30.0, 15.0, 0.0, 10.0, 30.0, 50.0, 180.0, 10.0, 130.0, 20.0, 0.0, 20.0, 80.0, 40.0, 30.0, 30.0, 90.0, 30.0, 20.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 380.0, 20.0, 330.0, 50.0, 240.0, 120.0, -40.0, 245.0, 70.0, -90.0, 0.0, 50.0, 20.0, -50.0, 160.0, -20.0, 60.0, -40.0, -50.0, -50.0, 150.0, 120.0, 30.0, 110.0, 170.0, 70.0, 20.0, 60.0, 0.0, 70.0, 260.0, 110.0, 40.0, 0.0, 90.0, 10.0, 20.0, 10.0, 60.0, 140.0, 60.0, 90.0, 150.0, 0.0, 10.0, 10.0, 70.0, 120.0, 40.0, 80.0, 30.0, 70.0, 70.0, -10.0, 170.0, 120.0, 40.0, 170.0, 70.0, 30.0, 40.0, 30.0, 30.0, 50.0, 50.0, 170.0, 10.0, 90.0, 50.0, 20.0, 40.0, 0.0, 10.0, 70.0, 10.0, 0.0, 10.0, 0.0, 30.0, 190.0, 40.0, 20.0, 150.0, 40.0, 160.0, 40.0, 50.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 40.0, 30.0, 0.0, 100.0, 20.0, 30.0, 0.0, 30.0, 210.0, 0.0, 70.0, 40.0, 30.0, 20.0, 10.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 80.0, 10.0, 20.0, 150.0, 20.0, -10.0, 40.0, 30.0, 30.0, 240.0, 180.0, 160.0, 15.0, 30.0, 60.0, -50.0, 60.0, 180.0, 40.0, 110.0, 10.0, 190.0, 60.0, 20.0, 70.0, 300.0, 20.0, 40.0, 130.0, 80.0, 140.0, 40.0, 60.0, 80.0, 30.0, 160.0, 30.0, 120.0, 40.0, 150.0, 20.0, 70.0, 80.0, 60.0, 290.0, 40.0, 170.0, 180.0, 60.0, 80.0, 40.0, -30.0, 80.0, -90.0, 60.0, 80.0, 100.0, 30.0, 80.0, 50.0, 40.0, 20.0, 10.0, 160.0, 90.0, 0.0, 50.0, 50.0, 50.0, 50.0, 125.0, 30.0, 20.0, 30.0, 60.0, 30.0, 170.0, 30.0, 280.0, 70.0, 10.0, 20.0, 20.0, 380.0, 10.0, -10.0, 80.0, 10.0, 60.0, 70.0, 50.0, 100.0, -5.0, 40.0, 350.0, 40.0, 60.0, 10.0, 200.0, 10.0, 70.0, 20.0, 10.0, 30.0, 60.0, 20.0, 50.0, 0.0, 300.0, 30.0, 50.0, 30.0, 270.0, -10.0, 10.0, 30.0, 30.0, 0.0, 60.0, 90.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 90.0, 210.0, 50.0, 5.0, 170.0, 160.0, 130.0, 40.0, 0.0, 10.0, 45.0, 40.0, 60.0, 20.0, 10.0, 40.0, -15.0, 0.0, 220.0, 200.0, 0.0, 40.0, 0.0, 150.0, 0.0, 40.0, 70.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.567578952815532, "mean_inference_ms": 1.4192007352365335, "mean_action_processing_ms": 0.44786034409056524, "mean_env_wait_ms": 1.2740697359093656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012239217758178711, "StateBufferConnector_ms": 0.00930929183959961, "ViewRequirementAgentConnector_ms": 0.3547840118408203}, "num_episodes": 22, "episode_return_max": 1435.0, "episode_return_min": 40.0, "episode_return_mean": 569.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.5703447205146, "num_env_steps_trained_throughput_per_sec": 21.5703447205146, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 186368.263, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186368.218, "sample_time_ms": 2438.086, "learn_time_ms": 183909.451, "learn_throughput": 21.75, "synch_weights_time_ms": 12.909}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 38, "trial_id": "90816_00000", "date": "2024-06-10_02-12-15", "timestamp": 1717999935, "time_this_iter_s": 185.44894790649414, "time_total_s": 7214.155414581299, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00cc790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7214.155414581299, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.340304182509506, "ram_util_percent": 78.84144486692016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.004095960691714, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.789608174365676, "policy_loss": -0.010271005227460592, "vf_loss": 5.798287050564068, "vf_explained_var": 0.007941715017802164, "kl": 0.00796059692163348, "entropy": 0.7930141009969579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 361515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 1435.0, "episode_reward_min": 40.0, "episode_reward_mean": 573.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 57.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.0, 595.0, 540.0, 480.0, 450.0, 530.0, 340.0, 360.0, 520.0, 810.0, 465.0, 780.0, 680.0, 500.0, 310.0, 555.0, 830.0, 195.0, 420.0, 220.0, 550.0, 230.0, 445.0, 310.0, 520.0, 455.0, 670.0, 1235.0, 1110.0, 1000.0, 530.0, 730.0, 650.0, 475.0, 600.0, 310.0, 210.0, 380.0, 855.0, 315.0, 520.0, 1200.0, 600.0, 280.0, 595.0, 1165.0, 335.0, 195.0, 560.0, 340.0, 1435.0, 40.0, 680.0, 670.0, 690.0, 810.0, 550.0, 190.0, 700.0, 270.0, 440.0, 410.0, 775.0, 690.0, 920.0, 1020.0, 590.0, 660.0, 465.0, 1020.0, 745.0, 510.0, 750.0, 300.0, 925.0, 210.0, 790.0, 535.0, 530.0, 310.0, 1250.0, 340.0, 310.0, 530.0, 560.0, 320.0, 595.0, 890.0, 190.0, 215.0, 540.0, 240.0, 630.0, 750.0, 660.0, 660.0, 1020.0, 785.0, 420.0, 630.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 10.0, 0.0, 20.0, 40.0, 0.0, 60.0, 0.0, 0.0, 10.0, 40.0, 50.0, 55.0, 20.0, -50.0, 20.0, 180.0, 190.0, 80.0, 10.0, 70.0, 10.0, 40.0, 40.0, 190.0, 70.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 80.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 20.0, 10.0, 30.0, 270.0, 0.0, 10.0, 30.0, 40.0, 40.0, 30.0, 70.0, 0.0, 70.0, 40.0, 40.0, 20.0, 30.0, 200.0, 30.0, 90.0, -20.0, 0.0, 40.0, 80.0, -25.0, 60.0, 15.0, 90.0, 10.0, 190.0, 10.0, 0.0, 80.0, 20.0, 10.0, 20.0, 60.0, -30.0, 0.0, 20.0, 30.0, 10.0, 70.0, 20.0, 220.0, 30.0, 0.0, 120.0, 0.0, 80.0, 0.0, 110.0, 230.0, 120.0, 10.0, 80.0, 70.0, 40.0, 70.0, 30.0, 5.0, 30.0, 10.0, 30.0, 80.0, 0.0, 0.0, 0.0, 280.0, 0.0, 30.0, 280.0, 0.0, 50.0, 10.0, 150.0, 50.0, 30.0, 180.0, 70.0, -40.0, 30.0, 370.0, 90.0, -30.0, 30.0, 60.0, 60.0, 40.0, 50.0, 120.0, 30.0, 30.0, 0.0, 30.0, 20.0, 10.0, 170.0, 40.0, 50.0, 40.0, 0.0, 10.0, 50.0, 70.0, 60.0, 10.0, 20.0, 0.0, 80.0, 30.0, 190.0, 80.0, 0.0, 45.0, 60.0, 10.0, 40.0, 20.0, 40.0, 40.0, 110.0, 160.0, 400.0, 20.0, -10.0, -10.0, 40.0, 40.0, 80.0, -10.0, -45.0, -140.0, 0.0, 20.0, 250.0, 0.0, 20.0, 20.0, 10.0, 10.0, 60.0, 260.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 70.0, 110.0, 30.0, 60.0, 10.0, 10.0, 0.0, 190.0, 0.0, 110.0, 30.0, 30.0, 60.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 60.0, 40.0, 40.0, 10.0, 15.0, 10.0, 160.0, 20.0, 20.0, 70.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 150.0, 40.0, 60.0, 30.0, 120.0, 40.0, 170.0, 10.0, 0.0, 40.0, 20.0, 30.0, -25.0, 40.0, 40.0, 230.0, 90.0, 20.0, -250.0, 160.0, 60.0, 90.0, 10.0, 40.0, 20.0, 80.0, 250.0, 170.0, 30.0, 50.0, 20.0, 0.0, 70.0, 120.0, 70.0, 90.0, 40.0, 440.0, 30.0, 170.0, 155.0, 50.0, 350.0, 80.0, 140.0, 40.0, 30.0, 90.0, 90.0, -10.0, 120.0, 180.0, 30.0, 40.0, 190.0, 210.0, 20.0, 50.0, 50.0, 30.0, 90.0, 290.0, 40.0, 310.0, 50.0, 20.0, 80.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 150.0, 30.0, 20.0, 40.0, 40.0, 130.0, 0.0, 270.0, 30.0, 0.0, -10.0, 50.0, 60.0, 460.0, 30.0, 10.0, 10.0, 30.0, 10.0, 10.0, 0.0, 5.0, 60.0, 60.0, 160.0, 10.0, 30.0, 60.0, 80.0, 20.0, 20.0, 20.0, 30.0, 40.0, 50.0, 90.0, 10.0, 0.0, 320.0, 10.0, 30.0, 30.0, 20.0, 60.0, 30.0, 10.0, 50.0, 10.0, 60.0, 20.0, 10.0, 50.0, 10.0, 10.0, 60.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 70.0, 30.0, 10.0, 170.0, 20.0, 0.0, 10.0, 70.0, 220.0, 40.0, 70.0, 50.0, 150.0, 155.0, -50.0, 70.0, 80.0, 35.0, 20.0, 30.0, 50.0, 0.0, 100.0, 50.0, 0.0, 10.0, 20.0, 80.0, 30.0, 60.0, -10.0, 60.0, 0.0, 40.0, 30.0, 40.0, 190.0, 80.0, 80.0, 90.0, 40.0, 80.0, 150.0, 40.0, 460.0, 40.0, 140.0, 120.0, 70.0, 60.0, 50.0, 30.0, 30.0, 30.0, 0.0, 40.0, 170.0, 0.0, 0.0, 10.0, 90.0, 30.0, 30.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 110.0, 30.0, 160.0, 120.0, 40.0, 20.0, 30.0, 45.0, 230.0, 190.0, 20.0, 110.0, 200.0, 85.0, 50.0, 50.0, 20.0, 210.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, -55.0, 30.0, 190.0, 40.0, 20.0, 20.0, 30.0, 70.0, 0.0, 0.0, 30.0, 15.0, 0.0, 10.0, 30.0, 50.0, 180.0, 10.0, 130.0, 20.0, 0.0, 20.0, 80.0, 40.0, 30.0, 30.0, 90.0, 30.0, 20.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 380.0, 20.0, 330.0, 50.0, 240.0, 120.0, -40.0, 245.0, 70.0, -90.0, 0.0, 50.0, 20.0, -50.0, 160.0, -20.0, 60.0, -40.0, -50.0, -50.0, 150.0, 120.0, 30.0, 110.0, 170.0, 70.0, 20.0, 60.0, 0.0, 70.0, 260.0, 110.0, 40.0, 0.0, 90.0, 10.0, 20.0, 10.0, 60.0, 140.0, 60.0, 90.0, 150.0, 0.0, 10.0, 10.0, 70.0, 120.0, 40.0, 80.0, 30.0, 70.0, 70.0, -10.0, 170.0, 120.0, 40.0, 170.0, 70.0, 30.0, 40.0, 30.0, 30.0, 50.0, 50.0, 170.0, 10.0, 90.0, 50.0, 20.0, 40.0, 0.0, 10.0, 70.0, 10.0, 0.0, 10.0, 0.0, 30.0, 190.0, 40.0, 20.0, 150.0, 40.0, 160.0, 40.0, 50.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 40.0, 30.0, 0.0, 100.0, 20.0, 30.0, 0.0, 30.0, 210.0, 0.0, 70.0, 40.0, 30.0, 20.0, 10.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 80.0, 10.0, 20.0, 150.0, 20.0, -10.0, 40.0, 30.0, 30.0, 240.0, 180.0, 160.0, 15.0, 30.0, 60.0, -50.0, 60.0, 180.0, 40.0, 110.0, 10.0, 190.0, 60.0, 20.0, 70.0, 300.0, 20.0, 40.0, 130.0, 80.0, 140.0, 40.0, 60.0, 80.0, 30.0, 160.0, 30.0, 120.0, 40.0, 150.0, 20.0, 70.0, 80.0, 60.0, 290.0, 40.0, 170.0, 180.0, 60.0, 80.0, 40.0, -30.0, 80.0, -90.0, 60.0, 80.0, 100.0, 30.0, 80.0, 50.0, 40.0, 20.0, 10.0, 160.0, 90.0, 0.0, 50.0, 50.0, 50.0, 50.0, 125.0, 30.0, 20.0, 30.0, 60.0, 30.0, 170.0, 30.0, 280.0, 70.0, 10.0, 20.0, 20.0, 380.0, 10.0, -10.0, 80.0, 10.0, 60.0, 70.0, 50.0, 100.0, -5.0, 40.0, 350.0, 40.0, 60.0, 10.0, 200.0, 10.0, 70.0, 20.0, 10.0, 30.0, 60.0, 20.0, 50.0, 0.0, 300.0, 30.0, 50.0, 30.0, 270.0, -10.0, 10.0, 30.0, 30.0, 0.0, 60.0, 90.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 90.0, 210.0, 50.0, 5.0, 170.0, 160.0, 130.0, 40.0, 0.0, 10.0, 45.0, 40.0, 60.0, 20.0, 10.0, 40.0, -15.0, 0.0, 220.0, 200.0, 0.0, 40.0, 0.0, 150.0, 0.0, 40.0, 70.0, 70.0, 65.0, 20.0, 190.0, 20.0, -50.0, 30.0, 30.0, 30.0, 190.0, 10.0, 0.0, 70.0, 40.0, 40.0, 40.0, 40.0, 30.0, 90.0, 100.0, 80.0, 40.0, 60.0, 0.0, 10.0, 70.0, 50.0, 30.0, 40.0, 0.0, 10.0, 50.0, 20.0, 240.0, 310.0, 90.0, 50.0, 110.0, 70.0, 250.0, 60.0, 10.0, 0.0, 160.0, 50.0, 10.0, 30.0, 40.0, 10.0, 20.0, 10.0, 20.0, 30.0, 40.0, 40.0, 60.0, 40.0, 20.0, 10.0, 20.0, 30.0, 60.0, 60.0, 140.0, 10.0, 70.0, 20.0, 10.0, 40.0, 90.0, 30.0, 30.0, 40.0, 90.0, -30.0, 40.0, 20.0, 70.0, 150.0, 90.0, 60.0, 30.0, 20.0, 70.0, 40.0, 30.0, 30.0, 20.0, 40.0, 20.0, 20.0, -20.0, 0.0, 50.0, 10.0, 40.0, 20.0, 50.0, 370.0, 35.0, 40.0, 30.0, 0.0, -30.0, 100.0, 140.0, 30.0, 20.0, 40.0, 190.0, 370.0, 30.0, 50.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 50.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, -5.0, 0.0, 90.0, 30.0, 70.0, 90.0, 30.0, 40.0, 10.0, 120.0, 60.0, 70.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 20.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 90.0, 190.0, 0.0, 70.0, 60.0, 70.0, 20.0, 90.0, 160.0, 40.0, 60.0, 70.0, 30.0, 170.0, 90.0, 20.0, 130.0, 50.0, 180.0, 0.0, -20.0, -40.0, 260.0, 0.0, 20.0, 80.0, 20.0, 30.0, 260.0, 10.0, 0.0, 10.0, 70.0, 190.0, 20.0, 50.0, 30.0, 30.0, 20.0, 100.0, 30.0, 50.0, 180.0, 70.0, 250.0, 260.0, -25.0, 70.0, 0.0, 20.0, 60.0, 20.0, 30.0, 380.0, 200.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 30.0, 120.0, 10.0, 30.0, 80.0, 40.0, -30.0, 60.0, 90.0, 40.0, 10.0, 0.0, 10.0, 20.0, 390.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5652046236575103, "mean_inference_ms": 1.418385617478143, "mean_action_processing_ms": 0.4457911520632819, "mean_env_wait_ms": 1.2720886826739861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012733936309814453, "StateBufferConnector_ms": 0.010314226150512695, "ViewRequirementAgentConnector_ms": 0.35323071479797363}, "num_episodes": 23, "episode_return_max": 1435.0, "episode_return_min": 40.0, "episode_return_mean": 573.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.48147199327655, "num_env_steps_trained_throughput_per_sec": 21.48147199327655, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 186194.988, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186194.942, "sample_time_ms": 2430.729, "learn_time_ms": 183743.697, "learn_throughput": 21.769, "synch_weights_time_ms": 12.716}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 39, "trial_id": "90816_00000", "date": "2024-06-10_02-15-21", "timestamp": 1718000121, "time_this_iter_s": 186.2145631313324, "time_total_s": 7400.369977712631, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f6940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7400.369977712631, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.634980988593156, "ram_util_percent": 78.99695817490493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.026131927294218, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.449771956259958, "policy_loss": -0.010389145987214476, "vf_loss": 5.458523135317273, "vf_explained_var": 0.0024160535000383662, "kl": 0.008189855412464711, "entropy": 0.8021687929241802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 370905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 1435.0, "episode_reward_min": 40.0, "episode_reward_mean": 573.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 57.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 220.0, 550.0, 230.0, 445.0, 310.0, 520.0, 455.0, 670.0, 1235.0, 1110.0, 1000.0, 530.0, 730.0, 650.0, 475.0, 600.0, 310.0, 210.0, 380.0, 855.0, 315.0, 520.0, 1200.0, 600.0, 280.0, 595.0, 1165.0, 335.0, 195.0, 560.0, 340.0, 1435.0, 40.0, 680.0, 670.0, 690.0, 810.0, 550.0, 190.0, 700.0, 270.0, 440.0, 410.0, 775.0, 690.0, 920.0, 1020.0, 590.0, 660.0, 465.0, 1020.0, 745.0, 510.0, 750.0, 300.0, 925.0, 210.0, 790.0, 535.0, 530.0, 310.0, 1250.0, 340.0, 310.0, 530.0, 560.0, 320.0, 595.0, 890.0, 190.0, 215.0, 540.0, 240.0, 630.0, 750.0, 660.0, 660.0, 1020.0, 785.0, 420.0, 630.0, 350.0, 750.0, 400.0, 540.0, 450.0, 290.0, 610.0, 555.0, 275.0, 950.0, 415.0, 270.0, 630.0, 835.0, 610.0, 280.0, 420.0, 540.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 60.0, 260.0, 10.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 70.0, 110.0, 30.0, 60.0, 10.0, 10.0, 0.0, 190.0, 0.0, 110.0, 30.0, 30.0, 60.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 30.0, 10.0, 60.0, 40.0, 40.0, 10.0, 15.0, 10.0, 160.0, 20.0, 20.0, 70.0, 20.0, 0.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 150.0, 40.0, 60.0, 30.0, 120.0, 40.0, 170.0, 10.0, 0.0, 40.0, 20.0, 30.0, -25.0, 40.0, 40.0, 230.0, 90.0, 20.0, -250.0, 160.0, 60.0, 90.0, 10.0, 40.0, 20.0, 80.0, 250.0, 170.0, 30.0, 50.0, 20.0, 0.0, 70.0, 120.0, 70.0, 90.0, 40.0, 440.0, 30.0, 170.0, 155.0, 50.0, 350.0, 80.0, 140.0, 40.0, 30.0, 90.0, 90.0, -10.0, 120.0, 180.0, 30.0, 40.0, 190.0, 210.0, 20.0, 50.0, 50.0, 30.0, 90.0, 290.0, 40.0, 310.0, 50.0, 20.0, 80.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 150.0, 30.0, 20.0, 40.0, 40.0, 130.0, 0.0, 270.0, 30.0, 0.0, -10.0, 50.0, 60.0, 460.0, 30.0, 10.0, 10.0, 30.0, 10.0, 10.0, 0.0, 5.0, 60.0, 60.0, 160.0, 10.0, 30.0, 60.0, 80.0, 20.0, 20.0, 20.0, 30.0, 40.0, 50.0, 90.0, 10.0, 0.0, 320.0, 10.0, 30.0, 30.0, 20.0, 60.0, 30.0, 10.0, 50.0, 10.0, 60.0, 20.0, 10.0, 50.0, 10.0, 10.0, 60.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 70.0, 30.0, 10.0, 170.0, 20.0, 0.0, 10.0, 70.0, 220.0, 40.0, 70.0, 50.0, 150.0, 155.0, -50.0, 70.0, 80.0, 35.0, 20.0, 30.0, 50.0, 0.0, 100.0, 50.0, 0.0, 10.0, 20.0, 80.0, 30.0, 60.0, -10.0, 60.0, 0.0, 40.0, 30.0, 40.0, 190.0, 80.0, 80.0, 90.0, 40.0, 80.0, 150.0, 40.0, 460.0, 40.0, 140.0, 120.0, 70.0, 60.0, 50.0, 30.0, 30.0, 30.0, 0.0, 40.0, 170.0, 0.0, 0.0, 10.0, 90.0, 30.0, 30.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 110.0, 30.0, 160.0, 120.0, 40.0, 20.0, 30.0, 45.0, 230.0, 190.0, 20.0, 110.0, 200.0, 85.0, 50.0, 50.0, 20.0, 210.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, -55.0, 30.0, 190.0, 40.0, 20.0, 20.0, 30.0, 70.0, 0.0, 0.0, 30.0, 15.0, 0.0, 10.0, 30.0, 50.0, 180.0, 10.0, 130.0, 20.0, 0.0, 20.0, 80.0, 40.0, 30.0, 30.0, 90.0, 30.0, 20.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 380.0, 20.0, 330.0, 50.0, 240.0, 120.0, -40.0, 245.0, 70.0, -90.0, 0.0, 50.0, 20.0, -50.0, 160.0, -20.0, 60.0, -40.0, -50.0, -50.0, 150.0, 120.0, 30.0, 110.0, 170.0, 70.0, 20.0, 60.0, 0.0, 70.0, 260.0, 110.0, 40.0, 0.0, 90.0, 10.0, 20.0, 10.0, 60.0, 140.0, 60.0, 90.0, 150.0, 0.0, 10.0, 10.0, 70.0, 120.0, 40.0, 80.0, 30.0, 70.0, 70.0, -10.0, 170.0, 120.0, 40.0, 170.0, 70.0, 30.0, 40.0, 30.0, 30.0, 50.0, 50.0, 170.0, 10.0, 90.0, 50.0, 20.0, 40.0, 0.0, 10.0, 70.0, 10.0, 0.0, 10.0, 0.0, 30.0, 190.0, 40.0, 20.0, 150.0, 40.0, 160.0, 40.0, 50.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 40.0, 30.0, 0.0, 100.0, 20.0, 30.0, 0.0, 30.0, 210.0, 0.0, 70.0, 40.0, 30.0, 20.0, 10.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 80.0, 10.0, 20.0, 150.0, 20.0, -10.0, 40.0, 30.0, 30.0, 240.0, 180.0, 160.0, 15.0, 30.0, 60.0, -50.0, 60.0, 180.0, 40.0, 110.0, 10.0, 190.0, 60.0, 20.0, 70.0, 300.0, 20.0, 40.0, 130.0, 80.0, 140.0, 40.0, 60.0, 80.0, 30.0, 160.0, 30.0, 120.0, 40.0, 150.0, 20.0, 70.0, 80.0, 60.0, 290.0, 40.0, 170.0, 180.0, 60.0, 80.0, 40.0, -30.0, 80.0, -90.0, 60.0, 80.0, 100.0, 30.0, 80.0, 50.0, 40.0, 20.0, 10.0, 160.0, 90.0, 0.0, 50.0, 50.0, 50.0, 50.0, 125.0, 30.0, 20.0, 30.0, 60.0, 30.0, 170.0, 30.0, 280.0, 70.0, 10.0, 20.0, 20.0, 380.0, 10.0, -10.0, 80.0, 10.0, 60.0, 70.0, 50.0, 100.0, -5.0, 40.0, 350.0, 40.0, 60.0, 10.0, 200.0, 10.0, 70.0, 20.0, 10.0, 30.0, 60.0, 20.0, 50.0, 0.0, 300.0, 30.0, 50.0, 30.0, 270.0, -10.0, 10.0, 30.0, 30.0, 0.0, 60.0, 90.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 90.0, 210.0, 50.0, 5.0, 170.0, 160.0, 130.0, 40.0, 0.0, 10.0, 45.0, 40.0, 60.0, 20.0, 10.0, 40.0, -15.0, 0.0, 220.0, 200.0, 0.0, 40.0, 0.0, 150.0, 0.0, 40.0, 70.0, 70.0, 65.0, 20.0, 190.0, 20.0, -50.0, 30.0, 30.0, 30.0, 190.0, 10.0, 0.0, 70.0, 40.0, 40.0, 40.0, 40.0, 30.0, 90.0, 100.0, 80.0, 40.0, 60.0, 0.0, 10.0, 70.0, 50.0, 30.0, 40.0, 0.0, 10.0, 50.0, 20.0, 240.0, 310.0, 90.0, 50.0, 110.0, 70.0, 250.0, 60.0, 10.0, 0.0, 160.0, 50.0, 10.0, 30.0, 40.0, 10.0, 20.0, 10.0, 20.0, 30.0, 40.0, 40.0, 60.0, 40.0, 20.0, 10.0, 20.0, 30.0, 60.0, 60.0, 140.0, 10.0, 70.0, 20.0, 10.0, 40.0, 90.0, 30.0, 30.0, 40.0, 90.0, -30.0, 40.0, 20.0, 70.0, 150.0, 90.0, 60.0, 30.0, 20.0, 70.0, 40.0, 30.0, 30.0, 20.0, 40.0, 20.0, 20.0, -20.0, 0.0, 50.0, 10.0, 40.0, 20.0, 50.0, 370.0, 35.0, 40.0, 30.0, 0.0, -30.0, 100.0, 140.0, 30.0, 20.0, 40.0, 190.0, 370.0, 30.0, 50.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 50.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, -5.0, 0.0, 90.0, 30.0, 70.0, 90.0, 30.0, 40.0, 10.0, 120.0, 60.0, 70.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 20.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 90.0, 190.0, 0.0, 70.0, 60.0, 70.0, 20.0, 90.0, 160.0, 40.0, 60.0, 70.0, 30.0, 170.0, 90.0, 20.0, 130.0, 50.0, 180.0, 0.0, -20.0, -40.0, 260.0, 0.0, 20.0, 80.0, 20.0, 30.0, 260.0, 10.0, 0.0, 10.0, 70.0, 190.0, 20.0, 50.0, 30.0, 30.0, 20.0, 100.0, 30.0, 50.0, 180.0, 70.0, 250.0, 260.0, -25.0, 70.0, 0.0, 20.0, 60.0, 20.0, 30.0, 380.0, 200.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 30.0, 120.0, 10.0, 30.0, 80.0, 40.0, -30.0, 60.0, 90.0, 40.0, 10.0, 0.0, 10.0, 20.0, 390.0, 60.0, 50.0, 20.0, 30.0, 100.0, 0.0, 10.0, 30.0, 20.0, 30.0, 10.0, 220.0, 30.0, 70.0, 170.0, 30.0, 60.0, 50.0, 20.0, 90.0, 40.0, 40.0, 110.0, 10.0, 10.0, -50.0, -10.0, -20.0, 0.0, 270.0, 190.0, -50.0, 60.0, 0.0, 140.0, 50.0, 40.0, 70.0, 30.0, 10.0, 20.0, 80.0, 20.0, 80.0, 0.0, 30.0, 90.0, 100.0, 0.0, 30.0, 30.0, 20.0, 0.0, 110.0, 50.0, 0.0, 30.0, 10.0, 0.0, 40.0, 30.0, 20.0, 20.0, 150.0, 20.0, 40.0, 90.0, 180.0, 40.0, 20.0, 10.0, 20.0, 40.0, 320.0, 20.0, 45.0, 40.0, 50.0, -80.0, 90.0, 10.0, 10.0, 70.0, 0.0, 160.0, -25.0, 30.0, -30.0, 40.0, 10.0, 60.0, 130.0, 0.0, 10.0, 150.0, 20.0, 350.0, 90.0, 100.0, 40.0, 10.0, 30.0, 145.0, 10.0, 0.0, 20.0, 20.0, 20.0, 90.0, 70.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 100.0, 40.0, 30.0, 10.0, 190.0, 110.0, 210.0, 40.0, 10.0, 20.0, 20.0, 40.0, -20.0, 10.0, 30.0, 15.0, 20.0, 140.0, 50.0, 100.0, -10.0, 80.0, 220.0, 190.0, 70.0, 100.0, 40.0, 120.0, 100.0, 0.0, -60.0, 130.0, 80.0, 30.0, 10.0, 60.0, 30.0, 20.0, 0.0, 70.0, 30.0, 10.0, 0.0, 50.0, -80.0, 20.0, 180.0, 20.0, 40.0, 190.0, 10.0, 0.0, 20.0, 20.0, 40.0, 200.0, 110.0, 70.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.563646673627804, "mean_inference_ms": 1.4176936759186065, "mean_action_processing_ms": 0.44427157879397083, "mean_env_wait_ms": 1.2706954540634394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012974262237548828, "StateBufferConnector_ms": 0.010335206985473633, "ViewRequirementAgentConnector_ms": 0.35780930519104004}, "num_episodes": 18, "episode_return_max": 1435.0, "episode_return_min": 40.0, "episode_return_mean": 573.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.367390546381174, "num_env_steps_trained_throughput_per_sec": 21.367390546381174, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 186351.835, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186351.79, "sample_time_ms": 2419.903, "learn_time_ms": 183911.748, "learn_throughput": 21.75, "synch_weights_time_ms": 12.408}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 40, "trial_id": "90816_00000", "date": "2024-06-10_02-18-29", "timestamp": 1718000309, "time_this_iter_s": 187.20970702171326, "time_total_s": 7587.5796847343445, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f6d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7587.5796847343445, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.90943396226415, "ram_util_percent": 78.86037735849057}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2545958610578847, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.028596380546578, "policy_loss": -0.010518702642044452, "vf_loss": 6.03766247167374, "vf_explained_var": 0.0015999993958031406, "kl": 0.0072630577946100165, "entropy": 0.777529279949566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 380295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "env_runners": {"episode_reward_max": 1680.0, "episode_reward_min": 40.0, "episode_reward_mean": 604.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -95.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 60.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 380.0, 855.0, 315.0, 520.0, 1200.0, 600.0, 280.0, 595.0, 1165.0, 335.0, 195.0, 560.0, 340.0, 1435.0, 40.0, 680.0, 670.0, 690.0, 810.0, 550.0, 190.0, 700.0, 270.0, 440.0, 410.0, 775.0, 690.0, 920.0, 1020.0, 590.0, 660.0, 465.0, 1020.0, 745.0, 510.0, 750.0, 300.0, 925.0, 210.0, 790.0, 535.0, 530.0, 310.0, 1250.0, 340.0, 310.0, 530.0, 560.0, 320.0, 595.0, 890.0, 190.0, 215.0, 540.0, 240.0, 630.0, 750.0, 660.0, 660.0, 1020.0, 785.0, 420.0, 630.0, 350.0, 750.0, 400.0, 540.0, 450.0, 290.0, 610.0, 555.0, 275.0, 950.0, 415.0, 270.0, 630.0, 835.0, 610.0, 280.0, 420.0, 540.0, 540.0, 640.0, 860.0, 225.0, 835.0, 1010.0, 1100.0, 665.0, 985.0, 1065.0, 810.0, 1680.0, 450.0, 180.0, 545.0, 470.0, 860.0, 650.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 50.0, 10.0, 10.0, 60.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 70.0, 30.0, 10.0, 170.0, 20.0, 0.0, 10.0, 70.0, 220.0, 40.0, 70.0, 50.0, 150.0, 155.0, -50.0, 70.0, 80.0, 35.0, 20.0, 30.0, 50.0, 0.0, 100.0, 50.0, 0.0, 10.0, 20.0, 80.0, 30.0, 60.0, -10.0, 60.0, 0.0, 40.0, 30.0, 40.0, 190.0, 80.0, 80.0, 90.0, 40.0, 80.0, 150.0, 40.0, 460.0, 40.0, 140.0, 120.0, 70.0, 60.0, 50.0, 30.0, 30.0, 30.0, 0.0, 40.0, 170.0, 0.0, 0.0, 10.0, 90.0, 30.0, 30.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 110.0, 30.0, 160.0, 120.0, 40.0, 20.0, 30.0, 45.0, 230.0, 190.0, 20.0, 110.0, 200.0, 85.0, 50.0, 50.0, 20.0, 210.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, -55.0, 30.0, 190.0, 40.0, 20.0, 20.0, 30.0, 70.0, 0.0, 0.0, 30.0, 15.0, 0.0, 10.0, 30.0, 50.0, 180.0, 10.0, 130.0, 20.0, 0.0, 20.0, 80.0, 40.0, 30.0, 30.0, 90.0, 30.0, 20.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 380.0, 20.0, 330.0, 50.0, 240.0, 120.0, -40.0, 245.0, 70.0, -90.0, 0.0, 50.0, 20.0, -50.0, 160.0, -20.0, 60.0, -40.0, -50.0, -50.0, 150.0, 120.0, 30.0, 110.0, 170.0, 70.0, 20.0, 60.0, 0.0, 70.0, 260.0, 110.0, 40.0, 0.0, 90.0, 10.0, 20.0, 10.0, 60.0, 140.0, 60.0, 90.0, 150.0, 0.0, 10.0, 10.0, 70.0, 120.0, 40.0, 80.0, 30.0, 70.0, 70.0, -10.0, 170.0, 120.0, 40.0, 170.0, 70.0, 30.0, 40.0, 30.0, 30.0, 50.0, 50.0, 170.0, 10.0, 90.0, 50.0, 20.0, 40.0, 0.0, 10.0, 70.0, 10.0, 0.0, 10.0, 0.0, 30.0, 190.0, 40.0, 20.0, 150.0, 40.0, 160.0, 40.0, 50.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 40.0, 30.0, 0.0, 100.0, 20.0, 30.0, 0.0, 30.0, 210.0, 0.0, 70.0, 40.0, 30.0, 20.0, 10.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 80.0, 10.0, 20.0, 150.0, 20.0, -10.0, 40.0, 30.0, 30.0, 240.0, 180.0, 160.0, 15.0, 30.0, 60.0, -50.0, 60.0, 180.0, 40.0, 110.0, 10.0, 190.0, 60.0, 20.0, 70.0, 300.0, 20.0, 40.0, 130.0, 80.0, 140.0, 40.0, 60.0, 80.0, 30.0, 160.0, 30.0, 120.0, 40.0, 150.0, 20.0, 70.0, 80.0, 60.0, 290.0, 40.0, 170.0, 180.0, 60.0, 80.0, 40.0, -30.0, 80.0, -90.0, 60.0, 80.0, 100.0, 30.0, 80.0, 50.0, 40.0, 20.0, 10.0, 160.0, 90.0, 0.0, 50.0, 50.0, 50.0, 50.0, 125.0, 30.0, 20.0, 30.0, 60.0, 30.0, 170.0, 30.0, 280.0, 70.0, 10.0, 20.0, 20.0, 380.0, 10.0, -10.0, 80.0, 10.0, 60.0, 70.0, 50.0, 100.0, -5.0, 40.0, 350.0, 40.0, 60.0, 10.0, 200.0, 10.0, 70.0, 20.0, 10.0, 30.0, 60.0, 20.0, 50.0, 0.0, 300.0, 30.0, 50.0, 30.0, 270.0, -10.0, 10.0, 30.0, 30.0, 0.0, 60.0, 90.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 90.0, 210.0, 50.0, 5.0, 170.0, 160.0, 130.0, 40.0, 0.0, 10.0, 45.0, 40.0, 60.0, 20.0, 10.0, 40.0, -15.0, 0.0, 220.0, 200.0, 0.0, 40.0, 0.0, 150.0, 0.0, 40.0, 70.0, 70.0, 65.0, 20.0, 190.0, 20.0, -50.0, 30.0, 30.0, 30.0, 190.0, 10.0, 0.0, 70.0, 40.0, 40.0, 40.0, 40.0, 30.0, 90.0, 100.0, 80.0, 40.0, 60.0, 0.0, 10.0, 70.0, 50.0, 30.0, 40.0, 0.0, 10.0, 50.0, 20.0, 240.0, 310.0, 90.0, 50.0, 110.0, 70.0, 250.0, 60.0, 10.0, 0.0, 160.0, 50.0, 10.0, 30.0, 40.0, 10.0, 20.0, 10.0, 20.0, 30.0, 40.0, 40.0, 60.0, 40.0, 20.0, 10.0, 20.0, 30.0, 60.0, 60.0, 140.0, 10.0, 70.0, 20.0, 10.0, 40.0, 90.0, 30.0, 30.0, 40.0, 90.0, -30.0, 40.0, 20.0, 70.0, 150.0, 90.0, 60.0, 30.0, 20.0, 70.0, 40.0, 30.0, 30.0, 20.0, 40.0, 20.0, 20.0, -20.0, 0.0, 50.0, 10.0, 40.0, 20.0, 50.0, 370.0, 35.0, 40.0, 30.0, 0.0, -30.0, 100.0, 140.0, 30.0, 20.0, 40.0, 190.0, 370.0, 30.0, 50.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 50.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, -5.0, 0.0, 90.0, 30.0, 70.0, 90.0, 30.0, 40.0, 10.0, 120.0, 60.0, 70.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 20.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 90.0, 190.0, 0.0, 70.0, 60.0, 70.0, 20.0, 90.0, 160.0, 40.0, 60.0, 70.0, 30.0, 170.0, 90.0, 20.0, 130.0, 50.0, 180.0, 0.0, -20.0, -40.0, 260.0, 0.0, 20.0, 80.0, 20.0, 30.0, 260.0, 10.0, 0.0, 10.0, 70.0, 190.0, 20.0, 50.0, 30.0, 30.0, 20.0, 100.0, 30.0, 50.0, 180.0, 70.0, 250.0, 260.0, -25.0, 70.0, 0.0, 20.0, 60.0, 20.0, 30.0, 380.0, 200.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 30.0, 120.0, 10.0, 30.0, 80.0, 40.0, -30.0, 60.0, 90.0, 40.0, 10.0, 0.0, 10.0, 20.0, 390.0, 60.0, 50.0, 20.0, 30.0, 100.0, 0.0, 10.0, 30.0, 20.0, 30.0, 10.0, 220.0, 30.0, 70.0, 170.0, 30.0, 60.0, 50.0, 20.0, 90.0, 40.0, 40.0, 110.0, 10.0, 10.0, -50.0, -10.0, -20.0, 0.0, 270.0, 190.0, -50.0, 60.0, 0.0, 140.0, 50.0, 40.0, 70.0, 30.0, 10.0, 20.0, 80.0, 20.0, 80.0, 0.0, 30.0, 90.0, 100.0, 0.0, 30.0, 30.0, 20.0, 0.0, 110.0, 50.0, 0.0, 30.0, 10.0, 0.0, 40.0, 30.0, 20.0, 20.0, 150.0, 20.0, 40.0, 90.0, 180.0, 40.0, 20.0, 10.0, 20.0, 40.0, 320.0, 20.0, 45.0, 40.0, 50.0, -80.0, 90.0, 10.0, 10.0, 70.0, 0.0, 160.0, -25.0, 30.0, -30.0, 40.0, 10.0, 60.0, 130.0, 0.0, 10.0, 150.0, 20.0, 350.0, 90.0, 100.0, 40.0, 10.0, 30.0, 145.0, 10.0, 0.0, 20.0, 20.0, 20.0, 90.0, 70.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 100.0, 40.0, 30.0, 10.0, 190.0, 110.0, 210.0, 40.0, 10.0, 20.0, 20.0, 40.0, -20.0, 10.0, 30.0, 15.0, 20.0, 140.0, 50.0, 100.0, -10.0, 80.0, 220.0, 190.0, 70.0, 100.0, 40.0, 120.0, 100.0, 0.0, -60.0, 130.0, 80.0, 30.0, 10.0, 60.0, 30.0, 20.0, 0.0, 70.0, 30.0, 10.0, 0.0, 50.0, -80.0, 20.0, 180.0, 20.0, 40.0, 190.0, 10.0, 0.0, 20.0, 20.0, 40.0, 200.0, 110.0, 70.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 0.0, 10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 10.0, 410.0, 0.0, 40.0, 10.0, 20.0, 0.0, 110.0, 170.0, 30.0, 160.0, 50.0, 50.0, 180.0, 20.0, 150.0, 250.0, 35.0, 90.0, 50.0, 5.0, 60.0, 20.0, 20.0, 25.0, 60.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 95.0, 10.0, 40.0, 300.0, 40.0, 150.0, 20.0, 50.0, 90.0, 40.0, 100.0, 50.0, 30.0, 100.0, 110.0, 90.0, 200.0, 50.0, 240.0, 40.0, 100.0, 50.0, 80.0, 90.0, 60.0, 50.0, 190.0, 90.0, 50.0, 340.0, 50.0, 30.0, 10.0, 40.0, 0.0, 20.0, 100.0, 260.0, 60.0, 95.0, 420.0, 170.0, 45.0, 210.0, -50.0, 30.0, 50.0, 60.0, -30.0, 80.0, 30.0, 220.0, 460.0, 40.0, 20.0, 160.0, 30.0, -30.0, 35.0, 100.0, 220.0, 50.0, 30.0, 60.0, 80.0, 20.0, 150.0, 160.0, 30.0, 10.0, 70.0, 90.0, 30.0, 350.0, 50.0, 170.0, 650.0, 70.0, 170.0, 30.0, 80.0, 50.0, 100.0, 30.0, 40.0, 35.0, 60.0, 0.0, 25.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 150.0, -10.0, 370.0, -95.0, 30.0, -80.0, 10.0, 110.0, 10.0, 80.0, 120.0, 0.0, 110.0, 40.0, 70.0, 300.0, 40.0, 20.0, 70.0, 50.0, 80.0, 0.0, 270.0, 0.0, 30.0, 60.0, 110.0, 30.0, 40.0, 40.0, 90.0, 30.0, 60.0, 40.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.561888811911686, "mean_inference_ms": 1.41697776645451, "mean_action_processing_ms": 0.44285702938016186, "mean_env_wait_ms": 1.269390775204978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013106822967529297, "StateBufferConnector_ms": 0.010455131530761719, "ViewRequirementAgentConnector_ms": 0.37103867530822754}, "num_episodes": 18, "episode_return_max": 1680.0, "episode_return_min": 40.0, "episode_return_mean": 604.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.28191788972229, "num_env_steps_trained_throughput_per_sec": 21.28191788972229, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 1640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1640000, "timers": {"training_iteration_time_ms": 186751.138, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186751.092, "sample_time_ms": 2426.888, "learn_time_ms": 184304.669, "learn_throughput": 21.703, "synch_weights_time_ms": 11.885}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "done": false, "training_iteration": 41, "trial_id": "90816_00000", "date": "2024-06-10_02-21-37", "timestamp": 1718000497, "time_this_iter_s": 187.98391103744507, "time_total_s": 7775.56359577179, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7775.56359577179, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 19.5484962406015, "ram_util_percent": 79.4063909774436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7640445833642895, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.13357761883761, "policy_loss": -0.00941157456054982, "vf_loss": 6.141460693428438, "vf_explained_var": 0.0037940491946995324, "kl": 0.007642467830272282, "entropy": 0.7358989441229766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 389685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 1680.0, "episode_reward_min": 180.0, "episode_reward_mean": 642.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -95.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 64.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.0, 810.0, 550.0, 190.0, 700.0, 270.0, 440.0, 410.0, 775.0, 690.0, 920.0, 1020.0, 590.0, 660.0, 465.0, 1020.0, 745.0, 510.0, 750.0, 300.0, 925.0, 210.0, 790.0, 535.0, 530.0, 310.0, 1250.0, 340.0, 310.0, 530.0, 560.0, 320.0, 595.0, 890.0, 190.0, 215.0, 540.0, 240.0, 630.0, 750.0, 660.0, 660.0, 1020.0, 785.0, 420.0, 630.0, 350.0, 750.0, 400.0, 540.0, 450.0, 290.0, 610.0, 555.0, 275.0, 950.0, 415.0, 270.0, 630.0, 835.0, 610.0, 280.0, 420.0, 540.0, 540.0, 640.0, 860.0, 225.0, 835.0, 1010.0, 1100.0, 665.0, 985.0, 1065.0, 810.0, 1680.0, 450.0, 180.0, 545.0, 470.0, 860.0, 650.0, 340.0, 380.0, 1055.0, 640.0, 970.0, 360.0, 360.0, 1275.0, 1090.0, 540.0, 1255.0, 1485.0, 875.0, 640.0, 1050.0, 515.0, 535.0, 780.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 60.0, 90.0, 150.0, 0.0, 10.0, 10.0, 70.0, 120.0, 40.0, 80.0, 30.0, 70.0, 70.0, -10.0, 170.0, 120.0, 40.0, 170.0, 70.0, 30.0, 40.0, 30.0, 30.0, 50.0, 50.0, 170.0, 10.0, 90.0, 50.0, 20.0, 40.0, 0.0, 10.0, 70.0, 10.0, 0.0, 10.0, 0.0, 30.0, 190.0, 40.0, 20.0, 150.0, 40.0, 160.0, 40.0, 50.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 40.0, 30.0, 0.0, 100.0, 20.0, 30.0, 0.0, 30.0, 210.0, 0.0, 70.0, 40.0, 30.0, 20.0, 10.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 80.0, 10.0, 20.0, 150.0, 20.0, -10.0, 40.0, 30.0, 30.0, 240.0, 180.0, 160.0, 15.0, 30.0, 60.0, -50.0, 60.0, 180.0, 40.0, 110.0, 10.0, 190.0, 60.0, 20.0, 70.0, 300.0, 20.0, 40.0, 130.0, 80.0, 140.0, 40.0, 60.0, 80.0, 30.0, 160.0, 30.0, 120.0, 40.0, 150.0, 20.0, 70.0, 80.0, 60.0, 290.0, 40.0, 170.0, 180.0, 60.0, 80.0, 40.0, -30.0, 80.0, -90.0, 60.0, 80.0, 100.0, 30.0, 80.0, 50.0, 40.0, 20.0, 10.0, 160.0, 90.0, 0.0, 50.0, 50.0, 50.0, 50.0, 125.0, 30.0, 20.0, 30.0, 60.0, 30.0, 170.0, 30.0, 280.0, 70.0, 10.0, 20.0, 20.0, 380.0, 10.0, -10.0, 80.0, 10.0, 60.0, 70.0, 50.0, 100.0, -5.0, 40.0, 350.0, 40.0, 60.0, 10.0, 200.0, 10.0, 70.0, 20.0, 10.0, 30.0, 60.0, 20.0, 50.0, 0.0, 300.0, 30.0, 50.0, 30.0, 270.0, -10.0, 10.0, 30.0, 30.0, 0.0, 60.0, 90.0, 10.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 90.0, 210.0, 50.0, 5.0, 170.0, 160.0, 130.0, 40.0, 0.0, 10.0, 45.0, 40.0, 60.0, 20.0, 10.0, 40.0, -15.0, 0.0, 220.0, 200.0, 0.0, 40.0, 0.0, 150.0, 0.0, 40.0, 70.0, 70.0, 65.0, 20.0, 190.0, 20.0, -50.0, 30.0, 30.0, 30.0, 190.0, 10.0, 0.0, 70.0, 40.0, 40.0, 40.0, 40.0, 30.0, 90.0, 100.0, 80.0, 40.0, 60.0, 0.0, 10.0, 70.0, 50.0, 30.0, 40.0, 0.0, 10.0, 50.0, 20.0, 240.0, 310.0, 90.0, 50.0, 110.0, 70.0, 250.0, 60.0, 10.0, 0.0, 160.0, 50.0, 10.0, 30.0, 40.0, 10.0, 20.0, 10.0, 20.0, 30.0, 40.0, 40.0, 60.0, 40.0, 20.0, 10.0, 20.0, 30.0, 60.0, 60.0, 140.0, 10.0, 70.0, 20.0, 10.0, 40.0, 90.0, 30.0, 30.0, 40.0, 90.0, -30.0, 40.0, 20.0, 70.0, 150.0, 90.0, 60.0, 30.0, 20.0, 70.0, 40.0, 30.0, 30.0, 20.0, 40.0, 20.0, 20.0, -20.0, 0.0, 50.0, 10.0, 40.0, 20.0, 50.0, 370.0, 35.0, 40.0, 30.0, 0.0, -30.0, 100.0, 140.0, 30.0, 20.0, 40.0, 190.0, 370.0, 30.0, 50.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 50.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, -5.0, 0.0, 90.0, 30.0, 70.0, 90.0, 30.0, 40.0, 10.0, 120.0, 60.0, 70.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 20.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 90.0, 190.0, 0.0, 70.0, 60.0, 70.0, 20.0, 90.0, 160.0, 40.0, 60.0, 70.0, 30.0, 170.0, 90.0, 20.0, 130.0, 50.0, 180.0, 0.0, -20.0, -40.0, 260.0, 0.0, 20.0, 80.0, 20.0, 30.0, 260.0, 10.0, 0.0, 10.0, 70.0, 190.0, 20.0, 50.0, 30.0, 30.0, 20.0, 100.0, 30.0, 50.0, 180.0, 70.0, 250.0, 260.0, -25.0, 70.0, 0.0, 20.0, 60.0, 20.0, 30.0, 380.0, 200.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 30.0, 120.0, 10.0, 30.0, 80.0, 40.0, -30.0, 60.0, 90.0, 40.0, 10.0, 0.0, 10.0, 20.0, 390.0, 60.0, 50.0, 20.0, 30.0, 100.0, 0.0, 10.0, 30.0, 20.0, 30.0, 10.0, 220.0, 30.0, 70.0, 170.0, 30.0, 60.0, 50.0, 20.0, 90.0, 40.0, 40.0, 110.0, 10.0, 10.0, -50.0, -10.0, -20.0, 0.0, 270.0, 190.0, -50.0, 60.0, 0.0, 140.0, 50.0, 40.0, 70.0, 30.0, 10.0, 20.0, 80.0, 20.0, 80.0, 0.0, 30.0, 90.0, 100.0, 0.0, 30.0, 30.0, 20.0, 0.0, 110.0, 50.0, 0.0, 30.0, 10.0, 0.0, 40.0, 30.0, 20.0, 20.0, 150.0, 20.0, 40.0, 90.0, 180.0, 40.0, 20.0, 10.0, 20.0, 40.0, 320.0, 20.0, 45.0, 40.0, 50.0, -80.0, 90.0, 10.0, 10.0, 70.0, 0.0, 160.0, -25.0, 30.0, -30.0, 40.0, 10.0, 60.0, 130.0, 0.0, 10.0, 150.0, 20.0, 350.0, 90.0, 100.0, 40.0, 10.0, 30.0, 145.0, 10.0, 0.0, 20.0, 20.0, 20.0, 90.0, 70.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 100.0, 40.0, 30.0, 10.0, 190.0, 110.0, 210.0, 40.0, 10.0, 20.0, 20.0, 40.0, -20.0, 10.0, 30.0, 15.0, 20.0, 140.0, 50.0, 100.0, -10.0, 80.0, 220.0, 190.0, 70.0, 100.0, 40.0, 120.0, 100.0, 0.0, -60.0, 130.0, 80.0, 30.0, 10.0, 60.0, 30.0, 20.0, 0.0, 70.0, 30.0, 10.0, 0.0, 50.0, -80.0, 20.0, 180.0, 20.0, 40.0, 190.0, 10.0, 0.0, 20.0, 20.0, 40.0, 200.0, 110.0, 70.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 0.0, 10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 10.0, 410.0, 0.0, 40.0, 10.0, 20.0, 0.0, 110.0, 170.0, 30.0, 160.0, 50.0, 50.0, 180.0, 20.0, 150.0, 250.0, 35.0, 90.0, 50.0, 5.0, 60.0, 20.0, 20.0, 25.0, 60.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 95.0, 10.0, 40.0, 300.0, 40.0, 150.0, 20.0, 50.0, 90.0, 40.0, 100.0, 50.0, 30.0, 100.0, 110.0, 90.0, 200.0, 50.0, 240.0, 40.0, 100.0, 50.0, 80.0, 90.0, 60.0, 50.0, 190.0, 90.0, 50.0, 340.0, 50.0, 30.0, 10.0, 40.0, 0.0, 20.0, 100.0, 260.0, 60.0, 95.0, 420.0, 170.0, 45.0, 210.0, -50.0, 30.0, 50.0, 60.0, -30.0, 80.0, 30.0, 220.0, 460.0, 40.0, 20.0, 160.0, 30.0, -30.0, 35.0, 100.0, 220.0, 50.0, 30.0, 60.0, 80.0, 20.0, 150.0, 160.0, 30.0, 10.0, 70.0, 90.0, 30.0, 350.0, 50.0, 170.0, 650.0, 70.0, 170.0, 30.0, 80.0, 50.0, 100.0, 30.0, 40.0, 35.0, 60.0, 0.0, 25.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 150.0, -10.0, 370.0, -95.0, 30.0, -80.0, 10.0, 110.0, 10.0, 80.0, 120.0, 0.0, 110.0, 40.0, 70.0, 300.0, 40.0, 20.0, 70.0, 50.0, 80.0, 0.0, 270.0, 0.0, 30.0, 60.0, 110.0, 30.0, 40.0, 40.0, 90.0, 30.0, 60.0, 40.0, 150.0, 20.0, 30.0, 20.0, 40.0, 20.0, 30.0, 80.0, 10.0, 60.0, 30.0, 70.0, 60.0, 0.0, 20.0, 30.0, 170.0, 20.0, 30.0, 20.0, -40.0, 20.0, 20.0, 80.0, 330.0, 100.0, 10.0, 40.0, 25.0, 70.0, 360.0, 0.0, 90.0, 90.0, 160.0, 40.0, 20.0, 40.0, 40.0, 140.0, 20.0, 330.0, 50.0, 50.0, 170.0, 30.0, 50.0, 150.0, 20.0, 30.0, 90.0, 40.0, 20.0, 0.0, 50.0, 60.0, 20.0, 20.0, 30.0, 60.0, 60.0, 10.0, 0.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 160.0, 10.0, 110.0, 0.0, 110.0, 160.0, 90.0, 110.0, 10.0, 470.0, 210.0, 5.0, 0.0, 90.0, 80.0, 410.0, 30.0, 80.0, 20.0, 0.0, 20.0, 360.0, 45.0, 60.0, -40.0, 30.0, 20.0, 65.0, 20.0, -20.0, 400.0, -40.0, 130.0, 210.0, 40.0, 80.0, 40.0, 15.0, 180.0, 20.0, 60.0, 480.0, 160.0, 290.0, 10.0, 50.0, 50.0, 500.0, 45.0, 160.0, 60.0, 160.0, -10.0, 40.0, 10.0, 45.0, 120.0, 80.0, 330.0, 50.0, 150.0, 60.0, 180.0, 20.0, 40.0, 60.0, 90.0, 40.0, 80.0, 30.0, 50.0, 50.0, 60.0, 0.0, 280.0, 10.0, -10.0, 490.0, 70.0, 40.0, 60.0, 50.0, 30.0, -40.0, 90.0, 65.0, 40.0, 80.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 120.0, 20.0, 180.0, 30.0, 35.0, 10.0, 20.0, 60.0, 90.0, 30.0, 80.0, 40.0, 220.0, 40.0, 50.0, 70.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5606669782224458, "mean_inference_ms": 1.4164804772034318, "mean_action_processing_ms": 0.44150355440766575, "mean_env_wait_ms": 1.2683786809573354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013832569122314453, "StateBufferConnector_ms": 0.010494470596313477, "ViewRequirementAgentConnector_ms": 0.38751840591430664}, "num_episodes": 18, "episode_return_max": 1680.0, "episode_return_min": 180.0, "episode_return_mean": 642.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.38502956589177, "num_env_steps_trained_throughput_per_sec": 21.38502956589177, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 186815.309, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186815.263, "sample_time_ms": 2443.506, "learn_time_ms": 184352.441, "learn_throughput": 21.698, "synch_weights_time_ms": 11.919}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 42, "trial_id": "90816_00000", "date": "2024-06-10_02-24-44", "timestamp": 1718000684, "time_this_iter_s": 187.053879737854, "time_total_s": 7962.617475509644, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00c5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7962.617475509644, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.025378787878783, "ram_util_percent": 79.28598484848484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7836386053262556, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6623934621882, "policy_loss": -0.009125704466661833, "vf_loss": 6.670069997125286, "vf_explained_var": 0.0011476497934522212, "kl": 0.0072458064468548435, "entropy": 0.6992494976177764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 399075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "env_runners": {"episode_reward_max": 1680.0, "episode_reward_min": 120.0, "episode_reward_mean": 673.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -95.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 67.355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [790.0, 535.0, 530.0, 310.0, 1250.0, 340.0, 310.0, 530.0, 560.0, 320.0, 595.0, 890.0, 190.0, 215.0, 540.0, 240.0, 630.0, 750.0, 660.0, 660.0, 1020.0, 785.0, 420.0, 630.0, 350.0, 750.0, 400.0, 540.0, 450.0, 290.0, 610.0, 555.0, 275.0, 950.0, 415.0, 270.0, 630.0, 835.0, 610.0, 280.0, 420.0, 540.0, 540.0, 640.0, 860.0, 225.0, 835.0, 1010.0, 1100.0, 665.0, 985.0, 1065.0, 810.0, 1680.0, 450.0, 180.0, 545.0, 470.0, 860.0, 650.0, 340.0, 380.0, 1055.0, 640.0, 970.0, 360.0, 360.0, 1275.0, 1090.0, 540.0, 1255.0, 1485.0, 875.0, 640.0, 1050.0, 515.0, 535.0, 780.0, 630.0, 935.0, 880.0, 700.0, 610.0, 855.0, 780.0, 900.0, 805.0, 530.0, 580.0, 1200.0, 370.0, 1170.0, 670.0, 590.0, 840.0, 650.0, 120.0, 785.0, 910.0, 1260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [220.0, 200.0, 0.0, 40.0, 0.0, 150.0, 0.0, 40.0, 70.0, 70.0, 65.0, 20.0, 190.0, 20.0, -50.0, 30.0, 30.0, 30.0, 190.0, 10.0, 0.0, 70.0, 40.0, 40.0, 40.0, 40.0, 30.0, 90.0, 100.0, 80.0, 40.0, 60.0, 0.0, 10.0, 70.0, 50.0, 30.0, 40.0, 0.0, 10.0, 50.0, 20.0, 240.0, 310.0, 90.0, 50.0, 110.0, 70.0, 250.0, 60.0, 10.0, 0.0, 160.0, 50.0, 10.0, 30.0, 40.0, 10.0, 20.0, 10.0, 20.0, 30.0, 40.0, 40.0, 60.0, 40.0, 20.0, 10.0, 20.0, 30.0, 60.0, 60.0, 140.0, 10.0, 70.0, 20.0, 10.0, 40.0, 90.0, 30.0, 30.0, 40.0, 90.0, -30.0, 40.0, 20.0, 70.0, 150.0, 90.0, 60.0, 30.0, 20.0, 70.0, 40.0, 30.0, 30.0, 20.0, 40.0, 20.0, 20.0, -20.0, 0.0, 50.0, 10.0, 40.0, 20.0, 50.0, 370.0, 35.0, 40.0, 30.0, 0.0, -30.0, 100.0, 140.0, 30.0, 20.0, 40.0, 190.0, 370.0, 30.0, 50.0, 40.0, 0.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 50.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, -5.0, 0.0, 90.0, 30.0, 70.0, 90.0, 30.0, 40.0, 10.0, 120.0, 60.0, 70.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 20.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 90.0, 190.0, 0.0, 70.0, 60.0, 70.0, 20.0, 90.0, 160.0, 40.0, 60.0, 70.0, 30.0, 170.0, 90.0, 20.0, 130.0, 50.0, 180.0, 0.0, -20.0, -40.0, 260.0, 0.0, 20.0, 80.0, 20.0, 30.0, 260.0, 10.0, 0.0, 10.0, 70.0, 190.0, 20.0, 50.0, 30.0, 30.0, 20.0, 100.0, 30.0, 50.0, 180.0, 70.0, 250.0, 260.0, -25.0, 70.0, 0.0, 20.0, 60.0, 20.0, 30.0, 380.0, 200.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 30.0, 120.0, 10.0, 30.0, 80.0, 40.0, -30.0, 60.0, 90.0, 40.0, 10.0, 0.0, 10.0, 20.0, 390.0, 60.0, 50.0, 20.0, 30.0, 100.0, 0.0, 10.0, 30.0, 20.0, 30.0, 10.0, 220.0, 30.0, 70.0, 170.0, 30.0, 60.0, 50.0, 20.0, 90.0, 40.0, 40.0, 110.0, 10.0, 10.0, -50.0, -10.0, -20.0, 0.0, 270.0, 190.0, -50.0, 60.0, 0.0, 140.0, 50.0, 40.0, 70.0, 30.0, 10.0, 20.0, 80.0, 20.0, 80.0, 0.0, 30.0, 90.0, 100.0, 0.0, 30.0, 30.0, 20.0, 0.0, 110.0, 50.0, 0.0, 30.0, 10.0, 0.0, 40.0, 30.0, 20.0, 20.0, 150.0, 20.0, 40.0, 90.0, 180.0, 40.0, 20.0, 10.0, 20.0, 40.0, 320.0, 20.0, 45.0, 40.0, 50.0, -80.0, 90.0, 10.0, 10.0, 70.0, 0.0, 160.0, -25.0, 30.0, -30.0, 40.0, 10.0, 60.0, 130.0, 0.0, 10.0, 150.0, 20.0, 350.0, 90.0, 100.0, 40.0, 10.0, 30.0, 145.0, 10.0, 0.0, 20.0, 20.0, 20.0, 90.0, 70.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 100.0, 40.0, 30.0, 10.0, 190.0, 110.0, 210.0, 40.0, 10.0, 20.0, 20.0, 40.0, -20.0, 10.0, 30.0, 15.0, 20.0, 140.0, 50.0, 100.0, -10.0, 80.0, 220.0, 190.0, 70.0, 100.0, 40.0, 120.0, 100.0, 0.0, -60.0, 130.0, 80.0, 30.0, 10.0, 60.0, 30.0, 20.0, 0.0, 70.0, 30.0, 10.0, 0.0, 50.0, -80.0, 20.0, 180.0, 20.0, 40.0, 190.0, 10.0, 0.0, 20.0, 20.0, 40.0, 200.0, 110.0, 70.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 0.0, 10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 10.0, 410.0, 0.0, 40.0, 10.0, 20.0, 0.0, 110.0, 170.0, 30.0, 160.0, 50.0, 50.0, 180.0, 20.0, 150.0, 250.0, 35.0, 90.0, 50.0, 5.0, 60.0, 20.0, 20.0, 25.0, 60.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 95.0, 10.0, 40.0, 300.0, 40.0, 150.0, 20.0, 50.0, 90.0, 40.0, 100.0, 50.0, 30.0, 100.0, 110.0, 90.0, 200.0, 50.0, 240.0, 40.0, 100.0, 50.0, 80.0, 90.0, 60.0, 50.0, 190.0, 90.0, 50.0, 340.0, 50.0, 30.0, 10.0, 40.0, 0.0, 20.0, 100.0, 260.0, 60.0, 95.0, 420.0, 170.0, 45.0, 210.0, -50.0, 30.0, 50.0, 60.0, -30.0, 80.0, 30.0, 220.0, 460.0, 40.0, 20.0, 160.0, 30.0, -30.0, 35.0, 100.0, 220.0, 50.0, 30.0, 60.0, 80.0, 20.0, 150.0, 160.0, 30.0, 10.0, 70.0, 90.0, 30.0, 350.0, 50.0, 170.0, 650.0, 70.0, 170.0, 30.0, 80.0, 50.0, 100.0, 30.0, 40.0, 35.0, 60.0, 0.0, 25.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 150.0, -10.0, 370.0, -95.0, 30.0, -80.0, 10.0, 110.0, 10.0, 80.0, 120.0, 0.0, 110.0, 40.0, 70.0, 300.0, 40.0, 20.0, 70.0, 50.0, 80.0, 0.0, 270.0, 0.0, 30.0, 60.0, 110.0, 30.0, 40.0, 40.0, 90.0, 30.0, 60.0, 40.0, 150.0, 20.0, 30.0, 20.0, 40.0, 20.0, 30.0, 80.0, 10.0, 60.0, 30.0, 70.0, 60.0, 0.0, 20.0, 30.0, 170.0, 20.0, 30.0, 20.0, -40.0, 20.0, 20.0, 80.0, 330.0, 100.0, 10.0, 40.0, 25.0, 70.0, 360.0, 0.0, 90.0, 90.0, 160.0, 40.0, 20.0, 40.0, 40.0, 140.0, 20.0, 330.0, 50.0, 50.0, 170.0, 30.0, 50.0, 150.0, 20.0, 30.0, 90.0, 40.0, 20.0, 0.0, 50.0, 60.0, 20.0, 20.0, 30.0, 60.0, 60.0, 10.0, 0.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 160.0, 10.0, 110.0, 0.0, 110.0, 160.0, 90.0, 110.0, 10.0, 470.0, 210.0, 5.0, 0.0, 90.0, 80.0, 410.0, 30.0, 80.0, 20.0, 0.0, 20.0, 360.0, 45.0, 60.0, -40.0, 30.0, 20.0, 65.0, 20.0, -20.0, 400.0, -40.0, 130.0, 210.0, 40.0, 80.0, 40.0, 15.0, 180.0, 20.0, 60.0, 480.0, 160.0, 290.0, 10.0, 50.0, 50.0, 500.0, 45.0, 160.0, 60.0, 160.0, -10.0, 40.0, 10.0, 45.0, 120.0, 80.0, 330.0, 50.0, 150.0, 60.0, 180.0, 20.0, 40.0, 60.0, 90.0, 40.0, 80.0, 30.0, 50.0, 50.0, 60.0, 0.0, 280.0, 10.0, -10.0, 490.0, 70.0, 40.0, 60.0, 50.0, 30.0, -40.0, 90.0, 65.0, 40.0, 80.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 120.0, 20.0, 180.0, 30.0, 35.0, 10.0, 20.0, 60.0, 90.0, 30.0, 80.0, 40.0, 220.0, 40.0, 50.0, 70.0, 100.0, 50.0, 20.0, 0.0, 40.0, 90.0, 80.0, 70.0, 200.0, 10.0, 70.0, 170.0, 220.0, 80.0, -20.0, -5.0, 130.0, 30.0, 170.0, 110.0, 50.0, 170.0, 40.0, 80.0, 100.0, 20.0, 90.0, 20.0, 260.0, 0.0, 100.0, 270.0, 0.0, 40.0, 0.0, 40.0, 40.0, 40.0, 170.0, 30.0, 70.0, 40.0, 160.0, 10.0, 10.0, 30.0, 30.0, 120.0, 180.0, -10.0, 40.0, 80.0, 80.0, 340.0, 30.0, 35.0, -50.0, 180.0, 40.0, 50.0, 70.0, 50.0, 120.0, 10.0, 290.0, 30.0, 10.0, 170.0, 30.0, 30.0, 40.0, 310.0, 90.0, 160.0, 90.0, 5.0, 5.0, 20.0, 110.0, 90.0, 20.0, 100.0, 45.0, 10.0, 10.0, 60.0, 0.0, 370.0, 40.0, 60.0, 110.0, 20.0, 130.0, 30.0, 30.0, 20.0, 30.0, 60.0, 30.0, 20.0, 160.0, 100.0, 40.0, 10.0, 110.0, 70.0, 10.0, -50.0, 60.0, 130.0, 100.0, 10.0, 80.0, 180.0, 110.0, 50.0, -10.0, 40.0, 360.0, 190.0, 190.0, 50.0, 20.0, 40.0, 10.0, 60.0, 30.0, 70.0, 10.0, 10.0, 70.0, 50.0, 10.0, 200.0, 70.0, 20.0, 90.0, 220.0, 70.0, 350.0, 90.0, 90.0, 0.0, 80.0, 10.0, 130.0, 80.0, 60.0, 120.0, 80.0, 20.0, 255.0, 30.0, 120.0, 20.0, -5.0, 30.0, 20.0, 30.0, 50.0, 40.0, 180.0, 40.0, 30.0, 40.0, 420.0, 70.0, 20.0, 30.0, 50.0, -40.0, 10.0, 30.0, 30.0, 190.0, 90.0, 0.0, 0.0, 80.0, 0.0, 220.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 40.0, 5.0, 490.0, 90.0, 70.0, 10.0, -30.0, 30.0, 170.0, 160.0, 60.0, 40.0, 50.0, 70.0, 400.0, 0.0, 10.0, -50.0, 180.0, 180.0, 50.0, 210.0, 110.0, 120.0, 70.0, 0.0, 50.0, 290.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5589241975612647, "mean_inference_ms": 1.415933129593065, "mean_action_processing_ms": 0.4399709867124884, "mean_env_wait_ms": 1.2673310838796998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013677358627319336, "StateBufferConnector_ms": 0.010753870010375977, "ViewRequirementAgentConnector_ms": 0.39742255210876465}, "num_episodes": 22, "episode_return_max": 1680.0, "episode_return_min": 120.0, "episode_return_mean": 673.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.341953677202188, "num_env_steps_trained_throughput_per_sec": 21.341953677202188, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 1720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1720000, "timers": {"training_iteration_time_ms": 186939.587, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186939.541, "sample_time_ms": 2487.573, "learn_time_ms": 184432.923, "learn_throughput": 21.688, "synch_weights_time_ms": 11.398}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "done": false, "training_iteration": 43, "trial_id": "90816_00000", "date": "2024-06-10_02-27-51", "timestamp": 1718000871, "time_this_iter_s": 187.43285393714905, "time_total_s": 8150.050329446793, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f6940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8150.050329446793, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.6011320754717, "ram_util_percent": 77.85018867924529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0337835072645873, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.267767973829763, "policy_loss": -0.010153121456674461, "vf_loss": 6.276378415618588, "vf_explained_var": 0.0006574033294368983, "kl": 0.007713344690310333, "entropy": 0.7043473162018834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 408465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 1680.0, "episode_reward_min": 120.0, "episode_reward_mean": 731.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 73.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [630.0, 350.0, 750.0, 400.0, 540.0, 450.0, 290.0, 610.0, 555.0, 275.0, 950.0, 415.0, 270.0, 630.0, 835.0, 610.0, 280.0, 420.0, 540.0, 540.0, 640.0, 860.0, 225.0, 835.0, 1010.0, 1100.0, 665.0, 985.0, 1065.0, 810.0, 1680.0, 450.0, 180.0, 545.0, 470.0, 860.0, 650.0, 340.0, 380.0, 1055.0, 640.0, 970.0, 360.0, 360.0, 1275.0, 1090.0, 540.0, 1255.0, 1485.0, 875.0, 640.0, 1050.0, 515.0, 535.0, 780.0, 630.0, 935.0, 880.0, 700.0, 610.0, 855.0, 780.0, 900.0, 805.0, 530.0, 580.0, 1200.0, 370.0, 1170.0, 670.0, 590.0, 840.0, 650.0, 120.0, 785.0, 910.0, 1260.0, 1620.0, 265.0, 610.0, 940.0, 190.0, 540.0, 1440.0, 420.0, 550.0, 1435.0, 320.0, 1320.0, 1015.0, 410.0, 605.0, 1250.0, 1390.0, 610.0, 575.0, 820.0, 600.0, 1045.0, 895.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, -30.0, 60.0, 90.0, 40.0, 10.0, 0.0, 10.0, 20.0, 390.0, 60.0, 50.0, 20.0, 30.0, 100.0, 0.0, 10.0, 30.0, 20.0, 30.0, 10.0, 220.0, 30.0, 70.0, 170.0, 30.0, 60.0, 50.0, 20.0, 90.0, 40.0, 40.0, 110.0, 10.0, 10.0, -50.0, -10.0, -20.0, 0.0, 270.0, 190.0, -50.0, 60.0, 0.0, 140.0, 50.0, 40.0, 70.0, 30.0, 10.0, 20.0, 80.0, 20.0, 80.0, 0.0, 30.0, 90.0, 100.0, 0.0, 30.0, 30.0, 20.0, 0.0, 110.0, 50.0, 0.0, 30.0, 10.0, 0.0, 40.0, 30.0, 20.0, 20.0, 150.0, 20.0, 40.0, 90.0, 180.0, 40.0, 20.0, 10.0, 20.0, 40.0, 320.0, 20.0, 45.0, 40.0, 50.0, -80.0, 90.0, 10.0, 10.0, 70.0, 0.0, 160.0, -25.0, 30.0, -30.0, 40.0, 10.0, 60.0, 130.0, 0.0, 10.0, 150.0, 20.0, 350.0, 90.0, 100.0, 40.0, 10.0, 30.0, 145.0, 10.0, 0.0, 20.0, 20.0, 20.0, 90.0, 70.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 100.0, 40.0, 30.0, 10.0, 190.0, 110.0, 210.0, 40.0, 10.0, 20.0, 20.0, 40.0, -20.0, 10.0, 30.0, 15.0, 20.0, 140.0, 50.0, 100.0, -10.0, 80.0, 220.0, 190.0, 70.0, 100.0, 40.0, 120.0, 100.0, 0.0, -60.0, 130.0, 80.0, 30.0, 10.0, 60.0, 30.0, 20.0, 0.0, 70.0, 30.0, 10.0, 0.0, 50.0, -80.0, 20.0, 180.0, 20.0, 40.0, 190.0, 10.0, 0.0, 20.0, 20.0, 40.0, 200.0, 110.0, 70.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 0.0, 10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 10.0, 410.0, 0.0, 40.0, 10.0, 20.0, 0.0, 110.0, 170.0, 30.0, 160.0, 50.0, 50.0, 180.0, 20.0, 150.0, 250.0, 35.0, 90.0, 50.0, 5.0, 60.0, 20.0, 20.0, 25.0, 60.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 95.0, 10.0, 40.0, 300.0, 40.0, 150.0, 20.0, 50.0, 90.0, 40.0, 100.0, 50.0, 30.0, 100.0, 110.0, 90.0, 200.0, 50.0, 240.0, 40.0, 100.0, 50.0, 80.0, 90.0, 60.0, 50.0, 190.0, 90.0, 50.0, 340.0, 50.0, 30.0, 10.0, 40.0, 0.0, 20.0, 100.0, 260.0, 60.0, 95.0, 420.0, 170.0, 45.0, 210.0, -50.0, 30.0, 50.0, 60.0, -30.0, 80.0, 30.0, 220.0, 460.0, 40.0, 20.0, 160.0, 30.0, -30.0, 35.0, 100.0, 220.0, 50.0, 30.0, 60.0, 80.0, 20.0, 150.0, 160.0, 30.0, 10.0, 70.0, 90.0, 30.0, 350.0, 50.0, 170.0, 650.0, 70.0, 170.0, 30.0, 80.0, 50.0, 100.0, 30.0, 40.0, 35.0, 60.0, 0.0, 25.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 150.0, -10.0, 370.0, -95.0, 30.0, -80.0, 10.0, 110.0, 10.0, 80.0, 120.0, 0.0, 110.0, 40.0, 70.0, 300.0, 40.0, 20.0, 70.0, 50.0, 80.0, 0.0, 270.0, 0.0, 30.0, 60.0, 110.0, 30.0, 40.0, 40.0, 90.0, 30.0, 60.0, 40.0, 150.0, 20.0, 30.0, 20.0, 40.0, 20.0, 30.0, 80.0, 10.0, 60.0, 30.0, 70.0, 60.0, 0.0, 20.0, 30.0, 170.0, 20.0, 30.0, 20.0, -40.0, 20.0, 20.0, 80.0, 330.0, 100.0, 10.0, 40.0, 25.0, 70.0, 360.0, 0.0, 90.0, 90.0, 160.0, 40.0, 20.0, 40.0, 40.0, 140.0, 20.0, 330.0, 50.0, 50.0, 170.0, 30.0, 50.0, 150.0, 20.0, 30.0, 90.0, 40.0, 20.0, 0.0, 50.0, 60.0, 20.0, 20.0, 30.0, 60.0, 60.0, 10.0, 0.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 160.0, 10.0, 110.0, 0.0, 110.0, 160.0, 90.0, 110.0, 10.0, 470.0, 210.0, 5.0, 0.0, 90.0, 80.0, 410.0, 30.0, 80.0, 20.0, 0.0, 20.0, 360.0, 45.0, 60.0, -40.0, 30.0, 20.0, 65.0, 20.0, -20.0, 400.0, -40.0, 130.0, 210.0, 40.0, 80.0, 40.0, 15.0, 180.0, 20.0, 60.0, 480.0, 160.0, 290.0, 10.0, 50.0, 50.0, 500.0, 45.0, 160.0, 60.0, 160.0, -10.0, 40.0, 10.0, 45.0, 120.0, 80.0, 330.0, 50.0, 150.0, 60.0, 180.0, 20.0, 40.0, 60.0, 90.0, 40.0, 80.0, 30.0, 50.0, 50.0, 60.0, 0.0, 280.0, 10.0, -10.0, 490.0, 70.0, 40.0, 60.0, 50.0, 30.0, -40.0, 90.0, 65.0, 40.0, 80.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 120.0, 20.0, 180.0, 30.0, 35.0, 10.0, 20.0, 60.0, 90.0, 30.0, 80.0, 40.0, 220.0, 40.0, 50.0, 70.0, 100.0, 50.0, 20.0, 0.0, 40.0, 90.0, 80.0, 70.0, 200.0, 10.0, 70.0, 170.0, 220.0, 80.0, -20.0, -5.0, 130.0, 30.0, 170.0, 110.0, 50.0, 170.0, 40.0, 80.0, 100.0, 20.0, 90.0, 20.0, 260.0, 0.0, 100.0, 270.0, 0.0, 40.0, 0.0, 40.0, 40.0, 40.0, 170.0, 30.0, 70.0, 40.0, 160.0, 10.0, 10.0, 30.0, 30.0, 120.0, 180.0, -10.0, 40.0, 80.0, 80.0, 340.0, 30.0, 35.0, -50.0, 180.0, 40.0, 50.0, 70.0, 50.0, 120.0, 10.0, 290.0, 30.0, 10.0, 170.0, 30.0, 30.0, 40.0, 310.0, 90.0, 160.0, 90.0, 5.0, 5.0, 20.0, 110.0, 90.0, 20.0, 100.0, 45.0, 10.0, 10.0, 60.0, 0.0, 370.0, 40.0, 60.0, 110.0, 20.0, 130.0, 30.0, 30.0, 20.0, 30.0, 60.0, 30.0, 20.0, 160.0, 100.0, 40.0, 10.0, 110.0, 70.0, 10.0, -50.0, 60.0, 130.0, 100.0, 10.0, 80.0, 180.0, 110.0, 50.0, -10.0, 40.0, 360.0, 190.0, 190.0, 50.0, 20.0, 40.0, 10.0, 60.0, 30.0, 70.0, 10.0, 10.0, 70.0, 50.0, 10.0, 200.0, 70.0, 20.0, 90.0, 220.0, 70.0, 350.0, 90.0, 90.0, 0.0, 80.0, 10.0, 130.0, 80.0, 60.0, 120.0, 80.0, 20.0, 255.0, 30.0, 120.0, 20.0, -5.0, 30.0, 20.0, 30.0, 50.0, 40.0, 180.0, 40.0, 30.0, 40.0, 420.0, 70.0, 20.0, 30.0, 50.0, -40.0, 10.0, 30.0, 30.0, 190.0, 90.0, 0.0, 0.0, 80.0, 0.0, 220.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 40.0, 5.0, 490.0, 90.0, 70.0, 10.0, -30.0, 30.0, 170.0, 160.0, 60.0, 40.0, 50.0, 70.0, 400.0, 0.0, 10.0, -50.0, 180.0, 180.0, 50.0, 210.0, 110.0, 120.0, 70.0, 0.0, 50.0, 290.0, 100.0, 160.0, 80.0, 320.0, 60.0, 10.0, 320.0, 160.0, 40.0, 370.0, 20.0, 20.0, 30.0, 20.0, 120.0, 0.0, 15.0, 10.0, 30.0, 0.0, 60.0, 40.0, -5.0, 60.0, 120.0, -5.0, 20.0, 120.0, 50.0, 150.0, 200.0, 90.0, 190.0, 70.0, 20.0, 20.0, 110.0, 90.0, 50.0, 100.0, 40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 170.0, 40.0, 160.0, 30.0, 40.0, 60.0, -40.0, 20.0, 70.0, 210.0, 50.0, 750.0, 30.0, 110.0, 50.0, 30.0, 90.0, 50.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 220.0, 20.0, 40.0, 60.0, 10.0, 0.0, 280.0, 70.0, 40.0, 60.0, 70.0, -50.0, 40.0, 30.0, 160.0, 20.0, 0.0, 90.0, 90.0, 100.0, 370.0, 360.0, 55.0, 190.0, 10.0, 0.0, 80.0, 0.0, 70.0, 30.0, -40.0, 20.0, 70.0, 80.0, -10.0, 340.0, 80.0, 40.0, 110.0, 30.0, 220.0, 170.0, 60.0, 280.0, 110.0, 40.0, 110.0, 160.0, 100.0, 0.0, 30.0, 20.0, 280.0, 165.0, 250.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, -30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 230.0, 150.0, 40.0, 35.0, 40.0, 160.0, 25.0, 50.0, 500.0, 90.0, 220.0, 70.0, 40.0, 25.0, 70.0, 60.0, 600.0, 90.0, 30.0, 60.0, 20.0, 50.0, 20.0, 310.0, 150.0, 20.0, 60.0, 100.0, 70.0, 80.0, 40.0, 60.0, 10.0, 160.0, 10.0, 40.0, -250.0, 100.0, 180.0, 40.0, 50.0, 30.0, 25.0, 360.0, 0.0, 10.0, 20.0, 30.0, 20.0, 120.0, 60.0, 10.0, 450.0, 40.0, 60.0, 0.0, 30.0, 20.0, 360.0, 20.0, 50.0, 100.0, 30.0, 10.0, -20.0, 90.0, 310.0, 120.0, -20.0, -30.0, 190.0, -50.0, 25.0, 350.0, 60.0, 150.0, 10.0, 100.0, 10.0, 270.0, 60.0, 40.0, 40.0, 195.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5565151655613696, "mean_inference_ms": 1.4147856279239162, "mean_action_processing_ms": 0.4384660118181191, "mean_env_wait_ms": 1.2662212157841735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01379084587097168, "StateBufferConnector_ms": 0.010143280029296875, "ViewRequirementAgentConnector_ms": 0.40726494789123535}, "num_episodes": 23, "episode_return_max": 1680.0, "episode_return_min": 120.0, "episode_return_mean": 731.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.59156847249672, "num_env_steps_trained_throughput_per_sec": 21.59156847249672, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 186889.826, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186889.78, "sample_time_ms": 2454.816, "learn_time_ms": 184415.775, "learn_throughput": 21.69, "synch_weights_time_ms": 11.542}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 44, "trial_id": "90816_00000", "date": "2024-06-10_02-30-56", "timestamp": 1718001056, "time_this_iter_s": 185.26687002182007, "time_total_s": 8335.317199468613, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00cc790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8335.317199468613, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 16.906870229007634, "ram_util_percent": 77.062213740458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1326304334865465, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.821415334209974, "policy_loss": -0.01001349472065374, "vf_loss": 6.829922409941213, "vf_explained_var": 0.0011218827689925448, "kl": 0.007532095366601276, "entropy": 0.688824467232433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 417855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 1680.0, "episode_reward_min": 120.0, "episode_reward_mean": 793.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 79.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [540.0, 540.0, 640.0, 860.0, 225.0, 835.0, 1010.0, 1100.0, 665.0, 985.0, 1065.0, 810.0, 1680.0, 450.0, 180.0, 545.0, 470.0, 860.0, 650.0, 340.0, 380.0, 1055.0, 640.0, 970.0, 360.0, 360.0, 1275.0, 1090.0, 540.0, 1255.0, 1485.0, 875.0, 640.0, 1050.0, 515.0, 535.0, 780.0, 630.0, 935.0, 880.0, 700.0, 610.0, 855.0, 780.0, 900.0, 805.0, 530.0, 580.0, 1200.0, 370.0, 1170.0, 670.0, 590.0, 840.0, 650.0, 120.0, 785.0, 910.0, 1260.0, 1620.0, 265.0, 610.0, 940.0, 190.0, 540.0, 1440.0, 420.0, 550.0, 1435.0, 320.0, 1320.0, 1015.0, 410.0, 605.0, 1250.0, 1390.0, 610.0, 575.0, 820.0, 600.0, 1045.0, 895.0, 810.0, 580.0, 1615.0, 1410.0, 920.0, 275.0, 935.0, 1100.0, 1040.0, 1160.0, 280.0, 120.0, 950.0, 900.0, 925.0, 1100.0, 675.0, 660.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 200.0, 110.0, 70.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 0.0, 10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 10.0, 410.0, 0.0, 40.0, 10.0, 20.0, 0.0, 110.0, 170.0, 30.0, 160.0, 50.0, 50.0, 180.0, 20.0, 150.0, 250.0, 35.0, 90.0, 50.0, 5.0, 60.0, 20.0, 20.0, 25.0, 60.0, 20.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 95.0, 10.0, 40.0, 300.0, 40.0, 150.0, 20.0, 50.0, 90.0, 40.0, 100.0, 50.0, 30.0, 100.0, 110.0, 90.0, 200.0, 50.0, 240.0, 40.0, 100.0, 50.0, 80.0, 90.0, 60.0, 50.0, 190.0, 90.0, 50.0, 340.0, 50.0, 30.0, 10.0, 40.0, 0.0, 20.0, 100.0, 260.0, 60.0, 95.0, 420.0, 170.0, 45.0, 210.0, -50.0, 30.0, 50.0, 60.0, -30.0, 80.0, 30.0, 220.0, 460.0, 40.0, 20.0, 160.0, 30.0, -30.0, 35.0, 100.0, 220.0, 50.0, 30.0, 60.0, 80.0, 20.0, 150.0, 160.0, 30.0, 10.0, 70.0, 90.0, 30.0, 350.0, 50.0, 170.0, 650.0, 70.0, 170.0, 30.0, 80.0, 50.0, 100.0, 30.0, 40.0, 35.0, 60.0, 0.0, 25.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 150.0, -10.0, 370.0, -95.0, 30.0, -80.0, 10.0, 110.0, 10.0, 80.0, 120.0, 0.0, 110.0, 40.0, 70.0, 300.0, 40.0, 20.0, 70.0, 50.0, 80.0, 0.0, 270.0, 0.0, 30.0, 60.0, 110.0, 30.0, 40.0, 40.0, 90.0, 30.0, 60.0, 40.0, 150.0, 20.0, 30.0, 20.0, 40.0, 20.0, 30.0, 80.0, 10.0, 60.0, 30.0, 70.0, 60.0, 0.0, 20.0, 30.0, 170.0, 20.0, 30.0, 20.0, -40.0, 20.0, 20.0, 80.0, 330.0, 100.0, 10.0, 40.0, 25.0, 70.0, 360.0, 0.0, 90.0, 90.0, 160.0, 40.0, 20.0, 40.0, 40.0, 140.0, 20.0, 330.0, 50.0, 50.0, 170.0, 30.0, 50.0, 150.0, 20.0, 30.0, 90.0, 40.0, 20.0, 0.0, 50.0, 60.0, 20.0, 20.0, 30.0, 60.0, 60.0, 10.0, 0.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 160.0, 10.0, 110.0, 0.0, 110.0, 160.0, 90.0, 110.0, 10.0, 470.0, 210.0, 5.0, 0.0, 90.0, 80.0, 410.0, 30.0, 80.0, 20.0, 0.0, 20.0, 360.0, 45.0, 60.0, -40.0, 30.0, 20.0, 65.0, 20.0, -20.0, 400.0, -40.0, 130.0, 210.0, 40.0, 80.0, 40.0, 15.0, 180.0, 20.0, 60.0, 480.0, 160.0, 290.0, 10.0, 50.0, 50.0, 500.0, 45.0, 160.0, 60.0, 160.0, -10.0, 40.0, 10.0, 45.0, 120.0, 80.0, 330.0, 50.0, 150.0, 60.0, 180.0, 20.0, 40.0, 60.0, 90.0, 40.0, 80.0, 30.0, 50.0, 50.0, 60.0, 0.0, 280.0, 10.0, -10.0, 490.0, 70.0, 40.0, 60.0, 50.0, 30.0, -40.0, 90.0, 65.0, 40.0, 80.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 120.0, 20.0, 180.0, 30.0, 35.0, 10.0, 20.0, 60.0, 90.0, 30.0, 80.0, 40.0, 220.0, 40.0, 50.0, 70.0, 100.0, 50.0, 20.0, 0.0, 40.0, 90.0, 80.0, 70.0, 200.0, 10.0, 70.0, 170.0, 220.0, 80.0, -20.0, -5.0, 130.0, 30.0, 170.0, 110.0, 50.0, 170.0, 40.0, 80.0, 100.0, 20.0, 90.0, 20.0, 260.0, 0.0, 100.0, 270.0, 0.0, 40.0, 0.0, 40.0, 40.0, 40.0, 170.0, 30.0, 70.0, 40.0, 160.0, 10.0, 10.0, 30.0, 30.0, 120.0, 180.0, -10.0, 40.0, 80.0, 80.0, 340.0, 30.0, 35.0, -50.0, 180.0, 40.0, 50.0, 70.0, 50.0, 120.0, 10.0, 290.0, 30.0, 10.0, 170.0, 30.0, 30.0, 40.0, 310.0, 90.0, 160.0, 90.0, 5.0, 5.0, 20.0, 110.0, 90.0, 20.0, 100.0, 45.0, 10.0, 10.0, 60.0, 0.0, 370.0, 40.0, 60.0, 110.0, 20.0, 130.0, 30.0, 30.0, 20.0, 30.0, 60.0, 30.0, 20.0, 160.0, 100.0, 40.0, 10.0, 110.0, 70.0, 10.0, -50.0, 60.0, 130.0, 100.0, 10.0, 80.0, 180.0, 110.0, 50.0, -10.0, 40.0, 360.0, 190.0, 190.0, 50.0, 20.0, 40.0, 10.0, 60.0, 30.0, 70.0, 10.0, 10.0, 70.0, 50.0, 10.0, 200.0, 70.0, 20.0, 90.0, 220.0, 70.0, 350.0, 90.0, 90.0, 0.0, 80.0, 10.0, 130.0, 80.0, 60.0, 120.0, 80.0, 20.0, 255.0, 30.0, 120.0, 20.0, -5.0, 30.0, 20.0, 30.0, 50.0, 40.0, 180.0, 40.0, 30.0, 40.0, 420.0, 70.0, 20.0, 30.0, 50.0, -40.0, 10.0, 30.0, 30.0, 190.0, 90.0, 0.0, 0.0, 80.0, 0.0, 220.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 40.0, 5.0, 490.0, 90.0, 70.0, 10.0, -30.0, 30.0, 170.0, 160.0, 60.0, 40.0, 50.0, 70.0, 400.0, 0.0, 10.0, -50.0, 180.0, 180.0, 50.0, 210.0, 110.0, 120.0, 70.0, 0.0, 50.0, 290.0, 100.0, 160.0, 80.0, 320.0, 60.0, 10.0, 320.0, 160.0, 40.0, 370.0, 20.0, 20.0, 30.0, 20.0, 120.0, 0.0, 15.0, 10.0, 30.0, 0.0, 60.0, 40.0, -5.0, 60.0, 120.0, -5.0, 20.0, 120.0, 50.0, 150.0, 200.0, 90.0, 190.0, 70.0, 20.0, 20.0, 110.0, 90.0, 50.0, 100.0, 40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 170.0, 40.0, 160.0, 30.0, 40.0, 60.0, -40.0, 20.0, 70.0, 210.0, 50.0, 750.0, 30.0, 110.0, 50.0, 30.0, 90.0, 50.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 220.0, 20.0, 40.0, 60.0, 10.0, 0.0, 280.0, 70.0, 40.0, 60.0, 70.0, -50.0, 40.0, 30.0, 160.0, 20.0, 0.0, 90.0, 90.0, 100.0, 370.0, 360.0, 55.0, 190.0, 10.0, 0.0, 80.0, 0.0, 70.0, 30.0, -40.0, 20.0, 70.0, 80.0, -10.0, 340.0, 80.0, 40.0, 110.0, 30.0, 220.0, 170.0, 60.0, 280.0, 110.0, 40.0, 110.0, 160.0, 100.0, 0.0, 30.0, 20.0, 280.0, 165.0, 250.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, -30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 230.0, 150.0, 40.0, 35.0, 40.0, 160.0, 25.0, 50.0, 500.0, 90.0, 220.0, 70.0, 40.0, 25.0, 70.0, 60.0, 600.0, 90.0, 30.0, 60.0, 20.0, 50.0, 20.0, 310.0, 150.0, 20.0, 60.0, 100.0, 70.0, 80.0, 40.0, 60.0, 10.0, 160.0, 10.0, 40.0, -250.0, 100.0, 180.0, 40.0, 50.0, 30.0, 25.0, 360.0, 0.0, 10.0, 20.0, 30.0, 20.0, 120.0, 60.0, 10.0, 450.0, 40.0, 60.0, 0.0, 30.0, 20.0, 360.0, 20.0, 50.0, 100.0, 30.0, 10.0, -20.0, 90.0, 310.0, 120.0, -20.0, -30.0, 190.0, -50.0, 25.0, 350.0, 60.0, 150.0, 10.0, 100.0, 10.0, 270.0, 60.0, 40.0, 40.0, 195.0, 20.0, 120.0, 60.0, 250.0, 30.0, 10.0, 30.0, 10.0, 250.0, 10.0, 40.0, 10.0, 160.0, 70.0, 30.0, 0.0, 30.0, 170.0, 0.0, 40.0, 70.0, 90.0, 15.0, 50.0, 80.0, 60.0, 570.0, 550.0, 60.0, 40.0, 100.0, 310.0, 40.0, 180.0, -60.0, 60.0, 300.0, 80.0, 50.0, 10.0, 440.0, 270.0, 170.0, 30.0, 70.0, 230.0, 40.0, 0.0, 0.0, 40.0, 70.0, -5.0, 0.0, 40.0, 40.0, 80.0, 40.0, 20.0, 0.0, 10.0, 50.0, 140.0, 160.0, -75.0, 140.0, 90.0, 90.0, 30.0, -30.0, 180.0, 210.0, 160.0, 60.0, 20.0, 90.0, 70.0, 100.0, 30.0, 240.0, 40.0, 290.0, 30.0, 0.0, 80.0, 380.0, -20.0, -40.0, 370.0, 0.0, 80.0, 160.0, 100.0, -40.0, 360.0, 80.0, 80.0, 240.0, 60.0, 100.0, 90.0, 90.0, 10.0, 60.0, 10.0, 20.0, 70.0, 40.0, 60.0, 0.0, 10.0, 0.0, 20.0, -5.0, 10.0, 10.0, 10.0, -5.0, 0.0, 10.0, 0.0, 70.0, 70.0, 20.0, 90.0, 120.0, 20.0, 90.0, 160.0, 40.0, 210.0, 130.0, 10.0, 0.0, 160.0, 140.0, 290.0, 90.0, 10.0, 140.0, 60.0, 0.0, 130.0, -50.0, 580.0, 50.0, 15.0, 30.0, 0.0, 160.0, -30.0, 40.0, 30.0, 40.0, 110.0, 150.0, 10.0, 390.0, 100.0, 120.0, 100.0, 50.0, 30.0, 155.0, 0.0, 25.0, 160.0, 230.0, 60.0, 60.0, -50.0, 5.0, 30.0, 30.0, 30.0, 10.0, 20.0, 70.0, 40.0, 360.0, 70.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5543205865607013, "mean_inference_ms": 1.414329705038657, "mean_action_processing_ms": 0.43732173928628676, "mean_env_wait_ms": 1.2653030816098667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013627052307128906, "StateBufferConnector_ms": 0.010099649429321289, "ViewRequirementAgentConnector_ms": 0.4069206714630127}, "num_episodes": 18, "episode_return_max": 1680.0, "episode_return_min": 120.0, "episode_return_mean": 793.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.35916198426614, "num_env_steps_trained_throughput_per_sec": 21.35916198426614, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 186841.403, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186841.356, "sample_time_ms": 2447.937, "learn_time_ms": 184374.078, "learn_throughput": 21.695, "synch_weights_time_ms": 11.579}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 45, "trial_id": "90816_00000", "date": "2024-06-10_02-34-04", "timestamp": 1718001244, "time_this_iter_s": 187.28258681297302, "time_total_s": 8522.599786281586, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00e1310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8522.599786281586, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.29924528301887, "ram_util_percent": 77.79056603773584}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7784417813197493, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.929801594995208, "policy_loss": -0.010115560103434458, "vf_loss": 5.938374759188602, "vf_explained_var": 0.0015185182721724018, "kl": 0.007711966456345855, "entropy": 0.6801051306140562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 427245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 1620.0, "episode_reward_min": 120.0, "episode_reward_mean": 790.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 79.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [650.0, 340.0, 380.0, 1055.0, 640.0, 970.0, 360.0, 360.0, 1275.0, 1090.0, 540.0, 1255.0, 1485.0, 875.0, 640.0, 1050.0, 515.0, 535.0, 780.0, 630.0, 935.0, 880.0, 700.0, 610.0, 855.0, 780.0, 900.0, 805.0, 530.0, 580.0, 1200.0, 370.0, 1170.0, 670.0, 590.0, 840.0, 650.0, 120.0, 785.0, 910.0, 1260.0, 1620.0, 265.0, 610.0, 940.0, 190.0, 540.0, 1440.0, 420.0, 550.0, 1435.0, 320.0, 1320.0, 1015.0, 410.0, 605.0, 1250.0, 1390.0, 610.0, 575.0, 820.0, 600.0, 1045.0, 895.0, 810.0, 580.0, 1615.0, 1410.0, 920.0, 275.0, 935.0, 1100.0, 1040.0, 1160.0, 280.0, 120.0, 950.0, 900.0, 925.0, 1100.0, 675.0, 660.0, 1245.0, 755.0, 690.0, 515.0, 1170.0, 1115.0, 680.0, 255.0, 680.0, 350.0, 670.0, 455.0, 1060.0, 340.0, 320.0, 890.0, 850.0, 1120.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 110.0, 30.0, 40.0, 40.0, 90.0, 30.0, 60.0, 40.0, 150.0, 20.0, 30.0, 20.0, 40.0, 20.0, 30.0, 80.0, 10.0, 60.0, 30.0, 70.0, 60.0, 0.0, 20.0, 30.0, 170.0, 20.0, 30.0, 20.0, -40.0, 20.0, 20.0, 80.0, 330.0, 100.0, 10.0, 40.0, 25.0, 70.0, 360.0, 0.0, 90.0, 90.0, 160.0, 40.0, 20.0, 40.0, 40.0, 140.0, 20.0, 330.0, 50.0, 50.0, 170.0, 30.0, 50.0, 150.0, 20.0, 30.0, 90.0, 40.0, 20.0, 0.0, 50.0, 60.0, 20.0, 20.0, 30.0, 60.0, 60.0, 10.0, 0.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 160.0, 10.0, 110.0, 0.0, 110.0, 160.0, 90.0, 110.0, 10.0, 470.0, 210.0, 5.0, 0.0, 90.0, 80.0, 410.0, 30.0, 80.0, 20.0, 0.0, 20.0, 360.0, 45.0, 60.0, -40.0, 30.0, 20.0, 65.0, 20.0, -20.0, 400.0, -40.0, 130.0, 210.0, 40.0, 80.0, 40.0, 15.0, 180.0, 20.0, 60.0, 480.0, 160.0, 290.0, 10.0, 50.0, 50.0, 500.0, 45.0, 160.0, 60.0, 160.0, -10.0, 40.0, 10.0, 45.0, 120.0, 80.0, 330.0, 50.0, 150.0, 60.0, 180.0, 20.0, 40.0, 60.0, 90.0, 40.0, 80.0, 30.0, 50.0, 50.0, 60.0, 0.0, 280.0, 10.0, -10.0, 490.0, 70.0, 40.0, 60.0, 50.0, 30.0, -40.0, 90.0, 65.0, 40.0, 80.0, 40.0, 0.0, 40.0, 170.0, 20.0, 100.0, 0.0, 120.0, 20.0, 180.0, 30.0, 35.0, 10.0, 20.0, 60.0, 90.0, 30.0, 80.0, 40.0, 220.0, 40.0, 50.0, 70.0, 100.0, 50.0, 20.0, 0.0, 40.0, 90.0, 80.0, 70.0, 200.0, 10.0, 70.0, 170.0, 220.0, 80.0, -20.0, -5.0, 130.0, 30.0, 170.0, 110.0, 50.0, 170.0, 40.0, 80.0, 100.0, 20.0, 90.0, 20.0, 260.0, 0.0, 100.0, 270.0, 0.0, 40.0, 0.0, 40.0, 40.0, 40.0, 170.0, 30.0, 70.0, 40.0, 160.0, 10.0, 10.0, 30.0, 30.0, 120.0, 180.0, -10.0, 40.0, 80.0, 80.0, 340.0, 30.0, 35.0, -50.0, 180.0, 40.0, 50.0, 70.0, 50.0, 120.0, 10.0, 290.0, 30.0, 10.0, 170.0, 30.0, 30.0, 40.0, 310.0, 90.0, 160.0, 90.0, 5.0, 5.0, 20.0, 110.0, 90.0, 20.0, 100.0, 45.0, 10.0, 10.0, 60.0, 0.0, 370.0, 40.0, 60.0, 110.0, 20.0, 130.0, 30.0, 30.0, 20.0, 30.0, 60.0, 30.0, 20.0, 160.0, 100.0, 40.0, 10.0, 110.0, 70.0, 10.0, -50.0, 60.0, 130.0, 100.0, 10.0, 80.0, 180.0, 110.0, 50.0, -10.0, 40.0, 360.0, 190.0, 190.0, 50.0, 20.0, 40.0, 10.0, 60.0, 30.0, 70.0, 10.0, 10.0, 70.0, 50.0, 10.0, 200.0, 70.0, 20.0, 90.0, 220.0, 70.0, 350.0, 90.0, 90.0, 0.0, 80.0, 10.0, 130.0, 80.0, 60.0, 120.0, 80.0, 20.0, 255.0, 30.0, 120.0, 20.0, -5.0, 30.0, 20.0, 30.0, 50.0, 40.0, 180.0, 40.0, 30.0, 40.0, 420.0, 70.0, 20.0, 30.0, 50.0, -40.0, 10.0, 30.0, 30.0, 190.0, 90.0, 0.0, 0.0, 80.0, 0.0, 220.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 40.0, 5.0, 490.0, 90.0, 70.0, 10.0, -30.0, 30.0, 170.0, 160.0, 60.0, 40.0, 50.0, 70.0, 400.0, 0.0, 10.0, -50.0, 180.0, 180.0, 50.0, 210.0, 110.0, 120.0, 70.0, 0.0, 50.0, 290.0, 100.0, 160.0, 80.0, 320.0, 60.0, 10.0, 320.0, 160.0, 40.0, 370.0, 20.0, 20.0, 30.0, 20.0, 120.0, 0.0, 15.0, 10.0, 30.0, 0.0, 60.0, 40.0, -5.0, 60.0, 120.0, -5.0, 20.0, 120.0, 50.0, 150.0, 200.0, 90.0, 190.0, 70.0, 20.0, 20.0, 110.0, 90.0, 50.0, 100.0, 40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 170.0, 40.0, 160.0, 30.0, 40.0, 60.0, -40.0, 20.0, 70.0, 210.0, 50.0, 750.0, 30.0, 110.0, 50.0, 30.0, 90.0, 50.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 220.0, 20.0, 40.0, 60.0, 10.0, 0.0, 280.0, 70.0, 40.0, 60.0, 70.0, -50.0, 40.0, 30.0, 160.0, 20.0, 0.0, 90.0, 90.0, 100.0, 370.0, 360.0, 55.0, 190.0, 10.0, 0.0, 80.0, 0.0, 70.0, 30.0, -40.0, 20.0, 70.0, 80.0, -10.0, 340.0, 80.0, 40.0, 110.0, 30.0, 220.0, 170.0, 60.0, 280.0, 110.0, 40.0, 110.0, 160.0, 100.0, 0.0, 30.0, 20.0, 280.0, 165.0, 250.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, -30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 230.0, 150.0, 40.0, 35.0, 40.0, 160.0, 25.0, 50.0, 500.0, 90.0, 220.0, 70.0, 40.0, 25.0, 70.0, 60.0, 600.0, 90.0, 30.0, 60.0, 20.0, 50.0, 20.0, 310.0, 150.0, 20.0, 60.0, 100.0, 70.0, 80.0, 40.0, 60.0, 10.0, 160.0, 10.0, 40.0, -250.0, 100.0, 180.0, 40.0, 50.0, 30.0, 25.0, 360.0, 0.0, 10.0, 20.0, 30.0, 20.0, 120.0, 60.0, 10.0, 450.0, 40.0, 60.0, 0.0, 30.0, 20.0, 360.0, 20.0, 50.0, 100.0, 30.0, 10.0, -20.0, 90.0, 310.0, 120.0, -20.0, -30.0, 190.0, -50.0, 25.0, 350.0, 60.0, 150.0, 10.0, 100.0, 10.0, 270.0, 60.0, 40.0, 40.0, 195.0, 20.0, 120.0, 60.0, 250.0, 30.0, 10.0, 30.0, 10.0, 250.0, 10.0, 40.0, 10.0, 160.0, 70.0, 30.0, 0.0, 30.0, 170.0, 0.0, 40.0, 70.0, 90.0, 15.0, 50.0, 80.0, 60.0, 570.0, 550.0, 60.0, 40.0, 100.0, 310.0, 40.0, 180.0, -60.0, 60.0, 300.0, 80.0, 50.0, 10.0, 440.0, 270.0, 170.0, 30.0, 70.0, 230.0, 40.0, 0.0, 0.0, 40.0, 70.0, -5.0, 0.0, 40.0, 40.0, 80.0, 40.0, 20.0, 0.0, 10.0, 50.0, 140.0, 160.0, -75.0, 140.0, 90.0, 90.0, 30.0, -30.0, 180.0, 210.0, 160.0, 60.0, 20.0, 90.0, 70.0, 100.0, 30.0, 240.0, 40.0, 290.0, 30.0, 0.0, 80.0, 380.0, -20.0, -40.0, 370.0, 0.0, 80.0, 160.0, 100.0, -40.0, 360.0, 80.0, 80.0, 240.0, 60.0, 100.0, 90.0, 90.0, 10.0, 60.0, 10.0, 20.0, 70.0, 40.0, 60.0, 0.0, 10.0, 0.0, 20.0, -5.0, 10.0, 10.0, 10.0, -5.0, 0.0, 10.0, 0.0, 70.0, 70.0, 20.0, 90.0, 120.0, 20.0, 90.0, 160.0, 40.0, 210.0, 130.0, 10.0, 0.0, 160.0, 140.0, 290.0, 90.0, 10.0, 140.0, 60.0, 0.0, 130.0, -50.0, 580.0, 50.0, 15.0, 30.0, 0.0, 160.0, -30.0, 40.0, 30.0, 40.0, 110.0, 150.0, 10.0, 390.0, 100.0, 120.0, 100.0, 50.0, 30.0, 155.0, 0.0, 25.0, 160.0, 230.0, 60.0, 60.0, -50.0, 5.0, 30.0, 30.0, 30.0, 10.0, 20.0, 70.0, 40.0, 360.0, 70.0, 0.0, 130.0, 285.0, 110.0, -60.0, 50.0, 60.0, 190.0, 200.0, 230.0, 50.0, 40.0, 195.0, 110.0, 0.0, 110.0, 110.0, 90.0, 60.0, 20.0, 20.0, 130.0, 110.0, 30.0, 70.0, 120.0, 30.0, 40.0, 40.0, 80.0, 40.0, 190.0, 60.0, 20.0, 10.0, 70.0, 30.0, 15.0, 20.0, 80.0, 20.0, 260.0, 120.0, 180.0, 110.0, 110.0, 10.0, 150.0, 80.0, 110.0, 40.0, 40.0, 410.0, 10.0, 160.0, -20.0, 15.0, 80.0, 0.0, 340.0, 80.0, 190.0, 70.0, 60.0, 10.0, 0.0, 60.0, 80.0, 70.0, 80.0, 60.0, 40.0, 10.0, 10.0, 40.0, 20.0, 40.0, 0.0, 0.0, 15.0, 80.0, 40.0, 140.0, 70.0, 200.0, 70.0, 50.0, 10.0, 40.0, 20.0, 40.0, -50.0, 40.0, 20.0, 80.0, 90.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 40.0, 20.0, 0.0, 260.0, 60.0, 20.0, 20.0, 50.0, 180.0, 0.0, 70.0, 380.0, 100.0, 20.0, -5.0, 70.0, -140.0, -80.0, 40.0, 80.0, 90.0, 140.0, 280.0, 190.0, -100.0, 70.0, 160.0, 60.0, 90.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 20.0, 130.0, 0.0, 50.0, 100.0, 10.0, 40.0, 40.0, 20.0, 30.0, 0.0, 10.0, 40.0, 30.0, 30.0, 150.0, 40.0, 70.0, 20.0, 380.0, 70.0, 40.0, 70.0, 20.0, 190.0, 50.0, 180.0, 90.0, 30.0, 10.0, 130.0, 20.0, 120.0, 30.0, -10.0, 120.0, 50.0, 20.0, 100.0, 410.0, 20.0, 360.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5520188847460856, "mean_inference_ms": 1.4136343244519787, "mean_action_processing_ms": 0.43619952448372973, "mean_env_wait_ms": 1.2643311766830592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013663530349731445, "StateBufferConnector_ms": 0.010163068771362305, "ViewRequirementAgentConnector_ms": 0.40039634704589844}, "num_episodes": 18, "episode_return_max": 1620.0, "episode_return_min": 120.0, "episode_return_mean": 790.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.506653884859922, "num_env_steps_trained_throughput_per_sec": 21.506653884859922, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 186765.6, "restore_workers_time_ms": 0.014, "training_step_time_ms": 186765.55, "sample_time_ms": 2444.949, "learn_time_ms": 184301.038, "learn_throughput": 21.704, "synch_weights_time_ms": 11.662}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 46, "trial_id": "90816_00000", "date": "2024-06-10_02-37-10", "timestamp": 1718001430, "time_this_iter_s": 185.99793100357056, "time_total_s": 8708.597717285156, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00c0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8708.597717285156, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.388973384030418, "ram_util_percent": 78.3106463878327}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5894404438420477, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.8416499152605015, "policy_loss": -0.007549303614795287, "vf_loss": 5.847836379070506, "vf_explained_var": 0.003043086428484851, "kl": 0.006814209699602491, "entropy": 0.6861003798671678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 436635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "env_runners": {"episode_reward_max": 1620.0, "episode_reward_min": 120.0, "episode_reward_mean": 764.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 76.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 610.0, 855.0, 780.0, 900.0, 805.0, 530.0, 580.0, 1200.0, 370.0, 1170.0, 670.0, 590.0, 840.0, 650.0, 120.0, 785.0, 910.0, 1260.0, 1620.0, 265.0, 610.0, 940.0, 190.0, 540.0, 1440.0, 420.0, 550.0, 1435.0, 320.0, 1320.0, 1015.0, 410.0, 605.0, 1250.0, 1390.0, 610.0, 575.0, 820.0, 600.0, 1045.0, 895.0, 810.0, 580.0, 1615.0, 1410.0, 920.0, 275.0, 935.0, 1100.0, 1040.0, 1160.0, 280.0, 120.0, 950.0, 900.0, 925.0, 1100.0, 675.0, 660.0, 1245.0, 755.0, 690.0, 515.0, 1170.0, 1115.0, 680.0, 255.0, 680.0, 350.0, 670.0, 455.0, 1060.0, 340.0, 320.0, 890.0, 850.0, 1120.0, 265.0, 490.0, 1290.0, 385.0, 725.0, 680.0, 1110.0, 415.0, 1035.0, 525.0, 685.0, 1265.0, 840.0, 530.0, 265.0, 630.0, 1000.0, 450.0, 880.0, 405.0, 290.0, 435.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [270.0, 0.0, 40.0, 0.0, 40.0, 40.0, 40.0, 170.0, 30.0, 70.0, 40.0, 160.0, 10.0, 10.0, 30.0, 30.0, 120.0, 180.0, -10.0, 40.0, 80.0, 80.0, 340.0, 30.0, 35.0, -50.0, 180.0, 40.0, 50.0, 70.0, 50.0, 120.0, 10.0, 290.0, 30.0, 10.0, 170.0, 30.0, 30.0, 40.0, 310.0, 90.0, 160.0, 90.0, 5.0, 5.0, 20.0, 110.0, 90.0, 20.0, 100.0, 45.0, 10.0, 10.0, 60.0, 0.0, 370.0, 40.0, 60.0, 110.0, 20.0, 130.0, 30.0, 30.0, 20.0, 30.0, 60.0, 30.0, 20.0, 160.0, 100.0, 40.0, 10.0, 110.0, 70.0, 10.0, -50.0, 60.0, 130.0, 100.0, 10.0, 80.0, 180.0, 110.0, 50.0, -10.0, 40.0, 360.0, 190.0, 190.0, 50.0, 20.0, 40.0, 10.0, 60.0, 30.0, 70.0, 10.0, 10.0, 70.0, 50.0, 10.0, 200.0, 70.0, 20.0, 90.0, 220.0, 70.0, 350.0, 90.0, 90.0, 0.0, 80.0, 10.0, 130.0, 80.0, 60.0, 120.0, 80.0, 20.0, 255.0, 30.0, 120.0, 20.0, -5.0, 30.0, 20.0, 30.0, 50.0, 40.0, 180.0, 40.0, 30.0, 40.0, 420.0, 70.0, 20.0, 30.0, 50.0, -40.0, 10.0, 30.0, 30.0, 190.0, 90.0, 0.0, 0.0, 80.0, 0.0, 220.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 40.0, 5.0, 490.0, 90.0, 70.0, 10.0, -30.0, 30.0, 170.0, 160.0, 60.0, 40.0, 50.0, 70.0, 400.0, 0.0, 10.0, -50.0, 180.0, 180.0, 50.0, 210.0, 110.0, 120.0, 70.0, 0.0, 50.0, 290.0, 100.0, 160.0, 80.0, 320.0, 60.0, 10.0, 320.0, 160.0, 40.0, 370.0, 20.0, 20.0, 30.0, 20.0, 120.0, 0.0, 15.0, 10.0, 30.0, 0.0, 60.0, 40.0, -5.0, 60.0, 120.0, -5.0, 20.0, 120.0, 50.0, 150.0, 200.0, 90.0, 190.0, 70.0, 20.0, 20.0, 110.0, 90.0, 50.0, 100.0, 40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 170.0, 40.0, 160.0, 30.0, 40.0, 60.0, -40.0, 20.0, 70.0, 210.0, 50.0, 750.0, 30.0, 110.0, 50.0, 30.0, 90.0, 50.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 220.0, 20.0, 40.0, 60.0, 10.0, 0.0, 280.0, 70.0, 40.0, 60.0, 70.0, -50.0, 40.0, 30.0, 160.0, 20.0, 0.0, 90.0, 90.0, 100.0, 370.0, 360.0, 55.0, 190.0, 10.0, 0.0, 80.0, 0.0, 70.0, 30.0, -40.0, 20.0, 70.0, 80.0, -10.0, 340.0, 80.0, 40.0, 110.0, 30.0, 220.0, 170.0, 60.0, 280.0, 110.0, 40.0, 110.0, 160.0, 100.0, 0.0, 30.0, 20.0, 280.0, 165.0, 250.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, -30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 230.0, 150.0, 40.0, 35.0, 40.0, 160.0, 25.0, 50.0, 500.0, 90.0, 220.0, 70.0, 40.0, 25.0, 70.0, 60.0, 600.0, 90.0, 30.0, 60.0, 20.0, 50.0, 20.0, 310.0, 150.0, 20.0, 60.0, 100.0, 70.0, 80.0, 40.0, 60.0, 10.0, 160.0, 10.0, 40.0, -250.0, 100.0, 180.0, 40.0, 50.0, 30.0, 25.0, 360.0, 0.0, 10.0, 20.0, 30.0, 20.0, 120.0, 60.0, 10.0, 450.0, 40.0, 60.0, 0.0, 30.0, 20.0, 360.0, 20.0, 50.0, 100.0, 30.0, 10.0, -20.0, 90.0, 310.0, 120.0, -20.0, -30.0, 190.0, -50.0, 25.0, 350.0, 60.0, 150.0, 10.0, 100.0, 10.0, 270.0, 60.0, 40.0, 40.0, 195.0, 20.0, 120.0, 60.0, 250.0, 30.0, 10.0, 30.0, 10.0, 250.0, 10.0, 40.0, 10.0, 160.0, 70.0, 30.0, 0.0, 30.0, 170.0, 0.0, 40.0, 70.0, 90.0, 15.0, 50.0, 80.0, 60.0, 570.0, 550.0, 60.0, 40.0, 100.0, 310.0, 40.0, 180.0, -60.0, 60.0, 300.0, 80.0, 50.0, 10.0, 440.0, 270.0, 170.0, 30.0, 70.0, 230.0, 40.0, 0.0, 0.0, 40.0, 70.0, -5.0, 0.0, 40.0, 40.0, 80.0, 40.0, 20.0, 0.0, 10.0, 50.0, 140.0, 160.0, -75.0, 140.0, 90.0, 90.0, 30.0, -30.0, 180.0, 210.0, 160.0, 60.0, 20.0, 90.0, 70.0, 100.0, 30.0, 240.0, 40.0, 290.0, 30.0, 0.0, 80.0, 380.0, -20.0, -40.0, 370.0, 0.0, 80.0, 160.0, 100.0, -40.0, 360.0, 80.0, 80.0, 240.0, 60.0, 100.0, 90.0, 90.0, 10.0, 60.0, 10.0, 20.0, 70.0, 40.0, 60.0, 0.0, 10.0, 0.0, 20.0, -5.0, 10.0, 10.0, 10.0, -5.0, 0.0, 10.0, 0.0, 70.0, 70.0, 20.0, 90.0, 120.0, 20.0, 90.0, 160.0, 40.0, 210.0, 130.0, 10.0, 0.0, 160.0, 140.0, 290.0, 90.0, 10.0, 140.0, 60.0, 0.0, 130.0, -50.0, 580.0, 50.0, 15.0, 30.0, 0.0, 160.0, -30.0, 40.0, 30.0, 40.0, 110.0, 150.0, 10.0, 390.0, 100.0, 120.0, 100.0, 50.0, 30.0, 155.0, 0.0, 25.0, 160.0, 230.0, 60.0, 60.0, -50.0, 5.0, 30.0, 30.0, 30.0, 10.0, 20.0, 70.0, 40.0, 360.0, 70.0, 0.0, 130.0, 285.0, 110.0, -60.0, 50.0, 60.0, 190.0, 200.0, 230.0, 50.0, 40.0, 195.0, 110.0, 0.0, 110.0, 110.0, 90.0, 60.0, 20.0, 20.0, 130.0, 110.0, 30.0, 70.0, 120.0, 30.0, 40.0, 40.0, 80.0, 40.0, 190.0, 60.0, 20.0, 10.0, 70.0, 30.0, 15.0, 20.0, 80.0, 20.0, 260.0, 120.0, 180.0, 110.0, 110.0, 10.0, 150.0, 80.0, 110.0, 40.0, 40.0, 410.0, 10.0, 160.0, -20.0, 15.0, 80.0, 0.0, 340.0, 80.0, 190.0, 70.0, 60.0, 10.0, 0.0, 60.0, 80.0, 70.0, 80.0, 60.0, 40.0, 10.0, 10.0, 40.0, 20.0, 40.0, 0.0, 0.0, 15.0, 80.0, 40.0, 140.0, 70.0, 200.0, 70.0, 50.0, 10.0, 40.0, 20.0, 40.0, -50.0, 40.0, 20.0, 80.0, 90.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 40.0, 20.0, 0.0, 260.0, 60.0, 20.0, 20.0, 50.0, 180.0, 0.0, 70.0, 380.0, 100.0, 20.0, -5.0, 70.0, -140.0, -80.0, 40.0, 80.0, 90.0, 140.0, 280.0, 190.0, -100.0, 70.0, 160.0, 60.0, 90.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 20.0, 130.0, 0.0, 50.0, 100.0, 10.0, 40.0, 40.0, 20.0, 30.0, 0.0, 10.0, 40.0, 30.0, 30.0, 150.0, 40.0, 70.0, 20.0, 380.0, 70.0, 40.0, 70.0, 20.0, 190.0, 50.0, 180.0, 90.0, 30.0, 10.0, 130.0, 20.0, 120.0, 30.0, -10.0, 120.0, 50.0, 20.0, 100.0, 410.0, 20.0, 360.0, 30.0, 20.0, 20.0, 35.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 90.0, 10.0, 10.0, 80.0, 50.0, 0.0, 120.0, 170.0, 20.0, 10.0, 20.0, 480.0, 50.0, 150.0, 20.0, 90.0, 20.0, 100.0, 310.0, 40.0, 30.0, 10.0, 0.0, 65.0, 20.0, 120.0, 70.0, 10.0, 20.0, 60.0, 10.0, 70.0, 30.0, 160.0, 220.0, 30.0, -45.0, 90.0, 70.0, 10.0, 90.0, 100.0, 230.0, 20.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 30.0, 20.0, 190.0, 140.0, 100.0, 40.0, 0.0, 350.0, 120.0, 150.0, 0.0, 35.0, 70.0, 80.0, 30.0, 10.0, 60.0, 0.0, 50.0, 40.0, 40.0, -5.0, 150.0, 120.0, 120.0, 70.0, 460.0, 0.0, 40.0, 40.0, 40.0, 30.0, 0.0, 80.0, 30.0, 80.0, 65.0, 10.0, 80.0, 110.0, 40.0, 10.0, 30.0, 35.0, 60.0, 20.0, 0.0, 330.0, 60.0, 130.0, 10.0, 80.0, 50.0, 10.0, 140.0, 20.0, 280.0, 40.0, 560.0, 60.0, 25.0, 20.0, 30.0, 140.0, 0.0, 150.0, -20.0, 80.0, 110.0, 320.0, 10.0, 10.0, 0.0, 20.0, 20.0, 160.0, 10.0, 30.0, 0.0, 110.0, 170.0, 70.0, 20.0, 25.0, 0.0, 40.0, 40.0, 10.0, 20.0, 0.0, 40.0, 70.0, 20.0, 20.0, 140.0, 30.0, 150.0, 30.0, 20.0, 80.0, 70.0, 30.0, 130.0, 190.0, 220.0, 90.0, 40.0, 40.0, 170.0, 0.0, 90.0, 170.0, 0.0, 20.0, 100.0, 10.0, 40.0, 40.0, 40.0, 20.0, 10.0, 30.0, 70.0, 230.0, 70.0, 290.0, 30.0, 160.0, -70.0, 30.0, 40.0, 70.0, 10.0, 10.0, 20.0, 0.0, 200.0, 0.0, 5.0, 20.0, 70.0, 20.0, 10.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 10.0, 30.0, 20.0, 130.0, 30.0, 60.0, 20.0, 15.0, 80.0, 10.0, 40.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5503246598654135, "mean_inference_ms": 1.413556345770089, "mean_action_processing_ms": 0.43499078246236444, "mean_env_wait_ms": 1.2628675516852568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012884378433227539, "StateBufferConnector_ms": 0.009831428527832031, "ViewRequirementAgentConnector_ms": 0.38109540939331055}, "num_episodes": 22, "episode_return_max": 1620.0, "episode_return_min": 120.0, "episode_return_mean": 764.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.379151906678498, "num_env_steps_trained_throughput_per_sec": 21.379151906678498, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 1880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1880000, "timers": {"training_iteration_time_ms": 186688.989, "restore_workers_time_ms": 0.014, "training_step_time_ms": 186688.939, "sample_time_ms": 2455.316, "learn_time_ms": 184212.823, "learn_throughput": 21.714, "synch_weights_time_ms": 12.418}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "done": false, "training_iteration": 47, "trial_id": "90816_00000", "date": "2024-06-10_02-40-17", "timestamp": 1718001617, "time_this_iter_s": 187.10497117042542, "time_total_s": 8895.702688455582, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00e1b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8895.702688455582, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.746415094339625, "ram_util_percent": 78.52603773584906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5672054528047483, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.441905057493744, "policy_loss": -0.008975139630242341, "vf_loss": 5.449468495010441, "vf_explained_var": 0.0016761413968790072, "kl": 0.007058469998961157, "entropy": 0.6518562839720576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 446025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 1615.0, "episode_reward_min": 120.0, "episode_reward_mean": 736.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 73.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 540.0, 1440.0, 420.0, 550.0, 1435.0, 320.0, 1320.0, 1015.0, 410.0, 605.0, 1250.0, 1390.0, 610.0, 575.0, 820.0, 600.0, 1045.0, 895.0, 810.0, 580.0, 1615.0, 1410.0, 920.0, 275.0, 935.0, 1100.0, 1040.0, 1160.0, 280.0, 120.0, 950.0, 900.0, 925.0, 1100.0, 675.0, 660.0, 1245.0, 755.0, 690.0, 515.0, 1170.0, 1115.0, 680.0, 255.0, 680.0, 350.0, 670.0, 455.0, 1060.0, 340.0, 320.0, 890.0, 850.0, 1120.0, 265.0, 490.0, 1290.0, 385.0, 725.0, 680.0, 1110.0, 415.0, 1035.0, 525.0, 685.0, 1265.0, 840.0, 530.0, 265.0, 630.0, 1000.0, 450.0, 880.0, 405.0, 290.0, 435.0, 940.0, 370.0, 455.0, 625.0, 300.0, 1105.0, 1240.0, 470.0, 320.0, 385.0, 530.0, 855.0, 1070.0, 980.0, 970.0, 1030.0, 225.0, 970.0, 430.0, 295.0, 990.0, 245.0, 210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 30.0, 30.0, 170.0, 40.0, 160.0, 30.0, 40.0, 60.0, -40.0, 20.0, 70.0, 210.0, 50.0, 750.0, 30.0, 110.0, 50.0, 30.0, 90.0, 50.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 220.0, 20.0, 40.0, 60.0, 10.0, 0.0, 280.0, 70.0, 40.0, 60.0, 70.0, -50.0, 40.0, 30.0, 160.0, 20.0, 0.0, 90.0, 90.0, 100.0, 370.0, 360.0, 55.0, 190.0, 10.0, 0.0, 80.0, 0.0, 70.0, 30.0, -40.0, 20.0, 70.0, 80.0, -10.0, 340.0, 80.0, 40.0, 110.0, 30.0, 220.0, 170.0, 60.0, 280.0, 110.0, 40.0, 110.0, 160.0, 100.0, 0.0, 30.0, 20.0, 280.0, 165.0, 250.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, -30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 230.0, 150.0, 40.0, 35.0, 40.0, 160.0, 25.0, 50.0, 500.0, 90.0, 220.0, 70.0, 40.0, 25.0, 70.0, 60.0, 600.0, 90.0, 30.0, 60.0, 20.0, 50.0, 20.0, 310.0, 150.0, 20.0, 60.0, 100.0, 70.0, 80.0, 40.0, 60.0, 10.0, 160.0, 10.0, 40.0, -250.0, 100.0, 180.0, 40.0, 50.0, 30.0, 25.0, 360.0, 0.0, 10.0, 20.0, 30.0, 20.0, 120.0, 60.0, 10.0, 450.0, 40.0, 60.0, 0.0, 30.0, 20.0, 360.0, 20.0, 50.0, 100.0, 30.0, 10.0, -20.0, 90.0, 310.0, 120.0, -20.0, -30.0, 190.0, -50.0, 25.0, 350.0, 60.0, 150.0, 10.0, 100.0, 10.0, 270.0, 60.0, 40.0, 40.0, 195.0, 20.0, 120.0, 60.0, 250.0, 30.0, 10.0, 30.0, 10.0, 250.0, 10.0, 40.0, 10.0, 160.0, 70.0, 30.0, 0.0, 30.0, 170.0, 0.0, 40.0, 70.0, 90.0, 15.0, 50.0, 80.0, 60.0, 570.0, 550.0, 60.0, 40.0, 100.0, 310.0, 40.0, 180.0, -60.0, 60.0, 300.0, 80.0, 50.0, 10.0, 440.0, 270.0, 170.0, 30.0, 70.0, 230.0, 40.0, 0.0, 0.0, 40.0, 70.0, -5.0, 0.0, 40.0, 40.0, 80.0, 40.0, 20.0, 0.0, 10.0, 50.0, 140.0, 160.0, -75.0, 140.0, 90.0, 90.0, 30.0, -30.0, 180.0, 210.0, 160.0, 60.0, 20.0, 90.0, 70.0, 100.0, 30.0, 240.0, 40.0, 290.0, 30.0, 0.0, 80.0, 380.0, -20.0, -40.0, 370.0, 0.0, 80.0, 160.0, 100.0, -40.0, 360.0, 80.0, 80.0, 240.0, 60.0, 100.0, 90.0, 90.0, 10.0, 60.0, 10.0, 20.0, 70.0, 40.0, 60.0, 0.0, 10.0, 0.0, 20.0, -5.0, 10.0, 10.0, 10.0, -5.0, 0.0, 10.0, 0.0, 70.0, 70.0, 20.0, 90.0, 120.0, 20.0, 90.0, 160.0, 40.0, 210.0, 130.0, 10.0, 0.0, 160.0, 140.0, 290.0, 90.0, 10.0, 140.0, 60.0, 0.0, 130.0, -50.0, 580.0, 50.0, 15.0, 30.0, 0.0, 160.0, -30.0, 40.0, 30.0, 40.0, 110.0, 150.0, 10.0, 390.0, 100.0, 120.0, 100.0, 50.0, 30.0, 155.0, 0.0, 25.0, 160.0, 230.0, 60.0, 60.0, -50.0, 5.0, 30.0, 30.0, 30.0, 10.0, 20.0, 70.0, 40.0, 360.0, 70.0, 0.0, 130.0, 285.0, 110.0, -60.0, 50.0, 60.0, 190.0, 200.0, 230.0, 50.0, 40.0, 195.0, 110.0, 0.0, 110.0, 110.0, 90.0, 60.0, 20.0, 20.0, 130.0, 110.0, 30.0, 70.0, 120.0, 30.0, 40.0, 40.0, 80.0, 40.0, 190.0, 60.0, 20.0, 10.0, 70.0, 30.0, 15.0, 20.0, 80.0, 20.0, 260.0, 120.0, 180.0, 110.0, 110.0, 10.0, 150.0, 80.0, 110.0, 40.0, 40.0, 410.0, 10.0, 160.0, -20.0, 15.0, 80.0, 0.0, 340.0, 80.0, 190.0, 70.0, 60.0, 10.0, 0.0, 60.0, 80.0, 70.0, 80.0, 60.0, 40.0, 10.0, 10.0, 40.0, 20.0, 40.0, 0.0, 0.0, 15.0, 80.0, 40.0, 140.0, 70.0, 200.0, 70.0, 50.0, 10.0, 40.0, 20.0, 40.0, -50.0, 40.0, 20.0, 80.0, 90.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 40.0, 20.0, 0.0, 260.0, 60.0, 20.0, 20.0, 50.0, 180.0, 0.0, 70.0, 380.0, 100.0, 20.0, -5.0, 70.0, -140.0, -80.0, 40.0, 80.0, 90.0, 140.0, 280.0, 190.0, -100.0, 70.0, 160.0, 60.0, 90.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 20.0, 130.0, 0.0, 50.0, 100.0, 10.0, 40.0, 40.0, 20.0, 30.0, 0.0, 10.0, 40.0, 30.0, 30.0, 150.0, 40.0, 70.0, 20.0, 380.0, 70.0, 40.0, 70.0, 20.0, 190.0, 50.0, 180.0, 90.0, 30.0, 10.0, 130.0, 20.0, 120.0, 30.0, -10.0, 120.0, 50.0, 20.0, 100.0, 410.0, 20.0, 360.0, 30.0, 20.0, 20.0, 35.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 90.0, 10.0, 10.0, 80.0, 50.0, 0.0, 120.0, 170.0, 20.0, 10.0, 20.0, 480.0, 50.0, 150.0, 20.0, 90.0, 20.0, 100.0, 310.0, 40.0, 30.0, 10.0, 0.0, 65.0, 20.0, 120.0, 70.0, 10.0, 20.0, 60.0, 10.0, 70.0, 30.0, 160.0, 220.0, 30.0, -45.0, 90.0, 70.0, 10.0, 90.0, 100.0, 230.0, 20.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 30.0, 20.0, 190.0, 140.0, 100.0, 40.0, 0.0, 350.0, 120.0, 150.0, 0.0, 35.0, 70.0, 80.0, 30.0, 10.0, 60.0, 0.0, 50.0, 40.0, 40.0, -5.0, 150.0, 120.0, 120.0, 70.0, 460.0, 0.0, 40.0, 40.0, 40.0, 30.0, 0.0, 80.0, 30.0, 80.0, 65.0, 10.0, 80.0, 110.0, 40.0, 10.0, 30.0, 35.0, 60.0, 20.0, 0.0, 330.0, 60.0, 130.0, 10.0, 80.0, 50.0, 10.0, 140.0, 20.0, 280.0, 40.0, 560.0, 60.0, 25.0, 20.0, 30.0, 140.0, 0.0, 150.0, -20.0, 80.0, 110.0, 320.0, 10.0, 10.0, 0.0, 20.0, 20.0, 160.0, 10.0, 30.0, 0.0, 110.0, 170.0, 70.0, 20.0, 25.0, 0.0, 40.0, 40.0, 10.0, 20.0, 0.0, 40.0, 70.0, 20.0, 20.0, 140.0, 30.0, 150.0, 30.0, 20.0, 80.0, 70.0, 30.0, 130.0, 190.0, 220.0, 90.0, 40.0, 40.0, 170.0, 0.0, 90.0, 170.0, 0.0, 20.0, 100.0, 10.0, 40.0, 40.0, 40.0, 20.0, 10.0, 30.0, 70.0, 230.0, 70.0, 290.0, 30.0, 160.0, -70.0, 30.0, 40.0, 70.0, 10.0, 10.0, 20.0, 0.0, 200.0, 0.0, 5.0, 20.0, 70.0, 20.0, 10.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 10.0, 30.0, 20.0, 130.0, 30.0, 60.0, 20.0, 15.0, 80.0, 10.0, 40.0, 30.0, 50.0, 90.0, 160.0, 190.0, 10.0, 30.0, 90.0, 100.0, 160.0, 60.0, 20.0, 0.0, 160.0, 0.0, 10.0, 50.0, 30.0, 30.0, 50.0, 20.0, 80.0, 15.0, 20.0, 0.0, 0.0, 90.0, 30.0, 30.0, 150.0, 40.0, 310.0, 60.0, 30.0, -50.0, 260.0, 30.0, 20.0, -85.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 30.0, 40.0, 70.0, 40.0, 0.0, 320.0, -10.0, 35.0, -20.0, 170.0, 80.0, 160.0, 60.0, 130.0, 180.0, 60.0, 170.0, 210.0, 60.0, 30.0, 30.0, 30.0, 250.0, 130.0, 270.0, 200.0, -10.0, 40.0, 40.0, 130.0, 40.0, -10.0, -60.0, 10.0, 90.0, 100.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 40.0, 200.0, 30.0, 10.0, 30.0, 130.0, -200.0, 150.0, 20.0, 15.0, 0.0, 20.0, 160.0, 130.0, 30.0, 20.0, 30.0, 40.0, 10.0, 50.0, 40.0, 10.0, 170.0, 130.0, 130.0, 10.0, 80.0, 170.0, 50.0, 55.0, 50.0, 50.0, 200.0, 80.0, 80.0, 120.0, 180.0, 20.0, 150.0, 140.0, 50.0, 20.0, 510.0, 40.0, 20.0, 80.0, 100.0, 30.0, 20.0, 120.0, 40.0, 150.0, 50.0, 150.0, 50.0, 50.0, 30.0, 10.0, 160.0, 60.0, 260.0, -70.0, 10.0, 20.0, 0.0, 80.0, 30.0, 380.0, 310.0, 20.0, 250.0, 0.0, 30.0, 30.0, -5.0, 10.0, 60.0, 20.0, 0.0, 20.0, 60.0, 200.0, 180.0, 120.0, 150.0, 10.0, 50.0, 100.0, -30.0, 150.0, 40.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 170.0, 20.0, 160.0, 15.0, 60.0, 40.0, 40.0, 30.0, 20.0, 10.0, -15.0, 40.0, 40.0, 30.0, 320.0, 110.0, 90.0, 60.0, 70.0, 50.0, 70.0, 40.0, 110.0, 70.0, 20.0, 50.0, 10.0, 40.0, 0.0, 0.0, 50.0, 30.0, 20.0, 25.0, 20.0, 40.0, 30.0, 0.0, 20.0, 70.0, 10.0, 10.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5478345399675724, "mean_inference_ms": 1.413252865192262, "mean_action_processing_ms": 0.43324462944747266, "mean_env_wait_ms": 1.2607474831092782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01291203498840332, "StateBufferConnector_ms": 0.009976387023925781, "ViewRequirementAgentConnector_ms": 0.3851890563964844}, "num_episodes": 23, "episode_return_max": 1615.0, "episode_return_min": 120.0, "episode_return_mean": 736.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.43039093272609, "num_env_steps_trained_throughput_per_sec": 21.43039093272609, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 186810.092, "restore_workers_time_ms": 0.014, "training_step_time_ms": 186810.043, "sample_time_ms": 2415.653, "learn_time_ms": 184374.062, "learn_throughput": 21.695, "synch_weights_time_ms": 12.123}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 48, "trial_id": "90816_00000", "date": "2024-06-10_02-43-24", "timestamp": 1718001804, "time_this_iter_s": 186.6585021018982, "time_total_s": 9082.36119055748, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0040430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9082.36119055748, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.559090909090912, "ram_util_percent": 78.86212121212121}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.473442301830164, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.181893822585685, "policy_loss": -0.009143884889945126, "vf_loss": 6.189570870567054, "vf_explained_var": 0.0012408170837182968, "kl": 0.0073341820993207945, "entropy": 0.6191511080160943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 455415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "env_runners": {"episode_reward_max": 1615.0, "episode_reward_min": 120.0, "episode_reward_mean": 748.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -200.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 74.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [895.0, 810.0, 580.0, 1615.0, 1410.0, 920.0, 275.0, 935.0, 1100.0, 1040.0, 1160.0, 280.0, 120.0, 950.0, 900.0, 925.0, 1100.0, 675.0, 660.0, 1245.0, 755.0, 690.0, 515.0, 1170.0, 1115.0, 680.0, 255.0, 680.0, 350.0, 670.0, 455.0, 1060.0, 340.0, 320.0, 890.0, 850.0, 1120.0, 265.0, 490.0, 1290.0, 385.0, 725.0, 680.0, 1110.0, 415.0, 1035.0, 525.0, 685.0, 1265.0, 840.0, 530.0, 265.0, 630.0, 1000.0, 450.0, 880.0, 405.0, 290.0, 435.0, 940.0, 370.0, 455.0, 625.0, 300.0, 1105.0, 1240.0, 470.0, 320.0, 385.0, 530.0, 855.0, 1070.0, 980.0, 970.0, 1030.0, 225.0, 970.0, 430.0, 295.0, 990.0, 245.0, 210.0, 140.0, 1020.0, 1300.0, 890.0, 600.0, 290.0, 765.0, 960.0, 1540.0, 550.0, 1250.0, 900.0, 630.0, 1105.0, 265.0, 1520.0, 950.0, 1020.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 10.0, 100.0, 10.0, 270.0, 60.0, 40.0, 40.0, 195.0, 20.0, 120.0, 60.0, 250.0, 30.0, 10.0, 30.0, 10.0, 250.0, 10.0, 40.0, 10.0, 160.0, 70.0, 30.0, 0.0, 30.0, 170.0, 0.0, 40.0, 70.0, 90.0, 15.0, 50.0, 80.0, 60.0, 570.0, 550.0, 60.0, 40.0, 100.0, 310.0, 40.0, 180.0, -60.0, 60.0, 300.0, 80.0, 50.0, 10.0, 440.0, 270.0, 170.0, 30.0, 70.0, 230.0, 40.0, 0.0, 0.0, 40.0, 70.0, -5.0, 0.0, 40.0, 40.0, 80.0, 40.0, 20.0, 0.0, 10.0, 50.0, 140.0, 160.0, -75.0, 140.0, 90.0, 90.0, 30.0, -30.0, 180.0, 210.0, 160.0, 60.0, 20.0, 90.0, 70.0, 100.0, 30.0, 240.0, 40.0, 290.0, 30.0, 0.0, 80.0, 380.0, -20.0, -40.0, 370.0, 0.0, 80.0, 160.0, 100.0, -40.0, 360.0, 80.0, 80.0, 240.0, 60.0, 100.0, 90.0, 90.0, 10.0, 60.0, 10.0, 20.0, 70.0, 40.0, 60.0, 0.0, 10.0, 0.0, 20.0, -5.0, 10.0, 10.0, 10.0, -5.0, 0.0, 10.0, 0.0, 70.0, 70.0, 20.0, 90.0, 120.0, 20.0, 90.0, 160.0, 40.0, 210.0, 130.0, 10.0, 0.0, 160.0, 140.0, 290.0, 90.0, 10.0, 140.0, 60.0, 0.0, 130.0, -50.0, 580.0, 50.0, 15.0, 30.0, 0.0, 160.0, -30.0, 40.0, 30.0, 40.0, 110.0, 150.0, 10.0, 390.0, 100.0, 120.0, 100.0, 50.0, 30.0, 155.0, 0.0, 25.0, 160.0, 230.0, 60.0, 60.0, -50.0, 5.0, 30.0, 30.0, 30.0, 10.0, 20.0, 70.0, 40.0, 360.0, 70.0, 0.0, 130.0, 285.0, 110.0, -60.0, 50.0, 60.0, 190.0, 200.0, 230.0, 50.0, 40.0, 195.0, 110.0, 0.0, 110.0, 110.0, 90.0, 60.0, 20.0, 20.0, 130.0, 110.0, 30.0, 70.0, 120.0, 30.0, 40.0, 40.0, 80.0, 40.0, 190.0, 60.0, 20.0, 10.0, 70.0, 30.0, 15.0, 20.0, 80.0, 20.0, 260.0, 120.0, 180.0, 110.0, 110.0, 10.0, 150.0, 80.0, 110.0, 40.0, 40.0, 410.0, 10.0, 160.0, -20.0, 15.0, 80.0, 0.0, 340.0, 80.0, 190.0, 70.0, 60.0, 10.0, 0.0, 60.0, 80.0, 70.0, 80.0, 60.0, 40.0, 10.0, 10.0, 40.0, 20.0, 40.0, 0.0, 0.0, 15.0, 80.0, 40.0, 140.0, 70.0, 200.0, 70.0, 50.0, 10.0, 40.0, 20.0, 40.0, -50.0, 40.0, 20.0, 80.0, 90.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 40.0, 20.0, 0.0, 260.0, 60.0, 20.0, 20.0, 50.0, 180.0, 0.0, 70.0, 380.0, 100.0, 20.0, -5.0, 70.0, -140.0, -80.0, 40.0, 80.0, 90.0, 140.0, 280.0, 190.0, -100.0, 70.0, 160.0, 60.0, 90.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 20.0, 130.0, 0.0, 50.0, 100.0, 10.0, 40.0, 40.0, 20.0, 30.0, 0.0, 10.0, 40.0, 30.0, 30.0, 150.0, 40.0, 70.0, 20.0, 380.0, 70.0, 40.0, 70.0, 20.0, 190.0, 50.0, 180.0, 90.0, 30.0, 10.0, 130.0, 20.0, 120.0, 30.0, -10.0, 120.0, 50.0, 20.0, 100.0, 410.0, 20.0, 360.0, 30.0, 20.0, 20.0, 35.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 90.0, 10.0, 10.0, 80.0, 50.0, 0.0, 120.0, 170.0, 20.0, 10.0, 20.0, 480.0, 50.0, 150.0, 20.0, 90.0, 20.0, 100.0, 310.0, 40.0, 30.0, 10.0, 0.0, 65.0, 20.0, 120.0, 70.0, 10.0, 20.0, 60.0, 10.0, 70.0, 30.0, 160.0, 220.0, 30.0, -45.0, 90.0, 70.0, 10.0, 90.0, 100.0, 230.0, 20.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 30.0, 20.0, 190.0, 140.0, 100.0, 40.0, 0.0, 350.0, 120.0, 150.0, 0.0, 35.0, 70.0, 80.0, 30.0, 10.0, 60.0, 0.0, 50.0, 40.0, 40.0, -5.0, 150.0, 120.0, 120.0, 70.0, 460.0, 0.0, 40.0, 40.0, 40.0, 30.0, 0.0, 80.0, 30.0, 80.0, 65.0, 10.0, 80.0, 110.0, 40.0, 10.0, 30.0, 35.0, 60.0, 20.0, 0.0, 330.0, 60.0, 130.0, 10.0, 80.0, 50.0, 10.0, 140.0, 20.0, 280.0, 40.0, 560.0, 60.0, 25.0, 20.0, 30.0, 140.0, 0.0, 150.0, -20.0, 80.0, 110.0, 320.0, 10.0, 10.0, 0.0, 20.0, 20.0, 160.0, 10.0, 30.0, 0.0, 110.0, 170.0, 70.0, 20.0, 25.0, 0.0, 40.0, 40.0, 10.0, 20.0, 0.0, 40.0, 70.0, 20.0, 20.0, 140.0, 30.0, 150.0, 30.0, 20.0, 80.0, 70.0, 30.0, 130.0, 190.0, 220.0, 90.0, 40.0, 40.0, 170.0, 0.0, 90.0, 170.0, 0.0, 20.0, 100.0, 10.0, 40.0, 40.0, 40.0, 20.0, 10.0, 30.0, 70.0, 230.0, 70.0, 290.0, 30.0, 160.0, -70.0, 30.0, 40.0, 70.0, 10.0, 10.0, 20.0, 0.0, 200.0, 0.0, 5.0, 20.0, 70.0, 20.0, 10.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 10.0, 30.0, 20.0, 130.0, 30.0, 60.0, 20.0, 15.0, 80.0, 10.0, 40.0, 30.0, 50.0, 90.0, 160.0, 190.0, 10.0, 30.0, 90.0, 100.0, 160.0, 60.0, 20.0, 0.0, 160.0, 0.0, 10.0, 50.0, 30.0, 30.0, 50.0, 20.0, 80.0, 15.0, 20.0, 0.0, 0.0, 90.0, 30.0, 30.0, 150.0, 40.0, 310.0, 60.0, 30.0, -50.0, 260.0, 30.0, 20.0, -85.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 30.0, 40.0, 70.0, 40.0, 0.0, 320.0, -10.0, 35.0, -20.0, 170.0, 80.0, 160.0, 60.0, 130.0, 180.0, 60.0, 170.0, 210.0, 60.0, 30.0, 30.0, 30.0, 250.0, 130.0, 270.0, 200.0, -10.0, 40.0, 40.0, 130.0, 40.0, -10.0, -60.0, 10.0, 90.0, 100.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 40.0, 200.0, 30.0, 10.0, 30.0, 130.0, -200.0, 150.0, 20.0, 15.0, 0.0, 20.0, 160.0, 130.0, 30.0, 20.0, 30.0, 40.0, 10.0, 50.0, 40.0, 10.0, 170.0, 130.0, 130.0, 10.0, 80.0, 170.0, 50.0, 55.0, 50.0, 50.0, 200.0, 80.0, 80.0, 120.0, 180.0, 20.0, 150.0, 140.0, 50.0, 20.0, 510.0, 40.0, 20.0, 80.0, 100.0, 30.0, 20.0, 120.0, 40.0, 150.0, 50.0, 150.0, 50.0, 50.0, 30.0, 10.0, 160.0, 60.0, 260.0, -70.0, 10.0, 20.0, 0.0, 80.0, 30.0, 380.0, 310.0, 20.0, 250.0, 0.0, 30.0, 30.0, -5.0, 10.0, 60.0, 20.0, 0.0, 20.0, 60.0, 200.0, 180.0, 120.0, 150.0, 10.0, 50.0, 100.0, -30.0, 150.0, 40.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 170.0, 20.0, 160.0, 15.0, 60.0, 40.0, 40.0, 30.0, 20.0, 10.0, -15.0, 40.0, 40.0, 30.0, 320.0, 110.0, 90.0, 60.0, 70.0, 50.0, 70.0, 40.0, 110.0, 70.0, 20.0, 50.0, 10.0, 40.0, 0.0, 0.0, 50.0, 30.0, 20.0, 25.0, 20.0, 40.0, 30.0, 0.0, 20.0, 70.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, 50.0, 90.0, 20.0, 210.0, 30.0, 60.0, 560.0, -50.0, 40.0, 10.0, 110.0, 300.0, 70.0, 90.0, 40.0, 160.0, 290.0, 110.0, 80.0, 50.0, 260.0, 330.0, 20.0, 40.0, -30.0, 140.0, 80.0, -10.0, 40.0, 20.0, 10.0, 180.0, 0.0, 30.0, 50.0, 20.0, 20.0, 30.0, 250.0, 10.0, 30.0, 40.0, 40.0, 70.0, 40.0, 10.0, 50.0, 0.0, 0.0, 10.0, 200.0, 10.0, 110.0, 10.0, 60.0, 30.0, 10.0, 30.0, 165.0, 140.0, 370.0, 20.0, 40.0, 40.0, 20.0, 0.0, 110.0, 80.0, 110.0, 170.0, 260.0, 150.0, 110.0, 320.0, 20.0, 570.0, 20.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 70.0, 70.0, 40.0, 150.0, 10.0, 60.0, 80.0, 150.0, 450.0, 10.0, 20.0, 10.0, 40.0, 370.0, -30.0, 30.0, 200.0, 80.0, 0.0, 260.0, 0.0, 90.0, 80.0, 30.0, 40.0, 0.0, 320.0, 30.0, 90.0, 60.0, 80.0, 30.0, 35.0, 200.0, 10.0, 90.0, 5.0, 130.0, 320.0, 45.0, 180.0, -10.0, 100.0, 40.0, 10.0, 190.0, 100.0, 20.0, 10.0, 40.0, 30.0, 0.0, 10.0, 50.0, 20.0, 40.0, 45.0, 200.0, 80.0, 120.0, 250.0, 60.0, 600.0, 50.0, 50.0, 30.0, 80.0, 40.0, 70.0, 20.0, 50.0, 160.0, 30.0, 0.0, 160.0, 310.0, 110.0, 30.0, 30.0, 170.0, 0.0, 40.0, 0.0, 30.0, 220.0, 250.0, 250.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5449750699849187, "mean_inference_ms": 1.4104676793890576, "mean_action_processing_ms": 0.43256634088125023, "mean_env_wait_ms": 1.2605295448103417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012153387069702148, "StateBufferConnector_ms": 0.009671449661254883, "ViewRequirementAgentConnector_ms": 0.375154972076416}, "num_episodes": 18, "episode_return_max": 1615.0, "episode_return_min": 120.0, "episode_return_mean": 748.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.574249378459175, "num_env_steps_trained_throughput_per_sec": 21.574249378459175, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 1960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1960000, "timers": {"training_iteration_time_ms": 186730.016, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186729.968, "sample_time_ms": 2416.902, "learn_time_ms": 184292.566, "learn_throughput": 21.705, "synch_weights_time_ms": 12.241}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "done": false, "training_iteration": 49, "trial_id": "90816_00000", "date": "2024-06-10_02-46-29", "timestamp": 1718001989, "time_this_iter_s": 185.41443586349487, "time_total_s": 9267.775626420975, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f24a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9267.775626420975, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 16.969847328244278, "ram_util_percent": 79.00877862595419}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2446719080368425, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.100661452408162, "policy_loss": -0.00873737666652765, "vf_loss": 6.107989198331254, "vf_explained_var": 0.0004865554448006887, "kl": 0.007048121699267511, "entropy": 0.6433315951412859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 464805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 1540.0, "episode_reward_min": 140.0, "episode_reward_mean": 718.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -280.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 71.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [660.0, 1245.0, 755.0, 690.0, 515.0, 1170.0, 1115.0, 680.0, 255.0, 680.0, 350.0, 670.0, 455.0, 1060.0, 340.0, 320.0, 890.0, 850.0, 1120.0, 265.0, 490.0, 1290.0, 385.0, 725.0, 680.0, 1110.0, 415.0, 1035.0, 525.0, 685.0, 1265.0, 840.0, 530.0, 265.0, 630.0, 1000.0, 450.0, 880.0, 405.0, 290.0, 435.0, 940.0, 370.0, 455.0, 625.0, 300.0, 1105.0, 1240.0, 470.0, 320.0, 385.0, 530.0, 855.0, 1070.0, 980.0, 970.0, 1030.0, 225.0, 970.0, 430.0, 295.0, 990.0, 245.0, 210.0, 140.0, 1020.0, 1300.0, 890.0, 600.0, 290.0, 765.0, 960.0, 1540.0, 550.0, 1250.0, 900.0, 630.0, 1105.0, 265.0, 1520.0, 950.0, 1020.0, 1220.0, 920.0, 1070.0, 160.0, 1150.0, 425.0, 900.0, 680.0, 590.0, 650.0, 640.0, 640.0, 935.0, 545.0, 460.0, 830.0, 565.0, 330.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 30.0, 10.0, 20.0, 70.0, 40.0, 360.0, 70.0, 0.0, 130.0, 285.0, 110.0, -60.0, 50.0, 60.0, 190.0, 200.0, 230.0, 50.0, 40.0, 195.0, 110.0, 0.0, 110.0, 110.0, 90.0, 60.0, 20.0, 20.0, 130.0, 110.0, 30.0, 70.0, 120.0, 30.0, 40.0, 40.0, 80.0, 40.0, 190.0, 60.0, 20.0, 10.0, 70.0, 30.0, 15.0, 20.0, 80.0, 20.0, 260.0, 120.0, 180.0, 110.0, 110.0, 10.0, 150.0, 80.0, 110.0, 40.0, 40.0, 410.0, 10.0, 160.0, -20.0, 15.0, 80.0, 0.0, 340.0, 80.0, 190.0, 70.0, 60.0, 10.0, 0.0, 60.0, 80.0, 70.0, 80.0, 60.0, 40.0, 10.0, 10.0, 40.0, 20.0, 40.0, 0.0, 0.0, 15.0, 80.0, 40.0, 140.0, 70.0, 200.0, 70.0, 50.0, 10.0, 40.0, 20.0, 40.0, -50.0, 40.0, 20.0, 80.0, 90.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 40.0, 20.0, 0.0, 260.0, 60.0, 20.0, 20.0, 50.0, 180.0, 0.0, 70.0, 380.0, 100.0, 20.0, -5.0, 70.0, -140.0, -80.0, 40.0, 80.0, 90.0, 140.0, 280.0, 190.0, -100.0, 70.0, 160.0, 60.0, 90.0, 0.0, 50.0, 20.0, 40.0, 0.0, 30.0, 20.0, 130.0, 0.0, 50.0, 100.0, 10.0, 40.0, 40.0, 20.0, 30.0, 0.0, 10.0, 40.0, 30.0, 30.0, 150.0, 40.0, 70.0, 20.0, 380.0, 70.0, 40.0, 70.0, 20.0, 190.0, 50.0, 180.0, 90.0, 30.0, 10.0, 130.0, 20.0, 120.0, 30.0, -10.0, 120.0, 50.0, 20.0, 100.0, 410.0, 20.0, 360.0, 30.0, 20.0, 20.0, 35.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 90.0, 10.0, 10.0, 80.0, 50.0, 0.0, 120.0, 170.0, 20.0, 10.0, 20.0, 480.0, 50.0, 150.0, 20.0, 90.0, 20.0, 100.0, 310.0, 40.0, 30.0, 10.0, 0.0, 65.0, 20.0, 120.0, 70.0, 10.0, 20.0, 60.0, 10.0, 70.0, 30.0, 160.0, 220.0, 30.0, -45.0, 90.0, 70.0, 10.0, 90.0, 100.0, 230.0, 20.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 30.0, 20.0, 190.0, 140.0, 100.0, 40.0, 0.0, 350.0, 120.0, 150.0, 0.0, 35.0, 70.0, 80.0, 30.0, 10.0, 60.0, 0.0, 50.0, 40.0, 40.0, -5.0, 150.0, 120.0, 120.0, 70.0, 460.0, 0.0, 40.0, 40.0, 40.0, 30.0, 0.0, 80.0, 30.0, 80.0, 65.0, 10.0, 80.0, 110.0, 40.0, 10.0, 30.0, 35.0, 60.0, 20.0, 0.0, 330.0, 60.0, 130.0, 10.0, 80.0, 50.0, 10.0, 140.0, 20.0, 280.0, 40.0, 560.0, 60.0, 25.0, 20.0, 30.0, 140.0, 0.0, 150.0, -20.0, 80.0, 110.0, 320.0, 10.0, 10.0, 0.0, 20.0, 20.0, 160.0, 10.0, 30.0, 0.0, 110.0, 170.0, 70.0, 20.0, 25.0, 0.0, 40.0, 40.0, 10.0, 20.0, 0.0, 40.0, 70.0, 20.0, 20.0, 140.0, 30.0, 150.0, 30.0, 20.0, 80.0, 70.0, 30.0, 130.0, 190.0, 220.0, 90.0, 40.0, 40.0, 170.0, 0.0, 90.0, 170.0, 0.0, 20.0, 100.0, 10.0, 40.0, 40.0, 40.0, 20.0, 10.0, 30.0, 70.0, 230.0, 70.0, 290.0, 30.0, 160.0, -70.0, 30.0, 40.0, 70.0, 10.0, 10.0, 20.0, 0.0, 200.0, 0.0, 5.0, 20.0, 70.0, 20.0, 10.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 10.0, 30.0, 20.0, 130.0, 30.0, 60.0, 20.0, 15.0, 80.0, 10.0, 40.0, 30.0, 50.0, 90.0, 160.0, 190.0, 10.0, 30.0, 90.0, 100.0, 160.0, 60.0, 20.0, 0.0, 160.0, 0.0, 10.0, 50.0, 30.0, 30.0, 50.0, 20.0, 80.0, 15.0, 20.0, 0.0, 0.0, 90.0, 30.0, 30.0, 150.0, 40.0, 310.0, 60.0, 30.0, -50.0, 260.0, 30.0, 20.0, -85.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 30.0, 40.0, 70.0, 40.0, 0.0, 320.0, -10.0, 35.0, -20.0, 170.0, 80.0, 160.0, 60.0, 130.0, 180.0, 60.0, 170.0, 210.0, 60.0, 30.0, 30.0, 30.0, 250.0, 130.0, 270.0, 200.0, -10.0, 40.0, 40.0, 130.0, 40.0, -10.0, -60.0, 10.0, 90.0, 100.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 40.0, 200.0, 30.0, 10.0, 30.0, 130.0, -200.0, 150.0, 20.0, 15.0, 0.0, 20.0, 160.0, 130.0, 30.0, 20.0, 30.0, 40.0, 10.0, 50.0, 40.0, 10.0, 170.0, 130.0, 130.0, 10.0, 80.0, 170.0, 50.0, 55.0, 50.0, 50.0, 200.0, 80.0, 80.0, 120.0, 180.0, 20.0, 150.0, 140.0, 50.0, 20.0, 510.0, 40.0, 20.0, 80.0, 100.0, 30.0, 20.0, 120.0, 40.0, 150.0, 50.0, 150.0, 50.0, 50.0, 30.0, 10.0, 160.0, 60.0, 260.0, -70.0, 10.0, 20.0, 0.0, 80.0, 30.0, 380.0, 310.0, 20.0, 250.0, 0.0, 30.0, 30.0, -5.0, 10.0, 60.0, 20.0, 0.0, 20.0, 60.0, 200.0, 180.0, 120.0, 150.0, 10.0, 50.0, 100.0, -30.0, 150.0, 40.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 170.0, 20.0, 160.0, 15.0, 60.0, 40.0, 40.0, 30.0, 20.0, 10.0, -15.0, 40.0, 40.0, 30.0, 320.0, 110.0, 90.0, 60.0, 70.0, 50.0, 70.0, 40.0, 110.0, 70.0, 20.0, 50.0, 10.0, 40.0, 0.0, 0.0, 50.0, 30.0, 20.0, 25.0, 20.0, 40.0, 30.0, 0.0, 20.0, 70.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, 50.0, 90.0, 20.0, 210.0, 30.0, 60.0, 560.0, -50.0, 40.0, 10.0, 110.0, 300.0, 70.0, 90.0, 40.0, 160.0, 290.0, 110.0, 80.0, 50.0, 260.0, 330.0, 20.0, 40.0, -30.0, 140.0, 80.0, -10.0, 40.0, 20.0, 10.0, 180.0, 0.0, 30.0, 50.0, 20.0, 20.0, 30.0, 250.0, 10.0, 30.0, 40.0, 40.0, 70.0, 40.0, 10.0, 50.0, 0.0, 0.0, 10.0, 200.0, 10.0, 110.0, 10.0, 60.0, 30.0, 10.0, 30.0, 165.0, 140.0, 370.0, 20.0, 40.0, 40.0, 20.0, 0.0, 110.0, 80.0, 110.0, 170.0, 260.0, 150.0, 110.0, 320.0, 20.0, 570.0, 20.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 70.0, 70.0, 40.0, 150.0, 10.0, 60.0, 80.0, 150.0, 450.0, 10.0, 20.0, 10.0, 40.0, 370.0, -30.0, 30.0, 200.0, 80.0, 0.0, 260.0, 0.0, 90.0, 80.0, 30.0, 40.0, 0.0, 320.0, 30.0, 90.0, 60.0, 80.0, 30.0, 35.0, 200.0, 10.0, 90.0, 5.0, 130.0, 320.0, 45.0, 180.0, -10.0, 100.0, 40.0, 10.0, 190.0, 100.0, 20.0, 10.0, 40.0, 30.0, 0.0, 10.0, 50.0, 20.0, 40.0, 45.0, 200.0, 80.0, 120.0, 250.0, 60.0, 600.0, 50.0, 50.0, 30.0, 80.0, 40.0, 70.0, 20.0, 50.0, 160.0, 30.0, 0.0, 160.0, 310.0, 110.0, 30.0, 30.0, 170.0, 0.0, 40.0, 0.0, 30.0, 220.0, 250.0, 250.0, 70.0, 100.0, 60.0, 380.0, 10.0, 120.0, 220.0, 230.0, -20.0, 50.0, 420.0, 10.0, 20.0, 100.0, 20.0, 20.0, 40.0, 20.0, 250.0, 20.0, -280.0, 180.0, 50.0, 60.0, 220.0, 190.0, 200.0, 180.0, 190.0, 80.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 90.0, 20.0, 60.0, 50.0, 30.0, 20.0, 520.0, 150.0, 170.0, 10.0, 70.0, 50.0, 0.0, 60.0, 10.0, 0.0, 175.0, 70.0, -20.0, 50.0, 100.0, 100.0, 20.0, 140.0, 40.0, 50.0, 180.0, 210.0, 10.0, 0.0, 40.0, 120.0, 50.0, 40.0, 40.0, 300.0, 0.0, 40.0, 50.0, 90.0, 30.0, 90.0, 80.0, 120.0, 30.0, 120.0, 0.0, 0.0, 30.0, 30.0, 60.0, 60.0, 70.0, 40.0, 0.0, 50.0, 90.0, 230.0, 20.0, 50.0, 90.0, -20.0, -10.0, 570.0, -50.0, 70.0, -90.0, 70.0, -40.0, 300.0, 0.0, 0.0, 20.0, 160.0, 0.0, 160.0, 40.0, -60.0, 20.0, 120.0, 30.0, 40.0, 0.0, 80.0, 340.0, 40.0, 10.0, 230.0, 45.0, 60.0, 10.0, 45.0, 50.0, 10.0, 210.0, -60.0, 10.0, 180.0, 30.0, 20.0, 10.0, 10.0, 30.0, 20.0, 220.0, 30.0, 0.0, 60.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, 50.0, 60.0, 290.0, -10.0, 80.0, 30.0, 0.0, 90.0, 20.0, 40.0, 190.0, 40.0, 80.0, 20.0, 55.0, 10.0, 50.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 70.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5439292586191784, "mean_inference_ms": 1.4111070523535827, "mean_action_processing_ms": 0.43197196535646937, "mean_env_wait_ms": 1.2608108373341118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012239694595336914, "StateBufferConnector_ms": 0.009786128997802734, "ViewRequirementAgentConnector_ms": 0.3794975280761719}, "num_episodes": 18, "episode_return_max": 1540.0, "episode_return_min": 140.0, "episode_return_mean": 718.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.30112979499151, "num_env_steps_trained_throughput_per_sec": 21.30112979499151, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 186788.248, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186788.198, "sample_time_ms": 2464.016, "learn_time_ms": 184303.926, "learn_throughput": 21.703, "synch_weights_time_ms": 11.884}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 50, "trial_id": "90816_00000", "date": "2024-06-10_02-49-37", "timestamp": 1718002177, "time_this_iter_s": 187.79309701919556, "time_total_s": 9455.56872344017, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00401f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9455.56872344017, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.08796992481203, "ram_util_percent": 79.23458646616542}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5318106761501746, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.45269724720964, "policy_loss": -0.009534005553231507, "vf_loss": 6.4608182804018295, "vf_explained_var": 0.0019527886876156027, "kl": 0.007064870248762622, "entropy": 0.6132242738756255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 474195.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 1540.0, "episode_reward_min": 140.0, "episode_reward_mean": 726.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -280.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 72.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1120.0, 265.0, 490.0, 1290.0, 385.0, 725.0, 680.0, 1110.0, 415.0, 1035.0, 525.0, 685.0, 1265.0, 840.0, 530.0, 265.0, 630.0, 1000.0, 450.0, 880.0, 405.0, 290.0, 435.0, 940.0, 370.0, 455.0, 625.0, 300.0, 1105.0, 1240.0, 470.0, 320.0, 385.0, 530.0, 855.0, 1070.0, 980.0, 970.0, 1030.0, 225.0, 970.0, 430.0, 295.0, 990.0, 245.0, 210.0, 140.0, 1020.0, 1300.0, 890.0, 600.0, 290.0, 765.0, 960.0, 1540.0, 550.0, 1250.0, 900.0, 630.0, 1105.0, 265.0, 1520.0, 950.0, 1020.0, 1220.0, 920.0, 1070.0, 160.0, 1150.0, 425.0, 900.0, 680.0, 590.0, 650.0, 640.0, 640.0, 935.0, 545.0, 460.0, 830.0, 565.0, 330.0, 300.0, 990.0, 810.0, 1110.0, 465.0, 640.0, 590.0, 830.0, 790.0, 1150.0, 820.0, 870.0, 645.0, 620.0, 390.0, 605.0, 1220.0, 675.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-10.0, 120.0, 50.0, 20.0, 100.0, 410.0, 20.0, 360.0, 30.0, 20.0, 20.0, 35.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 90.0, 10.0, 10.0, 80.0, 50.0, 0.0, 120.0, 170.0, 20.0, 10.0, 20.0, 480.0, 50.0, 150.0, 20.0, 90.0, 20.0, 100.0, 310.0, 40.0, 30.0, 10.0, 0.0, 65.0, 20.0, 120.0, 70.0, 10.0, 20.0, 60.0, 10.0, 70.0, 30.0, 160.0, 220.0, 30.0, -45.0, 90.0, 70.0, 10.0, 90.0, 100.0, 230.0, 20.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 30.0, 20.0, 190.0, 140.0, 100.0, 40.0, 0.0, 350.0, 120.0, 150.0, 0.0, 35.0, 70.0, 80.0, 30.0, 10.0, 60.0, 0.0, 50.0, 40.0, 40.0, -5.0, 150.0, 120.0, 120.0, 70.0, 460.0, 0.0, 40.0, 40.0, 40.0, 30.0, 0.0, 80.0, 30.0, 80.0, 65.0, 10.0, 80.0, 110.0, 40.0, 10.0, 30.0, 35.0, 60.0, 20.0, 0.0, 330.0, 60.0, 130.0, 10.0, 80.0, 50.0, 10.0, 140.0, 20.0, 280.0, 40.0, 560.0, 60.0, 25.0, 20.0, 30.0, 140.0, 0.0, 150.0, -20.0, 80.0, 110.0, 320.0, 10.0, 10.0, 0.0, 20.0, 20.0, 160.0, 10.0, 30.0, 0.0, 110.0, 170.0, 70.0, 20.0, 25.0, 0.0, 40.0, 40.0, 10.0, 20.0, 0.0, 40.0, 70.0, 20.0, 20.0, 140.0, 30.0, 150.0, 30.0, 20.0, 80.0, 70.0, 30.0, 130.0, 190.0, 220.0, 90.0, 40.0, 40.0, 170.0, 0.0, 90.0, 170.0, 0.0, 20.0, 100.0, 10.0, 40.0, 40.0, 40.0, 20.0, 10.0, 30.0, 70.0, 230.0, 70.0, 290.0, 30.0, 160.0, -70.0, 30.0, 40.0, 70.0, 10.0, 10.0, 20.0, 0.0, 200.0, 0.0, 5.0, 20.0, 70.0, 20.0, 10.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 10.0, 30.0, 20.0, 130.0, 30.0, 60.0, 20.0, 15.0, 80.0, 10.0, 40.0, 30.0, 50.0, 90.0, 160.0, 190.0, 10.0, 30.0, 90.0, 100.0, 160.0, 60.0, 20.0, 0.0, 160.0, 0.0, 10.0, 50.0, 30.0, 30.0, 50.0, 20.0, 80.0, 15.0, 20.0, 0.0, 0.0, 90.0, 30.0, 30.0, 150.0, 40.0, 310.0, 60.0, 30.0, -50.0, 260.0, 30.0, 20.0, -85.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 30.0, 40.0, 70.0, 40.0, 0.0, 320.0, -10.0, 35.0, -20.0, 170.0, 80.0, 160.0, 60.0, 130.0, 180.0, 60.0, 170.0, 210.0, 60.0, 30.0, 30.0, 30.0, 250.0, 130.0, 270.0, 200.0, -10.0, 40.0, 40.0, 130.0, 40.0, -10.0, -60.0, 10.0, 90.0, 100.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 40.0, 200.0, 30.0, 10.0, 30.0, 130.0, -200.0, 150.0, 20.0, 15.0, 0.0, 20.0, 160.0, 130.0, 30.0, 20.0, 30.0, 40.0, 10.0, 50.0, 40.0, 10.0, 170.0, 130.0, 130.0, 10.0, 80.0, 170.0, 50.0, 55.0, 50.0, 50.0, 200.0, 80.0, 80.0, 120.0, 180.0, 20.0, 150.0, 140.0, 50.0, 20.0, 510.0, 40.0, 20.0, 80.0, 100.0, 30.0, 20.0, 120.0, 40.0, 150.0, 50.0, 150.0, 50.0, 50.0, 30.0, 10.0, 160.0, 60.0, 260.0, -70.0, 10.0, 20.0, 0.0, 80.0, 30.0, 380.0, 310.0, 20.0, 250.0, 0.0, 30.0, 30.0, -5.0, 10.0, 60.0, 20.0, 0.0, 20.0, 60.0, 200.0, 180.0, 120.0, 150.0, 10.0, 50.0, 100.0, -30.0, 150.0, 40.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 170.0, 20.0, 160.0, 15.0, 60.0, 40.0, 40.0, 30.0, 20.0, 10.0, -15.0, 40.0, 40.0, 30.0, 320.0, 110.0, 90.0, 60.0, 70.0, 50.0, 70.0, 40.0, 110.0, 70.0, 20.0, 50.0, 10.0, 40.0, 0.0, 0.0, 50.0, 30.0, 20.0, 25.0, 20.0, 40.0, 30.0, 0.0, 20.0, 70.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, 50.0, 90.0, 20.0, 210.0, 30.0, 60.0, 560.0, -50.0, 40.0, 10.0, 110.0, 300.0, 70.0, 90.0, 40.0, 160.0, 290.0, 110.0, 80.0, 50.0, 260.0, 330.0, 20.0, 40.0, -30.0, 140.0, 80.0, -10.0, 40.0, 20.0, 10.0, 180.0, 0.0, 30.0, 50.0, 20.0, 20.0, 30.0, 250.0, 10.0, 30.0, 40.0, 40.0, 70.0, 40.0, 10.0, 50.0, 0.0, 0.0, 10.0, 200.0, 10.0, 110.0, 10.0, 60.0, 30.0, 10.0, 30.0, 165.0, 140.0, 370.0, 20.0, 40.0, 40.0, 20.0, 0.0, 110.0, 80.0, 110.0, 170.0, 260.0, 150.0, 110.0, 320.0, 20.0, 570.0, 20.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 70.0, 70.0, 40.0, 150.0, 10.0, 60.0, 80.0, 150.0, 450.0, 10.0, 20.0, 10.0, 40.0, 370.0, -30.0, 30.0, 200.0, 80.0, 0.0, 260.0, 0.0, 90.0, 80.0, 30.0, 40.0, 0.0, 320.0, 30.0, 90.0, 60.0, 80.0, 30.0, 35.0, 200.0, 10.0, 90.0, 5.0, 130.0, 320.0, 45.0, 180.0, -10.0, 100.0, 40.0, 10.0, 190.0, 100.0, 20.0, 10.0, 40.0, 30.0, 0.0, 10.0, 50.0, 20.0, 40.0, 45.0, 200.0, 80.0, 120.0, 250.0, 60.0, 600.0, 50.0, 50.0, 30.0, 80.0, 40.0, 70.0, 20.0, 50.0, 160.0, 30.0, 0.0, 160.0, 310.0, 110.0, 30.0, 30.0, 170.0, 0.0, 40.0, 0.0, 30.0, 220.0, 250.0, 250.0, 70.0, 100.0, 60.0, 380.0, 10.0, 120.0, 220.0, 230.0, -20.0, 50.0, 420.0, 10.0, 20.0, 100.0, 20.0, 20.0, 40.0, 20.0, 250.0, 20.0, -280.0, 180.0, 50.0, 60.0, 220.0, 190.0, 200.0, 180.0, 190.0, 80.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 90.0, 20.0, 60.0, 50.0, 30.0, 20.0, 520.0, 150.0, 170.0, 10.0, 70.0, 50.0, 0.0, 60.0, 10.0, 0.0, 175.0, 70.0, -20.0, 50.0, 100.0, 100.0, 20.0, 140.0, 40.0, 50.0, 180.0, 210.0, 10.0, 0.0, 40.0, 120.0, 50.0, 40.0, 40.0, 300.0, 0.0, 40.0, 50.0, 90.0, 30.0, 90.0, 80.0, 120.0, 30.0, 120.0, 0.0, 0.0, 30.0, 30.0, 60.0, 60.0, 70.0, 40.0, 0.0, 50.0, 90.0, 230.0, 20.0, 50.0, 90.0, -20.0, -10.0, 570.0, -50.0, 70.0, -90.0, 70.0, -40.0, 300.0, 0.0, 0.0, 20.0, 160.0, 0.0, 160.0, 40.0, -60.0, 20.0, 120.0, 30.0, 40.0, 0.0, 80.0, 340.0, 40.0, 10.0, 230.0, 45.0, 60.0, 10.0, 45.0, 50.0, 10.0, 210.0, -60.0, 10.0, 180.0, 30.0, 20.0, 10.0, 10.0, 30.0, 20.0, 220.0, 30.0, 0.0, 60.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, 50.0, 60.0, 290.0, -10.0, 80.0, 30.0, 0.0, 90.0, 20.0, 40.0, 190.0, 40.0, 80.0, 20.0, 55.0, 10.0, 50.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 70.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 150.0, 20.0, 60.0, 80.0, -40.0, 190.0, 380.0, 70.0, 160.0, 0.0, 80.0, 10.0, 130.0, 50.0, 60.0, 160.0, -10.0, 40.0, 480.0, -170.0, -20.0, 90.0, 20.0, 60.0, 100.0, 40.0, 120.0, 60.0, 340.0, 200.0, 160.0, 10.0, 70.0, 20.0, 20.0, 40.0, 150.0, 10.0, 110.0, 20.0, 10.0, 15.0, 170.0, 30.0, -60.0, 90.0, 10.0, 190.0, 40.0, -80.0, 220.0, 30.0, 70.0, 40.0, 30.0, 20.0, 90.0, 0.0, 90.0, 80.0, 160.0, 10.0, 20.0, 110.0, 20.0, 70.0, 350.0, 40.0, -10.0, 40.0, 40.0, 150.0, 10.0, 100.0, 0.0, 30.0, 70.0, 150.0, 170.0, 120.0, 140.0, 0.0, 70.0, 110.0, 110.0, 90.0, 60.0, 50.0, 490.0, 60.0, 70.0, 40.0, 30.0, 80.0, 30.0, 0.0, 280.0, 20.0, 30.0, 50.0, 40.0, 260.0, 0.0, 60.0, 10.0, 210.0, 130.0, 30.0, 50.0, 210.0, 160.0, 10.0, 10.0, 160.0, 40.0, 5.0, 10.0, 10.0, 240.0, 20.0, 110.0, 40.0, 30.0, 30.0, 200.0, 50.0, 30.0, 20.0, 30.0, 50.0, 150.0, 30.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 40.0, 60.0, 90.0, 40.0, 20.0, 10.0, 230.0, 25.0, 40.0, 80.0, 60.0, 20.0, 100.0, 20.0, 10.0, 110.0, 10.0, 40.0, 80.0, 380.0, 190.0, 20.0, 40.0, 340.0, 170.0, 300.0, 20.0, 60.0, 40.0, 70.0, 10.0, 45.0, -50.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5427687652549642, "mean_inference_ms": 1.411785926191161, "mean_action_processing_ms": 0.43144050953452784, "mean_env_wait_ms": 1.2611919463758345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012250185012817383, "StateBufferConnector_ms": 0.009569168090820312, "ViewRequirementAgentConnector_ms": 0.37741780281066895}, "num_episodes": 18, "episode_return_max": 1540.0, "episode_return_min": 140.0, "episode_return_mean": 726.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.427697930740813, "num_env_steps_trained_throughput_per_sec": 21.427697930740813, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 186660.377, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186660.325, "sample_time_ms": 2448.942, "learn_time_ms": 184190.872, "learn_throughput": 21.717, "synch_weights_time_ms": 12.045}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 51, "trial_id": "90816_00000", "date": "2024-06-10_02-52-44", "timestamp": 1718002364, "time_this_iter_s": 186.68492794036865, "time_total_s": 9642.253651380539, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f34790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9642.253651380539, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.46742424242424, "ram_util_percent": 79.45189393939394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.550612527132034, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.750140728356358, "policy_loss": -0.008713799161381259, "vf_loss": 6.75744664859467, "vf_explained_var": 0.00034944729302257015, "kl": 0.007039399769250757, "entropy": 0.5984433521922277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 483585.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 1540.0, "episode_reward_min": 140.0, "episode_reward_mean": 750.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -280.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 75.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [435.0, 940.0, 370.0, 455.0, 625.0, 300.0, 1105.0, 1240.0, 470.0, 320.0, 385.0, 530.0, 855.0, 1070.0, 980.0, 970.0, 1030.0, 225.0, 970.0, 430.0, 295.0, 990.0, 245.0, 210.0, 140.0, 1020.0, 1300.0, 890.0, 600.0, 290.0, 765.0, 960.0, 1540.0, 550.0, 1250.0, 900.0, 630.0, 1105.0, 265.0, 1520.0, 950.0, 1020.0, 1220.0, 920.0, 1070.0, 160.0, 1150.0, 425.0, 900.0, 680.0, 590.0, 650.0, 640.0, 640.0, 935.0, 545.0, 460.0, 830.0, 565.0, 330.0, 300.0, 990.0, 810.0, 1110.0, 465.0, 640.0, 590.0, 830.0, 790.0, 1150.0, 820.0, 870.0, 645.0, 620.0, 390.0, 605.0, 1220.0, 675.0, 860.0, 1440.0, 610.0, 475.0, 610.0, 670.0, 1250.0, 960.0, 500.0, 580.0, 740.0, 320.0, 320.0, 1390.0, 1000.0, 930.0, 485.0, 1080.0, 805.0, 965.0, 890.0, 840.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 130.0, 30.0, 60.0, 20.0, 15.0, 80.0, 10.0, 40.0, 30.0, 50.0, 90.0, 160.0, 190.0, 10.0, 30.0, 90.0, 100.0, 160.0, 60.0, 20.0, 0.0, 160.0, 0.0, 10.0, 50.0, 30.0, 30.0, 50.0, 20.0, 80.0, 15.0, 20.0, 0.0, 0.0, 90.0, 30.0, 30.0, 150.0, 40.0, 310.0, 60.0, 30.0, -50.0, 260.0, 30.0, 20.0, -85.0, 30.0, 20.0, 30.0, 20.0, 20.0, 20.0, 30.0, 30.0, 40.0, 70.0, 40.0, 0.0, 320.0, -10.0, 35.0, -20.0, 170.0, 80.0, 160.0, 60.0, 130.0, 180.0, 60.0, 170.0, 210.0, 60.0, 30.0, 30.0, 30.0, 250.0, 130.0, 270.0, 200.0, -10.0, 40.0, 40.0, 130.0, 40.0, -10.0, -60.0, 10.0, 90.0, 100.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 40.0, 200.0, 30.0, 10.0, 30.0, 130.0, -200.0, 150.0, 20.0, 15.0, 0.0, 20.0, 160.0, 130.0, 30.0, 20.0, 30.0, 40.0, 10.0, 50.0, 40.0, 10.0, 170.0, 130.0, 130.0, 10.0, 80.0, 170.0, 50.0, 55.0, 50.0, 50.0, 200.0, 80.0, 80.0, 120.0, 180.0, 20.0, 150.0, 140.0, 50.0, 20.0, 510.0, 40.0, 20.0, 80.0, 100.0, 30.0, 20.0, 120.0, 40.0, 150.0, 50.0, 150.0, 50.0, 50.0, 30.0, 10.0, 160.0, 60.0, 260.0, -70.0, 10.0, 20.0, 0.0, 80.0, 30.0, 380.0, 310.0, 20.0, 250.0, 0.0, 30.0, 30.0, -5.0, 10.0, 60.0, 20.0, 0.0, 20.0, 60.0, 200.0, 180.0, 120.0, 150.0, 10.0, 50.0, 100.0, -30.0, 150.0, 40.0, 0.0, 5.0, 20.0, 10.0, 10.0, 20.0, 170.0, 20.0, 160.0, 15.0, 60.0, 40.0, 40.0, 30.0, 20.0, 10.0, -15.0, 40.0, 40.0, 30.0, 320.0, 110.0, 90.0, 60.0, 70.0, 50.0, 70.0, 40.0, 110.0, 70.0, 20.0, 50.0, 10.0, 40.0, 0.0, 0.0, 50.0, 30.0, 20.0, 25.0, 20.0, 40.0, 30.0, 0.0, 20.0, 70.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, 50.0, 90.0, 20.0, 210.0, 30.0, 60.0, 560.0, -50.0, 40.0, 10.0, 110.0, 300.0, 70.0, 90.0, 40.0, 160.0, 290.0, 110.0, 80.0, 50.0, 260.0, 330.0, 20.0, 40.0, -30.0, 140.0, 80.0, -10.0, 40.0, 20.0, 10.0, 180.0, 0.0, 30.0, 50.0, 20.0, 20.0, 30.0, 250.0, 10.0, 30.0, 40.0, 40.0, 70.0, 40.0, 10.0, 50.0, 0.0, 0.0, 10.0, 200.0, 10.0, 110.0, 10.0, 60.0, 30.0, 10.0, 30.0, 165.0, 140.0, 370.0, 20.0, 40.0, 40.0, 20.0, 0.0, 110.0, 80.0, 110.0, 170.0, 260.0, 150.0, 110.0, 320.0, 20.0, 570.0, 20.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 70.0, 70.0, 40.0, 150.0, 10.0, 60.0, 80.0, 150.0, 450.0, 10.0, 20.0, 10.0, 40.0, 370.0, -30.0, 30.0, 200.0, 80.0, 0.0, 260.0, 0.0, 90.0, 80.0, 30.0, 40.0, 0.0, 320.0, 30.0, 90.0, 60.0, 80.0, 30.0, 35.0, 200.0, 10.0, 90.0, 5.0, 130.0, 320.0, 45.0, 180.0, -10.0, 100.0, 40.0, 10.0, 190.0, 100.0, 20.0, 10.0, 40.0, 30.0, 0.0, 10.0, 50.0, 20.0, 40.0, 45.0, 200.0, 80.0, 120.0, 250.0, 60.0, 600.0, 50.0, 50.0, 30.0, 80.0, 40.0, 70.0, 20.0, 50.0, 160.0, 30.0, 0.0, 160.0, 310.0, 110.0, 30.0, 30.0, 170.0, 0.0, 40.0, 0.0, 30.0, 220.0, 250.0, 250.0, 70.0, 100.0, 60.0, 380.0, 10.0, 120.0, 220.0, 230.0, -20.0, 50.0, 420.0, 10.0, 20.0, 100.0, 20.0, 20.0, 40.0, 20.0, 250.0, 20.0, -280.0, 180.0, 50.0, 60.0, 220.0, 190.0, 200.0, 180.0, 190.0, 80.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 90.0, 20.0, 60.0, 50.0, 30.0, 20.0, 520.0, 150.0, 170.0, 10.0, 70.0, 50.0, 0.0, 60.0, 10.0, 0.0, 175.0, 70.0, -20.0, 50.0, 100.0, 100.0, 20.0, 140.0, 40.0, 50.0, 180.0, 210.0, 10.0, 0.0, 40.0, 120.0, 50.0, 40.0, 40.0, 300.0, 0.0, 40.0, 50.0, 90.0, 30.0, 90.0, 80.0, 120.0, 30.0, 120.0, 0.0, 0.0, 30.0, 30.0, 60.0, 60.0, 70.0, 40.0, 0.0, 50.0, 90.0, 230.0, 20.0, 50.0, 90.0, -20.0, -10.0, 570.0, -50.0, 70.0, -90.0, 70.0, -40.0, 300.0, 0.0, 0.0, 20.0, 160.0, 0.0, 160.0, 40.0, -60.0, 20.0, 120.0, 30.0, 40.0, 0.0, 80.0, 340.0, 40.0, 10.0, 230.0, 45.0, 60.0, 10.0, 45.0, 50.0, 10.0, 210.0, -60.0, 10.0, 180.0, 30.0, 20.0, 10.0, 10.0, 30.0, 20.0, 220.0, 30.0, 0.0, 60.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, 50.0, 60.0, 290.0, -10.0, 80.0, 30.0, 0.0, 90.0, 20.0, 40.0, 190.0, 40.0, 80.0, 20.0, 55.0, 10.0, 50.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 70.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 150.0, 20.0, 60.0, 80.0, -40.0, 190.0, 380.0, 70.0, 160.0, 0.0, 80.0, 10.0, 130.0, 50.0, 60.0, 160.0, -10.0, 40.0, 480.0, -170.0, -20.0, 90.0, 20.0, 60.0, 100.0, 40.0, 120.0, 60.0, 340.0, 200.0, 160.0, 10.0, 70.0, 20.0, 20.0, 40.0, 150.0, 10.0, 110.0, 20.0, 10.0, 15.0, 170.0, 30.0, -60.0, 90.0, 10.0, 190.0, 40.0, -80.0, 220.0, 30.0, 70.0, 40.0, 30.0, 20.0, 90.0, 0.0, 90.0, 80.0, 160.0, 10.0, 20.0, 110.0, 20.0, 70.0, 350.0, 40.0, -10.0, 40.0, 40.0, 150.0, 10.0, 100.0, 0.0, 30.0, 70.0, 150.0, 170.0, 120.0, 140.0, 0.0, 70.0, 110.0, 110.0, 90.0, 60.0, 50.0, 490.0, 60.0, 70.0, 40.0, 30.0, 80.0, 30.0, 0.0, 280.0, 20.0, 30.0, 50.0, 40.0, 260.0, 0.0, 60.0, 10.0, 210.0, 130.0, 30.0, 50.0, 210.0, 160.0, 10.0, 10.0, 160.0, 40.0, 5.0, 10.0, 10.0, 240.0, 20.0, 110.0, 40.0, 30.0, 30.0, 200.0, 50.0, 30.0, 20.0, 30.0, 50.0, 150.0, 30.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 40.0, 60.0, 90.0, 40.0, 20.0, 10.0, 230.0, 25.0, 40.0, 80.0, 60.0, 20.0, 100.0, 20.0, 10.0, 110.0, 10.0, 40.0, 80.0, 380.0, 190.0, 20.0, 40.0, 340.0, 170.0, 300.0, 20.0, 60.0, 40.0, 70.0, 10.0, 45.0, -50.0, 10.0, 20.0, 40.0, 110.0, 160.0, -50.0, 80.0, 370.0, 20.0, 60.0, 50.0, 390.0, 150.0, -60.0, 400.0, 110.0, 130.0, -40.0, 150.0, 20.0, 190.0, 40.0, 40.0, 70.0, 40.0, 200.0, 40.0, 40.0, 10.0, 50.0, 80.0, 30.0, 60.0, 30.0, 120.0, 15.0, 40.0, 0.0, 50.0, 0.0, 130.0, 30.0, 360.0, 20.0, 0.0, 10.0, 0.0, 80.0, 50.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 70.0, 50.0, 160.0, 70.0, 90.0, 90.0, 150.0, 70.0, 170.0, 80.0, 140.0, 10.0, 120.0, -10.0, 490.0, 30.0, 150.0, 50.0, 40.0, 180.0, 70.0, 30.0, 100.0, 90.0, 70.0, 180.0, 80.0, 70.0, 40.0, 30.0, 30.0, 60.0, 120.0, 30.0, 0.0, 40.0, 80.0, 90.0, 170.0, 0.0, -40.0, 10.0, -20.0, 50.0, -20.0, 260.0, 40.0, 460.0, 40.0, -40.0, 20.0, 110.0, 150.0, 60.0, -55.0, -45.0, 10.0, 70.0, 0.0, 20.0, 20.0, 20.0, 40.0, 40.0, 80.0, 20.0, 20.0, 10.0, 30.0, 0.0, 30.0, 60.0, 50.0, 70.0, 10.0, 40.0, 330.0, 80.0, 170.0, 20.0, 440.0, 50.0, 50.0, 110.0, 130.0, 10.0, 100.0, 0.0, 60.0, 20.0, 50.0, 70.0, 10.0, 270.0, 130.0, 290.0, 120.0, 150.0, 50.0, 25.0, 40.0, -175.0, 270.0, 90.0, 260.0, 100.0, 60.0, 20.0, 20.0, 60.0, 20.0, 60.0, 140.0, 45.0, 30.0, 30.0, 420.0, 40.0, 40.0, 60.0, 20.0, 250.0, 80.0, 60.0, 80.0, 30.0, 510.0, 40.0, 40.0, 110.0, 5.0, 60.0, 70.0, 10.0, -20.0, -20.0, 80.0, 70.0, 110.0, -15.0, 60.0, 240.0, 40.0, 60.0, 160.0, 160.0, 20.0, 190.0, 170.0, 40.0, 90.0, 0.0, 120.0, 50.0, 0.0, 210.0, 20.0, 150.0, 80.0, 100.0, 60.0, 110.0, 30.0, 220.0, 30.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5407787453146609, "mean_inference_ms": 1.4127010132581175, "mean_action_processing_ms": 0.43087303460624754, "mean_env_wait_ms": 1.2617802916140823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012244462966918945, "StateBufferConnector_ms": 0.009507894515991211, "ViewRequirementAgentConnector_ms": 0.37505125999450684}, "num_episodes": 22, "episode_return_max": 1540.0, "episode_return_min": 140.0, "episode_return_mean": 750.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.117445428239733, "num_env_steps_trained_throughput_per_sec": 21.117445428239733, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 186897.388, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186897.337, "sample_time_ms": 2449.343, "learn_time_ms": 184427.25, "learn_throughput": 21.689, "synch_weights_time_ms": 12.283}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 52, "trial_id": "90816_00000", "date": "2024-06-10_02-55-53", "timestamp": 1718002553, "time_this_iter_s": 189.43096899986267, "time_total_s": 9831.684620380402, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0040430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9831.684620380402, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 20.994029850746266, "ram_util_percent": 80.54440298507461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4173205026232014, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.441240638513535, "policy_loss": -0.00864214853731235, "vf_loss": 6.44846458155761, "vf_explained_var": 0.0005541354068678916, "kl": 0.00709100412864555, "entropy": 0.5893120683547153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 492975.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "env_runners": {"episode_reward_max": 1540.0, "episode_reward_min": 140.0, "episode_reward_mean": 798.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -280.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 79.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 140.0, 1020.0, 1300.0, 890.0, 600.0, 290.0, 765.0, 960.0, 1540.0, 550.0, 1250.0, 900.0, 630.0, 1105.0, 265.0, 1520.0, 950.0, 1020.0, 1220.0, 920.0, 1070.0, 160.0, 1150.0, 425.0, 900.0, 680.0, 590.0, 650.0, 640.0, 640.0, 935.0, 545.0, 460.0, 830.0, 565.0, 330.0, 300.0, 990.0, 810.0, 1110.0, 465.0, 640.0, 590.0, 830.0, 790.0, 1150.0, 820.0, 870.0, 645.0, 620.0, 390.0, 605.0, 1220.0, 675.0, 860.0, 1440.0, 610.0, 475.0, 610.0, 670.0, 1250.0, 960.0, 500.0, 580.0, 740.0, 320.0, 320.0, 1390.0, 1000.0, 930.0, 485.0, 1080.0, 805.0, 965.0, 890.0, 840.0, 670.0, 1020.0, 1150.0, 955.0, 800.0, 780.0, 1430.0, 800.0, 1270.0, 1505.0, 1180.0, 1070.0, 1040.0, 1000.0, 965.0, 840.0, 800.0, 430.0, 770.0, 200.0, 310.0, 500.0, 550.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 40.0, 30.0, 0.0, 20.0, 70.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 40.0, 10.0, 50.0, 90.0, 20.0, 210.0, 30.0, 60.0, 560.0, -50.0, 40.0, 10.0, 110.0, 300.0, 70.0, 90.0, 40.0, 160.0, 290.0, 110.0, 80.0, 50.0, 260.0, 330.0, 20.0, 40.0, -30.0, 140.0, 80.0, -10.0, 40.0, 20.0, 10.0, 180.0, 0.0, 30.0, 50.0, 20.0, 20.0, 30.0, 250.0, 10.0, 30.0, 40.0, 40.0, 70.0, 40.0, 10.0, 50.0, 0.0, 0.0, 10.0, 200.0, 10.0, 110.0, 10.0, 60.0, 30.0, 10.0, 30.0, 165.0, 140.0, 370.0, 20.0, 40.0, 40.0, 20.0, 0.0, 110.0, 80.0, 110.0, 170.0, 260.0, 150.0, 110.0, 320.0, 20.0, 570.0, 20.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 70.0, 70.0, 40.0, 150.0, 10.0, 60.0, 80.0, 150.0, 450.0, 10.0, 20.0, 10.0, 40.0, 370.0, -30.0, 30.0, 200.0, 80.0, 0.0, 260.0, 0.0, 90.0, 80.0, 30.0, 40.0, 0.0, 320.0, 30.0, 90.0, 60.0, 80.0, 30.0, 35.0, 200.0, 10.0, 90.0, 5.0, 130.0, 320.0, 45.0, 180.0, -10.0, 100.0, 40.0, 10.0, 190.0, 100.0, 20.0, 10.0, 40.0, 30.0, 0.0, 10.0, 50.0, 20.0, 40.0, 45.0, 200.0, 80.0, 120.0, 250.0, 60.0, 600.0, 50.0, 50.0, 30.0, 80.0, 40.0, 70.0, 20.0, 50.0, 160.0, 30.0, 0.0, 160.0, 310.0, 110.0, 30.0, 30.0, 170.0, 0.0, 40.0, 0.0, 30.0, 220.0, 250.0, 250.0, 70.0, 100.0, 60.0, 380.0, 10.0, 120.0, 220.0, 230.0, -20.0, 50.0, 420.0, 10.0, 20.0, 100.0, 20.0, 20.0, 40.0, 20.0, 250.0, 20.0, -280.0, 180.0, 50.0, 60.0, 220.0, 190.0, 200.0, 180.0, 190.0, 80.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 90.0, 20.0, 60.0, 50.0, 30.0, 20.0, 520.0, 150.0, 170.0, 10.0, 70.0, 50.0, 0.0, 60.0, 10.0, 0.0, 175.0, 70.0, -20.0, 50.0, 100.0, 100.0, 20.0, 140.0, 40.0, 50.0, 180.0, 210.0, 10.0, 0.0, 40.0, 120.0, 50.0, 40.0, 40.0, 300.0, 0.0, 40.0, 50.0, 90.0, 30.0, 90.0, 80.0, 120.0, 30.0, 120.0, 0.0, 0.0, 30.0, 30.0, 60.0, 60.0, 70.0, 40.0, 0.0, 50.0, 90.0, 230.0, 20.0, 50.0, 90.0, -20.0, -10.0, 570.0, -50.0, 70.0, -90.0, 70.0, -40.0, 300.0, 0.0, 0.0, 20.0, 160.0, 0.0, 160.0, 40.0, -60.0, 20.0, 120.0, 30.0, 40.0, 0.0, 80.0, 340.0, 40.0, 10.0, 230.0, 45.0, 60.0, 10.0, 45.0, 50.0, 10.0, 210.0, -60.0, 10.0, 180.0, 30.0, 20.0, 10.0, 10.0, 30.0, 20.0, 220.0, 30.0, 0.0, 60.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, 50.0, 60.0, 290.0, -10.0, 80.0, 30.0, 0.0, 90.0, 20.0, 40.0, 190.0, 40.0, 80.0, 20.0, 55.0, 10.0, 50.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 70.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 150.0, 20.0, 60.0, 80.0, -40.0, 190.0, 380.0, 70.0, 160.0, 0.0, 80.0, 10.0, 130.0, 50.0, 60.0, 160.0, -10.0, 40.0, 480.0, -170.0, -20.0, 90.0, 20.0, 60.0, 100.0, 40.0, 120.0, 60.0, 340.0, 200.0, 160.0, 10.0, 70.0, 20.0, 20.0, 40.0, 150.0, 10.0, 110.0, 20.0, 10.0, 15.0, 170.0, 30.0, -60.0, 90.0, 10.0, 190.0, 40.0, -80.0, 220.0, 30.0, 70.0, 40.0, 30.0, 20.0, 90.0, 0.0, 90.0, 80.0, 160.0, 10.0, 20.0, 110.0, 20.0, 70.0, 350.0, 40.0, -10.0, 40.0, 40.0, 150.0, 10.0, 100.0, 0.0, 30.0, 70.0, 150.0, 170.0, 120.0, 140.0, 0.0, 70.0, 110.0, 110.0, 90.0, 60.0, 50.0, 490.0, 60.0, 70.0, 40.0, 30.0, 80.0, 30.0, 0.0, 280.0, 20.0, 30.0, 50.0, 40.0, 260.0, 0.0, 60.0, 10.0, 210.0, 130.0, 30.0, 50.0, 210.0, 160.0, 10.0, 10.0, 160.0, 40.0, 5.0, 10.0, 10.0, 240.0, 20.0, 110.0, 40.0, 30.0, 30.0, 200.0, 50.0, 30.0, 20.0, 30.0, 50.0, 150.0, 30.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 40.0, 60.0, 90.0, 40.0, 20.0, 10.0, 230.0, 25.0, 40.0, 80.0, 60.0, 20.0, 100.0, 20.0, 10.0, 110.0, 10.0, 40.0, 80.0, 380.0, 190.0, 20.0, 40.0, 340.0, 170.0, 300.0, 20.0, 60.0, 40.0, 70.0, 10.0, 45.0, -50.0, 10.0, 20.0, 40.0, 110.0, 160.0, -50.0, 80.0, 370.0, 20.0, 60.0, 50.0, 390.0, 150.0, -60.0, 400.0, 110.0, 130.0, -40.0, 150.0, 20.0, 190.0, 40.0, 40.0, 70.0, 40.0, 200.0, 40.0, 40.0, 10.0, 50.0, 80.0, 30.0, 60.0, 30.0, 120.0, 15.0, 40.0, 0.0, 50.0, 0.0, 130.0, 30.0, 360.0, 20.0, 0.0, 10.0, 0.0, 80.0, 50.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 70.0, 50.0, 160.0, 70.0, 90.0, 90.0, 150.0, 70.0, 170.0, 80.0, 140.0, 10.0, 120.0, -10.0, 490.0, 30.0, 150.0, 50.0, 40.0, 180.0, 70.0, 30.0, 100.0, 90.0, 70.0, 180.0, 80.0, 70.0, 40.0, 30.0, 30.0, 60.0, 120.0, 30.0, 0.0, 40.0, 80.0, 90.0, 170.0, 0.0, -40.0, 10.0, -20.0, 50.0, -20.0, 260.0, 40.0, 460.0, 40.0, -40.0, 20.0, 110.0, 150.0, 60.0, -55.0, -45.0, 10.0, 70.0, 0.0, 20.0, 20.0, 20.0, 40.0, 40.0, 80.0, 20.0, 20.0, 10.0, 30.0, 0.0, 30.0, 60.0, 50.0, 70.0, 10.0, 40.0, 330.0, 80.0, 170.0, 20.0, 440.0, 50.0, 50.0, 110.0, 130.0, 10.0, 100.0, 0.0, 60.0, 20.0, 50.0, 70.0, 10.0, 270.0, 130.0, 290.0, 120.0, 150.0, 50.0, 25.0, 40.0, -175.0, 270.0, 90.0, 260.0, 100.0, 60.0, 20.0, 20.0, 60.0, 20.0, 60.0, 140.0, 45.0, 30.0, 30.0, 420.0, 40.0, 40.0, 60.0, 20.0, 250.0, 80.0, 60.0, 80.0, 30.0, 510.0, 40.0, 40.0, 110.0, 5.0, 60.0, 70.0, 10.0, -20.0, -20.0, 80.0, 70.0, 110.0, -15.0, 60.0, 240.0, 40.0, 60.0, 160.0, 160.0, 20.0, 190.0, 170.0, 40.0, 90.0, 0.0, 120.0, 50.0, 0.0, 210.0, 20.0, 150.0, 80.0, 100.0, 60.0, 110.0, 30.0, 220.0, 30.0, 40.0, 80.0, 160.0, 30.0, 80.0, 80.0, 30.0, 70.0, 10.0, 20.0, 110.0, 50.0, 80.0, 20.0, 30.0, 110.0, 50.0, 20.0, 380.0, 250.0, 30.0, 350.0, 50.0, -50.0, 150.0, 40.0, 30.0, 90.0, 130.0, 40.0, 320.0, 40.0, 140.0, 15.0, 30.0, 60.0, 90.0, 150.0, 10.0, -30.0, 450.0, 20.0, 400.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 90.0, 20.0, 190.0, 30.0, 10.0, 250.0, 80.0, 70.0, 230.0, 70.0, 60.0, 230.0, 90.0, 70.0, 170.0, 350.0, 90.0, 20.0, 10.0, 30.0, 10.0, 70.0, 180.0, 50.0, 20.0, 190.0, 220.0, 100.0, 0.0, 180.0, 100.0, 250.0, 390.0, 10.0, 70.0, 140.0, 30.0, 75.0, 200.0, 130.0, 240.0, 50.0, 270.0, 30.0, 270.0, 30.0, 210.0, 80.0, 50.0, 360.0, 100.0, 40.0, 50.0, 90.0, 70.0, 200.0, 140.0, 80.0, 0.0, 60.0, 30.0, 160.0, 170.0, 60.0, 20.0, 130.0, 360.0, 100.0, 300.0, 10.0, 30.0, 20.0, 80.0, 40.0, 10.0, 0.0, 450.0, 50.0, 180.0, 120.0, 120.0, 70.0, 40.0, 50.0, 270.0, 80.0, 20.0, 20.0, 310.0, 40.0, -30.0, 320.0, 50.0, 100.0, 30.0, 70.0, 55.0, 60.0, -20.0, 210.0, 140.0, -50.0, 80.0, -80.0, 40.0, 350.0, 110.0, 140.0, 80.0, 20.0, 20.0, 50.0, 280.0, 10.0, 30.0, 130.0, 40.0, 100.0, 0.0, 370.0, 10.0, -40.0, 40.0, -90.0, 20.0, -40.0, 60.0, 50.0, 10.0, 0.0, 80.0, 560.0, 30.0, 10.0, -10.0, 20.0, 20.0, 50.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 10.0, 20.0, 35.0, 25.0, 40.0, 50.0, 110.0, 10.0, 10.0, 10.0, 120.0, 30.0, 10.0, 20.0, 130.0, 60.0, 70.0, 40.0, 0.0, 180.0, 40.0, 90.0, 20.0, 50.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5394993983274983, "mean_inference_ms": 1.4139668552180398, "mean_action_processing_ms": 0.43037807442069537, "mean_env_wait_ms": 1.2624404108759755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01196432113647461, "StateBufferConnector_ms": 0.009424209594726562, "ViewRequirementAgentConnector_ms": 0.37152767181396484}, "num_episodes": 23, "episode_return_max": 1540.0, "episode_return_min": 140.0, "episode_return_mean": 798.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.97878613369482, "num_env_steps_trained_throughput_per_sec": 20.97878613369482, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 2120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2120000, "timers": {"training_iteration_time_ms": 187221.842, "restore_workers_time_ms": 0.014, "training_step_time_ms": 187221.79, "sample_time_ms": 2543.526, "learn_time_ms": 184657.747, "learn_throughput": 21.662, "synch_weights_time_ms": 12.349}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "done": false, "training_iteration": 53, "trial_id": "90816_00000", "date": "2024-06-10_02-59-04", "timestamp": 1718002744, "time_this_iter_s": 190.6768660545349, "time_total_s": 10022.361486434937, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00e1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10022.361486434937, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 18.733085501858735, "ram_util_percent": 81.21821561338291}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5730573089930195, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.647872029732084, "policy_loss": -0.008565036898366789, "vf_loss": 6.655064349128796, "vf_explained_var": -0.00022225360266062906, "kl": 0.006863607018939575, "entropy": 0.5622049080614592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 502365.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 1505.0, "episode_reward_min": 160.0, "episode_reward_mean": 800.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -280.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 80.085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1020.0, 1220.0, 920.0, 1070.0, 160.0, 1150.0, 425.0, 900.0, 680.0, 590.0, 650.0, 640.0, 640.0, 935.0, 545.0, 460.0, 830.0, 565.0, 330.0, 300.0, 990.0, 810.0, 1110.0, 465.0, 640.0, 590.0, 830.0, 790.0, 1150.0, 820.0, 870.0, 645.0, 620.0, 390.0, 605.0, 1220.0, 675.0, 860.0, 1440.0, 610.0, 475.0, 610.0, 670.0, 1250.0, 960.0, 500.0, 580.0, 740.0, 320.0, 320.0, 1390.0, 1000.0, 930.0, 485.0, 1080.0, 805.0, 965.0, 890.0, 840.0, 670.0, 1020.0, 1150.0, 955.0, 800.0, 780.0, 1430.0, 800.0, 1270.0, 1505.0, 1180.0, 1070.0, 1040.0, 1000.0, 965.0, 840.0, 800.0, 430.0, 770.0, 200.0, 310.0, 500.0, 550.0, 1500.0, 1010.0, 600.0, 1050.0, 1115.0, 540.0, 455.0, 455.0, 760.0, 1360.0, 860.0, 770.0, 1170.0, 1200.0, 430.0, 745.0, 440.0, 620.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 170.0, 0.0, 40.0, 0.0, 30.0, 220.0, 250.0, 250.0, 70.0, 100.0, 60.0, 380.0, 10.0, 120.0, 220.0, 230.0, -20.0, 50.0, 420.0, 10.0, 20.0, 100.0, 20.0, 20.0, 40.0, 20.0, 250.0, 20.0, -280.0, 180.0, 50.0, 60.0, 220.0, 190.0, 200.0, 180.0, 190.0, 80.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 90.0, 20.0, 60.0, 50.0, 30.0, 20.0, 520.0, 150.0, 170.0, 10.0, 70.0, 50.0, 0.0, 60.0, 10.0, 0.0, 175.0, 70.0, -20.0, 50.0, 100.0, 100.0, 20.0, 140.0, 40.0, 50.0, 180.0, 210.0, 10.0, 0.0, 40.0, 120.0, 50.0, 40.0, 40.0, 300.0, 0.0, 40.0, 50.0, 90.0, 30.0, 90.0, 80.0, 120.0, 30.0, 120.0, 0.0, 0.0, 30.0, 30.0, 60.0, 60.0, 70.0, 40.0, 0.0, 50.0, 90.0, 230.0, 20.0, 50.0, 90.0, -20.0, -10.0, 570.0, -50.0, 70.0, -90.0, 70.0, -40.0, 300.0, 0.0, 0.0, 20.0, 160.0, 0.0, 160.0, 40.0, -60.0, 20.0, 120.0, 30.0, 40.0, 0.0, 80.0, 340.0, 40.0, 10.0, 230.0, 45.0, 60.0, 10.0, 45.0, 50.0, 10.0, 210.0, -60.0, 10.0, 180.0, 30.0, 20.0, 10.0, 10.0, 30.0, 20.0, 220.0, 30.0, 0.0, 60.0, 60.0, 90.0, 60.0, 30.0, 90.0, 90.0, 50.0, 60.0, 290.0, -10.0, 80.0, 30.0, 0.0, 90.0, 20.0, 40.0, 190.0, 40.0, 80.0, 20.0, 55.0, 10.0, 50.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 70.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 150.0, 20.0, 60.0, 80.0, -40.0, 190.0, 380.0, 70.0, 160.0, 0.0, 80.0, 10.0, 130.0, 50.0, 60.0, 160.0, -10.0, 40.0, 480.0, -170.0, -20.0, 90.0, 20.0, 60.0, 100.0, 40.0, 120.0, 60.0, 340.0, 200.0, 160.0, 10.0, 70.0, 20.0, 20.0, 40.0, 150.0, 10.0, 110.0, 20.0, 10.0, 15.0, 170.0, 30.0, -60.0, 90.0, 10.0, 190.0, 40.0, -80.0, 220.0, 30.0, 70.0, 40.0, 30.0, 20.0, 90.0, 0.0, 90.0, 80.0, 160.0, 10.0, 20.0, 110.0, 20.0, 70.0, 350.0, 40.0, -10.0, 40.0, 40.0, 150.0, 10.0, 100.0, 0.0, 30.0, 70.0, 150.0, 170.0, 120.0, 140.0, 0.0, 70.0, 110.0, 110.0, 90.0, 60.0, 50.0, 490.0, 60.0, 70.0, 40.0, 30.0, 80.0, 30.0, 0.0, 280.0, 20.0, 30.0, 50.0, 40.0, 260.0, 0.0, 60.0, 10.0, 210.0, 130.0, 30.0, 50.0, 210.0, 160.0, 10.0, 10.0, 160.0, 40.0, 5.0, 10.0, 10.0, 240.0, 20.0, 110.0, 40.0, 30.0, 30.0, 200.0, 50.0, 30.0, 20.0, 30.0, 50.0, 150.0, 30.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 40.0, 60.0, 90.0, 40.0, 20.0, 10.0, 230.0, 25.0, 40.0, 80.0, 60.0, 20.0, 100.0, 20.0, 10.0, 110.0, 10.0, 40.0, 80.0, 380.0, 190.0, 20.0, 40.0, 340.0, 170.0, 300.0, 20.0, 60.0, 40.0, 70.0, 10.0, 45.0, -50.0, 10.0, 20.0, 40.0, 110.0, 160.0, -50.0, 80.0, 370.0, 20.0, 60.0, 50.0, 390.0, 150.0, -60.0, 400.0, 110.0, 130.0, -40.0, 150.0, 20.0, 190.0, 40.0, 40.0, 70.0, 40.0, 200.0, 40.0, 40.0, 10.0, 50.0, 80.0, 30.0, 60.0, 30.0, 120.0, 15.0, 40.0, 0.0, 50.0, 0.0, 130.0, 30.0, 360.0, 20.0, 0.0, 10.0, 0.0, 80.0, 50.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 70.0, 50.0, 160.0, 70.0, 90.0, 90.0, 150.0, 70.0, 170.0, 80.0, 140.0, 10.0, 120.0, -10.0, 490.0, 30.0, 150.0, 50.0, 40.0, 180.0, 70.0, 30.0, 100.0, 90.0, 70.0, 180.0, 80.0, 70.0, 40.0, 30.0, 30.0, 60.0, 120.0, 30.0, 0.0, 40.0, 80.0, 90.0, 170.0, 0.0, -40.0, 10.0, -20.0, 50.0, -20.0, 260.0, 40.0, 460.0, 40.0, -40.0, 20.0, 110.0, 150.0, 60.0, -55.0, -45.0, 10.0, 70.0, 0.0, 20.0, 20.0, 20.0, 40.0, 40.0, 80.0, 20.0, 20.0, 10.0, 30.0, 0.0, 30.0, 60.0, 50.0, 70.0, 10.0, 40.0, 330.0, 80.0, 170.0, 20.0, 440.0, 50.0, 50.0, 110.0, 130.0, 10.0, 100.0, 0.0, 60.0, 20.0, 50.0, 70.0, 10.0, 270.0, 130.0, 290.0, 120.0, 150.0, 50.0, 25.0, 40.0, -175.0, 270.0, 90.0, 260.0, 100.0, 60.0, 20.0, 20.0, 60.0, 20.0, 60.0, 140.0, 45.0, 30.0, 30.0, 420.0, 40.0, 40.0, 60.0, 20.0, 250.0, 80.0, 60.0, 80.0, 30.0, 510.0, 40.0, 40.0, 110.0, 5.0, 60.0, 70.0, 10.0, -20.0, -20.0, 80.0, 70.0, 110.0, -15.0, 60.0, 240.0, 40.0, 60.0, 160.0, 160.0, 20.0, 190.0, 170.0, 40.0, 90.0, 0.0, 120.0, 50.0, 0.0, 210.0, 20.0, 150.0, 80.0, 100.0, 60.0, 110.0, 30.0, 220.0, 30.0, 40.0, 80.0, 160.0, 30.0, 80.0, 80.0, 30.0, 70.0, 10.0, 20.0, 110.0, 50.0, 80.0, 20.0, 30.0, 110.0, 50.0, 20.0, 380.0, 250.0, 30.0, 350.0, 50.0, -50.0, 150.0, 40.0, 30.0, 90.0, 130.0, 40.0, 320.0, 40.0, 140.0, 15.0, 30.0, 60.0, 90.0, 150.0, 10.0, -30.0, 450.0, 20.0, 400.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 90.0, 20.0, 190.0, 30.0, 10.0, 250.0, 80.0, 70.0, 230.0, 70.0, 60.0, 230.0, 90.0, 70.0, 170.0, 350.0, 90.0, 20.0, 10.0, 30.0, 10.0, 70.0, 180.0, 50.0, 20.0, 190.0, 220.0, 100.0, 0.0, 180.0, 100.0, 250.0, 390.0, 10.0, 70.0, 140.0, 30.0, 75.0, 200.0, 130.0, 240.0, 50.0, 270.0, 30.0, 270.0, 30.0, 210.0, 80.0, 50.0, 360.0, 100.0, 40.0, 50.0, 90.0, 70.0, 200.0, 140.0, 80.0, 0.0, 60.0, 30.0, 160.0, 170.0, 60.0, 20.0, 130.0, 360.0, 100.0, 300.0, 10.0, 30.0, 20.0, 80.0, 40.0, 10.0, 0.0, 450.0, 50.0, 180.0, 120.0, 120.0, 70.0, 40.0, 50.0, 270.0, 80.0, 20.0, 20.0, 310.0, 40.0, -30.0, 320.0, 50.0, 100.0, 30.0, 70.0, 55.0, 60.0, -20.0, 210.0, 140.0, -50.0, 80.0, -80.0, 40.0, 350.0, 110.0, 140.0, 80.0, 20.0, 20.0, 50.0, 280.0, 10.0, 30.0, 130.0, 40.0, 100.0, 0.0, 370.0, 10.0, -40.0, 40.0, -90.0, 20.0, -40.0, 60.0, 50.0, 10.0, 0.0, 80.0, 560.0, 30.0, 10.0, -10.0, 20.0, 20.0, 50.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 10.0, 20.0, 35.0, 25.0, 40.0, 50.0, 110.0, 10.0, 10.0, 10.0, 120.0, 30.0, 10.0, 20.0, 130.0, 60.0, 70.0, 40.0, 0.0, 180.0, 40.0, 90.0, 20.0, 50.0, 0.0, 40.0, 390.0, 100.0, 30.0, 110.0, 10.0, 270.0, 320.0, 170.0, 60.0, 70.0, 40.0, 90.0, 120.0, 240.0, 110.0, 140.0, 80.0, 80.0, 40.0, 30.0, 0.0, 130.0, 30.0, 40.0, 120.0, 70.0, 80.0, 30.0, 70.0, 30.0, 310.0, 70.0, 40.0, 300.0, 130.0, 100.0, 50.0, 10.0, 10.0, 260.0, -5.0, 70.0, 140.0, 30.0, 100.0, 30.0, 250.0, 210.0, 30.0, 40.0, 70.0, 60.0, 180.0, 60.0, 20.0, 20.0, -30.0, 20.0, 100.0, 30.0, 50.0, -40.0, 30.0, -40.0, 30.0, 365.0, 10.0, 0.0, 20.0, 80.0, 50.0, 40.0, 20.0, 30.0, 65.0, 30.0, 30.0, 30.0, 80.0, 50.0, 100.0, 30.0, 0.0, 130.0, 30.0, 60.0, 240.0, 40.0, 80.0, -10.0, 20.0, 110.0, 190.0, 90.0, 440.0, 320.0, 160.0, 90.0, -50.0, 90.0, 170.0, 130.0, 140.0, 50.0, 10.0, 30.0, 20.0, 70.0, 150.0, 60.0, 110.0, 100.0, 50.0, 60.0, 170.0, 150.0, 0.0, -10.0, 80.0, 120.0, 90.0, 0.0, 290.0, 140.0, 190.0, 240.0, 10.0, 20.0, 70.0, 70.0, 20.0, 90.0, 40.0, 90.0, 100.0, 80.0, 580.0, 20.0, 110.0, 10.0, 0.0, 10.0, 80.0, 40.0, 30.0, 200.0, 10.0, 30.0, 20.0, -20.0, 100.0, 20.0, 30.0, 40.0, 80.0, 70.0, 75.0, 40.0, 310.0, 30.0, 30.0, 0.0, 10.0, 0.0, 80.0, 20.0, 10.0, 260.0, 0.0, 10.0, 70.0, 80.0, 20.0, 180.0, 30.0, 100.0, 40.0, 30.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5386256202999968, "mean_inference_ms": 1.4149187488018489, "mean_action_processing_ms": 0.43000798116252326, "mean_env_wait_ms": 1.2628999346344847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012128114700317383, "StateBufferConnector_ms": 0.009329080581665039, "ViewRequirementAgentConnector_ms": 0.3681323528289795}, "num_episodes": 18, "episode_return_max": 1505.0, "episode_return_min": 160.0, "episode_return_mean": 800.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.351772841778605, "num_env_steps_trained_throughput_per_sec": 21.351772841778605, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 187429.9, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187429.848, "sample_time_ms": 2554.415, "learn_time_ms": 184854.543, "learn_throughput": 21.639, "synch_weights_time_ms": 12.777}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 54, "trial_id": "90816_00000", "date": "2024-06-10_03-02-11", "timestamp": 1718002931, "time_this_iter_s": 187.34810400009155, "time_total_s": 10209.709590435028, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f56280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10209.709590435028, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.373584905660376, "ram_util_percent": 79.73018867924529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3318465478123187, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.60039241631318, "policy_loss": -0.008247120791852287, "vf_loss": 6.607302791343583, "vf_explained_var": 0.0005922074071642436, "kl": 0.006683738603088358, "entropy": 0.5723090431560723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 511755.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "env_runners": {"episode_reward_max": 1505.0, "episode_reward_min": 200.0, "episode_reward_mean": 832.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -175.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 83.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.0, 300.0, 990.0, 810.0, 1110.0, 465.0, 640.0, 590.0, 830.0, 790.0, 1150.0, 820.0, 870.0, 645.0, 620.0, 390.0, 605.0, 1220.0, 675.0, 860.0, 1440.0, 610.0, 475.0, 610.0, 670.0, 1250.0, 960.0, 500.0, 580.0, 740.0, 320.0, 320.0, 1390.0, 1000.0, 930.0, 485.0, 1080.0, 805.0, 965.0, 890.0, 840.0, 670.0, 1020.0, 1150.0, 955.0, 800.0, 780.0, 1430.0, 800.0, 1270.0, 1505.0, 1180.0, 1070.0, 1040.0, 1000.0, 965.0, 840.0, 800.0, 430.0, 770.0, 200.0, 310.0, 500.0, 550.0, 1500.0, 1010.0, 600.0, 1050.0, 1115.0, 540.0, 455.0, 455.0, 760.0, 1360.0, 860.0, 770.0, 1170.0, 1200.0, 430.0, 745.0, 440.0, 620.0, 920.0, 330.0, 845.0, 1470.0, 1390.0, 1060.0, 360.0, 880.0, 1150.0, 820.0, 980.0, 1480.0, 620.0, 940.0, 345.0, 770.0, 1025.0, 1130.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 50.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 70.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 150.0, 20.0, 60.0, 80.0, -40.0, 190.0, 380.0, 70.0, 160.0, 0.0, 80.0, 10.0, 130.0, 50.0, 60.0, 160.0, -10.0, 40.0, 480.0, -170.0, -20.0, 90.0, 20.0, 60.0, 100.0, 40.0, 120.0, 60.0, 340.0, 200.0, 160.0, 10.0, 70.0, 20.0, 20.0, 40.0, 150.0, 10.0, 110.0, 20.0, 10.0, 15.0, 170.0, 30.0, -60.0, 90.0, 10.0, 190.0, 40.0, -80.0, 220.0, 30.0, 70.0, 40.0, 30.0, 20.0, 90.0, 0.0, 90.0, 80.0, 160.0, 10.0, 20.0, 110.0, 20.0, 70.0, 350.0, 40.0, -10.0, 40.0, 40.0, 150.0, 10.0, 100.0, 0.0, 30.0, 70.0, 150.0, 170.0, 120.0, 140.0, 0.0, 70.0, 110.0, 110.0, 90.0, 60.0, 50.0, 490.0, 60.0, 70.0, 40.0, 30.0, 80.0, 30.0, 0.0, 280.0, 20.0, 30.0, 50.0, 40.0, 260.0, 0.0, 60.0, 10.0, 210.0, 130.0, 30.0, 50.0, 210.0, 160.0, 10.0, 10.0, 160.0, 40.0, 5.0, 10.0, 10.0, 240.0, 20.0, 110.0, 40.0, 30.0, 30.0, 200.0, 50.0, 30.0, 20.0, 30.0, 50.0, 150.0, 30.0, 10.0, 60.0, 40.0, 20.0, 20.0, 10.0, 40.0, 60.0, 90.0, 40.0, 20.0, 10.0, 230.0, 25.0, 40.0, 80.0, 60.0, 20.0, 100.0, 20.0, 10.0, 110.0, 10.0, 40.0, 80.0, 380.0, 190.0, 20.0, 40.0, 340.0, 170.0, 300.0, 20.0, 60.0, 40.0, 70.0, 10.0, 45.0, -50.0, 10.0, 20.0, 40.0, 110.0, 160.0, -50.0, 80.0, 370.0, 20.0, 60.0, 50.0, 390.0, 150.0, -60.0, 400.0, 110.0, 130.0, -40.0, 150.0, 20.0, 190.0, 40.0, 40.0, 70.0, 40.0, 200.0, 40.0, 40.0, 10.0, 50.0, 80.0, 30.0, 60.0, 30.0, 120.0, 15.0, 40.0, 0.0, 50.0, 0.0, 130.0, 30.0, 360.0, 20.0, 0.0, 10.0, 0.0, 80.0, 50.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 70.0, 50.0, 160.0, 70.0, 90.0, 90.0, 150.0, 70.0, 170.0, 80.0, 140.0, 10.0, 120.0, -10.0, 490.0, 30.0, 150.0, 50.0, 40.0, 180.0, 70.0, 30.0, 100.0, 90.0, 70.0, 180.0, 80.0, 70.0, 40.0, 30.0, 30.0, 60.0, 120.0, 30.0, 0.0, 40.0, 80.0, 90.0, 170.0, 0.0, -40.0, 10.0, -20.0, 50.0, -20.0, 260.0, 40.0, 460.0, 40.0, -40.0, 20.0, 110.0, 150.0, 60.0, -55.0, -45.0, 10.0, 70.0, 0.0, 20.0, 20.0, 20.0, 40.0, 40.0, 80.0, 20.0, 20.0, 10.0, 30.0, 0.0, 30.0, 60.0, 50.0, 70.0, 10.0, 40.0, 330.0, 80.0, 170.0, 20.0, 440.0, 50.0, 50.0, 110.0, 130.0, 10.0, 100.0, 0.0, 60.0, 20.0, 50.0, 70.0, 10.0, 270.0, 130.0, 290.0, 120.0, 150.0, 50.0, 25.0, 40.0, -175.0, 270.0, 90.0, 260.0, 100.0, 60.0, 20.0, 20.0, 60.0, 20.0, 60.0, 140.0, 45.0, 30.0, 30.0, 420.0, 40.0, 40.0, 60.0, 20.0, 250.0, 80.0, 60.0, 80.0, 30.0, 510.0, 40.0, 40.0, 110.0, 5.0, 60.0, 70.0, 10.0, -20.0, -20.0, 80.0, 70.0, 110.0, -15.0, 60.0, 240.0, 40.0, 60.0, 160.0, 160.0, 20.0, 190.0, 170.0, 40.0, 90.0, 0.0, 120.0, 50.0, 0.0, 210.0, 20.0, 150.0, 80.0, 100.0, 60.0, 110.0, 30.0, 220.0, 30.0, 40.0, 80.0, 160.0, 30.0, 80.0, 80.0, 30.0, 70.0, 10.0, 20.0, 110.0, 50.0, 80.0, 20.0, 30.0, 110.0, 50.0, 20.0, 380.0, 250.0, 30.0, 350.0, 50.0, -50.0, 150.0, 40.0, 30.0, 90.0, 130.0, 40.0, 320.0, 40.0, 140.0, 15.0, 30.0, 60.0, 90.0, 150.0, 10.0, -30.0, 450.0, 20.0, 400.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 90.0, 20.0, 190.0, 30.0, 10.0, 250.0, 80.0, 70.0, 230.0, 70.0, 60.0, 230.0, 90.0, 70.0, 170.0, 350.0, 90.0, 20.0, 10.0, 30.0, 10.0, 70.0, 180.0, 50.0, 20.0, 190.0, 220.0, 100.0, 0.0, 180.0, 100.0, 250.0, 390.0, 10.0, 70.0, 140.0, 30.0, 75.0, 200.0, 130.0, 240.0, 50.0, 270.0, 30.0, 270.0, 30.0, 210.0, 80.0, 50.0, 360.0, 100.0, 40.0, 50.0, 90.0, 70.0, 200.0, 140.0, 80.0, 0.0, 60.0, 30.0, 160.0, 170.0, 60.0, 20.0, 130.0, 360.0, 100.0, 300.0, 10.0, 30.0, 20.0, 80.0, 40.0, 10.0, 0.0, 450.0, 50.0, 180.0, 120.0, 120.0, 70.0, 40.0, 50.0, 270.0, 80.0, 20.0, 20.0, 310.0, 40.0, -30.0, 320.0, 50.0, 100.0, 30.0, 70.0, 55.0, 60.0, -20.0, 210.0, 140.0, -50.0, 80.0, -80.0, 40.0, 350.0, 110.0, 140.0, 80.0, 20.0, 20.0, 50.0, 280.0, 10.0, 30.0, 130.0, 40.0, 100.0, 0.0, 370.0, 10.0, -40.0, 40.0, -90.0, 20.0, -40.0, 60.0, 50.0, 10.0, 0.0, 80.0, 560.0, 30.0, 10.0, -10.0, 20.0, 20.0, 50.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 10.0, 20.0, 35.0, 25.0, 40.0, 50.0, 110.0, 10.0, 10.0, 10.0, 120.0, 30.0, 10.0, 20.0, 130.0, 60.0, 70.0, 40.0, 0.0, 180.0, 40.0, 90.0, 20.0, 50.0, 0.0, 40.0, 390.0, 100.0, 30.0, 110.0, 10.0, 270.0, 320.0, 170.0, 60.0, 70.0, 40.0, 90.0, 120.0, 240.0, 110.0, 140.0, 80.0, 80.0, 40.0, 30.0, 0.0, 130.0, 30.0, 40.0, 120.0, 70.0, 80.0, 30.0, 70.0, 30.0, 310.0, 70.0, 40.0, 300.0, 130.0, 100.0, 50.0, 10.0, 10.0, 260.0, -5.0, 70.0, 140.0, 30.0, 100.0, 30.0, 250.0, 210.0, 30.0, 40.0, 70.0, 60.0, 180.0, 60.0, 20.0, 20.0, -30.0, 20.0, 100.0, 30.0, 50.0, -40.0, 30.0, -40.0, 30.0, 365.0, 10.0, 0.0, 20.0, 80.0, 50.0, 40.0, 20.0, 30.0, 65.0, 30.0, 30.0, 30.0, 80.0, 50.0, 100.0, 30.0, 0.0, 130.0, 30.0, 60.0, 240.0, 40.0, 80.0, -10.0, 20.0, 110.0, 190.0, 90.0, 440.0, 320.0, 160.0, 90.0, -50.0, 90.0, 170.0, 130.0, 140.0, 50.0, 10.0, 30.0, 20.0, 70.0, 150.0, 60.0, 110.0, 100.0, 50.0, 60.0, 170.0, 150.0, 0.0, -10.0, 80.0, 120.0, 90.0, 0.0, 290.0, 140.0, 190.0, 240.0, 10.0, 20.0, 70.0, 70.0, 20.0, 90.0, 40.0, 90.0, 100.0, 80.0, 580.0, 20.0, 110.0, 10.0, 0.0, 10.0, 80.0, 40.0, 30.0, 200.0, 10.0, 30.0, 20.0, -20.0, 100.0, 20.0, 30.0, 40.0, 80.0, 70.0, 75.0, 40.0, 310.0, 30.0, 30.0, 0.0, 10.0, 0.0, 80.0, 20.0, 10.0, 260.0, 0.0, 10.0, 70.0, 80.0, 20.0, 180.0, 30.0, 100.0, 40.0, 30.0, 60.0, 40.0, 170.0, 240.0, 80.0, -30.0, 210.0, 0.0, 60.0, 20.0, 130.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 10.0, 100.0, 20.0, 10.0, 20.0, 150.0, 100.0, 0.0, 0.0, 390.0, -5.0, 120.0, 40.0, 30.0, 120.0, 20.0, 50.0, 70.0, 50.0, 150.0, 160.0, 60.0, 740.0, 50.0, 80.0, 120.0, 30.0, 440.0, 270.0, 70.0, 100.0, 130.0, 110.0, 40.0, -50.0, -10.0, 10.0, 60.0, 70.0, 180.0, 0.0, 190.0, 230.0, 380.0, 210.0, 10.0, 10.0, 15.0, 80.0, 20.0, -55.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 200.0, 20.0, 280.0, 80.0, 130.0, 60.0, -30.0, 220.0, 30.0, 280.0, 130.0, 40.0, 40.0, 20.0, 140.0, 280.0, 180.0, 40.0, 10.0, 50.0, 350.0, 40.0, 20.0, 70.0, 40.0, 20.0, 180.0, 110.0, 60.0, 200.0, 20.0, 10.0, 180.0, 40.0, 70.0, 110.0, -10.0, 10.0, 100.0, 50.0, 180.0, 190.0, 10.0, 370.0, 150.0, 430.0, 190.0, 10.0, 70.0, 20.0, 20.0, 10.0, 70.0, 50.0, 120.0, 60.0, 40.0, 0.0, 40.0, 60.0, 40.0, -60.0, 720.0, -90.0, 160.0, 30.0, 0.0, 20.0, 30.0, 110.0, 30.0, 5.0, 100.0, 0.0, 50.0, 0.0, 20.0, 50.0, 160.0, 80.0, 30.0, 100.0, 30.0, 30.0, 10.0, 260.0, 20.0, 100.0, 180.0, 10.0, 55.0, -10.0, 30.0, 150.0, 300.0, 190.0, -40.0, 200.0, 70.0, -10.0, -20.0, 10.0, 50.0, 620.0, 30.0, 220.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.538667212417526, "mean_inference_ms": 1.4161427697662097, "mean_action_processing_ms": 0.4296853164287521, "mean_env_wait_ms": 1.2635794462830638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012578964233398438, "StateBufferConnector_ms": 0.0094757080078125, "ViewRequirementAgentConnector_ms": 0.38440585136413574}, "num_episodes": 18, "episode_return_max": 1505.0, "episode_return_min": 200.0, "episode_return_mean": 832.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.35698640107803, "num_env_steps_trained_throughput_per_sec": 21.35698640107803, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 2200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2200000, "timers": {"training_iteration_time_ms": 187431.807, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187431.755, "sample_time_ms": 2644.394, "learn_time_ms": 184766.501, "learn_throughput": 21.649, "synch_weights_time_ms": 12.645}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "done": false, "training_iteration": 55, "trial_id": "90816_00000", "date": "2024-06-10_03-05-18", "timestamp": 1718003118, "time_this_iter_s": 187.30098724365234, "time_total_s": 10397.01057767868, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f90d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10397.01057767868, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.84566037735849, "ram_util_percent": 79.24415094339624}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1071541677267787, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.880708702075215, "policy_loss": -0.008749845401132014, "vf_loss": 5.888106824490971, "vf_explained_var": 0.0016337972289076248, "kl": 0.006758602610222032, "entropy": 0.5913551110651293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 521145.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 1505.0, "episode_reward_min": 200.0, "episode_reward_mean": 842.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -175.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 84.245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [675.0, 860.0, 1440.0, 610.0, 475.0, 610.0, 670.0, 1250.0, 960.0, 500.0, 580.0, 740.0, 320.0, 320.0, 1390.0, 1000.0, 930.0, 485.0, 1080.0, 805.0, 965.0, 890.0, 840.0, 670.0, 1020.0, 1150.0, 955.0, 800.0, 780.0, 1430.0, 800.0, 1270.0, 1505.0, 1180.0, 1070.0, 1040.0, 1000.0, 965.0, 840.0, 800.0, 430.0, 770.0, 200.0, 310.0, 500.0, 550.0, 1500.0, 1010.0, 600.0, 1050.0, 1115.0, 540.0, 455.0, 455.0, 760.0, 1360.0, 860.0, 770.0, 1170.0, 1200.0, 430.0, 745.0, 440.0, 620.0, 920.0, 330.0, 845.0, 1470.0, 1390.0, 1060.0, 360.0, 880.0, 1150.0, 820.0, 980.0, 1480.0, 620.0, 940.0, 345.0, 770.0, 1025.0, 1130.0, 1100.0, 850.0, 280.0, 520.0, 1130.0, 250.0, 400.0, 370.0, 550.0, 330.0, 1410.0, 1110.0, 710.0, 1360.0, 770.0, 875.0, 1115.0, 1090.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 300.0, 20.0, 60.0, 40.0, 70.0, 10.0, 45.0, -50.0, 10.0, 20.0, 40.0, 110.0, 160.0, -50.0, 80.0, 370.0, 20.0, 60.0, 50.0, 390.0, 150.0, -60.0, 400.0, 110.0, 130.0, -40.0, 150.0, 20.0, 190.0, 40.0, 40.0, 70.0, 40.0, 200.0, 40.0, 40.0, 10.0, 50.0, 80.0, 30.0, 60.0, 30.0, 120.0, 15.0, 40.0, 0.0, 50.0, 0.0, 130.0, 30.0, 360.0, 20.0, 0.0, 10.0, 0.0, 80.0, 50.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 70.0, 50.0, 160.0, 70.0, 90.0, 90.0, 150.0, 70.0, 170.0, 80.0, 140.0, 10.0, 120.0, -10.0, 490.0, 30.0, 150.0, 50.0, 40.0, 180.0, 70.0, 30.0, 100.0, 90.0, 70.0, 180.0, 80.0, 70.0, 40.0, 30.0, 30.0, 60.0, 120.0, 30.0, 0.0, 40.0, 80.0, 90.0, 170.0, 0.0, -40.0, 10.0, -20.0, 50.0, -20.0, 260.0, 40.0, 460.0, 40.0, -40.0, 20.0, 110.0, 150.0, 60.0, -55.0, -45.0, 10.0, 70.0, 0.0, 20.0, 20.0, 20.0, 40.0, 40.0, 80.0, 20.0, 20.0, 10.0, 30.0, 0.0, 30.0, 60.0, 50.0, 70.0, 10.0, 40.0, 330.0, 80.0, 170.0, 20.0, 440.0, 50.0, 50.0, 110.0, 130.0, 10.0, 100.0, 0.0, 60.0, 20.0, 50.0, 70.0, 10.0, 270.0, 130.0, 290.0, 120.0, 150.0, 50.0, 25.0, 40.0, -175.0, 270.0, 90.0, 260.0, 100.0, 60.0, 20.0, 20.0, 60.0, 20.0, 60.0, 140.0, 45.0, 30.0, 30.0, 420.0, 40.0, 40.0, 60.0, 20.0, 250.0, 80.0, 60.0, 80.0, 30.0, 510.0, 40.0, 40.0, 110.0, 5.0, 60.0, 70.0, 10.0, -20.0, -20.0, 80.0, 70.0, 110.0, -15.0, 60.0, 240.0, 40.0, 60.0, 160.0, 160.0, 20.0, 190.0, 170.0, 40.0, 90.0, 0.0, 120.0, 50.0, 0.0, 210.0, 20.0, 150.0, 80.0, 100.0, 60.0, 110.0, 30.0, 220.0, 30.0, 40.0, 80.0, 160.0, 30.0, 80.0, 80.0, 30.0, 70.0, 10.0, 20.0, 110.0, 50.0, 80.0, 20.0, 30.0, 110.0, 50.0, 20.0, 380.0, 250.0, 30.0, 350.0, 50.0, -50.0, 150.0, 40.0, 30.0, 90.0, 130.0, 40.0, 320.0, 40.0, 140.0, 15.0, 30.0, 60.0, 90.0, 150.0, 10.0, -30.0, 450.0, 20.0, 400.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 90.0, 20.0, 190.0, 30.0, 10.0, 250.0, 80.0, 70.0, 230.0, 70.0, 60.0, 230.0, 90.0, 70.0, 170.0, 350.0, 90.0, 20.0, 10.0, 30.0, 10.0, 70.0, 180.0, 50.0, 20.0, 190.0, 220.0, 100.0, 0.0, 180.0, 100.0, 250.0, 390.0, 10.0, 70.0, 140.0, 30.0, 75.0, 200.0, 130.0, 240.0, 50.0, 270.0, 30.0, 270.0, 30.0, 210.0, 80.0, 50.0, 360.0, 100.0, 40.0, 50.0, 90.0, 70.0, 200.0, 140.0, 80.0, 0.0, 60.0, 30.0, 160.0, 170.0, 60.0, 20.0, 130.0, 360.0, 100.0, 300.0, 10.0, 30.0, 20.0, 80.0, 40.0, 10.0, 0.0, 450.0, 50.0, 180.0, 120.0, 120.0, 70.0, 40.0, 50.0, 270.0, 80.0, 20.0, 20.0, 310.0, 40.0, -30.0, 320.0, 50.0, 100.0, 30.0, 70.0, 55.0, 60.0, -20.0, 210.0, 140.0, -50.0, 80.0, -80.0, 40.0, 350.0, 110.0, 140.0, 80.0, 20.0, 20.0, 50.0, 280.0, 10.0, 30.0, 130.0, 40.0, 100.0, 0.0, 370.0, 10.0, -40.0, 40.0, -90.0, 20.0, -40.0, 60.0, 50.0, 10.0, 0.0, 80.0, 560.0, 30.0, 10.0, -10.0, 20.0, 20.0, 50.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 10.0, 20.0, 35.0, 25.0, 40.0, 50.0, 110.0, 10.0, 10.0, 10.0, 120.0, 30.0, 10.0, 20.0, 130.0, 60.0, 70.0, 40.0, 0.0, 180.0, 40.0, 90.0, 20.0, 50.0, 0.0, 40.0, 390.0, 100.0, 30.0, 110.0, 10.0, 270.0, 320.0, 170.0, 60.0, 70.0, 40.0, 90.0, 120.0, 240.0, 110.0, 140.0, 80.0, 80.0, 40.0, 30.0, 0.0, 130.0, 30.0, 40.0, 120.0, 70.0, 80.0, 30.0, 70.0, 30.0, 310.0, 70.0, 40.0, 300.0, 130.0, 100.0, 50.0, 10.0, 10.0, 260.0, -5.0, 70.0, 140.0, 30.0, 100.0, 30.0, 250.0, 210.0, 30.0, 40.0, 70.0, 60.0, 180.0, 60.0, 20.0, 20.0, -30.0, 20.0, 100.0, 30.0, 50.0, -40.0, 30.0, -40.0, 30.0, 365.0, 10.0, 0.0, 20.0, 80.0, 50.0, 40.0, 20.0, 30.0, 65.0, 30.0, 30.0, 30.0, 80.0, 50.0, 100.0, 30.0, 0.0, 130.0, 30.0, 60.0, 240.0, 40.0, 80.0, -10.0, 20.0, 110.0, 190.0, 90.0, 440.0, 320.0, 160.0, 90.0, -50.0, 90.0, 170.0, 130.0, 140.0, 50.0, 10.0, 30.0, 20.0, 70.0, 150.0, 60.0, 110.0, 100.0, 50.0, 60.0, 170.0, 150.0, 0.0, -10.0, 80.0, 120.0, 90.0, 0.0, 290.0, 140.0, 190.0, 240.0, 10.0, 20.0, 70.0, 70.0, 20.0, 90.0, 40.0, 90.0, 100.0, 80.0, 580.0, 20.0, 110.0, 10.0, 0.0, 10.0, 80.0, 40.0, 30.0, 200.0, 10.0, 30.0, 20.0, -20.0, 100.0, 20.0, 30.0, 40.0, 80.0, 70.0, 75.0, 40.0, 310.0, 30.0, 30.0, 0.0, 10.0, 0.0, 80.0, 20.0, 10.0, 260.0, 0.0, 10.0, 70.0, 80.0, 20.0, 180.0, 30.0, 100.0, 40.0, 30.0, 60.0, 40.0, 170.0, 240.0, 80.0, -30.0, 210.0, 0.0, 60.0, 20.0, 130.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 10.0, 100.0, 20.0, 10.0, 20.0, 150.0, 100.0, 0.0, 0.0, 390.0, -5.0, 120.0, 40.0, 30.0, 120.0, 20.0, 50.0, 70.0, 50.0, 150.0, 160.0, 60.0, 740.0, 50.0, 80.0, 120.0, 30.0, 440.0, 270.0, 70.0, 100.0, 130.0, 110.0, 40.0, -50.0, -10.0, 10.0, 60.0, 70.0, 180.0, 0.0, 190.0, 230.0, 380.0, 210.0, 10.0, 10.0, 15.0, 80.0, 20.0, -55.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 200.0, 20.0, 280.0, 80.0, 130.0, 60.0, -30.0, 220.0, 30.0, 280.0, 130.0, 40.0, 40.0, 20.0, 140.0, 280.0, 180.0, 40.0, 10.0, 50.0, 350.0, 40.0, 20.0, 70.0, 40.0, 20.0, 180.0, 110.0, 60.0, 200.0, 20.0, 10.0, 180.0, 40.0, 70.0, 110.0, -10.0, 10.0, 100.0, 50.0, 180.0, 190.0, 10.0, 370.0, 150.0, 430.0, 190.0, 10.0, 70.0, 20.0, 20.0, 10.0, 70.0, 50.0, 120.0, 60.0, 40.0, 0.0, 40.0, 60.0, 40.0, -60.0, 720.0, -90.0, 160.0, 30.0, 0.0, 20.0, 30.0, 110.0, 30.0, 5.0, 100.0, 0.0, 50.0, 0.0, 20.0, 50.0, 160.0, 80.0, 30.0, 100.0, 30.0, 30.0, 10.0, 260.0, 20.0, 100.0, 180.0, 10.0, 55.0, -10.0, 30.0, 150.0, 300.0, 190.0, -40.0, 200.0, 70.0, -10.0, -20.0, 10.0, 50.0, 620.0, 30.0, 220.0, 50.0, 10.0, 680.0, 0.0, -60.0, -20.0, 280.0, 90.0, 50.0, 20.0, 20.0, 20.0, 50.0, -80.0, 590.0, -10.0, 40.0, 170.0, -20.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 0.0, 40.0, 30.0, 40.0, 40.0, 70.0, 10.0, 40.0, 130.0, 20.0, 80.0, 40.0, 90.0, 0.0, 330.0, 170.0, 80.0, 130.0, 80.0, 90.0, 30.0, 100.0, 60.0, 60.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, -90.0, 30.0, 140.0, 40.0, 20.0, 140.0, 70.0, 30.0, 50.0, 20.0, 10.0, 30.0, 0.0, 150.0, 10.0, 0.0, 110.0, 30.0, -70.0, -90.0, 270.0, 30.0, 50.0, 50.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 20.0, 190.0, 0.0, 290.0, 360.0, 20.0, 160.0, 70.0, 320.0, 20.0, 40.0, 60.0, 70.0, 20.0, 40.0, 90.0, 140.0, 110.0, 30.0, 260.0, 90.0, 180.0, 150.0, 0.0, 30.0, 40.0, 10.0, 70.0, 150.0, 160.0, 60.0, 150.0, 40.0, 80.0, 70.0, 60.0, 30.0, 30.0, 260.0, 260.0, 180.0, 300.0, 90.0, 40.0, 80.0, 60.0, 80.0, 70.0, 160.0, 80.0, 20.0, 60.0, 120.0, -45.0, 40.0, 60.0, -40.0, 550.0, 50.0, 0.0, 100.0, 20.0, 140.0, 120.0, 40.0, 360.0, 140.0, 15.0, 180.0, 20.0, 40.0, 160.0, 40.0, 80.0, 50.0, 80.0, 80.0, 210.0, 130.0, 70.0, 130.0, 110.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5389981087971294, "mean_inference_ms": 1.417101237000269, "mean_action_processing_ms": 0.4293615331119122, "mean_env_wait_ms": 1.2640733157915889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01232004165649414, "StateBufferConnector_ms": 0.009479761123657227, "ViewRequirementAgentConnector_ms": 0.3848090171813965}, "num_episodes": 18, "episode_return_max": 1505.0, "episode_return_min": 200.0, "episode_return_mean": 842.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.359108034558734, "num_env_steps_trained_throughput_per_sec": 21.359108034558734, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 187560.285, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187560.238, "sample_time_ms": 2632.749, "learn_time_ms": 184906.667, "learn_throughput": 21.633, "synch_weights_time_ms": 12.46}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 56, "trial_id": "90816_00000", "date": "2024-06-10_03-08-26", "timestamp": 1718003306, "time_this_iter_s": 187.30451202392578, "time_total_s": 10584.315089702606, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00403a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10584.315089702606, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 18.07698113207547, "ram_util_percent": 79.47886792452829}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4507419955552705, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.818901674485943, "policy_loss": -0.010117173574158686, "vf_loss": 6.827544871382059, "vf_explained_var": 0.0007511211279482126, "kl": 0.007369894253346231, "entropy": 0.5688515140479619, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 530535.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 1590.0, "episode_reward_min": 200.0, "episode_reward_mean": 864.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 86.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [840.0, 670.0, 1020.0, 1150.0, 955.0, 800.0, 780.0, 1430.0, 800.0, 1270.0, 1505.0, 1180.0, 1070.0, 1040.0, 1000.0, 965.0, 840.0, 800.0, 430.0, 770.0, 200.0, 310.0, 500.0, 550.0, 1500.0, 1010.0, 600.0, 1050.0, 1115.0, 540.0, 455.0, 455.0, 760.0, 1360.0, 860.0, 770.0, 1170.0, 1200.0, 430.0, 745.0, 440.0, 620.0, 920.0, 330.0, 845.0, 1470.0, 1390.0, 1060.0, 360.0, 880.0, 1150.0, 820.0, 980.0, 1480.0, 620.0, 940.0, 345.0, 770.0, 1025.0, 1130.0, 1100.0, 850.0, 280.0, 520.0, 1130.0, 250.0, 400.0, 370.0, 550.0, 330.0, 1410.0, 1110.0, 710.0, 1360.0, 770.0, 875.0, 1115.0, 1090.0, 790.0, 360.0, 1170.0, 495.0, 730.0, 690.0, 980.0, 1035.0, 1200.0, 625.0, 1590.0, 1350.0, 680.0, 1010.0, 540.0, 495.0, 700.0, 905.0, 1110.0, 870.0, 1365.0, 1050.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 150.0, 80.0, 100.0, 60.0, 110.0, 30.0, 220.0, 30.0, 40.0, 80.0, 160.0, 30.0, 80.0, 80.0, 30.0, 70.0, 10.0, 20.0, 110.0, 50.0, 80.0, 20.0, 30.0, 110.0, 50.0, 20.0, 380.0, 250.0, 30.0, 350.0, 50.0, -50.0, 150.0, 40.0, 30.0, 90.0, 130.0, 40.0, 320.0, 40.0, 140.0, 15.0, 30.0, 60.0, 90.0, 150.0, 10.0, -30.0, 450.0, 20.0, 400.0, 30.0, 10.0, 160.0, 10.0, 30.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 90.0, 20.0, 190.0, 30.0, 10.0, 250.0, 80.0, 70.0, 230.0, 70.0, 60.0, 230.0, 90.0, 70.0, 170.0, 350.0, 90.0, 20.0, 10.0, 30.0, 10.0, 70.0, 180.0, 50.0, 20.0, 190.0, 220.0, 100.0, 0.0, 180.0, 100.0, 250.0, 390.0, 10.0, 70.0, 140.0, 30.0, 75.0, 200.0, 130.0, 240.0, 50.0, 270.0, 30.0, 270.0, 30.0, 210.0, 80.0, 50.0, 360.0, 100.0, 40.0, 50.0, 90.0, 70.0, 200.0, 140.0, 80.0, 0.0, 60.0, 30.0, 160.0, 170.0, 60.0, 20.0, 130.0, 360.0, 100.0, 300.0, 10.0, 30.0, 20.0, 80.0, 40.0, 10.0, 0.0, 450.0, 50.0, 180.0, 120.0, 120.0, 70.0, 40.0, 50.0, 270.0, 80.0, 20.0, 20.0, 310.0, 40.0, -30.0, 320.0, 50.0, 100.0, 30.0, 70.0, 55.0, 60.0, -20.0, 210.0, 140.0, -50.0, 80.0, -80.0, 40.0, 350.0, 110.0, 140.0, 80.0, 20.0, 20.0, 50.0, 280.0, 10.0, 30.0, 130.0, 40.0, 100.0, 0.0, 370.0, 10.0, -40.0, 40.0, -90.0, 20.0, -40.0, 60.0, 50.0, 10.0, 0.0, 80.0, 560.0, 30.0, 10.0, -10.0, 20.0, 20.0, 50.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 170.0, 10.0, 20.0, 35.0, 25.0, 40.0, 50.0, 110.0, 10.0, 10.0, 10.0, 120.0, 30.0, 10.0, 20.0, 130.0, 60.0, 70.0, 40.0, 0.0, 180.0, 40.0, 90.0, 20.0, 50.0, 0.0, 40.0, 390.0, 100.0, 30.0, 110.0, 10.0, 270.0, 320.0, 170.0, 60.0, 70.0, 40.0, 90.0, 120.0, 240.0, 110.0, 140.0, 80.0, 80.0, 40.0, 30.0, 0.0, 130.0, 30.0, 40.0, 120.0, 70.0, 80.0, 30.0, 70.0, 30.0, 310.0, 70.0, 40.0, 300.0, 130.0, 100.0, 50.0, 10.0, 10.0, 260.0, -5.0, 70.0, 140.0, 30.0, 100.0, 30.0, 250.0, 210.0, 30.0, 40.0, 70.0, 60.0, 180.0, 60.0, 20.0, 20.0, -30.0, 20.0, 100.0, 30.0, 50.0, -40.0, 30.0, -40.0, 30.0, 365.0, 10.0, 0.0, 20.0, 80.0, 50.0, 40.0, 20.0, 30.0, 65.0, 30.0, 30.0, 30.0, 80.0, 50.0, 100.0, 30.0, 0.0, 130.0, 30.0, 60.0, 240.0, 40.0, 80.0, -10.0, 20.0, 110.0, 190.0, 90.0, 440.0, 320.0, 160.0, 90.0, -50.0, 90.0, 170.0, 130.0, 140.0, 50.0, 10.0, 30.0, 20.0, 70.0, 150.0, 60.0, 110.0, 100.0, 50.0, 60.0, 170.0, 150.0, 0.0, -10.0, 80.0, 120.0, 90.0, 0.0, 290.0, 140.0, 190.0, 240.0, 10.0, 20.0, 70.0, 70.0, 20.0, 90.0, 40.0, 90.0, 100.0, 80.0, 580.0, 20.0, 110.0, 10.0, 0.0, 10.0, 80.0, 40.0, 30.0, 200.0, 10.0, 30.0, 20.0, -20.0, 100.0, 20.0, 30.0, 40.0, 80.0, 70.0, 75.0, 40.0, 310.0, 30.0, 30.0, 0.0, 10.0, 0.0, 80.0, 20.0, 10.0, 260.0, 0.0, 10.0, 70.0, 80.0, 20.0, 180.0, 30.0, 100.0, 40.0, 30.0, 60.0, 40.0, 170.0, 240.0, 80.0, -30.0, 210.0, 0.0, 60.0, 20.0, 130.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 10.0, 100.0, 20.0, 10.0, 20.0, 150.0, 100.0, 0.0, 0.0, 390.0, -5.0, 120.0, 40.0, 30.0, 120.0, 20.0, 50.0, 70.0, 50.0, 150.0, 160.0, 60.0, 740.0, 50.0, 80.0, 120.0, 30.0, 440.0, 270.0, 70.0, 100.0, 130.0, 110.0, 40.0, -50.0, -10.0, 10.0, 60.0, 70.0, 180.0, 0.0, 190.0, 230.0, 380.0, 210.0, 10.0, 10.0, 15.0, 80.0, 20.0, -55.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 200.0, 20.0, 280.0, 80.0, 130.0, 60.0, -30.0, 220.0, 30.0, 280.0, 130.0, 40.0, 40.0, 20.0, 140.0, 280.0, 180.0, 40.0, 10.0, 50.0, 350.0, 40.0, 20.0, 70.0, 40.0, 20.0, 180.0, 110.0, 60.0, 200.0, 20.0, 10.0, 180.0, 40.0, 70.0, 110.0, -10.0, 10.0, 100.0, 50.0, 180.0, 190.0, 10.0, 370.0, 150.0, 430.0, 190.0, 10.0, 70.0, 20.0, 20.0, 10.0, 70.0, 50.0, 120.0, 60.0, 40.0, 0.0, 40.0, 60.0, 40.0, -60.0, 720.0, -90.0, 160.0, 30.0, 0.0, 20.0, 30.0, 110.0, 30.0, 5.0, 100.0, 0.0, 50.0, 0.0, 20.0, 50.0, 160.0, 80.0, 30.0, 100.0, 30.0, 30.0, 10.0, 260.0, 20.0, 100.0, 180.0, 10.0, 55.0, -10.0, 30.0, 150.0, 300.0, 190.0, -40.0, 200.0, 70.0, -10.0, -20.0, 10.0, 50.0, 620.0, 30.0, 220.0, 50.0, 10.0, 680.0, 0.0, -60.0, -20.0, 280.0, 90.0, 50.0, 20.0, 20.0, 20.0, 50.0, -80.0, 590.0, -10.0, 40.0, 170.0, -20.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 0.0, 40.0, 30.0, 40.0, 40.0, 70.0, 10.0, 40.0, 130.0, 20.0, 80.0, 40.0, 90.0, 0.0, 330.0, 170.0, 80.0, 130.0, 80.0, 90.0, 30.0, 100.0, 60.0, 60.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, -90.0, 30.0, 140.0, 40.0, 20.0, 140.0, 70.0, 30.0, 50.0, 20.0, 10.0, 30.0, 0.0, 150.0, 10.0, 0.0, 110.0, 30.0, -70.0, -90.0, 270.0, 30.0, 50.0, 50.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 20.0, 190.0, 0.0, 290.0, 360.0, 20.0, 160.0, 70.0, 320.0, 20.0, 40.0, 60.0, 70.0, 20.0, 40.0, 90.0, 140.0, 110.0, 30.0, 260.0, 90.0, 180.0, 150.0, 0.0, 30.0, 40.0, 10.0, 70.0, 150.0, 160.0, 60.0, 150.0, 40.0, 80.0, 70.0, 60.0, 30.0, 30.0, 260.0, 260.0, 180.0, 300.0, 90.0, 40.0, 80.0, 60.0, 80.0, 70.0, 160.0, 80.0, 20.0, 60.0, 120.0, -45.0, 40.0, 60.0, -40.0, 550.0, 50.0, 0.0, 100.0, 20.0, 140.0, 120.0, 40.0, 360.0, 140.0, 15.0, 180.0, 20.0, 40.0, 160.0, 40.0, 80.0, 50.0, 80.0, 80.0, 210.0, 130.0, 70.0, 130.0, 110.0, 150.0, 90.0, 30.0, 0.0, 30.0, 20.0, 280.0, 60.0, 160.0, 30.0, 90.0, 30.0, 0.0, 30.0, 40.0, 20.0, 20.0, 40.0, 20.0, 20.0, 140.0, 70.0, 30.0, 260.0, 100.0, 90.0, 40.0, 160.0, 70.0, 300.0, 50.0, 0.0, 60.0, 10.0, 30.0, 10.0, 15.0, 40.0, 180.0, 90.0, 60.0, 60.0, 40.0, 0.0, 40.0, 120.0, 40.0, 310.0, 20.0, 100.0, 0.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 150.0, 80.0, 310.0, 10.0, 260.0, 40.0, 100.0, 30.0, 20.0, 10.0, 160.0, 280.0, 30.0, 50.0, 270.0, 40.0, 10.0, 20.0, 30.0, 35.0, 20.0, 190.0, 40.0, 380.0, 270.0, 30.0, 90.0, 30.0, 210.0, 10.0, 120.0, 90.0, 270.0, 80.0, 200.0, -105.0, 20.0, 70.0, 20.0, 0.0, 370.0, -10.0, 30.0, 30.0, 140.0, 60.0, 80.0, 20.0, 290.0, 170.0, 430.0, 50.0, 150.0, 200.0, 70.0, 30.0, 130.0, 80.0, 290.0, 160.0, 180.0, 60.0, 300.0, 50.0, 10.0, 30.0, 80.0, 190.0, 50.0, 10.0, 270.0, 50.0, -40.0, 30.0, 130.0, 160.0, 50.0, 80.0, 120.0, 80.0, 40.0, 160.0, 100.0, 90.0, 30.0, 20.0, 350.0, 10.0, 30.0, -10.0, 0.0, 30.0, 30.0, 50.0, 10.0, 320.0, 0.0, 40.0, 40.0, 0.0, 15.0, 20.0, 0.0, 50.0, 50.0, 40.0, 0.0, 0.0, 20.0, 260.0, 30.0, 20.0, 260.0, 20.0, 180.0, 80.0, 25.0, 380.0, 10.0, 10.0, -10.0, 80.0, 30.0, 120.0, 30.0, 30.0, 280.0, 40.0, 0.0, 90.0, 40.0, 300.0, 200.0, 100.0, 70.0, -30.0, 40.0, 170.0, 250.0, 40.0, 90.0, 80.0, 120.0, 40.0, -85.0, 180.0, 80.0, 70.0, 160.0, 400.0, 30.0, -10.0, 180.0, 360.0, 380.0, 150.0, 20.0, 200.0, 30.0, 40.0, 30.0, 70.0, 60.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.538945674366354, "mean_inference_ms": 1.4181250504500253, "mean_action_processing_ms": 0.43145260202370106, "mean_env_wait_ms": 1.264462771406506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012739181518554688, "StateBufferConnector_ms": 0.009743452072143555, "ViewRequirementAgentConnector_ms": 0.39745140075683594}, "num_episodes": 22, "episode_return_max": 1590.0, "episode_return_min": 200.0, "episode_return_mean": 864.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.525349566656747, "num_env_steps_trained_throughput_per_sec": 21.525349566656747, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 187433.21, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187433.162, "sample_time_ms": 2649.185, "learn_time_ms": 184764.489, "learn_throughput": 21.649, "synch_weights_time_ms": 11.778}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 57, "trial_id": "90816_00000", "date": "2024-06-10_03-11-32", "timestamp": 1718003492, "time_this_iter_s": 185.83623814582825, "time_total_s": 10770.151327848434, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00e1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10770.151327848434, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.150570342205324, "ram_util_percent": 79.15931558935361}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.330562334491041, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.775287114418607, "policy_loss": -0.008388608539153656, "vf_loss": 5.782342316675237, "vf_explained_var": 0.0014876209254970692, "kl": 0.006667034965163162, "entropy": 0.5621600348823749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 539925.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 1590.0, "episode_reward_min": 135.0, "episode_reward_mean": 833.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 83.39}, "custom_metrics": {}, "hist_stats": {"episode_reward": [550.0, 1500.0, 1010.0, 600.0, 1050.0, 1115.0, 540.0, 455.0, 455.0, 760.0, 1360.0, 860.0, 770.0, 1170.0, 1200.0, 430.0, 745.0, 440.0, 620.0, 920.0, 330.0, 845.0, 1470.0, 1390.0, 1060.0, 360.0, 880.0, 1150.0, 820.0, 980.0, 1480.0, 620.0, 940.0, 345.0, 770.0, 1025.0, 1130.0, 1100.0, 850.0, 280.0, 520.0, 1130.0, 250.0, 400.0, 370.0, 550.0, 330.0, 1410.0, 1110.0, 710.0, 1360.0, 770.0, 875.0, 1115.0, 1090.0, 790.0, 360.0, 1170.0, 495.0, 730.0, 690.0, 980.0, 1035.0, 1200.0, 625.0, 1590.0, 1350.0, 680.0, 1010.0, 540.0, 495.0, 700.0, 905.0, 1110.0, 870.0, 1365.0, 1050.0, 390.0, 525.0, 990.0, 135.0, 610.0, 1220.0, 775.0, 930.0, 340.0, 1180.0, 870.0, 1460.0, 510.0, 690.0, 1240.0, 600.0, 885.0, 490.0, 930.0, 630.0, 880.0, 805.0, 200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 70.0, 40.0, 0.0, 180.0, 40.0, 90.0, 20.0, 50.0, 0.0, 40.0, 390.0, 100.0, 30.0, 110.0, 10.0, 270.0, 320.0, 170.0, 60.0, 70.0, 40.0, 90.0, 120.0, 240.0, 110.0, 140.0, 80.0, 80.0, 40.0, 30.0, 0.0, 130.0, 30.0, 40.0, 120.0, 70.0, 80.0, 30.0, 70.0, 30.0, 310.0, 70.0, 40.0, 300.0, 130.0, 100.0, 50.0, 10.0, 10.0, 260.0, -5.0, 70.0, 140.0, 30.0, 100.0, 30.0, 250.0, 210.0, 30.0, 40.0, 70.0, 60.0, 180.0, 60.0, 20.0, 20.0, -30.0, 20.0, 100.0, 30.0, 50.0, -40.0, 30.0, -40.0, 30.0, 365.0, 10.0, 0.0, 20.0, 80.0, 50.0, 40.0, 20.0, 30.0, 65.0, 30.0, 30.0, 30.0, 80.0, 50.0, 100.0, 30.0, 0.0, 130.0, 30.0, 60.0, 240.0, 40.0, 80.0, -10.0, 20.0, 110.0, 190.0, 90.0, 440.0, 320.0, 160.0, 90.0, -50.0, 90.0, 170.0, 130.0, 140.0, 50.0, 10.0, 30.0, 20.0, 70.0, 150.0, 60.0, 110.0, 100.0, 50.0, 60.0, 170.0, 150.0, 0.0, -10.0, 80.0, 120.0, 90.0, 0.0, 290.0, 140.0, 190.0, 240.0, 10.0, 20.0, 70.0, 70.0, 20.0, 90.0, 40.0, 90.0, 100.0, 80.0, 580.0, 20.0, 110.0, 10.0, 0.0, 10.0, 80.0, 40.0, 30.0, 200.0, 10.0, 30.0, 20.0, -20.0, 100.0, 20.0, 30.0, 40.0, 80.0, 70.0, 75.0, 40.0, 310.0, 30.0, 30.0, 0.0, 10.0, 0.0, 80.0, 20.0, 10.0, 260.0, 0.0, 10.0, 70.0, 80.0, 20.0, 180.0, 30.0, 100.0, 40.0, 30.0, 60.0, 40.0, 170.0, 240.0, 80.0, -30.0, 210.0, 0.0, 60.0, 20.0, 130.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 10.0, 100.0, 20.0, 10.0, 20.0, 150.0, 100.0, 0.0, 0.0, 390.0, -5.0, 120.0, 40.0, 30.0, 120.0, 20.0, 50.0, 70.0, 50.0, 150.0, 160.0, 60.0, 740.0, 50.0, 80.0, 120.0, 30.0, 440.0, 270.0, 70.0, 100.0, 130.0, 110.0, 40.0, -50.0, -10.0, 10.0, 60.0, 70.0, 180.0, 0.0, 190.0, 230.0, 380.0, 210.0, 10.0, 10.0, 15.0, 80.0, 20.0, -55.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 200.0, 20.0, 280.0, 80.0, 130.0, 60.0, -30.0, 220.0, 30.0, 280.0, 130.0, 40.0, 40.0, 20.0, 140.0, 280.0, 180.0, 40.0, 10.0, 50.0, 350.0, 40.0, 20.0, 70.0, 40.0, 20.0, 180.0, 110.0, 60.0, 200.0, 20.0, 10.0, 180.0, 40.0, 70.0, 110.0, -10.0, 10.0, 100.0, 50.0, 180.0, 190.0, 10.0, 370.0, 150.0, 430.0, 190.0, 10.0, 70.0, 20.0, 20.0, 10.0, 70.0, 50.0, 120.0, 60.0, 40.0, 0.0, 40.0, 60.0, 40.0, -60.0, 720.0, -90.0, 160.0, 30.0, 0.0, 20.0, 30.0, 110.0, 30.0, 5.0, 100.0, 0.0, 50.0, 0.0, 20.0, 50.0, 160.0, 80.0, 30.0, 100.0, 30.0, 30.0, 10.0, 260.0, 20.0, 100.0, 180.0, 10.0, 55.0, -10.0, 30.0, 150.0, 300.0, 190.0, -40.0, 200.0, 70.0, -10.0, -20.0, 10.0, 50.0, 620.0, 30.0, 220.0, 50.0, 10.0, 680.0, 0.0, -60.0, -20.0, 280.0, 90.0, 50.0, 20.0, 20.0, 20.0, 50.0, -80.0, 590.0, -10.0, 40.0, 170.0, -20.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 0.0, 40.0, 30.0, 40.0, 40.0, 70.0, 10.0, 40.0, 130.0, 20.0, 80.0, 40.0, 90.0, 0.0, 330.0, 170.0, 80.0, 130.0, 80.0, 90.0, 30.0, 100.0, 60.0, 60.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, -90.0, 30.0, 140.0, 40.0, 20.0, 140.0, 70.0, 30.0, 50.0, 20.0, 10.0, 30.0, 0.0, 150.0, 10.0, 0.0, 110.0, 30.0, -70.0, -90.0, 270.0, 30.0, 50.0, 50.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 20.0, 190.0, 0.0, 290.0, 360.0, 20.0, 160.0, 70.0, 320.0, 20.0, 40.0, 60.0, 70.0, 20.0, 40.0, 90.0, 140.0, 110.0, 30.0, 260.0, 90.0, 180.0, 150.0, 0.0, 30.0, 40.0, 10.0, 70.0, 150.0, 160.0, 60.0, 150.0, 40.0, 80.0, 70.0, 60.0, 30.0, 30.0, 260.0, 260.0, 180.0, 300.0, 90.0, 40.0, 80.0, 60.0, 80.0, 70.0, 160.0, 80.0, 20.0, 60.0, 120.0, -45.0, 40.0, 60.0, -40.0, 550.0, 50.0, 0.0, 100.0, 20.0, 140.0, 120.0, 40.0, 360.0, 140.0, 15.0, 180.0, 20.0, 40.0, 160.0, 40.0, 80.0, 50.0, 80.0, 80.0, 210.0, 130.0, 70.0, 130.0, 110.0, 150.0, 90.0, 30.0, 0.0, 30.0, 20.0, 280.0, 60.0, 160.0, 30.0, 90.0, 30.0, 0.0, 30.0, 40.0, 20.0, 20.0, 40.0, 20.0, 20.0, 140.0, 70.0, 30.0, 260.0, 100.0, 90.0, 40.0, 160.0, 70.0, 300.0, 50.0, 0.0, 60.0, 10.0, 30.0, 10.0, 15.0, 40.0, 180.0, 90.0, 60.0, 60.0, 40.0, 0.0, 40.0, 120.0, 40.0, 310.0, 20.0, 100.0, 0.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 150.0, 80.0, 310.0, 10.0, 260.0, 40.0, 100.0, 30.0, 20.0, 10.0, 160.0, 280.0, 30.0, 50.0, 270.0, 40.0, 10.0, 20.0, 30.0, 35.0, 20.0, 190.0, 40.0, 380.0, 270.0, 30.0, 90.0, 30.0, 210.0, 10.0, 120.0, 90.0, 270.0, 80.0, 200.0, -105.0, 20.0, 70.0, 20.0, 0.0, 370.0, -10.0, 30.0, 30.0, 140.0, 60.0, 80.0, 20.0, 290.0, 170.0, 430.0, 50.0, 150.0, 200.0, 70.0, 30.0, 130.0, 80.0, 290.0, 160.0, 180.0, 60.0, 300.0, 50.0, 10.0, 30.0, 80.0, 190.0, 50.0, 10.0, 270.0, 50.0, -40.0, 30.0, 130.0, 160.0, 50.0, 80.0, 120.0, 80.0, 40.0, 160.0, 100.0, 90.0, 30.0, 20.0, 350.0, 10.0, 30.0, -10.0, 0.0, 30.0, 30.0, 50.0, 10.0, 320.0, 0.0, 40.0, 40.0, 0.0, 15.0, 20.0, 0.0, 50.0, 50.0, 40.0, 0.0, 0.0, 20.0, 260.0, 30.0, 20.0, 260.0, 20.0, 180.0, 80.0, 25.0, 380.0, 10.0, 10.0, -10.0, 80.0, 30.0, 120.0, 30.0, 30.0, 280.0, 40.0, 0.0, 90.0, 40.0, 300.0, 200.0, 100.0, 70.0, -30.0, 40.0, 170.0, 250.0, 40.0, 90.0, 80.0, 120.0, 40.0, -85.0, 180.0, 80.0, 70.0, 160.0, 400.0, 30.0, -10.0, 180.0, 360.0, 380.0, 150.0, 20.0, 200.0, 30.0, 40.0, 30.0, 70.0, 60.0, 70.0, 40.0, 10.0, 30.0, 40.0, 70.0, 20.0, 40.0, 20.0, 60.0, 60.0, 20.0, -5.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 200.0, 180.0, 120.0, 130.0, 60.0, 160.0, 40.0, 40.0, 290.0, 50.0, 30.0, 70.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -25.0, 40.0, 0.0, 50.0, 30.0, 40.0, 20.0, 110.0, 20.0, 100.0, 60.0, 150.0, 20.0, 60.0, 90.0, 110.0, 0.0, 460.0, 10.0, 60.0, 240.0, 220.0, 30.0, 0.0, 60.0, 90.0, 50.0, 60.0, 60.0, 40.0, 70.0, 30.0, 5.0, 310.0, 40.0, 20.0, 70.0, 20.0, 70.0, 80.0, 10.0, 110.0, 0.0, 510.0, -50.0, 10.0, 90.0, 30.0, 40.0, 70.0, -20.0, 50.0, 130.0, -10.0, 30.0, 50.0, 20.0, 220.0, 150.0, 60.0, 80.0, 260.0, 110.0, 200.0, -80.0, 190.0, 370.0, 240.0, 70.0, 0.0, 60.0, 40.0, 30.0, -50.0, 90.0, 70.0, 410.0, 200.0, 260.0, 70.0, -30.0, 50.0, 140.0, 200.0, -40.0, 120.0, 0.0, 30.0, 20.0, 70.0, 10.0, 30.0, 250.0, 20.0, 110.0, 70.0, 20.0, 190.0, 110.0, 70.0, 20.0, -50.0, 10.0, 140.0, 20.0, 130.0, 210.0, 150.0, 10.0, 50.0, 70.0, 150.0, 220.0, 230.0, 0.0, 10.0, 240.0, 70.0, 200.0, 50.0, 10.0, 10.0, 10.0, 0.0, 15.0, 120.0, 190.0, 30.0, 240.0, 30.0, 90.0, 130.0, 30.0, 10.0, 20.0, 10.0, 120.0, 60.0, 30.0, 40.0, 90.0, 10.0, 50.0, 60.0, 10.0, 90.0, 0.0, 40.0, -30.0, 730.0, 40.0, 30.0, 10.0, 10.0, 10.0, 40.0, 100.0, 40.0, 110.0, 70.0, 40.0, 20.0, 30.0, 170.0, 10.0, 20.0, 100.0, 70.0, 20.0, 90.0, 150.0, 150.0, 80.0, 190.0, 70.0, 60.0, 20.0, 480.0, -75.0, 70.0, 80.0, -20.0, 70.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 70.0, 20.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.538048991941419, "mean_inference_ms": 1.4194751388293938, "mean_action_processing_ms": 0.43492216881841794, "mean_env_wait_ms": 1.2649498119819773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012686729431152344, "StateBufferConnector_ms": 0.010859489440917969, "ViewRequirementAgentConnector_ms": 0.3981935977935791}, "num_episodes": 23, "episode_return_max": 1590.0, "episode_return_min": 135.0, "episode_return_mean": 833.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.267238182182282, "num_env_steps_trained_throughput_per_sec": 21.267238182182282, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 187576.4, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187576.353, "sample_time_ms": 2676.826, "learn_time_ms": 184880.1, "learn_throughput": 21.636, "synch_weights_time_ms": 11.729}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 58, "trial_id": "90816_00000", "date": "2024-06-10_03-14-40", "timestamp": 1718003680, "time_this_iter_s": 188.09293413162231, "time_total_s": 10958.244261980057, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00cb790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10958.244261980057, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 18.340601503759398, "ram_util_percent": 79.84172932330827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1491423933777694, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.360617757681459, "policy_loss": -0.008376527850737317, "vf_loss": 6.367606483353847, "vf_explained_var": 0.00023694284680806282, "kl": 0.006938993288479343, "entropy": 0.5443521854405206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 549315.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "env_runners": {"episode_reward_max": 1630.0, "episode_reward_min": 135.0, "episode_reward_mean": 834.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 83.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [620.0, 920.0, 330.0, 845.0, 1470.0, 1390.0, 1060.0, 360.0, 880.0, 1150.0, 820.0, 980.0, 1480.0, 620.0, 940.0, 345.0, 770.0, 1025.0, 1130.0, 1100.0, 850.0, 280.0, 520.0, 1130.0, 250.0, 400.0, 370.0, 550.0, 330.0, 1410.0, 1110.0, 710.0, 1360.0, 770.0, 875.0, 1115.0, 1090.0, 790.0, 360.0, 1170.0, 495.0, 730.0, 690.0, 980.0, 1035.0, 1200.0, 625.0, 1590.0, 1350.0, 680.0, 1010.0, 540.0, 495.0, 700.0, 905.0, 1110.0, 870.0, 1365.0, 1050.0, 390.0, 525.0, 990.0, 135.0, 610.0, 1220.0, 775.0, 930.0, 340.0, 1180.0, 870.0, 1460.0, 510.0, 690.0, 1240.0, 600.0, 885.0, 490.0, 930.0, 630.0, 880.0, 805.0, 200.0, 700.0, 710.0, 630.0, 730.0, 840.0, 1300.0, 1630.0, 545.0, 200.0, 440.0, 1070.0, 950.0, 1450.0, 205.0, 1570.0, 560.0, 820.0, 690.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 70.0, 80.0, 20.0, 180.0, 30.0, 100.0, 40.0, 30.0, 60.0, 40.0, 170.0, 240.0, 80.0, -30.0, 210.0, 0.0, 60.0, 20.0, 130.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 10.0, 100.0, 20.0, 10.0, 20.0, 150.0, 100.0, 0.0, 0.0, 390.0, -5.0, 120.0, 40.0, 30.0, 120.0, 20.0, 50.0, 70.0, 50.0, 150.0, 160.0, 60.0, 740.0, 50.0, 80.0, 120.0, 30.0, 440.0, 270.0, 70.0, 100.0, 130.0, 110.0, 40.0, -50.0, -10.0, 10.0, 60.0, 70.0, 180.0, 0.0, 190.0, 230.0, 380.0, 210.0, 10.0, 10.0, 15.0, 80.0, 20.0, -55.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, 40.0, 200.0, 20.0, 280.0, 80.0, 130.0, 60.0, -30.0, 220.0, 30.0, 280.0, 130.0, 40.0, 40.0, 20.0, 140.0, 280.0, 180.0, 40.0, 10.0, 50.0, 350.0, 40.0, 20.0, 70.0, 40.0, 20.0, 180.0, 110.0, 60.0, 200.0, 20.0, 10.0, 180.0, 40.0, 70.0, 110.0, -10.0, 10.0, 100.0, 50.0, 180.0, 190.0, 10.0, 370.0, 150.0, 430.0, 190.0, 10.0, 70.0, 20.0, 20.0, 10.0, 70.0, 50.0, 120.0, 60.0, 40.0, 0.0, 40.0, 60.0, 40.0, -60.0, 720.0, -90.0, 160.0, 30.0, 0.0, 20.0, 30.0, 110.0, 30.0, 5.0, 100.0, 0.0, 50.0, 0.0, 20.0, 50.0, 160.0, 80.0, 30.0, 100.0, 30.0, 30.0, 10.0, 260.0, 20.0, 100.0, 180.0, 10.0, 55.0, -10.0, 30.0, 150.0, 300.0, 190.0, -40.0, 200.0, 70.0, -10.0, -20.0, 10.0, 50.0, 620.0, 30.0, 220.0, 50.0, 10.0, 680.0, 0.0, -60.0, -20.0, 280.0, 90.0, 50.0, 20.0, 20.0, 20.0, 50.0, -80.0, 590.0, -10.0, 40.0, 170.0, -20.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 0.0, 40.0, 30.0, 40.0, 40.0, 70.0, 10.0, 40.0, 130.0, 20.0, 80.0, 40.0, 90.0, 0.0, 330.0, 170.0, 80.0, 130.0, 80.0, 90.0, 30.0, 100.0, 60.0, 60.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, -90.0, 30.0, 140.0, 40.0, 20.0, 140.0, 70.0, 30.0, 50.0, 20.0, 10.0, 30.0, 0.0, 150.0, 10.0, 0.0, 110.0, 30.0, -70.0, -90.0, 270.0, 30.0, 50.0, 50.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 20.0, 190.0, 0.0, 290.0, 360.0, 20.0, 160.0, 70.0, 320.0, 20.0, 40.0, 60.0, 70.0, 20.0, 40.0, 90.0, 140.0, 110.0, 30.0, 260.0, 90.0, 180.0, 150.0, 0.0, 30.0, 40.0, 10.0, 70.0, 150.0, 160.0, 60.0, 150.0, 40.0, 80.0, 70.0, 60.0, 30.0, 30.0, 260.0, 260.0, 180.0, 300.0, 90.0, 40.0, 80.0, 60.0, 80.0, 70.0, 160.0, 80.0, 20.0, 60.0, 120.0, -45.0, 40.0, 60.0, -40.0, 550.0, 50.0, 0.0, 100.0, 20.0, 140.0, 120.0, 40.0, 360.0, 140.0, 15.0, 180.0, 20.0, 40.0, 160.0, 40.0, 80.0, 50.0, 80.0, 80.0, 210.0, 130.0, 70.0, 130.0, 110.0, 150.0, 90.0, 30.0, 0.0, 30.0, 20.0, 280.0, 60.0, 160.0, 30.0, 90.0, 30.0, 0.0, 30.0, 40.0, 20.0, 20.0, 40.0, 20.0, 20.0, 140.0, 70.0, 30.0, 260.0, 100.0, 90.0, 40.0, 160.0, 70.0, 300.0, 50.0, 0.0, 60.0, 10.0, 30.0, 10.0, 15.0, 40.0, 180.0, 90.0, 60.0, 60.0, 40.0, 0.0, 40.0, 120.0, 40.0, 310.0, 20.0, 100.0, 0.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 150.0, 80.0, 310.0, 10.0, 260.0, 40.0, 100.0, 30.0, 20.0, 10.0, 160.0, 280.0, 30.0, 50.0, 270.0, 40.0, 10.0, 20.0, 30.0, 35.0, 20.0, 190.0, 40.0, 380.0, 270.0, 30.0, 90.0, 30.0, 210.0, 10.0, 120.0, 90.0, 270.0, 80.0, 200.0, -105.0, 20.0, 70.0, 20.0, 0.0, 370.0, -10.0, 30.0, 30.0, 140.0, 60.0, 80.0, 20.0, 290.0, 170.0, 430.0, 50.0, 150.0, 200.0, 70.0, 30.0, 130.0, 80.0, 290.0, 160.0, 180.0, 60.0, 300.0, 50.0, 10.0, 30.0, 80.0, 190.0, 50.0, 10.0, 270.0, 50.0, -40.0, 30.0, 130.0, 160.0, 50.0, 80.0, 120.0, 80.0, 40.0, 160.0, 100.0, 90.0, 30.0, 20.0, 350.0, 10.0, 30.0, -10.0, 0.0, 30.0, 30.0, 50.0, 10.0, 320.0, 0.0, 40.0, 40.0, 0.0, 15.0, 20.0, 0.0, 50.0, 50.0, 40.0, 0.0, 0.0, 20.0, 260.0, 30.0, 20.0, 260.0, 20.0, 180.0, 80.0, 25.0, 380.0, 10.0, 10.0, -10.0, 80.0, 30.0, 120.0, 30.0, 30.0, 280.0, 40.0, 0.0, 90.0, 40.0, 300.0, 200.0, 100.0, 70.0, -30.0, 40.0, 170.0, 250.0, 40.0, 90.0, 80.0, 120.0, 40.0, -85.0, 180.0, 80.0, 70.0, 160.0, 400.0, 30.0, -10.0, 180.0, 360.0, 380.0, 150.0, 20.0, 200.0, 30.0, 40.0, 30.0, 70.0, 60.0, 70.0, 40.0, 10.0, 30.0, 40.0, 70.0, 20.0, 40.0, 20.0, 60.0, 60.0, 20.0, -5.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 200.0, 180.0, 120.0, 130.0, 60.0, 160.0, 40.0, 40.0, 290.0, 50.0, 30.0, 70.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -25.0, 40.0, 0.0, 50.0, 30.0, 40.0, 20.0, 110.0, 20.0, 100.0, 60.0, 150.0, 20.0, 60.0, 90.0, 110.0, 0.0, 460.0, 10.0, 60.0, 240.0, 220.0, 30.0, 0.0, 60.0, 90.0, 50.0, 60.0, 60.0, 40.0, 70.0, 30.0, 5.0, 310.0, 40.0, 20.0, 70.0, 20.0, 70.0, 80.0, 10.0, 110.0, 0.0, 510.0, -50.0, 10.0, 90.0, 30.0, 40.0, 70.0, -20.0, 50.0, 130.0, -10.0, 30.0, 50.0, 20.0, 220.0, 150.0, 60.0, 80.0, 260.0, 110.0, 200.0, -80.0, 190.0, 370.0, 240.0, 70.0, 0.0, 60.0, 40.0, 30.0, -50.0, 90.0, 70.0, 410.0, 200.0, 260.0, 70.0, -30.0, 50.0, 140.0, 200.0, -40.0, 120.0, 0.0, 30.0, 20.0, 70.0, 10.0, 30.0, 250.0, 20.0, 110.0, 70.0, 20.0, 190.0, 110.0, 70.0, 20.0, -50.0, 10.0, 140.0, 20.0, 130.0, 210.0, 150.0, 10.0, 50.0, 70.0, 150.0, 220.0, 230.0, 0.0, 10.0, 240.0, 70.0, 200.0, 50.0, 10.0, 10.0, 10.0, 0.0, 15.0, 120.0, 190.0, 30.0, 240.0, 30.0, 90.0, 130.0, 30.0, 10.0, 20.0, 10.0, 120.0, 60.0, 30.0, 40.0, 90.0, 10.0, 50.0, 60.0, 10.0, 90.0, 0.0, 40.0, -30.0, 730.0, 40.0, 30.0, 10.0, 10.0, 10.0, 40.0, 100.0, 40.0, 110.0, 70.0, 40.0, 20.0, 30.0, 170.0, 10.0, 20.0, 100.0, 70.0, 20.0, 90.0, 150.0, 150.0, 80.0, 190.0, 70.0, 60.0, 20.0, 480.0, -75.0, 70.0, 80.0, -20.0, 70.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 70.0, 20.0, 0.0, 30.0, 100.0, 530.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, -50.0, 50.0, 20.0, 80.0, 40.0, 110.0, 100.0, 0.0, 30.0, 120.0, 160.0, 20.0, -50.0, -100.0, 0.0, 60.0, 50.0, 560.0, 0.0, 30.0, 60.0, 350.0, 90.0, 30.0, 80.0, 40.0, 30.0, 10.0, 60.0, 30.0, 10.0, 80.0, 30.0, 0.0, 20.0, 70.0, 220.0, 100.0, 130.0, 160.0, 30.0, 10.0, 70.0, 30.0, 80.0, 310.0, 200.0, 220.0, 60.0, 30.0, 290.0, 60.0, 30.0, 80.0, 60.0, 380.0, 420.0, 100.0, 220.0, 170.0, 110.0, 30.0, 120.0, 30.0, 50.0, -50.0, 60.0, -55.0, 130.0, 80.0, 150.0, 0.0, 20.0, 50.0, 30.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 80.0, 0.0, 10.0, 70.0, 20.0, 20.0, 80.0, 0.0, 70.0, 90.0, 100.0, 300.0, 30.0, 110.0, 150.0, 10.0, 60.0, 130.0, 160.0, 20.0, 170.0, 250.0, 50.0, 160.0, 10.0, 0.0, 60.0, 180.0, 40.0, 30.0, 40.0, -60.0, -10.0, 890.0, -20.0, 160.0, -60.0, 530.0, 90.0, -110.0, 30.0, 10.0, 0.0, 80.0, -25.0, 0.0, 10.0, 10.0, 10.0, 80.0, 390.0, 450.0, 120.0, 140.0, 50.0, 240.0, 130.0, -20.0, 50.0, 20.0, 270.0, 90.0, 100.0, 50.0, 0.0, -100.0, 40.0, 30.0, 80.0, 0.0, 60.0, 220.0, 20.0, 40.0, 150.0, 60.0, 10.0, 40.0, 160.0, 60.0, 160.0, 260.0, 80.0, 0.0, 10.0, 130.0, 40.0, 0.0, 50.0, -40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.537331442622156, "mean_inference_ms": 1.4204083475914777, "mean_action_processing_ms": 0.4376478794866167, "mean_env_wait_ms": 1.2653284308635981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012455940246582031, "StateBufferConnector_ms": 0.010749340057373047, "ViewRequirementAgentConnector_ms": 0.41967129707336426}, "num_episodes": 18, "episode_return_max": 1630.0, "episode_return_min": 135.0, "episode_return_mean": 834.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.420096856991403, "num_env_steps_trained_throughput_per_sec": 21.420096856991403, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 2360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2360000, "timers": {"training_iteration_time_ms": 187709.83, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187709.783, "sample_time_ms": 2678.614, "learn_time_ms": 185011.67, "learn_throughput": 21.62, "synch_weights_time_ms": 11.759}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "done": false, "training_iteration": 59, "trial_id": "90816_00000", "date": "2024-06-10_03-17-46", "timestamp": 1718003866, "time_this_iter_s": 186.75102162361145, "time_total_s": 11144.995283603668, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f4c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11144.995283603668, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 17.740909090909092, "ram_util_percent": 79.14696969696969}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.386945688311919, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.063412444964765, "policy_loss": -0.008464635425114348, "vf_loss": 6.070567877528767, "vf_explained_var": 0.0016376781387450977, "kl": 0.006546024258284145, "entropy": 0.5617620427482806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 558705.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 1630.0, "episode_reward_min": 110.0, "episode_reward_mean": 815.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 81.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1130.0, 1100.0, 850.0, 280.0, 520.0, 1130.0, 250.0, 400.0, 370.0, 550.0, 330.0, 1410.0, 1110.0, 710.0, 1360.0, 770.0, 875.0, 1115.0, 1090.0, 790.0, 360.0, 1170.0, 495.0, 730.0, 690.0, 980.0, 1035.0, 1200.0, 625.0, 1590.0, 1350.0, 680.0, 1010.0, 540.0, 495.0, 700.0, 905.0, 1110.0, 870.0, 1365.0, 1050.0, 390.0, 525.0, 990.0, 135.0, 610.0, 1220.0, 775.0, 930.0, 340.0, 1180.0, 870.0, 1460.0, 510.0, 690.0, 1240.0, 600.0, 885.0, 490.0, 930.0, 630.0, 880.0, 805.0, 200.0, 700.0, 710.0, 630.0, 730.0, 840.0, 1300.0, 1630.0, 545.0, 200.0, 440.0, 1070.0, 950.0, 1450.0, 205.0, 1570.0, 560.0, 820.0, 690.0, 675.0, 580.0, 1220.0, 600.0, 355.0, 1050.0, 310.0, 110.0, 1360.0, 995.0, 950.0, 490.0, 880.0, 1170.0, 630.0, 845.0, 980.0, 945.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-40.0, 200.0, 70.0, -10.0, -20.0, 10.0, 50.0, 620.0, 30.0, 220.0, 50.0, 10.0, 680.0, 0.0, -60.0, -20.0, 280.0, 90.0, 50.0, 20.0, 20.0, 20.0, 50.0, -80.0, 590.0, -10.0, 40.0, 170.0, -20.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 30.0, 0.0, 40.0, 30.0, 40.0, 40.0, 70.0, 10.0, 40.0, 130.0, 20.0, 80.0, 40.0, 90.0, 0.0, 330.0, 170.0, 80.0, 130.0, 80.0, 90.0, 30.0, 100.0, 60.0, 60.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 20.0, 40.0, 50.0, -90.0, 30.0, 140.0, 40.0, 20.0, 140.0, 70.0, 30.0, 50.0, 20.0, 10.0, 30.0, 0.0, 150.0, 10.0, 0.0, 110.0, 30.0, -70.0, -90.0, 270.0, 30.0, 50.0, 50.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 10.0, 20.0, 30.0, 20.0, 190.0, 0.0, 290.0, 360.0, 20.0, 160.0, 70.0, 320.0, 20.0, 40.0, 60.0, 70.0, 20.0, 40.0, 90.0, 140.0, 110.0, 30.0, 260.0, 90.0, 180.0, 150.0, 0.0, 30.0, 40.0, 10.0, 70.0, 150.0, 160.0, 60.0, 150.0, 40.0, 80.0, 70.0, 60.0, 30.0, 30.0, 260.0, 260.0, 180.0, 300.0, 90.0, 40.0, 80.0, 60.0, 80.0, 70.0, 160.0, 80.0, 20.0, 60.0, 120.0, -45.0, 40.0, 60.0, -40.0, 550.0, 50.0, 0.0, 100.0, 20.0, 140.0, 120.0, 40.0, 360.0, 140.0, 15.0, 180.0, 20.0, 40.0, 160.0, 40.0, 80.0, 50.0, 80.0, 80.0, 210.0, 130.0, 70.0, 130.0, 110.0, 150.0, 90.0, 30.0, 0.0, 30.0, 20.0, 280.0, 60.0, 160.0, 30.0, 90.0, 30.0, 0.0, 30.0, 40.0, 20.0, 20.0, 40.0, 20.0, 20.0, 140.0, 70.0, 30.0, 260.0, 100.0, 90.0, 40.0, 160.0, 70.0, 300.0, 50.0, 0.0, 60.0, 10.0, 30.0, 10.0, 15.0, 40.0, 180.0, 90.0, 60.0, 60.0, 40.0, 0.0, 40.0, 120.0, 40.0, 310.0, 20.0, 100.0, 0.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 150.0, 80.0, 310.0, 10.0, 260.0, 40.0, 100.0, 30.0, 20.0, 10.0, 160.0, 280.0, 30.0, 50.0, 270.0, 40.0, 10.0, 20.0, 30.0, 35.0, 20.0, 190.0, 40.0, 380.0, 270.0, 30.0, 90.0, 30.0, 210.0, 10.0, 120.0, 90.0, 270.0, 80.0, 200.0, -105.0, 20.0, 70.0, 20.0, 0.0, 370.0, -10.0, 30.0, 30.0, 140.0, 60.0, 80.0, 20.0, 290.0, 170.0, 430.0, 50.0, 150.0, 200.0, 70.0, 30.0, 130.0, 80.0, 290.0, 160.0, 180.0, 60.0, 300.0, 50.0, 10.0, 30.0, 80.0, 190.0, 50.0, 10.0, 270.0, 50.0, -40.0, 30.0, 130.0, 160.0, 50.0, 80.0, 120.0, 80.0, 40.0, 160.0, 100.0, 90.0, 30.0, 20.0, 350.0, 10.0, 30.0, -10.0, 0.0, 30.0, 30.0, 50.0, 10.0, 320.0, 0.0, 40.0, 40.0, 0.0, 15.0, 20.0, 0.0, 50.0, 50.0, 40.0, 0.0, 0.0, 20.0, 260.0, 30.0, 20.0, 260.0, 20.0, 180.0, 80.0, 25.0, 380.0, 10.0, 10.0, -10.0, 80.0, 30.0, 120.0, 30.0, 30.0, 280.0, 40.0, 0.0, 90.0, 40.0, 300.0, 200.0, 100.0, 70.0, -30.0, 40.0, 170.0, 250.0, 40.0, 90.0, 80.0, 120.0, 40.0, -85.0, 180.0, 80.0, 70.0, 160.0, 400.0, 30.0, -10.0, 180.0, 360.0, 380.0, 150.0, 20.0, 200.0, 30.0, 40.0, 30.0, 70.0, 60.0, 70.0, 40.0, 10.0, 30.0, 40.0, 70.0, 20.0, 40.0, 20.0, 60.0, 60.0, 20.0, -5.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 200.0, 180.0, 120.0, 130.0, 60.0, 160.0, 40.0, 40.0, 290.0, 50.0, 30.0, 70.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -25.0, 40.0, 0.0, 50.0, 30.0, 40.0, 20.0, 110.0, 20.0, 100.0, 60.0, 150.0, 20.0, 60.0, 90.0, 110.0, 0.0, 460.0, 10.0, 60.0, 240.0, 220.0, 30.0, 0.0, 60.0, 90.0, 50.0, 60.0, 60.0, 40.0, 70.0, 30.0, 5.0, 310.0, 40.0, 20.0, 70.0, 20.0, 70.0, 80.0, 10.0, 110.0, 0.0, 510.0, -50.0, 10.0, 90.0, 30.0, 40.0, 70.0, -20.0, 50.0, 130.0, -10.0, 30.0, 50.0, 20.0, 220.0, 150.0, 60.0, 80.0, 260.0, 110.0, 200.0, -80.0, 190.0, 370.0, 240.0, 70.0, 0.0, 60.0, 40.0, 30.0, -50.0, 90.0, 70.0, 410.0, 200.0, 260.0, 70.0, -30.0, 50.0, 140.0, 200.0, -40.0, 120.0, 0.0, 30.0, 20.0, 70.0, 10.0, 30.0, 250.0, 20.0, 110.0, 70.0, 20.0, 190.0, 110.0, 70.0, 20.0, -50.0, 10.0, 140.0, 20.0, 130.0, 210.0, 150.0, 10.0, 50.0, 70.0, 150.0, 220.0, 230.0, 0.0, 10.0, 240.0, 70.0, 200.0, 50.0, 10.0, 10.0, 10.0, 0.0, 15.0, 120.0, 190.0, 30.0, 240.0, 30.0, 90.0, 130.0, 30.0, 10.0, 20.0, 10.0, 120.0, 60.0, 30.0, 40.0, 90.0, 10.0, 50.0, 60.0, 10.0, 90.0, 0.0, 40.0, -30.0, 730.0, 40.0, 30.0, 10.0, 10.0, 10.0, 40.0, 100.0, 40.0, 110.0, 70.0, 40.0, 20.0, 30.0, 170.0, 10.0, 20.0, 100.0, 70.0, 20.0, 90.0, 150.0, 150.0, 80.0, 190.0, 70.0, 60.0, 20.0, 480.0, -75.0, 70.0, 80.0, -20.0, 70.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 70.0, 20.0, 0.0, 30.0, 100.0, 530.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, -50.0, 50.0, 20.0, 80.0, 40.0, 110.0, 100.0, 0.0, 30.0, 120.0, 160.0, 20.0, -50.0, -100.0, 0.0, 60.0, 50.0, 560.0, 0.0, 30.0, 60.0, 350.0, 90.0, 30.0, 80.0, 40.0, 30.0, 10.0, 60.0, 30.0, 10.0, 80.0, 30.0, 0.0, 20.0, 70.0, 220.0, 100.0, 130.0, 160.0, 30.0, 10.0, 70.0, 30.0, 80.0, 310.0, 200.0, 220.0, 60.0, 30.0, 290.0, 60.0, 30.0, 80.0, 60.0, 380.0, 420.0, 100.0, 220.0, 170.0, 110.0, 30.0, 120.0, 30.0, 50.0, -50.0, 60.0, -55.0, 130.0, 80.0, 150.0, 0.0, 20.0, 50.0, 30.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 80.0, 0.0, 10.0, 70.0, 20.0, 20.0, 80.0, 0.0, 70.0, 90.0, 100.0, 300.0, 30.0, 110.0, 150.0, 10.0, 60.0, 130.0, 160.0, 20.0, 170.0, 250.0, 50.0, 160.0, 10.0, 0.0, 60.0, 180.0, 40.0, 30.0, 40.0, -60.0, -10.0, 890.0, -20.0, 160.0, -60.0, 530.0, 90.0, -110.0, 30.0, 10.0, 0.0, 80.0, -25.0, 0.0, 10.0, 10.0, 10.0, 80.0, 390.0, 450.0, 120.0, 140.0, 50.0, 240.0, 130.0, -20.0, 50.0, 20.0, 270.0, 90.0, 100.0, 50.0, 0.0, -100.0, 40.0, 30.0, 80.0, 0.0, 60.0, 220.0, 20.0, 40.0, 150.0, 60.0, 10.0, 40.0, 160.0, 60.0, 160.0, 260.0, 80.0, 0.0, 10.0, 130.0, 40.0, 0.0, 50.0, -40.0, 40.0, 220.0, 0.0, 10.0, 30.0, 190.0, 10.0, 35.0, 60.0, 80.0, 30.0, 30.0, -30.0, 130.0, -30.0, 0.0, 30.0, 160.0, 40.0, 220.0, 0.0, 20.0, 360.0, 30.0, 40.0, 190.0, 10.0, 260.0, 70.0, 240.0, 60.0, 50.0, 10.0, 35.0, -5.0, 10.0, 170.0, 130.0, 80.0, 60.0, 40.0, -5.0, 30.0, 40.0, 0.0, 20.0, 50.0, 130.0, 30.0, 20.0, 200.0, 50.0, 50.0, 0.0, 90.0, 20.0, 330.0, 260.0, 30.0, 20.0, 20.0, 20.0, 90.0, 40.0, 10.0, 90.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 40.0, 60.0, 60.0, 520.0, 120.0, 400.0, 100.0, 70.0, 80.0, 10.0, 110.0, 80.0, 320.0, 10.0, 150.0, 60.0, 160.0, 15.0, -10.0, 180.0, 40.0, 90.0, 10.0, 40.0, 50.0, 20.0, 490.0, 40.0, 60.0, 20.0, 30.0, 40.0, 10.0, -20.0, 80.0, 120.0, 100.0, 50.0, 60.0, 10.0, 190.0, 180.0, 90.0, 260.0, 30.0, -50.0, 60.0, 50.0, 130.0, 150.0, 360.0, 60.0, 40.0, 10.0, 190.0, 130.0, 90.0, 10.0, 30.0, 40.0, 20.0, 250.0, 0.0, 50.0, 40.0, 150.0, 80.0, -30.0, 90.0, 360.0, 50.0, -10.0, 20.0, 130.0, 15.0, 20.0, 160.0, 10.0, 160.0, 40.0, 520.0, 100.0, 0.0, 60.0, 0.0, 60.0, 30.0, 10.0, 420.0, 0.0, 10.0, 80.0, 85.0, -90.0, 370.0, -20.0, 90.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5358325542210622, "mean_inference_ms": 1.4200214842156265, "mean_action_processing_ms": 0.44005364266994434, "mean_env_wait_ms": 1.264618031059072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01194143295288086, "StateBufferConnector_ms": 0.010567903518676758, "ViewRequirementAgentConnector_ms": 0.4008769989013672}, "num_episodes": 18, "episode_return_max": 1630.0, "episode_return_min": 110.0, "episode_return_mean": 815.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.473240272696838, "num_env_steps_trained_throughput_per_sec": 21.473240272696838, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 187559.319, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187559.274, "sample_time_ms": 2652.415, "learn_time_ms": 184887.089, "learn_throughput": 21.635, "synch_weights_time_ms": 11.974}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 60, "trial_id": "90816_00000", "date": "2024-06-10_03-20-53", "timestamp": 1718004053, "time_this_iter_s": 186.28896808624268, "time_total_s": 11331.28425168991, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00cbdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11331.28425168991, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.767424242424244, "ram_util_percent": 79.53598484848484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1488808505133954, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.358693884889158, "policy_loss": -0.00794766990681644, "vf_loss": 6.365335945631115, "vf_explained_var": 0.0010941932820918334, "kl": 0.0065280123891054915, "entropy": 0.5320951936756587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 568095.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "env_runners": {"episode_reward_max": 1630.0, "episode_reward_min": 110.0, "episode_reward_mean": 832.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 83.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [495.0, 730.0, 690.0, 980.0, 1035.0, 1200.0, 625.0, 1590.0, 1350.0, 680.0, 1010.0, 540.0, 495.0, 700.0, 905.0, 1110.0, 870.0, 1365.0, 1050.0, 390.0, 525.0, 990.0, 135.0, 610.0, 1220.0, 775.0, 930.0, 340.0, 1180.0, 870.0, 1460.0, 510.0, 690.0, 1240.0, 600.0, 885.0, 490.0, 930.0, 630.0, 880.0, 805.0, 200.0, 700.0, 710.0, 630.0, 730.0, 840.0, 1300.0, 1630.0, 545.0, 200.0, 440.0, 1070.0, 950.0, 1450.0, 205.0, 1570.0, 560.0, 820.0, 690.0, 675.0, 580.0, 1220.0, 600.0, 355.0, 1050.0, 310.0, 110.0, 1360.0, 995.0, 950.0, 490.0, 880.0, 1170.0, 630.0, 845.0, 980.0, 945.0, 605.0, 460.0, 785.0, 1290.0, 620.0, 1320.0, 1010.0, 960.0, 340.0, 690.0, 860.0, 800.0, 890.0, 860.0, 1190.0, 750.0, 980.0, 1020.0, 850.0, 940.0, 1120.0, 1030.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 60.0, 10.0, 30.0, 10.0, 15.0, 40.0, 180.0, 90.0, 60.0, 60.0, 40.0, 0.0, 40.0, 120.0, 40.0, 310.0, 20.0, 100.0, 0.0, 20.0, 0.0, 10.0, 80.0, 0.0, 30.0, 150.0, 80.0, 310.0, 10.0, 260.0, 40.0, 100.0, 30.0, 20.0, 10.0, 160.0, 280.0, 30.0, 50.0, 270.0, 40.0, 10.0, 20.0, 30.0, 35.0, 20.0, 190.0, 40.0, 380.0, 270.0, 30.0, 90.0, 30.0, 210.0, 10.0, 120.0, 90.0, 270.0, 80.0, 200.0, -105.0, 20.0, 70.0, 20.0, 0.0, 370.0, -10.0, 30.0, 30.0, 140.0, 60.0, 80.0, 20.0, 290.0, 170.0, 430.0, 50.0, 150.0, 200.0, 70.0, 30.0, 130.0, 80.0, 290.0, 160.0, 180.0, 60.0, 300.0, 50.0, 10.0, 30.0, 80.0, 190.0, 50.0, 10.0, 270.0, 50.0, -40.0, 30.0, 130.0, 160.0, 50.0, 80.0, 120.0, 80.0, 40.0, 160.0, 100.0, 90.0, 30.0, 20.0, 350.0, 10.0, 30.0, -10.0, 0.0, 30.0, 30.0, 50.0, 10.0, 320.0, 0.0, 40.0, 40.0, 0.0, 15.0, 20.0, 0.0, 50.0, 50.0, 40.0, 0.0, 0.0, 20.0, 260.0, 30.0, 20.0, 260.0, 20.0, 180.0, 80.0, 25.0, 380.0, 10.0, 10.0, -10.0, 80.0, 30.0, 120.0, 30.0, 30.0, 280.0, 40.0, 0.0, 90.0, 40.0, 300.0, 200.0, 100.0, 70.0, -30.0, 40.0, 170.0, 250.0, 40.0, 90.0, 80.0, 120.0, 40.0, -85.0, 180.0, 80.0, 70.0, 160.0, 400.0, 30.0, -10.0, 180.0, 360.0, 380.0, 150.0, 20.0, 200.0, 30.0, 40.0, 30.0, 70.0, 60.0, 70.0, 40.0, 10.0, 30.0, 40.0, 70.0, 20.0, 40.0, 20.0, 60.0, 60.0, 20.0, -5.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 200.0, 180.0, 120.0, 130.0, 60.0, 160.0, 40.0, 40.0, 290.0, 50.0, 30.0, 70.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -25.0, 40.0, 0.0, 50.0, 30.0, 40.0, 20.0, 110.0, 20.0, 100.0, 60.0, 150.0, 20.0, 60.0, 90.0, 110.0, 0.0, 460.0, 10.0, 60.0, 240.0, 220.0, 30.0, 0.0, 60.0, 90.0, 50.0, 60.0, 60.0, 40.0, 70.0, 30.0, 5.0, 310.0, 40.0, 20.0, 70.0, 20.0, 70.0, 80.0, 10.0, 110.0, 0.0, 510.0, -50.0, 10.0, 90.0, 30.0, 40.0, 70.0, -20.0, 50.0, 130.0, -10.0, 30.0, 50.0, 20.0, 220.0, 150.0, 60.0, 80.0, 260.0, 110.0, 200.0, -80.0, 190.0, 370.0, 240.0, 70.0, 0.0, 60.0, 40.0, 30.0, -50.0, 90.0, 70.0, 410.0, 200.0, 260.0, 70.0, -30.0, 50.0, 140.0, 200.0, -40.0, 120.0, 0.0, 30.0, 20.0, 70.0, 10.0, 30.0, 250.0, 20.0, 110.0, 70.0, 20.0, 190.0, 110.0, 70.0, 20.0, -50.0, 10.0, 140.0, 20.0, 130.0, 210.0, 150.0, 10.0, 50.0, 70.0, 150.0, 220.0, 230.0, 0.0, 10.0, 240.0, 70.0, 200.0, 50.0, 10.0, 10.0, 10.0, 0.0, 15.0, 120.0, 190.0, 30.0, 240.0, 30.0, 90.0, 130.0, 30.0, 10.0, 20.0, 10.0, 120.0, 60.0, 30.0, 40.0, 90.0, 10.0, 50.0, 60.0, 10.0, 90.0, 0.0, 40.0, -30.0, 730.0, 40.0, 30.0, 10.0, 10.0, 10.0, 40.0, 100.0, 40.0, 110.0, 70.0, 40.0, 20.0, 30.0, 170.0, 10.0, 20.0, 100.0, 70.0, 20.0, 90.0, 150.0, 150.0, 80.0, 190.0, 70.0, 60.0, 20.0, 480.0, -75.0, 70.0, 80.0, -20.0, 70.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 70.0, 20.0, 0.0, 30.0, 100.0, 530.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, -50.0, 50.0, 20.0, 80.0, 40.0, 110.0, 100.0, 0.0, 30.0, 120.0, 160.0, 20.0, -50.0, -100.0, 0.0, 60.0, 50.0, 560.0, 0.0, 30.0, 60.0, 350.0, 90.0, 30.0, 80.0, 40.0, 30.0, 10.0, 60.0, 30.0, 10.0, 80.0, 30.0, 0.0, 20.0, 70.0, 220.0, 100.0, 130.0, 160.0, 30.0, 10.0, 70.0, 30.0, 80.0, 310.0, 200.0, 220.0, 60.0, 30.0, 290.0, 60.0, 30.0, 80.0, 60.0, 380.0, 420.0, 100.0, 220.0, 170.0, 110.0, 30.0, 120.0, 30.0, 50.0, -50.0, 60.0, -55.0, 130.0, 80.0, 150.0, 0.0, 20.0, 50.0, 30.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 80.0, 0.0, 10.0, 70.0, 20.0, 20.0, 80.0, 0.0, 70.0, 90.0, 100.0, 300.0, 30.0, 110.0, 150.0, 10.0, 60.0, 130.0, 160.0, 20.0, 170.0, 250.0, 50.0, 160.0, 10.0, 0.0, 60.0, 180.0, 40.0, 30.0, 40.0, -60.0, -10.0, 890.0, -20.0, 160.0, -60.0, 530.0, 90.0, -110.0, 30.0, 10.0, 0.0, 80.0, -25.0, 0.0, 10.0, 10.0, 10.0, 80.0, 390.0, 450.0, 120.0, 140.0, 50.0, 240.0, 130.0, -20.0, 50.0, 20.0, 270.0, 90.0, 100.0, 50.0, 0.0, -100.0, 40.0, 30.0, 80.0, 0.0, 60.0, 220.0, 20.0, 40.0, 150.0, 60.0, 10.0, 40.0, 160.0, 60.0, 160.0, 260.0, 80.0, 0.0, 10.0, 130.0, 40.0, 0.0, 50.0, -40.0, 40.0, 220.0, 0.0, 10.0, 30.0, 190.0, 10.0, 35.0, 60.0, 80.0, 30.0, 30.0, -30.0, 130.0, -30.0, 0.0, 30.0, 160.0, 40.0, 220.0, 0.0, 20.0, 360.0, 30.0, 40.0, 190.0, 10.0, 260.0, 70.0, 240.0, 60.0, 50.0, 10.0, 35.0, -5.0, 10.0, 170.0, 130.0, 80.0, 60.0, 40.0, -5.0, 30.0, 40.0, 0.0, 20.0, 50.0, 130.0, 30.0, 20.0, 200.0, 50.0, 50.0, 0.0, 90.0, 20.0, 330.0, 260.0, 30.0, 20.0, 20.0, 20.0, 90.0, 40.0, 10.0, 90.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 40.0, 60.0, 60.0, 520.0, 120.0, 400.0, 100.0, 70.0, 80.0, 10.0, 110.0, 80.0, 320.0, 10.0, 150.0, 60.0, 160.0, 15.0, -10.0, 180.0, 40.0, 90.0, 10.0, 40.0, 50.0, 20.0, 490.0, 40.0, 60.0, 20.0, 30.0, 40.0, 10.0, -20.0, 80.0, 120.0, 100.0, 50.0, 60.0, 10.0, 190.0, 180.0, 90.0, 260.0, 30.0, -50.0, 60.0, 50.0, 130.0, 150.0, 360.0, 60.0, 40.0, 10.0, 190.0, 130.0, 90.0, 10.0, 30.0, 40.0, 20.0, 250.0, 0.0, 50.0, 40.0, 150.0, 80.0, -30.0, 90.0, 360.0, 50.0, -10.0, 20.0, 130.0, 15.0, 20.0, 160.0, 10.0, 160.0, 40.0, 520.0, 100.0, 0.0, 60.0, 0.0, 60.0, 30.0, 10.0, 420.0, 0.0, 10.0, 80.0, 85.0, -90.0, 370.0, -20.0, 90.0, 0.0, 40.0, 20.0, 10.0, 40.0, 160.0, 40.0, 0.0, 10.0, 250.0, 35.0, 60.0, 30.0, 40.0, 90.0, 90.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 50.0, 35.0, 40.0, 160.0, 150.0, 50.0, 80.0, 80.0, 120.0, 150.0, 100.0, -50.0, 150.0, 260.0, 380.0, 40.0, 90.0, 60.0, 110.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, 30.0, 180.0, 30.0, 230.0, 180.0, 440.0, 90.0, 60.0, 330.0, 60.0, 80.0, -30.0, 80.0, 30.0, 20.0, 140.0, 150.0, 110.0, 50.0, 50.0, 70.0, 170.0, 40.0, 210.0, 40.0, 180.0, 10.0, 170.0, 50.0, 330.0, 10.0, 140.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, 30.0, 190.0, 10.0, 140.0, 10.0, 330.0, 20.0, 40.0, 10.0, 40.0, 30.0, 60.0, 290.0, 60.0, 110.0, 40.0, -10.0, -30.0, 110.0, 200.0, 50.0, 40.0, 50.0, 160.0, 160.0, 120.0, 150.0, 60.0, 10.0, 0.0, 50.0, 40.0, 80.0, 10.0, 0.0, 170.0, 40.0, 100.0, 70.0, 30.0, 340.0, 50.0, 180.0, 10.0, 160.0, 80.0, 40.0, 140.0, 60.0, 80.0, 30.0, 80.0, 50.0, 680.0, 20.0, 180.0, 20.0, 50.0, 40.0, 70.0, 50.0, 30.0, 160.0, 100.0, 20.0, 40.0, 250.0, 80.0, -20.0, 0.0, 50.0, 70.0, 50.0, 360.0, 80.0, 0.0, 80.0, 150.0, 0.0, 160.0, 40.0, 60.0, 100.0, 130.0, 240.0, 90.0, 100.0, 70.0, 30.0, 40.0, 100.0, 120.0, 30.0, 30.0, 70.0, 30.0, 40.0, 370.0, 10.0, 20.0, 230.0, 20.0, 70.0, 20.0, 80.0, 50.0, 90.0, 170.0, 220.0, 180.0, 20.0, 40.0, 570.0, 0.0, 40.0, 30.0, 70.0, 90.0, 190.0, 20.0, 30.0, 80.0, 100.0, 40.0, 80.0, 590.0, 30.0, 70.0, -30.0, 40.0, -40.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5342458921914852, "mean_inference_ms": 1.4202710045429168, "mean_action_processing_ms": 0.4423760268260697, "mean_env_wait_ms": 1.2636877220987122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011979818344116211, "StateBufferConnector_ms": 0.01062154769897461, "ViewRequirementAgentConnector_ms": 0.3967587947845459}, "num_episodes": 22, "episode_return_max": 1630.0, "episode_return_min": 110.0, "episode_return_mean": 832.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.18001589110692, "num_env_steps_trained_throughput_per_sec": 21.18001589110692, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 2440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2440000, "timers": {"training_iteration_time_ms": 187777.619, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187777.575, "sample_time_ms": 2657.048, "learn_time_ms": 185101.025, "learn_throughput": 21.61, "synch_weights_time_ms": 11.811}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "done": false, "training_iteration": 61, "trial_id": "90816_00000", "date": "2024-06-10_03-24-02", "timestamp": 1718004242, "time_this_iter_s": 188.8659908771515, "time_total_s": 11520.150242567062, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f4c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11520.150242567062, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 20.103370786516855, "ram_util_percent": 80.44269662921349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2141885746147434, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.71696772194518, "policy_loss": -0.008054450035459215, "vf_loss": 6.723725922800862, "vf_explained_var": 0.0006411356730456042, "kl": 0.006481263083567948, "entropy": 0.5077874002206567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 577485.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 110.0, "episode_reward_mean": 830.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 83.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1050.0, 390.0, 525.0, 990.0, 135.0, 610.0, 1220.0, 775.0, 930.0, 340.0, 1180.0, 870.0, 1460.0, 510.0, 690.0, 1240.0, 600.0, 885.0, 490.0, 930.0, 630.0, 880.0, 805.0, 200.0, 700.0, 710.0, 630.0, 730.0, 840.0, 1300.0, 1630.0, 545.0, 200.0, 440.0, 1070.0, 950.0, 1450.0, 205.0, 1570.0, 560.0, 820.0, 690.0, 675.0, 580.0, 1220.0, 600.0, 355.0, 1050.0, 310.0, 110.0, 1360.0, 995.0, 950.0, 490.0, 880.0, 1170.0, 630.0, 845.0, 980.0, 945.0, 605.0, 460.0, 785.0, 1290.0, 620.0, 1320.0, 1010.0, 960.0, 340.0, 690.0, 860.0, 800.0, 890.0, 860.0, 1190.0, 750.0, 980.0, 1020.0, 850.0, 940.0, 1120.0, 1030.0, 885.0, 130.0, 750.0, 670.0, 705.0, 1540.0, 950.0, 1130.0, 1470.0, 605.0, 755.0, 1080.0, 660.0, 2080.0, 410.0, 950.0, 975.0, 410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [380.0, 150.0, 20.0, 200.0, 30.0, 40.0, 30.0, 70.0, 60.0, 70.0, 40.0, 10.0, 30.0, 40.0, 70.0, 20.0, 40.0, 20.0, 60.0, 60.0, 20.0, -5.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 200.0, 180.0, 120.0, 130.0, 60.0, 160.0, 40.0, 40.0, 290.0, 50.0, 30.0, 70.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -25.0, 40.0, 0.0, 50.0, 30.0, 40.0, 20.0, 110.0, 20.0, 100.0, 60.0, 150.0, 20.0, 60.0, 90.0, 110.0, 0.0, 460.0, 10.0, 60.0, 240.0, 220.0, 30.0, 0.0, 60.0, 90.0, 50.0, 60.0, 60.0, 40.0, 70.0, 30.0, 5.0, 310.0, 40.0, 20.0, 70.0, 20.0, 70.0, 80.0, 10.0, 110.0, 0.0, 510.0, -50.0, 10.0, 90.0, 30.0, 40.0, 70.0, -20.0, 50.0, 130.0, -10.0, 30.0, 50.0, 20.0, 220.0, 150.0, 60.0, 80.0, 260.0, 110.0, 200.0, -80.0, 190.0, 370.0, 240.0, 70.0, 0.0, 60.0, 40.0, 30.0, -50.0, 90.0, 70.0, 410.0, 200.0, 260.0, 70.0, -30.0, 50.0, 140.0, 200.0, -40.0, 120.0, 0.0, 30.0, 20.0, 70.0, 10.0, 30.0, 250.0, 20.0, 110.0, 70.0, 20.0, 190.0, 110.0, 70.0, 20.0, -50.0, 10.0, 140.0, 20.0, 130.0, 210.0, 150.0, 10.0, 50.0, 70.0, 150.0, 220.0, 230.0, 0.0, 10.0, 240.0, 70.0, 200.0, 50.0, 10.0, 10.0, 10.0, 0.0, 15.0, 120.0, 190.0, 30.0, 240.0, 30.0, 90.0, 130.0, 30.0, 10.0, 20.0, 10.0, 120.0, 60.0, 30.0, 40.0, 90.0, 10.0, 50.0, 60.0, 10.0, 90.0, 0.0, 40.0, -30.0, 730.0, 40.0, 30.0, 10.0, 10.0, 10.0, 40.0, 100.0, 40.0, 110.0, 70.0, 40.0, 20.0, 30.0, 170.0, 10.0, 20.0, 100.0, 70.0, 20.0, 90.0, 150.0, 150.0, 80.0, 190.0, 70.0, 60.0, 20.0, 480.0, -75.0, 70.0, 80.0, -20.0, 70.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 70.0, 20.0, 0.0, 30.0, 100.0, 530.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, -50.0, 50.0, 20.0, 80.0, 40.0, 110.0, 100.0, 0.0, 30.0, 120.0, 160.0, 20.0, -50.0, -100.0, 0.0, 60.0, 50.0, 560.0, 0.0, 30.0, 60.0, 350.0, 90.0, 30.0, 80.0, 40.0, 30.0, 10.0, 60.0, 30.0, 10.0, 80.0, 30.0, 0.0, 20.0, 70.0, 220.0, 100.0, 130.0, 160.0, 30.0, 10.0, 70.0, 30.0, 80.0, 310.0, 200.0, 220.0, 60.0, 30.0, 290.0, 60.0, 30.0, 80.0, 60.0, 380.0, 420.0, 100.0, 220.0, 170.0, 110.0, 30.0, 120.0, 30.0, 50.0, -50.0, 60.0, -55.0, 130.0, 80.0, 150.0, 0.0, 20.0, 50.0, 30.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 80.0, 0.0, 10.0, 70.0, 20.0, 20.0, 80.0, 0.0, 70.0, 90.0, 100.0, 300.0, 30.0, 110.0, 150.0, 10.0, 60.0, 130.0, 160.0, 20.0, 170.0, 250.0, 50.0, 160.0, 10.0, 0.0, 60.0, 180.0, 40.0, 30.0, 40.0, -60.0, -10.0, 890.0, -20.0, 160.0, -60.0, 530.0, 90.0, -110.0, 30.0, 10.0, 0.0, 80.0, -25.0, 0.0, 10.0, 10.0, 10.0, 80.0, 390.0, 450.0, 120.0, 140.0, 50.0, 240.0, 130.0, -20.0, 50.0, 20.0, 270.0, 90.0, 100.0, 50.0, 0.0, -100.0, 40.0, 30.0, 80.0, 0.0, 60.0, 220.0, 20.0, 40.0, 150.0, 60.0, 10.0, 40.0, 160.0, 60.0, 160.0, 260.0, 80.0, 0.0, 10.0, 130.0, 40.0, 0.0, 50.0, -40.0, 40.0, 220.0, 0.0, 10.0, 30.0, 190.0, 10.0, 35.0, 60.0, 80.0, 30.0, 30.0, -30.0, 130.0, -30.0, 0.0, 30.0, 160.0, 40.0, 220.0, 0.0, 20.0, 360.0, 30.0, 40.0, 190.0, 10.0, 260.0, 70.0, 240.0, 60.0, 50.0, 10.0, 35.0, -5.0, 10.0, 170.0, 130.0, 80.0, 60.0, 40.0, -5.0, 30.0, 40.0, 0.0, 20.0, 50.0, 130.0, 30.0, 20.0, 200.0, 50.0, 50.0, 0.0, 90.0, 20.0, 330.0, 260.0, 30.0, 20.0, 20.0, 20.0, 90.0, 40.0, 10.0, 90.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 40.0, 60.0, 60.0, 520.0, 120.0, 400.0, 100.0, 70.0, 80.0, 10.0, 110.0, 80.0, 320.0, 10.0, 150.0, 60.0, 160.0, 15.0, -10.0, 180.0, 40.0, 90.0, 10.0, 40.0, 50.0, 20.0, 490.0, 40.0, 60.0, 20.0, 30.0, 40.0, 10.0, -20.0, 80.0, 120.0, 100.0, 50.0, 60.0, 10.0, 190.0, 180.0, 90.0, 260.0, 30.0, -50.0, 60.0, 50.0, 130.0, 150.0, 360.0, 60.0, 40.0, 10.0, 190.0, 130.0, 90.0, 10.0, 30.0, 40.0, 20.0, 250.0, 0.0, 50.0, 40.0, 150.0, 80.0, -30.0, 90.0, 360.0, 50.0, -10.0, 20.0, 130.0, 15.0, 20.0, 160.0, 10.0, 160.0, 40.0, 520.0, 100.0, 0.0, 60.0, 0.0, 60.0, 30.0, 10.0, 420.0, 0.0, 10.0, 80.0, 85.0, -90.0, 370.0, -20.0, 90.0, 0.0, 40.0, 20.0, 10.0, 40.0, 160.0, 40.0, 0.0, 10.0, 250.0, 35.0, 60.0, 30.0, 40.0, 90.0, 90.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 50.0, 35.0, 40.0, 160.0, 150.0, 50.0, 80.0, 80.0, 120.0, 150.0, 100.0, -50.0, 150.0, 260.0, 380.0, 40.0, 90.0, 60.0, 110.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, 30.0, 180.0, 30.0, 230.0, 180.0, 440.0, 90.0, 60.0, 330.0, 60.0, 80.0, -30.0, 80.0, 30.0, 20.0, 140.0, 150.0, 110.0, 50.0, 50.0, 70.0, 170.0, 40.0, 210.0, 40.0, 180.0, 10.0, 170.0, 50.0, 330.0, 10.0, 140.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, 30.0, 190.0, 10.0, 140.0, 10.0, 330.0, 20.0, 40.0, 10.0, 40.0, 30.0, 60.0, 290.0, 60.0, 110.0, 40.0, -10.0, -30.0, 110.0, 200.0, 50.0, 40.0, 50.0, 160.0, 160.0, 120.0, 150.0, 60.0, 10.0, 0.0, 50.0, 40.0, 80.0, 10.0, 0.0, 170.0, 40.0, 100.0, 70.0, 30.0, 340.0, 50.0, 180.0, 10.0, 160.0, 80.0, 40.0, 140.0, 60.0, 80.0, 30.0, 80.0, 50.0, 680.0, 20.0, 180.0, 20.0, 50.0, 40.0, 70.0, 50.0, 30.0, 160.0, 100.0, 20.0, 40.0, 250.0, 80.0, -20.0, 0.0, 50.0, 70.0, 50.0, 360.0, 80.0, 0.0, 80.0, 150.0, 0.0, 160.0, 40.0, 60.0, 100.0, 130.0, 240.0, 90.0, 100.0, 70.0, 30.0, 40.0, 100.0, 120.0, 30.0, 30.0, 70.0, 30.0, 40.0, 370.0, 10.0, 20.0, 230.0, 20.0, 70.0, 20.0, 80.0, 50.0, 90.0, 170.0, 220.0, 180.0, 20.0, 40.0, 570.0, 0.0, 40.0, 30.0, 70.0, 90.0, 190.0, 20.0, 30.0, 80.0, 100.0, 40.0, 80.0, 590.0, 30.0, 70.0, -30.0, 40.0, -40.0, 150.0, 70.0, 70.0, 60.0, 60.0, 60.0, -15.0, 260.0, 110.0, 160.0, 50.0, 0.0, 30.0, 20.0, 0.0, 20.0, 10.0, 40.0, -10.0, 20.0, 0.0, 10.0, 50.0, 30.0, 280.0, 10.0, 0.0, 40.0, 90.0, 30.0, 210.0, 20.0, 20.0, 400.0, 30.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 160.0, 40.0, 50.0, -25.0, 10.0, -20.0, 20.0, 30.0, 290.0, 150.0, 100.0, 50.0, 620.0, 10.0, 90.0, 230.0, 100.0, 80.0, 210.0, 50.0, 100.0, 80.0, 150.0, 40.0, 100.0, 170.0, 180.0, 40.0, 10.0, 80.0, 20.0, 110.0, 20.0, 350.0, 40.0, 240.0, 0.0, 220.0, 80.0, 50.0, 90.0, 110.0, 220.0, 110.0, -110.0, 50.0, 340.0, 340.0, 130.0, 190.0, 10.0, 150.0, 50.0, 0.0, 20.0, 275.0, 0.0, 30.0, 50.0, 20.0, 30.0, 10.0, 100.0, 80.0, 320.0, 15.0, 10.0, 20.0, 170.0, 0.0, -10.0, 70.0, 20.0, 80.0, 130.0, 600.0, 90.0, 40.0, 40.0, 20.0, 20.0, 30.0, 200.0, 100.0, 70.0, 70.0, 20.0, 10.0, 30.0, 110.0, 90.0, 150.0, 170.0, 420.0, 770.0, 100.0, 210.0, 160.0, 0.0, 10.0, 20.0, 10.0, 150.0, 0.0, 80.0, 0.0, 20.0, 30.0, 60.0, 40.0, 50.0, 10.0, 10.0, 460.0, 50.0, 20.0, 320.0, 10.0, 30.0, -10.0, 0.0, 170.0, 25.0, 290.0, 70.0, 210.0, 20.0, 120.0, 20.0, 50.0, 0.0, 60.0, 50.0, 50.0, 30.0, 0.0, 0.0, 50.0, 120.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5327778735557351, "mean_inference_ms": 1.4194119511149117, "mean_action_processing_ms": 0.4429179949297853, "mean_env_wait_ms": 1.2632838583677373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011597156524658203, "StateBufferConnector_ms": 0.010370969772338867, "ViewRequirementAgentConnector_ms": 0.38529014587402344}, "num_episodes": 18, "episode_return_max": 2080.0, "episode_return_min": 110.0, "episode_return_mean": 830.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.285103559779454, "num_env_steps_trained_throughput_per_sec": 21.285103559779454, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 187628.418, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187628.375, "sample_time_ms": 2648.852, "learn_time_ms": 184960.245, "learn_throughput": 21.626, "synch_weights_time_ms": 11.458}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 62, "trial_id": "90816_00000", "date": "2024-06-10_03-27-10", "timestamp": 1718004430, "time_this_iter_s": 187.9344837665558, "time_total_s": 11708.084726333618, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0040940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11708.084726333618, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 18.362781954887218, "ram_util_percent": 79.2578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3919270279371956, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5669391732119395, "policy_loss": -0.009572308625543889, "vf_loss": 6.575119312883566, "vf_explained_var": 0.0006806297804981756, "kl": 0.006960815090510274, "entropy": 0.5075146160218409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 586875.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 110.0, "episode_reward_mean": 872.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 87.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 700.0, 710.0, 630.0, 730.0, 840.0, 1300.0, 1630.0, 545.0, 200.0, 440.0, 1070.0, 950.0, 1450.0, 205.0, 1570.0, 560.0, 820.0, 690.0, 675.0, 580.0, 1220.0, 600.0, 355.0, 1050.0, 310.0, 110.0, 1360.0, 995.0, 950.0, 490.0, 880.0, 1170.0, 630.0, 845.0, 980.0, 945.0, 605.0, 460.0, 785.0, 1290.0, 620.0, 1320.0, 1010.0, 960.0, 340.0, 690.0, 860.0, 800.0, 890.0, 860.0, 1190.0, 750.0, 980.0, 1020.0, 850.0, 940.0, 1120.0, 1030.0, 885.0, 130.0, 750.0, 670.0, 705.0, 1540.0, 950.0, 1130.0, 1470.0, 605.0, 755.0, 1080.0, 660.0, 2080.0, 410.0, 950.0, 975.0, 410.0, 595.0, 580.0, 595.0, 1060.0, 460.0, 560.0, 1860.0, 530.0, 790.0, 1330.0, 1125.0, 550.0, 420.0, 680.0, 1660.0, 1290.0, 1240.0, 1540.0, 1050.0, 890.0, 1000.0, 1120.0, 1420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 70.0, 20.0, 0.0, 30.0, 100.0, 530.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, -50.0, 50.0, 20.0, 80.0, 40.0, 110.0, 100.0, 0.0, 30.0, 120.0, 160.0, 20.0, -50.0, -100.0, 0.0, 60.0, 50.0, 560.0, 0.0, 30.0, 60.0, 350.0, 90.0, 30.0, 80.0, 40.0, 30.0, 10.0, 60.0, 30.0, 10.0, 80.0, 30.0, 0.0, 20.0, 70.0, 220.0, 100.0, 130.0, 160.0, 30.0, 10.0, 70.0, 30.0, 80.0, 310.0, 200.0, 220.0, 60.0, 30.0, 290.0, 60.0, 30.0, 80.0, 60.0, 380.0, 420.0, 100.0, 220.0, 170.0, 110.0, 30.0, 120.0, 30.0, 50.0, -50.0, 60.0, -55.0, 130.0, 80.0, 150.0, 0.0, 20.0, 50.0, 30.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 80.0, 0.0, 10.0, 70.0, 20.0, 20.0, 80.0, 0.0, 70.0, 90.0, 100.0, 300.0, 30.0, 110.0, 150.0, 10.0, 60.0, 130.0, 160.0, 20.0, 170.0, 250.0, 50.0, 160.0, 10.0, 0.0, 60.0, 180.0, 40.0, 30.0, 40.0, -60.0, -10.0, 890.0, -20.0, 160.0, -60.0, 530.0, 90.0, -110.0, 30.0, 10.0, 0.0, 80.0, -25.0, 0.0, 10.0, 10.0, 10.0, 80.0, 390.0, 450.0, 120.0, 140.0, 50.0, 240.0, 130.0, -20.0, 50.0, 20.0, 270.0, 90.0, 100.0, 50.0, 0.0, -100.0, 40.0, 30.0, 80.0, 0.0, 60.0, 220.0, 20.0, 40.0, 150.0, 60.0, 10.0, 40.0, 160.0, 60.0, 160.0, 260.0, 80.0, 0.0, 10.0, 130.0, 40.0, 0.0, 50.0, -40.0, 40.0, 220.0, 0.0, 10.0, 30.0, 190.0, 10.0, 35.0, 60.0, 80.0, 30.0, 30.0, -30.0, 130.0, -30.0, 0.0, 30.0, 160.0, 40.0, 220.0, 0.0, 20.0, 360.0, 30.0, 40.0, 190.0, 10.0, 260.0, 70.0, 240.0, 60.0, 50.0, 10.0, 35.0, -5.0, 10.0, 170.0, 130.0, 80.0, 60.0, 40.0, -5.0, 30.0, 40.0, 0.0, 20.0, 50.0, 130.0, 30.0, 20.0, 200.0, 50.0, 50.0, 0.0, 90.0, 20.0, 330.0, 260.0, 30.0, 20.0, 20.0, 20.0, 90.0, 40.0, 10.0, 90.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 40.0, 60.0, 60.0, 520.0, 120.0, 400.0, 100.0, 70.0, 80.0, 10.0, 110.0, 80.0, 320.0, 10.0, 150.0, 60.0, 160.0, 15.0, -10.0, 180.0, 40.0, 90.0, 10.0, 40.0, 50.0, 20.0, 490.0, 40.0, 60.0, 20.0, 30.0, 40.0, 10.0, -20.0, 80.0, 120.0, 100.0, 50.0, 60.0, 10.0, 190.0, 180.0, 90.0, 260.0, 30.0, -50.0, 60.0, 50.0, 130.0, 150.0, 360.0, 60.0, 40.0, 10.0, 190.0, 130.0, 90.0, 10.0, 30.0, 40.0, 20.0, 250.0, 0.0, 50.0, 40.0, 150.0, 80.0, -30.0, 90.0, 360.0, 50.0, -10.0, 20.0, 130.0, 15.0, 20.0, 160.0, 10.0, 160.0, 40.0, 520.0, 100.0, 0.0, 60.0, 0.0, 60.0, 30.0, 10.0, 420.0, 0.0, 10.0, 80.0, 85.0, -90.0, 370.0, -20.0, 90.0, 0.0, 40.0, 20.0, 10.0, 40.0, 160.0, 40.0, 0.0, 10.0, 250.0, 35.0, 60.0, 30.0, 40.0, 90.0, 90.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 50.0, 35.0, 40.0, 160.0, 150.0, 50.0, 80.0, 80.0, 120.0, 150.0, 100.0, -50.0, 150.0, 260.0, 380.0, 40.0, 90.0, 60.0, 110.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, 30.0, 180.0, 30.0, 230.0, 180.0, 440.0, 90.0, 60.0, 330.0, 60.0, 80.0, -30.0, 80.0, 30.0, 20.0, 140.0, 150.0, 110.0, 50.0, 50.0, 70.0, 170.0, 40.0, 210.0, 40.0, 180.0, 10.0, 170.0, 50.0, 330.0, 10.0, 140.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, 30.0, 190.0, 10.0, 140.0, 10.0, 330.0, 20.0, 40.0, 10.0, 40.0, 30.0, 60.0, 290.0, 60.0, 110.0, 40.0, -10.0, -30.0, 110.0, 200.0, 50.0, 40.0, 50.0, 160.0, 160.0, 120.0, 150.0, 60.0, 10.0, 0.0, 50.0, 40.0, 80.0, 10.0, 0.0, 170.0, 40.0, 100.0, 70.0, 30.0, 340.0, 50.0, 180.0, 10.0, 160.0, 80.0, 40.0, 140.0, 60.0, 80.0, 30.0, 80.0, 50.0, 680.0, 20.0, 180.0, 20.0, 50.0, 40.0, 70.0, 50.0, 30.0, 160.0, 100.0, 20.0, 40.0, 250.0, 80.0, -20.0, 0.0, 50.0, 70.0, 50.0, 360.0, 80.0, 0.0, 80.0, 150.0, 0.0, 160.0, 40.0, 60.0, 100.0, 130.0, 240.0, 90.0, 100.0, 70.0, 30.0, 40.0, 100.0, 120.0, 30.0, 30.0, 70.0, 30.0, 40.0, 370.0, 10.0, 20.0, 230.0, 20.0, 70.0, 20.0, 80.0, 50.0, 90.0, 170.0, 220.0, 180.0, 20.0, 40.0, 570.0, 0.0, 40.0, 30.0, 70.0, 90.0, 190.0, 20.0, 30.0, 80.0, 100.0, 40.0, 80.0, 590.0, 30.0, 70.0, -30.0, 40.0, -40.0, 150.0, 70.0, 70.0, 60.0, 60.0, 60.0, -15.0, 260.0, 110.0, 160.0, 50.0, 0.0, 30.0, 20.0, 0.0, 20.0, 10.0, 40.0, -10.0, 20.0, 0.0, 10.0, 50.0, 30.0, 280.0, 10.0, 0.0, 40.0, 90.0, 30.0, 210.0, 20.0, 20.0, 400.0, 30.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 160.0, 40.0, 50.0, -25.0, 10.0, -20.0, 20.0, 30.0, 290.0, 150.0, 100.0, 50.0, 620.0, 10.0, 90.0, 230.0, 100.0, 80.0, 210.0, 50.0, 100.0, 80.0, 150.0, 40.0, 100.0, 170.0, 180.0, 40.0, 10.0, 80.0, 20.0, 110.0, 20.0, 350.0, 40.0, 240.0, 0.0, 220.0, 80.0, 50.0, 90.0, 110.0, 220.0, 110.0, -110.0, 50.0, 340.0, 340.0, 130.0, 190.0, 10.0, 150.0, 50.0, 0.0, 20.0, 275.0, 0.0, 30.0, 50.0, 20.0, 30.0, 10.0, 100.0, 80.0, 320.0, 15.0, 10.0, 20.0, 170.0, 0.0, -10.0, 70.0, 20.0, 80.0, 130.0, 600.0, 90.0, 40.0, 40.0, 20.0, 20.0, 30.0, 200.0, 100.0, 70.0, 70.0, 20.0, 10.0, 30.0, 110.0, 90.0, 150.0, 170.0, 420.0, 770.0, 100.0, 210.0, 160.0, 0.0, 10.0, 20.0, 10.0, 150.0, 0.0, 80.0, 0.0, 20.0, 30.0, 60.0, 40.0, 50.0, 10.0, 10.0, 460.0, 50.0, 20.0, 320.0, 10.0, 30.0, -10.0, 0.0, 170.0, 25.0, 290.0, 70.0, 210.0, 20.0, 120.0, 20.0, 50.0, 0.0, 60.0, 50.0, 50.0, 30.0, 0.0, 0.0, 50.0, 120.0, 50.0, -135.0, 0.0, -10.0, -100.0, 30.0, 80.0, 190.0, 170.0, 180.0, 190.0, 30.0, 100.0, 20.0, 0.0, 50.0, 90.0, 30.0, -40.0, 170.0, 130.0, 15.0, 80.0, 240.0, 20.0, 30.0, 70.0, 80.0, 40.0, 10.0, 10.0, 300.0, 60.0, 70.0, 40.0, 140.0, 100.0, 20.0, 70.0, 20.0, 240.0, 10.0, 10.0, 30.0, 60.0, 140.0, 20.0, 10.0, 30.0, 50.0, 100.0, 30.0, 60.0, 0.0, 40.0, 150.0, 40.0, 20.0, 30.0, 200.0, -10.0, 260.0, 30.0, 80.0, 100.0, 320.0, 180.0, 80.0, 360.0, 240.0, 210.0, 110.0, 10.0, 0.0, 20.0, 10.0, 20.0, 270.0, 30.0, 60.0, 0.0, 10.0, 50.0, 70.0, 0.0, 80.0, 100.0, 40.0, 120.0, 30.0, 290.0, 30.0, 60.0, 390.0, 170.0, 490.0, 60.0, 50.0, 10.0, 80.0, -10.0, 60.0, 480.0, 40.0, 25.0, 30.0, 50.0, 0.0, 80.0, 50.0, 310.0, 70.0, 80.0, 70.0, 20.0, 10.0, 210.0, 40.0, -40.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 70.0, 20.0, 30.0, 150.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 130.0, 40.0, 30.0, 350.0, 20.0, 490.0, 40.0, 170.0, 40.0, 60.0, 220.0, 30.0, 430.0, 100.0, 80.0, 680.0, 150.0, 30.0, 110.0, -20.0, 10.0, 60.0, 190.0, 100.0, -20.0, 190.0, 300.0, 60.0, 230.0, 150.0, 40.0, 20.0, 80.0, 150.0, 20.0, 180.0, 140.0, 150.0, 100.0, 90.0, 70.0, 140.0, 290.0, 100.0, 280.0, 160.0, 40.0, 150.0, 50.0, 300.0, 90.0, 50.0, 10.0, 60.0, 140.0, 250.0, 310.0, 80.0, 30.0, 70.0, 20.0, 80.0, 0.0, 30.0, 20.0, 170.0, 250.0, 0.0, 100.0, 60.0, 40.0, 80.0, 190.0, 20.0, 90.0, 130.0, 360.0, 60.0, 70.0, 30.0, 210.0, 30.0, 30.0, 30.0, 170.0, 80.0, 570.0, 10.0, 30.0, 280.0, 160.0, 30.0, 180.0, 30.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5320396577528268, "mean_inference_ms": 1.4189605747101448, "mean_action_processing_ms": 0.4420602215633557, "mean_env_wait_ms": 1.2627517894652924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012424707412719727, "StateBufferConnector_ms": 0.009419679641723633, "ViewRequirementAgentConnector_ms": 0.39288902282714844}, "num_episodes": 23, "episode_return_max": 2080.0, "episode_return_min": 110.0, "episode_return_mean": 872.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.42120770164588, "num_env_steps_trained_throughput_per_sec": 21.42120770164588, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 2520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 187234.622, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187234.578, "sample_time_ms": 2535.466, "learn_time_ms": 184679.526, "learn_throughput": 21.659, "synch_weights_time_ms": 11.414}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "training_iteration": 63, "trial_id": "90816_00000", "date": "2024-06-10_03-30-16", "timestamp": 1718004616, "time_this_iter_s": 186.73936009407043, "time_total_s": 11894.824086427689, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f9d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11894.824086427689, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.935606060606062, "ram_util_percent": 78.92916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.163814110788928, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.343150228687242, "policy_loss": -0.008081992803894269, "vf_loss": 6.349885951215848, "vf_explained_var": 0.00032558117430811875, "kl": 0.00673140086961299, "entropy": 0.5009328769894834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 596265.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 110.0, "episode_reward_mean": 881.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 88.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.0, 675.0, 580.0, 1220.0, 600.0, 355.0, 1050.0, 310.0, 110.0, 1360.0, 995.0, 950.0, 490.0, 880.0, 1170.0, 630.0, 845.0, 980.0, 945.0, 605.0, 460.0, 785.0, 1290.0, 620.0, 1320.0, 1010.0, 960.0, 340.0, 690.0, 860.0, 800.0, 890.0, 860.0, 1190.0, 750.0, 980.0, 1020.0, 850.0, 940.0, 1120.0, 1030.0, 885.0, 130.0, 750.0, 670.0, 705.0, 1540.0, 950.0, 1130.0, 1470.0, 605.0, 755.0, 1080.0, 660.0, 2080.0, 410.0, 950.0, 975.0, 410.0, 595.0, 580.0, 595.0, 1060.0, 460.0, 560.0, 1860.0, 530.0, 790.0, 1330.0, 1125.0, 550.0, 420.0, 680.0, 1660.0, 1290.0, 1240.0, 1540.0, 1050.0, 890.0, 1000.0, 1120.0, 1420.0, 840.0, 1120.0, 1110.0, 580.0, 770.0, 1170.0, 800.0, 1060.0, 400.0, 1230.0, 690.0, 265.0, 1315.0, 240.0, 1430.0, 1080.0, 350.0, 960.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [160.0, 260.0, 80.0, 0.0, 10.0, 130.0, 40.0, 0.0, 50.0, -40.0, 40.0, 220.0, 0.0, 10.0, 30.0, 190.0, 10.0, 35.0, 60.0, 80.0, 30.0, 30.0, -30.0, 130.0, -30.0, 0.0, 30.0, 160.0, 40.0, 220.0, 0.0, 20.0, 360.0, 30.0, 40.0, 190.0, 10.0, 260.0, 70.0, 240.0, 60.0, 50.0, 10.0, 35.0, -5.0, 10.0, 170.0, 130.0, 80.0, 60.0, 40.0, -5.0, 30.0, 40.0, 0.0, 20.0, 50.0, 130.0, 30.0, 20.0, 200.0, 50.0, 50.0, 0.0, 90.0, 20.0, 330.0, 260.0, 30.0, 20.0, 20.0, 20.0, 90.0, 40.0, 10.0, 90.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 30.0, -10.0, 0.0, 40.0, 60.0, 60.0, 520.0, 120.0, 400.0, 100.0, 70.0, 80.0, 10.0, 110.0, 80.0, 320.0, 10.0, 150.0, 60.0, 160.0, 15.0, -10.0, 180.0, 40.0, 90.0, 10.0, 40.0, 50.0, 20.0, 490.0, 40.0, 60.0, 20.0, 30.0, 40.0, 10.0, -20.0, 80.0, 120.0, 100.0, 50.0, 60.0, 10.0, 190.0, 180.0, 90.0, 260.0, 30.0, -50.0, 60.0, 50.0, 130.0, 150.0, 360.0, 60.0, 40.0, 10.0, 190.0, 130.0, 90.0, 10.0, 30.0, 40.0, 20.0, 250.0, 0.0, 50.0, 40.0, 150.0, 80.0, -30.0, 90.0, 360.0, 50.0, -10.0, 20.0, 130.0, 15.0, 20.0, 160.0, 10.0, 160.0, 40.0, 520.0, 100.0, 0.0, 60.0, 0.0, 60.0, 30.0, 10.0, 420.0, 0.0, 10.0, 80.0, 85.0, -90.0, 370.0, -20.0, 90.0, 0.0, 40.0, 20.0, 10.0, 40.0, 160.0, 40.0, 0.0, 10.0, 250.0, 35.0, 60.0, 30.0, 40.0, 90.0, 90.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 50.0, 35.0, 40.0, 160.0, 150.0, 50.0, 80.0, 80.0, 120.0, 150.0, 100.0, -50.0, 150.0, 260.0, 380.0, 40.0, 90.0, 60.0, 110.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, 30.0, 180.0, 30.0, 230.0, 180.0, 440.0, 90.0, 60.0, 330.0, 60.0, 80.0, -30.0, 80.0, 30.0, 20.0, 140.0, 150.0, 110.0, 50.0, 50.0, 70.0, 170.0, 40.0, 210.0, 40.0, 180.0, 10.0, 170.0, 50.0, 330.0, 10.0, 140.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, 30.0, 190.0, 10.0, 140.0, 10.0, 330.0, 20.0, 40.0, 10.0, 40.0, 30.0, 60.0, 290.0, 60.0, 110.0, 40.0, -10.0, -30.0, 110.0, 200.0, 50.0, 40.0, 50.0, 160.0, 160.0, 120.0, 150.0, 60.0, 10.0, 0.0, 50.0, 40.0, 80.0, 10.0, 0.0, 170.0, 40.0, 100.0, 70.0, 30.0, 340.0, 50.0, 180.0, 10.0, 160.0, 80.0, 40.0, 140.0, 60.0, 80.0, 30.0, 80.0, 50.0, 680.0, 20.0, 180.0, 20.0, 50.0, 40.0, 70.0, 50.0, 30.0, 160.0, 100.0, 20.0, 40.0, 250.0, 80.0, -20.0, 0.0, 50.0, 70.0, 50.0, 360.0, 80.0, 0.0, 80.0, 150.0, 0.0, 160.0, 40.0, 60.0, 100.0, 130.0, 240.0, 90.0, 100.0, 70.0, 30.0, 40.0, 100.0, 120.0, 30.0, 30.0, 70.0, 30.0, 40.0, 370.0, 10.0, 20.0, 230.0, 20.0, 70.0, 20.0, 80.0, 50.0, 90.0, 170.0, 220.0, 180.0, 20.0, 40.0, 570.0, 0.0, 40.0, 30.0, 70.0, 90.0, 190.0, 20.0, 30.0, 80.0, 100.0, 40.0, 80.0, 590.0, 30.0, 70.0, -30.0, 40.0, -40.0, 150.0, 70.0, 70.0, 60.0, 60.0, 60.0, -15.0, 260.0, 110.0, 160.0, 50.0, 0.0, 30.0, 20.0, 0.0, 20.0, 10.0, 40.0, -10.0, 20.0, 0.0, 10.0, 50.0, 30.0, 280.0, 10.0, 0.0, 40.0, 90.0, 30.0, 210.0, 20.0, 20.0, 400.0, 30.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 160.0, 40.0, 50.0, -25.0, 10.0, -20.0, 20.0, 30.0, 290.0, 150.0, 100.0, 50.0, 620.0, 10.0, 90.0, 230.0, 100.0, 80.0, 210.0, 50.0, 100.0, 80.0, 150.0, 40.0, 100.0, 170.0, 180.0, 40.0, 10.0, 80.0, 20.0, 110.0, 20.0, 350.0, 40.0, 240.0, 0.0, 220.0, 80.0, 50.0, 90.0, 110.0, 220.0, 110.0, -110.0, 50.0, 340.0, 340.0, 130.0, 190.0, 10.0, 150.0, 50.0, 0.0, 20.0, 275.0, 0.0, 30.0, 50.0, 20.0, 30.0, 10.0, 100.0, 80.0, 320.0, 15.0, 10.0, 20.0, 170.0, 0.0, -10.0, 70.0, 20.0, 80.0, 130.0, 600.0, 90.0, 40.0, 40.0, 20.0, 20.0, 30.0, 200.0, 100.0, 70.0, 70.0, 20.0, 10.0, 30.0, 110.0, 90.0, 150.0, 170.0, 420.0, 770.0, 100.0, 210.0, 160.0, 0.0, 10.0, 20.0, 10.0, 150.0, 0.0, 80.0, 0.0, 20.0, 30.0, 60.0, 40.0, 50.0, 10.0, 10.0, 460.0, 50.0, 20.0, 320.0, 10.0, 30.0, -10.0, 0.0, 170.0, 25.0, 290.0, 70.0, 210.0, 20.0, 120.0, 20.0, 50.0, 0.0, 60.0, 50.0, 50.0, 30.0, 0.0, 0.0, 50.0, 120.0, 50.0, -135.0, 0.0, -10.0, -100.0, 30.0, 80.0, 190.0, 170.0, 180.0, 190.0, 30.0, 100.0, 20.0, 0.0, 50.0, 90.0, 30.0, -40.0, 170.0, 130.0, 15.0, 80.0, 240.0, 20.0, 30.0, 70.0, 80.0, 40.0, 10.0, 10.0, 300.0, 60.0, 70.0, 40.0, 140.0, 100.0, 20.0, 70.0, 20.0, 240.0, 10.0, 10.0, 30.0, 60.0, 140.0, 20.0, 10.0, 30.0, 50.0, 100.0, 30.0, 60.0, 0.0, 40.0, 150.0, 40.0, 20.0, 30.0, 200.0, -10.0, 260.0, 30.0, 80.0, 100.0, 320.0, 180.0, 80.0, 360.0, 240.0, 210.0, 110.0, 10.0, 0.0, 20.0, 10.0, 20.0, 270.0, 30.0, 60.0, 0.0, 10.0, 50.0, 70.0, 0.0, 80.0, 100.0, 40.0, 120.0, 30.0, 290.0, 30.0, 60.0, 390.0, 170.0, 490.0, 60.0, 50.0, 10.0, 80.0, -10.0, 60.0, 480.0, 40.0, 25.0, 30.0, 50.0, 0.0, 80.0, 50.0, 310.0, 70.0, 80.0, 70.0, 20.0, 10.0, 210.0, 40.0, -40.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 70.0, 20.0, 30.0, 150.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 130.0, 40.0, 30.0, 350.0, 20.0, 490.0, 40.0, 170.0, 40.0, 60.0, 220.0, 30.0, 430.0, 100.0, 80.0, 680.0, 150.0, 30.0, 110.0, -20.0, 10.0, 60.0, 190.0, 100.0, -20.0, 190.0, 300.0, 60.0, 230.0, 150.0, 40.0, 20.0, 80.0, 150.0, 20.0, 180.0, 140.0, 150.0, 100.0, 90.0, 70.0, 140.0, 290.0, 100.0, 280.0, 160.0, 40.0, 150.0, 50.0, 300.0, 90.0, 50.0, 10.0, 60.0, 140.0, 250.0, 310.0, 80.0, 30.0, 70.0, 20.0, 80.0, 0.0, 30.0, 20.0, 170.0, 250.0, 0.0, 100.0, 60.0, 40.0, 80.0, 190.0, 20.0, 90.0, 130.0, 360.0, 60.0, 70.0, 30.0, 210.0, 30.0, 30.0, 30.0, 170.0, 80.0, 570.0, 10.0, 30.0, 280.0, 160.0, 30.0, 180.0, 30.0, 50.0, 10.0, 150.0, 20.0, 80.0, 30.0, 130.0, 20.0, 180.0, 120.0, 100.0, 240.0, 70.0, -10.0, 0.0, 130.0, 110.0, 370.0, 60.0, 50.0, 100.0, 70.0, 50.0, 160.0, 120.0, 230.0, 130.0, 90.0, 50.0, 60.0, 150.0, 30.0, 100.0, 20.0, 80.0, 30.0, 20.0, 40.0, 130.0, 10.0, 120.0, 90.0, 140.0, 50.0, 40.0, 30.0, 20.0, 30.0, 150.0, 90.0, 130.0, 370.0, 170.0, 90.0, -20.0, 20.0, 90.0, 220.0, 50.0, 20.0, 160.0, 40.0, 30.0, 60.0, 190.0, 70.0, 10.0, 70.0, 250.0, 20.0, 60.0, 20.0, 110.0, 150.0, 40.0, 280.0, 230.0, 30.0, 70.0, 90.0, 40.0, 40.0, 10.0, 10.0, 10.0, 140.0, 30.0, 60.0, -10.0, 10.0, 100.0, 90.0, 40.0, 40.0, 150.0, 500.0, 80.0, 20.0, 50.0, 260.0, 0.0, 90.0, 20.0, 20.0, 50.0, 70.0, 320.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 130.0, 0.0, 10.0, 20.0, 10.0, 30.0, 5.0, 10.0, 60.0, 120.0, 230.0, 350.0, 90.0, 65.0, -10.0, 40.0, 50.0, 320.0, 0.0, 0.0, 50.0, 30.0, 20.0, 0.0, 10.0, 80.0, 20.0, 30.0, 570.0, 30.0, 120.0, 20.0, 130.0, 60.0, 0.0, 40.0, 50.0, 410.0, -40.0, 40.0, 150.0, 20.0, 20.0, 30.0, 30.0, 130.0, 650.0, 50.0, 50.0, 80.0, 40.0, 20.0, 0.0, 20.0, 40.0, 30.0, 20.0, 50.0, -30.0, 40.0, 100.0, 260.0, 110.0, 30.0, 380.0, 60.0, 110.0, -100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5315633612672155, "mean_inference_ms": 1.418599488239917, "mean_action_processing_ms": 0.4412827838026707, "mean_env_wait_ms": 1.2622854504988736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012481927871704102, "StateBufferConnector_ms": 0.00945901870727539, "ViewRequirementAgentConnector_ms": 0.36846923828125}, "num_episodes": 18, "episode_return_max": 2080.0, "episode_return_min": 110.0, "episode_return_mean": 881.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.488791720804706, "num_env_steps_trained_throughput_per_sec": 21.488791720804706, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 187115.169, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187115.126, "sample_time_ms": 2550.664, "learn_time_ms": 184545.498, "learn_throughput": 21.675, "synch_weights_time_ms": 10.822}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 64, "trial_id": "90816_00000", "date": "2024-06-10_03-33-23", "timestamp": 1718004803, "time_this_iter_s": 186.15265798568726, "time_total_s": 12080.976744413376, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f34b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12080.976744413376, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 18.32319391634981, "ram_util_percent": 79.40836501901141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3194671577094588, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.514350388479182, "policy_loss": -0.007749036656041988, "vf_loss": 6.5208990346890285, "vf_explained_var": -0.0002119745817174292, "kl": 0.006001954831788267, "entropy": 0.4752058958156675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 605655.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 130.0, "episode_reward_mean": 927.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 92.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [945.0, 605.0, 460.0, 785.0, 1290.0, 620.0, 1320.0, 1010.0, 960.0, 340.0, 690.0, 860.0, 800.0, 890.0, 860.0, 1190.0, 750.0, 980.0, 1020.0, 850.0, 940.0, 1120.0, 1030.0, 885.0, 130.0, 750.0, 670.0, 705.0, 1540.0, 950.0, 1130.0, 1470.0, 605.0, 755.0, 1080.0, 660.0, 2080.0, 410.0, 950.0, 975.0, 410.0, 595.0, 580.0, 595.0, 1060.0, 460.0, 560.0, 1860.0, 530.0, 790.0, 1330.0, 1125.0, 550.0, 420.0, 680.0, 1660.0, 1290.0, 1240.0, 1540.0, 1050.0, 890.0, 1000.0, 1120.0, 1420.0, 840.0, 1120.0, 1110.0, 580.0, 770.0, 1170.0, 800.0, 1060.0, 400.0, 1230.0, 690.0, 265.0, 1315.0, 240.0, 1430.0, 1080.0, 350.0, 960.0, 530.0, 965.0, 1700.0, 1340.0, 1170.0, 1210.0, 1180.0, 730.0, 1400.0, 970.0, 1350.0, 260.0, 960.0, 1780.0, 1120.0, 520.0, 945.0, 440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [420.0, 0.0, 10.0, 80.0, 85.0, -90.0, 370.0, -20.0, 90.0, 0.0, 40.0, 20.0, 10.0, 40.0, 160.0, 40.0, 0.0, 10.0, 250.0, 35.0, 60.0, 30.0, 40.0, 90.0, 90.0, 0.0, 30.0, 30.0, 60.0, 30.0, 20.0, 50.0, 35.0, 40.0, 160.0, 150.0, 50.0, 80.0, 80.0, 120.0, 150.0, 100.0, -50.0, 150.0, 260.0, 380.0, 40.0, 90.0, 60.0, 110.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, 30.0, 180.0, 30.0, 230.0, 180.0, 440.0, 90.0, 60.0, 330.0, 60.0, 80.0, -30.0, 80.0, 30.0, 20.0, 140.0, 150.0, 110.0, 50.0, 50.0, 70.0, 170.0, 40.0, 210.0, 40.0, 180.0, 10.0, 170.0, 50.0, 330.0, 10.0, 140.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, 30.0, 190.0, 10.0, 140.0, 10.0, 330.0, 20.0, 40.0, 10.0, 40.0, 30.0, 60.0, 290.0, 60.0, 110.0, 40.0, -10.0, -30.0, 110.0, 200.0, 50.0, 40.0, 50.0, 160.0, 160.0, 120.0, 150.0, 60.0, 10.0, 0.0, 50.0, 40.0, 80.0, 10.0, 0.0, 170.0, 40.0, 100.0, 70.0, 30.0, 340.0, 50.0, 180.0, 10.0, 160.0, 80.0, 40.0, 140.0, 60.0, 80.0, 30.0, 80.0, 50.0, 680.0, 20.0, 180.0, 20.0, 50.0, 40.0, 70.0, 50.0, 30.0, 160.0, 100.0, 20.0, 40.0, 250.0, 80.0, -20.0, 0.0, 50.0, 70.0, 50.0, 360.0, 80.0, 0.0, 80.0, 150.0, 0.0, 160.0, 40.0, 60.0, 100.0, 130.0, 240.0, 90.0, 100.0, 70.0, 30.0, 40.0, 100.0, 120.0, 30.0, 30.0, 70.0, 30.0, 40.0, 370.0, 10.0, 20.0, 230.0, 20.0, 70.0, 20.0, 80.0, 50.0, 90.0, 170.0, 220.0, 180.0, 20.0, 40.0, 570.0, 0.0, 40.0, 30.0, 70.0, 90.0, 190.0, 20.0, 30.0, 80.0, 100.0, 40.0, 80.0, 590.0, 30.0, 70.0, -30.0, 40.0, -40.0, 150.0, 70.0, 70.0, 60.0, 60.0, 60.0, -15.0, 260.0, 110.0, 160.0, 50.0, 0.0, 30.0, 20.0, 0.0, 20.0, 10.0, 40.0, -10.0, 20.0, 0.0, 10.0, 50.0, 30.0, 280.0, 10.0, 0.0, 40.0, 90.0, 30.0, 210.0, 20.0, 20.0, 400.0, 30.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 160.0, 40.0, 50.0, -25.0, 10.0, -20.0, 20.0, 30.0, 290.0, 150.0, 100.0, 50.0, 620.0, 10.0, 90.0, 230.0, 100.0, 80.0, 210.0, 50.0, 100.0, 80.0, 150.0, 40.0, 100.0, 170.0, 180.0, 40.0, 10.0, 80.0, 20.0, 110.0, 20.0, 350.0, 40.0, 240.0, 0.0, 220.0, 80.0, 50.0, 90.0, 110.0, 220.0, 110.0, -110.0, 50.0, 340.0, 340.0, 130.0, 190.0, 10.0, 150.0, 50.0, 0.0, 20.0, 275.0, 0.0, 30.0, 50.0, 20.0, 30.0, 10.0, 100.0, 80.0, 320.0, 15.0, 10.0, 20.0, 170.0, 0.0, -10.0, 70.0, 20.0, 80.0, 130.0, 600.0, 90.0, 40.0, 40.0, 20.0, 20.0, 30.0, 200.0, 100.0, 70.0, 70.0, 20.0, 10.0, 30.0, 110.0, 90.0, 150.0, 170.0, 420.0, 770.0, 100.0, 210.0, 160.0, 0.0, 10.0, 20.0, 10.0, 150.0, 0.0, 80.0, 0.0, 20.0, 30.0, 60.0, 40.0, 50.0, 10.0, 10.0, 460.0, 50.0, 20.0, 320.0, 10.0, 30.0, -10.0, 0.0, 170.0, 25.0, 290.0, 70.0, 210.0, 20.0, 120.0, 20.0, 50.0, 0.0, 60.0, 50.0, 50.0, 30.0, 0.0, 0.0, 50.0, 120.0, 50.0, -135.0, 0.0, -10.0, -100.0, 30.0, 80.0, 190.0, 170.0, 180.0, 190.0, 30.0, 100.0, 20.0, 0.0, 50.0, 90.0, 30.0, -40.0, 170.0, 130.0, 15.0, 80.0, 240.0, 20.0, 30.0, 70.0, 80.0, 40.0, 10.0, 10.0, 300.0, 60.0, 70.0, 40.0, 140.0, 100.0, 20.0, 70.0, 20.0, 240.0, 10.0, 10.0, 30.0, 60.0, 140.0, 20.0, 10.0, 30.0, 50.0, 100.0, 30.0, 60.0, 0.0, 40.0, 150.0, 40.0, 20.0, 30.0, 200.0, -10.0, 260.0, 30.0, 80.0, 100.0, 320.0, 180.0, 80.0, 360.0, 240.0, 210.0, 110.0, 10.0, 0.0, 20.0, 10.0, 20.0, 270.0, 30.0, 60.0, 0.0, 10.0, 50.0, 70.0, 0.0, 80.0, 100.0, 40.0, 120.0, 30.0, 290.0, 30.0, 60.0, 390.0, 170.0, 490.0, 60.0, 50.0, 10.0, 80.0, -10.0, 60.0, 480.0, 40.0, 25.0, 30.0, 50.0, 0.0, 80.0, 50.0, 310.0, 70.0, 80.0, 70.0, 20.0, 10.0, 210.0, 40.0, -40.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 70.0, 20.0, 30.0, 150.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 130.0, 40.0, 30.0, 350.0, 20.0, 490.0, 40.0, 170.0, 40.0, 60.0, 220.0, 30.0, 430.0, 100.0, 80.0, 680.0, 150.0, 30.0, 110.0, -20.0, 10.0, 60.0, 190.0, 100.0, -20.0, 190.0, 300.0, 60.0, 230.0, 150.0, 40.0, 20.0, 80.0, 150.0, 20.0, 180.0, 140.0, 150.0, 100.0, 90.0, 70.0, 140.0, 290.0, 100.0, 280.0, 160.0, 40.0, 150.0, 50.0, 300.0, 90.0, 50.0, 10.0, 60.0, 140.0, 250.0, 310.0, 80.0, 30.0, 70.0, 20.0, 80.0, 0.0, 30.0, 20.0, 170.0, 250.0, 0.0, 100.0, 60.0, 40.0, 80.0, 190.0, 20.0, 90.0, 130.0, 360.0, 60.0, 70.0, 30.0, 210.0, 30.0, 30.0, 30.0, 170.0, 80.0, 570.0, 10.0, 30.0, 280.0, 160.0, 30.0, 180.0, 30.0, 50.0, 10.0, 150.0, 20.0, 80.0, 30.0, 130.0, 20.0, 180.0, 120.0, 100.0, 240.0, 70.0, -10.0, 0.0, 130.0, 110.0, 370.0, 60.0, 50.0, 100.0, 70.0, 50.0, 160.0, 120.0, 230.0, 130.0, 90.0, 50.0, 60.0, 150.0, 30.0, 100.0, 20.0, 80.0, 30.0, 20.0, 40.0, 130.0, 10.0, 120.0, 90.0, 140.0, 50.0, 40.0, 30.0, 20.0, 30.0, 150.0, 90.0, 130.0, 370.0, 170.0, 90.0, -20.0, 20.0, 90.0, 220.0, 50.0, 20.0, 160.0, 40.0, 30.0, 60.0, 190.0, 70.0, 10.0, 70.0, 250.0, 20.0, 60.0, 20.0, 110.0, 150.0, 40.0, 280.0, 230.0, 30.0, 70.0, 90.0, 40.0, 40.0, 10.0, 10.0, 10.0, 140.0, 30.0, 60.0, -10.0, 10.0, 100.0, 90.0, 40.0, 40.0, 150.0, 500.0, 80.0, 20.0, 50.0, 260.0, 0.0, 90.0, 20.0, 20.0, 50.0, 70.0, 320.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 130.0, 0.0, 10.0, 20.0, 10.0, 30.0, 5.0, 10.0, 60.0, 120.0, 230.0, 350.0, 90.0, 65.0, -10.0, 40.0, 50.0, 320.0, 0.0, 0.0, 50.0, 30.0, 20.0, 0.0, 10.0, 80.0, 20.0, 30.0, 570.0, 30.0, 120.0, 20.0, 130.0, 60.0, 0.0, 40.0, 50.0, 410.0, -40.0, 40.0, 150.0, 20.0, 20.0, 30.0, 30.0, 130.0, 650.0, 50.0, 50.0, 80.0, 40.0, 20.0, 0.0, 20.0, 40.0, 30.0, 20.0, 50.0, -30.0, 40.0, 100.0, 260.0, 110.0, 30.0, 380.0, 60.0, 110.0, -100.0, 40.0, 80.0, 160.0, 0.0, 40.0, 0.0, 20.0, 20.0, 170.0, 0.0, 30.0, 70.0, 20.0, 210.0, 30.0, 300.0, 45.0, 40.0, 200.0, 20.0, 130.0, 310.0, 50.0, -50.0, 160.0, 140.0, 490.0, 80.0, 160.0, 230.0, 90.0, 70.0, 320.0, 180.0, 100.0, 150.0, 40.0, 130.0, 50.0, 210.0, 20.0, 220.0, 0.0, 40.0, 250.0, 70.0, 70.0, 180.0, 250.0, 70.0, 180.0, 0.0, -40.0, 40.0, 30.0, -30.0, 350.0, 550.0, 50.0, 80.0, 10.0, -20.0, 30.0, 230.0, 0.0, 30.0, 40.0, 30.0, 580.0, 250.0, 40.0, 40.0, 0.0, 100.0, 70.0, 30.0, 10.0, 390.0, 0.0, 50.0, 350.0, 80.0, 250.0, 40.0, 100.0, 130.0, 110.0, 60.0, 210.0, 70.0, 30.0, 80.0, 40.0, 190.0, 300.0, 90.0, 200.0, 10.0, 30.0, 0.0, -20.0, 390.0, 60.0, 100.0, 300.0, 320.0, 50.0, 80.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 140.0, 60.0, 10.0, 0.0, 270.0, 50.0, 90.0, 320.0, 310.0, -10.0, 300.0, 120.0, 90.0, -5.0, 680.0, 220.0, 40.0, 35.0, 80.0, 70.0, 20.0, 100.0, 50.0, 420.0, 150.0, 20.0, 120.0, 90.0, -50.0, 20.0, 40.0, 170.0, 40.0, 10.0, 10.0, 50.0, 50.0, 180.0, 30.0, -40.0, 40.0, 480.0, -60.0, -70.0, -120.0, -25.0, 520.0, 190.0, 20.0, 90.0, 10.0, 50.0, 30.0, 10.0, 50.0, 40.0, 60.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5305963651788677, "mean_inference_ms": 1.4179958076533552, "mean_action_processing_ms": 0.44042689147293373, "mean_env_wait_ms": 1.261643030177384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012403726577758789, "StateBufferConnector_ms": 0.009310722351074219, "ViewRequirementAgentConnector_ms": 0.3637509346008301}, "num_episodes": 18, "episode_return_max": 2080.0, "episode_return_min": 130.0, "episode_return_mean": 927.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.70311491249729, "num_env_steps_trained_throughput_per_sec": 21.70311491249729, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 2600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2600000, "timers": {"training_iteration_time_ms": 186816.469, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186816.426, "sample_time_ms": 2503.303, "learn_time_ms": 184294.435, "learn_throughput": 21.704, "synch_weights_time_ms": 10.655}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "done": false, "training_iteration": 65, "trial_id": "90816_00000", "date": "2024-06-10_03-36-27", "timestamp": 1718004987, "time_this_iter_s": 184.31656289100647, "time_total_s": 12265.293307304382, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f9040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12265.293307304382, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.852107279693485, "ram_util_percent": 78.28965517241379}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.316904000853832, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.214440769534776, "policy_loss": -0.00853397394396579, "vf_loss": 6.221608823759995, "vf_explained_var": -0.000461276308797038, "kl": 0.006829613411877567, "entropy": 0.49740106111771254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 615045.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 130.0, "episode_reward_mean": 917.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 91.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1030.0, 885.0, 130.0, 750.0, 670.0, 705.0, 1540.0, 950.0, 1130.0, 1470.0, 605.0, 755.0, 1080.0, 660.0, 2080.0, 410.0, 950.0, 975.0, 410.0, 595.0, 580.0, 595.0, 1060.0, 460.0, 560.0, 1860.0, 530.0, 790.0, 1330.0, 1125.0, 550.0, 420.0, 680.0, 1660.0, 1290.0, 1240.0, 1540.0, 1050.0, 890.0, 1000.0, 1120.0, 1420.0, 840.0, 1120.0, 1110.0, 580.0, 770.0, 1170.0, 800.0, 1060.0, 400.0, 1230.0, 690.0, 265.0, 1315.0, 240.0, 1430.0, 1080.0, 350.0, 960.0, 530.0, 965.0, 1700.0, 1340.0, 1170.0, 1210.0, 1180.0, 730.0, 1400.0, 970.0, 1350.0, 260.0, 960.0, 1780.0, 1120.0, 520.0, 945.0, 440.0, 830.0, 610.0, 490.0, 260.0, 1430.0, 970.0, 610.0, 960.0, 235.0, 840.0, 1790.0, 860.0, 780.0, 680.0, 700.0, 1380.0, 440.0, 820.0, 1050.0, 940.0, 840.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 40.0, 80.0, 590.0, 30.0, 70.0, -30.0, 40.0, -40.0, 150.0, 70.0, 70.0, 60.0, 60.0, 60.0, -15.0, 260.0, 110.0, 160.0, 50.0, 0.0, 30.0, 20.0, 0.0, 20.0, 10.0, 40.0, -10.0, 20.0, 0.0, 10.0, 50.0, 30.0, 280.0, 10.0, 0.0, 40.0, 90.0, 30.0, 210.0, 20.0, 20.0, 400.0, 30.0, 50.0, 20.0, 30.0, 20.0, 40.0, 40.0, 160.0, 40.0, 50.0, -25.0, 10.0, -20.0, 20.0, 30.0, 290.0, 150.0, 100.0, 50.0, 620.0, 10.0, 90.0, 230.0, 100.0, 80.0, 210.0, 50.0, 100.0, 80.0, 150.0, 40.0, 100.0, 170.0, 180.0, 40.0, 10.0, 80.0, 20.0, 110.0, 20.0, 350.0, 40.0, 240.0, 0.0, 220.0, 80.0, 50.0, 90.0, 110.0, 220.0, 110.0, -110.0, 50.0, 340.0, 340.0, 130.0, 190.0, 10.0, 150.0, 50.0, 0.0, 20.0, 275.0, 0.0, 30.0, 50.0, 20.0, 30.0, 10.0, 100.0, 80.0, 320.0, 15.0, 10.0, 20.0, 170.0, 0.0, -10.0, 70.0, 20.0, 80.0, 130.0, 600.0, 90.0, 40.0, 40.0, 20.0, 20.0, 30.0, 200.0, 100.0, 70.0, 70.0, 20.0, 10.0, 30.0, 110.0, 90.0, 150.0, 170.0, 420.0, 770.0, 100.0, 210.0, 160.0, 0.0, 10.0, 20.0, 10.0, 150.0, 0.0, 80.0, 0.0, 20.0, 30.0, 60.0, 40.0, 50.0, 10.0, 10.0, 460.0, 50.0, 20.0, 320.0, 10.0, 30.0, -10.0, 0.0, 170.0, 25.0, 290.0, 70.0, 210.0, 20.0, 120.0, 20.0, 50.0, 0.0, 60.0, 50.0, 50.0, 30.0, 0.0, 0.0, 50.0, 120.0, 50.0, -135.0, 0.0, -10.0, -100.0, 30.0, 80.0, 190.0, 170.0, 180.0, 190.0, 30.0, 100.0, 20.0, 0.0, 50.0, 90.0, 30.0, -40.0, 170.0, 130.0, 15.0, 80.0, 240.0, 20.0, 30.0, 70.0, 80.0, 40.0, 10.0, 10.0, 300.0, 60.0, 70.0, 40.0, 140.0, 100.0, 20.0, 70.0, 20.0, 240.0, 10.0, 10.0, 30.0, 60.0, 140.0, 20.0, 10.0, 30.0, 50.0, 100.0, 30.0, 60.0, 0.0, 40.0, 150.0, 40.0, 20.0, 30.0, 200.0, -10.0, 260.0, 30.0, 80.0, 100.0, 320.0, 180.0, 80.0, 360.0, 240.0, 210.0, 110.0, 10.0, 0.0, 20.0, 10.0, 20.0, 270.0, 30.0, 60.0, 0.0, 10.0, 50.0, 70.0, 0.0, 80.0, 100.0, 40.0, 120.0, 30.0, 290.0, 30.0, 60.0, 390.0, 170.0, 490.0, 60.0, 50.0, 10.0, 80.0, -10.0, 60.0, 480.0, 40.0, 25.0, 30.0, 50.0, 0.0, 80.0, 50.0, 310.0, 70.0, 80.0, 70.0, 20.0, 10.0, 210.0, 40.0, -40.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 70.0, 20.0, 30.0, 150.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 130.0, 40.0, 30.0, 350.0, 20.0, 490.0, 40.0, 170.0, 40.0, 60.0, 220.0, 30.0, 430.0, 100.0, 80.0, 680.0, 150.0, 30.0, 110.0, -20.0, 10.0, 60.0, 190.0, 100.0, -20.0, 190.0, 300.0, 60.0, 230.0, 150.0, 40.0, 20.0, 80.0, 150.0, 20.0, 180.0, 140.0, 150.0, 100.0, 90.0, 70.0, 140.0, 290.0, 100.0, 280.0, 160.0, 40.0, 150.0, 50.0, 300.0, 90.0, 50.0, 10.0, 60.0, 140.0, 250.0, 310.0, 80.0, 30.0, 70.0, 20.0, 80.0, 0.0, 30.0, 20.0, 170.0, 250.0, 0.0, 100.0, 60.0, 40.0, 80.0, 190.0, 20.0, 90.0, 130.0, 360.0, 60.0, 70.0, 30.0, 210.0, 30.0, 30.0, 30.0, 170.0, 80.0, 570.0, 10.0, 30.0, 280.0, 160.0, 30.0, 180.0, 30.0, 50.0, 10.0, 150.0, 20.0, 80.0, 30.0, 130.0, 20.0, 180.0, 120.0, 100.0, 240.0, 70.0, -10.0, 0.0, 130.0, 110.0, 370.0, 60.0, 50.0, 100.0, 70.0, 50.0, 160.0, 120.0, 230.0, 130.0, 90.0, 50.0, 60.0, 150.0, 30.0, 100.0, 20.0, 80.0, 30.0, 20.0, 40.0, 130.0, 10.0, 120.0, 90.0, 140.0, 50.0, 40.0, 30.0, 20.0, 30.0, 150.0, 90.0, 130.0, 370.0, 170.0, 90.0, -20.0, 20.0, 90.0, 220.0, 50.0, 20.0, 160.0, 40.0, 30.0, 60.0, 190.0, 70.0, 10.0, 70.0, 250.0, 20.0, 60.0, 20.0, 110.0, 150.0, 40.0, 280.0, 230.0, 30.0, 70.0, 90.0, 40.0, 40.0, 10.0, 10.0, 10.0, 140.0, 30.0, 60.0, -10.0, 10.0, 100.0, 90.0, 40.0, 40.0, 150.0, 500.0, 80.0, 20.0, 50.0, 260.0, 0.0, 90.0, 20.0, 20.0, 50.0, 70.0, 320.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 130.0, 0.0, 10.0, 20.0, 10.0, 30.0, 5.0, 10.0, 60.0, 120.0, 230.0, 350.0, 90.0, 65.0, -10.0, 40.0, 50.0, 320.0, 0.0, 0.0, 50.0, 30.0, 20.0, 0.0, 10.0, 80.0, 20.0, 30.0, 570.0, 30.0, 120.0, 20.0, 130.0, 60.0, 0.0, 40.0, 50.0, 410.0, -40.0, 40.0, 150.0, 20.0, 20.0, 30.0, 30.0, 130.0, 650.0, 50.0, 50.0, 80.0, 40.0, 20.0, 0.0, 20.0, 40.0, 30.0, 20.0, 50.0, -30.0, 40.0, 100.0, 260.0, 110.0, 30.0, 380.0, 60.0, 110.0, -100.0, 40.0, 80.0, 160.0, 0.0, 40.0, 0.0, 20.0, 20.0, 170.0, 0.0, 30.0, 70.0, 20.0, 210.0, 30.0, 300.0, 45.0, 40.0, 200.0, 20.0, 130.0, 310.0, 50.0, -50.0, 160.0, 140.0, 490.0, 80.0, 160.0, 230.0, 90.0, 70.0, 320.0, 180.0, 100.0, 150.0, 40.0, 130.0, 50.0, 210.0, 20.0, 220.0, 0.0, 40.0, 250.0, 70.0, 70.0, 180.0, 250.0, 70.0, 180.0, 0.0, -40.0, 40.0, 30.0, -30.0, 350.0, 550.0, 50.0, 80.0, 10.0, -20.0, 30.0, 230.0, 0.0, 30.0, 40.0, 30.0, 580.0, 250.0, 40.0, 40.0, 0.0, 100.0, 70.0, 30.0, 10.0, 390.0, 0.0, 50.0, 350.0, 80.0, 250.0, 40.0, 100.0, 130.0, 110.0, 60.0, 210.0, 70.0, 30.0, 80.0, 40.0, 190.0, 300.0, 90.0, 200.0, 10.0, 30.0, 0.0, -20.0, 390.0, 60.0, 100.0, 300.0, 320.0, 50.0, 80.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 140.0, 60.0, 10.0, 0.0, 270.0, 50.0, 90.0, 320.0, 310.0, -10.0, 300.0, 120.0, 90.0, -5.0, 680.0, 220.0, 40.0, 35.0, 80.0, 70.0, 20.0, 100.0, 50.0, 420.0, 150.0, 20.0, 120.0, 90.0, -50.0, 20.0, 40.0, 170.0, 40.0, 10.0, 10.0, 50.0, 50.0, 180.0, 30.0, -40.0, 40.0, 480.0, -60.0, -70.0, -120.0, -25.0, 520.0, 190.0, 20.0, 90.0, 10.0, 50.0, 30.0, 10.0, 50.0, 40.0, 60.0, 80.0, -10.0, 30.0, 20.0, 70.0, 160.0, 10.0, 480.0, 0.0, 20.0, 50.0, 20.0, 0.0, 190.0, 30.0, 100.0, 130.0, 30.0, 70.0, 30.0, 10.0, 110.0, 10.0, 40.0, 0.0, 70.0, 170.0, 10.0, 0.0, 50.0, 30.0, 30.0, -10.0, 20.0, 30.0, 50.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 40.0, 270.0, 700.0, 20.0, 40.0, -20.0, 10.0, 20.0, 310.0, 70.0, 0.0, 40.0, 80.0, 390.0, 90.0, 70.0, 10.0, 160.0, 60.0, 100.0, 30.0, 370.0, 10.0, 30.0, 80.0, -40.0, 20.0, -20.0, 30.0, 80.0, 150.0, 340.0, 20.0, 15.0, 110.0, 0.0, 70.0, 70.0, 105.0, 80.0, 40.0, 15.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, -20.0, 30.0, 70.0, 290.0, -80.0, 190.0, 70.0, 180.0, 10.0, 100.0, 180.0, 600.0, 120.0, 90.0, 70.0, 10.0, 420.0, 240.0, -10.0, 70.0, 30.0, 0.0, 100.0, 20.0, 100.0, 20.0, 60.0, 360.0, 130.0, 40.0, 40.0, 20.0, 80.0, 10.0, 40.0, 140.0, 290.0, 10.0, 80.0, 70.0, 30.0, -20.0, 40.0, 90.0, 0.0, 350.0, -10.0, 10.0, 150.0, 40.0, 40.0, 190.0, 60.0, 30.0, 0.0, 40.0, 250.0, 40.0, 10.0, 40.0, 230.0, 30.0, 40.0, 330.0, 420.0, 170.0, 70.0, 50.0, 90.0, -50.0, 170.0, 20.0, 20.0, 20.0, 40.0, 40.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 0.0, 70.0, 40.0, 320.0, 20.0, 60.0, 170.0, 110.0, 240.0, 460.0, 40.0, 100.0, 80.0, -20.0, -10.0, 100.0, 30.0, 30.0, 150.0, 100.0, 40.0, 260.0, 50.0, 0.0, 280.0, -30.0, 90.0, 0.0, 30.0, 20.0, 100.0, 130.0, 20.0, 20.0, 90.0, 20.0, 30.0, 380.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 350.0, 60.0, 20.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5297348493600686, "mean_inference_ms": 1.4171844842803358, "mean_action_processing_ms": 0.4393762723794994, "mean_env_wait_ms": 1.260848075662717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012357711791992188, "StateBufferConnector_ms": 0.009265661239624023, "ViewRequirementAgentConnector_ms": 0.36290788650512695}, "num_episodes": 22, "episode_return_max": 2080.0, "episode_return_min": 130.0, "episode_return_mean": 917.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.638287743334338, "num_env_steps_trained_throughput_per_sec": 21.638287743334338, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 186574.847, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186574.803, "sample_time_ms": 2508.068, "learn_time_ms": 184048.234, "learn_throughput": 21.733, "synch_weights_time_ms": 10.611}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 66, "trial_id": "90816_00000", "date": "2024-06-10_03-39-32", "timestamp": 1718005172, "time_this_iter_s": 184.8680808544159, "time_total_s": 12450.161388158798, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00e1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12450.161388158798, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.269731800766284, "ram_util_percent": 79.37547892720306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4187148480687024, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.557076751081326, "policy_loss": -0.009970463516217427, "vf_loss": 6.565616589841751, "vf_explained_var": 0.00038810242225313847, "kl": 0.007153101283958414, "entropy": 0.4897632677651569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 624435.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "env_runners": {"episode_reward_max": 1860.0, "episode_reward_min": 235.0, "episode_reward_mean": 907.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 90.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [460.0, 560.0, 1860.0, 530.0, 790.0, 1330.0, 1125.0, 550.0, 420.0, 680.0, 1660.0, 1290.0, 1240.0, 1540.0, 1050.0, 890.0, 1000.0, 1120.0, 1420.0, 840.0, 1120.0, 1110.0, 580.0, 770.0, 1170.0, 800.0, 1060.0, 400.0, 1230.0, 690.0, 265.0, 1315.0, 240.0, 1430.0, 1080.0, 350.0, 960.0, 530.0, 965.0, 1700.0, 1340.0, 1170.0, 1210.0, 1180.0, 730.0, 1400.0, 970.0, 1350.0, 260.0, 960.0, 1780.0, 1120.0, 520.0, 945.0, 440.0, 830.0, 610.0, 490.0, 260.0, 1430.0, 970.0, 610.0, 960.0, 235.0, 840.0, 1790.0, 860.0, 780.0, 680.0, 700.0, 1380.0, 440.0, 820.0, 1050.0, 940.0, 840.0, 700.0, 480.0, 760.0, 1445.0, 620.0, 1460.0, 480.0, 955.0, 380.0, 565.0, 570.0, 870.0, 1005.0, 860.0, 830.0, 1160.0, 1020.0, 1005.0, 620.0, 320.0, 635.0, 1150.0, 940.0, 890.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 30.0, 60.0, 140.0, 20.0, 10.0, 30.0, 50.0, 100.0, 30.0, 60.0, 0.0, 40.0, 150.0, 40.0, 20.0, 30.0, 200.0, -10.0, 260.0, 30.0, 80.0, 100.0, 320.0, 180.0, 80.0, 360.0, 240.0, 210.0, 110.0, 10.0, 0.0, 20.0, 10.0, 20.0, 270.0, 30.0, 60.0, 0.0, 10.0, 50.0, 70.0, 0.0, 80.0, 100.0, 40.0, 120.0, 30.0, 290.0, 30.0, 60.0, 390.0, 170.0, 490.0, 60.0, 50.0, 10.0, 80.0, -10.0, 60.0, 480.0, 40.0, 25.0, 30.0, 50.0, 0.0, 80.0, 50.0, 310.0, 70.0, 80.0, 70.0, 20.0, 10.0, 210.0, 40.0, -40.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 70.0, 20.0, 30.0, 150.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 130.0, 40.0, 30.0, 350.0, 20.0, 490.0, 40.0, 170.0, 40.0, 60.0, 220.0, 30.0, 430.0, 100.0, 80.0, 680.0, 150.0, 30.0, 110.0, -20.0, 10.0, 60.0, 190.0, 100.0, -20.0, 190.0, 300.0, 60.0, 230.0, 150.0, 40.0, 20.0, 80.0, 150.0, 20.0, 180.0, 140.0, 150.0, 100.0, 90.0, 70.0, 140.0, 290.0, 100.0, 280.0, 160.0, 40.0, 150.0, 50.0, 300.0, 90.0, 50.0, 10.0, 60.0, 140.0, 250.0, 310.0, 80.0, 30.0, 70.0, 20.0, 80.0, 0.0, 30.0, 20.0, 170.0, 250.0, 0.0, 100.0, 60.0, 40.0, 80.0, 190.0, 20.0, 90.0, 130.0, 360.0, 60.0, 70.0, 30.0, 210.0, 30.0, 30.0, 30.0, 170.0, 80.0, 570.0, 10.0, 30.0, 280.0, 160.0, 30.0, 180.0, 30.0, 50.0, 10.0, 150.0, 20.0, 80.0, 30.0, 130.0, 20.0, 180.0, 120.0, 100.0, 240.0, 70.0, -10.0, 0.0, 130.0, 110.0, 370.0, 60.0, 50.0, 100.0, 70.0, 50.0, 160.0, 120.0, 230.0, 130.0, 90.0, 50.0, 60.0, 150.0, 30.0, 100.0, 20.0, 80.0, 30.0, 20.0, 40.0, 130.0, 10.0, 120.0, 90.0, 140.0, 50.0, 40.0, 30.0, 20.0, 30.0, 150.0, 90.0, 130.0, 370.0, 170.0, 90.0, -20.0, 20.0, 90.0, 220.0, 50.0, 20.0, 160.0, 40.0, 30.0, 60.0, 190.0, 70.0, 10.0, 70.0, 250.0, 20.0, 60.0, 20.0, 110.0, 150.0, 40.0, 280.0, 230.0, 30.0, 70.0, 90.0, 40.0, 40.0, 10.0, 10.0, 10.0, 140.0, 30.0, 60.0, -10.0, 10.0, 100.0, 90.0, 40.0, 40.0, 150.0, 500.0, 80.0, 20.0, 50.0, 260.0, 0.0, 90.0, 20.0, 20.0, 50.0, 70.0, 320.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 130.0, 0.0, 10.0, 20.0, 10.0, 30.0, 5.0, 10.0, 60.0, 120.0, 230.0, 350.0, 90.0, 65.0, -10.0, 40.0, 50.0, 320.0, 0.0, 0.0, 50.0, 30.0, 20.0, 0.0, 10.0, 80.0, 20.0, 30.0, 570.0, 30.0, 120.0, 20.0, 130.0, 60.0, 0.0, 40.0, 50.0, 410.0, -40.0, 40.0, 150.0, 20.0, 20.0, 30.0, 30.0, 130.0, 650.0, 50.0, 50.0, 80.0, 40.0, 20.0, 0.0, 20.0, 40.0, 30.0, 20.0, 50.0, -30.0, 40.0, 100.0, 260.0, 110.0, 30.0, 380.0, 60.0, 110.0, -100.0, 40.0, 80.0, 160.0, 0.0, 40.0, 0.0, 20.0, 20.0, 170.0, 0.0, 30.0, 70.0, 20.0, 210.0, 30.0, 300.0, 45.0, 40.0, 200.0, 20.0, 130.0, 310.0, 50.0, -50.0, 160.0, 140.0, 490.0, 80.0, 160.0, 230.0, 90.0, 70.0, 320.0, 180.0, 100.0, 150.0, 40.0, 130.0, 50.0, 210.0, 20.0, 220.0, 0.0, 40.0, 250.0, 70.0, 70.0, 180.0, 250.0, 70.0, 180.0, 0.0, -40.0, 40.0, 30.0, -30.0, 350.0, 550.0, 50.0, 80.0, 10.0, -20.0, 30.0, 230.0, 0.0, 30.0, 40.0, 30.0, 580.0, 250.0, 40.0, 40.0, 0.0, 100.0, 70.0, 30.0, 10.0, 390.0, 0.0, 50.0, 350.0, 80.0, 250.0, 40.0, 100.0, 130.0, 110.0, 60.0, 210.0, 70.0, 30.0, 80.0, 40.0, 190.0, 300.0, 90.0, 200.0, 10.0, 30.0, 0.0, -20.0, 390.0, 60.0, 100.0, 300.0, 320.0, 50.0, 80.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 140.0, 60.0, 10.0, 0.0, 270.0, 50.0, 90.0, 320.0, 310.0, -10.0, 300.0, 120.0, 90.0, -5.0, 680.0, 220.0, 40.0, 35.0, 80.0, 70.0, 20.0, 100.0, 50.0, 420.0, 150.0, 20.0, 120.0, 90.0, -50.0, 20.0, 40.0, 170.0, 40.0, 10.0, 10.0, 50.0, 50.0, 180.0, 30.0, -40.0, 40.0, 480.0, -60.0, -70.0, -120.0, -25.0, 520.0, 190.0, 20.0, 90.0, 10.0, 50.0, 30.0, 10.0, 50.0, 40.0, 60.0, 80.0, -10.0, 30.0, 20.0, 70.0, 160.0, 10.0, 480.0, 0.0, 20.0, 50.0, 20.0, 0.0, 190.0, 30.0, 100.0, 130.0, 30.0, 70.0, 30.0, 10.0, 110.0, 10.0, 40.0, 0.0, 70.0, 170.0, 10.0, 0.0, 50.0, 30.0, 30.0, -10.0, 20.0, 30.0, 50.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 40.0, 270.0, 700.0, 20.0, 40.0, -20.0, 10.0, 20.0, 310.0, 70.0, 0.0, 40.0, 80.0, 390.0, 90.0, 70.0, 10.0, 160.0, 60.0, 100.0, 30.0, 370.0, 10.0, 30.0, 80.0, -40.0, 20.0, -20.0, 30.0, 80.0, 150.0, 340.0, 20.0, 15.0, 110.0, 0.0, 70.0, 70.0, 105.0, 80.0, 40.0, 15.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, -20.0, 30.0, 70.0, 290.0, -80.0, 190.0, 70.0, 180.0, 10.0, 100.0, 180.0, 600.0, 120.0, 90.0, 70.0, 10.0, 420.0, 240.0, -10.0, 70.0, 30.0, 0.0, 100.0, 20.0, 100.0, 20.0, 60.0, 360.0, 130.0, 40.0, 40.0, 20.0, 80.0, 10.0, 40.0, 140.0, 290.0, 10.0, 80.0, 70.0, 30.0, -20.0, 40.0, 90.0, 0.0, 350.0, -10.0, 10.0, 150.0, 40.0, 40.0, 190.0, 60.0, 30.0, 0.0, 40.0, 250.0, 40.0, 10.0, 40.0, 230.0, 30.0, 40.0, 330.0, 420.0, 170.0, 70.0, 50.0, 90.0, -50.0, 170.0, 20.0, 20.0, 20.0, 40.0, 40.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 0.0, 70.0, 40.0, 320.0, 20.0, 60.0, 170.0, 110.0, 240.0, 460.0, 40.0, 100.0, 80.0, -20.0, -10.0, 100.0, 30.0, 30.0, 150.0, 100.0, 40.0, 260.0, 50.0, 0.0, 280.0, -30.0, 90.0, 0.0, 30.0, 20.0, 100.0, 130.0, 20.0, 20.0, 90.0, 20.0, 30.0, 380.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 350.0, 60.0, 20.0, 150.0, 0.0, 20.0, 10.0, 20.0, 50.0, 30.0, 90.0, 0.0, 0.0, 260.0, 310.0, 180.0, 130.0, 120.0, -30.0, 0.0, 20.0, 90.0, -100.0, 40.0, 250.0, -20.0, 70.0, 0.0, 110.0, 90.0, 120.0, 220.0, 670.0, -65.0, -140.0, 50.0, 240.0, 120.0, -290.0, 10.0, -110.0, 340.0, 10.0, 390.0, 320.0, 30.0, -50.0, 390.0, 70.0, 170.0, 340.0, 80.0, 80.0, 30.0, 20.0, 230.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 40.0, 50.0, -75.0, 30.0, 130.0, 360.0, 40.0, 240.0, 90.0, 170.0, -50.0, 20.0, 160.0, 10.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 0.0, 30.0, 45.0, 30.0, 40.0, 50.0, 20.0, 40.0, 20.0, 0.0, 310.0, 10.0, 40.0, 20.0, 160.0, 150.0, 40.0, 20.0, 30.0, 0.0, 50.0, 60.0, 15.0, 120.0, 160.0, 180.0, 30.0, -55.0, 0.0, 60.0, 70.0, 290.0, 30.0, 20.0, 40.0, 60.0, 80.0, 30.0, 25.0, 390.0, 0.0, 330.0, 320.0, 170.0, 70.0, 20.0, 170.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 150.0, 40.0, 0.0, 460.0, 10.0, 60.0, 10.0, 80.0, 20.0, 70.0, 380.0, 160.0, 30.0, 30.0, 60.0, 10.0, 50.0, 150.0, 220.0, 220.0, 10.0, 180.0, 150.0, 160.0, 90.0, 40.0, 130.0, 0.0, 40.0, 480.0, 170.0, 20.0, 80.0, 10.0, 70.0, 15.0, 30.0, 20.0, 110.0, 80.0, 110.0, 100.0, 0.0, 60.0, 30.0, 30.0, 40.0, 160.0, 10.0, 90.0, 0.0, 0.0, 0.0, 60.0, 20.0, 10.0, 80.0, 40.0, 20.0, 190.0, 50.0, 80.0, 20.0, 0.0, 220.0, 10.0, 20.0, 15.0, 30.0, 550.0, 100.0, 150.0, 20.0, 60.0, 60.0, 60.0, -30.0, -10.0, 190.0, 150.0, 10.0, 170.0, 40.0, 10.0, 100.0, 170.0, 50.0, 210.0, 30.0, -40.0, 170.0, 410.0, 40.0, 100.0, 30.0, 90.0, 30.0, 50.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5293226734216443, "mean_inference_ms": 1.4187725841015657, "mean_action_processing_ms": 0.4378248965185294, "mean_env_wait_ms": 1.259602557939312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012939214706420898, "StateBufferConnector_ms": 0.009316444396972656, "ViewRequirementAgentConnector_ms": 0.3699357509613037}, "num_episodes": 23, "episode_return_max": 1860.0, "episode_return_min": 235.0, "episode_return_mean": 907.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.634471324713708, "num_env_steps_trained_throughput_per_sec": 21.634471324713708, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 2680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2680000, "timers": {"training_iteration_time_ms": 186481.118, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186481.074, "sample_time_ms": 2477.261, "learn_time_ms": 183985.109, "learn_throughput": 21.741, "synch_weights_time_ms": 10.722}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "done": false, "training_iteration": 67, "trial_id": "90816_00000", "date": "2024-06-10_03-42-37", "timestamp": 1718005357, "time_this_iter_s": 184.9018530845642, "time_total_s": 12635.063241243362, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00f9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12635.063241243362, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.522900763358777, "ram_util_percent": 79.47862595419846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0105950026974257, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.968363369920383, "policy_loss": -0.008472866895588767, "vf_loss": 5.97545624962503, "vf_explained_var": 2.5161189900927396e-05, "kl": 0.006899894791569936, "entropy": 0.47790667119815833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 633825.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 235.0, "episode_reward_mean": 877.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 87.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1420.0, 840.0, 1120.0, 1110.0, 580.0, 770.0, 1170.0, 800.0, 1060.0, 400.0, 1230.0, 690.0, 265.0, 1315.0, 240.0, 1430.0, 1080.0, 350.0, 960.0, 530.0, 965.0, 1700.0, 1340.0, 1170.0, 1210.0, 1180.0, 730.0, 1400.0, 970.0, 1350.0, 260.0, 960.0, 1780.0, 1120.0, 520.0, 945.0, 440.0, 830.0, 610.0, 490.0, 260.0, 1430.0, 970.0, 610.0, 960.0, 235.0, 840.0, 1790.0, 860.0, 780.0, 680.0, 700.0, 1380.0, 440.0, 820.0, 1050.0, 940.0, 840.0, 700.0, 480.0, 760.0, 1445.0, 620.0, 1460.0, 480.0, 955.0, 380.0, 565.0, 570.0, 870.0, 1005.0, 860.0, 830.0, 1160.0, 1020.0, 1005.0, 620.0, 320.0, 635.0, 1150.0, 940.0, 890.0, 1220.0, 305.0, 1160.0, 660.0, 1010.0, 290.0, 610.0, 1060.0, 790.0, 660.0, 1220.0, 470.0, 345.0, 640.0, 950.0, 1120.0, 1140.0, 1420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 570.0, 10.0, 30.0, 280.0, 160.0, 30.0, 180.0, 30.0, 50.0, 10.0, 150.0, 20.0, 80.0, 30.0, 130.0, 20.0, 180.0, 120.0, 100.0, 240.0, 70.0, -10.0, 0.0, 130.0, 110.0, 370.0, 60.0, 50.0, 100.0, 70.0, 50.0, 160.0, 120.0, 230.0, 130.0, 90.0, 50.0, 60.0, 150.0, 30.0, 100.0, 20.0, 80.0, 30.0, 20.0, 40.0, 130.0, 10.0, 120.0, 90.0, 140.0, 50.0, 40.0, 30.0, 20.0, 30.0, 150.0, 90.0, 130.0, 370.0, 170.0, 90.0, -20.0, 20.0, 90.0, 220.0, 50.0, 20.0, 160.0, 40.0, 30.0, 60.0, 190.0, 70.0, 10.0, 70.0, 250.0, 20.0, 60.0, 20.0, 110.0, 150.0, 40.0, 280.0, 230.0, 30.0, 70.0, 90.0, 40.0, 40.0, 10.0, 10.0, 10.0, 140.0, 30.0, 60.0, -10.0, 10.0, 100.0, 90.0, 40.0, 40.0, 150.0, 500.0, 80.0, 20.0, 50.0, 260.0, 0.0, 90.0, 20.0, 20.0, 50.0, 70.0, 320.0, 30.0, 30.0, 60.0, 0.0, 0.0, 50.0, 130.0, 0.0, 10.0, 20.0, 10.0, 30.0, 5.0, 10.0, 60.0, 120.0, 230.0, 350.0, 90.0, 65.0, -10.0, 40.0, 50.0, 320.0, 0.0, 0.0, 50.0, 30.0, 20.0, 0.0, 10.0, 80.0, 20.0, 30.0, 570.0, 30.0, 120.0, 20.0, 130.0, 60.0, 0.0, 40.0, 50.0, 410.0, -40.0, 40.0, 150.0, 20.0, 20.0, 30.0, 30.0, 130.0, 650.0, 50.0, 50.0, 80.0, 40.0, 20.0, 0.0, 20.0, 40.0, 30.0, 20.0, 50.0, -30.0, 40.0, 100.0, 260.0, 110.0, 30.0, 380.0, 60.0, 110.0, -100.0, 40.0, 80.0, 160.0, 0.0, 40.0, 0.0, 20.0, 20.0, 170.0, 0.0, 30.0, 70.0, 20.0, 210.0, 30.0, 300.0, 45.0, 40.0, 200.0, 20.0, 130.0, 310.0, 50.0, -50.0, 160.0, 140.0, 490.0, 80.0, 160.0, 230.0, 90.0, 70.0, 320.0, 180.0, 100.0, 150.0, 40.0, 130.0, 50.0, 210.0, 20.0, 220.0, 0.0, 40.0, 250.0, 70.0, 70.0, 180.0, 250.0, 70.0, 180.0, 0.0, -40.0, 40.0, 30.0, -30.0, 350.0, 550.0, 50.0, 80.0, 10.0, -20.0, 30.0, 230.0, 0.0, 30.0, 40.0, 30.0, 580.0, 250.0, 40.0, 40.0, 0.0, 100.0, 70.0, 30.0, 10.0, 390.0, 0.0, 50.0, 350.0, 80.0, 250.0, 40.0, 100.0, 130.0, 110.0, 60.0, 210.0, 70.0, 30.0, 80.0, 40.0, 190.0, 300.0, 90.0, 200.0, 10.0, 30.0, 0.0, -20.0, 390.0, 60.0, 100.0, 300.0, 320.0, 50.0, 80.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 140.0, 60.0, 10.0, 0.0, 270.0, 50.0, 90.0, 320.0, 310.0, -10.0, 300.0, 120.0, 90.0, -5.0, 680.0, 220.0, 40.0, 35.0, 80.0, 70.0, 20.0, 100.0, 50.0, 420.0, 150.0, 20.0, 120.0, 90.0, -50.0, 20.0, 40.0, 170.0, 40.0, 10.0, 10.0, 50.0, 50.0, 180.0, 30.0, -40.0, 40.0, 480.0, -60.0, -70.0, -120.0, -25.0, 520.0, 190.0, 20.0, 90.0, 10.0, 50.0, 30.0, 10.0, 50.0, 40.0, 60.0, 80.0, -10.0, 30.0, 20.0, 70.0, 160.0, 10.0, 480.0, 0.0, 20.0, 50.0, 20.0, 0.0, 190.0, 30.0, 100.0, 130.0, 30.0, 70.0, 30.0, 10.0, 110.0, 10.0, 40.0, 0.0, 70.0, 170.0, 10.0, 0.0, 50.0, 30.0, 30.0, -10.0, 20.0, 30.0, 50.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 40.0, 270.0, 700.0, 20.0, 40.0, -20.0, 10.0, 20.0, 310.0, 70.0, 0.0, 40.0, 80.0, 390.0, 90.0, 70.0, 10.0, 160.0, 60.0, 100.0, 30.0, 370.0, 10.0, 30.0, 80.0, -40.0, 20.0, -20.0, 30.0, 80.0, 150.0, 340.0, 20.0, 15.0, 110.0, 0.0, 70.0, 70.0, 105.0, 80.0, 40.0, 15.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, -20.0, 30.0, 70.0, 290.0, -80.0, 190.0, 70.0, 180.0, 10.0, 100.0, 180.0, 600.0, 120.0, 90.0, 70.0, 10.0, 420.0, 240.0, -10.0, 70.0, 30.0, 0.0, 100.0, 20.0, 100.0, 20.0, 60.0, 360.0, 130.0, 40.0, 40.0, 20.0, 80.0, 10.0, 40.0, 140.0, 290.0, 10.0, 80.0, 70.0, 30.0, -20.0, 40.0, 90.0, 0.0, 350.0, -10.0, 10.0, 150.0, 40.0, 40.0, 190.0, 60.0, 30.0, 0.0, 40.0, 250.0, 40.0, 10.0, 40.0, 230.0, 30.0, 40.0, 330.0, 420.0, 170.0, 70.0, 50.0, 90.0, -50.0, 170.0, 20.0, 20.0, 20.0, 40.0, 40.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 0.0, 70.0, 40.0, 320.0, 20.0, 60.0, 170.0, 110.0, 240.0, 460.0, 40.0, 100.0, 80.0, -20.0, -10.0, 100.0, 30.0, 30.0, 150.0, 100.0, 40.0, 260.0, 50.0, 0.0, 280.0, -30.0, 90.0, 0.0, 30.0, 20.0, 100.0, 130.0, 20.0, 20.0, 90.0, 20.0, 30.0, 380.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 350.0, 60.0, 20.0, 150.0, 0.0, 20.0, 10.0, 20.0, 50.0, 30.0, 90.0, 0.0, 0.0, 260.0, 310.0, 180.0, 130.0, 120.0, -30.0, 0.0, 20.0, 90.0, -100.0, 40.0, 250.0, -20.0, 70.0, 0.0, 110.0, 90.0, 120.0, 220.0, 670.0, -65.0, -140.0, 50.0, 240.0, 120.0, -290.0, 10.0, -110.0, 340.0, 10.0, 390.0, 320.0, 30.0, -50.0, 390.0, 70.0, 170.0, 340.0, 80.0, 80.0, 30.0, 20.0, 230.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 40.0, 50.0, -75.0, 30.0, 130.0, 360.0, 40.0, 240.0, 90.0, 170.0, -50.0, 20.0, 160.0, 10.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 0.0, 30.0, 45.0, 30.0, 40.0, 50.0, 20.0, 40.0, 20.0, 0.0, 310.0, 10.0, 40.0, 20.0, 160.0, 150.0, 40.0, 20.0, 30.0, 0.0, 50.0, 60.0, 15.0, 120.0, 160.0, 180.0, 30.0, -55.0, 0.0, 60.0, 70.0, 290.0, 30.0, 20.0, 40.0, 60.0, 80.0, 30.0, 25.0, 390.0, 0.0, 330.0, 320.0, 170.0, 70.0, 20.0, 170.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 150.0, 40.0, 0.0, 460.0, 10.0, 60.0, 10.0, 80.0, 20.0, 70.0, 380.0, 160.0, 30.0, 30.0, 60.0, 10.0, 50.0, 150.0, 220.0, 220.0, 10.0, 180.0, 150.0, 160.0, 90.0, 40.0, 130.0, 0.0, 40.0, 480.0, 170.0, 20.0, 80.0, 10.0, 70.0, 15.0, 30.0, 20.0, 110.0, 80.0, 110.0, 100.0, 0.0, 60.0, 30.0, 30.0, 40.0, 160.0, 10.0, 90.0, 0.0, 0.0, 0.0, 60.0, 20.0, 10.0, 80.0, 40.0, 20.0, 190.0, 50.0, 80.0, 20.0, 0.0, 220.0, 10.0, 20.0, 15.0, 30.0, 550.0, 100.0, 150.0, 20.0, 60.0, 60.0, 60.0, -30.0, -10.0, 190.0, 150.0, 10.0, 170.0, 40.0, 10.0, 100.0, 170.0, 50.0, 210.0, 30.0, -40.0, 170.0, 410.0, 40.0, 100.0, 30.0, 90.0, 30.0, 50.0, 10.0, 10.0, 210.0, 290.0, 50.0, 180.0, 50.0, 130.0, 110.0, 0.0, 190.0, 90.0, 0.0, 0.0, 70.0, 90.0, 10.0, 10.0, 20.0, 10.0, 5.0, 30.0, 170.0, 10.0, 70.0, 40.0, 190.0, 70.0, 190.0, 80.0, 310.0, 30.0, 40.0, -10.0, 30.0, 20.0, 220.0, 80.0, 140.0, 70.0, 40.0, 30.0, 200.0, 130.0, 40.0, 160.0, 150.0, 370.0, -150.0, -50.0, 130.0, 30.0, 50.0, 30.0, 40.0, 40.0, 10.0, 10.0, 0.0, 40.0, 40.0, 40.0, 210.0, 10.0, 0.0, 160.0, 10.0, 30.0, 40.0, 20.0, 90.0, 230.0, 30.0, 20.0, 30.0, 130.0, -30.0, 20.0, 60.0, 420.0, 150.0, 120.0, 20.0, 30.0, 30.0, 90.0, 230.0, 40.0, 0.0, 200.0, 30.0, 0.0, -10.0, 70.0, 10.0, 160.0, 20.0, 120.0, 290.0, 0.0, 0.0, 40.0, 100.0, 160.0, 110.0, 110.0, 50.0, 530.0, 0.0, 50.0, 70.0, 40.0, 10.0, 30.0, 30.0, 20.0, 40.0, 10.0, 140.0, 80.0, 70.0, 150.0, 30.0, 0.0, 190.0, -140.0, 25.0, 0.0, 30.0, 40.0, 20.0, 20.0, 20.0, 50.0, 20.0, 0.0, 70.0, 140.0, 0.0, 70.0, 250.0, 60.0, 0.0, 60.0, 460.0, 40.0, 50.0, 220.0, 40.0, 20.0, 0.0, 100.0, 170.0, 30.0, 60.0, 50.0, 80.0, 100.0, 90.0, 110.0, 330.0, 70.0, 30.0, 210.0, 90.0, 300.0, 80.0, 220.0, 20.0, 100.0, 20.0, 40.0, 50.0, 20.0, 40.0, 180.0, 170.0, 760.0, 100.0, 40.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5275927684554813, "mean_inference_ms": 1.4158078284630102, "mean_action_processing_ms": 0.4375312062829762, "mean_env_wait_ms": 1.259291001107052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011939525604248047, "StateBufferConnector_ms": 0.008989572525024414, "ViewRequirementAgentConnector_ms": 0.3559582233428955}, "num_episodes": 18, "episode_return_max": 1790.0, "episode_return_min": 235.0, "episode_return_mean": 877.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.649540973700585, "num_env_steps_trained_throughput_per_sec": 21.649540973700585, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 186148.989, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186148.944, "sample_time_ms": 2453.46, "learn_time_ms": 183676.737, "learn_throughput": 21.777, "synch_weights_time_ms": 10.725}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 68, "trial_id": "90816_00000", "date": "2024-06-10_03-45-41", "timestamp": 1718005541, "time_this_iter_s": 184.77174592018127, "time_total_s": 12819.834987163544, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00480d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12819.834987163544, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.369348659003833, "ram_util_percent": 78.87816091954022}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.081346627596976, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.40125051326772, "policy_loss": -0.00841593035453131, "vf_loss": 6.408332458217812, "vf_explained_var": -0.0002771295932408212, "kl": 0.006669921115671229, "entropy": 0.4756574728301031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 643215.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 150.0, "episode_reward_mean": 868.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 86.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [960.0, 530.0, 965.0, 1700.0, 1340.0, 1170.0, 1210.0, 1180.0, 730.0, 1400.0, 970.0, 1350.0, 260.0, 960.0, 1780.0, 1120.0, 520.0, 945.0, 440.0, 830.0, 610.0, 490.0, 260.0, 1430.0, 970.0, 610.0, 960.0, 235.0, 840.0, 1790.0, 860.0, 780.0, 680.0, 700.0, 1380.0, 440.0, 820.0, 1050.0, 940.0, 840.0, 700.0, 480.0, 760.0, 1445.0, 620.0, 1460.0, 480.0, 955.0, 380.0, 565.0, 570.0, 870.0, 1005.0, 860.0, 830.0, 1160.0, 1020.0, 1005.0, 620.0, 320.0, 635.0, 1150.0, 940.0, 890.0, 1220.0, 305.0, 1160.0, 660.0, 1010.0, 290.0, 610.0, 1060.0, 790.0, 660.0, 1220.0, 470.0, 345.0, 640.0, 950.0, 1120.0, 1140.0, 1420.0, 870.0, 1325.0, 700.0, 1100.0, 1015.0, 450.0, 420.0, 1080.0, 890.0, 1120.0, 1155.0, 780.0, 820.0, 870.0, 150.0, 400.0, 960.0, 915.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-30.0, 40.0, 100.0, 260.0, 110.0, 30.0, 380.0, 60.0, 110.0, -100.0, 40.0, 80.0, 160.0, 0.0, 40.0, 0.0, 20.0, 20.0, 170.0, 0.0, 30.0, 70.0, 20.0, 210.0, 30.0, 300.0, 45.0, 40.0, 200.0, 20.0, 130.0, 310.0, 50.0, -50.0, 160.0, 140.0, 490.0, 80.0, 160.0, 230.0, 90.0, 70.0, 320.0, 180.0, 100.0, 150.0, 40.0, 130.0, 50.0, 210.0, 20.0, 220.0, 0.0, 40.0, 250.0, 70.0, 70.0, 180.0, 250.0, 70.0, 180.0, 0.0, -40.0, 40.0, 30.0, -30.0, 350.0, 550.0, 50.0, 80.0, 10.0, -20.0, 30.0, 230.0, 0.0, 30.0, 40.0, 30.0, 580.0, 250.0, 40.0, 40.0, 0.0, 100.0, 70.0, 30.0, 10.0, 390.0, 0.0, 50.0, 350.0, 80.0, 250.0, 40.0, 100.0, 130.0, 110.0, 60.0, 210.0, 70.0, 30.0, 80.0, 40.0, 190.0, 300.0, 90.0, 200.0, 10.0, 30.0, 0.0, -20.0, 390.0, 60.0, 100.0, 300.0, 320.0, 50.0, 80.0, 40.0, 30.0, 60.0, 0.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 140.0, 60.0, 10.0, 0.0, 270.0, 50.0, 90.0, 320.0, 310.0, -10.0, 300.0, 120.0, 90.0, -5.0, 680.0, 220.0, 40.0, 35.0, 80.0, 70.0, 20.0, 100.0, 50.0, 420.0, 150.0, 20.0, 120.0, 90.0, -50.0, 20.0, 40.0, 170.0, 40.0, 10.0, 10.0, 50.0, 50.0, 180.0, 30.0, -40.0, 40.0, 480.0, -60.0, -70.0, -120.0, -25.0, 520.0, 190.0, 20.0, 90.0, 10.0, 50.0, 30.0, 10.0, 50.0, 40.0, 60.0, 80.0, -10.0, 30.0, 20.0, 70.0, 160.0, 10.0, 480.0, 0.0, 20.0, 50.0, 20.0, 0.0, 190.0, 30.0, 100.0, 130.0, 30.0, 70.0, 30.0, 10.0, 110.0, 10.0, 40.0, 0.0, 70.0, 170.0, 10.0, 0.0, 50.0, 30.0, 30.0, -10.0, 20.0, 30.0, 50.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 40.0, 270.0, 700.0, 20.0, 40.0, -20.0, 10.0, 20.0, 310.0, 70.0, 0.0, 40.0, 80.0, 390.0, 90.0, 70.0, 10.0, 160.0, 60.0, 100.0, 30.0, 370.0, 10.0, 30.0, 80.0, -40.0, 20.0, -20.0, 30.0, 80.0, 150.0, 340.0, 20.0, 15.0, 110.0, 0.0, 70.0, 70.0, 105.0, 80.0, 40.0, 15.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, -20.0, 30.0, 70.0, 290.0, -80.0, 190.0, 70.0, 180.0, 10.0, 100.0, 180.0, 600.0, 120.0, 90.0, 70.0, 10.0, 420.0, 240.0, -10.0, 70.0, 30.0, 0.0, 100.0, 20.0, 100.0, 20.0, 60.0, 360.0, 130.0, 40.0, 40.0, 20.0, 80.0, 10.0, 40.0, 140.0, 290.0, 10.0, 80.0, 70.0, 30.0, -20.0, 40.0, 90.0, 0.0, 350.0, -10.0, 10.0, 150.0, 40.0, 40.0, 190.0, 60.0, 30.0, 0.0, 40.0, 250.0, 40.0, 10.0, 40.0, 230.0, 30.0, 40.0, 330.0, 420.0, 170.0, 70.0, 50.0, 90.0, -50.0, 170.0, 20.0, 20.0, 20.0, 40.0, 40.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 0.0, 70.0, 40.0, 320.0, 20.0, 60.0, 170.0, 110.0, 240.0, 460.0, 40.0, 100.0, 80.0, -20.0, -10.0, 100.0, 30.0, 30.0, 150.0, 100.0, 40.0, 260.0, 50.0, 0.0, 280.0, -30.0, 90.0, 0.0, 30.0, 20.0, 100.0, 130.0, 20.0, 20.0, 90.0, 20.0, 30.0, 380.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 350.0, 60.0, 20.0, 150.0, 0.0, 20.0, 10.0, 20.0, 50.0, 30.0, 90.0, 0.0, 0.0, 260.0, 310.0, 180.0, 130.0, 120.0, -30.0, 0.0, 20.0, 90.0, -100.0, 40.0, 250.0, -20.0, 70.0, 0.0, 110.0, 90.0, 120.0, 220.0, 670.0, -65.0, -140.0, 50.0, 240.0, 120.0, -290.0, 10.0, -110.0, 340.0, 10.0, 390.0, 320.0, 30.0, -50.0, 390.0, 70.0, 170.0, 340.0, 80.0, 80.0, 30.0, 20.0, 230.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 40.0, 50.0, -75.0, 30.0, 130.0, 360.0, 40.0, 240.0, 90.0, 170.0, -50.0, 20.0, 160.0, 10.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 0.0, 30.0, 45.0, 30.0, 40.0, 50.0, 20.0, 40.0, 20.0, 0.0, 310.0, 10.0, 40.0, 20.0, 160.0, 150.0, 40.0, 20.0, 30.0, 0.0, 50.0, 60.0, 15.0, 120.0, 160.0, 180.0, 30.0, -55.0, 0.0, 60.0, 70.0, 290.0, 30.0, 20.0, 40.0, 60.0, 80.0, 30.0, 25.0, 390.0, 0.0, 330.0, 320.0, 170.0, 70.0, 20.0, 170.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 150.0, 40.0, 0.0, 460.0, 10.0, 60.0, 10.0, 80.0, 20.0, 70.0, 380.0, 160.0, 30.0, 30.0, 60.0, 10.0, 50.0, 150.0, 220.0, 220.0, 10.0, 180.0, 150.0, 160.0, 90.0, 40.0, 130.0, 0.0, 40.0, 480.0, 170.0, 20.0, 80.0, 10.0, 70.0, 15.0, 30.0, 20.0, 110.0, 80.0, 110.0, 100.0, 0.0, 60.0, 30.0, 30.0, 40.0, 160.0, 10.0, 90.0, 0.0, 0.0, 0.0, 60.0, 20.0, 10.0, 80.0, 40.0, 20.0, 190.0, 50.0, 80.0, 20.0, 0.0, 220.0, 10.0, 20.0, 15.0, 30.0, 550.0, 100.0, 150.0, 20.0, 60.0, 60.0, 60.0, -30.0, -10.0, 190.0, 150.0, 10.0, 170.0, 40.0, 10.0, 100.0, 170.0, 50.0, 210.0, 30.0, -40.0, 170.0, 410.0, 40.0, 100.0, 30.0, 90.0, 30.0, 50.0, 10.0, 10.0, 210.0, 290.0, 50.0, 180.0, 50.0, 130.0, 110.0, 0.0, 190.0, 90.0, 0.0, 0.0, 70.0, 90.0, 10.0, 10.0, 20.0, 10.0, 5.0, 30.0, 170.0, 10.0, 70.0, 40.0, 190.0, 70.0, 190.0, 80.0, 310.0, 30.0, 40.0, -10.0, 30.0, 20.0, 220.0, 80.0, 140.0, 70.0, 40.0, 30.0, 200.0, 130.0, 40.0, 160.0, 150.0, 370.0, -150.0, -50.0, 130.0, 30.0, 50.0, 30.0, 40.0, 40.0, 10.0, 10.0, 0.0, 40.0, 40.0, 40.0, 210.0, 10.0, 0.0, 160.0, 10.0, 30.0, 40.0, 20.0, 90.0, 230.0, 30.0, 20.0, 30.0, 130.0, -30.0, 20.0, 60.0, 420.0, 150.0, 120.0, 20.0, 30.0, 30.0, 90.0, 230.0, 40.0, 0.0, 200.0, 30.0, 0.0, -10.0, 70.0, 10.0, 160.0, 20.0, 120.0, 290.0, 0.0, 0.0, 40.0, 100.0, 160.0, 110.0, 110.0, 50.0, 530.0, 0.0, 50.0, 70.0, 40.0, 10.0, 30.0, 30.0, 20.0, 40.0, 10.0, 140.0, 80.0, 70.0, 150.0, 30.0, 0.0, 190.0, -140.0, 25.0, 0.0, 30.0, 40.0, 20.0, 20.0, 20.0, 50.0, 20.0, 0.0, 70.0, 140.0, 0.0, 70.0, 250.0, 60.0, 0.0, 60.0, 460.0, 40.0, 50.0, 220.0, 40.0, 20.0, 0.0, 100.0, 170.0, 30.0, 60.0, 50.0, 80.0, 100.0, 90.0, 110.0, 330.0, 70.0, 30.0, 210.0, 90.0, 300.0, 80.0, 220.0, 20.0, 100.0, 20.0, 40.0, 50.0, 20.0, 40.0, 180.0, 170.0, 760.0, 100.0, 40.0, 20.0, 0.0, 10.0, 260.0, 140.0, 10.0, 40.0, 70.0, 250.0, 50.0, 40.0, 130.0, 220.0, -30.0, 30.0, 120.0, 160.0, 120.0, 60.0, 510.0, 5.0, 50.0, 20.0, 60.0, 160.0, 150.0, 160.0, 0.0, 60.0, 40.0, 0.0, 40.0, 90.0, 390.0, 80.0, 80.0, 130.0, 60.0, 60.0, 130.0, 40.0, 10.0, 20.0, 280.0, 20.0, 100.0, 15.0, 150.0, 40.0, 70.0, 310.0, 20.0, 0.0, 180.0, 20.0, 30.0, 20.0, 90.0, 40.0, 30.0, 20.0, 0.0, 10.0, 10.0, -10.0, 30.0, 0.0, 110.0, 30.0, 20.0, 220.0, 30.0, 160.0, 160.0, 10.0, -50.0, 160.0, 160.0, 300.0, 20.0, 130.0, 310.0, 150.0, 80.0, 90.0, 0.0, 10.0, 180.0, 30.0, 30.0, 10.0, 70.0, 60.0, 40.0, 70.0, 70.0, 320.0, 30.0, 270.0, 160.0, 30.0, 0.0, 220.0, 50.0, 140.0, 100.0, 45.0, 90.0, 60.0, 230.0, 220.0, 120.0, -20.0, 20.0, 120.0, 30.0, 130.0, 100.0, -30.0, 360.0, -50.0, -10.0, 360.0, 60.0, 40.0, 60.0, -70.0, 160.0, 90.0, 50.0, 80.0, 20.0, 40.0, 50.0, 130.0, 30.0, 100.0, 250.0, 170.0, 80.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 30.0, 40.0, 260.0, 0.0, 20.0, 230.0, 180.0, 200.0, 160.0, 130.0, 80.0, 40.0, -80.0, 80.0, -60.0, 5.0, 10.0, 400.0, 190.0, 60.0, 10.0, 50.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.526577859283969, "mean_inference_ms": 1.415339009638561, "mean_action_processing_ms": 0.4367362486598054, "mean_env_wait_ms": 1.258578334474782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011977195739746094, "StateBufferConnector_ms": 0.009764909744262695, "ViewRequirementAgentConnector_ms": 0.3591728210449219}, "num_episodes": 18, "episode_return_max": 1790.0, "episode_return_min": 150.0, "episode_return_mean": 868.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.49884752117116, "num_env_steps_trained_throughput_per_sec": 21.49884752117116, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 2760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2760000, "timers": {"training_iteration_time_ms": 186080.586, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186080.54, "sample_time_ms": 2458.796, "learn_time_ms": 183603.124, "learn_throughput": 21.786, "synch_weights_time_ms": 10.552}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "done": false, "training_iteration": 69, "trial_id": "90816_00000", "date": "2024-06-10_03-48-48", "timestamp": 1718005728, "time_this_iter_s": 186.06638598442078, "time_total_s": 13005.901373147964, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f56af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13005.901373147964, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 18.131178707224336, "ram_util_percent": 79.40532319391635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2688589475596674, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.052213682534215, "policy_loss": -0.009119299112365871, "vf_loss": 7.059980358026279, "vf_explained_var": 0.0005539850114633481, "kl": 0.006763063738871325, "entropy": 0.4433397186449922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 652605.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 1790.0, "episode_reward_min": 150.0, "episode_reward_mean": 842.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 84.245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [440.0, 830.0, 610.0, 490.0, 260.0, 1430.0, 970.0, 610.0, 960.0, 235.0, 840.0, 1790.0, 860.0, 780.0, 680.0, 700.0, 1380.0, 440.0, 820.0, 1050.0, 940.0, 840.0, 700.0, 480.0, 760.0, 1445.0, 620.0, 1460.0, 480.0, 955.0, 380.0, 565.0, 570.0, 870.0, 1005.0, 860.0, 830.0, 1160.0, 1020.0, 1005.0, 620.0, 320.0, 635.0, 1150.0, 940.0, 890.0, 1220.0, 305.0, 1160.0, 660.0, 1010.0, 290.0, 610.0, 1060.0, 790.0, 660.0, 1220.0, 470.0, 345.0, 640.0, 950.0, 1120.0, 1140.0, 1420.0, 870.0, 1325.0, 700.0, 1100.0, 1015.0, 450.0, 420.0, 1080.0, 890.0, 1120.0, 1155.0, 780.0, 820.0, 870.0, 150.0, 400.0, 960.0, 915.0, 600.0, 575.0, 900.0, 365.0, 730.0, 900.0, 590.0, 1380.0, 1650.0, 580.0, 1100.0, 1190.0, 1170.0, 905.0, 960.0, 1535.0, 900.0, 450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 90.0, 10.0, 50.0, 30.0, 10.0, 50.0, 40.0, 60.0, 80.0, -10.0, 30.0, 20.0, 70.0, 160.0, 10.0, 480.0, 0.0, 20.0, 50.0, 20.0, 0.0, 190.0, 30.0, 100.0, 130.0, 30.0, 70.0, 30.0, 10.0, 110.0, 10.0, 40.0, 0.0, 70.0, 170.0, 10.0, 0.0, 50.0, 30.0, 30.0, -10.0, 20.0, 30.0, 50.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 40.0, 270.0, 700.0, 20.0, 40.0, -20.0, 10.0, 20.0, 310.0, 70.0, 0.0, 40.0, 80.0, 390.0, 90.0, 70.0, 10.0, 160.0, 60.0, 100.0, 30.0, 370.0, 10.0, 30.0, 80.0, -40.0, 20.0, -20.0, 30.0, 80.0, 150.0, 340.0, 20.0, 15.0, 110.0, 0.0, 70.0, 70.0, 105.0, 80.0, 40.0, 15.0, 30.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, -20.0, 30.0, 70.0, 290.0, -80.0, 190.0, 70.0, 180.0, 10.0, 100.0, 180.0, 600.0, 120.0, 90.0, 70.0, 10.0, 420.0, 240.0, -10.0, 70.0, 30.0, 0.0, 100.0, 20.0, 100.0, 20.0, 60.0, 360.0, 130.0, 40.0, 40.0, 20.0, 80.0, 10.0, 40.0, 140.0, 290.0, 10.0, 80.0, 70.0, 30.0, -20.0, 40.0, 90.0, 0.0, 350.0, -10.0, 10.0, 150.0, 40.0, 40.0, 190.0, 60.0, 30.0, 0.0, 40.0, 250.0, 40.0, 10.0, 40.0, 230.0, 30.0, 40.0, 330.0, 420.0, 170.0, 70.0, 50.0, 90.0, -50.0, 170.0, 20.0, 20.0, 20.0, 40.0, 40.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 0.0, 70.0, 40.0, 320.0, 20.0, 60.0, 170.0, 110.0, 240.0, 460.0, 40.0, 100.0, 80.0, -20.0, -10.0, 100.0, 30.0, 30.0, 150.0, 100.0, 40.0, 260.0, 50.0, 0.0, 280.0, -30.0, 90.0, 0.0, 30.0, 20.0, 100.0, 130.0, 20.0, 20.0, 90.0, 20.0, 30.0, 380.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 350.0, 60.0, 20.0, 150.0, 0.0, 20.0, 10.0, 20.0, 50.0, 30.0, 90.0, 0.0, 0.0, 260.0, 310.0, 180.0, 130.0, 120.0, -30.0, 0.0, 20.0, 90.0, -100.0, 40.0, 250.0, -20.0, 70.0, 0.0, 110.0, 90.0, 120.0, 220.0, 670.0, -65.0, -140.0, 50.0, 240.0, 120.0, -290.0, 10.0, -110.0, 340.0, 10.0, 390.0, 320.0, 30.0, -50.0, 390.0, 70.0, 170.0, 340.0, 80.0, 80.0, 30.0, 20.0, 230.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 40.0, 50.0, -75.0, 30.0, 130.0, 360.0, 40.0, 240.0, 90.0, 170.0, -50.0, 20.0, 160.0, 10.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 0.0, 30.0, 45.0, 30.0, 40.0, 50.0, 20.0, 40.0, 20.0, 0.0, 310.0, 10.0, 40.0, 20.0, 160.0, 150.0, 40.0, 20.0, 30.0, 0.0, 50.0, 60.0, 15.0, 120.0, 160.0, 180.0, 30.0, -55.0, 0.0, 60.0, 70.0, 290.0, 30.0, 20.0, 40.0, 60.0, 80.0, 30.0, 25.0, 390.0, 0.0, 330.0, 320.0, 170.0, 70.0, 20.0, 170.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 150.0, 40.0, 0.0, 460.0, 10.0, 60.0, 10.0, 80.0, 20.0, 70.0, 380.0, 160.0, 30.0, 30.0, 60.0, 10.0, 50.0, 150.0, 220.0, 220.0, 10.0, 180.0, 150.0, 160.0, 90.0, 40.0, 130.0, 0.0, 40.0, 480.0, 170.0, 20.0, 80.0, 10.0, 70.0, 15.0, 30.0, 20.0, 110.0, 80.0, 110.0, 100.0, 0.0, 60.0, 30.0, 30.0, 40.0, 160.0, 10.0, 90.0, 0.0, 0.0, 0.0, 60.0, 20.0, 10.0, 80.0, 40.0, 20.0, 190.0, 50.0, 80.0, 20.0, 0.0, 220.0, 10.0, 20.0, 15.0, 30.0, 550.0, 100.0, 150.0, 20.0, 60.0, 60.0, 60.0, -30.0, -10.0, 190.0, 150.0, 10.0, 170.0, 40.0, 10.0, 100.0, 170.0, 50.0, 210.0, 30.0, -40.0, 170.0, 410.0, 40.0, 100.0, 30.0, 90.0, 30.0, 50.0, 10.0, 10.0, 210.0, 290.0, 50.0, 180.0, 50.0, 130.0, 110.0, 0.0, 190.0, 90.0, 0.0, 0.0, 70.0, 90.0, 10.0, 10.0, 20.0, 10.0, 5.0, 30.0, 170.0, 10.0, 70.0, 40.0, 190.0, 70.0, 190.0, 80.0, 310.0, 30.0, 40.0, -10.0, 30.0, 20.0, 220.0, 80.0, 140.0, 70.0, 40.0, 30.0, 200.0, 130.0, 40.0, 160.0, 150.0, 370.0, -150.0, -50.0, 130.0, 30.0, 50.0, 30.0, 40.0, 40.0, 10.0, 10.0, 0.0, 40.0, 40.0, 40.0, 210.0, 10.0, 0.0, 160.0, 10.0, 30.0, 40.0, 20.0, 90.0, 230.0, 30.0, 20.0, 30.0, 130.0, -30.0, 20.0, 60.0, 420.0, 150.0, 120.0, 20.0, 30.0, 30.0, 90.0, 230.0, 40.0, 0.0, 200.0, 30.0, 0.0, -10.0, 70.0, 10.0, 160.0, 20.0, 120.0, 290.0, 0.0, 0.0, 40.0, 100.0, 160.0, 110.0, 110.0, 50.0, 530.0, 0.0, 50.0, 70.0, 40.0, 10.0, 30.0, 30.0, 20.0, 40.0, 10.0, 140.0, 80.0, 70.0, 150.0, 30.0, 0.0, 190.0, -140.0, 25.0, 0.0, 30.0, 40.0, 20.0, 20.0, 20.0, 50.0, 20.0, 0.0, 70.0, 140.0, 0.0, 70.0, 250.0, 60.0, 0.0, 60.0, 460.0, 40.0, 50.0, 220.0, 40.0, 20.0, 0.0, 100.0, 170.0, 30.0, 60.0, 50.0, 80.0, 100.0, 90.0, 110.0, 330.0, 70.0, 30.0, 210.0, 90.0, 300.0, 80.0, 220.0, 20.0, 100.0, 20.0, 40.0, 50.0, 20.0, 40.0, 180.0, 170.0, 760.0, 100.0, 40.0, 20.0, 0.0, 10.0, 260.0, 140.0, 10.0, 40.0, 70.0, 250.0, 50.0, 40.0, 130.0, 220.0, -30.0, 30.0, 120.0, 160.0, 120.0, 60.0, 510.0, 5.0, 50.0, 20.0, 60.0, 160.0, 150.0, 160.0, 0.0, 60.0, 40.0, 0.0, 40.0, 90.0, 390.0, 80.0, 80.0, 130.0, 60.0, 60.0, 130.0, 40.0, 10.0, 20.0, 280.0, 20.0, 100.0, 15.0, 150.0, 40.0, 70.0, 310.0, 20.0, 0.0, 180.0, 20.0, 30.0, 20.0, 90.0, 40.0, 30.0, 20.0, 0.0, 10.0, 10.0, -10.0, 30.0, 0.0, 110.0, 30.0, 20.0, 220.0, 30.0, 160.0, 160.0, 10.0, -50.0, 160.0, 160.0, 300.0, 20.0, 130.0, 310.0, 150.0, 80.0, 90.0, 0.0, 10.0, 180.0, 30.0, 30.0, 10.0, 70.0, 60.0, 40.0, 70.0, 70.0, 320.0, 30.0, 270.0, 160.0, 30.0, 0.0, 220.0, 50.0, 140.0, 100.0, 45.0, 90.0, 60.0, 230.0, 220.0, 120.0, -20.0, 20.0, 120.0, 30.0, 130.0, 100.0, -30.0, 360.0, -50.0, -10.0, 360.0, 60.0, 40.0, 60.0, -70.0, 160.0, 90.0, 50.0, 80.0, 20.0, 40.0, 50.0, 130.0, 30.0, 100.0, 250.0, 170.0, 80.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 30.0, 40.0, 260.0, 0.0, 20.0, 230.0, 180.0, 200.0, 160.0, 130.0, 80.0, 40.0, -80.0, 80.0, -60.0, 5.0, 10.0, 400.0, 190.0, 60.0, 10.0, 50.0, 170.0, 0.0, 10.0, 40.0, 10.0, 150.0, 40.0, 30.0, 130.0, 170.0, 20.0, 390.0, 20.0, 30.0, 20.0, 10.0, -90.0, 90.0, 40.0, 0.0, 65.0, 30.0, 130.0, 100.0, 10.0, -40.0, 30.0, 370.0, 40.0, 130.0, 100.0, 10.0, 25.0, 180.0, 50.0, -50.0, 50.0, 30.0, 20.0, 20.0, 30.0, 230.0, 30.0, 40.0, 30.0, 50.0, 10.0, 120.0, 40.0, 150.0, 30.0, 30.0, 70.0, 190.0, 70.0, 70.0, -30.0, 320.0, 120.0, 30.0, 30.0, 40.0, 200.0, 10.0, 30.0, 180.0, 60.0, 30.0, 0.0, 30.0, 10.0, 10.0, 250.0, 60.0, 100.0, 130.0, 210.0, 190.0, 120.0, 160.0, 150.0, 110.0, 40.0, 90.0, 260.0, 50.0, 370.0, 50.0, 360.0, 100.0, 220.0, 40.0, 0.0, 30.0, 40.0, 20.0, 200.0, 100.0, 80.0, 60.0, 10.0, 440.0, 50.0, -130.0, 200.0, 40.0, 30.0, 90.0, 90.0, 20.0, 270.0, 40.0, 90.0, 170.0, 40.0, 160.0, 160.0, 480.0, 20.0, 30.0, 0.0, 0.0, 40.0, 180.0, 170.0, -30.0, -20.0, 50.0, 300.0, 380.0, 100.0, 100.0, 90.0, 90.0, 10.0, 180.0, 40.0, -125.0, 420.0, 110.0, -10.0, 20.0, 80.0, 400.0, 90.0, 40.0, 20.0, 30.0, 30.0, 190.0, 60.0, 40.0, 330.0, 190.0, 260.0, 85.0, 100.0, 10.0, 10.0, 270.0, 240.0, 180.0, 90.0, 30.0, 10.0, 100.0, 60.0, 130.0, 80.0, 60.0, 160.0, 0.0, 30.0, 120.0, 30.0, 20.0, 30.0, 50.0, 110.0, 40.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5255246284703563, "mean_inference_ms": 1.4149065324868428, "mean_action_processing_ms": 0.4359688505494128, "mean_env_wait_ms": 1.257851650527493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011951446533203125, "StateBufferConnector_ms": 0.00977635383605957, "ViewRequirementAgentConnector_ms": 0.35957789421081543}, "num_episodes": 18, "episode_return_max": 1790.0, "episode_return_min": 150.0, "episode_return_mean": 842.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.624003046340327, "num_env_steps_trained_throughput_per_sec": 21.624003046340327, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 185950.712, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185950.667, "sample_time_ms": 2436.495, "learn_time_ms": 183495.768, "learn_throughput": 21.799, "synch_weights_time_ms": 10.368}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 70, "trial_id": "90816_00000", "date": "2024-06-10_03-51-53", "timestamp": 1718005913, "time_this_iter_s": 184.9901099205017, "time_total_s": 13190.891483068466, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0048f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13190.891483068466, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.684674329501913, "ram_util_percent": 79.34827586206897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2890853200984584, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.784115744348024, "policy_loss": -0.00911706610745428, "vf_loss": 6.7918494925839195, "vf_explained_var": 0.0005655109374540936, "kl": 0.00691660088747885, "entropy": 0.4599654747528263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 661995.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "env_runners": {"episode_reward_max": 1740.0, "episode_reward_min": 150.0, "episode_reward_mean": 896.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 89.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 480.0, 760.0, 1445.0, 620.0, 1460.0, 480.0, 955.0, 380.0, 565.0, 570.0, 870.0, 1005.0, 860.0, 830.0, 1160.0, 1020.0, 1005.0, 620.0, 320.0, 635.0, 1150.0, 940.0, 890.0, 1220.0, 305.0, 1160.0, 660.0, 1010.0, 290.0, 610.0, 1060.0, 790.0, 660.0, 1220.0, 470.0, 345.0, 640.0, 950.0, 1120.0, 1140.0, 1420.0, 870.0, 1325.0, 700.0, 1100.0, 1015.0, 450.0, 420.0, 1080.0, 890.0, 1120.0, 1155.0, 780.0, 820.0, 870.0, 150.0, 400.0, 960.0, 915.0, 600.0, 575.0, 900.0, 365.0, 730.0, 900.0, 590.0, 1380.0, 1650.0, 580.0, 1100.0, 1190.0, 1170.0, 905.0, 960.0, 1535.0, 900.0, 450.0, 1740.0, 930.0, 1570.0, 810.0, 1440.0, 1110.0, 600.0, 1340.0, 630.0, 1620.0, 410.0, 1450.0, 1145.0, 600.0, 1300.0, 1070.0, 1350.0, 500.0, 850.0, 955.0, 810.0, 1150.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 350.0, 60.0, 20.0, 150.0, 0.0, 20.0, 10.0, 20.0, 50.0, 30.0, 90.0, 0.0, 0.0, 260.0, 310.0, 180.0, 130.0, 120.0, -30.0, 0.0, 20.0, 90.0, -100.0, 40.0, 250.0, -20.0, 70.0, 0.0, 110.0, 90.0, 120.0, 220.0, 670.0, -65.0, -140.0, 50.0, 240.0, 120.0, -290.0, 10.0, -110.0, 340.0, 10.0, 390.0, 320.0, 30.0, -50.0, 390.0, 70.0, 170.0, 340.0, 80.0, 80.0, 30.0, 20.0, 230.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 40.0, 50.0, -75.0, 30.0, 130.0, 360.0, 40.0, 240.0, 90.0, 170.0, -50.0, 20.0, 160.0, 10.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 0.0, 30.0, 45.0, 30.0, 40.0, 50.0, 20.0, 40.0, 20.0, 0.0, 310.0, 10.0, 40.0, 20.0, 160.0, 150.0, 40.0, 20.0, 30.0, 0.0, 50.0, 60.0, 15.0, 120.0, 160.0, 180.0, 30.0, -55.0, 0.0, 60.0, 70.0, 290.0, 30.0, 20.0, 40.0, 60.0, 80.0, 30.0, 25.0, 390.0, 0.0, 330.0, 320.0, 170.0, 70.0, 20.0, 170.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 150.0, 40.0, 0.0, 460.0, 10.0, 60.0, 10.0, 80.0, 20.0, 70.0, 380.0, 160.0, 30.0, 30.0, 60.0, 10.0, 50.0, 150.0, 220.0, 220.0, 10.0, 180.0, 150.0, 160.0, 90.0, 40.0, 130.0, 0.0, 40.0, 480.0, 170.0, 20.0, 80.0, 10.0, 70.0, 15.0, 30.0, 20.0, 110.0, 80.0, 110.0, 100.0, 0.0, 60.0, 30.0, 30.0, 40.0, 160.0, 10.0, 90.0, 0.0, 0.0, 0.0, 60.0, 20.0, 10.0, 80.0, 40.0, 20.0, 190.0, 50.0, 80.0, 20.0, 0.0, 220.0, 10.0, 20.0, 15.0, 30.0, 550.0, 100.0, 150.0, 20.0, 60.0, 60.0, 60.0, -30.0, -10.0, 190.0, 150.0, 10.0, 170.0, 40.0, 10.0, 100.0, 170.0, 50.0, 210.0, 30.0, -40.0, 170.0, 410.0, 40.0, 100.0, 30.0, 90.0, 30.0, 50.0, 10.0, 10.0, 210.0, 290.0, 50.0, 180.0, 50.0, 130.0, 110.0, 0.0, 190.0, 90.0, 0.0, 0.0, 70.0, 90.0, 10.0, 10.0, 20.0, 10.0, 5.0, 30.0, 170.0, 10.0, 70.0, 40.0, 190.0, 70.0, 190.0, 80.0, 310.0, 30.0, 40.0, -10.0, 30.0, 20.0, 220.0, 80.0, 140.0, 70.0, 40.0, 30.0, 200.0, 130.0, 40.0, 160.0, 150.0, 370.0, -150.0, -50.0, 130.0, 30.0, 50.0, 30.0, 40.0, 40.0, 10.0, 10.0, 0.0, 40.0, 40.0, 40.0, 210.0, 10.0, 0.0, 160.0, 10.0, 30.0, 40.0, 20.0, 90.0, 230.0, 30.0, 20.0, 30.0, 130.0, -30.0, 20.0, 60.0, 420.0, 150.0, 120.0, 20.0, 30.0, 30.0, 90.0, 230.0, 40.0, 0.0, 200.0, 30.0, 0.0, -10.0, 70.0, 10.0, 160.0, 20.0, 120.0, 290.0, 0.0, 0.0, 40.0, 100.0, 160.0, 110.0, 110.0, 50.0, 530.0, 0.0, 50.0, 70.0, 40.0, 10.0, 30.0, 30.0, 20.0, 40.0, 10.0, 140.0, 80.0, 70.0, 150.0, 30.0, 0.0, 190.0, -140.0, 25.0, 0.0, 30.0, 40.0, 20.0, 20.0, 20.0, 50.0, 20.0, 0.0, 70.0, 140.0, 0.0, 70.0, 250.0, 60.0, 0.0, 60.0, 460.0, 40.0, 50.0, 220.0, 40.0, 20.0, 0.0, 100.0, 170.0, 30.0, 60.0, 50.0, 80.0, 100.0, 90.0, 110.0, 330.0, 70.0, 30.0, 210.0, 90.0, 300.0, 80.0, 220.0, 20.0, 100.0, 20.0, 40.0, 50.0, 20.0, 40.0, 180.0, 170.0, 760.0, 100.0, 40.0, 20.0, 0.0, 10.0, 260.0, 140.0, 10.0, 40.0, 70.0, 250.0, 50.0, 40.0, 130.0, 220.0, -30.0, 30.0, 120.0, 160.0, 120.0, 60.0, 510.0, 5.0, 50.0, 20.0, 60.0, 160.0, 150.0, 160.0, 0.0, 60.0, 40.0, 0.0, 40.0, 90.0, 390.0, 80.0, 80.0, 130.0, 60.0, 60.0, 130.0, 40.0, 10.0, 20.0, 280.0, 20.0, 100.0, 15.0, 150.0, 40.0, 70.0, 310.0, 20.0, 0.0, 180.0, 20.0, 30.0, 20.0, 90.0, 40.0, 30.0, 20.0, 0.0, 10.0, 10.0, -10.0, 30.0, 0.0, 110.0, 30.0, 20.0, 220.0, 30.0, 160.0, 160.0, 10.0, -50.0, 160.0, 160.0, 300.0, 20.0, 130.0, 310.0, 150.0, 80.0, 90.0, 0.0, 10.0, 180.0, 30.0, 30.0, 10.0, 70.0, 60.0, 40.0, 70.0, 70.0, 320.0, 30.0, 270.0, 160.0, 30.0, 0.0, 220.0, 50.0, 140.0, 100.0, 45.0, 90.0, 60.0, 230.0, 220.0, 120.0, -20.0, 20.0, 120.0, 30.0, 130.0, 100.0, -30.0, 360.0, -50.0, -10.0, 360.0, 60.0, 40.0, 60.0, -70.0, 160.0, 90.0, 50.0, 80.0, 20.0, 40.0, 50.0, 130.0, 30.0, 100.0, 250.0, 170.0, 80.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 30.0, 40.0, 260.0, 0.0, 20.0, 230.0, 180.0, 200.0, 160.0, 130.0, 80.0, 40.0, -80.0, 80.0, -60.0, 5.0, 10.0, 400.0, 190.0, 60.0, 10.0, 50.0, 170.0, 0.0, 10.0, 40.0, 10.0, 150.0, 40.0, 30.0, 130.0, 170.0, 20.0, 390.0, 20.0, 30.0, 20.0, 10.0, -90.0, 90.0, 40.0, 0.0, 65.0, 30.0, 130.0, 100.0, 10.0, -40.0, 30.0, 370.0, 40.0, 130.0, 100.0, 10.0, 25.0, 180.0, 50.0, -50.0, 50.0, 30.0, 20.0, 20.0, 30.0, 230.0, 30.0, 40.0, 30.0, 50.0, 10.0, 120.0, 40.0, 150.0, 30.0, 30.0, 70.0, 190.0, 70.0, 70.0, -30.0, 320.0, 120.0, 30.0, 30.0, 40.0, 200.0, 10.0, 30.0, 180.0, 60.0, 30.0, 0.0, 30.0, 10.0, 10.0, 250.0, 60.0, 100.0, 130.0, 210.0, 190.0, 120.0, 160.0, 150.0, 110.0, 40.0, 90.0, 260.0, 50.0, 370.0, 50.0, 360.0, 100.0, 220.0, 40.0, 0.0, 30.0, 40.0, 20.0, 200.0, 100.0, 80.0, 60.0, 10.0, 440.0, 50.0, -130.0, 200.0, 40.0, 30.0, 90.0, 90.0, 20.0, 270.0, 40.0, 90.0, 170.0, 40.0, 160.0, 160.0, 480.0, 20.0, 30.0, 0.0, 0.0, 40.0, 180.0, 170.0, -30.0, -20.0, 50.0, 300.0, 380.0, 100.0, 100.0, 90.0, 90.0, 10.0, 180.0, 40.0, -125.0, 420.0, 110.0, -10.0, 20.0, 80.0, 400.0, 90.0, 40.0, 20.0, 30.0, 30.0, 190.0, 60.0, 40.0, 330.0, 190.0, 260.0, 85.0, 100.0, 10.0, 10.0, 270.0, 240.0, 180.0, 90.0, 30.0, 10.0, 100.0, 60.0, 130.0, 80.0, 60.0, 160.0, 0.0, 30.0, 120.0, 30.0, 20.0, 30.0, 50.0, 110.0, 40.0, 20.0, 30.0, 190.0, 60.0, 100.0, 120.0, 270.0, 160.0, 20.0, 700.0, 90.0, 100.0, 10.0, 20.0, 70.0, 180.0, 0.0, 380.0, 60.0, 40.0, 70.0, 110.0, 150.0, 30.0, 320.0, 300.0, 30.0, 280.0, 40.0, 150.0, 160.0, 180.0, 330.0, -50.0, -20.0, 30.0, 70.0, 30.0, 60.0, 30.0, 150.0, 380.0, 160.0, 190.0, 60.0, 0.0, 110.0, 80.0, 310.0, 120.0, 30.0, 320.0, 70.0, 160.0, 60.0, 40.0, 70.0, 150.0, 190.0, 0.0, 50.0, 20.0, 110.0, 130.0, 0.0, 90.0, 0.0, 20.0, 60.0, 110.0, 60.0, 140.0, 260.0, 240.0, 10.0, 50.0, 260.0, 20.0, 90.0, 220.0, 50.0, 20.0, 90.0, 160.0, 120.0, 110.0, 0.0, 20.0, 30.0, 40.0, 40.0, 560.0, 40.0, 140.0, 70.0, 110.0, 350.0, 80.0, 30.0, 60.0, 180.0, 110.0, 0.0, 20.0, 170.0, 20.0, 0.0, 30.0, 40.0, 0.0, 20.0, 220.0, 40.0, 10.0, 410.0, 140.0, 20.0, 80.0, 310.0, 0.0, 220.0, 50.0, 170.0, 190.0, 300.0, 50.0, 60.0, 100.0, 35.0, 30.0, 160.0, 110.0, 20.0, 40.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 300.0, 250.0, 20.0, 40.0, 220.0, 40.0, 180.0, 70.0, 0.0, 490.0, -10.0, 60.0, 20.0, 240.0, -90.0, 160.0, 260.0, 290.0, -40.0, 130.0, 40.0, 70.0, -20.0, 150.0, 170.0, 220.0, 180.0, 100.0, 120.0, 350.0, 10.0, -50.0, 50.0, 20.0, 0.0, 70.0, -20.0, 100.0, 160.0, 200.0, -30.0, 220.0, 400.0, 130.0, 40.0, 40.0, -20.0, 30.0, 0.0, 10.0, 0.0, 70.0, 200.0, 190.0, -15.0, 40.0, 30.0, 120.0, 120.0, 140.0, 60.0, 30.0, 140.0, 100.0, 60.0, 30.0, 20.0, 210.0, 100.0, 50.0, 70.0, 80.0, 0.0, 250.0, 300.0, 110.0, 190.0, 80.0, 40.0, 60.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5241330640271697, "mean_inference_ms": 1.41454498232454, "mean_action_processing_ms": 0.43505591702071245, "mean_env_wait_ms": 1.257067362764587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012672185897827148, "StateBufferConnector_ms": 0.010044097900390625, "ViewRequirementAgentConnector_ms": 0.3665916919708252}, "num_episodes": 22, "episode_return_max": 1740.0, "episode_return_min": 150.0, "episode_return_mean": 896.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.570617836936602, "num_env_steps_trained_throughput_per_sec": 21.570617836936602, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 2840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2840000, "timers": {"training_iteration_time_ms": 185608.728, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185608.684, "sample_time_ms": 2450.042, "learn_time_ms": 183140.04, "learn_throughput": 21.841, "synch_weights_time_ms": 10.614}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "done": false, "training_iteration": 71, "trial_id": "90816_00000", "date": "2024-06-10_03-54-58", "timestamp": 1718006098, "time_this_iter_s": 185.44690108299255, "time_total_s": 13376.338384151459, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0048e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13376.338384151459, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 18.67680608365019, "ram_util_percent": 78.98783269961977}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.106085559563896, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.46597091605742, "policy_loss": -0.008323135620247894, "vf_loss": 6.47300499803342, "vf_explained_var": -0.00010942428891524213, "kl": 0.006445248081901298, "entropy": 0.4578591538821293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 671385.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 1740.0, "episode_reward_min": 150.0, "episode_reward_mean": 900.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 90.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [890.0, 1220.0, 305.0, 1160.0, 660.0, 1010.0, 290.0, 610.0, 1060.0, 790.0, 660.0, 1220.0, 470.0, 345.0, 640.0, 950.0, 1120.0, 1140.0, 1420.0, 870.0, 1325.0, 700.0, 1100.0, 1015.0, 450.0, 420.0, 1080.0, 890.0, 1120.0, 1155.0, 780.0, 820.0, 870.0, 150.0, 400.0, 960.0, 915.0, 600.0, 575.0, 900.0, 365.0, 730.0, 900.0, 590.0, 1380.0, 1650.0, 580.0, 1100.0, 1190.0, 1170.0, 905.0, 960.0, 1535.0, 900.0, 450.0, 1740.0, 930.0, 1570.0, 810.0, 1440.0, 1110.0, 600.0, 1340.0, 630.0, 1620.0, 410.0, 1450.0, 1145.0, 600.0, 1300.0, 1070.0, 1350.0, 500.0, 850.0, 955.0, 810.0, 1150.0, 1300.0, 1440.0, 800.0, 1325.0, 400.0, 490.0, 800.0, 730.0, 700.0, 440.0, 1075.0, 650.0, 1030.0, 755.0, 405.0, 1610.0, 240.0, 410.0, 360.0, 890.0, 1115.0, 1195.0, 1070.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-40.0, 170.0, 410.0, 40.0, 100.0, 30.0, 90.0, 30.0, 50.0, 10.0, 10.0, 210.0, 290.0, 50.0, 180.0, 50.0, 130.0, 110.0, 0.0, 190.0, 90.0, 0.0, 0.0, 70.0, 90.0, 10.0, 10.0, 20.0, 10.0, 5.0, 30.0, 170.0, 10.0, 70.0, 40.0, 190.0, 70.0, 190.0, 80.0, 310.0, 30.0, 40.0, -10.0, 30.0, 20.0, 220.0, 80.0, 140.0, 70.0, 40.0, 30.0, 200.0, 130.0, 40.0, 160.0, 150.0, 370.0, -150.0, -50.0, 130.0, 30.0, 50.0, 30.0, 40.0, 40.0, 10.0, 10.0, 0.0, 40.0, 40.0, 40.0, 210.0, 10.0, 0.0, 160.0, 10.0, 30.0, 40.0, 20.0, 90.0, 230.0, 30.0, 20.0, 30.0, 130.0, -30.0, 20.0, 60.0, 420.0, 150.0, 120.0, 20.0, 30.0, 30.0, 90.0, 230.0, 40.0, 0.0, 200.0, 30.0, 0.0, -10.0, 70.0, 10.0, 160.0, 20.0, 120.0, 290.0, 0.0, 0.0, 40.0, 100.0, 160.0, 110.0, 110.0, 50.0, 530.0, 0.0, 50.0, 70.0, 40.0, 10.0, 30.0, 30.0, 20.0, 40.0, 10.0, 140.0, 80.0, 70.0, 150.0, 30.0, 0.0, 190.0, -140.0, 25.0, 0.0, 30.0, 40.0, 20.0, 20.0, 20.0, 50.0, 20.0, 0.0, 70.0, 140.0, 0.0, 70.0, 250.0, 60.0, 0.0, 60.0, 460.0, 40.0, 50.0, 220.0, 40.0, 20.0, 0.0, 100.0, 170.0, 30.0, 60.0, 50.0, 80.0, 100.0, 90.0, 110.0, 330.0, 70.0, 30.0, 210.0, 90.0, 300.0, 80.0, 220.0, 20.0, 100.0, 20.0, 40.0, 50.0, 20.0, 40.0, 180.0, 170.0, 760.0, 100.0, 40.0, 20.0, 0.0, 10.0, 260.0, 140.0, 10.0, 40.0, 70.0, 250.0, 50.0, 40.0, 130.0, 220.0, -30.0, 30.0, 120.0, 160.0, 120.0, 60.0, 510.0, 5.0, 50.0, 20.0, 60.0, 160.0, 150.0, 160.0, 0.0, 60.0, 40.0, 0.0, 40.0, 90.0, 390.0, 80.0, 80.0, 130.0, 60.0, 60.0, 130.0, 40.0, 10.0, 20.0, 280.0, 20.0, 100.0, 15.0, 150.0, 40.0, 70.0, 310.0, 20.0, 0.0, 180.0, 20.0, 30.0, 20.0, 90.0, 40.0, 30.0, 20.0, 0.0, 10.0, 10.0, -10.0, 30.0, 0.0, 110.0, 30.0, 20.0, 220.0, 30.0, 160.0, 160.0, 10.0, -50.0, 160.0, 160.0, 300.0, 20.0, 130.0, 310.0, 150.0, 80.0, 90.0, 0.0, 10.0, 180.0, 30.0, 30.0, 10.0, 70.0, 60.0, 40.0, 70.0, 70.0, 320.0, 30.0, 270.0, 160.0, 30.0, 0.0, 220.0, 50.0, 140.0, 100.0, 45.0, 90.0, 60.0, 230.0, 220.0, 120.0, -20.0, 20.0, 120.0, 30.0, 130.0, 100.0, -30.0, 360.0, -50.0, -10.0, 360.0, 60.0, 40.0, 60.0, -70.0, 160.0, 90.0, 50.0, 80.0, 20.0, 40.0, 50.0, 130.0, 30.0, 100.0, 250.0, 170.0, 80.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 30.0, 40.0, 260.0, 0.0, 20.0, 230.0, 180.0, 200.0, 160.0, 130.0, 80.0, 40.0, -80.0, 80.0, -60.0, 5.0, 10.0, 400.0, 190.0, 60.0, 10.0, 50.0, 170.0, 0.0, 10.0, 40.0, 10.0, 150.0, 40.0, 30.0, 130.0, 170.0, 20.0, 390.0, 20.0, 30.0, 20.0, 10.0, -90.0, 90.0, 40.0, 0.0, 65.0, 30.0, 130.0, 100.0, 10.0, -40.0, 30.0, 370.0, 40.0, 130.0, 100.0, 10.0, 25.0, 180.0, 50.0, -50.0, 50.0, 30.0, 20.0, 20.0, 30.0, 230.0, 30.0, 40.0, 30.0, 50.0, 10.0, 120.0, 40.0, 150.0, 30.0, 30.0, 70.0, 190.0, 70.0, 70.0, -30.0, 320.0, 120.0, 30.0, 30.0, 40.0, 200.0, 10.0, 30.0, 180.0, 60.0, 30.0, 0.0, 30.0, 10.0, 10.0, 250.0, 60.0, 100.0, 130.0, 210.0, 190.0, 120.0, 160.0, 150.0, 110.0, 40.0, 90.0, 260.0, 50.0, 370.0, 50.0, 360.0, 100.0, 220.0, 40.0, 0.0, 30.0, 40.0, 20.0, 200.0, 100.0, 80.0, 60.0, 10.0, 440.0, 50.0, -130.0, 200.0, 40.0, 30.0, 90.0, 90.0, 20.0, 270.0, 40.0, 90.0, 170.0, 40.0, 160.0, 160.0, 480.0, 20.0, 30.0, 0.0, 0.0, 40.0, 180.0, 170.0, -30.0, -20.0, 50.0, 300.0, 380.0, 100.0, 100.0, 90.0, 90.0, 10.0, 180.0, 40.0, -125.0, 420.0, 110.0, -10.0, 20.0, 80.0, 400.0, 90.0, 40.0, 20.0, 30.0, 30.0, 190.0, 60.0, 40.0, 330.0, 190.0, 260.0, 85.0, 100.0, 10.0, 10.0, 270.0, 240.0, 180.0, 90.0, 30.0, 10.0, 100.0, 60.0, 130.0, 80.0, 60.0, 160.0, 0.0, 30.0, 120.0, 30.0, 20.0, 30.0, 50.0, 110.0, 40.0, 20.0, 30.0, 190.0, 60.0, 100.0, 120.0, 270.0, 160.0, 20.0, 700.0, 90.0, 100.0, 10.0, 20.0, 70.0, 180.0, 0.0, 380.0, 60.0, 40.0, 70.0, 110.0, 150.0, 30.0, 320.0, 300.0, 30.0, 280.0, 40.0, 150.0, 160.0, 180.0, 330.0, -50.0, -20.0, 30.0, 70.0, 30.0, 60.0, 30.0, 150.0, 380.0, 160.0, 190.0, 60.0, 0.0, 110.0, 80.0, 310.0, 120.0, 30.0, 320.0, 70.0, 160.0, 60.0, 40.0, 70.0, 150.0, 190.0, 0.0, 50.0, 20.0, 110.0, 130.0, 0.0, 90.0, 0.0, 20.0, 60.0, 110.0, 60.0, 140.0, 260.0, 240.0, 10.0, 50.0, 260.0, 20.0, 90.0, 220.0, 50.0, 20.0, 90.0, 160.0, 120.0, 110.0, 0.0, 20.0, 30.0, 40.0, 40.0, 560.0, 40.0, 140.0, 70.0, 110.0, 350.0, 80.0, 30.0, 60.0, 180.0, 110.0, 0.0, 20.0, 170.0, 20.0, 0.0, 30.0, 40.0, 0.0, 20.0, 220.0, 40.0, 10.0, 410.0, 140.0, 20.0, 80.0, 310.0, 0.0, 220.0, 50.0, 170.0, 190.0, 300.0, 50.0, 60.0, 100.0, 35.0, 30.0, 160.0, 110.0, 20.0, 40.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 300.0, 250.0, 20.0, 40.0, 220.0, 40.0, 180.0, 70.0, 0.0, 490.0, -10.0, 60.0, 20.0, 240.0, -90.0, 160.0, 260.0, 290.0, -40.0, 130.0, 40.0, 70.0, -20.0, 150.0, 170.0, 220.0, 180.0, 100.0, 120.0, 350.0, 10.0, -50.0, 50.0, 20.0, 0.0, 70.0, -20.0, 100.0, 160.0, 200.0, -30.0, 220.0, 400.0, 130.0, 40.0, 40.0, -20.0, 30.0, 0.0, 10.0, 0.0, 70.0, 200.0, 190.0, -15.0, 40.0, 30.0, 120.0, 120.0, 140.0, 60.0, 30.0, 140.0, 100.0, 60.0, 30.0, 20.0, 210.0, 100.0, 50.0, 70.0, 80.0, 0.0, 250.0, 300.0, 110.0, 190.0, 80.0, 40.0, 60.0, 40.0, 100.0, 0.0, 30.0, 540.0, 140.0, 140.0, 40.0, 120.0, 10.0, 180.0, 60.0, 130.0, 70.0, 30.0, 390.0, 110.0, 60.0, 400.0, 70.0, 120.0, 200.0, 130.0, -390.0, 40.0, 170.0, 140.0, -10.0, 400.0, 40.0, 80.0, 5.0, 140.0, 50.0, 120.0, 240.0, 420.0, 100.0, 200.0, 40.0, 10.0, 10.0, 20.0, 20.0, 60.0, 0.0, 10.0, 30.0, 0.0, 40.0, 210.0, 0.0, 0.0, 170.0, 110.0, 40.0, 50.0, 10.0, 50.0, 20.0, 40.0, 40.0, 40.0, 150.0, 90.0, 20.0, 20.0, 10.0, 50.0, 110.0, 270.0, 20.0, 100.0, 230.0, 30.0, 0.0, 60.0, 180.0, 40.0, 50.0, 20.0, 30.0, 100.0, 30.0, 50.0, 260.0, 70.0, 10.0, 60.0, 10.0, 80.0, 50.0, 0.0, 70.0, 160.0, 10.0, 40.0, 30.0, 10.0, 40.0, 30.0, 70.0, 80.0, 225.0, 20.0, 110.0, 50.0, 420.0, 50.0, 0.0, 50.0, 50.0, 40.0, 30.0, 50.0, 40.0, 350.0, 20.0, 20.0, 40.0, 10.0, 40.0, 0.0, 120.0, 60.0, 70.0, 110.0, 30.0, 40.0, 560.0, 0.0, 40.0, 30.0, 30.0, 0.0, 80.0, 40.0, 105.0, 0.0, 40.0, 390.0, 25.0, 30.0, 20.0, 10.0, -10.0, 10.0, 35.0, 5.0, 190.0, 90.0, -20.0, 0.0, 340.0, 330.0, 80.0, 80.0, 190.0, 70.0, 90.0, 450.0, 30.0, 30.0, 10.0, 20.0, -10.0, 20.0, 80.0, 30.0, 30.0, 0.0, -10.0, 30.0, 160.0, 40.0, 30.0, 20.0, 70.0, 30.0, 40.0, 0.0, 20.0, 170.0, 20.0, 20.0, 0.0, 30.0, 10.0, 10.0, 40.0, 40.0, 150.0, 220.0, 280.0, 20.0, 20.0, 70.0, 90.0, -10.0, 30.0, 20.0, 140.0, 170.0, 280.0, 90.0, 70.0, 90.0, 100.0, 35.0, 100.0, 40.0, 75.0, 50.0, 60.0, 300.0, 320.0, 90.0, 200.0, 30.0, 10.0, 60.0, 200.0, 70.0, -10.0, 190.0, -10.0, 420.0, 100.0, 30.0, 30.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5230476995829392, "mean_inference_ms": 1.414378236828113, "mean_action_processing_ms": 0.4341796371252747, "mean_env_wait_ms": 1.2562678261674534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012232303619384766, "StateBufferConnector_ms": 0.010065317153930664, "ViewRequirementAgentConnector_ms": 0.36572933197021484}, "num_episodes": 23, "episode_return_max": 1740.0, "episode_return_min": 150.0, "episode_return_mean": 900.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.297819040262024, "num_env_steps_trained_throughput_per_sec": 21.297819040262024, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 185597.509, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185597.464, "sample_time_ms": 2444.779, "learn_time_ms": 183134.071, "learn_throughput": 21.842, "synch_weights_time_ms": 10.758}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 72, "trial_id": "90816_00000", "date": "2024-06-10_03-58-06", "timestamp": 1718006286, "time_this_iter_s": 187.8199520111084, "time_total_s": 13564.158336162567, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00480d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13564.158336162567, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 19.369811320754717, "ram_util_percent": 78.3833962264151}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1044275835235786, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7080000522926335, "policy_loss": -0.008656534620315725, "vf_loss": 6.715279927827552, "vf_explained_var": -0.00020022915955930472, "kl": 0.006883291889926252, "entropy": 0.4575301766935121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 680775.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "env_runners": {"episode_reward_max": 2750.0, "episode_reward_min": 150.0, "episode_reward_mean": 941.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 94.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1420.0, 870.0, 1325.0, 700.0, 1100.0, 1015.0, 450.0, 420.0, 1080.0, 890.0, 1120.0, 1155.0, 780.0, 820.0, 870.0, 150.0, 400.0, 960.0, 915.0, 600.0, 575.0, 900.0, 365.0, 730.0, 900.0, 590.0, 1380.0, 1650.0, 580.0, 1100.0, 1190.0, 1170.0, 905.0, 960.0, 1535.0, 900.0, 450.0, 1740.0, 930.0, 1570.0, 810.0, 1440.0, 1110.0, 600.0, 1340.0, 630.0, 1620.0, 410.0, 1450.0, 1145.0, 600.0, 1300.0, 1070.0, 1350.0, 500.0, 850.0, 955.0, 810.0, 1150.0, 1300.0, 1440.0, 800.0, 1325.0, 400.0, 490.0, 800.0, 730.0, 700.0, 440.0, 1075.0, 650.0, 1030.0, 755.0, 405.0, 1610.0, 240.0, 410.0, 360.0, 890.0, 1115.0, 1195.0, 1070.0, 1385.0, 1170.0, 520.0, 2750.0, 490.0, 455.0, 820.0, 1050.0, 1275.0, 210.0, 425.0, 1110.0, 1490.0, 1030.0, 1490.0, 360.0, 1075.0, 1560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 50.0, 20.0, 40.0, 180.0, 170.0, 760.0, 100.0, 40.0, 20.0, 0.0, 10.0, 260.0, 140.0, 10.0, 40.0, 70.0, 250.0, 50.0, 40.0, 130.0, 220.0, -30.0, 30.0, 120.0, 160.0, 120.0, 60.0, 510.0, 5.0, 50.0, 20.0, 60.0, 160.0, 150.0, 160.0, 0.0, 60.0, 40.0, 0.0, 40.0, 90.0, 390.0, 80.0, 80.0, 130.0, 60.0, 60.0, 130.0, 40.0, 10.0, 20.0, 280.0, 20.0, 100.0, 15.0, 150.0, 40.0, 70.0, 310.0, 20.0, 0.0, 180.0, 20.0, 30.0, 20.0, 90.0, 40.0, 30.0, 20.0, 0.0, 10.0, 10.0, -10.0, 30.0, 0.0, 110.0, 30.0, 20.0, 220.0, 30.0, 160.0, 160.0, 10.0, -50.0, 160.0, 160.0, 300.0, 20.0, 130.0, 310.0, 150.0, 80.0, 90.0, 0.0, 10.0, 180.0, 30.0, 30.0, 10.0, 70.0, 60.0, 40.0, 70.0, 70.0, 320.0, 30.0, 270.0, 160.0, 30.0, 0.0, 220.0, 50.0, 140.0, 100.0, 45.0, 90.0, 60.0, 230.0, 220.0, 120.0, -20.0, 20.0, 120.0, 30.0, 130.0, 100.0, -30.0, 360.0, -50.0, -10.0, 360.0, 60.0, 40.0, 60.0, -70.0, 160.0, 90.0, 50.0, 80.0, 20.0, 40.0, 50.0, 130.0, 30.0, 100.0, 250.0, 170.0, 80.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 50.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 30.0, 40.0, 260.0, 0.0, 20.0, 230.0, 180.0, 200.0, 160.0, 130.0, 80.0, 40.0, -80.0, 80.0, -60.0, 5.0, 10.0, 400.0, 190.0, 60.0, 10.0, 50.0, 170.0, 0.0, 10.0, 40.0, 10.0, 150.0, 40.0, 30.0, 130.0, 170.0, 20.0, 390.0, 20.0, 30.0, 20.0, 10.0, -90.0, 90.0, 40.0, 0.0, 65.0, 30.0, 130.0, 100.0, 10.0, -40.0, 30.0, 370.0, 40.0, 130.0, 100.0, 10.0, 25.0, 180.0, 50.0, -50.0, 50.0, 30.0, 20.0, 20.0, 30.0, 230.0, 30.0, 40.0, 30.0, 50.0, 10.0, 120.0, 40.0, 150.0, 30.0, 30.0, 70.0, 190.0, 70.0, 70.0, -30.0, 320.0, 120.0, 30.0, 30.0, 40.0, 200.0, 10.0, 30.0, 180.0, 60.0, 30.0, 0.0, 30.0, 10.0, 10.0, 250.0, 60.0, 100.0, 130.0, 210.0, 190.0, 120.0, 160.0, 150.0, 110.0, 40.0, 90.0, 260.0, 50.0, 370.0, 50.0, 360.0, 100.0, 220.0, 40.0, 0.0, 30.0, 40.0, 20.0, 200.0, 100.0, 80.0, 60.0, 10.0, 440.0, 50.0, -130.0, 200.0, 40.0, 30.0, 90.0, 90.0, 20.0, 270.0, 40.0, 90.0, 170.0, 40.0, 160.0, 160.0, 480.0, 20.0, 30.0, 0.0, 0.0, 40.0, 180.0, 170.0, -30.0, -20.0, 50.0, 300.0, 380.0, 100.0, 100.0, 90.0, 90.0, 10.0, 180.0, 40.0, -125.0, 420.0, 110.0, -10.0, 20.0, 80.0, 400.0, 90.0, 40.0, 20.0, 30.0, 30.0, 190.0, 60.0, 40.0, 330.0, 190.0, 260.0, 85.0, 100.0, 10.0, 10.0, 270.0, 240.0, 180.0, 90.0, 30.0, 10.0, 100.0, 60.0, 130.0, 80.0, 60.0, 160.0, 0.0, 30.0, 120.0, 30.0, 20.0, 30.0, 50.0, 110.0, 40.0, 20.0, 30.0, 190.0, 60.0, 100.0, 120.0, 270.0, 160.0, 20.0, 700.0, 90.0, 100.0, 10.0, 20.0, 70.0, 180.0, 0.0, 380.0, 60.0, 40.0, 70.0, 110.0, 150.0, 30.0, 320.0, 300.0, 30.0, 280.0, 40.0, 150.0, 160.0, 180.0, 330.0, -50.0, -20.0, 30.0, 70.0, 30.0, 60.0, 30.0, 150.0, 380.0, 160.0, 190.0, 60.0, 0.0, 110.0, 80.0, 310.0, 120.0, 30.0, 320.0, 70.0, 160.0, 60.0, 40.0, 70.0, 150.0, 190.0, 0.0, 50.0, 20.0, 110.0, 130.0, 0.0, 90.0, 0.0, 20.0, 60.0, 110.0, 60.0, 140.0, 260.0, 240.0, 10.0, 50.0, 260.0, 20.0, 90.0, 220.0, 50.0, 20.0, 90.0, 160.0, 120.0, 110.0, 0.0, 20.0, 30.0, 40.0, 40.0, 560.0, 40.0, 140.0, 70.0, 110.0, 350.0, 80.0, 30.0, 60.0, 180.0, 110.0, 0.0, 20.0, 170.0, 20.0, 0.0, 30.0, 40.0, 0.0, 20.0, 220.0, 40.0, 10.0, 410.0, 140.0, 20.0, 80.0, 310.0, 0.0, 220.0, 50.0, 170.0, 190.0, 300.0, 50.0, 60.0, 100.0, 35.0, 30.0, 160.0, 110.0, 20.0, 40.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 300.0, 250.0, 20.0, 40.0, 220.0, 40.0, 180.0, 70.0, 0.0, 490.0, -10.0, 60.0, 20.0, 240.0, -90.0, 160.0, 260.0, 290.0, -40.0, 130.0, 40.0, 70.0, -20.0, 150.0, 170.0, 220.0, 180.0, 100.0, 120.0, 350.0, 10.0, -50.0, 50.0, 20.0, 0.0, 70.0, -20.0, 100.0, 160.0, 200.0, -30.0, 220.0, 400.0, 130.0, 40.0, 40.0, -20.0, 30.0, 0.0, 10.0, 0.0, 70.0, 200.0, 190.0, -15.0, 40.0, 30.0, 120.0, 120.0, 140.0, 60.0, 30.0, 140.0, 100.0, 60.0, 30.0, 20.0, 210.0, 100.0, 50.0, 70.0, 80.0, 0.0, 250.0, 300.0, 110.0, 190.0, 80.0, 40.0, 60.0, 40.0, 100.0, 0.0, 30.0, 540.0, 140.0, 140.0, 40.0, 120.0, 10.0, 180.0, 60.0, 130.0, 70.0, 30.0, 390.0, 110.0, 60.0, 400.0, 70.0, 120.0, 200.0, 130.0, -390.0, 40.0, 170.0, 140.0, -10.0, 400.0, 40.0, 80.0, 5.0, 140.0, 50.0, 120.0, 240.0, 420.0, 100.0, 200.0, 40.0, 10.0, 10.0, 20.0, 20.0, 60.0, 0.0, 10.0, 30.0, 0.0, 40.0, 210.0, 0.0, 0.0, 170.0, 110.0, 40.0, 50.0, 10.0, 50.0, 20.0, 40.0, 40.0, 40.0, 150.0, 90.0, 20.0, 20.0, 10.0, 50.0, 110.0, 270.0, 20.0, 100.0, 230.0, 30.0, 0.0, 60.0, 180.0, 40.0, 50.0, 20.0, 30.0, 100.0, 30.0, 50.0, 260.0, 70.0, 10.0, 60.0, 10.0, 80.0, 50.0, 0.0, 70.0, 160.0, 10.0, 40.0, 30.0, 10.0, 40.0, 30.0, 70.0, 80.0, 225.0, 20.0, 110.0, 50.0, 420.0, 50.0, 0.0, 50.0, 50.0, 40.0, 30.0, 50.0, 40.0, 350.0, 20.0, 20.0, 40.0, 10.0, 40.0, 0.0, 120.0, 60.0, 70.0, 110.0, 30.0, 40.0, 560.0, 0.0, 40.0, 30.0, 30.0, 0.0, 80.0, 40.0, 105.0, 0.0, 40.0, 390.0, 25.0, 30.0, 20.0, 10.0, -10.0, 10.0, 35.0, 5.0, 190.0, 90.0, -20.0, 0.0, 340.0, 330.0, 80.0, 80.0, 190.0, 70.0, 90.0, 450.0, 30.0, 30.0, 10.0, 20.0, -10.0, 20.0, 80.0, 30.0, 30.0, 0.0, -10.0, 30.0, 160.0, 40.0, 30.0, 20.0, 70.0, 30.0, 40.0, 0.0, 20.0, 170.0, 20.0, 20.0, 0.0, 30.0, 10.0, 10.0, 40.0, 40.0, 150.0, 220.0, 280.0, 20.0, 20.0, 70.0, 90.0, -10.0, 30.0, 20.0, 140.0, 170.0, 280.0, 90.0, 70.0, 90.0, 100.0, 35.0, 100.0, 40.0, 75.0, 50.0, 60.0, 300.0, 320.0, 90.0, 200.0, 30.0, 10.0, 60.0, 200.0, 70.0, -10.0, 190.0, -10.0, 420.0, 100.0, 30.0, 30.0, 50.0, 290.0, 90.0, 370.0, 70.0, -45.0, -110.0, 80.0, 40.0, 410.0, 190.0, 140.0, 40.0, 120.0, 70.0, 70.0, 40.0, 320.0, 170.0, 150.0, 50.0, 20.0, 20.0, 80.0, 20.0, 110.0, 80.0, 70.0, 20.0, 60.0, 40.0, 620.0, 240.0, 180.0, 330.0, 30.0, 90.0, 710.0, 210.0, 150.0, 190.0, 60.0, 40.0, 60.0, 40.0, 80.0, 130.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 60.0, 0.0, 190.0, 20.0, 40.0, 0.0, 40.0, 120.0, 160.0, 40.0, 190.0, 70.0, 0.0, 30.0, 10.0, 40.0, 110.0, 170.0, 10.0, 60.0, 80.0, 190.0, 150.0, 60.0, 130.0, 150.0, 170.0, 50.0, 0.0, 60.0, 60.0, 100.0, 310.0, 410.0, 50.0, -50.0, 310.0, 25.0, 40.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 25.0, 190.0, 70.0, 300.0, -40.0, 240.0, 40.0, 80.0, 50.0, 170.0, 50.0, 150.0, 210.0, 220.0, 170.0, 80.0, 0.0, 180.0, 130.0, 130.0, 270.0, 100.0, 140.0, 190.0, 30.0, 110.0, 60.0, 160.0, 90.0, 180.0, -50.0, 120.0, 270.0, 140.0, 550.0, 50.0, 110.0, 50.0, 30.0, 230.0, 90.0, -30.0, 10.0, 40.0, 30.0, 0.0, 170.0, 40.0, 30.0, 30.0, 0.0, 10.0, 160.0, 40.0, 20.0, 30.0, 0.0, 50.0, 150.0, 20.0, 445.0, 160.0, 300.0, -20.0, 20.0, 70.0, 60.0, 40.0, 140.0, 120.0, 470.0, 360.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5221524108889362, "mean_inference_ms": 1.4139403287086083, "mean_action_processing_ms": 0.4334959188846699, "mean_env_wait_ms": 1.2556129864677645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012225866317749023, "StateBufferConnector_ms": 0.009993314743041992, "ViewRequirementAgentConnector_ms": 0.36632680892944336}, "num_episodes": 18, "episode_return_max": 2750.0, "episode_return_min": 150.0, "episode_return_mean": 941.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.371958315034536, "num_env_steps_trained_throughput_per_sec": 21.371958315034536, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 2920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2920000, "timers": {"training_iteration_time_ms": 185640.539, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185640.494, "sample_time_ms": 2431.032, "learn_time_ms": 183191.12, "learn_throughput": 21.835, "synch_weights_time_ms": 10.722}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "done": false, "training_iteration": 73, "trial_id": "90816_00000", "date": "2024-06-10_04-01-13", "timestamp": 1718006473, "time_this_iter_s": 187.17034602165222, "time_total_s": 13751.32868218422, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f18430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13751.32868218422, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.702641509433963, "ram_util_percent": 78.33509433962266}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.161817757745647, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.083759140993713, "policy_loss": -0.008645516696323555, "vf_loss": 7.091096697676296, "vf_explained_var": 0.000498654387883358, "kl": 0.006539786546080277, "entropy": 0.43515197324295773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 690165.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 2750.0, "episode_reward_min": 210.0, "episode_reward_mean": 982.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 990.0}, "policy_reward_mean": {"policy_0": 98.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [915.0, 600.0, 575.0, 900.0, 365.0, 730.0, 900.0, 590.0, 1380.0, 1650.0, 580.0, 1100.0, 1190.0, 1170.0, 905.0, 960.0, 1535.0, 900.0, 450.0, 1740.0, 930.0, 1570.0, 810.0, 1440.0, 1110.0, 600.0, 1340.0, 630.0, 1620.0, 410.0, 1450.0, 1145.0, 600.0, 1300.0, 1070.0, 1350.0, 500.0, 850.0, 955.0, 810.0, 1150.0, 1300.0, 1440.0, 800.0, 1325.0, 400.0, 490.0, 800.0, 730.0, 700.0, 440.0, 1075.0, 650.0, 1030.0, 755.0, 405.0, 1610.0, 240.0, 410.0, 360.0, 890.0, 1115.0, 1195.0, 1070.0, 1385.0, 1170.0, 520.0, 2750.0, 490.0, 455.0, 820.0, 1050.0, 1275.0, 210.0, 425.0, 1110.0, 1490.0, 1030.0, 1490.0, 360.0, 1075.0, 1560.0, 910.0, 1275.0, 1550.0, 1175.0, 660.0, 860.0, 1215.0, 1265.0, 375.0, 750.0, 1150.0, 1710.0, 1240.0, 560.0, 470.0, 2400.0, 1290.0, 760.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, -60.0, 5.0, 10.0, 400.0, 190.0, 60.0, 10.0, 50.0, 170.0, 0.0, 10.0, 40.0, 10.0, 150.0, 40.0, 30.0, 130.0, 170.0, 20.0, 390.0, 20.0, 30.0, 20.0, 10.0, -90.0, 90.0, 40.0, 0.0, 65.0, 30.0, 130.0, 100.0, 10.0, -40.0, 30.0, 370.0, 40.0, 130.0, 100.0, 10.0, 25.0, 180.0, 50.0, -50.0, 50.0, 30.0, 20.0, 20.0, 30.0, 230.0, 30.0, 40.0, 30.0, 50.0, 10.0, 120.0, 40.0, 150.0, 30.0, 30.0, 70.0, 190.0, 70.0, 70.0, -30.0, 320.0, 120.0, 30.0, 30.0, 40.0, 200.0, 10.0, 30.0, 180.0, 60.0, 30.0, 0.0, 30.0, 10.0, 10.0, 250.0, 60.0, 100.0, 130.0, 210.0, 190.0, 120.0, 160.0, 150.0, 110.0, 40.0, 90.0, 260.0, 50.0, 370.0, 50.0, 360.0, 100.0, 220.0, 40.0, 0.0, 30.0, 40.0, 20.0, 200.0, 100.0, 80.0, 60.0, 10.0, 440.0, 50.0, -130.0, 200.0, 40.0, 30.0, 90.0, 90.0, 20.0, 270.0, 40.0, 90.0, 170.0, 40.0, 160.0, 160.0, 480.0, 20.0, 30.0, 0.0, 0.0, 40.0, 180.0, 170.0, -30.0, -20.0, 50.0, 300.0, 380.0, 100.0, 100.0, 90.0, 90.0, 10.0, 180.0, 40.0, -125.0, 420.0, 110.0, -10.0, 20.0, 80.0, 400.0, 90.0, 40.0, 20.0, 30.0, 30.0, 190.0, 60.0, 40.0, 330.0, 190.0, 260.0, 85.0, 100.0, 10.0, 10.0, 270.0, 240.0, 180.0, 90.0, 30.0, 10.0, 100.0, 60.0, 130.0, 80.0, 60.0, 160.0, 0.0, 30.0, 120.0, 30.0, 20.0, 30.0, 50.0, 110.0, 40.0, 20.0, 30.0, 190.0, 60.0, 100.0, 120.0, 270.0, 160.0, 20.0, 700.0, 90.0, 100.0, 10.0, 20.0, 70.0, 180.0, 0.0, 380.0, 60.0, 40.0, 70.0, 110.0, 150.0, 30.0, 320.0, 300.0, 30.0, 280.0, 40.0, 150.0, 160.0, 180.0, 330.0, -50.0, -20.0, 30.0, 70.0, 30.0, 60.0, 30.0, 150.0, 380.0, 160.0, 190.0, 60.0, 0.0, 110.0, 80.0, 310.0, 120.0, 30.0, 320.0, 70.0, 160.0, 60.0, 40.0, 70.0, 150.0, 190.0, 0.0, 50.0, 20.0, 110.0, 130.0, 0.0, 90.0, 0.0, 20.0, 60.0, 110.0, 60.0, 140.0, 260.0, 240.0, 10.0, 50.0, 260.0, 20.0, 90.0, 220.0, 50.0, 20.0, 90.0, 160.0, 120.0, 110.0, 0.0, 20.0, 30.0, 40.0, 40.0, 560.0, 40.0, 140.0, 70.0, 110.0, 350.0, 80.0, 30.0, 60.0, 180.0, 110.0, 0.0, 20.0, 170.0, 20.0, 0.0, 30.0, 40.0, 0.0, 20.0, 220.0, 40.0, 10.0, 410.0, 140.0, 20.0, 80.0, 310.0, 0.0, 220.0, 50.0, 170.0, 190.0, 300.0, 50.0, 60.0, 100.0, 35.0, 30.0, 160.0, 110.0, 20.0, 40.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 300.0, 250.0, 20.0, 40.0, 220.0, 40.0, 180.0, 70.0, 0.0, 490.0, -10.0, 60.0, 20.0, 240.0, -90.0, 160.0, 260.0, 290.0, -40.0, 130.0, 40.0, 70.0, -20.0, 150.0, 170.0, 220.0, 180.0, 100.0, 120.0, 350.0, 10.0, -50.0, 50.0, 20.0, 0.0, 70.0, -20.0, 100.0, 160.0, 200.0, -30.0, 220.0, 400.0, 130.0, 40.0, 40.0, -20.0, 30.0, 0.0, 10.0, 0.0, 70.0, 200.0, 190.0, -15.0, 40.0, 30.0, 120.0, 120.0, 140.0, 60.0, 30.0, 140.0, 100.0, 60.0, 30.0, 20.0, 210.0, 100.0, 50.0, 70.0, 80.0, 0.0, 250.0, 300.0, 110.0, 190.0, 80.0, 40.0, 60.0, 40.0, 100.0, 0.0, 30.0, 540.0, 140.0, 140.0, 40.0, 120.0, 10.0, 180.0, 60.0, 130.0, 70.0, 30.0, 390.0, 110.0, 60.0, 400.0, 70.0, 120.0, 200.0, 130.0, -390.0, 40.0, 170.0, 140.0, -10.0, 400.0, 40.0, 80.0, 5.0, 140.0, 50.0, 120.0, 240.0, 420.0, 100.0, 200.0, 40.0, 10.0, 10.0, 20.0, 20.0, 60.0, 0.0, 10.0, 30.0, 0.0, 40.0, 210.0, 0.0, 0.0, 170.0, 110.0, 40.0, 50.0, 10.0, 50.0, 20.0, 40.0, 40.0, 40.0, 150.0, 90.0, 20.0, 20.0, 10.0, 50.0, 110.0, 270.0, 20.0, 100.0, 230.0, 30.0, 0.0, 60.0, 180.0, 40.0, 50.0, 20.0, 30.0, 100.0, 30.0, 50.0, 260.0, 70.0, 10.0, 60.0, 10.0, 80.0, 50.0, 0.0, 70.0, 160.0, 10.0, 40.0, 30.0, 10.0, 40.0, 30.0, 70.0, 80.0, 225.0, 20.0, 110.0, 50.0, 420.0, 50.0, 0.0, 50.0, 50.0, 40.0, 30.0, 50.0, 40.0, 350.0, 20.0, 20.0, 40.0, 10.0, 40.0, 0.0, 120.0, 60.0, 70.0, 110.0, 30.0, 40.0, 560.0, 0.0, 40.0, 30.0, 30.0, 0.0, 80.0, 40.0, 105.0, 0.0, 40.0, 390.0, 25.0, 30.0, 20.0, 10.0, -10.0, 10.0, 35.0, 5.0, 190.0, 90.0, -20.0, 0.0, 340.0, 330.0, 80.0, 80.0, 190.0, 70.0, 90.0, 450.0, 30.0, 30.0, 10.0, 20.0, -10.0, 20.0, 80.0, 30.0, 30.0, 0.0, -10.0, 30.0, 160.0, 40.0, 30.0, 20.0, 70.0, 30.0, 40.0, 0.0, 20.0, 170.0, 20.0, 20.0, 0.0, 30.0, 10.0, 10.0, 40.0, 40.0, 150.0, 220.0, 280.0, 20.0, 20.0, 70.0, 90.0, -10.0, 30.0, 20.0, 140.0, 170.0, 280.0, 90.0, 70.0, 90.0, 100.0, 35.0, 100.0, 40.0, 75.0, 50.0, 60.0, 300.0, 320.0, 90.0, 200.0, 30.0, 10.0, 60.0, 200.0, 70.0, -10.0, 190.0, -10.0, 420.0, 100.0, 30.0, 30.0, 50.0, 290.0, 90.0, 370.0, 70.0, -45.0, -110.0, 80.0, 40.0, 410.0, 190.0, 140.0, 40.0, 120.0, 70.0, 70.0, 40.0, 320.0, 170.0, 150.0, 50.0, 20.0, 20.0, 80.0, 20.0, 110.0, 80.0, 70.0, 20.0, 60.0, 40.0, 620.0, 240.0, 180.0, 330.0, 30.0, 90.0, 710.0, 210.0, 150.0, 190.0, 60.0, 40.0, 60.0, 40.0, 80.0, 130.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 60.0, 0.0, 190.0, 20.0, 40.0, 0.0, 40.0, 120.0, 160.0, 40.0, 190.0, 70.0, 0.0, 30.0, 10.0, 40.0, 110.0, 170.0, 10.0, 60.0, 80.0, 190.0, 150.0, 60.0, 130.0, 150.0, 170.0, 50.0, 0.0, 60.0, 60.0, 100.0, 310.0, 410.0, 50.0, -50.0, 310.0, 25.0, 40.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 25.0, 190.0, 70.0, 300.0, -40.0, 240.0, 40.0, 80.0, 50.0, 170.0, 50.0, 150.0, 210.0, 220.0, 170.0, 80.0, 0.0, 180.0, 130.0, 130.0, 270.0, 100.0, 140.0, 190.0, 30.0, 110.0, 60.0, 160.0, 90.0, 180.0, -50.0, 120.0, 270.0, 140.0, 550.0, 50.0, 110.0, 50.0, 30.0, 230.0, 90.0, -30.0, 10.0, 40.0, 30.0, 0.0, 170.0, 40.0, 30.0, 30.0, 0.0, 10.0, 160.0, 40.0, 20.0, 30.0, 0.0, 50.0, 150.0, 20.0, 445.0, 160.0, 300.0, -20.0, 20.0, 70.0, 60.0, 40.0, 140.0, 120.0, 470.0, 360.0, 80.0, 160.0, 20.0, 50.0, 120.0, 70.0, 40.0, 230.0, 90.0, 50.0, 50.0, 240.0, 110.0, 90.0, 80.0, 15.0, 150.0, 20.0, 550.0, -30.0, 0.0, 80.0, 740.0, 200.0, 30.0, 10.0, 40.0, 230.0, 150.0, 70.0, 90.0, 210.0, 45.0, 180.0, 360.0, 70.0, 60.0, 120.0, 40.0, 0.0, 100.0, 170.0, 0.0, 90.0, 150.0, 230.0, 40.0, 40.0, -230.0, 70.0, 190.0, 10.0, 20.0, 60.0, 450.0, 40.0, 30.0, 30.0, 30.0, 0.0, 30.0, 15.0, 140.0, 330.0, 100.0, 40.0, 100.0, 40.0, 360.0, 60.0, 20.0, 30.0, 60.0, 0.0, 155.0, 20.0, 130.0, 330.0, 200.0, 320.0, 10.0, 10.0, 50.0, -20.0, 30.0, 0.0, 70.0, -5.0, 230.0, 0.0, 70.0, 10.0, 210.0, 110.0, 40.0, 40.0, 160.0, 30.0, 80.0, 0.0, 40.0, 60.0, 50.0, 100.0, 310.0, 100.0, 40.0, 40.0, 160.0, 250.0, 10.0, 70.0, 460.0, 10.0, 200.0, 190.0, 270.0, 380.0, 150.0, -30.0, 50.0, 70.0, 90.0, 170.0, 0.0, -140.0, 580.0, 60.0, 310.0, 50.0, 20.0, -40.0, 20.0, 0.0, 40.0, 170.0, 290.0, 10.0, 20.0, 30.0, 90.0, 0.0, 20.0, 20.0, 150.0, 80.0, 10.0, 70.0, 30.0, 0.0, 100.0, -60.0, 70.0, 60.0, 180.0, 170.0, 490.0, 990.0, 60.0, 340.0, 10.0, 450.0, 390.0, 30.0, 0.0, 10.0, 150.0, 80.0, 100.0, 70.0, 30.0, 40.0, 90.0, 240.0, 60.0, 20.0, 60.0, 10.0, 150.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5212409150049229, "mean_inference_ms": 1.4134803778476088, "mean_action_processing_ms": 0.4328269108749751, "mean_env_wait_ms": 1.2549579278292364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012207746505737305, "StateBufferConnector_ms": 0.009191274642944336, "ViewRequirementAgentConnector_ms": 0.3646817207336426}, "num_episodes": 18, "episode_return_max": 2750.0, "episode_return_min": 210.0, "episode_return_mean": 982.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.295292211977802, "num_env_steps_trained_throughput_per_sec": 21.295292211977802, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 185809.678, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185809.634, "sample_time_ms": 2420.07, "learn_time_ms": 183371.059, "learn_throughput": 21.814, "synch_weights_time_ms": 10.73}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 74, "trial_id": "90816_00000", "date": "2024-06-10_04-04-21", "timestamp": 1718006661, "time_this_iter_s": 187.84203600883484, "time_total_s": 13939.170718193054, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0048e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13939.170718193054, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 18.916541353383455, "ram_util_percent": 78.91466165413534}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.160586340511188, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008524283798311315, "vf_loss": 6.385945184695454, "vf_explained_var": 0.0010632839827491834, "kl": Infinity, "entropy": 0.45459697313836844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 699555.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "env_runners": {"episode_reward_max": 2750.0, "episode_reward_min": 155.0, "episode_reward_mean": 959.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 990.0}, "policy_reward_mean": {"policy_0": 95.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [810.0, 1440.0, 1110.0, 600.0, 1340.0, 630.0, 1620.0, 410.0, 1450.0, 1145.0, 600.0, 1300.0, 1070.0, 1350.0, 500.0, 850.0, 955.0, 810.0, 1150.0, 1300.0, 1440.0, 800.0, 1325.0, 400.0, 490.0, 800.0, 730.0, 700.0, 440.0, 1075.0, 650.0, 1030.0, 755.0, 405.0, 1610.0, 240.0, 410.0, 360.0, 890.0, 1115.0, 1195.0, 1070.0, 1385.0, 1170.0, 520.0, 2750.0, 490.0, 455.0, 820.0, 1050.0, 1275.0, 210.0, 425.0, 1110.0, 1490.0, 1030.0, 1490.0, 360.0, 1075.0, 1560.0, 910.0, 1275.0, 1550.0, 1175.0, 660.0, 860.0, 1215.0, 1265.0, 375.0, 750.0, 1150.0, 1710.0, 1240.0, 560.0, 470.0, 2400.0, 1290.0, 760.0, 750.0, 805.0, 1045.0, 1110.0, 660.0, 620.0, 520.0, 1100.0, 1050.0, 1335.0, 1070.0, 415.0, 1060.0, 180.0, 1155.0, 155.0, 840.0, 900.0, 2125.0, 880.0, 620.0, 890.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 330.0, -50.0, -20.0, 30.0, 70.0, 30.0, 60.0, 30.0, 150.0, 380.0, 160.0, 190.0, 60.0, 0.0, 110.0, 80.0, 310.0, 120.0, 30.0, 320.0, 70.0, 160.0, 60.0, 40.0, 70.0, 150.0, 190.0, 0.0, 50.0, 20.0, 110.0, 130.0, 0.0, 90.0, 0.0, 20.0, 60.0, 110.0, 60.0, 140.0, 260.0, 240.0, 10.0, 50.0, 260.0, 20.0, 90.0, 220.0, 50.0, 20.0, 90.0, 160.0, 120.0, 110.0, 0.0, 20.0, 30.0, 40.0, 40.0, 560.0, 40.0, 140.0, 70.0, 110.0, 350.0, 80.0, 30.0, 60.0, 180.0, 110.0, 0.0, 20.0, 170.0, 20.0, 0.0, 30.0, 40.0, 0.0, 20.0, 220.0, 40.0, 10.0, 410.0, 140.0, 20.0, 80.0, 310.0, 0.0, 220.0, 50.0, 170.0, 190.0, 300.0, 50.0, 60.0, 100.0, 35.0, 30.0, 160.0, 110.0, 20.0, 40.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 300.0, 250.0, 20.0, 40.0, 220.0, 40.0, 180.0, 70.0, 0.0, 490.0, -10.0, 60.0, 20.0, 240.0, -90.0, 160.0, 260.0, 290.0, -40.0, 130.0, 40.0, 70.0, -20.0, 150.0, 170.0, 220.0, 180.0, 100.0, 120.0, 350.0, 10.0, -50.0, 50.0, 20.0, 0.0, 70.0, -20.0, 100.0, 160.0, 200.0, -30.0, 220.0, 400.0, 130.0, 40.0, 40.0, -20.0, 30.0, 0.0, 10.0, 0.0, 70.0, 200.0, 190.0, -15.0, 40.0, 30.0, 120.0, 120.0, 140.0, 60.0, 30.0, 140.0, 100.0, 60.0, 30.0, 20.0, 210.0, 100.0, 50.0, 70.0, 80.0, 0.0, 250.0, 300.0, 110.0, 190.0, 80.0, 40.0, 60.0, 40.0, 100.0, 0.0, 30.0, 540.0, 140.0, 140.0, 40.0, 120.0, 10.0, 180.0, 60.0, 130.0, 70.0, 30.0, 390.0, 110.0, 60.0, 400.0, 70.0, 120.0, 200.0, 130.0, -390.0, 40.0, 170.0, 140.0, -10.0, 400.0, 40.0, 80.0, 5.0, 140.0, 50.0, 120.0, 240.0, 420.0, 100.0, 200.0, 40.0, 10.0, 10.0, 20.0, 20.0, 60.0, 0.0, 10.0, 30.0, 0.0, 40.0, 210.0, 0.0, 0.0, 170.0, 110.0, 40.0, 50.0, 10.0, 50.0, 20.0, 40.0, 40.0, 40.0, 150.0, 90.0, 20.0, 20.0, 10.0, 50.0, 110.0, 270.0, 20.0, 100.0, 230.0, 30.0, 0.0, 60.0, 180.0, 40.0, 50.0, 20.0, 30.0, 100.0, 30.0, 50.0, 260.0, 70.0, 10.0, 60.0, 10.0, 80.0, 50.0, 0.0, 70.0, 160.0, 10.0, 40.0, 30.0, 10.0, 40.0, 30.0, 70.0, 80.0, 225.0, 20.0, 110.0, 50.0, 420.0, 50.0, 0.0, 50.0, 50.0, 40.0, 30.0, 50.0, 40.0, 350.0, 20.0, 20.0, 40.0, 10.0, 40.0, 0.0, 120.0, 60.0, 70.0, 110.0, 30.0, 40.0, 560.0, 0.0, 40.0, 30.0, 30.0, 0.0, 80.0, 40.0, 105.0, 0.0, 40.0, 390.0, 25.0, 30.0, 20.0, 10.0, -10.0, 10.0, 35.0, 5.0, 190.0, 90.0, -20.0, 0.0, 340.0, 330.0, 80.0, 80.0, 190.0, 70.0, 90.0, 450.0, 30.0, 30.0, 10.0, 20.0, -10.0, 20.0, 80.0, 30.0, 30.0, 0.0, -10.0, 30.0, 160.0, 40.0, 30.0, 20.0, 70.0, 30.0, 40.0, 0.0, 20.0, 170.0, 20.0, 20.0, 0.0, 30.0, 10.0, 10.0, 40.0, 40.0, 150.0, 220.0, 280.0, 20.0, 20.0, 70.0, 90.0, -10.0, 30.0, 20.0, 140.0, 170.0, 280.0, 90.0, 70.0, 90.0, 100.0, 35.0, 100.0, 40.0, 75.0, 50.0, 60.0, 300.0, 320.0, 90.0, 200.0, 30.0, 10.0, 60.0, 200.0, 70.0, -10.0, 190.0, -10.0, 420.0, 100.0, 30.0, 30.0, 50.0, 290.0, 90.0, 370.0, 70.0, -45.0, -110.0, 80.0, 40.0, 410.0, 190.0, 140.0, 40.0, 120.0, 70.0, 70.0, 40.0, 320.0, 170.0, 150.0, 50.0, 20.0, 20.0, 80.0, 20.0, 110.0, 80.0, 70.0, 20.0, 60.0, 40.0, 620.0, 240.0, 180.0, 330.0, 30.0, 90.0, 710.0, 210.0, 150.0, 190.0, 60.0, 40.0, 60.0, 40.0, 80.0, 130.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 60.0, 0.0, 190.0, 20.0, 40.0, 0.0, 40.0, 120.0, 160.0, 40.0, 190.0, 70.0, 0.0, 30.0, 10.0, 40.0, 110.0, 170.0, 10.0, 60.0, 80.0, 190.0, 150.0, 60.0, 130.0, 150.0, 170.0, 50.0, 0.0, 60.0, 60.0, 100.0, 310.0, 410.0, 50.0, -50.0, 310.0, 25.0, 40.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 25.0, 190.0, 70.0, 300.0, -40.0, 240.0, 40.0, 80.0, 50.0, 170.0, 50.0, 150.0, 210.0, 220.0, 170.0, 80.0, 0.0, 180.0, 130.0, 130.0, 270.0, 100.0, 140.0, 190.0, 30.0, 110.0, 60.0, 160.0, 90.0, 180.0, -50.0, 120.0, 270.0, 140.0, 550.0, 50.0, 110.0, 50.0, 30.0, 230.0, 90.0, -30.0, 10.0, 40.0, 30.0, 0.0, 170.0, 40.0, 30.0, 30.0, 0.0, 10.0, 160.0, 40.0, 20.0, 30.0, 0.0, 50.0, 150.0, 20.0, 445.0, 160.0, 300.0, -20.0, 20.0, 70.0, 60.0, 40.0, 140.0, 120.0, 470.0, 360.0, 80.0, 160.0, 20.0, 50.0, 120.0, 70.0, 40.0, 230.0, 90.0, 50.0, 50.0, 240.0, 110.0, 90.0, 80.0, 15.0, 150.0, 20.0, 550.0, -30.0, 0.0, 80.0, 740.0, 200.0, 30.0, 10.0, 40.0, 230.0, 150.0, 70.0, 90.0, 210.0, 45.0, 180.0, 360.0, 70.0, 60.0, 120.0, 40.0, 0.0, 100.0, 170.0, 0.0, 90.0, 150.0, 230.0, 40.0, 40.0, -230.0, 70.0, 190.0, 10.0, 20.0, 60.0, 450.0, 40.0, 30.0, 30.0, 30.0, 0.0, 30.0, 15.0, 140.0, 330.0, 100.0, 40.0, 100.0, 40.0, 360.0, 60.0, 20.0, 30.0, 60.0, 0.0, 155.0, 20.0, 130.0, 330.0, 200.0, 320.0, 10.0, 10.0, 50.0, -20.0, 30.0, 0.0, 70.0, -5.0, 230.0, 0.0, 70.0, 10.0, 210.0, 110.0, 40.0, 40.0, 160.0, 30.0, 80.0, 0.0, 40.0, 60.0, 50.0, 100.0, 310.0, 100.0, 40.0, 40.0, 160.0, 250.0, 10.0, 70.0, 460.0, 10.0, 200.0, 190.0, 270.0, 380.0, 150.0, -30.0, 50.0, 70.0, 90.0, 170.0, 0.0, -140.0, 580.0, 60.0, 310.0, 50.0, 20.0, -40.0, 20.0, 0.0, 40.0, 170.0, 290.0, 10.0, 20.0, 30.0, 90.0, 0.0, 20.0, 20.0, 150.0, 80.0, 10.0, 70.0, 30.0, 0.0, 100.0, -60.0, 70.0, 60.0, 180.0, 170.0, 490.0, 990.0, 60.0, 340.0, 10.0, 450.0, 390.0, 30.0, 0.0, 10.0, 150.0, 80.0, 100.0, 70.0, 30.0, 40.0, 90.0, 240.0, 60.0, 20.0, 60.0, 10.0, 150.0, 60.0, 20.0, 30.0, 90.0, 70.0, 140.0, 10.0, 100.0, 120.0, 160.0, 10.0, 10.0, 440.0, 10.0, 30.0, 20.0, 20.0, 10.0, 5.0, 150.0, 110.0, 10.0, 20.0, 130.0, -40.0, 450.0, 30.0, 60.0, 230.0, 105.0, 50.0, 400.0, 80.0, 80.0, 50.0, 110.0, 30.0, 70.0, 160.0, 50.0, 80.0, 30.0, 200.0, 60.0, -10.0, -100.0, 0.0, 30.0, 350.0, 0.0, 100.0, 30.0, 0.0, 90.0, 270.0, 0.0, 100.0, 0.0, 50.0, 70.0, 10.0, 40.0, 100.0, 30.0, 120.0, 30.0, 10.0, 30.0, 70.0, 70.0, 20.0, 180.0, 40.0, 20.0, 50.0, 90.0, 160.0, 80.0, 160.0, 230.0, 90.0, 40.0, 90.0, 220.0, 180.0, 220.0, 20.0, 110.0, 90.0, 40.0, 40.0, 20.0, 100.0, 300.0, 100.0, 320.0, 20.0, 50.0, 65.0, 60.0, 300.0, -40.0, 300.0, 90.0, 210.0, 60.0, 340.0, -30.0, 70.0, 70.0, 0.0, 30.0, 10.0, 20.0, 40.0, 35.0, 55.0, 140.0, 40.0, 0.0, 45.0, 160.0, 230.0, 60.0, 40.0, 320.0, 50.0, 60.0, 0.0, 60.0, 80.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 40.0, 10.0, 100.0, 200.0, 300.0, 35.0, 100.0, 70.0, 130.0, 20.0, 110.0, 90.0, 0.0, 10.0, 10.0, 60.0, 0.0, 10.0, 30.0, 10.0, 30.0, -5.0, 300.0, 190.0, 100.0, 60.0, 20.0, 0.0, 40.0, 20.0, 0.0, 110.0, 50.0, 50.0, 30.0, 70.0, 370.0, 20.0, 30.0, 20.0, 80.0, 180.0, -10.0, 900.0, 380.0, -25.0, 260.0, 100.0, 140.0, 20.0, 180.0, 180.0, 240.0, 20.0, 10.0, 60.0, 190.0, 90.0, 0.0, 70.0, 50.0, 150.0, 80.0, 180.0, 0.0, 40.0, 180.0, -40.0, 10.0, 0.0, 120.0, 50.0, 20.0, 100.0, 150.0, 30.0, 30.0, 270.0, 160.0, 10.0, 100.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.520529424565998, "mean_inference_ms": 1.413591091125229, "mean_action_processing_ms": 0.4319698915239107, "mean_env_wait_ms": 1.2540341052461894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01227259635925293, "StateBufferConnector_ms": 0.009297609329223633, "ViewRequirementAgentConnector_ms": 0.3655974864959717}, "num_episodes": 22, "episode_return_max": 2750.0, "episode_return_min": 155.0, "episode_return_mean": 959.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.379652570068824, "num_env_steps_trained_throughput_per_sec": 21.379652570068824, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 3000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000000, "timers": {"training_iteration_time_ms": 186088.522, "restore_workers_time_ms": 0.014, "training_step_time_ms": 186088.476, "sample_time_ms": 2399.35, "learn_time_ms": 183670.299, "learn_throughput": 21.778, "synch_weights_time_ms": 10.854}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "done": false, "training_iteration": 75, "trial_id": "90816_00000", "date": "2024-06-10_04-07-28", "timestamp": 1718006848, "time_this_iter_s": 187.10106921195984, "time_total_s": 14126.271787405014, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00480d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14126.271787405014, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 18.120075757575762, "ram_util_percent": 79.2840909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.321648601443369, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.413518325665508, "policy_loss": -0.00877600027351413, "vf_loss": 6.420570124960301, "vf_explained_var": 0.00123099557761821, "kl": 0.00574735093165165, "entropy": 0.43761215264550923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 708945.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 2750.0, "episode_reward_min": 155.0, "episode_reward_mean": 938.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 990.0}, "policy_reward_mean": {"policy_0": 93.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1150.0, 1300.0, 1440.0, 800.0, 1325.0, 400.0, 490.0, 800.0, 730.0, 700.0, 440.0, 1075.0, 650.0, 1030.0, 755.0, 405.0, 1610.0, 240.0, 410.0, 360.0, 890.0, 1115.0, 1195.0, 1070.0, 1385.0, 1170.0, 520.0, 2750.0, 490.0, 455.0, 820.0, 1050.0, 1275.0, 210.0, 425.0, 1110.0, 1490.0, 1030.0, 1490.0, 360.0, 1075.0, 1560.0, 910.0, 1275.0, 1550.0, 1175.0, 660.0, 860.0, 1215.0, 1265.0, 375.0, 750.0, 1150.0, 1710.0, 1240.0, 560.0, 470.0, 2400.0, 1290.0, 760.0, 750.0, 805.0, 1045.0, 1110.0, 660.0, 620.0, 520.0, 1100.0, 1050.0, 1335.0, 1070.0, 415.0, 1060.0, 180.0, 1155.0, 155.0, 840.0, 900.0, 2125.0, 880.0, 620.0, 890.0, 960.0, 620.0, 420.0, 800.0, 1070.0, 1300.0, 1790.0, 600.0, 270.0, 410.0, 1380.0, 500.0, 1510.0, 370.0, 1520.0, 740.0, 660.0, 1010.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 0.0, 250.0, 300.0, 110.0, 190.0, 80.0, 40.0, 60.0, 40.0, 100.0, 0.0, 30.0, 540.0, 140.0, 140.0, 40.0, 120.0, 10.0, 180.0, 60.0, 130.0, 70.0, 30.0, 390.0, 110.0, 60.0, 400.0, 70.0, 120.0, 200.0, 130.0, -390.0, 40.0, 170.0, 140.0, -10.0, 400.0, 40.0, 80.0, 5.0, 140.0, 50.0, 120.0, 240.0, 420.0, 100.0, 200.0, 40.0, 10.0, 10.0, 20.0, 20.0, 60.0, 0.0, 10.0, 30.0, 0.0, 40.0, 210.0, 0.0, 0.0, 170.0, 110.0, 40.0, 50.0, 10.0, 50.0, 20.0, 40.0, 40.0, 40.0, 150.0, 90.0, 20.0, 20.0, 10.0, 50.0, 110.0, 270.0, 20.0, 100.0, 230.0, 30.0, 0.0, 60.0, 180.0, 40.0, 50.0, 20.0, 30.0, 100.0, 30.0, 50.0, 260.0, 70.0, 10.0, 60.0, 10.0, 80.0, 50.0, 0.0, 70.0, 160.0, 10.0, 40.0, 30.0, 10.0, 40.0, 30.0, 70.0, 80.0, 225.0, 20.0, 110.0, 50.0, 420.0, 50.0, 0.0, 50.0, 50.0, 40.0, 30.0, 50.0, 40.0, 350.0, 20.0, 20.0, 40.0, 10.0, 40.0, 0.0, 120.0, 60.0, 70.0, 110.0, 30.0, 40.0, 560.0, 0.0, 40.0, 30.0, 30.0, 0.0, 80.0, 40.0, 105.0, 0.0, 40.0, 390.0, 25.0, 30.0, 20.0, 10.0, -10.0, 10.0, 35.0, 5.0, 190.0, 90.0, -20.0, 0.0, 340.0, 330.0, 80.0, 80.0, 190.0, 70.0, 90.0, 450.0, 30.0, 30.0, 10.0, 20.0, -10.0, 20.0, 80.0, 30.0, 30.0, 0.0, -10.0, 30.0, 160.0, 40.0, 30.0, 20.0, 70.0, 30.0, 40.0, 0.0, 20.0, 170.0, 20.0, 20.0, 0.0, 30.0, 10.0, 10.0, 40.0, 40.0, 150.0, 220.0, 280.0, 20.0, 20.0, 70.0, 90.0, -10.0, 30.0, 20.0, 140.0, 170.0, 280.0, 90.0, 70.0, 90.0, 100.0, 35.0, 100.0, 40.0, 75.0, 50.0, 60.0, 300.0, 320.0, 90.0, 200.0, 30.0, 10.0, 60.0, 200.0, 70.0, -10.0, 190.0, -10.0, 420.0, 100.0, 30.0, 30.0, 50.0, 290.0, 90.0, 370.0, 70.0, -45.0, -110.0, 80.0, 40.0, 410.0, 190.0, 140.0, 40.0, 120.0, 70.0, 70.0, 40.0, 320.0, 170.0, 150.0, 50.0, 20.0, 20.0, 80.0, 20.0, 110.0, 80.0, 70.0, 20.0, 60.0, 40.0, 620.0, 240.0, 180.0, 330.0, 30.0, 90.0, 710.0, 210.0, 150.0, 190.0, 60.0, 40.0, 60.0, 40.0, 80.0, 130.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 60.0, 0.0, 190.0, 20.0, 40.0, 0.0, 40.0, 120.0, 160.0, 40.0, 190.0, 70.0, 0.0, 30.0, 10.0, 40.0, 110.0, 170.0, 10.0, 60.0, 80.0, 190.0, 150.0, 60.0, 130.0, 150.0, 170.0, 50.0, 0.0, 60.0, 60.0, 100.0, 310.0, 410.0, 50.0, -50.0, 310.0, 25.0, 40.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 25.0, 190.0, 70.0, 300.0, -40.0, 240.0, 40.0, 80.0, 50.0, 170.0, 50.0, 150.0, 210.0, 220.0, 170.0, 80.0, 0.0, 180.0, 130.0, 130.0, 270.0, 100.0, 140.0, 190.0, 30.0, 110.0, 60.0, 160.0, 90.0, 180.0, -50.0, 120.0, 270.0, 140.0, 550.0, 50.0, 110.0, 50.0, 30.0, 230.0, 90.0, -30.0, 10.0, 40.0, 30.0, 0.0, 170.0, 40.0, 30.0, 30.0, 0.0, 10.0, 160.0, 40.0, 20.0, 30.0, 0.0, 50.0, 150.0, 20.0, 445.0, 160.0, 300.0, -20.0, 20.0, 70.0, 60.0, 40.0, 140.0, 120.0, 470.0, 360.0, 80.0, 160.0, 20.0, 50.0, 120.0, 70.0, 40.0, 230.0, 90.0, 50.0, 50.0, 240.0, 110.0, 90.0, 80.0, 15.0, 150.0, 20.0, 550.0, -30.0, 0.0, 80.0, 740.0, 200.0, 30.0, 10.0, 40.0, 230.0, 150.0, 70.0, 90.0, 210.0, 45.0, 180.0, 360.0, 70.0, 60.0, 120.0, 40.0, 0.0, 100.0, 170.0, 0.0, 90.0, 150.0, 230.0, 40.0, 40.0, -230.0, 70.0, 190.0, 10.0, 20.0, 60.0, 450.0, 40.0, 30.0, 30.0, 30.0, 0.0, 30.0, 15.0, 140.0, 330.0, 100.0, 40.0, 100.0, 40.0, 360.0, 60.0, 20.0, 30.0, 60.0, 0.0, 155.0, 20.0, 130.0, 330.0, 200.0, 320.0, 10.0, 10.0, 50.0, -20.0, 30.0, 0.0, 70.0, -5.0, 230.0, 0.0, 70.0, 10.0, 210.0, 110.0, 40.0, 40.0, 160.0, 30.0, 80.0, 0.0, 40.0, 60.0, 50.0, 100.0, 310.0, 100.0, 40.0, 40.0, 160.0, 250.0, 10.0, 70.0, 460.0, 10.0, 200.0, 190.0, 270.0, 380.0, 150.0, -30.0, 50.0, 70.0, 90.0, 170.0, 0.0, -140.0, 580.0, 60.0, 310.0, 50.0, 20.0, -40.0, 20.0, 0.0, 40.0, 170.0, 290.0, 10.0, 20.0, 30.0, 90.0, 0.0, 20.0, 20.0, 150.0, 80.0, 10.0, 70.0, 30.0, 0.0, 100.0, -60.0, 70.0, 60.0, 180.0, 170.0, 490.0, 990.0, 60.0, 340.0, 10.0, 450.0, 390.0, 30.0, 0.0, 10.0, 150.0, 80.0, 100.0, 70.0, 30.0, 40.0, 90.0, 240.0, 60.0, 20.0, 60.0, 10.0, 150.0, 60.0, 20.0, 30.0, 90.0, 70.0, 140.0, 10.0, 100.0, 120.0, 160.0, 10.0, 10.0, 440.0, 10.0, 30.0, 20.0, 20.0, 10.0, 5.0, 150.0, 110.0, 10.0, 20.0, 130.0, -40.0, 450.0, 30.0, 60.0, 230.0, 105.0, 50.0, 400.0, 80.0, 80.0, 50.0, 110.0, 30.0, 70.0, 160.0, 50.0, 80.0, 30.0, 200.0, 60.0, -10.0, -100.0, 0.0, 30.0, 350.0, 0.0, 100.0, 30.0, 0.0, 90.0, 270.0, 0.0, 100.0, 0.0, 50.0, 70.0, 10.0, 40.0, 100.0, 30.0, 120.0, 30.0, 10.0, 30.0, 70.0, 70.0, 20.0, 180.0, 40.0, 20.0, 50.0, 90.0, 160.0, 80.0, 160.0, 230.0, 90.0, 40.0, 90.0, 220.0, 180.0, 220.0, 20.0, 110.0, 90.0, 40.0, 40.0, 20.0, 100.0, 300.0, 100.0, 320.0, 20.0, 50.0, 65.0, 60.0, 300.0, -40.0, 300.0, 90.0, 210.0, 60.0, 340.0, -30.0, 70.0, 70.0, 0.0, 30.0, 10.0, 20.0, 40.0, 35.0, 55.0, 140.0, 40.0, 0.0, 45.0, 160.0, 230.0, 60.0, 40.0, 320.0, 50.0, 60.0, 0.0, 60.0, 80.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 40.0, 10.0, 100.0, 200.0, 300.0, 35.0, 100.0, 70.0, 130.0, 20.0, 110.0, 90.0, 0.0, 10.0, 10.0, 60.0, 0.0, 10.0, 30.0, 10.0, 30.0, -5.0, 300.0, 190.0, 100.0, 60.0, 20.0, 0.0, 40.0, 20.0, 0.0, 110.0, 50.0, 50.0, 30.0, 70.0, 370.0, 20.0, 30.0, 20.0, 80.0, 180.0, -10.0, 900.0, 380.0, -25.0, 260.0, 100.0, 140.0, 20.0, 180.0, 180.0, 240.0, 20.0, 10.0, 60.0, 190.0, 90.0, 0.0, 70.0, 50.0, 150.0, 80.0, 180.0, 0.0, 40.0, 180.0, -40.0, 10.0, 0.0, 120.0, 50.0, 20.0, 100.0, 150.0, 30.0, 30.0, 270.0, 160.0, 10.0, 100.0, 20.0, 60.0, 25.0, 60.0, 45.0, 220.0, 90.0, 240.0, 60.0, 50.0, 110.0, 10.0, 50.0, 80.0, 230.0, 10.0, 20.0, 0.0, 50.0, 160.0, 10.0, 210.0, 0.0, 40.0, 0.0, 0.0, 60.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 390.0, 30.0, 140.0, 10.0, 20.0, 80.0, 30.0, 10.0, 170.0, 470.0, 40.0, 170.0, 60.0, 40.0, 30.0, 10.0, 30.0, 50.0, 180.0, 170.0, 60.0, 120.0, 100.0, 60.0, 10.0, 140.0, 370.0, 90.0, 90.0, 50.0, 340.0, 190.0, -80.0, 660.0, 210.0, 60.0, 210.0, 60.0, 80.0, 30.0, -30.0, 40.0, 10.0, -50.0, 40.0, 380.0, 60.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 80.0, 20.0, 20.0, 20.0, 70.0, 10.0, 0.0, 80.0, 10.0, 150.0, 10.0, 30.0, 110.0, 10.0, 0.0, 400.0, 130.0, 90.0, 20.0, 50.0, 40.0, 40.0, 50.0, 260.0, 300.0, 140.0, 40.0, 10.0, 30.0, 60.0, 10.0, 10.0, 180.0, 0.0, 20.0, 130.0, 30.0, 210.0, -40.0, 220.0, 200.0, 700.0, 20.0, 0.0, 40.0, 20.0, 40.0, 160.0, 70.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, -30.0, 30.0, 65.0, -30.0, 250.0, 30.0, 315.0, 350.0, 280.0, 260.0, -80.0, 400.0, 50.0, 150.0, 80.0, -80.0, 80.0, 60.0, 40.0, 40.0, 30.0, 10.0, 260.0, 150.0, 30.0, 30.0, 20.0, 30.0, 90.0, 10.0, -60.0, -130.0, 70.0, -20.0, -10.0, 90.0, 70.0, 150.0, 230.0, 620.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5196164595871047, "mean_inference_ms": 1.4128054003301185, "mean_action_processing_ms": 0.4314009858829567, "mean_env_wait_ms": 1.2536896342956043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011678695678710938, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.3616781234741211}, "num_episodes": 18, "episode_return_max": 2750.0, "episode_return_min": 155.0, "episode_return_mean": 938.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.418261126760214, "num_env_steps_trained_throughput_per_sec": 21.418261126760214, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 186278.424, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186278.377, "sample_time_ms": 2413.507, "learn_time_ms": 183846.13, "learn_throughput": 21.757, "synch_weights_time_ms": 10.843}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 76, "trial_id": "90816_00000", "date": "2024-06-10_04-10-35", "timestamp": 1718007035, "time_this_iter_s": 186.76741909980774, "time_total_s": 14313.039206504822, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b004a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14313.039206504822, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.44264150943396, "ram_util_percent": 79.10641509433964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.250977958645176, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.595789892401812, "policy_loss": -0.00896662230675552, "vf_loss": 6.6030592546168485, "vf_explained_var": 0.0005053097955462016, "kl": 0.005657528532789052, "entropy": 0.4137165298762794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 718335.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "env_runners": {"episode_reward_max": 2750.0, "episode_reward_min": 80.0, "episode_reward_mean": 960.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 990.0}, "policy_reward_mean": {"policy_0": 96.025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1070.0, 1385.0, 1170.0, 520.0, 2750.0, 490.0, 455.0, 820.0, 1050.0, 1275.0, 210.0, 425.0, 1110.0, 1490.0, 1030.0, 1490.0, 360.0, 1075.0, 1560.0, 910.0, 1275.0, 1550.0, 1175.0, 660.0, 860.0, 1215.0, 1265.0, 375.0, 750.0, 1150.0, 1710.0, 1240.0, 560.0, 470.0, 2400.0, 1290.0, 760.0, 750.0, 805.0, 1045.0, 1110.0, 660.0, 620.0, 520.0, 1100.0, 1050.0, 1335.0, 1070.0, 415.0, 1060.0, 180.0, 1155.0, 155.0, 840.0, 900.0, 2125.0, 880.0, 620.0, 890.0, 960.0, 620.0, 420.0, 800.0, 1070.0, 1300.0, 1790.0, 600.0, 270.0, 410.0, 1380.0, 500.0, 1510.0, 370.0, 1520.0, 740.0, 660.0, 1010.0, 1490.0, 1480.0, 590.0, 910.0, 1540.0, 1330.0, 995.0, 1110.0, 820.0, 190.0, 1305.0, 80.0, 880.0, 470.0, 1410.0, 295.0, 805.0, 1030.0, 1040.0, 1620.0, 600.0, 1060.0, 410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [200.0, 70.0, -10.0, 190.0, -10.0, 420.0, 100.0, 30.0, 30.0, 50.0, 290.0, 90.0, 370.0, 70.0, -45.0, -110.0, 80.0, 40.0, 410.0, 190.0, 140.0, 40.0, 120.0, 70.0, 70.0, 40.0, 320.0, 170.0, 150.0, 50.0, 20.0, 20.0, 80.0, 20.0, 110.0, 80.0, 70.0, 20.0, 60.0, 40.0, 620.0, 240.0, 180.0, 330.0, 30.0, 90.0, 710.0, 210.0, 150.0, 190.0, 60.0, 40.0, 60.0, 40.0, 80.0, 130.0, 20.0, 10.0, 20.0, 30.0, 10.0, -25.0, 60.0, 0.0, 190.0, 20.0, 40.0, 0.0, 40.0, 120.0, 160.0, 40.0, 190.0, 70.0, 0.0, 30.0, 10.0, 40.0, 110.0, 170.0, 10.0, 60.0, 80.0, 190.0, 150.0, 60.0, 130.0, 150.0, 170.0, 50.0, 0.0, 60.0, 60.0, 100.0, 310.0, 410.0, 50.0, -50.0, 310.0, 25.0, 40.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 20.0, 10.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 25.0, 190.0, 70.0, 300.0, -40.0, 240.0, 40.0, 80.0, 50.0, 170.0, 50.0, 150.0, 210.0, 220.0, 170.0, 80.0, 0.0, 180.0, 130.0, 130.0, 270.0, 100.0, 140.0, 190.0, 30.0, 110.0, 60.0, 160.0, 90.0, 180.0, -50.0, 120.0, 270.0, 140.0, 550.0, 50.0, 110.0, 50.0, 30.0, 230.0, 90.0, -30.0, 10.0, 40.0, 30.0, 0.0, 170.0, 40.0, 30.0, 30.0, 0.0, 10.0, 160.0, 40.0, 20.0, 30.0, 0.0, 50.0, 150.0, 20.0, 445.0, 160.0, 300.0, -20.0, 20.0, 70.0, 60.0, 40.0, 140.0, 120.0, 470.0, 360.0, 80.0, 160.0, 20.0, 50.0, 120.0, 70.0, 40.0, 230.0, 90.0, 50.0, 50.0, 240.0, 110.0, 90.0, 80.0, 15.0, 150.0, 20.0, 550.0, -30.0, 0.0, 80.0, 740.0, 200.0, 30.0, 10.0, 40.0, 230.0, 150.0, 70.0, 90.0, 210.0, 45.0, 180.0, 360.0, 70.0, 60.0, 120.0, 40.0, 0.0, 100.0, 170.0, 0.0, 90.0, 150.0, 230.0, 40.0, 40.0, -230.0, 70.0, 190.0, 10.0, 20.0, 60.0, 450.0, 40.0, 30.0, 30.0, 30.0, 0.0, 30.0, 15.0, 140.0, 330.0, 100.0, 40.0, 100.0, 40.0, 360.0, 60.0, 20.0, 30.0, 60.0, 0.0, 155.0, 20.0, 130.0, 330.0, 200.0, 320.0, 10.0, 10.0, 50.0, -20.0, 30.0, 0.0, 70.0, -5.0, 230.0, 0.0, 70.0, 10.0, 210.0, 110.0, 40.0, 40.0, 160.0, 30.0, 80.0, 0.0, 40.0, 60.0, 50.0, 100.0, 310.0, 100.0, 40.0, 40.0, 160.0, 250.0, 10.0, 70.0, 460.0, 10.0, 200.0, 190.0, 270.0, 380.0, 150.0, -30.0, 50.0, 70.0, 90.0, 170.0, 0.0, -140.0, 580.0, 60.0, 310.0, 50.0, 20.0, -40.0, 20.0, 0.0, 40.0, 170.0, 290.0, 10.0, 20.0, 30.0, 90.0, 0.0, 20.0, 20.0, 150.0, 80.0, 10.0, 70.0, 30.0, 0.0, 100.0, -60.0, 70.0, 60.0, 180.0, 170.0, 490.0, 990.0, 60.0, 340.0, 10.0, 450.0, 390.0, 30.0, 0.0, 10.0, 150.0, 80.0, 100.0, 70.0, 30.0, 40.0, 90.0, 240.0, 60.0, 20.0, 60.0, 10.0, 150.0, 60.0, 20.0, 30.0, 90.0, 70.0, 140.0, 10.0, 100.0, 120.0, 160.0, 10.0, 10.0, 440.0, 10.0, 30.0, 20.0, 20.0, 10.0, 5.0, 150.0, 110.0, 10.0, 20.0, 130.0, -40.0, 450.0, 30.0, 60.0, 230.0, 105.0, 50.0, 400.0, 80.0, 80.0, 50.0, 110.0, 30.0, 70.0, 160.0, 50.0, 80.0, 30.0, 200.0, 60.0, -10.0, -100.0, 0.0, 30.0, 350.0, 0.0, 100.0, 30.0, 0.0, 90.0, 270.0, 0.0, 100.0, 0.0, 50.0, 70.0, 10.0, 40.0, 100.0, 30.0, 120.0, 30.0, 10.0, 30.0, 70.0, 70.0, 20.0, 180.0, 40.0, 20.0, 50.0, 90.0, 160.0, 80.0, 160.0, 230.0, 90.0, 40.0, 90.0, 220.0, 180.0, 220.0, 20.0, 110.0, 90.0, 40.0, 40.0, 20.0, 100.0, 300.0, 100.0, 320.0, 20.0, 50.0, 65.0, 60.0, 300.0, -40.0, 300.0, 90.0, 210.0, 60.0, 340.0, -30.0, 70.0, 70.0, 0.0, 30.0, 10.0, 20.0, 40.0, 35.0, 55.0, 140.0, 40.0, 0.0, 45.0, 160.0, 230.0, 60.0, 40.0, 320.0, 50.0, 60.0, 0.0, 60.0, 80.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 40.0, 10.0, 100.0, 200.0, 300.0, 35.0, 100.0, 70.0, 130.0, 20.0, 110.0, 90.0, 0.0, 10.0, 10.0, 60.0, 0.0, 10.0, 30.0, 10.0, 30.0, -5.0, 300.0, 190.0, 100.0, 60.0, 20.0, 0.0, 40.0, 20.0, 0.0, 110.0, 50.0, 50.0, 30.0, 70.0, 370.0, 20.0, 30.0, 20.0, 80.0, 180.0, -10.0, 900.0, 380.0, -25.0, 260.0, 100.0, 140.0, 20.0, 180.0, 180.0, 240.0, 20.0, 10.0, 60.0, 190.0, 90.0, 0.0, 70.0, 50.0, 150.0, 80.0, 180.0, 0.0, 40.0, 180.0, -40.0, 10.0, 0.0, 120.0, 50.0, 20.0, 100.0, 150.0, 30.0, 30.0, 270.0, 160.0, 10.0, 100.0, 20.0, 60.0, 25.0, 60.0, 45.0, 220.0, 90.0, 240.0, 60.0, 50.0, 110.0, 10.0, 50.0, 80.0, 230.0, 10.0, 20.0, 0.0, 50.0, 160.0, 10.0, 210.0, 0.0, 40.0, 0.0, 0.0, 60.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 390.0, 30.0, 140.0, 10.0, 20.0, 80.0, 30.0, 10.0, 170.0, 470.0, 40.0, 170.0, 60.0, 40.0, 30.0, 10.0, 30.0, 50.0, 180.0, 170.0, 60.0, 120.0, 100.0, 60.0, 10.0, 140.0, 370.0, 90.0, 90.0, 50.0, 340.0, 190.0, -80.0, 660.0, 210.0, 60.0, 210.0, 60.0, 80.0, 30.0, -30.0, 40.0, 10.0, -50.0, 40.0, 380.0, 60.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 80.0, 20.0, 20.0, 20.0, 70.0, 10.0, 0.0, 80.0, 10.0, 150.0, 10.0, 30.0, 110.0, 10.0, 0.0, 400.0, 130.0, 90.0, 20.0, 50.0, 40.0, 40.0, 50.0, 260.0, 300.0, 140.0, 40.0, 10.0, 30.0, 60.0, 10.0, 10.0, 180.0, 0.0, 20.0, 130.0, 30.0, 210.0, -40.0, 220.0, 200.0, 700.0, 20.0, 0.0, 40.0, 20.0, 40.0, 160.0, 70.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, -30.0, 30.0, 65.0, -30.0, 250.0, 30.0, 315.0, 350.0, 280.0, 260.0, -80.0, 400.0, 50.0, 150.0, 80.0, -80.0, 80.0, 60.0, 40.0, 40.0, 30.0, 10.0, 260.0, 150.0, 30.0, 30.0, 20.0, 30.0, 90.0, 10.0, -60.0, -130.0, 70.0, -20.0, -10.0, 90.0, 70.0, 150.0, 230.0, 620.0, 120.0, 60.0, 320.0, 30.0, 20.0, 390.0, 10.0, 410.0, 80.0, 50.0, 120.0, 60.0, 610.0, 90.0, 140.0, 130.0, 60.0, -20.0, 60.0, 230.0, 160.0, 40.0, 0.0, 70.0, 20.0, 40.0, 40.0, 40.0, 160.0, 20.0, 90.0, 100.0, 110.0, 220.0, 20.0, -15.0, 120.0, 15.0, 60.0, 190.0, 370.0, 140.0, -30.0, 80.0, 100.0, 430.0, 230.0, 80.0, 60.0, 80.0, 60.0, 30.0, 40.0, 40.0, 140.0, 340.0, 400.0, -10.0, 190.0, 100.0, 25.0, 130.0, 60.0, 20.0, 30.0, 90.0, 150.0, 40.0, 350.0, 100.0, 20.0, 90.0, 160.0, 150.0, 20.0, 80.0, 210.0, 360.0, 20.0, 0.0, 80.0, 20.0, 70.0, 80.0, 290.0, 80.0, 90.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 90.0, 220.0, 40.0, 180.0, 30.0, 490.0, 200.0, 0.0, 25.0, 40.0, 80.0, 0.0, 5.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 5.0, 0.0, 130.0, 100.0, 10.0, 90.0, 100.0, 90.0, 40.0, 20.0, 60.0, 240.0, 0.0, 20.0, 90.0, 20.0, 80.0, -10.0, 0.0, 10.0, 110.0, 150.0, 220.0, 80.0, 290.0, 60.0, 70.0, 70.0, 30.0, 440.0, 80.0, 70.0, 25.0, 70.0, -20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 30.0, 20.0, -5.0, 10.0, 150.0, 10.0, 150.0, 210.0, 200.0, 10.0, 10.0, 60.0, 10.0, 40.0, 180.0, 40.0, -30.0, 210.0, 500.0, 50.0, 10.0, 20.0, 140.0, 0.0, 180.0, 120.0, -80.0, 40.0, 110.0, 120.0, 0.0, 410.0, 180.0, 210.0, 310.0, 60.0, 30.0, 100.0, 470.0, 30.0, 220.0, 10.0, 70.0, 10.0, 150.0, 60.0, 0.0, 90.0, 10.0, 50.0, 130.0, 30.0, 290.0, 70.0, 50.0, 220.0, 370.0, 70.0, 160.0, 0.0, 70.0, -240.0, 20.0, -50.0, 30.0, 60.0, 20.0, 10.0, 160.0, 80.0, 20.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5189149445407455, "mean_inference_ms": 1.4125273652783992, "mean_action_processing_ms": 0.4306243436382217, "mean_env_wait_ms": 1.2531105476980426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011537790298461914, "StateBufferConnector_ms": 0.00890660285949707, "ViewRequirementAgentConnector_ms": 0.3591933250427246}, "num_episodes": 23, "episode_return_max": 2750.0, "episode_return_min": 80.0, "episode_return_mean": 960.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.25886709812036, "num_env_steps_trained_throughput_per_sec": 21.25886709812036, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 3080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3080000, "timers": {"training_iteration_time_ms": 186605.09, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186605.043, "sample_time_ms": 2422.383, "learn_time_ms": 184163.747, "learn_throughput": 21.72, "synch_weights_time_ms": 11.003}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "done": false, "training_iteration": 77, "trial_id": "90816_00000", "date": "2024-06-10_04-13-43", "timestamp": 1718007223, "time_this_iter_s": 188.16731786727905, "time_total_s": 14501.2065243721, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327f340d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14501.2065243721, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 19.12293233082707, "ram_util_percent": 79.07669172932331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.405305440776264, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.469474341897284, "policy_loss": -0.008114875666598796, "vf_loss": 6.475989455283005, "vf_explained_var": 0.0006685491377553239, "kl": 0.005332517031443063, "entropy": 0.42066359091173217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 727725.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 2400.0, "episode_reward_min": 80.0, "episode_reward_mean": 943.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 990.0}, "policy_reward_mean": {"policy_0": 94.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1560.0, 910.0, 1275.0, 1550.0, 1175.0, 660.0, 860.0, 1215.0, 1265.0, 375.0, 750.0, 1150.0, 1710.0, 1240.0, 560.0, 470.0, 2400.0, 1290.0, 760.0, 750.0, 805.0, 1045.0, 1110.0, 660.0, 620.0, 520.0, 1100.0, 1050.0, 1335.0, 1070.0, 415.0, 1060.0, 180.0, 1155.0, 155.0, 840.0, 900.0, 2125.0, 880.0, 620.0, 890.0, 960.0, 620.0, 420.0, 800.0, 1070.0, 1300.0, 1790.0, 600.0, 270.0, 410.0, 1380.0, 500.0, 1510.0, 370.0, 1520.0, 740.0, 660.0, 1010.0, 1490.0, 1480.0, 590.0, 910.0, 1540.0, 1330.0, 995.0, 1110.0, 820.0, 190.0, 1305.0, 80.0, 880.0, 470.0, 1410.0, 295.0, 805.0, 1030.0, 1040.0, 1620.0, 600.0, 1060.0, 410.0, 930.0, 1520.0, 730.0, 1495.0, 630.0, 460.0, 1330.0, 1435.0, 1110.0, 925.0, 130.0, 190.0, 960.0, 100.0, 910.0, 1750.0, 1065.0, 830.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [300.0, -20.0, 20.0, 70.0, 60.0, 40.0, 140.0, 120.0, 470.0, 360.0, 80.0, 160.0, 20.0, 50.0, 120.0, 70.0, 40.0, 230.0, 90.0, 50.0, 50.0, 240.0, 110.0, 90.0, 80.0, 15.0, 150.0, 20.0, 550.0, -30.0, 0.0, 80.0, 740.0, 200.0, 30.0, 10.0, 40.0, 230.0, 150.0, 70.0, 90.0, 210.0, 45.0, 180.0, 360.0, 70.0, 60.0, 120.0, 40.0, 0.0, 100.0, 170.0, 0.0, 90.0, 150.0, 230.0, 40.0, 40.0, -230.0, 70.0, 190.0, 10.0, 20.0, 60.0, 450.0, 40.0, 30.0, 30.0, 30.0, 0.0, 30.0, 15.0, 140.0, 330.0, 100.0, 40.0, 100.0, 40.0, 360.0, 60.0, 20.0, 30.0, 60.0, 0.0, 155.0, 20.0, 130.0, 330.0, 200.0, 320.0, 10.0, 10.0, 50.0, -20.0, 30.0, 0.0, 70.0, -5.0, 230.0, 0.0, 70.0, 10.0, 210.0, 110.0, 40.0, 40.0, 160.0, 30.0, 80.0, 0.0, 40.0, 60.0, 50.0, 100.0, 310.0, 100.0, 40.0, 40.0, 160.0, 250.0, 10.0, 70.0, 460.0, 10.0, 200.0, 190.0, 270.0, 380.0, 150.0, -30.0, 50.0, 70.0, 90.0, 170.0, 0.0, -140.0, 580.0, 60.0, 310.0, 50.0, 20.0, -40.0, 20.0, 0.0, 40.0, 170.0, 290.0, 10.0, 20.0, 30.0, 90.0, 0.0, 20.0, 20.0, 150.0, 80.0, 10.0, 70.0, 30.0, 0.0, 100.0, -60.0, 70.0, 60.0, 180.0, 170.0, 490.0, 990.0, 60.0, 340.0, 10.0, 450.0, 390.0, 30.0, 0.0, 10.0, 150.0, 80.0, 100.0, 70.0, 30.0, 40.0, 90.0, 240.0, 60.0, 20.0, 60.0, 10.0, 150.0, 60.0, 20.0, 30.0, 90.0, 70.0, 140.0, 10.0, 100.0, 120.0, 160.0, 10.0, 10.0, 440.0, 10.0, 30.0, 20.0, 20.0, 10.0, 5.0, 150.0, 110.0, 10.0, 20.0, 130.0, -40.0, 450.0, 30.0, 60.0, 230.0, 105.0, 50.0, 400.0, 80.0, 80.0, 50.0, 110.0, 30.0, 70.0, 160.0, 50.0, 80.0, 30.0, 200.0, 60.0, -10.0, -100.0, 0.0, 30.0, 350.0, 0.0, 100.0, 30.0, 0.0, 90.0, 270.0, 0.0, 100.0, 0.0, 50.0, 70.0, 10.0, 40.0, 100.0, 30.0, 120.0, 30.0, 10.0, 30.0, 70.0, 70.0, 20.0, 180.0, 40.0, 20.0, 50.0, 90.0, 160.0, 80.0, 160.0, 230.0, 90.0, 40.0, 90.0, 220.0, 180.0, 220.0, 20.0, 110.0, 90.0, 40.0, 40.0, 20.0, 100.0, 300.0, 100.0, 320.0, 20.0, 50.0, 65.0, 60.0, 300.0, -40.0, 300.0, 90.0, 210.0, 60.0, 340.0, -30.0, 70.0, 70.0, 0.0, 30.0, 10.0, 20.0, 40.0, 35.0, 55.0, 140.0, 40.0, 0.0, 45.0, 160.0, 230.0, 60.0, 40.0, 320.0, 50.0, 60.0, 0.0, 60.0, 80.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 40.0, 10.0, 100.0, 200.0, 300.0, 35.0, 100.0, 70.0, 130.0, 20.0, 110.0, 90.0, 0.0, 10.0, 10.0, 60.0, 0.0, 10.0, 30.0, 10.0, 30.0, -5.0, 300.0, 190.0, 100.0, 60.0, 20.0, 0.0, 40.0, 20.0, 0.0, 110.0, 50.0, 50.0, 30.0, 70.0, 370.0, 20.0, 30.0, 20.0, 80.0, 180.0, -10.0, 900.0, 380.0, -25.0, 260.0, 100.0, 140.0, 20.0, 180.0, 180.0, 240.0, 20.0, 10.0, 60.0, 190.0, 90.0, 0.0, 70.0, 50.0, 150.0, 80.0, 180.0, 0.0, 40.0, 180.0, -40.0, 10.0, 0.0, 120.0, 50.0, 20.0, 100.0, 150.0, 30.0, 30.0, 270.0, 160.0, 10.0, 100.0, 20.0, 60.0, 25.0, 60.0, 45.0, 220.0, 90.0, 240.0, 60.0, 50.0, 110.0, 10.0, 50.0, 80.0, 230.0, 10.0, 20.0, 0.0, 50.0, 160.0, 10.0, 210.0, 0.0, 40.0, 0.0, 0.0, 60.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 390.0, 30.0, 140.0, 10.0, 20.0, 80.0, 30.0, 10.0, 170.0, 470.0, 40.0, 170.0, 60.0, 40.0, 30.0, 10.0, 30.0, 50.0, 180.0, 170.0, 60.0, 120.0, 100.0, 60.0, 10.0, 140.0, 370.0, 90.0, 90.0, 50.0, 340.0, 190.0, -80.0, 660.0, 210.0, 60.0, 210.0, 60.0, 80.0, 30.0, -30.0, 40.0, 10.0, -50.0, 40.0, 380.0, 60.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 80.0, 20.0, 20.0, 20.0, 70.0, 10.0, 0.0, 80.0, 10.0, 150.0, 10.0, 30.0, 110.0, 10.0, 0.0, 400.0, 130.0, 90.0, 20.0, 50.0, 40.0, 40.0, 50.0, 260.0, 300.0, 140.0, 40.0, 10.0, 30.0, 60.0, 10.0, 10.0, 180.0, 0.0, 20.0, 130.0, 30.0, 210.0, -40.0, 220.0, 200.0, 700.0, 20.0, 0.0, 40.0, 20.0, 40.0, 160.0, 70.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, -30.0, 30.0, 65.0, -30.0, 250.0, 30.0, 315.0, 350.0, 280.0, 260.0, -80.0, 400.0, 50.0, 150.0, 80.0, -80.0, 80.0, 60.0, 40.0, 40.0, 30.0, 10.0, 260.0, 150.0, 30.0, 30.0, 20.0, 30.0, 90.0, 10.0, -60.0, -130.0, 70.0, -20.0, -10.0, 90.0, 70.0, 150.0, 230.0, 620.0, 120.0, 60.0, 320.0, 30.0, 20.0, 390.0, 10.0, 410.0, 80.0, 50.0, 120.0, 60.0, 610.0, 90.0, 140.0, 130.0, 60.0, -20.0, 60.0, 230.0, 160.0, 40.0, 0.0, 70.0, 20.0, 40.0, 40.0, 40.0, 160.0, 20.0, 90.0, 100.0, 110.0, 220.0, 20.0, -15.0, 120.0, 15.0, 60.0, 190.0, 370.0, 140.0, -30.0, 80.0, 100.0, 430.0, 230.0, 80.0, 60.0, 80.0, 60.0, 30.0, 40.0, 40.0, 140.0, 340.0, 400.0, -10.0, 190.0, 100.0, 25.0, 130.0, 60.0, 20.0, 30.0, 90.0, 150.0, 40.0, 350.0, 100.0, 20.0, 90.0, 160.0, 150.0, 20.0, 80.0, 210.0, 360.0, 20.0, 0.0, 80.0, 20.0, 70.0, 80.0, 290.0, 80.0, 90.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 90.0, 220.0, 40.0, 180.0, 30.0, 490.0, 200.0, 0.0, 25.0, 40.0, 80.0, 0.0, 5.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 5.0, 0.0, 130.0, 100.0, 10.0, 90.0, 100.0, 90.0, 40.0, 20.0, 60.0, 240.0, 0.0, 20.0, 90.0, 20.0, 80.0, -10.0, 0.0, 10.0, 110.0, 150.0, 220.0, 80.0, 290.0, 60.0, 70.0, 70.0, 30.0, 440.0, 80.0, 70.0, 25.0, 70.0, -20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 30.0, 20.0, -5.0, 10.0, 150.0, 10.0, 150.0, 210.0, 200.0, 10.0, 10.0, 60.0, 10.0, 40.0, 180.0, 40.0, -30.0, 210.0, 500.0, 50.0, 10.0, 20.0, 140.0, 0.0, 180.0, 120.0, -80.0, 40.0, 110.0, 120.0, 0.0, 410.0, 180.0, 210.0, 310.0, 60.0, 30.0, 100.0, 470.0, 30.0, 220.0, 10.0, 70.0, 10.0, 150.0, 60.0, 0.0, 90.0, 10.0, 50.0, 130.0, 30.0, 290.0, 70.0, 50.0, 220.0, 370.0, 70.0, 160.0, 0.0, 70.0, -240.0, 20.0, -50.0, 30.0, 60.0, 20.0, 10.0, 160.0, 80.0, 20.0, 60.0, 240.0, 110.0, 80.0, 160.0, 40.0, 60.0, 110.0, 30.0, 80.0, 20.0, 100.0, 60.0, 540.0, 130.0, 60.0, 260.0, 80.0, 180.0, 70.0, 40.0, 60.0, 0.0, 40.0, 70.0, 40.0, 20.0, 200.0, 160.0, 60.0, 80.0, -100.0, 30.0, 70.0, 310.0, 10.0, 40.0, 670.0, 50.0, -10.0, 425.0, 10.0, 20.0, -40.0, 70.0, 40.0, 150.0, 150.0, 60.0, 100.0, 70.0, 40.0, 0.0, 10.0, 90.0, 200.0, 30.0, 10.0, 20.0, 10.0, 50.0, 90.0, 170.0, 90.0, 220.0, 10.0, 110.0, 90.0, 160.0, 160.0, 230.0, 420.0, 40.0, 60.0, 110.0, 160.0, 430.0, -30.0, 160.0, 35.0, 50.0, 100.0, 30.0, 210.0, 90.0, 50.0, 150.0, 140.0, 30.0, 120.0, 190.0, 80.0, -10.0, 320.0, 20.0, 270.0, 20.0, 15.0, 60.0, 20.0, 130.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 20.0, 10.0, -10.0, 10.0, 20.0, 10.0, 30.0, 5.0, 50.0, 60.0, 5.0, 90.0, 260.0, 190.0, 20.0, 190.0, 0.0, 20.0, 30.0, 90.0, 70.0, 10.0, 0.0, 10.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 150.0, 140.0, 160.0, 200.0, 10.0, 80.0, -50.0, 50.0, 160.0, 10.0, 250.0, 60.0, 140.0, 250.0, 200.0, 40.0, 80.0, -50.0, 110.0, 670.0, 310.0, 170.0, 130.0, -60.0, 150.0, 190.0, 10.0, 80.0, 75.0, 10.0, 150.0, 50.0, 20.0, 130.0, 260.0, 20.0, 130.0, 30.0, 10.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.518327150840642, "mean_inference_ms": 1.4123696273219735, "mean_action_processing_ms": 0.43002497829648606, "mean_env_wait_ms": 1.2527442444142236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011644124984741211, "StateBufferConnector_ms": 0.009062767028808594, "ViewRequirementAgentConnector_ms": 0.3695540428161621}, "num_episodes": 18, "episode_return_max": 2400.0, "episode_return_min": 80.0, "episode_return_mean": 943.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.42233668750089, "num_env_steps_trained_throughput_per_sec": 21.42233668750089, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 186801.046, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186801.001, "sample_time_ms": 2434.77, "learn_time_ms": 184347.31, "learn_throughput": 21.698, "synch_weights_time_ms": 11.253}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 78, "trial_id": "90816_00000", "date": "2024-06-10_04-16-50", "timestamp": 1718007410, "time_this_iter_s": 186.74544715881348, "time_total_s": 14687.951971530914, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0040310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14687.951971530914, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.65265151515151, "ram_util_percent": 79.01590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.27829918441808, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007888258644131719, "vf_loss": 7.475918010756358, "vf_explained_var": -0.00026074824368737886, "kl": Infinity, "entropy": 0.4081633942132306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 737115.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "env_runners": {"episode_reward_max": 2125.0, "episode_reward_min": 80.0, "episode_reward_mean": 916.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 91.68}, "custom_metrics": {}, "hist_stats": {"episode_reward": [760.0, 750.0, 805.0, 1045.0, 1110.0, 660.0, 620.0, 520.0, 1100.0, 1050.0, 1335.0, 1070.0, 415.0, 1060.0, 180.0, 1155.0, 155.0, 840.0, 900.0, 2125.0, 880.0, 620.0, 890.0, 960.0, 620.0, 420.0, 800.0, 1070.0, 1300.0, 1790.0, 600.0, 270.0, 410.0, 1380.0, 500.0, 1510.0, 370.0, 1520.0, 740.0, 660.0, 1010.0, 1490.0, 1480.0, 590.0, 910.0, 1540.0, 1330.0, 995.0, 1110.0, 820.0, 190.0, 1305.0, 80.0, 880.0, 470.0, 1410.0, 295.0, 805.0, 1030.0, 1040.0, 1620.0, 600.0, 1060.0, 410.0, 930.0, 1520.0, 730.0, 1495.0, 630.0, 460.0, 1330.0, 1435.0, 1110.0, 925.0, 130.0, 190.0, 960.0, 100.0, 910.0, 1750.0, 1065.0, 830.0, 980.0, 750.0, 605.0, 1140.0, 870.0, 1015.0, 325.0, 610.0, 1285.0, 650.0, 1165.0, 1140.0, 1760.0, 470.0, 790.0, 940.0, 1260.0, 1990.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 40.0, 90.0, 240.0, 60.0, 20.0, 60.0, 10.0, 150.0, 60.0, 20.0, 30.0, 90.0, 70.0, 140.0, 10.0, 100.0, 120.0, 160.0, 10.0, 10.0, 440.0, 10.0, 30.0, 20.0, 20.0, 10.0, 5.0, 150.0, 110.0, 10.0, 20.0, 130.0, -40.0, 450.0, 30.0, 60.0, 230.0, 105.0, 50.0, 400.0, 80.0, 80.0, 50.0, 110.0, 30.0, 70.0, 160.0, 50.0, 80.0, 30.0, 200.0, 60.0, -10.0, -100.0, 0.0, 30.0, 350.0, 0.0, 100.0, 30.0, 0.0, 90.0, 270.0, 0.0, 100.0, 0.0, 50.0, 70.0, 10.0, 40.0, 100.0, 30.0, 120.0, 30.0, 10.0, 30.0, 70.0, 70.0, 20.0, 180.0, 40.0, 20.0, 50.0, 90.0, 160.0, 80.0, 160.0, 230.0, 90.0, 40.0, 90.0, 220.0, 180.0, 220.0, 20.0, 110.0, 90.0, 40.0, 40.0, 20.0, 100.0, 300.0, 100.0, 320.0, 20.0, 50.0, 65.0, 60.0, 300.0, -40.0, 300.0, 90.0, 210.0, 60.0, 340.0, -30.0, 70.0, 70.0, 0.0, 30.0, 10.0, 20.0, 40.0, 35.0, 55.0, 140.0, 40.0, 0.0, 45.0, 160.0, 230.0, 60.0, 40.0, 320.0, 50.0, 60.0, 0.0, 60.0, 80.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 40.0, 10.0, 100.0, 200.0, 300.0, 35.0, 100.0, 70.0, 130.0, 20.0, 110.0, 90.0, 0.0, 10.0, 10.0, 60.0, 0.0, 10.0, 30.0, 10.0, 30.0, -5.0, 300.0, 190.0, 100.0, 60.0, 20.0, 0.0, 40.0, 20.0, 0.0, 110.0, 50.0, 50.0, 30.0, 70.0, 370.0, 20.0, 30.0, 20.0, 80.0, 180.0, -10.0, 900.0, 380.0, -25.0, 260.0, 100.0, 140.0, 20.0, 180.0, 180.0, 240.0, 20.0, 10.0, 60.0, 190.0, 90.0, 0.0, 70.0, 50.0, 150.0, 80.0, 180.0, 0.0, 40.0, 180.0, -40.0, 10.0, 0.0, 120.0, 50.0, 20.0, 100.0, 150.0, 30.0, 30.0, 270.0, 160.0, 10.0, 100.0, 20.0, 60.0, 25.0, 60.0, 45.0, 220.0, 90.0, 240.0, 60.0, 50.0, 110.0, 10.0, 50.0, 80.0, 230.0, 10.0, 20.0, 0.0, 50.0, 160.0, 10.0, 210.0, 0.0, 40.0, 0.0, 0.0, 60.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 390.0, 30.0, 140.0, 10.0, 20.0, 80.0, 30.0, 10.0, 170.0, 470.0, 40.0, 170.0, 60.0, 40.0, 30.0, 10.0, 30.0, 50.0, 180.0, 170.0, 60.0, 120.0, 100.0, 60.0, 10.0, 140.0, 370.0, 90.0, 90.0, 50.0, 340.0, 190.0, -80.0, 660.0, 210.0, 60.0, 210.0, 60.0, 80.0, 30.0, -30.0, 40.0, 10.0, -50.0, 40.0, 380.0, 60.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 80.0, 20.0, 20.0, 20.0, 70.0, 10.0, 0.0, 80.0, 10.0, 150.0, 10.0, 30.0, 110.0, 10.0, 0.0, 400.0, 130.0, 90.0, 20.0, 50.0, 40.0, 40.0, 50.0, 260.0, 300.0, 140.0, 40.0, 10.0, 30.0, 60.0, 10.0, 10.0, 180.0, 0.0, 20.0, 130.0, 30.0, 210.0, -40.0, 220.0, 200.0, 700.0, 20.0, 0.0, 40.0, 20.0, 40.0, 160.0, 70.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, -30.0, 30.0, 65.0, -30.0, 250.0, 30.0, 315.0, 350.0, 280.0, 260.0, -80.0, 400.0, 50.0, 150.0, 80.0, -80.0, 80.0, 60.0, 40.0, 40.0, 30.0, 10.0, 260.0, 150.0, 30.0, 30.0, 20.0, 30.0, 90.0, 10.0, -60.0, -130.0, 70.0, -20.0, -10.0, 90.0, 70.0, 150.0, 230.0, 620.0, 120.0, 60.0, 320.0, 30.0, 20.0, 390.0, 10.0, 410.0, 80.0, 50.0, 120.0, 60.0, 610.0, 90.0, 140.0, 130.0, 60.0, -20.0, 60.0, 230.0, 160.0, 40.0, 0.0, 70.0, 20.0, 40.0, 40.0, 40.0, 160.0, 20.0, 90.0, 100.0, 110.0, 220.0, 20.0, -15.0, 120.0, 15.0, 60.0, 190.0, 370.0, 140.0, -30.0, 80.0, 100.0, 430.0, 230.0, 80.0, 60.0, 80.0, 60.0, 30.0, 40.0, 40.0, 140.0, 340.0, 400.0, -10.0, 190.0, 100.0, 25.0, 130.0, 60.0, 20.0, 30.0, 90.0, 150.0, 40.0, 350.0, 100.0, 20.0, 90.0, 160.0, 150.0, 20.0, 80.0, 210.0, 360.0, 20.0, 0.0, 80.0, 20.0, 70.0, 80.0, 290.0, 80.0, 90.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 90.0, 220.0, 40.0, 180.0, 30.0, 490.0, 200.0, 0.0, 25.0, 40.0, 80.0, 0.0, 5.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 5.0, 0.0, 130.0, 100.0, 10.0, 90.0, 100.0, 90.0, 40.0, 20.0, 60.0, 240.0, 0.0, 20.0, 90.0, 20.0, 80.0, -10.0, 0.0, 10.0, 110.0, 150.0, 220.0, 80.0, 290.0, 60.0, 70.0, 70.0, 30.0, 440.0, 80.0, 70.0, 25.0, 70.0, -20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 30.0, 20.0, -5.0, 10.0, 150.0, 10.0, 150.0, 210.0, 200.0, 10.0, 10.0, 60.0, 10.0, 40.0, 180.0, 40.0, -30.0, 210.0, 500.0, 50.0, 10.0, 20.0, 140.0, 0.0, 180.0, 120.0, -80.0, 40.0, 110.0, 120.0, 0.0, 410.0, 180.0, 210.0, 310.0, 60.0, 30.0, 100.0, 470.0, 30.0, 220.0, 10.0, 70.0, 10.0, 150.0, 60.0, 0.0, 90.0, 10.0, 50.0, 130.0, 30.0, 290.0, 70.0, 50.0, 220.0, 370.0, 70.0, 160.0, 0.0, 70.0, -240.0, 20.0, -50.0, 30.0, 60.0, 20.0, 10.0, 160.0, 80.0, 20.0, 60.0, 240.0, 110.0, 80.0, 160.0, 40.0, 60.0, 110.0, 30.0, 80.0, 20.0, 100.0, 60.0, 540.0, 130.0, 60.0, 260.0, 80.0, 180.0, 70.0, 40.0, 60.0, 0.0, 40.0, 70.0, 40.0, 20.0, 200.0, 160.0, 60.0, 80.0, -100.0, 30.0, 70.0, 310.0, 10.0, 40.0, 670.0, 50.0, -10.0, 425.0, 10.0, 20.0, -40.0, 70.0, 40.0, 150.0, 150.0, 60.0, 100.0, 70.0, 40.0, 0.0, 10.0, 90.0, 200.0, 30.0, 10.0, 20.0, 10.0, 50.0, 90.0, 170.0, 90.0, 220.0, 10.0, 110.0, 90.0, 160.0, 160.0, 230.0, 420.0, 40.0, 60.0, 110.0, 160.0, 430.0, -30.0, 160.0, 35.0, 50.0, 100.0, 30.0, 210.0, 90.0, 50.0, 150.0, 140.0, 30.0, 120.0, 190.0, 80.0, -10.0, 320.0, 20.0, 270.0, 20.0, 15.0, 60.0, 20.0, 130.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 20.0, 10.0, -10.0, 10.0, 20.0, 10.0, 30.0, 5.0, 50.0, 60.0, 5.0, 90.0, 260.0, 190.0, 20.0, 190.0, 0.0, 20.0, 30.0, 90.0, 70.0, 10.0, 0.0, 10.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 150.0, 140.0, 160.0, 200.0, 10.0, 80.0, -50.0, 50.0, 160.0, 10.0, 250.0, 60.0, 140.0, 250.0, 200.0, 40.0, 80.0, -50.0, 110.0, 670.0, 310.0, 170.0, 130.0, -60.0, 150.0, 190.0, 10.0, 80.0, 75.0, 10.0, 150.0, 50.0, 20.0, 130.0, 260.0, 20.0, 130.0, 30.0, 10.0, 30.0, 50.0, 30.0, 25.0, 120.0, 30.0, 20.0, -5.0, 360.0, 190.0, 160.0, 30.0, 10.0, 240.0, 90.0, 30.0, 20.0, 30.0, 80.0, 120.0, 100.0, -30.0, 60.0, 40.0, 40.0, -45.0, 60.0, 300.0, 150.0, 20.0, 10.0, 160.0, 30.0, 30.0, 50.0, 180.0, 160.0, 100.0, 50.0, 390.0, -10.0, 370.0, 30.0, 20.0, 50.0, 200.0, 100.0, 0.0, 100.0, 30.0, -30.0, 340.0, -10.0, 40.0, 30.0, 115.0, 90.0, 60.0, 40.0, 80.0, 230.0, 10.0, 280.0, -55.0, -20.0, 10.0, 220.0, -10.0, -20.0, -40.0, -50.0, 70.0, 110.0, 20.0, 20.0, 80.0, 150.0, 20.0, 60.0, 40.0, 40.0, 320.0, 90.0, 50.0, 220.0, -25.0, 90.0, 120.0, 120.0, 130.0, 170.0, 10.0, 70.0, 80.0, 150.0, 0.0, 130.0, 80.0, 70.0, 30.0, 30.0, 70.0, 40.0, 320.0, 10.0, 15.0, 160.0, 180.0, 60.0, 210.0, 100.0, -30.0, -60.0, -20.0, 1010.0, 20.0, 60.0, 10.0, 70.0, -80.0, 160.0, 180.0, 130.0, 10.0, 90.0, -40.0, 250.0, 150.0, 160.0, 80.0, 750.0, 170.0, 50.0, 0.0, 10.0, 50.0, 0.0, 70.0, 0.0, 40.0, 80.0, 80.0, 80.0, 10.0, 90.0, 70.0, 110.0, 40.0, 270.0, 20.0, 20.0, 210.0, 190.0, 320.0, -240.0, 90.0, 60.0, 80.0, 130.0, 40.0, 60.0, 110.0, 190.0, 100.0, 0.0, 120.0, 30.0, 150.0, 70.0, 170.0, 320.0, 270.0, 430.0, 65.0, 90.0, -15.0, 170.0, 920.0, -140.0, 60.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5177111051756853, "mean_inference_ms": 1.4123496170930852, "mean_action_processing_ms": 0.4294652886973611, "mean_env_wait_ms": 1.2524398619685397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011658430099487305, "StateBufferConnector_ms": 0.009099245071411133, "ViewRequirementAgentConnector_ms": 0.37094974517822266}, "num_episodes": 18, "episode_return_max": 2125.0, "episode_return_min": 80.0, "episode_return_mean": 916.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.53671481795362, "num_env_steps_trained_throughput_per_sec": 21.53671481795362, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 3160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3160000, "timers": {"training_iteration_time_ms": 186768.332, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186768.287, "sample_time_ms": 2431.256, "learn_time_ms": 184318.199, "learn_throughput": 21.702, "synch_weights_time_ms": 11.092}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "done": false, "training_iteration": 79, "trial_id": "90816_00000", "date": "2024-06-10_04-19-56", "timestamp": 1718007596, "time_this_iter_s": 185.73917984962463, "time_total_s": 14873.691151380539, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b006c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14873.691151380539, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 17.31406844106464, "ram_util_percent": 78.94524714828898}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.59939662258719, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.787543205966076, "policy_loss": -0.008758653585349743, "vf_loss": 6.794226598536499, "vf_explained_var": -0.0007145161001573102, "kl": 0.004611684226835603, "entropy": 0.4343003625242601, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 746505.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 1990.0, "episode_reward_min": -30.0, "episode_reward_mean": 914.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 91.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [890.0, 960.0, 620.0, 420.0, 800.0, 1070.0, 1300.0, 1790.0, 600.0, 270.0, 410.0, 1380.0, 500.0, 1510.0, 370.0, 1520.0, 740.0, 660.0, 1010.0, 1490.0, 1480.0, 590.0, 910.0, 1540.0, 1330.0, 995.0, 1110.0, 820.0, 190.0, 1305.0, 80.0, 880.0, 470.0, 1410.0, 295.0, 805.0, 1030.0, 1040.0, 1620.0, 600.0, 1060.0, 410.0, 930.0, 1520.0, 730.0, 1495.0, 630.0, 460.0, 1330.0, 1435.0, 1110.0, 925.0, 130.0, 190.0, 960.0, 100.0, 910.0, 1750.0, 1065.0, 830.0, 980.0, 750.0, 605.0, 1140.0, 870.0, 1015.0, 325.0, 610.0, 1285.0, 650.0, 1165.0, 1140.0, 1760.0, 470.0, 790.0, 940.0, 1260.0, 1990.0, 1480.0, 1450.0, 890.0, 750.0, 1015.0, 790.0, 815.0, 500.0, -30.0, 1035.0, 545.0, 1065.0, 730.0, 500.0, 1445.0, 500.0, 565.0, 1145.0, 1410.0, 1100.0, 450.0, 770.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 100.0, 150.0, 30.0, 30.0, 270.0, 160.0, 10.0, 100.0, 20.0, 60.0, 25.0, 60.0, 45.0, 220.0, 90.0, 240.0, 60.0, 50.0, 110.0, 10.0, 50.0, 80.0, 230.0, 10.0, 20.0, 0.0, 50.0, 160.0, 10.0, 210.0, 0.0, 40.0, 0.0, 0.0, 60.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 390.0, 30.0, 140.0, 10.0, 20.0, 80.0, 30.0, 10.0, 170.0, 470.0, 40.0, 170.0, 60.0, 40.0, 30.0, 10.0, 30.0, 50.0, 180.0, 170.0, 60.0, 120.0, 100.0, 60.0, 10.0, 140.0, 370.0, 90.0, 90.0, 50.0, 340.0, 190.0, -80.0, 660.0, 210.0, 60.0, 210.0, 60.0, 80.0, 30.0, -30.0, 40.0, 10.0, -50.0, 40.0, 380.0, 60.0, 40.0, 20.0, 10.0, 10.0, 0.0, 20.0, 80.0, 20.0, 20.0, 20.0, 70.0, 10.0, 0.0, 80.0, 10.0, 150.0, 10.0, 30.0, 110.0, 10.0, 0.0, 400.0, 130.0, 90.0, 20.0, 50.0, 40.0, 40.0, 50.0, 260.0, 300.0, 140.0, 40.0, 10.0, 30.0, 60.0, 10.0, 10.0, 180.0, 0.0, 20.0, 130.0, 30.0, 210.0, -40.0, 220.0, 200.0, 700.0, 20.0, 0.0, 40.0, 20.0, 40.0, 160.0, 70.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, -30.0, 30.0, 65.0, -30.0, 250.0, 30.0, 315.0, 350.0, 280.0, 260.0, -80.0, 400.0, 50.0, 150.0, 80.0, -80.0, 80.0, 60.0, 40.0, 40.0, 30.0, 10.0, 260.0, 150.0, 30.0, 30.0, 20.0, 30.0, 90.0, 10.0, -60.0, -130.0, 70.0, -20.0, -10.0, 90.0, 70.0, 150.0, 230.0, 620.0, 120.0, 60.0, 320.0, 30.0, 20.0, 390.0, 10.0, 410.0, 80.0, 50.0, 120.0, 60.0, 610.0, 90.0, 140.0, 130.0, 60.0, -20.0, 60.0, 230.0, 160.0, 40.0, 0.0, 70.0, 20.0, 40.0, 40.0, 40.0, 160.0, 20.0, 90.0, 100.0, 110.0, 220.0, 20.0, -15.0, 120.0, 15.0, 60.0, 190.0, 370.0, 140.0, -30.0, 80.0, 100.0, 430.0, 230.0, 80.0, 60.0, 80.0, 60.0, 30.0, 40.0, 40.0, 140.0, 340.0, 400.0, -10.0, 190.0, 100.0, 25.0, 130.0, 60.0, 20.0, 30.0, 90.0, 150.0, 40.0, 350.0, 100.0, 20.0, 90.0, 160.0, 150.0, 20.0, 80.0, 210.0, 360.0, 20.0, 0.0, 80.0, 20.0, 70.0, 80.0, 290.0, 80.0, 90.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 90.0, 220.0, 40.0, 180.0, 30.0, 490.0, 200.0, 0.0, 25.0, 40.0, 80.0, 0.0, 5.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 5.0, 0.0, 130.0, 100.0, 10.0, 90.0, 100.0, 90.0, 40.0, 20.0, 60.0, 240.0, 0.0, 20.0, 90.0, 20.0, 80.0, -10.0, 0.0, 10.0, 110.0, 150.0, 220.0, 80.0, 290.0, 60.0, 70.0, 70.0, 30.0, 440.0, 80.0, 70.0, 25.0, 70.0, -20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 30.0, 20.0, -5.0, 10.0, 150.0, 10.0, 150.0, 210.0, 200.0, 10.0, 10.0, 60.0, 10.0, 40.0, 180.0, 40.0, -30.0, 210.0, 500.0, 50.0, 10.0, 20.0, 140.0, 0.0, 180.0, 120.0, -80.0, 40.0, 110.0, 120.0, 0.0, 410.0, 180.0, 210.0, 310.0, 60.0, 30.0, 100.0, 470.0, 30.0, 220.0, 10.0, 70.0, 10.0, 150.0, 60.0, 0.0, 90.0, 10.0, 50.0, 130.0, 30.0, 290.0, 70.0, 50.0, 220.0, 370.0, 70.0, 160.0, 0.0, 70.0, -240.0, 20.0, -50.0, 30.0, 60.0, 20.0, 10.0, 160.0, 80.0, 20.0, 60.0, 240.0, 110.0, 80.0, 160.0, 40.0, 60.0, 110.0, 30.0, 80.0, 20.0, 100.0, 60.0, 540.0, 130.0, 60.0, 260.0, 80.0, 180.0, 70.0, 40.0, 60.0, 0.0, 40.0, 70.0, 40.0, 20.0, 200.0, 160.0, 60.0, 80.0, -100.0, 30.0, 70.0, 310.0, 10.0, 40.0, 670.0, 50.0, -10.0, 425.0, 10.0, 20.0, -40.0, 70.0, 40.0, 150.0, 150.0, 60.0, 100.0, 70.0, 40.0, 0.0, 10.0, 90.0, 200.0, 30.0, 10.0, 20.0, 10.0, 50.0, 90.0, 170.0, 90.0, 220.0, 10.0, 110.0, 90.0, 160.0, 160.0, 230.0, 420.0, 40.0, 60.0, 110.0, 160.0, 430.0, -30.0, 160.0, 35.0, 50.0, 100.0, 30.0, 210.0, 90.0, 50.0, 150.0, 140.0, 30.0, 120.0, 190.0, 80.0, -10.0, 320.0, 20.0, 270.0, 20.0, 15.0, 60.0, 20.0, 130.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 20.0, 10.0, -10.0, 10.0, 20.0, 10.0, 30.0, 5.0, 50.0, 60.0, 5.0, 90.0, 260.0, 190.0, 20.0, 190.0, 0.0, 20.0, 30.0, 90.0, 70.0, 10.0, 0.0, 10.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 150.0, 140.0, 160.0, 200.0, 10.0, 80.0, -50.0, 50.0, 160.0, 10.0, 250.0, 60.0, 140.0, 250.0, 200.0, 40.0, 80.0, -50.0, 110.0, 670.0, 310.0, 170.0, 130.0, -60.0, 150.0, 190.0, 10.0, 80.0, 75.0, 10.0, 150.0, 50.0, 20.0, 130.0, 260.0, 20.0, 130.0, 30.0, 10.0, 30.0, 50.0, 30.0, 25.0, 120.0, 30.0, 20.0, -5.0, 360.0, 190.0, 160.0, 30.0, 10.0, 240.0, 90.0, 30.0, 20.0, 30.0, 80.0, 120.0, 100.0, -30.0, 60.0, 40.0, 40.0, -45.0, 60.0, 300.0, 150.0, 20.0, 10.0, 160.0, 30.0, 30.0, 50.0, 180.0, 160.0, 100.0, 50.0, 390.0, -10.0, 370.0, 30.0, 20.0, 50.0, 200.0, 100.0, 0.0, 100.0, 30.0, -30.0, 340.0, -10.0, 40.0, 30.0, 115.0, 90.0, 60.0, 40.0, 80.0, 230.0, 10.0, 280.0, -55.0, -20.0, 10.0, 220.0, -10.0, -20.0, -40.0, -50.0, 70.0, 110.0, 20.0, 20.0, 80.0, 150.0, 20.0, 60.0, 40.0, 40.0, 320.0, 90.0, 50.0, 220.0, -25.0, 90.0, 120.0, 120.0, 130.0, 170.0, 10.0, 70.0, 80.0, 150.0, 0.0, 130.0, 80.0, 70.0, 30.0, 30.0, 70.0, 40.0, 320.0, 10.0, 15.0, 160.0, 180.0, 60.0, 210.0, 100.0, -30.0, -60.0, -20.0, 1010.0, 20.0, 60.0, 10.0, 70.0, -80.0, 160.0, 180.0, 130.0, 10.0, 90.0, -40.0, 250.0, 150.0, 160.0, 80.0, 750.0, 170.0, 50.0, 0.0, 10.0, 50.0, 0.0, 70.0, 0.0, 40.0, 80.0, 80.0, 80.0, 10.0, 90.0, 70.0, 110.0, 40.0, 270.0, 20.0, 20.0, 210.0, 190.0, 320.0, -240.0, 90.0, 60.0, 80.0, 130.0, 40.0, 60.0, 110.0, 190.0, 100.0, 0.0, 120.0, 30.0, 150.0, 70.0, 170.0, 320.0, 270.0, 430.0, 65.0, 90.0, -15.0, 170.0, 920.0, -140.0, 60.0, 140.0, 200.0, 140.0, 200.0, 160.0, 80.0, 480.0, 60.0, 20.0, 20.0, 120.0, 270.0, 20.0, 220.0, 10.0, 10.0, 50.0, 770.0, 10.0, 40.0, 50.0, -10.0, 15.0, 40.0, 480.0, 0.0, 100.0, 180.0, 20.0, 70.0, -5.0, 30.0, 40.0, -50.0, 60.0, 30.0, 60.0, 200.0, 40.0, 290.0, 50.0, 10.0, 190.0, 30.0, 70.0, 40.0, 220.0, 310.0, 20.0, 25.0, 100.0, 40.0, 80.0, 80.0, 120.0, 70.0, 40.0, 70.0, 160.0, 30.0, 100.0, 20.0, 10.0, 70.0, 130.0, 150.0, 10.0, 60.0, 25.0, 140.0, 200.0, 20.0, 80.0, 30.0, 10.0, 40.0, 40.0, 120.0, -20.0, 10.0, 170.0, 40.0, 0.0, 0.0, 30.0, -15.0, 5.0, 0.0, 0.0, 0.0, -90.0, 50.0, 125.0, 90.0, 110.0, 180.0, 80.0, 40.0, 190.0, 160.0, 10.0, 470.0, 40.0, 0.0, 30.0, -50.0, -125.0, 130.0, 30.0, 10.0, 10.0, 130.0, 50.0, 60.0, 70.0, 90.0, 110.0, 25.0, 260.0, 50.0, 220.0, -10.0, 10.0, 50.0, 80.0, 70.0, 230.0, 40.0, 30.0, 70.0, 160.0, 20.0, 50.0, 170.0, 10.0, 25.0, 0.0, 200.0, 20.0, 5.0, 0.0, 230.0, 80.0, -15.0, 580.0, 0.0, 170.0, 180.0, -10.0, 80.0, 150.0, 10.0, 90.0, 30.0, 10.0, 120.0, 10.0, 50.0, 140.0, 40.0, 0.0, 40.0, 50.0, 30.0, 50.0, 270.0, 30.0, 10.0, 40.0, 95.0, -50.0, 40.0, 530.0, 50.0, 120.0, 30.0, -125.0, 210.0, 220.0, -10.0, 80.0, 300.0, 40.0, 410.0, 80.0, 120.0, 30.0, 170.0, 130.0, 80.0, 50.0, 80.0, 100.0, 380.0, 80.0, 110.0, 260.0, 60.0, 20.0, -30.0, 40.0, 100.0, 10.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 0.0, 190.0, 10.0, 80.0, 60.0, 150.0, 20.0, 40.0, 80.0, 110.0, 30.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5169436493586985, "mean_inference_ms": 1.4122559417651146, "mean_action_processing_ms": 0.4288237743678035, "mean_env_wait_ms": 1.2521878857946214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011671066284179688, "StateBufferConnector_ms": 0.009307861328125, "ViewRequirementAgentConnector_ms": 0.3719003200531006}, "num_episodes": 22, "episode_return_max": 1990.0, "episode_return_min": -30.0, "episode_return_mean": 914.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.215043023710134, "num_env_steps_trained_throughput_per_sec": 21.215043023710134, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 187124.915, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187124.87, "sample_time_ms": 2445.62, "learn_time_ms": 184660.364, "learn_throughput": 21.661, "synch_weights_time_ms": 11.247}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": false, "training_iteration": 80, "trial_id": "90816_00000", "date": "2024-06-10_04-23-04", "timestamp": 1718007784, "time_this_iter_s": 188.55498504638672, "time_total_s": 15062.246136426926, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b012fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15062.246136426926, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 20.103007518796993, "ram_util_percent": 79.43233082706767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4259458880581923, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007803626202767927, "vf_loss": 6.545846700414428, "vf_explained_var": -0.0003580962697537943, "kl": Infinity, "entropy": 0.43269250048869967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 755895.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "env_runners": {"episode_reward_max": 1990.0, "episode_reward_min": -30.0, "episode_reward_mean": 935.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 93.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1010.0, 1490.0, 1480.0, 590.0, 910.0, 1540.0, 1330.0, 995.0, 1110.0, 820.0, 190.0, 1305.0, 80.0, 880.0, 470.0, 1410.0, 295.0, 805.0, 1030.0, 1040.0, 1620.0, 600.0, 1060.0, 410.0, 930.0, 1520.0, 730.0, 1495.0, 630.0, 460.0, 1330.0, 1435.0, 1110.0, 925.0, 130.0, 190.0, 960.0, 100.0, 910.0, 1750.0, 1065.0, 830.0, 980.0, 750.0, 605.0, 1140.0, 870.0, 1015.0, 325.0, 610.0, 1285.0, 650.0, 1165.0, 1140.0, 1760.0, 470.0, 790.0, 940.0, 1260.0, 1990.0, 1480.0, 1450.0, 890.0, 750.0, 1015.0, 790.0, 815.0, 500.0, -30.0, 1035.0, 545.0, 1065.0, 730.0, 500.0, 1445.0, 500.0, 565.0, 1145.0, 1410.0, 1100.0, 450.0, 770.0, 615.0, 1320.0, 270.0, 820.0, 890.0, 1020.0, 1945.0, 1190.0, 1640.0, 980.0, 1150.0, 175.0, 1150.0, 810.0, 965.0, 800.0, 1105.0, 1075.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-60.0, -130.0, 70.0, -20.0, -10.0, 90.0, 70.0, 150.0, 230.0, 620.0, 120.0, 60.0, 320.0, 30.0, 20.0, 390.0, 10.0, 410.0, 80.0, 50.0, 120.0, 60.0, 610.0, 90.0, 140.0, 130.0, 60.0, -20.0, 60.0, 230.0, 160.0, 40.0, 0.0, 70.0, 20.0, 40.0, 40.0, 40.0, 160.0, 20.0, 90.0, 100.0, 110.0, 220.0, 20.0, -15.0, 120.0, 15.0, 60.0, 190.0, 370.0, 140.0, -30.0, 80.0, 100.0, 430.0, 230.0, 80.0, 60.0, 80.0, 60.0, 30.0, 40.0, 40.0, 140.0, 340.0, 400.0, -10.0, 190.0, 100.0, 25.0, 130.0, 60.0, 20.0, 30.0, 90.0, 150.0, 40.0, 350.0, 100.0, 20.0, 90.0, 160.0, 150.0, 20.0, 80.0, 210.0, 360.0, 20.0, 0.0, 80.0, 20.0, 70.0, 80.0, 290.0, 80.0, 90.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 90.0, 220.0, 40.0, 180.0, 30.0, 490.0, 200.0, 0.0, 25.0, 40.0, 80.0, 0.0, 5.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 5.0, 0.0, 130.0, 100.0, 10.0, 90.0, 100.0, 90.0, 40.0, 20.0, 60.0, 240.0, 0.0, 20.0, 90.0, 20.0, 80.0, -10.0, 0.0, 10.0, 110.0, 150.0, 220.0, 80.0, 290.0, 60.0, 70.0, 70.0, 30.0, 440.0, 80.0, 70.0, 25.0, 70.0, -20.0, 10.0, 40.0, 40.0, 40.0, 40.0, 30.0, 20.0, -5.0, 10.0, 150.0, 10.0, 150.0, 210.0, 200.0, 10.0, 10.0, 60.0, 10.0, 40.0, 180.0, 40.0, -30.0, 210.0, 500.0, 50.0, 10.0, 20.0, 140.0, 0.0, 180.0, 120.0, -80.0, 40.0, 110.0, 120.0, 0.0, 410.0, 180.0, 210.0, 310.0, 60.0, 30.0, 100.0, 470.0, 30.0, 220.0, 10.0, 70.0, 10.0, 150.0, 60.0, 0.0, 90.0, 10.0, 50.0, 130.0, 30.0, 290.0, 70.0, 50.0, 220.0, 370.0, 70.0, 160.0, 0.0, 70.0, -240.0, 20.0, -50.0, 30.0, 60.0, 20.0, 10.0, 160.0, 80.0, 20.0, 60.0, 240.0, 110.0, 80.0, 160.0, 40.0, 60.0, 110.0, 30.0, 80.0, 20.0, 100.0, 60.0, 540.0, 130.0, 60.0, 260.0, 80.0, 180.0, 70.0, 40.0, 60.0, 0.0, 40.0, 70.0, 40.0, 20.0, 200.0, 160.0, 60.0, 80.0, -100.0, 30.0, 70.0, 310.0, 10.0, 40.0, 670.0, 50.0, -10.0, 425.0, 10.0, 20.0, -40.0, 70.0, 40.0, 150.0, 150.0, 60.0, 100.0, 70.0, 40.0, 0.0, 10.0, 90.0, 200.0, 30.0, 10.0, 20.0, 10.0, 50.0, 90.0, 170.0, 90.0, 220.0, 10.0, 110.0, 90.0, 160.0, 160.0, 230.0, 420.0, 40.0, 60.0, 110.0, 160.0, 430.0, -30.0, 160.0, 35.0, 50.0, 100.0, 30.0, 210.0, 90.0, 50.0, 150.0, 140.0, 30.0, 120.0, 190.0, 80.0, -10.0, 320.0, 20.0, 270.0, 20.0, 15.0, 60.0, 20.0, 130.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 20.0, 10.0, -10.0, 10.0, 20.0, 10.0, 30.0, 5.0, 50.0, 60.0, 5.0, 90.0, 260.0, 190.0, 20.0, 190.0, 0.0, 20.0, 30.0, 90.0, 70.0, 10.0, 0.0, 10.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 150.0, 140.0, 160.0, 200.0, 10.0, 80.0, -50.0, 50.0, 160.0, 10.0, 250.0, 60.0, 140.0, 250.0, 200.0, 40.0, 80.0, -50.0, 110.0, 670.0, 310.0, 170.0, 130.0, -60.0, 150.0, 190.0, 10.0, 80.0, 75.0, 10.0, 150.0, 50.0, 20.0, 130.0, 260.0, 20.0, 130.0, 30.0, 10.0, 30.0, 50.0, 30.0, 25.0, 120.0, 30.0, 20.0, -5.0, 360.0, 190.0, 160.0, 30.0, 10.0, 240.0, 90.0, 30.0, 20.0, 30.0, 80.0, 120.0, 100.0, -30.0, 60.0, 40.0, 40.0, -45.0, 60.0, 300.0, 150.0, 20.0, 10.0, 160.0, 30.0, 30.0, 50.0, 180.0, 160.0, 100.0, 50.0, 390.0, -10.0, 370.0, 30.0, 20.0, 50.0, 200.0, 100.0, 0.0, 100.0, 30.0, -30.0, 340.0, -10.0, 40.0, 30.0, 115.0, 90.0, 60.0, 40.0, 80.0, 230.0, 10.0, 280.0, -55.0, -20.0, 10.0, 220.0, -10.0, -20.0, -40.0, -50.0, 70.0, 110.0, 20.0, 20.0, 80.0, 150.0, 20.0, 60.0, 40.0, 40.0, 320.0, 90.0, 50.0, 220.0, -25.0, 90.0, 120.0, 120.0, 130.0, 170.0, 10.0, 70.0, 80.0, 150.0, 0.0, 130.0, 80.0, 70.0, 30.0, 30.0, 70.0, 40.0, 320.0, 10.0, 15.0, 160.0, 180.0, 60.0, 210.0, 100.0, -30.0, -60.0, -20.0, 1010.0, 20.0, 60.0, 10.0, 70.0, -80.0, 160.0, 180.0, 130.0, 10.0, 90.0, -40.0, 250.0, 150.0, 160.0, 80.0, 750.0, 170.0, 50.0, 0.0, 10.0, 50.0, 0.0, 70.0, 0.0, 40.0, 80.0, 80.0, 80.0, 10.0, 90.0, 70.0, 110.0, 40.0, 270.0, 20.0, 20.0, 210.0, 190.0, 320.0, -240.0, 90.0, 60.0, 80.0, 130.0, 40.0, 60.0, 110.0, 190.0, 100.0, 0.0, 120.0, 30.0, 150.0, 70.0, 170.0, 320.0, 270.0, 430.0, 65.0, 90.0, -15.0, 170.0, 920.0, -140.0, 60.0, 140.0, 200.0, 140.0, 200.0, 160.0, 80.0, 480.0, 60.0, 20.0, 20.0, 120.0, 270.0, 20.0, 220.0, 10.0, 10.0, 50.0, 770.0, 10.0, 40.0, 50.0, -10.0, 15.0, 40.0, 480.0, 0.0, 100.0, 180.0, 20.0, 70.0, -5.0, 30.0, 40.0, -50.0, 60.0, 30.0, 60.0, 200.0, 40.0, 290.0, 50.0, 10.0, 190.0, 30.0, 70.0, 40.0, 220.0, 310.0, 20.0, 25.0, 100.0, 40.0, 80.0, 80.0, 120.0, 70.0, 40.0, 70.0, 160.0, 30.0, 100.0, 20.0, 10.0, 70.0, 130.0, 150.0, 10.0, 60.0, 25.0, 140.0, 200.0, 20.0, 80.0, 30.0, 10.0, 40.0, 40.0, 120.0, -20.0, 10.0, 170.0, 40.0, 0.0, 0.0, 30.0, -15.0, 5.0, 0.0, 0.0, 0.0, -90.0, 50.0, 125.0, 90.0, 110.0, 180.0, 80.0, 40.0, 190.0, 160.0, 10.0, 470.0, 40.0, 0.0, 30.0, -50.0, -125.0, 130.0, 30.0, 10.0, 10.0, 130.0, 50.0, 60.0, 70.0, 90.0, 110.0, 25.0, 260.0, 50.0, 220.0, -10.0, 10.0, 50.0, 80.0, 70.0, 230.0, 40.0, 30.0, 70.0, 160.0, 20.0, 50.0, 170.0, 10.0, 25.0, 0.0, 200.0, 20.0, 5.0, 0.0, 230.0, 80.0, -15.0, 580.0, 0.0, 170.0, 180.0, -10.0, 80.0, 150.0, 10.0, 90.0, 30.0, 10.0, 120.0, 10.0, 50.0, 140.0, 40.0, 0.0, 40.0, 50.0, 30.0, 50.0, 270.0, 30.0, 10.0, 40.0, 95.0, -50.0, 40.0, 530.0, 50.0, 120.0, 30.0, -125.0, 210.0, 220.0, -10.0, 80.0, 300.0, 40.0, 410.0, 80.0, 120.0, 30.0, 170.0, 130.0, 80.0, 50.0, 80.0, 100.0, 380.0, 80.0, 110.0, 260.0, 60.0, 20.0, -30.0, 40.0, 100.0, 10.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 0.0, 190.0, 10.0, 80.0, 60.0, 150.0, 20.0, 40.0, 80.0, 110.0, 30.0, 190.0, 40.0, 30.0, 160.0, 20.0, 110.0, 10.0, 110.0, 25.0, 60.0, 50.0, 520.0, 0.0, 20.0, -70.0, 130.0, 80.0, 450.0, 100.0, 30.0, 60.0, 40.0, 0.0, 50.0, 20.0, 20.0, 30.0, 0.0, 70.0, 20.0, 20.0, 180.0, 10.0, 140.0, 60.0, 40.0, 270.0, 20.0, 0.0, 70.0, 30.0, -20.0, 40.0, 35.0, 180.0, 150.0, 130.0, 285.0, 50.0, 30.0, 10.0, 70.0, 0.0, 280.0, 30.0, 190.0, 0.0, 50.0, 160.0, 140.0, 100.0, 15.0, 460.0, 170.0, -20.0, 610.0, 60.0, 200.0, 260.0, 170.0, 20.0, 20.0, 30.0, 160.0, 330.0, 10.0, 100.0, 130.0, 10.0, 310.0, 90.0, 260.0, 185.0, 40.0, 90.0, 80.0, 90.0, 130.0, 455.0, 10.0, 300.0, 40.0, 20.0, 20.0, -40.0, 10.0, 130.0, 290.0, 150.0, 40.0, 320.0, 250.0, 15.0, 40.0, 340.0, 30.0, 200.0, 10.0, 45.0, 110.0, 110.0, 40.0, 10.0, 20.0, 30.0, 15.0, 0.0, 0.0, 10.0, 20.0, 30.0, 260.0, 150.0, 50.0, 0.0, 120.0, 280.0, 10.0, 100.0, 100.0, 80.0, 110.0, 80.0, 150.0, 100.0, 130.0, 40.0, 20.0, 130.0, 30.0, 20.0, 100.0, 120.0, 60.0, 230.0, 110.0, 60.0, 15.0, 210.0, 20.0, 40.0, 270.0, 10.0, 110.0, 60.0, 10.0, 190.0, 50.0, 0.0, 50.0, 50.0, 110.0, 260.0, 70.0, 5.0, 30.0, 70.0, 100.0, 380.0, 40.0, 40.0, 0.0, 40.0, 80.0, 170.0, 40.0, 320.0, 180.0, 150.0, 45.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5161698700603055, "mean_inference_ms": 1.4119992972347353, "mean_action_processing_ms": 0.42831140644950993, "mean_env_wait_ms": 1.2519478984569339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011642217636108398, "StateBufferConnector_ms": 0.009289741516113281, "ViewRequirementAgentConnector_ms": 0.3673379421234131}, "num_episodes": 18, "episode_return_max": 1990.0, "episode_return_min": -30.0, "episode_return_mean": 935.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.3893168577666, "num_env_steps_trained_throughput_per_sec": 21.3893168577666, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 3240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3240000, "timers": {"training_iteration_time_ms": 187282.097, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187282.051, "sample_time_ms": 2429.969, "learn_time_ms": 184833.15, "learn_throughput": 21.641, "synch_weights_time_ms": 11.358}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "done": false, "training_iteration": 81, "trial_id": "90816_00000", "date": "2024-06-10_04-26-11", "timestamp": 1718007971, "time_this_iter_s": 187.01689076423645, "time_total_s": 15249.263027191162, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b004af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15249.263027191162, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 18.01056603773585, "ram_util_percent": 79.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.34648276957841, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.35256330913629, "policy_loss": -0.00881303087525522, "vf_loss": 6.359458334225055, "vf_explained_var": 9.777341533900577e-05, "kl": 0.005682983896308875, "entropy": 0.4592870059199988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 765285.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "env_runners": {"episode_reward_max": 2055.0, "episode_reward_min": -30.0, "episode_reward_mean": 885.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 88.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.0, 930.0, 1520.0, 730.0, 1495.0, 630.0, 460.0, 1330.0, 1435.0, 1110.0, 925.0, 130.0, 190.0, 960.0, 100.0, 910.0, 1750.0, 1065.0, 830.0, 980.0, 750.0, 605.0, 1140.0, 870.0, 1015.0, 325.0, 610.0, 1285.0, 650.0, 1165.0, 1140.0, 1760.0, 470.0, 790.0, 940.0, 1260.0, 1990.0, 1480.0, 1450.0, 890.0, 750.0, 1015.0, 790.0, 815.0, 500.0, -30.0, 1035.0, 545.0, 1065.0, 730.0, 500.0, 1445.0, 500.0, 565.0, 1145.0, 1410.0, 1100.0, 450.0, 770.0, 615.0, 1320.0, 270.0, 820.0, 890.0, 1020.0, 1945.0, 1190.0, 1640.0, 980.0, 1150.0, 175.0, 1150.0, 810.0, 965.0, 800.0, 1105.0, 1075.0, 650.0, 920.0, 560.0, 980.0, 710.0, 500.0, 1075.0, 1335.0, 2055.0, 510.0, 695.0, 345.0, 370.0, 720.0, 1085.0, 1170.0, 775.0, 520.0, 340.0, 230.0, 330.0, 430.0, 720.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, -50.0, 30.0, 60.0, 20.0, 10.0, 160.0, 80.0, 20.0, 60.0, 240.0, 110.0, 80.0, 160.0, 40.0, 60.0, 110.0, 30.0, 80.0, 20.0, 100.0, 60.0, 540.0, 130.0, 60.0, 260.0, 80.0, 180.0, 70.0, 40.0, 60.0, 0.0, 40.0, 70.0, 40.0, 20.0, 200.0, 160.0, 60.0, 80.0, -100.0, 30.0, 70.0, 310.0, 10.0, 40.0, 670.0, 50.0, -10.0, 425.0, 10.0, 20.0, -40.0, 70.0, 40.0, 150.0, 150.0, 60.0, 100.0, 70.0, 40.0, 0.0, 10.0, 90.0, 200.0, 30.0, 10.0, 20.0, 10.0, 50.0, 90.0, 170.0, 90.0, 220.0, 10.0, 110.0, 90.0, 160.0, 160.0, 230.0, 420.0, 40.0, 60.0, 110.0, 160.0, 430.0, -30.0, 160.0, 35.0, 50.0, 100.0, 30.0, 210.0, 90.0, 50.0, 150.0, 140.0, 30.0, 120.0, 190.0, 80.0, -10.0, 320.0, 20.0, 270.0, 20.0, 15.0, 60.0, 20.0, 130.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 30.0, 20.0, 10.0, -10.0, 10.0, 20.0, 10.0, 30.0, 5.0, 50.0, 60.0, 5.0, 90.0, 260.0, 190.0, 20.0, 190.0, 0.0, 20.0, 30.0, 90.0, 70.0, 10.0, 0.0, 10.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 150.0, 140.0, 160.0, 200.0, 10.0, 80.0, -50.0, 50.0, 160.0, 10.0, 250.0, 60.0, 140.0, 250.0, 200.0, 40.0, 80.0, -50.0, 110.0, 670.0, 310.0, 170.0, 130.0, -60.0, 150.0, 190.0, 10.0, 80.0, 75.0, 10.0, 150.0, 50.0, 20.0, 130.0, 260.0, 20.0, 130.0, 30.0, 10.0, 30.0, 50.0, 30.0, 25.0, 120.0, 30.0, 20.0, -5.0, 360.0, 190.0, 160.0, 30.0, 10.0, 240.0, 90.0, 30.0, 20.0, 30.0, 80.0, 120.0, 100.0, -30.0, 60.0, 40.0, 40.0, -45.0, 60.0, 300.0, 150.0, 20.0, 10.0, 160.0, 30.0, 30.0, 50.0, 180.0, 160.0, 100.0, 50.0, 390.0, -10.0, 370.0, 30.0, 20.0, 50.0, 200.0, 100.0, 0.0, 100.0, 30.0, -30.0, 340.0, -10.0, 40.0, 30.0, 115.0, 90.0, 60.0, 40.0, 80.0, 230.0, 10.0, 280.0, -55.0, -20.0, 10.0, 220.0, -10.0, -20.0, -40.0, -50.0, 70.0, 110.0, 20.0, 20.0, 80.0, 150.0, 20.0, 60.0, 40.0, 40.0, 320.0, 90.0, 50.0, 220.0, -25.0, 90.0, 120.0, 120.0, 130.0, 170.0, 10.0, 70.0, 80.0, 150.0, 0.0, 130.0, 80.0, 70.0, 30.0, 30.0, 70.0, 40.0, 320.0, 10.0, 15.0, 160.0, 180.0, 60.0, 210.0, 100.0, -30.0, -60.0, -20.0, 1010.0, 20.0, 60.0, 10.0, 70.0, -80.0, 160.0, 180.0, 130.0, 10.0, 90.0, -40.0, 250.0, 150.0, 160.0, 80.0, 750.0, 170.0, 50.0, 0.0, 10.0, 50.0, 0.0, 70.0, 0.0, 40.0, 80.0, 80.0, 80.0, 10.0, 90.0, 70.0, 110.0, 40.0, 270.0, 20.0, 20.0, 210.0, 190.0, 320.0, -240.0, 90.0, 60.0, 80.0, 130.0, 40.0, 60.0, 110.0, 190.0, 100.0, 0.0, 120.0, 30.0, 150.0, 70.0, 170.0, 320.0, 270.0, 430.0, 65.0, 90.0, -15.0, 170.0, 920.0, -140.0, 60.0, 140.0, 200.0, 140.0, 200.0, 160.0, 80.0, 480.0, 60.0, 20.0, 20.0, 120.0, 270.0, 20.0, 220.0, 10.0, 10.0, 50.0, 770.0, 10.0, 40.0, 50.0, -10.0, 15.0, 40.0, 480.0, 0.0, 100.0, 180.0, 20.0, 70.0, -5.0, 30.0, 40.0, -50.0, 60.0, 30.0, 60.0, 200.0, 40.0, 290.0, 50.0, 10.0, 190.0, 30.0, 70.0, 40.0, 220.0, 310.0, 20.0, 25.0, 100.0, 40.0, 80.0, 80.0, 120.0, 70.0, 40.0, 70.0, 160.0, 30.0, 100.0, 20.0, 10.0, 70.0, 130.0, 150.0, 10.0, 60.0, 25.0, 140.0, 200.0, 20.0, 80.0, 30.0, 10.0, 40.0, 40.0, 120.0, -20.0, 10.0, 170.0, 40.0, 0.0, 0.0, 30.0, -15.0, 5.0, 0.0, 0.0, 0.0, -90.0, 50.0, 125.0, 90.0, 110.0, 180.0, 80.0, 40.0, 190.0, 160.0, 10.0, 470.0, 40.0, 0.0, 30.0, -50.0, -125.0, 130.0, 30.0, 10.0, 10.0, 130.0, 50.0, 60.0, 70.0, 90.0, 110.0, 25.0, 260.0, 50.0, 220.0, -10.0, 10.0, 50.0, 80.0, 70.0, 230.0, 40.0, 30.0, 70.0, 160.0, 20.0, 50.0, 170.0, 10.0, 25.0, 0.0, 200.0, 20.0, 5.0, 0.0, 230.0, 80.0, -15.0, 580.0, 0.0, 170.0, 180.0, -10.0, 80.0, 150.0, 10.0, 90.0, 30.0, 10.0, 120.0, 10.0, 50.0, 140.0, 40.0, 0.0, 40.0, 50.0, 30.0, 50.0, 270.0, 30.0, 10.0, 40.0, 95.0, -50.0, 40.0, 530.0, 50.0, 120.0, 30.0, -125.0, 210.0, 220.0, -10.0, 80.0, 300.0, 40.0, 410.0, 80.0, 120.0, 30.0, 170.0, 130.0, 80.0, 50.0, 80.0, 100.0, 380.0, 80.0, 110.0, 260.0, 60.0, 20.0, -30.0, 40.0, 100.0, 10.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 0.0, 190.0, 10.0, 80.0, 60.0, 150.0, 20.0, 40.0, 80.0, 110.0, 30.0, 190.0, 40.0, 30.0, 160.0, 20.0, 110.0, 10.0, 110.0, 25.0, 60.0, 50.0, 520.0, 0.0, 20.0, -70.0, 130.0, 80.0, 450.0, 100.0, 30.0, 60.0, 40.0, 0.0, 50.0, 20.0, 20.0, 30.0, 0.0, 70.0, 20.0, 20.0, 180.0, 10.0, 140.0, 60.0, 40.0, 270.0, 20.0, 0.0, 70.0, 30.0, -20.0, 40.0, 35.0, 180.0, 150.0, 130.0, 285.0, 50.0, 30.0, 10.0, 70.0, 0.0, 280.0, 30.0, 190.0, 0.0, 50.0, 160.0, 140.0, 100.0, 15.0, 460.0, 170.0, -20.0, 610.0, 60.0, 200.0, 260.0, 170.0, 20.0, 20.0, 30.0, 160.0, 330.0, 10.0, 100.0, 130.0, 10.0, 310.0, 90.0, 260.0, 185.0, 40.0, 90.0, 80.0, 90.0, 130.0, 455.0, 10.0, 300.0, 40.0, 20.0, 20.0, -40.0, 10.0, 130.0, 290.0, 150.0, 40.0, 320.0, 250.0, 15.0, 40.0, 340.0, 30.0, 200.0, 10.0, 45.0, 110.0, 110.0, 40.0, 10.0, 20.0, 30.0, 15.0, 0.0, 0.0, 10.0, 20.0, 30.0, 260.0, 150.0, 50.0, 0.0, 120.0, 280.0, 10.0, 100.0, 100.0, 80.0, 110.0, 80.0, 150.0, 100.0, 130.0, 40.0, 20.0, 130.0, 30.0, 20.0, 100.0, 120.0, 60.0, 230.0, 110.0, 60.0, 15.0, 210.0, 20.0, 40.0, 270.0, 10.0, 110.0, 60.0, 10.0, 190.0, 50.0, 0.0, 50.0, 50.0, 110.0, 260.0, 70.0, 5.0, 30.0, 70.0, 100.0, 380.0, 40.0, 40.0, 0.0, 40.0, 80.0, 170.0, 40.0, 320.0, 180.0, 150.0, 45.0, 50.0, 170.0, 0.0, 80.0, 160.0, 30.0, 20.0, 40.0, 40.0, 0.0, 110.0, 80.0, 200.0, 60.0, 20.0, 190.0, 90.0, 70.0, 120.0, 70.0, 20.0, 20.0, 110.0, 50.0, 60.0, 45.0, 70.0, 90.0, 40.0, 50.0, 25.0, 170.0, 100.0, 70.0, 50.0, 40.0, 50.0, 190.0, 0.0, 50.0, 260.0, 50.0, 30.0, 0.0, 30.0, 20.0, 10.0, 40.0, 170.0, 190.0, 170.0, 120.0, 20.0, 300.0, 40.0, 5.0, 20.0, -50.0, 0.0, 30.0, 15.0, 30.0, -80.0, 30.0, 80.0, 0.0, 70.0, 180.0, 250.0, 500.0, 15.0, 60.0, 30.0, 115.0, 150.0, 70.0, 170.0, 420.0, 100.0, 150.0, 70.0, 425.0, 240.0, -10.0, 340.0, 90.0, 40.0, 60.0, 100.0, 720.0, 50.0, 0.0, 150.0, 40.0, 30.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 250.0, 370.0, 20.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, -25.0, -140.0, -5.0, 10.0, 10.0, 60.0, 140.0, 80.0, 170.0, 10.0, 10.0, 30.0, 50.0, -50.0, 150.0, 180.0, 0.0, -30.0, -30.0, 70.0, 0.0, 10.0, 180.0, 0.0, 10.0, 125.0, 180.0, 130.0, -15.0, 20.0, 80.0, 20.0, 40.0, 140.0, -10.0, 60.0, 80.0, 580.0, 170.0, 5.0, 0.0, 40.0, 0.0, 40.0, 40.0, 120.0, 70.0, 450.0, 210.0, 40.0, 160.0, 80.0, 0.0, 10.0, 60.0, 310.0, 30.0, 20.0, 180.0, 40.0, 45.0, 40.0, 40.0, 0.0, 0.0, 140.0, 10.0, 210.0, 30.0, 40.0, 10.0, 30.0, 370.0, -65.0, 20.0, 0.0, 20.0, 40.0, -70.0, -55.0, 50.0, 10.0, 15.0, 100.0, 10.0, 0.0, 40.0, 30.0, 0.0, -5.0, 30.0, 10.0, 0.0, 40.0, 100.0, 30.0, 20.0, 40.0, 60.0, 0.0, 30.0, 20.0, 40.0, 60.0, 40.0, 40.0, 0.0, 20.0, 10.0, 80.0, 120.0, 120.0, 120.0, 170.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5150080552734886, "mean_inference_ms": 1.412126071069427, "mean_action_processing_ms": 0.4277799170394568, "mean_env_wait_ms": 1.2518263288889189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011990070343017578, "StateBufferConnector_ms": 0.00927114486694336, "ViewRequirementAgentConnector_ms": 0.3652188777923584}, "num_episodes": 23, "episode_return_max": 2055.0, "episode_return_min": -30.0, "episode_return_mean": 885.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.31538452584397, "num_env_steps_trained_throughput_per_sec": 21.31538452584397, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 3280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3280000, "timers": {"training_iteration_time_ms": 187266.619, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187266.574, "sample_time_ms": 2449.088, "learn_time_ms": 184798.269, "learn_throughput": 21.645, "synch_weights_time_ms": 11.791}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "done": false, "training_iteration": 82, "trial_id": "90816_00000", "date": "2024-06-10_04-29-19", "timestamp": 1718008159, "time_this_iter_s": 187.664870262146, "time_total_s": 15436.927897453308, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b012f0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15436.927897453308, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.318867924528302, "ram_util_percent": 79.0754716981132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.101602543561984, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.027221998848473, "policy_loss": -0.007144614390773982, "vf_loss": 6.032767210219996, "vf_explained_var": 0.00013275526709957753, "kl": 0.004738978261500955, "entropy": 0.46484849831611075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 774675.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "env_runners": {"episode_reward_max": 2055.0, "episode_reward_min": -30.0, "episode_reward_mean": 865.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 86.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [830.0, 980.0, 750.0, 605.0, 1140.0, 870.0, 1015.0, 325.0, 610.0, 1285.0, 650.0, 1165.0, 1140.0, 1760.0, 470.0, 790.0, 940.0, 1260.0, 1990.0, 1480.0, 1450.0, 890.0, 750.0, 1015.0, 790.0, 815.0, 500.0, -30.0, 1035.0, 545.0, 1065.0, 730.0, 500.0, 1445.0, 500.0, 565.0, 1145.0, 1410.0, 1100.0, 450.0, 770.0, 615.0, 1320.0, 270.0, 820.0, 890.0, 1020.0, 1945.0, 1190.0, 1640.0, 980.0, 1150.0, 175.0, 1150.0, 810.0, 965.0, 800.0, 1105.0, 1075.0, 650.0, 920.0, 560.0, 980.0, 710.0, 500.0, 1075.0, 1335.0, 2055.0, 510.0, 695.0, 345.0, 370.0, 720.0, 1085.0, 1170.0, 775.0, 520.0, 340.0, 230.0, 330.0, 430.0, 720.0, 930.0, 230.0, 700.0, 620.0, 340.0, 1220.0, 1010.0, 820.0, 740.0, 455.0, 90.0, 885.0, 1340.0, 1120.0, 1030.0, 610.0, 1405.0, 545.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 50.0, 20.0, 130.0, 260.0, 20.0, 130.0, 30.0, 10.0, 30.0, 50.0, 30.0, 25.0, 120.0, 30.0, 20.0, -5.0, 360.0, 190.0, 160.0, 30.0, 10.0, 240.0, 90.0, 30.0, 20.0, 30.0, 80.0, 120.0, 100.0, -30.0, 60.0, 40.0, 40.0, -45.0, 60.0, 300.0, 150.0, 20.0, 10.0, 160.0, 30.0, 30.0, 50.0, 180.0, 160.0, 100.0, 50.0, 390.0, -10.0, 370.0, 30.0, 20.0, 50.0, 200.0, 100.0, 0.0, 100.0, 30.0, -30.0, 340.0, -10.0, 40.0, 30.0, 115.0, 90.0, 60.0, 40.0, 80.0, 230.0, 10.0, 280.0, -55.0, -20.0, 10.0, 220.0, -10.0, -20.0, -40.0, -50.0, 70.0, 110.0, 20.0, 20.0, 80.0, 150.0, 20.0, 60.0, 40.0, 40.0, 320.0, 90.0, 50.0, 220.0, -25.0, 90.0, 120.0, 120.0, 130.0, 170.0, 10.0, 70.0, 80.0, 150.0, 0.0, 130.0, 80.0, 70.0, 30.0, 30.0, 70.0, 40.0, 320.0, 10.0, 15.0, 160.0, 180.0, 60.0, 210.0, 100.0, -30.0, -60.0, -20.0, 1010.0, 20.0, 60.0, 10.0, 70.0, -80.0, 160.0, 180.0, 130.0, 10.0, 90.0, -40.0, 250.0, 150.0, 160.0, 80.0, 750.0, 170.0, 50.0, 0.0, 10.0, 50.0, 0.0, 70.0, 0.0, 40.0, 80.0, 80.0, 80.0, 10.0, 90.0, 70.0, 110.0, 40.0, 270.0, 20.0, 20.0, 210.0, 190.0, 320.0, -240.0, 90.0, 60.0, 80.0, 130.0, 40.0, 60.0, 110.0, 190.0, 100.0, 0.0, 120.0, 30.0, 150.0, 70.0, 170.0, 320.0, 270.0, 430.0, 65.0, 90.0, -15.0, 170.0, 920.0, -140.0, 60.0, 140.0, 200.0, 140.0, 200.0, 160.0, 80.0, 480.0, 60.0, 20.0, 20.0, 120.0, 270.0, 20.0, 220.0, 10.0, 10.0, 50.0, 770.0, 10.0, 40.0, 50.0, -10.0, 15.0, 40.0, 480.0, 0.0, 100.0, 180.0, 20.0, 70.0, -5.0, 30.0, 40.0, -50.0, 60.0, 30.0, 60.0, 200.0, 40.0, 290.0, 50.0, 10.0, 190.0, 30.0, 70.0, 40.0, 220.0, 310.0, 20.0, 25.0, 100.0, 40.0, 80.0, 80.0, 120.0, 70.0, 40.0, 70.0, 160.0, 30.0, 100.0, 20.0, 10.0, 70.0, 130.0, 150.0, 10.0, 60.0, 25.0, 140.0, 200.0, 20.0, 80.0, 30.0, 10.0, 40.0, 40.0, 120.0, -20.0, 10.0, 170.0, 40.0, 0.0, 0.0, 30.0, -15.0, 5.0, 0.0, 0.0, 0.0, -90.0, 50.0, 125.0, 90.0, 110.0, 180.0, 80.0, 40.0, 190.0, 160.0, 10.0, 470.0, 40.0, 0.0, 30.0, -50.0, -125.0, 130.0, 30.0, 10.0, 10.0, 130.0, 50.0, 60.0, 70.0, 90.0, 110.0, 25.0, 260.0, 50.0, 220.0, -10.0, 10.0, 50.0, 80.0, 70.0, 230.0, 40.0, 30.0, 70.0, 160.0, 20.0, 50.0, 170.0, 10.0, 25.0, 0.0, 200.0, 20.0, 5.0, 0.0, 230.0, 80.0, -15.0, 580.0, 0.0, 170.0, 180.0, -10.0, 80.0, 150.0, 10.0, 90.0, 30.0, 10.0, 120.0, 10.0, 50.0, 140.0, 40.0, 0.0, 40.0, 50.0, 30.0, 50.0, 270.0, 30.0, 10.0, 40.0, 95.0, -50.0, 40.0, 530.0, 50.0, 120.0, 30.0, -125.0, 210.0, 220.0, -10.0, 80.0, 300.0, 40.0, 410.0, 80.0, 120.0, 30.0, 170.0, 130.0, 80.0, 50.0, 80.0, 100.0, 380.0, 80.0, 110.0, 260.0, 60.0, 20.0, -30.0, 40.0, 100.0, 10.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 0.0, 190.0, 10.0, 80.0, 60.0, 150.0, 20.0, 40.0, 80.0, 110.0, 30.0, 190.0, 40.0, 30.0, 160.0, 20.0, 110.0, 10.0, 110.0, 25.0, 60.0, 50.0, 520.0, 0.0, 20.0, -70.0, 130.0, 80.0, 450.0, 100.0, 30.0, 60.0, 40.0, 0.0, 50.0, 20.0, 20.0, 30.0, 0.0, 70.0, 20.0, 20.0, 180.0, 10.0, 140.0, 60.0, 40.0, 270.0, 20.0, 0.0, 70.0, 30.0, -20.0, 40.0, 35.0, 180.0, 150.0, 130.0, 285.0, 50.0, 30.0, 10.0, 70.0, 0.0, 280.0, 30.0, 190.0, 0.0, 50.0, 160.0, 140.0, 100.0, 15.0, 460.0, 170.0, -20.0, 610.0, 60.0, 200.0, 260.0, 170.0, 20.0, 20.0, 30.0, 160.0, 330.0, 10.0, 100.0, 130.0, 10.0, 310.0, 90.0, 260.0, 185.0, 40.0, 90.0, 80.0, 90.0, 130.0, 455.0, 10.0, 300.0, 40.0, 20.0, 20.0, -40.0, 10.0, 130.0, 290.0, 150.0, 40.0, 320.0, 250.0, 15.0, 40.0, 340.0, 30.0, 200.0, 10.0, 45.0, 110.0, 110.0, 40.0, 10.0, 20.0, 30.0, 15.0, 0.0, 0.0, 10.0, 20.0, 30.0, 260.0, 150.0, 50.0, 0.0, 120.0, 280.0, 10.0, 100.0, 100.0, 80.0, 110.0, 80.0, 150.0, 100.0, 130.0, 40.0, 20.0, 130.0, 30.0, 20.0, 100.0, 120.0, 60.0, 230.0, 110.0, 60.0, 15.0, 210.0, 20.0, 40.0, 270.0, 10.0, 110.0, 60.0, 10.0, 190.0, 50.0, 0.0, 50.0, 50.0, 110.0, 260.0, 70.0, 5.0, 30.0, 70.0, 100.0, 380.0, 40.0, 40.0, 0.0, 40.0, 80.0, 170.0, 40.0, 320.0, 180.0, 150.0, 45.0, 50.0, 170.0, 0.0, 80.0, 160.0, 30.0, 20.0, 40.0, 40.0, 0.0, 110.0, 80.0, 200.0, 60.0, 20.0, 190.0, 90.0, 70.0, 120.0, 70.0, 20.0, 20.0, 110.0, 50.0, 60.0, 45.0, 70.0, 90.0, 40.0, 50.0, 25.0, 170.0, 100.0, 70.0, 50.0, 40.0, 50.0, 190.0, 0.0, 50.0, 260.0, 50.0, 30.0, 0.0, 30.0, 20.0, 10.0, 40.0, 170.0, 190.0, 170.0, 120.0, 20.0, 300.0, 40.0, 5.0, 20.0, -50.0, 0.0, 30.0, 15.0, 30.0, -80.0, 30.0, 80.0, 0.0, 70.0, 180.0, 250.0, 500.0, 15.0, 60.0, 30.0, 115.0, 150.0, 70.0, 170.0, 420.0, 100.0, 150.0, 70.0, 425.0, 240.0, -10.0, 340.0, 90.0, 40.0, 60.0, 100.0, 720.0, 50.0, 0.0, 150.0, 40.0, 30.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 250.0, 370.0, 20.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, -25.0, -140.0, -5.0, 10.0, 10.0, 60.0, 140.0, 80.0, 170.0, 10.0, 10.0, 30.0, 50.0, -50.0, 150.0, 180.0, 0.0, -30.0, -30.0, 70.0, 0.0, 10.0, 180.0, 0.0, 10.0, 125.0, 180.0, 130.0, -15.0, 20.0, 80.0, 20.0, 40.0, 140.0, -10.0, 60.0, 80.0, 580.0, 170.0, 5.0, 0.0, 40.0, 0.0, 40.0, 40.0, 120.0, 70.0, 450.0, 210.0, 40.0, 160.0, 80.0, 0.0, 10.0, 60.0, 310.0, 30.0, 20.0, 180.0, 40.0, 45.0, 40.0, 40.0, 0.0, 0.0, 140.0, 10.0, 210.0, 30.0, 40.0, 10.0, 30.0, 370.0, -65.0, 20.0, 0.0, 20.0, 40.0, -70.0, -55.0, 50.0, 10.0, 15.0, 100.0, 10.0, 0.0, 40.0, 30.0, 0.0, -5.0, 30.0, 10.0, 0.0, 40.0, 100.0, 30.0, 20.0, 40.0, 60.0, 0.0, 30.0, 20.0, 40.0, 60.0, 40.0, 40.0, 0.0, 20.0, 10.0, 80.0, 120.0, 120.0, 120.0, 170.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 130.0, 180.0, 20.0, 0.0, 80.0, 70.0, 40.0, 100.0, 160.0, 280.0, 0.0, 20.0, 40.0, -5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 25.0, 30.0, 0.0, 200.0, 30.0, 220.0, 20.0, 20.0, 70.0, 40.0, 50.0, 50.0, 40.0, 10.0, 30.0, 60.0, 10.0, 220.0, 80.0, 70.0, 90.0, 10.0, 160.0, 20.0, 0.0, 60.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 310.0, 130.0, 40.0, 470.0, 50.0, 40.0, 110.0, 50.0, 40.0, -20.0, 30.0, 350.0, 20.0, 280.0, 0.0, 130.0, 0.0, 70.0, 10.0, 120.0, 100.0, 330.0, -5.0, 90.0, 40.0, -15.0, 140.0, 10.0, 30.0, 100.0, 100.0, -20.0, 110.0, 30.0, 60.0, 20.0, 300.0, 110.0, 10.0, 20.0, 30.0, 20.0, 5.0, 10.0, 50.0, 40.0, 80.0, 150.0, 40.0, 30.0, 0.0, 10.0, -10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 60.0, 20.0, 0.0, 270.0, 40.0, 90.0, 30.0, 50.0, 300.0, 25.0, 70.0, 20.0, 90.0, 270.0, 170.0, 100.0, 10.0, 120.0, 170.0, 320.0, 110.0, 360.0, -50.0, 50.0, 80.0, 60.0, 200.0, 190.0, 60.0, 60.0, 80.0, 170.0, 70.0, 80.0, 130.0, 70.0, 60.0, 250.0, 70.0, 50.0, 10.0, 0.0, 40.0, 100.0, 180.0, 60.0, 160.0, 60.0, 0.0, 0.0, 110.0, 40.0, -15.0, 420.0, 120.0, 30.0, 180.0, 210.0, 190.0, 120.0, 60.0, 30.0, 0.0, 280.0, -20.0, 15.0, 20.0, 150.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5141565707659057, "mean_inference_ms": 1.4120480429081306, "mean_action_processing_ms": 0.4273399242807633, "mean_env_wait_ms": 1.251635631341949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012078046798706055, "StateBufferConnector_ms": 0.009206533432006836, "ViewRequirementAgentConnector_ms": 0.3579130172729492}, "num_episodes": 18, "episode_return_max": 2055.0, "episode_return_min": -30.0, "episode_return_mean": 865.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.535985695760903, "num_env_steps_trained_throughput_per_sec": 21.535985695760903, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 3320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3320000, "timers": {"training_iteration_time_ms": 187124.07, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187124.024, "sample_time_ms": 2455.538, "learn_time_ms": 184649.356, "learn_throughput": 21.663, "synch_weights_time_ms": 11.656}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "done": false, "training_iteration": 83, "trial_id": "90816_00000", "date": "2024-06-10_04-32-25", "timestamp": 1718008345, "time_this_iter_s": 185.74764895439148, "time_total_s": 15622.6755464077, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b013a1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15622.6755464077, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.631939163498103, "ram_util_percent": 79.28022813688212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1924938640401512, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008198634718078128, "vf_loss": 6.5722709965020325, "vf_explained_var": -0.00022011390382362504, "kl": Infinity, "entropy": 0.4306281341880528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 784065.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "env_runners": {"episode_reward_max": 2055.0, "episode_reward_min": -30.0, "episode_reward_mean": 856.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 85.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1990.0, 1480.0, 1450.0, 890.0, 750.0, 1015.0, 790.0, 815.0, 500.0, -30.0, 1035.0, 545.0, 1065.0, 730.0, 500.0, 1445.0, 500.0, 565.0, 1145.0, 1410.0, 1100.0, 450.0, 770.0, 615.0, 1320.0, 270.0, 820.0, 890.0, 1020.0, 1945.0, 1190.0, 1640.0, 980.0, 1150.0, 175.0, 1150.0, 810.0, 965.0, 800.0, 1105.0, 1075.0, 650.0, 920.0, 560.0, 980.0, 710.0, 500.0, 1075.0, 1335.0, 2055.0, 510.0, 695.0, 345.0, 370.0, 720.0, 1085.0, 1170.0, 775.0, 520.0, 340.0, 230.0, 330.0, 430.0, 720.0, 930.0, 230.0, 700.0, 620.0, 340.0, 1220.0, 1010.0, 820.0, 740.0, 455.0, 90.0, 885.0, 1340.0, 1120.0, 1030.0, 610.0, 1405.0, 545.0, 820.0, 285.0, 455.0, 600.0, 895.0, 940.0, 130.0, 900.0, 1380.0, 1575.0, 1230.0, 1150.0, 460.0, 860.0, 1180.0, 1660.0, 645.0, 540.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [270.0, 430.0, 65.0, 90.0, -15.0, 170.0, 920.0, -140.0, 60.0, 140.0, 200.0, 140.0, 200.0, 160.0, 80.0, 480.0, 60.0, 20.0, 20.0, 120.0, 270.0, 20.0, 220.0, 10.0, 10.0, 50.0, 770.0, 10.0, 40.0, 50.0, -10.0, 15.0, 40.0, 480.0, 0.0, 100.0, 180.0, 20.0, 70.0, -5.0, 30.0, 40.0, -50.0, 60.0, 30.0, 60.0, 200.0, 40.0, 290.0, 50.0, 10.0, 190.0, 30.0, 70.0, 40.0, 220.0, 310.0, 20.0, 25.0, 100.0, 40.0, 80.0, 80.0, 120.0, 70.0, 40.0, 70.0, 160.0, 30.0, 100.0, 20.0, 10.0, 70.0, 130.0, 150.0, 10.0, 60.0, 25.0, 140.0, 200.0, 20.0, 80.0, 30.0, 10.0, 40.0, 40.0, 120.0, -20.0, 10.0, 170.0, 40.0, 0.0, 0.0, 30.0, -15.0, 5.0, 0.0, 0.0, 0.0, -90.0, 50.0, 125.0, 90.0, 110.0, 180.0, 80.0, 40.0, 190.0, 160.0, 10.0, 470.0, 40.0, 0.0, 30.0, -50.0, -125.0, 130.0, 30.0, 10.0, 10.0, 130.0, 50.0, 60.0, 70.0, 90.0, 110.0, 25.0, 260.0, 50.0, 220.0, -10.0, 10.0, 50.0, 80.0, 70.0, 230.0, 40.0, 30.0, 70.0, 160.0, 20.0, 50.0, 170.0, 10.0, 25.0, 0.0, 200.0, 20.0, 5.0, 0.0, 230.0, 80.0, -15.0, 580.0, 0.0, 170.0, 180.0, -10.0, 80.0, 150.0, 10.0, 90.0, 30.0, 10.0, 120.0, 10.0, 50.0, 140.0, 40.0, 0.0, 40.0, 50.0, 30.0, 50.0, 270.0, 30.0, 10.0, 40.0, 95.0, -50.0, 40.0, 530.0, 50.0, 120.0, 30.0, -125.0, 210.0, 220.0, -10.0, 80.0, 300.0, 40.0, 410.0, 80.0, 120.0, 30.0, 170.0, 130.0, 80.0, 50.0, 80.0, 100.0, 380.0, 80.0, 110.0, 260.0, 60.0, 20.0, -30.0, 40.0, 100.0, 10.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 0.0, 190.0, 10.0, 80.0, 60.0, 150.0, 20.0, 40.0, 80.0, 110.0, 30.0, 190.0, 40.0, 30.0, 160.0, 20.0, 110.0, 10.0, 110.0, 25.0, 60.0, 50.0, 520.0, 0.0, 20.0, -70.0, 130.0, 80.0, 450.0, 100.0, 30.0, 60.0, 40.0, 0.0, 50.0, 20.0, 20.0, 30.0, 0.0, 70.0, 20.0, 20.0, 180.0, 10.0, 140.0, 60.0, 40.0, 270.0, 20.0, 0.0, 70.0, 30.0, -20.0, 40.0, 35.0, 180.0, 150.0, 130.0, 285.0, 50.0, 30.0, 10.0, 70.0, 0.0, 280.0, 30.0, 190.0, 0.0, 50.0, 160.0, 140.0, 100.0, 15.0, 460.0, 170.0, -20.0, 610.0, 60.0, 200.0, 260.0, 170.0, 20.0, 20.0, 30.0, 160.0, 330.0, 10.0, 100.0, 130.0, 10.0, 310.0, 90.0, 260.0, 185.0, 40.0, 90.0, 80.0, 90.0, 130.0, 455.0, 10.0, 300.0, 40.0, 20.0, 20.0, -40.0, 10.0, 130.0, 290.0, 150.0, 40.0, 320.0, 250.0, 15.0, 40.0, 340.0, 30.0, 200.0, 10.0, 45.0, 110.0, 110.0, 40.0, 10.0, 20.0, 30.0, 15.0, 0.0, 0.0, 10.0, 20.0, 30.0, 260.0, 150.0, 50.0, 0.0, 120.0, 280.0, 10.0, 100.0, 100.0, 80.0, 110.0, 80.0, 150.0, 100.0, 130.0, 40.0, 20.0, 130.0, 30.0, 20.0, 100.0, 120.0, 60.0, 230.0, 110.0, 60.0, 15.0, 210.0, 20.0, 40.0, 270.0, 10.0, 110.0, 60.0, 10.0, 190.0, 50.0, 0.0, 50.0, 50.0, 110.0, 260.0, 70.0, 5.0, 30.0, 70.0, 100.0, 380.0, 40.0, 40.0, 0.0, 40.0, 80.0, 170.0, 40.0, 320.0, 180.0, 150.0, 45.0, 50.0, 170.0, 0.0, 80.0, 160.0, 30.0, 20.0, 40.0, 40.0, 0.0, 110.0, 80.0, 200.0, 60.0, 20.0, 190.0, 90.0, 70.0, 120.0, 70.0, 20.0, 20.0, 110.0, 50.0, 60.0, 45.0, 70.0, 90.0, 40.0, 50.0, 25.0, 170.0, 100.0, 70.0, 50.0, 40.0, 50.0, 190.0, 0.0, 50.0, 260.0, 50.0, 30.0, 0.0, 30.0, 20.0, 10.0, 40.0, 170.0, 190.0, 170.0, 120.0, 20.0, 300.0, 40.0, 5.0, 20.0, -50.0, 0.0, 30.0, 15.0, 30.0, -80.0, 30.0, 80.0, 0.0, 70.0, 180.0, 250.0, 500.0, 15.0, 60.0, 30.0, 115.0, 150.0, 70.0, 170.0, 420.0, 100.0, 150.0, 70.0, 425.0, 240.0, -10.0, 340.0, 90.0, 40.0, 60.0, 100.0, 720.0, 50.0, 0.0, 150.0, 40.0, 30.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 250.0, 370.0, 20.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, -25.0, -140.0, -5.0, 10.0, 10.0, 60.0, 140.0, 80.0, 170.0, 10.0, 10.0, 30.0, 50.0, -50.0, 150.0, 180.0, 0.0, -30.0, -30.0, 70.0, 0.0, 10.0, 180.0, 0.0, 10.0, 125.0, 180.0, 130.0, -15.0, 20.0, 80.0, 20.0, 40.0, 140.0, -10.0, 60.0, 80.0, 580.0, 170.0, 5.0, 0.0, 40.0, 0.0, 40.0, 40.0, 120.0, 70.0, 450.0, 210.0, 40.0, 160.0, 80.0, 0.0, 10.0, 60.0, 310.0, 30.0, 20.0, 180.0, 40.0, 45.0, 40.0, 40.0, 0.0, 0.0, 140.0, 10.0, 210.0, 30.0, 40.0, 10.0, 30.0, 370.0, -65.0, 20.0, 0.0, 20.0, 40.0, -70.0, -55.0, 50.0, 10.0, 15.0, 100.0, 10.0, 0.0, 40.0, 30.0, 0.0, -5.0, 30.0, 10.0, 0.0, 40.0, 100.0, 30.0, 20.0, 40.0, 60.0, 0.0, 30.0, 20.0, 40.0, 60.0, 40.0, 40.0, 0.0, 20.0, 10.0, 80.0, 120.0, 120.0, 120.0, 170.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 130.0, 180.0, 20.0, 0.0, 80.0, 70.0, 40.0, 100.0, 160.0, 280.0, 0.0, 20.0, 40.0, -5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 25.0, 30.0, 0.0, 200.0, 30.0, 220.0, 20.0, 20.0, 70.0, 40.0, 50.0, 50.0, 40.0, 10.0, 30.0, 60.0, 10.0, 220.0, 80.0, 70.0, 90.0, 10.0, 160.0, 20.0, 0.0, 60.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 310.0, 130.0, 40.0, 470.0, 50.0, 40.0, 110.0, 50.0, 40.0, -20.0, 30.0, 350.0, 20.0, 280.0, 0.0, 130.0, 0.0, 70.0, 10.0, 120.0, 100.0, 330.0, -5.0, 90.0, 40.0, -15.0, 140.0, 10.0, 30.0, 100.0, 100.0, -20.0, 110.0, 30.0, 60.0, 20.0, 300.0, 110.0, 10.0, 20.0, 30.0, 20.0, 5.0, 10.0, 50.0, 40.0, 80.0, 150.0, 40.0, 30.0, 0.0, 10.0, -10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 60.0, 20.0, 0.0, 270.0, 40.0, 90.0, 30.0, 50.0, 300.0, 25.0, 70.0, 20.0, 90.0, 270.0, 170.0, 100.0, 10.0, 120.0, 170.0, 320.0, 110.0, 360.0, -50.0, 50.0, 80.0, 60.0, 200.0, 190.0, 60.0, 60.0, 80.0, 170.0, 70.0, 80.0, 130.0, 70.0, 60.0, 250.0, 70.0, 50.0, 10.0, 0.0, 40.0, 100.0, 180.0, 60.0, 160.0, 60.0, 0.0, 0.0, 110.0, 40.0, -15.0, 420.0, 120.0, 30.0, 180.0, 210.0, 190.0, 120.0, 60.0, 30.0, 0.0, 280.0, -20.0, 15.0, 20.0, 150.0, 10.0, 0.0, 110.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 490.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 15.0, 20.0, 40.0, 40.0, 80.0, 40.0, 15.0, 50.0, 160.0, -35.0, 60.0, -20.0, 25.0, 160.0, 40.0, 0.0, 50.0, 210.0, 20.0, 200.0, 20.0, 20.0, 0.0, -40.0, 20.0, 100.0, 70.0, 50.0, 70.0, 20.0, 40.0, 290.0, 40.0, 10.0, 250.0, 55.0, 30.0, 40.0, 160.0, -50.0, -30.0, 20.0, 170.0, 450.0, 190.0, -40.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 0.0, 170.0, 210.0, -40.0, -20.0, 170.0, 50.0, 40.0, 300.0, -20.0, 40.0, 50.0, 30.0, 120.0, 660.0, -30.0, 60.0, 180.0, 150.0, 170.0, -10.0, -30.0, 100.0, 75.0, 820.0, 0.0, 190.0, 100.0, 50.0, 300.0, -30.0, 290.0, 20.0, 40.0, 70.0, 60.0, 220.0, 140.0, 70.0, 210.0, 110.0, 0.0, 170.0, 170.0, 270.0, 110.0, 120.0, 150.0, 0.0, 150.0, 10.0, 50.0, 120.0, -10.0, 85.0, 0.0, 60.0, 60.0, 70.0, -15.0, 40.0, 190.0, 40.0, 20.0, 20.0, 20.0, 20.0, 200.0, 70.0, 90.0, 190.0, 440.0, 20.0, -20.0, 210.0, 80.0, 40.0, 90.0, 60.0, -40.0, 300.0, 60.0, 40.0, 390.0, 250.0, 300.0, 80.0, 80.0, 20.0, 60.0, 380.0, 160.0, 15.0, 180.0, 20.0, 40.0, 30.0, 120.0, 30.0, 10.0, 40.0, 80.0, 40.0, 20.0, 40.0, 100.0, 40.0, 150.0, 20.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.513404418260246, "mean_inference_ms": 1.411807700333042, "mean_action_processing_ms": 0.42690163968002276, "mean_env_wait_ms": 1.251487425665925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012041568756103516, "StateBufferConnector_ms": 0.009220123291015625, "ViewRequirementAgentConnector_ms": 0.3564326763153076}, "num_episodes": 18, "episode_return_max": 2055.0, "episode_return_min": -30.0, "episode_return_mean": 856.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.26635644678285, "num_env_steps_trained_throughput_per_sec": 21.26635644678285, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 3360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3360000, "timers": {"training_iteration_time_ms": 187149.627, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187149.581, "sample_time_ms": 2457.3, "learn_time_ms": 184673.069, "learn_throughput": 21.66, "synch_weights_time_ms": 11.983}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "done": false, "training_iteration": 84, "trial_id": "90816_00000", "date": "2024-06-10_04-35-33", "timestamp": 1718008533, "time_this_iter_s": 188.09900188446045, "time_total_s": 15810.77454829216, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00458b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15810.77454829216, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 21.343609022556393, "ram_util_percent": 79.0624060150376}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0080964200984175, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0078115636087840975, "vf_loss": 7.6131582637945305, "vf_explained_var": 0.0006260506642131379, "kl": Infinity, "entropy": 0.37301515995884854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 793455.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "env_runners": {"episode_reward_max": 2055.0, "episode_reward_min": 90.0, "episode_reward_mean": 899.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 89.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0, 615.0, 1320.0, 270.0, 820.0, 890.0, 1020.0, 1945.0, 1190.0, 1640.0, 980.0, 1150.0, 175.0, 1150.0, 810.0, 965.0, 800.0, 1105.0, 1075.0, 650.0, 920.0, 560.0, 980.0, 710.0, 500.0, 1075.0, 1335.0, 2055.0, 510.0, 695.0, 345.0, 370.0, 720.0, 1085.0, 1170.0, 775.0, 520.0, 340.0, 230.0, 330.0, 430.0, 720.0, 930.0, 230.0, 700.0, 620.0, 340.0, 1220.0, 1010.0, 820.0, 740.0, 455.0, 90.0, 885.0, 1340.0, 1120.0, 1030.0, 610.0, 1405.0, 545.0, 820.0, 285.0, 455.0, 600.0, 895.0, 940.0, 130.0, 900.0, 1380.0, 1575.0, 1230.0, 1150.0, 460.0, 860.0, 1180.0, 1660.0, 645.0, 540.0, 1070.0, 1340.0, 1140.0, 1500.0, 530.0, 1455.0, 505.0, 1260.0, 690.0, 1060.0, 860.0, 730.0, 1430.0, 490.0, 1610.0, 1190.0, 680.0, 1490.0, 1640.0, 1320.0, 1270.0, 1180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 80.0, 60.0, 150.0, 20.0, 40.0, 80.0, 110.0, 30.0, 190.0, 40.0, 30.0, 160.0, 20.0, 110.0, 10.0, 110.0, 25.0, 60.0, 50.0, 520.0, 0.0, 20.0, -70.0, 130.0, 80.0, 450.0, 100.0, 30.0, 60.0, 40.0, 0.0, 50.0, 20.0, 20.0, 30.0, 0.0, 70.0, 20.0, 20.0, 180.0, 10.0, 140.0, 60.0, 40.0, 270.0, 20.0, 0.0, 70.0, 30.0, -20.0, 40.0, 35.0, 180.0, 150.0, 130.0, 285.0, 50.0, 30.0, 10.0, 70.0, 0.0, 280.0, 30.0, 190.0, 0.0, 50.0, 160.0, 140.0, 100.0, 15.0, 460.0, 170.0, -20.0, 610.0, 60.0, 200.0, 260.0, 170.0, 20.0, 20.0, 30.0, 160.0, 330.0, 10.0, 100.0, 130.0, 10.0, 310.0, 90.0, 260.0, 185.0, 40.0, 90.0, 80.0, 90.0, 130.0, 455.0, 10.0, 300.0, 40.0, 20.0, 20.0, -40.0, 10.0, 130.0, 290.0, 150.0, 40.0, 320.0, 250.0, 15.0, 40.0, 340.0, 30.0, 200.0, 10.0, 45.0, 110.0, 110.0, 40.0, 10.0, 20.0, 30.0, 15.0, 0.0, 0.0, 10.0, 20.0, 30.0, 260.0, 150.0, 50.0, 0.0, 120.0, 280.0, 10.0, 100.0, 100.0, 80.0, 110.0, 80.0, 150.0, 100.0, 130.0, 40.0, 20.0, 130.0, 30.0, 20.0, 100.0, 120.0, 60.0, 230.0, 110.0, 60.0, 15.0, 210.0, 20.0, 40.0, 270.0, 10.0, 110.0, 60.0, 10.0, 190.0, 50.0, 0.0, 50.0, 50.0, 110.0, 260.0, 70.0, 5.0, 30.0, 70.0, 100.0, 380.0, 40.0, 40.0, 0.0, 40.0, 80.0, 170.0, 40.0, 320.0, 180.0, 150.0, 45.0, 50.0, 170.0, 0.0, 80.0, 160.0, 30.0, 20.0, 40.0, 40.0, 0.0, 110.0, 80.0, 200.0, 60.0, 20.0, 190.0, 90.0, 70.0, 120.0, 70.0, 20.0, 20.0, 110.0, 50.0, 60.0, 45.0, 70.0, 90.0, 40.0, 50.0, 25.0, 170.0, 100.0, 70.0, 50.0, 40.0, 50.0, 190.0, 0.0, 50.0, 260.0, 50.0, 30.0, 0.0, 30.0, 20.0, 10.0, 40.0, 170.0, 190.0, 170.0, 120.0, 20.0, 300.0, 40.0, 5.0, 20.0, -50.0, 0.0, 30.0, 15.0, 30.0, -80.0, 30.0, 80.0, 0.0, 70.0, 180.0, 250.0, 500.0, 15.0, 60.0, 30.0, 115.0, 150.0, 70.0, 170.0, 420.0, 100.0, 150.0, 70.0, 425.0, 240.0, -10.0, 340.0, 90.0, 40.0, 60.0, 100.0, 720.0, 50.0, 0.0, 150.0, 40.0, 30.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 250.0, 370.0, 20.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, -25.0, -140.0, -5.0, 10.0, 10.0, 60.0, 140.0, 80.0, 170.0, 10.0, 10.0, 30.0, 50.0, -50.0, 150.0, 180.0, 0.0, -30.0, -30.0, 70.0, 0.0, 10.0, 180.0, 0.0, 10.0, 125.0, 180.0, 130.0, -15.0, 20.0, 80.0, 20.0, 40.0, 140.0, -10.0, 60.0, 80.0, 580.0, 170.0, 5.0, 0.0, 40.0, 0.0, 40.0, 40.0, 120.0, 70.0, 450.0, 210.0, 40.0, 160.0, 80.0, 0.0, 10.0, 60.0, 310.0, 30.0, 20.0, 180.0, 40.0, 45.0, 40.0, 40.0, 0.0, 0.0, 140.0, 10.0, 210.0, 30.0, 40.0, 10.0, 30.0, 370.0, -65.0, 20.0, 0.0, 20.0, 40.0, -70.0, -55.0, 50.0, 10.0, 15.0, 100.0, 10.0, 0.0, 40.0, 30.0, 0.0, -5.0, 30.0, 10.0, 0.0, 40.0, 100.0, 30.0, 20.0, 40.0, 60.0, 0.0, 30.0, 20.0, 40.0, 60.0, 40.0, 40.0, 0.0, 20.0, 10.0, 80.0, 120.0, 120.0, 120.0, 170.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 130.0, 180.0, 20.0, 0.0, 80.0, 70.0, 40.0, 100.0, 160.0, 280.0, 0.0, 20.0, 40.0, -5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 25.0, 30.0, 0.0, 200.0, 30.0, 220.0, 20.0, 20.0, 70.0, 40.0, 50.0, 50.0, 40.0, 10.0, 30.0, 60.0, 10.0, 220.0, 80.0, 70.0, 90.0, 10.0, 160.0, 20.0, 0.0, 60.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 310.0, 130.0, 40.0, 470.0, 50.0, 40.0, 110.0, 50.0, 40.0, -20.0, 30.0, 350.0, 20.0, 280.0, 0.0, 130.0, 0.0, 70.0, 10.0, 120.0, 100.0, 330.0, -5.0, 90.0, 40.0, -15.0, 140.0, 10.0, 30.0, 100.0, 100.0, -20.0, 110.0, 30.0, 60.0, 20.0, 300.0, 110.0, 10.0, 20.0, 30.0, 20.0, 5.0, 10.0, 50.0, 40.0, 80.0, 150.0, 40.0, 30.0, 0.0, 10.0, -10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 60.0, 20.0, 0.0, 270.0, 40.0, 90.0, 30.0, 50.0, 300.0, 25.0, 70.0, 20.0, 90.0, 270.0, 170.0, 100.0, 10.0, 120.0, 170.0, 320.0, 110.0, 360.0, -50.0, 50.0, 80.0, 60.0, 200.0, 190.0, 60.0, 60.0, 80.0, 170.0, 70.0, 80.0, 130.0, 70.0, 60.0, 250.0, 70.0, 50.0, 10.0, 0.0, 40.0, 100.0, 180.0, 60.0, 160.0, 60.0, 0.0, 0.0, 110.0, 40.0, -15.0, 420.0, 120.0, 30.0, 180.0, 210.0, 190.0, 120.0, 60.0, 30.0, 0.0, 280.0, -20.0, 15.0, 20.0, 150.0, 10.0, 0.0, 110.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 490.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 15.0, 20.0, 40.0, 40.0, 80.0, 40.0, 15.0, 50.0, 160.0, -35.0, 60.0, -20.0, 25.0, 160.0, 40.0, 0.0, 50.0, 210.0, 20.0, 200.0, 20.0, 20.0, 0.0, -40.0, 20.0, 100.0, 70.0, 50.0, 70.0, 20.0, 40.0, 290.0, 40.0, 10.0, 250.0, 55.0, 30.0, 40.0, 160.0, -50.0, -30.0, 20.0, 170.0, 450.0, 190.0, -40.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 0.0, 170.0, 210.0, -40.0, -20.0, 170.0, 50.0, 40.0, 300.0, -20.0, 40.0, 50.0, 30.0, 120.0, 660.0, -30.0, 60.0, 180.0, 150.0, 170.0, -10.0, -30.0, 100.0, 75.0, 820.0, 0.0, 190.0, 100.0, 50.0, 300.0, -30.0, 290.0, 20.0, 40.0, 70.0, 60.0, 220.0, 140.0, 70.0, 210.0, 110.0, 0.0, 170.0, 170.0, 270.0, 110.0, 120.0, 150.0, 0.0, 150.0, 10.0, 50.0, 120.0, -10.0, 85.0, 0.0, 60.0, 60.0, 70.0, -15.0, 40.0, 190.0, 40.0, 20.0, 20.0, 20.0, 20.0, 200.0, 70.0, 90.0, 190.0, 440.0, 20.0, -20.0, 210.0, 80.0, 40.0, 90.0, 60.0, -40.0, 300.0, 60.0, 40.0, 390.0, 250.0, 300.0, 80.0, 80.0, 20.0, 60.0, 380.0, 160.0, 15.0, 180.0, 20.0, 40.0, 30.0, 120.0, 30.0, 10.0, 40.0, 80.0, 40.0, 20.0, 40.0, 100.0, 40.0, 150.0, 20.0, 30.0, 20.0, 50.0, 70.0, 70.0, 280.0, 40.0, 130.0, 20.0, 180.0, 100.0, 130.0, 90.0, 130.0, 40.0, 220.0, 80.0, 100.0, 190.0, 280.0, 60.0, 150.0, 90.0, 240.0, 50.0, 30.0, 150.0, 100.0, 80.0, 100.0, 180.0, 120.0, 350.0, 200.0, 10.0, 20.0, 70.0, 90.0, 40.0, 300.0, 240.0, 180.0, 30.0, 90.0, 80.0, 10.0, 60.0, 70.0, 60.0, 10.0, 40.0, 80.0, 80.0, 580.0, 170.0, 60.0, 210.0, 30.0, 20.0, 105.0, 130.0, 70.0, 30.0, 0.0, 50.0, 80.0, 100.0, 40.0, 10.0, 150.0, 25.0, 20.0, 140.0, 130.0, 240.0, 230.0, 40.0, 180.0, 40.0, 90.0, 190.0, -20.0, 160.0, 30.0, 20.0, 40.0, 100.0, 170.0, 60.0, 20.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 30.0, 200.0, 150.0, 380.0, 20.0, 120.0, 80.0, 80.0, 140.0, 100.0, 190.0, 5.0, 40.0, 30.0, 130.0, 65.0, 10.0, 190.0, 30.0, 90.0, 60.0, 30.0, 0.0, 10.0, 100.0, 210.0, 380.0, 190.0, 110.0, 160.0, -50.0, 210.0, 120.0, 170.0, 70.0, 70.0, 20.0, 20.0, 140.0, 10.0, 110.0, 10.0, -40.0, 40.0, 160.0, 20.0, 310.0, 10.0, 250.0, 10.0, 500.0, 140.0, 20.0, 250.0, 80.0, 40.0, 90.0, 100.0, 110.0, 25.0, 285.0, 40.0, 140.0, 170.0, 140.0, 90.0, 110.0, 30.0, 10.0, 20.0, 0.0, 30.0, 160.0, 30.0, 20.0, 270.0, 50.0, -140.0, 10.0, 170.0, 50.0, 30.0, 220.0, -20.0, 240.0, 880.0, 120.0, 380.0, 20.0, 40.0, 800.0, 20.0, 130.0, 40.0, 130.0, -40.0, 40.0, 240.0, 40.0, 380.0, 50.0, 60.0, 160.0, 140.0, 70.0, 140.0, 120.0, 60.0, 60.0, 770.0, -40.0, -30.0, 120.0, 60.0, 40.0, 110.0, 100.0, 50.0, 90.0, 110.0, 230.0, 160.0, 90.0, 80.0, 140.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5129324095230166, "mean_inference_ms": 1.4120081754054699, "mean_action_processing_ms": 0.42652288578167946, "mean_env_wait_ms": 1.2516858840035392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013178110122680664, "StateBufferConnector_ms": 0.009549140930175781, "ViewRequirementAgentConnector_ms": 0.36861681938171387}, "num_episodes": 22, "episode_return_max": 2055.0, "episode_return_min": 90.0, "episode_return_mean": 899.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.141917219512745, "num_env_steps_trained_throughput_per_sec": 21.141917219512745, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 3400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3400000, "timers": {"training_iteration_time_ms": 187360.009, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187359.964, "sample_time_ms": 2546.26, "learn_time_ms": 184794.705, "learn_throughput": 21.646, "synch_weights_time_ms": 11.992}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "done": false, "training_iteration": 85, "trial_id": "90816_00000", "date": "2024-06-10_04-38-42", "timestamp": 1718008722, "time_this_iter_s": 189.20835399627686, "time_total_s": 15999.982902288437, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b013a3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15999.982902288437, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 19.57827715355805, "ram_util_percent": 79.13595505617977}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.454043742541434, "cur_kl_coeff": 0.3796875000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007935122017802212, "vf_loss": 7.120063206639153, "vf_explained_var": 7.188584857855361e-05, "kl": Infinity, "entropy": 0.3973568642736116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 802845.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "env_runners": {"episode_reward_max": 2055.0, "episode_reward_min": 90.0, "episode_reward_mean": 909.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -510.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 90.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1075.0, 650.0, 920.0, 560.0, 980.0, 710.0, 500.0, 1075.0, 1335.0, 2055.0, 510.0, 695.0, 345.0, 370.0, 720.0, 1085.0, 1170.0, 775.0, 520.0, 340.0, 230.0, 330.0, 430.0, 720.0, 930.0, 230.0, 700.0, 620.0, 340.0, 1220.0, 1010.0, 820.0, 740.0, 455.0, 90.0, 885.0, 1340.0, 1120.0, 1030.0, 610.0, 1405.0, 545.0, 820.0, 285.0, 455.0, 600.0, 895.0, 940.0, 130.0, 900.0, 1380.0, 1575.0, 1230.0, 1150.0, 460.0, 860.0, 1180.0, 1660.0, 645.0, 540.0, 1070.0, 1340.0, 1140.0, 1500.0, 530.0, 1455.0, 505.0, 1260.0, 690.0, 1060.0, 860.0, 730.0, 1430.0, 490.0, 1610.0, 1190.0, 680.0, 1490.0, 1640.0, 1320.0, 1270.0, 1180.0, 1125.0, 1230.0, 685.0, 1320.0, 1145.0, 730.0, 1230.0, 1180.0, 930.0, 1290.0, 1250.0, 1080.0, 920.0, 1220.0, 1350.0, 545.0, 990.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 40.0, 80.0, 170.0, 40.0, 320.0, 180.0, 150.0, 45.0, 50.0, 170.0, 0.0, 80.0, 160.0, 30.0, 20.0, 40.0, 40.0, 0.0, 110.0, 80.0, 200.0, 60.0, 20.0, 190.0, 90.0, 70.0, 120.0, 70.0, 20.0, 20.0, 110.0, 50.0, 60.0, 45.0, 70.0, 90.0, 40.0, 50.0, 25.0, 170.0, 100.0, 70.0, 50.0, 40.0, 50.0, 190.0, 0.0, 50.0, 260.0, 50.0, 30.0, 0.0, 30.0, 20.0, 10.0, 40.0, 170.0, 190.0, 170.0, 120.0, 20.0, 300.0, 40.0, 5.0, 20.0, -50.0, 0.0, 30.0, 15.0, 30.0, -80.0, 30.0, 80.0, 0.0, 70.0, 180.0, 250.0, 500.0, 15.0, 60.0, 30.0, 115.0, 150.0, 70.0, 170.0, 420.0, 100.0, 150.0, 70.0, 425.0, 240.0, -10.0, 340.0, 90.0, 40.0, 60.0, 100.0, 720.0, 50.0, 0.0, 150.0, 40.0, 30.0, 40.0, 20.0, 150.0, 50.0, 0.0, 30.0, 250.0, 370.0, 20.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, -25.0, -140.0, -5.0, 10.0, 10.0, 60.0, 140.0, 80.0, 170.0, 10.0, 10.0, 30.0, 50.0, -50.0, 150.0, 180.0, 0.0, -30.0, -30.0, 70.0, 0.0, 10.0, 180.0, 0.0, 10.0, 125.0, 180.0, 130.0, -15.0, 20.0, 80.0, 20.0, 40.0, 140.0, -10.0, 60.0, 80.0, 580.0, 170.0, 5.0, 0.0, 40.0, 0.0, 40.0, 40.0, 120.0, 70.0, 450.0, 210.0, 40.0, 160.0, 80.0, 0.0, 10.0, 60.0, 310.0, 30.0, 20.0, 180.0, 40.0, 45.0, 40.0, 40.0, 0.0, 0.0, 140.0, 10.0, 210.0, 30.0, 40.0, 10.0, 30.0, 370.0, -65.0, 20.0, 0.0, 20.0, 40.0, -70.0, -55.0, 50.0, 10.0, 15.0, 100.0, 10.0, 0.0, 40.0, 30.0, 0.0, -5.0, 30.0, 10.0, 0.0, 40.0, 100.0, 30.0, 20.0, 40.0, 60.0, 0.0, 30.0, 20.0, 40.0, 60.0, 40.0, 40.0, 0.0, 20.0, 10.0, 80.0, 120.0, 120.0, 120.0, 170.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 130.0, 180.0, 20.0, 0.0, 80.0, 70.0, 40.0, 100.0, 160.0, 280.0, 0.0, 20.0, 40.0, -5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 25.0, 30.0, 0.0, 200.0, 30.0, 220.0, 20.0, 20.0, 70.0, 40.0, 50.0, 50.0, 40.0, 10.0, 30.0, 60.0, 10.0, 220.0, 80.0, 70.0, 90.0, 10.0, 160.0, 20.0, 0.0, 60.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 310.0, 130.0, 40.0, 470.0, 50.0, 40.0, 110.0, 50.0, 40.0, -20.0, 30.0, 350.0, 20.0, 280.0, 0.0, 130.0, 0.0, 70.0, 10.0, 120.0, 100.0, 330.0, -5.0, 90.0, 40.0, -15.0, 140.0, 10.0, 30.0, 100.0, 100.0, -20.0, 110.0, 30.0, 60.0, 20.0, 300.0, 110.0, 10.0, 20.0, 30.0, 20.0, 5.0, 10.0, 50.0, 40.0, 80.0, 150.0, 40.0, 30.0, 0.0, 10.0, -10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 60.0, 20.0, 0.0, 270.0, 40.0, 90.0, 30.0, 50.0, 300.0, 25.0, 70.0, 20.0, 90.0, 270.0, 170.0, 100.0, 10.0, 120.0, 170.0, 320.0, 110.0, 360.0, -50.0, 50.0, 80.0, 60.0, 200.0, 190.0, 60.0, 60.0, 80.0, 170.0, 70.0, 80.0, 130.0, 70.0, 60.0, 250.0, 70.0, 50.0, 10.0, 0.0, 40.0, 100.0, 180.0, 60.0, 160.0, 60.0, 0.0, 0.0, 110.0, 40.0, -15.0, 420.0, 120.0, 30.0, 180.0, 210.0, 190.0, 120.0, 60.0, 30.0, 0.0, 280.0, -20.0, 15.0, 20.0, 150.0, 10.0, 0.0, 110.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 490.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 15.0, 20.0, 40.0, 40.0, 80.0, 40.0, 15.0, 50.0, 160.0, -35.0, 60.0, -20.0, 25.0, 160.0, 40.0, 0.0, 50.0, 210.0, 20.0, 200.0, 20.0, 20.0, 0.0, -40.0, 20.0, 100.0, 70.0, 50.0, 70.0, 20.0, 40.0, 290.0, 40.0, 10.0, 250.0, 55.0, 30.0, 40.0, 160.0, -50.0, -30.0, 20.0, 170.0, 450.0, 190.0, -40.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 0.0, 170.0, 210.0, -40.0, -20.0, 170.0, 50.0, 40.0, 300.0, -20.0, 40.0, 50.0, 30.0, 120.0, 660.0, -30.0, 60.0, 180.0, 150.0, 170.0, -10.0, -30.0, 100.0, 75.0, 820.0, 0.0, 190.0, 100.0, 50.0, 300.0, -30.0, 290.0, 20.0, 40.0, 70.0, 60.0, 220.0, 140.0, 70.0, 210.0, 110.0, 0.0, 170.0, 170.0, 270.0, 110.0, 120.0, 150.0, 0.0, 150.0, 10.0, 50.0, 120.0, -10.0, 85.0, 0.0, 60.0, 60.0, 70.0, -15.0, 40.0, 190.0, 40.0, 20.0, 20.0, 20.0, 20.0, 200.0, 70.0, 90.0, 190.0, 440.0, 20.0, -20.0, 210.0, 80.0, 40.0, 90.0, 60.0, -40.0, 300.0, 60.0, 40.0, 390.0, 250.0, 300.0, 80.0, 80.0, 20.0, 60.0, 380.0, 160.0, 15.0, 180.0, 20.0, 40.0, 30.0, 120.0, 30.0, 10.0, 40.0, 80.0, 40.0, 20.0, 40.0, 100.0, 40.0, 150.0, 20.0, 30.0, 20.0, 50.0, 70.0, 70.0, 280.0, 40.0, 130.0, 20.0, 180.0, 100.0, 130.0, 90.0, 130.0, 40.0, 220.0, 80.0, 100.0, 190.0, 280.0, 60.0, 150.0, 90.0, 240.0, 50.0, 30.0, 150.0, 100.0, 80.0, 100.0, 180.0, 120.0, 350.0, 200.0, 10.0, 20.0, 70.0, 90.0, 40.0, 300.0, 240.0, 180.0, 30.0, 90.0, 80.0, 10.0, 60.0, 70.0, 60.0, 10.0, 40.0, 80.0, 80.0, 580.0, 170.0, 60.0, 210.0, 30.0, 20.0, 105.0, 130.0, 70.0, 30.0, 0.0, 50.0, 80.0, 100.0, 40.0, 10.0, 150.0, 25.0, 20.0, 140.0, 130.0, 240.0, 230.0, 40.0, 180.0, 40.0, 90.0, 190.0, -20.0, 160.0, 30.0, 20.0, 40.0, 100.0, 170.0, 60.0, 20.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 30.0, 200.0, 150.0, 380.0, 20.0, 120.0, 80.0, 80.0, 140.0, 100.0, 190.0, 5.0, 40.0, 30.0, 130.0, 65.0, 10.0, 190.0, 30.0, 90.0, 60.0, 30.0, 0.0, 10.0, 100.0, 210.0, 380.0, 190.0, 110.0, 160.0, -50.0, 210.0, 120.0, 170.0, 70.0, 70.0, 20.0, 20.0, 140.0, 10.0, 110.0, 10.0, -40.0, 40.0, 160.0, 20.0, 310.0, 10.0, 250.0, 10.0, 500.0, 140.0, 20.0, 250.0, 80.0, 40.0, 90.0, 100.0, 110.0, 25.0, 285.0, 40.0, 140.0, 170.0, 140.0, 90.0, 110.0, 30.0, 10.0, 20.0, 0.0, 30.0, 160.0, 30.0, 20.0, 270.0, 50.0, -140.0, 10.0, 170.0, 50.0, 30.0, 220.0, -20.0, 240.0, 880.0, 120.0, 380.0, 20.0, 40.0, 800.0, 20.0, 130.0, 40.0, 130.0, -40.0, 40.0, 240.0, 40.0, 380.0, 50.0, 60.0, 160.0, 140.0, 70.0, 140.0, 120.0, 60.0, 60.0, 770.0, -40.0, -30.0, 120.0, 60.0, 40.0, 110.0, 100.0, 50.0, 90.0, 110.0, 230.0, 160.0, 90.0, 80.0, 140.0, 130.0, 170.0, 15.0, 60.0, 50.0, 40.0, 60.0, 180.0, 190.0, 230.0, 130.0, 490.0, 40.0, 50.0, 70.0, 110.0, 180.0, 40.0, 110.0, 70.0, 70.0, 250.0, 20.0, 30.0, 10.0, 10.0, 40.0, 190.0, 55.0, 20.0, 60.0, 140.0, 200.0, 90.0, -180.0, 170.0, 100.0, 190.0, 120.0, 230.0, 260.0, 130.0, 90.0, 110.0, 40.0, 400.0, 200.0, -25.0, 90.0, 80.0, 30.0, 50.0, 190.0, 100.0, 400.0, 30.0, 150.0, 130.0, 160.0, 30.0, -510.0, 190.0, 170.0, 180.0, 260.0, 50.0, 230.0, 0.0, 120.0, 20.0, 10.0, 10.0, 20.0, 70.0, 180.0, 290.0, 400.0, 90.0, 60.0, 30.0, 30.0, 30.0, 230.0, 150.0, 110.0, -20.0, 140.0, 160.0, 20.0, 20.0, 90.0, 60.0, 110.0, 140.0, 40.0, 350.0, 50.0, 260.0, 110.0, 40.0, 130.0, 80.0, 210.0, 90.0, 70.0, 110.0, 200.0, 0.0, 80.0, 100.0, 310.0, 40.0, 220.0, 40.0, 190.0, 70.0, 30.0, 10.0, 210.0, 50.0, 220.0, 120.0, 200.0, 50.0, 150.0, 180.0, 20.0, 40.0, 50.0, 10.0, 100.0, 140.0, 380.0, 40.0, 10.0, 200.0, 10.0, 130.0, 70.0, 110.0, 130.0, 80.0, 180.0, 30.0, 50.0, 150.0, 90.0, 100.0, 580.0, 70.0, 20.0, 0.0, 30.0, 160.0, 70.0, 100.0, 40.0, 0.0, 15.0, 20.0, 110.0, 0.0, 20.0, 50.0, 320.0, 20.0, 200.0, 120.0, 0.0, 60.0, 200.0, 0.0, 100.0, 20.0, 100.0, 0.0, 70.0, 10.0, 10.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5127915656291249, "mean_inference_ms": 1.412321111148583, "mean_action_processing_ms": 0.4262202746449586, "mean_env_wait_ms": 1.2518012611426266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013291597366333008, "StateBufferConnector_ms": 0.009572744369506836, "ViewRequirementAgentConnector_ms": 0.37319064140319824}, "num_episodes": 18, "episode_return_max": 2055.0, "episode_return_min": 90.0, "episode_return_mean": 909.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.58897779940843, "num_env_steps_trained_throughput_per_sec": 21.58897779940843, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 3440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3440000, "timers": {"training_iteration_time_ms": 187212.329, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187212.285, "sample_time_ms": 2542.384, "learn_time_ms": 184650.66, "learn_throughput": 21.663, "synch_weights_time_ms": 12.225}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "done": false, "training_iteration": 86, "trial_id": "90816_00000", "date": "2024-06-10_04-41-47", "timestamp": 1718008907, "time_this_iter_s": 185.28956079483032, "time_total_s": 16185.272463083267, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0045310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16185.272463083267, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.06958174904943, "ram_util_percent": 79.30038022813689}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.58690516343132, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008958132811316168, "vf_loss": 6.4898695505973, "vf_explained_var": 0.00040525374448083587, "kl": Infinity, "entropy": 0.440356286766684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 812235.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 90.0, "episode_reward_mean": 903.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -510.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 90.305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [720.0, 930.0, 230.0, 700.0, 620.0, 340.0, 1220.0, 1010.0, 820.0, 740.0, 455.0, 90.0, 885.0, 1340.0, 1120.0, 1030.0, 610.0, 1405.0, 545.0, 820.0, 285.0, 455.0, 600.0, 895.0, 940.0, 130.0, 900.0, 1380.0, 1575.0, 1230.0, 1150.0, 460.0, 860.0, 1180.0, 1660.0, 645.0, 540.0, 1070.0, 1340.0, 1140.0, 1500.0, 530.0, 1455.0, 505.0, 1260.0, 690.0, 1060.0, 860.0, 730.0, 1430.0, 490.0, 1610.0, 1190.0, 680.0, 1490.0, 1640.0, 1320.0, 1270.0, 1180.0, 1125.0, 1230.0, 685.0, 1320.0, 1145.0, 730.0, 1230.0, 1180.0, 930.0, 1290.0, 1250.0, 1080.0, 920.0, 1220.0, 1350.0, 545.0, 990.0, 370.0, 1430.0, 890.0, 1505.0, 640.0, 260.0, 90.0, 935.0, 685.0, 170.0, 175.0, 590.0, 1170.0, 575.0, 1090.0, 1150.0, 305.0, 1390.0, 1400.0, 370.0, 350.0, 595.0, 735.0, 260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 120.0, 170.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 130.0, 180.0, 20.0, 0.0, 80.0, 70.0, 40.0, 100.0, 160.0, 280.0, 0.0, 20.0, 40.0, -5.0, 0.0, 20.0, 70.0, 20.0, 10.0, 25.0, 30.0, 0.0, 200.0, 30.0, 220.0, 20.0, 20.0, 70.0, 40.0, 50.0, 50.0, 40.0, 10.0, 30.0, 60.0, 10.0, 220.0, 80.0, 70.0, 90.0, 10.0, 160.0, 20.0, 0.0, 60.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 310.0, 130.0, 40.0, 470.0, 50.0, 40.0, 110.0, 50.0, 40.0, -20.0, 30.0, 350.0, 20.0, 280.0, 0.0, 130.0, 0.0, 70.0, 10.0, 120.0, 100.0, 330.0, -5.0, 90.0, 40.0, -15.0, 140.0, 10.0, 30.0, 100.0, 100.0, -20.0, 110.0, 30.0, 60.0, 20.0, 300.0, 110.0, 10.0, 20.0, 30.0, 20.0, 5.0, 10.0, 50.0, 40.0, 80.0, 150.0, 40.0, 30.0, 0.0, 10.0, -10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 60.0, 20.0, 0.0, 270.0, 40.0, 90.0, 30.0, 50.0, 300.0, 25.0, 70.0, 20.0, 90.0, 270.0, 170.0, 100.0, 10.0, 120.0, 170.0, 320.0, 110.0, 360.0, -50.0, 50.0, 80.0, 60.0, 200.0, 190.0, 60.0, 60.0, 80.0, 170.0, 70.0, 80.0, 130.0, 70.0, 60.0, 250.0, 70.0, 50.0, 10.0, 0.0, 40.0, 100.0, 180.0, 60.0, 160.0, 60.0, 0.0, 0.0, 110.0, 40.0, -15.0, 420.0, 120.0, 30.0, 180.0, 210.0, 190.0, 120.0, 60.0, 30.0, 0.0, 280.0, -20.0, 15.0, 20.0, 150.0, 10.0, 0.0, 110.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 490.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 15.0, 20.0, 40.0, 40.0, 80.0, 40.0, 15.0, 50.0, 160.0, -35.0, 60.0, -20.0, 25.0, 160.0, 40.0, 0.0, 50.0, 210.0, 20.0, 200.0, 20.0, 20.0, 0.0, -40.0, 20.0, 100.0, 70.0, 50.0, 70.0, 20.0, 40.0, 290.0, 40.0, 10.0, 250.0, 55.0, 30.0, 40.0, 160.0, -50.0, -30.0, 20.0, 170.0, 450.0, 190.0, -40.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 0.0, 170.0, 210.0, -40.0, -20.0, 170.0, 50.0, 40.0, 300.0, -20.0, 40.0, 50.0, 30.0, 120.0, 660.0, -30.0, 60.0, 180.0, 150.0, 170.0, -10.0, -30.0, 100.0, 75.0, 820.0, 0.0, 190.0, 100.0, 50.0, 300.0, -30.0, 290.0, 20.0, 40.0, 70.0, 60.0, 220.0, 140.0, 70.0, 210.0, 110.0, 0.0, 170.0, 170.0, 270.0, 110.0, 120.0, 150.0, 0.0, 150.0, 10.0, 50.0, 120.0, -10.0, 85.0, 0.0, 60.0, 60.0, 70.0, -15.0, 40.0, 190.0, 40.0, 20.0, 20.0, 20.0, 20.0, 200.0, 70.0, 90.0, 190.0, 440.0, 20.0, -20.0, 210.0, 80.0, 40.0, 90.0, 60.0, -40.0, 300.0, 60.0, 40.0, 390.0, 250.0, 300.0, 80.0, 80.0, 20.0, 60.0, 380.0, 160.0, 15.0, 180.0, 20.0, 40.0, 30.0, 120.0, 30.0, 10.0, 40.0, 80.0, 40.0, 20.0, 40.0, 100.0, 40.0, 150.0, 20.0, 30.0, 20.0, 50.0, 70.0, 70.0, 280.0, 40.0, 130.0, 20.0, 180.0, 100.0, 130.0, 90.0, 130.0, 40.0, 220.0, 80.0, 100.0, 190.0, 280.0, 60.0, 150.0, 90.0, 240.0, 50.0, 30.0, 150.0, 100.0, 80.0, 100.0, 180.0, 120.0, 350.0, 200.0, 10.0, 20.0, 70.0, 90.0, 40.0, 300.0, 240.0, 180.0, 30.0, 90.0, 80.0, 10.0, 60.0, 70.0, 60.0, 10.0, 40.0, 80.0, 80.0, 580.0, 170.0, 60.0, 210.0, 30.0, 20.0, 105.0, 130.0, 70.0, 30.0, 0.0, 50.0, 80.0, 100.0, 40.0, 10.0, 150.0, 25.0, 20.0, 140.0, 130.0, 240.0, 230.0, 40.0, 180.0, 40.0, 90.0, 190.0, -20.0, 160.0, 30.0, 20.0, 40.0, 100.0, 170.0, 60.0, 20.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 30.0, 200.0, 150.0, 380.0, 20.0, 120.0, 80.0, 80.0, 140.0, 100.0, 190.0, 5.0, 40.0, 30.0, 130.0, 65.0, 10.0, 190.0, 30.0, 90.0, 60.0, 30.0, 0.0, 10.0, 100.0, 210.0, 380.0, 190.0, 110.0, 160.0, -50.0, 210.0, 120.0, 170.0, 70.0, 70.0, 20.0, 20.0, 140.0, 10.0, 110.0, 10.0, -40.0, 40.0, 160.0, 20.0, 310.0, 10.0, 250.0, 10.0, 500.0, 140.0, 20.0, 250.0, 80.0, 40.0, 90.0, 100.0, 110.0, 25.0, 285.0, 40.0, 140.0, 170.0, 140.0, 90.0, 110.0, 30.0, 10.0, 20.0, 0.0, 30.0, 160.0, 30.0, 20.0, 270.0, 50.0, -140.0, 10.0, 170.0, 50.0, 30.0, 220.0, -20.0, 240.0, 880.0, 120.0, 380.0, 20.0, 40.0, 800.0, 20.0, 130.0, 40.0, 130.0, -40.0, 40.0, 240.0, 40.0, 380.0, 50.0, 60.0, 160.0, 140.0, 70.0, 140.0, 120.0, 60.0, 60.0, 770.0, -40.0, -30.0, 120.0, 60.0, 40.0, 110.0, 100.0, 50.0, 90.0, 110.0, 230.0, 160.0, 90.0, 80.0, 140.0, 130.0, 170.0, 15.0, 60.0, 50.0, 40.0, 60.0, 180.0, 190.0, 230.0, 130.0, 490.0, 40.0, 50.0, 70.0, 110.0, 180.0, 40.0, 110.0, 70.0, 70.0, 250.0, 20.0, 30.0, 10.0, 10.0, 40.0, 190.0, 55.0, 20.0, 60.0, 140.0, 200.0, 90.0, -180.0, 170.0, 100.0, 190.0, 120.0, 230.0, 260.0, 130.0, 90.0, 110.0, 40.0, 400.0, 200.0, -25.0, 90.0, 80.0, 30.0, 50.0, 190.0, 100.0, 400.0, 30.0, 150.0, 130.0, 160.0, 30.0, -510.0, 190.0, 170.0, 180.0, 260.0, 50.0, 230.0, 0.0, 120.0, 20.0, 10.0, 10.0, 20.0, 70.0, 180.0, 290.0, 400.0, 90.0, 60.0, 30.0, 30.0, 30.0, 230.0, 150.0, 110.0, -20.0, 140.0, 160.0, 20.0, 20.0, 90.0, 60.0, 110.0, 140.0, 40.0, 350.0, 50.0, 260.0, 110.0, 40.0, 130.0, 80.0, 210.0, 90.0, 70.0, 110.0, 200.0, 0.0, 80.0, 100.0, 310.0, 40.0, 220.0, 40.0, 190.0, 70.0, 30.0, 10.0, 210.0, 50.0, 220.0, 120.0, 200.0, 50.0, 150.0, 180.0, 20.0, 40.0, 50.0, 10.0, 100.0, 140.0, 380.0, 40.0, 10.0, 200.0, 10.0, 130.0, 70.0, 110.0, 130.0, 80.0, 180.0, 30.0, 50.0, 150.0, 90.0, 100.0, 580.0, 70.0, 20.0, 0.0, 30.0, 160.0, 70.0, 100.0, 40.0, 0.0, 15.0, 20.0, 110.0, 0.0, 20.0, 50.0, 320.0, 20.0, 200.0, 120.0, 0.0, 60.0, 200.0, 0.0, 100.0, 20.0, 100.0, 0.0, 70.0, 10.0, 10.0, 20.0, 40.0, 450.0, 30.0, 20.0, 90.0, 30.0, 160.0, 110.0, 170.0, 190.0, 180.0, 10.0, 90.0, 150.0, 0.0, 110.0, 110.0, 80.0, 180.0, 120.0, 40.0, -40.0, 640.0, 160.0, 80.0, 40.0, 140.0, 110.0, 140.0, 165.0, 70.0, 50.0, 40.0, 30.0, 120.0, 55.0, 260.0, 110.0, 20.0, -75.0, 30.0, 30.0, 30.0, 15.0, 20.0, 0.0, 25.0, -10.0, 20.0, 20.0, 110.0, -90.0, 10.0, 40.0, 20.0, 30.0, -5.0, -65.0, 20.0, 120.0, 10.0, 40.0, 260.0, 50.0, 50.0, 35.0, 210.0, 260.0, 80.0, -10.0, -40.0, -20.0, 40.0, 60.0, 40.0, 10.0, 90.0, -130.0, 35.0, 80.0, 480.0, 15.0, 30.0, 40.0, 0.0, 70.0, -45.0, 20.0, 30.0, 0.0, 10.0, -35.0, -55.0, 40.0, -75.0, 10.0, 250.0, -30.0, -80.0, 40.0, 110.0, 150.0, 30.0, 20.0, 30.0, 10.0, 120.0, 40.0, 20.0, 140.0, 30.0, 110.0, 280.0, 120.0, 110.0, 170.0, 60.0, 40.0, 180.0, 0.0, 100.0, -20.0, 40.0, 60.0, 20.0, 60.0, -30.0, 90.0, 55.0, 40.0, 260.0, 140.0, 60.0, 80.0, 260.0, 20.0, 60.0, 160.0, 130.0, 150.0, 30.0, 120.0, 90.0, 50.0, 200.0, 20.0, 70.0, 110.0, 0.0, 70.0, 420.0, 30.0, 30.0, 0.0, 5.0, 10.0, 0.0, 70.0, 100.0, 20.0, 40.0, 150.0, 100.0, 40.0, 350.0, 130.0, 80.0, 270.0, 60.0, 120.0, 90.0, 40.0, 20.0, 200.0, 70.0, 100.0, 90.0, 610.0, 180.0, 80.0, 10.0, 35.0, 10.0, 20.0, 10.0, 80.0, -5.0, 60.0, 30.0, 60.0, 70.0, 20.0, -30.0, 60.0, 20.0, 30.0, 0.0, 40.0, 170.0, 10.0, 30.0, 150.0, 180.0, 20.0, 5.0, 60.0, 80.0, 0.0, 40.0, 60.0, 0.0, 100.0, 15.0, 40.0, 10.0, 80.0, 180.0, 20.0, 180.0, 70.0, 40.0, 40.0, 0.0, 30.0, 20.0, 10.0, 80.0, 20.0, 0.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.51332195547084, "mean_inference_ms": 1.4132618426802728, "mean_action_processing_ms": 0.42757664811171253, "mean_env_wait_ms": 1.2524428625486863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013704061508178711, "StateBufferConnector_ms": 0.01018214225769043, "ViewRequirementAgentConnector_ms": 0.41777634620666504}, "num_episodes": 23, "episode_return_max": 1660.0, "episode_return_min": 90.0, "episode_return_mean": 903.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.336367998893927, "num_env_steps_trained_throughput_per_sec": 21.336367998893927, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 3480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3480000, "timers": {"training_iteration_time_ms": 187143.984, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187143.941, "sample_time_ms": 2589.179, "learn_time_ms": 184535.566, "learn_throughput": 21.676, "synch_weights_time_ms": 12.224}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "done": false, "training_iteration": 87, "trial_id": "90816_00000", "date": "2024-06-10_04-44-55", "timestamp": 1718009095, "time_this_iter_s": 187.48481917381287, "time_total_s": 16372.75728225708, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b01034c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16372.75728225708, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 18.004545454545454, "ram_util_percent": 78.96439393939393}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5175899310424303, "cur_kl_coeff": 0.8542968749999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.326219636309769, "policy_loss": -0.00719055147068942, "vf_loss": 7.330837933781048, "vf_explained_var": 0.00010746976438040931, "kl": 0.0030109503759228324, "entropy": 0.41993753765655145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 821625.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 90.0, "episode_reward_mean": 930.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -510.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 93.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [545.0, 820.0, 285.0, 455.0, 600.0, 895.0, 940.0, 130.0, 900.0, 1380.0, 1575.0, 1230.0, 1150.0, 460.0, 860.0, 1180.0, 1660.0, 645.0, 540.0, 1070.0, 1340.0, 1140.0, 1500.0, 530.0, 1455.0, 505.0, 1260.0, 690.0, 1060.0, 860.0, 730.0, 1430.0, 490.0, 1610.0, 1190.0, 680.0, 1490.0, 1640.0, 1320.0, 1270.0, 1180.0, 1125.0, 1230.0, 685.0, 1320.0, 1145.0, 730.0, 1230.0, 1180.0, 930.0, 1290.0, 1250.0, 1080.0, 920.0, 1220.0, 1350.0, 545.0, 990.0, 370.0, 1430.0, 890.0, 1505.0, 640.0, 260.0, 90.0, 935.0, 685.0, 170.0, 175.0, 590.0, 1170.0, 575.0, 1090.0, 1150.0, 305.0, 1390.0, 1400.0, 370.0, 350.0, 595.0, 735.0, 260.0, 425.0, 1010.0, 1180.0, 1125.0, 1230.0, 960.0, 610.0, 1055.0, 860.0, 675.0, 975.0, 800.0, 935.0, 820.0, 1500.0, 325.0, 1290.0, 1260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 30.0, 0.0, 280.0, -20.0, 15.0, 20.0, 150.0, 10.0, 0.0, 110.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 490.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 15.0, 20.0, 40.0, 40.0, 80.0, 40.0, 15.0, 50.0, 160.0, -35.0, 60.0, -20.0, 25.0, 160.0, 40.0, 0.0, 50.0, 210.0, 20.0, 200.0, 20.0, 20.0, 0.0, -40.0, 20.0, 100.0, 70.0, 50.0, 70.0, 20.0, 40.0, 290.0, 40.0, 10.0, 250.0, 55.0, 30.0, 40.0, 160.0, -50.0, -30.0, 20.0, 170.0, 450.0, 190.0, -40.0, 10.0, 40.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 0.0, 0.0, 170.0, 210.0, -40.0, -20.0, 170.0, 50.0, 40.0, 300.0, -20.0, 40.0, 50.0, 30.0, 120.0, 660.0, -30.0, 60.0, 180.0, 150.0, 170.0, -10.0, -30.0, 100.0, 75.0, 820.0, 0.0, 190.0, 100.0, 50.0, 300.0, -30.0, 290.0, 20.0, 40.0, 70.0, 60.0, 220.0, 140.0, 70.0, 210.0, 110.0, 0.0, 170.0, 170.0, 270.0, 110.0, 120.0, 150.0, 0.0, 150.0, 10.0, 50.0, 120.0, -10.0, 85.0, 0.0, 60.0, 60.0, 70.0, -15.0, 40.0, 190.0, 40.0, 20.0, 20.0, 20.0, 20.0, 200.0, 70.0, 90.0, 190.0, 440.0, 20.0, -20.0, 210.0, 80.0, 40.0, 90.0, 60.0, -40.0, 300.0, 60.0, 40.0, 390.0, 250.0, 300.0, 80.0, 80.0, 20.0, 60.0, 380.0, 160.0, 15.0, 180.0, 20.0, 40.0, 30.0, 120.0, 30.0, 10.0, 40.0, 80.0, 40.0, 20.0, 40.0, 100.0, 40.0, 150.0, 20.0, 30.0, 20.0, 50.0, 70.0, 70.0, 280.0, 40.0, 130.0, 20.0, 180.0, 100.0, 130.0, 90.0, 130.0, 40.0, 220.0, 80.0, 100.0, 190.0, 280.0, 60.0, 150.0, 90.0, 240.0, 50.0, 30.0, 150.0, 100.0, 80.0, 100.0, 180.0, 120.0, 350.0, 200.0, 10.0, 20.0, 70.0, 90.0, 40.0, 300.0, 240.0, 180.0, 30.0, 90.0, 80.0, 10.0, 60.0, 70.0, 60.0, 10.0, 40.0, 80.0, 80.0, 580.0, 170.0, 60.0, 210.0, 30.0, 20.0, 105.0, 130.0, 70.0, 30.0, 0.0, 50.0, 80.0, 100.0, 40.0, 10.0, 150.0, 25.0, 20.0, 140.0, 130.0, 240.0, 230.0, 40.0, 180.0, 40.0, 90.0, 190.0, -20.0, 160.0, 30.0, 20.0, 40.0, 100.0, 170.0, 60.0, 20.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 30.0, 200.0, 150.0, 380.0, 20.0, 120.0, 80.0, 80.0, 140.0, 100.0, 190.0, 5.0, 40.0, 30.0, 130.0, 65.0, 10.0, 190.0, 30.0, 90.0, 60.0, 30.0, 0.0, 10.0, 100.0, 210.0, 380.0, 190.0, 110.0, 160.0, -50.0, 210.0, 120.0, 170.0, 70.0, 70.0, 20.0, 20.0, 140.0, 10.0, 110.0, 10.0, -40.0, 40.0, 160.0, 20.0, 310.0, 10.0, 250.0, 10.0, 500.0, 140.0, 20.0, 250.0, 80.0, 40.0, 90.0, 100.0, 110.0, 25.0, 285.0, 40.0, 140.0, 170.0, 140.0, 90.0, 110.0, 30.0, 10.0, 20.0, 0.0, 30.0, 160.0, 30.0, 20.0, 270.0, 50.0, -140.0, 10.0, 170.0, 50.0, 30.0, 220.0, -20.0, 240.0, 880.0, 120.0, 380.0, 20.0, 40.0, 800.0, 20.0, 130.0, 40.0, 130.0, -40.0, 40.0, 240.0, 40.0, 380.0, 50.0, 60.0, 160.0, 140.0, 70.0, 140.0, 120.0, 60.0, 60.0, 770.0, -40.0, -30.0, 120.0, 60.0, 40.0, 110.0, 100.0, 50.0, 90.0, 110.0, 230.0, 160.0, 90.0, 80.0, 140.0, 130.0, 170.0, 15.0, 60.0, 50.0, 40.0, 60.0, 180.0, 190.0, 230.0, 130.0, 490.0, 40.0, 50.0, 70.0, 110.0, 180.0, 40.0, 110.0, 70.0, 70.0, 250.0, 20.0, 30.0, 10.0, 10.0, 40.0, 190.0, 55.0, 20.0, 60.0, 140.0, 200.0, 90.0, -180.0, 170.0, 100.0, 190.0, 120.0, 230.0, 260.0, 130.0, 90.0, 110.0, 40.0, 400.0, 200.0, -25.0, 90.0, 80.0, 30.0, 50.0, 190.0, 100.0, 400.0, 30.0, 150.0, 130.0, 160.0, 30.0, -510.0, 190.0, 170.0, 180.0, 260.0, 50.0, 230.0, 0.0, 120.0, 20.0, 10.0, 10.0, 20.0, 70.0, 180.0, 290.0, 400.0, 90.0, 60.0, 30.0, 30.0, 30.0, 230.0, 150.0, 110.0, -20.0, 140.0, 160.0, 20.0, 20.0, 90.0, 60.0, 110.0, 140.0, 40.0, 350.0, 50.0, 260.0, 110.0, 40.0, 130.0, 80.0, 210.0, 90.0, 70.0, 110.0, 200.0, 0.0, 80.0, 100.0, 310.0, 40.0, 220.0, 40.0, 190.0, 70.0, 30.0, 10.0, 210.0, 50.0, 220.0, 120.0, 200.0, 50.0, 150.0, 180.0, 20.0, 40.0, 50.0, 10.0, 100.0, 140.0, 380.0, 40.0, 10.0, 200.0, 10.0, 130.0, 70.0, 110.0, 130.0, 80.0, 180.0, 30.0, 50.0, 150.0, 90.0, 100.0, 580.0, 70.0, 20.0, 0.0, 30.0, 160.0, 70.0, 100.0, 40.0, 0.0, 15.0, 20.0, 110.0, 0.0, 20.0, 50.0, 320.0, 20.0, 200.0, 120.0, 0.0, 60.0, 200.0, 0.0, 100.0, 20.0, 100.0, 0.0, 70.0, 10.0, 10.0, 20.0, 40.0, 450.0, 30.0, 20.0, 90.0, 30.0, 160.0, 110.0, 170.0, 190.0, 180.0, 10.0, 90.0, 150.0, 0.0, 110.0, 110.0, 80.0, 180.0, 120.0, 40.0, -40.0, 640.0, 160.0, 80.0, 40.0, 140.0, 110.0, 140.0, 165.0, 70.0, 50.0, 40.0, 30.0, 120.0, 55.0, 260.0, 110.0, 20.0, -75.0, 30.0, 30.0, 30.0, 15.0, 20.0, 0.0, 25.0, -10.0, 20.0, 20.0, 110.0, -90.0, 10.0, 40.0, 20.0, 30.0, -5.0, -65.0, 20.0, 120.0, 10.0, 40.0, 260.0, 50.0, 50.0, 35.0, 210.0, 260.0, 80.0, -10.0, -40.0, -20.0, 40.0, 60.0, 40.0, 10.0, 90.0, -130.0, 35.0, 80.0, 480.0, 15.0, 30.0, 40.0, 0.0, 70.0, -45.0, 20.0, 30.0, 0.0, 10.0, -35.0, -55.0, 40.0, -75.0, 10.0, 250.0, -30.0, -80.0, 40.0, 110.0, 150.0, 30.0, 20.0, 30.0, 10.0, 120.0, 40.0, 20.0, 140.0, 30.0, 110.0, 280.0, 120.0, 110.0, 170.0, 60.0, 40.0, 180.0, 0.0, 100.0, -20.0, 40.0, 60.0, 20.0, 60.0, -30.0, 90.0, 55.0, 40.0, 260.0, 140.0, 60.0, 80.0, 260.0, 20.0, 60.0, 160.0, 130.0, 150.0, 30.0, 120.0, 90.0, 50.0, 200.0, 20.0, 70.0, 110.0, 0.0, 70.0, 420.0, 30.0, 30.0, 0.0, 5.0, 10.0, 0.0, 70.0, 100.0, 20.0, 40.0, 150.0, 100.0, 40.0, 350.0, 130.0, 80.0, 270.0, 60.0, 120.0, 90.0, 40.0, 20.0, 200.0, 70.0, 100.0, 90.0, 610.0, 180.0, 80.0, 10.0, 35.0, 10.0, 20.0, 10.0, 80.0, -5.0, 60.0, 30.0, 60.0, 70.0, 20.0, -30.0, 60.0, 20.0, 30.0, 0.0, 40.0, 170.0, 10.0, 30.0, 150.0, 180.0, 20.0, 5.0, 60.0, 80.0, 0.0, 40.0, 60.0, 0.0, 100.0, 15.0, 40.0, 10.0, 80.0, 180.0, 20.0, 180.0, 70.0, 40.0, 40.0, 0.0, 30.0, 20.0, 10.0, 80.0, 20.0, 0.0, 20.0, 40.0, 15.0, 35.0, 15.0, 0.0, 10.0, 100.0, 70.0, 0.0, 190.0, -10.0, 360.0, 20.0, 85.0, 110.0, 60.0, 70.0, 30.0, 80.0, -55.0, 250.0, 130.0, 50.0, 310.0, 140.0, 110.0, 20.0, 190.0, 50.0, 150.0, 30.0, 100.0, 20.0, -45.0, 250.0, 140.0, 40.0, 130.0, 110.0, 90.0, 290.0, 100.0, 290.0, 60.0, 70.0, 90.0, 20.0, 100.0, 360.0, 100.0, 40.0, 190.0, 50.0, 70.0, 125.0, 250.0, 90.0, 30.0, 80.0, 80.0, -5.0, 160.0, 210.0, 30.0, 10.0, 50.0, 60.0, 10.0, 60.0, 10.0, 10.0, 160.0, 20.0, 40.0, 50.0, 20.0, 120.0, 35.0, 180.0, 240.0, 190.0, 80.0, 30.0, 120.0, 100.0, 50.0, 50.0, 190.0, 30.0, 160.0, 50.0, 100.0, 140.0, 90.0, -40.0, -75.0, 70.0, 90.0, 70.0, 20.0, 210.0, 30.0, 280.0, 30.0, 25.0, 30.0, 160.0, 290.0, 50.0, 30.0, 50.0, 40.0, 20.0, 120.0, 40.0, 140.0, 240.0, 150.0, 20.0, -10.0, 40.0, 160.0, 310.0, 50.0, -50.0, 70.0, 50.0, 110.0, 60.0, 235.0, -60.0, 20.0, 0.0, 40.0, 200.0, 130.0, 40.0, 20.0, 80.0, 40.0, 250.0, 90.0, 60.0, 80.0, 400.0, 60.0, 60.0, 370.0, 90.0, 110.0, 180.0, 10.0, 20.0, 10.0, 120.0, 140.0, 0.0, 0.0, -5.0, 20.0, 10.0, -110.0, 380.0, 390.0, 110.0, 40.0, 20.0, 60.0, 80.0, 210.0, 110.0, 70.0, 110.0, 20.0, -20.0, 40.0, 140.0, 410.0, 40.0, 80.0, 370.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5137302762741172, "mean_inference_ms": 1.4140057193148567, "mean_action_processing_ms": 0.42867029827897335, "mean_env_wait_ms": 1.252967744992561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013697385787963867, "StateBufferConnector_ms": 0.01023411750793457, "ViewRequirementAgentConnector_ms": 0.42069029808044434}, "num_episodes": 18, "episode_return_max": 1660.0, "episode_return_min": 90.0, "episode_return_mean": 930.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.463277958793398, "num_env_steps_trained_throughput_per_sec": 21.463277958793398, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 3520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3520000, "timers": {"training_iteration_time_ms": 187108.367, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187108.322, "sample_time_ms": 2574.725, "learn_time_ms": 184514.377, "learn_throughput": 21.679, "synch_weights_time_ms": 12.021}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "done": false, "training_iteration": 88, "trial_id": "90816_00000", "date": "2024-06-10_04-48-01", "timestamp": 1718009281, "time_this_iter_s": 186.37424778938293, "time_total_s": 16559.131530046463, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b012b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16559.131530046463, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.711742424242424, "ram_util_percent": 79.09848484848486}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.417865066019237, "cur_kl_coeff": 0.4271484374999999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008149817510467335, "vf_loss": 7.585769711261867, "vf_explained_var": -0.0003339997178322464, "kl": Infinity, "entropy": 0.37320662668813914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 831015.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 90.0, "episode_reward_mean": 1000.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -510.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 100.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1500.0, 530.0, 1455.0, 505.0, 1260.0, 690.0, 1060.0, 860.0, 730.0, 1430.0, 490.0, 1610.0, 1190.0, 680.0, 1490.0, 1640.0, 1320.0, 1270.0, 1180.0, 1125.0, 1230.0, 685.0, 1320.0, 1145.0, 730.0, 1230.0, 1180.0, 930.0, 1290.0, 1250.0, 1080.0, 920.0, 1220.0, 1350.0, 545.0, 990.0, 370.0, 1430.0, 890.0, 1505.0, 640.0, 260.0, 90.0, 935.0, 685.0, 170.0, 175.0, 590.0, 1170.0, 575.0, 1090.0, 1150.0, 305.0, 1390.0, 1400.0, 370.0, 350.0, 595.0, 735.0, 260.0, 425.0, 1010.0, 1180.0, 1125.0, 1230.0, 960.0, 610.0, 1055.0, 860.0, 675.0, 975.0, 800.0, 935.0, 820.0, 1500.0, 325.0, 1290.0, 1260.0, 1920.0, 805.0, 1565.0, 1075.0, 1230.0, 1140.0, 1120.0, 1000.0, 1530.0, 790.0, 1030.0, 905.0, 1120.0, 1450.0, 260.0, 850.0, 2225.0, 1320.0, 1080.0, 1315.0, 1480.0, 1550.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [350.0, 200.0, 10.0, 20.0, 70.0, 90.0, 40.0, 300.0, 240.0, 180.0, 30.0, 90.0, 80.0, 10.0, 60.0, 70.0, 60.0, 10.0, 40.0, 80.0, 80.0, 580.0, 170.0, 60.0, 210.0, 30.0, 20.0, 105.0, 130.0, 70.0, 30.0, 0.0, 50.0, 80.0, 100.0, 40.0, 10.0, 150.0, 25.0, 20.0, 140.0, 130.0, 240.0, 230.0, 40.0, 180.0, 40.0, 90.0, 190.0, -20.0, 160.0, 30.0, 20.0, 40.0, 100.0, 170.0, 60.0, 20.0, 0.0, 90.0, 50.0, 10.0, 80.0, 20.0, 30.0, 200.0, 150.0, 380.0, 20.0, 120.0, 80.0, 80.0, 140.0, 100.0, 190.0, 5.0, 40.0, 30.0, 130.0, 65.0, 10.0, 190.0, 30.0, 90.0, 60.0, 30.0, 0.0, 10.0, 100.0, 210.0, 380.0, 190.0, 110.0, 160.0, -50.0, 210.0, 120.0, 170.0, 70.0, 70.0, 20.0, 20.0, 140.0, 10.0, 110.0, 10.0, -40.0, 40.0, 160.0, 20.0, 310.0, 10.0, 250.0, 10.0, 500.0, 140.0, 20.0, 250.0, 80.0, 40.0, 90.0, 100.0, 110.0, 25.0, 285.0, 40.0, 140.0, 170.0, 140.0, 90.0, 110.0, 30.0, 10.0, 20.0, 0.0, 30.0, 160.0, 30.0, 20.0, 270.0, 50.0, -140.0, 10.0, 170.0, 50.0, 30.0, 220.0, -20.0, 240.0, 880.0, 120.0, 380.0, 20.0, 40.0, 800.0, 20.0, 130.0, 40.0, 130.0, -40.0, 40.0, 240.0, 40.0, 380.0, 50.0, 60.0, 160.0, 140.0, 70.0, 140.0, 120.0, 60.0, 60.0, 770.0, -40.0, -30.0, 120.0, 60.0, 40.0, 110.0, 100.0, 50.0, 90.0, 110.0, 230.0, 160.0, 90.0, 80.0, 140.0, 130.0, 170.0, 15.0, 60.0, 50.0, 40.0, 60.0, 180.0, 190.0, 230.0, 130.0, 490.0, 40.0, 50.0, 70.0, 110.0, 180.0, 40.0, 110.0, 70.0, 70.0, 250.0, 20.0, 30.0, 10.0, 10.0, 40.0, 190.0, 55.0, 20.0, 60.0, 140.0, 200.0, 90.0, -180.0, 170.0, 100.0, 190.0, 120.0, 230.0, 260.0, 130.0, 90.0, 110.0, 40.0, 400.0, 200.0, -25.0, 90.0, 80.0, 30.0, 50.0, 190.0, 100.0, 400.0, 30.0, 150.0, 130.0, 160.0, 30.0, -510.0, 190.0, 170.0, 180.0, 260.0, 50.0, 230.0, 0.0, 120.0, 20.0, 10.0, 10.0, 20.0, 70.0, 180.0, 290.0, 400.0, 90.0, 60.0, 30.0, 30.0, 30.0, 230.0, 150.0, 110.0, -20.0, 140.0, 160.0, 20.0, 20.0, 90.0, 60.0, 110.0, 140.0, 40.0, 350.0, 50.0, 260.0, 110.0, 40.0, 130.0, 80.0, 210.0, 90.0, 70.0, 110.0, 200.0, 0.0, 80.0, 100.0, 310.0, 40.0, 220.0, 40.0, 190.0, 70.0, 30.0, 10.0, 210.0, 50.0, 220.0, 120.0, 200.0, 50.0, 150.0, 180.0, 20.0, 40.0, 50.0, 10.0, 100.0, 140.0, 380.0, 40.0, 10.0, 200.0, 10.0, 130.0, 70.0, 110.0, 130.0, 80.0, 180.0, 30.0, 50.0, 150.0, 90.0, 100.0, 580.0, 70.0, 20.0, 0.0, 30.0, 160.0, 70.0, 100.0, 40.0, 0.0, 15.0, 20.0, 110.0, 0.0, 20.0, 50.0, 320.0, 20.0, 200.0, 120.0, 0.0, 60.0, 200.0, 0.0, 100.0, 20.0, 100.0, 0.0, 70.0, 10.0, 10.0, 20.0, 40.0, 450.0, 30.0, 20.0, 90.0, 30.0, 160.0, 110.0, 170.0, 190.0, 180.0, 10.0, 90.0, 150.0, 0.0, 110.0, 110.0, 80.0, 180.0, 120.0, 40.0, -40.0, 640.0, 160.0, 80.0, 40.0, 140.0, 110.0, 140.0, 165.0, 70.0, 50.0, 40.0, 30.0, 120.0, 55.0, 260.0, 110.0, 20.0, -75.0, 30.0, 30.0, 30.0, 15.0, 20.0, 0.0, 25.0, -10.0, 20.0, 20.0, 110.0, -90.0, 10.0, 40.0, 20.0, 30.0, -5.0, -65.0, 20.0, 120.0, 10.0, 40.0, 260.0, 50.0, 50.0, 35.0, 210.0, 260.0, 80.0, -10.0, -40.0, -20.0, 40.0, 60.0, 40.0, 10.0, 90.0, -130.0, 35.0, 80.0, 480.0, 15.0, 30.0, 40.0, 0.0, 70.0, -45.0, 20.0, 30.0, 0.0, 10.0, -35.0, -55.0, 40.0, -75.0, 10.0, 250.0, -30.0, -80.0, 40.0, 110.0, 150.0, 30.0, 20.0, 30.0, 10.0, 120.0, 40.0, 20.0, 140.0, 30.0, 110.0, 280.0, 120.0, 110.0, 170.0, 60.0, 40.0, 180.0, 0.0, 100.0, -20.0, 40.0, 60.0, 20.0, 60.0, -30.0, 90.0, 55.0, 40.0, 260.0, 140.0, 60.0, 80.0, 260.0, 20.0, 60.0, 160.0, 130.0, 150.0, 30.0, 120.0, 90.0, 50.0, 200.0, 20.0, 70.0, 110.0, 0.0, 70.0, 420.0, 30.0, 30.0, 0.0, 5.0, 10.0, 0.0, 70.0, 100.0, 20.0, 40.0, 150.0, 100.0, 40.0, 350.0, 130.0, 80.0, 270.0, 60.0, 120.0, 90.0, 40.0, 20.0, 200.0, 70.0, 100.0, 90.0, 610.0, 180.0, 80.0, 10.0, 35.0, 10.0, 20.0, 10.0, 80.0, -5.0, 60.0, 30.0, 60.0, 70.0, 20.0, -30.0, 60.0, 20.0, 30.0, 0.0, 40.0, 170.0, 10.0, 30.0, 150.0, 180.0, 20.0, 5.0, 60.0, 80.0, 0.0, 40.0, 60.0, 0.0, 100.0, 15.0, 40.0, 10.0, 80.0, 180.0, 20.0, 180.0, 70.0, 40.0, 40.0, 0.0, 30.0, 20.0, 10.0, 80.0, 20.0, 0.0, 20.0, 40.0, 15.0, 35.0, 15.0, 0.0, 10.0, 100.0, 70.0, 0.0, 190.0, -10.0, 360.0, 20.0, 85.0, 110.0, 60.0, 70.0, 30.0, 80.0, -55.0, 250.0, 130.0, 50.0, 310.0, 140.0, 110.0, 20.0, 190.0, 50.0, 150.0, 30.0, 100.0, 20.0, -45.0, 250.0, 140.0, 40.0, 130.0, 110.0, 90.0, 290.0, 100.0, 290.0, 60.0, 70.0, 90.0, 20.0, 100.0, 360.0, 100.0, 40.0, 190.0, 50.0, 70.0, 125.0, 250.0, 90.0, 30.0, 80.0, 80.0, -5.0, 160.0, 210.0, 30.0, 10.0, 50.0, 60.0, 10.0, 60.0, 10.0, 10.0, 160.0, 20.0, 40.0, 50.0, 20.0, 120.0, 35.0, 180.0, 240.0, 190.0, 80.0, 30.0, 120.0, 100.0, 50.0, 50.0, 190.0, 30.0, 160.0, 50.0, 100.0, 140.0, 90.0, -40.0, -75.0, 70.0, 90.0, 70.0, 20.0, 210.0, 30.0, 280.0, 30.0, 25.0, 30.0, 160.0, 290.0, 50.0, 30.0, 50.0, 40.0, 20.0, 120.0, 40.0, 140.0, 240.0, 150.0, 20.0, -10.0, 40.0, 160.0, 310.0, 50.0, -50.0, 70.0, 50.0, 110.0, 60.0, 235.0, -60.0, 20.0, 0.0, 40.0, 200.0, 130.0, 40.0, 20.0, 80.0, 40.0, 250.0, 90.0, 60.0, 80.0, 400.0, 60.0, 60.0, 370.0, 90.0, 110.0, 180.0, 10.0, 20.0, 10.0, 120.0, 140.0, 0.0, 0.0, -5.0, 20.0, 10.0, -110.0, 380.0, 390.0, 110.0, 40.0, 20.0, 60.0, 80.0, 210.0, 110.0, 70.0, 110.0, 20.0, -20.0, 40.0, 140.0, 410.0, 40.0, 80.0, 370.0, 300.0, 190.0, 240.0, 90.0, 0.0, 100.0, 440.0, 50.0, 40.0, 470.0, 80.0, 20.0, 80.0, 40.0, 60.0, 130.0, 210.0, 160.0, 15.0, 10.0, 50.0, 50.0, 110.0, 90.0, 190.0, 10.0, -15.0, 500.0, 530.0, 50.0, 155.0, 170.0, 10.0, 20.0, 0.0, 100.0, 50.0, 380.0, 10.0, 180.0, 140.0, 30.0, 40.0, 50.0, 120.0, 0.0, 610.0, 50.0, 220.0, -30.0, 80.0, 20.0, 300.0, 70.0, 10.0, 30.0, 0.0, 280.0, 170.0, 180.0, 60.0, 40.0, 50.0, 60.0, 60.0, 50.0, 90.0, 90.0, 440.0, 180.0, 80.0, -90.0, -30.0, 180.0, 220.0, 0.0, -50.0, 70.0, 130.0, 490.0, 510.0, 30.0, 190.0, -60.0, 40.0, 80.0, 70.0, 210.0, 370.0, 90.0, 70.0, 80.0, 30.0, 180.0, 80.0, 30.0, 170.0, 80.0, 20.0, 50.0, 200.0, 30.0, 150.0, 110.0, -40.0, 20.0, 280.0, 160.0, 80.0, 40.0, 40.0, 180.0, 5.0, 50.0, 130.0, 40.0, 40.0, 80.0, 320.0, 20.0, -10.0, 200.0, 40.0, -20.0, 180.0, 60.0, 240.0, 290.0, 80.0, 60.0, 330.0, 100.0, 70.0, 400.0, 80.0, 50.0, 130.0, 130.0, 140.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 80.0, 20.0, 20.0, 20.0, 40.0, 60.0, 20.0, 150.0, 50.0, 100.0, 210.0, 90.0, 30.0, 90.0, 50.0, 130.0, 0.0, 240.0, 210.0, 850.0, -15.0, 500.0, 50.0, 10.0, 250.0, 10.0, 90.0, 290.0, 200.0, 290.0, 30.0, 300.0, 40.0, 40.0, 30.0, 20.0, 290.0, 80.0, 280.0, 60.0, -50.0, 130.0, 100.0, 80.0, 90.0, 25.0, 40.0, 150.0, 60.0, 70.0, 60.0, 0.0, 680.0, -30.0, 260.0, 160.0, 40.0, 330.0, 50.0, -10.0, 70.0, 210.0, 120.0, 70.0, 440.0, 50.0, 150.0, 170.0, 0.0, 320.0, 60.0, 350.0, 40.0, 50.0, 360.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5144914036506054, "mean_inference_ms": 1.415649297157275, "mean_action_processing_ms": 0.4299513641674349, "mean_env_wait_ms": 1.2534062396056111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013484001159667969, "StateBufferConnector_ms": 0.010119438171386719, "ViewRequirementAgentConnector_ms": 0.42112135887145996}, "num_episodes": 22, "episode_return_max": 2225.0, "episode_return_min": 90.0, "episode_return_mean": 1000.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.646128773506486, "num_env_steps_trained_throughput_per_sec": 21.646128773506486, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 3560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3560000, "timers": {"training_iteration_time_ms": 187014.487, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187014.441, "sample_time_ms": 2576.785, "learn_time_ms": 184418.21, "learn_throughput": 21.69, "synch_weights_time_ms": 12.279}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "done": false, "training_iteration": 89, "trial_id": "90816_00000", "date": "2024-06-10_04-51-06", "timestamp": 1718009466, "time_this_iter_s": 184.7996642589569, "time_total_s": 16743.93119430542, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b012bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16743.93119430542, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 16.920689655172414, "ram_util_percent": 78.94099616858239}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.34270457216599, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.046413859823387, "policy_loss": -0.008508516116741216, "vf_loss": 7.052529645042298, "vf_explained_var": -0.00031161939247220725, "kl": 0.003734420593443702, "entropy": 0.41009164511268764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 840405.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 90.0, "episode_reward_mean": 1005.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -510.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 100.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1180.0, 1125.0, 1230.0, 685.0, 1320.0, 1145.0, 730.0, 1230.0, 1180.0, 930.0, 1290.0, 1250.0, 1080.0, 920.0, 1220.0, 1350.0, 545.0, 990.0, 370.0, 1430.0, 890.0, 1505.0, 640.0, 260.0, 90.0, 935.0, 685.0, 170.0, 175.0, 590.0, 1170.0, 575.0, 1090.0, 1150.0, 305.0, 1390.0, 1400.0, 370.0, 350.0, 595.0, 735.0, 260.0, 425.0, 1010.0, 1180.0, 1125.0, 1230.0, 960.0, 610.0, 1055.0, 860.0, 675.0, 975.0, 800.0, 935.0, 820.0, 1500.0, 325.0, 1290.0, 1260.0, 1920.0, 805.0, 1565.0, 1075.0, 1230.0, 1140.0, 1120.0, 1000.0, 1530.0, 790.0, 1030.0, 905.0, 1120.0, 1450.0, 260.0, 850.0, 2225.0, 1320.0, 1080.0, 1315.0, 1480.0, 1550.0, 1230.0, 1130.0, 1220.0, 1260.0, 935.0, 1140.0, 1315.0, 1050.0, 575.0, 1330.0, 1150.0, 2110.0, 820.0, 400.0, 1290.0, 915.0, 655.0, 1710.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 50.0, 90.0, 110.0, 230.0, 160.0, 90.0, 80.0, 140.0, 130.0, 170.0, 15.0, 60.0, 50.0, 40.0, 60.0, 180.0, 190.0, 230.0, 130.0, 490.0, 40.0, 50.0, 70.0, 110.0, 180.0, 40.0, 110.0, 70.0, 70.0, 250.0, 20.0, 30.0, 10.0, 10.0, 40.0, 190.0, 55.0, 20.0, 60.0, 140.0, 200.0, 90.0, -180.0, 170.0, 100.0, 190.0, 120.0, 230.0, 260.0, 130.0, 90.0, 110.0, 40.0, 400.0, 200.0, -25.0, 90.0, 80.0, 30.0, 50.0, 190.0, 100.0, 400.0, 30.0, 150.0, 130.0, 160.0, 30.0, -510.0, 190.0, 170.0, 180.0, 260.0, 50.0, 230.0, 0.0, 120.0, 20.0, 10.0, 10.0, 20.0, 70.0, 180.0, 290.0, 400.0, 90.0, 60.0, 30.0, 30.0, 30.0, 230.0, 150.0, 110.0, -20.0, 140.0, 160.0, 20.0, 20.0, 90.0, 60.0, 110.0, 140.0, 40.0, 350.0, 50.0, 260.0, 110.0, 40.0, 130.0, 80.0, 210.0, 90.0, 70.0, 110.0, 200.0, 0.0, 80.0, 100.0, 310.0, 40.0, 220.0, 40.0, 190.0, 70.0, 30.0, 10.0, 210.0, 50.0, 220.0, 120.0, 200.0, 50.0, 150.0, 180.0, 20.0, 40.0, 50.0, 10.0, 100.0, 140.0, 380.0, 40.0, 10.0, 200.0, 10.0, 130.0, 70.0, 110.0, 130.0, 80.0, 180.0, 30.0, 50.0, 150.0, 90.0, 100.0, 580.0, 70.0, 20.0, 0.0, 30.0, 160.0, 70.0, 100.0, 40.0, 0.0, 15.0, 20.0, 110.0, 0.0, 20.0, 50.0, 320.0, 20.0, 200.0, 120.0, 0.0, 60.0, 200.0, 0.0, 100.0, 20.0, 100.0, 0.0, 70.0, 10.0, 10.0, 20.0, 40.0, 450.0, 30.0, 20.0, 90.0, 30.0, 160.0, 110.0, 170.0, 190.0, 180.0, 10.0, 90.0, 150.0, 0.0, 110.0, 110.0, 80.0, 180.0, 120.0, 40.0, -40.0, 640.0, 160.0, 80.0, 40.0, 140.0, 110.0, 140.0, 165.0, 70.0, 50.0, 40.0, 30.0, 120.0, 55.0, 260.0, 110.0, 20.0, -75.0, 30.0, 30.0, 30.0, 15.0, 20.0, 0.0, 25.0, -10.0, 20.0, 20.0, 110.0, -90.0, 10.0, 40.0, 20.0, 30.0, -5.0, -65.0, 20.0, 120.0, 10.0, 40.0, 260.0, 50.0, 50.0, 35.0, 210.0, 260.0, 80.0, -10.0, -40.0, -20.0, 40.0, 60.0, 40.0, 10.0, 90.0, -130.0, 35.0, 80.0, 480.0, 15.0, 30.0, 40.0, 0.0, 70.0, -45.0, 20.0, 30.0, 0.0, 10.0, -35.0, -55.0, 40.0, -75.0, 10.0, 250.0, -30.0, -80.0, 40.0, 110.0, 150.0, 30.0, 20.0, 30.0, 10.0, 120.0, 40.0, 20.0, 140.0, 30.0, 110.0, 280.0, 120.0, 110.0, 170.0, 60.0, 40.0, 180.0, 0.0, 100.0, -20.0, 40.0, 60.0, 20.0, 60.0, -30.0, 90.0, 55.0, 40.0, 260.0, 140.0, 60.0, 80.0, 260.0, 20.0, 60.0, 160.0, 130.0, 150.0, 30.0, 120.0, 90.0, 50.0, 200.0, 20.0, 70.0, 110.0, 0.0, 70.0, 420.0, 30.0, 30.0, 0.0, 5.0, 10.0, 0.0, 70.0, 100.0, 20.0, 40.0, 150.0, 100.0, 40.0, 350.0, 130.0, 80.0, 270.0, 60.0, 120.0, 90.0, 40.0, 20.0, 200.0, 70.0, 100.0, 90.0, 610.0, 180.0, 80.0, 10.0, 35.0, 10.0, 20.0, 10.0, 80.0, -5.0, 60.0, 30.0, 60.0, 70.0, 20.0, -30.0, 60.0, 20.0, 30.0, 0.0, 40.0, 170.0, 10.0, 30.0, 150.0, 180.0, 20.0, 5.0, 60.0, 80.0, 0.0, 40.0, 60.0, 0.0, 100.0, 15.0, 40.0, 10.0, 80.0, 180.0, 20.0, 180.0, 70.0, 40.0, 40.0, 0.0, 30.0, 20.0, 10.0, 80.0, 20.0, 0.0, 20.0, 40.0, 15.0, 35.0, 15.0, 0.0, 10.0, 100.0, 70.0, 0.0, 190.0, -10.0, 360.0, 20.0, 85.0, 110.0, 60.0, 70.0, 30.0, 80.0, -55.0, 250.0, 130.0, 50.0, 310.0, 140.0, 110.0, 20.0, 190.0, 50.0, 150.0, 30.0, 100.0, 20.0, -45.0, 250.0, 140.0, 40.0, 130.0, 110.0, 90.0, 290.0, 100.0, 290.0, 60.0, 70.0, 90.0, 20.0, 100.0, 360.0, 100.0, 40.0, 190.0, 50.0, 70.0, 125.0, 250.0, 90.0, 30.0, 80.0, 80.0, -5.0, 160.0, 210.0, 30.0, 10.0, 50.0, 60.0, 10.0, 60.0, 10.0, 10.0, 160.0, 20.0, 40.0, 50.0, 20.0, 120.0, 35.0, 180.0, 240.0, 190.0, 80.0, 30.0, 120.0, 100.0, 50.0, 50.0, 190.0, 30.0, 160.0, 50.0, 100.0, 140.0, 90.0, -40.0, -75.0, 70.0, 90.0, 70.0, 20.0, 210.0, 30.0, 280.0, 30.0, 25.0, 30.0, 160.0, 290.0, 50.0, 30.0, 50.0, 40.0, 20.0, 120.0, 40.0, 140.0, 240.0, 150.0, 20.0, -10.0, 40.0, 160.0, 310.0, 50.0, -50.0, 70.0, 50.0, 110.0, 60.0, 235.0, -60.0, 20.0, 0.0, 40.0, 200.0, 130.0, 40.0, 20.0, 80.0, 40.0, 250.0, 90.0, 60.0, 80.0, 400.0, 60.0, 60.0, 370.0, 90.0, 110.0, 180.0, 10.0, 20.0, 10.0, 120.0, 140.0, 0.0, 0.0, -5.0, 20.0, 10.0, -110.0, 380.0, 390.0, 110.0, 40.0, 20.0, 60.0, 80.0, 210.0, 110.0, 70.0, 110.0, 20.0, -20.0, 40.0, 140.0, 410.0, 40.0, 80.0, 370.0, 300.0, 190.0, 240.0, 90.0, 0.0, 100.0, 440.0, 50.0, 40.0, 470.0, 80.0, 20.0, 80.0, 40.0, 60.0, 130.0, 210.0, 160.0, 15.0, 10.0, 50.0, 50.0, 110.0, 90.0, 190.0, 10.0, -15.0, 500.0, 530.0, 50.0, 155.0, 170.0, 10.0, 20.0, 0.0, 100.0, 50.0, 380.0, 10.0, 180.0, 140.0, 30.0, 40.0, 50.0, 120.0, 0.0, 610.0, 50.0, 220.0, -30.0, 80.0, 20.0, 300.0, 70.0, 10.0, 30.0, 0.0, 280.0, 170.0, 180.0, 60.0, 40.0, 50.0, 60.0, 60.0, 50.0, 90.0, 90.0, 440.0, 180.0, 80.0, -90.0, -30.0, 180.0, 220.0, 0.0, -50.0, 70.0, 130.0, 490.0, 510.0, 30.0, 190.0, -60.0, 40.0, 80.0, 70.0, 210.0, 370.0, 90.0, 70.0, 80.0, 30.0, 180.0, 80.0, 30.0, 170.0, 80.0, 20.0, 50.0, 200.0, 30.0, 150.0, 110.0, -40.0, 20.0, 280.0, 160.0, 80.0, 40.0, 40.0, 180.0, 5.0, 50.0, 130.0, 40.0, 40.0, 80.0, 320.0, 20.0, -10.0, 200.0, 40.0, -20.0, 180.0, 60.0, 240.0, 290.0, 80.0, 60.0, 330.0, 100.0, 70.0, 400.0, 80.0, 50.0, 130.0, 130.0, 140.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 80.0, 20.0, 20.0, 20.0, 40.0, 60.0, 20.0, 150.0, 50.0, 100.0, 210.0, 90.0, 30.0, 90.0, 50.0, 130.0, 0.0, 240.0, 210.0, 850.0, -15.0, 500.0, 50.0, 10.0, 250.0, 10.0, 90.0, 290.0, 200.0, 290.0, 30.0, 300.0, 40.0, 40.0, 30.0, 20.0, 290.0, 80.0, 280.0, 60.0, -50.0, 130.0, 100.0, 80.0, 90.0, 25.0, 40.0, 150.0, 60.0, 70.0, 60.0, 0.0, 680.0, -30.0, 260.0, 160.0, 40.0, 330.0, 50.0, -10.0, 70.0, 210.0, 120.0, 70.0, 440.0, 50.0, 150.0, 170.0, 0.0, 320.0, 60.0, 350.0, 40.0, 50.0, 360.0, 280.0, 70.0, 100.0, 300.0, 180.0, -20.0, 30.0, 50.0, 150.0, 90.0, 30.0, -30.0, 600.0, -45.0, 90.0, -40.0, 510.0, 70.0, -25.0, -30.0, 0.0, 245.0, 30.0, 190.0, 400.0, 30.0, -45.0, 110.0, 80.0, 180.0, 80.0, 330.0, 170.0, 80.0, 100.0, 250.0, 220.0, 30.0, 40.0, -40.0, 20.0, 70.0, 0.0, 80.0, 0.0, 240.0, 180.0, 140.0, 35.0, 170.0, 170.0, 200.0, 50.0, 0.0, 40.0, 170.0, -20.0, 260.0, 110.0, 160.0, 40.0, 20.0, 10.0, 790.0, 190.0, 0.0, 230.0, 20.0, -5.0, 20.0, 40.0, 160.0, 40.0, 110.0, 100.0, 160.0, 30.0, 180.0, 40.0, 190.0, 5.0, 40.0, 15.0, 80.0, 25.0, 40.0, 60.0, 20.0, 180.0, 110.0, 100.0, 130.0, 100.0, 40.0, 60.0, 100.0, 140.0, 340.0, 90.0, 230.0, 140.0, 10.0, -10.0, 10.0, 20.0, -30.0, 100.0, 190.0, 40.0, 680.0, 70.0, 50.0, 160.0, 740.0, 120.0, 380.0, 360.0, 70.0, 200.0, -40.0, 140.0, 120.0, 30.0, 30.0, 10.0, 20.0, 40.0, 20.0, 40.0, 370.0, -5.0, 20.0, 20.0, 70.0, 70.0, 15.0, 20.0, 30.0, 90.0, 70.0, 380.0, 110.0, 130.0, 170.0, 130.0, 0.0, -140.0, 50.0, 360.0, 100.0, 270.0, 60.0, 60.0, 290.0, 20.0, 50.0, 50.0, 30.0, 50.0, 35.0, 60.0, 0.0, 30.0, 5.0, 290.0, 110.0, 40.0, 20.0, 20.0, 80.0, 380.0, 40.0, 190.0, 100.0, 540.0, 20.0, 90.0, 140.0, 120.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.514403739051681, "mean_inference_ms": 1.4159558679901847, "mean_action_processing_ms": 0.4310932840273163, "mean_env_wait_ms": 1.2540971553011258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013276338577270508, "StateBufferConnector_ms": 0.009914636611938477, "ViewRequirementAgentConnector_ms": 0.42582225799560547}, "num_episodes": 18, "episode_return_max": 2225.0, "episode_return_min": 90.0, "episode_return_mean": 1005.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.336147995007693, "num_env_steps_trained_throughput_per_sec": 21.336147995007693, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 3600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3600000, "timers": {"training_iteration_time_ms": 186907.468, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186907.421, "sample_time_ms": 2593.909, "learn_time_ms": 184294.047, "learn_throughput": 21.704, "synch_weights_time_ms": 12.264}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "done": false, "training_iteration": 90, "trial_id": "90816_00000", "date": "2024-06-10_04-54-13", "timestamp": 1718009653, "time_this_iter_s": 187.48611783981323, "time_total_s": 16931.417312145233, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b012bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16931.417312145233, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.978490566037735, "ram_util_percent": 79.11849056603774}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1574918322415906, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008848095931538258, "vf_loss": 6.97467184269898, "vf_explained_var": -0.0003502360040260453, "kl": Infinity, "entropy": 0.40348203352655465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 849795.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 40.0, "episode_reward_mean": 953.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -330.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 95.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [260.0, 90.0, 935.0, 685.0, 170.0, 175.0, 590.0, 1170.0, 575.0, 1090.0, 1150.0, 305.0, 1390.0, 1400.0, 370.0, 350.0, 595.0, 735.0, 260.0, 425.0, 1010.0, 1180.0, 1125.0, 1230.0, 960.0, 610.0, 1055.0, 860.0, 675.0, 975.0, 800.0, 935.0, 820.0, 1500.0, 325.0, 1290.0, 1260.0, 1920.0, 805.0, 1565.0, 1075.0, 1230.0, 1140.0, 1120.0, 1000.0, 1530.0, 790.0, 1030.0, 905.0, 1120.0, 1450.0, 260.0, 850.0, 2225.0, 1320.0, 1080.0, 1315.0, 1480.0, 1550.0, 1230.0, 1130.0, 1220.0, 1260.0, 935.0, 1140.0, 1315.0, 1050.0, 575.0, 1330.0, 1150.0, 2110.0, 820.0, 400.0, 1290.0, 915.0, 655.0, 1710.0, 780.0, 1560.0, 1180.0, 40.0, 1430.0, 590.0, 640.0, 610.0, 545.0, 1425.0, 900.0, 300.0, 710.0, 1320.0, 890.0, 860.0, 1005.0, 290.0, 520.0, 820.0, 760.0, 450.0, 1410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 15.0, 20.0, 0.0, 25.0, -10.0, 20.0, 20.0, 110.0, -90.0, 10.0, 40.0, 20.0, 30.0, -5.0, -65.0, 20.0, 120.0, 10.0, 40.0, 260.0, 50.0, 50.0, 35.0, 210.0, 260.0, 80.0, -10.0, -40.0, -20.0, 40.0, 60.0, 40.0, 10.0, 90.0, -130.0, 35.0, 80.0, 480.0, 15.0, 30.0, 40.0, 0.0, 70.0, -45.0, 20.0, 30.0, 0.0, 10.0, -35.0, -55.0, 40.0, -75.0, 10.0, 250.0, -30.0, -80.0, 40.0, 110.0, 150.0, 30.0, 20.0, 30.0, 10.0, 120.0, 40.0, 20.0, 140.0, 30.0, 110.0, 280.0, 120.0, 110.0, 170.0, 60.0, 40.0, 180.0, 0.0, 100.0, -20.0, 40.0, 60.0, 20.0, 60.0, -30.0, 90.0, 55.0, 40.0, 260.0, 140.0, 60.0, 80.0, 260.0, 20.0, 60.0, 160.0, 130.0, 150.0, 30.0, 120.0, 90.0, 50.0, 200.0, 20.0, 70.0, 110.0, 0.0, 70.0, 420.0, 30.0, 30.0, 0.0, 5.0, 10.0, 0.0, 70.0, 100.0, 20.0, 40.0, 150.0, 100.0, 40.0, 350.0, 130.0, 80.0, 270.0, 60.0, 120.0, 90.0, 40.0, 20.0, 200.0, 70.0, 100.0, 90.0, 610.0, 180.0, 80.0, 10.0, 35.0, 10.0, 20.0, 10.0, 80.0, -5.0, 60.0, 30.0, 60.0, 70.0, 20.0, -30.0, 60.0, 20.0, 30.0, 0.0, 40.0, 170.0, 10.0, 30.0, 150.0, 180.0, 20.0, 5.0, 60.0, 80.0, 0.0, 40.0, 60.0, 0.0, 100.0, 15.0, 40.0, 10.0, 80.0, 180.0, 20.0, 180.0, 70.0, 40.0, 40.0, 0.0, 30.0, 20.0, 10.0, 80.0, 20.0, 0.0, 20.0, 40.0, 15.0, 35.0, 15.0, 0.0, 10.0, 100.0, 70.0, 0.0, 190.0, -10.0, 360.0, 20.0, 85.0, 110.0, 60.0, 70.0, 30.0, 80.0, -55.0, 250.0, 130.0, 50.0, 310.0, 140.0, 110.0, 20.0, 190.0, 50.0, 150.0, 30.0, 100.0, 20.0, -45.0, 250.0, 140.0, 40.0, 130.0, 110.0, 90.0, 290.0, 100.0, 290.0, 60.0, 70.0, 90.0, 20.0, 100.0, 360.0, 100.0, 40.0, 190.0, 50.0, 70.0, 125.0, 250.0, 90.0, 30.0, 80.0, 80.0, -5.0, 160.0, 210.0, 30.0, 10.0, 50.0, 60.0, 10.0, 60.0, 10.0, 10.0, 160.0, 20.0, 40.0, 50.0, 20.0, 120.0, 35.0, 180.0, 240.0, 190.0, 80.0, 30.0, 120.0, 100.0, 50.0, 50.0, 190.0, 30.0, 160.0, 50.0, 100.0, 140.0, 90.0, -40.0, -75.0, 70.0, 90.0, 70.0, 20.0, 210.0, 30.0, 280.0, 30.0, 25.0, 30.0, 160.0, 290.0, 50.0, 30.0, 50.0, 40.0, 20.0, 120.0, 40.0, 140.0, 240.0, 150.0, 20.0, -10.0, 40.0, 160.0, 310.0, 50.0, -50.0, 70.0, 50.0, 110.0, 60.0, 235.0, -60.0, 20.0, 0.0, 40.0, 200.0, 130.0, 40.0, 20.0, 80.0, 40.0, 250.0, 90.0, 60.0, 80.0, 400.0, 60.0, 60.0, 370.0, 90.0, 110.0, 180.0, 10.0, 20.0, 10.0, 120.0, 140.0, 0.0, 0.0, -5.0, 20.0, 10.0, -110.0, 380.0, 390.0, 110.0, 40.0, 20.0, 60.0, 80.0, 210.0, 110.0, 70.0, 110.0, 20.0, -20.0, 40.0, 140.0, 410.0, 40.0, 80.0, 370.0, 300.0, 190.0, 240.0, 90.0, 0.0, 100.0, 440.0, 50.0, 40.0, 470.0, 80.0, 20.0, 80.0, 40.0, 60.0, 130.0, 210.0, 160.0, 15.0, 10.0, 50.0, 50.0, 110.0, 90.0, 190.0, 10.0, -15.0, 500.0, 530.0, 50.0, 155.0, 170.0, 10.0, 20.0, 0.0, 100.0, 50.0, 380.0, 10.0, 180.0, 140.0, 30.0, 40.0, 50.0, 120.0, 0.0, 610.0, 50.0, 220.0, -30.0, 80.0, 20.0, 300.0, 70.0, 10.0, 30.0, 0.0, 280.0, 170.0, 180.0, 60.0, 40.0, 50.0, 60.0, 60.0, 50.0, 90.0, 90.0, 440.0, 180.0, 80.0, -90.0, -30.0, 180.0, 220.0, 0.0, -50.0, 70.0, 130.0, 490.0, 510.0, 30.0, 190.0, -60.0, 40.0, 80.0, 70.0, 210.0, 370.0, 90.0, 70.0, 80.0, 30.0, 180.0, 80.0, 30.0, 170.0, 80.0, 20.0, 50.0, 200.0, 30.0, 150.0, 110.0, -40.0, 20.0, 280.0, 160.0, 80.0, 40.0, 40.0, 180.0, 5.0, 50.0, 130.0, 40.0, 40.0, 80.0, 320.0, 20.0, -10.0, 200.0, 40.0, -20.0, 180.0, 60.0, 240.0, 290.0, 80.0, 60.0, 330.0, 100.0, 70.0, 400.0, 80.0, 50.0, 130.0, 130.0, 140.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 80.0, 20.0, 20.0, 20.0, 40.0, 60.0, 20.0, 150.0, 50.0, 100.0, 210.0, 90.0, 30.0, 90.0, 50.0, 130.0, 0.0, 240.0, 210.0, 850.0, -15.0, 500.0, 50.0, 10.0, 250.0, 10.0, 90.0, 290.0, 200.0, 290.0, 30.0, 300.0, 40.0, 40.0, 30.0, 20.0, 290.0, 80.0, 280.0, 60.0, -50.0, 130.0, 100.0, 80.0, 90.0, 25.0, 40.0, 150.0, 60.0, 70.0, 60.0, 0.0, 680.0, -30.0, 260.0, 160.0, 40.0, 330.0, 50.0, -10.0, 70.0, 210.0, 120.0, 70.0, 440.0, 50.0, 150.0, 170.0, 0.0, 320.0, 60.0, 350.0, 40.0, 50.0, 360.0, 280.0, 70.0, 100.0, 300.0, 180.0, -20.0, 30.0, 50.0, 150.0, 90.0, 30.0, -30.0, 600.0, -45.0, 90.0, -40.0, 510.0, 70.0, -25.0, -30.0, 0.0, 245.0, 30.0, 190.0, 400.0, 30.0, -45.0, 110.0, 80.0, 180.0, 80.0, 330.0, 170.0, 80.0, 100.0, 250.0, 220.0, 30.0, 40.0, -40.0, 20.0, 70.0, 0.0, 80.0, 0.0, 240.0, 180.0, 140.0, 35.0, 170.0, 170.0, 200.0, 50.0, 0.0, 40.0, 170.0, -20.0, 260.0, 110.0, 160.0, 40.0, 20.0, 10.0, 790.0, 190.0, 0.0, 230.0, 20.0, -5.0, 20.0, 40.0, 160.0, 40.0, 110.0, 100.0, 160.0, 30.0, 180.0, 40.0, 190.0, 5.0, 40.0, 15.0, 80.0, 25.0, 40.0, 60.0, 20.0, 180.0, 110.0, 100.0, 130.0, 100.0, 40.0, 60.0, 100.0, 140.0, 340.0, 90.0, 230.0, 140.0, 10.0, -10.0, 10.0, 20.0, -30.0, 100.0, 190.0, 40.0, 680.0, 70.0, 50.0, 160.0, 740.0, 120.0, 380.0, 360.0, 70.0, 200.0, -40.0, 140.0, 120.0, 30.0, 30.0, 10.0, 20.0, 40.0, 20.0, 40.0, 370.0, -5.0, 20.0, 20.0, 70.0, 70.0, 15.0, 20.0, 30.0, 90.0, 70.0, 380.0, 110.0, 130.0, 170.0, 130.0, 0.0, -140.0, 50.0, 360.0, 100.0, 270.0, 60.0, 60.0, 290.0, 20.0, 50.0, 50.0, 30.0, 50.0, 35.0, 60.0, 0.0, 30.0, 5.0, 290.0, 110.0, 40.0, 20.0, 20.0, 80.0, 380.0, 40.0, 190.0, 100.0, 540.0, 20.0, 90.0, 140.0, 120.0, 90.0, 10.0, 30.0, 70.0, 220.0, 20.0, -10.0, 170.0, 70.0, 10.0, 190.0, 160.0, 10.0, 230.0, 130.0, 90.0, 170.0, 160.0, 60.0, 400.0, 150.0, 60.0, -20.0, 230.0, 20.0, 60.0, 70.0, 400.0, 50.0, -10.0, 320.0, 30.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 30.0, 10.0, -20.0, 60.0, 110.0, 490.0, 150.0, 180.0, 30.0, 160.0, 40.0, 150.0, 60.0, 10.0, 20.0, 320.0, 0.0, 20.0, 40.0, 130.0, 50.0, -30.0, 30.0, 30.0, -80.0, 60.0, 200.0, 20.0, 40.0, 170.0, 0.0, 40.0, 160.0, -20.0, 20.0, -50.0, 150.0, 180.0, -50.0, 200.0, 70.0, -100.0, 210.0, 45.0, 10.0, 150.0, 30.0, 90.0, 0.0, 50.0, 40.0, 110.0, 20.0, 20.0, 20.0, 120.0, 40.0, 140.0, 660.0, 35.0, 340.0, 30.0, 20.0, 40.0, 180.0, 70.0, 100.0, 180.0, 70.0, 90.0, 130.0, -30.0, 70.0, 50.0, 20.0, 20.0, 40.0, 130.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 160.0, 60.0, -30.0, 20.0, 80.0, 110.0, 0.0, -50.0, 360.0, -30.0, 140.0, 90.0, 250.0, 200.0, 20.0, 110.0, 150.0, 120.0, 270.0, 240.0, 20.0, 100.0, 40.0, 50.0, 80.0, 30.0, 100.0, 150.0, 80.0, 150.0, 120.0, 90.0, 220.0, 50.0, 40.0, 140.0, 20.0, 30.0, 0.0, 30.0, 10.0, 80.0, 5.0, 210.0, 60.0, 10.0, 520.0, 70.0, 10.0, 0.0, 170.0, 0.0, 20.0, -10.0, 10.0, 10.0, 20.0, 10.0, 60.0, 160.0, 60.0, -10.0, -330.0, 20.0, 70.0, 80.0, 20.0, 160.0, 290.0, 60.0, 100.0, 200.0, 210.0, 0.0, 90.0, 160.0, 200.0, -270.0, 70.0, 200.0, 10.0, 60.0, 20.0, 10.0, 190.0, 200.0, 30.0, 20.0, 20.0, 50.0, -70.0, 80.0, 80.0, 400.0, -70.0, -55.0, -15.0, 80.0, -30.0, 140.0, 90.0, 120.0, 180.0, 70.0, 290.0, 240.0, 130.0, 100.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5158826229487827, "mean_inference_ms": 1.4202161014203472, "mean_action_processing_ms": 0.4317546140916269, "mean_env_wait_ms": 1.2545604982987226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013564586639404297, "StateBufferConnector_ms": 0.009973764419555664, "ViewRequirementAgentConnector_ms": 0.42247796058654785}, "num_episodes": 23, "episode_return_max": 2225.0, "episode_return_min": 40.0, "episode_return_mean": 953.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.26172055948768, "num_env_steps_trained_throughput_per_sec": 21.26172055948768, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 3640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3640000, "timers": {"training_iteration_time_ms": 187019.696, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187019.649, "sample_time_ms": 2640.501, "learn_time_ms": 184359.783, "learn_throughput": 21.697, "synch_weights_time_ms": 12.03}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "done": false, "training_iteration": 91, "trial_id": "90816_00000", "date": "2024-06-10_04-57-22", "timestamp": 1718009842, "time_this_iter_s": 188.14219427108765, "time_total_s": 17119.55950641632, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b011a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17119.55950641632, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 19.69285714285714, "ram_util_percent": 78.67180451127818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5193460976798185, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00864744414761365, "vf_loss": 6.928419296632305, "vf_explained_var": -0.00018925805188342533, "kl": Infinity, "entropy": 0.41604913984751674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 859185.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 40.0, "episode_reward_mean": 987.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -330.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 98.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [260.0, 425.0, 1010.0, 1180.0, 1125.0, 1230.0, 960.0, 610.0, 1055.0, 860.0, 675.0, 975.0, 800.0, 935.0, 820.0, 1500.0, 325.0, 1290.0, 1260.0, 1920.0, 805.0, 1565.0, 1075.0, 1230.0, 1140.0, 1120.0, 1000.0, 1530.0, 790.0, 1030.0, 905.0, 1120.0, 1450.0, 260.0, 850.0, 2225.0, 1320.0, 1080.0, 1315.0, 1480.0, 1550.0, 1230.0, 1130.0, 1220.0, 1260.0, 935.0, 1140.0, 1315.0, 1050.0, 575.0, 1330.0, 1150.0, 2110.0, 820.0, 400.0, 1290.0, 915.0, 655.0, 1710.0, 780.0, 1560.0, 1180.0, 40.0, 1430.0, 590.0, 640.0, 610.0, 545.0, 1425.0, 900.0, 300.0, 710.0, 1320.0, 890.0, 860.0, 1005.0, 290.0, 520.0, 820.0, 760.0, 450.0, 1410.0, 485.0, 600.0, 775.0, 190.0, 330.0, 1830.0, 570.0, 840.0, 1700.0, 420.0, 1030.0, 1075.0, 800.0, 880.0, 1210.0, 795.0, 1170.0, 770.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 0.0, 30.0, 20.0, 10.0, 80.0, 20.0, 0.0, 20.0, 40.0, 15.0, 35.0, 15.0, 0.0, 10.0, 100.0, 70.0, 0.0, 190.0, -10.0, 360.0, 20.0, 85.0, 110.0, 60.0, 70.0, 30.0, 80.0, -55.0, 250.0, 130.0, 50.0, 310.0, 140.0, 110.0, 20.0, 190.0, 50.0, 150.0, 30.0, 100.0, 20.0, -45.0, 250.0, 140.0, 40.0, 130.0, 110.0, 90.0, 290.0, 100.0, 290.0, 60.0, 70.0, 90.0, 20.0, 100.0, 360.0, 100.0, 40.0, 190.0, 50.0, 70.0, 125.0, 250.0, 90.0, 30.0, 80.0, 80.0, -5.0, 160.0, 210.0, 30.0, 10.0, 50.0, 60.0, 10.0, 60.0, 10.0, 10.0, 160.0, 20.0, 40.0, 50.0, 20.0, 120.0, 35.0, 180.0, 240.0, 190.0, 80.0, 30.0, 120.0, 100.0, 50.0, 50.0, 190.0, 30.0, 160.0, 50.0, 100.0, 140.0, 90.0, -40.0, -75.0, 70.0, 90.0, 70.0, 20.0, 210.0, 30.0, 280.0, 30.0, 25.0, 30.0, 160.0, 290.0, 50.0, 30.0, 50.0, 40.0, 20.0, 120.0, 40.0, 140.0, 240.0, 150.0, 20.0, -10.0, 40.0, 160.0, 310.0, 50.0, -50.0, 70.0, 50.0, 110.0, 60.0, 235.0, -60.0, 20.0, 0.0, 40.0, 200.0, 130.0, 40.0, 20.0, 80.0, 40.0, 250.0, 90.0, 60.0, 80.0, 400.0, 60.0, 60.0, 370.0, 90.0, 110.0, 180.0, 10.0, 20.0, 10.0, 120.0, 140.0, 0.0, 0.0, -5.0, 20.0, 10.0, -110.0, 380.0, 390.0, 110.0, 40.0, 20.0, 60.0, 80.0, 210.0, 110.0, 70.0, 110.0, 20.0, -20.0, 40.0, 140.0, 410.0, 40.0, 80.0, 370.0, 300.0, 190.0, 240.0, 90.0, 0.0, 100.0, 440.0, 50.0, 40.0, 470.0, 80.0, 20.0, 80.0, 40.0, 60.0, 130.0, 210.0, 160.0, 15.0, 10.0, 50.0, 50.0, 110.0, 90.0, 190.0, 10.0, -15.0, 500.0, 530.0, 50.0, 155.0, 170.0, 10.0, 20.0, 0.0, 100.0, 50.0, 380.0, 10.0, 180.0, 140.0, 30.0, 40.0, 50.0, 120.0, 0.0, 610.0, 50.0, 220.0, -30.0, 80.0, 20.0, 300.0, 70.0, 10.0, 30.0, 0.0, 280.0, 170.0, 180.0, 60.0, 40.0, 50.0, 60.0, 60.0, 50.0, 90.0, 90.0, 440.0, 180.0, 80.0, -90.0, -30.0, 180.0, 220.0, 0.0, -50.0, 70.0, 130.0, 490.0, 510.0, 30.0, 190.0, -60.0, 40.0, 80.0, 70.0, 210.0, 370.0, 90.0, 70.0, 80.0, 30.0, 180.0, 80.0, 30.0, 170.0, 80.0, 20.0, 50.0, 200.0, 30.0, 150.0, 110.0, -40.0, 20.0, 280.0, 160.0, 80.0, 40.0, 40.0, 180.0, 5.0, 50.0, 130.0, 40.0, 40.0, 80.0, 320.0, 20.0, -10.0, 200.0, 40.0, -20.0, 180.0, 60.0, 240.0, 290.0, 80.0, 60.0, 330.0, 100.0, 70.0, 400.0, 80.0, 50.0, 130.0, 130.0, 140.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 80.0, 20.0, 20.0, 20.0, 40.0, 60.0, 20.0, 150.0, 50.0, 100.0, 210.0, 90.0, 30.0, 90.0, 50.0, 130.0, 0.0, 240.0, 210.0, 850.0, -15.0, 500.0, 50.0, 10.0, 250.0, 10.0, 90.0, 290.0, 200.0, 290.0, 30.0, 300.0, 40.0, 40.0, 30.0, 20.0, 290.0, 80.0, 280.0, 60.0, -50.0, 130.0, 100.0, 80.0, 90.0, 25.0, 40.0, 150.0, 60.0, 70.0, 60.0, 0.0, 680.0, -30.0, 260.0, 160.0, 40.0, 330.0, 50.0, -10.0, 70.0, 210.0, 120.0, 70.0, 440.0, 50.0, 150.0, 170.0, 0.0, 320.0, 60.0, 350.0, 40.0, 50.0, 360.0, 280.0, 70.0, 100.0, 300.0, 180.0, -20.0, 30.0, 50.0, 150.0, 90.0, 30.0, -30.0, 600.0, -45.0, 90.0, -40.0, 510.0, 70.0, -25.0, -30.0, 0.0, 245.0, 30.0, 190.0, 400.0, 30.0, -45.0, 110.0, 80.0, 180.0, 80.0, 330.0, 170.0, 80.0, 100.0, 250.0, 220.0, 30.0, 40.0, -40.0, 20.0, 70.0, 0.0, 80.0, 0.0, 240.0, 180.0, 140.0, 35.0, 170.0, 170.0, 200.0, 50.0, 0.0, 40.0, 170.0, -20.0, 260.0, 110.0, 160.0, 40.0, 20.0, 10.0, 790.0, 190.0, 0.0, 230.0, 20.0, -5.0, 20.0, 40.0, 160.0, 40.0, 110.0, 100.0, 160.0, 30.0, 180.0, 40.0, 190.0, 5.0, 40.0, 15.0, 80.0, 25.0, 40.0, 60.0, 20.0, 180.0, 110.0, 100.0, 130.0, 100.0, 40.0, 60.0, 100.0, 140.0, 340.0, 90.0, 230.0, 140.0, 10.0, -10.0, 10.0, 20.0, -30.0, 100.0, 190.0, 40.0, 680.0, 70.0, 50.0, 160.0, 740.0, 120.0, 380.0, 360.0, 70.0, 200.0, -40.0, 140.0, 120.0, 30.0, 30.0, 10.0, 20.0, 40.0, 20.0, 40.0, 370.0, -5.0, 20.0, 20.0, 70.0, 70.0, 15.0, 20.0, 30.0, 90.0, 70.0, 380.0, 110.0, 130.0, 170.0, 130.0, 0.0, -140.0, 50.0, 360.0, 100.0, 270.0, 60.0, 60.0, 290.0, 20.0, 50.0, 50.0, 30.0, 50.0, 35.0, 60.0, 0.0, 30.0, 5.0, 290.0, 110.0, 40.0, 20.0, 20.0, 80.0, 380.0, 40.0, 190.0, 100.0, 540.0, 20.0, 90.0, 140.0, 120.0, 90.0, 10.0, 30.0, 70.0, 220.0, 20.0, -10.0, 170.0, 70.0, 10.0, 190.0, 160.0, 10.0, 230.0, 130.0, 90.0, 170.0, 160.0, 60.0, 400.0, 150.0, 60.0, -20.0, 230.0, 20.0, 60.0, 70.0, 400.0, 50.0, -10.0, 320.0, 30.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 30.0, 10.0, -20.0, 60.0, 110.0, 490.0, 150.0, 180.0, 30.0, 160.0, 40.0, 150.0, 60.0, 10.0, 20.0, 320.0, 0.0, 20.0, 40.0, 130.0, 50.0, -30.0, 30.0, 30.0, -80.0, 60.0, 200.0, 20.0, 40.0, 170.0, 0.0, 40.0, 160.0, -20.0, 20.0, -50.0, 150.0, 180.0, -50.0, 200.0, 70.0, -100.0, 210.0, 45.0, 10.0, 150.0, 30.0, 90.0, 0.0, 50.0, 40.0, 110.0, 20.0, 20.0, 20.0, 120.0, 40.0, 140.0, 660.0, 35.0, 340.0, 30.0, 20.0, 40.0, 180.0, 70.0, 100.0, 180.0, 70.0, 90.0, 130.0, -30.0, 70.0, 50.0, 20.0, 20.0, 40.0, 130.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 160.0, 60.0, -30.0, 20.0, 80.0, 110.0, 0.0, -50.0, 360.0, -30.0, 140.0, 90.0, 250.0, 200.0, 20.0, 110.0, 150.0, 120.0, 270.0, 240.0, 20.0, 100.0, 40.0, 50.0, 80.0, 30.0, 100.0, 150.0, 80.0, 150.0, 120.0, 90.0, 220.0, 50.0, 40.0, 140.0, 20.0, 30.0, 0.0, 30.0, 10.0, 80.0, 5.0, 210.0, 60.0, 10.0, 520.0, 70.0, 10.0, 0.0, 170.0, 0.0, 20.0, -10.0, 10.0, 10.0, 20.0, 10.0, 60.0, 160.0, 60.0, -10.0, -330.0, 20.0, 70.0, 80.0, 20.0, 160.0, 290.0, 60.0, 100.0, 200.0, 210.0, 0.0, 90.0, 160.0, 200.0, -270.0, 70.0, 200.0, 10.0, 60.0, 20.0, 10.0, 190.0, 200.0, 30.0, 20.0, 20.0, 50.0, -70.0, 80.0, 80.0, 400.0, -70.0, -55.0, -15.0, 80.0, -30.0, 140.0, 90.0, 120.0, 180.0, 70.0, 290.0, 240.0, 130.0, 100.0, 50.0, 0.0, 20.0, 210.0, -20.0, 10.0, 10.0, 180.0, 15.0, 10.0, 50.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 120.0, 0.0, 90.0, 200.0, -30.0, 60.0, 70.0, 290.0, 50.0, 90.0, -25.0, 5.0, -5.0, 270.0, 10.0, 40.0, 10.0, 20.0, 30.0, 15.0, -15.0, 20.0, -10.0, 70.0, 20.0, 10.0, 10.0, 70.0, 30.0, 10.0, 70.0, 10.0, 30.0, 70.0, 120.0, 0.0, 310.0, 100.0, 370.0, 640.0, 150.0, -10.0, 130.0, 20.0, 40.0, 20.0, 220.0, -5.0, 210.0, 10.0, 5.0, 30.0, 15.0, 25.0, 10.0, 80.0, 90.0, 270.0, 40.0, 160.0, 80.0, 10.0, 40.0, 60.0, 130.0, 70.0, 20.0, 540.0, 80.0, 420.0, 100.0, 110.0, 160.0, 70.0, 20.0, 100.0, 0.0, 60.0, -65.0, 170.0, 120.0, -25.0, 30.0, 10.0, 60.0, 200.0, 240.0, -50.0, 80.0, 50.0, 60.0, 310.0, 60.0, 20.0, 170.0, 60.0, 40.0, 20.0, 130.0, -5.0, 80.0, 70.0, 420.0, 90.0, 90.0, 100.0, 30.0, 25.0, 155.0, 100.0, 150.0, 30.0, 20.0, 100.0, 0.0, 150.0, 40.0, 30.0, 120.0, 40.0, 240.0, -70.0, 220.0, 110.0, 30.0, 150.0, 310.0, 50.0, 260.0, 20.0, 170.0, 50.0, 60.0, 110.0, 80.0, 0.0, 270.0, 10.0, 0.0, 120.0, 10.0, -5.0, 310.0, 0.0, 170.0, 170.0, 160.0, 250.0, 40.0, 50.0, 20.0, 120.0, 90.0, 100.0, 50.0, -10.0, 140.0, 100.0, -80.0, 0.0, 160.0, -30.0, 340.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5145757126522768, "mean_inference_ms": 1.417249420189569, "mean_action_processing_ms": 0.43179439839859735, "mean_env_wait_ms": 1.2548526010769032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012866973876953125, "StateBufferConnector_ms": 0.009471893310546875, "ViewRequirementAgentConnector_ms": 0.3812694549560547}, "num_episodes": 18, "episode_return_max": 2225.0, "episode_return_min": 40.0, "episode_return_mean": 987.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.349628594161537, "num_env_steps_trained_throughput_per_sec": 21.349628594161537, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 3680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3680000, "timers": {"training_iteration_time_ms": 186989.597, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186989.55, "sample_time_ms": 2627.435, "learn_time_ms": 184342.931, "learn_throughput": 21.699, "synch_weights_time_ms": 11.627}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "done": false, "training_iteration": 92, "trial_id": "90816_00000", "date": "2024-06-10_05-00-29", "timestamp": 1718010029, "time_this_iter_s": 187.36505317687988, "time_total_s": 17306.9245595932, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b011a8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17306.9245595932, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.016226415094337, "ram_util_percent": 78.57811320754716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2728964536017378, "cur_kl_coeff": 0.72081298828125, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007805297075680539, "vf_loss": 7.09850003686322, "vf_explained_var": 0.0004309391569151792, "kl": Infinity, "entropy": 0.3820208395584323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 868575.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 40.0, "episode_reward_mean": 1029.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -330.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 102.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1260.0, 1920.0, 805.0, 1565.0, 1075.0, 1230.0, 1140.0, 1120.0, 1000.0, 1530.0, 790.0, 1030.0, 905.0, 1120.0, 1450.0, 260.0, 850.0, 2225.0, 1320.0, 1080.0, 1315.0, 1480.0, 1550.0, 1230.0, 1130.0, 1220.0, 1260.0, 935.0, 1140.0, 1315.0, 1050.0, 575.0, 1330.0, 1150.0, 2110.0, 820.0, 400.0, 1290.0, 915.0, 655.0, 1710.0, 780.0, 1560.0, 1180.0, 40.0, 1430.0, 590.0, 640.0, 610.0, 545.0, 1425.0, 900.0, 300.0, 710.0, 1320.0, 890.0, 860.0, 1005.0, 290.0, 520.0, 820.0, 760.0, 450.0, 1410.0, 485.0, 600.0, 775.0, 190.0, 330.0, 1830.0, 570.0, 840.0, 1700.0, 420.0, 1030.0, 1075.0, 800.0, 880.0, 1210.0, 795.0, 1170.0, 770.0, 730.0, 1385.0, 1050.0, 1040.0, 795.0, 1120.0, 1970.0, 1335.0, 1610.0, 1185.0, 1130.0, 1000.0, 790.0, 1320.0, 1070.0, 250.0, 935.0, 1500.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 110.0, 20.0, -20.0, 40.0, 140.0, 410.0, 40.0, 80.0, 370.0, 300.0, 190.0, 240.0, 90.0, 0.0, 100.0, 440.0, 50.0, 40.0, 470.0, 80.0, 20.0, 80.0, 40.0, 60.0, 130.0, 210.0, 160.0, 15.0, 10.0, 50.0, 50.0, 110.0, 90.0, 190.0, 10.0, -15.0, 500.0, 530.0, 50.0, 155.0, 170.0, 10.0, 20.0, 0.0, 100.0, 50.0, 380.0, 10.0, 180.0, 140.0, 30.0, 40.0, 50.0, 120.0, 0.0, 610.0, 50.0, 220.0, -30.0, 80.0, 20.0, 300.0, 70.0, 10.0, 30.0, 0.0, 280.0, 170.0, 180.0, 60.0, 40.0, 50.0, 60.0, 60.0, 50.0, 90.0, 90.0, 440.0, 180.0, 80.0, -90.0, -30.0, 180.0, 220.0, 0.0, -50.0, 70.0, 130.0, 490.0, 510.0, 30.0, 190.0, -60.0, 40.0, 80.0, 70.0, 210.0, 370.0, 90.0, 70.0, 80.0, 30.0, 180.0, 80.0, 30.0, 170.0, 80.0, 20.0, 50.0, 200.0, 30.0, 150.0, 110.0, -40.0, 20.0, 280.0, 160.0, 80.0, 40.0, 40.0, 180.0, 5.0, 50.0, 130.0, 40.0, 40.0, 80.0, 320.0, 20.0, -10.0, 200.0, 40.0, -20.0, 180.0, 60.0, 240.0, 290.0, 80.0, 60.0, 330.0, 100.0, 70.0, 400.0, 80.0, 50.0, 130.0, 130.0, 140.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 80.0, 20.0, 20.0, 20.0, 40.0, 60.0, 20.0, 150.0, 50.0, 100.0, 210.0, 90.0, 30.0, 90.0, 50.0, 130.0, 0.0, 240.0, 210.0, 850.0, -15.0, 500.0, 50.0, 10.0, 250.0, 10.0, 90.0, 290.0, 200.0, 290.0, 30.0, 300.0, 40.0, 40.0, 30.0, 20.0, 290.0, 80.0, 280.0, 60.0, -50.0, 130.0, 100.0, 80.0, 90.0, 25.0, 40.0, 150.0, 60.0, 70.0, 60.0, 0.0, 680.0, -30.0, 260.0, 160.0, 40.0, 330.0, 50.0, -10.0, 70.0, 210.0, 120.0, 70.0, 440.0, 50.0, 150.0, 170.0, 0.0, 320.0, 60.0, 350.0, 40.0, 50.0, 360.0, 280.0, 70.0, 100.0, 300.0, 180.0, -20.0, 30.0, 50.0, 150.0, 90.0, 30.0, -30.0, 600.0, -45.0, 90.0, -40.0, 510.0, 70.0, -25.0, -30.0, 0.0, 245.0, 30.0, 190.0, 400.0, 30.0, -45.0, 110.0, 80.0, 180.0, 80.0, 330.0, 170.0, 80.0, 100.0, 250.0, 220.0, 30.0, 40.0, -40.0, 20.0, 70.0, 0.0, 80.0, 0.0, 240.0, 180.0, 140.0, 35.0, 170.0, 170.0, 200.0, 50.0, 0.0, 40.0, 170.0, -20.0, 260.0, 110.0, 160.0, 40.0, 20.0, 10.0, 790.0, 190.0, 0.0, 230.0, 20.0, -5.0, 20.0, 40.0, 160.0, 40.0, 110.0, 100.0, 160.0, 30.0, 180.0, 40.0, 190.0, 5.0, 40.0, 15.0, 80.0, 25.0, 40.0, 60.0, 20.0, 180.0, 110.0, 100.0, 130.0, 100.0, 40.0, 60.0, 100.0, 140.0, 340.0, 90.0, 230.0, 140.0, 10.0, -10.0, 10.0, 20.0, -30.0, 100.0, 190.0, 40.0, 680.0, 70.0, 50.0, 160.0, 740.0, 120.0, 380.0, 360.0, 70.0, 200.0, -40.0, 140.0, 120.0, 30.0, 30.0, 10.0, 20.0, 40.0, 20.0, 40.0, 370.0, -5.0, 20.0, 20.0, 70.0, 70.0, 15.0, 20.0, 30.0, 90.0, 70.0, 380.0, 110.0, 130.0, 170.0, 130.0, 0.0, -140.0, 50.0, 360.0, 100.0, 270.0, 60.0, 60.0, 290.0, 20.0, 50.0, 50.0, 30.0, 50.0, 35.0, 60.0, 0.0, 30.0, 5.0, 290.0, 110.0, 40.0, 20.0, 20.0, 80.0, 380.0, 40.0, 190.0, 100.0, 540.0, 20.0, 90.0, 140.0, 120.0, 90.0, 10.0, 30.0, 70.0, 220.0, 20.0, -10.0, 170.0, 70.0, 10.0, 190.0, 160.0, 10.0, 230.0, 130.0, 90.0, 170.0, 160.0, 60.0, 400.0, 150.0, 60.0, -20.0, 230.0, 20.0, 60.0, 70.0, 400.0, 50.0, -10.0, 320.0, 30.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 30.0, 10.0, -20.0, 60.0, 110.0, 490.0, 150.0, 180.0, 30.0, 160.0, 40.0, 150.0, 60.0, 10.0, 20.0, 320.0, 0.0, 20.0, 40.0, 130.0, 50.0, -30.0, 30.0, 30.0, -80.0, 60.0, 200.0, 20.0, 40.0, 170.0, 0.0, 40.0, 160.0, -20.0, 20.0, -50.0, 150.0, 180.0, -50.0, 200.0, 70.0, -100.0, 210.0, 45.0, 10.0, 150.0, 30.0, 90.0, 0.0, 50.0, 40.0, 110.0, 20.0, 20.0, 20.0, 120.0, 40.0, 140.0, 660.0, 35.0, 340.0, 30.0, 20.0, 40.0, 180.0, 70.0, 100.0, 180.0, 70.0, 90.0, 130.0, -30.0, 70.0, 50.0, 20.0, 20.0, 40.0, 130.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 160.0, 60.0, -30.0, 20.0, 80.0, 110.0, 0.0, -50.0, 360.0, -30.0, 140.0, 90.0, 250.0, 200.0, 20.0, 110.0, 150.0, 120.0, 270.0, 240.0, 20.0, 100.0, 40.0, 50.0, 80.0, 30.0, 100.0, 150.0, 80.0, 150.0, 120.0, 90.0, 220.0, 50.0, 40.0, 140.0, 20.0, 30.0, 0.0, 30.0, 10.0, 80.0, 5.0, 210.0, 60.0, 10.0, 520.0, 70.0, 10.0, 0.0, 170.0, 0.0, 20.0, -10.0, 10.0, 10.0, 20.0, 10.0, 60.0, 160.0, 60.0, -10.0, -330.0, 20.0, 70.0, 80.0, 20.0, 160.0, 290.0, 60.0, 100.0, 200.0, 210.0, 0.0, 90.0, 160.0, 200.0, -270.0, 70.0, 200.0, 10.0, 60.0, 20.0, 10.0, 190.0, 200.0, 30.0, 20.0, 20.0, 50.0, -70.0, 80.0, 80.0, 400.0, -70.0, -55.0, -15.0, 80.0, -30.0, 140.0, 90.0, 120.0, 180.0, 70.0, 290.0, 240.0, 130.0, 100.0, 50.0, 0.0, 20.0, 210.0, -20.0, 10.0, 10.0, 180.0, 15.0, 10.0, 50.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 120.0, 0.0, 90.0, 200.0, -30.0, 60.0, 70.0, 290.0, 50.0, 90.0, -25.0, 5.0, -5.0, 270.0, 10.0, 40.0, 10.0, 20.0, 30.0, 15.0, -15.0, 20.0, -10.0, 70.0, 20.0, 10.0, 10.0, 70.0, 30.0, 10.0, 70.0, 10.0, 30.0, 70.0, 120.0, 0.0, 310.0, 100.0, 370.0, 640.0, 150.0, -10.0, 130.0, 20.0, 40.0, 20.0, 220.0, -5.0, 210.0, 10.0, 5.0, 30.0, 15.0, 25.0, 10.0, 80.0, 90.0, 270.0, 40.0, 160.0, 80.0, 10.0, 40.0, 60.0, 130.0, 70.0, 20.0, 540.0, 80.0, 420.0, 100.0, 110.0, 160.0, 70.0, 20.0, 100.0, 0.0, 60.0, -65.0, 170.0, 120.0, -25.0, 30.0, 10.0, 60.0, 200.0, 240.0, -50.0, 80.0, 50.0, 60.0, 310.0, 60.0, 20.0, 170.0, 60.0, 40.0, 20.0, 130.0, -5.0, 80.0, 70.0, 420.0, 90.0, 90.0, 100.0, 30.0, 25.0, 155.0, 100.0, 150.0, 30.0, 20.0, 100.0, 0.0, 150.0, 40.0, 30.0, 120.0, 40.0, 240.0, -70.0, 220.0, 110.0, 30.0, 150.0, 310.0, 50.0, 260.0, 20.0, 170.0, 50.0, 60.0, 110.0, 80.0, 0.0, 270.0, 10.0, 0.0, 120.0, 10.0, -5.0, 310.0, 0.0, 170.0, 170.0, 160.0, 250.0, 40.0, 50.0, 20.0, 120.0, 90.0, 100.0, 50.0, -10.0, 140.0, 100.0, -80.0, 0.0, 160.0, -30.0, 340.0, 100.0, 180.0, 80.0, 170.0, -75.0, 100.0, 40.0, 155.0, 20.0, 30.0, 30.0, 80.0, 240.0, 200.0, 150.0, -20.0, 30.0, 460.0, 80.0, 130.0, 35.0, 140.0, -20.0, 130.0, 10.0, 110.0, 370.0, 10.0, 20.0, 270.0, 10.0, 310.0, 190.0, 110.0, 10.0, 40.0, 190.0, 50.0, 20.0, 30.0, 90.0, 30.0, 0.0, 25.0, 10.0, 170.0, 140.0, 180.0, 20.0, 40.0, 180.0, 60.0, 90.0, 80.0, 230.0, 190.0, 120.0, 150.0, 20.0, 160.0, 20.0, -20.0, 180.0, 290.0, 0.0, 500.0, 80.0, 920.0, 0.0, 40.0, -20.0, 40.0, 120.0, 40.0, 120.0, 390.0, 25.0, 90.0, 60.0, 350.0, 100.0, 220.0, 110.0, 50.0, 140.0, 110.0, 180.0, 120.0, 80.0, 360.0, 240.0, 330.0, 0.0, 180.0, 20.0, 60.0, 130.0, 5.0, 50.0, 190.0, 220.0, 160.0, 80.0, 50.0, 70.0, 60.0, 520.0, 90.0, 10.0, 60.0, 30.0, 20.0, 30.0, 40.0, 80.0, 60.0, 300.0, 150.0, 130.0, 150.0, 40.0, 20.0, 40.0, 50.0, 110.0, 210.0, 40.0, 130.0, 10.0, 170.0, 10.0, 40.0, 10.0, 40.0, -10.0, 310.0, 80.0, 560.0, 30.0, 80.0, 180.0, 70.0, 30.0, 150.0, 80.0, 250.0, 390.0, 60.0, -30.0, 50.0, 20.0, 40.0, 10.0, 70.0, 40.0, 5.0, 10.0, 20.0, 30.0, -5.0, 30.0, 140.0, 20.0, 90.0, 70.0, 0.0, 450.0, 10.0, 30.0, 130.0, -5.0, 320.0, 90.0, 130.0, 150.0, 80.0, 90.0, 0.0, 580.0, -10.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5143761357314873, "mean_inference_ms": 1.4173242891379991, "mean_action_processing_ms": 0.4314209955926351, "mean_env_wait_ms": 1.2549154438587689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012747764587402344, "StateBufferConnector_ms": 0.009425878524780273, "ViewRequirementAgentConnector_ms": 0.37890124320983887}, "num_episodes": 18, "episode_return_max": 2225.0, "episode_return_min": 40.0, "episode_return_mean": 1029.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.251321028986585, "num_env_steps_trained_throughput_per_sec": 21.251321028986585, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 3720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3720000, "timers": {"training_iteration_time_ms": 187238.392, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187238.346, "sample_time_ms": 2619.419, "learn_time_ms": 184599.255, "learn_throughput": 21.669, "synch_weights_time_ms": 12.503}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "done": false, "training_iteration": 93, "trial_id": "90816_00000", "date": "2024-06-10_05-03-37", "timestamp": 1718010217, "time_this_iter_s": 188.23973202705383, "time_total_s": 17495.164291620255, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b011ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17495.164291620255, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 19.510486891385764, "ram_util_percent": 79.25543071161049}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.436055509484233, "cur_kl_coeff": 1.0812194824218753, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.374003394698691, "policy_loss": -0.007784616807649255, "vf_loss": 6.379019433164749, "vf_explained_var": 0.0008514354848506224, "kl": 0.0025606054804122452, "entropy": 0.4315000564018631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 877965.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "env_runners": {"episode_reward_max": 2110.0, "episode_reward_min": 40.0, "episode_reward_mean": 956.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -330.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 95.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1550.0, 1230.0, 1130.0, 1220.0, 1260.0, 935.0, 1140.0, 1315.0, 1050.0, 575.0, 1330.0, 1150.0, 2110.0, 820.0, 400.0, 1290.0, 915.0, 655.0, 1710.0, 780.0, 1560.0, 1180.0, 40.0, 1430.0, 590.0, 640.0, 610.0, 545.0, 1425.0, 900.0, 300.0, 710.0, 1320.0, 890.0, 860.0, 1005.0, 290.0, 520.0, 820.0, 760.0, 450.0, 1410.0, 485.0, 600.0, 775.0, 190.0, 330.0, 1830.0, 570.0, 840.0, 1700.0, 420.0, 1030.0, 1075.0, 800.0, 880.0, 1210.0, 795.0, 1170.0, 770.0, 730.0, 1385.0, 1050.0, 1040.0, 795.0, 1120.0, 1970.0, 1335.0, 1610.0, 1185.0, 1130.0, 1000.0, 790.0, 1320.0, 1070.0, 250.0, 935.0, 1500.0, 695.0, 380.0, 1295.0, 1010.0, 470.0, 1280.0, 785.0, 1300.0, 555.0, 665.0, 395.0, 1535.0, 880.0, 570.0, 535.0, 1730.0, 470.0, 1220.0, 900.0, 1390.0, 600.0, 510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 150.0, 170.0, 0.0, 320.0, 60.0, 350.0, 40.0, 50.0, 360.0, 280.0, 70.0, 100.0, 300.0, 180.0, -20.0, 30.0, 50.0, 150.0, 90.0, 30.0, -30.0, 600.0, -45.0, 90.0, -40.0, 510.0, 70.0, -25.0, -30.0, 0.0, 245.0, 30.0, 190.0, 400.0, 30.0, -45.0, 110.0, 80.0, 180.0, 80.0, 330.0, 170.0, 80.0, 100.0, 250.0, 220.0, 30.0, 40.0, -40.0, 20.0, 70.0, 0.0, 80.0, 0.0, 240.0, 180.0, 140.0, 35.0, 170.0, 170.0, 200.0, 50.0, 0.0, 40.0, 170.0, -20.0, 260.0, 110.0, 160.0, 40.0, 20.0, 10.0, 790.0, 190.0, 0.0, 230.0, 20.0, -5.0, 20.0, 40.0, 160.0, 40.0, 110.0, 100.0, 160.0, 30.0, 180.0, 40.0, 190.0, 5.0, 40.0, 15.0, 80.0, 25.0, 40.0, 60.0, 20.0, 180.0, 110.0, 100.0, 130.0, 100.0, 40.0, 60.0, 100.0, 140.0, 340.0, 90.0, 230.0, 140.0, 10.0, -10.0, 10.0, 20.0, -30.0, 100.0, 190.0, 40.0, 680.0, 70.0, 50.0, 160.0, 740.0, 120.0, 380.0, 360.0, 70.0, 200.0, -40.0, 140.0, 120.0, 30.0, 30.0, 10.0, 20.0, 40.0, 20.0, 40.0, 370.0, -5.0, 20.0, 20.0, 70.0, 70.0, 15.0, 20.0, 30.0, 90.0, 70.0, 380.0, 110.0, 130.0, 170.0, 130.0, 0.0, -140.0, 50.0, 360.0, 100.0, 270.0, 60.0, 60.0, 290.0, 20.0, 50.0, 50.0, 30.0, 50.0, 35.0, 60.0, 0.0, 30.0, 5.0, 290.0, 110.0, 40.0, 20.0, 20.0, 80.0, 380.0, 40.0, 190.0, 100.0, 540.0, 20.0, 90.0, 140.0, 120.0, 90.0, 10.0, 30.0, 70.0, 220.0, 20.0, -10.0, 170.0, 70.0, 10.0, 190.0, 160.0, 10.0, 230.0, 130.0, 90.0, 170.0, 160.0, 60.0, 400.0, 150.0, 60.0, -20.0, 230.0, 20.0, 60.0, 70.0, 400.0, 50.0, -10.0, 320.0, 30.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 30.0, 10.0, -20.0, 60.0, 110.0, 490.0, 150.0, 180.0, 30.0, 160.0, 40.0, 150.0, 60.0, 10.0, 20.0, 320.0, 0.0, 20.0, 40.0, 130.0, 50.0, -30.0, 30.0, 30.0, -80.0, 60.0, 200.0, 20.0, 40.0, 170.0, 0.0, 40.0, 160.0, -20.0, 20.0, -50.0, 150.0, 180.0, -50.0, 200.0, 70.0, -100.0, 210.0, 45.0, 10.0, 150.0, 30.0, 90.0, 0.0, 50.0, 40.0, 110.0, 20.0, 20.0, 20.0, 120.0, 40.0, 140.0, 660.0, 35.0, 340.0, 30.0, 20.0, 40.0, 180.0, 70.0, 100.0, 180.0, 70.0, 90.0, 130.0, -30.0, 70.0, 50.0, 20.0, 20.0, 40.0, 130.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 160.0, 60.0, -30.0, 20.0, 80.0, 110.0, 0.0, -50.0, 360.0, -30.0, 140.0, 90.0, 250.0, 200.0, 20.0, 110.0, 150.0, 120.0, 270.0, 240.0, 20.0, 100.0, 40.0, 50.0, 80.0, 30.0, 100.0, 150.0, 80.0, 150.0, 120.0, 90.0, 220.0, 50.0, 40.0, 140.0, 20.0, 30.0, 0.0, 30.0, 10.0, 80.0, 5.0, 210.0, 60.0, 10.0, 520.0, 70.0, 10.0, 0.0, 170.0, 0.0, 20.0, -10.0, 10.0, 10.0, 20.0, 10.0, 60.0, 160.0, 60.0, -10.0, -330.0, 20.0, 70.0, 80.0, 20.0, 160.0, 290.0, 60.0, 100.0, 200.0, 210.0, 0.0, 90.0, 160.0, 200.0, -270.0, 70.0, 200.0, 10.0, 60.0, 20.0, 10.0, 190.0, 200.0, 30.0, 20.0, 20.0, 50.0, -70.0, 80.0, 80.0, 400.0, -70.0, -55.0, -15.0, 80.0, -30.0, 140.0, 90.0, 120.0, 180.0, 70.0, 290.0, 240.0, 130.0, 100.0, 50.0, 0.0, 20.0, 210.0, -20.0, 10.0, 10.0, 180.0, 15.0, 10.0, 50.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 120.0, 0.0, 90.0, 200.0, -30.0, 60.0, 70.0, 290.0, 50.0, 90.0, -25.0, 5.0, -5.0, 270.0, 10.0, 40.0, 10.0, 20.0, 30.0, 15.0, -15.0, 20.0, -10.0, 70.0, 20.0, 10.0, 10.0, 70.0, 30.0, 10.0, 70.0, 10.0, 30.0, 70.0, 120.0, 0.0, 310.0, 100.0, 370.0, 640.0, 150.0, -10.0, 130.0, 20.0, 40.0, 20.0, 220.0, -5.0, 210.0, 10.0, 5.0, 30.0, 15.0, 25.0, 10.0, 80.0, 90.0, 270.0, 40.0, 160.0, 80.0, 10.0, 40.0, 60.0, 130.0, 70.0, 20.0, 540.0, 80.0, 420.0, 100.0, 110.0, 160.0, 70.0, 20.0, 100.0, 0.0, 60.0, -65.0, 170.0, 120.0, -25.0, 30.0, 10.0, 60.0, 200.0, 240.0, -50.0, 80.0, 50.0, 60.0, 310.0, 60.0, 20.0, 170.0, 60.0, 40.0, 20.0, 130.0, -5.0, 80.0, 70.0, 420.0, 90.0, 90.0, 100.0, 30.0, 25.0, 155.0, 100.0, 150.0, 30.0, 20.0, 100.0, 0.0, 150.0, 40.0, 30.0, 120.0, 40.0, 240.0, -70.0, 220.0, 110.0, 30.0, 150.0, 310.0, 50.0, 260.0, 20.0, 170.0, 50.0, 60.0, 110.0, 80.0, 0.0, 270.0, 10.0, 0.0, 120.0, 10.0, -5.0, 310.0, 0.0, 170.0, 170.0, 160.0, 250.0, 40.0, 50.0, 20.0, 120.0, 90.0, 100.0, 50.0, -10.0, 140.0, 100.0, -80.0, 0.0, 160.0, -30.0, 340.0, 100.0, 180.0, 80.0, 170.0, -75.0, 100.0, 40.0, 155.0, 20.0, 30.0, 30.0, 80.0, 240.0, 200.0, 150.0, -20.0, 30.0, 460.0, 80.0, 130.0, 35.0, 140.0, -20.0, 130.0, 10.0, 110.0, 370.0, 10.0, 20.0, 270.0, 10.0, 310.0, 190.0, 110.0, 10.0, 40.0, 190.0, 50.0, 20.0, 30.0, 90.0, 30.0, 0.0, 25.0, 10.0, 170.0, 140.0, 180.0, 20.0, 40.0, 180.0, 60.0, 90.0, 80.0, 230.0, 190.0, 120.0, 150.0, 20.0, 160.0, 20.0, -20.0, 180.0, 290.0, 0.0, 500.0, 80.0, 920.0, 0.0, 40.0, -20.0, 40.0, 120.0, 40.0, 120.0, 390.0, 25.0, 90.0, 60.0, 350.0, 100.0, 220.0, 110.0, 50.0, 140.0, 110.0, 180.0, 120.0, 80.0, 360.0, 240.0, 330.0, 0.0, 180.0, 20.0, 60.0, 130.0, 5.0, 50.0, 190.0, 220.0, 160.0, 80.0, 50.0, 70.0, 60.0, 520.0, 90.0, 10.0, 60.0, 30.0, 20.0, 30.0, 40.0, 80.0, 60.0, 300.0, 150.0, 130.0, 150.0, 40.0, 20.0, 40.0, 50.0, 110.0, 210.0, 40.0, 130.0, 10.0, 170.0, 10.0, 40.0, 10.0, 40.0, -10.0, 310.0, 80.0, 560.0, 30.0, 80.0, 180.0, 70.0, 30.0, 150.0, 80.0, 250.0, 390.0, 60.0, -30.0, 50.0, 20.0, 40.0, 10.0, 70.0, 40.0, 5.0, 10.0, 20.0, 30.0, -5.0, 30.0, 140.0, 20.0, 90.0, 70.0, 0.0, 450.0, 10.0, 30.0, 130.0, -5.0, 320.0, 90.0, 130.0, 150.0, 80.0, 90.0, 0.0, 580.0, -10.0, 70.0, 20.0, 40.0, 270.0, 10.0, 40.0, 5.0, 40.0, 20.0, 50.0, 200.0, 170.0, -10.0, 20.0, 10.0, 50.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 60.0, 140.0, 470.0, 140.0, 350.0, 0.0, 0.0, 110.0, 25.0, 0.0, 220.0, 30.0, 70.0, 340.0, 80.0, -40.0, 10.0, 130.0, 170.0, 70.0, 50.0, 160.0, 30.0, 40.0, 0.0, 0.0, -20.0, 90.0, 50.0, 20.0, 140.0, 40.0, 160.0, 20.0, 90.0, 470.0, 190.0, 0.0, 150.0, 30.0, 35.0, 110.0, 80.0, 260.0, 180.0, 50.0, 10.0, 0.0, 30.0, 30.0, 410.0, 50.0, 130.0, 260.0, 50.0, 20.0, 300.0, 20.0, 30.0, 390.0, 40.0, 20.0, -20.0, 20.0, 30.0, -30.0, -5.0, 60.0, 50.0, 150.0, 220.0, 80.0, 0.0, 60.0, 15.0, 70.0, 0.0, 10.0, 60.0, 10.0, 200.0, -5.0, 50.0, 30.0, 5.0, 20.0, 90.0, -5.0, 0.0, 320.0, 380.0, 150.0, 60.0, 30.0, 160.0, 20.0, -20.0, 385.0, 50.0, 0.0, 40.0, 50.0, 50.0, 90.0, 40.0, 80.0, 110.0, 420.0, 0.0, 20.0, 100.0, 30.0, 10.0, 30.0, 130.0, 170.0, 0.0, 60.0, 20.0, 0.0, 50.0, 40.0, 40.0, 75.0, 30.0, 0.0, 250.0, 20.0, 30.0, 90.0, 70.0, 130.0, 80.0, 440.0, 90.0, 440.0, 80.0, 140.0, 170.0, 40.0, -5.0, 180.0, -20.0, 130.0, -55.0, 10.0, 160.0, 20.0, 10.0, 125.0, 110.0, 150.0, 5.0, 70.0, 360.0, 40.0, 80.0, 220.0, 60.0, 110.0, 10.0, 200.0, 40.0, 80.0, 45.0, 25.0, 20.0, 160.0, 210.0, 220.0, 60.0, 30.0, 230.0, 70.0, 140.0, 130.0, 40.0, 450.0, 20.0, 10.0, -10.0, 10.0, 90.0, 60.0, 220.0, 30.0, 10.0, 180.0, 0.0, 130.0, 40.0, 150.0, 0.0, 20.0, 0.0, 40.0, 20.0, 40.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5139430802976164, "mean_inference_ms": 1.4173596019033017, "mean_action_processing_ms": 0.4309626865920281, "mean_env_wait_ms": 1.2549940044261063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012712717056274414, "StateBufferConnector_ms": 0.009340524673461914, "ViewRequirementAgentConnector_ms": 0.3804488182067871}, "num_episodes": 22, "episode_return_max": 2110.0, "episode_return_min": 40.0, "episode_return_mean": 956.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.416532058298166, "num_env_steps_trained_throughput_per_sec": 21.416532058298166, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 3760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3760000, "timers": {"training_iteration_time_ms": 187106.501, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187106.454, "sample_time_ms": 2613.988, "learn_time_ms": 184472.887, "learn_throughput": 21.683, "synch_weights_time_ms": 12.235}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "done": false, "training_iteration": 94, "trial_id": "90816_00000", "date": "2024-06-10_05-06-44", "timestamp": 1718010404, "time_this_iter_s": 186.7812421321869, "time_total_s": 17681.94553375244, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b011a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17681.94553375244, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 17.504545454545458, "ram_util_percent": 78.96060606060607}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0799017293702047, "cur_kl_coeff": 0.5406097412109376, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008603258671425482, "vf_loss": 6.350658251099185, "vf_explained_var": 0.00033909305216024477, "kl": Infinity, "entropy": 0.4000501969307502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 887355.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "env_runners": {"episode_reward_max": 1970.0, "episode_reward_min": 40.0, "episode_reward_mean": 900.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -330.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 90.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1710.0, 780.0, 1560.0, 1180.0, 40.0, 1430.0, 590.0, 640.0, 610.0, 545.0, 1425.0, 900.0, 300.0, 710.0, 1320.0, 890.0, 860.0, 1005.0, 290.0, 520.0, 820.0, 760.0, 450.0, 1410.0, 485.0, 600.0, 775.0, 190.0, 330.0, 1830.0, 570.0, 840.0, 1700.0, 420.0, 1030.0, 1075.0, 800.0, 880.0, 1210.0, 795.0, 1170.0, 770.0, 730.0, 1385.0, 1050.0, 1040.0, 795.0, 1120.0, 1970.0, 1335.0, 1610.0, 1185.0, 1130.0, 1000.0, 790.0, 1320.0, 1070.0, 250.0, 935.0, 1500.0, 695.0, 380.0, 1295.0, 1010.0, 470.0, 1280.0, 785.0, 1300.0, 555.0, 665.0, 395.0, 1535.0, 880.0, 570.0, 535.0, 1730.0, 470.0, 1220.0, 900.0, 1390.0, 600.0, 510.0, 500.0, 860.0, 320.0, 610.0, 1170.0, 1055.0, 1060.0, 295.0, 675.0, 340.0, 1480.0, 460.0, 1120.0, 810.0, 560.0, 1590.0, 870.0, 720.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [380.0, 40.0, 190.0, 100.0, 540.0, 20.0, 90.0, 140.0, 120.0, 90.0, 10.0, 30.0, 70.0, 220.0, 20.0, -10.0, 170.0, 70.0, 10.0, 190.0, 160.0, 10.0, 230.0, 130.0, 90.0, 170.0, 160.0, 60.0, 400.0, 150.0, 60.0, -20.0, 230.0, 20.0, 60.0, 70.0, 400.0, 50.0, -10.0, 320.0, 30.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 30.0, 10.0, -20.0, 60.0, 110.0, 490.0, 150.0, 180.0, 30.0, 160.0, 40.0, 150.0, 60.0, 10.0, 20.0, 320.0, 0.0, 20.0, 40.0, 130.0, 50.0, -30.0, 30.0, 30.0, -80.0, 60.0, 200.0, 20.0, 40.0, 170.0, 0.0, 40.0, 160.0, -20.0, 20.0, -50.0, 150.0, 180.0, -50.0, 200.0, 70.0, -100.0, 210.0, 45.0, 10.0, 150.0, 30.0, 90.0, 0.0, 50.0, 40.0, 110.0, 20.0, 20.0, 20.0, 120.0, 40.0, 140.0, 660.0, 35.0, 340.0, 30.0, 20.0, 40.0, 180.0, 70.0, 100.0, 180.0, 70.0, 90.0, 130.0, -30.0, 70.0, 50.0, 20.0, 20.0, 40.0, 130.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 160.0, 60.0, -30.0, 20.0, 80.0, 110.0, 0.0, -50.0, 360.0, -30.0, 140.0, 90.0, 250.0, 200.0, 20.0, 110.0, 150.0, 120.0, 270.0, 240.0, 20.0, 100.0, 40.0, 50.0, 80.0, 30.0, 100.0, 150.0, 80.0, 150.0, 120.0, 90.0, 220.0, 50.0, 40.0, 140.0, 20.0, 30.0, 0.0, 30.0, 10.0, 80.0, 5.0, 210.0, 60.0, 10.0, 520.0, 70.0, 10.0, 0.0, 170.0, 0.0, 20.0, -10.0, 10.0, 10.0, 20.0, 10.0, 60.0, 160.0, 60.0, -10.0, -330.0, 20.0, 70.0, 80.0, 20.0, 160.0, 290.0, 60.0, 100.0, 200.0, 210.0, 0.0, 90.0, 160.0, 200.0, -270.0, 70.0, 200.0, 10.0, 60.0, 20.0, 10.0, 190.0, 200.0, 30.0, 20.0, 20.0, 50.0, -70.0, 80.0, 80.0, 400.0, -70.0, -55.0, -15.0, 80.0, -30.0, 140.0, 90.0, 120.0, 180.0, 70.0, 290.0, 240.0, 130.0, 100.0, 50.0, 0.0, 20.0, 210.0, -20.0, 10.0, 10.0, 180.0, 15.0, 10.0, 50.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 120.0, 0.0, 90.0, 200.0, -30.0, 60.0, 70.0, 290.0, 50.0, 90.0, -25.0, 5.0, -5.0, 270.0, 10.0, 40.0, 10.0, 20.0, 30.0, 15.0, -15.0, 20.0, -10.0, 70.0, 20.0, 10.0, 10.0, 70.0, 30.0, 10.0, 70.0, 10.0, 30.0, 70.0, 120.0, 0.0, 310.0, 100.0, 370.0, 640.0, 150.0, -10.0, 130.0, 20.0, 40.0, 20.0, 220.0, -5.0, 210.0, 10.0, 5.0, 30.0, 15.0, 25.0, 10.0, 80.0, 90.0, 270.0, 40.0, 160.0, 80.0, 10.0, 40.0, 60.0, 130.0, 70.0, 20.0, 540.0, 80.0, 420.0, 100.0, 110.0, 160.0, 70.0, 20.0, 100.0, 0.0, 60.0, -65.0, 170.0, 120.0, -25.0, 30.0, 10.0, 60.0, 200.0, 240.0, -50.0, 80.0, 50.0, 60.0, 310.0, 60.0, 20.0, 170.0, 60.0, 40.0, 20.0, 130.0, -5.0, 80.0, 70.0, 420.0, 90.0, 90.0, 100.0, 30.0, 25.0, 155.0, 100.0, 150.0, 30.0, 20.0, 100.0, 0.0, 150.0, 40.0, 30.0, 120.0, 40.0, 240.0, -70.0, 220.0, 110.0, 30.0, 150.0, 310.0, 50.0, 260.0, 20.0, 170.0, 50.0, 60.0, 110.0, 80.0, 0.0, 270.0, 10.0, 0.0, 120.0, 10.0, -5.0, 310.0, 0.0, 170.0, 170.0, 160.0, 250.0, 40.0, 50.0, 20.0, 120.0, 90.0, 100.0, 50.0, -10.0, 140.0, 100.0, -80.0, 0.0, 160.0, -30.0, 340.0, 100.0, 180.0, 80.0, 170.0, -75.0, 100.0, 40.0, 155.0, 20.0, 30.0, 30.0, 80.0, 240.0, 200.0, 150.0, -20.0, 30.0, 460.0, 80.0, 130.0, 35.0, 140.0, -20.0, 130.0, 10.0, 110.0, 370.0, 10.0, 20.0, 270.0, 10.0, 310.0, 190.0, 110.0, 10.0, 40.0, 190.0, 50.0, 20.0, 30.0, 90.0, 30.0, 0.0, 25.0, 10.0, 170.0, 140.0, 180.0, 20.0, 40.0, 180.0, 60.0, 90.0, 80.0, 230.0, 190.0, 120.0, 150.0, 20.0, 160.0, 20.0, -20.0, 180.0, 290.0, 0.0, 500.0, 80.0, 920.0, 0.0, 40.0, -20.0, 40.0, 120.0, 40.0, 120.0, 390.0, 25.0, 90.0, 60.0, 350.0, 100.0, 220.0, 110.0, 50.0, 140.0, 110.0, 180.0, 120.0, 80.0, 360.0, 240.0, 330.0, 0.0, 180.0, 20.0, 60.0, 130.0, 5.0, 50.0, 190.0, 220.0, 160.0, 80.0, 50.0, 70.0, 60.0, 520.0, 90.0, 10.0, 60.0, 30.0, 20.0, 30.0, 40.0, 80.0, 60.0, 300.0, 150.0, 130.0, 150.0, 40.0, 20.0, 40.0, 50.0, 110.0, 210.0, 40.0, 130.0, 10.0, 170.0, 10.0, 40.0, 10.0, 40.0, -10.0, 310.0, 80.0, 560.0, 30.0, 80.0, 180.0, 70.0, 30.0, 150.0, 80.0, 250.0, 390.0, 60.0, -30.0, 50.0, 20.0, 40.0, 10.0, 70.0, 40.0, 5.0, 10.0, 20.0, 30.0, -5.0, 30.0, 140.0, 20.0, 90.0, 70.0, 0.0, 450.0, 10.0, 30.0, 130.0, -5.0, 320.0, 90.0, 130.0, 150.0, 80.0, 90.0, 0.0, 580.0, -10.0, 70.0, 20.0, 40.0, 270.0, 10.0, 40.0, 5.0, 40.0, 20.0, 50.0, 200.0, 170.0, -10.0, 20.0, 10.0, 50.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 60.0, 140.0, 470.0, 140.0, 350.0, 0.0, 0.0, 110.0, 25.0, 0.0, 220.0, 30.0, 70.0, 340.0, 80.0, -40.0, 10.0, 130.0, 170.0, 70.0, 50.0, 160.0, 30.0, 40.0, 0.0, 0.0, -20.0, 90.0, 50.0, 20.0, 140.0, 40.0, 160.0, 20.0, 90.0, 470.0, 190.0, 0.0, 150.0, 30.0, 35.0, 110.0, 80.0, 260.0, 180.0, 50.0, 10.0, 0.0, 30.0, 30.0, 410.0, 50.0, 130.0, 260.0, 50.0, 20.0, 300.0, 20.0, 30.0, 390.0, 40.0, 20.0, -20.0, 20.0, 30.0, -30.0, -5.0, 60.0, 50.0, 150.0, 220.0, 80.0, 0.0, 60.0, 15.0, 70.0, 0.0, 10.0, 60.0, 10.0, 200.0, -5.0, 50.0, 30.0, 5.0, 20.0, 90.0, -5.0, 0.0, 320.0, 380.0, 150.0, 60.0, 30.0, 160.0, 20.0, -20.0, 385.0, 50.0, 0.0, 40.0, 50.0, 50.0, 90.0, 40.0, 80.0, 110.0, 420.0, 0.0, 20.0, 100.0, 30.0, 10.0, 30.0, 130.0, 170.0, 0.0, 60.0, 20.0, 0.0, 50.0, 40.0, 40.0, 75.0, 30.0, 0.0, 250.0, 20.0, 30.0, 90.0, 70.0, 130.0, 80.0, 440.0, 90.0, 440.0, 80.0, 140.0, 170.0, 40.0, -5.0, 180.0, -20.0, 130.0, -55.0, 10.0, 160.0, 20.0, 10.0, 125.0, 110.0, 150.0, 5.0, 70.0, 360.0, 40.0, 80.0, 220.0, 60.0, 110.0, 10.0, 200.0, 40.0, 80.0, 45.0, 25.0, 20.0, 160.0, 210.0, 220.0, 60.0, 30.0, 230.0, 70.0, 140.0, 130.0, 40.0, 450.0, 20.0, 10.0, -10.0, 10.0, 90.0, 60.0, 220.0, 30.0, 10.0, 180.0, 0.0, 130.0, 40.0, 150.0, 0.0, 20.0, 0.0, 40.0, 20.0, 40.0, 70.0, 0.0, 40.0, 40.0, 50.0, 180.0, 40.0, 50.0, 60.0, 10.0, 30.0, 0.0, 130.0, 10.0, 30.0, 170.0, 20.0, 290.0, 140.0, 30.0, 40.0, 0.0, 80.0, -10.0, 30.0, 190.0, 20.0, 0.0, -10.0, 20.0, 0.0, 130.0, 40.0, 30.0, 80.0, 130.0, 0.0, 60.0, 50.0, 0.0, 90.0, 90.0, 300.0, 0.0, 20.0, 50.0, 160.0, 40.0, 180.0, 170.0, 160.0, 50.0, 190.0, 20.0, 70.0, 45.0, 70.0, 100.0, 110.0, 340.0, 60.0, 50.0, 70.0, 20.0, 50.0, 40.0, 0.0, 300.0, 160.0, 190.0, 180.0, -35.0, 20.0, 10.0, 10.0, 10.0, 160.0, 10.0, 110.0, 40.0, -40.0, 70.0, 190.0, -5.0, 30.0, 40.0, 15.0, 40.0, 5.0, 30.0, 260.0, 20.0, 40.0, 10.0, 50.0, 20.0, 140.0, 10.0, 40.0, 0.0, 10.0, -35.0, 560.0, 260.0, 100.0, 90.0, 200.0, 190.0, -25.0, 50.0, 90.0, 20.0, 25.0, -15.0, -10.0, 100.0, 20.0, 0.0, -15.0, 290.0, 45.0, 10.0, 20.0, 470.0, 90.0, 80.0, 30.0, 80.0, 30.0, 130.0, 180.0, 170.0, 120.0, -30.0, 80.0, -110.0, 90.0, 450.0, 70.0, -100.0, 70.0, 20.0, 80.0, 0.0, 150.0, 120.0, 20.0, 40.0, 70.0, 40.0, 20.0, 50.0, 220.0, -20.0, 110.0, 270.0, 170.0, 200.0, 190.0, 80.0, 320.0, 160.0, 10.0, -10.0, 40.0, 0.0, 40.0, 70.0, 160.0, 500.0, -100.0, 10.0, 0.0, 150.0, 80.0, 30.0, 70.0, 250.0, 120.0, -10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5133701163721884, "mean_inference_ms": 1.4167301639871248, "mean_action_processing_ms": 0.43046735438947936, "mean_env_wait_ms": 1.2546342672449686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012113094329833984, "StateBufferConnector_ms": 0.009118795394897461, "ViewRequirementAgentConnector_ms": 0.372194766998291}, "num_episodes": 18, "episode_return_max": 1970.0, "episode_return_min": 40.0, "episode_return_mean": 900.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.378383561893518, "num_env_steps_trained_throughput_per_sec": 21.378383561893518, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 3800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3800000, "timers": {"training_iteration_time_ms": 186897.229, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186897.183, "sample_time_ms": 2506.426, "learn_time_ms": 184370.991, "learn_throughput": 21.695, "synch_weights_time_ms": 12.479}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "done": false, "training_iteration": 95, "trial_id": "90816_00000", "date": "2024-06-10_05-09-51", "timestamp": 1718010591, "time_this_iter_s": 187.11532998085022, "time_total_s": 17869.06086373329, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b01305e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17869.06086373329, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 18.08787878787879, "ram_util_percent": 78.87765151515153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9488784481669132, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006284947771702013, "vf_loss": 5.730134367714294, "vf_explained_var": 0.0003986791617319353, "kl": Infinity, "entropy": 0.43730267237740966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 896745.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "env_runners": {"episode_reward_max": 1970.0, "episode_reward_min": 190.0, "episode_reward_mean": 888.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 88.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1410.0, 485.0, 600.0, 775.0, 190.0, 330.0, 1830.0, 570.0, 840.0, 1700.0, 420.0, 1030.0, 1075.0, 800.0, 880.0, 1210.0, 795.0, 1170.0, 770.0, 730.0, 1385.0, 1050.0, 1040.0, 795.0, 1120.0, 1970.0, 1335.0, 1610.0, 1185.0, 1130.0, 1000.0, 790.0, 1320.0, 1070.0, 250.0, 935.0, 1500.0, 695.0, 380.0, 1295.0, 1010.0, 470.0, 1280.0, 785.0, 1300.0, 555.0, 665.0, 395.0, 1535.0, 880.0, 570.0, 535.0, 1730.0, 470.0, 1220.0, 900.0, 1390.0, 600.0, 510.0, 500.0, 860.0, 320.0, 610.0, 1170.0, 1055.0, 1060.0, 295.0, 675.0, 340.0, 1480.0, 460.0, 1120.0, 810.0, 560.0, 1590.0, 870.0, 720.0, 790.0, 410.0, 310.0, 230.0, 790.0, 790.0, 270.0, 810.0, 660.0, 810.0, 710.0, 1320.0, 800.0, 540.0, 1425.0, 980.0, 650.0, 520.0, 1330.0, 1080.0, 990.0, 700.0, 1175.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 90.0, 120.0, 180.0, 70.0, 290.0, 240.0, 130.0, 100.0, 50.0, 0.0, 20.0, 210.0, -20.0, 10.0, 10.0, 180.0, 15.0, 10.0, 50.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 120.0, 0.0, 90.0, 200.0, -30.0, 60.0, 70.0, 290.0, 50.0, 90.0, -25.0, 5.0, -5.0, 270.0, 10.0, 40.0, 10.0, 20.0, 30.0, 15.0, -15.0, 20.0, -10.0, 70.0, 20.0, 10.0, 10.0, 70.0, 30.0, 10.0, 70.0, 10.0, 30.0, 70.0, 120.0, 0.0, 310.0, 100.0, 370.0, 640.0, 150.0, -10.0, 130.0, 20.0, 40.0, 20.0, 220.0, -5.0, 210.0, 10.0, 5.0, 30.0, 15.0, 25.0, 10.0, 80.0, 90.0, 270.0, 40.0, 160.0, 80.0, 10.0, 40.0, 60.0, 130.0, 70.0, 20.0, 540.0, 80.0, 420.0, 100.0, 110.0, 160.0, 70.0, 20.0, 100.0, 0.0, 60.0, -65.0, 170.0, 120.0, -25.0, 30.0, 10.0, 60.0, 200.0, 240.0, -50.0, 80.0, 50.0, 60.0, 310.0, 60.0, 20.0, 170.0, 60.0, 40.0, 20.0, 130.0, -5.0, 80.0, 70.0, 420.0, 90.0, 90.0, 100.0, 30.0, 25.0, 155.0, 100.0, 150.0, 30.0, 20.0, 100.0, 0.0, 150.0, 40.0, 30.0, 120.0, 40.0, 240.0, -70.0, 220.0, 110.0, 30.0, 150.0, 310.0, 50.0, 260.0, 20.0, 170.0, 50.0, 60.0, 110.0, 80.0, 0.0, 270.0, 10.0, 0.0, 120.0, 10.0, -5.0, 310.0, 0.0, 170.0, 170.0, 160.0, 250.0, 40.0, 50.0, 20.0, 120.0, 90.0, 100.0, 50.0, -10.0, 140.0, 100.0, -80.0, 0.0, 160.0, -30.0, 340.0, 100.0, 180.0, 80.0, 170.0, -75.0, 100.0, 40.0, 155.0, 20.0, 30.0, 30.0, 80.0, 240.0, 200.0, 150.0, -20.0, 30.0, 460.0, 80.0, 130.0, 35.0, 140.0, -20.0, 130.0, 10.0, 110.0, 370.0, 10.0, 20.0, 270.0, 10.0, 310.0, 190.0, 110.0, 10.0, 40.0, 190.0, 50.0, 20.0, 30.0, 90.0, 30.0, 0.0, 25.0, 10.0, 170.0, 140.0, 180.0, 20.0, 40.0, 180.0, 60.0, 90.0, 80.0, 230.0, 190.0, 120.0, 150.0, 20.0, 160.0, 20.0, -20.0, 180.0, 290.0, 0.0, 500.0, 80.0, 920.0, 0.0, 40.0, -20.0, 40.0, 120.0, 40.0, 120.0, 390.0, 25.0, 90.0, 60.0, 350.0, 100.0, 220.0, 110.0, 50.0, 140.0, 110.0, 180.0, 120.0, 80.0, 360.0, 240.0, 330.0, 0.0, 180.0, 20.0, 60.0, 130.0, 5.0, 50.0, 190.0, 220.0, 160.0, 80.0, 50.0, 70.0, 60.0, 520.0, 90.0, 10.0, 60.0, 30.0, 20.0, 30.0, 40.0, 80.0, 60.0, 300.0, 150.0, 130.0, 150.0, 40.0, 20.0, 40.0, 50.0, 110.0, 210.0, 40.0, 130.0, 10.0, 170.0, 10.0, 40.0, 10.0, 40.0, -10.0, 310.0, 80.0, 560.0, 30.0, 80.0, 180.0, 70.0, 30.0, 150.0, 80.0, 250.0, 390.0, 60.0, -30.0, 50.0, 20.0, 40.0, 10.0, 70.0, 40.0, 5.0, 10.0, 20.0, 30.0, -5.0, 30.0, 140.0, 20.0, 90.0, 70.0, 0.0, 450.0, 10.0, 30.0, 130.0, -5.0, 320.0, 90.0, 130.0, 150.0, 80.0, 90.0, 0.0, 580.0, -10.0, 70.0, 20.0, 40.0, 270.0, 10.0, 40.0, 5.0, 40.0, 20.0, 50.0, 200.0, 170.0, -10.0, 20.0, 10.0, 50.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 60.0, 140.0, 470.0, 140.0, 350.0, 0.0, 0.0, 110.0, 25.0, 0.0, 220.0, 30.0, 70.0, 340.0, 80.0, -40.0, 10.0, 130.0, 170.0, 70.0, 50.0, 160.0, 30.0, 40.0, 0.0, 0.0, -20.0, 90.0, 50.0, 20.0, 140.0, 40.0, 160.0, 20.0, 90.0, 470.0, 190.0, 0.0, 150.0, 30.0, 35.0, 110.0, 80.0, 260.0, 180.0, 50.0, 10.0, 0.0, 30.0, 30.0, 410.0, 50.0, 130.0, 260.0, 50.0, 20.0, 300.0, 20.0, 30.0, 390.0, 40.0, 20.0, -20.0, 20.0, 30.0, -30.0, -5.0, 60.0, 50.0, 150.0, 220.0, 80.0, 0.0, 60.0, 15.0, 70.0, 0.0, 10.0, 60.0, 10.0, 200.0, -5.0, 50.0, 30.0, 5.0, 20.0, 90.0, -5.0, 0.0, 320.0, 380.0, 150.0, 60.0, 30.0, 160.0, 20.0, -20.0, 385.0, 50.0, 0.0, 40.0, 50.0, 50.0, 90.0, 40.0, 80.0, 110.0, 420.0, 0.0, 20.0, 100.0, 30.0, 10.0, 30.0, 130.0, 170.0, 0.0, 60.0, 20.0, 0.0, 50.0, 40.0, 40.0, 75.0, 30.0, 0.0, 250.0, 20.0, 30.0, 90.0, 70.0, 130.0, 80.0, 440.0, 90.0, 440.0, 80.0, 140.0, 170.0, 40.0, -5.0, 180.0, -20.0, 130.0, -55.0, 10.0, 160.0, 20.0, 10.0, 125.0, 110.0, 150.0, 5.0, 70.0, 360.0, 40.0, 80.0, 220.0, 60.0, 110.0, 10.0, 200.0, 40.0, 80.0, 45.0, 25.0, 20.0, 160.0, 210.0, 220.0, 60.0, 30.0, 230.0, 70.0, 140.0, 130.0, 40.0, 450.0, 20.0, 10.0, -10.0, 10.0, 90.0, 60.0, 220.0, 30.0, 10.0, 180.0, 0.0, 130.0, 40.0, 150.0, 0.0, 20.0, 0.0, 40.0, 20.0, 40.0, 70.0, 0.0, 40.0, 40.0, 50.0, 180.0, 40.0, 50.0, 60.0, 10.0, 30.0, 0.0, 130.0, 10.0, 30.0, 170.0, 20.0, 290.0, 140.0, 30.0, 40.0, 0.0, 80.0, -10.0, 30.0, 190.0, 20.0, 0.0, -10.0, 20.0, 0.0, 130.0, 40.0, 30.0, 80.0, 130.0, 0.0, 60.0, 50.0, 0.0, 90.0, 90.0, 300.0, 0.0, 20.0, 50.0, 160.0, 40.0, 180.0, 170.0, 160.0, 50.0, 190.0, 20.0, 70.0, 45.0, 70.0, 100.0, 110.0, 340.0, 60.0, 50.0, 70.0, 20.0, 50.0, 40.0, 0.0, 300.0, 160.0, 190.0, 180.0, -35.0, 20.0, 10.0, 10.0, 10.0, 160.0, 10.0, 110.0, 40.0, -40.0, 70.0, 190.0, -5.0, 30.0, 40.0, 15.0, 40.0, 5.0, 30.0, 260.0, 20.0, 40.0, 10.0, 50.0, 20.0, 140.0, 10.0, 40.0, 0.0, 10.0, -35.0, 560.0, 260.0, 100.0, 90.0, 200.0, 190.0, -25.0, 50.0, 90.0, 20.0, 25.0, -15.0, -10.0, 100.0, 20.0, 0.0, -15.0, 290.0, 45.0, 10.0, 20.0, 470.0, 90.0, 80.0, 30.0, 80.0, 30.0, 130.0, 180.0, 170.0, 120.0, -30.0, 80.0, -110.0, 90.0, 450.0, 70.0, -100.0, 70.0, 20.0, 80.0, 0.0, 150.0, 120.0, 20.0, 40.0, 70.0, 40.0, 20.0, 50.0, 220.0, -20.0, 110.0, 270.0, 170.0, 200.0, 190.0, 80.0, 320.0, 160.0, 10.0, -10.0, 40.0, 0.0, 40.0, 70.0, 160.0, 500.0, -100.0, 10.0, 0.0, 150.0, 80.0, 30.0, 70.0, 250.0, 120.0, -10.0, 20.0, 30.0, 80.0, 60.0, 40.0, 270.0, 90.0, 30.0, 130.0, 0.0, 60.0, 10.0, 40.0, 60.0, 20.0, 0.0, 20.0, 20.0, 70.0, 30.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 0.0, 140.0, 30.0, 40.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 80.0, 390.0, 10.0, 40.0, 40.0, 130.0, 20.0, 50.0, 310.0, 40.0, 30.0, 90.0, 60.0, 100.0, 40.0, 60.0, 60.0, 0.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 10.0, 10.0, 120.0, 40.0, 0.0, 70.0, 190.0, 30.0, 290.0, 30.0, 20.0, 100.0, 40.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 90.0, 70.0, 340.0, 30.0, 30.0, 300.0, 80.0, 40.0, 20.0, 40.0, 20.0, 160.0, 90.0, 30.0, 30.0, 70.0, 20.0, -35.0, 60.0, 190.0, 70.0, 15.0, 290.0, 0.0, 170.0, 160.0, 50.0, 50.0, 370.0, -40.0, -50.0, 280.0, 80.0, 250.0, 100.0, 0.0, 90.0, 180.0, 120.0, 40.0, 25.0, 10.0, 90.0, 145.0, 40.0, 10.0, 70.0, 240.0, 20.0, 10.0, 40.0, 10.0, 10.0, 90.0, 130.0, 120.0, 120.0, 90.0, 20.0, 320.0, 100.0, 180.0, 330.0, 15.0, 30.0, 120.0, 40.0, 120.0, 80.0, 70.0, 230.0, 90.0, 160.0, 40.0, 10.0, 160.0, 0.0, 50.0, 180.0, 60.0, 90.0, 60.0, 30.0, 10.0, 70.0, 30.0, 30.0, 0.0, 80.0, 0.0, 90.0, 40.0, 40.0, 140.0, 40.0, 30.0, 160.0, 60.0, 370.0, 60.0, 40.0, 70.0, 170.0, 330.0, 40.0, 90.0, 400.0, -10.0, 90.0, 150.0, 190.0, 90.0, 10.0, 30.0, 160.0, 50.0, 290.0, 100.0, 30.0, 160.0, 20.0, 50.0, 20.0, 110.0, 10.0, 190.0, 70.0, 60.0, 40.0, 60.0, 70.0, 30.0, 140.0, 30.0, 150.0, 40.0, 200.0, 220.0, 130.0, 170.0, 10.0, 115.0, 0.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.512643797260497, "mean_inference_ms": 1.41610628467968, "mean_action_processing_ms": 0.42986029369504464, "mean_env_wait_ms": 1.2541706632305918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011662006378173828, "StateBufferConnector_ms": 0.009699821472167969, "ViewRequirementAgentConnector_ms": 0.3614969253540039}, "num_episodes": 23, "episode_return_max": 1970.0, "episode_return_min": 190.0, "episode_return_mean": 888.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.474076167141302, "num_env_steps_trained_throughput_per_sec": 21.474076167141302, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 3840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3840000, "timers": {"training_iteration_time_ms": 186996.367, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186996.321, "sample_time_ms": 2524.394, "learn_time_ms": 184451.918, "learn_throughput": 21.686, "synch_weights_time_ms": 12.674}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "done": false, "training_iteration": 96, "trial_id": "90816_00000", "date": "2024-06-10_05-12-58", "timestamp": 1718010778, "time_this_iter_s": 186.28257775306702, "time_total_s": 18055.34344148636, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0130dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18055.34344148636, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 17.2280303030303, "ram_util_percent": 78.9219696969697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.39974618846743, "cur_kl_coeff": 1.2163719177246093, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.924166040958815, "policy_loss": -0.007151760710319018, "vf_loss": 6.928513429060785, "vf_explained_var": 0.0008023685032821184, "kl": 0.0023055226172680773, "entropy": 0.37184455896211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 906135.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "env_runners": {"episode_reward_max": 1970.0, "episode_reward_min": 230.0, "episode_reward_mean": 906.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 90.68}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0, 730.0, 1385.0, 1050.0, 1040.0, 795.0, 1120.0, 1970.0, 1335.0, 1610.0, 1185.0, 1130.0, 1000.0, 790.0, 1320.0, 1070.0, 250.0, 935.0, 1500.0, 695.0, 380.0, 1295.0, 1010.0, 470.0, 1280.0, 785.0, 1300.0, 555.0, 665.0, 395.0, 1535.0, 880.0, 570.0, 535.0, 1730.0, 470.0, 1220.0, 900.0, 1390.0, 600.0, 510.0, 500.0, 860.0, 320.0, 610.0, 1170.0, 1055.0, 1060.0, 295.0, 675.0, 340.0, 1480.0, 460.0, 1120.0, 810.0, 560.0, 1590.0, 870.0, 720.0, 790.0, 410.0, 310.0, 230.0, 790.0, 790.0, 270.0, 810.0, 660.0, 810.0, 710.0, 1320.0, 800.0, 540.0, 1425.0, 980.0, 650.0, 520.0, 1330.0, 1080.0, 990.0, 700.0, 1175.0, 670.0, 1140.0, 830.0, 1130.0, 920.0, 1110.0, 1100.0, 1040.0, 430.0, 385.0, 820.0, 1200.0, 1480.0, 1115.0, 1720.0, 585.0, 885.0, 1380.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, -10.0, 140.0, 100.0, -80.0, 0.0, 160.0, -30.0, 340.0, 100.0, 180.0, 80.0, 170.0, -75.0, 100.0, 40.0, 155.0, 20.0, 30.0, 30.0, 80.0, 240.0, 200.0, 150.0, -20.0, 30.0, 460.0, 80.0, 130.0, 35.0, 140.0, -20.0, 130.0, 10.0, 110.0, 370.0, 10.0, 20.0, 270.0, 10.0, 310.0, 190.0, 110.0, 10.0, 40.0, 190.0, 50.0, 20.0, 30.0, 90.0, 30.0, 0.0, 25.0, 10.0, 170.0, 140.0, 180.0, 20.0, 40.0, 180.0, 60.0, 90.0, 80.0, 230.0, 190.0, 120.0, 150.0, 20.0, 160.0, 20.0, -20.0, 180.0, 290.0, 0.0, 500.0, 80.0, 920.0, 0.0, 40.0, -20.0, 40.0, 120.0, 40.0, 120.0, 390.0, 25.0, 90.0, 60.0, 350.0, 100.0, 220.0, 110.0, 50.0, 140.0, 110.0, 180.0, 120.0, 80.0, 360.0, 240.0, 330.0, 0.0, 180.0, 20.0, 60.0, 130.0, 5.0, 50.0, 190.0, 220.0, 160.0, 80.0, 50.0, 70.0, 60.0, 520.0, 90.0, 10.0, 60.0, 30.0, 20.0, 30.0, 40.0, 80.0, 60.0, 300.0, 150.0, 130.0, 150.0, 40.0, 20.0, 40.0, 50.0, 110.0, 210.0, 40.0, 130.0, 10.0, 170.0, 10.0, 40.0, 10.0, 40.0, -10.0, 310.0, 80.0, 560.0, 30.0, 80.0, 180.0, 70.0, 30.0, 150.0, 80.0, 250.0, 390.0, 60.0, -30.0, 50.0, 20.0, 40.0, 10.0, 70.0, 40.0, 5.0, 10.0, 20.0, 30.0, -5.0, 30.0, 140.0, 20.0, 90.0, 70.0, 0.0, 450.0, 10.0, 30.0, 130.0, -5.0, 320.0, 90.0, 130.0, 150.0, 80.0, 90.0, 0.0, 580.0, -10.0, 70.0, 20.0, 40.0, 270.0, 10.0, 40.0, 5.0, 40.0, 20.0, 50.0, 200.0, 170.0, -10.0, 20.0, 10.0, 50.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 60.0, 140.0, 470.0, 140.0, 350.0, 0.0, 0.0, 110.0, 25.0, 0.0, 220.0, 30.0, 70.0, 340.0, 80.0, -40.0, 10.0, 130.0, 170.0, 70.0, 50.0, 160.0, 30.0, 40.0, 0.0, 0.0, -20.0, 90.0, 50.0, 20.0, 140.0, 40.0, 160.0, 20.0, 90.0, 470.0, 190.0, 0.0, 150.0, 30.0, 35.0, 110.0, 80.0, 260.0, 180.0, 50.0, 10.0, 0.0, 30.0, 30.0, 410.0, 50.0, 130.0, 260.0, 50.0, 20.0, 300.0, 20.0, 30.0, 390.0, 40.0, 20.0, -20.0, 20.0, 30.0, -30.0, -5.0, 60.0, 50.0, 150.0, 220.0, 80.0, 0.0, 60.0, 15.0, 70.0, 0.0, 10.0, 60.0, 10.0, 200.0, -5.0, 50.0, 30.0, 5.0, 20.0, 90.0, -5.0, 0.0, 320.0, 380.0, 150.0, 60.0, 30.0, 160.0, 20.0, -20.0, 385.0, 50.0, 0.0, 40.0, 50.0, 50.0, 90.0, 40.0, 80.0, 110.0, 420.0, 0.0, 20.0, 100.0, 30.0, 10.0, 30.0, 130.0, 170.0, 0.0, 60.0, 20.0, 0.0, 50.0, 40.0, 40.0, 75.0, 30.0, 0.0, 250.0, 20.0, 30.0, 90.0, 70.0, 130.0, 80.0, 440.0, 90.0, 440.0, 80.0, 140.0, 170.0, 40.0, -5.0, 180.0, -20.0, 130.0, -55.0, 10.0, 160.0, 20.0, 10.0, 125.0, 110.0, 150.0, 5.0, 70.0, 360.0, 40.0, 80.0, 220.0, 60.0, 110.0, 10.0, 200.0, 40.0, 80.0, 45.0, 25.0, 20.0, 160.0, 210.0, 220.0, 60.0, 30.0, 230.0, 70.0, 140.0, 130.0, 40.0, 450.0, 20.0, 10.0, -10.0, 10.0, 90.0, 60.0, 220.0, 30.0, 10.0, 180.0, 0.0, 130.0, 40.0, 150.0, 0.0, 20.0, 0.0, 40.0, 20.0, 40.0, 70.0, 0.0, 40.0, 40.0, 50.0, 180.0, 40.0, 50.0, 60.0, 10.0, 30.0, 0.0, 130.0, 10.0, 30.0, 170.0, 20.0, 290.0, 140.0, 30.0, 40.0, 0.0, 80.0, -10.0, 30.0, 190.0, 20.0, 0.0, -10.0, 20.0, 0.0, 130.0, 40.0, 30.0, 80.0, 130.0, 0.0, 60.0, 50.0, 0.0, 90.0, 90.0, 300.0, 0.0, 20.0, 50.0, 160.0, 40.0, 180.0, 170.0, 160.0, 50.0, 190.0, 20.0, 70.0, 45.0, 70.0, 100.0, 110.0, 340.0, 60.0, 50.0, 70.0, 20.0, 50.0, 40.0, 0.0, 300.0, 160.0, 190.0, 180.0, -35.0, 20.0, 10.0, 10.0, 10.0, 160.0, 10.0, 110.0, 40.0, -40.0, 70.0, 190.0, -5.0, 30.0, 40.0, 15.0, 40.0, 5.0, 30.0, 260.0, 20.0, 40.0, 10.0, 50.0, 20.0, 140.0, 10.0, 40.0, 0.0, 10.0, -35.0, 560.0, 260.0, 100.0, 90.0, 200.0, 190.0, -25.0, 50.0, 90.0, 20.0, 25.0, -15.0, -10.0, 100.0, 20.0, 0.0, -15.0, 290.0, 45.0, 10.0, 20.0, 470.0, 90.0, 80.0, 30.0, 80.0, 30.0, 130.0, 180.0, 170.0, 120.0, -30.0, 80.0, -110.0, 90.0, 450.0, 70.0, -100.0, 70.0, 20.0, 80.0, 0.0, 150.0, 120.0, 20.0, 40.0, 70.0, 40.0, 20.0, 50.0, 220.0, -20.0, 110.0, 270.0, 170.0, 200.0, 190.0, 80.0, 320.0, 160.0, 10.0, -10.0, 40.0, 0.0, 40.0, 70.0, 160.0, 500.0, -100.0, 10.0, 0.0, 150.0, 80.0, 30.0, 70.0, 250.0, 120.0, -10.0, 20.0, 30.0, 80.0, 60.0, 40.0, 270.0, 90.0, 30.0, 130.0, 0.0, 60.0, 10.0, 40.0, 60.0, 20.0, 0.0, 20.0, 20.0, 70.0, 30.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 0.0, 140.0, 30.0, 40.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 80.0, 390.0, 10.0, 40.0, 40.0, 130.0, 20.0, 50.0, 310.0, 40.0, 30.0, 90.0, 60.0, 100.0, 40.0, 60.0, 60.0, 0.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 10.0, 10.0, 120.0, 40.0, 0.0, 70.0, 190.0, 30.0, 290.0, 30.0, 20.0, 100.0, 40.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 90.0, 70.0, 340.0, 30.0, 30.0, 300.0, 80.0, 40.0, 20.0, 40.0, 20.0, 160.0, 90.0, 30.0, 30.0, 70.0, 20.0, -35.0, 60.0, 190.0, 70.0, 15.0, 290.0, 0.0, 170.0, 160.0, 50.0, 50.0, 370.0, -40.0, -50.0, 280.0, 80.0, 250.0, 100.0, 0.0, 90.0, 180.0, 120.0, 40.0, 25.0, 10.0, 90.0, 145.0, 40.0, 10.0, 70.0, 240.0, 20.0, 10.0, 40.0, 10.0, 10.0, 90.0, 130.0, 120.0, 120.0, 90.0, 20.0, 320.0, 100.0, 180.0, 330.0, 15.0, 30.0, 120.0, 40.0, 120.0, 80.0, 70.0, 230.0, 90.0, 160.0, 40.0, 10.0, 160.0, 0.0, 50.0, 180.0, 60.0, 90.0, 60.0, 30.0, 10.0, 70.0, 30.0, 30.0, 0.0, 80.0, 0.0, 90.0, 40.0, 40.0, 140.0, 40.0, 30.0, 160.0, 60.0, 370.0, 60.0, 40.0, 70.0, 170.0, 330.0, 40.0, 90.0, 400.0, -10.0, 90.0, 150.0, 190.0, 90.0, 10.0, 30.0, 160.0, 50.0, 290.0, 100.0, 30.0, 160.0, 20.0, 50.0, 20.0, 110.0, 10.0, 190.0, 70.0, 60.0, 40.0, 60.0, 70.0, 30.0, 140.0, 30.0, 150.0, 40.0, 200.0, 220.0, 130.0, 170.0, 10.0, 115.0, 0.0, 140.0, 60.0, 500.0, 320.0, -80.0, -470.0, 0.0, -70.0, 110.0, 170.0, 130.0, 610.0, 120.0, 30.0, 20.0, 110.0, 70.0, 150.0, 30.0, 0.0, 0.0, 30.0, 20.0, 50.0, 30.0, 70.0, 60.0, 330.0, 10.0, 190.0, 40.0, 380.0, 50.0, 130.0, 20.0, 80.0, 10.0, 400.0, -20.0, 0.0, 80.0, 170.0, -40.0, 30.0, 360.0, 0.0, 140.0, 190.0, 20.0, 30.0, 20.0, 320.0, 100.0, 30.0, 50.0, 110.0, 50.0, 10.0, 320.0, 30.0, 90.0, 180.0, 30.0, 130.0, 160.0, 0.0, 200.0, 200.0, 160.0, -30.0, 70.0, 90.0, -30.0, 180.0, 30.0, 30.0, 170.0, 60.0, 60.0, 80.0, 370.0, 0.0, 80.0, 0.0, 40.0, 20.0, 250.0, 15.0, 10.0, 5.0, 10.0, 0.0, 50.0, 90.0, 120.0, 60.0, 20.0, 20.0, 30.0, -5.0, 0.0, 90.0, 35.0, 5.0, 50.0, 310.0, 90.0, 160.0, 40.0, 10.0, 30.0, 130.0, 50.0, 30.0, 130.0, 160.0, 150.0, 300.0, 60.0, 110.0, 80.0, 240.0, 180.0, 90.0, 130.0, 60.0, 90.0, 320.0, 370.0, 170.0, -170.0, 90.0, 40.0, 420.0, 40.0, 35.0, 170.0, 70.0, 120.0, 90.0, 40.0, 90.0, 30.0, 160.0, 110.0, 310.0, 300.0, 440.0, 80.0, 150.0, 50.0, 0.0, 20.0, 30.0, 310.0, 80.0, 70.0, 10.0, 30.0, 20.0, 15.0, 20.0, 30.0, 20.0, 25.0, 350.0, 40.0, 60.0, 50.0, 10.0, 280.0, 120.0, 70.0, 40.0, 400.0, 210.0, 180.0, 70.0, 70.0, 100.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5121762649001669, "mean_inference_ms": 1.4157563284197077, "mean_action_processing_ms": 0.429395922960706, "mean_env_wait_ms": 1.253840711947254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012981176376342773, "StateBufferConnector_ms": 0.009691715240478516, "ViewRequirementAgentConnector_ms": 0.3586118221282959}, "num_episodes": 18, "episode_return_max": 1970.0, "episode_return_min": 230.0, "episode_return_mean": 906.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.43520416620901, "num_env_steps_trained_throughput_per_sec": 21.43520416620901, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 3880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3880000, "timers": {"training_iteration_time_ms": 186909.925, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186909.878, "sample_time_ms": 2467.243, "learn_time_ms": 184422.877, "learn_throughput": 21.689, "synch_weights_time_ms": 12.493}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "done": false, "training_iteration": 97, "trial_id": "90816_00000", "date": "2024-06-10_05-16-04", "timestamp": 1718010964, "time_this_iter_s": 186.6188259124756, "time_total_s": 18241.962267398834, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0103670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18241.962267398834, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.781818181818185, "ram_util_percent": 78.12954545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.274819033163678, "cur_kl_coeff": 0.6081859588623046, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00866366604403062, "vf_loss": 6.908831291381543, "vf_explained_var": 0.0005190895324824844, "kl": Infinity, "entropy": 0.3841334157414076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 915525.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "env_runners": {"episode_reward_max": 1820.0, "episode_reward_min": 120.0, "episode_reward_mean": 885.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 88.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1500.0, 695.0, 380.0, 1295.0, 1010.0, 470.0, 1280.0, 785.0, 1300.0, 555.0, 665.0, 395.0, 1535.0, 880.0, 570.0, 535.0, 1730.0, 470.0, 1220.0, 900.0, 1390.0, 600.0, 510.0, 500.0, 860.0, 320.0, 610.0, 1170.0, 1055.0, 1060.0, 295.0, 675.0, 340.0, 1480.0, 460.0, 1120.0, 810.0, 560.0, 1590.0, 870.0, 720.0, 790.0, 410.0, 310.0, 230.0, 790.0, 790.0, 270.0, 810.0, 660.0, 810.0, 710.0, 1320.0, 800.0, 540.0, 1425.0, 980.0, 650.0, 520.0, 1330.0, 1080.0, 990.0, 700.0, 1175.0, 670.0, 1140.0, 830.0, 1130.0, 920.0, 1110.0, 1100.0, 1040.0, 430.0, 385.0, 820.0, 1200.0, 1480.0, 1115.0, 1720.0, 585.0, 885.0, 1380.0, 410.0, 735.0, 120.0, 960.0, 1820.0, 1710.0, 310.0, 165.0, 870.0, 780.0, 855.0, 1750.0, 1420.0, 1120.0, 755.0, 1360.0, 1560.0, 630.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [320.0, 90.0, 130.0, 150.0, 80.0, 90.0, 0.0, 580.0, -10.0, 70.0, 20.0, 40.0, 270.0, 10.0, 40.0, 5.0, 40.0, 20.0, 50.0, 200.0, 170.0, -10.0, 20.0, 10.0, 50.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 60.0, 140.0, 470.0, 140.0, 350.0, 0.0, 0.0, 110.0, 25.0, 0.0, 220.0, 30.0, 70.0, 340.0, 80.0, -40.0, 10.0, 130.0, 170.0, 70.0, 50.0, 160.0, 30.0, 40.0, 0.0, 0.0, -20.0, 90.0, 50.0, 20.0, 140.0, 40.0, 160.0, 20.0, 90.0, 470.0, 190.0, 0.0, 150.0, 30.0, 35.0, 110.0, 80.0, 260.0, 180.0, 50.0, 10.0, 0.0, 30.0, 30.0, 410.0, 50.0, 130.0, 260.0, 50.0, 20.0, 300.0, 20.0, 30.0, 390.0, 40.0, 20.0, -20.0, 20.0, 30.0, -30.0, -5.0, 60.0, 50.0, 150.0, 220.0, 80.0, 0.0, 60.0, 15.0, 70.0, 0.0, 10.0, 60.0, 10.0, 200.0, -5.0, 50.0, 30.0, 5.0, 20.0, 90.0, -5.0, 0.0, 320.0, 380.0, 150.0, 60.0, 30.0, 160.0, 20.0, -20.0, 385.0, 50.0, 0.0, 40.0, 50.0, 50.0, 90.0, 40.0, 80.0, 110.0, 420.0, 0.0, 20.0, 100.0, 30.0, 10.0, 30.0, 130.0, 170.0, 0.0, 60.0, 20.0, 0.0, 50.0, 40.0, 40.0, 75.0, 30.0, 0.0, 250.0, 20.0, 30.0, 90.0, 70.0, 130.0, 80.0, 440.0, 90.0, 440.0, 80.0, 140.0, 170.0, 40.0, -5.0, 180.0, -20.0, 130.0, -55.0, 10.0, 160.0, 20.0, 10.0, 125.0, 110.0, 150.0, 5.0, 70.0, 360.0, 40.0, 80.0, 220.0, 60.0, 110.0, 10.0, 200.0, 40.0, 80.0, 45.0, 25.0, 20.0, 160.0, 210.0, 220.0, 60.0, 30.0, 230.0, 70.0, 140.0, 130.0, 40.0, 450.0, 20.0, 10.0, -10.0, 10.0, 90.0, 60.0, 220.0, 30.0, 10.0, 180.0, 0.0, 130.0, 40.0, 150.0, 0.0, 20.0, 0.0, 40.0, 20.0, 40.0, 70.0, 0.0, 40.0, 40.0, 50.0, 180.0, 40.0, 50.0, 60.0, 10.0, 30.0, 0.0, 130.0, 10.0, 30.0, 170.0, 20.0, 290.0, 140.0, 30.0, 40.0, 0.0, 80.0, -10.0, 30.0, 190.0, 20.0, 0.0, -10.0, 20.0, 0.0, 130.0, 40.0, 30.0, 80.0, 130.0, 0.0, 60.0, 50.0, 0.0, 90.0, 90.0, 300.0, 0.0, 20.0, 50.0, 160.0, 40.0, 180.0, 170.0, 160.0, 50.0, 190.0, 20.0, 70.0, 45.0, 70.0, 100.0, 110.0, 340.0, 60.0, 50.0, 70.0, 20.0, 50.0, 40.0, 0.0, 300.0, 160.0, 190.0, 180.0, -35.0, 20.0, 10.0, 10.0, 10.0, 160.0, 10.0, 110.0, 40.0, -40.0, 70.0, 190.0, -5.0, 30.0, 40.0, 15.0, 40.0, 5.0, 30.0, 260.0, 20.0, 40.0, 10.0, 50.0, 20.0, 140.0, 10.0, 40.0, 0.0, 10.0, -35.0, 560.0, 260.0, 100.0, 90.0, 200.0, 190.0, -25.0, 50.0, 90.0, 20.0, 25.0, -15.0, -10.0, 100.0, 20.0, 0.0, -15.0, 290.0, 45.0, 10.0, 20.0, 470.0, 90.0, 80.0, 30.0, 80.0, 30.0, 130.0, 180.0, 170.0, 120.0, -30.0, 80.0, -110.0, 90.0, 450.0, 70.0, -100.0, 70.0, 20.0, 80.0, 0.0, 150.0, 120.0, 20.0, 40.0, 70.0, 40.0, 20.0, 50.0, 220.0, -20.0, 110.0, 270.0, 170.0, 200.0, 190.0, 80.0, 320.0, 160.0, 10.0, -10.0, 40.0, 0.0, 40.0, 70.0, 160.0, 500.0, -100.0, 10.0, 0.0, 150.0, 80.0, 30.0, 70.0, 250.0, 120.0, -10.0, 20.0, 30.0, 80.0, 60.0, 40.0, 270.0, 90.0, 30.0, 130.0, 0.0, 60.0, 10.0, 40.0, 60.0, 20.0, 0.0, 20.0, 20.0, 70.0, 30.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 0.0, 140.0, 30.0, 40.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 80.0, 390.0, 10.0, 40.0, 40.0, 130.0, 20.0, 50.0, 310.0, 40.0, 30.0, 90.0, 60.0, 100.0, 40.0, 60.0, 60.0, 0.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 10.0, 10.0, 120.0, 40.0, 0.0, 70.0, 190.0, 30.0, 290.0, 30.0, 20.0, 100.0, 40.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 90.0, 70.0, 340.0, 30.0, 30.0, 300.0, 80.0, 40.0, 20.0, 40.0, 20.0, 160.0, 90.0, 30.0, 30.0, 70.0, 20.0, -35.0, 60.0, 190.0, 70.0, 15.0, 290.0, 0.0, 170.0, 160.0, 50.0, 50.0, 370.0, -40.0, -50.0, 280.0, 80.0, 250.0, 100.0, 0.0, 90.0, 180.0, 120.0, 40.0, 25.0, 10.0, 90.0, 145.0, 40.0, 10.0, 70.0, 240.0, 20.0, 10.0, 40.0, 10.0, 10.0, 90.0, 130.0, 120.0, 120.0, 90.0, 20.0, 320.0, 100.0, 180.0, 330.0, 15.0, 30.0, 120.0, 40.0, 120.0, 80.0, 70.0, 230.0, 90.0, 160.0, 40.0, 10.0, 160.0, 0.0, 50.0, 180.0, 60.0, 90.0, 60.0, 30.0, 10.0, 70.0, 30.0, 30.0, 0.0, 80.0, 0.0, 90.0, 40.0, 40.0, 140.0, 40.0, 30.0, 160.0, 60.0, 370.0, 60.0, 40.0, 70.0, 170.0, 330.0, 40.0, 90.0, 400.0, -10.0, 90.0, 150.0, 190.0, 90.0, 10.0, 30.0, 160.0, 50.0, 290.0, 100.0, 30.0, 160.0, 20.0, 50.0, 20.0, 110.0, 10.0, 190.0, 70.0, 60.0, 40.0, 60.0, 70.0, 30.0, 140.0, 30.0, 150.0, 40.0, 200.0, 220.0, 130.0, 170.0, 10.0, 115.0, 0.0, 140.0, 60.0, 500.0, 320.0, -80.0, -470.0, 0.0, -70.0, 110.0, 170.0, 130.0, 610.0, 120.0, 30.0, 20.0, 110.0, 70.0, 150.0, 30.0, 0.0, 0.0, 30.0, 20.0, 50.0, 30.0, 70.0, 60.0, 330.0, 10.0, 190.0, 40.0, 380.0, 50.0, 130.0, 20.0, 80.0, 10.0, 400.0, -20.0, 0.0, 80.0, 170.0, -40.0, 30.0, 360.0, 0.0, 140.0, 190.0, 20.0, 30.0, 20.0, 320.0, 100.0, 30.0, 50.0, 110.0, 50.0, 10.0, 320.0, 30.0, 90.0, 180.0, 30.0, 130.0, 160.0, 0.0, 200.0, 200.0, 160.0, -30.0, 70.0, 90.0, -30.0, 180.0, 30.0, 30.0, 170.0, 60.0, 60.0, 80.0, 370.0, 0.0, 80.0, 0.0, 40.0, 20.0, 250.0, 15.0, 10.0, 5.0, 10.0, 0.0, 50.0, 90.0, 120.0, 60.0, 20.0, 20.0, 30.0, -5.0, 0.0, 90.0, 35.0, 5.0, 50.0, 310.0, 90.0, 160.0, 40.0, 10.0, 30.0, 130.0, 50.0, 30.0, 130.0, 160.0, 150.0, 300.0, 60.0, 110.0, 80.0, 240.0, 180.0, 90.0, 130.0, 60.0, 90.0, 320.0, 370.0, 170.0, -170.0, 90.0, 40.0, 420.0, 40.0, 35.0, 170.0, 70.0, 120.0, 90.0, 40.0, 90.0, 30.0, 160.0, 110.0, 310.0, 300.0, 440.0, 80.0, 150.0, 50.0, 0.0, 20.0, 30.0, 310.0, 80.0, 70.0, 10.0, 30.0, 20.0, 15.0, 20.0, 30.0, 20.0, 25.0, 350.0, 40.0, 60.0, 50.0, 10.0, 280.0, 120.0, 70.0, 40.0, 400.0, 210.0, 180.0, 70.0, 70.0, 100.0, 120.0, 30.0, 140.0, 30.0, 35.0, 25.0, 70.0, 20.0, 0.0, 40.0, 20.0, 20.0, 10.0, 40.0, 10.0, 310.0, 40.0, -25.0, 120.0, 200.0, 10.0, 40.0, -100.0, 0.0, 20.0, 80.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 140.0, 30.0, 50.0, 70.0, 380.0, 50.0, 100.0, 0.0, 120.0, 180.0, 80.0, 70.0, 410.0, 420.0, 50.0, 250.0, 10.0, 10.0, 340.0, 40.0, 110.0, 40.0, 100.0, -10.0, 180.0, 80.0, 200.0, 750.0, 220.0, 30.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 20.0, 50.0, 30.0, 20.0, 100.0, -185.0, 10.0, 100.0, 20.0, 20.0, 0.0, 40.0, 40.0, 40.0, 170.0, 210.0, 20.0, 40.0, 10.0, 30.0, 240.0, 90.0, 20.0, 180.0, 20.0, 0.0, 70.0, 140.0, 20.0, 30.0, 110.0, 170.0, 40.0, 170.0, 15.0, 70.0, 80.0, 30.0, 170.0, 70.0, 210.0, 20.0, 20.0, -20.0, 230.0, 70.0, 150.0, 130.0, 270.0, 540.0, 110.0, 340.0, -70.0, 340.0, 140.0, 200.0, 140.0, 40.0, 40.0, 90.0, 110.0, 100.0, 220.0, 120.0, 100.0, -30.0, 240.0, 60.0, 70.0, 80.0, 100.0, 250.0, 130.0, 570.0, -45.0, 20.0, -30.0, 60.0, 30.0, 60.0, 60.0, 0.0, 30.0, 250.0, 310.0, 110.0, 30.0, 70.0, 90.0, 20.0, 200.0, 90.0, 190.0, 120.0, 460.0, -30.0, 170.0, 290.0, 320.0, 50.0, 50.0, 100.0, 30.0, 0.0, 0.0, 60.0, 80.0, 0.0, 40.0, 10.0, 200.0, 150.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.511669304845164, "mean_inference_ms": 1.4154625421281042, "mean_action_processing_ms": 0.4289327447047043, "mean_env_wait_ms": 1.2534788725393096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013039112091064453, "StateBufferConnector_ms": 0.009647846221923828, "ViewRequirementAgentConnector_ms": 0.3575623035430908}, "num_episodes": 18, "episode_return_max": 1820.0, "episode_return_min": 120.0, "episode_return_mean": 885.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.598947502001426, "num_env_steps_trained_throughput_per_sec": 21.598947502001426, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 3920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3920000, "timers": {"training_iteration_time_ms": 186792.863, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186792.818, "sample_time_ms": 2460.367, "learn_time_ms": 184312.758, "learn_throughput": 21.702, "synch_weights_time_ms": 12.478}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "done": false, "training_iteration": 98, "trial_id": "90816_00000", "date": "2024-06-10_05-19-09", "timestamp": 1718011149, "time_this_iter_s": 185.20309495925903, "time_total_s": 18427.165362358093, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b012fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18427.165362358093, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 17.385496183206108, "ram_util_percent": 78.19809160305344}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.237820661683687, "cur_kl_coeff": 0.9122789382934572, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007933629123534694, "vf_loss": 6.985201694256962, "vf_explained_var": -0.00016744369135116236, "kl": Infinity, "entropy": 0.3759465694744874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 924915.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "env_runners": {"episode_reward_max": 1820.0, "episode_reward_min": 120.0, "episode_reward_mean": 896.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 89.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [510.0, 500.0, 860.0, 320.0, 610.0, 1170.0, 1055.0, 1060.0, 295.0, 675.0, 340.0, 1480.0, 460.0, 1120.0, 810.0, 560.0, 1590.0, 870.0, 720.0, 790.0, 410.0, 310.0, 230.0, 790.0, 790.0, 270.0, 810.0, 660.0, 810.0, 710.0, 1320.0, 800.0, 540.0, 1425.0, 980.0, 650.0, 520.0, 1330.0, 1080.0, 990.0, 700.0, 1175.0, 670.0, 1140.0, 830.0, 1130.0, 920.0, 1110.0, 1100.0, 1040.0, 430.0, 385.0, 820.0, 1200.0, 1480.0, 1115.0, 1720.0, 585.0, 885.0, 1380.0, 410.0, 735.0, 120.0, 960.0, 1820.0, 1710.0, 310.0, 165.0, 870.0, 780.0, 855.0, 1750.0, 1420.0, 1120.0, 755.0, 1360.0, 1560.0, 630.0, 325.0, 990.0, 1120.0, 840.0, 580.0, 1355.0, 760.0, 270.0, 1730.0, 870.0, 590.0, 1610.0, 990.0, 1300.0, 1365.0, 595.0, 665.0, 1110.0, 1170.0, 1070.0, 1190.0, 800.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 40.0, 150.0, 0.0, 20.0, 0.0, 40.0, 20.0, 40.0, 70.0, 0.0, 40.0, 40.0, 50.0, 180.0, 40.0, 50.0, 60.0, 10.0, 30.0, 0.0, 130.0, 10.0, 30.0, 170.0, 20.0, 290.0, 140.0, 30.0, 40.0, 0.0, 80.0, -10.0, 30.0, 190.0, 20.0, 0.0, -10.0, 20.0, 0.0, 130.0, 40.0, 30.0, 80.0, 130.0, 0.0, 60.0, 50.0, 0.0, 90.0, 90.0, 300.0, 0.0, 20.0, 50.0, 160.0, 40.0, 180.0, 170.0, 160.0, 50.0, 190.0, 20.0, 70.0, 45.0, 70.0, 100.0, 110.0, 340.0, 60.0, 50.0, 70.0, 20.0, 50.0, 40.0, 0.0, 300.0, 160.0, 190.0, 180.0, -35.0, 20.0, 10.0, 10.0, 10.0, 160.0, 10.0, 110.0, 40.0, -40.0, 70.0, 190.0, -5.0, 30.0, 40.0, 15.0, 40.0, 5.0, 30.0, 260.0, 20.0, 40.0, 10.0, 50.0, 20.0, 140.0, 10.0, 40.0, 0.0, 10.0, -35.0, 560.0, 260.0, 100.0, 90.0, 200.0, 190.0, -25.0, 50.0, 90.0, 20.0, 25.0, -15.0, -10.0, 100.0, 20.0, 0.0, -15.0, 290.0, 45.0, 10.0, 20.0, 470.0, 90.0, 80.0, 30.0, 80.0, 30.0, 130.0, 180.0, 170.0, 120.0, -30.0, 80.0, -110.0, 90.0, 450.0, 70.0, -100.0, 70.0, 20.0, 80.0, 0.0, 150.0, 120.0, 20.0, 40.0, 70.0, 40.0, 20.0, 50.0, 220.0, -20.0, 110.0, 270.0, 170.0, 200.0, 190.0, 80.0, 320.0, 160.0, 10.0, -10.0, 40.0, 0.0, 40.0, 70.0, 160.0, 500.0, -100.0, 10.0, 0.0, 150.0, 80.0, 30.0, 70.0, 250.0, 120.0, -10.0, 20.0, 30.0, 80.0, 60.0, 40.0, 270.0, 90.0, 30.0, 130.0, 0.0, 60.0, 10.0, 40.0, 60.0, 20.0, 0.0, 20.0, 20.0, 70.0, 30.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 0.0, 140.0, 30.0, 40.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 80.0, 390.0, 10.0, 40.0, 40.0, 130.0, 20.0, 50.0, 310.0, 40.0, 30.0, 90.0, 60.0, 100.0, 40.0, 60.0, 60.0, 0.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 10.0, 10.0, 120.0, 40.0, 0.0, 70.0, 190.0, 30.0, 290.0, 30.0, 20.0, 100.0, 40.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 90.0, 70.0, 340.0, 30.0, 30.0, 300.0, 80.0, 40.0, 20.0, 40.0, 20.0, 160.0, 90.0, 30.0, 30.0, 70.0, 20.0, -35.0, 60.0, 190.0, 70.0, 15.0, 290.0, 0.0, 170.0, 160.0, 50.0, 50.0, 370.0, -40.0, -50.0, 280.0, 80.0, 250.0, 100.0, 0.0, 90.0, 180.0, 120.0, 40.0, 25.0, 10.0, 90.0, 145.0, 40.0, 10.0, 70.0, 240.0, 20.0, 10.0, 40.0, 10.0, 10.0, 90.0, 130.0, 120.0, 120.0, 90.0, 20.0, 320.0, 100.0, 180.0, 330.0, 15.0, 30.0, 120.0, 40.0, 120.0, 80.0, 70.0, 230.0, 90.0, 160.0, 40.0, 10.0, 160.0, 0.0, 50.0, 180.0, 60.0, 90.0, 60.0, 30.0, 10.0, 70.0, 30.0, 30.0, 0.0, 80.0, 0.0, 90.0, 40.0, 40.0, 140.0, 40.0, 30.0, 160.0, 60.0, 370.0, 60.0, 40.0, 70.0, 170.0, 330.0, 40.0, 90.0, 400.0, -10.0, 90.0, 150.0, 190.0, 90.0, 10.0, 30.0, 160.0, 50.0, 290.0, 100.0, 30.0, 160.0, 20.0, 50.0, 20.0, 110.0, 10.0, 190.0, 70.0, 60.0, 40.0, 60.0, 70.0, 30.0, 140.0, 30.0, 150.0, 40.0, 200.0, 220.0, 130.0, 170.0, 10.0, 115.0, 0.0, 140.0, 60.0, 500.0, 320.0, -80.0, -470.0, 0.0, -70.0, 110.0, 170.0, 130.0, 610.0, 120.0, 30.0, 20.0, 110.0, 70.0, 150.0, 30.0, 0.0, 0.0, 30.0, 20.0, 50.0, 30.0, 70.0, 60.0, 330.0, 10.0, 190.0, 40.0, 380.0, 50.0, 130.0, 20.0, 80.0, 10.0, 400.0, -20.0, 0.0, 80.0, 170.0, -40.0, 30.0, 360.0, 0.0, 140.0, 190.0, 20.0, 30.0, 20.0, 320.0, 100.0, 30.0, 50.0, 110.0, 50.0, 10.0, 320.0, 30.0, 90.0, 180.0, 30.0, 130.0, 160.0, 0.0, 200.0, 200.0, 160.0, -30.0, 70.0, 90.0, -30.0, 180.0, 30.0, 30.0, 170.0, 60.0, 60.0, 80.0, 370.0, 0.0, 80.0, 0.0, 40.0, 20.0, 250.0, 15.0, 10.0, 5.0, 10.0, 0.0, 50.0, 90.0, 120.0, 60.0, 20.0, 20.0, 30.0, -5.0, 0.0, 90.0, 35.0, 5.0, 50.0, 310.0, 90.0, 160.0, 40.0, 10.0, 30.0, 130.0, 50.0, 30.0, 130.0, 160.0, 150.0, 300.0, 60.0, 110.0, 80.0, 240.0, 180.0, 90.0, 130.0, 60.0, 90.0, 320.0, 370.0, 170.0, -170.0, 90.0, 40.0, 420.0, 40.0, 35.0, 170.0, 70.0, 120.0, 90.0, 40.0, 90.0, 30.0, 160.0, 110.0, 310.0, 300.0, 440.0, 80.0, 150.0, 50.0, 0.0, 20.0, 30.0, 310.0, 80.0, 70.0, 10.0, 30.0, 20.0, 15.0, 20.0, 30.0, 20.0, 25.0, 350.0, 40.0, 60.0, 50.0, 10.0, 280.0, 120.0, 70.0, 40.0, 400.0, 210.0, 180.0, 70.0, 70.0, 100.0, 120.0, 30.0, 140.0, 30.0, 35.0, 25.0, 70.0, 20.0, 0.0, 40.0, 20.0, 20.0, 10.0, 40.0, 10.0, 310.0, 40.0, -25.0, 120.0, 200.0, 10.0, 40.0, -100.0, 0.0, 20.0, 80.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 140.0, 30.0, 50.0, 70.0, 380.0, 50.0, 100.0, 0.0, 120.0, 180.0, 80.0, 70.0, 410.0, 420.0, 50.0, 250.0, 10.0, 10.0, 340.0, 40.0, 110.0, 40.0, 100.0, -10.0, 180.0, 80.0, 200.0, 750.0, 220.0, 30.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 20.0, 50.0, 30.0, 20.0, 100.0, -185.0, 10.0, 100.0, 20.0, 20.0, 0.0, 40.0, 40.0, 40.0, 170.0, 210.0, 20.0, 40.0, 10.0, 30.0, 240.0, 90.0, 20.0, 180.0, 20.0, 0.0, 70.0, 140.0, 20.0, 30.0, 110.0, 170.0, 40.0, 170.0, 15.0, 70.0, 80.0, 30.0, 170.0, 70.0, 210.0, 20.0, 20.0, -20.0, 230.0, 70.0, 150.0, 130.0, 270.0, 540.0, 110.0, 340.0, -70.0, 340.0, 140.0, 200.0, 140.0, 40.0, 40.0, 90.0, 110.0, 100.0, 220.0, 120.0, 100.0, -30.0, 240.0, 60.0, 70.0, 80.0, 100.0, 250.0, 130.0, 570.0, -45.0, 20.0, -30.0, 60.0, 30.0, 60.0, 60.0, 0.0, 30.0, 250.0, 310.0, 110.0, 30.0, 70.0, 90.0, 20.0, 200.0, 90.0, 190.0, 120.0, 460.0, -30.0, 170.0, 290.0, 320.0, 50.0, 50.0, 100.0, 30.0, 0.0, 0.0, 60.0, 80.0, 0.0, 40.0, 10.0, 200.0, 150.0, 90.0, 20.0, 120.0, 90.0, 40.0, 10.0, 10.0, 10.0, 0.0, 0.0, 25.0, 170.0, 60.0, 100.0, 60.0, 150.0, 150.0, 140.0, 40.0, 40.0, 80.0, 0.0, 10.0, 380.0, 60.0, 50.0, 470.0, 90.0, 50.0, 0.0, 10.0, 80.0, 30.0, 50.0, 30.0, 130.0, 390.0, 30.0, 40.0, 40.0, 20.0, 20.0, 60.0, 40.0, 90.0, 30.0, 40.0, 220.0, 30.0, 10.0, 40.0, -30.0, 190.0, 390.0, 80.0, -25.0, 620.0, 30.0, 40.0, 30.0, 30.0, 40.0, -20.0, -50.0, 40.0, 10.0, 530.0, 40.0, 90.0, 40.0, 40.0, 20.0, 0.0, 30.0, 130.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 170.0, 580.0, 120.0, 360.0, 60.0, 60.0, -30.0, 50.0, 280.0, 80.0, 30.0, 110.0, 30.0, 90.0, 30.0, 190.0, 30.0, 80.0, 160.0, 120.0, 90.0, 40.0, 70.0, 150.0, 40.0, 100.0, 70.0, 10.0, 20.0, 0.0, -10.0, 560.0, 180.0, 90.0, 330.0, 70.0, 70.0, 50.0, 320.0, -50.0, 20.0, -40.0, -90.0, 40.0, 190.0, 70.0, 60.0, 670.0, -80.0, 150.0, 0.0, 210.0, 50.0, 10.0, 270.0, 310.0, 130.0, 210.0, 30.0, 80.0, 260.0, 90.0, 200.0, 40.0, 25.0, 120.0, 260.0, 30.0, 300.0, 40.0, 15.0, 130.0, 20.0, 370.0, -10.0, -40.0, 40.0, 40.0, 0.0, 30.0, 40.0, 90.0, -10.0, 0.0, 110.0, 50.0, 5.0, 60.0, 210.0, 110.0, 100.0, 240.0, 290.0, 170.0, 40.0, 90.0, 20.0, 30.0, 120.0, 10.0, 170.0, 100.0, 210.0, -120.0, 280.0, 180.0, 90.0, 10.0, 20.0, 230.0, 30.0, 0.0, 80.0, 50.0, 610.0, 150.0, 80.0, 30.0, -50.0, 90.0, 50.0, 190.0, 410.0, 40.0, 130.0, 30.0, 20.0, 120.0, 110.0, 90.0, 60.0, 30.0, 40.0, -30.0, 70.0, 10.0, 30.0, 520.0, 40.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5112879466855604, "mean_inference_ms": 1.4153971886305845, "mean_action_processing_ms": 0.4283926928719984, "mean_env_wait_ms": 1.2530766958502553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013756036758422852, "StateBufferConnector_ms": 0.010030984878540039, "ViewRequirementAgentConnector_ms": 0.3617069721221924}, "num_episodes": 22, "episode_return_max": 1820.0, "episode_return_min": 120.0, "episode_return_mean": 896.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.251220219424123, "num_env_steps_trained_throughput_per_sec": 21.251220219424123, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 3960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3960000, "timers": {"training_iteration_time_ms": 187136.257, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187136.213, "sample_time_ms": 2473.448, "learn_time_ms": 184642.916, "learn_throughput": 21.663, "synch_weights_time_ms": 12.8}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "done": false, "training_iteration": 99, "trial_id": "90816_00000", "date": "2024-06-10_05-22-18", "timestamp": 1718011338, "time_this_iter_s": 188.2325780391693, "time_total_s": 18615.397940397263, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0045430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18615.397940397263, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 20.543984962406018, "ram_util_percent": 78.9718045112782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5264007132972517, "cur_kl_coeff": 1.3684184074401853, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0078000464912055655, "vf_loss": 6.863567111388055, "vf_explained_var": 0.0004009044144988949, "kl": Infinity, "entropy": 0.37697730512220384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 934305.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "env_runners": {"episode_reward_max": 1925.0, "episode_reward_min": 120.0, "episode_reward_mean": 923.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 92.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [720.0, 790.0, 410.0, 310.0, 230.0, 790.0, 790.0, 270.0, 810.0, 660.0, 810.0, 710.0, 1320.0, 800.0, 540.0, 1425.0, 980.0, 650.0, 520.0, 1330.0, 1080.0, 990.0, 700.0, 1175.0, 670.0, 1140.0, 830.0, 1130.0, 920.0, 1110.0, 1100.0, 1040.0, 430.0, 385.0, 820.0, 1200.0, 1480.0, 1115.0, 1720.0, 585.0, 885.0, 1380.0, 410.0, 735.0, 120.0, 960.0, 1820.0, 1710.0, 310.0, 165.0, 870.0, 780.0, 855.0, 1750.0, 1420.0, 1120.0, 755.0, 1360.0, 1560.0, 630.0, 325.0, 990.0, 1120.0, 840.0, 580.0, 1355.0, 760.0, 270.0, 1730.0, 870.0, 590.0, 1610.0, 990.0, 1300.0, 1365.0, 595.0, 665.0, 1110.0, 1170.0, 1070.0, 1190.0, 800.0, 610.0, 1410.0, 1025.0, 1120.0, 210.0, 690.0, 210.0, 575.0, 1050.0, 1400.0, 1925.0, 990.0, 300.0, 1210.0, 1195.0, 990.0, 1420.0, 620.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 150.0, 80.0, 30.0, 70.0, 250.0, 120.0, -10.0, 20.0, 30.0, 80.0, 60.0, 40.0, 270.0, 90.0, 30.0, 130.0, 0.0, 60.0, 10.0, 40.0, 60.0, 20.0, 0.0, 20.0, 20.0, 70.0, 30.0, 140.0, 30.0, 0.0, 40.0, 0.0, 20.0, 0.0, 140.0, 30.0, 40.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 80.0, 390.0, 10.0, 40.0, 40.0, 130.0, 20.0, 50.0, 310.0, 40.0, 30.0, 90.0, 60.0, 100.0, 40.0, 60.0, 60.0, 0.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 10.0, 10.0, 120.0, 40.0, 0.0, 70.0, 190.0, 30.0, 290.0, 30.0, 20.0, 100.0, 40.0, 30.0, 30.0, 20.0, 20.0, 20.0, 10.0, 90.0, 70.0, 340.0, 30.0, 30.0, 300.0, 80.0, 40.0, 20.0, 40.0, 20.0, 160.0, 90.0, 30.0, 30.0, 70.0, 20.0, -35.0, 60.0, 190.0, 70.0, 15.0, 290.0, 0.0, 170.0, 160.0, 50.0, 50.0, 370.0, -40.0, -50.0, 280.0, 80.0, 250.0, 100.0, 0.0, 90.0, 180.0, 120.0, 40.0, 25.0, 10.0, 90.0, 145.0, 40.0, 10.0, 70.0, 240.0, 20.0, 10.0, 40.0, 10.0, 10.0, 90.0, 130.0, 120.0, 120.0, 90.0, 20.0, 320.0, 100.0, 180.0, 330.0, 15.0, 30.0, 120.0, 40.0, 120.0, 80.0, 70.0, 230.0, 90.0, 160.0, 40.0, 10.0, 160.0, 0.0, 50.0, 180.0, 60.0, 90.0, 60.0, 30.0, 10.0, 70.0, 30.0, 30.0, 0.0, 80.0, 0.0, 90.0, 40.0, 40.0, 140.0, 40.0, 30.0, 160.0, 60.0, 370.0, 60.0, 40.0, 70.0, 170.0, 330.0, 40.0, 90.0, 400.0, -10.0, 90.0, 150.0, 190.0, 90.0, 10.0, 30.0, 160.0, 50.0, 290.0, 100.0, 30.0, 160.0, 20.0, 50.0, 20.0, 110.0, 10.0, 190.0, 70.0, 60.0, 40.0, 60.0, 70.0, 30.0, 140.0, 30.0, 150.0, 40.0, 200.0, 220.0, 130.0, 170.0, 10.0, 115.0, 0.0, 140.0, 60.0, 500.0, 320.0, -80.0, -470.0, 0.0, -70.0, 110.0, 170.0, 130.0, 610.0, 120.0, 30.0, 20.0, 110.0, 70.0, 150.0, 30.0, 0.0, 0.0, 30.0, 20.0, 50.0, 30.0, 70.0, 60.0, 330.0, 10.0, 190.0, 40.0, 380.0, 50.0, 130.0, 20.0, 80.0, 10.0, 400.0, -20.0, 0.0, 80.0, 170.0, -40.0, 30.0, 360.0, 0.0, 140.0, 190.0, 20.0, 30.0, 20.0, 320.0, 100.0, 30.0, 50.0, 110.0, 50.0, 10.0, 320.0, 30.0, 90.0, 180.0, 30.0, 130.0, 160.0, 0.0, 200.0, 200.0, 160.0, -30.0, 70.0, 90.0, -30.0, 180.0, 30.0, 30.0, 170.0, 60.0, 60.0, 80.0, 370.0, 0.0, 80.0, 0.0, 40.0, 20.0, 250.0, 15.0, 10.0, 5.0, 10.0, 0.0, 50.0, 90.0, 120.0, 60.0, 20.0, 20.0, 30.0, -5.0, 0.0, 90.0, 35.0, 5.0, 50.0, 310.0, 90.0, 160.0, 40.0, 10.0, 30.0, 130.0, 50.0, 30.0, 130.0, 160.0, 150.0, 300.0, 60.0, 110.0, 80.0, 240.0, 180.0, 90.0, 130.0, 60.0, 90.0, 320.0, 370.0, 170.0, -170.0, 90.0, 40.0, 420.0, 40.0, 35.0, 170.0, 70.0, 120.0, 90.0, 40.0, 90.0, 30.0, 160.0, 110.0, 310.0, 300.0, 440.0, 80.0, 150.0, 50.0, 0.0, 20.0, 30.0, 310.0, 80.0, 70.0, 10.0, 30.0, 20.0, 15.0, 20.0, 30.0, 20.0, 25.0, 350.0, 40.0, 60.0, 50.0, 10.0, 280.0, 120.0, 70.0, 40.0, 400.0, 210.0, 180.0, 70.0, 70.0, 100.0, 120.0, 30.0, 140.0, 30.0, 35.0, 25.0, 70.0, 20.0, 0.0, 40.0, 20.0, 20.0, 10.0, 40.0, 10.0, 310.0, 40.0, -25.0, 120.0, 200.0, 10.0, 40.0, -100.0, 0.0, 20.0, 80.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 140.0, 30.0, 50.0, 70.0, 380.0, 50.0, 100.0, 0.0, 120.0, 180.0, 80.0, 70.0, 410.0, 420.0, 50.0, 250.0, 10.0, 10.0, 340.0, 40.0, 110.0, 40.0, 100.0, -10.0, 180.0, 80.0, 200.0, 750.0, 220.0, 30.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 20.0, 50.0, 30.0, 20.0, 100.0, -185.0, 10.0, 100.0, 20.0, 20.0, 0.0, 40.0, 40.0, 40.0, 170.0, 210.0, 20.0, 40.0, 10.0, 30.0, 240.0, 90.0, 20.0, 180.0, 20.0, 0.0, 70.0, 140.0, 20.0, 30.0, 110.0, 170.0, 40.0, 170.0, 15.0, 70.0, 80.0, 30.0, 170.0, 70.0, 210.0, 20.0, 20.0, -20.0, 230.0, 70.0, 150.0, 130.0, 270.0, 540.0, 110.0, 340.0, -70.0, 340.0, 140.0, 200.0, 140.0, 40.0, 40.0, 90.0, 110.0, 100.0, 220.0, 120.0, 100.0, -30.0, 240.0, 60.0, 70.0, 80.0, 100.0, 250.0, 130.0, 570.0, -45.0, 20.0, -30.0, 60.0, 30.0, 60.0, 60.0, 0.0, 30.0, 250.0, 310.0, 110.0, 30.0, 70.0, 90.0, 20.0, 200.0, 90.0, 190.0, 120.0, 460.0, -30.0, 170.0, 290.0, 320.0, 50.0, 50.0, 100.0, 30.0, 0.0, 0.0, 60.0, 80.0, 0.0, 40.0, 10.0, 200.0, 150.0, 90.0, 20.0, 120.0, 90.0, 40.0, 10.0, 10.0, 10.0, 0.0, 0.0, 25.0, 170.0, 60.0, 100.0, 60.0, 150.0, 150.0, 140.0, 40.0, 40.0, 80.0, 0.0, 10.0, 380.0, 60.0, 50.0, 470.0, 90.0, 50.0, 0.0, 10.0, 80.0, 30.0, 50.0, 30.0, 130.0, 390.0, 30.0, 40.0, 40.0, 20.0, 20.0, 60.0, 40.0, 90.0, 30.0, 40.0, 220.0, 30.0, 10.0, 40.0, -30.0, 190.0, 390.0, 80.0, -25.0, 620.0, 30.0, 40.0, 30.0, 30.0, 40.0, -20.0, -50.0, 40.0, 10.0, 530.0, 40.0, 90.0, 40.0, 40.0, 20.0, 0.0, 30.0, 130.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 170.0, 580.0, 120.0, 360.0, 60.0, 60.0, -30.0, 50.0, 280.0, 80.0, 30.0, 110.0, 30.0, 90.0, 30.0, 190.0, 30.0, 80.0, 160.0, 120.0, 90.0, 40.0, 70.0, 150.0, 40.0, 100.0, 70.0, 10.0, 20.0, 0.0, -10.0, 560.0, 180.0, 90.0, 330.0, 70.0, 70.0, 50.0, 320.0, -50.0, 20.0, -40.0, -90.0, 40.0, 190.0, 70.0, 60.0, 670.0, -80.0, 150.0, 0.0, 210.0, 50.0, 10.0, 270.0, 310.0, 130.0, 210.0, 30.0, 80.0, 260.0, 90.0, 200.0, 40.0, 25.0, 120.0, 260.0, 30.0, 300.0, 40.0, 15.0, 130.0, 20.0, 370.0, -10.0, -40.0, 40.0, 40.0, 0.0, 30.0, 40.0, 90.0, -10.0, 0.0, 110.0, 50.0, 5.0, 60.0, 210.0, 110.0, 100.0, 240.0, 290.0, 170.0, 40.0, 90.0, 20.0, 30.0, 120.0, 10.0, 170.0, 100.0, 210.0, -120.0, 280.0, 180.0, 90.0, 10.0, 20.0, 230.0, 30.0, 0.0, 80.0, 50.0, 610.0, 150.0, 80.0, 30.0, -50.0, 90.0, 50.0, 190.0, 410.0, 40.0, 130.0, 30.0, 20.0, 120.0, 110.0, 90.0, 60.0, 30.0, 40.0, -30.0, 70.0, 10.0, 30.0, 520.0, 40.0, 30.0, 30.0, 30.0, 20.0, 100.0, 50.0, 60.0, 40.0, 180.0, 40.0, 60.0, 220.0, 120.0, 20.0, 450.0, 320.0, 100.0, 30.0, 40.0, 90.0, 20.0, 140.0, 110.0, 20.0, 255.0, 0.0, 190.0, 50.0, 50.0, 120.0, 90.0, 160.0, 60.0, 330.0, 10.0, 110.0, 20.0, 310.0, 120.0, 10.0, -10.0, 20.0, 0.0, 30.0, 0.0, 40.0, 10.0, 20.0, 0.0, 90.0, 0.0, 170.0, 40.0, 240.0, -30.0, 0.0, -10.0, 60.0, 60.0, 30.0, 130.0, 40.0, 10.0, 50.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 180.0, 30.0, 0.0, 15.0, 110.0, 30.0, 70.0, 0.0, 100.0, 40.0, 240.0, 160.0, 30.0, 110.0, -30.0, -50.0, 10.0, 100.0, 50.0, 430.0, 200.0, 30.0, 50.0, 360.0, 150.0, 90.0, 130.0, -20.0, 230.0, 180.0, 200.0, 50.0, 145.0, 40.0, 80.0, 640.0, 160.0, 500.0, 60.0, 50.0, 90.0, 100.0, 40.0, 80.0, 40.0, 400.0, 130.0, 30.0, 310.0, -230.0, 40.0, 20.0, 10.0, 120.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 380.0, 100.0, 90.0, 120.0, 150.0, 60.0, 90.0, 90.0, 70.0, 60.0, 40.0, 50.0, 0.0, 30.0, 45.0, 170.0, 240.0, 60.0, 40.0, 520.0, 50.0, 90.0, 100.0, 150.0, 20.0, 50.0, 30.0, 190.0, 250.0, 60.0, 120.0, 290.0, 300.0, -10.0, -20.0, 70.0, -50.0, 540.0, 50.0, 130.0, 30.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 140.0, 90.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.511044958312405, "mean_inference_ms": 1.4153709575794124, "mean_action_processing_ms": 0.4279587848808014, "mean_env_wait_ms": 1.2527193008282185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01375269889831543, "StateBufferConnector_ms": 0.009971141815185547, "ViewRequirementAgentConnector_ms": 0.356792688369751}, "num_episodes": 18, "episode_return_max": 1925.0, "episode_return_min": 120.0, "episode_return_mean": 923.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.281216121274777, "num_env_steps_trained_throughput_per_sec": 21.281216121274777, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 4000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000000, "timers": {"training_iteration_time_ms": 187184.649, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187184.606, "sample_time_ms": 2454.942, "learn_time_ms": 184709.844, "learn_throughput": 21.656, "synch_weights_time_ms": 12.718}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "done": false, "training_iteration": 100, "trial_id": "90816_00000", "date": "2024-06-10_05-25-26", "timestamp": 1718011526, "time_this_iter_s": 187.9675350189209, "time_total_s": 18803.365475416183, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00821f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18803.365475416183, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 18.72218045112782, "ram_util_percent": 79.38609022556393}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.393861187900852, "cur_kl_coeff": 2.0526276111602786, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006537759412304202, "vf_loss": 6.474801306272594, "vf_explained_var": 0.0007832525764156582, "kl": Infinity, "entropy": 0.36451093408500296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 943695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "env_runners": {"episode_reward_max": 1925.0, "episode_reward_min": 120.0, "episode_reward_mean": 946.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 94.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1175.0, 670.0, 1140.0, 830.0, 1130.0, 920.0, 1110.0, 1100.0, 1040.0, 430.0, 385.0, 820.0, 1200.0, 1480.0, 1115.0, 1720.0, 585.0, 885.0, 1380.0, 410.0, 735.0, 120.0, 960.0, 1820.0, 1710.0, 310.0, 165.0, 870.0, 780.0, 855.0, 1750.0, 1420.0, 1120.0, 755.0, 1360.0, 1560.0, 630.0, 325.0, 990.0, 1120.0, 840.0, 580.0, 1355.0, 760.0, 270.0, 1730.0, 870.0, 590.0, 1610.0, 990.0, 1300.0, 1365.0, 595.0, 665.0, 1110.0, 1170.0, 1070.0, 1190.0, 800.0, 610.0, 1410.0, 1025.0, 1120.0, 210.0, 690.0, 210.0, 575.0, 1050.0, 1400.0, 1925.0, 990.0, 300.0, 1210.0, 1195.0, 990.0, 1420.0, 620.0, 515.0, 690.0, 640.0, 1670.0, 1050.0, 1090.0, 335.0, 590.0, 1060.0, 440.0, 1280.0, 1080.0, 1770.0, 350.0, 950.0, 1310.0, 1040.0, 680.0, 390.0, 455.0, 1290.0, 450.0, 810.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 40.0, 200.0, 220.0, 130.0, 170.0, 10.0, 115.0, 0.0, 140.0, 60.0, 500.0, 320.0, -80.0, -470.0, 0.0, -70.0, 110.0, 170.0, 130.0, 610.0, 120.0, 30.0, 20.0, 110.0, 70.0, 150.0, 30.0, 0.0, 0.0, 30.0, 20.0, 50.0, 30.0, 70.0, 60.0, 330.0, 10.0, 190.0, 40.0, 380.0, 50.0, 130.0, 20.0, 80.0, 10.0, 400.0, -20.0, 0.0, 80.0, 170.0, -40.0, 30.0, 360.0, 0.0, 140.0, 190.0, 20.0, 30.0, 20.0, 320.0, 100.0, 30.0, 50.0, 110.0, 50.0, 10.0, 320.0, 30.0, 90.0, 180.0, 30.0, 130.0, 160.0, 0.0, 200.0, 200.0, 160.0, -30.0, 70.0, 90.0, -30.0, 180.0, 30.0, 30.0, 170.0, 60.0, 60.0, 80.0, 370.0, 0.0, 80.0, 0.0, 40.0, 20.0, 250.0, 15.0, 10.0, 5.0, 10.0, 0.0, 50.0, 90.0, 120.0, 60.0, 20.0, 20.0, 30.0, -5.0, 0.0, 90.0, 35.0, 5.0, 50.0, 310.0, 90.0, 160.0, 40.0, 10.0, 30.0, 130.0, 50.0, 30.0, 130.0, 160.0, 150.0, 300.0, 60.0, 110.0, 80.0, 240.0, 180.0, 90.0, 130.0, 60.0, 90.0, 320.0, 370.0, 170.0, -170.0, 90.0, 40.0, 420.0, 40.0, 35.0, 170.0, 70.0, 120.0, 90.0, 40.0, 90.0, 30.0, 160.0, 110.0, 310.0, 300.0, 440.0, 80.0, 150.0, 50.0, 0.0, 20.0, 30.0, 310.0, 80.0, 70.0, 10.0, 30.0, 20.0, 15.0, 20.0, 30.0, 20.0, 25.0, 350.0, 40.0, 60.0, 50.0, 10.0, 280.0, 120.0, 70.0, 40.0, 400.0, 210.0, 180.0, 70.0, 70.0, 100.0, 120.0, 30.0, 140.0, 30.0, 35.0, 25.0, 70.0, 20.0, 0.0, 40.0, 20.0, 20.0, 10.0, 40.0, 10.0, 310.0, 40.0, -25.0, 120.0, 200.0, 10.0, 40.0, -100.0, 0.0, 20.0, 80.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 140.0, 30.0, 50.0, 70.0, 380.0, 50.0, 100.0, 0.0, 120.0, 180.0, 80.0, 70.0, 410.0, 420.0, 50.0, 250.0, 10.0, 10.0, 340.0, 40.0, 110.0, 40.0, 100.0, -10.0, 180.0, 80.0, 200.0, 750.0, 220.0, 30.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 20.0, 50.0, 30.0, 20.0, 100.0, -185.0, 10.0, 100.0, 20.0, 20.0, 0.0, 40.0, 40.0, 40.0, 170.0, 210.0, 20.0, 40.0, 10.0, 30.0, 240.0, 90.0, 20.0, 180.0, 20.0, 0.0, 70.0, 140.0, 20.0, 30.0, 110.0, 170.0, 40.0, 170.0, 15.0, 70.0, 80.0, 30.0, 170.0, 70.0, 210.0, 20.0, 20.0, -20.0, 230.0, 70.0, 150.0, 130.0, 270.0, 540.0, 110.0, 340.0, -70.0, 340.0, 140.0, 200.0, 140.0, 40.0, 40.0, 90.0, 110.0, 100.0, 220.0, 120.0, 100.0, -30.0, 240.0, 60.0, 70.0, 80.0, 100.0, 250.0, 130.0, 570.0, -45.0, 20.0, -30.0, 60.0, 30.0, 60.0, 60.0, 0.0, 30.0, 250.0, 310.0, 110.0, 30.0, 70.0, 90.0, 20.0, 200.0, 90.0, 190.0, 120.0, 460.0, -30.0, 170.0, 290.0, 320.0, 50.0, 50.0, 100.0, 30.0, 0.0, 0.0, 60.0, 80.0, 0.0, 40.0, 10.0, 200.0, 150.0, 90.0, 20.0, 120.0, 90.0, 40.0, 10.0, 10.0, 10.0, 0.0, 0.0, 25.0, 170.0, 60.0, 100.0, 60.0, 150.0, 150.0, 140.0, 40.0, 40.0, 80.0, 0.0, 10.0, 380.0, 60.0, 50.0, 470.0, 90.0, 50.0, 0.0, 10.0, 80.0, 30.0, 50.0, 30.0, 130.0, 390.0, 30.0, 40.0, 40.0, 20.0, 20.0, 60.0, 40.0, 90.0, 30.0, 40.0, 220.0, 30.0, 10.0, 40.0, -30.0, 190.0, 390.0, 80.0, -25.0, 620.0, 30.0, 40.0, 30.0, 30.0, 40.0, -20.0, -50.0, 40.0, 10.0, 530.0, 40.0, 90.0, 40.0, 40.0, 20.0, 0.0, 30.0, 130.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 170.0, 580.0, 120.0, 360.0, 60.0, 60.0, -30.0, 50.0, 280.0, 80.0, 30.0, 110.0, 30.0, 90.0, 30.0, 190.0, 30.0, 80.0, 160.0, 120.0, 90.0, 40.0, 70.0, 150.0, 40.0, 100.0, 70.0, 10.0, 20.0, 0.0, -10.0, 560.0, 180.0, 90.0, 330.0, 70.0, 70.0, 50.0, 320.0, -50.0, 20.0, -40.0, -90.0, 40.0, 190.0, 70.0, 60.0, 670.0, -80.0, 150.0, 0.0, 210.0, 50.0, 10.0, 270.0, 310.0, 130.0, 210.0, 30.0, 80.0, 260.0, 90.0, 200.0, 40.0, 25.0, 120.0, 260.0, 30.0, 300.0, 40.0, 15.0, 130.0, 20.0, 370.0, -10.0, -40.0, 40.0, 40.0, 0.0, 30.0, 40.0, 90.0, -10.0, 0.0, 110.0, 50.0, 5.0, 60.0, 210.0, 110.0, 100.0, 240.0, 290.0, 170.0, 40.0, 90.0, 20.0, 30.0, 120.0, 10.0, 170.0, 100.0, 210.0, -120.0, 280.0, 180.0, 90.0, 10.0, 20.0, 230.0, 30.0, 0.0, 80.0, 50.0, 610.0, 150.0, 80.0, 30.0, -50.0, 90.0, 50.0, 190.0, 410.0, 40.0, 130.0, 30.0, 20.0, 120.0, 110.0, 90.0, 60.0, 30.0, 40.0, -30.0, 70.0, 10.0, 30.0, 520.0, 40.0, 30.0, 30.0, 30.0, 20.0, 100.0, 50.0, 60.0, 40.0, 180.0, 40.0, 60.0, 220.0, 120.0, 20.0, 450.0, 320.0, 100.0, 30.0, 40.0, 90.0, 20.0, 140.0, 110.0, 20.0, 255.0, 0.0, 190.0, 50.0, 50.0, 120.0, 90.0, 160.0, 60.0, 330.0, 10.0, 110.0, 20.0, 310.0, 120.0, 10.0, -10.0, 20.0, 0.0, 30.0, 0.0, 40.0, 10.0, 20.0, 0.0, 90.0, 0.0, 170.0, 40.0, 240.0, -30.0, 0.0, -10.0, 60.0, 60.0, 30.0, 130.0, 40.0, 10.0, 50.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 180.0, 30.0, 0.0, 15.0, 110.0, 30.0, 70.0, 0.0, 100.0, 40.0, 240.0, 160.0, 30.0, 110.0, -30.0, -50.0, 10.0, 100.0, 50.0, 430.0, 200.0, 30.0, 50.0, 360.0, 150.0, 90.0, 130.0, -20.0, 230.0, 180.0, 200.0, 50.0, 145.0, 40.0, 80.0, 640.0, 160.0, 500.0, 60.0, 50.0, 90.0, 100.0, 40.0, 80.0, 40.0, 400.0, 130.0, 30.0, 310.0, -230.0, 40.0, 20.0, 10.0, 120.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 380.0, 100.0, 90.0, 120.0, 150.0, 60.0, 90.0, 90.0, 70.0, 60.0, 40.0, 50.0, 0.0, 30.0, 45.0, 170.0, 240.0, 60.0, 40.0, 520.0, 50.0, 90.0, 100.0, 150.0, 20.0, 50.0, 30.0, 190.0, 250.0, 60.0, 120.0, 290.0, 300.0, -10.0, -20.0, 70.0, -50.0, 540.0, 50.0, 130.0, 30.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 140.0, 90.0, 110.0, 170.0, 30.0, -20.0, 20.0, 315.0, 70.0, -170.0, 20.0, 20.0, 60.0, 120.0, 0.0, 150.0, 30.0, 130.0, 160.0, 60.0, 20.0, 20.0, 0.0, 20.0, 160.0, 10.0, 80.0, 10.0, 80.0, 30.0, 150.0, -30.0, 130.0, 110.0, 70.0, 100.0, 40.0, 220.0, 360.0, 270.0, 70.0, 330.0, 100.0, 20.0, 90.0, 0.0, 30.0, 530.0, 200.0, 80.0, 20.0, 0.0, 80.0, 210.0, -20.0, -50.0, 100.0, 480.0, 240.0, 10.0, 60.0, -40.0, 100.0, 20.0, 35.0, 40.0, 30.0, 190.0, 20.0, -60.0, 0.0, 0.0, 60.0, 20.0, 180.0, 140.0, 20.0, 30.0, 20.0, 40.0, 140.0, 30.0, -30.0, 30.0, 110.0, 160.0, 310.0, 90.0, 20.0, 160.0, 50.0, 70.0, 60.0, 50.0, 150.0, 20.0, 10.0, 20.0, 20.0, 80.0, 30.0, 40.0, 20.0, 80.0, 10.0, 150.0, 470.0, 0.0, 50.0, 380.0, 50.0, 60.0, 30.0, 10.0, 110.0, 0.0, 210.0, 100.0, 70.0, 30.0, 140.0, 100.0, 310.0, 50.0, 100.0, 170.0, 230.0, 240.0, 80.0, 170.0, 370.0, 50.0, 310.0, 30.0, 90.0, 30.0, 100.0, 30.0, 10.0, 10.0, 40.0, 0.0, 10.0, 30.0, 30.0, 240.0, 0.0, 150.0, 250.0, 130.0, 90.0, -20.0, 50.0, 30.0, 330.0, 20.0, 20.0, 150.0, 40.0, 50.0, 300.0, 290.0, 80.0, 140.0, 80.0, 30.0, 0.0, 10.0, 30.0, 10.0, 300.0, 330.0, 110.0, 0.0, 0.0, 50.0, 40.0, 220.0, 10.0, 100.0, 40.0, 70.0, 150.0, 80.0, -5.0, 30.0, 30.0, 90.0, -15.0, -20.0, 160.0, 20.0, 20.0, 0.0, 0.0, 30.0, 110.0, 10.0, 90.0, 30.0, 20.0, 160.0, 5.0, 110.0, 40.0, 70.0, 60.0, 270.0, 400.0, -20.0, 290.0, 40.0, 30.0, 0.0, 60.0, 10.0, 90.0, 40.0, 70.0, 40.0, 110.0, 30.0, 0.0, 90.0, 0.0, 10.0, 60.0, 170.0, 150.0, 70.0, 20.0, 30.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5102909106953482, "mean_inference_ms": 1.4154558078826458, "mean_action_processing_ms": 0.427455522430699, "mean_env_wait_ms": 1.2523441465363958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014046430587768555, "StateBufferConnector_ms": 0.00953984260559082, "ViewRequirementAgentConnector_ms": 0.38053154945373535}, "num_episodes": 23, "episode_return_max": 1925.0, "episode_return_min": 120.0, "episode_return_mean": 946.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.38304727597696, "num_env_steps_trained_throughput_per_sec": 21.38304727597696, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 4040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4040000, "timers": {"training_iteration_time_ms": 187077.904, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187077.861, "sample_time_ms": 2423.801, "learn_time_ms": 184634.061, "learn_throughput": 21.664, "synch_weights_time_ms": 12.973}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "done": false, "training_iteration": 101, "trial_id": "90816_00000", "date": "2024-06-10_05-28-33", "timestamp": 1718011713, "time_this_iter_s": 187.0721311569214, "time_total_s": 18990.437606573105, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b011adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18990.437606573105, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 18.30792452830189, "ram_util_percent": 78.68377358490568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3645309249813944, "cur_kl_coeff": 3.0789414167404177, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005237235600938098, "vf_loss": 6.919142942205151, "vf_explained_var": 0.0008357269631914945, "kl": Infinity, "entropy": 0.3432952116250484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 953085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "env_runners": {"episode_reward_max": 1925.0, "episode_reward_min": 120.0, "episode_reward_mean": 952.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 95.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1380.0, 410.0, 735.0, 120.0, 960.0, 1820.0, 1710.0, 310.0, 165.0, 870.0, 780.0, 855.0, 1750.0, 1420.0, 1120.0, 755.0, 1360.0, 1560.0, 630.0, 325.0, 990.0, 1120.0, 840.0, 580.0, 1355.0, 760.0, 270.0, 1730.0, 870.0, 590.0, 1610.0, 990.0, 1300.0, 1365.0, 595.0, 665.0, 1110.0, 1170.0, 1070.0, 1190.0, 800.0, 610.0, 1410.0, 1025.0, 1120.0, 210.0, 690.0, 210.0, 575.0, 1050.0, 1400.0, 1925.0, 990.0, 300.0, 1210.0, 1195.0, 990.0, 1420.0, 620.0, 515.0, 690.0, 640.0, 1670.0, 1050.0, 1090.0, 335.0, 590.0, 1060.0, 440.0, 1280.0, 1080.0, 1770.0, 350.0, 950.0, 1310.0, 1040.0, 680.0, 390.0, 455.0, 1290.0, 450.0, 810.0, 830.0, 850.0, 1240.0, 850.0, 1070.0, 800.0, 1240.0, 680.0, 450.0, 1010.0, 1505.0, 1135.0, 1160.0, 1290.0, 855.0, 980.0, 1300.0, 1120.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 70.0, 40.0, 400.0, 210.0, 180.0, 70.0, 70.0, 100.0, 120.0, 30.0, 140.0, 30.0, 35.0, 25.0, 70.0, 20.0, 0.0, 40.0, 20.0, 20.0, 10.0, 40.0, 10.0, 310.0, 40.0, -25.0, 120.0, 200.0, 10.0, 40.0, -100.0, 0.0, 20.0, 80.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, 140.0, 30.0, 50.0, 70.0, 380.0, 50.0, 100.0, 0.0, 120.0, 180.0, 80.0, 70.0, 410.0, 420.0, 50.0, 250.0, 10.0, 10.0, 340.0, 40.0, 110.0, 40.0, 100.0, -10.0, 180.0, 80.0, 200.0, 750.0, 220.0, 30.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 20.0, 50.0, 30.0, 20.0, 100.0, -185.0, 10.0, 100.0, 20.0, 20.0, 0.0, 40.0, 40.0, 40.0, 170.0, 210.0, 20.0, 40.0, 10.0, 30.0, 240.0, 90.0, 20.0, 180.0, 20.0, 0.0, 70.0, 140.0, 20.0, 30.0, 110.0, 170.0, 40.0, 170.0, 15.0, 70.0, 80.0, 30.0, 170.0, 70.0, 210.0, 20.0, 20.0, -20.0, 230.0, 70.0, 150.0, 130.0, 270.0, 540.0, 110.0, 340.0, -70.0, 340.0, 140.0, 200.0, 140.0, 40.0, 40.0, 90.0, 110.0, 100.0, 220.0, 120.0, 100.0, -30.0, 240.0, 60.0, 70.0, 80.0, 100.0, 250.0, 130.0, 570.0, -45.0, 20.0, -30.0, 60.0, 30.0, 60.0, 60.0, 0.0, 30.0, 250.0, 310.0, 110.0, 30.0, 70.0, 90.0, 20.0, 200.0, 90.0, 190.0, 120.0, 460.0, -30.0, 170.0, 290.0, 320.0, 50.0, 50.0, 100.0, 30.0, 0.0, 0.0, 60.0, 80.0, 0.0, 40.0, 10.0, 200.0, 150.0, 90.0, 20.0, 120.0, 90.0, 40.0, 10.0, 10.0, 10.0, 0.0, 0.0, 25.0, 170.0, 60.0, 100.0, 60.0, 150.0, 150.0, 140.0, 40.0, 40.0, 80.0, 0.0, 10.0, 380.0, 60.0, 50.0, 470.0, 90.0, 50.0, 0.0, 10.0, 80.0, 30.0, 50.0, 30.0, 130.0, 390.0, 30.0, 40.0, 40.0, 20.0, 20.0, 60.0, 40.0, 90.0, 30.0, 40.0, 220.0, 30.0, 10.0, 40.0, -30.0, 190.0, 390.0, 80.0, -25.0, 620.0, 30.0, 40.0, 30.0, 30.0, 40.0, -20.0, -50.0, 40.0, 10.0, 530.0, 40.0, 90.0, 40.0, 40.0, 20.0, 0.0, 30.0, 130.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 170.0, 580.0, 120.0, 360.0, 60.0, 60.0, -30.0, 50.0, 280.0, 80.0, 30.0, 110.0, 30.0, 90.0, 30.0, 190.0, 30.0, 80.0, 160.0, 120.0, 90.0, 40.0, 70.0, 150.0, 40.0, 100.0, 70.0, 10.0, 20.0, 0.0, -10.0, 560.0, 180.0, 90.0, 330.0, 70.0, 70.0, 50.0, 320.0, -50.0, 20.0, -40.0, -90.0, 40.0, 190.0, 70.0, 60.0, 670.0, -80.0, 150.0, 0.0, 210.0, 50.0, 10.0, 270.0, 310.0, 130.0, 210.0, 30.0, 80.0, 260.0, 90.0, 200.0, 40.0, 25.0, 120.0, 260.0, 30.0, 300.0, 40.0, 15.0, 130.0, 20.0, 370.0, -10.0, -40.0, 40.0, 40.0, 0.0, 30.0, 40.0, 90.0, -10.0, 0.0, 110.0, 50.0, 5.0, 60.0, 210.0, 110.0, 100.0, 240.0, 290.0, 170.0, 40.0, 90.0, 20.0, 30.0, 120.0, 10.0, 170.0, 100.0, 210.0, -120.0, 280.0, 180.0, 90.0, 10.0, 20.0, 230.0, 30.0, 0.0, 80.0, 50.0, 610.0, 150.0, 80.0, 30.0, -50.0, 90.0, 50.0, 190.0, 410.0, 40.0, 130.0, 30.0, 20.0, 120.0, 110.0, 90.0, 60.0, 30.0, 40.0, -30.0, 70.0, 10.0, 30.0, 520.0, 40.0, 30.0, 30.0, 30.0, 20.0, 100.0, 50.0, 60.0, 40.0, 180.0, 40.0, 60.0, 220.0, 120.0, 20.0, 450.0, 320.0, 100.0, 30.0, 40.0, 90.0, 20.0, 140.0, 110.0, 20.0, 255.0, 0.0, 190.0, 50.0, 50.0, 120.0, 90.0, 160.0, 60.0, 330.0, 10.0, 110.0, 20.0, 310.0, 120.0, 10.0, -10.0, 20.0, 0.0, 30.0, 0.0, 40.0, 10.0, 20.0, 0.0, 90.0, 0.0, 170.0, 40.0, 240.0, -30.0, 0.0, -10.0, 60.0, 60.0, 30.0, 130.0, 40.0, 10.0, 50.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 180.0, 30.0, 0.0, 15.0, 110.0, 30.0, 70.0, 0.0, 100.0, 40.0, 240.0, 160.0, 30.0, 110.0, -30.0, -50.0, 10.0, 100.0, 50.0, 430.0, 200.0, 30.0, 50.0, 360.0, 150.0, 90.0, 130.0, -20.0, 230.0, 180.0, 200.0, 50.0, 145.0, 40.0, 80.0, 640.0, 160.0, 500.0, 60.0, 50.0, 90.0, 100.0, 40.0, 80.0, 40.0, 400.0, 130.0, 30.0, 310.0, -230.0, 40.0, 20.0, 10.0, 120.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 380.0, 100.0, 90.0, 120.0, 150.0, 60.0, 90.0, 90.0, 70.0, 60.0, 40.0, 50.0, 0.0, 30.0, 45.0, 170.0, 240.0, 60.0, 40.0, 520.0, 50.0, 90.0, 100.0, 150.0, 20.0, 50.0, 30.0, 190.0, 250.0, 60.0, 120.0, 290.0, 300.0, -10.0, -20.0, 70.0, -50.0, 540.0, 50.0, 130.0, 30.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 140.0, 90.0, 110.0, 170.0, 30.0, -20.0, 20.0, 315.0, 70.0, -170.0, 20.0, 20.0, 60.0, 120.0, 0.0, 150.0, 30.0, 130.0, 160.0, 60.0, 20.0, 20.0, 0.0, 20.0, 160.0, 10.0, 80.0, 10.0, 80.0, 30.0, 150.0, -30.0, 130.0, 110.0, 70.0, 100.0, 40.0, 220.0, 360.0, 270.0, 70.0, 330.0, 100.0, 20.0, 90.0, 0.0, 30.0, 530.0, 200.0, 80.0, 20.0, 0.0, 80.0, 210.0, -20.0, -50.0, 100.0, 480.0, 240.0, 10.0, 60.0, -40.0, 100.0, 20.0, 35.0, 40.0, 30.0, 190.0, 20.0, -60.0, 0.0, 0.0, 60.0, 20.0, 180.0, 140.0, 20.0, 30.0, 20.0, 40.0, 140.0, 30.0, -30.0, 30.0, 110.0, 160.0, 310.0, 90.0, 20.0, 160.0, 50.0, 70.0, 60.0, 50.0, 150.0, 20.0, 10.0, 20.0, 20.0, 80.0, 30.0, 40.0, 20.0, 80.0, 10.0, 150.0, 470.0, 0.0, 50.0, 380.0, 50.0, 60.0, 30.0, 10.0, 110.0, 0.0, 210.0, 100.0, 70.0, 30.0, 140.0, 100.0, 310.0, 50.0, 100.0, 170.0, 230.0, 240.0, 80.0, 170.0, 370.0, 50.0, 310.0, 30.0, 90.0, 30.0, 100.0, 30.0, 10.0, 10.0, 40.0, 0.0, 10.0, 30.0, 30.0, 240.0, 0.0, 150.0, 250.0, 130.0, 90.0, -20.0, 50.0, 30.0, 330.0, 20.0, 20.0, 150.0, 40.0, 50.0, 300.0, 290.0, 80.0, 140.0, 80.0, 30.0, 0.0, 10.0, 30.0, 10.0, 300.0, 330.0, 110.0, 0.0, 0.0, 50.0, 40.0, 220.0, 10.0, 100.0, 40.0, 70.0, 150.0, 80.0, -5.0, 30.0, 30.0, 90.0, -15.0, -20.0, 160.0, 20.0, 20.0, 0.0, 0.0, 30.0, 110.0, 10.0, 90.0, 30.0, 20.0, 160.0, 5.0, 110.0, 40.0, 70.0, 60.0, 270.0, 400.0, -20.0, 290.0, 40.0, 30.0, 0.0, 60.0, 10.0, 90.0, 40.0, 70.0, 40.0, 110.0, 30.0, 0.0, 90.0, 0.0, 10.0, 60.0, 170.0, 150.0, 70.0, 20.0, 30.0, 210.0, 20.0, 40.0, 230.0, 290.0, 60.0, 30.0, 60.0, 30.0, 10.0, 60.0, 520.0, 10.0, 30.0, 0.0, 10.0, 50.0, 150.0, 40.0, 40.0, 0.0, 50.0, 210.0, 40.0, 40.0, 260.0, 320.0, 70.0, 50.0, 100.0, 100.0, 0.0, 70.0, 90.0, 230.0, 50.0, 50.0, 60.0, 220.0, 30.0, 50.0, 180.0, 300.0, 60.0, 50.0, 75.0, -5.0, 70.0, 270.0, 100.0, -30.0, 30.0, 160.0, 50.0, 30.0, 180.0, 80.0, 140.0, 30.0, 80.0, 20.0, 70.0, -30.0, 20.0, 30.0, 580.0, 80.0, 210.0, 50.0, 80.0, 150.0, 190.0, 30.0, -40.0, 0.0, 30.0, 50.0, 360.0, 0.0, 20.0, 40.0, 40.0, 20.0, 40.0, 0.0, 50.0, 40.0, 180.0, 30.0, 50.0, 0.0, 40.0, 70.0, 170.0, 220.0, 40.0, 20.0, 80.0, 300.0, 50.0, 20.0, 50.0, 70.0, 40.0, 45.0, 620.0, 170.0, 50.0, 190.0, 150.0, 120.0, 130.0, 45.0, 500.0, 40.0, 10.0, 80.0, 160.0, -20.0, 20.0, 170.0, 110.0, 260.0, 190.0, 310.0, 0.0, -10.0, 50.0, -10.0, 30.0, 230.0, 10.0, -70.0, 70.0, 60.0, 70.0, 50.0, 180.0, 430.0, 220.0, 270.0, 300.0, 40.0, 35.0, 80.0, -50.0, 150.0, 30.0, 100.0, 140.0, 30.0, 80.0, 0.0, 170.0, 20.0, 160.0, 30.0, 70.0, 20.0, 180.0, 250.0, 70.0, 160.0, 100.0, 80.0, 120.0, 30.0, 130.0, 370.0, 90.0, 150.0, 200.0, 100.0, 30.0, 120.0, 100.0, 80.0, 360.0, 40.0, 60.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5097455875410637, "mean_inference_ms": 1.4154720631145008, "mean_action_processing_ms": 0.4270677361287871, "mean_env_wait_ms": 1.25204291642701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013362407684326172, "StateBufferConnector_ms": 0.009485244750976562, "ViewRequirementAgentConnector_ms": 0.3822450637817383}, "num_episodes": 18, "episode_return_max": 1925.0, "episode_return_min": 120.0, "episode_return_mean": 952.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.503195954502296, "num_env_steps_trained_throughput_per_sec": 21.503195954502296, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 4080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4080000, "timers": {"training_iteration_time_ms": 186944.101, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186944.058, "sample_time_ms": 2445.32, "learn_time_ms": 184479.022, "learn_throughput": 21.683, "synch_weights_time_ms": 12.617}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "done": false, "training_iteration": 102, "trial_id": "90816_00000", "date": "2024-06-10_05-31-39", "timestamp": 1718011899, "time_this_iter_s": 186.02904105186462, "time_total_s": 19176.46664762497, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0082040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19176.46664762497, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 17.68745247148289, "ram_util_percent": 78.71634980988594}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.386234648578083, "cur_kl_coeff": 4.618412125110625, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0041446417976265994, "vf_loss": 6.1034491854861646, "vf_explained_var": 0.0007442780640432502, "kl": Infinity, "entropy": 0.37505776921209816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 962475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "env_runners": {"episode_reward_max": 1925.0, "episode_reward_min": 210.0, "episode_reward_mean": 925.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 92.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [840.0, 580.0, 1355.0, 760.0, 270.0, 1730.0, 870.0, 590.0, 1610.0, 990.0, 1300.0, 1365.0, 595.0, 665.0, 1110.0, 1170.0, 1070.0, 1190.0, 800.0, 610.0, 1410.0, 1025.0, 1120.0, 210.0, 690.0, 210.0, 575.0, 1050.0, 1400.0, 1925.0, 990.0, 300.0, 1210.0, 1195.0, 990.0, 1420.0, 620.0, 515.0, 690.0, 640.0, 1670.0, 1050.0, 1090.0, 335.0, 590.0, 1060.0, 440.0, 1280.0, 1080.0, 1770.0, 350.0, 950.0, 1310.0, 1040.0, 680.0, 390.0, 455.0, 1290.0, 450.0, 810.0, 830.0, 850.0, 1240.0, 850.0, 1070.0, 800.0, 1240.0, 680.0, 450.0, 1010.0, 1505.0, 1135.0, 1160.0, 1290.0, 855.0, 980.0, 1300.0, 1120.0, 835.0, 830.0, 390.0, 1020.0, 560.0, 710.0, 970.0, 800.0, 1125.0, 630.0, 790.0, 380.0, 930.0, 650.0, 370.0, 730.0, 1620.0, 1095.0, 430.0, 760.0, 1220.0, 1560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 30.0, 50.0, 30.0, 130.0, 390.0, 30.0, 40.0, 40.0, 20.0, 20.0, 60.0, 40.0, 90.0, 30.0, 40.0, 220.0, 30.0, 10.0, 40.0, -30.0, 190.0, 390.0, 80.0, -25.0, 620.0, 30.0, 40.0, 30.0, 30.0, 40.0, -20.0, -50.0, 40.0, 10.0, 530.0, 40.0, 90.0, 40.0, 40.0, 20.0, 0.0, 30.0, 130.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 170.0, 580.0, 120.0, 360.0, 60.0, 60.0, -30.0, 50.0, 280.0, 80.0, 30.0, 110.0, 30.0, 90.0, 30.0, 190.0, 30.0, 80.0, 160.0, 120.0, 90.0, 40.0, 70.0, 150.0, 40.0, 100.0, 70.0, 10.0, 20.0, 0.0, -10.0, 560.0, 180.0, 90.0, 330.0, 70.0, 70.0, 50.0, 320.0, -50.0, 20.0, -40.0, -90.0, 40.0, 190.0, 70.0, 60.0, 670.0, -80.0, 150.0, 0.0, 210.0, 50.0, 10.0, 270.0, 310.0, 130.0, 210.0, 30.0, 80.0, 260.0, 90.0, 200.0, 40.0, 25.0, 120.0, 260.0, 30.0, 300.0, 40.0, 15.0, 130.0, 20.0, 370.0, -10.0, -40.0, 40.0, 40.0, 0.0, 30.0, 40.0, 90.0, -10.0, 0.0, 110.0, 50.0, 5.0, 60.0, 210.0, 110.0, 100.0, 240.0, 290.0, 170.0, 40.0, 90.0, 20.0, 30.0, 120.0, 10.0, 170.0, 100.0, 210.0, -120.0, 280.0, 180.0, 90.0, 10.0, 20.0, 230.0, 30.0, 0.0, 80.0, 50.0, 610.0, 150.0, 80.0, 30.0, -50.0, 90.0, 50.0, 190.0, 410.0, 40.0, 130.0, 30.0, 20.0, 120.0, 110.0, 90.0, 60.0, 30.0, 40.0, -30.0, 70.0, 10.0, 30.0, 520.0, 40.0, 30.0, 30.0, 30.0, 20.0, 100.0, 50.0, 60.0, 40.0, 180.0, 40.0, 60.0, 220.0, 120.0, 20.0, 450.0, 320.0, 100.0, 30.0, 40.0, 90.0, 20.0, 140.0, 110.0, 20.0, 255.0, 0.0, 190.0, 50.0, 50.0, 120.0, 90.0, 160.0, 60.0, 330.0, 10.0, 110.0, 20.0, 310.0, 120.0, 10.0, -10.0, 20.0, 0.0, 30.0, 0.0, 40.0, 10.0, 20.0, 0.0, 90.0, 0.0, 170.0, 40.0, 240.0, -30.0, 0.0, -10.0, 60.0, 60.0, 30.0, 130.0, 40.0, 10.0, 50.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 180.0, 30.0, 0.0, 15.0, 110.0, 30.0, 70.0, 0.0, 100.0, 40.0, 240.0, 160.0, 30.0, 110.0, -30.0, -50.0, 10.0, 100.0, 50.0, 430.0, 200.0, 30.0, 50.0, 360.0, 150.0, 90.0, 130.0, -20.0, 230.0, 180.0, 200.0, 50.0, 145.0, 40.0, 80.0, 640.0, 160.0, 500.0, 60.0, 50.0, 90.0, 100.0, 40.0, 80.0, 40.0, 400.0, 130.0, 30.0, 310.0, -230.0, 40.0, 20.0, 10.0, 120.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 380.0, 100.0, 90.0, 120.0, 150.0, 60.0, 90.0, 90.0, 70.0, 60.0, 40.0, 50.0, 0.0, 30.0, 45.0, 170.0, 240.0, 60.0, 40.0, 520.0, 50.0, 90.0, 100.0, 150.0, 20.0, 50.0, 30.0, 190.0, 250.0, 60.0, 120.0, 290.0, 300.0, -10.0, -20.0, 70.0, -50.0, 540.0, 50.0, 130.0, 30.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 140.0, 90.0, 110.0, 170.0, 30.0, -20.0, 20.0, 315.0, 70.0, -170.0, 20.0, 20.0, 60.0, 120.0, 0.0, 150.0, 30.0, 130.0, 160.0, 60.0, 20.0, 20.0, 0.0, 20.0, 160.0, 10.0, 80.0, 10.0, 80.0, 30.0, 150.0, -30.0, 130.0, 110.0, 70.0, 100.0, 40.0, 220.0, 360.0, 270.0, 70.0, 330.0, 100.0, 20.0, 90.0, 0.0, 30.0, 530.0, 200.0, 80.0, 20.0, 0.0, 80.0, 210.0, -20.0, -50.0, 100.0, 480.0, 240.0, 10.0, 60.0, -40.0, 100.0, 20.0, 35.0, 40.0, 30.0, 190.0, 20.0, -60.0, 0.0, 0.0, 60.0, 20.0, 180.0, 140.0, 20.0, 30.0, 20.0, 40.0, 140.0, 30.0, -30.0, 30.0, 110.0, 160.0, 310.0, 90.0, 20.0, 160.0, 50.0, 70.0, 60.0, 50.0, 150.0, 20.0, 10.0, 20.0, 20.0, 80.0, 30.0, 40.0, 20.0, 80.0, 10.0, 150.0, 470.0, 0.0, 50.0, 380.0, 50.0, 60.0, 30.0, 10.0, 110.0, 0.0, 210.0, 100.0, 70.0, 30.0, 140.0, 100.0, 310.0, 50.0, 100.0, 170.0, 230.0, 240.0, 80.0, 170.0, 370.0, 50.0, 310.0, 30.0, 90.0, 30.0, 100.0, 30.0, 10.0, 10.0, 40.0, 0.0, 10.0, 30.0, 30.0, 240.0, 0.0, 150.0, 250.0, 130.0, 90.0, -20.0, 50.0, 30.0, 330.0, 20.0, 20.0, 150.0, 40.0, 50.0, 300.0, 290.0, 80.0, 140.0, 80.0, 30.0, 0.0, 10.0, 30.0, 10.0, 300.0, 330.0, 110.0, 0.0, 0.0, 50.0, 40.0, 220.0, 10.0, 100.0, 40.0, 70.0, 150.0, 80.0, -5.0, 30.0, 30.0, 90.0, -15.0, -20.0, 160.0, 20.0, 20.0, 0.0, 0.0, 30.0, 110.0, 10.0, 90.0, 30.0, 20.0, 160.0, 5.0, 110.0, 40.0, 70.0, 60.0, 270.0, 400.0, -20.0, 290.0, 40.0, 30.0, 0.0, 60.0, 10.0, 90.0, 40.0, 70.0, 40.0, 110.0, 30.0, 0.0, 90.0, 0.0, 10.0, 60.0, 170.0, 150.0, 70.0, 20.0, 30.0, 210.0, 20.0, 40.0, 230.0, 290.0, 60.0, 30.0, 60.0, 30.0, 10.0, 60.0, 520.0, 10.0, 30.0, 0.0, 10.0, 50.0, 150.0, 40.0, 40.0, 0.0, 50.0, 210.0, 40.0, 40.0, 260.0, 320.0, 70.0, 50.0, 100.0, 100.0, 0.0, 70.0, 90.0, 230.0, 50.0, 50.0, 60.0, 220.0, 30.0, 50.0, 180.0, 300.0, 60.0, 50.0, 75.0, -5.0, 70.0, 270.0, 100.0, -30.0, 30.0, 160.0, 50.0, 30.0, 180.0, 80.0, 140.0, 30.0, 80.0, 20.0, 70.0, -30.0, 20.0, 30.0, 580.0, 80.0, 210.0, 50.0, 80.0, 150.0, 190.0, 30.0, -40.0, 0.0, 30.0, 50.0, 360.0, 0.0, 20.0, 40.0, 40.0, 20.0, 40.0, 0.0, 50.0, 40.0, 180.0, 30.0, 50.0, 0.0, 40.0, 70.0, 170.0, 220.0, 40.0, 20.0, 80.0, 300.0, 50.0, 20.0, 50.0, 70.0, 40.0, 45.0, 620.0, 170.0, 50.0, 190.0, 150.0, 120.0, 130.0, 45.0, 500.0, 40.0, 10.0, 80.0, 160.0, -20.0, 20.0, 170.0, 110.0, 260.0, 190.0, 310.0, 0.0, -10.0, 50.0, -10.0, 30.0, 230.0, 10.0, -70.0, 70.0, 60.0, 70.0, 50.0, 180.0, 430.0, 220.0, 270.0, 300.0, 40.0, 35.0, 80.0, -50.0, 150.0, 30.0, 100.0, 140.0, 30.0, 80.0, 0.0, 170.0, 20.0, 160.0, 30.0, 70.0, 20.0, 180.0, 250.0, 70.0, 160.0, 100.0, 80.0, 120.0, 30.0, 130.0, 370.0, 90.0, 150.0, 200.0, 100.0, 30.0, 120.0, 100.0, 80.0, 360.0, 40.0, 60.0, 30.0, 250.0, 20.0, 180.0, 20.0, 35.0, 40.0, 70.0, 20.0, 30.0, 170.0, 20.0, 130.0, 100.0, 30.0, 150.0, 10.0, 260.0, 40.0, 20.0, 70.0, 20.0, 10.0, 120.0, 0.0, 30.0, 10.0, 130.0, 0.0, 30.0, 40.0, 420.0, 20.0, 180.0, 90.0, 120.0, 0.0, 40.0, 120.0, 0.0, 30.0, 140.0, 0.0, -50.0, 90.0, 0.0, 80.0, 70.0, 120.0, 100.0, 10.0, 100.0, 140.0, 140.0, 110.0, 40.0, 10.0, 90.0, 20.0, 40.0, 20.0, 20.0, 80.0, 40.0, 100.0, 220.0, 0.0, 140.0, 0.0, 270.0, 100.0, 60.0, -100.0, 20.0, 80.0, 20.0, 110.0, 340.0, 0.0, 260.0, 10.0, 80.0, 40.0, 310.0, 130.0, 70.0, 160.0, 5.0, 170.0, 80.0, 80.0, 20.0, -10.0, 10.0, 400.0, 20.0, 60.0, 70.0, 30.0, 20.0, 10.0, 10.0, 120.0, 10.0, 20.0, 260.0, 80.0, 150.0, 80.0, 30.0, 30.0, 20.0, 100.0, 25.0, 70.0, 40.0, 25.0, 10.0, 30.0, 30.0, 30.0, 200.0, 50.0, 30.0, 40.0, 30.0, 100.0, 130.0, 130.0, 120.0, 100.0, -40.0, 150.0, 120.0, 40.0, 30.0, 100.0, -50.0, 210.0, 80.0, 10.0, 50.0, 10.0, 0.0, 20.0, 20.0, 100.0, 10.0, 40.0, 30.0, 90.0, 60.0, 20.0, 90.0, 280.0, 20.0, 30.0, 0.0, 110.0, 70.0, 50.0, 500.0, 60.0, 200.0, 10.0, 530.0, 60.0, 120.0, 90.0, 0.0, 50.0, 90.0, 170.0, 35.0, 0.0, 150.0, 70.0, 360.0, 30.0, 10.0, 180.0, 60.0, 30.0, 10.0, 60.0, 0.0, 110.0, 10.0, 100.0, 40.0, 10.0, 340.0, 110.0, 0.0, 40.0, 0.0, 70.0, 120.0, 80.0, 0.0, 0.0, 300.0, 200.0, 120.0, 150.0, 50.0, 170.0, 40.0, 40.0, 10.0, 140.0, 0.0, 60.0, 540.0, 370.0, 170.0, 110.0, 80.0, 80.0, 50.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.509395084408298, "mean_inference_ms": 1.4160404341309698, "mean_action_processing_ms": 0.4265522541176886, "mean_env_wait_ms": 1.2516517352106473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013208389282226562, "StateBufferConnector_ms": 0.009305953979492188, "ViewRequirementAgentConnector_ms": 0.3766047954559326}, "num_episodes": 22, "episode_return_max": 1925.0, "episode_return_min": 210.0, "episode_return_mean": 925.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.290158248595883, "num_env_steps_trained_throughput_per_sec": 21.290158248595883, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 4120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4120000, "timers": {"training_iteration_time_ms": 186909.765, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186909.721, "sample_time_ms": 2440.531, "learn_time_ms": 184449.713, "learn_throughput": 21.686, "synch_weights_time_ms": 12.003}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "done": false, "training_iteration": 103, "trial_id": "90816_00000", "date": "2024-06-10_05-34-47", "timestamp": 1718012087, "time_this_iter_s": 187.89017987251282, "time_total_s": 19364.356827497482, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b011adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19364.356827497482, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 18.389433962264146, "ram_util_percent": 81.01509433962264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.763786514193867, "cur_kl_coeff": 6.927618187665941, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.775079625102277, "policy_loss": -0.004382013567752221, "vf_loss": 6.776220664429588, "vf_explained_var": 0.0004498470388154506, "kl": 0.00046783402663685427, "entropy": 0.3565978118437675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 971865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "env_runners": {"episode_reward_max": 1925.0, "episode_reward_min": 145.0, "episode_reward_mean": 921.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 640.0}, "policy_reward_mean": {"policy_0": 92.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [800.0, 610.0, 1410.0, 1025.0, 1120.0, 210.0, 690.0, 210.0, 575.0, 1050.0, 1400.0, 1925.0, 990.0, 300.0, 1210.0, 1195.0, 990.0, 1420.0, 620.0, 515.0, 690.0, 640.0, 1670.0, 1050.0, 1090.0, 335.0, 590.0, 1060.0, 440.0, 1280.0, 1080.0, 1770.0, 350.0, 950.0, 1310.0, 1040.0, 680.0, 390.0, 455.0, 1290.0, 450.0, 810.0, 830.0, 850.0, 1240.0, 850.0, 1070.0, 800.0, 1240.0, 680.0, 450.0, 1010.0, 1505.0, 1135.0, 1160.0, 1290.0, 855.0, 980.0, 1300.0, 1120.0, 835.0, 830.0, 390.0, 1020.0, 560.0, 710.0, 970.0, 800.0, 1125.0, 630.0, 790.0, 380.0, 930.0, 650.0, 370.0, 730.0, 1620.0, 1095.0, 430.0, 760.0, 1220.0, 1560.0, 1330.0, 1140.0, 1100.0, 290.0, 990.0, 900.0, 940.0, 1185.0, 1050.0, 145.0, 1270.0, 1510.0, 240.0, 740.0, 920.0, 1475.0, 1570.0, 900.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 30.0, 40.0, -30.0, 70.0, 10.0, 30.0, 520.0, 40.0, 30.0, 30.0, 30.0, 20.0, 100.0, 50.0, 60.0, 40.0, 180.0, 40.0, 60.0, 220.0, 120.0, 20.0, 450.0, 320.0, 100.0, 30.0, 40.0, 90.0, 20.0, 140.0, 110.0, 20.0, 255.0, 0.0, 190.0, 50.0, 50.0, 120.0, 90.0, 160.0, 60.0, 330.0, 10.0, 110.0, 20.0, 310.0, 120.0, 10.0, -10.0, 20.0, 0.0, 30.0, 0.0, 40.0, 10.0, 20.0, 0.0, 90.0, 0.0, 170.0, 40.0, 240.0, -30.0, 0.0, -10.0, 60.0, 60.0, 30.0, 130.0, 40.0, 10.0, 50.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 0.0, 180.0, 30.0, 0.0, 15.0, 110.0, 30.0, 70.0, 0.0, 100.0, 40.0, 240.0, 160.0, 30.0, 110.0, -30.0, -50.0, 10.0, 100.0, 50.0, 430.0, 200.0, 30.0, 50.0, 360.0, 150.0, 90.0, 130.0, -20.0, 230.0, 180.0, 200.0, 50.0, 145.0, 40.0, 80.0, 640.0, 160.0, 500.0, 60.0, 50.0, 90.0, 100.0, 40.0, 80.0, 40.0, 400.0, 130.0, 30.0, 310.0, -230.0, 40.0, 20.0, 10.0, 120.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 380.0, 100.0, 90.0, 120.0, 150.0, 60.0, 90.0, 90.0, 70.0, 60.0, 40.0, 50.0, 0.0, 30.0, 45.0, 170.0, 240.0, 60.0, 40.0, 520.0, 50.0, 90.0, 100.0, 150.0, 20.0, 50.0, 30.0, 190.0, 250.0, 60.0, 120.0, 290.0, 300.0, -10.0, -20.0, 70.0, -50.0, 540.0, 50.0, 130.0, 30.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 140.0, 90.0, 110.0, 170.0, 30.0, -20.0, 20.0, 315.0, 70.0, -170.0, 20.0, 20.0, 60.0, 120.0, 0.0, 150.0, 30.0, 130.0, 160.0, 60.0, 20.0, 20.0, 0.0, 20.0, 160.0, 10.0, 80.0, 10.0, 80.0, 30.0, 150.0, -30.0, 130.0, 110.0, 70.0, 100.0, 40.0, 220.0, 360.0, 270.0, 70.0, 330.0, 100.0, 20.0, 90.0, 0.0, 30.0, 530.0, 200.0, 80.0, 20.0, 0.0, 80.0, 210.0, -20.0, -50.0, 100.0, 480.0, 240.0, 10.0, 60.0, -40.0, 100.0, 20.0, 35.0, 40.0, 30.0, 190.0, 20.0, -60.0, 0.0, 0.0, 60.0, 20.0, 180.0, 140.0, 20.0, 30.0, 20.0, 40.0, 140.0, 30.0, -30.0, 30.0, 110.0, 160.0, 310.0, 90.0, 20.0, 160.0, 50.0, 70.0, 60.0, 50.0, 150.0, 20.0, 10.0, 20.0, 20.0, 80.0, 30.0, 40.0, 20.0, 80.0, 10.0, 150.0, 470.0, 0.0, 50.0, 380.0, 50.0, 60.0, 30.0, 10.0, 110.0, 0.0, 210.0, 100.0, 70.0, 30.0, 140.0, 100.0, 310.0, 50.0, 100.0, 170.0, 230.0, 240.0, 80.0, 170.0, 370.0, 50.0, 310.0, 30.0, 90.0, 30.0, 100.0, 30.0, 10.0, 10.0, 40.0, 0.0, 10.0, 30.0, 30.0, 240.0, 0.0, 150.0, 250.0, 130.0, 90.0, -20.0, 50.0, 30.0, 330.0, 20.0, 20.0, 150.0, 40.0, 50.0, 300.0, 290.0, 80.0, 140.0, 80.0, 30.0, 0.0, 10.0, 30.0, 10.0, 300.0, 330.0, 110.0, 0.0, 0.0, 50.0, 40.0, 220.0, 10.0, 100.0, 40.0, 70.0, 150.0, 80.0, -5.0, 30.0, 30.0, 90.0, -15.0, -20.0, 160.0, 20.0, 20.0, 0.0, 0.0, 30.0, 110.0, 10.0, 90.0, 30.0, 20.0, 160.0, 5.0, 110.0, 40.0, 70.0, 60.0, 270.0, 400.0, -20.0, 290.0, 40.0, 30.0, 0.0, 60.0, 10.0, 90.0, 40.0, 70.0, 40.0, 110.0, 30.0, 0.0, 90.0, 0.0, 10.0, 60.0, 170.0, 150.0, 70.0, 20.0, 30.0, 210.0, 20.0, 40.0, 230.0, 290.0, 60.0, 30.0, 60.0, 30.0, 10.0, 60.0, 520.0, 10.0, 30.0, 0.0, 10.0, 50.0, 150.0, 40.0, 40.0, 0.0, 50.0, 210.0, 40.0, 40.0, 260.0, 320.0, 70.0, 50.0, 100.0, 100.0, 0.0, 70.0, 90.0, 230.0, 50.0, 50.0, 60.0, 220.0, 30.0, 50.0, 180.0, 300.0, 60.0, 50.0, 75.0, -5.0, 70.0, 270.0, 100.0, -30.0, 30.0, 160.0, 50.0, 30.0, 180.0, 80.0, 140.0, 30.0, 80.0, 20.0, 70.0, -30.0, 20.0, 30.0, 580.0, 80.0, 210.0, 50.0, 80.0, 150.0, 190.0, 30.0, -40.0, 0.0, 30.0, 50.0, 360.0, 0.0, 20.0, 40.0, 40.0, 20.0, 40.0, 0.0, 50.0, 40.0, 180.0, 30.0, 50.0, 0.0, 40.0, 70.0, 170.0, 220.0, 40.0, 20.0, 80.0, 300.0, 50.0, 20.0, 50.0, 70.0, 40.0, 45.0, 620.0, 170.0, 50.0, 190.0, 150.0, 120.0, 130.0, 45.0, 500.0, 40.0, 10.0, 80.0, 160.0, -20.0, 20.0, 170.0, 110.0, 260.0, 190.0, 310.0, 0.0, -10.0, 50.0, -10.0, 30.0, 230.0, 10.0, -70.0, 70.0, 60.0, 70.0, 50.0, 180.0, 430.0, 220.0, 270.0, 300.0, 40.0, 35.0, 80.0, -50.0, 150.0, 30.0, 100.0, 140.0, 30.0, 80.0, 0.0, 170.0, 20.0, 160.0, 30.0, 70.0, 20.0, 180.0, 250.0, 70.0, 160.0, 100.0, 80.0, 120.0, 30.0, 130.0, 370.0, 90.0, 150.0, 200.0, 100.0, 30.0, 120.0, 100.0, 80.0, 360.0, 40.0, 60.0, 30.0, 250.0, 20.0, 180.0, 20.0, 35.0, 40.0, 70.0, 20.0, 30.0, 170.0, 20.0, 130.0, 100.0, 30.0, 150.0, 10.0, 260.0, 40.0, 20.0, 70.0, 20.0, 10.0, 120.0, 0.0, 30.0, 10.0, 130.0, 0.0, 30.0, 40.0, 420.0, 20.0, 180.0, 90.0, 120.0, 0.0, 40.0, 120.0, 0.0, 30.0, 140.0, 0.0, -50.0, 90.0, 0.0, 80.0, 70.0, 120.0, 100.0, 10.0, 100.0, 140.0, 140.0, 110.0, 40.0, 10.0, 90.0, 20.0, 40.0, 20.0, 20.0, 80.0, 40.0, 100.0, 220.0, 0.0, 140.0, 0.0, 270.0, 100.0, 60.0, -100.0, 20.0, 80.0, 20.0, 110.0, 340.0, 0.0, 260.0, 10.0, 80.0, 40.0, 310.0, 130.0, 70.0, 160.0, 5.0, 170.0, 80.0, 80.0, 20.0, -10.0, 10.0, 400.0, 20.0, 60.0, 70.0, 30.0, 20.0, 10.0, 10.0, 120.0, 10.0, 20.0, 260.0, 80.0, 150.0, 80.0, 30.0, 30.0, 20.0, 100.0, 25.0, 70.0, 40.0, 25.0, 10.0, 30.0, 30.0, 30.0, 200.0, 50.0, 30.0, 40.0, 30.0, 100.0, 130.0, 130.0, 120.0, 100.0, -40.0, 150.0, 120.0, 40.0, 30.0, 100.0, -50.0, 210.0, 80.0, 10.0, 50.0, 10.0, 0.0, 20.0, 20.0, 100.0, 10.0, 40.0, 30.0, 90.0, 60.0, 20.0, 90.0, 280.0, 20.0, 30.0, 0.0, 110.0, 70.0, 50.0, 500.0, 60.0, 200.0, 10.0, 530.0, 60.0, 120.0, 90.0, 0.0, 50.0, 90.0, 170.0, 35.0, 0.0, 150.0, 70.0, 360.0, 30.0, 10.0, 180.0, 60.0, 30.0, 10.0, 60.0, 0.0, 110.0, 10.0, 100.0, 40.0, 10.0, 340.0, 110.0, 0.0, 40.0, 0.0, 70.0, 120.0, 80.0, 0.0, 0.0, 300.0, 200.0, 120.0, 150.0, 50.0, 170.0, 40.0, 40.0, 10.0, 140.0, 0.0, 60.0, 540.0, 370.0, 170.0, 110.0, 80.0, 80.0, 50.0, 100.0, 60.0, 180.0, 100.0, 100.0, 40.0, 110.0, 110.0, 400.0, 50.0, 180.0, -50.0, 110.0, 150.0, 0.0, 580.0, -30.0, 280.0, 90.0, -50.0, 60.0, 210.0, 130.0, 190.0, 150.0, 70.0, 70.0, 0.0, -30.0, 150.0, 160.0, 120.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 60.0, 70.0, 100.0, 120.0, 40.0, 300.0, 240.0, -10.0, 60.0, 10.0, -20.0, 0.0, 200.0, 60.0, 60.0, 60.0, 70.0, 160.0, 260.0, 50.0, 20.0, 80.0, 30.0, 10.0, 350.0, 20.0, 150.0, 10.0, 130.0, 140.0, 50.0, 160.0, 70.0, 130.0, 290.0, 230.0, 60.0, 80.0, 50.0, 65.0, 70.0, 100.0, 60.0, 90.0, 50.0, 50.0, 300.0, 40.0, 250.0, 40.0, 15.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 0.0, 0.0, 290.0, 390.0, -200.0, 10.0, 120.0, 280.0, 40.0, 80.0, 260.0, 140.0, 110.0, 80.0, 370.0, 10.0, 260.0, 260.0, 260.0, 130.0, -110.0, 40.0, 50.0, 40.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 90.0, 30.0, 200.0, 130.0, 50.0, -90.0, 20.0, 300.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 60.0, 30.0, 80.0, 100.0, 140.0, 200.0, 450.0, 220.0, 100.0, 0.0, 600.0, 20.0, -85.0, 60.0, 20.0, 90.0, 90.0, 200.0, -40.0, 240.0, 20.0, 220.0, 170.0, 20.0, 390.0, 260.0, 190.0, 170.0, 20.0, 80.0, 110.0, 70.0, 80.0, 90.0, 90.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5084296560081787, "mean_inference_ms": 1.414942986219328, "mean_action_processing_ms": 0.42623363667927194, "mean_env_wait_ms": 1.2513757246225596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012568473815917969, "StateBufferConnector_ms": 0.008994102478027344, "ViewRequirementAgentConnector_ms": 0.3732938766479492}, "num_episodes": 18, "episode_return_max": 1925.0, "episode_return_min": 145.0, "episode_return_mean": 921.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.407125707136924, "num_env_steps_trained_throughput_per_sec": 21.407125707136924, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 4160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4160000, "timers": {"training_iteration_time_ms": 186917.972, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186917.929, "sample_time_ms": 2437.58, "learn_time_ms": 184460.807, "learn_throughput": 21.685, "synch_weights_time_ms": 12.274}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "done": false, "training_iteration": 104, "trial_id": "90816_00000", "date": "2024-06-10_05-37-54", "timestamp": 1718012274, "time_this_iter_s": 186.8640480041504, "time_total_s": 19551.220875501633, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0082430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19551.220875501633, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 18.562641509433963, "ram_util_percent": 80.72377358490564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7510439439195666, "cur_kl_coeff": 3.4638090938329706, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005686160757730064, "vf_loss": 6.649336126284858, "vf_explained_var": 0.001303569856670083, "kl": Infinity, "entropy": 0.36099497270755493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 981255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "env_runners": {"episode_reward_max": 1770.0, "episode_reward_min": 145.0, "episode_reward_mean": 899.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 620.0}, "policy_reward_mean": {"policy_0": 89.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [620.0, 515.0, 690.0, 640.0, 1670.0, 1050.0, 1090.0, 335.0, 590.0, 1060.0, 440.0, 1280.0, 1080.0, 1770.0, 350.0, 950.0, 1310.0, 1040.0, 680.0, 390.0, 455.0, 1290.0, 450.0, 810.0, 830.0, 850.0, 1240.0, 850.0, 1070.0, 800.0, 1240.0, 680.0, 450.0, 1010.0, 1505.0, 1135.0, 1160.0, 1290.0, 855.0, 980.0, 1300.0, 1120.0, 835.0, 830.0, 390.0, 1020.0, 560.0, 710.0, 970.0, 800.0, 1125.0, 630.0, 790.0, 380.0, 930.0, 650.0, 370.0, 730.0, 1620.0, 1095.0, 430.0, 760.0, 1220.0, 1560.0, 1330.0, 1140.0, 1100.0, 290.0, 990.0, 900.0, 940.0, 1185.0, 1050.0, 145.0, 1270.0, 1510.0, 240.0, 740.0, 920.0, 1475.0, 1570.0, 900.0, 1575.0, 355.0, 420.0, 1545.0, 230.0, 860.0, 560.0, 1130.0, 860.0, 1450.0, 350.0, 680.0, 740.0, 610.0, 690.0, 1140.0, 1005.0, 690.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 140.0, 90.0, 110.0, 170.0, 30.0, -20.0, 20.0, 315.0, 70.0, -170.0, 20.0, 20.0, 60.0, 120.0, 0.0, 150.0, 30.0, 130.0, 160.0, 60.0, 20.0, 20.0, 0.0, 20.0, 160.0, 10.0, 80.0, 10.0, 80.0, 30.0, 150.0, -30.0, 130.0, 110.0, 70.0, 100.0, 40.0, 220.0, 360.0, 270.0, 70.0, 330.0, 100.0, 20.0, 90.0, 0.0, 30.0, 530.0, 200.0, 80.0, 20.0, 0.0, 80.0, 210.0, -20.0, -50.0, 100.0, 480.0, 240.0, 10.0, 60.0, -40.0, 100.0, 20.0, 35.0, 40.0, 30.0, 190.0, 20.0, -60.0, 0.0, 0.0, 60.0, 20.0, 180.0, 140.0, 20.0, 30.0, 20.0, 40.0, 140.0, 30.0, -30.0, 30.0, 110.0, 160.0, 310.0, 90.0, 20.0, 160.0, 50.0, 70.0, 60.0, 50.0, 150.0, 20.0, 10.0, 20.0, 20.0, 80.0, 30.0, 40.0, 20.0, 80.0, 10.0, 150.0, 470.0, 0.0, 50.0, 380.0, 50.0, 60.0, 30.0, 10.0, 110.0, 0.0, 210.0, 100.0, 70.0, 30.0, 140.0, 100.0, 310.0, 50.0, 100.0, 170.0, 230.0, 240.0, 80.0, 170.0, 370.0, 50.0, 310.0, 30.0, 90.0, 30.0, 100.0, 30.0, 10.0, 10.0, 40.0, 0.0, 10.0, 30.0, 30.0, 240.0, 0.0, 150.0, 250.0, 130.0, 90.0, -20.0, 50.0, 30.0, 330.0, 20.0, 20.0, 150.0, 40.0, 50.0, 300.0, 290.0, 80.0, 140.0, 80.0, 30.0, 0.0, 10.0, 30.0, 10.0, 300.0, 330.0, 110.0, 0.0, 0.0, 50.0, 40.0, 220.0, 10.0, 100.0, 40.0, 70.0, 150.0, 80.0, -5.0, 30.0, 30.0, 90.0, -15.0, -20.0, 160.0, 20.0, 20.0, 0.0, 0.0, 30.0, 110.0, 10.0, 90.0, 30.0, 20.0, 160.0, 5.0, 110.0, 40.0, 70.0, 60.0, 270.0, 400.0, -20.0, 290.0, 40.0, 30.0, 0.0, 60.0, 10.0, 90.0, 40.0, 70.0, 40.0, 110.0, 30.0, 0.0, 90.0, 0.0, 10.0, 60.0, 170.0, 150.0, 70.0, 20.0, 30.0, 210.0, 20.0, 40.0, 230.0, 290.0, 60.0, 30.0, 60.0, 30.0, 10.0, 60.0, 520.0, 10.0, 30.0, 0.0, 10.0, 50.0, 150.0, 40.0, 40.0, 0.0, 50.0, 210.0, 40.0, 40.0, 260.0, 320.0, 70.0, 50.0, 100.0, 100.0, 0.0, 70.0, 90.0, 230.0, 50.0, 50.0, 60.0, 220.0, 30.0, 50.0, 180.0, 300.0, 60.0, 50.0, 75.0, -5.0, 70.0, 270.0, 100.0, -30.0, 30.0, 160.0, 50.0, 30.0, 180.0, 80.0, 140.0, 30.0, 80.0, 20.0, 70.0, -30.0, 20.0, 30.0, 580.0, 80.0, 210.0, 50.0, 80.0, 150.0, 190.0, 30.0, -40.0, 0.0, 30.0, 50.0, 360.0, 0.0, 20.0, 40.0, 40.0, 20.0, 40.0, 0.0, 50.0, 40.0, 180.0, 30.0, 50.0, 0.0, 40.0, 70.0, 170.0, 220.0, 40.0, 20.0, 80.0, 300.0, 50.0, 20.0, 50.0, 70.0, 40.0, 45.0, 620.0, 170.0, 50.0, 190.0, 150.0, 120.0, 130.0, 45.0, 500.0, 40.0, 10.0, 80.0, 160.0, -20.0, 20.0, 170.0, 110.0, 260.0, 190.0, 310.0, 0.0, -10.0, 50.0, -10.0, 30.0, 230.0, 10.0, -70.0, 70.0, 60.0, 70.0, 50.0, 180.0, 430.0, 220.0, 270.0, 300.0, 40.0, 35.0, 80.0, -50.0, 150.0, 30.0, 100.0, 140.0, 30.0, 80.0, 0.0, 170.0, 20.0, 160.0, 30.0, 70.0, 20.0, 180.0, 250.0, 70.0, 160.0, 100.0, 80.0, 120.0, 30.0, 130.0, 370.0, 90.0, 150.0, 200.0, 100.0, 30.0, 120.0, 100.0, 80.0, 360.0, 40.0, 60.0, 30.0, 250.0, 20.0, 180.0, 20.0, 35.0, 40.0, 70.0, 20.0, 30.0, 170.0, 20.0, 130.0, 100.0, 30.0, 150.0, 10.0, 260.0, 40.0, 20.0, 70.0, 20.0, 10.0, 120.0, 0.0, 30.0, 10.0, 130.0, 0.0, 30.0, 40.0, 420.0, 20.0, 180.0, 90.0, 120.0, 0.0, 40.0, 120.0, 0.0, 30.0, 140.0, 0.0, -50.0, 90.0, 0.0, 80.0, 70.0, 120.0, 100.0, 10.0, 100.0, 140.0, 140.0, 110.0, 40.0, 10.0, 90.0, 20.0, 40.0, 20.0, 20.0, 80.0, 40.0, 100.0, 220.0, 0.0, 140.0, 0.0, 270.0, 100.0, 60.0, -100.0, 20.0, 80.0, 20.0, 110.0, 340.0, 0.0, 260.0, 10.0, 80.0, 40.0, 310.0, 130.0, 70.0, 160.0, 5.0, 170.0, 80.0, 80.0, 20.0, -10.0, 10.0, 400.0, 20.0, 60.0, 70.0, 30.0, 20.0, 10.0, 10.0, 120.0, 10.0, 20.0, 260.0, 80.0, 150.0, 80.0, 30.0, 30.0, 20.0, 100.0, 25.0, 70.0, 40.0, 25.0, 10.0, 30.0, 30.0, 30.0, 200.0, 50.0, 30.0, 40.0, 30.0, 100.0, 130.0, 130.0, 120.0, 100.0, -40.0, 150.0, 120.0, 40.0, 30.0, 100.0, -50.0, 210.0, 80.0, 10.0, 50.0, 10.0, 0.0, 20.0, 20.0, 100.0, 10.0, 40.0, 30.0, 90.0, 60.0, 20.0, 90.0, 280.0, 20.0, 30.0, 0.0, 110.0, 70.0, 50.0, 500.0, 60.0, 200.0, 10.0, 530.0, 60.0, 120.0, 90.0, 0.0, 50.0, 90.0, 170.0, 35.0, 0.0, 150.0, 70.0, 360.0, 30.0, 10.0, 180.0, 60.0, 30.0, 10.0, 60.0, 0.0, 110.0, 10.0, 100.0, 40.0, 10.0, 340.0, 110.0, 0.0, 40.0, 0.0, 70.0, 120.0, 80.0, 0.0, 0.0, 300.0, 200.0, 120.0, 150.0, 50.0, 170.0, 40.0, 40.0, 10.0, 140.0, 0.0, 60.0, 540.0, 370.0, 170.0, 110.0, 80.0, 80.0, 50.0, 100.0, 60.0, 180.0, 100.0, 100.0, 40.0, 110.0, 110.0, 400.0, 50.0, 180.0, -50.0, 110.0, 150.0, 0.0, 580.0, -30.0, 280.0, 90.0, -50.0, 60.0, 210.0, 130.0, 190.0, 150.0, 70.0, 70.0, 0.0, -30.0, 150.0, 160.0, 120.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 60.0, 70.0, 100.0, 120.0, 40.0, 300.0, 240.0, -10.0, 60.0, 10.0, -20.0, 0.0, 200.0, 60.0, 60.0, 60.0, 70.0, 160.0, 260.0, 50.0, 20.0, 80.0, 30.0, 10.0, 350.0, 20.0, 150.0, 10.0, 130.0, 140.0, 50.0, 160.0, 70.0, 130.0, 290.0, 230.0, 60.0, 80.0, 50.0, 65.0, 70.0, 100.0, 60.0, 90.0, 50.0, 50.0, 300.0, 40.0, 250.0, 40.0, 15.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 0.0, 0.0, 290.0, 390.0, -200.0, 10.0, 120.0, 280.0, 40.0, 80.0, 260.0, 140.0, 110.0, 80.0, 370.0, 10.0, 260.0, 260.0, 260.0, 130.0, -110.0, 40.0, 50.0, 40.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 90.0, 30.0, 200.0, 130.0, 50.0, -90.0, 20.0, 300.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 60.0, 30.0, 80.0, 100.0, 140.0, 200.0, 450.0, 220.0, 100.0, 0.0, 600.0, 20.0, -85.0, 60.0, 20.0, 90.0, 90.0, 200.0, -40.0, 240.0, 20.0, 220.0, 170.0, 20.0, 390.0, 260.0, 190.0, 170.0, 20.0, 80.0, 110.0, 70.0, 80.0, 90.0, 90.0, 0.0, 480.0, 70.0, 20.0, 490.0, 140.0, 60.0, 65.0, 280.0, -20.0, -10.0, 50.0, 150.0, 10.0, 10.0, 50.0, 110.0, 95.0, 90.0, 30.0, -240.0, 10.0, 30.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 50.0, 240.0, 70.0, 45.0, 190.0, 0.0, 150.0, 270.0, 100.0, 360.0, 60.0, 300.0, 70.0, 10.0, 0.0, 20.0, 20.0, 50.0, 20.0, 30.0, 0.0, 10.0, 30.0, 90.0, 130.0, 90.0, 100.0, 50.0, 210.0, 60.0, 30.0, 70.0, 0.0, 160.0, 30.0, 50.0, 40.0, 20.0, 40.0, 90.0, 20.0, 110.0, 100.0, 70.0, 310.0, 80.0, 210.0, 80.0, 70.0, 60.0, 80.0, 70.0, -20.0, -40.0, 20.0, 90.0, -10.0, 110.0, 110.0, 490.0, 110.0, 0.0, 180.0, 60.0, 50.0, 80.0, 250.0, 110.0, 500.0, 70.0, 130.0, 20.0, 120.0, 30.0, 20.0, 0.0, 60.0, 40.0, -230.0, 250.0, 30.0, 30.0, 90.0, 30.0, 10.0, 90.0, 20.0, 10.0, 140.0, 20.0, 240.0, 30.0, 10.0, 20.0, 160.0, 10.0, 0.0, 240.0, 30.0, 10.0, 240.0, 20.0, 40.0, 60.0, 20.0, 60.0, 40.0, 100.0, 290.0, 0.0, 0.0, 0.0, 40.0, 90.0, 250.0, 0.0, 10.0, 40.0, 160.0, -30.0, 90.0, 40.0, 40.0, 120.0, 0.0, 90.0, 80.0, 280.0, 120.0, 290.0, 50.0, 70.0, 30.0, 10.0, 80.0, 320.0, 70.0, 60.0, 190.0, 100.0, 45.0, 100.0, 20.0, 70.0, 120.0, 20.0, 20.0, 310.0, 120.0, -20.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5078510680846995, "mean_inference_ms": 1.4146143694463051, "mean_action_processing_ms": 0.425856645539363, "mean_env_wait_ms": 1.2510812374003126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01257944107055664, "StateBufferConnector_ms": 0.009193897247314453, "ViewRequirementAgentConnector_ms": 0.3852121829986572}, "num_episodes": 18, "episode_return_max": 1770.0, "episode_return_min": 145.0, "episode_return_mean": 899.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.63228612969674, "num_env_steps_trained_throughput_per_sec": 21.63228612969674, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 4200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4200000, "timers": {"training_iteration_time_ms": 186698.364, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186698.32, "sample_time_ms": 2465.184, "learn_time_ms": 184213.498, "learn_throughput": 21.714, "synch_weights_time_ms": 12.17}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "done": false, "training_iteration": 105, "trial_id": "90816_00000", "date": "2024-06-10_05-40-58", "timestamp": 1718012458, "time_this_iter_s": 184.9184010028839, "time_total_s": 19736.139276504517, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b012b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19736.139276504517, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 17.333716475095788, "ram_util_percent": 79.12796934865901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6329381361302224, "cur_kl_coeff": 5.195713640749455, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.673153780976804, "policy_loss": -0.004639550906316406, "vf_loss": 6.67476532568439, "vf_explained_var": 0.00036577171030135965, "kl": 0.0005827889830578648, "entropy": 0.34354936851860995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 990645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "env_runners": {"episode_reward_max": 1835.0, "episode_reward_min": 145.0, "episode_reward_mean": 920.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 92.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [810.0, 830.0, 850.0, 1240.0, 850.0, 1070.0, 800.0, 1240.0, 680.0, 450.0, 1010.0, 1505.0, 1135.0, 1160.0, 1290.0, 855.0, 980.0, 1300.0, 1120.0, 835.0, 830.0, 390.0, 1020.0, 560.0, 710.0, 970.0, 800.0, 1125.0, 630.0, 790.0, 380.0, 930.0, 650.0, 370.0, 730.0, 1620.0, 1095.0, 430.0, 760.0, 1220.0, 1560.0, 1330.0, 1140.0, 1100.0, 290.0, 990.0, 900.0, 940.0, 1185.0, 1050.0, 145.0, 1270.0, 1510.0, 240.0, 740.0, 920.0, 1475.0, 1570.0, 900.0, 1575.0, 355.0, 420.0, 1545.0, 230.0, 860.0, 560.0, 1130.0, 860.0, 1450.0, 350.0, 680.0, 740.0, 610.0, 690.0, 1140.0, 1005.0, 690.0, 1835.0, 1000.0, 480.0, 1200.0, 1100.0, 1375.0, 1120.0, 1115.0, 1500.0, 850.0, 680.0, 650.0, 530.0, 820.0, 380.0, 1065.0, 305.0, 570.0, 820.0, 1500.0, 790.0, 1235.0, 990.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 0.0, 10.0, 60.0, 170.0, 150.0, 70.0, 20.0, 30.0, 210.0, 20.0, 40.0, 230.0, 290.0, 60.0, 30.0, 60.0, 30.0, 10.0, 60.0, 520.0, 10.0, 30.0, 0.0, 10.0, 50.0, 150.0, 40.0, 40.0, 0.0, 50.0, 210.0, 40.0, 40.0, 260.0, 320.0, 70.0, 50.0, 100.0, 100.0, 0.0, 70.0, 90.0, 230.0, 50.0, 50.0, 60.0, 220.0, 30.0, 50.0, 180.0, 300.0, 60.0, 50.0, 75.0, -5.0, 70.0, 270.0, 100.0, -30.0, 30.0, 160.0, 50.0, 30.0, 180.0, 80.0, 140.0, 30.0, 80.0, 20.0, 70.0, -30.0, 20.0, 30.0, 580.0, 80.0, 210.0, 50.0, 80.0, 150.0, 190.0, 30.0, -40.0, 0.0, 30.0, 50.0, 360.0, 0.0, 20.0, 40.0, 40.0, 20.0, 40.0, 0.0, 50.0, 40.0, 180.0, 30.0, 50.0, 0.0, 40.0, 70.0, 170.0, 220.0, 40.0, 20.0, 80.0, 300.0, 50.0, 20.0, 50.0, 70.0, 40.0, 45.0, 620.0, 170.0, 50.0, 190.0, 150.0, 120.0, 130.0, 45.0, 500.0, 40.0, 10.0, 80.0, 160.0, -20.0, 20.0, 170.0, 110.0, 260.0, 190.0, 310.0, 0.0, -10.0, 50.0, -10.0, 30.0, 230.0, 10.0, -70.0, 70.0, 60.0, 70.0, 50.0, 180.0, 430.0, 220.0, 270.0, 300.0, 40.0, 35.0, 80.0, -50.0, 150.0, 30.0, 100.0, 140.0, 30.0, 80.0, 0.0, 170.0, 20.0, 160.0, 30.0, 70.0, 20.0, 180.0, 250.0, 70.0, 160.0, 100.0, 80.0, 120.0, 30.0, 130.0, 370.0, 90.0, 150.0, 200.0, 100.0, 30.0, 120.0, 100.0, 80.0, 360.0, 40.0, 60.0, 30.0, 250.0, 20.0, 180.0, 20.0, 35.0, 40.0, 70.0, 20.0, 30.0, 170.0, 20.0, 130.0, 100.0, 30.0, 150.0, 10.0, 260.0, 40.0, 20.0, 70.0, 20.0, 10.0, 120.0, 0.0, 30.0, 10.0, 130.0, 0.0, 30.0, 40.0, 420.0, 20.0, 180.0, 90.0, 120.0, 0.0, 40.0, 120.0, 0.0, 30.0, 140.0, 0.0, -50.0, 90.0, 0.0, 80.0, 70.0, 120.0, 100.0, 10.0, 100.0, 140.0, 140.0, 110.0, 40.0, 10.0, 90.0, 20.0, 40.0, 20.0, 20.0, 80.0, 40.0, 100.0, 220.0, 0.0, 140.0, 0.0, 270.0, 100.0, 60.0, -100.0, 20.0, 80.0, 20.0, 110.0, 340.0, 0.0, 260.0, 10.0, 80.0, 40.0, 310.0, 130.0, 70.0, 160.0, 5.0, 170.0, 80.0, 80.0, 20.0, -10.0, 10.0, 400.0, 20.0, 60.0, 70.0, 30.0, 20.0, 10.0, 10.0, 120.0, 10.0, 20.0, 260.0, 80.0, 150.0, 80.0, 30.0, 30.0, 20.0, 100.0, 25.0, 70.0, 40.0, 25.0, 10.0, 30.0, 30.0, 30.0, 200.0, 50.0, 30.0, 40.0, 30.0, 100.0, 130.0, 130.0, 120.0, 100.0, -40.0, 150.0, 120.0, 40.0, 30.0, 100.0, -50.0, 210.0, 80.0, 10.0, 50.0, 10.0, 0.0, 20.0, 20.0, 100.0, 10.0, 40.0, 30.0, 90.0, 60.0, 20.0, 90.0, 280.0, 20.0, 30.0, 0.0, 110.0, 70.0, 50.0, 500.0, 60.0, 200.0, 10.0, 530.0, 60.0, 120.0, 90.0, 0.0, 50.0, 90.0, 170.0, 35.0, 0.0, 150.0, 70.0, 360.0, 30.0, 10.0, 180.0, 60.0, 30.0, 10.0, 60.0, 0.0, 110.0, 10.0, 100.0, 40.0, 10.0, 340.0, 110.0, 0.0, 40.0, 0.0, 70.0, 120.0, 80.0, 0.0, 0.0, 300.0, 200.0, 120.0, 150.0, 50.0, 170.0, 40.0, 40.0, 10.0, 140.0, 0.0, 60.0, 540.0, 370.0, 170.0, 110.0, 80.0, 80.0, 50.0, 100.0, 60.0, 180.0, 100.0, 100.0, 40.0, 110.0, 110.0, 400.0, 50.0, 180.0, -50.0, 110.0, 150.0, 0.0, 580.0, -30.0, 280.0, 90.0, -50.0, 60.0, 210.0, 130.0, 190.0, 150.0, 70.0, 70.0, 0.0, -30.0, 150.0, 160.0, 120.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 60.0, 70.0, 100.0, 120.0, 40.0, 300.0, 240.0, -10.0, 60.0, 10.0, -20.0, 0.0, 200.0, 60.0, 60.0, 60.0, 70.0, 160.0, 260.0, 50.0, 20.0, 80.0, 30.0, 10.0, 350.0, 20.0, 150.0, 10.0, 130.0, 140.0, 50.0, 160.0, 70.0, 130.0, 290.0, 230.0, 60.0, 80.0, 50.0, 65.0, 70.0, 100.0, 60.0, 90.0, 50.0, 50.0, 300.0, 40.0, 250.0, 40.0, 15.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 0.0, 0.0, 290.0, 390.0, -200.0, 10.0, 120.0, 280.0, 40.0, 80.0, 260.0, 140.0, 110.0, 80.0, 370.0, 10.0, 260.0, 260.0, 260.0, 130.0, -110.0, 40.0, 50.0, 40.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 90.0, 30.0, 200.0, 130.0, 50.0, -90.0, 20.0, 300.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 60.0, 30.0, 80.0, 100.0, 140.0, 200.0, 450.0, 220.0, 100.0, 0.0, 600.0, 20.0, -85.0, 60.0, 20.0, 90.0, 90.0, 200.0, -40.0, 240.0, 20.0, 220.0, 170.0, 20.0, 390.0, 260.0, 190.0, 170.0, 20.0, 80.0, 110.0, 70.0, 80.0, 90.0, 90.0, 0.0, 480.0, 70.0, 20.0, 490.0, 140.0, 60.0, 65.0, 280.0, -20.0, -10.0, 50.0, 150.0, 10.0, 10.0, 50.0, 110.0, 95.0, 90.0, 30.0, -240.0, 10.0, 30.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 50.0, 240.0, 70.0, 45.0, 190.0, 0.0, 150.0, 270.0, 100.0, 360.0, 60.0, 300.0, 70.0, 10.0, 0.0, 20.0, 20.0, 50.0, 20.0, 30.0, 0.0, 10.0, 30.0, 90.0, 130.0, 90.0, 100.0, 50.0, 210.0, 60.0, 30.0, 70.0, 0.0, 160.0, 30.0, 50.0, 40.0, 20.0, 40.0, 90.0, 20.0, 110.0, 100.0, 70.0, 310.0, 80.0, 210.0, 80.0, 70.0, 60.0, 80.0, 70.0, -20.0, -40.0, 20.0, 90.0, -10.0, 110.0, 110.0, 490.0, 110.0, 0.0, 180.0, 60.0, 50.0, 80.0, 250.0, 110.0, 500.0, 70.0, 130.0, 20.0, 120.0, 30.0, 20.0, 0.0, 60.0, 40.0, -230.0, 250.0, 30.0, 30.0, 90.0, 30.0, 10.0, 90.0, 20.0, 10.0, 140.0, 20.0, 240.0, 30.0, 10.0, 20.0, 160.0, 10.0, 0.0, 240.0, 30.0, 10.0, 240.0, 20.0, 40.0, 60.0, 20.0, 60.0, 40.0, 100.0, 290.0, 0.0, 0.0, 0.0, 40.0, 90.0, 250.0, 0.0, 10.0, 40.0, 160.0, -30.0, 90.0, 40.0, 40.0, 120.0, 0.0, 90.0, 80.0, 280.0, 120.0, 290.0, 50.0, 70.0, 30.0, 10.0, 80.0, 320.0, 70.0, 60.0, 190.0, 100.0, 45.0, 100.0, 20.0, 70.0, 120.0, 20.0, 20.0, 310.0, 120.0, -20.0, 10.0, 20.0, 70.0, 290.0, -10.0, 70.0, 20.0, 190.0, 780.0, 195.0, 80.0, 150.0, 10.0, 30.0, 40.0, 260.0, 60.0, 340.0, 70.0, 30.0, 90.0, 70.0, 10.0, 120.0, 110.0, 30.0, 20.0, 20.0, 90.0, 10.0, 40.0, 30.0, 60.0, 30.0, 120.0, 40.0, 80.0, 170.0, 370.0, 130.0, 30.0, 170.0, -10.0, 30.0, 570.0, 30.0, 0.0, 390.0, 0.0, 10.0, 40.0, 40.0, -10.0, 310.0, 65.0, 130.0, 70.0, 140.0, -10.0, 80.0, 30.0, 570.0, 620.0, 260.0, 50.0, 20.0, -110.0, 30.0, 140.0, 0.0, 80.0, 30.0, 30.0, 130.0, 90.0, 20.0, 150.0, 25.0, 190.0, 260.0, 150.0, 70.0, 90.0, 20.0, 290.0, 360.0, 170.0, 10.0, 40.0, 10.0, 50.0, 460.0, 60.0, 320.0, 90.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 240.0, 150.0, 190.0, 20.0, 20.0, 140.0, 60.0, 0.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 180.0, 50.0, 90.0, 180.0, 40.0, 10.0, 0.0, -90.0, -50.0, 40.0, 250.0, 50.0, 90.0, -80.0, 150.0, 20.0, 150.0, 110.0, 60.0, 70.0, 50.0, 190.0, 0.0, 60.0, 220.0, -20.0, 80.0, 10.0, 50.0, 30.0, 20.0, 20.0, 60.0, 0.0, 40.0, 50.0, 100.0, 80.0, 160.0, 100.0, 0.0, 10.0, 10.0, 30.0, 330.0, -40.0, 385.0, 190.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 50.0, 50.0, -55.0, 150.0, 30.0, 40.0, 30.0, 40.0, 110.0, 70.0, 30.0, 30.0, 40.0, 30.0, 60.0, 20.0, 40.0, 160.0, 230.0, 10.0, 230.0, 0.0, 40.0, 60.0, 140.0, 140.0, 430.0, 0.0, 80.0, -20.0, 220.0, 160.0, 290.0, 100.0, 140.0, 20.0, 10.0, -55.0, 280.0, -95.0, 70.0, 290.0, 30.0, 90.0, 460.0, -5.0, 20.0, 100.0, 90.0, 10.0, 50.0, 250.0, 170.0, 340.0, 50.0, 50.0, 100.0, 50.0, 50.0, 140.0, 60.0, 110.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.507232546858265, "mean_inference_ms": 1.4138427019353055, "mean_action_processing_ms": 0.42536397822341326, "mean_env_wait_ms": 1.2506167869201317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012696504592895508, "StateBufferConnector_ms": 0.009163379669189453, "ViewRequirementAgentConnector_ms": 0.3647289276123047}, "num_episodes": 23, "episode_return_max": 1835.0, "episode_return_min": 145.0, "episode_return_mean": 920.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.536826952447246, "num_env_steps_trained_throughput_per_sec": 21.536826952447246, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 4240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4240000, "timers": {"training_iteration_time_ms": 186644.091, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186644.047, "sample_time_ms": 2432.412, "learn_time_ms": 184192.502, "learn_throughput": 21.716, "synch_weights_time_ms": 11.594}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "done": false, "training_iteration": 106, "trial_id": "90816_00000", "date": "2024-06-10_05-44-04", "timestamp": 1718012644, "time_this_iter_s": 185.7402787208557, "time_total_s": 19921.879555225372, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00825e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19921.879555225372, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.758935361216732, "ram_util_percent": 79.35247148288973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.136504628445013, "cur_kl_coeff": 2.5978568203747274, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005227497046742949, "vf_loss": 6.938955680300761, "vf_explained_var": 0.0001349941673624122, "kl": Infinity, "entropy": 0.3427137512638292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1000035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "env_runners": {"episode_reward_max": 1835.0, "episode_reward_min": 145.0, "episode_reward_mean": 923.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 92.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1120.0, 835.0, 830.0, 390.0, 1020.0, 560.0, 710.0, 970.0, 800.0, 1125.0, 630.0, 790.0, 380.0, 930.0, 650.0, 370.0, 730.0, 1620.0, 1095.0, 430.0, 760.0, 1220.0, 1560.0, 1330.0, 1140.0, 1100.0, 290.0, 990.0, 900.0, 940.0, 1185.0, 1050.0, 145.0, 1270.0, 1510.0, 240.0, 740.0, 920.0, 1475.0, 1570.0, 900.0, 1575.0, 355.0, 420.0, 1545.0, 230.0, 860.0, 560.0, 1130.0, 860.0, 1450.0, 350.0, 680.0, 740.0, 610.0, 690.0, 1140.0, 1005.0, 690.0, 1835.0, 1000.0, 480.0, 1200.0, 1100.0, 1375.0, 1120.0, 1115.0, 1500.0, 850.0, 680.0, 650.0, 530.0, 820.0, 380.0, 1065.0, 305.0, 570.0, 820.0, 1500.0, 790.0, 1235.0, 990.0, 905.0, 435.0, 920.0, 1530.0, 510.0, 1370.0, 620.0, 880.0, 1380.0, 760.0, 1240.0, 800.0, 730.0, 1065.0, 560.0, 1320.0, 1805.0, 1500.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [200.0, 100.0, 30.0, 120.0, 100.0, 80.0, 360.0, 40.0, 60.0, 30.0, 250.0, 20.0, 180.0, 20.0, 35.0, 40.0, 70.0, 20.0, 30.0, 170.0, 20.0, 130.0, 100.0, 30.0, 150.0, 10.0, 260.0, 40.0, 20.0, 70.0, 20.0, 10.0, 120.0, 0.0, 30.0, 10.0, 130.0, 0.0, 30.0, 40.0, 420.0, 20.0, 180.0, 90.0, 120.0, 0.0, 40.0, 120.0, 0.0, 30.0, 140.0, 0.0, -50.0, 90.0, 0.0, 80.0, 70.0, 120.0, 100.0, 10.0, 100.0, 140.0, 140.0, 110.0, 40.0, 10.0, 90.0, 20.0, 40.0, 20.0, 20.0, 80.0, 40.0, 100.0, 220.0, 0.0, 140.0, 0.0, 270.0, 100.0, 60.0, -100.0, 20.0, 80.0, 20.0, 110.0, 340.0, 0.0, 260.0, 10.0, 80.0, 40.0, 310.0, 130.0, 70.0, 160.0, 5.0, 170.0, 80.0, 80.0, 20.0, -10.0, 10.0, 400.0, 20.0, 60.0, 70.0, 30.0, 20.0, 10.0, 10.0, 120.0, 10.0, 20.0, 260.0, 80.0, 150.0, 80.0, 30.0, 30.0, 20.0, 100.0, 25.0, 70.0, 40.0, 25.0, 10.0, 30.0, 30.0, 30.0, 200.0, 50.0, 30.0, 40.0, 30.0, 100.0, 130.0, 130.0, 120.0, 100.0, -40.0, 150.0, 120.0, 40.0, 30.0, 100.0, -50.0, 210.0, 80.0, 10.0, 50.0, 10.0, 0.0, 20.0, 20.0, 100.0, 10.0, 40.0, 30.0, 90.0, 60.0, 20.0, 90.0, 280.0, 20.0, 30.0, 0.0, 110.0, 70.0, 50.0, 500.0, 60.0, 200.0, 10.0, 530.0, 60.0, 120.0, 90.0, 0.0, 50.0, 90.0, 170.0, 35.0, 0.0, 150.0, 70.0, 360.0, 30.0, 10.0, 180.0, 60.0, 30.0, 10.0, 60.0, 0.0, 110.0, 10.0, 100.0, 40.0, 10.0, 340.0, 110.0, 0.0, 40.0, 0.0, 70.0, 120.0, 80.0, 0.0, 0.0, 300.0, 200.0, 120.0, 150.0, 50.0, 170.0, 40.0, 40.0, 10.0, 140.0, 0.0, 60.0, 540.0, 370.0, 170.0, 110.0, 80.0, 80.0, 50.0, 100.0, 60.0, 180.0, 100.0, 100.0, 40.0, 110.0, 110.0, 400.0, 50.0, 180.0, -50.0, 110.0, 150.0, 0.0, 580.0, -30.0, 280.0, 90.0, -50.0, 60.0, 210.0, 130.0, 190.0, 150.0, 70.0, 70.0, 0.0, -30.0, 150.0, 160.0, 120.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 60.0, 70.0, 100.0, 120.0, 40.0, 300.0, 240.0, -10.0, 60.0, 10.0, -20.0, 0.0, 200.0, 60.0, 60.0, 60.0, 70.0, 160.0, 260.0, 50.0, 20.0, 80.0, 30.0, 10.0, 350.0, 20.0, 150.0, 10.0, 130.0, 140.0, 50.0, 160.0, 70.0, 130.0, 290.0, 230.0, 60.0, 80.0, 50.0, 65.0, 70.0, 100.0, 60.0, 90.0, 50.0, 50.0, 300.0, 40.0, 250.0, 40.0, 15.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 0.0, 0.0, 290.0, 390.0, -200.0, 10.0, 120.0, 280.0, 40.0, 80.0, 260.0, 140.0, 110.0, 80.0, 370.0, 10.0, 260.0, 260.0, 260.0, 130.0, -110.0, 40.0, 50.0, 40.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 90.0, 30.0, 200.0, 130.0, 50.0, -90.0, 20.0, 300.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 60.0, 30.0, 80.0, 100.0, 140.0, 200.0, 450.0, 220.0, 100.0, 0.0, 600.0, 20.0, -85.0, 60.0, 20.0, 90.0, 90.0, 200.0, -40.0, 240.0, 20.0, 220.0, 170.0, 20.0, 390.0, 260.0, 190.0, 170.0, 20.0, 80.0, 110.0, 70.0, 80.0, 90.0, 90.0, 0.0, 480.0, 70.0, 20.0, 490.0, 140.0, 60.0, 65.0, 280.0, -20.0, -10.0, 50.0, 150.0, 10.0, 10.0, 50.0, 110.0, 95.0, 90.0, 30.0, -240.0, 10.0, 30.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 50.0, 240.0, 70.0, 45.0, 190.0, 0.0, 150.0, 270.0, 100.0, 360.0, 60.0, 300.0, 70.0, 10.0, 0.0, 20.0, 20.0, 50.0, 20.0, 30.0, 0.0, 10.0, 30.0, 90.0, 130.0, 90.0, 100.0, 50.0, 210.0, 60.0, 30.0, 70.0, 0.0, 160.0, 30.0, 50.0, 40.0, 20.0, 40.0, 90.0, 20.0, 110.0, 100.0, 70.0, 310.0, 80.0, 210.0, 80.0, 70.0, 60.0, 80.0, 70.0, -20.0, -40.0, 20.0, 90.0, -10.0, 110.0, 110.0, 490.0, 110.0, 0.0, 180.0, 60.0, 50.0, 80.0, 250.0, 110.0, 500.0, 70.0, 130.0, 20.0, 120.0, 30.0, 20.0, 0.0, 60.0, 40.0, -230.0, 250.0, 30.0, 30.0, 90.0, 30.0, 10.0, 90.0, 20.0, 10.0, 140.0, 20.0, 240.0, 30.0, 10.0, 20.0, 160.0, 10.0, 0.0, 240.0, 30.0, 10.0, 240.0, 20.0, 40.0, 60.0, 20.0, 60.0, 40.0, 100.0, 290.0, 0.0, 0.0, 0.0, 40.0, 90.0, 250.0, 0.0, 10.0, 40.0, 160.0, -30.0, 90.0, 40.0, 40.0, 120.0, 0.0, 90.0, 80.0, 280.0, 120.0, 290.0, 50.0, 70.0, 30.0, 10.0, 80.0, 320.0, 70.0, 60.0, 190.0, 100.0, 45.0, 100.0, 20.0, 70.0, 120.0, 20.0, 20.0, 310.0, 120.0, -20.0, 10.0, 20.0, 70.0, 290.0, -10.0, 70.0, 20.0, 190.0, 780.0, 195.0, 80.0, 150.0, 10.0, 30.0, 40.0, 260.0, 60.0, 340.0, 70.0, 30.0, 90.0, 70.0, 10.0, 120.0, 110.0, 30.0, 20.0, 20.0, 90.0, 10.0, 40.0, 30.0, 60.0, 30.0, 120.0, 40.0, 80.0, 170.0, 370.0, 130.0, 30.0, 170.0, -10.0, 30.0, 570.0, 30.0, 0.0, 390.0, 0.0, 10.0, 40.0, 40.0, -10.0, 310.0, 65.0, 130.0, 70.0, 140.0, -10.0, 80.0, 30.0, 570.0, 620.0, 260.0, 50.0, 20.0, -110.0, 30.0, 140.0, 0.0, 80.0, 30.0, 30.0, 130.0, 90.0, 20.0, 150.0, 25.0, 190.0, 260.0, 150.0, 70.0, 90.0, 20.0, 290.0, 360.0, 170.0, 10.0, 40.0, 10.0, 50.0, 460.0, 60.0, 320.0, 90.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 240.0, 150.0, 190.0, 20.0, 20.0, 140.0, 60.0, 0.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 180.0, 50.0, 90.0, 180.0, 40.0, 10.0, 0.0, -90.0, -50.0, 40.0, 250.0, 50.0, 90.0, -80.0, 150.0, 20.0, 150.0, 110.0, 60.0, 70.0, 50.0, 190.0, 0.0, 60.0, 220.0, -20.0, 80.0, 10.0, 50.0, 30.0, 20.0, 20.0, 60.0, 0.0, 40.0, 50.0, 100.0, 80.0, 160.0, 100.0, 0.0, 10.0, 10.0, 30.0, 330.0, -40.0, 385.0, 190.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 50.0, 50.0, -55.0, 150.0, 30.0, 40.0, 30.0, 40.0, 110.0, 70.0, 30.0, 30.0, 40.0, 30.0, 60.0, 20.0, 40.0, 160.0, 230.0, 10.0, 230.0, 0.0, 40.0, 60.0, 140.0, 140.0, 430.0, 0.0, 80.0, -20.0, 220.0, 160.0, 290.0, 100.0, 140.0, 20.0, 10.0, -55.0, 280.0, -95.0, 70.0, 290.0, 30.0, 90.0, 460.0, -5.0, 20.0, 100.0, 90.0, 10.0, 50.0, 250.0, 170.0, 340.0, 50.0, 50.0, 100.0, 50.0, 50.0, 140.0, 60.0, 110.0, 40.0, 250.0, 80.0, 150.0, 30.0, 60.0, 200.0, 30.0, 40.0, 70.0, -5.0, 30.0, 20.0, 50.0, 110.0, 0.0, 0.0, 60.0, 130.0, 5.0, 30.0, 50.0, 150.0, 60.0, 10.0, 110.0, 110.0, 30.0, 300.0, 0.0, 100.0, 80.0, 90.0, 460.0, 60.0, 230.0, 240.0, 60.0, 60.0, 200.0, 50.0, 20.0, 10.0, 80.0, 30.0, 20.0, 110.0, 20.0, 10.0, 170.0, 40.0, 230.0, 50.0, 90.0, 220.0, 360.0, 70.0, 40.0, 140.0, 130.0, 40.0, 50.0, 50.0, 10.0, 320.0, 30.0, 40.0, 40.0, 20.0, 30.0, 30.0, 40.0, 160.0, 0.0, 40.0, 140.0, 40.0, 300.0, 50.0, 110.0, 0.0, 10.0, 50.0, 100.0, 240.0, 100.0, 160.0, 150.0, -10.0, 530.0, 50.0, 410.0, 40.0, 20.0, -130.0, 30.0, 10.0, 90.0, 40.0, 20.0, 230.0, -50.0, 490.0, 60.0, 140.0, 40.0, 90.0, 200.0, 30.0, 150.0, 90.0, 80.0, 40.0, 160.0, 40.0, 50.0, 140.0, 70.0, 10.0, 190.0, 20.0, 10.0, 60.0, 70.0, 40.0, 10.0, 20.0, 20.0, 500.0, 0.0, 0.0, -55.0, 50.0, 100.0, 160.0, 10.0, 120.0, 550.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 160.0, 210.0, 120.0, 180.0, 70.0, 110.0, 50.0, 70.0, 340.0, 190.0, 80.0, 110.0, 160.0, -10.0, 410.0, -10.0, 770.0, 15.0, 90.0, 180.0, 110.0, 90.0, 190.0, 80.0, 190.0, 160.0, 140.0, 170.0, 350.0, 120.0, 90.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5065747143079427, "mean_inference_ms": 1.4132019996468081, "mean_action_processing_ms": 0.42497539637216425, "mean_env_wait_ms": 1.25025814344262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012311220169067383, "StateBufferConnector_ms": 0.009236335754394531, "ViewRequirementAgentConnector_ms": 0.3772745132446289}, "num_episodes": 18, "episode_return_max": 1835.0, "episode_return_min": 145.0, "episode_return_mean": 923.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.45457915561232, "num_env_steps_trained_throughput_per_sec": 21.45457915561232, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 4280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4280000, "timers": {"training_iteration_time_ms": 186627.238, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186627.195, "sample_time_ms": 2416.288, "learn_time_ms": 184191.764, "learn_throughput": 21.716, "synch_weights_time_ms": 11.741}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "done": false, "training_iteration": 107, "trial_id": "90816_00000", "date": "2024-06-10_05-47-11", "timestamp": 1718012831, "time_this_iter_s": 186.44733905792236, "time_total_s": 20108.326894283295, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0103a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20108.326894283295, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 17.8280303030303, "ram_util_percent": 79.5965909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4613542088875757, "cur_kl_coeff": 3.8967852305620903, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005022382139028928, "vf_loss": 5.8804974294952945, "vf_explained_var": 0.00155257339548633, "kl": Infinity, "entropy": 0.38556244906843407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1009425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 145.0, "episode_reward_mean": 934.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 93.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1560.0, 1330.0, 1140.0, 1100.0, 290.0, 990.0, 900.0, 940.0, 1185.0, 1050.0, 145.0, 1270.0, 1510.0, 240.0, 740.0, 920.0, 1475.0, 1570.0, 900.0, 1575.0, 355.0, 420.0, 1545.0, 230.0, 860.0, 560.0, 1130.0, 860.0, 1450.0, 350.0, 680.0, 740.0, 610.0, 690.0, 1140.0, 1005.0, 690.0, 1835.0, 1000.0, 480.0, 1200.0, 1100.0, 1375.0, 1120.0, 1115.0, 1500.0, 850.0, 680.0, 650.0, 530.0, 820.0, 380.0, 1065.0, 305.0, 570.0, 820.0, 1500.0, 790.0, 1235.0, 990.0, 905.0, 435.0, 920.0, 1530.0, 510.0, 1370.0, 620.0, 880.0, 1380.0, 760.0, 1240.0, 800.0, 730.0, 1065.0, 560.0, 1320.0, 1805.0, 1500.0, 665.0, 920.0, 190.0, 930.0, 660.0, 590.0, 1900.0, 1010.0, 775.0, 1380.0, 810.0, 150.0, 850.0, 1430.0, 765.0, 760.0, 200.0, 1300.0, 1085.0, 1280.0, 600.0, 790.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 60.0, 540.0, 370.0, 170.0, 110.0, 80.0, 80.0, 50.0, 100.0, 60.0, 180.0, 100.0, 100.0, 40.0, 110.0, 110.0, 400.0, 50.0, 180.0, -50.0, 110.0, 150.0, 0.0, 580.0, -30.0, 280.0, 90.0, -50.0, 60.0, 210.0, 130.0, 190.0, 150.0, 70.0, 70.0, 0.0, -30.0, 150.0, 160.0, 120.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 20.0, 0.0, 40.0, 60.0, 70.0, 100.0, 120.0, 40.0, 300.0, 240.0, -10.0, 60.0, 10.0, -20.0, 0.0, 200.0, 60.0, 60.0, 60.0, 70.0, 160.0, 260.0, 50.0, 20.0, 80.0, 30.0, 10.0, 350.0, 20.0, 150.0, 10.0, 130.0, 140.0, 50.0, 160.0, 70.0, 130.0, 290.0, 230.0, 60.0, 80.0, 50.0, 65.0, 70.0, 100.0, 60.0, 90.0, 50.0, 50.0, 300.0, 40.0, 250.0, 40.0, 15.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 0.0, 0.0, 290.0, 390.0, -200.0, 10.0, 120.0, 280.0, 40.0, 80.0, 260.0, 140.0, 110.0, 80.0, 370.0, 10.0, 260.0, 260.0, 260.0, 130.0, -110.0, 40.0, 50.0, 40.0, 40.0, 30.0, 10.0, 0.0, 20.0, 0.0, 10.0, 90.0, 30.0, 200.0, 130.0, 50.0, -90.0, 20.0, 300.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 60.0, 30.0, 80.0, 100.0, 140.0, 200.0, 450.0, 220.0, 100.0, 0.0, 600.0, 20.0, -85.0, 60.0, 20.0, 90.0, 90.0, 200.0, -40.0, 240.0, 20.0, 220.0, 170.0, 20.0, 390.0, 260.0, 190.0, 170.0, 20.0, 80.0, 110.0, 70.0, 80.0, 90.0, 90.0, 0.0, 480.0, 70.0, 20.0, 490.0, 140.0, 60.0, 65.0, 280.0, -20.0, -10.0, 50.0, 150.0, 10.0, 10.0, 50.0, 110.0, 95.0, 90.0, 30.0, -240.0, 10.0, 30.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 50.0, 240.0, 70.0, 45.0, 190.0, 0.0, 150.0, 270.0, 100.0, 360.0, 60.0, 300.0, 70.0, 10.0, 0.0, 20.0, 20.0, 50.0, 20.0, 30.0, 0.0, 10.0, 30.0, 90.0, 130.0, 90.0, 100.0, 50.0, 210.0, 60.0, 30.0, 70.0, 0.0, 160.0, 30.0, 50.0, 40.0, 20.0, 40.0, 90.0, 20.0, 110.0, 100.0, 70.0, 310.0, 80.0, 210.0, 80.0, 70.0, 60.0, 80.0, 70.0, -20.0, -40.0, 20.0, 90.0, -10.0, 110.0, 110.0, 490.0, 110.0, 0.0, 180.0, 60.0, 50.0, 80.0, 250.0, 110.0, 500.0, 70.0, 130.0, 20.0, 120.0, 30.0, 20.0, 0.0, 60.0, 40.0, -230.0, 250.0, 30.0, 30.0, 90.0, 30.0, 10.0, 90.0, 20.0, 10.0, 140.0, 20.0, 240.0, 30.0, 10.0, 20.0, 160.0, 10.0, 0.0, 240.0, 30.0, 10.0, 240.0, 20.0, 40.0, 60.0, 20.0, 60.0, 40.0, 100.0, 290.0, 0.0, 0.0, 0.0, 40.0, 90.0, 250.0, 0.0, 10.0, 40.0, 160.0, -30.0, 90.0, 40.0, 40.0, 120.0, 0.0, 90.0, 80.0, 280.0, 120.0, 290.0, 50.0, 70.0, 30.0, 10.0, 80.0, 320.0, 70.0, 60.0, 190.0, 100.0, 45.0, 100.0, 20.0, 70.0, 120.0, 20.0, 20.0, 310.0, 120.0, -20.0, 10.0, 20.0, 70.0, 290.0, -10.0, 70.0, 20.0, 190.0, 780.0, 195.0, 80.0, 150.0, 10.0, 30.0, 40.0, 260.0, 60.0, 340.0, 70.0, 30.0, 90.0, 70.0, 10.0, 120.0, 110.0, 30.0, 20.0, 20.0, 90.0, 10.0, 40.0, 30.0, 60.0, 30.0, 120.0, 40.0, 80.0, 170.0, 370.0, 130.0, 30.0, 170.0, -10.0, 30.0, 570.0, 30.0, 0.0, 390.0, 0.0, 10.0, 40.0, 40.0, -10.0, 310.0, 65.0, 130.0, 70.0, 140.0, -10.0, 80.0, 30.0, 570.0, 620.0, 260.0, 50.0, 20.0, -110.0, 30.0, 140.0, 0.0, 80.0, 30.0, 30.0, 130.0, 90.0, 20.0, 150.0, 25.0, 190.0, 260.0, 150.0, 70.0, 90.0, 20.0, 290.0, 360.0, 170.0, 10.0, 40.0, 10.0, 50.0, 460.0, 60.0, 320.0, 90.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 240.0, 150.0, 190.0, 20.0, 20.0, 140.0, 60.0, 0.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 180.0, 50.0, 90.0, 180.0, 40.0, 10.0, 0.0, -90.0, -50.0, 40.0, 250.0, 50.0, 90.0, -80.0, 150.0, 20.0, 150.0, 110.0, 60.0, 70.0, 50.0, 190.0, 0.0, 60.0, 220.0, -20.0, 80.0, 10.0, 50.0, 30.0, 20.0, 20.0, 60.0, 0.0, 40.0, 50.0, 100.0, 80.0, 160.0, 100.0, 0.0, 10.0, 10.0, 30.0, 330.0, -40.0, 385.0, 190.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 50.0, 50.0, -55.0, 150.0, 30.0, 40.0, 30.0, 40.0, 110.0, 70.0, 30.0, 30.0, 40.0, 30.0, 60.0, 20.0, 40.0, 160.0, 230.0, 10.0, 230.0, 0.0, 40.0, 60.0, 140.0, 140.0, 430.0, 0.0, 80.0, -20.0, 220.0, 160.0, 290.0, 100.0, 140.0, 20.0, 10.0, -55.0, 280.0, -95.0, 70.0, 290.0, 30.0, 90.0, 460.0, -5.0, 20.0, 100.0, 90.0, 10.0, 50.0, 250.0, 170.0, 340.0, 50.0, 50.0, 100.0, 50.0, 50.0, 140.0, 60.0, 110.0, 40.0, 250.0, 80.0, 150.0, 30.0, 60.0, 200.0, 30.0, 40.0, 70.0, -5.0, 30.0, 20.0, 50.0, 110.0, 0.0, 0.0, 60.0, 130.0, 5.0, 30.0, 50.0, 150.0, 60.0, 10.0, 110.0, 110.0, 30.0, 300.0, 0.0, 100.0, 80.0, 90.0, 460.0, 60.0, 230.0, 240.0, 60.0, 60.0, 200.0, 50.0, 20.0, 10.0, 80.0, 30.0, 20.0, 110.0, 20.0, 10.0, 170.0, 40.0, 230.0, 50.0, 90.0, 220.0, 360.0, 70.0, 40.0, 140.0, 130.0, 40.0, 50.0, 50.0, 10.0, 320.0, 30.0, 40.0, 40.0, 20.0, 30.0, 30.0, 40.0, 160.0, 0.0, 40.0, 140.0, 40.0, 300.0, 50.0, 110.0, 0.0, 10.0, 50.0, 100.0, 240.0, 100.0, 160.0, 150.0, -10.0, 530.0, 50.0, 410.0, 40.0, 20.0, -130.0, 30.0, 10.0, 90.0, 40.0, 20.0, 230.0, -50.0, 490.0, 60.0, 140.0, 40.0, 90.0, 200.0, 30.0, 150.0, 90.0, 80.0, 40.0, 160.0, 40.0, 50.0, 140.0, 70.0, 10.0, 190.0, 20.0, 10.0, 60.0, 70.0, 40.0, 10.0, 20.0, 20.0, 500.0, 0.0, 0.0, -55.0, 50.0, 100.0, 160.0, 10.0, 120.0, 550.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 160.0, 210.0, 120.0, 180.0, 70.0, 110.0, 50.0, 70.0, 340.0, 190.0, 80.0, 110.0, 160.0, -10.0, 410.0, -10.0, 770.0, 15.0, 90.0, 180.0, 110.0, 90.0, 190.0, 80.0, 190.0, 160.0, 140.0, 170.0, 350.0, 120.0, 90.0, 10.0, 0.0, 20.0, 170.0, 130.0, 100.0, 150.0, 100.0, 50.0, -50.0, -5.0, 260.0, 70.0, 200.0, 40.0, 20.0, 10.0, 20.0, 40.0, 80.0, 180.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 10.0, 100.0, 20.0, 30.0, 390.0, 40.0, 40.0, 130.0, 170.0, 60.0, -50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 380.0, 30.0, 120.0, 50.0, 100.0, 10.0, 0.0, 10.0, 20.0, 30.0, 40.0, 180.0, 170.0, 30.0, 160.0, 730.0, 50.0, 0.0, 90.0, 610.0, 130.0, 40.0, 50.0, 40.0, 120.0, 50.0, 370.0, 10.0, 70.0, 260.0, 20.0, 10.0, -20.0, 120.0, 10.0, 40.0, 90.0, 30.0, 130.0, 60.0, 350.0, 80.0, 10.0, -25.0, 40.0, 170.0, 190.0, 30.0, 100.0, 60.0, 70.0, 70.0, 40.0, 610.0, 40.0, 25.0, 40.0, 120.0, 40.0, 35.0, 40.0, 20.0, 100.0, 350.0, 30.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 170.0, 80.0, 50.0, 30.0, 40.0, 0.0, 100.0, -30.0, 380.0, 30.0, 60.0, 90.0, 90.0, 240.0, 340.0, 190.0, 80.0, 80.0, 60.0, 200.0, 140.0, 70.0, 0.0, 10.0, 10.0, 80.0, 20.0, 20.0, 390.0, 25.0, 130.0, 30.0, 50.0, 50.0, 80.0, 40.0, 80.0, 30.0, 150.0, 120.0, 30.0, 10.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 90.0, 390.0, 230.0, -10.0, 130.0, 70.0, 210.0, 70.0, 80.0, 120.0, 30.0, 90.0, 390.0, 80.0, 20.0, 60.0, 40.0, 250.0, 5.0, 90.0, 520.0, 90.0, 10.0, 30.0, 40.0, 40.0, 250.0, 150.0, 60.0, 30.0, 0.0, 40.0, 40.0, -60.0, 170.0, 90.0, 20.0, 10.0, 260.0, 10.0, 40.0, 130.0, 170.0, 80.0, 180.0, 10.0, 20.0, 70.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5060794010909202, "mean_inference_ms": 1.4130126288678249, "mean_action_processing_ms": 0.4245353817576772, "mean_env_wait_ms": 1.2499815154931562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012362480163574219, "StateBufferConnector_ms": 0.009361028671264648, "ViewRequirementAgentConnector_ms": 0.38846755027770996}, "num_episodes": 22, "episode_return_max": 1900.0, "episode_return_min": 145.0, "episode_return_mean": 934.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.643925055987793, "num_env_steps_trained_throughput_per_sec": 21.643925055987793, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 4320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4320000, "timers": {"training_iteration_time_ms": 186588.754, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186588.71, "sample_time_ms": 2445.424, "learn_time_ms": 184123.929, "learn_throughput": 21.724, "synch_weights_time_ms": 11.698}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "done": false, "training_iteration": 108, "trial_id": "90816_00000", "date": "2024-06-10_05-50-16", "timestamp": 1718013016, "time_this_iter_s": 184.81680727005005, "time_total_s": 20293.143701553345, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b008e310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20293.143701553345, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 17.916091954022985, "ram_util_percent": 78.70498084291188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5058136246455742, "cur_kl_coeff": 5.845177845843138, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004083023080961825, "vf_loss": 7.50671404786765, "vf_explained_var": 7.740318203886477e-05, "kl": Infinity, "entropy": 0.3347885315124981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1018815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 150.0, "episode_reward_mean": 937.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 93.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [900.0, 1575.0, 355.0, 420.0, 1545.0, 230.0, 860.0, 560.0, 1130.0, 860.0, 1450.0, 350.0, 680.0, 740.0, 610.0, 690.0, 1140.0, 1005.0, 690.0, 1835.0, 1000.0, 480.0, 1200.0, 1100.0, 1375.0, 1120.0, 1115.0, 1500.0, 850.0, 680.0, 650.0, 530.0, 820.0, 380.0, 1065.0, 305.0, 570.0, 820.0, 1500.0, 790.0, 1235.0, 990.0, 905.0, 435.0, 920.0, 1530.0, 510.0, 1370.0, 620.0, 880.0, 1380.0, 760.0, 1240.0, 800.0, 730.0, 1065.0, 560.0, 1320.0, 1805.0, 1500.0, 665.0, 920.0, 190.0, 930.0, 660.0, 590.0, 1900.0, 1010.0, 775.0, 1380.0, 810.0, 150.0, 850.0, 1430.0, 765.0, 760.0, 200.0, 1300.0, 1085.0, 1280.0, 600.0, 790.0, 805.0, 1440.0, 505.0, 850.0, 1430.0, 525.0, 720.0, 680.0, 1045.0, 1520.0, 1150.0, 1410.0, 730.0, 1980.0, 890.0, 1240.0, 570.0, 1220.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 170.0, 20.0, 80.0, 110.0, 70.0, 80.0, 90.0, 90.0, 0.0, 480.0, 70.0, 20.0, 490.0, 140.0, 60.0, 65.0, 280.0, -20.0, -10.0, 50.0, 150.0, 10.0, 10.0, 50.0, 110.0, 95.0, 90.0, 30.0, -240.0, 10.0, 30.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 50.0, 240.0, 70.0, 45.0, 190.0, 0.0, 150.0, 270.0, 100.0, 360.0, 60.0, 300.0, 70.0, 10.0, 0.0, 20.0, 20.0, 50.0, 20.0, 30.0, 0.0, 10.0, 30.0, 90.0, 130.0, 90.0, 100.0, 50.0, 210.0, 60.0, 30.0, 70.0, 0.0, 160.0, 30.0, 50.0, 40.0, 20.0, 40.0, 90.0, 20.0, 110.0, 100.0, 70.0, 310.0, 80.0, 210.0, 80.0, 70.0, 60.0, 80.0, 70.0, -20.0, -40.0, 20.0, 90.0, -10.0, 110.0, 110.0, 490.0, 110.0, 0.0, 180.0, 60.0, 50.0, 80.0, 250.0, 110.0, 500.0, 70.0, 130.0, 20.0, 120.0, 30.0, 20.0, 0.0, 60.0, 40.0, -230.0, 250.0, 30.0, 30.0, 90.0, 30.0, 10.0, 90.0, 20.0, 10.0, 140.0, 20.0, 240.0, 30.0, 10.0, 20.0, 160.0, 10.0, 0.0, 240.0, 30.0, 10.0, 240.0, 20.0, 40.0, 60.0, 20.0, 60.0, 40.0, 100.0, 290.0, 0.0, 0.0, 0.0, 40.0, 90.0, 250.0, 0.0, 10.0, 40.0, 160.0, -30.0, 90.0, 40.0, 40.0, 120.0, 0.0, 90.0, 80.0, 280.0, 120.0, 290.0, 50.0, 70.0, 30.0, 10.0, 80.0, 320.0, 70.0, 60.0, 190.0, 100.0, 45.0, 100.0, 20.0, 70.0, 120.0, 20.0, 20.0, 310.0, 120.0, -20.0, 10.0, 20.0, 70.0, 290.0, -10.0, 70.0, 20.0, 190.0, 780.0, 195.0, 80.0, 150.0, 10.0, 30.0, 40.0, 260.0, 60.0, 340.0, 70.0, 30.0, 90.0, 70.0, 10.0, 120.0, 110.0, 30.0, 20.0, 20.0, 90.0, 10.0, 40.0, 30.0, 60.0, 30.0, 120.0, 40.0, 80.0, 170.0, 370.0, 130.0, 30.0, 170.0, -10.0, 30.0, 570.0, 30.0, 0.0, 390.0, 0.0, 10.0, 40.0, 40.0, -10.0, 310.0, 65.0, 130.0, 70.0, 140.0, -10.0, 80.0, 30.0, 570.0, 620.0, 260.0, 50.0, 20.0, -110.0, 30.0, 140.0, 0.0, 80.0, 30.0, 30.0, 130.0, 90.0, 20.0, 150.0, 25.0, 190.0, 260.0, 150.0, 70.0, 90.0, 20.0, 290.0, 360.0, 170.0, 10.0, 40.0, 10.0, 50.0, 460.0, 60.0, 320.0, 90.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 240.0, 150.0, 190.0, 20.0, 20.0, 140.0, 60.0, 0.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 180.0, 50.0, 90.0, 180.0, 40.0, 10.0, 0.0, -90.0, -50.0, 40.0, 250.0, 50.0, 90.0, -80.0, 150.0, 20.0, 150.0, 110.0, 60.0, 70.0, 50.0, 190.0, 0.0, 60.0, 220.0, -20.0, 80.0, 10.0, 50.0, 30.0, 20.0, 20.0, 60.0, 0.0, 40.0, 50.0, 100.0, 80.0, 160.0, 100.0, 0.0, 10.0, 10.0, 30.0, 330.0, -40.0, 385.0, 190.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 50.0, 50.0, -55.0, 150.0, 30.0, 40.0, 30.0, 40.0, 110.0, 70.0, 30.0, 30.0, 40.0, 30.0, 60.0, 20.0, 40.0, 160.0, 230.0, 10.0, 230.0, 0.0, 40.0, 60.0, 140.0, 140.0, 430.0, 0.0, 80.0, -20.0, 220.0, 160.0, 290.0, 100.0, 140.0, 20.0, 10.0, -55.0, 280.0, -95.0, 70.0, 290.0, 30.0, 90.0, 460.0, -5.0, 20.0, 100.0, 90.0, 10.0, 50.0, 250.0, 170.0, 340.0, 50.0, 50.0, 100.0, 50.0, 50.0, 140.0, 60.0, 110.0, 40.0, 250.0, 80.0, 150.0, 30.0, 60.0, 200.0, 30.0, 40.0, 70.0, -5.0, 30.0, 20.0, 50.0, 110.0, 0.0, 0.0, 60.0, 130.0, 5.0, 30.0, 50.0, 150.0, 60.0, 10.0, 110.0, 110.0, 30.0, 300.0, 0.0, 100.0, 80.0, 90.0, 460.0, 60.0, 230.0, 240.0, 60.0, 60.0, 200.0, 50.0, 20.0, 10.0, 80.0, 30.0, 20.0, 110.0, 20.0, 10.0, 170.0, 40.0, 230.0, 50.0, 90.0, 220.0, 360.0, 70.0, 40.0, 140.0, 130.0, 40.0, 50.0, 50.0, 10.0, 320.0, 30.0, 40.0, 40.0, 20.0, 30.0, 30.0, 40.0, 160.0, 0.0, 40.0, 140.0, 40.0, 300.0, 50.0, 110.0, 0.0, 10.0, 50.0, 100.0, 240.0, 100.0, 160.0, 150.0, -10.0, 530.0, 50.0, 410.0, 40.0, 20.0, -130.0, 30.0, 10.0, 90.0, 40.0, 20.0, 230.0, -50.0, 490.0, 60.0, 140.0, 40.0, 90.0, 200.0, 30.0, 150.0, 90.0, 80.0, 40.0, 160.0, 40.0, 50.0, 140.0, 70.0, 10.0, 190.0, 20.0, 10.0, 60.0, 70.0, 40.0, 10.0, 20.0, 20.0, 500.0, 0.0, 0.0, -55.0, 50.0, 100.0, 160.0, 10.0, 120.0, 550.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 160.0, 210.0, 120.0, 180.0, 70.0, 110.0, 50.0, 70.0, 340.0, 190.0, 80.0, 110.0, 160.0, -10.0, 410.0, -10.0, 770.0, 15.0, 90.0, 180.0, 110.0, 90.0, 190.0, 80.0, 190.0, 160.0, 140.0, 170.0, 350.0, 120.0, 90.0, 10.0, 0.0, 20.0, 170.0, 130.0, 100.0, 150.0, 100.0, 50.0, -50.0, -5.0, 260.0, 70.0, 200.0, 40.0, 20.0, 10.0, 20.0, 40.0, 80.0, 180.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 10.0, 100.0, 20.0, 30.0, 390.0, 40.0, 40.0, 130.0, 170.0, 60.0, -50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 380.0, 30.0, 120.0, 50.0, 100.0, 10.0, 0.0, 10.0, 20.0, 30.0, 40.0, 180.0, 170.0, 30.0, 160.0, 730.0, 50.0, 0.0, 90.0, 610.0, 130.0, 40.0, 50.0, 40.0, 120.0, 50.0, 370.0, 10.0, 70.0, 260.0, 20.0, 10.0, -20.0, 120.0, 10.0, 40.0, 90.0, 30.0, 130.0, 60.0, 350.0, 80.0, 10.0, -25.0, 40.0, 170.0, 190.0, 30.0, 100.0, 60.0, 70.0, 70.0, 40.0, 610.0, 40.0, 25.0, 40.0, 120.0, 40.0, 35.0, 40.0, 20.0, 100.0, 350.0, 30.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 170.0, 80.0, 50.0, 30.0, 40.0, 0.0, 100.0, -30.0, 380.0, 30.0, 60.0, 90.0, 90.0, 240.0, 340.0, 190.0, 80.0, 80.0, 60.0, 200.0, 140.0, 70.0, 0.0, 10.0, 10.0, 80.0, 20.0, 20.0, 390.0, 25.0, 130.0, 30.0, 50.0, 50.0, 80.0, 40.0, 80.0, 30.0, 150.0, 120.0, 30.0, 10.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 90.0, 390.0, 230.0, -10.0, 130.0, 70.0, 210.0, 70.0, 80.0, 120.0, 30.0, 90.0, 390.0, 80.0, 20.0, 60.0, 40.0, 250.0, 5.0, 90.0, 520.0, 90.0, 10.0, 30.0, 40.0, 40.0, 250.0, 150.0, 60.0, 30.0, 0.0, 40.0, 40.0, -60.0, 170.0, 90.0, 20.0, 10.0, 260.0, 10.0, 40.0, 130.0, 170.0, 80.0, 180.0, 10.0, 20.0, 70.0, 80.0, 80.0, 210.0, 30.0, 30.0, 360.0, 30.0, 10.0, 40.0, 40.0, -25.0, 20.0, 20.0, 0.0, 40.0, 60.0, 410.0, 110.0, 340.0, 440.0, 0.0, 5.0, 220.0, 5.0, 170.0, 40.0, -60.0, 40.0, -5.0, 10.0, 80.0, 10.0, 160.0, 190.0, 150.0, 110.0, 40.0, 20.0, 40.0, 20.0, 110.0, 30.0, 70.0, 290.0, 270.0, -30.0, 60.0, 300.0, 330.0, 90.0, 20.0, 40.0, 30.0, 20.0, -10.0, 110.0, -30.0, 40.0, 60.0, -85.0, 350.0, 320.0, 10.0, 20.0, 40.0, 60.0, -50.0, 50.0, 130.0, 100.0, 40.0, 20.0, 20.0, 210.0, 80.0, 30.0, 10.0, 20.0, 20.0, 210.0, 60.0, 40.0, 250.0, 160.0, -10.0, 120.0, 100.0, -20.0, -15.0, 150.0, 270.0, 70.0, 100.0, 490.0, 110.0, 110.0, 140.0, 50.0, 310.0, 100.0, 40.0, 70.0, 30.0, 750.0, 60.0, 140.0, 40.0, 30.0, 20.0, 50.0, -40.0, 140.0, 140.0, 70.0, 230.0, 330.0, 80.0, 120.0, 150.0, 40.0, 110.0, 10.0, 40.0, 20.0, 25.0, 240.0, 30.0, 140.0, 15.0, 180.0, 30.0, 100.0, 50.0, 270.0, 110.0, 320.0, 250.0, 60.0, 600.0, 80.0, 140.0, 110.0, 40.0, 50.0, 120.0, 0.0, 260.0, 120.0, 70.0, 20.0, 100.0, 70.0, 210.0, 200.0, 40.0, 220.0, 150.0, 270.0, 50.0, -10.0, 40.0, 0.0, 40.0, -80.0, 280.0, 160.0, 20.0, 20.0, 70.0, 60.0, 0.0, 40.0, 60.0, 190.0, 40.0, 30.0, 80.0, 240.0, 60.0, 490.0, -10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.505482296898153, "mean_inference_ms": 1.4127991586440225, "mean_action_processing_ms": 0.42417416319895684, "mean_env_wait_ms": 1.2497378581026246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012401342391967773, "StateBufferConnector_ms": 0.009409427642822266, "ViewRequirementAgentConnector_ms": 0.3887500762939453}, "num_episodes": 18, "episode_return_max": 1980.0, "episode_return_min": 150.0, "episode_return_mean": 937.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.610138100954366, "num_env_steps_trained_throughput_per_sec": 21.610138100954366, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 4360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4360000, "timers": {"training_iteration_time_ms": 186276.136, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186276.092, "sample_time_ms": 2413.898, "learn_time_ms": 183842.948, "learn_throughput": 21.758, "synch_weights_time_ms": 11.389}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "done": false, "training_iteration": 109, "trial_id": "90816_00000", "date": "2024-06-10_05-53-21", "timestamp": 1718013201, "time_this_iter_s": 185.1059708595276, "time_total_s": 20478.249672412872, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3157310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20478.249672412872, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 17.986259541984733, "ram_util_percent": 78.90458015267177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.987431807652576, "cur_kl_coeff": 8.767766768764703, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004119081335654036, "vf_loss": 6.796531725945437, "vf_explained_var": 0.0016025745449736476, "kl": Infinity, "entropy": 0.34695265939949166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1028205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 150.0, "episode_reward_mean": 963.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 96.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.0, 1835.0, 1000.0, 480.0, 1200.0, 1100.0, 1375.0, 1120.0, 1115.0, 1500.0, 850.0, 680.0, 650.0, 530.0, 820.0, 380.0, 1065.0, 305.0, 570.0, 820.0, 1500.0, 790.0, 1235.0, 990.0, 905.0, 435.0, 920.0, 1530.0, 510.0, 1370.0, 620.0, 880.0, 1380.0, 760.0, 1240.0, 800.0, 730.0, 1065.0, 560.0, 1320.0, 1805.0, 1500.0, 665.0, 920.0, 190.0, 930.0, 660.0, 590.0, 1900.0, 1010.0, 775.0, 1380.0, 810.0, 150.0, 850.0, 1430.0, 765.0, 760.0, 200.0, 1300.0, 1085.0, 1280.0, 600.0, 790.0, 805.0, 1440.0, 505.0, 850.0, 1430.0, 525.0, 720.0, 680.0, 1045.0, 1520.0, 1150.0, 1410.0, 730.0, 1980.0, 890.0, 1240.0, 570.0, 1220.0, 1300.0, 845.0, 990.0, 1045.0, 1000.0, 500.0, 980.0, 1230.0, 590.0, 580.0, 1455.0, 580.0, 1460.0, 970.0, 1160.0, 360.0, 1085.0, 1510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 70.0, 120.0, 20.0, 20.0, 310.0, 120.0, -20.0, 10.0, 20.0, 70.0, 290.0, -10.0, 70.0, 20.0, 190.0, 780.0, 195.0, 80.0, 150.0, 10.0, 30.0, 40.0, 260.0, 60.0, 340.0, 70.0, 30.0, 90.0, 70.0, 10.0, 120.0, 110.0, 30.0, 20.0, 20.0, 90.0, 10.0, 40.0, 30.0, 60.0, 30.0, 120.0, 40.0, 80.0, 170.0, 370.0, 130.0, 30.0, 170.0, -10.0, 30.0, 570.0, 30.0, 0.0, 390.0, 0.0, 10.0, 40.0, 40.0, -10.0, 310.0, 65.0, 130.0, 70.0, 140.0, -10.0, 80.0, 30.0, 570.0, 620.0, 260.0, 50.0, 20.0, -110.0, 30.0, 140.0, 0.0, 80.0, 30.0, 30.0, 130.0, 90.0, 20.0, 150.0, 25.0, 190.0, 260.0, 150.0, 70.0, 90.0, 20.0, 290.0, 360.0, 170.0, 10.0, 40.0, 10.0, 50.0, 460.0, 60.0, 320.0, 90.0, 20.0, 20.0, 30.0, 30.0, 20.0, 20.0, 240.0, 150.0, 190.0, 20.0, 20.0, 140.0, 60.0, 0.0, 30.0, 30.0, 40.0, 40.0, 40.0, 20.0, 180.0, 50.0, 90.0, 180.0, 40.0, 10.0, 0.0, -90.0, -50.0, 40.0, 250.0, 50.0, 90.0, -80.0, 150.0, 20.0, 150.0, 110.0, 60.0, 70.0, 50.0, 190.0, 0.0, 60.0, 220.0, -20.0, 80.0, 10.0, 50.0, 30.0, 20.0, 20.0, 60.0, 0.0, 40.0, 50.0, 100.0, 80.0, 160.0, 100.0, 0.0, 10.0, 10.0, 30.0, 330.0, -40.0, 385.0, 190.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 50.0, 50.0, -55.0, 150.0, 30.0, 40.0, 30.0, 40.0, 110.0, 70.0, 30.0, 30.0, 40.0, 30.0, 60.0, 20.0, 40.0, 160.0, 230.0, 10.0, 230.0, 0.0, 40.0, 60.0, 140.0, 140.0, 430.0, 0.0, 80.0, -20.0, 220.0, 160.0, 290.0, 100.0, 140.0, 20.0, 10.0, -55.0, 280.0, -95.0, 70.0, 290.0, 30.0, 90.0, 460.0, -5.0, 20.0, 100.0, 90.0, 10.0, 50.0, 250.0, 170.0, 340.0, 50.0, 50.0, 100.0, 50.0, 50.0, 140.0, 60.0, 110.0, 40.0, 250.0, 80.0, 150.0, 30.0, 60.0, 200.0, 30.0, 40.0, 70.0, -5.0, 30.0, 20.0, 50.0, 110.0, 0.0, 0.0, 60.0, 130.0, 5.0, 30.0, 50.0, 150.0, 60.0, 10.0, 110.0, 110.0, 30.0, 300.0, 0.0, 100.0, 80.0, 90.0, 460.0, 60.0, 230.0, 240.0, 60.0, 60.0, 200.0, 50.0, 20.0, 10.0, 80.0, 30.0, 20.0, 110.0, 20.0, 10.0, 170.0, 40.0, 230.0, 50.0, 90.0, 220.0, 360.0, 70.0, 40.0, 140.0, 130.0, 40.0, 50.0, 50.0, 10.0, 320.0, 30.0, 40.0, 40.0, 20.0, 30.0, 30.0, 40.0, 160.0, 0.0, 40.0, 140.0, 40.0, 300.0, 50.0, 110.0, 0.0, 10.0, 50.0, 100.0, 240.0, 100.0, 160.0, 150.0, -10.0, 530.0, 50.0, 410.0, 40.0, 20.0, -130.0, 30.0, 10.0, 90.0, 40.0, 20.0, 230.0, -50.0, 490.0, 60.0, 140.0, 40.0, 90.0, 200.0, 30.0, 150.0, 90.0, 80.0, 40.0, 160.0, 40.0, 50.0, 140.0, 70.0, 10.0, 190.0, 20.0, 10.0, 60.0, 70.0, 40.0, 10.0, 20.0, 20.0, 500.0, 0.0, 0.0, -55.0, 50.0, 100.0, 160.0, 10.0, 120.0, 550.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 160.0, 210.0, 120.0, 180.0, 70.0, 110.0, 50.0, 70.0, 340.0, 190.0, 80.0, 110.0, 160.0, -10.0, 410.0, -10.0, 770.0, 15.0, 90.0, 180.0, 110.0, 90.0, 190.0, 80.0, 190.0, 160.0, 140.0, 170.0, 350.0, 120.0, 90.0, 10.0, 0.0, 20.0, 170.0, 130.0, 100.0, 150.0, 100.0, 50.0, -50.0, -5.0, 260.0, 70.0, 200.0, 40.0, 20.0, 10.0, 20.0, 40.0, 80.0, 180.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 10.0, 100.0, 20.0, 30.0, 390.0, 40.0, 40.0, 130.0, 170.0, 60.0, -50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 380.0, 30.0, 120.0, 50.0, 100.0, 10.0, 0.0, 10.0, 20.0, 30.0, 40.0, 180.0, 170.0, 30.0, 160.0, 730.0, 50.0, 0.0, 90.0, 610.0, 130.0, 40.0, 50.0, 40.0, 120.0, 50.0, 370.0, 10.0, 70.0, 260.0, 20.0, 10.0, -20.0, 120.0, 10.0, 40.0, 90.0, 30.0, 130.0, 60.0, 350.0, 80.0, 10.0, -25.0, 40.0, 170.0, 190.0, 30.0, 100.0, 60.0, 70.0, 70.0, 40.0, 610.0, 40.0, 25.0, 40.0, 120.0, 40.0, 35.0, 40.0, 20.0, 100.0, 350.0, 30.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 170.0, 80.0, 50.0, 30.0, 40.0, 0.0, 100.0, -30.0, 380.0, 30.0, 60.0, 90.0, 90.0, 240.0, 340.0, 190.0, 80.0, 80.0, 60.0, 200.0, 140.0, 70.0, 0.0, 10.0, 10.0, 80.0, 20.0, 20.0, 390.0, 25.0, 130.0, 30.0, 50.0, 50.0, 80.0, 40.0, 80.0, 30.0, 150.0, 120.0, 30.0, 10.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 90.0, 390.0, 230.0, -10.0, 130.0, 70.0, 210.0, 70.0, 80.0, 120.0, 30.0, 90.0, 390.0, 80.0, 20.0, 60.0, 40.0, 250.0, 5.0, 90.0, 520.0, 90.0, 10.0, 30.0, 40.0, 40.0, 250.0, 150.0, 60.0, 30.0, 0.0, 40.0, 40.0, -60.0, 170.0, 90.0, 20.0, 10.0, 260.0, 10.0, 40.0, 130.0, 170.0, 80.0, 180.0, 10.0, 20.0, 70.0, 80.0, 80.0, 210.0, 30.0, 30.0, 360.0, 30.0, 10.0, 40.0, 40.0, -25.0, 20.0, 20.0, 0.0, 40.0, 60.0, 410.0, 110.0, 340.0, 440.0, 0.0, 5.0, 220.0, 5.0, 170.0, 40.0, -60.0, 40.0, -5.0, 10.0, 80.0, 10.0, 160.0, 190.0, 150.0, 110.0, 40.0, 20.0, 40.0, 20.0, 110.0, 30.0, 70.0, 290.0, 270.0, -30.0, 60.0, 300.0, 330.0, 90.0, 20.0, 40.0, 30.0, 20.0, -10.0, 110.0, -30.0, 40.0, 60.0, -85.0, 350.0, 320.0, 10.0, 20.0, 40.0, 60.0, -50.0, 50.0, 130.0, 100.0, 40.0, 20.0, 20.0, 210.0, 80.0, 30.0, 10.0, 20.0, 20.0, 210.0, 60.0, 40.0, 250.0, 160.0, -10.0, 120.0, 100.0, -20.0, -15.0, 150.0, 270.0, 70.0, 100.0, 490.0, 110.0, 110.0, 140.0, 50.0, 310.0, 100.0, 40.0, 70.0, 30.0, 750.0, 60.0, 140.0, 40.0, 30.0, 20.0, 50.0, -40.0, 140.0, 140.0, 70.0, 230.0, 330.0, 80.0, 120.0, 150.0, 40.0, 110.0, 10.0, 40.0, 20.0, 25.0, 240.0, 30.0, 140.0, 15.0, 180.0, 30.0, 100.0, 50.0, 270.0, 110.0, 320.0, 250.0, 60.0, 600.0, 80.0, 140.0, 110.0, 40.0, 50.0, 120.0, 0.0, 260.0, 120.0, 70.0, 20.0, 100.0, 70.0, 210.0, 200.0, 40.0, 220.0, 150.0, 270.0, 50.0, -10.0, 40.0, 0.0, 40.0, -80.0, 280.0, 160.0, 20.0, 20.0, 70.0, 60.0, 0.0, 40.0, 60.0, 190.0, 40.0, 30.0, 80.0, 240.0, 60.0, 490.0, -10.0, 280.0, 170.0, 250.0, 230.0, 70.0, 60.0, 180.0, 60.0, 10.0, -10.0, 160.0, 20.0, 35.0, 250.0, -15.0, 25.0, 20.0, 10.0, 310.0, 30.0, 80.0, 80.0, 10.0, 30.0, 70.0, 260.0, 50.0, 60.0, 230.0, 120.0, 80.0, 90.0, 30.0, 50.0, 40.0, 130.0, 210.0, 175.0, 200.0, 40.0, 130.0, 100.0, 190.0, 120.0, 30.0, 40.0, 170.0, 80.0, 40.0, 100.0, 0.0, 0.0, 50.0, 10.0, 170.0, 10.0, 20.0, 30.0, 80.0, 130.0, 100.0, 40.0, 100.0, 510.0, 50.0, 60.0, 10.0, 20.0, 20.0, 70.0, 360.0, 190.0, 30.0, 0.0, -30.0, 10.0, 30.0, 70.0, 300.0, 270.0, 0.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 140.0, 80.0, 100.0, 120.0, 40.0, 40.0, 10.0, 100.0, 0.0, 170.0, 30.0, 40.0, 30.0, 90.0, 170.0, 120.0, 150.0, -25.0, 50.0, 90.0, 360.0, 70.0, 380.0, 40.0, 190.0, 30.0, 20.0, 40.0, 80.0, 60.0, 0.0, 0.0, 120.0, 0.0, 750.0, 20.0, 30.0, 40.0, 40.0, 180.0, 270.0, 20.0, 110.0, 70.0, 70.0, 190.0, 140.0, 180.0, 30.0, 80.0, 20.0, 140.0, 50.0, 20.0, 90.0, 180.0, 20.0, 0.0, 90.0, 20.0, 30.0, 530.0, 180.0, -15.0, 5.0, 40.0, 70.0, 80.0, 100.0, 40.0, 10.0, 40.0, -10.0, 80.0, 190.0, 180.0, 80.0, 70.0, 50.0, 400.0, 35.0, -80.0, 80.0, 300.0, 110.0, 220.0, 120.0, 10.0, 380.0, 120.0, 60.0, 180.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5046760202035065, "mean_inference_ms": 1.412592644680142, "mean_action_processing_ms": 0.4238257559099525, "mean_env_wait_ms": 1.249499430026293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012167930603027344, "StateBufferConnector_ms": 0.009343147277832031, "ViewRequirementAgentConnector_ms": 0.37909436225891113}, "num_episodes": 18, "episode_return_max": 1980.0, "episode_return_min": 150.0, "episode_return_mean": 963.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.354258786508222, "num_env_steps_trained_throughput_per_sec": 21.354258786508222, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 4400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4400000, "timers": {"training_iteration_time_ms": 186211.844, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186211.8, "sample_time_ms": 2395.967, "learn_time_ms": 183795.986, "learn_throughput": 21.763, "synch_weights_time_ms": 11.982}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "done": false, "training_iteration": 110, "trial_id": "90816_00000", "date": "2024-06-10_05-56-28", "timestamp": 1718013388, "time_this_iter_s": 187.32662415504456, "time_total_s": 20665.576296567917, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b008e3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20665.576296567917, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 19.82, "ram_util_percent": 79.53509433962265}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4655617544318416, "cur_kl_coeff": 13.151650153147054, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002909618737652136, "vf_loss": 7.312765856875906, "vf_explained_var": -0.0002231000076594571, "kl": Infinity, "entropy": 0.3404591847516604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1037595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 150.0, "episode_reward_mean": 994.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 99.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [990.0, 905.0, 435.0, 920.0, 1530.0, 510.0, 1370.0, 620.0, 880.0, 1380.0, 760.0, 1240.0, 800.0, 730.0, 1065.0, 560.0, 1320.0, 1805.0, 1500.0, 665.0, 920.0, 190.0, 930.0, 660.0, 590.0, 1900.0, 1010.0, 775.0, 1380.0, 810.0, 150.0, 850.0, 1430.0, 765.0, 760.0, 200.0, 1300.0, 1085.0, 1280.0, 600.0, 790.0, 805.0, 1440.0, 505.0, 850.0, 1430.0, 525.0, 720.0, 680.0, 1045.0, 1520.0, 1150.0, 1410.0, 730.0, 1980.0, 890.0, 1240.0, 570.0, 1220.0, 1300.0, 845.0, 990.0, 1045.0, 1000.0, 500.0, 980.0, 1230.0, 590.0, 580.0, 1455.0, 580.0, 1460.0, 970.0, 1160.0, 360.0, 1085.0, 1510.0, 1570.0, 635.0, 555.0, 1120.0, 730.0, 1350.0, 960.0, 530.0, 1690.0, 1280.0, 1420.0, 980.0, 950.0, 1270.0, 1250.0, 1190.0, 820.0, 280.0, 1260.0, 840.0, 1720.0, 1280.0, 1040.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [340.0, 50.0, 50.0, 100.0, 50.0, 50.0, 140.0, 60.0, 110.0, 40.0, 250.0, 80.0, 150.0, 30.0, 60.0, 200.0, 30.0, 40.0, 70.0, -5.0, 30.0, 20.0, 50.0, 110.0, 0.0, 0.0, 60.0, 130.0, 5.0, 30.0, 50.0, 150.0, 60.0, 10.0, 110.0, 110.0, 30.0, 300.0, 0.0, 100.0, 80.0, 90.0, 460.0, 60.0, 230.0, 240.0, 60.0, 60.0, 200.0, 50.0, 20.0, 10.0, 80.0, 30.0, 20.0, 110.0, 20.0, 10.0, 170.0, 40.0, 230.0, 50.0, 90.0, 220.0, 360.0, 70.0, 40.0, 140.0, 130.0, 40.0, 50.0, 50.0, 10.0, 320.0, 30.0, 40.0, 40.0, 20.0, 30.0, 30.0, 40.0, 160.0, 0.0, 40.0, 140.0, 40.0, 300.0, 50.0, 110.0, 0.0, 10.0, 50.0, 100.0, 240.0, 100.0, 160.0, 150.0, -10.0, 530.0, 50.0, 410.0, 40.0, 20.0, -130.0, 30.0, 10.0, 90.0, 40.0, 20.0, 230.0, -50.0, 490.0, 60.0, 140.0, 40.0, 90.0, 200.0, 30.0, 150.0, 90.0, 80.0, 40.0, 160.0, 40.0, 50.0, 140.0, 70.0, 10.0, 190.0, 20.0, 10.0, 60.0, 70.0, 40.0, 10.0, 20.0, 20.0, 500.0, 0.0, 0.0, -55.0, 50.0, 100.0, 160.0, 10.0, 120.0, 550.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 160.0, 210.0, 120.0, 180.0, 70.0, 110.0, 50.0, 70.0, 340.0, 190.0, 80.0, 110.0, 160.0, -10.0, 410.0, -10.0, 770.0, 15.0, 90.0, 180.0, 110.0, 90.0, 190.0, 80.0, 190.0, 160.0, 140.0, 170.0, 350.0, 120.0, 90.0, 10.0, 0.0, 20.0, 170.0, 130.0, 100.0, 150.0, 100.0, 50.0, -50.0, -5.0, 260.0, 70.0, 200.0, 40.0, 20.0, 10.0, 20.0, 40.0, 80.0, 180.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 10.0, 100.0, 20.0, 30.0, 390.0, 40.0, 40.0, 130.0, 170.0, 60.0, -50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 380.0, 30.0, 120.0, 50.0, 100.0, 10.0, 0.0, 10.0, 20.0, 30.0, 40.0, 180.0, 170.0, 30.0, 160.0, 730.0, 50.0, 0.0, 90.0, 610.0, 130.0, 40.0, 50.0, 40.0, 120.0, 50.0, 370.0, 10.0, 70.0, 260.0, 20.0, 10.0, -20.0, 120.0, 10.0, 40.0, 90.0, 30.0, 130.0, 60.0, 350.0, 80.0, 10.0, -25.0, 40.0, 170.0, 190.0, 30.0, 100.0, 60.0, 70.0, 70.0, 40.0, 610.0, 40.0, 25.0, 40.0, 120.0, 40.0, 35.0, 40.0, 20.0, 100.0, 350.0, 30.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 170.0, 80.0, 50.0, 30.0, 40.0, 0.0, 100.0, -30.0, 380.0, 30.0, 60.0, 90.0, 90.0, 240.0, 340.0, 190.0, 80.0, 80.0, 60.0, 200.0, 140.0, 70.0, 0.0, 10.0, 10.0, 80.0, 20.0, 20.0, 390.0, 25.0, 130.0, 30.0, 50.0, 50.0, 80.0, 40.0, 80.0, 30.0, 150.0, 120.0, 30.0, 10.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 90.0, 390.0, 230.0, -10.0, 130.0, 70.0, 210.0, 70.0, 80.0, 120.0, 30.0, 90.0, 390.0, 80.0, 20.0, 60.0, 40.0, 250.0, 5.0, 90.0, 520.0, 90.0, 10.0, 30.0, 40.0, 40.0, 250.0, 150.0, 60.0, 30.0, 0.0, 40.0, 40.0, -60.0, 170.0, 90.0, 20.0, 10.0, 260.0, 10.0, 40.0, 130.0, 170.0, 80.0, 180.0, 10.0, 20.0, 70.0, 80.0, 80.0, 210.0, 30.0, 30.0, 360.0, 30.0, 10.0, 40.0, 40.0, -25.0, 20.0, 20.0, 0.0, 40.0, 60.0, 410.0, 110.0, 340.0, 440.0, 0.0, 5.0, 220.0, 5.0, 170.0, 40.0, -60.0, 40.0, -5.0, 10.0, 80.0, 10.0, 160.0, 190.0, 150.0, 110.0, 40.0, 20.0, 40.0, 20.0, 110.0, 30.0, 70.0, 290.0, 270.0, -30.0, 60.0, 300.0, 330.0, 90.0, 20.0, 40.0, 30.0, 20.0, -10.0, 110.0, -30.0, 40.0, 60.0, -85.0, 350.0, 320.0, 10.0, 20.0, 40.0, 60.0, -50.0, 50.0, 130.0, 100.0, 40.0, 20.0, 20.0, 210.0, 80.0, 30.0, 10.0, 20.0, 20.0, 210.0, 60.0, 40.0, 250.0, 160.0, -10.0, 120.0, 100.0, -20.0, -15.0, 150.0, 270.0, 70.0, 100.0, 490.0, 110.0, 110.0, 140.0, 50.0, 310.0, 100.0, 40.0, 70.0, 30.0, 750.0, 60.0, 140.0, 40.0, 30.0, 20.0, 50.0, -40.0, 140.0, 140.0, 70.0, 230.0, 330.0, 80.0, 120.0, 150.0, 40.0, 110.0, 10.0, 40.0, 20.0, 25.0, 240.0, 30.0, 140.0, 15.0, 180.0, 30.0, 100.0, 50.0, 270.0, 110.0, 320.0, 250.0, 60.0, 600.0, 80.0, 140.0, 110.0, 40.0, 50.0, 120.0, 0.0, 260.0, 120.0, 70.0, 20.0, 100.0, 70.0, 210.0, 200.0, 40.0, 220.0, 150.0, 270.0, 50.0, -10.0, 40.0, 0.0, 40.0, -80.0, 280.0, 160.0, 20.0, 20.0, 70.0, 60.0, 0.0, 40.0, 60.0, 190.0, 40.0, 30.0, 80.0, 240.0, 60.0, 490.0, -10.0, 280.0, 170.0, 250.0, 230.0, 70.0, 60.0, 180.0, 60.0, 10.0, -10.0, 160.0, 20.0, 35.0, 250.0, -15.0, 25.0, 20.0, 10.0, 310.0, 30.0, 80.0, 80.0, 10.0, 30.0, 70.0, 260.0, 50.0, 60.0, 230.0, 120.0, 80.0, 90.0, 30.0, 50.0, 40.0, 130.0, 210.0, 175.0, 200.0, 40.0, 130.0, 100.0, 190.0, 120.0, 30.0, 40.0, 170.0, 80.0, 40.0, 100.0, 0.0, 0.0, 50.0, 10.0, 170.0, 10.0, 20.0, 30.0, 80.0, 130.0, 100.0, 40.0, 100.0, 510.0, 50.0, 60.0, 10.0, 20.0, 20.0, 70.0, 360.0, 190.0, 30.0, 0.0, -30.0, 10.0, 30.0, 70.0, 300.0, 270.0, 0.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 140.0, 80.0, 100.0, 120.0, 40.0, 40.0, 10.0, 100.0, 0.0, 170.0, 30.0, 40.0, 30.0, 90.0, 170.0, 120.0, 150.0, -25.0, 50.0, 90.0, 360.0, 70.0, 380.0, 40.0, 190.0, 30.0, 20.0, 40.0, 80.0, 60.0, 0.0, 0.0, 120.0, 0.0, 750.0, 20.0, 30.0, 40.0, 40.0, 180.0, 270.0, 20.0, 110.0, 70.0, 70.0, 190.0, 140.0, 180.0, 30.0, 80.0, 20.0, 140.0, 50.0, 20.0, 90.0, 180.0, 20.0, 0.0, 90.0, 20.0, 30.0, 530.0, 180.0, -15.0, 5.0, 40.0, 70.0, 80.0, 100.0, 40.0, 10.0, 40.0, -10.0, 80.0, 190.0, 180.0, 80.0, 70.0, 50.0, 400.0, 35.0, -80.0, 80.0, 300.0, 110.0, 220.0, 120.0, 10.0, 380.0, 120.0, 60.0, 180.0, 10.0, 200.0, 120.0, 60.0, 40.0, 170.0, 170.0, 370.0, 80.0, 210.0, 150.0, 60.0, 40.0, 10.0, 150.0, 30.0, 170.0, 35.0, 10.0, 90.0, 40.0, 20.0, 40.0, 10.0, 10.0, 360.0, 30.0, 60.0, 0.0, 25.0, 0.0, 30.0, 70.0, -30.0, 70.0, 200.0, 50.0, 390.0, 160.0, 60.0, 120.0, 0.0, 210.0, 20.0, 100.0, 0.0, 20.0, 260.0, 30.0, 80.0, 10.0, 40.0, 30.0, 10.0, 320.0, 20.0, 110.0, 380.0, 150.0, 210.0, 80.0, 80.0, 50.0, 110.0, 470.0, 140.0, 90.0, 20.0, 30.0, -10.0, -20.0, 110.0, 70.0, 10.0, 160.0, 40.0, 0.0, 40.0, 30.0, 50.0, 20.0, 480.0, 170.0, 200.0, 30.0, 30.0, 70.0, 570.0, -40.0, 30.0, 150.0, 70.0, 540.0, 60.0, 50.0, 130.0, 100.0, 200.0, 80.0, 50.0, 0.0, 70.0, 70.0, 580.0, 410.0, -20.0, 130.0, 70.0, 20.0, 40.0, 50.0, -10.0, 420.0, 30.0, -20.0, 40.0, 30.0, 50.0, 360.0, 50.0, 30.0, 410.0, 50.0, 10.0, -30.0, 50.0, 10.0, 10.0, 110.0, 120.0, 210.0, 30.0, 380.0, 50.0, 30.0, 50.0, 60.0, 0.0, 100.0, 170.0, 400.0, 70.0, 130.0, 140.0, 40.0, 70.0, -100.0, 670.0, 180.0, 90.0, -40.0, 170.0, 45.0, 100.0, 80.0, 10.0, 30.0, 240.0, 20.0, 25.0, 470.0, 160.0, 160.0, 80.0, 30.0, 40.0, 100.0, 30.0, 30.0, 110.0, 80.0, 20.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 70.0, 40.0, 0.0, 560.0, -30.0, 200.0, 170.0, 30.0, 120.0, 10.0, 10.0, 40.0, 150.0, 20.0, 0.0, 80.0, 20.0, 180.0, 50.0, 30.0, 20.0, 20.0, 420.0, 230.0, 80.0, 60.0, 180.0, 20.0, 100.0, -20.0, 190.0, 540.0, 340.0, 110.0, 690.0, 10.0, 110.0, 80.0, 20.0, 140.0, 70.0, 10.0, 40.0, 50.0, 20.0, 170.0, 10.0, 20.0, 350.0, 90.0, 110.0, 120.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5037329207201682, "mean_inference_ms": 1.4125337948873165, "mean_action_processing_ms": 0.42341056322098675, "mean_env_wait_ms": 1.2492760275313506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012552022933959961, "StateBufferConnector_ms": 0.009796380996704102, "ViewRequirementAgentConnector_ms": 0.38929057121276855}, "num_episodes": 23, "episode_return_max": 1980.0, "episode_return_min": 150.0, "episode_return_mean": 994.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.54880413967633, "num_env_steps_trained_throughput_per_sec": 21.54880413967633, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 4440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4440000, "timers": {"training_iteration_time_ms": 186067.952, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186067.907, "sample_time_ms": 2458.782, "learn_time_ms": 183589.226, "learn_throughput": 21.788, "synch_weights_time_ms": 11.749}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "done": false, "training_iteration": 111, "trial_id": "90816_00000", "date": "2024-06-10_05-59-34", "timestamp": 1718013574, "time_this_iter_s": 185.63690280914307, "time_total_s": 20851.21319937706, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3157ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20851.21319937706, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 17.216793893129772, "ram_util_percent": 78.60076335877864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5906483847239272, "cur_kl_coeff": 19.72747522972059, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002081341026348376, "vf_loss": 7.03506282515927, "vf_explained_var": 0.0010937632653659907, "kl": Infinity, "entropy": 0.33712465571551026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1046985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 150.0, "episode_reward_mean": 983.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -415.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 98.39}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1500.0, 665.0, 920.0, 190.0, 930.0, 660.0, 590.0, 1900.0, 1010.0, 775.0, 1380.0, 810.0, 150.0, 850.0, 1430.0, 765.0, 760.0, 200.0, 1300.0, 1085.0, 1280.0, 600.0, 790.0, 805.0, 1440.0, 505.0, 850.0, 1430.0, 525.0, 720.0, 680.0, 1045.0, 1520.0, 1150.0, 1410.0, 730.0, 1980.0, 890.0, 1240.0, 570.0, 1220.0, 1300.0, 845.0, 990.0, 1045.0, 1000.0, 500.0, 980.0, 1230.0, 590.0, 580.0, 1455.0, 580.0, 1460.0, 970.0, 1160.0, 360.0, 1085.0, 1510.0, 1570.0, 635.0, 555.0, 1120.0, 730.0, 1350.0, 960.0, 530.0, 1690.0, 1280.0, 1420.0, 980.0, 950.0, 1270.0, 1250.0, 1190.0, 820.0, 280.0, 1260.0, 840.0, 1720.0, 1280.0, 1040.0, 650.0, 1240.0, 1435.0, 1270.0, 740.0, 1190.0, 1050.0, 1110.0, 920.0, 425.0, 690.0, 380.0, 1160.0, 1250.0, 1250.0, 810.0, 410.0, 800.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 80.0, 190.0, 160.0, 140.0, 170.0, 350.0, 120.0, 90.0, 10.0, 0.0, 20.0, 170.0, 130.0, 100.0, 150.0, 100.0, 50.0, -50.0, -5.0, 260.0, 70.0, 200.0, 40.0, 20.0, 10.0, 20.0, 40.0, 80.0, 180.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 10.0, 100.0, 20.0, 30.0, 390.0, 40.0, 40.0, 130.0, 170.0, 60.0, -50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 10.0, 380.0, 30.0, 120.0, 50.0, 100.0, 10.0, 0.0, 10.0, 20.0, 30.0, 40.0, 180.0, 170.0, 30.0, 160.0, 730.0, 50.0, 0.0, 90.0, 610.0, 130.0, 40.0, 50.0, 40.0, 120.0, 50.0, 370.0, 10.0, 70.0, 260.0, 20.0, 10.0, -20.0, 120.0, 10.0, 40.0, 90.0, 30.0, 130.0, 60.0, 350.0, 80.0, 10.0, -25.0, 40.0, 170.0, 190.0, 30.0, 100.0, 60.0, 70.0, 70.0, 40.0, 610.0, 40.0, 25.0, 40.0, 120.0, 40.0, 35.0, 40.0, 20.0, 100.0, 350.0, 30.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 170.0, 80.0, 50.0, 30.0, 40.0, 0.0, 100.0, -30.0, 380.0, 30.0, 60.0, 90.0, 90.0, 240.0, 340.0, 190.0, 80.0, 80.0, 60.0, 200.0, 140.0, 70.0, 0.0, 10.0, 10.0, 80.0, 20.0, 20.0, 390.0, 25.0, 130.0, 30.0, 50.0, 50.0, 80.0, 40.0, 80.0, 30.0, 150.0, 120.0, 30.0, 10.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 90.0, 390.0, 230.0, -10.0, 130.0, 70.0, 210.0, 70.0, 80.0, 120.0, 30.0, 90.0, 390.0, 80.0, 20.0, 60.0, 40.0, 250.0, 5.0, 90.0, 520.0, 90.0, 10.0, 30.0, 40.0, 40.0, 250.0, 150.0, 60.0, 30.0, 0.0, 40.0, 40.0, -60.0, 170.0, 90.0, 20.0, 10.0, 260.0, 10.0, 40.0, 130.0, 170.0, 80.0, 180.0, 10.0, 20.0, 70.0, 80.0, 80.0, 210.0, 30.0, 30.0, 360.0, 30.0, 10.0, 40.0, 40.0, -25.0, 20.0, 20.0, 0.0, 40.0, 60.0, 410.0, 110.0, 340.0, 440.0, 0.0, 5.0, 220.0, 5.0, 170.0, 40.0, -60.0, 40.0, -5.0, 10.0, 80.0, 10.0, 160.0, 190.0, 150.0, 110.0, 40.0, 20.0, 40.0, 20.0, 110.0, 30.0, 70.0, 290.0, 270.0, -30.0, 60.0, 300.0, 330.0, 90.0, 20.0, 40.0, 30.0, 20.0, -10.0, 110.0, -30.0, 40.0, 60.0, -85.0, 350.0, 320.0, 10.0, 20.0, 40.0, 60.0, -50.0, 50.0, 130.0, 100.0, 40.0, 20.0, 20.0, 210.0, 80.0, 30.0, 10.0, 20.0, 20.0, 210.0, 60.0, 40.0, 250.0, 160.0, -10.0, 120.0, 100.0, -20.0, -15.0, 150.0, 270.0, 70.0, 100.0, 490.0, 110.0, 110.0, 140.0, 50.0, 310.0, 100.0, 40.0, 70.0, 30.0, 750.0, 60.0, 140.0, 40.0, 30.0, 20.0, 50.0, -40.0, 140.0, 140.0, 70.0, 230.0, 330.0, 80.0, 120.0, 150.0, 40.0, 110.0, 10.0, 40.0, 20.0, 25.0, 240.0, 30.0, 140.0, 15.0, 180.0, 30.0, 100.0, 50.0, 270.0, 110.0, 320.0, 250.0, 60.0, 600.0, 80.0, 140.0, 110.0, 40.0, 50.0, 120.0, 0.0, 260.0, 120.0, 70.0, 20.0, 100.0, 70.0, 210.0, 200.0, 40.0, 220.0, 150.0, 270.0, 50.0, -10.0, 40.0, 0.0, 40.0, -80.0, 280.0, 160.0, 20.0, 20.0, 70.0, 60.0, 0.0, 40.0, 60.0, 190.0, 40.0, 30.0, 80.0, 240.0, 60.0, 490.0, -10.0, 280.0, 170.0, 250.0, 230.0, 70.0, 60.0, 180.0, 60.0, 10.0, -10.0, 160.0, 20.0, 35.0, 250.0, -15.0, 25.0, 20.0, 10.0, 310.0, 30.0, 80.0, 80.0, 10.0, 30.0, 70.0, 260.0, 50.0, 60.0, 230.0, 120.0, 80.0, 90.0, 30.0, 50.0, 40.0, 130.0, 210.0, 175.0, 200.0, 40.0, 130.0, 100.0, 190.0, 120.0, 30.0, 40.0, 170.0, 80.0, 40.0, 100.0, 0.0, 0.0, 50.0, 10.0, 170.0, 10.0, 20.0, 30.0, 80.0, 130.0, 100.0, 40.0, 100.0, 510.0, 50.0, 60.0, 10.0, 20.0, 20.0, 70.0, 360.0, 190.0, 30.0, 0.0, -30.0, 10.0, 30.0, 70.0, 300.0, 270.0, 0.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 140.0, 80.0, 100.0, 120.0, 40.0, 40.0, 10.0, 100.0, 0.0, 170.0, 30.0, 40.0, 30.0, 90.0, 170.0, 120.0, 150.0, -25.0, 50.0, 90.0, 360.0, 70.0, 380.0, 40.0, 190.0, 30.0, 20.0, 40.0, 80.0, 60.0, 0.0, 0.0, 120.0, 0.0, 750.0, 20.0, 30.0, 40.0, 40.0, 180.0, 270.0, 20.0, 110.0, 70.0, 70.0, 190.0, 140.0, 180.0, 30.0, 80.0, 20.0, 140.0, 50.0, 20.0, 90.0, 180.0, 20.0, 0.0, 90.0, 20.0, 30.0, 530.0, 180.0, -15.0, 5.0, 40.0, 70.0, 80.0, 100.0, 40.0, 10.0, 40.0, -10.0, 80.0, 190.0, 180.0, 80.0, 70.0, 50.0, 400.0, 35.0, -80.0, 80.0, 300.0, 110.0, 220.0, 120.0, 10.0, 380.0, 120.0, 60.0, 180.0, 10.0, 200.0, 120.0, 60.0, 40.0, 170.0, 170.0, 370.0, 80.0, 210.0, 150.0, 60.0, 40.0, 10.0, 150.0, 30.0, 170.0, 35.0, 10.0, 90.0, 40.0, 20.0, 40.0, 10.0, 10.0, 360.0, 30.0, 60.0, 0.0, 25.0, 0.0, 30.0, 70.0, -30.0, 70.0, 200.0, 50.0, 390.0, 160.0, 60.0, 120.0, 0.0, 210.0, 20.0, 100.0, 0.0, 20.0, 260.0, 30.0, 80.0, 10.0, 40.0, 30.0, 10.0, 320.0, 20.0, 110.0, 380.0, 150.0, 210.0, 80.0, 80.0, 50.0, 110.0, 470.0, 140.0, 90.0, 20.0, 30.0, -10.0, -20.0, 110.0, 70.0, 10.0, 160.0, 40.0, 0.0, 40.0, 30.0, 50.0, 20.0, 480.0, 170.0, 200.0, 30.0, 30.0, 70.0, 570.0, -40.0, 30.0, 150.0, 70.0, 540.0, 60.0, 50.0, 130.0, 100.0, 200.0, 80.0, 50.0, 0.0, 70.0, 70.0, 580.0, 410.0, -20.0, 130.0, 70.0, 20.0, 40.0, 50.0, -10.0, 420.0, 30.0, -20.0, 40.0, 30.0, 50.0, 360.0, 50.0, 30.0, 410.0, 50.0, 10.0, -30.0, 50.0, 10.0, 10.0, 110.0, 120.0, 210.0, 30.0, 380.0, 50.0, 30.0, 50.0, 60.0, 0.0, 100.0, 170.0, 400.0, 70.0, 130.0, 140.0, 40.0, 70.0, -100.0, 670.0, 180.0, 90.0, -40.0, 170.0, 45.0, 100.0, 80.0, 10.0, 30.0, 240.0, 20.0, 25.0, 470.0, 160.0, 160.0, 80.0, 30.0, 40.0, 100.0, 30.0, 30.0, 110.0, 80.0, 20.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 70.0, 40.0, 0.0, 560.0, -30.0, 200.0, 170.0, 30.0, 120.0, 10.0, 10.0, 40.0, 150.0, 20.0, 0.0, 80.0, 20.0, 180.0, 50.0, 30.0, 20.0, 20.0, 420.0, 230.0, 80.0, 60.0, 180.0, 20.0, 100.0, -20.0, 190.0, 540.0, 340.0, 110.0, 690.0, 10.0, 110.0, 80.0, 20.0, 140.0, 70.0, 10.0, 40.0, 50.0, 20.0, 170.0, 10.0, 20.0, 350.0, 90.0, 110.0, 120.0, 100.0, 90.0, 10.0, 80.0, 80.0, 60.0, 30.0, 150.0, -10.0, 150.0, 10.0, 90.0, 70.0, -10.0, -10.0, 240.0, 40.0, 280.0, 260.0, 120.0, 160.0, 240.0, 100.0, 250.0, 270.0, -15.0, 90.0, -10.0, 400.0, 140.0, -30.0, 110.0, 90.0, 60.0, 320.0, 60.0, 500.0, 20.0, 40.0, 0.0, 70.0, 160.0, 0.0, -30.0, 60.0, 40.0, 35.0, 20.0, -55.0, 10.0, 500.0, 0.0, 340.0, 70.0, -10.0, 250.0, 20.0, 0.0, 300.0, 150.0, 70.0, 120.0, 60.0, 230.0, 60.0, 40.0, 40.0, 220.0, 260.0, 0.0, 20.0, 20.0, 30.0, 40.0, 380.0, 170.0, 0.0, 10.0, 150.0, 180.0, 130.0, -50.0, 60.0, 30.0, 20.0, -130.0, 0.0, 520.0, 20.0, 200.0, 250.0, 100.0, 110.0, 150.0, 40.0, 80.0, 30.0, -415.0, 10.0, 150.0, 170.0, 120.0, 40.0, 10.0, 50.0, 190.0, -10.0, 30.0, 20.0, 180.0, 60.0, 70.0, 190.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 0.0, 0.0, 60.0, 50.0, 120.0, 200.0, 80.0, 40.0, 160.0, 210.0, 10.0, 230.0, 100.0, 90.0, 380.0, 10.0, 30.0, 400.0, 70.0, 30.0, 110.0, 30.0, 80.0, 20.0, 100.0, 10.0, 10.0, 10.0, 610.0, 30.0, 110.0, 270.0, 60.0, 20.0, 80.0, 10.0, 60.0, 180.0, 50.0, 20.0, 260.0, 70.0, 20.0, 30.0, 20.0, 50.0, 10.0, 150.0, 30.0, 10.0, 70.0, 20.0, 90.0, 100.0, 90.0, 100.0, 150.0, 60.0, 80.0, 50.0, 60.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5030794043639946, "mean_inference_ms": 1.4125974154861345, "mean_action_processing_ms": 0.42310448441415643, "mean_env_wait_ms": 1.2491272680548255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01218557357788086, "StateBufferConnector_ms": 0.00965118408203125, "ViewRequirementAgentConnector_ms": 0.37313389778137207}, "num_episodes": 18, "episode_return_max": 1980.0, "episode_return_min": 150.0, "episode_return_mean": 983.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.444614875902154, "num_env_steps_trained_throughput_per_sec": 21.444614875902154, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 4480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4480000, "timers": {"training_iteration_time_ms": 186118.767, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186118.722, "sample_time_ms": 2429.287, "learn_time_ms": 183668.838, "learn_throughput": 21.778, "synch_weights_time_ms": 12.081}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "done": false, "training_iteration": 112, "trial_id": "90816_00000", "date": "2024-06-10_06-02-40", "timestamp": 1718013760, "time_this_iter_s": 186.53832507133484, "time_total_s": 21037.751524448395, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0136d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21037.751524448395, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 18.200757575757574, "ram_util_percent": 78.71856060606059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.351987285126512, "cur_kl_coeff": 29.59121284458087, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002336791009692767, "vf_loss": 6.705762371290733, "vf_explained_var": 0.001650837714425799, "kl": Infinity, "entropy": 0.34810851641927665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1056375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "env_runners": {"episode_reward_max": 1980.0, "episode_reward_min": 280.0, "episode_reward_mean": 1011.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -415.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 101.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [790.0, 805.0, 1440.0, 505.0, 850.0, 1430.0, 525.0, 720.0, 680.0, 1045.0, 1520.0, 1150.0, 1410.0, 730.0, 1980.0, 890.0, 1240.0, 570.0, 1220.0, 1300.0, 845.0, 990.0, 1045.0, 1000.0, 500.0, 980.0, 1230.0, 590.0, 580.0, 1455.0, 580.0, 1460.0, 970.0, 1160.0, 360.0, 1085.0, 1510.0, 1570.0, 635.0, 555.0, 1120.0, 730.0, 1350.0, 960.0, 530.0, 1690.0, 1280.0, 1420.0, 980.0, 950.0, 1270.0, 1250.0, 1190.0, 820.0, 280.0, 1260.0, 840.0, 1720.0, 1280.0, 1040.0, 650.0, 1240.0, 1435.0, 1270.0, 740.0, 1190.0, 1050.0, 1110.0, 920.0, 425.0, 690.0, 380.0, 1160.0, 1250.0, 1250.0, 810.0, 410.0, 800.0, 1200.0, 1120.0, 340.0, 1140.0, 1390.0, 375.0, 930.0, 1180.0, 1630.0, 1170.0, 1680.0, 710.0, 885.0, 1630.0, 1155.0, 800.0, 1020.0, 865.0, 890.0, 1320.0, 630.0, 450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 130.0, 170.0, 80.0, 180.0, 10.0, 20.0, 70.0, 80.0, 80.0, 210.0, 30.0, 30.0, 360.0, 30.0, 10.0, 40.0, 40.0, -25.0, 20.0, 20.0, 0.0, 40.0, 60.0, 410.0, 110.0, 340.0, 440.0, 0.0, 5.0, 220.0, 5.0, 170.0, 40.0, -60.0, 40.0, -5.0, 10.0, 80.0, 10.0, 160.0, 190.0, 150.0, 110.0, 40.0, 20.0, 40.0, 20.0, 110.0, 30.0, 70.0, 290.0, 270.0, -30.0, 60.0, 300.0, 330.0, 90.0, 20.0, 40.0, 30.0, 20.0, -10.0, 110.0, -30.0, 40.0, 60.0, -85.0, 350.0, 320.0, 10.0, 20.0, 40.0, 60.0, -50.0, 50.0, 130.0, 100.0, 40.0, 20.0, 20.0, 210.0, 80.0, 30.0, 10.0, 20.0, 20.0, 210.0, 60.0, 40.0, 250.0, 160.0, -10.0, 120.0, 100.0, -20.0, -15.0, 150.0, 270.0, 70.0, 100.0, 490.0, 110.0, 110.0, 140.0, 50.0, 310.0, 100.0, 40.0, 70.0, 30.0, 750.0, 60.0, 140.0, 40.0, 30.0, 20.0, 50.0, -40.0, 140.0, 140.0, 70.0, 230.0, 330.0, 80.0, 120.0, 150.0, 40.0, 110.0, 10.0, 40.0, 20.0, 25.0, 240.0, 30.0, 140.0, 15.0, 180.0, 30.0, 100.0, 50.0, 270.0, 110.0, 320.0, 250.0, 60.0, 600.0, 80.0, 140.0, 110.0, 40.0, 50.0, 120.0, 0.0, 260.0, 120.0, 70.0, 20.0, 100.0, 70.0, 210.0, 200.0, 40.0, 220.0, 150.0, 270.0, 50.0, -10.0, 40.0, 0.0, 40.0, -80.0, 280.0, 160.0, 20.0, 20.0, 70.0, 60.0, 0.0, 40.0, 60.0, 190.0, 40.0, 30.0, 80.0, 240.0, 60.0, 490.0, -10.0, 280.0, 170.0, 250.0, 230.0, 70.0, 60.0, 180.0, 60.0, 10.0, -10.0, 160.0, 20.0, 35.0, 250.0, -15.0, 25.0, 20.0, 10.0, 310.0, 30.0, 80.0, 80.0, 10.0, 30.0, 70.0, 260.0, 50.0, 60.0, 230.0, 120.0, 80.0, 90.0, 30.0, 50.0, 40.0, 130.0, 210.0, 175.0, 200.0, 40.0, 130.0, 100.0, 190.0, 120.0, 30.0, 40.0, 170.0, 80.0, 40.0, 100.0, 0.0, 0.0, 50.0, 10.0, 170.0, 10.0, 20.0, 30.0, 80.0, 130.0, 100.0, 40.0, 100.0, 510.0, 50.0, 60.0, 10.0, 20.0, 20.0, 70.0, 360.0, 190.0, 30.0, 0.0, -30.0, 10.0, 30.0, 70.0, 300.0, 270.0, 0.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 140.0, 80.0, 100.0, 120.0, 40.0, 40.0, 10.0, 100.0, 0.0, 170.0, 30.0, 40.0, 30.0, 90.0, 170.0, 120.0, 150.0, -25.0, 50.0, 90.0, 360.0, 70.0, 380.0, 40.0, 190.0, 30.0, 20.0, 40.0, 80.0, 60.0, 0.0, 0.0, 120.0, 0.0, 750.0, 20.0, 30.0, 40.0, 40.0, 180.0, 270.0, 20.0, 110.0, 70.0, 70.0, 190.0, 140.0, 180.0, 30.0, 80.0, 20.0, 140.0, 50.0, 20.0, 90.0, 180.0, 20.0, 0.0, 90.0, 20.0, 30.0, 530.0, 180.0, -15.0, 5.0, 40.0, 70.0, 80.0, 100.0, 40.0, 10.0, 40.0, -10.0, 80.0, 190.0, 180.0, 80.0, 70.0, 50.0, 400.0, 35.0, -80.0, 80.0, 300.0, 110.0, 220.0, 120.0, 10.0, 380.0, 120.0, 60.0, 180.0, 10.0, 200.0, 120.0, 60.0, 40.0, 170.0, 170.0, 370.0, 80.0, 210.0, 150.0, 60.0, 40.0, 10.0, 150.0, 30.0, 170.0, 35.0, 10.0, 90.0, 40.0, 20.0, 40.0, 10.0, 10.0, 360.0, 30.0, 60.0, 0.0, 25.0, 0.0, 30.0, 70.0, -30.0, 70.0, 200.0, 50.0, 390.0, 160.0, 60.0, 120.0, 0.0, 210.0, 20.0, 100.0, 0.0, 20.0, 260.0, 30.0, 80.0, 10.0, 40.0, 30.0, 10.0, 320.0, 20.0, 110.0, 380.0, 150.0, 210.0, 80.0, 80.0, 50.0, 110.0, 470.0, 140.0, 90.0, 20.0, 30.0, -10.0, -20.0, 110.0, 70.0, 10.0, 160.0, 40.0, 0.0, 40.0, 30.0, 50.0, 20.0, 480.0, 170.0, 200.0, 30.0, 30.0, 70.0, 570.0, -40.0, 30.0, 150.0, 70.0, 540.0, 60.0, 50.0, 130.0, 100.0, 200.0, 80.0, 50.0, 0.0, 70.0, 70.0, 580.0, 410.0, -20.0, 130.0, 70.0, 20.0, 40.0, 50.0, -10.0, 420.0, 30.0, -20.0, 40.0, 30.0, 50.0, 360.0, 50.0, 30.0, 410.0, 50.0, 10.0, -30.0, 50.0, 10.0, 10.0, 110.0, 120.0, 210.0, 30.0, 380.0, 50.0, 30.0, 50.0, 60.0, 0.0, 100.0, 170.0, 400.0, 70.0, 130.0, 140.0, 40.0, 70.0, -100.0, 670.0, 180.0, 90.0, -40.0, 170.0, 45.0, 100.0, 80.0, 10.0, 30.0, 240.0, 20.0, 25.0, 470.0, 160.0, 160.0, 80.0, 30.0, 40.0, 100.0, 30.0, 30.0, 110.0, 80.0, 20.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 70.0, 40.0, 0.0, 560.0, -30.0, 200.0, 170.0, 30.0, 120.0, 10.0, 10.0, 40.0, 150.0, 20.0, 0.0, 80.0, 20.0, 180.0, 50.0, 30.0, 20.0, 20.0, 420.0, 230.0, 80.0, 60.0, 180.0, 20.0, 100.0, -20.0, 190.0, 540.0, 340.0, 110.0, 690.0, 10.0, 110.0, 80.0, 20.0, 140.0, 70.0, 10.0, 40.0, 50.0, 20.0, 170.0, 10.0, 20.0, 350.0, 90.0, 110.0, 120.0, 100.0, 90.0, 10.0, 80.0, 80.0, 60.0, 30.0, 150.0, -10.0, 150.0, 10.0, 90.0, 70.0, -10.0, -10.0, 240.0, 40.0, 280.0, 260.0, 120.0, 160.0, 240.0, 100.0, 250.0, 270.0, -15.0, 90.0, -10.0, 400.0, 140.0, -30.0, 110.0, 90.0, 60.0, 320.0, 60.0, 500.0, 20.0, 40.0, 0.0, 70.0, 160.0, 0.0, -30.0, 60.0, 40.0, 35.0, 20.0, -55.0, 10.0, 500.0, 0.0, 340.0, 70.0, -10.0, 250.0, 20.0, 0.0, 300.0, 150.0, 70.0, 120.0, 60.0, 230.0, 60.0, 40.0, 40.0, 220.0, 260.0, 0.0, 20.0, 20.0, 30.0, 40.0, 380.0, 170.0, 0.0, 10.0, 150.0, 180.0, 130.0, -50.0, 60.0, 30.0, 20.0, -130.0, 0.0, 520.0, 20.0, 200.0, 250.0, 100.0, 110.0, 150.0, 40.0, 80.0, 30.0, -415.0, 10.0, 150.0, 170.0, 120.0, 40.0, 10.0, 50.0, 190.0, -10.0, 30.0, 20.0, 180.0, 60.0, 70.0, 190.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 0.0, 0.0, 60.0, 50.0, 120.0, 200.0, 80.0, 40.0, 160.0, 210.0, 10.0, 230.0, 100.0, 90.0, 380.0, 10.0, 30.0, 400.0, 70.0, 30.0, 110.0, 30.0, 80.0, 20.0, 100.0, 10.0, 10.0, 10.0, 610.0, 30.0, 110.0, 270.0, 60.0, 20.0, 80.0, 10.0, 60.0, 180.0, 50.0, 20.0, 260.0, 70.0, 20.0, 30.0, 20.0, 50.0, 10.0, 150.0, 30.0, 10.0, 70.0, 20.0, 90.0, 100.0, 90.0, 100.0, 150.0, 60.0, 80.0, 50.0, 60.0, 20.0, 230.0, 90.0, 390.0, 110.0, 30.0, 120.0, -30.0, 210.0, 220.0, -170.0, 40.0, 340.0, 150.0, 60.0, 70.0, 20.0, 30.0, 70.0, 60.0, 280.0, 10.0, 70.0, 10.0, 30.0, 20.0, 40.0, 30.0, 10.0, 110.0, 10.0, 180.0, 90.0, 60.0, 60.0, 20.0, 150.0, 110.0, 180.0, 270.0, 20.0, 70.0, 190.0, -80.0, 70.0, 90.0, 100.0, 590.0, 20.0, -30.0, 370.0, 30.0, 80.0, 20.0, 20.0, 10.0, 150.0, 25.0, 10.0, 10.0, 20.0, 0.0, 60.0, 10.0, 110.0, 100.0, 100.0, 50.0, 40.0, 220.0, 240.0, 120.0, 40.0, 0.0, 60.0, 110.0, 200.0, 100.0, 70.0, 320.0, 160.0, 80.0, -20.0, 280.0, 300.0, 60.0, 370.0, 220.0, 180.0, 110.0, 50.0, 210.0, 280.0, 60.0, 160.0, 60.0, 20.0, 90.0, 70.0, 60.0, 160.0, 520.0, 270.0, 80.0, 100.0, 360.0, 10.0, 40.0, 40.0, 180.0, 80.0, 60.0, 80.0, 190.0, 30.0, 210.0, 40.0, 10.0, 50.0, 20.0, 20.0, 190.0, 250.0, 40.0, 10.0, 25.0, -50.0, 0.0, -10.0, 230.0, 200.0, 50.0, 60.0, 0.0, 300.0, 350.0, 70.0, 150.0, 70.0, 500.0, 80.0, 290.0, 200.0, 30.0, 40.0, 140.0, 150.0, 50.0, 70.0, 155.0, 30.0, 120.0, 10.0, 20.0, 280.0, 50.0, 30.0, 210.0, 50.0, 10.0, 20.0, 210.0, 130.0, 50.0, 40.0, 10.0, 150.0, 30.0, 50.0, 130.0, 220.0, -10.0, 20.0, 40.0, 90.0, -70.0, 695.0, -40.0, 100.0, 110.0, -70.0, 260.0, 40.0, 30.0, 20.0, 90.0, 0.0, 20.0, 190.0, 180.0, 60.0, 70.0, 70.0, 120.0, 160.0, 110.0, 10.0, 260.0, 280.0, 70.0, 170.0, 10.0, 50.0, 130.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 370.0, 20.0, 170.0, 60.0, 20.0, 10.0, 10.0, 0.0, 30.0, 20.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5021983057511945, "mean_inference_ms": 1.4126570673571615, "mean_action_processing_ms": 0.4228067851551743, "mean_env_wait_ms": 1.2490519577574823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013176679611206055, "StateBufferConnector_ms": 0.01030278205871582, "ViewRequirementAgentConnector_ms": 0.38845205307006836}, "num_episodes": 22, "episode_return_max": 1980.0, "episode_return_min": 280.0, "episode_return_mean": 1011.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.55286610400943, "num_env_steps_trained_throughput_per_sec": 21.55286610400943, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 4520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4520000, "timers": {"training_iteration_time_ms": 185889.76, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185889.715, "sample_time_ms": 2450.571, "learn_time_ms": 183418.534, "learn_throughput": 21.808, "synch_weights_time_ms": 12.07}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "done": false, "training_iteration": 113, "trial_id": "90816_00000", "date": "2024-06-10_06-05-46", "timestamp": 1718013946, "time_this_iter_s": 185.60229206085205, "time_total_s": 21223.353816509247, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3157280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21223.353816509247, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 18.264885496183204, "ram_util_percent": 78.57595419847328}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.266359641084783, "cur_kl_coeff": 44.38681926687131, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0012823114525457335, "vf_loss": 7.114682433805781, "vf_explained_var": 0.0006811767657851766, "kl": Infinity, "entropy": 0.33463504769392033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1065765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "env_runners": {"episode_reward_max": 1720.0, "episode_reward_min": 265.0, "episode_reward_mean": 1020.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -415.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 102.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.0, 1300.0, 845.0, 990.0, 1045.0, 1000.0, 500.0, 980.0, 1230.0, 590.0, 580.0, 1455.0, 580.0, 1460.0, 970.0, 1160.0, 360.0, 1085.0, 1510.0, 1570.0, 635.0, 555.0, 1120.0, 730.0, 1350.0, 960.0, 530.0, 1690.0, 1280.0, 1420.0, 980.0, 950.0, 1270.0, 1250.0, 1190.0, 820.0, 280.0, 1260.0, 840.0, 1720.0, 1280.0, 1040.0, 650.0, 1240.0, 1435.0, 1270.0, 740.0, 1190.0, 1050.0, 1110.0, 920.0, 425.0, 690.0, 380.0, 1160.0, 1250.0, 1250.0, 810.0, 410.0, 800.0, 1200.0, 1120.0, 340.0, 1140.0, 1390.0, 375.0, 930.0, 1180.0, 1630.0, 1170.0, 1680.0, 710.0, 885.0, 1630.0, 1155.0, 800.0, 1020.0, 865.0, 890.0, 1320.0, 630.0, 450.0, 850.0, 1160.0, 1345.0, 600.0, 925.0, 1210.0, 900.0, 980.0, 850.0, 1565.0, 1590.0, 940.0, 1220.0, 1190.0, 1185.0, 1400.0, 265.0, 990.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 60.0, 190.0, 40.0, 30.0, 80.0, 240.0, 60.0, 490.0, -10.0, 280.0, 170.0, 250.0, 230.0, 70.0, 60.0, 180.0, 60.0, 10.0, -10.0, 160.0, 20.0, 35.0, 250.0, -15.0, 25.0, 20.0, 10.0, 310.0, 30.0, 80.0, 80.0, 10.0, 30.0, 70.0, 260.0, 50.0, 60.0, 230.0, 120.0, 80.0, 90.0, 30.0, 50.0, 40.0, 130.0, 210.0, 175.0, 200.0, 40.0, 130.0, 100.0, 190.0, 120.0, 30.0, 40.0, 170.0, 80.0, 40.0, 100.0, 0.0, 0.0, 50.0, 10.0, 170.0, 10.0, 20.0, 30.0, 80.0, 130.0, 100.0, 40.0, 100.0, 510.0, 50.0, 60.0, 10.0, 20.0, 20.0, 70.0, 360.0, 190.0, 30.0, 0.0, -30.0, 10.0, 30.0, 70.0, 300.0, 270.0, 0.0, 70.0, 10.0, 40.0, 50.0, 60.0, 40.0, 140.0, 80.0, 100.0, 120.0, 40.0, 40.0, 10.0, 100.0, 0.0, 170.0, 30.0, 40.0, 30.0, 90.0, 170.0, 120.0, 150.0, -25.0, 50.0, 90.0, 360.0, 70.0, 380.0, 40.0, 190.0, 30.0, 20.0, 40.0, 80.0, 60.0, 0.0, 0.0, 120.0, 0.0, 750.0, 20.0, 30.0, 40.0, 40.0, 180.0, 270.0, 20.0, 110.0, 70.0, 70.0, 190.0, 140.0, 180.0, 30.0, 80.0, 20.0, 140.0, 50.0, 20.0, 90.0, 180.0, 20.0, 0.0, 90.0, 20.0, 30.0, 530.0, 180.0, -15.0, 5.0, 40.0, 70.0, 80.0, 100.0, 40.0, 10.0, 40.0, -10.0, 80.0, 190.0, 180.0, 80.0, 70.0, 50.0, 400.0, 35.0, -80.0, 80.0, 300.0, 110.0, 220.0, 120.0, 10.0, 380.0, 120.0, 60.0, 180.0, 10.0, 200.0, 120.0, 60.0, 40.0, 170.0, 170.0, 370.0, 80.0, 210.0, 150.0, 60.0, 40.0, 10.0, 150.0, 30.0, 170.0, 35.0, 10.0, 90.0, 40.0, 20.0, 40.0, 10.0, 10.0, 360.0, 30.0, 60.0, 0.0, 25.0, 0.0, 30.0, 70.0, -30.0, 70.0, 200.0, 50.0, 390.0, 160.0, 60.0, 120.0, 0.0, 210.0, 20.0, 100.0, 0.0, 20.0, 260.0, 30.0, 80.0, 10.0, 40.0, 30.0, 10.0, 320.0, 20.0, 110.0, 380.0, 150.0, 210.0, 80.0, 80.0, 50.0, 110.0, 470.0, 140.0, 90.0, 20.0, 30.0, -10.0, -20.0, 110.0, 70.0, 10.0, 160.0, 40.0, 0.0, 40.0, 30.0, 50.0, 20.0, 480.0, 170.0, 200.0, 30.0, 30.0, 70.0, 570.0, -40.0, 30.0, 150.0, 70.0, 540.0, 60.0, 50.0, 130.0, 100.0, 200.0, 80.0, 50.0, 0.0, 70.0, 70.0, 580.0, 410.0, -20.0, 130.0, 70.0, 20.0, 40.0, 50.0, -10.0, 420.0, 30.0, -20.0, 40.0, 30.0, 50.0, 360.0, 50.0, 30.0, 410.0, 50.0, 10.0, -30.0, 50.0, 10.0, 10.0, 110.0, 120.0, 210.0, 30.0, 380.0, 50.0, 30.0, 50.0, 60.0, 0.0, 100.0, 170.0, 400.0, 70.0, 130.0, 140.0, 40.0, 70.0, -100.0, 670.0, 180.0, 90.0, -40.0, 170.0, 45.0, 100.0, 80.0, 10.0, 30.0, 240.0, 20.0, 25.0, 470.0, 160.0, 160.0, 80.0, 30.0, 40.0, 100.0, 30.0, 30.0, 110.0, 80.0, 20.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 70.0, 40.0, 0.0, 560.0, -30.0, 200.0, 170.0, 30.0, 120.0, 10.0, 10.0, 40.0, 150.0, 20.0, 0.0, 80.0, 20.0, 180.0, 50.0, 30.0, 20.0, 20.0, 420.0, 230.0, 80.0, 60.0, 180.0, 20.0, 100.0, -20.0, 190.0, 540.0, 340.0, 110.0, 690.0, 10.0, 110.0, 80.0, 20.0, 140.0, 70.0, 10.0, 40.0, 50.0, 20.0, 170.0, 10.0, 20.0, 350.0, 90.0, 110.0, 120.0, 100.0, 90.0, 10.0, 80.0, 80.0, 60.0, 30.0, 150.0, -10.0, 150.0, 10.0, 90.0, 70.0, -10.0, -10.0, 240.0, 40.0, 280.0, 260.0, 120.0, 160.0, 240.0, 100.0, 250.0, 270.0, -15.0, 90.0, -10.0, 400.0, 140.0, -30.0, 110.0, 90.0, 60.0, 320.0, 60.0, 500.0, 20.0, 40.0, 0.0, 70.0, 160.0, 0.0, -30.0, 60.0, 40.0, 35.0, 20.0, -55.0, 10.0, 500.0, 0.0, 340.0, 70.0, -10.0, 250.0, 20.0, 0.0, 300.0, 150.0, 70.0, 120.0, 60.0, 230.0, 60.0, 40.0, 40.0, 220.0, 260.0, 0.0, 20.0, 20.0, 30.0, 40.0, 380.0, 170.0, 0.0, 10.0, 150.0, 180.0, 130.0, -50.0, 60.0, 30.0, 20.0, -130.0, 0.0, 520.0, 20.0, 200.0, 250.0, 100.0, 110.0, 150.0, 40.0, 80.0, 30.0, -415.0, 10.0, 150.0, 170.0, 120.0, 40.0, 10.0, 50.0, 190.0, -10.0, 30.0, 20.0, 180.0, 60.0, 70.0, 190.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 0.0, 0.0, 60.0, 50.0, 120.0, 200.0, 80.0, 40.0, 160.0, 210.0, 10.0, 230.0, 100.0, 90.0, 380.0, 10.0, 30.0, 400.0, 70.0, 30.0, 110.0, 30.0, 80.0, 20.0, 100.0, 10.0, 10.0, 10.0, 610.0, 30.0, 110.0, 270.0, 60.0, 20.0, 80.0, 10.0, 60.0, 180.0, 50.0, 20.0, 260.0, 70.0, 20.0, 30.0, 20.0, 50.0, 10.0, 150.0, 30.0, 10.0, 70.0, 20.0, 90.0, 100.0, 90.0, 100.0, 150.0, 60.0, 80.0, 50.0, 60.0, 20.0, 230.0, 90.0, 390.0, 110.0, 30.0, 120.0, -30.0, 210.0, 220.0, -170.0, 40.0, 340.0, 150.0, 60.0, 70.0, 20.0, 30.0, 70.0, 60.0, 280.0, 10.0, 70.0, 10.0, 30.0, 20.0, 40.0, 30.0, 10.0, 110.0, 10.0, 180.0, 90.0, 60.0, 60.0, 20.0, 150.0, 110.0, 180.0, 270.0, 20.0, 70.0, 190.0, -80.0, 70.0, 90.0, 100.0, 590.0, 20.0, -30.0, 370.0, 30.0, 80.0, 20.0, 20.0, 10.0, 150.0, 25.0, 10.0, 10.0, 20.0, 0.0, 60.0, 10.0, 110.0, 100.0, 100.0, 50.0, 40.0, 220.0, 240.0, 120.0, 40.0, 0.0, 60.0, 110.0, 200.0, 100.0, 70.0, 320.0, 160.0, 80.0, -20.0, 280.0, 300.0, 60.0, 370.0, 220.0, 180.0, 110.0, 50.0, 210.0, 280.0, 60.0, 160.0, 60.0, 20.0, 90.0, 70.0, 60.0, 160.0, 520.0, 270.0, 80.0, 100.0, 360.0, 10.0, 40.0, 40.0, 180.0, 80.0, 60.0, 80.0, 190.0, 30.0, 210.0, 40.0, 10.0, 50.0, 20.0, 20.0, 190.0, 250.0, 40.0, 10.0, 25.0, -50.0, 0.0, -10.0, 230.0, 200.0, 50.0, 60.0, 0.0, 300.0, 350.0, 70.0, 150.0, 70.0, 500.0, 80.0, 290.0, 200.0, 30.0, 40.0, 140.0, 150.0, 50.0, 70.0, 155.0, 30.0, 120.0, 10.0, 20.0, 280.0, 50.0, 30.0, 210.0, 50.0, 10.0, 20.0, 210.0, 130.0, 50.0, 40.0, 10.0, 150.0, 30.0, 50.0, 130.0, 220.0, -10.0, 20.0, 40.0, 90.0, -70.0, 695.0, -40.0, 100.0, 110.0, -70.0, 260.0, 40.0, 30.0, 20.0, 90.0, 0.0, 20.0, 190.0, 180.0, 60.0, 70.0, 70.0, 120.0, 160.0, 110.0, 10.0, 260.0, 280.0, 70.0, 170.0, 10.0, 50.0, 130.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 370.0, 20.0, 170.0, 60.0, 20.0, 10.0, 10.0, 0.0, 30.0, 20.0, 110.0, 310.0, 40.0, 20.0, 300.0, 0.0, 10.0, 70.0, 50.0, 20.0, 30.0, 140.0, 280.0, 60.0, 180.0, 40.0, 220.0, 70.0, 30.0, 110.0, 30.0, 170.0, 360.0, 70.0, 70.0, -45.0, 140.0, 210.0, 120.0, 50.0, 200.0, 150.0, 220.0, 90.0, 40.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 500.0, 90.0, 10.0, 0.0, 140.0, 150.0, 5.0, 20.0, 10.0, 50.0, -20.0, 140.0, 10.0, -30.0, 860.0, 210.0, 0.0, -20.0, 10.0, 70.0, 240.0, 20.0, 70.0, 80.0, 80.0, 70.0, 140.0, 90.0, 40.0, 0.0, 60.0, 50.0, 430.0, 20.0, 30.0, 60.0, 310.0, 20.0, 0.0, 0.0, 480.0, 0.0, 100.0, 50.0, 110.0, 10.0, 70.0, 20.0, 10.0, 150.0, 220.0, 120.0, 200.0, 50.0, 145.0, 40.0, 70.0, 40.0, 530.0, 100.0, 120.0, 500.0, 190.0, 100.0, 100.0, 190.0, 80.0, 140.0, 70.0, 10.0, 40.0, 320.0, 70.0, 20.0, 0.0, 60.0, 350.0, 10.0, 60.0, 10.0, 60.0, 50.0, 130.0, 510.0, 120.0, 130.0, 160.0, 40.0, 10.0, 40.0, 190.0, 110.0, 20.0, 10.0, 400.0, 120.0, 30.0, 140.0, 130.0, 0.0, 190.0, 30.0, 70.0, 80.0, 30.0, 0.0, 20.0, 670.0, 95.0, 60.0, 120.0, 120.0, 470.0, 80.0, 110.0, 50.0, 190.0, 50.0, 150.0, -25.0, 10.0, 70.0, 140.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 70.0, 60.0, 110.0, 180.0, 70.0, 70.0, 110.0, 90.0, 200.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5013985400139085, "mean_inference_ms": 1.4126076441482394, "mean_action_processing_ms": 0.42256949085415696, "mean_env_wait_ms": 1.248969767298082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013241767883300781, "StateBufferConnector_ms": 0.010357379913330078, "ViewRequirementAgentConnector_ms": 0.39017581939697266}, "num_episodes": 18, "episode_return_max": 1720.0, "episode_return_min": 265.0, "episode_return_mean": 1020.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.523728334890993, "num_env_steps_trained_throughput_per_sec": 21.523728334890993, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 4560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4560000, "timers": {"training_iteration_time_ms": 185788.533, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185788.489, "sample_time_ms": 2445.912, "learn_time_ms": 183322.018, "learn_throughput": 21.82, "synch_weights_time_ms": 11.841}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "done": false, "training_iteration": 114, "trial_id": "90816_00000", "date": "2024-06-10_06-08-52", "timestamp": 1718014132, "time_this_iter_s": 185.85492587089539, "time_total_s": 21409.208742380142, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0136280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21409.208742380142, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 17.697338403041822, "ram_util_percent": 78.67490494296577}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.520115364854709, "cur_kl_coeff": 66.58022890030699, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.910007644182069, "policy_loss": -0.0009644435207370402, "vf_loss": 6.908143387308009, "vf_explained_var": 0.00018866014556762891, "kl": 4.248556110714878e-05, "entropy": 0.35226524922762686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1075155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 265.0, "episode_reward_mean": 1007.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -415.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 100.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [730.0, 1350.0, 960.0, 530.0, 1690.0, 1280.0, 1420.0, 980.0, 950.0, 1270.0, 1250.0, 1190.0, 820.0, 280.0, 1260.0, 840.0, 1720.0, 1280.0, 1040.0, 650.0, 1240.0, 1435.0, 1270.0, 740.0, 1190.0, 1050.0, 1110.0, 920.0, 425.0, 690.0, 380.0, 1160.0, 1250.0, 1250.0, 810.0, 410.0, 800.0, 1200.0, 1120.0, 340.0, 1140.0, 1390.0, 375.0, 930.0, 1180.0, 1630.0, 1170.0, 1680.0, 710.0, 885.0, 1630.0, 1155.0, 800.0, 1020.0, 865.0, 890.0, 1320.0, 630.0, 450.0, 850.0, 1160.0, 1345.0, 600.0, 925.0, 1210.0, 900.0, 980.0, 850.0, 1565.0, 1590.0, 940.0, 1220.0, 1190.0, 1185.0, 1400.0, 265.0, 990.0, 1370.0, 1270.0, 620.0, 840.0, 1360.0, 1170.0, 500.0, 770.0, 380.0, 370.0, 795.0, 600.0, 1360.0, 1840.0, 780.0, 810.0, 1220.0, 680.0, 1870.0, 640.0, 1310.0, 600.0, 310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 210.0, 20.0, 100.0, 0.0, 20.0, 260.0, 30.0, 80.0, 10.0, 40.0, 30.0, 10.0, 320.0, 20.0, 110.0, 380.0, 150.0, 210.0, 80.0, 80.0, 50.0, 110.0, 470.0, 140.0, 90.0, 20.0, 30.0, -10.0, -20.0, 110.0, 70.0, 10.0, 160.0, 40.0, 0.0, 40.0, 30.0, 50.0, 20.0, 480.0, 170.0, 200.0, 30.0, 30.0, 70.0, 570.0, -40.0, 30.0, 150.0, 70.0, 540.0, 60.0, 50.0, 130.0, 100.0, 200.0, 80.0, 50.0, 0.0, 70.0, 70.0, 580.0, 410.0, -20.0, 130.0, 70.0, 20.0, 40.0, 50.0, -10.0, 420.0, 30.0, -20.0, 40.0, 30.0, 50.0, 360.0, 50.0, 30.0, 410.0, 50.0, 10.0, -30.0, 50.0, 10.0, 10.0, 110.0, 120.0, 210.0, 30.0, 380.0, 50.0, 30.0, 50.0, 60.0, 0.0, 100.0, 170.0, 400.0, 70.0, 130.0, 140.0, 40.0, 70.0, -100.0, 670.0, 180.0, 90.0, -40.0, 170.0, 45.0, 100.0, 80.0, 10.0, 30.0, 240.0, 20.0, 25.0, 470.0, 160.0, 160.0, 80.0, 30.0, 40.0, 100.0, 30.0, 30.0, 110.0, 80.0, 20.0, 20.0, 10.0, 60.0, 0.0, 30.0, 30.0, 70.0, 40.0, 0.0, 560.0, -30.0, 200.0, 170.0, 30.0, 120.0, 10.0, 10.0, 40.0, 150.0, 20.0, 0.0, 80.0, 20.0, 180.0, 50.0, 30.0, 20.0, 20.0, 420.0, 230.0, 80.0, 60.0, 180.0, 20.0, 100.0, -20.0, 190.0, 540.0, 340.0, 110.0, 690.0, 10.0, 110.0, 80.0, 20.0, 140.0, 70.0, 10.0, 40.0, 50.0, 20.0, 170.0, 10.0, 20.0, 350.0, 90.0, 110.0, 120.0, 100.0, 90.0, 10.0, 80.0, 80.0, 60.0, 30.0, 150.0, -10.0, 150.0, 10.0, 90.0, 70.0, -10.0, -10.0, 240.0, 40.0, 280.0, 260.0, 120.0, 160.0, 240.0, 100.0, 250.0, 270.0, -15.0, 90.0, -10.0, 400.0, 140.0, -30.0, 110.0, 90.0, 60.0, 320.0, 60.0, 500.0, 20.0, 40.0, 0.0, 70.0, 160.0, 0.0, -30.0, 60.0, 40.0, 35.0, 20.0, -55.0, 10.0, 500.0, 0.0, 340.0, 70.0, -10.0, 250.0, 20.0, 0.0, 300.0, 150.0, 70.0, 120.0, 60.0, 230.0, 60.0, 40.0, 40.0, 220.0, 260.0, 0.0, 20.0, 20.0, 30.0, 40.0, 380.0, 170.0, 0.0, 10.0, 150.0, 180.0, 130.0, -50.0, 60.0, 30.0, 20.0, -130.0, 0.0, 520.0, 20.0, 200.0, 250.0, 100.0, 110.0, 150.0, 40.0, 80.0, 30.0, -415.0, 10.0, 150.0, 170.0, 120.0, 40.0, 10.0, 50.0, 190.0, -10.0, 30.0, 20.0, 180.0, 60.0, 70.0, 190.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 0.0, 0.0, 60.0, 50.0, 120.0, 200.0, 80.0, 40.0, 160.0, 210.0, 10.0, 230.0, 100.0, 90.0, 380.0, 10.0, 30.0, 400.0, 70.0, 30.0, 110.0, 30.0, 80.0, 20.0, 100.0, 10.0, 10.0, 10.0, 610.0, 30.0, 110.0, 270.0, 60.0, 20.0, 80.0, 10.0, 60.0, 180.0, 50.0, 20.0, 260.0, 70.0, 20.0, 30.0, 20.0, 50.0, 10.0, 150.0, 30.0, 10.0, 70.0, 20.0, 90.0, 100.0, 90.0, 100.0, 150.0, 60.0, 80.0, 50.0, 60.0, 20.0, 230.0, 90.0, 390.0, 110.0, 30.0, 120.0, -30.0, 210.0, 220.0, -170.0, 40.0, 340.0, 150.0, 60.0, 70.0, 20.0, 30.0, 70.0, 60.0, 280.0, 10.0, 70.0, 10.0, 30.0, 20.0, 40.0, 30.0, 10.0, 110.0, 10.0, 180.0, 90.0, 60.0, 60.0, 20.0, 150.0, 110.0, 180.0, 270.0, 20.0, 70.0, 190.0, -80.0, 70.0, 90.0, 100.0, 590.0, 20.0, -30.0, 370.0, 30.0, 80.0, 20.0, 20.0, 10.0, 150.0, 25.0, 10.0, 10.0, 20.0, 0.0, 60.0, 10.0, 110.0, 100.0, 100.0, 50.0, 40.0, 220.0, 240.0, 120.0, 40.0, 0.0, 60.0, 110.0, 200.0, 100.0, 70.0, 320.0, 160.0, 80.0, -20.0, 280.0, 300.0, 60.0, 370.0, 220.0, 180.0, 110.0, 50.0, 210.0, 280.0, 60.0, 160.0, 60.0, 20.0, 90.0, 70.0, 60.0, 160.0, 520.0, 270.0, 80.0, 100.0, 360.0, 10.0, 40.0, 40.0, 180.0, 80.0, 60.0, 80.0, 190.0, 30.0, 210.0, 40.0, 10.0, 50.0, 20.0, 20.0, 190.0, 250.0, 40.0, 10.0, 25.0, -50.0, 0.0, -10.0, 230.0, 200.0, 50.0, 60.0, 0.0, 300.0, 350.0, 70.0, 150.0, 70.0, 500.0, 80.0, 290.0, 200.0, 30.0, 40.0, 140.0, 150.0, 50.0, 70.0, 155.0, 30.0, 120.0, 10.0, 20.0, 280.0, 50.0, 30.0, 210.0, 50.0, 10.0, 20.0, 210.0, 130.0, 50.0, 40.0, 10.0, 150.0, 30.0, 50.0, 130.0, 220.0, -10.0, 20.0, 40.0, 90.0, -70.0, 695.0, -40.0, 100.0, 110.0, -70.0, 260.0, 40.0, 30.0, 20.0, 90.0, 0.0, 20.0, 190.0, 180.0, 60.0, 70.0, 70.0, 120.0, 160.0, 110.0, 10.0, 260.0, 280.0, 70.0, 170.0, 10.0, 50.0, 130.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 370.0, 20.0, 170.0, 60.0, 20.0, 10.0, 10.0, 0.0, 30.0, 20.0, 110.0, 310.0, 40.0, 20.0, 300.0, 0.0, 10.0, 70.0, 50.0, 20.0, 30.0, 140.0, 280.0, 60.0, 180.0, 40.0, 220.0, 70.0, 30.0, 110.0, 30.0, 170.0, 360.0, 70.0, 70.0, -45.0, 140.0, 210.0, 120.0, 50.0, 200.0, 150.0, 220.0, 90.0, 40.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 500.0, 90.0, 10.0, 0.0, 140.0, 150.0, 5.0, 20.0, 10.0, 50.0, -20.0, 140.0, 10.0, -30.0, 860.0, 210.0, 0.0, -20.0, 10.0, 70.0, 240.0, 20.0, 70.0, 80.0, 80.0, 70.0, 140.0, 90.0, 40.0, 0.0, 60.0, 50.0, 430.0, 20.0, 30.0, 60.0, 310.0, 20.0, 0.0, 0.0, 480.0, 0.0, 100.0, 50.0, 110.0, 10.0, 70.0, 20.0, 10.0, 150.0, 220.0, 120.0, 200.0, 50.0, 145.0, 40.0, 70.0, 40.0, 530.0, 100.0, 120.0, 500.0, 190.0, 100.0, 100.0, 190.0, 80.0, 140.0, 70.0, 10.0, 40.0, 320.0, 70.0, 20.0, 0.0, 60.0, 350.0, 10.0, 60.0, 10.0, 60.0, 50.0, 130.0, 510.0, 120.0, 130.0, 160.0, 40.0, 10.0, 40.0, 190.0, 110.0, 20.0, 10.0, 400.0, 120.0, 30.0, 140.0, 130.0, 0.0, 190.0, 30.0, 70.0, 80.0, 30.0, 0.0, 20.0, 670.0, 95.0, 60.0, 120.0, 120.0, 470.0, 80.0, 110.0, 50.0, 190.0, 50.0, 150.0, -25.0, 10.0, 70.0, 140.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 70.0, 60.0, 110.0, 180.0, 70.0, 70.0, 110.0, 90.0, 200.0, 30.0, 40.0, 90.0, 130.0, 320.0, 140.0, 10.0, 250.0, 210.0, 120.0, 60.0, 210.0, 20.0, 150.0, 30.0, 180.0, 40.0, 320.0, 210.0, 90.0, 20.0, 40.0, 60.0, 110.0, 20.0, 170.0, 10.0, 70.0, 20.0, 60.0, 60.0, -85.0, 130.0, 0.0, -30.0, -5.0, 20.0, -140.0, 930.0, 20.0, 0.0, 90.0, 60.0, 50.0, 360.0, 70.0, 150.0, 30.0, 110.0, 350.0, 90.0, 280.0, 20.0, 50.0, 250.0, -30.0, 20.0, 50.0, 70.0, 100.0, 360.0, 150.0, 20.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 60.0, -30.0, 140.0, 40.0, 110.0, -20.0, 380.0, 60.0, 10.0, 50.0, 30.0, 50.0, 30.0, 10.0, 70.0, 0.0, 0.0, 150.0, 30.0, 10.0, 30.0, 10.0, 0.0, 30.0, 90.0, 0.0, 30.0, 10.0, 30.0, 150.0, 20.0, -50.0, 200.0, 70.0, 15.0, 100.0, 70.0, 20.0, 90.0, 200.0, 80.0, 20.0, 90.0, 110.0, -50.0, 20.0, 150.0, 40.0, 0.0, 0.0, 220.0, -40.0, 40.0, 470.0, 340.0, 30.0, 30.0, 60.0, 350.0, 30.0, 50.0, 50.0, 260.0, 60.0, 70.0, 90.0, 450.0, 420.0, 360.0, 0.0, 80.0, -10.0, 10.0, 80.0, 30.0, -20.0, 130.0, -10.0, 500.0, 80.0, -10.0, 80.0, 30.0, 30.0, 120.0, 150.0, 220.0, 50.0, 70.0, 60.0, 0.0, 220.0, 140.0, 100.0, 60.0, 130.0, 10.0, 100.0, 80.0, 140.0, 240.0, 10.0, 40.0, -30.0, 110.0, 20.0, 50.0, 100.0, 60.0, 150.0, 170.0, 280.0, 720.0, 10.0, 40.0, 400.0, 80.0, 20.0, 90.0, 190.0, 40.0, 20.0, 240.0, -50.0, 40.0, -50.0, 10.0, 70.0, 190.0, 70.0, 100.0, 30.0, 120.0, 180.0, 10.0, 110.0, 80.0, -20.0, 320.0, 70.0, 410.0, -120.0, 40.0, 15.0, 25.0, 120.0, 190.0, 30.0, 10.0, 40.0, 250.0, 40.0, 20.0, 60.0, -20.0, 60.0, -140.0, -150.0, 60.0, 80.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5012336440154157, "mean_inference_ms": 1.4159277707761035, "mean_action_processing_ms": 0.42229705856298877, "mean_env_wait_ms": 1.2487747091415242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013540983200073242, "StateBufferConnector_ms": 0.010294675827026367, "ViewRequirementAgentConnector_ms": 0.3852102756500244}, "num_episodes": 23, "episode_return_max": 1870.0, "episode_return_min": 265.0, "episode_return_mean": 1007.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.614880097412243, "num_env_steps_trained_throughput_per_sec": 21.614880097412243, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 4600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4600000, "timers": {"training_iteration_time_ms": 185803.424, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185803.38, "sample_time_ms": 2437.28, "learn_time_ms": 183346.017, "learn_throughput": 21.817, "synch_weights_time_ms": 11.909}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "done": false, "training_iteration": 115, "trial_id": "90816_00000", "date": "2024-06-10_06-11-57", "timestamp": 1718014317, "time_this_iter_s": 185.06340408325195, "time_total_s": 21594.272146463394, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3157f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21594.272146463394, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 17.45152671755725, "ram_util_percent": 79.12290076335879}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.387068781824793, "cur_kl_coeff": 33.290114450153496, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00160681130562902, "vf_loss": 6.285484720876042, "vf_explained_var": -0.0023970147608695066, "kl": Infinity, "entropy": 0.34579319456578317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1084545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 150.0, "episode_reward_mean": 958.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -415.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 95.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1040.0, 650.0, 1240.0, 1435.0, 1270.0, 740.0, 1190.0, 1050.0, 1110.0, 920.0, 425.0, 690.0, 380.0, 1160.0, 1250.0, 1250.0, 810.0, 410.0, 800.0, 1200.0, 1120.0, 340.0, 1140.0, 1390.0, 375.0, 930.0, 1180.0, 1630.0, 1170.0, 1680.0, 710.0, 885.0, 1630.0, 1155.0, 800.0, 1020.0, 865.0, 890.0, 1320.0, 630.0, 450.0, 850.0, 1160.0, 1345.0, 600.0, 925.0, 1210.0, 900.0, 980.0, 850.0, 1565.0, 1590.0, 940.0, 1220.0, 1190.0, 1185.0, 1400.0, 265.0, 990.0, 1370.0, 1270.0, 620.0, 840.0, 1360.0, 1170.0, 500.0, 770.0, 380.0, 370.0, 795.0, 600.0, 1360.0, 1840.0, 780.0, 810.0, 1220.0, 680.0, 1870.0, 640.0, 1310.0, 600.0, 310.0, 990.0, 150.0, 545.0, 1070.0, 1400.0, 1540.0, 560.0, 1550.0, 1030.0, 1000.0, 1620.0, 820.0, 385.0, 410.0, 740.0, 350.0, 240.0, 450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 20.0, 170.0, 10.0, 20.0, 350.0, 90.0, 110.0, 120.0, 100.0, 90.0, 10.0, 80.0, 80.0, 60.0, 30.0, 150.0, -10.0, 150.0, 10.0, 90.0, 70.0, -10.0, -10.0, 240.0, 40.0, 280.0, 260.0, 120.0, 160.0, 240.0, 100.0, 250.0, 270.0, -15.0, 90.0, -10.0, 400.0, 140.0, -30.0, 110.0, 90.0, 60.0, 320.0, 60.0, 500.0, 20.0, 40.0, 0.0, 70.0, 160.0, 0.0, -30.0, 60.0, 40.0, 35.0, 20.0, -55.0, 10.0, 500.0, 0.0, 340.0, 70.0, -10.0, 250.0, 20.0, 0.0, 300.0, 150.0, 70.0, 120.0, 60.0, 230.0, 60.0, 40.0, 40.0, 220.0, 260.0, 0.0, 20.0, 20.0, 30.0, 40.0, 380.0, 170.0, 0.0, 10.0, 150.0, 180.0, 130.0, -50.0, 60.0, 30.0, 20.0, -130.0, 0.0, 520.0, 20.0, 200.0, 250.0, 100.0, 110.0, 150.0, 40.0, 80.0, 30.0, -415.0, 10.0, 150.0, 170.0, 120.0, 40.0, 10.0, 50.0, 190.0, -10.0, 30.0, 20.0, 180.0, 60.0, 70.0, 190.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 0.0, 0.0, 60.0, 50.0, 120.0, 200.0, 80.0, 40.0, 160.0, 210.0, 10.0, 230.0, 100.0, 90.0, 380.0, 10.0, 30.0, 400.0, 70.0, 30.0, 110.0, 30.0, 80.0, 20.0, 100.0, 10.0, 10.0, 10.0, 610.0, 30.0, 110.0, 270.0, 60.0, 20.0, 80.0, 10.0, 60.0, 180.0, 50.0, 20.0, 260.0, 70.0, 20.0, 30.0, 20.0, 50.0, 10.0, 150.0, 30.0, 10.0, 70.0, 20.0, 90.0, 100.0, 90.0, 100.0, 150.0, 60.0, 80.0, 50.0, 60.0, 20.0, 230.0, 90.0, 390.0, 110.0, 30.0, 120.0, -30.0, 210.0, 220.0, -170.0, 40.0, 340.0, 150.0, 60.0, 70.0, 20.0, 30.0, 70.0, 60.0, 280.0, 10.0, 70.0, 10.0, 30.0, 20.0, 40.0, 30.0, 10.0, 110.0, 10.0, 180.0, 90.0, 60.0, 60.0, 20.0, 150.0, 110.0, 180.0, 270.0, 20.0, 70.0, 190.0, -80.0, 70.0, 90.0, 100.0, 590.0, 20.0, -30.0, 370.0, 30.0, 80.0, 20.0, 20.0, 10.0, 150.0, 25.0, 10.0, 10.0, 20.0, 0.0, 60.0, 10.0, 110.0, 100.0, 100.0, 50.0, 40.0, 220.0, 240.0, 120.0, 40.0, 0.0, 60.0, 110.0, 200.0, 100.0, 70.0, 320.0, 160.0, 80.0, -20.0, 280.0, 300.0, 60.0, 370.0, 220.0, 180.0, 110.0, 50.0, 210.0, 280.0, 60.0, 160.0, 60.0, 20.0, 90.0, 70.0, 60.0, 160.0, 520.0, 270.0, 80.0, 100.0, 360.0, 10.0, 40.0, 40.0, 180.0, 80.0, 60.0, 80.0, 190.0, 30.0, 210.0, 40.0, 10.0, 50.0, 20.0, 20.0, 190.0, 250.0, 40.0, 10.0, 25.0, -50.0, 0.0, -10.0, 230.0, 200.0, 50.0, 60.0, 0.0, 300.0, 350.0, 70.0, 150.0, 70.0, 500.0, 80.0, 290.0, 200.0, 30.0, 40.0, 140.0, 150.0, 50.0, 70.0, 155.0, 30.0, 120.0, 10.0, 20.0, 280.0, 50.0, 30.0, 210.0, 50.0, 10.0, 20.0, 210.0, 130.0, 50.0, 40.0, 10.0, 150.0, 30.0, 50.0, 130.0, 220.0, -10.0, 20.0, 40.0, 90.0, -70.0, 695.0, -40.0, 100.0, 110.0, -70.0, 260.0, 40.0, 30.0, 20.0, 90.0, 0.0, 20.0, 190.0, 180.0, 60.0, 70.0, 70.0, 120.0, 160.0, 110.0, 10.0, 260.0, 280.0, 70.0, 170.0, 10.0, 50.0, 130.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 370.0, 20.0, 170.0, 60.0, 20.0, 10.0, 10.0, 0.0, 30.0, 20.0, 110.0, 310.0, 40.0, 20.0, 300.0, 0.0, 10.0, 70.0, 50.0, 20.0, 30.0, 140.0, 280.0, 60.0, 180.0, 40.0, 220.0, 70.0, 30.0, 110.0, 30.0, 170.0, 360.0, 70.0, 70.0, -45.0, 140.0, 210.0, 120.0, 50.0, 200.0, 150.0, 220.0, 90.0, 40.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 500.0, 90.0, 10.0, 0.0, 140.0, 150.0, 5.0, 20.0, 10.0, 50.0, -20.0, 140.0, 10.0, -30.0, 860.0, 210.0, 0.0, -20.0, 10.0, 70.0, 240.0, 20.0, 70.0, 80.0, 80.0, 70.0, 140.0, 90.0, 40.0, 0.0, 60.0, 50.0, 430.0, 20.0, 30.0, 60.0, 310.0, 20.0, 0.0, 0.0, 480.0, 0.0, 100.0, 50.0, 110.0, 10.0, 70.0, 20.0, 10.0, 150.0, 220.0, 120.0, 200.0, 50.0, 145.0, 40.0, 70.0, 40.0, 530.0, 100.0, 120.0, 500.0, 190.0, 100.0, 100.0, 190.0, 80.0, 140.0, 70.0, 10.0, 40.0, 320.0, 70.0, 20.0, 0.0, 60.0, 350.0, 10.0, 60.0, 10.0, 60.0, 50.0, 130.0, 510.0, 120.0, 130.0, 160.0, 40.0, 10.0, 40.0, 190.0, 110.0, 20.0, 10.0, 400.0, 120.0, 30.0, 140.0, 130.0, 0.0, 190.0, 30.0, 70.0, 80.0, 30.0, 0.0, 20.0, 670.0, 95.0, 60.0, 120.0, 120.0, 470.0, 80.0, 110.0, 50.0, 190.0, 50.0, 150.0, -25.0, 10.0, 70.0, 140.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 70.0, 60.0, 110.0, 180.0, 70.0, 70.0, 110.0, 90.0, 200.0, 30.0, 40.0, 90.0, 130.0, 320.0, 140.0, 10.0, 250.0, 210.0, 120.0, 60.0, 210.0, 20.0, 150.0, 30.0, 180.0, 40.0, 320.0, 210.0, 90.0, 20.0, 40.0, 60.0, 110.0, 20.0, 170.0, 10.0, 70.0, 20.0, 60.0, 60.0, -85.0, 130.0, 0.0, -30.0, -5.0, 20.0, -140.0, 930.0, 20.0, 0.0, 90.0, 60.0, 50.0, 360.0, 70.0, 150.0, 30.0, 110.0, 350.0, 90.0, 280.0, 20.0, 50.0, 250.0, -30.0, 20.0, 50.0, 70.0, 100.0, 360.0, 150.0, 20.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 60.0, -30.0, 140.0, 40.0, 110.0, -20.0, 380.0, 60.0, 10.0, 50.0, 30.0, 50.0, 30.0, 10.0, 70.0, 0.0, 0.0, 150.0, 30.0, 10.0, 30.0, 10.0, 0.0, 30.0, 90.0, 0.0, 30.0, 10.0, 30.0, 150.0, 20.0, -50.0, 200.0, 70.0, 15.0, 100.0, 70.0, 20.0, 90.0, 200.0, 80.0, 20.0, 90.0, 110.0, -50.0, 20.0, 150.0, 40.0, 0.0, 0.0, 220.0, -40.0, 40.0, 470.0, 340.0, 30.0, 30.0, 60.0, 350.0, 30.0, 50.0, 50.0, 260.0, 60.0, 70.0, 90.0, 450.0, 420.0, 360.0, 0.0, 80.0, -10.0, 10.0, 80.0, 30.0, -20.0, 130.0, -10.0, 500.0, 80.0, -10.0, 80.0, 30.0, 30.0, 120.0, 150.0, 220.0, 50.0, 70.0, 60.0, 0.0, 220.0, 140.0, 100.0, 60.0, 130.0, 10.0, 100.0, 80.0, 140.0, 240.0, 10.0, 40.0, -30.0, 110.0, 20.0, 50.0, 100.0, 60.0, 150.0, 170.0, 280.0, 720.0, 10.0, 40.0, 400.0, 80.0, 20.0, 90.0, 190.0, 40.0, 20.0, 240.0, -50.0, 40.0, -50.0, 10.0, 70.0, 190.0, 70.0, 100.0, 30.0, 120.0, 180.0, 10.0, 110.0, 80.0, -20.0, 320.0, 70.0, 410.0, -120.0, 40.0, 15.0, 25.0, 120.0, 190.0, 30.0, 10.0, 40.0, 250.0, 40.0, 20.0, 60.0, -20.0, 60.0, -140.0, -150.0, 60.0, 80.0, 300.0, 430.0, 100.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 220.0, 110.0, -20.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 70.0, 10.0, 240.0, 20.0, -10.0, 10.0, 165.0, 480.0, -20.0, 40.0, 40.0, 0.0, 270.0, 0.0, 70.0, 40.0, 150.0, 200.0, 30.0, 190.0, 70.0, 50.0, 50.0, 480.0, 30.0, -10.0, 310.0, 160.0, 70.0, 70.0, 530.0, 30.0, 270.0, 60.0, 150.0, 230.0, -30.0, 70.0, -20.0, 270.0, 0.0, 10.0, 20.0, 160.0, 30.0, 0.0, 20.0, 20.0, 190.0, 140.0, 60.0, 320.0, 0.0, 510.0, 70.0, 170.0, 70.0, 40.0, 130.0, 120.0, 110.0, 40.0, 50.0, 300.0, 0.0, 180.0, 60.0, 50.0, 10.0, 30.0, 80.0, 80.0, 0.0, 210.0, 350.0, 20.0, 170.0, 410.0, 110.0, 120.0, 230.0, 40.0, 80.0, -40.0, 20.0, 150.0, 500.0, 170.0, 30.0, 70.0, 180.0, 40.0, 20.0, 130.0, 50.0, 110.0, 20.0, 30.0, 210.0, -190.0, 110.0, 100.0, 0.0, 110.0, 40.0, 10.0, -35.0, 30.0, 40.0, -10.0, 180.0, -400.0, 80.0, 180.0, 80.0, 20.0, 210.0, 60.0, 100.0, 10.0, 20.0, 210.0, 0.0, 0.0, 320.0, 10.0, 10.0, 160.0, 0.0, 20.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 120.0, 40.0, 20.0, 0.0, 120.0, 20.0, 90.0, 10.0, 60.0, 10.0, 30.0, 60.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.499335524034837, "mean_inference_ms": 1.4129159211420563, "mean_action_processing_ms": 0.42290075064847366, "mean_env_wait_ms": 1.249099059265506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013044357299804688, "StateBufferConnector_ms": 0.009816884994506836, "ViewRequirementAgentConnector_ms": 0.3880631923675537}, "num_episodes": 18, "episode_return_max": 1870.0, "episode_return_min": 150.0, "episode_return_mean": 958.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.55890841331294, "num_env_steps_trained_throughput_per_sec": 21.55890841331294, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 4640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4640000, "timers": {"training_iteration_time_ms": 185784.401, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185784.357, "sample_time_ms": 2463.936, "learn_time_ms": 183300.226, "learn_throughput": 21.822, "synch_weights_time_ms": 11.968}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "done": false, "training_iteration": 116, "trial_id": "90816_00000", "date": "2024-06-10_06-15-02", "timestamp": 1718014502, "time_this_iter_s": 185.54841589927673, "time_total_s": 21779.82056236267, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b011a8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21779.82056236267, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 17.480988593155892, "ram_util_percent": 79.15551330798479}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.160118915872198, "cur_kl_coeff": 49.93517167523022, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0014691734067099893, "vf_loss": 6.515220106701754, "vf_explained_var": 0.00033713347487810194, "kl": Infinity, "entropy": 0.3632763271466993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1093935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 150.0, "episode_reward_mean": 947.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -400.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 94.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1140.0, 1390.0, 375.0, 930.0, 1180.0, 1630.0, 1170.0, 1680.0, 710.0, 885.0, 1630.0, 1155.0, 800.0, 1020.0, 865.0, 890.0, 1320.0, 630.0, 450.0, 850.0, 1160.0, 1345.0, 600.0, 925.0, 1210.0, 900.0, 980.0, 850.0, 1565.0, 1590.0, 940.0, 1220.0, 1190.0, 1185.0, 1400.0, 265.0, 990.0, 1370.0, 1270.0, 620.0, 840.0, 1360.0, 1170.0, 500.0, 770.0, 380.0, 370.0, 795.0, 600.0, 1360.0, 1840.0, 780.0, 810.0, 1220.0, 680.0, 1870.0, 640.0, 1310.0, 600.0, 310.0, 990.0, 150.0, 545.0, 1070.0, 1400.0, 1540.0, 560.0, 1550.0, 1030.0, 1000.0, 1620.0, 820.0, 385.0, 410.0, 740.0, 350.0, 240.0, 450.0, 1395.0, 810.0, 540.0, 780.0, 655.0, 730.0, 600.0, 1390.0, 970.0, 450.0, 870.0, 1590.0, 370.0, 680.0, 1030.0, 535.0, 680.0, 495.0, 1790.0, 500.0, 980.0, 1550.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 90.0, 60.0, 60.0, 20.0, 150.0, 110.0, 180.0, 270.0, 20.0, 70.0, 190.0, -80.0, 70.0, 90.0, 100.0, 590.0, 20.0, -30.0, 370.0, 30.0, 80.0, 20.0, 20.0, 10.0, 150.0, 25.0, 10.0, 10.0, 20.0, 0.0, 60.0, 10.0, 110.0, 100.0, 100.0, 50.0, 40.0, 220.0, 240.0, 120.0, 40.0, 0.0, 60.0, 110.0, 200.0, 100.0, 70.0, 320.0, 160.0, 80.0, -20.0, 280.0, 300.0, 60.0, 370.0, 220.0, 180.0, 110.0, 50.0, 210.0, 280.0, 60.0, 160.0, 60.0, 20.0, 90.0, 70.0, 60.0, 160.0, 520.0, 270.0, 80.0, 100.0, 360.0, 10.0, 40.0, 40.0, 180.0, 80.0, 60.0, 80.0, 190.0, 30.0, 210.0, 40.0, 10.0, 50.0, 20.0, 20.0, 190.0, 250.0, 40.0, 10.0, 25.0, -50.0, 0.0, -10.0, 230.0, 200.0, 50.0, 60.0, 0.0, 300.0, 350.0, 70.0, 150.0, 70.0, 500.0, 80.0, 290.0, 200.0, 30.0, 40.0, 140.0, 150.0, 50.0, 70.0, 155.0, 30.0, 120.0, 10.0, 20.0, 280.0, 50.0, 30.0, 210.0, 50.0, 10.0, 20.0, 210.0, 130.0, 50.0, 40.0, 10.0, 150.0, 30.0, 50.0, 130.0, 220.0, -10.0, 20.0, 40.0, 90.0, -70.0, 695.0, -40.0, 100.0, 110.0, -70.0, 260.0, 40.0, 30.0, 20.0, 90.0, 0.0, 20.0, 190.0, 180.0, 60.0, 70.0, 70.0, 120.0, 160.0, 110.0, 10.0, 260.0, 280.0, 70.0, 170.0, 10.0, 50.0, 130.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 370.0, 20.0, 170.0, 60.0, 20.0, 10.0, 10.0, 0.0, 30.0, 20.0, 110.0, 310.0, 40.0, 20.0, 300.0, 0.0, 10.0, 70.0, 50.0, 20.0, 30.0, 140.0, 280.0, 60.0, 180.0, 40.0, 220.0, 70.0, 30.0, 110.0, 30.0, 170.0, 360.0, 70.0, 70.0, -45.0, 140.0, 210.0, 120.0, 50.0, 200.0, 150.0, 220.0, 90.0, 40.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 500.0, 90.0, 10.0, 0.0, 140.0, 150.0, 5.0, 20.0, 10.0, 50.0, -20.0, 140.0, 10.0, -30.0, 860.0, 210.0, 0.0, -20.0, 10.0, 70.0, 240.0, 20.0, 70.0, 80.0, 80.0, 70.0, 140.0, 90.0, 40.0, 0.0, 60.0, 50.0, 430.0, 20.0, 30.0, 60.0, 310.0, 20.0, 0.0, 0.0, 480.0, 0.0, 100.0, 50.0, 110.0, 10.0, 70.0, 20.0, 10.0, 150.0, 220.0, 120.0, 200.0, 50.0, 145.0, 40.0, 70.0, 40.0, 530.0, 100.0, 120.0, 500.0, 190.0, 100.0, 100.0, 190.0, 80.0, 140.0, 70.0, 10.0, 40.0, 320.0, 70.0, 20.0, 0.0, 60.0, 350.0, 10.0, 60.0, 10.0, 60.0, 50.0, 130.0, 510.0, 120.0, 130.0, 160.0, 40.0, 10.0, 40.0, 190.0, 110.0, 20.0, 10.0, 400.0, 120.0, 30.0, 140.0, 130.0, 0.0, 190.0, 30.0, 70.0, 80.0, 30.0, 0.0, 20.0, 670.0, 95.0, 60.0, 120.0, 120.0, 470.0, 80.0, 110.0, 50.0, 190.0, 50.0, 150.0, -25.0, 10.0, 70.0, 140.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 70.0, 60.0, 110.0, 180.0, 70.0, 70.0, 110.0, 90.0, 200.0, 30.0, 40.0, 90.0, 130.0, 320.0, 140.0, 10.0, 250.0, 210.0, 120.0, 60.0, 210.0, 20.0, 150.0, 30.0, 180.0, 40.0, 320.0, 210.0, 90.0, 20.0, 40.0, 60.0, 110.0, 20.0, 170.0, 10.0, 70.0, 20.0, 60.0, 60.0, -85.0, 130.0, 0.0, -30.0, -5.0, 20.0, -140.0, 930.0, 20.0, 0.0, 90.0, 60.0, 50.0, 360.0, 70.0, 150.0, 30.0, 110.0, 350.0, 90.0, 280.0, 20.0, 50.0, 250.0, -30.0, 20.0, 50.0, 70.0, 100.0, 360.0, 150.0, 20.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 60.0, -30.0, 140.0, 40.0, 110.0, -20.0, 380.0, 60.0, 10.0, 50.0, 30.0, 50.0, 30.0, 10.0, 70.0, 0.0, 0.0, 150.0, 30.0, 10.0, 30.0, 10.0, 0.0, 30.0, 90.0, 0.0, 30.0, 10.0, 30.0, 150.0, 20.0, -50.0, 200.0, 70.0, 15.0, 100.0, 70.0, 20.0, 90.0, 200.0, 80.0, 20.0, 90.0, 110.0, -50.0, 20.0, 150.0, 40.0, 0.0, 0.0, 220.0, -40.0, 40.0, 470.0, 340.0, 30.0, 30.0, 60.0, 350.0, 30.0, 50.0, 50.0, 260.0, 60.0, 70.0, 90.0, 450.0, 420.0, 360.0, 0.0, 80.0, -10.0, 10.0, 80.0, 30.0, -20.0, 130.0, -10.0, 500.0, 80.0, -10.0, 80.0, 30.0, 30.0, 120.0, 150.0, 220.0, 50.0, 70.0, 60.0, 0.0, 220.0, 140.0, 100.0, 60.0, 130.0, 10.0, 100.0, 80.0, 140.0, 240.0, 10.0, 40.0, -30.0, 110.0, 20.0, 50.0, 100.0, 60.0, 150.0, 170.0, 280.0, 720.0, 10.0, 40.0, 400.0, 80.0, 20.0, 90.0, 190.0, 40.0, 20.0, 240.0, -50.0, 40.0, -50.0, 10.0, 70.0, 190.0, 70.0, 100.0, 30.0, 120.0, 180.0, 10.0, 110.0, 80.0, -20.0, 320.0, 70.0, 410.0, -120.0, 40.0, 15.0, 25.0, 120.0, 190.0, 30.0, 10.0, 40.0, 250.0, 40.0, 20.0, 60.0, -20.0, 60.0, -140.0, -150.0, 60.0, 80.0, 300.0, 430.0, 100.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 220.0, 110.0, -20.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 70.0, 10.0, 240.0, 20.0, -10.0, 10.0, 165.0, 480.0, -20.0, 40.0, 40.0, 0.0, 270.0, 0.0, 70.0, 40.0, 150.0, 200.0, 30.0, 190.0, 70.0, 50.0, 50.0, 480.0, 30.0, -10.0, 310.0, 160.0, 70.0, 70.0, 530.0, 30.0, 270.0, 60.0, 150.0, 230.0, -30.0, 70.0, -20.0, 270.0, 0.0, 10.0, 20.0, 160.0, 30.0, 0.0, 20.0, 20.0, 190.0, 140.0, 60.0, 320.0, 0.0, 510.0, 70.0, 170.0, 70.0, 40.0, 130.0, 120.0, 110.0, 40.0, 50.0, 300.0, 0.0, 180.0, 60.0, 50.0, 10.0, 30.0, 80.0, 80.0, 0.0, 210.0, 350.0, 20.0, 170.0, 410.0, 110.0, 120.0, 230.0, 40.0, 80.0, -40.0, 20.0, 150.0, 500.0, 170.0, 30.0, 70.0, 180.0, 40.0, 20.0, 130.0, 50.0, 110.0, 20.0, 30.0, 210.0, -190.0, 110.0, 100.0, 0.0, 110.0, 40.0, 10.0, -35.0, 30.0, 40.0, -10.0, 180.0, -400.0, 80.0, 180.0, 80.0, 20.0, 210.0, 60.0, 100.0, 10.0, 20.0, 210.0, 0.0, 0.0, 320.0, 10.0, 10.0, 160.0, 0.0, 20.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 120.0, 40.0, 20.0, 0.0, 120.0, 20.0, 90.0, 10.0, 60.0, 10.0, 30.0, 60.0, 50.0, 20.0, 450.0, 55.0, 90.0, 80.0, 70.0, 100.0, 180.0, 290.0, 60.0, 40.0, 80.0, -20.0, 40.0, 380.0, 10.0, 70.0, 20.0, 170.0, 20.0, 120.0, 80.0, 60.0, 40.0, 40.0, 70.0, 20.0, 20.0, 80.0, 10.0, 80.0, 90.0, 60.0, 20.0, 120.0, 50.0, 40.0, 60.0, 50.0, 210.0, 5.0, 20.0, 40.0, 300.0, 20.0, 80.0, 0.0, 30.0, 30.0, 130.0, 40.0, 0.0, 160.0, 100.0, 70.0, 70.0, 90.0, 20.0, 60.0, 120.0, 70.0, 20.0, 30.0, 110.0, 20.0, 110.0, 90.0, 10.0, 60.0, 80.0, 30.0, 80.0, 280.0, 70.0, 40.0, 390.0, 170.0, 120.0, 60.0, 150.0, 20.0, 10.0, 20.0, 40.0, 10.0, 40.0, 30.0, 590.0, 240.0, -30.0, 50.0, 0.0, 30.0, 20.0, 20.0, 140.0, 10.0, 160.0, 10.0, 10.0, 30.0, 150.0, 70.0, 0.0, 40.0, 40.0, 140.0, 30.0, 320.0, 50.0, 380.0, 430.0, 20.0, 30.0, -20.0, 0.0, 30.0, 110.0, 480.0, 130.0, 60.0, 30.0, 80.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 120.0, 250.0, 10.0, 40.0, 20.0, 160.0, -20.0, 50.0, 0.0, 20.0, 180.0, 260.0, 40.0, 170.0, 40.0, 30.0, 230.0, 60.0, 15.0, 20.0, 270.0, 150.0, 20.0, 10.0, 10.0, -40.0, 40.0, 40.0, 100.0, -10.0, 150.0, 50.0, 0.0, 0.0, 40.0, -100.0, 400.0, 50.0, 5.0, 30.0, -5.0, 170.0, 20.0, 20.0, 5.0, 260.0, -30.0, 20.0, 50.0, 300.0, 0.0, 360.0, 360.0, 70.0, 370.0, 100.0, 140.0, 40.0, 10.0, 10.0, 70.0, 50.0, 70.0, 50.0, 150.0, 30.0, 40.0, 20.0, 70.0, 150.0, 70.0, 20.0, 50.0, 70.0, 50.0, 10.0, 30.0, 460.0, 30.0, 350.0, 40.0, 120.0, 170.0, 170.0, 40.0, 160.0, 390.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4989074399010844, "mean_inference_ms": 1.414075848623348, "mean_action_processing_ms": 0.42331550573859306, "mean_env_wait_ms": 1.2493769904922896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013062715530395508, "StateBufferConnector_ms": 0.010003805160522461, "ViewRequirementAgentConnector_ms": 0.3988611698150635}, "num_episodes": 22, "episode_return_max": 1870.0, "episode_return_min": 150.0, "episode_return_mean": 947.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.56469255838455, "num_env_steps_trained_throughput_per_sec": 21.56469255838455, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 4680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4680000, "timers": {"training_iteration_time_ms": 185689.201, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185689.157, "sample_time_ms": 2460.441, "learn_time_ms": 183208.482, "learn_throughput": 21.833, "synch_weights_time_ms": 11.839}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "done": false, "training_iteration": 117, "trial_id": "90816_00000", "date": "2024-06-10_06-18-08", "timestamp": 1718014688, "time_this_iter_s": 185.497154712677, "time_total_s": 21965.317717075348, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0136e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21965.317717075348, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 17.649236641221375, "ram_util_percent": 79.26526717557252}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.713251794857212, "cur_kl_coeff": 74.90275751284534, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.72398316456487, "policy_loss": -0.00104274182695463, "vf_loss": 6.7219928132078515, "vf_explained_var": -0.000865321126354896, "kl": 4.049377508834812e-05, "entropy": 0.3548216554319389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1103325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 150.0, "episode_reward_mean": 922.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -400.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 92.245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [450.0, 850.0, 1160.0, 1345.0, 600.0, 925.0, 1210.0, 900.0, 980.0, 850.0, 1565.0, 1590.0, 940.0, 1220.0, 1190.0, 1185.0, 1400.0, 265.0, 990.0, 1370.0, 1270.0, 620.0, 840.0, 1360.0, 1170.0, 500.0, 770.0, 380.0, 370.0, 795.0, 600.0, 1360.0, 1840.0, 780.0, 810.0, 1220.0, 680.0, 1870.0, 640.0, 1310.0, 600.0, 310.0, 990.0, 150.0, 545.0, 1070.0, 1400.0, 1540.0, 560.0, 1550.0, 1030.0, 1000.0, 1620.0, 820.0, 385.0, 410.0, 740.0, 350.0, 240.0, 450.0, 1395.0, 810.0, 540.0, 780.0, 655.0, 730.0, 600.0, 1390.0, 970.0, 450.0, 870.0, 1590.0, 370.0, 680.0, 1030.0, 535.0, 680.0, 495.0, 1790.0, 500.0, 980.0, 1550.0, 880.0, 1220.0, 1210.0, 1310.0, 990.0, 280.0, 820.0, 630.0, 1135.0, 690.0, 670.0, 1060.0, 880.0, 1255.0, 1340.0, 200.0, 1330.0, 1025.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 170.0, 60.0, 20.0, 10.0, 10.0, 0.0, 30.0, 20.0, 110.0, 310.0, 40.0, 20.0, 300.0, 0.0, 10.0, 70.0, 50.0, 20.0, 30.0, 140.0, 280.0, 60.0, 180.0, 40.0, 220.0, 70.0, 30.0, 110.0, 30.0, 170.0, 360.0, 70.0, 70.0, -45.0, 140.0, 210.0, 120.0, 50.0, 200.0, 150.0, 220.0, 90.0, 40.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 0.0, 500.0, 90.0, 10.0, 0.0, 140.0, 150.0, 5.0, 20.0, 10.0, 50.0, -20.0, 140.0, 10.0, -30.0, 860.0, 210.0, 0.0, -20.0, 10.0, 70.0, 240.0, 20.0, 70.0, 80.0, 80.0, 70.0, 140.0, 90.0, 40.0, 0.0, 60.0, 50.0, 430.0, 20.0, 30.0, 60.0, 310.0, 20.0, 0.0, 0.0, 480.0, 0.0, 100.0, 50.0, 110.0, 10.0, 70.0, 20.0, 10.0, 150.0, 220.0, 120.0, 200.0, 50.0, 145.0, 40.0, 70.0, 40.0, 530.0, 100.0, 120.0, 500.0, 190.0, 100.0, 100.0, 190.0, 80.0, 140.0, 70.0, 10.0, 40.0, 320.0, 70.0, 20.0, 0.0, 60.0, 350.0, 10.0, 60.0, 10.0, 60.0, 50.0, 130.0, 510.0, 120.0, 130.0, 160.0, 40.0, 10.0, 40.0, 190.0, 110.0, 20.0, 10.0, 400.0, 120.0, 30.0, 140.0, 130.0, 0.0, 190.0, 30.0, 70.0, 80.0, 30.0, 0.0, 20.0, 670.0, 95.0, 60.0, 120.0, 120.0, 470.0, 80.0, 110.0, 50.0, 190.0, 50.0, 150.0, -25.0, 10.0, 70.0, 140.0, 0.0, 10.0, 30.0, 0.0, 0.0, 30.0, 70.0, 60.0, 110.0, 180.0, 70.0, 70.0, 110.0, 90.0, 200.0, 30.0, 40.0, 90.0, 130.0, 320.0, 140.0, 10.0, 250.0, 210.0, 120.0, 60.0, 210.0, 20.0, 150.0, 30.0, 180.0, 40.0, 320.0, 210.0, 90.0, 20.0, 40.0, 60.0, 110.0, 20.0, 170.0, 10.0, 70.0, 20.0, 60.0, 60.0, -85.0, 130.0, 0.0, -30.0, -5.0, 20.0, -140.0, 930.0, 20.0, 0.0, 90.0, 60.0, 50.0, 360.0, 70.0, 150.0, 30.0, 110.0, 350.0, 90.0, 280.0, 20.0, 50.0, 250.0, -30.0, 20.0, 50.0, 70.0, 100.0, 360.0, 150.0, 20.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 60.0, -30.0, 140.0, 40.0, 110.0, -20.0, 380.0, 60.0, 10.0, 50.0, 30.0, 50.0, 30.0, 10.0, 70.0, 0.0, 0.0, 150.0, 30.0, 10.0, 30.0, 10.0, 0.0, 30.0, 90.0, 0.0, 30.0, 10.0, 30.0, 150.0, 20.0, -50.0, 200.0, 70.0, 15.0, 100.0, 70.0, 20.0, 90.0, 200.0, 80.0, 20.0, 90.0, 110.0, -50.0, 20.0, 150.0, 40.0, 0.0, 0.0, 220.0, -40.0, 40.0, 470.0, 340.0, 30.0, 30.0, 60.0, 350.0, 30.0, 50.0, 50.0, 260.0, 60.0, 70.0, 90.0, 450.0, 420.0, 360.0, 0.0, 80.0, -10.0, 10.0, 80.0, 30.0, -20.0, 130.0, -10.0, 500.0, 80.0, -10.0, 80.0, 30.0, 30.0, 120.0, 150.0, 220.0, 50.0, 70.0, 60.0, 0.0, 220.0, 140.0, 100.0, 60.0, 130.0, 10.0, 100.0, 80.0, 140.0, 240.0, 10.0, 40.0, -30.0, 110.0, 20.0, 50.0, 100.0, 60.0, 150.0, 170.0, 280.0, 720.0, 10.0, 40.0, 400.0, 80.0, 20.0, 90.0, 190.0, 40.0, 20.0, 240.0, -50.0, 40.0, -50.0, 10.0, 70.0, 190.0, 70.0, 100.0, 30.0, 120.0, 180.0, 10.0, 110.0, 80.0, -20.0, 320.0, 70.0, 410.0, -120.0, 40.0, 15.0, 25.0, 120.0, 190.0, 30.0, 10.0, 40.0, 250.0, 40.0, 20.0, 60.0, -20.0, 60.0, -140.0, -150.0, 60.0, 80.0, 300.0, 430.0, 100.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 220.0, 110.0, -20.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 70.0, 10.0, 240.0, 20.0, -10.0, 10.0, 165.0, 480.0, -20.0, 40.0, 40.0, 0.0, 270.0, 0.0, 70.0, 40.0, 150.0, 200.0, 30.0, 190.0, 70.0, 50.0, 50.0, 480.0, 30.0, -10.0, 310.0, 160.0, 70.0, 70.0, 530.0, 30.0, 270.0, 60.0, 150.0, 230.0, -30.0, 70.0, -20.0, 270.0, 0.0, 10.0, 20.0, 160.0, 30.0, 0.0, 20.0, 20.0, 190.0, 140.0, 60.0, 320.0, 0.0, 510.0, 70.0, 170.0, 70.0, 40.0, 130.0, 120.0, 110.0, 40.0, 50.0, 300.0, 0.0, 180.0, 60.0, 50.0, 10.0, 30.0, 80.0, 80.0, 0.0, 210.0, 350.0, 20.0, 170.0, 410.0, 110.0, 120.0, 230.0, 40.0, 80.0, -40.0, 20.0, 150.0, 500.0, 170.0, 30.0, 70.0, 180.0, 40.0, 20.0, 130.0, 50.0, 110.0, 20.0, 30.0, 210.0, -190.0, 110.0, 100.0, 0.0, 110.0, 40.0, 10.0, -35.0, 30.0, 40.0, -10.0, 180.0, -400.0, 80.0, 180.0, 80.0, 20.0, 210.0, 60.0, 100.0, 10.0, 20.0, 210.0, 0.0, 0.0, 320.0, 10.0, 10.0, 160.0, 0.0, 20.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 120.0, 40.0, 20.0, 0.0, 120.0, 20.0, 90.0, 10.0, 60.0, 10.0, 30.0, 60.0, 50.0, 20.0, 450.0, 55.0, 90.0, 80.0, 70.0, 100.0, 180.0, 290.0, 60.0, 40.0, 80.0, -20.0, 40.0, 380.0, 10.0, 70.0, 20.0, 170.0, 20.0, 120.0, 80.0, 60.0, 40.0, 40.0, 70.0, 20.0, 20.0, 80.0, 10.0, 80.0, 90.0, 60.0, 20.0, 120.0, 50.0, 40.0, 60.0, 50.0, 210.0, 5.0, 20.0, 40.0, 300.0, 20.0, 80.0, 0.0, 30.0, 30.0, 130.0, 40.0, 0.0, 160.0, 100.0, 70.0, 70.0, 90.0, 20.0, 60.0, 120.0, 70.0, 20.0, 30.0, 110.0, 20.0, 110.0, 90.0, 10.0, 60.0, 80.0, 30.0, 80.0, 280.0, 70.0, 40.0, 390.0, 170.0, 120.0, 60.0, 150.0, 20.0, 10.0, 20.0, 40.0, 10.0, 40.0, 30.0, 590.0, 240.0, -30.0, 50.0, 0.0, 30.0, 20.0, 20.0, 140.0, 10.0, 160.0, 10.0, 10.0, 30.0, 150.0, 70.0, 0.0, 40.0, 40.0, 140.0, 30.0, 320.0, 50.0, 380.0, 430.0, 20.0, 30.0, -20.0, 0.0, 30.0, 110.0, 480.0, 130.0, 60.0, 30.0, 80.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 120.0, 250.0, 10.0, 40.0, 20.0, 160.0, -20.0, 50.0, 0.0, 20.0, 180.0, 260.0, 40.0, 170.0, 40.0, 30.0, 230.0, 60.0, 15.0, 20.0, 270.0, 150.0, 20.0, 10.0, 10.0, -40.0, 40.0, 40.0, 100.0, -10.0, 150.0, 50.0, 0.0, 0.0, 40.0, -100.0, 400.0, 50.0, 5.0, 30.0, -5.0, 170.0, 20.0, 20.0, 5.0, 260.0, -30.0, 20.0, 50.0, 300.0, 0.0, 360.0, 360.0, 70.0, 370.0, 100.0, 140.0, 40.0, 10.0, 10.0, 70.0, 50.0, 70.0, 50.0, 150.0, 30.0, 40.0, 20.0, 70.0, 150.0, 70.0, 20.0, 50.0, 70.0, 50.0, 10.0, 30.0, 460.0, 30.0, 350.0, 40.0, 120.0, 170.0, 170.0, 40.0, 160.0, 390.0, 80.0, 70.0, 70.0, 70.0, 130.0, 60.0, 10.0, 60.0, 120.0, 70.0, 220.0, 50.0, 100.0, 30.0, 190.0, 140.0, 340.0, 150.0, -10.0, 220.0, 10.0, 40.0, 220.0, 30.0, 50.0, 490.0, 50.0, 70.0, 50.0, 20.0, 190.0, 50.0, 80.0, 150.0, 110.0, 140.0, 130.0, 200.0, 50.0, 50.0, 350.0, 100.0, 160.0, 30.0, 0.0, 50.0, 220.0, 70.0, -40.0, 20.0, 380.0, 10.0, 50.0, 30.0, 30.0, 70.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 30.0, 90.0, 200.0, 60.0, 140.0, 80.0, 50.0, 140.0, 20.0, 80.0, 0.0, 30.0, 160.0, 30.0, 0.0, 40.0, 50.0, 10.0, 230.0, 360.0, 10.0, 360.0, 160.0, -25.0, 20.0, 20.0, -40.0, 250.0, 20.0, 20.0, 20.0, 60.0, 370.0, 35.0, 60.0, 25.0, 40.0, 60.0, 0.0, 20.0, 80.0, 40.0, 420.0, 30.0, 30.0, 0.0, 30.0, 0.0, 20.0, 80.0, 70.0, 10.0, 160.0, 160.0, 50.0, 20.0, 190.0, 270.0, 50.0, 110.0, 20.0, 50.0, 120.0, 120.0, 30.0, 290.0, 20.0, 90.0, 30.0, 180.0, 50.0, 90.0, 50.0, -40.0, 410.0, 45.0, 70.0, 30.0, 370.0, 150.0, 250.0, 150.0, 310.0, 180.0, -90.0, 180.0, 90.0, -140.0, 260.0, 40.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 40.0, 380.0, 70.0, 60.0, 60.0, 270.0, 90.0, 40.0, 40.0, 150.0, 170.0, 20.0, 110.0, 210.0, 200.0, 90.0, 130.0, 40.0, 140.0, 15.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4972737880624214, "mean_inference_ms": 1.4132803772374978, "mean_action_processing_ms": 0.42357162975968016, "mean_env_wait_ms": 1.2494555384564368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012213468551635742, "StateBufferConnector_ms": 0.009520769119262695, "ViewRequirementAgentConnector_ms": 0.3798713684082031}, "num_episodes": 18, "episode_return_max": 1870.0, "episode_return_min": 150.0, "episode_return_mean": 922.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.557136536362467, "num_env_steps_trained_throughput_per_sec": 21.557136536362467, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 4720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4720000, "timers": {"training_iteration_time_ms": 185763.605, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185763.562, "sample_time_ms": 2423.525, "learn_time_ms": 183319.753, "learn_throughput": 21.82, "synch_weights_time_ms": 11.795}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "done": false, "training_iteration": 118, "trial_id": "90816_00000", "date": "2024-06-10_06-21-13", "timestamp": 1718014873, "time_this_iter_s": 185.58207511901855, "time_total_s": 22150.899792194366, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0045790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22150.899792194366, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 17.896564885496186, "ram_util_percent": 79.17748091603053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.075084359171037, "cur_kl_coeff": 37.45137875642267, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0015538055334424678, "vf_loss": 6.567957685651363, "vf_explained_var": 0.0010024723915246349, "kl": Infinity, "entropy": 0.3713440822272763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1112715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 150.0, "episode_reward_mean": 900.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -400.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 90.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [990.0, 1370.0, 1270.0, 620.0, 840.0, 1360.0, 1170.0, 500.0, 770.0, 380.0, 370.0, 795.0, 600.0, 1360.0, 1840.0, 780.0, 810.0, 1220.0, 680.0, 1870.0, 640.0, 1310.0, 600.0, 310.0, 990.0, 150.0, 545.0, 1070.0, 1400.0, 1540.0, 560.0, 1550.0, 1030.0, 1000.0, 1620.0, 820.0, 385.0, 410.0, 740.0, 350.0, 240.0, 450.0, 1395.0, 810.0, 540.0, 780.0, 655.0, 730.0, 600.0, 1390.0, 970.0, 450.0, 870.0, 1590.0, 370.0, 680.0, 1030.0, 535.0, 680.0, 495.0, 1790.0, 500.0, 980.0, 1550.0, 880.0, 1220.0, 1210.0, 1310.0, 990.0, 280.0, 820.0, 630.0, 1135.0, 690.0, 670.0, 1060.0, 880.0, 1255.0, 1340.0, 200.0, 1330.0, 1025.0, 1110.0, 1250.0, 1155.0, 630.0, 260.0, 450.0, 1270.0, 465.0, 940.0, 860.0, 830.0, 790.0, 965.0, 1315.0, 1245.0, 1230.0, 1065.0, 640.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 60.0, 110.0, 180.0, 70.0, 70.0, 110.0, 90.0, 200.0, 30.0, 40.0, 90.0, 130.0, 320.0, 140.0, 10.0, 250.0, 210.0, 120.0, 60.0, 210.0, 20.0, 150.0, 30.0, 180.0, 40.0, 320.0, 210.0, 90.0, 20.0, 40.0, 60.0, 110.0, 20.0, 170.0, 10.0, 70.0, 20.0, 60.0, 60.0, -85.0, 130.0, 0.0, -30.0, -5.0, 20.0, -140.0, 930.0, 20.0, 0.0, 90.0, 60.0, 50.0, 360.0, 70.0, 150.0, 30.0, 110.0, 350.0, 90.0, 280.0, 20.0, 50.0, 250.0, -30.0, 20.0, 50.0, 70.0, 100.0, 360.0, 150.0, 20.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 20.0, 60.0, -30.0, 140.0, 40.0, 110.0, -20.0, 380.0, 60.0, 10.0, 50.0, 30.0, 50.0, 30.0, 10.0, 70.0, 0.0, 0.0, 150.0, 30.0, 10.0, 30.0, 10.0, 0.0, 30.0, 90.0, 0.0, 30.0, 10.0, 30.0, 150.0, 20.0, -50.0, 200.0, 70.0, 15.0, 100.0, 70.0, 20.0, 90.0, 200.0, 80.0, 20.0, 90.0, 110.0, -50.0, 20.0, 150.0, 40.0, 0.0, 0.0, 220.0, -40.0, 40.0, 470.0, 340.0, 30.0, 30.0, 60.0, 350.0, 30.0, 50.0, 50.0, 260.0, 60.0, 70.0, 90.0, 450.0, 420.0, 360.0, 0.0, 80.0, -10.0, 10.0, 80.0, 30.0, -20.0, 130.0, -10.0, 500.0, 80.0, -10.0, 80.0, 30.0, 30.0, 120.0, 150.0, 220.0, 50.0, 70.0, 60.0, 0.0, 220.0, 140.0, 100.0, 60.0, 130.0, 10.0, 100.0, 80.0, 140.0, 240.0, 10.0, 40.0, -30.0, 110.0, 20.0, 50.0, 100.0, 60.0, 150.0, 170.0, 280.0, 720.0, 10.0, 40.0, 400.0, 80.0, 20.0, 90.0, 190.0, 40.0, 20.0, 240.0, -50.0, 40.0, -50.0, 10.0, 70.0, 190.0, 70.0, 100.0, 30.0, 120.0, 180.0, 10.0, 110.0, 80.0, -20.0, 320.0, 70.0, 410.0, -120.0, 40.0, 15.0, 25.0, 120.0, 190.0, 30.0, 10.0, 40.0, 250.0, 40.0, 20.0, 60.0, -20.0, 60.0, -140.0, -150.0, 60.0, 80.0, 300.0, 430.0, 100.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 220.0, 110.0, -20.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 70.0, 10.0, 240.0, 20.0, -10.0, 10.0, 165.0, 480.0, -20.0, 40.0, 40.0, 0.0, 270.0, 0.0, 70.0, 40.0, 150.0, 200.0, 30.0, 190.0, 70.0, 50.0, 50.0, 480.0, 30.0, -10.0, 310.0, 160.0, 70.0, 70.0, 530.0, 30.0, 270.0, 60.0, 150.0, 230.0, -30.0, 70.0, -20.0, 270.0, 0.0, 10.0, 20.0, 160.0, 30.0, 0.0, 20.0, 20.0, 190.0, 140.0, 60.0, 320.0, 0.0, 510.0, 70.0, 170.0, 70.0, 40.0, 130.0, 120.0, 110.0, 40.0, 50.0, 300.0, 0.0, 180.0, 60.0, 50.0, 10.0, 30.0, 80.0, 80.0, 0.0, 210.0, 350.0, 20.0, 170.0, 410.0, 110.0, 120.0, 230.0, 40.0, 80.0, -40.0, 20.0, 150.0, 500.0, 170.0, 30.0, 70.0, 180.0, 40.0, 20.0, 130.0, 50.0, 110.0, 20.0, 30.0, 210.0, -190.0, 110.0, 100.0, 0.0, 110.0, 40.0, 10.0, -35.0, 30.0, 40.0, -10.0, 180.0, -400.0, 80.0, 180.0, 80.0, 20.0, 210.0, 60.0, 100.0, 10.0, 20.0, 210.0, 0.0, 0.0, 320.0, 10.0, 10.0, 160.0, 0.0, 20.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 120.0, 40.0, 20.0, 0.0, 120.0, 20.0, 90.0, 10.0, 60.0, 10.0, 30.0, 60.0, 50.0, 20.0, 450.0, 55.0, 90.0, 80.0, 70.0, 100.0, 180.0, 290.0, 60.0, 40.0, 80.0, -20.0, 40.0, 380.0, 10.0, 70.0, 20.0, 170.0, 20.0, 120.0, 80.0, 60.0, 40.0, 40.0, 70.0, 20.0, 20.0, 80.0, 10.0, 80.0, 90.0, 60.0, 20.0, 120.0, 50.0, 40.0, 60.0, 50.0, 210.0, 5.0, 20.0, 40.0, 300.0, 20.0, 80.0, 0.0, 30.0, 30.0, 130.0, 40.0, 0.0, 160.0, 100.0, 70.0, 70.0, 90.0, 20.0, 60.0, 120.0, 70.0, 20.0, 30.0, 110.0, 20.0, 110.0, 90.0, 10.0, 60.0, 80.0, 30.0, 80.0, 280.0, 70.0, 40.0, 390.0, 170.0, 120.0, 60.0, 150.0, 20.0, 10.0, 20.0, 40.0, 10.0, 40.0, 30.0, 590.0, 240.0, -30.0, 50.0, 0.0, 30.0, 20.0, 20.0, 140.0, 10.0, 160.0, 10.0, 10.0, 30.0, 150.0, 70.0, 0.0, 40.0, 40.0, 140.0, 30.0, 320.0, 50.0, 380.0, 430.0, 20.0, 30.0, -20.0, 0.0, 30.0, 110.0, 480.0, 130.0, 60.0, 30.0, 80.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 120.0, 250.0, 10.0, 40.0, 20.0, 160.0, -20.0, 50.0, 0.0, 20.0, 180.0, 260.0, 40.0, 170.0, 40.0, 30.0, 230.0, 60.0, 15.0, 20.0, 270.0, 150.0, 20.0, 10.0, 10.0, -40.0, 40.0, 40.0, 100.0, -10.0, 150.0, 50.0, 0.0, 0.0, 40.0, -100.0, 400.0, 50.0, 5.0, 30.0, -5.0, 170.0, 20.0, 20.0, 5.0, 260.0, -30.0, 20.0, 50.0, 300.0, 0.0, 360.0, 360.0, 70.0, 370.0, 100.0, 140.0, 40.0, 10.0, 10.0, 70.0, 50.0, 70.0, 50.0, 150.0, 30.0, 40.0, 20.0, 70.0, 150.0, 70.0, 20.0, 50.0, 70.0, 50.0, 10.0, 30.0, 460.0, 30.0, 350.0, 40.0, 120.0, 170.0, 170.0, 40.0, 160.0, 390.0, 80.0, 70.0, 70.0, 70.0, 130.0, 60.0, 10.0, 60.0, 120.0, 70.0, 220.0, 50.0, 100.0, 30.0, 190.0, 140.0, 340.0, 150.0, -10.0, 220.0, 10.0, 40.0, 220.0, 30.0, 50.0, 490.0, 50.0, 70.0, 50.0, 20.0, 190.0, 50.0, 80.0, 150.0, 110.0, 140.0, 130.0, 200.0, 50.0, 50.0, 350.0, 100.0, 160.0, 30.0, 0.0, 50.0, 220.0, 70.0, -40.0, 20.0, 380.0, 10.0, 50.0, 30.0, 30.0, 70.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 30.0, 90.0, 200.0, 60.0, 140.0, 80.0, 50.0, 140.0, 20.0, 80.0, 0.0, 30.0, 160.0, 30.0, 0.0, 40.0, 50.0, 10.0, 230.0, 360.0, 10.0, 360.0, 160.0, -25.0, 20.0, 20.0, -40.0, 250.0, 20.0, 20.0, 20.0, 60.0, 370.0, 35.0, 60.0, 25.0, 40.0, 60.0, 0.0, 20.0, 80.0, 40.0, 420.0, 30.0, 30.0, 0.0, 30.0, 0.0, 20.0, 80.0, 70.0, 10.0, 160.0, 160.0, 50.0, 20.0, 190.0, 270.0, 50.0, 110.0, 20.0, 50.0, 120.0, 120.0, 30.0, 290.0, 20.0, 90.0, 30.0, 180.0, 50.0, 90.0, 50.0, -40.0, 410.0, 45.0, 70.0, 30.0, 370.0, 150.0, 250.0, 150.0, 310.0, 180.0, -90.0, 180.0, 90.0, -140.0, 260.0, 40.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 40.0, 380.0, 70.0, 60.0, 60.0, 270.0, 90.0, 40.0, 40.0, 150.0, 170.0, 20.0, 110.0, 210.0, 200.0, 90.0, 130.0, 40.0, 140.0, 15.0, 70.0, 530.0, 70.0, 0.0, 120.0, 150.0, -210.0, 40.0, -150.0, 310.0, 250.0, 40.0, 40.0, 60.0, 50.0, 230.0, 170.0, 70.0, 270.0, 220.0, 100.0, 25.0, 50.0, 0.0, -20.0, 100.0, 110.0, 220.0, 180.0, 480.0, 10.0, 270.0, 20.0, 10.0, 60.0, 70.0, 30.0, 20.0, 50.0, 60.0, 40.0, 30.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 50.0, 10.0, 0.0, 250.0, 30.0, 40.0, 20.0, 20.0, 30.0, 0.0, 80.0, 320.0, 90.0, 270.0, 80.0, 170.0, 60.0, 70.0, 40.0, 90.0, 160.0, 30.0, 20.0, 20.0, 10.0, 110.0, 20.0, 15.0, 40.0, 40.0, 130.0, 80.0, 10.0, 70.0, 390.0, 30.0, 170.0, 0.0, 20.0, 40.0, 250.0, 130.0, 40.0, -40.0, 80.0, 40.0, 0.0, 270.0, 50.0, 40.0, 40.0, 180.0, 10.0, 40.0, 130.0, 0.0, 60.0, 120.0, 60.0, 190.0, 100.0, 220.0, 90.0, 10.0, 10.0, 200.0, 70.0, 30.0, 60.0, 0.0, 260.0, 0.0, 180.0, 280.0, 20.0, 5.0, 110.0, 60.0, 30.0, 20.0, 0.0, 200.0, 40.0, 180.0, -20.0, -50.0, 720.0, -15.0, 150.0, 110.0, 10.0, 50.0, 130.0, -125.0, 170.0, 180.0, 0.0, 170.0, 620.0, 40.0, 120.0, 10.0, 110.0, 0.0, 90.0, 30.0, 450.0, 20.0, 80.0, 320.0, 170.0, 250.0, 10.0, 50.0, -75.0, 30.0, 120.0, 140.0, 370.0, 0.0, 0.0, 70.0, 120.0, 80.0, 20.0, 70.0, 10.0, 10.0, 220.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4965292983416634, "mean_inference_ms": 1.4141029694776284, "mean_action_processing_ms": 0.4239239920043802, "mean_env_wait_ms": 1.250050129752993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012413978576660156, "StateBufferConnector_ms": 0.00964045524597168, "ViewRequirementAgentConnector_ms": 0.4031405448913574}, "num_episodes": 18, "episode_return_max": 1870.0, "episode_return_min": 150.0, "episode_return_mean": 900.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.21270895154918, "num_env_steps_trained_throughput_per_sec": 21.21270895154918, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 4760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4760000, "timers": {"training_iteration_time_ms": 186110.396, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186110.351, "sample_time_ms": 2488.04, "learn_time_ms": 183602.196, "learn_throughput": 21.786, "synch_weights_time_ms": 11.682}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "done": false, "training_iteration": 119, "trial_id": "90816_00000", "date": "2024-06-10_06-24-22", "timestamp": 1718015062, "time_this_iter_s": 188.57572603225708, "time_total_s": 22339.475518226624, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b008e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22339.475518226624, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 20.500374531835206, "ram_util_percent": 80.13558052434458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.058381891821901, "cur_kl_coeff": 56.17706813463403, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.469485114049861, "policy_loss": -0.001360062927853701, "vf_loss": 6.467930367452522, "vf_explained_var": 0.0001694489337892705, "kl": 5.188592892509461e-05, "entropy": 0.36750861017848735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1122105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "env_runners": {"episode_reward_max": 1975.0, "episode_reward_min": 150.0, "episode_reward_mean": 914.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -400.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 91.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.0, 990.0, 150.0, 545.0, 1070.0, 1400.0, 1540.0, 560.0, 1550.0, 1030.0, 1000.0, 1620.0, 820.0, 385.0, 410.0, 740.0, 350.0, 240.0, 450.0, 1395.0, 810.0, 540.0, 780.0, 655.0, 730.0, 600.0, 1390.0, 970.0, 450.0, 870.0, 1590.0, 370.0, 680.0, 1030.0, 535.0, 680.0, 495.0, 1790.0, 500.0, 980.0, 1550.0, 880.0, 1220.0, 1210.0, 1310.0, 990.0, 280.0, 820.0, 630.0, 1135.0, 690.0, 670.0, 1060.0, 880.0, 1255.0, 1340.0, 200.0, 1330.0, 1025.0, 1110.0, 1250.0, 1155.0, 630.0, 260.0, 450.0, 1270.0, 465.0, 940.0, 860.0, 830.0, 790.0, 965.0, 1315.0, 1245.0, 1230.0, 1065.0, 640.0, 1480.0, 990.0, 1380.0, 1000.0, 285.0, 1555.0, 325.0, 1975.0, 1390.0, 1870.0, 320.0, 1030.0, 550.0, 550.0, 1840.0, 885.0, 930.0, 885.0, 640.0, 1050.0, 1370.0, 355.0, 850.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 20.0, 60.0, -20.0, 60.0, -140.0, -150.0, 60.0, 80.0, 300.0, 430.0, 100.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 220.0, 110.0, -20.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 70.0, 10.0, 240.0, 20.0, -10.0, 10.0, 165.0, 480.0, -20.0, 40.0, 40.0, 0.0, 270.0, 0.0, 70.0, 40.0, 150.0, 200.0, 30.0, 190.0, 70.0, 50.0, 50.0, 480.0, 30.0, -10.0, 310.0, 160.0, 70.0, 70.0, 530.0, 30.0, 270.0, 60.0, 150.0, 230.0, -30.0, 70.0, -20.0, 270.0, 0.0, 10.0, 20.0, 160.0, 30.0, 0.0, 20.0, 20.0, 190.0, 140.0, 60.0, 320.0, 0.0, 510.0, 70.0, 170.0, 70.0, 40.0, 130.0, 120.0, 110.0, 40.0, 50.0, 300.0, 0.0, 180.0, 60.0, 50.0, 10.0, 30.0, 80.0, 80.0, 0.0, 210.0, 350.0, 20.0, 170.0, 410.0, 110.0, 120.0, 230.0, 40.0, 80.0, -40.0, 20.0, 150.0, 500.0, 170.0, 30.0, 70.0, 180.0, 40.0, 20.0, 130.0, 50.0, 110.0, 20.0, 30.0, 210.0, -190.0, 110.0, 100.0, 0.0, 110.0, 40.0, 10.0, -35.0, 30.0, 40.0, -10.0, 180.0, -400.0, 80.0, 180.0, 80.0, 20.0, 210.0, 60.0, 100.0, 10.0, 20.0, 210.0, 0.0, 0.0, 320.0, 10.0, 10.0, 160.0, 0.0, 20.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 120.0, 40.0, 20.0, 0.0, 120.0, 20.0, 90.0, 10.0, 60.0, 10.0, 30.0, 60.0, 50.0, 20.0, 450.0, 55.0, 90.0, 80.0, 70.0, 100.0, 180.0, 290.0, 60.0, 40.0, 80.0, -20.0, 40.0, 380.0, 10.0, 70.0, 20.0, 170.0, 20.0, 120.0, 80.0, 60.0, 40.0, 40.0, 70.0, 20.0, 20.0, 80.0, 10.0, 80.0, 90.0, 60.0, 20.0, 120.0, 50.0, 40.0, 60.0, 50.0, 210.0, 5.0, 20.0, 40.0, 300.0, 20.0, 80.0, 0.0, 30.0, 30.0, 130.0, 40.0, 0.0, 160.0, 100.0, 70.0, 70.0, 90.0, 20.0, 60.0, 120.0, 70.0, 20.0, 30.0, 110.0, 20.0, 110.0, 90.0, 10.0, 60.0, 80.0, 30.0, 80.0, 280.0, 70.0, 40.0, 390.0, 170.0, 120.0, 60.0, 150.0, 20.0, 10.0, 20.0, 40.0, 10.0, 40.0, 30.0, 590.0, 240.0, -30.0, 50.0, 0.0, 30.0, 20.0, 20.0, 140.0, 10.0, 160.0, 10.0, 10.0, 30.0, 150.0, 70.0, 0.0, 40.0, 40.0, 140.0, 30.0, 320.0, 50.0, 380.0, 430.0, 20.0, 30.0, -20.0, 0.0, 30.0, 110.0, 480.0, 130.0, 60.0, 30.0, 80.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 120.0, 250.0, 10.0, 40.0, 20.0, 160.0, -20.0, 50.0, 0.0, 20.0, 180.0, 260.0, 40.0, 170.0, 40.0, 30.0, 230.0, 60.0, 15.0, 20.0, 270.0, 150.0, 20.0, 10.0, 10.0, -40.0, 40.0, 40.0, 100.0, -10.0, 150.0, 50.0, 0.0, 0.0, 40.0, -100.0, 400.0, 50.0, 5.0, 30.0, -5.0, 170.0, 20.0, 20.0, 5.0, 260.0, -30.0, 20.0, 50.0, 300.0, 0.0, 360.0, 360.0, 70.0, 370.0, 100.0, 140.0, 40.0, 10.0, 10.0, 70.0, 50.0, 70.0, 50.0, 150.0, 30.0, 40.0, 20.0, 70.0, 150.0, 70.0, 20.0, 50.0, 70.0, 50.0, 10.0, 30.0, 460.0, 30.0, 350.0, 40.0, 120.0, 170.0, 170.0, 40.0, 160.0, 390.0, 80.0, 70.0, 70.0, 70.0, 130.0, 60.0, 10.0, 60.0, 120.0, 70.0, 220.0, 50.0, 100.0, 30.0, 190.0, 140.0, 340.0, 150.0, -10.0, 220.0, 10.0, 40.0, 220.0, 30.0, 50.0, 490.0, 50.0, 70.0, 50.0, 20.0, 190.0, 50.0, 80.0, 150.0, 110.0, 140.0, 130.0, 200.0, 50.0, 50.0, 350.0, 100.0, 160.0, 30.0, 0.0, 50.0, 220.0, 70.0, -40.0, 20.0, 380.0, 10.0, 50.0, 30.0, 30.0, 70.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 30.0, 90.0, 200.0, 60.0, 140.0, 80.0, 50.0, 140.0, 20.0, 80.0, 0.0, 30.0, 160.0, 30.0, 0.0, 40.0, 50.0, 10.0, 230.0, 360.0, 10.0, 360.0, 160.0, -25.0, 20.0, 20.0, -40.0, 250.0, 20.0, 20.0, 20.0, 60.0, 370.0, 35.0, 60.0, 25.0, 40.0, 60.0, 0.0, 20.0, 80.0, 40.0, 420.0, 30.0, 30.0, 0.0, 30.0, 0.0, 20.0, 80.0, 70.0, 10.0, 160.0, 160.0, 50.0, 20.0, 190.0, 270.0, 50.0, 110.0, 20.0, 50.0, 120.0, 120.0, 30.0, 290.0, 20.0, 90.0, 30.0, 180.0, 50.0, 90.0, 50.0, -40.0, 410.0, 45.0, 70.0, 30.0, 370.0, 150.0, 250.0, 150.0, 310.0, 180.0, -90.0, 180.0, 90.0, -140.0, 260.0, 40.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 40.0, 380.0, 70.0, 60.0, 60.0, 270.0, 90.0, 40.0, 40.0, 150.0, 170.0, 20.0, 110.0, 210.0, 200.0, 90.0, 130.0, 40.0, 140.0, 15.0, 70.0, 530.0, 70.0, 0.0, 120.0, 150.0, -210.0, 40.0, -150.0, 310.0, 250.0, 40.0, 40.0, 60.0, 50.0, 230.0, 170.0, 70.0, 270.0, 220.0, 100.0, 25.0, 50.0, 0.0, -20.0, 100.0, 110.0, 220.0, 180.0, 480.0, 10.0, 270.0, 20.0, 10.0, 60.0, 70.0, 30.0, 20.0, 50.0, 60.0, 40.0, 30.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 50.0, 10.0, 0.0, 250.0, 30.0, 40.0, 20.0, 20.0, 30.0, 0.0, 80.0, 320.0, 90.0, 270.0, 80.0, 170.0, 60.0, 70.0, 40.0, 90.0, 160.0, 30.0, 20.0, 20.0, 10.0, 110.0, 20.0, 15.0, 40.0, 40.0, 130.0, 80.0, 10.0, 70.0, 390.0, 30.0, 170.0, 0.0, 20.0, 40.0, 250.0, 130.0, 40.0, -40.0, 80.0, 40.0, 0.0, 270.0, 50.0, 40.0, 40.0, 180.0, 10.0, 40.0, 130.0, 0.0, 60.0, 120.0, 60.0, 190.0, 100.0, 220.0, 90.0, 10.0, 10.0, 200.0, 70.0, 30.0, 60.0, 0.0, 260.0, 0.0, 180.0, 280.0, 20.0, 5.0, 110.0, 60.0, 30.0, 20.0, 0.0, 200.0, 40.0, 180.0, -20.0, -50.0, 720.0, -15.0, 150.0, 110.0, 10.0, 50.0, 130.0, -125.0, 170.0, 180.0, 0.0, 170.0, 620.0, 40.0, 120.0, 10.0, 110.0, 0.0, 90.0, 30.0, 450.0, 20.0, 80.0, 320.0, 170.0, 250.0, 10.0, 50.0, -75.0, 30.0, 120.0, 140.0, 370.0, 0.0, 0.0, 70.0, 120.0, 80.0, 20.0, 70.0, 10.0, 10.0, 220.0, 40.0, 460.0, 130.0, 50.0, -20.0, 270.0, 160.0, 110.0, 120.0, 100.0, 100.0, 10.0, 120.0, 160.0, 320.0, 160.0, 110.0, 15.0, -5.0, 70.0, 30.0, 100.0, 130.0, 210.0, 20.0, 150.0, 250.0, 60.0, 120.0, 70.0, 270.0, 50.0, 520.0, 20.0, 110.0, 40.0, 100.0, 20.0, 10.0, 90.0, 40.0, 40.0, 0.0, 110.0, 15.0, 20.0, 70.0, 20.0, 10.0, 30.0, -30.0, 30.0, 65.0, 110.0, 210.0, 290.0, 40.0, 580.0, 90.0, 60.0, 80.0, -25.0, 40.0, 0.0, 20.0, 10.0, 20.0, 160.0, 20.0, 60.0, 20.0, 170.0, 500.0, 90.0, 90.0, 480.0, 110.0, 5.0, 220.0, 210.0, 100.0, 120.0, -30.0, 70.0, 370.0, 150.0, 50.0, -20.0, 370.0, 230.0, 80.0, 260.0, 100.0, 60.0, 230.0, 300.0, 20.0, 300.0, 80.0, 440.0, 80.0, 30.0, 0.0, 20.0, 10.0, 40.0, 160.0, 0.0, 0.0, 30.0, 30.0, -50.0, 30.0, 100.0, 30.0, 390.0, 490.0, -30.0, 110.0, 10.0, -50.0, 10.0, 20.0, 130.0, 0.0, 100.0, 20.0, 10.0, 100.0, 60.0, 100.0, 0.0, 210.0, 10.0, 50.0, 10.0, 20.0, 40.0, 40.0, 30.0, 140.0, 160.0, 260.0, 90.0, 160.0, 140.0, 40.0, 360.0, 220.0, 70.0, 340.0, 120.0, 70.0, 85.0, 70.0, 10.0, 30.0, 20.0, 0.0, 470.0, 10.0, 220.0, 20.0, 90.0, 40.0, 40.0, 170.0, 180.0, 110.0, 50.0, 10.0, 10.0, 360.0, 10.0, 30.0, 10.0, 120.0, 90.0, 50.0, -25.0, 230.0, 200.0, 10.0, 70.0, 80.0, 100.0, 50.0, -10.0, 80.0, 20.0, 40.0, 270.0, 80.0, 0.0, 30.0, 170.0, -20.0, 50.0, 340.0, 70.0, 60.0, 450.0, 200.0, 60.0, 100.0, 60.0, 110.0, 100.0, 30.0, 70.0, 190.0, 110.0, -15.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 110.0, 30.0, 0.0, 90.0, 50.0, 270.0, 230.0, -40.0, 40.0, 40.0, 40.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4956900481463535, "mean_inference_ms": 1.4151720840162674, "mean_action_processing_ms": 0.42387414746783314, "mean_env_wait_ms": 1.2506862209886387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012090921401977539, "StateBufferConnector_ms": 0.009465694427490234, "ViewRequirementAgentConnector_ms": 0.39942455291748047}, "num_episodes": 23, "episode_return_max": 1975.0, "episode_return_min": 150.0, "episode_return_mean": 914.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.343990509991404, "num_env_steps_trained_throughput_per_sec": 21.343990509991404, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 4800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4800000, "timers": {"training_iteration_time_ms": 186119.407, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186119.363, "sample_time_ms": 2504.604, "learn_time_ms": 183594.85, "learn_throughput": 21.787, "synch_weights_time_ms": 11.586}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "done": false, "training_iteration": 120, "trial_id": "90816_00000", "date": "2024-06-10_06-27-30", "timestamp": 1718015250, "time_this_iter_s": 187.41397666931152, "time_total_s": 22526.889494895935, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00999d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22526.889494895935, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 19.459999999999997, "ram_util_percent": 78.88075471698114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9584278369737, "cur_kl_coeff": 28.088534067317013, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.15510660599088, "policy_loss": -0.001793831100397772, "vf_loss": 7.154179572652831, "vf_explained_var": 0.0003377810072975037, "kl": 9.686743846076771e-05, "entropy": 0.3504612988747728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1131495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "env_runners": {"episode_reward_max": 1975.0, "episode_reward_min": 200.0, "episode_reward_mean": 954.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 95.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [450.0, 1395.0, 810.0, 540.0, 780.0, 655.0, 730.0, 600.0, 1390.0, 970.0, 450.0, 870.0, 1590.0, 370.0, 680.0, 1030.0, 535.0, 680.0, 495.0, 1790.0, 500.0, 980.0, 1550.0, 880.0, 1220.0, 1210.0, 1310.0, 990.0, 280.0, 820.0, 630.0, 1135.0, 690.0, 670.0, 1060.0, 880.0, 1255.0, 1340.0, 200.0, 1330.0, 1025.0, 1110.0, 1250.0, 1155.0, 630.0, 260.0, 450.0, 1270.0, 465.0, 940.0, 860.0, 830.0, 790.0, 965.0, 1315.0, 1245.0, 1230.0, 1065.0, 640.0, 1480.0, 990.0, 1380.0, 1000.0, 285.0, 1555.0, 325.0, 1975.0, 1390.0, 1870.0, 320.0, 1030.0, 550.0, 550.0, 1840.0, 885.0, 930.0, 885.0, 640.0, 1050.0, 1370.0, 355.0, 850.0, 1340.0, 720.0, 560.0, 1385.0, 270.0, 660.0, 445.0, 1650.0, 1680.0, 1320.0, 1320.0, 1215.0, 670.0, 1100.0, 1310.0, 410.0, 1800.0, 875.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 120.0, 20.0, 90.0, 10.0, 60.0, 10.0, 30.0, 60.0, 50.0, 20.0, 450.0, 55.0, 90.0, 80.0, 70.0, 100.0, 180.0, 290.0, 60.0, 40.0, 80.0, -20.0, 40.0, 380.0, 10.0, 70.0, 20.0, 170.0, 20.0, 120.0, 80.0, 60.0, 40.0, 40.0, 70.0, 20.0, 20.0, 80.0, 10.0, 80.0, 90.0, 60.0, 20.0, 120.0, 50.0, 40.0, 60.0, 50.0, 210.0, 5.0, 20.0, 40.0, 300.0, 20.0, 80.0, 0.0, 30.0, 30.0, 130.0, 40.0, 0.0, 160.0, 100.0, 70.0, 70.0, 90.0, 20.0, 60.0, 120.0, 70.0, 20.0, 30.0, 110.0, 20.0, 110.0, 90.0, 10.0, 60.0, 80.0, 30.0, 80.0, 280.0, 70.0, 40.0, 390.0, 170.0, 120.0, 60.0, 150.0, 20.0, 10.0, 20.0, 40.0, 10.0, 40.0, 30.0, 590.0, 240.0, -30.0, 50.0, 0.0, 30.0, 20.0, 20.0, 140.0, 10.0, 160.0, 10.0, 10.0, 30.0, 150.0, 70.0, 0.0, 40.0, 40.0, 140.0, 30.0, 320.0, 50.0, 380.0, 430.0, 20.0, 30.0, -20.0, 0.0, 30.0, 110.0, 480.0, 130.0, 60.0, 30.0, 80.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 120.0, 250.0, 10.0, 40.0, 20.0, 160.0, -20.0, 50.0, 0.0, 20.0, 180.0, 260.0, 40.0, 170.0, 40.0, 30.0, 230.0, 60.0, 15.0, 20.0, 270.0, 150.0, 20.0, 10.0, 10.0, -40.0, 40.0, 40.0, 100.0, -10.0, 150.0, 50.0, 0.0, 0.0, 40.0, -100.0, 400.0, 50.0, 5.0, 30.0, -5.0, 170.0, 20.0, 20.0, 5.0, 260.0, -30.0, 20.0, 50.0, 300.0, 0.0, 360.0, 360.0, 70.0, 370.0, 100.0, 140.0, 40.0, 10.0, 10.0, 70.0, 50.0, 70.0, 50.0, 150.0, 30.0, 40.0, 20.0, 70.0, 150.0, 70.0, 20.0, 50.0, 70.0, 50.0, 10.0, 30.0, 460.0, 30.0, 350.0, 40.0, 120.0, 170.0, 170.0, 40.0, 160.0, 390.0, 80.0, 70.0, 70.0, 70.0, 130.0, 60.0, 10.0, 60.0, 120.0, 70.0, 220.0, 50.0, 100.0, 30.0, 190.0, 140.0, 340.0, 150.0, -10.0, 220.0, 10.0, 40.0, 220.0, 30.0, 50.0, 490.0, 50.0, 70.0, 50.0, 20.0, 190.0, 50.0, 80.0, 150.0, 110.0, 140.0, 130.0, 200.0, 50.0, 50.0, 350.0, 100.0, 160.0, 30.0, 0.0, 50.0, 220.0, 70.0, -40.0, 20.0, 380.0, 10.0, 50.0, 30.0, 30.0, 70.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 30.0, 90.0, 200.0, 60.0, 140.0, 80.0, 50.0, 140.0, 20.0, 80.0, 0.0, 30.0, 160.0, 30.0, 0.0, 40.0, 50.0, 10.0, 230.0, 360.0, 10.0, 360.0, 160.0, -25.0, 20.0, 20.0, -40.0, 250.0, 20.0, 20.0, 20.0, 60.0, 370.0, 35.0, 60.0, 25.0, 40.0, 60.0, 0.0, 20.0, 80.0, 40.0, 420.0, 30.0, 30.0, 0.0, 30.0, 0.0, 20.0, 80.0, 70.0, 10.0, 160.0, 160.0, 50.0, 20.0, 190.0, 270.0, 50.0, 110.0, 20.0, 50.0, 120.0, 120.0, 30.0, 290.0, 20.0, 90.0, 30.0, 180.0, 50.0, 90.0, 50.0, -40.0, 410.0, 45.0, 70.0, 30.0, 370.0, 150.0, 250.0, 150.0, 310.0, 180.0, -90.0, 180.0, 90.0, -140.0, 260.0, 40.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 40.0, 380.0, 70.0, 60.0, 60.0, 270.0, 90.0, 40.0, 40.0, 150.0, 170.0, 20.0, 110.0, 210.0, 200.0, 90.0, 130.0, 40.0, 140.0, 15.0, 70.0, 530.0, 70.0, 0.0, 120.0, 150.0, -210.0, 40.0, -150.0, 310.0, 250.0, 40.0, 40.0, 60.0, 50.0, 230.0, 170.0, 70.0, 270.0, 220.0, 100.0, 25.0, 50.0, 0.0, -20.0, 100.0, 110.0, 220.0, 180.0, 480.0, 10.0, 270.0, 20.0, 10.0, 60.0, 70.0, 30.0, 20.0, 50.0, 60.0, 40.0, 30.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 50.0, 10.0, 0.0, 250.0, 30.0, 40.0, 20.0, 20.0, 30.0, 0.0, 80.0, 320.0, 90.0, 270.0, 80.0, 170.0, 60.0, 70.0, 40.0, 90.0, 160.0, 30.0, 20.0, 20.0, 10.0, 110.0, 20.0, 15.0, 40.0, 40.0, 130.0, 80.0, 10.0, 70.0, 390.0, 30.0, 170.0, 0.0, 20.0, 40.0, 250.0, 130.0, 40.0, -40.0, 80.0, 40.0, 0.0, 270.0, 50.0, 40.0, 40.0, 180.0, 10.0, 40.0, 130.0, 0.0, 60.0, 120.0, 60.0, 190.0, 100.0, 220.0, 90.0, 10.0, 10.0, 200.0, 70.0, 30.0, 60.0, 0.0, 260.0, 0.0, 180.0, 280.0, 20.0, 5.0, 110.0, 60.0, 30.0, 20.0, 0.0, 200.0, 40.0, 180.0, -20.0, -50.0, 720.0, -15.0, 150.0, 110.0, 10.0, 50.0, 130.0, -125.0, 170.0, 180.0, 0.0, 170.0, 620.0, 40.0, 120.0, 10.0, 110.0, 0.0, 90.0, 30.0, 450.0, 20.0, 80.0, 320.0, 170.0, 250.0, 10.0, 50.0, -75.0, 30.0, 120.0, 140.0, 370.0, 0.0, 0.0, 70.0, 120.0, 80.0, 20.0, 70.0, 10.0, 10.0, 220.0, 40.0, 460.0, 130.0, 50.0, -20.0, 270.0, 160.0, 110.0, 120.0, 100.0, 100.0, 10.0, 120.0, 160.0, 320.0, 160.0, 110.0, 15.0, -5.0, 70.0, 30.0, 100.0, 130.0, 210.0, 20.0, 150.0, 250.0, 60.0, 120.0, 70.0, 270.0, 50.0, 520.0, 20.0, 110.0, 40.0, 100.0, 20.0, 10.0, 90.0, 40.0, 40.0, 0.0, 110.0, 15.0, 20.0, 70.0, 20.0, 10.0, 30.0, -30.0, 30.0, 65.0, 110.0, 210.0, 290.0, 40.0, 580.0, 90.0, 60.0, 80.0, -25.0, 40.0, 0.0, 20.0, 10.0, 20.0, 160.0, 20.0, 60.0, 20.0, 170.0, 500.0, 90.0, 90.0, 480.0, 110.0, 5.0, 220.0, 210.0, 100.0, 120.0, -30.0, 70.0, 370.0, 150.0, 50.0, -20.0, 370.0, 230.0, 80.0, 260.0, 100.0, 60.0, 230.0, 300.0, 20.0, 300.0, 80.0, 440.0, 80.0, 30.0, 0.0, 20.0, 10.0, 40.0, 160.0, 0.0, 0.0, 30.0, 30.0, -50.0, 30.0, 100.0, 30.0, 390.0, 490.0, -30.0, 110.0, 10.0, -50.0, 10.0, 20.0, 130.0, 0.0, 100.0, 20.0, 10.0, 100.0, 60.0, 100.0, 0.0, 210.0, 10.0, 50.0, 10.0, 20.0, 40.0, 40.0, 30.0, 140.0, 160.0, 260.0, 90.0, 160.0, 140.0, 40.0, 360.0, 220.0, 70.0, 340.0, 120.0, 70.0, 85.0, 70.0, 10.0, 30.0, 20.0, 0.0, 470.0, 10.0, 220.0, 20.0, 90.0, 40.0, 40.0, 170.0, 180.0, 110.0, 50.0, 10.0, 10.0, 360.0, 10.0, 30.0, 10.0, 120.0, 90.0, 50.0, -25.0, 230.0, 200.0, 10.0, 70.0, 80.0, 100.0, 50.0, -10.0, 80.0, 20.0, 40.0, 270.0, 80.0, 0.0, 30.0, 170.0, -20.0, 50.0, 340.0, 70.0, 60.0, 450.0, 200.0, 60.0, 100.0, 60.0, 110.0, 100.0, 30.0, 70.0, 190.0, 110.0, -15.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 110.0, 30.0, 0.0, 90.0, 50.0, 270.0, 230.0, -40.0, 40.0, 40.0, 40.0, 130.0, 240.0, 50.0, 90.0, 180.0, 320.0, 20.0, 90.0, 50.0, 250.0, 50.0, 60.0, 30.0, 200.0, 50.0, 30.0, 0.0, 270.0, -50.0, 50.0, 80.0, 10.0, 50.0, 40.0, 60.0, 50.0, 30.0, 40.0, 200.0, 30.0, 50.0, 220.0, 170.0, 25.0, -20.0, 490.0, 40.0, -30.0, 210.0, 60.0, 220.0, 0.0, 40.0, 50.0, 10.0, 0.0, 70.0, 10.0, 0.0, 0.0, 90.0, 320.0, 80.0, 0.0, 70.0, 40.0, 30.0, 30.0, 0.0, 0.0, 90.0, 40.0, 90.0, 35.0, 40.0, 10.0, 20.0, 40.0, 150.0, 30.0, -10.0, 890.0, 40.0, 160.0, 0.0, 130.0, 80.0, 180.0, 30.0, 60.0, 80.0, 50.0, 0.0, 310.0, 350.0, 120.0, 160.0, 70.0, 150.0, 400.0, 70.0, 70.0, 70.0, 40.0, 60.0, 80.0, 480.0, 180.0, 150.0, 190.0, 0.0, 50.0, 150.0, 80.0, 190.0, 60.0, 170.0, 320.0, 60.0, 80.0, 160.0, 30.0, 50.0, -15.0, 100.0, -30.0, 560.0, 410.0, 10.0, 20.0, 80.0, 70.0, 30.0, 100.0, 180.0, 20.0, 70.0, 30.0, 100.0, 40.0, 30.0, 280.0, 30.0, 140.0, 130.0, 220.0, 20.0, -20.0, 80.0, 70.0, 150.0, 380.0, -20.0, 400.0, 80.0, 210.0, 30.0, 20.0, -20.0, 50.0, 180.0, 60.0, 20.0, 30.0, 50.0, 0.0, 150.0, 100.0, -10.0, 0.0, 10.0, 330.0, 60.0, 500.0, 90.0, 220.0, 80.0, 150.0, 170.0, 120.0, 80.0, -50.0, -50.0, 10.0, 35.0, 400.0, 220.0, 90.0, 80.0, 100.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.495001770141133, "mean_inference_ms": 1.4157150769895532, "mean_action_processing_ms": 0.4237260217257972, "mean_env_wait_ms": 1.250983715141507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012043237686157227, "StateBufferConnector_ms": 0.009424686431884766, "ViewRequirementAgentConnector_ms": 0.3950037956237793}, "num_episodes": 18, "episode_return_max": 1975.0, "episode_return_min": 200.0, "episode_return_mean": 954.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.578114681332302, "num_env_steps_trained_throughput_per_sec": 21.578114681332302, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 4840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4840000, "timers": {"training_iteration_time_ms": 186094.193, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186094.149, "sample_time_ms": 2460.771, "learn_time_ms": 183613.529, "learn_throughput": 21.785, "synch_weights_time_ms": 11.724}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "done": false, "training_iteration": 121, "trial_id": "90816_00000", "date": "2024-06-10_06-30-35", "timestamp": 1718015435, "time_this_iter_s": 185.3835198879242, "time_total_s": 22712.27301478386, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0082ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22712.27301478386, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 17.699236641221376, "ram_util_percent": 78.70610687022901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.333243897903207, "cur_kl_coeff": 14.044267033658507, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.694241035682833, "policy_loss": -0.0029495175079620097, "vf_loss": 6.694234520939593, "vf_explained_var": 2.5237945956797898e-05, "kl": 0.00021047962274636214, "entropy": 0.3609014566999655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1140885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "env_runners": {"episode_reward_max": 1975.0, "episode_reward_min": 200.0, "episode_reward_mean": 977.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 97.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1550.0, 880.0, 1220.0, 1210.0, 1310.0, 990.0, 280.0, 820.0, 630.0, 1135.0, 690.0, 670.0, 1060.0, 880.0, 1255.0, 1340.0, 200.0, 1330.0, 1025.0, 1110.0, 1250.0, 1155.0, 630.0, 260.0, 450.0, 1270.0, 465.0, 940.0, 860.0, 830.0, 790.0, 965.0, 1315.0, 1245.0, 1230.0, 1065.0, 640.0, 1480.0, 990.0, 1380.0, 1000.0, 285.0, 1555.0, 325.0, 1975.0, 1390.0, 1870.0, 320.0, 1030.0, 550.0, 550.0, 1840.0, 885.0, 930.0, 885.0, 640.0, 1050.0, 1370.0, 355.0, 850.0, 1340.0, 720.0, 560.0, 1385.0, 270.0, 660.0, 445.0, 1650.0, 1680.0, 1320.0, 1320.0, 1215.0, 670.0, 1100.0, 1310.0, 410.0, 1800.0, 875.0, 1180.0, 745.0, 1600.0, 1390.0, 1420.0, 970.0, 1290.0, 450.0, 300.0, 430.0, 620.0, 1410.0, 310.0, 540.0, 350.0, 1160.0, 775.0, 1295.0, 1080.0, 1135.0, 860.0, 1240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 350.0, 40.0, 120.0, 170.0, 170.0, 40.0, 160.0, 390.0, 80.0, 70.0, 70.0, 70.0, 130.0, 60.0, 10.0, 60.0, 120.0, 70.0, 220.0, 50.0, 100.0, 30.0, 190.0, 140.0, 340.0, 150.0, -10.0, 220.0, 10.0, 40.0, 220.0, 30.0, 50.0, 490.0, 50.0, 70.0, 50.0, 20.0, 190.0, 50.0, 80.0, 150.0, 110.0, 140.0, 130.0, 200.0, 50.0, 50.0, 350.0, 100.0, 160.0, 30.0, 0.0, 50.0, 220.0, 70.0, -40.0, 20.0, 380.0, 10.0, 50.0, 30.0, 30.0, 70.0, 0.0, 30.0, 20.0, 10.0, 30.0, 10.0, 30.0, 90.0, 200.0, 60.0, 140.0, 80.0, 50.0, 140.0, 20.0, 80.0, 0.0, 30.0, 160.0, 30.0, 0.0, 40.0, 50.0, 10.0, 230.0, 360.0, 10.0, 360.0, 160.0, -25.0, 20.0, 20.0, -40.0, 250.0, 20.0, 20.0, 20.0, 60.0, 370.0, 35.0, 60.0, 25.0, 40.0, 60.0, 0.0, 20.0, 80.0, 40.0, 420.0, 30.0, 30.0, 0.0, 30.0, 0.0, 20.0, 80.0, 70.0, 10.0, 160.0, 160.0, 50.0, 20.0, 190.0, 270.0, 50.0, 110.0, 20.0, 50.0, 120.0, 120.0, 30.0, 290.0, 20.0, 90.0, 30.0, 180.0, 50.0, 90.0, 50.0, -40.0, 410.0, 45.0, 70.0, 30.0, 370.0, 150.0, 250.0, 150.0, 310.0, 180.0, -90.0, 180.0, 90.0, -140.0, 260.0, 40.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 40.0, 380.0, 70.0, 60.0, 60.0, 270.0, 90.0, 40.0, 40.0, 150.0, 170.0, 20.0, 110.0, 210.0, 200.0, 90.0, 130.0, 40.0, 140.0, 15.0, 70.0, 530.0, 70.0, 0.0, 120.0, 150.0, -210.0, 40.0, -150.0, 310.0, 250.0, 40.0, 40.0, 60.0, 50.0, 230.0, 170.0, 70.0, 270.0, 220.0, 100.0, 25.0, 50.0, 0.0, -20.0, 100.0, 110.0, 220.0, 180.0, 480.0, 10.0, 270.0, 20.0, 10.0, 60.0, 70.0, 30.0, 20.0, 50.0, 60.0, 40.0, 30.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 50.0, 10.0, 0.0, 250.0, 30.0, 40.0, 20.0, 20.0, 30.0, 0.0, 80.0, 320.0, 90.0, 270.0, 80.0, 170.0, 60.0, 70.0, 40.0, 90.0, 160.0, 30.0, 20.0, 20.0, 10.0, 110.0, 20.0, 15.0, 40.0, 40.0, 130.0, 80.0, 10.0, 70.0, 390.0, 30.0, 170.0, 0.0, 20.0, 40.0, 250.0, 130.0, 40.0, -40.0, 80.0, 40.0, 0.0, 270.0, 50.0, 40.0, 40.0, 180.0, 10.0, 40.0, 130.0, 0.0, 60.0, 120.0, 60.0, 190.0, 100.0, 220.0, 90.0, 10.0, 10.0, 200.0, 70.0, 30.0, 60.0, 0.0, 260.0, 0.0, 180.0, 280.0, 20.0, 5.0, 110.0, 60.0, 30.0, 20.0, 0.0, 200.0, 40.0, 180.0, -20.0, -50.0, 720.0, -15.0, 150.0, 110.0, 10.0, 50.0, 130.0, -125.0, 170.0, 180.0, 0.0, 170.0, 620.0, 40.0, 120.0, 10.0, 110.0, 0.0, 90.0, 30.0, 450.0, 20.0, 80.0, 320.0, 170.0, 250.0, 10.0, 50.0, -75.0, 30.0, 120.0, 140.0, 370.0, 0.0, 0.0, 70.0, 120.0, 80.0, 20.0, 70.0, 10.0, 10.0, 220.0, 40.0, 460.0, 130.0, 50.0, -20.0, 270.0, 160.0, 110.0, 120.0, 100.0, 100.0, 10.0, 120.0, 160.0, 320.0, 160.0, 110.0, 15.0, -5.0, 70.0, 30.0, 100.0, 130.0, 210.0, 20.0, 150.0, 250.0, 60.0, 120.0, 70.0, 270.0, 50.0, 520.0, 20.0, 110.0, 40.0, 100.0, 20.0, 10.0, 90.0, 40.0, 40.0, 0.0, 110.0, 15.0, 20.0, 70.0, 20.0, 10.0, 30.0, -30.0, 30.0, 65.0, 110.0, 210.0, 290.0, 40.0, 580.0, 90.0, 60.0, 80.0, -25.0, 40.0, 0.0, 20.0, 10.0, 20.0, 160.0, 20.0, 60.0, 20.0, 170.0, 500.0, 90.0, 90.0, 480.0, 110.0, 5.0, 220.0, 210.0, 100.0, 120.0, -30.0, 70.0, 370.0, 150.0, 50.0, -20.0, 370.0, 230.0, 80.0, 260.0, 100.0, 60.0, 230.0, 300.0, 20.0, 300.0, 80.0, 440.0, 80.0, 30.0, 0.0, 20.0, 10.0, 40.0, 160.0, 0.0, 0.0, 30.0, 30.0, -50.0, 30.0, 100.0, 30.0, 390.0, 490.0, -30.0, 110.0, 10.0, -50.0, 10.0, 20.0, 130.0, 0.0, 100.0, 20.0, 10.0, 100.0, 60.0, 100.0, 0.0, 210.0, 10.0, 50.0, 10.0, 20.0, 40.0, 40.0, 30.0, 140.0, 160.0, 260.0, 90.0, 160.0, 140.0, 40.0, 360.0, 220.0, 70.0, 340.0, 120.0, 70.0, 85.0, 70.0, 10.0, 30.0, 20.0, 0.0, 470.0, 10.0, 220.0, 20.0, 90.0, 40.0, 40.0, 170.0, 180.0, 110.0, 50.0, 10.0, 10.0, 360.0, 10.0, 30.0, 10.0, 120.0, 90.0, 50.0, -25.0, 230.0, 200.0, 10.0, 70.0, 80.0, 100.0, 50.0, -10.0, 80.0, 20.0, 40.0, 270.0, 80.0, 0.0, 30.0, 170.0, -20.0, 50.0, 340.0, 70.0, 60.0, 450.0, 200.0, 60.0, 100.0, 60.0, 110.0, 100.0, 30.0, 70.0, 190.0, 110.0, -15.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 110.0, 30.0, 0.0, 90.0, 50.0, 270.0, 230.0, -40.0, 40.0, 40.0, 40.0, 130.0, 240.0, 50.0, 90.0, 180.0, 320.0, 20.0, 90.0, 50.0, 250.0, 50.0, 60.0, 30.0, 200.0, 50.0, 30.0, 0.0, 270.0, -50.0, 50.0, 80.0, 10.0, 50.0, 40.0, 60.0, 50.0, 30.0, 40.0, 200.0, 30.0, 50.0, 220.0, 170.0, 25.0, -20.0, 490.0, 40.0, -30.0, 210.0, 60.0, 220.0, 0.0, 40.0, 50.0, 10.0, 0.0, 70.0, 10.0, 0.0, 0.0, 90.0, 320.0, 80.0, 0.0, 70.0, 40.0, 30.0, 30.0, 0.0, 0.0, 90.0, 40.0, 90.0, 35.0, 40.0, 10.0, 20.0, 40.0, 150.0, 30.0, -10.0, 890.0, 40.0, 160.0, 0.0, 130.0, 80.0, 180.0, 30.0, 60.0, 80.0, 50.0, 0.0, 310.0, 350.0, 120.0, 160.0, 70.0, 150.0, 400.0, 70.0, 70.0, 70.0, 40.0, 60.0, 80.0, 480.0, 180.0, 150.0, 190.0, 0.0, 50.0, 150.0, 80.0, 190.0, 60.0, 170.0, 320.0, 60.0, 80.0, 160.0, 30.0, 50.0, -15.0, 100.0, -30.0, 560.0, 410.0, 10.0, 20.0, 80.0, 70.0, 30.0, 100.0, 180.0, 20.0, 70.0, 30.0, 100.0, 40.0, 30.0, 280.0, 30.0, 140.0, 130.0, 220.0, 20.0, -20.0, 80.0, 70.0, 150.0, 380.0, -20.0, 400.0, 80.0, 210.0, 30.0, 20.0, -20.0, 50.0, 180.0, 60.0, 20.0, 30.0, 50.0, 0.0, 150.0, 100.0, -10.0, 0.0, 10.0, 330.0, 60.0, 500.0, 90.0, 220.0, 80.0, 150.0, 170.0, 120.0, 80.0, -50.0, -50.0, 10.0, 35.0, 400.0, 220.0, 90.0, 80.0, 100.0, 40.0, 280.0, -5.0, 300.0, 230.0, 100.0, 130.0, 70.0, 70.0, 5.0, 0.0, 30.0, 40.0, 30.0, 20.0, 320.0, 15.0, 120.0, 20.0, 50.0, 100.0, 190.0, 60.0, 90.0, 160.0, 580.0, 90.0, 30.0, 70.0, 120.0, 210.0, 530.0, 90.0, 170.0, 110.0, 100.0, 30.0, 180.0, 60.0, 90.0, 30.0, 70.0, 0.0, 50.0, 420.0, 240.0, 110.0, 30.0, 130.0, 90.0, 280.0, 170.0, 210.0, 150.0, 20.0, 130.0, 0.0, 40.0, 40.0, 50.0, 160.0, 50.0, 140.0, 240.0, 30.0, 120.0, 30.0, 100.0, 280.0, 210.0, 90.0, 40.0, 20.0, 90.0, 190.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 30.0, 40.0, 90.0, 30.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 40.0, 60.0, 20.0, 10.0, 170.0, 20.0, 50.0, 30.0, 30.0, 0.0, 40.0, 500.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 30.0, -60.0, 330.0, 210.0, 170.0, 130.0, 110.0, -10.0, 480.0, 20.0, 60.0, 50.0, 30.0, 0.0, 10.0, 60.0, 0.0, 40.0, 40.0, 20.0, 60.0, 90.0, 40.0, 30.0, 40.0, 60.0, 50.0, 70.0, 20.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 180.0, -30.0, 90.0, 150.0, 80.0, 530.0, 150.0, 60.0, 60.0, 30.0, 40.0, -25.0, 50.0, 60.0, -40.0, 60.0, 40.0, -50.0, 160.0, 160.0, 360.0, 315.0, 190.0, 5.0, 360.0, 210.0, 140.0, 15.0, 0.0, 90.0, -30.0, 40.0, 50.0, 70.0, 200.0, 110.0, 80.0, 150.0, 130.0, 30.0, 220.0, 90.0, 50.0, 120.0, -15.0, 0.0, 40.0, 70.0, 70.0, 510.0, 200.0, 30.0, 160.0, 10.0, 10.0, 250.0, 30.0, 120.0, 90.0, 140.0, 20.0, 150.0, 180.0, 50.0, 290.0, 40.0, 230.0, -10.0, 150.0, 80.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4942798093621599, "mean_inference_ms": 1.416548899020906, "mean_action_processing_ms": 0.42354844006964226, "mean_env_wait_ms": 1.2513870215222667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011940240859985352, "StateBufferConnector_ms": 0.009502410888671875, "ViewRequirementAgentConnector_ms": 0.385326623916626}, "num_episodes": 22, "episode_return_max": 1975.0, "episode_return_min": 200.0, "episode_return_mean": 977.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.345608703163762, "num_env_steps_trained_throughput_per_sec": 21.345608703163762, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 4880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4880000, "timers": {"training_iteration_time_ms": 186180.708, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186180.66, "sample_time_ms": 2458.094, "learn_time_ms": 183702.744, "learn_throughput": 21.774, "synch_weights_time_ms": 11.622}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "done": false, "training_iteration": 122, "trial_id": "90816_00000", "date": "2024-06-10_06-33-42", "timestamp": 1718015622, "time_this_iter_s": 187.41570520401, "time_total_s": 22899.68871998787, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0099280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22899.68871998787, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 18.86466165413534, "ram_util_percent": 79.42481203007519}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1603527380000798, "cur_kl_coeff": 7.022133516829253, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004125245079086723, "vf_loss": 6.046098008323401, "vf_explained_var": 0.0023920433589825615, "kl": Infinity, "entropy": 0.3937277685751676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1150275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "env_runners": {"episode_reward_max": 1975.0, "episode_reward_min": 130.0, "episode_reward_mean": 935.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 93.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1025.0, 1110.0, 1250.0, 1155.0, 630.0, 260.0, 450.0, 1270.0, 465.0, 940.0, 860.0, 830.0, 790.0, 965.0, 1315.0, 1245.0, 1230.0, 1065.0, 640.0, 1480.0, 990.0, 1380.0, 1000.0, 285.0, 1555.0, 325.0, 1975.0, 1390.0, 1870.0, 320.0, 1030.0, 550.0, 550.0, 1840.0, 885.0, 930.0, 885.0, 640.0, 1050.0, 1370.0, 355.0, 850.0, 1340.0, 720.0, 560.0, 1385.0, 270.0, 660.0, 445.0, 1650.0, 1680.0, 1320.0, 1320.0, 1215.0, 670.0, 1100.0, 1310.0, 410.0, 1800.0, 875.0, 1180.0, 745.0, 1600.0, 1390.0, 1420.0, 970.0, 1290.0, 450.0, 300.0, 430.0, 620.0, 1410.0, 310.0, 540.0, 350.0, 1160.0, 775.0, 1295.0, 1080.0, 1135.0, 860.0, 1240.0, 275.0, 705.0, 1010.0, 720.0, 560.0, 1060.0, 895.0, 220.0, 940.0, 1090.0, 690.0, 450.0, 775.0, 1015.0, 130.0, 1670.0, 610.0, 410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 110.0, 210.0, 200.0, 90.0, 130.0, 40.0, 140.0, 15.0, 70.0, 530.0, 70.0, 0.0, 120.0, 150.0, -210.0, 40.0, -150.0, 310.0, 250.0, 40.0, 40.0, 60.0, 50.0, 230.0, 170.0, 70.0, 270.0, 220.0, 100.0, 25.0, 50.0, 0.0, -20.0, 100.0, 110.0, 220.0, 180.0, 480.0, 10.0, 270.0, 20.0, 10.0, 60.0, 70.0, 30.0, 20.0, 50.0, 60.0, 40.0, 30.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 20.0, 60.0, 50.0, 10.0, 0.0, 250.0, 30.0, 40.0, 20.0, 20.0, 30.0, 0.0, 80.0, 320.0, 90.0, 270.0, 80.0, 170.0, 60.0, 70.0, 40.0, 90.0, 160.0, 30.0, 20.0, 20.0, 10.0, 110.0, 20.0, 15.0, 40.0, 40.0, 130.0, 80.0, 10.0, 70.0, 390.0, 30.0, 170.0, 0.0, 20.0, 40.0, 250.0, 130.0, 40.0, -40.0, 80.0, 40.0, 0.0, 270.0, 50.0, 40.0, 40.0, 180.0, 10.0, 40.0, 130.0, 0.0, 60.0, 120.0, 60.0, 190.0, 100.0, 220.0, 90.0, 10.0, 10.0, 200.0, 70.0, 30.0, 60.0, 0.0, 260.0, 0.0, 180.0, 280.0, 20.0, 5.0, 110.0, 60.0, 30.0, 20.0, 0.0, 200.0, 40.0, 180.0, -20.0, -50.0, 720.0, -15.0, 150.0, 110.0, 10.0, 50.0, 130.0, -125.0, 170.0, 180.0, 0.0, 170.0, 620.0, 40.0, 120.0, 10.0, 110.0, 0.0, 90.0, 30.0, 450.0, 20.0, 80.0, 320.0, 170.0, 250.0, 10.0, 50.0, -75.0, 30.0, 120.0, 140.0, 370.0, 0.0, 0.0, 70.0, 120.0, 80.0, 20.0, 70.0, 10.0, 10.0, 220.0, 40.0, 460.0, 130.0, 50.0, -20.0, 270.0, 160.0, 110.0, 120.0, 100.0, 100.0, 10.0, 120.0, 160.0, 320.0, 160.0, 110.0, 15.0, -5.0, 70.0, 30.0, 100.0, 130.0, 210.0, 20.0, 150.0, 250.0, 60.0, 120.0, 70.0, 270.0, 50.0, 520.0, 20.0, 110.0, 40.0, 100.0, 20.0, 10.0, 90.0, 40.0, 40.0, 0.0, 110.0, 15.0, 20.0, 70.0, 20.0, 10.0, 30.0, -30.0, 30.0, 65.0, 110.0, 210.0, 290.0, 40.0, 580.0, 90.0, 60.0, 80.0, -25.0, 40.0, 0.0, 20.0, 10.0, 20.0, 160.0, 20.0, 60.0, 20.0, 170.0, 500.0, 90.0, 90.0, 480.0, 110.0, 5.0, 220.0, 210.0, 100.0, 120.0, -30.0, 70.0, 370.0, 150.0, 50.0, -20.0, 370.0, 230.0, 80.0, 260.0, 100.0, 60.0, 230.0, 300.0, 20.0, 300.0, 80.0, 440.0, 80.0, 30.0, 0.0, 20.0, 10.0, 40.0, 160.0, 0.0, 0.0, 30.0, 30.0, -50.0, 30.0, 100.0, 30.0, 390.0, 490.0, -30.0, 110.0, 10.0, -50.0, 10.0, 20.0, 130.0, 0.0, 100.0, 20.0, 10.0, 100.0, 60.0, 100.0, 0.0, 210.0, 10.0, 50.0, 10.0, 20.0, 40.0, 40.0, 30.0, 140.0, 160.0, 260.0, 90.0, 160.0, 140.0, 40.0, 360.0, 220.0, 70.0, 340.0, 120.0, 70.0, 85.0, 70.0, 10.0, 30.0, 20.0, 0.0, 470.0, 10.0, 220.0, 20.0, 90.0, 40.0, 40.0, 170.0, 180.0, 110.0, 50.0, 10.0, 10.0, 360.0, 10.0, 30.0, 10.0, 120.0, 90.0, 50.0, -25.0, 230.0, 200.0, 10.0, 70.0, 80.0, 100.0, 50.0, -10.0, 80.0, 20.0, 40.0, 270.0, 80.0, 0.0, 30.0, 170.0, -20.0, 50.0, 340.0, 70.0, 60.0, 450.0, 200.0, 60.0, 100.0, 60.0, 110.0, 100.0, 30.0, 70.0, 190.0, 110.0, -15.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 110.0, 30.0, 0.0, 90.0, 50.0, 270.0, 230.0, -40.0, 40.0, 40.0, 40.0, 130.0, 240.0, 50.0, 90.0, 180.0, 320.0, 20.0, 90.0, 50.0, 250.0, 50.0, 60.0, 30.0, 200.0, 50.0, 30.0, 0.0, 270.0, -50.0, 50.0, 80.0, 10.0, 50.0, 40.0, 60.0, 50.0, 30.0, 40.0, 200.0, 30.0, 50.0, 220.0, 170.0, 25.0, -20.0, 490.0, 40.0, -30.0, 210.0, 60.0, 220.0, 0.0, 40.0, 50.0, 10.0, 0.0, 70.0, 10.0, 0.0, 0.0, 90.0, 320.0, 80.0, 0.0, 70.0, 40.0, 30.0, 30.0, 0.0, 0.0, 90.0, 40.0, 90.0, 35.0, 40.0, 10.0, 20.0, 40.0, 150.0, 30.0, -10.0, 890.0, 40.0, 160.0, 0.0, 130.0, 80.0, 180.0, 30.0, 60.0, 80.0, 50.0, 0.0, 310.0, 350.0, 120.0, 160.0, 70.0, 150.0, 400.0, 70.0, 70.0, 70.0, 40.0, 60.0, 80.0, 480.0, 180.0, 150.0, 190.0, 0.0, 50.0, 150.0, 80.0, 190.0, 60.0, 170.0, 320.0, 60.0, 80.0, 160.0, 30.0, 50.0, -15.0, 100.0, -30.0, 560.0, 410.0, 10.0, 20.0, 80.0, 70.0, 30.0, 100.0, 180.0, 20.0, 70.0, 30.0, 100.0, 40.0, 30.0, 280.0, 30.0, 140.0, 130.0, 220.0, 20.0, -20.0, 80.0, 70.0, 150.0, 380.0, -20.0, 400.0, 80.0, 210.0, 30.0, 20.0, -20.0, 50.0, 180.0, 60.0, 20.0, 30.0, 50.0, 0.0, 150.0, 100.0, -10.0, 0.0, 10.0, 330.0, 60.0, 500.0, 90.0, 220.0, 80.0, 150.0, 170.0, 120.0, 80.0, -50.0, -50.0, 10.0, 35.0, 400.0, 220.0, 90.0, 80.0, 100.0, 40.0, 280.0, -5.0, 300.0, 230.0, 100.0, 130.0, 70.0, 70.0, 5.0, 0.0, 30.0, 40.0, 30.0, 20.0, 320.0, 15.0, 120.0, 20.0, 50.0, 100.0, 190.0, 60.0, 90.0, 160.0, 580.0, 90.0, 30.0, 70.0, 120.0, 210.0, 530.0, 90.0, 170.0, 110.0, 100.0, 30.0, 180.0, 60.0, 90.0, 30.0, 70.0, 0.0, 50.0, 420.0, 240.0, 110.0, 30.0, 130.0, 90.0, 280.0, 170.0, 210.0, 150.0, 20.0, 130.0, 0.0, 40.0, 40.0, 50.0, 160.0, 50.0, 140.0, 240.0, 30.0, 120.0, 30.0, 100.0, 280.0, 210.0, 90.0, 40.0, 20.0, 90.0, 190.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 30.0, 40.0, 90.0, 30.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 40.0, 60.0, 20.0, 10.0, 170.0, 20.0, 50.0, 30.0, 30.0, 0.0, 40.0, 500.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 30.0, -60.0, 330.0, 210.0, 170.0, 130.0, 110.0, -10.0, 480.0, 20.0, 60.0, 50.0, 30.0, 0.0, 10.0, 60.0, 0.0, 40.0, 40.0, 20.0, 60.0, 90.0, 40.0, 30.0, 40.0, 60.0, 50.0, 70.0, 20.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 180.0, -30.0, 90.0, 150.0, 80.0, 530.0, 150.0, 60.0, 60.0, 30.0, 40.0, -25.0, 50.0, 60.0, -40.0, 60.0, 40.0, -50.0, 160.0, 160.0, 360.0, 315.0, 190.0, 5.0, 360.0, 210.0, 140.0, 15.0, 0.0, 90.0, -30.0, 40.0, 50.0, 70.0, 200.0, 110.0, 80.0, 150.0, 130.0, 30.0, 220.0, 90.0, 50.0, 120.0, -15.0, 0.0, 40.0, 70.0, 70.0, 510.0, 200.0, 30.0, 160.0, 10.0, 10.0, 250.0, 30.0, 120.0, 90.0, 140.0, 20.0, 150.0, 180.0, 50.0, 290.0, 40.0, 230.0, -10.0, 150.0, 80.0, 80.0, 10.0, 20.0, 80.0, 20.0, 20.0, 70.0, 10.0, 20.0, 5.0, 20.0, 130.0, 120.0, 20.0, 50.0, 80.0, 40.0, -35.0, 80.0, 30.0, 190.0, 70.0, 210.0, 10.0, 240.0, 10.0, 160.0, 40.0, 120.0, 50.0, 100.0, 10.0, 100.0, 240.0, 10.0, 80.0, 270.0, -70.0, 20.0, 40.0, 20.0, 150.0, 50.0, 120.0, 80.0, 20.0, 70.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 110.0, 30.0, 110.0, 60.0, 50.0, 230.0, 400.0, 0.0, 200.0, 230.0, 10.0, 45.0, 20.0, 50.0, 270.0, 30.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 50.0, 10.0, 10.0, 110.0, 290.0, 20.0, 100.0, 150.0, 40.0, 40.0, 0.0, 80.0, 110.0, 110.0, 0.0, 140.0, 20.0, 130.0, 460.0, 50.0, 70.0, 50.0, 60.0, 130.0, 20.0, 10.0, 20.0, 10.0, 30.0, 80.0, 90.0, 290.0, 10.0, 100.0, 250.0, 20.0, 90.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 60.0, 200.0, 40.0, 110.0, 160.0, -25.0, 100.0, -20.0, 140.0, 10.0, 90.0, 140.0, 130.0, 90.0, 35.0, 130.0, 60.0, 90.0, 140.0, 110.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 140.0, 160.0, 710.0, 20.0, 300.0, 20.0, 170.0, 50.0, 70.0, 180.0, -20.0, 10.0, 10.0, 40.0, 30.0, -30.0, 160.0, 70.0, 160.0, 210.0, 20.0, 70.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.493674574875452, "mean_inference_ms": 1.4171876816794633, "mean_action_processing_ms": 0.423427536308022, "mean_env_wait_ms": 1.2517701969804849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011872529983520508, "StateBufferConnector_ms": 0.009423494338989258, "ViewRequirementAgentConnector_ms": 0.3823428153991699}, "num_episodes": 18, "episode_return_max": 1975.0, "episode_return_min": 130.0, "episode_return_mean": 935.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.51382652824446, "num_env_steps_trained_throughput_per_sec": 21.51382652824446, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 4920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4920000, "timers": {"training_iteration_time_ms": 186214.386, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186214.338, "sample_time_ms": 2437.199, "learn_time_ms": 183757.247, "learn_throughput": 21.768, "synch_weights_time_ms": 11.71}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "done": false, "training_iteration": 123, "trial_id": "90816_00000", "date": "2024-06-10_06-36-48", "timestamp": 1718015808, "time_this_iter_s": 185.93700790405273, "time_total_s": 23085.625727891922, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00ba1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23085.625727891922, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 18.909885931558936, "ram_util_percent": 79.6338403041825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.078950800333287, "cur_kl_coeff": 10.533200275243875, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.688915588198125, "policy_loss": -0.0031648007792562517, "vf_loss": 6.689196351745005, "vf_explained_var": 0.0008565180916120957, "kl": 0.00027380556840320185, "entropy": 0.35950158740670535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1159665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "env_runners": {"episode_reward_max": 1975.0, "episode_reward_min": 130.0, "episode_reward_mean": 928.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 92.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [640.0, 1480.0, 990.0, 1380.0, 1000.0, 285.0, 1555.0, 325.0, 1975.0, 1390.0, 1870.0, 320.0, 1030.0, 550.0, 550.0, 1840.0, 885.0, 930.0, 885.0, 640.0, 1050.0, 1370.0, 355.0, 850.0, 1340.0, 720.0, 560.0, 1385.0, 270.0, 660.0, 445.0, 1650.0, 1680.0, 1320.0, 1320.0, 1215.0, 670.0, 1100.0, 1310.0, 410.0, 1800.0, 875.0, 1180.0, 745.0, 1600.0, 1390.0, 1420.0, 970.0, 1290.0, 450.0, 300.0, 430.0, 620.0, 1410.0, 310.0, 540.0, 350.0, 1160.0, 775.0, 1295.0, 1080.0, 1135.0, 860.0, 1240.0, 275.0, 705.0, 1010.0, 720.0, 560.0, 1060.0, 895.0, 220.0, 940.0, 1090.0, 690.0, 450.0, 775.0, 1015.0, 130.0, 1670.0, 610.0, 410.0, 1020.0, 660.0, 600.0, 1670.0, 485.0, 1210.0, 410.0, 1230.0, 990.0, 540.0, 890.0, 980.0, 640.0, 1275.0, 1120.0, 310.0, 1080.0, 1040.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 70.0, 120.0, 80.0, 20.0, 70.0, 10.0, 10.0, 220.0, 40.0, 460.0, 130.0, 50.0, -20.0, 270.0, 160.0, 110.0, 120.0, 100.0, 100.0, 10.0, 120.0, 160.0, 320.0, 160.0, 110.0, 15.0, -5.0, 70.0, 30.0, 100.0, 130.0, 210.0, 20.0, 150.0, 250.0, 60.0, 120.0, 70.0, 270.0, 50.0, 520.0, 20.0, 110.0, 40.0, 100.0, 20.0, 10.0, 90.0, 40.0, 40.0, 0.0, 110.0, 15.0, 20.0, 70.0, 20.0, 10.0, 30.0, -30.0, 30.0, 65.0, 110.0, 210.0, 290.0, 40.0, 580.0, 90.0, 60.0, 80.0, -25.0, 40.0, 0.0, 20.0, 10.0, 20.0, 160.0, 20.0, 60.0, 20.0, 170.0, 500.0, 90.0, 90.0, 480.0, 110.0, 5.0, 220.0, 210.0, 100.0, 120.0, -30.0, 70.0, 370.0, 150.0, 50.0, -20.0, 370.0, 230.0, 80.0, 260.0, 100.0, 60.0, 230.0, 300.0, 20.0, 300.0, 80.0, 440.0, 80.0, 30.0, 0.0, 20.0, 10.0, 40.0, 160.0, 0.0, 0.0, 30.0, 30.0, -50.0, 30.0, 100.0, 30.0, 390.0, 490.0, -30.0, 110.0, 10.0, -50.0, 10.0, 20.0, 130.0, 0.0, 100.0, 20.0, 10.0, 100.0, 60.0, 100.0, 0.0, 210.0, 10.0, 50.0, 10.0, 20.0, 40.0, 40.0, 30.0, 140.0, 160.0, 260.0, 90.0, 160.0, 140.0, 40.0, 360.0, 220.0, 70.0, 340.0, 120.0, 70.0, 85.0, 70.0, 10.0, 30.0, 20.0, 0.0, 470.0, 10.0, 220.0, 20.0, 90.0, 40.0, 40.0, 170.0, 180.0, 110.0, 50.0, 10.0, 10.0, 360.0, 10.0, 30.0, 10.0, 120.0, 90.0, 50.0, -25.0, 230.0, 200.0, 10.0, 70.0, 80.0, 100.0, 50.0, -10.0, 80.0, 20.0, 40.0, 270.0, 80.0, 0.0, 30.0, 170.0, -20.0, 50.0, 340.0, 70.0, 60.0, 450.0, 200.0, 60.0, 100.0, 60.0, 110.0, 100.0, 30.0, 70.0, 190.0, 110.0, -15.0, 20.0, 20.0, 0.0, 30.0, 30.0, 20.0, 110.0, 30.0, 0.0, 90.0, 50.0, 270.0, 230.0, -40.0, 40.0, 40.0, 40.0, 130.0, 240.0, 50.0, 90.0, 180.0, 320.0, 20.0, 90.0, 50.0, 250.0, 50.0, 60.0, 30.0, 200.0, 50.0, 30.0, 0.0, 270.0, -50.0, 50.0, 80.0, 10.0, 50.0, 40.0, 60.0, 50.0, 30.0, 40.0, 200.0, 30.0, 50.0, 220.0, 170.0, 25.0, -20.0, 490.0, 40.0, -30.0, 210.0, 60.0, 220.0, 0.0, 40.0, 50.0, 10.0, 0.0, 70.0, 10.0, 0.0, 0.0, 90.0, 320.0, 80.0, 0.0, 70.0, 40.0, 30.0, 30.0, 0.0, 0.0, 90.0, 40.0, 90.0, 35.0, 40.0, 10.0, 20.0, 40.0, 150.0, 30.0, -10.0, 890.0, 40.0, 160.0, 0.0, 130.0, 80.0, 180.0, 30.0, 60.0, 80.0, 50.0, 0.0, 310.0, 350.0, 120.0, 160.0, 70.0, 150.0, 400.0, 70.0, 70.0, 70.0, 40.0, 60.0, 80.0, 480.0, 180.0, 150.0, 190.0, 0.0, 50.0, 150.0, 80.0, 190.0, 60.0, 170.0, 320.0, 60.0, 80.0, 160.0, 30.0, 50.0, -15.0, 100.0, -30.0, 560.0, 410.0, 10.0, 20.0, 80.0, 70.0, 30.0, 100.0, 180.0, 20.0, 70.0, 30.0, 100.0, 40.0, 30.0, 280.0, 30.0, 140.0, 130.0, 220.0, 20.0, -20.0, 80.0, 70.0, 150.0, 380.0, -20.0, 400.0, 80.0, 210.0, 30.0, 20.0, -20.0, 50.0, 180.0, 60.0, 20.0, 30.0, 50.0, 0.0, 150.0, 100.0, -10.0, 0.0, 10.0, 330.0, 60.0, 500.0, 90.0, 220.0, 80.0, 150.0, 170.0, 120.0, 80.0, -50.0, -50.0, 10.0, 35.0, 400.0, 220.0, 90.0, 80.0, 100.0, 40.0, 280.0, -5.0, 300.0, 230.0, 100.0, 130.0, 70.0, 70.0, 5.0, 0.0, 30.0, 40.0, 30.0, 20.0, 320.0, 15.0, 120.0, 20.0, 50.0, 100.0, 190.0, 60.0, 90.0, 160.0, 580.0, 90.0, 30.0, 70.0, 120.0, 210.0, 530.0, 90.0, 170.0, 110.0, 100.0, 30.0, 180.0, 60.0, 90.0, 30.0, 70.0, 0.0, 50.0, 420.0, 240.0, 110.0, 30.0, 130.0, 90.0, 280.0, 170.0, 210.0, 150.0, 20.0, 130.0, 0.0, 40.0, 40.0, 50.0, 160.0, 50.0, 140.0, 240.0, 30.0, 120.0, 30.0, 100.0, 280.0, 210.0, 90.0, 40.0, 20.0, 90.0, 190.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 30.0, 40.0, 90.0, 30.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 40.0, 60.0, 20.0, 10.0, 170.0, 20.0, 50.0, 30.0, 30.0, 0.0, 40.0, 500.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 30.0, -60.0, 330.0, 210.0, 170.0, 130.0, 110.0, -10.0, 480.0, 20.0, 60.0, 50.0, 30.0, 0.0, 10.0, 60.0, 0.0, 40.0, 40.0, 20.0, 60.0, 90.0, 40.0, 30.0, 40.0, 60.0, 50.0, 70.0, 20.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 180.0, -30.0, 90.0, 150.0, 80.0, 530.0, 150.0, 60.0, 60.0, 30.0, 40.0, -25.0, 50.0, 60.0, -40.0, 60.0, 40.0, -50.0, 160.0, 160.0, 360.0, 315.0, 190.0, 5.0, 360.0, 210.0, 140.0, 15.0, 0.0, 90.0, -30.0, 40.0, 50.0, 70.0, 200.0, 110.0, 80.0, 150.0, 130.0, 30.0, 220.0, 90.0, 50.0, 120.0, -15.0, 0.0, 40.0, 70.0, 70.0, 510.0, 200.0, 30.0, 160.0, 10.0, 10.0, 250.0, 30.0, 120.0, 90.0, 140.0, 20.0, 150.0, 180.0, 50.0, 290.0, 40.0, 230.0, -10.0, 150.0, 80.0, 80.0, 10.0, 20.0, 80.0, 20.0, 20.0, 70.0, 10.0, 20.0, 5.0, 20.0, 130.0, 120.0, 20.0, 50.0, 80.0, 40.0, -35.0, 80.0, 30.0, 190.0, 70.0, 210.0, 10.0, 240.0, 10.0, 160.0, 40.0, 120.0, 50.0, 100.0, 10.0, 100.0, 240.0, 10.0, 80.0, 270.0, -70.0, 20.0, 40.0, 20.0, 150.0, 50.0, 120.0, 80.0, 20.0, 70.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 110.0, 30.0, 110.0, 60.0, 50.0, 230.0, 400.0, 0.0, 200.0, 230.0, 10.0, 45.0, 20.0, 50.0, 270.0, 30.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 50.0, 10.0, 10.0, 110.0, 290.0, 20.0, 100.0, 150.0, 40.0, 40.0, 0.0, 80.0, 110.0, 110.0, 0.0, 140.0, 20.0, 130.0, 460.0, 50.0, 70.0, 50.0, 60.0, 130.0, 20.0, 10.0, 20.0, 10.0, 30.0, 80.0, 90.0, 290.0, 10.0, 100.0, 250.0, 20.0, 90.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 60.0, 200.0, 40.0, 110.0, 160.0, -25.0, 100.0, -20.0, 140.0, 10.0, 90.0, 140.0, 130.0, 90.0, 35.0, 130.0, 60.0, 90.0, 140.0, 110.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 140.0, 160.0, 710.0, 20.0, 300.0, 20.0, 170.0, 50.0, 70.0, 180.0, -20.0, 10.0, 10.0, 40.0, 30.0, -30.0, 160.0, 70.0, 160.0, 210.0, 20.0, 70.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 80.0, 110.0, 50.0, 70.0, 200.0, 180.0, 10.0, 40.0, 30.0, 130.0, 200.0, 50.0, 30.0, 10.0, 20.0, 280.0, 50.0, 90.0, 30.0, 70.0, 30.0, 90.0, 40.0, 50.0, 200.0, 70.0, 0.0, 100.0, 0.0, 20.0, 30.0, 50.0, 50.0, 80.0, 260.0, 290.0, 430.0, 200.0, 170.0, -10.0, 150.0, 40.0, 10.0, 140.0, 15.0, 0.0, 60.0, 150.0, 0.0, 30.0, 40.0, 30.0, 20.0, 60.0, 370.0, 510.0, 10.0, 10.0, 160.0, 40.0, 0.0, 40.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 110.0, 70.0, 40.0, 40.0, 310.0, -120.0, 410.0, 100.0, 60.0, 170.0, 70.0, 40.0, 150.0, 30.0, 40.0, 70.0, 240.0, 40.0, 160.0, 0.0, 20.0, 40.0, 350.0, -80.0, 100.0, 55.0, -10.0, 0.0, -10.0, 35.0, 480.0, 30.0, -60.0, 100.0, -10.0, -30.0, -80.0, 90.0, 50.0, 180.0, 20.0, 530.0, 40.0, 300.0, 40.0, 190.0, 20.0, 110.0, 90.0, 130.0, 20.0, 50.0, 30.0, 50.0, 30.0, 210.0, 40.0, 10.0, 60.0, 15.0, 110.0, 90.0, 25.0, 40.0, 30.0, 55.0, 230.0, 40.0, 490.0, 50.0, 20.0, 50.0, 270.0, 210.0, 60.0, -10.0, 30.0, 30.0, 280.0, 30.0, 190.0, 110.0, 190.0, 20.0, 10.0, 20.0, 70.0, 70.0, 20.0, 20.0, 10.0, 50.0, 20.0, 20.0, 130.0, 40.0, 690.0, 10.0, 20.0, 50.0, 80.0, 30.0, 10.0, 80.0, 110.0, 50.0, 360.0, 150.0, 50.0, 40.0, 130.0, 10.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4927062094395314, "mean_inference_ms": 1.4172071972652218, "mean_action_processing_ms": 0.4231674526001716, "mean_env_wait_ms": 1.2516442024961492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011739730834960938, "StateBufferConnector_ms": 0.009415626525878906, "ViewRequirementAgentConnector_ms": 0.3674001693725586}, "num_episodes": 18, "episode_return_max": 1975.0, "episode_return_min": 130.0, "episode_return_mean": 928.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.56036036507007, "num_env_steps_trained_throughput_per_sec": 21.56036036507007, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 4960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4960000, "timers": {"training_iteration_time_ms": 186182.811, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186182.763, "sample_time_ms": 2439.765, "learn_time_ms": 183722.261, "learn_throughput": 21.772, "synch_weights_time_ms": 12.455}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "done": false, "training_iteration": 124, "trial_id": "90816_00000", "date": "2024-06-10_06-39-54", "timestamp": 1718015994, "time_this_iter_s": 185.53391885757446, "time_total_s": 23271.159646749496, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b012b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23271.159646749496, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 17.45267175572519, "ram_util_percent": 79.54694656488549}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0802280330365965, "cur_kl_coeff": 5.266600137621937, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005046694640318651, "vf_loss": 7.085170750775403, "vf_explained_var": -4.5350089240759704e-05, "kl": Infinity, "entropy": 0.35437313833207496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1169055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "env_runners": {"episode_reward_max": 1930.0, "episode_reward_min": 130.0, "episode_reward_mean": 928.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 890.0}, "policy_reward_mean": {"policy_0": 92.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [850.0, 1340.0, 720.0, 560.0, 1385.0, 270.0, 660.0, 445.0, 1650.0, 1680.0, 1320.0, 1320.0, 1215.0, 670.0, 1100.0, 1310.0, 410.0, 1800.0, 875.0, 1180.0, 745.0, 1600.0, 1390.0, 1420.0, 970.0, 1290.0, 450.0, 300.0, 430.0, 620.0, 1410.0, 310.0, 540.0, 350.0, 1160.0, 775.0, 1295.0, 1080.0, 1135.0, 860.0, 1240.0, 275.0, 705.0, 1010.0, 720.0, 560.0, 1060.0, 895.0, 220.0, 940.0, 1090.0, 690.0, 450.0, 775.0, 1015.0, 130.0, 1670.0, 610.0, 410.0, 1020.0, 660.0, 600.0, 1670.0, 485.0, 1210.0, 410.0, 1230.0, 990.0, 540.0, 890.0, 980.0, 640.0, 1275.0, 1120.0, 310.0, 1080.0, 1040.0, 810.0, 1150.0, 375.0, 1930.0, 1670.0, 670.0, 845.0, 1060.0, 1120.0, 1165.0, 1110.0, 1100.0, 930.0, 730.0, 1020.0, 1180.0, 600.0, 630.0, 1060.0, 720.0, 1220.0, 1405.0, 855.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 90.0, 50.0, 270.0, 230.0, -40.0, 40.0, 40.0, 40.0, 130.0, 240.0, 50.0, 90.0, 180.0, 320.0, 20.0, 90.0, 50.0, 250.0, 50.0, 60.0, 30.0, 200.0, 50.0, 30.0, 0.0, 270.0, -50.0, 50.0, 80.0, 10.0, 50.0, 40.0, 60.0, 50.0, 30.0, 40.0, 200.0, 30.0, 50.0, 220.0, 170.0, 25.0, -20.0, 490.0, 40.0, -30.0, 210.0, 60.0, 220.0, 0.0, 40.0, 50.0, 10.0, 0.0, 70.0, 10.0, 0.0, 0.0, 90.0, 320.0, 80.0, 0.0, 70.0, 40.0, 30.0, 30.0, 0.0, 0.0, 90.0, 40.0, 90.0, 35.0, 40.0, 10.0, 20.0, 40.0, 150.0, 30.0, -10.0, 890.0, 40.0, 160.0, 0.0, 130.0, 80.0, 180.0, 30.0, 60.0, 80.0, 50.0, 0.0, 310.0, 350.0, 120.0, 160.0, 70.0, 150.0, 400.0, 70.0, 70.0, 70.0, 40.0, 60.0, 80.0, 480.0, 180.0, 150.0, 190.0, 0.0, 50.0, 150.0, 80.0, 190.0, 60.0, 170.0, 320.0, 60.0, 80.0, 160.0, 30.0, 50.0, -15.0, 100.0, -30.0, 560.0, 410.0, 10.0, 20.0, 80.0, 70.0, 30.0, 100.0, 180.0, 20.0, 70.0, 30.0, 100.0, 40.0, 30.0, 280.0, 30.0, 140.0, 130.0, 220.0, 20.0, -20.0, 80.0, 70.0, 150.0, 380.0, -20.0, 400.0, 80.0, 210.0, 30.0, 20.0, -20.0, 50.0, 180.0, 60.0, 20.0, 30.0, 50.0, 0.0, 150.0, 100.0, -10.0, 0.0, 10.0, 330.0, 60.0, 500.0, 90.0, 220.0, 80.0, 150.0, 170.0, 120.0, 80.0, -50.0, -50.0, 10.0, 35.0, 400.0, 220.0, 90.0, 80.0, 100.0, 40.0, 280.0, -5.0, 300.0, 230.0, 100.0, 130.0, 70.0, 70.0, 5.0, 0.0, 30.0, 40.0, 30.0, 20.0, 320.0, 15.0, 120.0, 20.0, 50.0, 100.0, 190.0, 60.0, 90.0, 160.0, 580.0, 90.0, 30.0, 70.0, 120.0, 210.0, 530.0, 90.0, 170.0, 110.0, 100.0, 30.0, 180.0, 60.0, 90.0, 30.0, 70.0, 0.0, 50.0, 420.0, 240.0, 110.0, 30.0, 130.0, 90.0, 280.0, 170.0, 210.0, 150.0, 20.0, 130.0, 0.0, 40.0, 40.0, 50.0, 160.0, 50.0, 140.0, 240.0, 30.0, 120.0, 30.0, 100.0, 280.0, 210.0, 90.0, 40.0, 20.0, 90.0, 190.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 30.0, 40.0, 90.0, 30.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 40.0, 60.0, 20.0, 10.0, 170.0, 20.0, 50.0, 30.0, 30.0, 0.0, 40.0, 500.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 30.0, -60.0, 330.0, 210.0, 170.0, 130.0, 110.0, -10.0, 480.0, 20.0, 60.0, 50.0, 30.0, 0.0, 10.0, 60.0, 0.0, 40.0, 40.0, 20.0, 60.0, 90.0, 40.0, 30.0, 40.0, 60.0, 50.0, 70.0, 20.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 180.0, -30.0, 90.0, 150.0, 80.0, 530.0, 150.0, 60.0, 60.0, 30.0, 40.0, -25.0, 50.0, 60.0, -40.0, 60.0, 40.0, -50.0, 160.0, 160.0, 360.0, 315.0, 190.0, 5.0, 360.0, 210.0, 140.0, 15.0, 0.0, 90.0, -30.0, 40.0, 50.0, 70.0, 200.0, 110.0, 80.0, 150.0, 130.0, 30.0, 220.0, 90.0, 50.0, 120.0, -15.0, 0.0, 40.0, 70.0, 70.0, 510.0, 200.0, 30.0, 160.0, 10.0, 10.0, 250.0, 30.0, 120.0, 90.0, 140.0, 20.0, 150.0, 180.0, 50.0, 290.0, 40.0, 230.0, -10.0, 150.0, 80.0, 80.0, 10.0, 20.0, 80.0, 20.0, 20.0, 70.0, 10.0, 20.0, 5.0, 20.0, 130.0, 120.0, 20.0, 50.0, 80.0, 40.0, -35.0, 80.0, 30.0, 190.0, 70.0, 210.0, 10.0, 240.0, 10.0, 160.0, 40.0, 120.0, 50.0, 100.0, 10.0, 100.0, 240.0, 10.0, 80.0, 270.0, -70.0, 20.0, 40.0, 20.0, 150.0, 50.0, 120.0, 80.0, 20.0, 70.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 110.0, 30.0, 110.0, 60.0, 50.0, 230.0, 400.0, 0.0, 200.0, 230.0, 10.0, 45.0, 20.0, 50.0, 270.0, 30.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 50.0, 10.0, 10.0, 110.0, 290.0, 20.0, 100.0, 150.0, 40.0, 40.0, 0.0, 80.0, 110.0, 110.0, 0.0, 140.0, 20.0, 130.0, 460.0, 50.0, 70.0, 50.0, 60.0, 130.0, 20.0, 10.0, 20.0, 10.0, 30.0, 80.0, 90.0, 290.0, 10.0, 100.0, 250.0, 20.0, 90.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 60.0, 200.0, 40.0, 110.0, 160.0, -25.0, 100.0, -20.0, 140.0, 10.0, 90.0, 140.0, 130.0, 90.0, 35.0, 130.0, 60.0, 90.0, 140.0, 110.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 140.0, 160.0, 710.0, 20.0, 300.0, 20.0, 170.0, 50.0, 70.0, 180.0, -20.0, 10.0, 10.0, 40.0, 30.0, -30.0, 160.0, 70.0, 160.0, 210.0, 20.0, 70.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 80.0, 110.0, 50.0, 70.0, 200.0, 180.0, 10.0, 40.0, 30.0, 130.0, 200.0, 50.0, 30.0, 10.0, 20.0, 280.0, 50.0, 90.0, 30.0, 70.0, 30.0, 90.0, 40.0, 50.0, 200.0, 70.0, 0.0, 100.0, 0.0, 20.0, 30.0, 50.0, 50.0, 80.0, 260.0, 290.0, 430.0, 200.0, 170.0, -10.0, 150.0, 40.0, 10.0, 140.0, 15.0, 0.0, 60.0, 150.0, 0.0, 30.0, 40.0, 30.0, 20.0, 60.0, 370.0, 510.0, 10.0, 10.0, 160.0, 40.0, 0.0, 40.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 110.0, 70.0, 40.0, 40.0, 310.0, -120.0, 410.0, 100.0, 60.0, 170.0, 70.0, 40.0, 150.0, 30.0, 40.0, 70.0, 240.0, 40.0, 160.0, 0.0, 20.0, 40.0, 350.0, -80.0, 100.0, 55.0, -10.0, 0.0, -10.0, 35.0, 480.0, 30.0, -60.0, 100.0, -10.0, -30.0, -80.0, 90.0, 50.0, 180.0, 20.0, 530.0, 40.0, 300.0, 40.0, 190.0, 20.0, 110.0, 90.0, 130.0, 20.0, 50.0, 30.0, 50.0, 30.0, 210.0, 40.0, 10.0, 60.0, 15.0, 110.0, 90.0, 25.0, 40.0, 30.0, 55.0, 230.0, 40.0, 490.0, 50.0, 20.0, 50.0, 270.0, 210.0, 60.0, -10.0, 30.0, 30.0, 280.0, 30.0, 190.0, 110.0, 190.0, 20.0, 10.0, 20.0, 70.0, 70.0, 20.0, 20.0, 10.0, 50.0, 20.0, 20.0, 130.0, 40.0, 690.0, 10.0, 20.0, 50.0, 80.0, 30.0, 10.0, 80.0, 110.0, 50.0, 360.0, 150.0, 50.0, 40.0, 130.0, 10.0, 60.0, 140.0, 10.0, 20.0, 100.0, 10.0, 10.0, -30.0, 130.0, 350.0, 70.0, 310.0, 90.0, 30.0, 60.0, 140.0, 300.0, 80.0, 50.0, 80.0, 10.0, 30.0, -5.0, 50.0, 20.0, 20.0, 70.0, 70.0, -10.0, 70.0, 60.0, 280.0, 50.0, 210.0, 500.0, 440.0, 170.0, 20.0, 100.0, 80.0, 80.0, 30.0, 100.0, -20.0, 460.0, 150.0, 60.0, 90.0, 610.0, 20.0, 170.0, 50.0, 20.0, 20.0, 30.0, 0.0, 20.0, 60.0, 210.0, 100.0, 160.0, -50.0, -90.0, 120.0, 150.0, 25.0, -45.0, 390.0, 5.0, 260.0, 80.0, 20.0, 20.0, 100.0, 20.0, 90.0, 160.0, 100.0, 290.0, 120.0, 140.0, 80.0, 10.0, 170.0, 170.0, 90.0, 30.0, 110.0, 200.0, 60.0, 200.0, 310.0, 25.0, 100.0, 30.0, -10.0, 80.0, 10.0, -80.0, 580.0, 120.0, 90.0, 20.0, 120.0, 290.0, 70.0, 10.0, 30.0, 90.0, 30.0, 360.0, 270.0, 90.0, 220.0, 100.0, 80.0, 40.0, 20.0, 40.0, -10.0, 250.0, 10.0, -50.0, 380.0, 0.0, 150.0, 120.0, 180.0, 110.0, -20.0, 50.0, -30.0, 20.0, 30.0, 0.0, -40.0, 780.0, 10.0, -40.0, 60.0, -60.0, 60.0, 500.0, 70.0, 170.0, 30.0, 30.0, 20.0, 60.0, 0.0, 80.0, 80.0, 60.0, -30.0, 60.0, 90.0, 140.0, 60.0, 210.0, 110.0, 400.0, 40.0, 50.0, -50.0, -10.0, 40.0, 110.0, 0.0, 360.0, 0.0, 60.0, 40.0, 20.0, 200.0, 70.0, 30.0, 190.0, 30.0, 20.0, 20.0, 10.0, -50.0, 210.0, 30.0, 80.0, 70.0, 480.0, 80.0, 80.0, 0.0, 80.0, 60.0, -50.0, 80.0, 240.0, 120.0, 30.0, 60.0, 20.0, 160.0, 0.0, 190.0, 160.0, 100.0, 110.0, 90.0, 80.0, 60.0, 130.0, 100.0, 200.0, 540.0, 140.0, 35.0, 50.0, 40.0, 50.0, 100.0, 90.0, 360.0, 0.0, 75.0, 250.0, 0.0, 20.0, 20.0, 110.0, 140.0, 170.0, 10.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.491192203556468, "mean_inference_ms": 1.416954670017805, "mean_action_processing_ms": 0.4228460604431094, "mean_env_wait_ms": 1.2514355360277245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011890411376953125, "StateBufferConnector_ms": 0.009705543518066406, "ViewRequirementAgentConnector_ms": 0.3745410442352295}, "num_episodes": 23, "episode_return_max": 1930.0, "episode_return_min": 130.0, "episode_return_mean": 928.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.560609843295733, "num_env_steps_trained_throughput_per_sec": 21.560609843295733, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 5000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000000, "timers": {"training_iteration_time_ms": 186229.392, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186229.343, "sample_time_ms": 2424.005, "learn_time_ms": 183784.094, "learn_throughput": 21.765, "synch_weights_time_ms": 12.426}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "done": false, "training_iteration": 125, "trial_id": "90816_00000", "date": "2024-06-10_06-42-59", "timestamp": 1718016179, "time_this_iter_s": 185.53374791145325, "time_total_s": 23456.69339466095, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00ae940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23456.69339466095, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 17.494296577946766, "ram_util_percent": 79.6022813688213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.911513306037052, "cur_kl_coeff": 7.899900206432907, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003639444743141262, "vf_loss": 7.6001634317972915, "vf_explained_var": -0.0006039189137082003, "kl": Infinity, "entropy": 0.30488523749656443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1178445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "env_runners": {"episode_reward_max": 2050.0, "episode_reward_min": 130.0, "episode_reward_mean": 949.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 1130.0}, "policy_reward_mean": {"policy_0": 94.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [875.0, 1180.0, 745.0, 1600.0, 1390.0, 1420.0, 970.0, 1290.0, 450.0, 300.0, 430.0, 620.0, 1410.0, 310.0, 540.0, 350.0, 1160.0, 775.0, 1295.0, 1080.0, 1135.0, 860.0, 1240.0, 275.0, 705.0, 1010.0, 720.0, 560.0, 1060.0, 895.0, 220.0, 940.0, 1090.0, 690.0, 450.0, 775.0, 1015.0, 130.0, 1670.0, 610.0, 410.0, 1020.0, 660.0, 600.0, 1670.0, 485.0, 1210.0, 410.0, 1230.0, 990.0, 540.0, 890.0, 980.0, 640.0, 1275.0, 1120.0, 310.0, 1080.0, 1040.0, 810.0, 1150.0, 375.0, 1930.0, 1670.0, 670.0, 845.0, 1060.0, 1120.0, 1165.0, 1110.0, 1100.0, 930.0, 730.0, 1020.0, 1180.0, 600.0, 630.0, 1060.0, 720.0, 1220.0, 1405.0, 855.0, 750.0, 1395.0, 920.0, 1360.0, 1210.0, 1015.0, 1580.0, 730.0, 850.0, 910.0, 1660.0, 990.0, 750.0, 1120.0, 1360.0, 1330.0, 2050.0, 860.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-50.0, -50.0, 10.0, 35.0, 400.0, 220.0, 90.0, 80.0, 100.0, 40.0, 280.0, -5.0, 300.0, 230.0, 100.0, 130.0, 70.0, 70.0, 5.0, 0.0, 30.0, 40.0, 30.0, 20.0, 320.0, 15.0, 120.0, 20.0, 50.0, 100.0, 190.0, 60.0, 90.0, 160.0, 580.0, 90.0, 30.0, 70.0, 120.0, 210.0, 530.0, 90.0, 170.0, 110.0, 100.0, 30.0, 180.0, 60.0, 90.0, 30.0, 70.0, 0.0, 50.0, 420.0, 240.0, 110.0, 30.0, 130.0, 90.0, 280.0, 170.0, 210.0, 150.0, 20.0, 130.0, 0.0, 40.0, 40.0, 50.0, 160.0, 50.0, 140.0, 240.0, 30.0, 120.0, 30.0, 100.0, 280.0, 210.0, 90.0, 40.0, 20.0, 90.0, 190.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 30.0, 40.0, 90.0, 30.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 40.0, 60.0, 20.0, 10.0, 170.0, 20.0, 50.0, 30.0, 30.0, 0.0, 40.0, 500.0, 10.0, 0.0, 0.0, 20.0, 10.0, 10.0, 30.0, -60.0, 330.0, 210.0, 170.0, 130.0, 110.0, -10.0, 480.0, 20.0, 60.0, 50.0, 30.0, 0.0, 10.0, 60.0, 0.0, 40.0, 40.0, 20.0, 60.0, 90.0, 40.0, 30.0, 40.0, 60.0, 50.0, 70.0, 20.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 180.0, -30.0, 90.0, 150.0, 80.0, 530.0, 150.0, 60.0, 60.0, 30.0, 40.0, -25.0, 50.0, 60.0, -40.0, 60.0, 40.0, -50.0, 160.0, 160.0, 360.0, 315.0, 190.0, 5.0, 360.0, 210.0, 140.0, 15.0, 0.0, 90.0, -30.0, 40.0, 50.0, 70.0, 200.0, 110.0, 80.0, 150.0, 130.0, 30.0, 220.0, 90.0, 50.0, 120.0, -15.0, 0.0, 40.0, 70.0, 70.0, 510.0, 200.0, 30.0, 160.0, 10.0, 10.0, 250.0, 30.0, 120.0, 90.0, 140.0, 20.0, 150.0, 180.0, 50.0, 290.0, 40.0, 230.0, -10.0, 150.0, 80.0, 80.0, 10.0, 20.0, 80.0, 20.0, 20.0, 70.0, 10.0, 20.0, 5.0, 20.0, 130.0, 120.0, 20.0, 50.0, 80.0, 40.0, -35.0, 80.0, 30.0, 190.0, 70.0, 210.0, 10.0, 240.0, 10.0, 160.0, 40.0, 120.0, 50.0, 100.0, 10.0, 100.0, 240.0, 10.0, 80.0, 270.0, -70.0, 20.0, 40.0, 20.0, 150.0, 50.0, 120.0, 80.0, 20.0, 70.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 110.0, 30.0, 110.0, 60.0, 50.0, 230.0, 400.0, 0.0, 200.0, 230.0, 10.0, 45.0, 20.0, 50.0, 270.0, 30.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 50.0, 10.0, 10.0, 110.0, 290.0, 20.0, 100.0, 150.0, 40.0, 40.0, 0.0, 80.0, 110.0, 110.0, 0.0, 140.0, 20.0, 130.0, 460.0, 50.0, 70.0, 50.0, 60.0, 130.0, 20.0, 10.0, 20.0, 10.0, 30.0, 80.0, 90.0, 290.0, 10.0, 100.0, 250.0, 20.0, 90.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 60.0, 200.0, 40.0, 110.0, 160.0, -25.0, 100.0, -20.0, 140.0, 10.0, 90.0, 140.0, 130.0, 90.0, 35.0, 130.0, 60.0, 90.0, 140.0, 110.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 140.0, 160.0, 710.0, 20.0, 300.0, 20.0, 170.0, 50.0, 70.0, 180.0, -20.0, 10.0, 10.0, 40.0, 30.0, -30.0, 160.0, 70.0, 160.0, 210.0, 20.0, 70.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 80.0, 110.0, 50.0, 70.0, 200.0, 180.0, 10.0, 40.0, 30.0, 130.0, 200.0, 50.0, 30.0, 10.0, 20.0, 280.0, 50.0, 90.0, 30.0, 70.0, 30.0, 90.0, 40.0, 50.0, 200.0, 70.0, 0.0, 100.0, 0.0, 20.0, 30.0, 50.0, 50.0, 80.0, 260.0, 290.0, 430.0, 200.0, 170.0, -10.0, 150.0, 40.0, 10.0, 140.0, 15.0, 0.0, 60.0, 150.0, 0.0, 30.0, 40.0, 30.0, 20.0, 60.0, 370.0, 510.0, 10.0, 10.0, 160.0, 40.0, 0.0, 40.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 110.0, 70.0, 40.0, 40.0, 310.0, -120.0, 410.0, 100.0, 60.0, 170.0, 70.0, 40.0, 150.0, 30.0, 40.0, 70.0, 240.0, 40.0, 160.0, 0.0, 20.0, 40.0, 350.0, -80.0, 100.0, 55.0, -10.0, 0.0, -10.0, 35.0, 480.0, 30.0, -60.0, 100.0, -10.0, -30.0, -80.0, 90.0, 50.0, 180.0, 20.0, 530.0, 40.0, 300.0, 40.0, 190.0, 20.0, 110.0, 90.0, 130.0, 20.0, 50.0, 30.0, 50.0, 30.0, 210.0, 40.0, 10.0, 60.0, 15.0, 110.0, 90.0, 25.0, 40.0, 30.0, 55.0, 230.0, 40.0, 490.0, 50.0, 20.0, 50.0, 270.0, 210.0, 60.0, -10.0, 30.0, 30.0, 280.0, 30.0, 190.0, 110.0, 190.0, 20.0, 10.0, 20.0, 70.0, 70.0, 20.0, 20.0, 10.0, 50.0, 20.0, 20.0, 130.0, 40.0, 690.0, 10.0, 20.0, 50.0, 80.0, 30.0, 10.0, 80.0, 110.0, 50.0, 360.0, 150.0, 50.0, 40.0, 130.0, 10.0, 60.0, 140.0, 10.0, 20.0, 100.0, 10.0, 10.0, -30.0, 130.0, 350.0, 70.0, 310.0, 90.0, 30.0, 60.0, 140.0, 300.0, 80.0, 50.0, 80.0, 10.0, 30.0, -5.0, 50.0, 20.0, 20.0, 70.0, 70.0, -10.0, 70.0, 60.0, 280.0, 50.0, 210.0, 500.0, 440.0, 170.0, 20.0, 100.0, 80.0, 80.0, 30.0, 100.0, -20.0, 460.0, 150.0, 60.0, 90.0, 610.0, 20.0, 170.0, 50.0, 20.0, 20.0, 30.0, 0.0, 20.0, 60.0, 210.0, 100.0, 160.0, -50.0, -90.0, 120.0, 150.0, 25.0, -45.0, 390.0, 5.0, 260.0, 80.0, 20.0, 20.0, 100.0, 20.0, 90.0, 160.0, 100.0, 290.0, 120.0, 140.0, 80.0, 10.0, 170.0, 170.0, 90.0, 30.0, 110.0, 200.0, 60.0, 200.0, 310.0, 25.0, 100.0, 30.0, -10.0, 80.0, 10.0, -80.0, 580.0, 120.0, 90.0, 20.0, 120.0, 290.0, 70.0, 10.0, 30.0, 90.0, 30.0, 360.0, 270.0, 90.0, 220.0, 100.0, 80.0, 40.0, 20.0, 40.0, -10.0, 250.0, 10.0, -50.0, 380.0, 0.0, 150.0, 120.0, 180.0, 110.0, -20.0, 50.0, -30.0, 20.0, 30.0, 0.0, -40.0, 780.0, 10.0, -40.0, 60.0, -60.0, 60.0, 500.0, 70.0, 170.0, 30.0, 30.0, 20.0, 60.0, 0.0, 80.0, 80.0, 60.0, -30.0, 60.0, 90.0, 140.0, 60.0, 210.0, 110.0, 400.0, 40.0, 50.0, -50.0, -10.0, 40.0, 110.0, 0.0, 360.0, 0.0, 60.0, 40.0, 20.0, 200.0, 70.0, 30.0, 190.0, 30.0, 20.0, 20.0, 10.0, -50.0, 210.0, 30.0, 80.0, 70.0, 480.0, 80.0, 80.0, 0.0, 80.0, 60.0, -50.0, 80.0, 240.0, 120.0, 30.0, 60.0, 20.0, 160.0, 0.0, 190.0, 160.0, 100.0, 110.0, 90.0, 80.0, 60.0, 130.0, 100.0, 200.0, 540.0, 140.0, 35.0, 50.0, 40.0, 50.0, 100.0, 90.0, 360.0, 0.0, 75.0, 250.0, 0.0, 20.0, 20.0, 110.0, 140.0, 170.0, 10.0, 60.0, 150.0, 120.0, 70.0, 80.0, 40.0, 90.0, 30.0, 80.0, 30.0, 60.0, 130.0, 110.0, 110.0, 30.0, 30.0, 165.0, 70.0, 330.0, -20.0, 440.0, 40.0, 40.0, 0.0, 170.0, 60.0, 140.0, 100.0, 160.0, 170.0, 40.0, 70.0, 150.0, 210.0, 50.0, 230.0, 90.0, 30.0, -10.0, 180.0, 360.0, 230.0, 360.0, 70.0, 190.0, -60.0, 150.0, 130.0, 10.0, 30.0, 100.0, 90.0, 100.0, 400.0, -30.0, 70.0, 45.0, 170.0, 50.0, 110.0, 10.0, 30.0, 50.0, 160.0, 940.0, -40.0, 30.0, 50.0, 150.0, 170.0, 40.0, 100.0, 0.0, 40.0, 170.0, 30.0, 80.0, 40.0, 10.0, 10.0, 250.0, 20.0, 0.0, 40.0, 30.0, 280.0, 50.0, 170.0, 140.0, 80.0, 40.0, -50.0, 50.0, 70.0, 330.0, 150.0, 190.0, 0.0, 60.0, 80.0, 30.0, 20.0, 1130.0, 10.0, 40.0, 10.0, 40.0, 40.0, 210.0, 20.0, 140.0, 120.0, 120.0, 20.0, 130.0, 130.0, 160.0, 40.0, 50.0, 60.0, 160.0, 90.0, 40.0, 80.0, 40.0, 10.0, 60.0, 40.0, 30.0, 30.0, 330.0, 50.0, 140.0, 130.0, 60.0, 390.0, 80.0, 270.0, 80.0, -10.0, -70.0, 20.0, 350.0, 140.0, 240.0, -20.0, 10.0, -10.0, 30.0, 480.0, 120.0, -10.0, 130.0, 60.0, 90.0, 70.0, 120.0, 140.0, 70.0, 320.0, 340.0, 120.0, 170.0, 190.0, 40.0, 160.0, 430.0, 540.0, 120.0, 40.0, 240.0, 140.0, 50.0, 20.0, 50.0, 80.0, 0.0, 140.0, 80.0, 180.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4899527973365279, "mean_inference_ms": 1.4167378805324478, "mean_action_processing_ms": 0.42258571515177373, "mean_env_wait_ms": 1.2512730831123497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011580467224121094, "StateBufferConnector_ms": 0.012240409851074219, "ViewRequirementAgentConnector_ms": 0.366793155670166}, "num_episodes": 18, "episode_return_max": 2050.0, "episode_return_min": 130.0, "episode_return_mean": 949.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.49710021151903, "num_env_steps_trained_throughput_per_sec": 21.49710021151903, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 5040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5040000, "timers": {"training_iteration_time_ms": 186282.738, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186282.687, "sample_time_ms": 2391.17, "learn_time_ms": 183870.072, "learn_throughput": 21.754, "synch_weights_time_ms": 12.584}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "done": false, "training_iteration": 126, "trial_id": "90816_00000", "date": "2024-06-10_06-46-06", "timestamp": 1718016366, "time_this_iter_s": 186.0866150856018, "time_total_s": 23642.78000974655, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b01300d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23642.78000974655, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 17.62699619771863, "ram_util_percent": 79.49049429657795}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5169074737733674, "cur_kl_coeff": 11.849850309649359, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.687671108875539, "policy_loss": -0.0034356266018885947, "vf_loss": 6.68790747080875, "vf_explained_var": 0.0023906472201545396, "kl": 0.0002699836916213194, "entropy": 0.3469306512286488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1187835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "env_runners": {"episode_reward_max": 2050.0, "episode_reward_min": 130.0, "episode_reward_mean": 960.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -560.0}, "policy_reward_max": {"policy_0": 1130.0}, "policy_reward_mean": {"policy_0": 96.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1240.0, 275.0, 705.0, 1010.0, 720.0, 560.0, 1060.0, 895.0, 220.0, 940.0, 1090.0, 690.0, 450.0, 775.0, 1015.0, 130.0, 1670.0, 610.0, 410.0, 1020.0, 660.0, 600.0, 1670.0, 485.0, 1210.0, 410.0, 1230.0, 990.0, 540.0, 890.0, 980.0, 640.0, 1275.0, 1120.0, 310.0, 1080.0, 1040.0, 810.0, 1150.0, 375.0, 1930.0, 1670.0, 670.0, 845.0, 1060.0, 1120.0, 1165.0, 1110.0, 1100.0, 930.0, 730.0, 1020.0, 1180.0, 600.0, 630.0, 1060.0, 720.0, 1220.0, 1405.0, 855.0, 750.0, 1395.0, 920.0, 1360.0, 1210.0, 1015.0, 1580.0, 730.0, 850.0, 910.0, 1660.0, 990.0, 750.0, 1120.0, 1360.0, 1330.0, 2050.0, 860.0, 1320.0, 930.0, 285.0, 1360.0, 1250.0, 640.0, 635.0, 1005.0, 1055.0, 870.0, 590.0, 920.0, 1260.0, 1140.0, 450.0, 1215.0, 360.0, 980.0, 1740.0, 1230.0, 840.0, 1160.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 180.0, 50.0, 290.0, 40.0, 230.0, -10.0, 150.0, 80.0, 80.0, 10.0, 20.0, 80.0, 20.0, 20.0, 70.0, 10.0, 20.0, 5.0, 20.0, 130.0, 120.0, 20.0, 50.0, 80.0, 40.0, -35.0, 80.0, 30.0, 190.0, 70.0, 210.0, 10.0, 240.0, 10.0, 160.0, 40.0, 120.0, 50.0, 100.0, 10.0, 100.0, 240.0, 10.0, 80.0, 270.0, -70.0, 20.0, 40.0, 20.0, 150.0, 50.0, 120.0, 80.0, 20.0, 70.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 110.0, 30.0, 110.0, 60.0, 50.0, 230.0, 400.0, 0.0, 200.0, 230.0, 10.0, 45.0, 20.0, 50.0, 270.0, 30.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 50.0, 10.0, 10.0, 110.0, 290.0, 20.0, 100.0, 150.0, 40.0, 40.0, 0.0, 80.0, 110.0, 110.0, 0.0, 140.0, 20.0, 130.0, 460.0, 50.0, 70.0, 50.0, 60.0, 130.0, 20.0, 10.0, 20.0, 10.0, 30.0, 80.0, 90.0, 290.0, 10.0, 100.0, 250.0, 20.0, 90.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 60.0, 200.0, 40.0, 110.0, 160.0, -25.0, 100.0, -20.0, 140.0, 10.0, 90.0, 140.0, 130.0, 90.0, 35.0, 130.0, 60.0, 90.0, 140.0, 110.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 140.0, 160.0, 710.0, 20.0, 300.0, 20.0, 170.0, 50.0, 70.0, 180.0, -20.0, 10.0, 10.0, 40.0, 30.0, -30.0, 160.0, 70.0, 160.0, 210.0, 20.0, 70.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 80.0, 110.0, 50.0, 70.0, 200.0, 180.0, 10.0, 40.0, 30.0, 130.0, 200.0, 50.0, 30.0, 10.0, 20.0, 280.0, 50.0, 90.0, 30.0, 70.0, 30.0, 90.0, 40.0, 50.0, 200.0, 70.0, 0.0, 100.0, 0.0, 20.0, 30.0, 50.0, 50.0, 80.0, 260.0, 290.0, 430.0, 200.0, 170.0, -10.0, 150.0, 40.0, 10.0, 140.0, 15.0, 0.0, 60.0, 150.0, 0.0, 30.0, 40.0, 30.0, 20.0, 60.0, 370.0, 510.0, 10.0, 10.0, 160.0, 40.0, 0.0, 40.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 110.0, 70.0, 40.0, 40.0, 310.0, -120.0, 410.0, 100.0, 60.0, 170.0, 70.0, 40.0, 150.0, 30.0, 40.0, 70.0, 240.0, 40.0, 160.0, 0.0, 20.0, 40.0, 350.0, -80.0, 100.0, 55.0, -10.0, 0.0, -10.0, 35.0, 480.0, 30.0, -60.0, 100.0, -10.0, -30.0, -80.0, 90.0, 50.0, 180.0, 20.0, 530.0, 40.0, 300.0, 40.0, 190.0, 20.0, 110.0, 90.0, 130.0, 20.0, 50.0, 30.0, 50.0, 30.0, 210.0, 40.0, 10.0, 60.0, 15.0, 110.0, 90.0, 25.0, 40.0, 30.0, 55.0, 230.0, 40.0, 490.0, 50.0, 20.0, 50.0, 270.0, 210.0, 60.0, -10.0, 30.0, 30.0, 280.0, 30.0, 190.0, 110.0, 190.0, 20.0, 10.0, 20.0, 70.0, 70.0, 20.0, 20.0, 10.0, 50.0, 20.0, 20.0, 130.0, 40.0, 690.0, 10.0, 20.0, 50.0, 80.0, 30.0, 10.0, 80.0, 110.0, 50.0, 360.0, 150.0, 50.0, 40.0, 130.0, 10.0, 60.0, 140.0, 10.0, 20.0, 100.0, 10.0, 10.0, -30.0, 130.0, 350.0, 70.0, 310.0, 90.0, 30.0, 60.0, 140.0, 300.0, 80.0, 50.0, 80.0, 10.0, 30.0, -5.0, 50.0, 20.0, 20.0, 70.0, 70.0, -10.0, 70.0, 60.0, 280.0, 50.0, 210.0, 500.0, 440.0, 170.0, 20.0, 100.0, 80.0, 80.0, 30.0, 100.0, -20.0, 460.0, 150.0, 60.0, 90.0, 610.0, 20.0, 170.0, 50.0, 20.0, 20.0, 30.0, 0.0, 20.0, 60.0, 210.0, 100.0, 160.0, -50.0, -90.0, 120.0, 150.0, 25.0, -45.0, 390.0, 5.0, 260.0, 80.0, 20.0, 20.0, 100.0, 20.0, 90.0, 160.0, 100.0, 290.0, 120.0, 140.0, 80.0, 10.0, 170.0, 170.0, 90.0, 30.0, 110.0, 200.0, 60.0, 200.0, 310.0, 25.0, 100.0, 30.0, -10.0, 80.0, 10.0, -80.0, 580.0, 120.0, 90.0, 20.0, 120.0, 290.0, 70.0, 10.0, 30.0, 90.0, 30.0, 360.0, 270.0, 90.0, 220.0, 100.0, 80.0, 40.0, 20.0, 40.0, -10.0, 250.0, 10.0, -50.0, 380.0, 0.0, 150.0, 120.0, 180.0, 110.0, -20.0, 50.0, -30.0, 20.0, 30.0, 0.0, -40.0, 780.0, 10.0, -40.0, 60.0, -60.0, 60.0, 500.0, 70.0, 170.0, 30.0, 30.0, 20.0, 60.0, 0.0, 80.0, 80.0, 60.0, -30.0, 60.0, 90.0, 140.0, 60.0, 210.0, 110.0, 400.0, 40.0, 50.0, -50.0, -10.0, 40.0, 110.0, 0.0, 360.0, 0.0, 60.0, 40.0, 20.0, 200.0, 70.0, 30.0, 190.0, 30.0, 20.0, 20.0, 10.0, -50.0, 210.0, 30.0, 80.0, 70.0, 480.0, 80.0, 80.0, 0.0, 80.0, 60.0, -50.0, 80.0, 240.0, 120.0, 30.0, 60.0, 20.0, 160.0, 0.0, 190.0, 160.0, 100.0, 110.0, 90.0, 80.0, 60.0, 130.0, 100.0, 200.0, 540.0, 140.0, 35.0, 50.0, 40.0, 50.0, 100.0, 90.0, 360.0, 0.0, 75.0, 250.0, 0.0, 20.0, 20.0, 110.0, 140.0, 170.0, 10.0, 60.0, 150.0, 120.0, 70.0, 80.0, 40.0, 90.0, 30.0, 80.0, 30.0, 60.0, 130.0, 110.0, 110.0, 30.0, 30.0, 165.0, 70.0, 330.0, -20.0, 440.0, 40.0, 40.0, 0.0, 170.0, 60.0, 140.0, 100.0, 160.0, 170.0, 40.0, 70.0, 150.0, 210.0, 50.0, 230.0, 90.0, 30.0, -10.0, 180.0, 360.0, 230.0, 360.0, 70.0, 190.0, -60.0, 150.0, 130.0, 10.0, 30.0, 100.0, 90.0, 100.0, 400.0, -30.0, 70.0, 45.0, 170.0, 50.0, 110.0, 10.0, 30.0, 50.0, 160.0, 940.0, -40.0, 30.0, 50.0, 150.0, 170.0, 40.0, 100.0, 0.0, 40.0, 170.0, 30.0, 80.0, 40.0, 10.0, 10.0, 250.0, 20.0, 0.0, 40.0, 30.0, 280.0, 50.0, 170.0, 140.0, 80.0, 40.0, -50.0, 50.0, 70.0, 330.0, 150.0, 190.0, 0.0, 60.0, 80.0, 30.0, 20.0, 1130.0, 10.0, 40.0, 10.0, 40.0, 40.0, 210.0, 20.0, 140.0, 120.0, 120.0, 20.0, 130.0, 130.0, 160.0, 40.0, 50.0, 60.0, 160.0, 90.0, 40.0, 80.0, 40.0, 10.0, 60.0, 40.0, 30.0, 30.0, 330.0, 50.0, 140.0, 130.0, 60.0, 390.0, 80.0, 270.0, 80.0, -10.0, -70.0, 20.0, 350.0, 140.0, 240.0, -20.0, 10.0, -10.0, 30.0, 480.0, 120.0, -10.0, 130.0, 60.0, 90.0, 70.0, 120.0, 140.0, 70.0, 320.0, 340.0, 120.0, 170.0, 190.0, 40.0, 160.0, 430.0, 540.0, 120.0, 40.0, 240.0, 140.0, 50.0, 20.0, 50.0, 80.0, 0.0, 140.0, 80.0, 180.0, 120.0, 210.0, 0.0, -50.0, 0.0, 170.0, 80.0, 850.0, 30.0, 0.0, 30.0, 170.0, 40.0, 140.0, 50.0, 10.0, 120.0, 70.0, 100.0, 230.0, 0.0, 10.0, 40.0, 40.0, -15.0, 70.0, 10.0, 20.0, 30.0, 30.0, 50.0, 80.0, 130.0, 30.0, 190.0, 0.0, -10.0, 0.0, 660.0, 80.0, 200.0, 80.0, 20.0, 60.0, 30.0, 470.0, 150.0, 30.0, 120.0, 140.0, 150.0, 80.0, 160.0, 10.0, 70.0, 20.0, 140.0, 30.0, 20.0, 90.0, 20.0, -95.0, -560.0, 410.0, 180.0, 60.0, 20.0, 120.0, 270.0, 120.0, 110.0, 80.0, 0.0, 20.0, 155.0, 210.0, 20.0, 100.0, 30.0, 350.0, 40.0, 300.0, 40.0, 160.0, 100.0, 50.0, 0.0, 190.0, 0.0, 110.0, 105.0, 70.0, 20.0, 70.0, 170.0, 30.0, 210.0, 100.0, 90.0, 80.0, 30.0, 10.0, 20.0, 30.0, 120.0, 130.0, 40.0, 10.0, 80.0, 130.0, 20.0, 170.0, 170.0, 70.0, 0.0, 110.0, 150.0, 160.0, 40.0, 40.0, 10.0, -80.0, 220.0, 180.0, 100.0, 140.0, 150.0, 70.0, 260.0, 150.0, 70.0, 40.0, -10.0, 370.0, -25.0, 90.0, 200.0, 70.0, 300.0, -75.0, 180.0, 40.0, 20.0, 80.0, -20.0, 20.0, 220.0, 10.0, 40.0, 10.0, 30.0, 50.0, 190.0, 190.0, 60.0, 380.0, 90.0, 135.0, 20.0, 110.0, -10.0, 60.0, 10.0, 10.0, 80.0, 20.0, 60.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 110.0, 80.0, 30.0, 10.0, 110.0, 30.0, 510.0, 40.0, 180.0, -40.0, 450.0, 390.0, 100.0, 370.0, 20.0, 70.0, 60.0, 140.0, 20.0, 10.0, 20.0, 270.0, 100.0, -10.0, 70.0, 50.0, 40.0, 660.0, 230.0, 40.0, 90.0, 70.0, 20.0, 60.0, 60.0, 100.0, 60.0, 110.0, 200.0, 30.0, 40.0, 170.0, 20.0, 20.0, 460.0, 200.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4886976694873766, "mean_inference_ms": 1.4166471474798283, "mean_action_processing_ms": 0.42226748782871154, "mean_env_wait_ms": 1.251121729835469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012438297271728516, "StateBufferConnector_ms": 0.012361764907836914, "ViewRequirementAgentConnector_ms": 0.38077807426452637}, "num_episodes": 22, "episode_return_max": 2050.0, "episode_return_min": 130.0, "episode_return_mean": 960.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.502535709341014, "num_env_steps_trained_throughput_per_sec": 21.502535709341014, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 5080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5080000, "timers": {"training_iteration_time_ms": 186336.356, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186336.305, "sample_time_ms": 2407.563, "learn_time_ms": 183905.486, "learn_throughput": 21.75, "synch_weights_time_ms": 14.185}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "done": false, "training_iteration": 127, "trial_id": "90816_00000", "date": "2024-06-10_06-49-12", "timestamp": 1718016552, "time_this_iter_s": 186.0371720790863, "time_total_s": 23828.817181825638, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00a73a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23828.817181825638, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 18.61026615969582, "ram_util_percent": 79.44524714828897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.642052173030516, "cur_kl_coeff": 5.924925154824679, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004083189927487851, "vf_loss": 6.72430272950405, "vf_explained_var": -0.00013585645423783534, "kl": Infinity, "entropy": 0.3563959661589517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1197225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "env_runners": {"episode_reward_max": 2050.0, "episode_reward_min": 285.0, "episode_reward_mean": 994.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -560.0}, "policy_reward_max": {"policy_0": 1130.0}, "policy_reward_mean": {"policy_0": 99.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.0, 1020.0, 660.0, 600.0, 1670.0, 485.0, 1210.0, 410.0, 1230.0, 990.0, 540.0, 890.0, 980.0, 640.0, 1275.0, 1120.0, 310.0, 1080.0, 1040.0, 810.0, 1150.0, 375.0, 1930.0, 1670.0, 670.0, 845.0, 1060.0, 1120.0, 1165.0, 1110.0, 1100.0, 930.0, 730.0, 1020.0, 1180.0, 600.0, 630.0, 1060.0, 720.0, 1220.0, 1405.0, 855.0, 750.0, 1395.0, 920.0, 1360.0, 1210.0, 1015.0, 1580.0, 730.0, 850.0, 910.0, 1660.0, 990.0, 750.0, 1120.0, 1360.0, 1330.0, 2050.0, 860.0, 1320.0, 930.0, 285.0, 1360.0, 1250.0, 640.0, 635.0, 1005.0, 1055.0, 870.0, 590.0, 920.0, 1260.0, 1140.0, 450.0, 1215.0, 360.0, 980.0, 1740.0, 1230.0, 840.0, 1160.0, 790.0, 1170.0, 1160.0, 895.0, 640.0, 1455.0, 1380.0, 1240.0, 880.0, 850.0, 1730.0, 1190.0, 710.0, 1230.0, 320.0, 1065.0, 410.0, 380.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 20.0, 70.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 80.0, 110.0, 50.0, 70.0, 200.0, 180.0, 10.0, 40.0, 30.0, 130.0, 200.0, 50.0, 30.0, 10.0, 20.0, 280.0, 50.0, 90.0, 30.0, 70.0, 30.0, 90.0, 40.0, 50.0, 200.0, 70.0, 0.0, 100.0, 0.0, 20.0, 30.0, 50.0, 50.0, 80.0, 260.0, 290.0, 430.0, 200.0, 170.0, -10.0, 150.0, 40.0, 10.0, 140.0, 15.0, 0.0, 60.0, 150.0, 0.0, 30.0, 40.0, 30.0, 20.0, 60.0, 370.0, 510.0, 10.0, 10.0, 160.0, 40.0, 0.0, 40.0, 10.0, 70.0, 30.0, 0.0, 20.0, 20.0, 110.0, 70.0, 40.0, 40.0, 310.0, -120.0, 410.0, 100.0, 60.0, 170.0, 70.0, 40.0, 150.0, 30.0, 40.0, 70.0, 240.0, 40.0, 160.0, 0.0, 20.0, 40.0, 350.0, -80.0, 100.0, 55.0, -10.0, 0.0, -10.0, 35.0, 480.0, 30.0, -60.0, 100.0, -10.0, -30.0, -80.0, 90.0, 50.0, 180.0, 20.0, 530.0, 40.0, 300.0, 40.0, 190.0, 20.0, 110.0, 90.0, 130.0, 20.0, 50.0, 30.0, 50.0, 30.0, 210.0, 40.0, 10.0, 60.0, 15.0, 110.0, 90.0, 25.0, 40.0, 30.0, 55.0, 230.0, 40.0, 490.0, 50.0, 20.0, 50.0, 270.0, 210.0, 60.0, -10.0, 30.0, 30.0, 280.0, 30.0, 190.0, 110.0, 190.0, 20.0, 10.0, 20.0, 70.0, 70.0, 20.0, 20.0, 10.0, 50.0, 20.0, 20.0, 130.0, 40.0, 690.0, 10.0, 20.0, 50.0, 80.0, 30.0, 10.0, 80.0, 110.0, 50.0, 360.0, 150.0, 50.0, 40.0, 130.0, 10.0, 60.0, 140.0, 10.0, 20.0, 100.0, 10.0, 10.0, -30.0, 130.0, 350.0, 70.0, 310.0, 90.0, 30.0, 60.0, 140.0, 300.0, 80.0, 50.0, 80.0, 10.0, 30.0, -5.0, 50.0, 20.0, 20.0, 70.0, 70.0, -10.0, 70.0, 60.0, 280.0, 50.0, 210.0, 500.0, 440.0, 170.0, 20.0, 100.0, 80.0, 80.0, 30.0, 100.0, -20.0, 460.0, 150.0, 60.0, 90.0, 610.0, 20.0, 170.0, 50.0, 20.0, 20.0, 30.0, 0.0, 20.0, 60.0, 210.0, 100.0, 160.0, -50.0, -90.0, 120.0, 150.0, 25.0, -45.0, 390.0, 5.0, 260.0, 80.0, 20.0, 20.0, 100.0, 20.0, 90.0, 160.0, 100.0, 290.0, 120.0, 140.0, 80.0, 10.0, 170.0, 170.0, 90.0, 30.0, 110.0, 200.0, 60.0, 200.0, 310.0, 25.0, 100.0, 30.0, -10.0, 80.0, 10.0, -80.0, 580.0, 120.0, 90.0, 20.0, 120.0, 290.0, 70.0, 10.0, 30.0, 90.0, 30.0, 360.0, 270.0, 90.0, 220.0, 100.0, 80.0, 40.0, 20.0, 40.0, -10.0, 250.0, 10.0, -50.0, 380.0, 0.0, 150.0, 120.0, 180.0, 110.0, -20.0, 50.0, -30.0, 20.0, 30.0, 0.0, -40.0, 780.0, 10.0, -40.0, 60.0, -60.0, 60.0, 500.0, 70.0, 170.0, 30.0, 30.0, 20.0, 60.0, 0.0, 80.0, 80.0, 60.0, -30.0, 60.0, 90.0, 140.0, 60.0, 210.0, 110.0, 400.0, 40.0, 50.0, -50.0, -10.0, 40.0, 110.0, 0.0, 360.0, 0.0, 60.0, 40.0, 20.0, 200.0, 70.0, 30.0, 190.0, 30.0, 20.0, 20.0, 10.0, -50.0, 210.0, 30.0, 80.0, 70.0, 480.0, 80.0, 80.0, 0.0, 80.0, 60.0, -50.0, 80.0, 240.0, 120.0, 30.0, 60.0, 20.0, 160.0, 0.0, 190.0, 160.0, 100.0, 110.0, 90.0, 80.0, 60.0, 130.0, 100.0, 200.0, 540.0, 140.0, 35.0, 50.0, 40.0, 50.0, 100.0, 90.0, 360.0, 0.0, 75.0, 250.0, 0.0, 20.0, 20.0, 110.0, 140.0, 170.0, 10.0, 60.0, 150.0, 120.0, 70.0, 80.0, 40.0, 90.0, 30.0, 80.0, 30.0, 60.0, 130.0, 110.0, 110.0, 30.0, 30.0, 165.0, 70.0, 330.0, -20.0, 440.0, 40.0, 40.0, 0.0, 170.0, 60.0, 140.0, 100.0, 160.0, 170.0, 40.0, 70.0, 150.0, 210.0, 50.0, 230.0, 90.0, 30.0, -10.0, 180.0, 360.0, 230.0, 360.0, 70.0, 190.0, -60.0, 150.0, 130.0, 10.0, 30.0, 100.0, 90.0, 100.0, 400.0, -30.0, 70.0, 45.0, 170.0, 50.0, 110.0, 10.0, 30.0, 50.0, 160.0, 940.0, -40.0, 30.0, 50.0, 150.0, 170.0, 40.0, 100.0, 0.0, 40.0, 170.0, 30.0, 80.0, 40.0, 10.0, 10.0, 250.0, 20.0, 0.0, 40.0, 30.0, 280.0, 50.0, 170.0, 140.0, 80.0, 40.0, -50.0, 50.0, 70.0, 330.0, 150.0, 190.0, 0.0, 60.0, 80.0, 30.0, 20.0, 1130.0, 10.0, 40.0, 10.0, 40.0, 40.0, 210.0, 20.0, 140.0, 120.0, 120.0, 20.0, 130.0, 130.0, 160.0, 40.0, 50.0, 60.0, 160.0, 90.0, 40.0, 80.0, 40.0, 10.0, 60.0, 40.0, 30.0, 30.0, 330.0, 50.0, 140.0, 130.0, 60.0, 390.0, 80.0, 270.0, 80.0, -10.0, -70.0, 20.0, 350.0, 140.0, 240.0, -20.0, 10.0, -10.0, 30.0, 480.0, 120.0, -10.0, 130.0, 60.0, 90.0, 70.0, 120.0, 140.0, 70.0, 320.0, 340.0, 120.0, 170.0, 190.0, 40.0, 160.0, 430.0, 540.0, 120.0, 40.0, 240.0, 140.0, 50.0, 20.0, 50.0, 80.0, 0.0, 140.0, 80.0, 180.0, 120.0, 210.0, 0.0, -50.0, 0.0, 170.0, 80.0, 850.0, 30.0, 0.0, 30.0, 170.0, 40.0, 140.0, 50.0, 10.0, 120.0, 70.0, 100.0, 230.0, 0.0, 10.0, 40.0, 40.0, -15.0, 70.0, 10.0, 20.0, 30.0, 30.0, 50.0, 80.0, 130.0, 30.0, 190.0, 0.0, -10.0, 0.0, 660.0, 80.0, 200.0, 80.0, 20.0, 60.0, 30.0, 470.0, 150.0, 30.0, 120.0, 140.0, 150.0, 80.0, 160.0, 10.0, 70.0, 20.0, 140.0, 30.0, 20.0, 90.0, 20.0, -95.0, -560.0, 410.0, 180.0, 60.0, 20.0, 120.0, 270.0, 120.0, 110.0, 80.0, 0.0, 20.0, 155.0, 210.0, 20.0, 100.0, 30.0, 350.0, 40.0, 300.0, 40.0, 160.0, 100.0, 50.0, 0.0, 190.0, 0.0, 110.0, 105.0, 70.0, 20.0, 70.0, 170.0, 30.0, 210.0, 100.0, 90.0, 80.0, 30.0, 10.0, 20.0, 30.0, 120.0, 130.0, 40.0, 10.0, 80.0, 130.0, 20.0, 170.0, 170.0, 70.0, 0.0, 110.0, 150.0, 160.0, 40.0, 40.0, 10.0, -80.0, 220.0, 180.0, 100.0, 140.0, 150.0, 70.0, 260.0, 150.0, 70.0, 40.0, -10.0, 370.0, -25.0, 90.0, 200.0, 70.0, 300.0, -75.0, 180.0, 40.0, 20.0, 80.0, -20.0, 20.0, 220.0, 10.0, 40.0, 10.0, 30.0, 50.0, 190.0, 190.0, 60.0, 380.0, 90.0, 135.0, 20.0, 110.0, -10.0, 60.0, 10.0, 10.0, 80.0, 20.0, 60.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 110.0, 80.0, 30.0, 10.0, 110.0, 30.0, 510.0, 40.0, 180.0, -40.0, 450.0, 390.0, 100.0, 370.0, 20.0, 70.0, 60.0, 140.0, 20.0, 10.0, 20.0, 270.0, 100.0, -10.0, 70.0, 50.0, 40.0, 660.0, 230.0, 40.0, 90.0, 70.0, 20.0, 60.0, 60.0, 100.0, 60.0, 110.0, 200.0, 30.0, 40.0, 170.0, 20.0, 20.0, 460.0, 200.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 310.0, 70.0, 20.0, 200.0, 50.0, 40.0, 50.0, 10.0, 80.0, 40.0, 20.0, 150.0, 190.0, 20.0, 660.0, -50.0, 20.0, 0.0, 0.0, 290.0, 60.0, 390.0, 250.0, 110.0, -20.0, 60.0, 140.0, 380.0, -50.0, 190.0, 60.0, 30.0, 60.0, 30.0, 130.0, -75.0, 100.0, 50.0, 190.0, 80.0, 0.0, 0.0, 90.0, 40.0, 20.0, 70.0, 90.0, 20.0, 140.0, -20.0, 760.0, 210.0, 65.0, 50.0, 170.0, -30.0, 450.0, 160.0, 180.0, 260.0, -10.0, 70.0, 50.0, 270.0, -40.0, -10.0, 190.0, 80.0, 190.0, 60.0, 40.0, 60.0, 260.0, 80.0, 110.0, 170.0, 40.0, 140.0, 20.0, -70.0, 110.0, 140.0, 350.0, 30.0, 60.0, 60.0, 40.0, 0.0, 220.0, 40.0, 180.0, 20.0, 40.0, 20.0, 160.0, 130.0, 190.0, 400.0, 130.0, 50.0, 30.0, 180.0, 340.0, 130.0, 60.0, 220.0, -20.0, 0.0, 130.0, -20.0, 20.0, 40.0, 50.0, 610.0, 250.0, 130.0, 30.0, 40.0, 110.0, 0.0, -20.0, 170.0, 180.0, 120.0, 80.0, 0.0, 80.0, -30.0, 210.0, 410.0, 40.0, 100.0, 220.0, 160.0, 80.0, -40.0, 30.0, 70.0, 20.0, 60.0, 10.0, 10.0, 30.0, 30.0, 20.0, 40.0, 520.0, 40.0, 40.0, 5.0, -10.0, 30.0, 110.0, 10.0, 20.0, 300.0, 40.0, 30.0, 100.0, 0.0, 140.0, 10.0, 30.0, 30.0, 10.0, 20.0, 90.0, 80.0, -50.0, 25.0, 25.0, 30.0, 160.0, -20.0, 10.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.488041167228237, "mean_inference_ms": 1.4171847941863405, "mean_action_processing_ms": 0.4221456810385425, "mean_env_wait_ms": 1.2514070920636764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012861251831054688, "StateBufferConnector_ms": 0.013684988021850586, "ViewRequirementAgentConnector_ms": 0.43561673164367676}, "num_episodes": 18, "episode_return_max": 2050.0, "episode_return_min": 285.0, "episode_return_mean": 994.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.111289057274142, "num_env_steps_trained_throughput_per_sec": 21.111289057274142, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 5120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5120000, "timers": {"training_iteration_time_ms": 186728.225, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186728.173, "sample_time_ms": 2475.252, "learn_time_ms": 184229.573, "learn_throughput": 21.712, "synch_weights_time_ms": 14.55}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "done": false, "training_iteration": 128, "trial_id": "90816_00000", "date": "2024-06-10_06-52-21", "timestamp": 1718016741, "time_this_iter_s": 189.48270297050476, "time_total_s": 24018.299884796143, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b0045160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24018.299884796143, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 25.93768656716418, "ram_util_percent": 81.09253731343281}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9776926946525757, "cur_kl_coeff": 8.88738773223702, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0039523448480919985, "vf_loss": 6.276392160868619, "vf_explained_var": 0.0012331612765217742, "kl": Infinity, "entropy": 0.36328649469140495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1206615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "env_runners": {"episode_reward_max": 2050.0, "episode_reward_min": 200.0, "episode_reward_mean": 997.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -560.0}, "policy_reward_max": {"policy_0": 1130.0}, "policy_reward_mean": {"policy_0": 99.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1040.0, 810.0, 1150.0, 375.0, 1930.0, 1670.0, 670.0, 845.0, 1060.0, 1120.0, 1165.0, 1110.0, 1100.0, 930.0, 730.0, 1020.0, 1180.0, 600.0, 630.0, 1060.0, 720.0, 1220.0, 1405.0, 855.0, 750.0, 1395.0, 920.0, 1360.0, 1210.0, 1015.0, 1580.0, 730.0, 850.0, 910.0, 1660.0, 990.0, 750.0, 1120.0, 1360.0, 1330.0, 2050.0, 860.0, 1320.0, 930.0, 285.0, 1360.0, 1250.0, 640.0, 635.0, 1005.0, 1055.0, 870.0, 590.0, 920.0, 1260.0, 1140.0, 450.0, 1215.0, 360.0, 980.0, 1740.0, 1230.0, 840.0, 1160.0, 790.0, 1170.0, 1160.0, 895.0, 640.0, 1455.0, 1380.0, 1240.0, 880.0, 850.0, 1730.0, 1190.0, 710.0, 1230.0, 320.0, 1065.0, 410.0, 380.0, 830.0, 1400.0, 710.0, 1380.0, 885.0, 1130.0, 710.0, 1110.0, 1100.0, 480.0, 1130.0, 1080.0, 1165.0, 870.0, 200.0, 260.0, 860.0, 440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 110.0, 50.0, 360.0, 150.0, 50.0, 40.0, 130.0, 10.0, 60.0, 140.0, 10.0, 20.0, 100.0, 10.0, 10.0, -30.0, 130.0, 350.0, 70.0, 310.0, 90.0, 30.0, 60.0, 140.0, 300.0, 80.0, 50.0, 80.0, 10.0, 30.0, -5.0, 50.0, 20.0, 20.0, 70.0, 70.0, -10.0, 70.0, 60.0, 280.0, 50.0, 210.0, 500.0, 440.0, 170.0, 20.0, 100.0, 80.0, 80.0, 30.0, 100.0, -20.0, 460.0, 150.0, 60.0, 90.0, 610.0, 20.0, 170.0, 50.0, 20.0, 20.0, 30.0, 0.0, 20.0, 60.0, 210.0, 100.0, 160.0, -50.0, -90.0, 120.0, 150.0, 25.0, -45.0, 390.0, 5.0, 260.0, 80.0, 20.0, 20.0, 100.0, 20.0, 90.0, 160.0, 100.0, 290.0, 120.0, 140.0, 80.0, 10.0, 170.0, 170.0, 90.0, 30.0, 110.0, 200.0, 60.0, 200.0, 310.0, 25.0, 100.0, 30.0, -10.0, 80.0, 10.0, -80.0, 580.0, 120.0, 90.0, 20.0, 120.0, 290.0, 70.0, 10.0, 30.0, 90.0, 30.0, 360.0, 270.0, 90.0, 220.0, 100.0, 80.0, 40.0, 20.0, 40.0, -10.0, 250.0, 10.0, -50.0, 380.0, 0.0, 150.0, 120.0, 180.0, 110.0, -20.0, 50.0, -30.0, 20.0, 30.0, 0.0, -40.0, 780.0, 10.0, -40.0, 60.0, -60.0, 60.0, 500.0, 70.0, 170.0, 30.0, 30.0, 20.0, 60.0, 0.0, 80.0, 80.0, 60.0, -30.0, 60.0, 90.0, 140.0, 60.0, 210.0, 110.0, 400.0, 40.0, 50.0, -50.0, -10.0, 40.0, 110.0, 0.0, 360.0, 0.0, 60.0, 40.0, 20.0, 200.0, 70.0, 30.0, 190.0, 30.0, 20.0, 20.0, 10.0, -50.0, 210.0, 30.0, 80.0, 70.0, 480.0, 80.0, 80.0, 0.0, 80.0, 60.0, -50.0, 80.0, 240.0, 120.0, 30.0, 60.0, 20.0, 160.0, 0.0, 190.0, 160.0, 100.0, 110.0, 90.0, 80.0, 60.0, 130.0, 100.0, 200.0, 540.0, 140.0, 35.0, 50.0, 40.0, 50.0, 100.0, 90.0, 360.0, 0.0, 75.0, 250.0, 0.0, 20.0, 20.0, 110.0, 140.0, 170.0, 10.0, 60.0, 150.0, 120.0, 70.0, 80.0, 40.0, 90.0, 30.0, 80.0, 30.0, 60.0, 130.0, 110.0, 110.0, 30.0, 30.0, 165.0, 70.0, 330.0, -20.0, 440.0, 40.0, 40.0, 0.0, 170.0, 60.0, 140.0, 100.0, 160.0, 170.0, 40.0, 70.0, 150.0, 210.0, 50.0, 230.0, 90.0, 30.0, -10.0, 180.0, 360.0, 230.0, 360.0, 70.0, 190.0, -60.0, 150.0, 130.0, 10.0, 30.0, 100.0, 90.0, 100.0, 400.0, -30.0, 70.0, 45.0, 170.0, 50.0, 110.0, 10.0, 30.0, 50.0, 160.0, 940.0, -40.0, 30.0, 50.0, 150.0, 170.0, 40.0, 100.0, 0.0, 40.0, 170.0, 30.0, 80.0, 40.0, 10.0, 10.0, 250.0, 20.0, 0.0, 40.0, 30.0, 280.0, 50.0, 170.0, 140.0, 80.0, 40.0, -50.0, 50.0, 70.0, 330.0, 150.0, 190.0, 0.0, 60.0, 80.0, 30.0, 20.0, 1130.0, 10.0, 40.0, 10.0, 40.0, 40.0, 210.0, 20.0, 140.0, 120.0, 120.0, 20.0, 130.0, 130.0, 160.0, 40.0, 50.0, 60.0, 160.0, 90.0, 40.0, 80.0, 40.0, 10.0, 60.0, 40.0, 30.0, 30.0, 330.0, 50.0, 140.0, 130.0, 60.0, 390.0, 80.0, 270.0, 80.0, -10.0, -70.0, 20.0, 350.0, 140.0, 240.0, -20.0, 10.0, -10.0, 30.0, 480.0, 120.0, -10.0, 130.0, 60.0, 90.0, 70.0, 120.0, 140.0, 70.0, 320.0, 340.0, 120.0, 170.0, 190.0, 40.0, 160.0, 430.0, 540.0, 120.0, 40.0, 240.0, 140.0, 50.0, 20.0, 50.0, 80.0, 0.0, 140.0, 80.0, 180.0, 120.0, 210.0, 0.0, -50.0, 0.0, 170.0, 80.0, 850.0, 30.0, 0.0, 30.0, 170.0, 40.0, 140.0, 50.0, 10.0, 120.0, 70.0, 100.0, 230.0, 0.0, 10.0, 40.0, 40.0, -15.0, 70.0, 10.0, 20.0, 30.0, 30.0, 50.0, 80.0, 130.0, 30.0, 190.0, 0.0, -10.0, 0.0, 660.0, 80.0, 200.0, 80.0, 20.0, 60.0, 30.0, 470.0, 150.0, 30.0, 120.0, 140.0, 150.0, 80.0, 160.0, 10.0, 70.0, 20.0, 140.0, 30.0, 20.0, 90.0, 20.0, -95.0, -560.0, 410.0, 180.0, 60.0, 20.0, 120.0, 270.0, 120.0, 110.0, 80.0, 0.0, 20.0, 155.0, 210.0, 20.0, 100.0, 30.0, 350.0, 40.0, 300.0, 40.0, 160.0, 100.0, 50.0, 0.0, 190.0, 0.0, 110.0, 105.0, 70.0, 20.0, 70.0, 170.0, 30.0, 210.0, 100.0, 90.0, 80.0, 30.0, 10.0, 20.0, 30.0, 120.0, 130.0, 40.0, 10.0, 80.0, 130.0, 20.0, 170.0, 170.0, 70.0, 0.0, 110.0, 150.0, 160.0, 40.0, 40.0, 10.0, -80.0, 220.0, 180.0, 100.0, 140.0, 150.0, 70.0, 260.0, 150.0, 70.0, 40.0, -10.0, 370.0, -25.0, 90.0, 200.0, 70.0, 300.0, -75.0, 180.0, 40.0, 20.0, 80.0, -20.0, 20.0, 220.0, 10.0, 40.0, 10.0, 30.0, 50.0, 190.0, 190.0, 60.0, 380.0, 90.0, 135.0, 20.0, 110.0, -10.0, 60.0, 10.0, 10.0, 80.0, 20.0, 60.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 110.0, 80.0, 30.0, 10.0, 110.0, 30.0, 510.0, 40.0, 180.0, -40.0, 450.0, 390.0, 100.0, 370.0, 20.0, 70.0, 60.0, 140.0, 20.0, 10.0, 20.0, 270.0, 100.0, -10.0, 70.0, 50.0, 40.0, 660.0, 230.0, 40.0, 90.0, 70.0, 20.0, 60.0, 60.0, 100.0, 60.0, 110.0, 200.0, 30.0, 40.0, 170.0, 20.0, 20.0, 460.0, 200.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 310.0, 70.0, 20.0, 200.0, 50.0, 40.0, 50.0, 10.0, 80.0, 40.0, 20.0, 150.0, 190.0, 20.0, 660.0, -50.0, 20.0, 0.0, 0.0, 290.0, 60.0, 390.0, 250.0, 110.0, -20.0, 60.0, 140.0, 380.0, -50.0, 190.0, 60.0, 30.0, 60.0, 30.0, 130.0, -75.0, 100.0, 50.0, 190.0, 80.0, 0.0, 0.0, 90.0, 40.0, 20.0, 70.0, 90.0, 20.0, 140.0, -20.0, 760.0, 210.0, 65.0, 50.0, 170.0, -30.0, 450.0, 160.0, 180.0, 260.0, -10.0, 70.0, 50.0, 270.0, -40.0, -10.0, 190.0, 80.0, 190.0, 60.0, 40.0, 60.0, 260.0, 80.0, 110.0, 170.0, 40.0, 140.0, 20.0, -70.0, 110.0, 140.0, 350.0, 30.0, 60.0, 60.0, 40.0, 0.0, 220.0, 40.0, 180.0, 20.0, 40.0, 20.0, 160.0, 130.0, 190.0, 400.0, 130.0, 50.0, 30.0, 180.0, 340.0, 130.0, 60.0, 220.0, -20.0, 0.0, 130.0, -20.0, 20.0, 40.0, 50.0, 610.0, 250.0, 130.0, 30.0, 40.0, 110.0, 0.0, -20.0, 170.0, 180.0, 120.0, 80.0, 0.0, 80.0, -30.0, 210.0, 410.0, 40.0, 100.0, 220.0, 160.0, 80.0, -40.0, 30.0, 70.0, 20.0, 60.0, 10.0, 10.0, 30.0, 30.0, 20.0, 40.0, 520.0, 40.0, 40.0, 5.0, -10.0, 30.0, 110.0, 10.0, 20.0, 300.0, 40.0, 30.0, 100.0, 0.0, 140.0, 10.0, 30.0, 30.0, 10.0, 20.0, 90.0, 80.0, -50.0, 25.0, 25.0, 30.0, 160.0, -20.0, 10.0, 30.0, 650.0, 30.0, 0.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 120.0, 130.0, 40.0, 310.0, 0.0, 30.0, 120.0, 190.0, 80.0, 380.0, 0.0, 20.0, 150.0, 40.0, 60.0, 80.0, 20.0, 90.0, 190.0, 60.0, 160.0, 0.0, 130.0, 100.0, 60.0, 190.0, 80.0, 150.0, 320.0, 190.0, 110.0, 290.0, 100.0, 30.0, 20.0, -45.0, 30.0, 220.0, 0.0, 130.0, 20.0, 180.0, 120.0, 90.0, 10.0, 60.0, 10.0, 70.0, 200.0, 370.0, 10.0, -10.0, -50.0, 50.0, 70.0, 10.0, 40.0, -20.0, 20.0, 590.0, -40.0, 60.0, 430.0, 20.0, 150.0, 20.0, 380.0, 50.0, 20.0, 20.0, -20.0, 90.0, 90.0, 30.0, 350.0, 190.0, 10.0, 190.0, 0.0, 170.0, 40.0, 200.0, 10.0, 110.0, 40.0, -70.0, 0.0, 60.0, 30.0, 60.0, 20.0, 180.0, 120.0, 20.0, 0.0, 250.0, 210.0, 40.0, 80.0, 210.0, 160.0, 170.0, 120.0, 20.0, 110.0, 30.0, 300.0, 0.0, 30.0, 140.0, 180.0, 140.0, 70.0, 160.0, 275.0, 150.0, 30.0, 30.0, 100.0, 30.0, 0.0, 0.0, 70.0, 30.0, 50.0, 150.0, 70.0, 40.0, 10.0, 450.0, 10.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 20.0, 0.0, 60.0, -10.0, 210.0, 50.0, 130.0, 110.0, -10.0, 170.0, 120.0, 30.0, 20.0, 60.0, 160.0, 0.0, 40.0, 40.0, 0.0, 70.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4875197363652832, "mean_inference_ms": 1.4177881726190733, "mean_action_processing_ms": 0.42204938185198093, "mean_env_wait_ms": 1.2517979592017876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012803077697753906, "StateBufferConnector_ms": 0.013743400573730469, "ViewRequirementAgentConnector_ms": 0.43563318252563477}, "num_episodes": 18, "episode_return_max": 2050.0, "episode_return_min": 200.0, "episode_return_mean": 997.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.46249899768017, "num_env_steps_trained_throughput_per_sec": 21.46249899768017, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 5160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5160000, "timers": {"training_iteration_time_ms": 186508.763, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186508.711, "sample_time_ms": 2494.874, "learn_time_ms": 183990.334, "learn_throughput": 21.74, "synch_weights_time_ms": 14.748}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "done": false, "training_iteration": 129, "trial_id": "90816_00000", "date": "2024-06-10_06-55-27", "timestamp": 1718016927, "time_this_iter_s": 186.38177371025085, "time_total_s": 24204.681658506393, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00b5160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24204.681658506393, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 18.760984848484846, "ram_util_percent": 78.7784090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9905026441120617, "cur_kl_coeff": 13.331081598355526, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.708628259807095, "policy_loss": -0.002667028364736321, "vf_loss": 6.708609978713421, "vf_explained_var": -0.0011794839740688174, "kl": 0.00020143186598474525, "entropy": 0.32750245826566815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1216005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "env_runners": {"episode_reward_max": 2050.0, "episode_reward_min": 200.0, "episode_reward_mean": 995.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -560.0}, "policy_reward_max": {"policy_0": 1130.0}, "policy_reward_mean": {"policy_0": 99.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [855.0, 750.0, 1395.0, 920.0, 1360.0, 1210.0, 1015.0, 1580.0, 730.0, 850.0, 910.0, 1660.0, 990.0, 750.0, 1120.0, 1360.0, 1330.0, 2050.0, 860.0, 1320.0, 930.0, 285.0, 1360.0, 1250.0, 640.0, 635.0, 1005.0, 1055.0, 870.0, 590.0, 920.0, 1260.0, 1140.0, 450.0, 1215.0, 360.0, 980.0, 1740.0, 1230.0, 840.0, 1160.0, 790.0, 1170.0, 1160.0, 895.0, 640.0, 1455.0, 1380.0, 1240.0, 880.0, 850.0, 1730.0, 1190.0, 710.0, 1230.0, 320.0, 1065.0, 410.0, 380.0, 830.0, 1400.0, 710.0, 1380.0, 885.0, 1130.0, 710.0, 1110.0, 1100.0, 480.0, 1130.0, 1080.0, 1165.0, 870.0, 200.0, 260.0, 860.0, 440.0, 640.0, 1075.0, 335.0, 295.0, 1780.0, 1025.0, 250.0, 1500.0, 570.0, 1040.0, 640.0, 725.0, 1125.0, 1670.0, 1480.0, 1500.0, 1440.0, 1620.0, 790.0, 750.0, 1450.0, 810.0, 850.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [75.0, 250.0, 0.0, 20.0, 20.0, 110.0, 140.0, 170.0, 10.0, 60.0, 150.0, 120.0, 70.0, 80.0, 40.0, 90.0, 30.0, 80.0, 30.0, 60.0, 130.0, 110.0, 110.0, 30.0, 30.0, 165.0, 70.0, 330.0, -20.0, 440.0, 40.0, 40.0, 0.0, 170.0, 60.0, 140.0, 100.0, 160.0, 170.0, 40.0, 70.0, 150.0, 210.0, 50.0, 230.0, 90.0, 30.0, -10.0, 180.0, 360.0, 230.0, 360.0, 70.0, 190.0, -60.0, 150.0, 130.0, 10.0, 30.0, 100.0, 90.0, 100.0, 400.0, -30.0, 70.0, 45.0, 170.0, 50.0, 110.0, 10.0, 30.0, 50.0, 160.0, 940.0, -40.0, 30.0, 50.0, 150.0, 170.0, 40.0, 100.0, 0.0, 40.0, 170.0, 30.0, 80.0, 40.0, 10.0, 10.0, 250.0, 20.0, 0.0, 40.0, 30.0, 280.0, 50.0, 170.0, 140.0, 80.0, 40.0, -50.0, 50.0, 70.0, 330.0, 150.0, 190.0, 0.0, 60.0, 80.0, 30.0, 20.0, 1130.0, 10.0, 40.0, 10.0, 40.0, 40.0, 210.0, 20.0, 140.0, 120.0, 120.0, 20.0, 130.0, 130.0, 160.0, 40.0, 50.0, 60.0, 160.0, 90.0, 40.0, 80.0, 40.0, 10.0, 60.0, 40.0, 30.0, 30.0, 330.0, 50.0, 140.0, 130.0, 60.0, 390.0, 80.0, 270.0, 80.0, -10.0, -70.0, 20.0, 350.0, 140.0, 240.0, -20.0, 10.0, -10.0, 30.0, 480.0, 120.0, -10.0, 130.0, 60.0, 90.0, 70.0, 120.0, 140.0, 70.0, 320.0, 340.0, 120.0, 170.0, 190.0, 40.0, 160.0, 430.0, 540.0, 120.0, 40.0, 240.0, 140.0, 50.0, 20.0, 50.0, 80.0, 0.0, 140.0, 80.0, 180.0, 120.0, 210.0, 0.0, -50.0, 0.0, 170.0, 80.0, 850.0, 30.0, 0.0, 30.0, 170.0, 40.0, 140.0, 50.0, 10.0, 120.0, 70.0, 100.0, 230.0, 0.0, 10.0, 40.0, 40.0, -15.0, 70.0, 10.0, 20.0, 30.0, 30.0, 50.0, 80.0, 130.0, 30.0, 190.0, 0.0, -10.0, 0.0, 660.0, 80.0, 200.0, 80.0, 20.0, 60.0, 30.0, 470.0, 150.0, 30.0, 120.0, 140.0, 150.0, 80.0, 160.0, 10.0, 70.0, 20.0, 140.0, 30.0, 20.0, 90.0, 20.0, -95.0, -560.0, 410.0, 180.0, 60.0, 20.0, 120.0, 270.0, 120.0, 110.0, 80.0, 0.0, 20.0, 155.0, 210.0, 20.0, 100.0, 30.0, 350.0, 40.0, 300.0, 40.0, 160.0, 100.0, 50.0, 0.0, 190.0, 0.0, 110.0, 105.0, 70.0, 20.0, 70.0, 170.0, 30.0, 210.0, 100.0, 90.0, 80.0, 30.0, 10.0, 20.0, 30.0, 120.0, 130.0, 40.0, 10.0, 80.0, 130.0, 20.0, 170.0, 170.0, 70.0, 0.0, 110.0, 150.0, 160.0, 40.0, 40.0, 10.0, -80.0, 220.0, 180.0, 100.0, 140.0, 150.0, 70.0, 260.0, 150.0, 70.0, 40.0, -10.0, 370.0, -25.0, 90.0, 200.0, 70.0, 300.0, -75.0, 180.0, 40.0, 20.0, 80.0, -20.0, 20.0, 220.0, 10.0, 40.0, 10.0, 30.0, 50.0, 190.0, 190.0, 60.0, 380.0, 90.0, 135.0, 20.0, 110.0, -10.0, 60.0, 10.0, 10.0, 80.0, 20.0, 60.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 110.0, 80.0, 30.0, 10.0, 110.0, 30.0, 510.0, 40.0, 180.0, -40.0, 450.0, 390.0, 100.0, 370.0, 20.0, 70.0, 60.0, 140.0, 20.0, 10.0, 20.0, 270.0, 100.0, -10.0, 70.0, 50.0, 40.0, 660.0, 230.0, 40.0, 90.0, 70.0, 20.0, 60.0, 60.0, 100.0, 60.0, 110.0, 200.0, 30.0, 40.0, 170.0, 20.0, 20.0, 460.0, 200.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 310.0, 70.0, 20.0, 200.0, 50.0, 40.0, 50.0, 10.0, 80.0, 40.0, 20.0, 150.0, 190.0, 20.0, 660.0, -50.0, 20.0, 0.0, 0.0, 290.0, 60.0, 390.0, 250.0, 110.0, -20.0, 60.0, 140.0, 380.0, -50.0, 190.0, 60.0, 30.0, 60.0, 30.0, 130.0, -75.0, 100.0, 50.0, 190.0, 80.0, 0.0, 0.0, 90.0, 40.0, 20.0, 70.0, 90.0, 20.0, 140.0, -20.0, 760.0, 210.0, 65.0, 50.0, 170.0, -30.0, 450.0, 160.0, 180.0, 260.0, -10.0, 70.0, 50.0, 270.0, -40.0, -10.0, 190.0, 80.0, 190.0, 60.0, 40.0, 60.0, 260.0, 80.0, 110.0, 170.0, 40.0, 140.0, 20.0, -70.0, 110.0, 140.0, 350.0, 30.0, 60.0, 60.0, 40.0, 0.0, 220.0, 40.0, 180.0, 20.0, 40.0, 20.0, 160.0, 130.0, 190.0, 400.0, 130.0, 50.0, 30.0, 180.0, 340.0, 130.0, 60.0, 220.0, -20.0, 0.0, 130.0, -20.0, 20.0, 40.0, 50.0, 610.0, 250.0, 130.0, 30.0, 40.0, 110.0, 0.0, -20.0, 170.0, 180.0, 120.0, 80.0, 0.0, 80.0, -30.0, 210.0, 410.0, 40.0, 100.0, 220.0, 160.0, 80.0, -40.0, 30.0, 70.0, 20.0, 60.0, 10.0, 10.0, 30.0, 30.0, 20.0, 40.0, 520.0, 40.0, 40.0, 5.0, -10.0, 30.0, 110.0, 10.0, 20.0, 300.0, 40.0, 30.0, 100.0, 0.0, 140.0, 10.0, 30.0, 30.0, 10.0, 20.0, 90.0, 80.0, -50.0, 25.0, 25.0, 30.0, 160.0, -20.0, 10.0, 30.0, 650.0, 30.0, 0.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 120.0, 130.0, 40.0, 310.0, 0.0, 30.0, 120.0, 190.0, 80.0, 380.0, 0.0, 20.0, 150.0, 40.0, 60.0, 80.0, 20.0, 90.0, 190.0, 60.0, 160.0, 0.0, 130.0, 100.0, 60.0, 190.0, 80.0, 150.0, 320.0, 190.0, 110.0, 290.0, 100.0, 30.0, 20.0, -45.0, 30.0, 220.0, 0.0, 130.0, 20.0, 180.0, 120.0, 90.0, 10.0, 60.0, 10.0, 70.0, 200.0, 370.0, 10.0, -10.0, -50.0, 50.0, 70.0, 10.0, 40.0, -20.0, 20.0, 590.0, -40.0, 60.0, 430.0, 20.0, 150.0, 20.0, 380.0, 50.0, 20.0, 20.0, -20.0, 90.0, 90.0, 30.0, 350.0, 190.0, 10.0, 190.0, 0.0, 170.0, 40.0, 200.0, 10.0, 110.0, 40.0, -70.0, 0.0, 60.0, 30.0, 60.0, 20.0, 180.0, 120.0, 20.0, 0.0, 250.0, 210.0, 40.0, 80.0, 210.0, 160.0, 170.0, 120.0, 20.0, 110.0, 30.0, 300.0, 0.0, 30.0, 140.0, 180.0, 140.0, 70.0, 160.0, 275.0, 150.0, 30.0, 30.0, 100.0, 30.0, 0.0, 0.0, 70.0, 30.0, 50.0, 150.0, 70.0, 40.0, 10.0, 450.0, 10.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 20.0, 0.0, 60.0, -10.0, 210.0, 50.0, 130.0, 110.0, -10.0, 170.0, 120.0, 30.0, 20.0, 60.0, 160.0, 0.0, 40.0, 40.0, 0.0, 70.0, 30.0, 20.0, 20.0, 30.0, 140.0, 230.0, 0.0, 20.0, 130.0, 40.0, 20.0, 10.0, 110.0, 120.0, 120.0, 120.0, 140.0, 20.0, 50.0, 20.0, 45.0, 330.0, 80.0, 20.0, 10.0, 50.0, 40.0, 40.0, 10.0, 40.0, 15.0, 30.0, 0.0, 20.0, 30.0, 20.0, 90.0, 50.0, -5.0, 20.0, 70.0, 0.0, 210.0, 40.0, 530.0, 40.0, 50.0, 110.0, 80.0, 70.0, 100.0, 550.0, 110.0, -40.0, 35.0, 70.0, 40.0, -10.0, 320.0, 190.0, 270.0, 40.0, 30.0, 80.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 0.0, 10.0, 60.0, 330.0, 140.0, 60.0, 330.0, 20.0, 0.0, 110.0, 290.0, 160.0, 50.0, 40.0, 130.0, 20.0, 110.0, 40.0, 100.0, 20.0, 40.0, 20.0, 70.0, 80.0, 70.0, 30.0, 50.0, 0.0, 20.0, 90.0, 60.0, 570.0, 60.0, -20.0, -20.0, 40.0, 170.0, 10.0, 0.0, 0.0, 380.0, 20.0, 15.0, 30.0, -10.0, 70.0, -40.0, 30.0, 60.0, -10.0, 460.0, 120.0, 0.0, 35.0, 140.0, 50.0, 30.0, 250.0, 110.0, 110.0, 40.0, 360.0, 80.0, 390.0, -10.0, 20.0, 20.0, 70.0, 100.0, 40.0, 750.0, 210.0, 50.0, 150.0, 270.0, 130.0, 50.0, 40.0, 220.0, 50.0, 20.0, 500.0, 130.0, 300.0, 40.0, 60.0, 10.0, 50.0, 490.0, 140.0, 60.0, 220.0, 50.0, 10.0, 120.0, 170.0, -10.0, 100.0, 390.0, 400.0, 20.0, 190.0, -10.0, 60.0, 130.0, 90.0, 30.0, 30.0, 260.0, 730.0, 200.0, 100.0, 40.0, 90.0, 70.0, 100.0, 120.0, 30.0, 180.0, 40.0, 60.0, 60.0, 20.0, 40.0, 40.0, 50.0, 170.0, 40.0, 300.0, 70.0, 10.0, 10.0, 210.0, 360.0, 290.0, 180.0, 30.0, 380.0, 60.0, -30.0, -50.0, 20.0, 20.0, 30.0, 0.0, 40.0, 60.0, 160.0, 20.0, 30.0, 440.0, 10.0, 150.0, 120.0, 120.0, 60.0, 50.0, 20.0, 50.0, 110.0, 30.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.486804815849835, "mean_inference_ms": 1.41849038081254, "mean_action_processing_ms": 0.42192692543142696, "mean_env_wait_ms": 1.2523183249604517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013417243957519531, "StateBufferConnector_ms": 0.013911247253417969, "ViewRequirementAgentConnector_ms": 0.4457206726074219}, "num_episodes": 23, "episode_return_max": 2050.0, "episode_return_min": 200.0, "episode_return_mean": 995.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.492922722888295, "num_env_steps_trained_throughput_per_sec": 21.492922722888295, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 5200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5200000, "timers": {"training_iteration_time_ms": 186378.902, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186378.851, "sample_time_ms": 2486.509, "learn_time_ms": 183867.904, "learn_throughput": 21.755, "synch_weights_time_ms": 14.972}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "done": false, "training_iteration": 130, "trial_id": "90816_00000", "date": "2024-06-10_06-58-34", "timestamp": 1718017114, "time_this_iter_s": 186.13278698921204, "time_total_s": 24390.814445495605, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00459d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24390.814445495605, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 18.279467680608363, "ram_util_percent": 78.07642585551332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.001661362517248, "cur_kl_coeff": 6.665540799177763, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004115411036804564, "vf_loss": 7.167953008940172, "vf_explained_var": 0.0005430089462552461, "kl": Infinity, "entropy": 0.339286957003565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1225395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "env_runners": {"episode_reward_max": 1900.0, "episode_reward_min": 200.0, "episode_reward_mean": 963.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -560.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 96.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1360.0, 1250.0, 640.0, 635.0, 1005.0, 1055.0, 870.0, 590.0, 920.0, 1260.0, 1140.0, 450.0, 1215.0, 360.0, 980.0, 1740.0, 1230.0, 840.0, 1160.0, 790.0, 1170.0, 1160.0, 895.0, 640.0, 1455.0, 1380.0, 1240.0, 880.0, 850.0, 1730.0, 1190.0, 710.0, 1230.0, 320.0, 1065.0, 410.0, 380.0, 830.0, 1400.0, 710.0, 1380.0, 885.0, 1130.0, 710.0, 1110.0, 1100.0, 480.0, 1130.0, 1080.0, 1165.0, 870.0, 200.0, 260.0, 860.0, 440.0, 640.0, 1075.0, 335.0, 295.0, 1780.0, 1025.0, 250.0, 1500.0, 570.0, 1040.0, 640.0, 725.0, 1125.0, 1670.0, 1480.0, 1500.0, 1440.0, 1620.0, 790.0, 750.0, 1450.0, 810.0, 850.0, 1590.0, 1730.0, 400.0, 930.0, 870.0, 695.0, 425.0, 1490.0, 1590.0, 830.0, 560.0, 860.0, 700.0, 1900.0, 735.0, 1080.0, 1210.0, 760.0, 540.0, 910.0, 890.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 130.0, 30.0, 190.0, 0.0, -10.0, 0.0, 660.0, 80.0, 200.0, 80.0, 20.0, 60.0, 30.0, 470.0, 150.0, 30.0, 120.0, 140.0, 150.0, 80.0, 160.0, 10.0, 70.0, 20.0, 140.0, 30.0, 20.0, 90.0, 20.0, -95.0, -560.0, 410.0, 180.0, 60.0, 20.0, 120.0, 270.0, 120.0, 110.0, 80.0, 0.0, 20.0, 155.0, 210.0, 20.0, 100.0, 30.0, 350.0, 40.0, 300.0, 40.0, 160.0, 100.0, 50.0, 0.0, 190.0, 0.0, 110.0, 105.0, 70.0, 20.0, 70.0, 170.0, 30.0, 210.0, 100.0, 90.0, 80.0, 30.0, 10.0, 20.0, 30.0, 120.0, 130.0, 40.0, 10.0, 80.0, 130.0, 20.0, 170.0, 170.0, 70.0, 0.0, 110.0, 150.0, 160.0, 40.0, 40.0, 10.0, -80.0, 220.0, 180.0, 100.0, 140.0, 150.0, 70.0, 260.0, 150.0, 70.0, 40.0, -10.0, 370.0, -25.0, 90.0, 200.0, 70.0, 300.0, -75.0, 180.0, 40.0, 20.0, 80.0, -20.0, 20.0, 220.0, 10.0, 40.0, 10.0, 30.0, 50.0, 190.0, 190.0, 60.0, 380.0, 90.0, 135.0, 20.0, 110.0, -10.0, 60.0, 10.0, 10.0, 80.0, 20.0, 60.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 110.0, 80.0, 30.0, 10.0, 110.0, 30.0, 510.0, 40.0, 180.0, -40.0, 450.0, 390.0, 100.0, 370.0, 20.0, 70.0, 60.0, 140.0, 20.0, 10.0, 20.0, 270.0, 100.0, -10.0, 70.0, 50.0, 40.0, 660.0, 230.0, 40.0, 90.0, 70.0, 20.0, 60.0, 60.0, 100.0, 60.0, 110.0, 200.0, 30.0, 40.0, 170.0, 20.0, 20.0, 460.0, 200.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 310.0, 70.0, 20.0, 200.0, 50.0, 40.0, 50.0, 10.0, 80.0, 40.0, 20.0, 150.0, 190.0, 20.0, 660.0, -50.0, 20.0, 0.0, 0.0, 290.0, 60.0, 390.0, 250.0, 110.0, -20.0, 60.0, 140.0, 380.0, -50.0, 190.0, 60.0, 30.0, 60.0, 30.0, 130.0, -75.0, 100.0, 50.0, 190.0, 80.0, 0.0, 0.0, 90.0, 40.0, 20.0, 70.0, 90.0, 20.0, 140.0, -20.0, 760.0, 210.0, 65.0, 50.0, 170.0, -30.0, 450.0, 160.0, 180.0, 260.0, -10.0, 70.0, 50.0, 270.0, -40.0, -10.0, 190.0, 80.0, 190.0, 60.0, 40.0, 60.0, 260.0, 80.0, 110.0, 170.0, 40.0, 140.0, 20.0, -70.0, 110.0, 140.0, 350.0, 30.0, 60.0, 60.0, 40.0, 0.0, 220.0, 40.0, 180.0, 20.0, 40.0, 20.0, 160.0, 130.0, 190.0, 400.0, 130.0, 50.0, 30.0, 180.0, 340.0, 130.0, 60.0, 220.0, -20.0, 0.0, 130.0, -20.0, 20.0, 40.0, 50.0, 610.0, 250.0, 130.0, 30.0, 40.0, 110.0, 0.0, -20.0, 170.0, 180.0, 120.0, 80.0, 0.0, 80.0, -30.0, 210.0, 410.0, 40.0, 100.0, 220.0, 160.0, 80.0, -40.0, 30.0, 70.0, 20.0, 60.0, 10.0, 10.0, 30.0, 30.0, 20.0, 40.0, 520.0, 40.0, 40.0, 5.0, -10.0, 30.0, 110.0, 10.0, 20.0, 300.0, 40.0, 30.0, 100.0, 0.0, 140.0, 10.0, 30.0, 30.0, 10.0, 20.0, 90.0, 80.0, -50.0, 25.0, 25.0, 30.0, 160.0, -20.0, 10.0, 30.0, 650.0, 30.0, 0.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 120.0, 130.0, 40.0, 310.0, 0.0, 30.0, 120.0, 190.0, 80.0, 380.0, 0.0, 20.0, 150.0, 40.0, 60.0, 80.0, 20.0, 90.0, 190.0, 60.0, 160.0, 0.0, 130.0, 100.0, 60.0, 190.0, 80.0, 150.0, 320.0, 190.0, 110.0, 290.0, 100.0, 30.0, 20.0, -45.0, 30.0, 220.0, 0.0, 130.0, 20.0, 180.0, 120.0, 90.0, 10.0, 60.0, 10.0, 70.0, 200.0, 370.0, 10.0, -10.0, -50.0, 50.0, 70.0, 10.0, 40.0, -20.0, 20.0, 590.0, -40.0, 60.0, 430.0, 20.0, 150.0, 20.0, 380.0, 50.0, 20.0, 20.0, -20.0, 90.0, 90.0, 30.0, 350.0, 190.0, 10.0, 190.0, 0.0, 170.0, 40.0, 200.0, 10.0, 110.0, 40.0, -70.0, 0.0, 60.0, 30.0, 60.0, 20.0, 180.0, 120.0, 20.0, 0.0, 250.0, 210.0, 40.0, 80.0, 210.0, 160.0, 170.0, 120.0, 20.0, 110.0, 30.0, 300.0, 0.0, 30.0, 140.0, 180.0, 140.0, 70.0, 160.0, 275.0, 150.0, 30.0, 30.0, 100.0, 30.0, 0.0, 0.0, 70.0, 30.0, 50.0, 150.0, 70.0, 40.0, 10.0, 450.0, 10.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 20.0, 0.0, 60.0, -10.0, 210.0, 50.0, 130.0, 110.0, -10.0, 170.0, 120.0, 30.0, 20.0, 60.0, 160.0, 0.0, 40.0, 40.0, 0.0, 70.0, 30.0, 20.0, 20.0, 30.0, 140.0, 230.0, 0.0, 20.0, 130.0, 40.0, 20.0, 10.0, 110.0, 120.0, 120.0, 120.0, 140.0, 20.0, 50.0, 20.0, 45.0, 330.0, 80.0, 20.0, 10.0, 50.0, 40.0, 40.0, 10.0, 40.0, 15.0, 30.0, 0.0, 20.0, 30.0, 20.0, 90.0, 50.0, -5.0, 20.0, 70.0, 0.0, 210.0, 40.0, 530.0, 40.0, 50.0, 110.0, 80.0, 70.0, 100.0, 550.0, 110.0, -40.0, 35.0, 70.0, 40.0, -10.0, 320.0, 190.0, 270.0, 40.0, 30.0, 80.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 0.0, 10.0, 60.0, 330.0, 140.0, 60.0, 330.0, 20.0, 0.0, 110.0, 290.0, 160.0, 50.0, 40.0, 130.0, 20.0, 110.0, 40.0, 100.0, 20.0, 40.0, 20.0, 70.0, 80.0, 70.0, 30.0, 50.0, 0.0, 20.0, 90.0, 60.0, 570.0, 60.0, -20.0, -20.0, 40.0, 170.0, 10.0, 0.0, 0.0, 380.0, 20.0, 15.0, 30.0, -10.0, 70.0, -40.0, 30.0, 60.0, -10.0, 460.0, 120.0, 0.0, 35.0, 140.0, 50.0, 30.0, 250.0, 110.0, 110.0, 40.0, 360.0, 80.0, 390.0, -10.0, 20.0, 20.0, 70.0, 100.0, 40.0, 750.0, 210.0, 50.0, 150.0, 270.0, 130.0, 50.0, 40.0, 220.0, 50.0, 20.0, 500.0, 130.0, 300.0, 40.0, 60.0, 10.0, 50.0, 490.0, 140.0, 60.0, 220.0, 50.0, 10.0, 120.0, 170.0, -10.0, 100.0, 390.0, 400.0, 20.0, 190.0, -10.0, 60.0, 130.0, 90.0, 30.0, 30.0, 260.0, 730.0, 200.0, 100.0, 40.0, 90.0, 70.0, 100.0, 120.0, 30.0, 180.0, 40.0, 60.0, 60.0, 20.0, 40.0, 40.0, 50.0, 170.0, 40.0, 300.0, 70.0, 10.0, 10.0, 210.0, 360.0, 290.0, 180.0, 30.0, 380.0, 60.0, -30.0, -50.0, 20.0, 20.0, 30.0, 0.0, 40.0, 60.0, 160.0, 20.0, 30.0, 440.0, 10.0, 150.0, 120.0, 120.0, 60.0, 50.0, 20.0, 50.0, 110.0, 30.0, 140.0, 100.0, 180.0, 10.0, 540.0, 130.0, 90.0, 70.0, 80.0, 300.0, 90.0, 260.0, 40.0, 30.0, 210.0, -10.0, 50.0, 500.0, 90.0, 400.0, 160.0, 10.0, 70.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 30.0, 20.0, 60.0, 90.0, 200.0, -40.0, 60.0, 70.0, 50.0, 390.0, 30.0, -40.0, -20.0, -40.0, -40.0, 310.0, 40.0, -70.0, 710.0, -40.0, 60.0, 40.0, 40.0, 120.0, 20.0, 40.0, 130.0, 55.0, 200.0, 40.0, 10.0, 160.0, 20.0, 30.0, 30.0, 35.0, 20.0, 30.0, 70.0, 10.0, 20.0, 310.0, 50.0, 220.0, 430.0, 50.0, 20.0, 20.0, 180.0, 90.0, 120.0, 130.0, 330.0, 160.0, 70.0, 120.0, 90.0, 80.0, 530.0, -10.0, 90.0, 60.0, 10.0, -20.0, 160.0, 30.0, 20.0, 150.0, 160.0, 110.0, 150.0, 30.0, -100.0, 200.0, 30.0, -160.0, -50.0, 560.0, 190.0, 10.0, -150.0, 200.0, 10.0, 20.0, 70.0, 460.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 20.0, 10.0, -15.0, 80.0, 390.0, -25.0, 10.0, 140.0, 70.0, 50.0, 150.0, 110.0, 40.0, 160.0, 670.0, 160.0, 30.0, 440.0, 90.0, -175.0, 180.0, 20.0, 20.0, 140.0, 90.0, 220.0, 160.0, -30.0, 110.0, 390.0, 140.0, 160.0, 120.0, 110.0, 10.0, 20.0, 20.0, -20.0, 130.0, 280.0, 260.0, 20.0, 90.0, 30.0, 70.0, 20.0, 50.0, 350.0, 40.0, -210.0, 170.0, 130.0, 180.0, 180.0, 120.0, 100.0, 50.0, -10.0, 50.0, 50.0, -40.0, 100.0, 10.0, 160.0, 50.0, 0.0, 170.0, 0.0, 40.0, 100.0, 20.0, 40.0, 110.0, 10.0, 50.0, 260.0, 40.0, 50.0, 230.0, 0.0, 200.0, 240.0, 100.0, 120.0, 30.0, 40.0, 20.0, 120.0, 20.0, 20.0, 30.0, 40.0, 40.0, 0.0, 50.0, 0.0, 140.0, 40.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4870248029708262, "mean_inference_ms": 1.4202385371449535, "mean_action_processing_ms": 0.4218606304899351, "mean_env_wait_ms": 1.253014918357675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020052433013916016, "StateBufferConnector_ms": 0.011587858200073242, "ViewRequirementAgentConnector_ms": 0.4518115520477295}, "num_episodes": 22, "episode_return_max": 1900.0, "episode_return_min": 200.0, "episode_return_mean": 963.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.596037672787702, "num_env_steps_trained_throughput_per_sec": 21.596037672787702, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 5240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5240000, "timers": {"training_iteration_time_ms": 186363.518, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186363.466, "sample_time_ms": 2461.297, "learn_time_ms": 183876.959, "learn_throughput": 21.754, "synch_weights_time_ms": 14.87}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "done": false, "training_iteration": 131, "trial_id": "90816_00000", "date": "2024-06-10_07-01-39", "timestamp": 1718017299, "time_this_iter_s": 185.22960996627808, "time_total_s": 24576.044055461884, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00b5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24576.044055461884, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 21.061068702290076, "ram_util_percent": 78.50381679389314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.569677789072894, "cur_kl_coeff": 9.998311198766649, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0033857552270197704, "vf_loss": 7.038885887743185, "vf_explained_var": 0.002229440186859066, "kl": Infinity, "entropy": 0.33309084206216505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1234785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "env_runners": {"episode_reward_max": 1950.0, "episode_reward_min": 200.0, "episode_reward_mean": 987.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 98.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1160.0, 790.0, 1170.0, 1160.0, 895.0, 640.0, 1455.0, 1380.0, 1240.0, 880.0, 850.0, 1730.0, 1190.0, 710.0, 1230.0, 320.0, 1065.0, 410.0, 380.0, 830.0, 1400.0, 710.0, 1380.0, 885.0, 1130.0, 710.0, 1110.0, 1100.0, 480.0, 1130.0, 1080.0, 1165.0, 870.0, 200.0, 260.0, 860.0, 440.0, 640.0, 1075.0, 335.0, 295.0, 1780.0, 1025.0, 250.0, 1500.0, 570.0, 1040.0, 640.0, 725.0, 1125.0, 1670.0, 1480.0, 1500.0, 1440.0, 1620.0, 790.0, 750.0, 1450.0, 810.0, 850.0, 1590.0, 1730.0, 400.0, 930.0, 870.0, 695.0, 425.0, 1490.0, 1590.0, 830.0, 560.0, 860.0, 700.0, 1900.0, 735.0, 1080.0, 1210.0, 760.0, 540.0, 910.0, 890.0, 370.0, 205.0, 1810.0, 1330.0, 1090.0, 1480.0, 1780.0, 830.0, 225.0, 1230.0, 1020.0, 1950.0, 1140.0, 1200.0, 1645.0, 1040.0, 730.0, 560.0, 690.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [200.0, 30.0, 40.0, 170.0, 20.0, 20.0, 460.0, 200.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 310.0, 70.0, 20.0, 200.0, 50.0, 40.0, 50.0, 10.0, 80.0, 40.0, 20.0, 150.0, 190.0, 20.0, 660.0, -50.0, 20.0, 0.0, 0.0, 290.0, 60.0, 390.0, 250.0, 110.0, -20.0, 60.0, 140.0, 380.0, -50.0, 190.0, 60.0, 30.0, 60.0, 30.0, 130.0, -75.0, 100.0, 50.0, 190.0, 80.0, 0.0, 0.0, 90.0, 40.0, 20.0, 70.0, 90.0, 20.0, 140.0, -20.0, 760.0, 210.0, 65.0, 50.0, 170.0, -30.0, 450.0, 160.0, 180.0, 260.0, -10.0, 70.0, 50.0, 270.0, -40.0, -10.0, 190.0, 80.0, 190.0, 60.0, 40.0, 60.0, 260.0, 80.0, 110.0, 170.0, 40.0, 140.0, 20.0, -70.0, 110.0, 140.0, 350.0, 30.0, 60.0, 60.0, 40.0, 0.0, 220.0, 40.0, 180.0, 20.0, 40.0, 20.0, 160.0, 130.0, 190.0, 400.0, 130.0, 50.0, 30.0, 180.0, 340.0, 130.0, 60.0, 220.0, -20.0, 0.0, 130.0, -20.0, 20.0, 40.0, 50.0, 610.0, 250.0, 130.0, 30.0, 40.0, 110.0, 0.0, -20.0, 170.0, 180.0, 120.0, 80.0, 0.0, 80.0, -30.0, 210.0, 410.0, 40.0, 100.0, 220.0, 160.0, 80.0, -40.0, 30.0, 70.0, 20.0, 60.0, 10.0, 10.0, 30.0, 30.0, 20.0, 40.0, 520.0, 40.0, 40.0, 5.0, -10.0, 30.0, 110.0, 10.0, 20.0, 300.0, 40.0, 30.0, 100.0, 0.0, 140.0, 10.0, 30.0, 30.0, 10.0, 20.0, 90.0, 80.0, -50.0, 25.0, 25.0, 30.0, 160.0, -20.0, 10.0, 30.0, 650.0, 30.0, 0.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 120.0, 130.0, 40.0, 310.0, 0.0, 30.0, 120.0, 190.0, 80.0, 380.0, 0.0, 20.0, 150.0, 40.0, 60.0, 80.0, 20.0, 90.0, 190.0, 60.0, 160.0, 0.0, 130.0, 100.0, 60.0, 190.0, 80.0, 150.0, 320.0, 190.0, 110.0, 290.0, 100.0, 30.0, 20.0, -45.0, 30.0, 220.0, 0.0, 130.0, 20.0, 180.0, 120.0, 90.0, 10.0, 60.0, 10.0, 70.0, 200.0, 370.0, 10.0, -10.0, -50.0, 50.0, 70.0, 10.0, 40.0, -20.0, 20.0, 590.0, -40.0, 60.0, 430.0, 20.0, 150.0, 20.0, 380.0, 50.0, 20.0, 20.0, -20.0, 90.0, 90.0, 30.0, 350.0, 190.0, 10.0, 190.0, 0.0, 170.0, 40.0, 200.0, 10.0, 110.0, 40.0, -70.0, 0.0, 60.0, 30.0, 60.0, 20.0, 180.0, 120.0, 20.0, 0.0, 250.0, 210.0, 40.0, 80.0, 210.0, 160.0, 170.0, 120.0, 20.0, 110.0, 30.0, 300.0, 0.0, 30.0, 140.0, 180.0, 140.0, 70.0, 160.0, 275.0, 150.0, 30.0, 30.0, 100.0, 30.0, 0.0, 0.0, 70.0, 30.0, 50.0, 150.0, 70.0, 40.0, 10.0, 450.0, 10.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 20.0, 0.0, 60.0, -10.0, 210.0, 50.0, 130.0, 110.0, -10.0, 170.0, 120.0, 30.0, 20.0, 60.0, 160.0, 0.0, 40.0, 40.0, 0.0, 70.0, 30.0, 20.0, 20.0, 30.0, 140.0, 230.0, 0.0, 20.0, 130.0, 40.0, 20.0, 10.0, 110.0, 120.0, 120.0, 120.0, 140.0, 20.0, 50.0, 20.0, 45.0, 330.0, 80.0, 20.0, 10.0, 50.0, 40.0, 40.0, 10.0, 40.0, 15.0, 30.0, 0.0, 20.0, 30.0, 20.0, 90.0, 50.0, -5.0, 20.0, 70.0, 0.0, 210.0, 40.0, 530.0, 40.0, 50.0, 110.0, 80.0, 70.0, 100.0, 550.0, 110.0, -40.0, 35.0, 70.0, 40.0, -10.0, 320.0, 190.0, 270.0, 40.0, 30.0, 80.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 0.0, 10.0, 60.0, 330.0, 140.0, 60.0, 330.0, 20.0, 0.0, 110.0, 290.0, 160.0, 50.0, 40.0, 130.0, 20.0, 110.0, 40.0, 100.0, 20.0, 40.0, 20.0, 70.0, 80.0, 70.0, 30.0, 50.0, 0.0, 20.0, 90.0, 60.0, 570.0, 60.0, -20.0, -20.0, 40.0, 170.0, 10.0, 0.0, 0.0, 380.0, 20.0, 15.0, 30.0, -10.0, 70.0, -40.0, 30.0, 60.0, -10.0, 460.0, 120.0, 0.0, 35.0, 140.0, 50.0, 30.0, 250.0, 110.0, 110.0, 40.0, 360.0, 80.0, 390.0, -10.0, 20.0, 20.0, 70.0, 100.0, 40.0, 750.0, 210.0, 50.0, 150.0, 270.0, 130.0, 50.0, 40.0, 220.0, 50.0, 20.0, 500.0, 130.0, 300.0, 40.0, 60.0, 10.0, 50.0, 490.0, 140.0, 60.0, 220.0, 50.0, 10.0, 120.0, 170.0, -10.0, 100.0, 390.0, 400.0, 20.0, 190.0, -10.0, 60.0, 130.0, 90.0, 30.0, 30.0, 260.0, 730.0, 200.0, 100.0, 40.0, 90.0, 70.0, 100.0, 120.0, 30.0, 180.0, 40.0, 60.0, 60.0, 20.0, 40.0, 40.0, 50.0, 170.0, 40.0, 300.0, 70.0, 10.0, 10.0, 210.0, 360.0, 290.0, 180.0, 30.0, 380.0, 60.0, -30.0, -50.0, 20.0, 20.0, 30.0, 0.0, 40.0, 60.0, 160.0, 20.0, 30.0, 440.0, 10.0, 150.0, 120.0, 120.0, 60.0, 50.0, 20.0, 50.0, 110.0, 30.0, 140.0, 100.0, 180.0, 10.0, 540.0, 130.0, 90.0, 70.0, 80.0, 300.0, 90.0, 260.0, 40.0, 30.0, 210.0, -10.0, 50.0, 500.0, 90.0, 400.0, 160.0, 10.0, 70.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 30.0, 20.0, 60.0, 90.0, 200.0, -40.0, 60.0, 70.0, 50.0, 390.0, 30.0, -40.0, -20.0, -40.0, -40.0, 310.0, 40.0, -70.0, 710.0, -40.0, 60.0, 40.0, 40.0, 120.0, 20.0, 40.0, 130.0, 55.0, 200.0, 40.0, 10.0, 160.0, 20.0, 30.0, 30.0, 35.0, 20.0, 30.0, 70.0, 10.0, 20.0, 310.0, 50.0, 220.0, 430.0, 50.0, 20.0, 20.0, 180.0, 90.0, 120.0, 130.0, 330.0, 160.0, 70.0, 120.0, 90.0, 80.0, 530.0, -10.0, 90.0, 60.0, 10.0, -20.0, 160.0, 30.0, 20.0, 150.0, 160.0, 110.0, 150.0, 30.0, -100.0, 200.0, 30.0, -160.0, -50.0, 560.0, 190.0, 10.0, -150.0, 200.0, 10.0, 20.0, 70.0, 460.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 20.0, 10.0, -15.0, 80.0, 390.0, -25.0, 10.0, 140.0, 70.0, 50.0, 150.0, 110.0, 40.0, 160.0, 670.0, 160.0, 30.0, 440.0, 90.0, -175.0, 180.0, 20.0, 20.0, 140.0, 90.0, 220.0, 160.0, -30.0, 110.0, 390.0, 140.0, 160.0, 120.0, 110.0, 10.0, 20.0, 20.0, -20.0, 130.0, 280.0, 260.0, 20.0, 90.0, 30.0, 70.0, 20.0, 50.0, 350.0, 40.0, -210.0, 170.0, 130.0, 180.0, 180.0, 120.0, 100.0, 50.0, -10.0, 50.0, 50.0, -40.0, 100.0, 10.0, 160.0, 50.0, 0.0, 170.0, 0.0, 40.0, 100.0, 20.0, 40.0, 110.0, 10.0, 50.0, 260.0, 40.0, 50.0, 230.0, 0.0, 200.0, 240.0, 100.0, 120.0, 30.0, 40.0, 20.0, 120.0, 20.0, 20.0, 30.0, 40.0, 40.0, 0.0, 50.0, 0.0, 140.0, 40.0, 10.0, 70.0, 10.0, 0.0, 15.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 90.0, 400.0, 300.0, 80.0, 220.0, 210.0, 40.0, 120.0, 320.0, 90.0, 730.0, 20.0, 40.0, 20.0, 60.0, 70.0, 160.0, 70.0, 70.0, 100.0, 60.0, 20.0, 270.0, 110.0, 90.0, 60.0, 150.0, 180.0, 50.0, 50.0, 290.0, 20.0, 30.0, 10.0, 710.0, 20.0, 300.0, 40.0, 10.0, 70.0, 380.0, 20.0, 200.0, 70.0, 430.0, 50.0, 370.0, 20.0, 170.0, 20.0, 40.0, 120.0, -10.0, 10.0, 360.0, 130.0, 40.0, 20.0, 100.0, 30.0, -20.0, 20.0, 30.0, 20.0, 5.0, 20.0, 10.0, 110.0, 0.0, 170.0, 190.0, 10.0, 170.0, 40.0, 50.0, 190.0, 25.0, 210.0, 175.0, 70.0, 140.0, 50.0, 120.0, 70.0, 80.0, 200.0, 100.0, 180.0, 10.0, 170.0, 40.0, 310.0, 120.0, 70.0, 150.0, 240.0, 40.0, 550.0, 260.0, 20.0, 340.0, 50.0, 20.0, 270.0, 20.0, 70.0, 100.0, 210.0, 40.0, 170.0, 250.0, 80.0, 20.0, 80.0, 140.0, 120.0, 110.0, 170.0, 60.0, 650.0, 170.0, 105.0, 110.0, 60.0, 100.0, 20.0, 90.0, 60.0, 280.0, 80.0, -40.0, 90.0, 220.0, 160.0, 200.0, 10.0, 290.0, 20.0, 10.0, 80.0, -50.0, 150.0, 200.0, 30.0, 10.0, 90.0, 60.0, 10.0, 150.0, 80.0, 40.0, 30.0, 80.0, 20.0, 20.0, 10.0, 20.0, 130.0, 130.0, 30.0, 60.0, 30.0, 10.0, 100.0, 180.0, 140.0, 120.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4856689389889624, "mean_inference_ms": 1.4199788271933556, "mean_action_processing_ms": 0.4217863082624308, "mean_env_wait_ms": 1.2534610611160069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021248579025268555, "StateBufferConnector_ms": 0.011256694793701172, "ViewRequirementAgentConnector_ms": 0.43823862075805664}, "num_episodes": 18, "episode_return_max": 1950.0, "episode_return_min": 200.0, "episode_return_mean": 987.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.48616365545168, "num_env_steps_trained_throughput_per_sec": 21.48616365545168, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 5280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5280000, "timers": {"training_iteration_time_ms": 186240.932, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186240.885, "sample_time_ms": 2497.431, "learn_time_ms": 183718.84, "learn_throughput": 21.772, "synch_weights_time_ms": 14.832}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "done": false, "training_iteration": 132, "trial_id": "90816_00000", "date": "2024-06-10_07-04-45", "timestamp": 1718017485, "time_this_iter_s": 186.17612504959106, "time_total_s": 24762.220180511475, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3111ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24762.220180511475, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 25.493916349809883, "ram_util_percent": 78.91444866920152}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.356580751182172, "cur_kl_coeff": 14.997466798149965, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.248847375814907, "policy_loss": -0.0033243265335474864, "vf_loss": 6.249049681317184, "vf_explained_var": 0.0022834053181738645, "kl": 0.00020817029515984633, "entropy": 0.3571544043807049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1244175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "env_runners": {"episode_reward_max": 1950.0, "episode_reward_min": 200.0, "episode_reward_mean": 957.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 95.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 830.0, 1400.0, 710.0, 1380.0, 885.0, 1130.0, 710.0, 1110.0, 1100.0, 480.0, 1130.0, 1080.0, 1165.0, 870.0, 200.0, 260.0, 860.0, 440.0, 640.0, 1075.0, 335.0, 295.0, 1780.0, 1025.0, 250.0, 1500.0, 570.0, 1040.0, 640.0, 725.0, 1125.0, 1670.0, 1480.0, 1500.0, 1440.0, 1620.0, 790.0, 750.0, 1450.0, 810.0, 850.0, 1590.0, 1730.0, 400.0, 930.0, 870.0, 695.0, 425.0, 1490.0, 1590.0, 830.0, 560.0, 860.0, 700.0, 1900.0, 735.0, 1080.0, 1210.0, 760.0, 540.0, 910.0, 890.0, 370.0, 205.0, 1810.0, 1330.0, 1090.0, 1480.0, 1780.0, 830.0, 225.0, 1230.0, 1020.0, 1950.0, 1140.0, 1200.0, 1645.0, 1040.0, 730.0, 560.0, 690.0, 980.0, 210.0, 1690.0, 1005.0, 1330.0, 1260.0, 465.0, 610.0, 400.0, 1420.0, 700.0, 670.0, 795.0, 600.0, 670.0, 890.0, 1260.0, 330.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 80.0, -50.0, 25.0, 25.0, 30.0, 160.0, -20.0, 10.0, 30.0, 650.0, 30.0, 0.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 120.0, 130.0, 40.0, 310.0, 0.0, 30.0, 120.0, 190.0, 80.0, 380.0, 0.0, 20.0, 150.0, 40.0, 60.0, 80.0, 20.0, 90.0, 190.0, 60.0, 160.0, 0.0, 130.0, 100.0, 60.0, 190.0, 80.0, 150.0, 320.0, 190.0, 110.0, 290.0, 100.0, 30.0, 20.0, -45.0, 30.0, 220.0, 0.0, 130.0, 20.0, 180.0, 120.0, 90.0, 10.0, 60.0, 10.0, 70.0, 200.0, 370.0, 10.0, -10.0, -50.0, 50.0, 70.0, 10.0, 40.0, -20.0, 20.0, 590.0, -40.0, 60.0, 430.0, 20.0, 150.0, 20.0, 380.0, 50.0, 20.0, 20.0, -20.0, 90.0, 90.0, 30.0, 350.0, 190.0, 10.0, 190.0, 0.0, 170.0, 40.0, 200.0, 10.0, 110.0, 40.0, -70.0, 0.0, 60.0, 30.0, 60.0, 20.0, 180.0, 120.0, 20.0, 0.0, 250.0, 210.0, 40.0, 80.0, 210.0, 160.0, 170.0, 120.0, 20.0, 110.0, 30.0, 300.0, 0.0, 30.0, 140.0, 180.0, 140.0, 70.0, 160.0, 275.0, 150.0, 30.0, 30.0, 100.0, 30.0, 0.0, 0.0, 70.0, 30.0, 50.0, 150.0, 70.0, 40.0, 10.0, 450.0, 10.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 20.0, 0.0, 60.0, -10.0, 210.0, 50.0, 130.0, 110.0, -10.0, 170.0, 120.0, 30.0, 20.0, 60.0, 160.0, 0.0, 40.0, 40.0, 0.0, 70.0, 30.0, 20.0, 20.0, 30.0, 140.0, 230.0, 0.0, 20.0, 130.0, 40.0, 20.0, 10.0, 110.0, 120.0, 120.0, 120.0, 140.0, 20.0, 50.0, 20.0, 45.0, 330.0, 80.0, 20.0, 10.0, 50.0, 40.0, 40.0, 10.0, 40.0, 15.0, 30.0, 0.0, 20.0, 30.0, 20.0, 90.0, 50.0, -5.0, 20.0, 70.0, 0.0, 210.0, 40.0, 530.0, 40.0, 50.0, 110.0, 80.0, 70.0, 100.0, 550.0, 110.0, -40.0, 35.0, 70.0, 40.0, -10.0, 320.0, 190.0, 270.0, 40.0, 30.0, 80.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 0.0, 10.0, 60.0, 330.0, 140.0, 60.0, 330.0, 20.0, 0.0, 110.0, 290.0, 160.0, 50.0, 40.0, 130.0, 20.0, 110.0, 40.0, 100.0, 20.0, 40.0, 20.0, 70.0, 80.0, 70.0, 30.0, 50.0, 0.0, 20.0, 90.0, 60.0, 570.0, 60.0, -20.0, -20.0, 40.0, 170.0, 10.0, 0.0, 0.0, 380.0, 20.0, 15.0, 30.0, -10.0, 70.0, -40.0, 30.0, 60.0, -10.0, 460.0, 120.0, 0.0, 35.0, 140.0, 50.0, 30.0, 250.0, 110.0, 110.0, 40.0, 360.0, 80.0, 390.0, -10.0, 20.0, 20.0, 70.0, 100.0, 40.0, 750.0, 210.0, 50.0, 150.0, 270.0, 130.0, 50.0, 40.0, 220.0, 50.0, 20.0, 500.0, 130.0, 300.0, 40.0, 60.0, 10.0, 50.0, 490.0, 140.0, 60.0, 220.0, 50.0, 10.0, 120.0, 170.0, -10.0, 100.0, 390.0, 400.0, 20.0, 190.0, -10.0, 60.0, 130.0, 90.0, 30.0, 30.0, 260.0, 730.0, 200.0, 100.0, 40.0, 90.0, 70.0, 100.0, 120.0, 30.0, 180.0, 40.0, 60.0, 60.0, 20.0, 40.0, 40.0, 50.0, 170.0, 40.0, 300.0, 70.0, 10.0, 10.0, 210.0, 360.0, 290.0, 180.0, 30.0, 380.0, 60.0, -30.0, -50.0, 20.0, 20.0, 30.0, 0.0, 40.0, 60.0, 160.0, 20.0, 30.0, 440.0, 10.0, 150.0, 120.0, 120.0, 60.0, 50.0, 20.0, 50.0, 110.0, 30.0, 140.0, 100.0, 180.0, 10.0, 540.0, 130.0, 90.0, 70.0, 80.0, 300.0, 90.0, 260.0, 40.0, 30.0, 210.0, -10.0, 50.0, 500.0, 90.0, 400.0, 160.0, 10.0, 70.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 30.0, 20.0, 60.0, 90.0, 200.0, -40.0, 60.0, 70.0, 50.0, 390.0, 30.0, -40.0, -20.0, -40.0, -40.0, 310.0, 40.0, -70.0, 710.0, -40.0, 60.0, 40.0, 40.0, 120.0, 20.0, 40.0, 130.0, 55.0, 200.0, 40.0, 10.0, 160.0, 20.0, 30.0, 30.0, 35.0, 20.0, 30.0, 70.0, 10.0, 20.0, 310.0, 50.0, 220.0, 430.0, 50.0, 20.0, 20.0, 180.0, 90.0, 120.0, 130.0, 330.0, 160.0, 70.0, 120.0, 90.0, 80.0, 530.0, -10.0, 90.0, 60.0, 10.0, -20.0, 160.0, 30.0, 20.0, 150.0, 160.0, 110.0, 150.0, 30.0, -100.0, 200.0, 30.0, -160.0, -50.0, 560.0, 190.0, 10.0, -150.0, 200.0, 10.0, 20.0, 70.0, 460.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 20.0, 10.0, -15.0, 80.0, 390.0, -25.0, 10.0, 140.0, 70.0, 50.0, 150.0, 110.0, 40.0, 160.0, 670.0, 160.0, 30.0, 440.0, 90.0, -175.0, 180.0, 20.0, 20.0, 140.0, 90.0, 220.0, 160.0, -30.0, 110.0, 390.0, 140.0, 160.0, 120.0, 110.0, 10.0, 20.0, 20.0, -20.0, 130.0, 280.0, 260.0, 20.0, 90.0, 30.0, 70.0, 20.0, 50.0, 350.0, 40.0, -210.0, 170.0, 130.0, 180.0, 180.0, 120.0, 100.0, 50.0, -10.0, 50.0, 50.0, -40.0, 100.0, 10.0, 160.0, 50.0, 0.0, 170.0, 0.0, 40.0, 100.0, 20.0, 40.0, 110.0, 10.0, 50.0, 260.0, 40.0, 50.0, 230.0, 0.0, 200.0, 240.0, 100.0, 120.0, 30.0, 40.0, 20.0, 120.0, 20.0, 20.0, 30.0, 40.0, 40.0, 0.0, 50.0, 0.0, 140.0, 40.0, 10.0, 70.0, 10.0, 0.0, 15.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 90.0, 400.0, 300.0, 80.0, 220.0, 210.0, 40.0, 120.0, 320.0, 90.0, 730.0, 20.0, 40.0, 20.0, 60.0, 70.0, 160.0, 70.0, 70.0, 100.0, 60.0, 20.0, 270.0, 110.0, 90.0, 60.0, 150.0, 180.0, 50.0, 50.0, 290.0, 20.0, 30.0, 10.0, 710.0, 20.0, 300.0, 40.0, 10.0, 70.0, 380.0, 20.0, 200.0, 70.0, 430.0, 50.0, 370.0, 20.0, 170.0, 20.0, 40.0, 120.0, -10.0, 10.0, 360.0, 130.0, 40.0, 20.0, 100.0, 30.0, -20.0, 20.0, 30.0, 20.0, 5.0, 20.0, 10.0, 110.0, 0.0, 170.0, 190.0, 10.0, 170.0, 40.0, 50.0, 190.0, 25.0, 210.0, 175.0, 70.0, 140.0, 50.0, 120.0, 70.0, 80.0, 200.0, 100.0, 180.0, 10.0, 170.0, 40.0, 310.0, 120.0, 70.0, 150.0, 240.0, 40.0, 550.0, 260.0, 20.0, 340.0, 50.0, 20.0, 270.0, 20.0, 70.0, 100.0, 210.0, 40.0, 170.0, 250.0, 80.0, 20.0, 80.0, 140.0, 120.0, 110.0, 170.0, 60.0, 650.0, 170.0, 105.0, 110.0, 60.0, 100.0, 20.0, 90.0, 60.0, 280.0, 80.0, -40.0, 90.0, 220.0, 160.0, 200.0, 10.0, 290.0, 20.0, 10.0, 80.0, -50.0, 150.0, 200.0, 30.0, 10.0, 90.0, 60.0, 10.0, 150.0, 80.0, 40.0, 30.0, 80.0, 20.0, 20.0, 10.0, 20.0, 130.0, 130.0, 30.0, 60.0, 30.0, 10.0, 100.0, 180.0, 140.0, 120.0, 0.0, 20.0, 200.0, 70.0, 40.0, 0.0, 200.0, 30.0, 90.0, 40.0, 220.0, 90.0, 30.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 50.0, 20.0, 30.0, 80.0, 660.0, 270.0, -10.0, 30.0, 20.0, 70.0, 220.0, 320.0, 20.0, 150.0, 70.0, 100.0, -45.0, 30.0, 260.0, 460.0, -40.0, 0.0, 110.0, 160.0, 100.0, 220.0, 330.0, 120.0, 120.0, 170.0, -110.0, 110.0, 60.0, 150.0, 180.0, 470.0, 0.0, 170.0, 30.0, 60.0, 70.0, 70.0, 40.0, 15.0, 10.0, 0.0, 20.0, 100.0, 20.0, 110.0, 150.0, 0.0, 110.0, 150.0, 10.0, 90.0, 40.0, 60.0, 20.0, 60.0, 30.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 20.0, 150.0, 100.0, 10.0, 300.0, 70.0, 70.0, 20.0, 300.0, 320.0, 40.0, 170.0, 50.0, 80.0, 150.0, 10.0, 50.0, 20.0, 40.0, 60.0, 10.0, 50.0, 310.0, 0.0, 50.0, 30.0, 40.0, 50.0, 40.0, 70.0, 30.0, 270.0, 40.0, 50.0, 130.0, 110.0, 60.0, 140.0, 5.0, 10.0, 40.0, 250.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 20.0, 260.0, 55.0, 40.0, 30.0, 10.0, 20.0, 40.0, 100.0, 40.0, 140.0, 70.0, 10.0, 20.0, 30.0, 200.0, 40.0, 90.0, 80.0, 190.0, 40.0, 120.0, 90.0, 50.0, 100.0, 90.0, 80.0, 40.0, 90.0, 300.0, 80.0, 140.0, 80.0, 310.0, 150.0, -10.0, 10.0, 90.0, 0.0, 30.0, 70.0, 40.0, 90.0, 40.0, -40.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4846160138387716, "mean_inference_ms": 1.419971235996519, "mean_action_processing_ms": 0.42157924261384855, "mean_env_wait_ms": 1.2534917702778785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020786523818969727, "StateBufferConnector_ms": 0.009946346282958984, "ViewRequirementAgentConnector_ms": 0.3840596675872803}, "num_episodes": 18, "episode_return_max": 1950.0, "episode_return_min": 200.0, "episode_return_mean": 957.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.485573711545833, "num_env_steps_trained_throughput_per_sec": 21.485573711545833, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 5320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5320000, "timers": {"training_iteration_time_ms": 186265.381, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186265.333, "sample_time_ms": 2503.598, "learn_time_ms": 183737.593, "learn_throughput": 21.77, "synch_weights_time_ms": 14.401}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "done": false, "training_iteration": 133, "trial_id": "90816_00000", "date": "2024-06-10_07-07-51", "timestamp": 1718017671, "time_this_iter_s": 186.18219017982483, "time_total_s": 24948.4023706913, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b310f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24948.4023706913, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 23.679087452471485, "ram_util_percent": 79.45361216730036}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.272069505076058, "cur_kl_coeff": 7.4987333990749825, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0034970236635450533, "vf_loss": 6.842201591172792, "vf_explained_var": 0.0014974840469380664, "kl": Infinity, "entropy": 0.3612034745633412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1253565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "env_runners": {"episode_reward_max": 1950.0, "episode_reward_min": 205.0, "episode_reward_mean": 975.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 97.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1780.0, 1025.0, 250.0, 1500.0, 570.0, 1040.0, 640.0, 725.0, 1125.0, 1670.0, 1480.0, 1500.0, 1440.0, 1620.0, 790.0, 750.0, 1450.0, 810.0, 850.0, 1590.0, 1730.0, 400.0, 930.0, 870.0, 695.0, 425.0, 1490.0, 1590.0, 830.0, 560.0, 860.0, 700.0, 1900.0, 735.0, 1080.0, 1210.0, 760.0, 540.0, 910.0, 890.0, 370.0, 205.0, 1810.0, 1330.0, 1090.0, 1480.0, 1780.0, 830.0, 225.0, 1230.0, 1020.0, 1950.0, 1140.0, 1200.0, 1645.0, 1040.0, 730.0, 560.0, 690.0, 980.0, 210.0, 1690.0, 1005.0, 1330.0, 1260.0, 465.0, 610.0, 400.0, 1420.0, 700.0, 670.0, 795.0, 600.0, 670.0, 890.0, 1260.0, 330.0, 1240.0, 300.0, 1255.0, 320.0, 530.0, 780.0, 540.0, 1560.0, 840.0, 1050.0, 330.0, 460.0, 800.0, 715.0, 820.0, 1080.0, 1340.0, 795.0, 975.0, 1260.0, 1150.0, 870.0, 1250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 40.0, 530.0, 40.0, 50.0, 110.0, 80.0, 70.0, 100.0, 550.0, 110.0, -40.0, 35.0, 70.0, 40.0, -10.0, 320.0, 190.0, 270.0, 40.0, 30.0, 80.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 0.0, 10.0, 60.0, 330.0, 140.0, 60.0, 330.0, 20.0, 0.0, 110.0, 290.0, 160.0, 50.0, 40.0, 130.0, 20.0, 110.0, 40.0, 100.0, 20.0, 40.0, 20.0, 70.0, 80.0, 70.0, 30.0, 50.0, 0.0, 20.0, 90.0, 60.0, 570.0, 60.0, -20.0, -20.0, 40.0, 170.0, 10.0, 0.0, 0.0, 380.0, 20.0, 15.0, 30.0, -10.0, 70.0, -40.0, 30.0, 60.0, -10.0, 460.0, 120.0, 0.0, 35.0, 140.0, 50.0, 30.0, 250.0, 110.0, 110.0, 40.0, 360.0, 80.0, 390.0, -10.0, 20.0, 20.0, 70.0, 100.0, 40.0, 750.0, 210.0, 50.0, 150.0, 270.0, 130.0, 50.0, 40.0, 220.0, 50.0, 20.0, 500.0, 130.0, 300.0, 40.0, 60.0, 10.0, 50.0, 490.0, 140.0, 60.0, 220.0, 50.0, 10.0, 120.0, 170.0, -10.0, 100.0, 390.0, 400.0, 20.0, 190.0, -10.0, 60.0, 130.0, 90.0, 30.0, 30.0, 260.0, 730.0, 200.0, 100.0, 40.0, 90.0, 70.0, 100.0, 120.0, 30.0, 180.0, 40.0, 60.0, 60.0, 20.0, 40.0, 40.0, 50.0, 170.0, 40.0, 300.0, 70.0, 10.0, 10.0, 210.0, 360.0, 290.0, 180.0, 30.0, 380.0, 60.0, -30.0, -50.0, 20.0, 20.0, 30.0, 0.0, 40.0, 60.0, 160.0, 20.0, 30.0, 440.0, 10.0, 150.0, 120.0, 120.0, 60.0, 50.0, 20.0, 50.0, 110.0, 30.0, 140.0, 100.0, 180.0, 10.0, 540.0, 130.0, 90.0, 70.0, 80.0, 300.0, 90.0, 260.0, 40.0, 30.0, 210.0, -10.0, 50.0, 500.0, 90.0, 400.0, 160.0, 10.0, 70.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 30.0, 20.0, 60.0, 90.0, 200.0, -40.0, 60.0, 70.0, 50.0, 390.0, 30.0, -40.0, -20.0, -40.0, -40.0, 310.0, 40.0, -70.0, 710.0, -40.0, 60.0, 40.0, 40.0, 120.0, 20.0, 40.0, 130.0, 55.0, 200.0, 40.0, 10.0, 160.0, 20.0, 30.0, 30.0, 35.0, 20.0, 30.0, 70.0, 10.0, 20.0, 310.0, 50.0, 220.0, 430.0, 50.0, 20.0, 20.0, 180.0, 90.0, 120.0, 130.0, 330.0, 160.0, 70.0, 120.0, 90.0, 80.0, 530.0, -10.0, 90.0, 60.0, 10.0, -20.0, 160.0, 30.0, 20.0, 150.0, 160.0, 110.0, 150.0, 30.0, -100.0, 200.0, 30.0, -160.0, -50.0, 560.0, 190.0, 10.0, -150.0, 200.0, 10.0, 20.0, 70.0, 460.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 20.0, 10.0, -15.0, 80.0, 390.0, -25.0, 10.0, 140.0, 70.0, 50.0, 150.0, 110.0, 40.0, 160.0, 670.0, 160.0, 30.0, 440.0, 90.0, -175.0, 180.0, 20.0, 20.0, 140.0, 90.0, 220.0, 160.0, -30.0, 110.0, 390.0, 140.0, 160.0, 120.0, 110.0, 10.0, 20.0, 20.0, -20.0, 130.0, 280.0, 260.0, 20.0, 90.0, 30.0, 70.0, 20.0, 50.0, 350.0, 40.0, -210.0, 170.0, 130.0, 180.0, 180.0, 120.0, 100.0, 50.0, -10.0, 50.0, 50.0, -40.0, 100.0, 10.0, 160.0, 50.0, 0.0, 170.0, 0.0, 40.0, 100.0, 20.0, 40.0, 110.0, 10.0, 50.0, 260.0, 40.0, 50.0, 230.0, 0.0, 200.0, 240.0, 100.0, 120.0, 30.0, 40.0, 20.0, 120.0, 20.0, 20.0, 30.0, 40.0, 40.0, 0.0, 50.0, 0.0, 140.0, 40.0, 10.0, 70.0, 10.0, 0.0, 15.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 90.0, 400.0, 300.0, 80.0, 220.0, 210.0, 40.0, 120.0, 320.0, 90.0, 730.0, 20.0, 40.0, 20.0, 60.0, 70.0, 160.0, 70.0, 70.0, 100.0, 60.0, 20.0, 270.0, 110.0, 90.0, 60.0, 150.0, 180.0, 50.0, 50.0, 290.0, 20.0, 30.0, 10.0, 710.0, 20.0, 300.0, 40.0, 10.0, 70.0, 380.0, 20.0, 200.0, 70.0, 430.0, 50.0, 370.0, 20.0, 170.0, 20.0, 40.0, 120.0, -10.0, 10.0, 360.0, 130.0, 40.0, 20.0, 100.0, 30.0, -20.0, 20.0, 30.0, 20.0, 5.0, 20.0, 10.0, 110.0, 0.0, 170.0, 190.0, 10.0, 170.0, 40.0, 50.0, 190.0, 25.0, 210.0, 175.0, 70.0, 140.0, 50.0, 120.0, 70.0, 80.0, 200.0, 100.0, 180.0, 10.0, 170.0, 40.0, 310.0, 120.0, 70.0, 150.0, 240.0, 40.0, 550.0, 260.0, 20.0, 340.0, 50.0, 20.0, 270.0, 20.0, 70.0, 100.0, 210.0, 40.0, 170.0, 250.0, 80.0, 20.0, 80.0, 140.0, 120.0, 110.0, 170.0, 60.0, 650.0, 170.0, 105.0, 110.0, 60.0, 100.0, 20.0, 90.0, 60.0, 280.0, 80.0, -40.0, 90.0, 220.0, 160.0, 200.0, 10.0, 290.0, 20.0, 10.0, 80.0, -50.0, 150.0, 200.0, 30.0, 10.0, 90.0, 60.0, 10.0, 150.0, 80.0, 40.0, 30.0, 80.0, 20.0, 20.0, 10.0, 20.0, 130.0, 130.0, 30.0, 60.0, 30.0, 10.0, 100.0, 180.0, 140.0, 120.0, 0.0, 20.0, 200.0, 70.0, 40.0, 0.0, 200.0, 30.0, 90.0, 40.0, 220.0, 90.0, 30.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 50.0, 20.0, 30.0, 80.0, 660.0, 270.0, -10.0, 30.0, 20.0, 70.0, 220.0, 320.0, 20.0, 150.0, 70.0, 100.0, -45.0, 30.0, 260.0, 460.0, -40.0, 0.0, 110.0, 160.0, 100.0, 220.0, 330.0, 120.0, 120.0, 170.0, -110.0, 110.0, 60.0, 150.0, 180.0, 470.0, 0.0, 170.0, 30.0, 60.0, 70.0, 70.0, 40.0, 15.0, 10.0, 0.0, 20.0, 100.0, 20.0, 110.0, 150.0, 0.0, 110.0, 150.0, 10.0, 90.0, 40.0, 60.0, 20.0, 60.0, 30.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 20.0, 150.0, 100.0, 10.0, 300.0, 70.0, 70.0, 20.0, 300.0, 320.0, 40.0, 170.0, 50.0, 80.0, 150.0, 10.0, 50.0, 20.0, 40.0, 60.0, 10.0, 50.0, 310.0, 0.0, 50.0, 30.0, 40.0, 50.0, 40.0, 70.0, 30.0, 270.0, 40.0, 50.0, 130.0, 110.0, 60.0, 140.0, 5.0, 10.0, 40.0, 250.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 20.0, 260.0, 55.0, 40.0, 30.0, 10.0, 20.0, 40.0, 100.0, 40.0, 140.0, 70.0, 10.0, 20.0, 30.0, 200.0, 40.0, 90.0, 80.0, 190.0, 40.0, 120.0, 90.0, 50.0, 100.0, 90.0, 80.0, 40.0, 90.0, 300.0, 80.0, 140.0, 80.0, 310.0, 150.0, -10.0, 10.0, 90.0, 0.0, 30.0, 70.0, 40.0, 90.0, 40.0, -40.0, 0.0, 40.0, 160.0, 80.0, 120.0, 170.0, 10.0, 40.0, 360.0, 60.0, 200.0, -30.0, 10.0, 30.0, 0.0, 100.0, 60.0, 20.0, 20.0, 40.0, 50.0, 40.0, 270.0, 160.0, 70.0, 100.0, 160.0, 390.0, -30.0, 90.0, 5.0, 30.0, 0.0, 30.0, 0.0, 80.0, 70.0, 30.0, 60.0, -40.0, 60.0, 0.0, -40.0, 170.0, 130.0, 20.0, 70.0, 100.0, 80.0, 0.0, 0.0, 180.0, 60.0, 30.0, 0.0, 190.0, 80.0, 50.0, 40.0, 20.0, 130.0, 70.0, 20.0, 20.0, 20.0, 300.0, 60.0, 40.0, 0.0, 0.0, 10.0, 70.0, 220.0, 80.0, 480.0, 160.0, 30.0, 50.0, 120.0, 180.0, 170.0, 80.0, 20.0, 30.0, 70.0, 70.0, 60.0, 40.0, 90.0, 350.0, 30.0, -65.0, 780.0, 55.0, 80.0, 30.0, 20.0, 40.0, 0.0, 70.0, 40.0, 0.0, 270.0, 80.0, 120.0, 70.0, 30.0, -30.0, 20.0, -260.0, 30.0, 20.0, 40.0, 90.0, -130.0, 250.0, 10.0, 80.0, 20.0, 40.0, 40.0, 10.0, 70.0, 60.0, 30.0, 330.0, 50.0, 100.0, 40.0, 70.0, 40.0, 70.0, -85.0, -105.0, 110.0, 350.0, 80.0, -115.0, 170.0, 160.0, 80.0, 40.0, 30.0, 70.0, 60.0, 20.0, -20.0, 110.0, 250.0, 260.0, 0.0, 550.0, 70.0, 20.0, 250.0, 30.0, 20.0, 20.0, 50.0, 60.0, 10.0, 40.0, 90.0, 70.0, 150.0, 60.0, 310.0, 60.0, 480.0, 70.0, 10.0, 160.0, 160.0, 170.0, -55.0, 50.0, 70.0, 0.0, 10.0, 70.0, 160.0, 90.0, -30.0, 60.0, 370.0, 210.0, 70.0, 35.0, 40.0, 60.0, 70.0, 20.0, 520.0, 160.0, 0.0, 20.0, 20.0, 210.0, 10.0, 180.0, 120.0, 200.0, 150.0, 200.0, 20.0, -10.0, 250.0, 0.0, 30.0, 210.0, 100.0, 120.0, 140.0, 10.0, 60.0, 80.0, 120.0, 60.0, 50.0, 150.0, 80.0, 80.0, 30.0, -20.0, 190.0, 110.0, 240.0, 190.0, 100.0, 80.0, 250.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.483636673934503, "mean_inference_ms": 1.4224300087126946, "mean_action_processing_ms": 0.4207009423768742, "mean_env_wait_ms": 1.253011734619248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02078413963317871, "StateBufferConnector_ms": 0.009766817092895508, "ViewRequirementAgentConnector_ms": 0.38164639472961426}, "num_episodes": 23, "episode_return_max": 1950.0, "episode_return_min": 205.0, "episode_return_mean": 975.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.5479469747262, "num_env_steps_trained_throughput_per_sec": 21.5479469747262, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 5360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5360000, "timers": {"training_iteration_time_ms": 186276.069, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186276.021, "sample_time_ms": 2509.781, "learn_time_ms": 183742.908, "learn_throughput": 21.77, "synch_weights_time_ms": 13.842}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "done": false, "training_iteration": 134, "trial_id": "90816_00000", "date": "2024-06-10_07-10-57", "timestamp": 1718017857, "time_this_iter_s": 185.6420030593872, "time_total_s": 25134.044373750687, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b310f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25134.044373750687, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 21.660076045627378, "ram_util_percent": 79.5680608365019}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.480495462973659, "cur_kl_coeff": 11.248100098612477, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0031637014117472753, "vf_loss": 6.859648767700845, "vf_explained_var": -0.0005833046885725027, "kl": Infinity, "entropy": 0.33530748636641317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1262955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "env_runners": {"episode_reward_max": 1950.0, "episode_reward_min": 80.0, "episode_reward_mean": 951.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 95.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [850.0, 1590.0, 1730.0, 400.0, 930.0, 870.0, 695.0, 425.0, 1490.0, 1590.0, 830.0, 560.0, 860.0, 700.0, 1900.0, 735.0, 1080.0, 1210.0, 760.0, 540.0, 910.0, 890.0, 370.0, 205.0, 1810.0, 1330.0, 1090.0, 1480.0, 1780.0, 830.0, 225.0, 1230.0, 1020.0, 1950.0, 1140.0, 1200.0, 1645.0, 1040.0, 730.0, 560.0, 690.0, 980.0, 210.0, 1690.0, 1005.0, 1330.0, 1260.0, 465.0, 610.0, 400.0, 1420.0, 700.0, 670.0, 795.0, 600.0, 670.0, 890.0, 1260.0, 330.0, 1240.0, 300.0, 1255.0, 320.0, 530.0, 780.0, 540.0, 1560.0, 840.0, 1050.0, 330.0, 460.0, 800.0, 715.0, 820.0, 1080.0, 1340.0, 795.0, 975.0, 1260.0, 1150.0, 870.0, 1250.0, 470.0, 1700.0, 1130.0, 1760.0, 1120.0, 970.0, 1040.0, 1010.0, 550.0, 890.0, 870.0, 650.0, 490.0, 80.0, 1540.0, 1010.0, 1320.0, 1150.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 120.0, 120.0, 60.0, 50.0, 20.0, 50.0, 110.0, 30.0, 140.0, 100.0, 180.0, 10.0, 540.0, 130.0, 90.0, 70.0, 80.0, 300.0, 90.0, 260.0, 40.0, 30.0, 210.0, -10.0, 50.0, 500.0, 90.0, 400.0, 160.0, 10.0, 70.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 30.0, 20.0, 60.0, 90.0, 200.0, -40.0, 60.0, 70.0, 50.0, 390.0, 30.0, -40.0, -20.0, -40.0, -40.0, 310.0, 40.0, -70.0, 710.0, -40.0, 60.0, 40.0, 40.0, 120.0, 20.0, 40.0, 130.0, 55.0, 200.0, 40.0, 10.0, 160.0, 20.0, 30.0, 30.0, 35.0, 20.0, 30.0, 70.0, 10.0, 20.0, 310.0, 50.0, 220.0, 430.0, 50.0, 20.0, 20.0, 180.0, 90.0, 120.0, 130.0, 330.0, 160.0, 70.0, 120.0, 90.0, 80.0, 530.0, -10.0, 90.0, 60.0, 10.0, -20.0, 160.0, 30.0, 20.0, 150.0, 160.0, 110.0, 150.0, 30.0, -100.0, 200.0, 30.0, -160.0, -50.0, 560.0, 190.0, 10.0, -150.0, 200.0, 10.0, 20.0, 70.0, 460.0, 30.0, 0.0, 40.0, 10.0, 20.0, 20.0, 20.0, 10.0, -15.0, 80.0, 390.0, -25.0, 10.0, 140.0, 70.0, 50.0, 150.0, 110.0, 40.0, 160.0, 670.0, 160.0, 30.0, 440.0, 90.0, -175.0, 180.0, 20.0, 20.0, 140.0, 90.0, 220.0, 160.0, -30.0, 110.0, 390.0, 140.0, 160.0, 120.0, 110.0, 10.0, 20.0, 20.0, -20.0, 130.0, 280.0, 260.0, 20.0, 90.0, 30.0, 70.0, 20.0, 50.0, 350.0, 40.0, -210.0, 170.0, 130.0, 180.0, 180.0, 120.0, 100.0, 50.0, -10.0, 50.0, 50.0, -40.0, 100.0, 10.0, 160.0, 50.0, 0.0, 170.0, 0.0, 40.0, 100.0, 20.0, 40.0, 110.0, 10.0, 50.0, 260.0, 40.0, 50.0, 230.0, 0.0, 200.0, 240.0, 100.0, 120.0, 30.0, 40.0, 20.0, 120.0, 20.0, 20.0, 30.0, 40.0, 40.0, 0.0, 50.0, 0.0, 140.0, 40.0, 10.0, 70.0, 10.0, 0.0, 15.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 90.0, 400.0, 300.0, 80.0, 220.0, 210.0, 40.0, 120.0, 320.0, 90.0, 730.0, 20.0, 40.0, 20.0, 60.0, 70.0, 160.0, 70.0, 70.0, 100.0, 60.0, 20.0, 270.0, 110.0, 90.0, 60.0, 150.0, 180.0, 50.0, 50.0, 290.0, 20.0, 30.0, 10.0, 710.0, 20.0, 300.0, 40.0, 10.0, 70.0, 380.0, 20.0, 200.0, 70.0, 430.0, 50.0, 370.0, 20.0, 170.0, 20.0, 40.0, 120.0, -10.0, 10.0, 360.0, 130.0, 40.0, 20.0, 100.0, 30.0, -20.0, 20.0, 30.0, 20.0, 5.0, 20.0, 10.0, 110.0, 0.0, 170.0, 190.0, 10.0, 170.0, 40.0, 50.0, 190.0, 25.0, 210.0, 175.0, 70.0, 140.0, 50.0, 120.0, 70.0, 80.0, 200.0, 100.0, 180.0, 10.0, 170.0, 40.0, 310.0, 120.0, 70.0, 150.0, 240.0, 40.0, 550.0, 260.0, 20.0, 340.0, 50.0, 20.0, 270.0, 20.0, 70.0, 100.0, 210.0, 40.0, 170.0, 250.0, 80.0, 20.0, 80.0, 140.0, 120.0, 110.0, 170.0, 60.0, 650.0, 170.0, 105.0, 110.0, 60.0, 100.0, 20.0, 90.0, 60.0, 280.0, 80.0, -40.0, 90.0, 220.0, 160.0, 200.0, 10.0, 290.0, 20.0, 10.0, 80.0, -50.0, 150.0, 200.0, 30.0, 10.0, 90.0, 60.0, 10.0, 150.0, 80.0, 40.0, 30.0, 80.0, 20.0, 20.0, 10.0, 20.0, 130.0, 130.0, 30.0, 60.0, 30.0, 10.0, 100.0, 180.0, 140.0, 120.0, 0.0, 20.0, 200.0, 70.0, 40.0, 0.0, 200.0, 30.0, 90.0, 40.0, 220.0, 90.0, 30.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 50.0, 20.0, 30.0, 80.0, 660.0, 270.0, -10.0, 30.0, 20.0, 70.0, 220.0, 320.0, 20.0, 150.0, 70.0, 100.0, -45.0, 30.0, 260.0, 460.0, -40.0, 0.0, 110.0, 160.0, 100.0, 220.0, 330.0, 120.0, 120.0, 170.0, -110.0, 110.0, 60.0, 150.0, 180.0, 470.0, 0.0, 170.0, 30.0, 60.0, 70.0, 70.0, 40.0, 15.0, 10.0, 0.0, 20.0, 100.0, 20.0, 110.0, 150.0, 0.0, 110.0, 150.0, 10.0, 90.0, 40.0, 60.0, 20.0, 60.0, 30.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 20.0, 150.0, 100.0, 10.0, 300.0, 70.0, 70.0, 20.0, 300.0, 320.0, 40.0, 170.0, 50.0, 80.0, 150.0, 10.0, 50.0, 20.0, 40.0, 60.0, 10.0, 50.0, 310.0, 0.0, 50.0, 30.0, 40.0, 50.0, 40.0, 70.0, 30.0, 270.0, 40.0, 50.0, 130.0, 110.0, 60.0, 140.0, 5.0, 10.0, 40.0, 250.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 20.0, 260.0, 55.0, 40.0, 30.0, 10.0, 20.0, 40.0, 100.0, 40.0, 140.0, 70.0, 10.0, 20.0, 30.0, 200.0, 40.0, 90.0, 80.0, 190.0, 40.0, 120.0, 90.0, 50.0, 100.0, 90.0, 80.0, 40.0, 90.0, 300.0, 80.0, 140.0, 80.0, 310.0, 150.0, -10.0, 10.0, 90.0, 0.0, 30.0, 70.0, 40.0, 90.0, 40.0, -40.0, 0.0, 40.0, 160.0, 80.0, 120.0, 170.0, 10.0, 40.0, 360.0, 60.0, 200.0, -30.0, 10.0, 30.0, 0.0, 100.0, 60.0, 20.0, 20.0, 40.0, 50.0, 40.0, 270.0, 160.0, 70.0, 100.0, 160.0, 390.0, -30.0, 90.0, 5.0, 30.0, 0.0, 30.0, 0.0, 80.0, 70.0, 30.0, 60.0, -40.0, 60.0, 0.0, -40.0, 170.0, 130.0, 20.0, 70.0, 100.0, 80.0, 0.0, 0.0, 180.0, 60.0, 30.0, 0.0, 190.0, 80.0, 50.0, 40.0, 20.0, 130.0, 70.0, 20.0, 20.0, 20.0, 300.0, 60.0, 40.0, 0.0, 0.0, 10.0, 70.0, 220.0, 80.0, 480.0, 160.0, 30.0, 50.0, 120.0, 180.0, 170.0, 80.0, 20.0, 30.0, 70.0, 70.0, 60.0, 40.0, 90.0, 350.0, 30.0, -65.0, 780.0, 55.0, 80.0, 30.0, 20.0, 40.0, 0.0, 70.0, 40.0, 0.0, 270.0, 80.0, 120.0, 70.0, 30.0, -30.0, 20.0, -260.0, 30.0, 20.0, 40.0, 90.0, -130.0, 250.0, 10.0, 80.0, 20.0, 40.0, 40.0, 10.0, 70.0, 60.0, 30.0, 330.0, 50.0, 100.0, 40.0, 70.0, 40.0, 70.0, -85.0, -105.0, 110.0, 350.0, 80.0, -115.0, 170.0, 160.0, 80.0, 40.0, 30.0, 70.0, 60.0, 20.0, -20.0, 110.0, 250.0, 260.0, 0.0, 550.0, 70.0, 20.0, 250.0, 30.0, 20.0, 20.0, 50.0, 60.0, 10.0, 40.0, 90.0, 70.0, 150.0, 60.0, 310.0, 60.0, 480.0, 70.0, 10.0, 160.0, 160.0, 170.0, -55.0, 50.0, 70.0, 0.0, 10.0, 70.0, 160.0, 90.0, -30.0, 60.0, 370.0, 210.0, 70.0, 35.0, 40.0, 60.0, 70.0, 20.0, 520.0, 160.0, 0.0, 20.0, 20.0, 210.0, 10.0, 180.0, 120.0, 200.0, 150.0, 200.0, 20.0, -10.0, 250.0, 0.0, 30.0, 210.0, 100.0, 120.0, 140.0, 10.0, 60.0, 80.0, 120.0, 60.0, 50.0, 150.0, 80.0, 80.0, 30.0, -20.0, 190.0, 110.0, 240.0, 190.0, 100.0, 80.0, 250.0, 40.0, 20.0, 60.0, 60.0, 40.0, 70.0, 40.0, 70.0, 10.0, 60.0, 130.0, 110.0, 110.0, 280.0, 50.0, 100.0, 30.0, 510.0, 310.0, 70.0, 90.0, 50.0, 20.0, 230.0, 100.0, 90.0, 110.0, 100.0, 280.0, 60.0, -60.0, 70.0, 410.0, 500.0, 280.0, 100.0, 50.0, -30.0, 130.0, 310.0, 0.0, 410.0, 50.0, 90.0, 200.0, 0.0, 90.0, 90.0, 30.0, 160.0, 20.0, 270.0, 170.0, 80.0, 280.0, 10.0, 0.0, 10.0, 100.0, 30.0, 270.0, 10.0, 120.0, 290.0, -20.0, 150.0, 40.0, 30.0, 70.0, 80.0, 20.0, 70.0, 50.0, 110.0, 200.0, 200.0, 130.0, 160.0, 10.0, 60.0, 10.0, 0.0, 20.0, 80.0, 100.0, 110.0, 0.0, 10.0, 190.0, 30.0, 60.0, 20.0, 10.0, 40.0, 150.0, 380.0, 30.0, 100.0, 90.0, 10.0, 50.0, 120.0, 120.0, 40.0, 10.0, 200.0, 190.0, 20.0, 90.0, 30.0, 30.0, 230.0, 60.0, 160.0, 20.0, 10.0, 40.0, 50.0, 20.0, 30.0, 0.0, 30.0, 40.0, 100.0, 10.0, 0.0, 20.0, 50.0, 230.0, 10.0, 0.0, 10.0, 30.0, 30.0, -50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 380.0, 20.0, 130.0, 70.0, 630.0, 60.0, 70.0, 160.0, -20.0, 40.0, 110.0, 260.0, 120.0, 20.0, 200.0, 40.0, 70.0, 60.0, 40.0, 90.0, 150.0, 90.0, 70.0, 490.0, -20.0, 260.0, -20.0, 70.0, 110.0, 120.0, 0.0, 60.0, 310.0, 80.0, 40.0, 120.0, 90.0, 150.0, 100.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.482128067077389, "mean_inference_ms": 1.4198312207163668, "mean_action_processing_ms": 0.4211018206858885, "mean_env_wait_ms": 1.2534218389277352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020175933837890625, "StateBufferConnector_ms": 0.009786844253540039, "ViewRequirementAgentConnector_ms": 0.3699464797973633}, "num_episodes": 18, "episode_return_max": 1950.0, "episode_return_min": 80.0, "episode_return_mean": 951.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.622183670153007, "num_env_steps_trained_throughput_per_sec": 21.622183670153007, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 5400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5400000, "timers": {"training_iteration_time_ms": 186223.237, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186223.19, "sample_time_ms": 2516.548, "learn_time_ms": 183683.397, "learn_throughput": 21.777, "synch_weights_time_ms": 13.759}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "done": false, "training_iteration": 135, "trial_id": "90816_00000", "date": "2024-06-10_07-14-02", "timestamp": 1718018042, "time_this_iter_s": 185.00459384918213, "time_total_s": 25319.04896759987, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b310ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25319.04896759987, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 29.328244274809162, "ram_util_percent": 79.1232824427481}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6613754857462437, "cur_kl_coeff": 16.872150147918717, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.133736899053962, "policy_loss": -0.002949067553891121, "vf_loss": 6.133745775486841, "vf_explained_var": -0.0002653709298378616, "kl": 0.00017426339338795277, "entropy": 0.36257487104152336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1272345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "env_runners": {"episode_reward_max": 1950.0, "episode_reward_min": 80.0, "episode_reward_mean": 943.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 94.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 205.0, 1810.0, 1330.0, 1090.0, 1480.0, 1780.0, 830.0, 225.0, 1230.0, 1020.0, 1950.0, 1140.0, 1200.0, 1645.0, 1040.0, 730.0, 560.0, 690.0, 980.0, 210.0, 1690.0, 1005.0, 1330.0, 1260.0, 465.0, 610.0, 400.0, 1420.0, 700.0, 670.0, 795.0, 600.0, 670.0, 890.0, 1260.0, 330.0, 1240.0, 300.0, 1255.0, 320.0, 530.0, 780.0, 540.0, 1560.0, 840.0, 1050.0, 330.0, 460.0, 800.0, 715.0, 820.0, 1080.0, 1340.0, 795.0, 975.0, 1260.0, 1150.0, 870.0, 1250.0, 470.0, 1700.0, 1130.0, 1760.0, 1120.0, 970.0, 1040.0, 1010.0, 550.0, 890.0, 870.0, 650.0, 490.0, 80.0, 1540.0, 1010.0, 1320.0, 1150.0, 1100.0, 1280.0, 1500.0, 1000.0, 585.0, 1705.0, 550.0, 1090.0, 600.0, 1030.0, 1465.0, 1450.0, 610.0, 320.0, 850.0, 810.0, 1590.0, 960.0, 1050.0, 230.0, 330.0, 575.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 40.0, 40.0, 0.0, 50.0, 0.0, 140.0, 40.0, 10.0, 70.0, 10.0, 0.0, 15.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 90.0, 400.0, 300.0, 80.0, 220.0, 210.0, 40.0, 120.0, 320.0, 90.0, 730.0, 20.0, 40.0, 20.0, 60.0, 70.0, 160.0, 70.0, 70.0, 100.0, 60.0, 20.0, 270.0, 110.0, 90.0, 60.0, 150.0, 180.0, 50.0, 50.0, 290.0, 20.0, 30.0, 10.0, 710.0, 20.0, 300.0, 40.0, 10.0, 70.0, 380.0, 20.0, 200.0, 70.0, 430.0, 50.0, 370.0, 20.0, 170.0, 20.0, 40.0, 120.0, -10.0, 10.0, 360.0, 130.0, 40.0, 20.0, 100.0, 30.0, -20.0, 20.0, 30.0, 20.0, 5.0, 20.0, 10.0, 110.0, 0.0, 170.0, 190.0, 10.0, 170.0, 40.0, 50.0, 190.0, 25.0, 210.0, 175.0, 70.0, 140.0, 50.0, 120.0, 70.0, 80.0, 200.0, 100.0, 180.0, 10.0, 170.0, 40.0, 310.0, 120.0, 70.0, 150.0, 240.0, 40.0, 550.0, 260.0, 20.0, 340.0, 50.0, 20.0, 270.0, 20.0, 70.0, 100.0, 210.0, 40.0, 170.0, 250.0, 80.0, 20.0, 80.0, 140.0, 120.0, 110.0, 170.0, 60.0, 650.0, 170.0, 105.0, 110.0, 60.0, 100.0, 20.0, 90.0, 60.0, 280.0, 80.0, -40.0, 90.0, 220.0, 160.0, 200.0, 10.0, 290.0, 20.0, 10.0, 80.0, -50.0, 150.0, 200.0, 30.0, 10.0, 90.0, 60.0, 10.0, 150.0, 80.0, 40.0, 30.0, 80.0, 20.0, 20.0, 10.0, 20.0, 130.0, 130.0, 30.0, 60.0, 30.0, 10.0, 100.0, 180.0, 140.0, 120.0, 0.0, 20.0, 200.0, 70.0, 40.0, 0.0, 200.0, 30.0, 90.0, 40.0, 220.0, 90.0, 30.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 50.0, 20.0, 30.0, 80.0, 660.0, 270.0, -10.0, 30.0, 20.0, 70.0, 220.0, 320.0, 20.0, 150.0, 70.0, 100.0, -45.0, 30.0, 260.0, 460.0, -40.0, 0.0, 110.0, 160.0, 100.0, 220.0, 330.0, 120.0, 120.0, 170.0, -110.0, 110.0, 60.0, 150.0, 180.0, 470.0, 0.0, 170.0, 30.0, 60.0, 70.0, 70.0, 40.0, 15.0, 10.0, 0.0, 20.0, 100.0, 20.0, 110.0, 150.0, 0.0, 110.0, 150.0, 10.0, 90.0, 40.0, 60.0, 20.0, 60.0, 30.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 20.0, 150.0, 100.0, 10.0, 300.0, 70.0, 70.0, 20.0, 300.0, 320.0, 40.0, 170.0, 50.0, 80.0, 150.0, 10.0, 50.0, 20.0, 40.0, 60.0, 10.0, 50.0, 310.0, 0.0, 50.0, 30.0, 40.0, 50.0, 40.0, 70.0, 30.0, 270.0, 40.0, 50.0, 130.0, 110.0, 60.0, 140.0, 5.0, 10.0, 40.0, 250.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 20.0, 260.0, 55.0, 40.0, 30.0, 10.0, 20.0, 40.0, 100.0, 40.0, 140.0, 70.0, 10.0, 20.0, 30.0, 200.0, 40.0, 90.0, 80.0, 190.0, 40.0, 120.0, 90.0, 50.0, 100.0, 90.0, 80.0, 40.0, 90.0, 300.0, 80.0, 140.0, 80.0, 310.0, 150.0, -10.0, 10.0, 90.0, 0.0, 30.0, 70.0, 40.0, 90.0, 40.0, -40.0, 0.0, 40.0, 160.0, 80.0, 120.0, 170.0, 10.0, 40.0, 360.0, 60.0, 200.0, -30.0, 10.0, 30.0, 0.0, 100.0, 60.0, 20.0, 20.0, 40.0, 50.0, 40.0, 270.0, 160.0, 70.0, 100.0, 160.0, 390.0, -30.0, 90.0, 5.0, 30.0, 0.0, 30.0, 0.0, 80.0, 70.0, 30.0, 60.0, -40.0, 60.0, 0.0, -40.0, 170.0, 130.0, 20.0, 70.0, 100.0, 80.0, 0.0, 0.0, 180.0, 60.0, 30.0, 0.0, 190.0, 80.0, 50.0, 40.0, 20.0, 130.0, 70.0, 20.0, 20.0, 20.0, 300.0, 60.0, 40.0, 0.0, 0.0, 10.0, 70.0, 220.0, 80.0, 480.0, 160.0, 30.0, 50.0, 120.0, 180.0, 170.0, 80.0, 20.0, 30.0, 70.0, 70.0, 60.0, 40.0, 90.0, 350.0, 30.0, -65.0, 780.0, 55.0, 80.0, 30.0, 20.0, 40.0, 0.0, 70.0, 40.0, 0.0, 270.0, 80.0, 120.0, 70.0, 30.0, -30.0, 20.0, -260.0, 30.0, 20.0, 40.0, 90.0, -130.0, 250.0, 10.0, 80.0, 20.0, 40.0, 40.0, 10.0, 70.0, 60.0, 30.0, 330.0, 50.0, 100.0, 40.0, 70.0, 40.0, 70.0, -85.0, -105.0, 110.0, 350.0, 80.0, -115.0, 170.0, 160.0, 80.0, 40.0, 30.0, 70.0, 60.0, 20.0, -20.0, 110.0, 250.0, 260.0, 0.0, 550.0, 70.0, 20.0, 250.0, 30.0, 20.0, 20.0, 50.0, 60.0, 10.0, 40.0, 90.0, 70.0, 150.0, 60.0, 310.0, 60.0, 480.0, 70.0, 10.0, 160.0, 160.0, 170.0, -55.0, 50.0, 70.0, 0.0, 10.0, 70.0, 160.0, 90.0, -30.0, 60.0, 370.0, 210.0, 70.0, 35.0, 40.0, 60.0, 70.0, 20.0, 520.0, 160.0, 0.0, 20.0, 20.0, 210.0, 10.0, 180.0, 120.0, 200.0, 150.0, 200.0, 20.0, -10.0, 250.0, 0.0, 30.0, 210.0, 100.0, 120.0, 140.0, 10.0, 60.0, 80.0, 120.0, 60.0, 50.0, 150.0, 80.0, 80.0, 30.0, -20.0, 190.0, 110.0, 240.0, 190.0, 100.0, 80.0, 250.0, 40.0, 20.0, 60.0, 60.0, 40.0, 70.0, 40.0, 70.0, 10.0, 60.0, 130.0, 110.0, 110.0, 280.0, 50.0, 100.0, 30.0, 510.0, 310.0, 70.0, 90.0, 50.0, 20.0, 230.0, 100.0, 90.0, 110.0, 100.0, 280.0, 60.0, -60.0, 70.0, 410.0, 500.0, 280.0, 100.0, 50.0, -30.0, 130.0, 310.0, 0.0, 410.0, 50.0, 90.0, 200.0, 0.0, 90.0, 90.0, 30.0, 160.0, 20.0, 270.0, 170.0, 80.0, 280.0, 10.0, 0.0, 10.0, 100.0, 30.0, 270.0, 10.0, 120.0, 290.0, -20.0, 150.0, 40.0, 30.0, 70.0, 80.0, 20.0, 70.0, 50.0, 110.0, 200.0, 200.0, 130.0, 160.0, 10.0, 60.0, 10.0, 0.0, 20.0, 80.0, 100.0, 110.0, 0.0, 10.0, 190.0, 30.0, 60.0, 20.0, 10.0, 40.0, 150.0, 380.0, 30.0, 100.0, 90.0, 10.0, 50.0, 120.0, 120.0, 40.0, 10.0, 200.0, 190.0, 20.0, 90.0, 30.0, 30.0, 230.0, 60.0, 160.0, 20.0, 10.0, 40.0, 50.0, 20.0, 30.0, 0.0, 30.0, 40.0, 100.0, 10.0, 0.0, 20.0, 50.0, 230.0, 10.0, 0.0, 10.0, 30.0, 30.0, -50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 380.0, 20.0, 130.0, 70.0, 630.0, 60.0, 70.0, 160.0, -20.0, 40.0, 110.0, 260.0, 120.0, 20.0, 200.0, 40.0, 70.0, 60.0, 40.0, 90.0, 150.0, 90.0, 70.0, 490.0, -20.0, 260.0, -20.0, 70.0, 110.0, 120.0, 0.0, 60.0, 310.0, 80.0, 40.0, 120.0, 90.0, 150.0, 100.0, 200.0, 210.0, 140.0, 20.0, -10.0, 50.0, 330.0, 80.0, 110.0, 80.0, 90.0, -10.0, 60.0, 610.0, 20.0, 140.0, 50.0, 240.0, 80.0, 20.0, 70.0, 0.0, 520.0, 70.0, 270.0, 360.0, 30.0, 50.0, 90.0, 40.0, 70.0, 130.0, 230.0, 40.0, 20.0, 40.0, 150.0, 60.0, 90.0, 220.0, 20.0, 10.0, -50.0, 40.0, 20.0, 30.0, 160.0, 40.0, 60.0, 15.0, 260.0, 120.0, 170.0, -40.0, 70.0, 260.0, 45.0, 610.0, 200.0, 90.0, 180.0, 30.0, 60.0, 10.0, 10.0, 40.0, 80.0, 70.0, 60.0, 160.0, 30.0, 120.0, -20.0, 380.0, 30.0, 120.0, 40.0, 270.0, 20.0, 130.0, 0.0, 120.0, 10.0, 10.0, 120.0, 170.0, 10.0, 10.0, 50.0, 60.0, 40.0, 10.0, 200.0, 230.0, 20.0, 230.0, 100.0, 80.0, 30.0, 70.0, 60.0, 350.0, 55.0, 30.0, 15.0, 240.0, 60.0, 110.0, 90.0, 490.0, 25.0, 260.0, 250.0, 50.0, 90.0, -20.0, 60.0, 30.0, 20.0, 250.0, 460.0, 0.0, 380.0, -10.0, 50.0, -10.0, 20.0, 10.0, 70.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 70.0, 450.0, 60.0, -40.0, -20.0, 40.0, 80.0, 30.0, 40.0, 140.0, 40.0, 80.0, 0.0, 20.0, 90.0, 40.0, 380.0, 90.0, 20.0, 50.0, 30.0, 80.0, 710.0, 150.0, 210.0, 40.0, 0.0, 180.0, 70.0, 120.0, 10.0, 60.0, 40.0, 80.0, -20.0, 160.0, 280.0, 260.0, 30.0, 60.0, 60.0, 70.0, 400.0, 30.0, 370.0, 60.0, -10.0, 20.0, -30.0, 80.0, 0.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 30.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 90.0, 10.0, 170.0, 10.0, 0.0, 40.0, 10.0, 70.0, 40.0, 50.0, 10.0, 35.0, 280.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4808824135883702, "mean_inference_ms": 1.4200982395657176, "mean_action_processing_ms": 0.4208635395387468, "mean_env_wait_ms": 1.25342542025911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013509273529052734, "StateBufferConnector_ms": 0.009435415267944336, "ViewRequirementAgentConnector_ms": 0.3676877021789551}, "num_episodes": 22, "episode_return_max": 1950.0, "episode_return_min": 80.0, "episode_return_mean": 943.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.69219126466174, "num_env_steps_trained_throughput_per_sec": 21.69219126466174, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 5440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5440000, "timers": {"training_iteration_time_ms": 186055.891, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186055.846, "sample_time_ms": 2519.71, "learn_time_ms": 183513.134, "learn_throughput": 21.797, "synch_weights_time_ms": 13.691}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "done": false, "training_iteration": 136, "trial_id": "90816_00000", "date": "2024-06-10_07-17-06", "timestamp": 1718018226, "time_this_iter_s": 184.4079978466034, "time_total_s": 25503.456965446472, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b311f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25503.456965446472, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 28.822692307692307, "ram_util_percent": 78.99653846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.225680464582321, "cur_kl_coeff": 8.436075073959358, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.396322117623684, "policy_loss": -0.003441952948862165, "vf_loss": 6.397001155217489, "vf_explained_var": -0.00017778710308420266, "kl": 0.0003275115393123355, "entropy": 0.35524572450925496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1281735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "env_runners": {"episode_reward_max": 1800.0, "episode_reward_min": 80.0, "episode_reward_mean": 922.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 92.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.0, 980.0, 210.0, 1690.0, 1005.0, 1330.0, 1260.0, 465.0, 610.0, 400.0, 1420.0, 700.0, 670.0, 795.0, 600.0, 670.0, 890.0, 1260.0, 330.0, 1240.0, 300.0, 1255.0, 320.0, 530.0, 780.0, 540.0, 1560.0, 840.0, 1050.0, 330.0, 460.0, 800.0, 715.0, 820.0, 1080.0, 1340.0, 795.0, 975.0, 1260.0, 1150.0, 870.0, 1250.0, 470.0, 1700.0, 1130.0, 1760.0, 1120.0, 970.0, 1040.0, 1010.0, 550.0, 890.0, 870.0, 650.0, 490.0, 80.0, 1540.0, 1010.0, 1320.0, 1150.0, 1100.0, 1280.0, 1500.0, 1000.0, 585.0, 1705.0, 550.0, 1090.0, 600.0, 1030.0, 1465.0, 1450.0, 610.0, 320.0, 850.0, 810.0, 1590.0, 960.0, 1050.0, 230.0, 330.0, 575.0, 1000.0, 1800.0, 430.0, 850.0, 165.0, 1370.0, 1030.0, 660.0, 1155.0, 1590.0, 1565.0, 340.0, 420.0, 1800.0, 770.0, 890.0, 1360.0, 340.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 60.0, 30.0, 10.0, 100.0, 180.0, 140.0, 120.0, 0.0, 20.0, 200.0, 70.0, 40.0, 0.0, 200.0, 30.0, 90.0, 40.0, 220.0, 90.0, 30.0, 10.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 50.0, 20.0, 30.0, 80.0, 660.0, 270.0, -10.0, 30.0, 20.0, 70.0, 220.0, 320.0, 20.0, 150.0, 70.0, 100.0, -45.0, 30.0, 260.0, 460.0, -40.0, 0.0, 110.0, 160.0, 100.0, 220.0, 330.0, 120.0, 120.0, 170.0, -110.0, 110.0, 60.0, 150.0, 180.0, 470.0, 0.0, 170.0, 30.0, 60.0, 70.0, 70.0, 40.0, 15.0, 10.0, 0.0, 20.0, 100.0, 20.0, 110.0, 150.0, 0.0, 110.0, 150.0, 10.0, 90.0, 40.0, 60.0, 20.0, 60.0, 30.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 20.0, 150.0, 100.0, 10.0, 300.0, 70.0, 70.0, 20.0, 300.0, 320.0, 40.0, 170.0, 50.0, 80.0, 150.0, 10.0, 50.0, 20.0, 40.0, 60.0, 10.0, 50.0, 310.0, 0.0, 50.0, 30.0, 40.0, 50.0, 40.0, 70.0, 30.0, 270.0, 40.0, 50.0, 130.0, 110.0, 60.0, 140.0, 5.0, 10.0, 40.0, 250.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 20.0, 260.0, 55.0, 40.0, 30.0, 10.0, 20.0, 40.0, 100.0, 40.0, 140.0, 70.0, 10.0, 20.0, 30.0, 200.0, 40.0, 90.0, 80.0, 190.0, 40.0, 120.0, 90.0, 50.0, 100.0, 90.0, 80.0, 40.0, 90.0, 300.0, 80.0, 140.0, 80.0, 310.0, 150.0, -10.0, 10.0, 90.0, 0.0, 30.0, 70.0, 40.0, 90.0, 40.0, -40.0, 0.0, 40.0, 160.0, 80.0, 120.0, 170.0, 10.0, 40.0, 360.0, 60.0, 200.0, -30.0, 10.0, 30.0, 0.0, 100.0, 60.0, 20.0, 20.0, 40.0, 50.0, 40.0, 270.0, 160.0, 70.0, 100.0, 160.0, 390.0, -30.0, 90.0, 5.0, 30.0, 0.0, 30.0, 0.0, 80.0, 70.0, 30.0, 60.0, -40.0, 60.0, 0.0, -40.0, 170.0, 130.0, 20.0, 70.0, 100.0, 80.0, 0.0, 0.0, 180.0, 60.0, 30.0, 0.0, 190.0, 80.0, 50.0, 40.0, 20.0, 130.0, 70.0, 20.0, 20.0, 20.0, 300.0, 60.0, 40.0, 0.0, 0.0, 10.0, 70.0, 220.0, 80.0, 480.0, 160.0, 30.0, 50.0, 120.0, 180.0, 170.0, 80.0, 20.0, 30.0, 70.0, 70.0, 60.0, 40.0, 90.0, 350.0, 30.0, -65.0, 780.0, 55.0, 80.0, 30.0, 20.0, 40.0, 0.0, 70.0, 40.0, 0.0, 270.0, 80.0, 120.0, 70.0, 30.0, -30.0, 20.0, -260.0, 30.0, 20.0, 40.0, 90.0, -130.0, 250.0, 10.0, 80.0, 20.0, 40.0, 40.0, 10.0, 70.0, 60.0, 30.0, 330.0, 50.0, 100.0, 40.0, 70.0, 40.0, 70.0, -85.0, -105.0, 110.0, 350.0, 80.0, -115.0, 170.0, 160.0, 80.0, 40.0, 30.0, 70.0, 60.0, 20.0, -20.0, 110.0, 250.0, 260.0, 0.0, 550.0, 70.0, 20.0, 250.0, 30.0, 20.0, 20.0, 50.0, 60.0, 10.0, 40.0, 90.0, 70.0, 150.0, 60.0, 310.0, 60.0, 480.0, 70.0, 10.0, 160.0, 160.0, 170.0, -55.0, 50.0, 70.0, 0.0, 10.0, 70.0, 160.0, 90.0, -30.0, 60.0, 370.0, 210.0, 70.0, 35.0, 40.0, 60.0, 70.0, 20.0, 520.0, 160.0, 0.0, 20.0, 20.0, 210.0, 10.0, 180.0, 120.0, 200.0, 150.0, 200.0, 20.0, -10.0, 250.0, 0.0, 30.0, 210.0, 100.0, 120.0, 140.0, 10.0, 60.0, 80.0, 120.0, 60.0, 50.0, 150.0, 80.0, 80.0, 30.0, -20.0, 190.0, 110.0, 240.0, 190.0, 100.0, 80.0, 250.0, 40.0, 20.0, 60.0, 60.0, 40.0, 70.0, 40.0, 70.0, 10.0, 60.0, 130.0, 110.0, 110.0, 280.0, 50.0, 100.0, 30.0, 510.0, 310.0, 70.0, 90.0, 50.0, 20.0, 230.0, 100.0, 90.0, 110.0, 100.0, 280.0, 60.0, -60.0, 70.0, 410.0, 500.0, 280.0, 100.0, 50.0, -30.0, 130.0, 310.0, 0.0, 410.0, 50.0, 90.0, 200.0, 0.0, 90.0, 90.0, 30.0, 160.0, 20.0, 270.0, 170.0, 80.0, 280.0, 10.0, 0.0, 10.0, 100.0, 30.0, 270.0, 10.0, 120.0, 290.0, -20.0, 150.0, 40.0, 30.0, 70.0, 80.0, 20.0, 70.0, 50.0, 110.0, 200.0, 200.0, 130.0, 160.0, 10.0, 60.0, 10.0, 0.0, 20.0, 80.0, 100.0, 110.0, 0.0, 10.0, 190.0, 30.0, 60.0, 20.0, 10.0, 40.0, 150.0, 380.0, 30.0, 100.0, 90.0, 10.0, 50.0, 120.0, 120.0, 40.0, 10.0, 200.0, 190.0, 20.0, 90.0, 30.0, 30.0, 230.0, 60.0, 160.0, 20.0, 10.0, 40.0, 50.0, 20.0, 30.0, 0.0, 30.0, 40.0, 100.0, 10.0, 0.0, 20.0, 50.0, 230.0, 10.0, 0.0, 10.0, 30.0, 30.0, -50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 380.0, 20.0, 130.0, 70.0, 630.0, 60.0, 70.0, 160.0, -20.0, 40.0, 110.0, 260.0, 120.0, 20.0, 200.0, 40.0, 70.0, 60.0, 40.0, 90.0, 150.0, 90.0, 70.0, 490.0, -20.0, 260.0, -20.0, 70.0, 110.0, 120.0, 0.0, 60.0, 310.0, 80.0, 40.0, 120.0, 90.0, 150.0, 100.0, 200.0, 210.0, 140.0, 20.0, -10.0, 50.0, 330.0, 80.0, 110.0, 80.0, 90.0, -10.0, 60.0, 610.0, 20.0, 140.0, 50.0, 240.0, 80.0, 20.0, 70.0, 0.0, 520.0, 70.0, 270.0, 360.0, 30.0, 50.0, 90.0, 40.0, 70.0, 130.0, 230.0, 40.0, 20.0, 40.0, 150.0, 60.0, 90.0, 220.0, 20.0, 10.0, -50.0, 40.0, 20.0, 30.0, 160.0, 40.0, 60.0, 15.0, 260.0, 120.0, 170.0, -40.0, 70.0, 260.0, 45.0, 610.0, 200.0, 90.0, 180.0, 30.0, 60.0, 10.0, 10.0, 40.0, 80.0, 70.0, 60.0, 160.0, 30.0, 120.0, -20.0, 380.0, 30.0, 120.0, 40.0, 270.0, 20.0, 130.0, 0.0, 120.0, 10.0, 10.0, 120.0, 170.0, 10.0, 10.0, 50.0, 60.0, 40.0, 10.0, 200.0, 230.0, 20.0, 230.0, 100.0, 80.0, 30.0, 70.0, 60.0, 350.0, 55.0, 30.0, 15.0, 240.0, 60.0, 110.0, 90.0, 490.0, 25.0, 260.0, 250.0, 50.0, 90.0, -20.0, 60.0, 30.0, 20.0, 250.0, 460.0, 0.0, 380.0, -10.0, 50.0, -10.0, 20.0, 10.0, 70.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 70.0, 450.0, 60.0, -40.0, -20.0, 40.0, 80.0, 30.0, 40.0, 140.0, 40.0, 80.0, 0.0, 20.0, 90.0, 40.0, 380.0, 90.0, 20.0, 50.0, 30.0, 80.0, 710.0, 150.0, 210.0, 40.0, 0.0, 180.0, 70.0, 120.0, 10.0, 60.0, 40.0, 80.0, -20.0, 160.0, 280.0, 260.0, 30.0, 60.0, 60.0, 70.0, 400.0, 30.0, 370.0, 60.0, -10.0, 20.0, -30.0, 80.0, 0.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 30.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 90.0, 10.0, 170.0, 10.0, 0.0, 40.0, 10.0, 70.0, 40.0, 50.0, 10.0, 35.0, 280.0, 20.0, 20.0, 60.0, 110.0, 50.0, 40.0, 160.0, 30.0, 350.0, 130.0, 30.0, 40.0, 70.0, 30.0, 30.0, 30.0, 140.0, 0.0, 380.0, 190.0, 920.0, 10.0, 30.0, 20.0, 120.0, 20.0, 30.0, 0.0, 70.0, 20.0, 100.0, 20.0, -20.0, 80.0, 100.0, 80.0, 120.0, 60.0, 30.0, 70.0, 30.0, 300.0, 50.0, 10.0, 30.0, 10.0, 5.0, 40.0, 0.0, 0.0, 20.0, 0.0, 120.0, 270.0, 70.0, 10.0, 80.0, 40.0, 670.0, -70.0, 100.0, 80.0, 30.0, 20.0, 90.0, 10.0, 130.0, 40.0, 70.0, 280.0, 200.0, 160.0, 80.0, 90.0, 60.0, 0.0, 60.0, 0.0, 50.0, 120.0, 160.0, 40.0, 10.0, 0.0, 395.0, 50.0, 70.0, 30.0, 70.0, 420.0, 70.0, 40.0, 30.0, 60.0, 70.0, 0.0, 300.0, 590.0, 80.0, 190.0, 230.0, 40.0, 100.0, 590.0, 130.0, 15.0, 50.0, 210.0, 110.0, 310.0, 40.0, 10.0, 40.0, 10.0, 100.0, 10.0, 70.0, 0.0, 10.0, 40.0, 30.0, 30.0, 50.0, 30.0, 10.0, 100.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 100.0, 150.0, 720.0, 50.0, 120.0, 90.0, 220.0, 230.0, 60.0, 60.0, 20.0, 180.0, 120.0, 30.0, 40.0, 100.0, 80.0, 150.0, 10.0, 40.0, 30.0, 210.0, 80.0, 40.0, 100.0, 170.0, 40.0, 80.0, 30.0, 110.0, 520.0, 100.0, 20.0, 260.0, 40.0, 120.0, 70.0, 190.0, 0.0, 40.0, 80.0, 10.0, 20.0, 10.0, 60.0, 0.0, 60.0, 10.0, 90.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4798258006349092, "mean_inference_ms": 1.42021158356915, "mean_action_processing_ms": 0.42064725893101806, "mean_env_wait_ms": 1.2533891509674897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01156306266784668, "StateBufferConnector_ms": 0.00939178466796875, "ViewRequirementAgentConnector_ms": 0.36939239501953125}, "num_episodes": 18, "episode_return_max": 1800.0, "episode_return_min": 80.0, "episode_return_mean": 922.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.636896125753605, "num_env_steps_trained_throughput_per_sec": 21.636896125753605, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 5480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5480000, "timers": {"training_iteration_time_ms": 185940.374, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185940.328, "sample_time_ms": 2508.975, "learn_time_ms": 183410.108, "learn_throughput": 21.809, "synch_weights_time_ms": 12.006}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "done": false, "training_iteration": 137, "trial_id": "90816_00000", "date": "2024-06-10_07-20-11", "timestamp": 1718018411, "time_this_iter_s": 184.87980222702026, "time_total_s": 25688.336767673492, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00b5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25688.336767673492, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 28.97824427480916, "ram_util_percent": 78.80114503816795}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6274612720528094, "cur_kl_coeff": 4.218037536979679, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005341786347677747, "vf_loss": 7.245479707443676, "vf_explained_var": 7.556404549473772e-05, "kl": Infinity, "entropy": 0.3386888145892638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1291125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 80.0, "episode_reward_mean": 943.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 94.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.0, 1240.0, 300.0, 1255.0, 320.0, 530.0, 780.0, 540.0, 1560.0, 840.0, 1050.0, 330.0, 460.0, 800.0, 715.0, 820.0, 1080.0, 1340.0, 795.0, 975.0, 1260.0, 1150.0, 870.0, 1250.0, 470.0, 1700.0, 1130.0, 1760.0, 1120.0, 970.0, 1040.0, 1010.0, 550.0, 890.0, 870.0, 650.0, 490.0, 80.0, 1540.0, 1010.0, 1320.0, 1150.0, 1100.0, 1280.0, 1500.0, 1000.0, 585.0, 1705.0, 550.0, 1090.0, 600.0, 1030.0, 1465.0, 1450.0, 610.0, 320.0, 850.0, 810.0, 1590.0, 960.0, 1050.0, 230.0, 330.0, 575.0, 1000.0, 1800.0, 430.0, 850.0, 165.0, 1370.0, 1030.0, 660.0, 1155.0, 1590.0, 1565.0, 340.0, 420.0, 1800.0, 770.0, 890.0, 1360.0, 340.0, 1080.0, 770.0, 360.0, 880.0, 1090.0, 1410.0, 1570.0, 540.0, 345.0, 520.0, 1250.0, 1520.0, 650.0, 1675.0, 2080.0, 950.0, 600.0, 480.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 90.0, 0.0, 30.0, 70.0, 40.0, 90.0, 40.0, -40.0, 0.0, 40.0, 160.0, 80.0, 120.0, 170.0, 10.0, 40.0, 360.0, 60.0, 200.0, -30.0, 10.0, 30.0, 0.0, 100.0, 60.0, 20.0, 20.0, 40.0, 50.0, 40.0, 270.0, 160.0, 70.0, 100.0, 160.0, 390.0, -30.0, 90.0, 5.0, 30.0, 0.0, 30.0, 0.0, 80.0, 70.0, 30.0, 60.0, -40.0, 60.0, 0.0, -40.0, 170.0, 130.0, 20.0, 70.0, 100.0, 80.0, 0.0, 0.0, 180.0, 60.0, 30.0, 0.0, 190.0, 80.0, 50.0, 40.0, 20.0, 130.0, 70.0, 20.0, 20.0, 20.0, 300.0, 60.0, 40.0, 0.0, 0.0, 10.0, 70.0, 220.0, 80.0, 480.0, 160.0, 30.0, 50.0, 120.0, 180.0, 170.0, 80.0, 20.0, 30.0, 70.0, 70.0, 60.0, 40.0, 90.0, 350.0, 30.0, -65.0, 780.0, 55.0, 80.0, 30.0, 20.0, 40.0, 0.0, 70.0, 40.0, 0.0, 270.0, 80.0, 120.0, 70.0, 30.0, -30.0, 20.0, -260.0, 30.0, 20.0, 40.0, 90.0, -130.0, 250.0, 10.0, 80.0, 20.0, 40.0, 40.0, 10.0, 70.0, 60.0, 30.0, 330.0, 50.0, 100.0, 40.0, 70.0, 40.0, 70.0, -85.0, -105.0, 110.0, 350.0, 80.0, -115.0, 170.0, 160.0, 80.0, 40.0, 30.0, 70.0, 60.0, 20.0, -20.0, 110.0, 250.0, 260.0, 0.0, 550.0, 70.0, 20.0, 250.0, 30.0, 20.0, 20.0, 50.0, 60.0, 10.0, 40.0, 90.0, 70.0, 150.0, 60.0, 310.0, 60.0, 480.0, 70.0, 10.0, 160.0, 160.0, 170.0, -55.0, 50.0, 70.0, 0.0, 10.0, 70.0, 160.0, 90.0, -30.0, 60.0, 370.0, 210.0, 70.0, 35.0, 40.0, 60.0, 70.0, 20.0, 520.0, 160.0, 0.0, 20.0, 20.0, 210.0, 10.0, 180.0, 120.0, 200.0, 150.0, 200.0, 20.0, -10.0, 250.0, 0.0, 30.0, 210.0, 100.0, 120.0, 140.0, 10.0, 60.0, 80.0, 120.0, 60.0, 50.0, 150.0, 80.0, 80.0, 30.0, -20.0, 190.0, 110.0, 240.0, 190.0, 100.0, 80.0, 250.0, 40.0, 20.0, 60.0, 60.0, 40.0, 70.0, 40.0, 70.0, 10.0, 60.0, 130.0, 110.0, 110.0, 280.0, 50.0, 100.0, 30.0, 510.0, 310.0, 70.0, 90.0, 50.0, 20.0, 230.0, 100.0, 90.0, 110.0, 100.0, 280.0, 60.0, -60.0, 70.0, 410.0, 500.0, 280.0, 100.0, 50.0, -30.0, 130.0, 310.0, 0.0, 410.0, 50.0, 90.0, 200.0, 0.0, 90.0, 90.0, 30.0, 160.0, 20.0, 270.0, 170.0, 80.0, 280.0, 10.0, 0.0, 10.0, 100.0, 30.0, 270.0, 10.0, 120.0, 290.0, -20.0, 150.0, 40.0, 30.0, 70.0, 80.0, 20.0, 70.0, 50.0, 110.0, 200.0, 200.0, 130.0, 160.0, 10.0, 60.0, 10.0, 0.0, 20.0, 80.0, 100.0, 110.0, 0.0, 10.0, 190.0, 30.0, 60.0, 20.0, 10.0, 40.0, 150.0, 380.0, 30.0, 100.0, 90.0, 10.0, 50.0, 120.0, 120.0, 40.0, 10.0, 200.0, 190.0, 20.0, 90.0, 30.0, 30.0, 230.0, 60.0, 160.0, 20.0, 10.0, 40.0, 50.0, 20.0, 30.0, 0.0, 30.0, 40.0, 100.0, 10.0, 0.0, 20.0, 50.0, 230.0, 10.0, 0.0, 10.0, 30.0, 30.0, -50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 380.0, 20.0, 130.0, 70.0, 630.0, 60.0, 70.0, 160.0, -20.0, 40.0, 110.0, 260.0, 120.0, 20.0, 200.0, 40.0, 70.0, 60.0, 40.0, 90.0, 150.0, 90.0, 70.0, 490.0, -20.0, 260.0, -20.0, 70.0, 110.0, 120.0, 0.0, 60.0, 310.0, 80.0, 40.0, 120.0, 90.0, 150.0, 100.0, 200.0, 210.0, 140.0, 20.0, -10.0, 50.0, 330.0, 80.0, 110.0, 80.0, 90.0, -10.0, 60.0, 610.0, 20.0, 140.0, 50.0, 240.0, 80.0, 20.0, 70.0, 0.0, 520.0, 70.0, 270.0, 360.0, 30.0, 50.0, 90.0, 40.0, 70.0, 130.0, 230.0, 40.0, 20.0, 40.0, 150.0, 60.0, 90.0, 220.0, 20.0, 10.0, -50.0, 40.0, 20.0, 30.0, 160.0, 40.0, 60.0, 15.0, 260.0, 120.0, 170.0, -40.0, 70.0, 260.0, 45.0, 610.0, 200.0, 90.0, 180.0, 30.0, 60.0, 10.0, 10.0, 40.0, 80.0, 70.0, 60.0, 160.0, 30.0, 120.0, -20.0, 380.0, 30.0, 120.0, 40.0, 270.0, 20.0, 130.0, 0.0, 120.0, 10.0, 10.0, 120.0, 170.0, 10.0, 10.0, 50.0, 60.0, 40.0, 10.0, 200.0, 230.0, 20.0, 230.0, 100.0, 80.0, 30.0, 70.0, 60.0, 350.0, 55.0, 30.0, 15.0, 240.0, 60.0, 110.0, 90.0, 490.0, 25.0, 260.0, 250.0, 50.0, 90.0, -20.0, 60.0, 30.0, 20.0, 250.0, 460.0, 0.0, 380.0, -10.0, 50.0, -10.0, 20.0, 10.0, 70.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 70.0, 450.0, 60.0, -40.0, -20.0, 40.0, 80.0, 30.0, 40.0, 140.0, 40.0, 80.0, 0.0, 20.0, 90.0, 40.0, 380.0, 90.0, 20.0, 50.0, 30.0, 80.0, 710.0, 150.0, 210.0, 40.0, 0.0, 180.0, 70.0, 120.0, 10.0, 60.0, 40.0, 80.0, -20.0, 160.0, 280.0, 260.0, 30.0, 60.0, 60.0, 70.0, 400.0, 30.0, 370.0, 60.0, -10.0, 20.0, -30.0, 80.0, 0.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 30.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 90.0, 10.0, 170.0, 10.0, 0.0, 40.0, 10.0, 70.0, 40.0, 50.0, 10.0, 35.0, 280.0, 20.0, 20.0, 60.0, 110.0, 50.0, 40.0, 160.0, 30.0, 350.0, 130.0, 30.0, 40.0, 70.0, 30.0, 30.0, 30.0, 140.0, 0.0, 380.0, 190.0, 920.0, 10.0, 30.0, 20.0, 120.0, 20.0, 30.0, 0.0, 70.0, 20.0, 100.0, 20.0, -20.0, 80.0, 100.0, 80.0, 120.0, 60.0, 30.0, 70.0, 30.0, 300.0, 50.0, 10.0, 30.0, 10.0, 5.0, 40.0, 0.0, 0.0, 20.0, 0.0, 120.0, 270.0, 70.0, 10.0, 80.0, 40.0, 670.0, -70.0, 100.0, 80.0, 30.0, 20.0, 90.0, 10.0, 130.0, 40.0, 70.0, 280.0, 200.0, 160.0, 80.0, 90.0, 60.0, 0.0, 60.0, 0.0, 50.0, 120.0, 160.0, 40.0, 10.0, 0.0, 395.0, 50.0, 70.0, 30.0, 70.0, 420.0, 70.0, 40.0, 30.0, 60.0, 70.0, 0.0, 300.0, 590.0, 80.0, 190.0, 230.0, 40.0, 100.0, 590.0, 130.0, 15.0, 50.0, 210.0, 110.0, 310.0, 40.0, 10.0, 40.0, 10.0, 100.0, 10.0, 70.0, 0.0, 10.0, 40.0, 30.0, 30.0, 50.0, 30.0, 10.0, 100.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 100.0, 150.0, 720.0, 50.0, 120.0, 90.0, 220.0, 230.0, 60.0, 60.0, 20.0, 180.0, 120.0, 30.0, 40.0, 100.0, 80.0, 150.0, 10.0, 40.0, 30.0, 210.0, 80.0, 40.0, 100.0, 170.0, 40.0, 80.0, 30.0, 110.0, 520.0, 100.0, 20.0, 260.0, 40.0, 120.0, 70.0, 190.0, 0.0, 40.0, 80.0, 10.0, 20.0, 10.0, 60.0, 0.0, 60.0, 10.0, 90.0, 0.0, 130.0, -60.0, 510.0, 200.0, -40.0, 190.0, 70.0, 20.0, 40.0, 20.0, 20.0, 30.0, 390.0, 20.0, -25.0, 5.0, 20.0, 180.0, 70.0, 60.0, 180.0, 0.0, 110.0, 380.0, 40.0, 10.0, 0.0, -470.0, 90.0, 20.0, 70.0, 40.0, 30.0, 130.0, 30.0, 0.0, 30.0, 30.0, 510.0, 10.0, 50.0, 80.0, 270.0, 10.0, 360.0, 200.0, -150.0, -10.0, 70.0, 210.0, 40.0, 120.0, 60.0, 30.0, 110.0, 50.0, 300.0, 190.0, 70.0, 440.0, 30.0, 570.0, 110.0, 380.0, 200.0, 100.0, 20.0, 50.0, 10.0, 100.0, 40.0, 0.0, 40.0, 40.0, 160.0, 30.0, 0.0, 110.0, 0.0, 120.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 110.0, 75.0, 40.0, 110.0, 60.0, 20.0, 0.0, 80.0, 50.0, 0.0, 90.0, 20.0, 90.0, 230.0, 260.0, 170.0, 90.0, 130.0, 60.0, 20.0, 40.0, 120.0, 130.0, 20.0, 150.0, 540.0, 10.0, 100.0, -10.0, 300.0, 60.0, 190.0, 160.0, 90.0, 130.0, -50.0, 110.0, 20.0, 40.0, 80.0, 190.0, 40.0, 0.0, 70.0, -15.0, 570.0, 20.0, 10.0, 70.0, 470.0, 20.0, 70.0, 390.0, 100.0, 680.0, 100.0, 0.0, 170.0, 200.0, 40.0, 70.0, 410.0, 310.0, 70.0, 80.0, 60.0, 190.0, 20.0, 80.0, 30.0, 170.0, 170.0, 80.0, 30.0, 30.0, 30.0, 30.0, -70.0, 310.0, 20.0, 20.0, 110.0, 90.0, 20.0, 90.0, 30.0, 20.0, 60.0, 10.0, 100.0, 70.0, 30.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4791072996654233, "mean_inference_ms": 1.4207394001275429, "mean_action_processing_ms": 0.4205546408864476, "mean_env_wait_ms": 1.2537514925188769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011947870254516602, "StateBufferConnector_ms": 0.009512186050415039, "ViewRequirementAgentConnector_ms": 0.3883357048034668}, "num_episodes": 18, "episode_return_max": 2080.0, "episode_return_min": 80.0, "episode_return_mean": 943.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.4397685654255, "num_env_steps_trained_throughput_per_sec": 21.4397685654255, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 5520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5520000, "timers": {"training_iteration_time_ms": 185650.082, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185650.038, "sample_time_ms": 2499.777, "learn_time_ms": 183129.351, "learn_throughput": 21.842, "synch_weights_time_ms": 11.687}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "done": false, "training_iteration": 138, "trial_id": "90816_00000", "date": "2024-06-10_07-23-18", "timestamp": 1718018598, "time_this_iter_s": 186.57814192771912, "time_total_s": 25874.91490960121, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00a7d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25874.91490960121, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 29.741666666666664, "ram_util_percent": 79.41818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0904983883721635, "cur_kl_coeff": 6.327056305469517, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0040253836110123176, "vf_loss": 7.299393741467509, "vf_explained_var": -0.0006731452906347565, "kl": Infinity, "entropy": 0.3024622901496542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1300515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 80.0, "episode_reward_mean": 1000.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 100.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1250.0, 470.0, 1700.0, 1130.0, 1760.0, 1120.0, 970.0, 1040.0, 1010.0, 550.0, 890.0, 870.0, 650.0, 490.0, 80.0, 1540.0, 1010.0, 1320.0, 1150.0, 1100.0, 1280.0, 1500.0, 1000.0, 585.0, 1705.0, 550.0, 1090.0, 600.0, 1030.0, 1465.0, 1450.0, 610.0, 320.0, 850.0, 810.0, 1590.0, 960.0, 1050.0, 230.0, 330.0, 575.0, 1000.0, 1800.0, 430.0, 850.0, 165.0, 1370.0, 1030.0, 660.0, 1155.0, 1590.0, 1565.0, 340.0, 420.0, 1800.0, 770.0, 890.0, 1360.0, 340.0, 1080.0, 770.0, 360.0, 880.0, 1090.0, 1410.0, 1570.0, 540.0, 345.0, 520.0, 1250.0, 1520.0, 650.0, 1675.0, 2080.0, 950.0, 600.0, 480.0, 1320.0, 810.0, 630.0, 1450.0, 1050.0, 1590.0, 870.0, 1280.0, 980.0, 1510.0, 775.0, 1270.0, 1045.0, 690.0, 900.0, 1650.0, 880.0, 1040.0, 1460.0, 730.0, 1060.0, 1555.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 30.0, -20.0, 190.0, 110.0, 240.0, 190.0, 100.0, 80.0, 250.0, 40.0, 20.0, 60.0, 60.0, 40.0, 70.0, 40.0, 70.0, 10.0, 60.0, 130.0, 110.0, 110.0, 280.0, 50.0, 100.0, 30.0, 510.0, 310.0, 70.0, 90.0, 50.0, 20.0, 230.0, 100.0, 90.0, 110.0, 100.0, 280.0, 60.0, -60.0, 70.0, 410.0, 500.0, 280.0, 100.0, 50.0, -30.0, 130.0, 310.0, 0.0, 410.0, 50.0, 90.0, 200.0, 0.0, 90.0, 90.0, 30.0, 160.0, 20.0, 270.0, 170.0, 80.0, 280.0, 10.0, 0.0, 10.0, 100.0, 30.0, 270.0, 10.0, 120.0, 290.0, -20.0, 150.0, 40.0, 30.0, 70.0, 80.0, 20.0, 70.0, 50.0, 110.0, 200.0, 200.0, 130.0, 160.0, 10.0, 60.0, 10.0, 0.0, 20.0, 80.0, 100.0, 110.0, 0.0, 10.0, 190.0, 30.0, 60.0, 20.0, 10.0, 40.0, 150.0, 380.0, 30.0, 100.0, 90.0, 10.0, 50.0, 120.0, 120.0, 40.0, 10.0, 200.0, 190.0, 20.0, 90.0, 30.0, 30.0, 230.0, 60.0, 160.0, 20.0, 10.0, 40.0, 50.0, 20.0, 30.0, 0.0, 30.0, 40.0, 100.0, 10.0, 0.0, 20.0, 50.0, 230.0, 10.0, 0.0, 10.0, 30.0, 30.0, -50.0, 0.0, 10.0, 0.0, 20.0, 30.0, 380.0, 20.0, 130.0, 70.0, 630.0, 60.0, 70.0, 160.0, -20.0, 40.0, 110.0, 260.0, 120.0, 20.0, 200.0, 40.0, 70.0, 60.0, 40.0, 90.0, 150.0, 90.0, 70.0, 490.0, -20.0, 260.0, -20.0, 70.0, 110.0, 120.0, 0.0, 60.0, 310.0, 80.0, 40.0, 120.0, 90.0, 150.0, 100.0, 200.0, 210.0, 140.0, 20.0, -10.0, 50.0, 330.0, 80.0, 110.0, 80.0, 90.0, -10.0, 60.0, 610.0, 20.0, 140.0, 50.0, 240.0, 80.0, 20.0, 70.0, 0.0, 520.0, 70.0, 270.0, 360.0, 30.0, 50.0, 90.0, 40.0, 70.0, 130.0, 230.0, 40.0, 20.0, 40.0, 150.0, 60.0, 90.0, 220.0, 20.0, 10.0, -50.0, 40.0, 20.0, 30.0, 160.0, 40.0, 60.0, 15.0, 260.0, 120.0, 170.0, -40.0, 70.0, 260.0, 45.0, 610.0, 200.0, 90.0, 180.0, 30.0, 60.0, 10.0, 10.0, 40.0, 80.0, 70.0, 60.0, 160.0, 30.0, 120.0, -20.0, 380.0, 30.0, 120.0, 40.0, 270.0, 20.0, 130.0, 0.0, 120.0, 10.0, 10.0, 120.0, 170.0, 10.0, 10.0, 50.0, 60.0, 40.0, 10.0, 200.0, 230.0, 20.0, 230.0, 100.0, 80.0, 30.0, 70.0, 60.0, 350.0, 55.0, 30.0, 15.0, 240.0, 60.0, 110.0, 90.0, 490.0, 25.0, 260.0, 250.0, 50.0, 90.0, -20.0, 60.0, 30.0, 20.0, 250.0, 460.0, 0.0, 380.0, -10.0, 50.0, -10.0, 20.0, 10.0, 70.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 70.0, 450.0, 60.0, -40.0, -20.0, 40.0, 80.0, 30.0, 40.0, 140.0, 40.0, 80.0, 0.0, 20.0, 90.0, 40.0, 380.0, 90.0, 20.0, 50.0, 30.0, 80.0, 710.0, 150.0, 210.0, 40.0, 0.0, 180.0, 70.0, 120.0, 10.0, 60.0, 40.0, 80.0, -20.0, 160.0, 280.0, 260.0, 30.0, 60.0, 60.0, 70.0, 400.0, 30.0, 370.0, 60.0, -10.0, 20.0, -30.0, 80.0, 0.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 30.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 90.0, 10.0, 170.0, 10.0, 0.0, 40.0, 10.0, 70.0, 40.0, 50.0, 10.0, 35.0, 280.0, 20.0, 20.0, 60.0, 110.0, 50.0, 40.0, 160.0, 30.0, 350.0, 130.0, 30.0, 40.0, 70.0, 30.0, 30.0, 30.0, 140.0, 0.0, 380.0, 190.0, 920.0, 10.0, 30.0, 20.0, 120.0, 20.0, 30.0, 0.0, 70.0, 20.0, 100.0, 20.0, -20.0, 80.0, 100.0, 80.0, 120.0, 60.0, 30.0, 70.0, 30.0, 300.0, 50.0, 10.0, 30.0, 10.0, 5.0, 40.0, 0.0, 0.0, 20.0, 0.0, 120.0, 270.0, 70.0, 10.0, 80.0, 40.0, 670.0, -70.0, 100.0, 80.0, 30.0, 20.0, 90.0, 10.0, 130.0, 40.0, 70.0, 280.0, 200.0, 160.0, 80.0, 90.0, 60.0, 0.0, 60.0, 0.0, 50.0, 120.0, 160.0, 40.0, 10.0, 0.0, 395.0, 50.0, 70.0, 30.0, 70.0, 420.0, 70.0, 40.0, 30.0, 60.0, 70.0, 0.0, 300.0, 590.0, 80.0, 190.0, 230.0, 40.0, 100.0, 590.0, 130.0, 15.0, 50.0, 210.0, 110.0, 310.0, 40.0, 10.0, 40.0, 10.0, 100.0, 10.0, 70.0, 0.0, 10.0, 40.0, 30.0, 30.0, 50.0, 30.0, 10.0, 100.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 100.0, 150.0, 720.0, 50.0, 120.0, 90.0, 220.0, 230.0, 60.0, 60.0, 20.0, 180.0, 120.0, 30.0, 40.0, 100.0, 80.0, 150.0, 10.0, 40.0, 30.0, 210.0, 80.0, 40.0, 100.0, 170.0, 40.0, 80.0, 30.0, 110.0, 520.0, 100.0, 20.0, 260.0, 40.0, 120.0, 70.0, 190.0, 0.0, 40.0, 80.0, 10.0, 20.0, 10.0, 60.0, 0.0, 60.0, 10.0, 90.0, 0.0, 130.0, -60.0, 510.0, 200.0, -40.0, 190.0, 70.0, 20.0, 40.0, 20.0, 20.0, 30.0, 390.0, 20.0, -25.0, 5.0, 20.0, 180.0, 70.0, 60.0, 180.0, 0.0, 110.0, 380.0, 40.0, 10.0, 0.0, -470.0, 90.0, 20.0, 70.0, 40.0, 30.0, 130.0, 30.0, 0.0, 30.0, 30.0, 510.0, 10.0, 50.0, 80.0, 270.0, 10.0, 360.0, 200.0, -150.0, -10.0, 70.0, 210.0, 40.0, 120.0, 60.0, 30.0, 110.0, 50.0, 300.0, 190.0, 70.0, 440.0, 30.0, 570.0, 110.0, 380.0, 200.0, 100.0, 20.0, 50.0, 10.0, 100.0, 40.0, 0.0, 40.0, 40.0, 160.0, 30.0, 0.0, 110.0, 0.0, 120.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 110.0, 75.0, 40.0, 110.0, 60.0, 20.0, 0.0, 80.0, 50.0, 0.0, 90.0, 20.0, 90.0, 230.0, 260.0, 170.0, 90.0, 130.0, 60.0, 20.0, 40.0, 120.0, 130.0, 20.0, 150.0, 540.0, 10.0, 100.0, -10.0, 300.0, 60.0, 190.0, 160.0, 90.0, 130.0, -50.0, 110.0, 20.0, 40.0, 80.0, 190.0, 40.0, 0.0, 70.0, -15.0, 570.0, 20.0, 10.0, 70.0, 470.0, 20.0, 70.0, 390.0, 100.0, 680.0, 100.0, 0.0, 170.0, 200.0, 40.0, 70.0, 410.0, 310.0, 70.0, 80.0, 60.0, 190.0, 20.0, 80.0, 30.0, 170.0, 170.0, 80.0, 30.0, 30.0, 30.0, 30.0, -70.0, 310.0, 20.0, 20.0, 110.0, 90.0, 20.0, 90.0, 30.0, 20.0, 60.0, 10.0, 100.0, 70.0, 30.0, 50.0, 0.0, 200.0, 390.0, 160.0, 80.0, 70.0, 70.0, 100.0, 170.0, 80.0, 20.0, 150.0, 100.0, 60.0, 120.0, -20.0, 30.0, 180.0, 0.0, 170.0, 70.0, 480.0, 30.0, 10.0, 20.0, -30.0, 0.0, 40.0, 10.0, 0.0, 350.0, -20.0, 70.0, 170.0, 170.0, 40.0, 60.0, 460.0, 180.0, -30.0, -10.0, 180.0, 290.0, 140.0, 80.0, 50.0, 180.0, 30.0, 30.0, 80.0, 25.0, 5.0, 320.0, 210.0, 270.0, 300.0, 100.0, 180.0, 70.0, 110.0, 80.0, 50.0, 70.0, 80.0, 60.0, 50.0, 40.0, 40.0, 30.0, 370.0, -40.0, 10.0, 410.0, -40.0, 50.0, 110.0, 80.0, 70.0, 50.0, 580.0, 100.0, 110.0, 220.0, 50.0, 80.0, 50.0, 120.0, 60.0, 160.0, 30.0, 70.0, 180.0, 190.0, 310.0, 70.0, 70.0, 40.0, 30.0, 120.0, 430.0, 0.0, -5.0, 30.0, 120.0, 170.0, 90.0, 70.0, 170.0, 80.0, 50.0, 90.0, 40.0, 130.0, 70.0, 410.0, 10.0, -30.0, 150.0, 70.0, 330.0, 10.0, 60.0, 60.0, 80.0, 120.0, 10.0, 330.0, 220.0, 120.0, 35.0, 80.0, 30.0, 0.0, 10.0, 170.0, 250.0, 80.0, 0.0, 30.0, 40.0, 10.0, 40.0, 440.0, 70.0, 40.0, 40.0, 60.0, 30.0, 100.0, 70.0, 100.0, 80.0, 80.0, 50.0, 250.0, 80.0, 260.0, 460.0, 230.0, 60.0, 40.0, 30.0, 430.0, 50.0, 120.0, 70.0, 40.0, 30.0, 30.0, 40.0, -100.0, 260.0, 230.0, 170.0, 70.0, 90.0, -170.0, 80.0, 130.0, 280.0, 120.0, 90.0, 50.0, 70.0, 110.0, 470.0, 40.0, 400.0, 50.0, 60.0, -50.0, 20.0, 190.0, 160.0, -300.0, 370.0, 190.0, 10.0, 100.0, 40.0, 210.0, 90.0, 120.0, 90.0, 190.0, 70.0, 90.0, 70.0, 50.0, 80.0, 80.0, 30.0, -35.0, 865.0, 340.0, 200.0, -70.0, 40.0, 5.0, 100.0, -25.0, 40.0, 20.0, 10.0, 170.0, 240.0, -25.0, 80.0, -20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4782188093665816, "mean_inference_ms": 1.4213904854372736, "mean_action_processing_ms": 0.4204539790850862, "mean_env_wait_ms": 1.254175674829757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012031793594360352, "StateBufferConnector_ms": 0.00991678237915039, "ViewRequirementAgentConnector_ms": 0.3972601890563965}, "num_episodes": 23, "episode_return_max": 2080.0, "episode_return_min": 80.0, "episode_return_mean": 1000.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.55728907518808, "num_env_steps_trained_throughput_per_sec": 21.55728907518808, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 5560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5560000, "timers": {"training_iteration_time_ms": 185568.132, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185568.089, "sample_time_ms": 2429.559, "learn_time_ms": 183117.774, "learn_throughput": 21.844, "synch_weights_time_ms": 11.603}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "done": false, "training_iteration": 139, "trial_id": "90816_00000", "date": "2024-06-10_07-26-23", "timestamp": 1718018783, "time_this_iter_s": 185.56078004837036, "time_total_s": 26060.475689649582, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00a74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26060.475689649582, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 27.731297709923666, "ram_util_percent": 79.29198473282443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.202998693707906, "cur_kl_coeff": 9.49058445820428, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0035802157046531226, "vf_loss": 6.851032128146154, "vf_explained_var": 0.0009538815425226863, "kl": Infinity, "entropy": 0.32651505715930806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1309905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 165.0, "episode_reward_mean": 998.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 99.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1150.0, 1100.0, 1280.0, 1500.0, 1000.0, 585.0, 1705.0, 550.0, 1090.0, 600.0, 1030.0, 1465.0, 1450.0, 610.0, 320.0, 850.0, 810.0, 1590.0, 960.0, 1050.0, 230.0, 330.0, 575.0, 1000.0, 1800.0, 430.0, 850.0, 165.0, 1370.0, 1030.0, 660.0, 1155.0, 1590.0, 1565.0, 340.0, 420.0, 1800.0, 770.0, 890.0, 1360.0, 340.0, 1080.0, 770.0, 360.0, 880.0, 1090.0, 1410.0, 1570.0, 540.0, 345.0, 520.0, 1250.0, 1520.0, 650.0, 1675.0, 2080.0, 950.0, 600.0, 480.0, 1320.0, 810.0, 630.0, 1450.0, 1050.0, 1590.0, 870.0, 1280.0, 980.0, 1510.0, 775.0, 1270.0, 1045.0, 690.0, 900.0, 1650.0, 880.0, 1040.0, 1460.0, 730.0, 1060.0, 1555.0, 520.0, 390.0, 1740.0, 720.0, 1290.0, 850.0, 760.0, 1700.0, 880.0, 1410.0, 1560.0, 450.0, 300.0, 1050.0, 1120.0, 800.0, 560.0, 870.0, 1200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 60.0, 310.0, 80.0, 40.0, 120.0, 90.0, 150.0, 100.0, 200.0, 210.0, 140.0, 20.0, -10.0, 50.0, 330.0, 80.0, 110.0, 80.0, 90.0, -10.0, 60.0, 610.0, 20.0, 140.0, 50.0, 240.0, 80.0, 20.0, 70.0, 0.0, 520.0, 70.0, 270.0, 360.0, 30.0, 50.0, 90.0, 40.0, 70.0, 130.0, 230.0, 40.0, 20.0, 40.0, 150.0, 60.0, 90.0, 220.0, 20.0, 10.0, -50.0, 40.0, 20.0, 30.0, 160.0, 40.0, 60.0, 15.0, 260.0, 120.0, 170.0, -40.0, 70.0, 260.0, 45.0, 610.0, 200.0, 90.0, 180.0, 30.0, 60.0, 10.0, 10.0, 40.0, 80.0, 70.0, 60.0, 160.0, 30.0, 120.0, -20.0, 380.0, 30.0, 120.0, 40.0, 270.0, 20.0, 130.0, 0.0, 120.0, 10.0, 10.0, 120.0, 170.0, 10.0, 10.0, 50.0, 60.0, 40.0, 10.0, 200.0, 230.0, 20.0, 230.0, 100.0, 80.0, 30.0, 70.0, 60.0, 350.0, 55.0, 30.0, 15.0, 240.0, 60.0, 110.0, 90.0, 490.0, 25.0, 260.0, 250.0, 50.0, 90.0, -20.0, 60.0, 30.0, 20.0, 250.0, 460.0, 0.0, 380.0, -10.0, 50.0, -10.0, 20.0, 10.0, 70.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 70.0, 450.0, 60.0, -40.0, -20.0, 40.0, 80.0, 30.0, 40.0, 140.0, 40.0, 80.0, 0.0, 20.0, 90.0, 40.0, 380.0, 90.0, 20.0, 50.0, 30.0, 80.0, 710.0, 150.0, 210.0, 40.0, 0.0, 180.0, 70.0, 120.0, 10.0, 60.0, 40.0, 80.0, -20.0, 160.0, 280.0, 260.0, 30.0, 60.0, 60.0, 70.0, 400.0, 30.0, 370.0, 60.0, -10.0, 20.0, -30.0, 80.0, 0.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 30.0, 10.0, 20.0, 0.0, 30.0, 0.0, 0.0, 90.0, 10.0, 170.0, 10.0, 0.0, 40.0, 10.0, 70.0, 40.0, 50.0, 10.0, 35.0, 280.0, 20.0, 20.0, 60.0, 110.0, 50.0, 40.0, 160.0, 30.0, 350.0, 130.0, 30.0, 40.0, 70.0, 30.0, 30.0, 30.0, 140.0, 0.0, 380.0, 190.0, 920.0, 10.0, 30.0, 20.0, 120.0, 20.0, 30.0, 0.0, 70.0, 20.0, 100.0, 20.0, -20.0, 80.0, 100.0, 80.0, 120.0, 60.0, 30.0, 70.0, 30.0, 300.0, 50.0, 10.0, 30.0, 10.0, 5.0, 40.0, 0.0, 0.0, 20.0, 0.0, 120.0, 270.0, 70.0, 10.0, 80.0, 40.0, 670.0, -70.0, 100.0, 80.0, 30.0, 20.0, 90.0, 10.0, 130.0, 40.0, 70.0, 280.0, 200.0, 160.0, 80.0, 90.0, 60.0, 0.0, 60.0, 0.0, 50.0, 120.0, 160.0, 40.0, 10.0, 0.0, 395.0, 50.0, 70.0, 30.0, 70.0, 420.0, 70.0, 40.0, 30.0, 60.0, 70.0, 0.0, 300.0, 590.0, 80.0, 190.0, 230.0, 40.0, 100.0, 590.0, 130.0, 15.0, 50.0, 210.0, 110.0, 310.0, 40.0, 10.0, 40.0, 10.0, 100.0, 10.0, 70.0, 0.0, 10.0, 40.0, 30.0, 30.0, 50.0, 30.0, 10.0, 100.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 100.0, 150.0, 720.0, 50.0, 120.0, 90.0, 220.0, 230.0, 60.0, 60.0, 20.0, 180.0, 120.0, 30.0, 40.0, 100.0, 80.0, 150.0, 10.0, 40.0, 30.0, 210.0, 80.0, 40.0, 100.0, 170.0, 40.0, 80.0, 30.0, 110.0, 520.0, 100.0, 20.0, 260.0, 40.0, 120.0, 70.0, 190.0, 0.0, 40.0, 80.0, 10.0, 20.0, 10.0, 60.0, 0.0, 60.0, 10.0, 90.0, 0.0, 130.0, -60.0, 510.0, 200.0, -40.0, 190.0, 70.0, 20.0, 40.0, 20.0, 20.0, 30.0, 390.0, 20.0, -25.0, 5.0, 20.0, 180.0, 70.0, 60.0, 180.0, 0.0, 110.0, 380.0, 40.0, 10.0, 0.0, -470.0, 90.0, 20.0, 70.0, 40.0, 30.0, 130.0, 30.0, 0.0, 30.0, 30.0, 510.0, 10.0, 50.0, 80.0, 270.0, 10.0, 360.0, 200.0, -150.0, -10.0, 70.0, 210.0, 40.0, 120.0, 60.0, 30.0, 110.0, 50.0, 300.0, 190.0, 70.0, 440.0, 30.0, 570.0, 110.0, 380.0, 200.0, 100.0, 20.0, 50.0, 10.0, 100.0, 40.0, 0.0, 40.0, 40.0, 160.0, 30.0, 0.0, 110.0, 0.0, 120.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 110.0, 75.0, 40.0, 110.0, 60.0, 20.0, 0.0, 80.0, 50.0, 0.0, 90.0, 20.0, 90.0, 230.0, 260.0, 170.0, 90.0, 130.0, 60.0, 20.0, 40.0, 120.0, 130.0, 20.0, 150.0, 540.0, 10.0, 100.0, -10.0, 300.0, 60.0, 190.0, 160.0, 90.0, 130.0, -50.0, 110.0, 20.0, 40.0, 80.0, 190.0, 40.0, 0.0, 70.0, -15.0, 570.0, 20.0, 10.0, 70.0, 470.0, 20.0, 70.0, 390.0, 100.0, 680.0, 100.0, 0.0, 170.0, 200.0, 40.0, 70.0, 410.0, 310.0, 70.0, 80.0, 60.0, 190.0, 20.0, 80.0, 30.0, 170.0, 170.0, 80.0, 30.0, 30.0, 30.0, 30.0, -70.0, 310.0, 20.0, 20.0, 110.0, 90.0, 20.0, 90.0, 30.0, 20.0, 60.0, 10.0, 100.0, 70.0, 30.0, 50.0, 0.0, 200.0, 390.0, 160.0, 80.0, 70.0, 70.0, 100.0, 170.0, 80.0, 20.0, 150.0, 100.0, 60.0, 120.0, -20.0, 30.0, 180.0, 0.0, 170.0, 70.0, 480.0, 30.0, 10.0, 20.0, -30.0, 0.0, 40.0, 10.0, 0.0, 350.0, -20.0, 70.0, 170.0, 170.0, 40.0, 60.0, 460.0, 180.0, -30.0, -10.0, 180.0, 290.0, 140.0, 80.0, 50.0, 180.0, 30.0, 30.0, 80.0, 25.0, 5.0, 320.0, 210.0, 270.0, 300.0, 100.0, 180.0, 70.0, 110.0, 80.0, 50.0, 70.0, 80.0, 60.0, 50.0, 40.0, 40.0, 30.0, 370.0, -40.0, 10.0, 410.0, -40.0, 50.0, 110.0, 80.0, 70.0, 50.0, 580.0, 100.0, 110.0, 220.0, 50.0, 80.0, 50.0, 120.0, 60.0, 160.0, 30.0, 70.0, 180.0, 190.0, 310.0, 70.0, 70.0, 40.0, 30.0, 120.0, 430.0, 0.0, -5.0, 30.0, 120.0, 170.0, 90.0, 70.0, 170.0, 80.0, 50.0, 90.0, 40.0, 130.0, 70.0, 410.0, 10.0, -30.0, 150.0, 70.0, 330.0, 10.0, 60.0, 60.0, 80.0, 120.0, 10.0, 330.0, 220.0, 120.0, 35.0, 80.0, 30.0, 0.0, 10.0, 170.0, 250.0, 80.0, 0.0, 30.0, 40.0, 10.0, 40.0, 440.0, 70.0, 40.0, 40.0, 60.0, 30.0, 100.0, 70.0, 100.0, 80.0, 80.0, 50.0, 250.0, 80.0, 260.0, 460.0, 230.0, 60.0, 40.0, 30.0, 430.0, 50.0, 120.0, 70.0, 40.0, 30.0, 30.0, 40.0, -100.0, 260.0, 230.0, 170.0, 70.0, 90.0, -170.0, 80.0, 130.0, 280.0, 120.0, 90.0, 50.0, 70.0, 110.0, 470.0, 40.0, 400.0, 50.0, 60.0, -50.0, 20.0, 190.0, 160.0, -300.0, 370.0, 190.0, 10.0, 100.0, 40.0, 210.0, 90.0, 120.0, 90.0, 190.0, 70.0, 90.0, 70.0, 50.0, 80.0, 80.0, 30.0, -35.0, 865.0, 340.0, 200.0, -70.0, 40.0, 5.0, 100.0, -25.0, 40.0, 20.0, 10.0, 170.0, 240.0, -25.0, 80.0, -20.0, 30.0, 120.0, 20.0, 10.0, 50.0, 110.0, 0.0, 40.0, 10.0, 30.0, 0.0, -110.0, 330.0, 120.0, 120.0, 290.0, 70.0, 110.0, 210.0, 530.0, 70.0, 270.0, 20.0, 40.0, 60.0, 70.0, 110.0, 40.0, 20.0, 40.0, 50.0, 80.0, 0.0, 70.0, 50.0, 340.0, 100.0, 340.0, 130.0, 130.0, 50.0, 180.0, -100.0, 30.0, 250.0, 30.0, 90.0, 120.0, 10.0, 290.0, -50.0, 90.0, 50.0, 80.0, 140.0, 30.0, 190.0, 20.0, 50.0, 30.0, 80.0, -20.0, 570.0, 50.0, 300.0, 40.0, 360.0, 40.0, 110.0, 10.0, 240.0, 20.0, 210.0, 0.0, 110.0, 30.0, 50.0, 20.0, 170.0, 90.0, 180.0, 60.0, 40.0, -20.0, 130.0, 740.0, 0.0, 30.0, 230.0, 50.0, 150.0, 20.0, 170.0, 270.0, 30.0, 150.0, 30.0, 140.0, 220.0, 520.0, 10.0, 30.0, 150.0, 60.0, 0.0, 40.0, 40.0, 30.0, 60.0, 0.0, 40.0, 20.0, 130.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 40.0, 90.0, 20.0, 40.0, 60.0, 130.0, 100.0, 0.0, 500.0, 70.0, 180.0, 20.0, 160.0, 80.0, 110.0, 100.0, 190.0, 70.0, 170.0, 40.0, 30.0, 20.0, 40.0, 460.0, 10.0, 10.0, 110.0, -10.0, 80.0, 50.0, -40.0, 10.0, 90.0, 20.0, 190.0, 80.0, 40.0, -20.0, 90.0, 100.0, 30.0, -30.0, -50.0, 340.0, 10.0, 80.0, 60.0, 30.0, 370.0, 30.0, 0.0, 230.0, 30.0, 260.0, 40.0, 560.0, 20.0, 20.0, 30.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4776557822079228, "mean_inference_ms": 1.421760101854728, "mean_action_processing_ms": 0.4203641043505694, "mean_env_wait_ms": 1.254456376240234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012033700942993164, "StateBufferConnector_ms": 0.009552955627441406, "ViewRequirementAgentConnector_ms": 0.39341139793395996}, "num_episodes": 18, "episode_return_max": 2080.0, "episode_return_min": 165.0, "episode_return_mean": 998.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.332528486311954, "num_env_steps_trained_throughput_per_sec": 21.332528486311954, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 5600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5600000, "timers": {"training_iteration_time_ms": 185708.063, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185708.008, "sample_time_ms": 2435.755, "learn_time_ms": 183252.483, "learn_throughput": 21.828, "synch_weights_time_ms": 11.26}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "done": false, "training_iteration": 140, "trial_id": "90816_00000", "date": "2024-06-10_07-29-31", "timestamp": 1718018971, "time_this_iter_s": 187.51682090759277, "time_total_s": 26247.992510557175, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b311f0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26247.992510557175, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 25.56754716981132, "ram_util_percent": 79.08452830188679}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5021433291724695, "cur_kl_coeff": 14.235876687306419, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.407053037141712, "policy_loss": -0.002822884790132197, "vf_loss": 6.406861974078373, "vf_explained_var": -0.00030344384419905363, "kl": 0.0002117150738261169, "entropy": 0.3526705600995733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1319295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 165.0, "episode_reward_mean": 982.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 98.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [575.0, 1000.0, 1800.0, 430.0, 850.0, 165.0, 1370.0, 1030.0, 660.0, 1155.0, 1590.0, 1565.0, 340.0, 420.0, 1800.0, 770.0, 890.0, 1360.0, 340.0, 1080.0, 770.0, 360.0, 880.0, 1090.0, 1410.0, 1570.0, 540.0, 345.0, 520.0, 1250.0, 1520.0, 650.0, 1675.0, 2080.0, 950.0, 600.0, 480.0, 1320.0, 810.0, 630.0, 1450.0, 1050.0, 1590.0, 870.0, 1280.0, 980.0, 1510.0, 775.0, 1270.0, 1045.0, 690.0, 900.0, 1650.0, 880.0, 1040.0, 1460.0, 730.0, 1060.0, 1555.0, 520.0, 390.0, 1740.0, 720.0, 1290.0, 850.0, 760.0, 1700.0, 880.0, 1410.0, 1560.0, 450.0, 300.0, 1050.0, 1120.0, 800.0, 560.0, 870.0, 1200.0, 1080.0, 1670.0, 820.0, 285.0, 750.0, 580.0, 1010.0, 785.0, 890.0, 1390.0, 1325.0, 480.0, 1290.0, 420.0, 900.0, 1510.0, 710.0, 570.0, 1100.0, 435.0, 440.0, 1230.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 70.0, 40.0, 50.0, 10.0, 35.0, 280.0, 20.0, 20.0, 60.0, 110.0, 50.0, 40.0, 160.0, 30.0, 350.0, 130.0, 30.0, 40.0, 70.0, 30.0, 30.0, 30.0, 140.0, 0.0, 380.0, 190.0, 920.0, 10.0, 30.0, 20.0, 120.0, 20.0, 30.0, 0.0, 70.0, 20.0, 100.0, 20.0, -20.0, 80.0, 100.0, 80.0, 120.0, 60.0, 30.0, 70.0, 30.0, 300.0, 50.0, 10.0, 30.0, 10.0, 5.0, 40.0, 0.0, 0.0, 20.0, 0.0, 120.0, 270.0, 70.0, 10.0, 80.0, 40.0, 670.0, -70.0, 100.0, 80.0, 30.0, 20.0, 90.0, 10.0, 130.0, 40.0, 70.0, 280.0, 200.0, 160.0, 80.0, 90.0, 60.0, 0.0, 60.0, 0.0, 50.0, 120.0, 160.0, 40.0, 10.0, 0.0, 395.0, 50.0, 70.0, 30.0, 70.0, 420.0, 70.0, 40.0, 30.0, 60.0, 70.0, 0.0, 300.0, 590.0, 80.0, 190.0, 230.0, 40.0, 100.0, 590.0, 130.0, 15.0, 50.0, 210.0, 110.0, 310.0, 40.0, 10.0, 40.0, 10.0, 100.0, 10.0, 70.0, 0.0, 10.0, 40.0, 30.0, 30.0, 50.0, 30.0, 10.0, 100.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 100.0, 150.0, 720.0, 50.0, 120.0, 90.0, 220.0, 230.0, 60.0, 60.0, 20.0, 180.0, 120.0, 30.0, 40.0, 100.0, 80.0, 150.0, 10.0, 40.0, 30.0, 210.0, 80.0, 40.0, 100.0, 170.0, 40.0, 80.0, 30.0, 110.0, 520.0, 100.0, 20.0, 260.0, 40.0, 120.0, 70.0, 190.0, 0.0, 40.0, 80.0, 10.0, 20.0, 10.0, 60.0, 0.0, 60.0, 10.0, 90.0, 0.0, 130.0, -60.0, 510.0, 200.0, -40.0, 190.0, 70.0, 20.0, 40.0, 20.0, 20.0, 30.0, 390.0, 20.0, -25.0, 5.0, 20.0, 180.0, 70.0, 60.0, 180.0, 0.0, 110.0, 380.0, 40.0, 10.0, 0.0, -470.0, 90.0, 20.0, 70.0, 40.0, 30.0, 130.0, 30.0, 0.0, 30.0, 30.0, 510.0, 10.0, 50.0, 80.0, 270.0, 10.0, 360.0, 200.0, -150.0, -10.0, 70.0, 210.0, 40.0, 120.0, 60.0, 30.0, 110.0, 50.0, 300.0, 190.0, 70.0, 440.0, 30.0, 570.0, 110.0, 380.0, 200.0, 100.0, 20.0, 50.0, 10.0, 100.0, 40.0, 0.0, 40.0, 40.0, 160.0, 30.0, 0.0, 110.0, 0.0, 120.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 110.0, 75.0, 40.0, 110.0, 60.0, 20.0, 0.0, 80.0, 50.0, 0.0, 90.0, 20.0, 90.0, 230.0, 260.0, 170.0, 90.0, 130.0, 60.0, 20.0, 40.0, 120.0, 130.0, 20.0, 150.0, 540.0, 10.0, 100.0, -10.0, 300.0, 60.0, 190.0, 160.0, 90.0, 130.0, -50.0, 110.0, 20.0, 40.0, 80.0, 190.0, 40.0, 0.0, 70.0, -15.0, 570.0, 20.0, 10.0, 70.0, 470.0, 20.0, 70.0, 390.0, 100.0, 680.0, 100.0, 0.0, 170.0, 200.0, 40.0, 70.0, 410.0, 310.0, 70.0, 80.0, 60.0, 190.0, 20.0, 80.0, 30.0, 170.0, 170.0, 80.0, 30.0, 30.0, 30.0, 30.0, -70.0, 310.0, 20.0, 20.0, 110.0, 90.0, 20.0, 90.0, 30.0, 20.0, 60.0, 10.0, 100.0, 70.0, 30.0, 50.0, 0.0, 200.0, 390.0, 160.0, 80.0, 70.0, 70.0, 100.0, 170.0, 80.0, 20.0, 150.0, 100.0, 60.0, 120.0, -20.0, 30.0, 180.0, 0.0, 170.0, 70.0, 480.0, 30.0, 10.0, 20.0, -30.0, 0.0, 40.0, 10.0, 0.0, 350.0, -20.0, 70.0, 170.0, 170.0, 40.0, 60.0, 460.0, 180.0, -30.0, -10.0, 180.0, 290.0, 140.0, 80.0, 50.0, 180.0, 30.0, 30.0, 80.0, 25.0, 5.0, 320.0, 210.0, 270.0, 300.0, 100.0, 180.0, 70.0, 110.0, 80.0, 50.0, 70.0, 80.0, 60.0, 50.0, 40.0, 40.0, 30.0, 370.0, -40.0, 10.0, 410.0, -40.0, 50.0, 110.0, 80.0, 70.0, 50.0, 580.0, 100.0, 110.0, 220.0, 50.0, 80.0, 50.0, 120.0, 60.0, 160.0, 30.0, 70.0, 180.0, 190.0, 310.0, 70.0, 70.0, 40.0, 30.0, 120.0, 430.0, 0.0, -5.0, 30.0, 120.0, 170.0, 90.0, 70.0, 170.0, 80.0, 50.0, 90.0, 40.0, 130.0, 70.0, 410.0, 10.0, -30.0, 150.0, 70.0, 330.0, 10.0, 60.0, 60.0, 80.0, 120.0, 10.0, 330.0, 220.0, 120.0, 35.0, 80.0, 30.0, 0.0, 10.0, 170.0, 250.0, 80.0, 0.0, 30.0, 40.0, 10.0, 40.0, 440.0, 70.0, 40.0, 40.0, 60.0, 30.0, 100.0, 70.0, 100.0, 80.0, 80.0, 50.0, 250.0, 80.0, 260.0, 460.0, 230.0, 60.0, 40.0, 30.0, 430.0, 50.0, 120.0, 70.0, 40.0, 30.0, 30.0, 40.0, -100.0, 260.0, 230.0, 170.0, 70.0, 90.0, -170.0, 80.0, 130.0, 280.0, 120.0, 90.0, 50.0, 70.0, 110.0, 470.0, 40.0, 400.0, 50.0, 60.0, -50.0, 20.0, 190.0, 160.0, -300.0, 370.0, 190.0, 10.0, 100.0, 40.0, 210.0, 90.0, 120.0, 90.0, 190.0, 70.0, 90.0, 70.0, 50.0, 80.0, 80.0, 30.0, -35.0, 865.0, 340.0, 200.0, -70.0, 40.0, 5.0, 100.0, -25.0, 40.0, 20.0, 10.0, 170.0, 240.0, -25.0, 80.0, -20.0, 30.0, 120.0, 20.0, 10.0, 50.0, 110.0, 0.0, 40.0, 10.0, 30.0, 0.0, -110.0, 330.0, 120.0, 120.0, 290.0, 70.0, 110.0, 210.0, 530.0, 70.0, 270.0, 20.0, 40.0, 60.0, 70.0, 110.0, 40.0, 20.0, 40.0, 50.0, 80.0, 0.0, 70.0, 50.0, 340.0, 100.0, 340.0, 130.0, 130.0, 50.0, 180.0, -100.0, 30.0, 250.0, 30.0, 90.0, 120.0, 10.0, 290.0, -50.0, 90.0, 50.0, 80.0, 140.0, 30.0, 190.0, 20.0, 50.0, 30.0, 80.0, -20.0, 570.0, 50.0, 300.0, 40.0, 360.0, 40.0, 110.0, 10.0, 240.0, 20.0, 210.0, 0.0, 110.0, 30.0, 50.0, 20.0, 170.0, 90.0, 180.0, 60.0, 40.0, -20.0, 130.0, 740.0, 0.0, 30.0, 230.0, 50.0, 150.0, 20.0, 170.0, 270.0, 30.0, 150.0, 30.0, 140.0, 220.0, 520.0, 10.0, 30.0, 150.0, 60.0, 0.0, 40.0, 40.0, 30.0, 60.0, 0.0, 40.0, 20.0, 130.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 40.0, 90.0, 20.0, 40.0, 60.0, 130.0, 100.0, 0.0, 500.0, 70.0, 180.0, 20.0, 160.0, 80.0, 110.0, 100.0, 190.0, 70.0, 170.0, 40.0, 30.0, 20.0, 40.0, 460.0, 10.0, 10.0, 110.0, -10.0, 80.0, 50.0, -40.0, 10.0, 90.0, 20.0, 190.0, 80.0, 40.0, -20.0, 90.0, 100.0, 30.0, -30.0, -50.0, 340.0, 10.0, 80.0, 60.0, 30.0, 370.0, 30.0, 0.0, 230.0, 30.0, 260.0, 40.0, 560.0, 20.0, 20.0, 30.0, 10.0, -50.0, 330.0, -100.0, 310.0, 130.0, 210.0, 80.0, 50.0, 70.0, 50.0, 180.0, 40.0, 180.0, 380.0, 100.0, 50.0, 20.0, 410.0, 20.0, 290.0, 310.0, 80.0, 10.0, 60.0, 0.0, 10.0, 40.0, 90.0, 100.0, 120.0, 0.0, 0.0, 0.0, 120.0, 0.0, 50.0, 90.0, 20.0, 10.0, -5.0, 10.0, 10.0, 30.0, 170.0, 20.0, 80.0, 140.0, 50.0, 20.0, 220.0, 30.0, 20.0, 150.0, 20.0, 40.0, 70.0, 30.0, 30.0, 170.0, 20.0, 20.0, 60.0, 40.0, 190.0, 70.0, 380.0, 110.0, 30.0, 40.0, 70.0, 280.0, 70.0, 0.0, 90.0, 10.0, 50.0, 210.0, 30.0, 50.0, -5.0, 10.0, 30.0, 20.0, 110.0, 40.0, 30.0, 90.0, 0.0, 480.0, 80.0, 30.0, 130.0, 360.0, 220.0, 270.0, 0.0, 150.0, 40.0, 70.0, 120.0, -60.0, 170.0, 60.0, 490.0, 140.0, 30.0, -95.0, 120.0, 340.0, 130.0, 10.0, 10.0, 10.0, 20.0, 170.0, 70.0, 60.0, 20.0, 50.0, 60.0, 370.0, 100.0, 10.0, -40.0, 530.0, 70.0, 240.0, 0.0, 30.0, -20.0, 90.0, 40.0, 30.0, 10.0, 40.0, 0.0, 90.0, 0.0, 10.0, 110.0, 20.0, 20.0, 20.0, 40.0, 260.0, 110.0, 0.0, 30.0, 260.0, 140.0, 100.0, 60.0, -110.0, 270.0, 150.0, 10.0, 60.0, 90.0, 60.0, 820.0, 200.0, 0.0, 90.0, 130.0, 120.0, 30.0, 20.0, 20.0, 30.0, 70.0, 10.0, 180.0, 10.0, 0.0, 10.0, 80.0, 50.0, 30.0, 180.0, 20.0, 150.0, 260.0, -20.0, 70.0, 80.0, 0.0, -20.0, 350.0, 100.0, 130.0, 60.0, 40.0, 20.0, 70.0, 40.0, 160.0, 10.0, 40.0, 10.0, -15.0, 30.0, 50.0, 40.0, 10.0, 20.0, 90.0, 10.0, 70.0, 30.0, 90.0, 70.0, 20.0, 100.0, 130.0, 110.0, 160.0, 120.0, 370.0, 140.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4771075749015408, "mean_inference_ms": 1.422290314865342, "mean_action_processing_ms": 0.4202764755523381, "mean_env_wait_ms": 1.2548827880209448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013673067092895508, "StateBufferConnector_ms": 0.009976387023925781, "ViewRequirementAgentConnector_ms": 0.4058520793914795}, "num_episodes": 22, "episode_return_max": 2080.0, "episode_return_min": 165.0, "episode_return_mean": 982.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.39750003995798, "num_env_steps_trained_throughput_per_sec": 21.39750003995798, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 5640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5640000, "timers": {"training_iteration_time_ms": 185879.919, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185879.864, "sample_time_ms": 2447.181, "learn_time_ms": 183413.774, "learn_throughput": 21.809, "synch_weights_time_ms": 11.353}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "done": false, "training_iteration": 141, "trial_id": "90816_00000", "date": "2024-06-10_07-32-38", "timestamp": 1718019158, "time_this_iter_s": 186.94454288482666, "time_total_s": 26434.937053442, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b311faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26434.937053442, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 25.00188679245283, "ram_util_percent": 79.18339622641508}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1673071890466384, "cur_kl_coeff": 7.1179383436532095, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00400045371229569, "vf_loss": 7.075187400964121, "vf_explained_var": 0.0010653939617835421, "kl": Infinity, "entropy": 0.33432690603410603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1328685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "env_runners": {"episode_reward_max": 2080.0, "episode_reward_min": 270.0, "episode_reward_mean": 999.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -470.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 99.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0, 1080.0, 770.0, 360.0, 880.0, 1090.0, 1410.0, 1570.0, 540.0, 345.0, 520.0, 1250.0, 1520.0, 650.0, 1675.0, 2080.0, 950.0, 600.0, 480.0, 1320.0, 810.0, 630.0, 1450.0, 1050.0, 1590.0, 870.0, 1280.0, 980.0, 1510.0, 775.0, 1270.0, 1045.0, 690.0, 900.0, 1650.0, 880.0, 1040.0, 1460.0, 730.0, 1060.0, 1555.0, 520.0, 390.0, 1740.0, 720.0, 1290.0, 850.0, 760.0, 1700.0, 880.0, 1410.0, 1560.0, 450.0, 300.0, 1050.0, 1120.0, 800.0, 560.0, 870.0, 1200.0, 1080.0, 1670.0, 820.0, 285.0, 750.0, 580.0, 1010.0, 785.0, 890.0, 1390.0, 1325.0, 480.0, 1290.0, 420.0, 900.0, 1510.0, 710.0, 570.0, 1100.0, 435.0, 440.0, 1230.0, 940.0, 1110.0, 730.0, 865.0, 1140.0, 2000.0, 290.0, 810.0, 830.0, 1440.0, 1060.0, 270.0, 970.0, 1565.0, 1770.0, 1330.0, 1470.0, 910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 10.0, 20.0, 10.0, 60.0, 0.0, 60.0, 10.0, 90.0, 0.0, 130.0, -60.0, 510.0, 200.0, -40.0, 190.0, 70.0, 20.0, 40.0, 20.0, 20.0, 30.0, 390.0, 20.0, -25.0, 5.0, 20.0, 180.0, 70.0, 60.0, 180.0, 0.0, 110.0, 380.0, 40.0, 10.0, 0.0, -470.0, 90.0, 20.0, 70.0, 40.0, 30.0, 130.0, 30.0, 0.0, 30.0, 30.0, 510.0, 10.0, 50.0, 80.0, 270.0, 10.0, 360.0, 200.0, -150.0, -10.0, 70.0, 210.0, 40.0, 120.0, 60.0, 30.0, 110.0, 50.0, 300.0, 190.0, 70.0, 440.0, 30.0, 570.0, 110.0, 380.0, 200.0, 100.0, 20.0, 50.0, 10.0, 100.0, 40.0, 0.0, 40.0, 40.0, 160.0, 30.0, 0.0, 110.0, 0.0, 120.0, 20.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 110.0, 75.0, 40.0, 110.0, 60.0, 20.0, 0.0, 80.0, 50.0, 0.0, 90.0, 20.0, 90.0, 230.0, 260.0, 170.0, 90.0, 130.0, 60.0, 20.0, 40.0, 120.0, 130.0, 20.0, 150.0, 540.0, 10.0, 100.0, -10.0, 300.0, 60.0, 190.0, 160.0, 90.0, 130.0, -50.0, 110.0, 20.0, 40.0, 80.0, 190.0, 40.0, 0.0, 70.0, -15.0, 570.0, 20.0, 10.0, 70.0, 470.0, 20.0, 70.0, 390.0, 100.0, 680.0, 100.0, 0.0, 170.0, 200.0, 40.0, 70.0, 410.0, 310.0, 70.0, 80.0, 60.0, 190.0, 20.0, 80.0, 30.0, 170.0, 170.0, 80.0, 30.0, 30.0, 30.0, 30.0, -70.0, 310.0, 20.0, 20.0, 110.0, 90.0, 20.0, 90.0, 30.0, 20.0, 60.0, 10.0, 100.0, 70.0, 30.0, 50.0, 0.0, 200.0, 390.0, 160.0, 80.0, 70.0, 70.0, 100.0, 170.0, 80.0, 20.0, 150.0, 100.0, 60.0, 120.0, -20.0, 30.0, 180.0, 0.0, 170.0, 70.0, 480.0, 30.0, 10.0, 20.0, -30.0, 0.0, 40.0, 10.0, 0.0, 350.0, -20.0, 70.0, 170.0, 170.0, 40.0, 60.0, 460.0, 180.0, -30.0, -10.0, 180.0, 290.0, 140.0, 80.0, 50.0, 180.0, 30.0, 30.0, 80.0, 25.0, 5.0, 320.0, 210.0, 270.0, 300.0, 100.0, 180.0, 70.0, 110.0, 80.0, 50.0, 70.0, 80.0, 60.0, 50.0, 40.0, 40.0, 30.0, 370.0, -40.0, 10.0, 410.0, -40.0, 50.0, 110.0, 80.0, 70.0, 50.0, 580.0, 100.0, 110.0, 220.0, 50.0, 80.0, 50.0, 120.0, 60.0, 160.0, 30.0, 70.0, 180.0, 190.0, 310.0, 70.0, 70.0, 40.0, 30.0, 120.0, 430.0, 0.0, -5.0, 30.0, 120.0, 170.0, 90.0, 70.0, 170.0, 80.0, 50.0, 90.0, 40.0, 130.0, 70.0, 410.0, 10.0, -30.0, 150.0, 70.0, 330.0, 10.0, 60.0, 60.0, 80.0, 120.0, 10.0, 330.0, 220.0, 120.0, 35.0, 80.0, 30.0, 0.0, 10.0, 170.0, 250.0, 80.0, 0.0, 30.0, 40.0, 10.0, 40.0, 440.0, 70.0, 40.0, 40.0, 60.0, 30.0, 100.0, 70.0, 100.0, 80.0, 80.0, 50.0, 250.0, 80.0, 260.0, 460.0, 230.0, 60.0, 40.0, 30.0, 430.0, 50.0, 120.0, 70.0, 40.0, 30.0, 30.0, 40.0, -100.0, 260.0, 230.0, 170.0, 70.0, 90.0, -170.0, 80.0, 130.0, 280.0, 120.0, 90.0, 50.0, 70.0, 110.0, 470.0, 40.0, 400.0, 50.0, 60.0, -50.0, 20.0, 190.0, 160.0, -300.0, 370.0, 190.0, 10.0, 100.0, 40.0, 210.0, 90.0, 120.0, 90.0, 190.0, 70.0, 90.0, 70.0, 50.0, 80.0, 80.0, 30.0, -35.0, 865.0, 340.0, 200.0, -70.0, 40.0, 5.0, 100.0, -25.0, 40.0, 20.0, 10.0, 170.0, 240.0, -25.0, 80.0, -20.0, 30.0, 120.0, 20.0, 10.0, 50.0, 110.0, 0.0, 40.0, 10.0, 30.0, 0.0, -110.0, 330.0, 120.0, 120.0, 290.0, 70.0, 110.0, 210.0, 530.0, 70.0, 270.0, 20.0, 40.0, 60.0, 70.0, 110.0, 40.0, 20.0, 40.0, 50.0, 80.0, 0.0, 70.0, 50.0, 340.0, 100.0, 340.0, 130.0, 130.0, 50.0, 180.0, -100.0, 30.0, 250.0, 30.0, 90.0, 120.0, 10.0, 290.0, -50.0, 90.0, 50.0, 80.0, 140.0, 30.0, 190.0, 20.0, 50.0, 30.0, 80.0, -20.0, 570.0, 50.0, 300.0, 40.0, 360.0, 40.0, 110.0, 10.0, 240.0, 20.0, 210.0, 0.0, 110.0, 30.0, 50.0, 20.0, 170.0, 90.0, 180.0, 60.0, 40.0, -20.0, 130.0, 740.0, 0.0, 30.0, 230.0, 50.0, 150.0, 20.0, 170.0, 270.0, 30.0, 150.0, 30.0, 140.0, 220.0, 520.0, 10.0, 30.0, 150.0, 60.0, 0.0, 40.0, 40.0, 30.0, 60.0, 0.0, 40.0, 20.0, 130.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 40.0, 90.0, 20.0, 40.0, 60.0, 130.0, 100.0, 0.0, 500.0, 70.0, 180.0, 20.0, 160.0, 80.0, 110.0, 100.0, 190.0, 70.0, 170.0, 40.0, 30.0, 20.0, 40.0, 460.0, 10.0, 10.0, 110.0, -10.0, 80.0, 50.0, -40.0, 10.0, 90.0, 20.0, 190.0, 80.0, 40.0, -20.0, 90.0, 100.0, 30.0, -30.0, -50.0, 340.0, 10.0, 80.0, 60.0, 30.0, 370.0, 30.0, 0.0, 230.0, 30.0, 260.0, 40.0, 560.0, 20.0, 20.0, 30.0, 10.0, -50.0, 330.0, -100.0, 310.0, 130.0, 210.0, 80.0, 50.0, 70.0, 50.0, 180.0, 40.0, 180.0, 380.0, 100.0, 50.0, 20.0, 410.0, 20.0, 290.0, 310.0, 80.0, 10.0, 60.0, 0.0, 10.0, 40.0, 90.0, 100.0, 120.0, 0.0, 0.0, 0.0, 120.0, 0.0, 50.0, 90.0, 20.0, 10.0, -5.0, 10.0, 10.0, 30.0, 170.0, 20.0, 80.0, 140.0, 50.0, 20.0, 220.0, 30.0, 20.0, 150.0, 20.0, 40.0, 70.0, 30.0, 30.0, 170.0, 20.0, 20.0, 60.0, 40.0, 190.0, 70.0, 380.0, 110.0, 30.0, 40.0, 70.0, 280.0, 70.0, 0.0, 90.0, 10.0, 50.0, 210.0, 30.0, 50.0, -5.0, 10.0, 30.0, 20.0, 110.0, 40.0, 30.0, 90.0, 0.0, 480.0, 80.0, 30.0, 130.0, 360.0, 220.0, 270.0, 0.0, 150.0, 40.0, 70.0, 120.0, -60.0, 170.0, 60.0, 490.0, 140.0, 30.0, -95.0, 120.0, 340.0, 130.0, 10.0, 10.0, 10.0, 20.0, 170.0, 70.0, 60.0, 20.0, 50.0, 60.0, 370.0, 100.0, 10.0, -40.0, 530.0, 70.0, 240.0, 0.0, 30.0, -20.0, 90.0, 40.0, 30.0, 10.0, 40.0, 0.0, 90.0, 0.0, 10.0, 110.0, 20.0, 20.0, 20.0, 40.0, 260.0, 110.0, 0.0, 30.0, 260.0, 140.0, 100.0, 60.0, -110.0, 270.0, 150.0, 10.0, 60.0, 90.0, 60.0, 820.0, 200.0, 0.0, 90.0, 130.0, 120.0, 30.0, 20.0, 20.0, 30.0, 70.0, 10.0, 180.0, 10.0, 0.0, 10.0, 80.0, 50.0, 30.0, 180.0, 20.0, 150.0, 260.0, -20.0, 70.0, 80.0, 0.0, -20.0, 350.0, 100.0, 130.0, 60.0, 40.0, 20.0, 70.0, 40.0, 160.0, 10.0, 40.0, 10.0, -15.0, 30.0, 50.0, 40.0, 10.0, 20.0, 90.0, 10.0, 70.0, 30.0, 90.0, 70.0, 20.0, 100.0, 130.0, 110.0, 160.0, 120.0, 370.0, 140.0, 10.0, 50.0, 170.0, 40.0, 20.0, 30.0, 170.0, 80.0, 260.0, 100.0, 20.0, -40.0, 30.0, 110.0, 100.0, 190.0, 50.0, 200.0, 260.0, 160.0, 50.0, 5.0, -15.0, 40.0, 40.0, 450.0, 10.0, 40.0, -30.0, -20.0, 210.0, 70.0, 30.0, 30.0, -10.0, 40.0, 220.0, 180.0, 250.0, 0.0, 55.0, 50.0, 80.0, 60.0, 110.0, 290.0, -10.0, 30.0, 190.0, 290.0, 50.0, 0.0, 40.0, 630.0, 10.0, 40.0, 340.0, 510.0, 290.0, 20.0, 120.0, 10.0, 0.0, 20.0, 0.0, 50.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, -50.0, 250.0, -10.0, 40.0, 50.0, -30.0, 400.0, -10.0, 120.0, 320.0, 30.0, 110.0, 10.0, 30.0, 220.0, 50.0, 10.0, 20.0, 30.0, 60.0, 200.0, 30.0, 300.0, 190.0, 280.0, 70.0, 0.0, 40.0, 270.0, 50.0, 80.0, 100.0, 40.0, 10.0, 30.0, 180.0, 280.0, 80.0, 210.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 150.0, 50.0, 0.0, 60.0, 30.0, 10.0, 270.0, 260.0, 40.0, 170.0, 40.0, 90.0, -30.0, 485.0, 40.0, 80.0, 170.0, 90.0, 120.0, 110.0, 270.0, 230.0, 50.0, 30.0, -60.0, 180.0, 160.0, 130.0, -80.0, 40.0, 180.0, 1140.0, 80.0, 70.0, 20.0, 30.0, 90.0, 290.0, 200.0, 140.0, 380.0, 30.0, 90.0, 110.0, 280.0, 60.0, 280.0, 100.0, 110.0, 70.0, 60.0, 310.0, 150.0, 210.0, 30.0, 30.0, 10.0, 250.0, 90.0, 50.0, 60.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4766178066618552, "mean_inference_ms": 1.4226648025957889, "mean_action_processing_ms": 0.4202258376295984, "mean_env_wait_ms": 1.2552048193494791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013669013977050781, "StateBufferConnector_ms": 0.012107610702514648, "ViewRequirementAgentConnector_ms": 0.40358543395996094}, "num_episodes": 18, "episode_return_max": 2080.0, "episode_return_min": 270.0, "episode_return_mean": 999.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.361382479568476, "num_env_steps_trained_throughput_per_sec": 21.361382479568476, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 5680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5680000, "timers": {"training_iteration_time_ms": 185988.667, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185988.613, "sample_time_ms": 2412.69, "learn_time_ms": 183556.66, "learn_throughput": 21.792, "synch_weights_time_ms": 11.593}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "done": false, "training_iteration": 142, "trial_id": "90816_00000", "date": "2024-06-10_07-35-45", "timestamp": 1718019345, "time_this_iter_s": 187.26528215408325, "time_total_s": 26622.202335596085, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b311ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26622.202335596085, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 25.0588679245283, "ram_util_percent": 79.38415094339622}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0137466862623175, "cur_kl_coeff": 10.676907515479815, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003224058226703074, "vf_loss": 6.752326308322536, "vf_explained_var": -0.0008094945210364426, "kl": Infinity, "entropy": 0.3269919033121631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1338075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "env_runners": {"episode_reward_max": 2000.0, "episode_reward_min": 120.0, "episode_reward_mean": 1010.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -300.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 101.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.0, 1320.0, 810.0, 630.0, 1450.0, 1050.0, 1590.0, 870.0, 1280.0, 980.0, 1510.0, 775.0, 1270.0, 1045.0, 690.0, 900.0, 1650.0, 880.0, 1040.0, 1460.0, 730.0, 1060.0, 1555.0, 520.0, 390.0, 1740.0, 720.0, 1290.0, 850.0, 760.0, 1700.0, 880.0, 1410.0, 1560.0, 450.0, 300.0, 1050.0, 1120.0, 800.0, 560.0, 870.0, 1200.0, 1080.0, 1670.0, 820.0, 285.0, 750.0, 580.0, 1010.0, 785.0, 890.0, 1390.0, 1325.0, 480.0, 1290.0, 420.0, 900.0, 1510.0, 710.0, 570.0, 1100.0, 435.0, 440.0, 1230.0, 940.0, 1110.0, 730.0, 865.0, 1140.0, 2000.0, 290.0, 810.0, 830.0, 1440.0, 1060.0, 270.0, 970.0, 1565.0, 1770.0, 1330.0, 1470.0, 910.0, 120.0, 560.0, 1030.0, 1125.0, 330.0, 1390.0, 1530.0, 1370.0, 930.0, 1380.0, 1010.0, 900.0, 1770.0, 1340.0, 865.0, 1130.0, 765.0, 1110.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 90.0, 30.0, 20.0, 60.0, 10.0, 100.0, 70.0, 30.0, 50.0, 0.0, 200.0, 390.0, 160.0, 80.0, 70.0, 70.0, 100.0, 170.0, 80.0, 20.0, 150.0, 100.0, 60.0, 120.0, -20.0, 30.0, 180.0, 0.0, 170.0, 70.0, 480.0, 30.0, 10.0, 20.0, -30.0, 0.0, 40.0, 10.0, 0.0, 350.0, -20.0, 70.0, 170.0, 170.0, 40.0, 60.0, 460.0, 180.0, -30.0, -10.0, 180.0, 290.0, 140.0, 80.0, 50.0, 180.0, 30.0, 30.0, 80.0, 25.0, 5.0, 320.0, 210.0, 270.0, 300.0, 100.0, 180.0, 70.0, 110.0, 80.0, 50.0, 70.0, 80.0, 60.0, 50.0, 40.0, 40.0, 30.0, 370.0, -40.0, 10.0, 410.0, -40.0, 50.0, 110.0, 80.0, 70.0, 50.0, 580.0, 100.0, 110.0, 220.0, 50.0, 80.0, 50.0, 120.0, 60.0, 160.0, 30.0, 70.0, 180.0, 190.0, 310.0, 70.0, 70.0, 40.0, 30.0, 120.0, 430.0, 0.0, -5.0, 30.0, 120.0, 170.0, 90.0, 70.0, 170.0, 80.0, 50.0, 90.0, 40.0, 130.0, 70.0, 410.0, 10.0, -30.0, 150.0, 70.0, 330.0, 10.0, 60.0, 60.0, 80.0, 120.0, 10.0, 330.0, 220.0, 120.0, 35.0, 80.0, 30.0, 0.0, 10.0, 170.0, 250.0, 80.0, 0.0, 30.0, 40.0, 10.0, 40.0, 440.0, 70.0, 40.0, 40.0, 60.0, 30.0, 100.0, 70.0, 100.0, 80.0, 80.0, 50.0, 250.0, 80.0, 260.0, 460.0, 230.0, 60.0, 40.0, 30.0, 430.0, 50.0, 120.0, 70.0, 40.0, 30.0, 30.0, 40.0, -100.0, 260.0, 230.0, 170.0, 70.0, 90.0, -170.0, 80.0, 130.0, 280.0, 120.0, 90.0, 50.0, 70.0, 110.0, 470.0, 40.0, 400.0, 50.0, 60.0, -50.0, 20.0, 190.0, 160.0, -300.0, 370.0, 190.0, 10.0, 100.0, 40.0, 210.0, 90.0, 120.0, 90.0, 190.0, 70.0, 90.0, 70.0, 50.0, 80.0, 80.0, 30.0, -35.0, 865.0, 340.0, 200.0, -70.0, 40.0, 5.0, 100.0, -25.0, 40.0, 20.0, 10.0, 170.0, 240.0, -25.0, 80.0, -20.0, 30.0, 120.0, 20.0, 10.0, 50.0, 110.0, 0.0, 40.0, 10.0, 30.0, 0.0, -110.0, 330.0, 120.0, 120.0, 290.0, 70.0, 110.0, 210.0, 530.0, 70.0, 270.0, 20.0, 40.0, 60.0, 70.0, 110.0, 40.0, 20.0, 40.0, 50.0, 80.0, 0.0, 70.0, 50.0, 340.0, 100.0, 340.0, 130.0, 130.0, 50.0, 180.0, -100.0, 30.0, 250.0, 30.0, 90.0, 120.0, 10.0, 290.0, -50.0, 90.0, 50.0, 80.0, 140.0, 30.0, 190.0, 20.0, 50.0, 30.0, 80.0, -20.0, 570.0, 50.0, 300.0, 40.0, 360.0, 40.0, 110.0, 10.0, 240.0, 20.0, 210.0, 0.0, 110.0, 30.0, 50.0, 20.0, 170.0, 90.0, 180.0, 60.0, 40.0, -20.0, 130.0, 740.0, 0.0, 30.0, 230.0, 50.0, 150.0, 20.0, 170.0, 270.0, 30.0, 150.0, 30.0, 140.0, 220.0, 520.0, 10.0, 30.0, 150.0, 60.0, 0.0, 40.0, 40.0, 30.0, 60.0, 0.0, 40.0, 20.0, 130.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 40.0, 90.0, 20.0, 40.0, 60.0, 130.0, 100.0, 0.0, 500.0, 70.0, 180.0, 20.0, 160.0, 80.0, 110.0, 100.0, 190.0, 70.0, 170.0, 40.0, 30.0, 20.0, 40.0, 460.0, 10.0, 10.0, 110.0, -10.0, 80.0, 50.0, -40.0, 10.0, 90.0, 20.0, 190.0, 80.0, 40.0, -20.0, 90.0, 100.0, 30.0, -30.0, -50.0, 340.0, 10.0, 80.0, 60.0, 30.0, 370.0, 30.0, 0.0, 230.0, 30.0, 260.0, 40.0, 560.0, 20.0, 20.0, 30.0, 10.0, -50.0, 330.0, -100.0, 310.0, 130.0, 210.0, 80.0, 50.0, 70.0, 50.0, 180.0, 40.0, 180.0, 380.0, 100.0, 50.0, 20.0, 410.0, 20.0, 290.0, 310.0, 80.0, 10.0, 60.0, 0.0, 10.0, 40.0, 90.0, 100.0, 120.0, 0.0, 0.0, 0.0, 120.0, 0.0, 50.0, 90.0, 20.0, 10.0, -5.0, 10.0, 10.0, 30.0, 170.0, 20.0, 80.0, 140.0, 50.0, 20.0, 220.0, 30.0, 20.0, 150.0, 20.0, 40.0, 70.0, 30.0, 30.0, 170.0, 20.0, 20.0, 60.0, 40.0, 190.0, 70.0, 380.0, 110.0, 30.0, 40.0, 70.0, 280.0, 70.0, 0.0, 90.0, 10.0, 50.0, 210.0, 30.0, 50.0, -5.0, 10.0, 30.0, 20.0, 110.0, 40.0, 30.0, 90.0, 0.0, 480.0, 80.0, 30.0, 130.0, 360.0, 220.0, 270.0, 0.0, 150.0, 40.0, 70.0, 120.0, -60.0, 170.0, 60.0, 490.0, 140.0, 30.0, -95.0, 120.0, 340.0, 130.0, 10.0, 10.0, 10.0, 20.0, 170.0, 70.0, 60.0, 20.0, 50.0, 60.0, 370.0, 100.0, 10.0, -40.0, 530.0, 70.0, 240.0, 0.0, 30.0, -20.0, 90.0, 40.0, 30.0, 10.0, 40.0, 0.0, 90.0, 0.0, 10.0, 110.0, 20.0, 20.0, 20.0, 40.0, 260.0, 110.0, 0.0, 30.0, 260.0, 140.0, 100.0, 60.0, -110.0, 270.0, 150.0, 10.0, 60.0, 90.0, 60.0, 820.0, 200.0, 0.0, 90.0, 130.0, 120.0, 30.0, 20.0, 20.0, 30.0, 70.0, 10.0, 180.0, 10.0, 0.0, 10.0, 80.0, 50.0, 30.0, 180.0, 20.0, 150.0, 260.0, -20.0, 70.0, 80.0, 0.0, -20.0, 350.0, 100.0, 130.0, 60.0, 40.0, 20.0, 70.0, 40.0, 160.0, 10.0, 40.0, 10.0, -15.0, 30.0, 50.0, 40.0, 10.0, 20.0, 90.0, 10.0, 70.0, 30.0, 90.0, 70.0, 20.0, 100.0, 130.0, 110.0, 160.0, 120.0, 370.0, 140.0, 10.0, 50.0, 170.0, 40.0, 20.0, 30.0, 170.0, 80.0, 260.0, 100.0, 20.0, -40.0, 30.0, 110.0, 100.0, 190.0, 50.0, 200.0, 260.0, 160.0, 50.0, 5.0, -15.0, 40.0, 40.0, 450.0, 10.0, 40.0, -30.0, -20.0, 210.0, 70.0, 30.0, 30.0, -10.0, 40.0, 220.0, 180.0, 250.0, 0.0, 55.0, 50.0, 80.0, 60.0, 110.0, 290.0, -10.0, 30.0, 190.0, 290.0, 50.0, 0.0, 40.0, 630.0, 10.0, 40.0, 340.0, 510.0, 290.0, 20.0, 120.0, 10.0, 0.0, 20.0, 0.0, 50.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, -50.0, 250.0, -10.0, 40.0, 50.0, -30.0, 400.0, -10.0, 120.0, 320.0, 30.0, 110.0, 10.0, 30.0, 220.0, 50.0, 10.0, 20.0, 30.0, 60.0, 200.0, 30.0, 300.0, 190.0, 280.0, 70.0, 0.0, 40.0, 270.0, 50.0, 80.0, 100.0, 40.0, 10.0, 30.0, 180.0, 280.0, 80.0, 210.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 150.0, 50.0, 0.0, 60.0, 30.0, 10.0, 270.0, 260.0, 40.0, 170.0, 40.0, 90.0, -30.0, 485.0, 40.0, 80.0, 170.0, 90.0, 120.0, 110.0, 270.0, 230.0, 50.0, 30.0, -60.0, 180.0, 160.0, 130.0, -80.0, 40.0, 180.0, 1140.0, 80.0, 70.0, 20.0, 30.0, 90.0, 290.0, 200.0, 140.0, 380.0, 30.0, 90.0, 110.0, 280.0, 60.0, 280.0, 100.0, 110.0, 70.0, 60.0, 310.0, 150.0, 210.0, 30.0, 30.0, 10.0, 250.0, 90.0, 50.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 120.0, 140.0, 30.0, -30.0, 110.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 420.0, 20.0, -30.0, 70.0, 40.0, 20.0, 80.0, 60.0, 320.0, 20.0, 20.0, 0.0, 110.0, 240.0, 650.0, 25.0, 0.0, 20.0, 40.0, 140.0, 30.0, 10.0, -30.0, 10.0, 0.0, 30.0, 40.0, 100.0, 0.0, 30.0, 280.0, 40.0, 20.0, 350.0, 120.0, 50.0, 270.0, 200.0, 30.0, 90.0, 80.0, 150.0, 150.0, 20.0, 360.0, 190.0, 30.0, 150.0, 310.0, 280.0, 70.0, 420.0, 90.0, 70.0, 80.0, 50.0, 220.0, 70.0, 20.0, 190.0, 30.0, 100.0, 40.0, 160.0, 20.0, 60.0, 20.0, 90.0, 220.0, 320.0, 40.0, 50.0, 90.0, 70.0, 30.0, 30.0, 100.0, 0.0, 650.0, 180.0, 20.0, 20.0, 20.0, 140.0, 40.0, 330.0, -20.0, 30.0, 250.0, 310.0, 210.0, 80.0, 50.0, 80.0, 140.0, 30.0, -50.0, 10.0, 40.0, 460.0, 30.0, 20.0, 460.0, 240.0, 50.0, 180.0, 120.0, 150.0, 60.0, 70.0, 400.0, 370.0, 10.0, 10.0, 90.0, 0.0, 70.0, 50.0, 270.0, 150.0, 50.0, 40.0, 30.0, 70.0, 380.0, 50.0, 30.0, 65.0, 0.0, 150.0, 200.0, 60.0, 110.0, 80.0, 90.0, 80.0, 140.0, 70.0, 150.0, 70.0, 250.0, 90.0, 0.0, 50.0, 30.0, -20.0, 15.0, 90.0, 190.0, 50.0, 70.0, 150.0, 270.0, -30.0, 150.0, 150.0, 130.0, 40.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4758844518565895, "mean_inference_ms": 1.4226225243587587, "mean_action_processing_ms": 0.42051224819017113, "mean_env_wait_ms": 1.2551781079328528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013583183288574219, "StateBufferConnector_ms": 0.012286663055419922, "ViewRequirementAgentConnector_ms": 0.3928225040435791}, "num_episodes": 18, "episode_return_max": 2000.0, "episode_return_min": 120.0, "episode_return_mean": 1010.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.30249470332802, "num_env_steps_trained_throughput_per_sec": 21.30249470332802, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 5720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5720000, "timers": {"training_iteration_time_ms": 186148.667, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186148.613, "sample_time_ms": 2440.483, "learn_time_ms": 183688.972, "learn_throughput": 21.776, "synch_weights_time_ms": 11.559}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "done": false, "training_iteration": 143, "trial_id": "90816_00000", "date": "2024-06-10_07-38-53", "timestamp": 1718019533, "time_this_iter_s": 187.78000831604004, "time_total_s": 26809.982343912125, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2617940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26809.982343912125, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 25.2188679245283, "ram_util_percent": 79.67207547169811}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.820805616354663, "cur_kl_coeff": 16.01536127321972, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0027828749805327833, "vf_loss": 6.146841520801012, "vf_explained_var": 0.0008219709982887244, "kl": Infinity, "entropy": 0.3543953835503997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1347465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "env_runners": {"episode_reward_max": 2000.0, "episode_reward_min": -50.0, "episode_reward_mean": 941.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 94.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0, 390.0, 1740.0, 720.0, 1290.0, 850.0, 760.0, 1700.0, 880.0, 1410.0, 1560.0, 450.0, 300.0, 1050.0, 1120.0, 800.0, 560.0, 870.0, 1200.0, 1080.0, 1670.0, 820.0, 285.0, 750.0, 580.0, 1010.0, 785.0, 890.0, 1390.0, 1325.0, 480.0, 1290.0, 420.0, 900.0, 1510.0, 710.0, 570.0, 1100.0, 435.0, 440.0, 1230.0, 940.0, 1110.0, 730.0, 865.0, 1140.0, 2000.0, 290.0, 810.0, 830.0, 1440.0, 1060.0, 270.0, 970.0, 1565.0, 1770.0, 1330.0, 1470.0, 910.0, 120.0, 560.0, 1030.0, 1125.0, 330.0, 1390.0, 1530.0, 1370.0, 930.0, 1380.0, 1010.0, 900.0, 1770.0, 1340.0, 865.0, 1130.0, 765.0, 1110.0, 860.0, 130.0, 690.0, 920.0, 890.0, 1115.0, 970.0, -50.0, 260.0, 560.0, 660.0, 650.0, 1000.0, 1360.0, 1120.0, 1100.0, 180.0, 655.0, 1120.0, 1180.0, 800.0, 990.0, 945.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-25.0, 40.0, 20.0, 10.0, 170.0, 240.0, -25.0, 80.0, -20.0, 30.0, 120.0, 20.0, 10.0, 50.0, 110.0, 0.0, 40.0, 10.0, 30.0, 0.0, -110.0, 330.0, 120.0, 120.0, 290.0, 70.0, 110.0, 210.0, 530.0, 70.0, 270.0, 20.0, 40.0, 60.0, 70.0, 110.0, 40.0, 20.0, 40.0, 50.0, 80.0, 0.0, 70.0, 50.0, 340.0, 100.0, 340.0, 130.0, 130.0, 50.0, 180.0, -100.0, 30.0, 250.0, 30.0, 90.0, 120.0, 10.0, 290.0, -50.0, 90.0, 50.0, 80.0, 140.0, 30.0, 190.0, 20.0, 50.0, 30.0, 80.0, -20.0, 570.0, 50.0, 300.0, 40.0, 360.0, 40.0, 110.0, 10.0, 240.0, 20.0, 210.0, 0.0, 110.0, 30.0, 50.0, 20.0, 170.0, 90.0, 180.0, 60.0, 40.0, -20.0, 130.0, 740.0, 0.0, 30.0, 230.0, 50.0, 150.0, 20.0, 170.0, 270.0, 30.0, 150.0, 30.0, 140.0, 220.0, 520.0, 10.0, 30.0, 150.0, 60.0, 0.0, 40.0, 40.0, 30.0, 60.0, 0.0, 40.0, 20.0, 130.0, 20.0, 20.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 40.0, 90.0, 20.0, 40.0, 60.0, 130.0, 100.0, 0.0, 500.0, 70.0, 180.0, 20.0, 160.0, 80.0, 110.0, 100.0, 190.0, 70.0, 170.0, 40.0, 30.0, 20.0, 40.0, 460.0, 10.0, 10.0, 110.0, -10.0, 80.0, 50.0, -40.0, 10.0, 90.0, 20.0, 190.0, 80.0, 40.0, -20.0, 90.0, 100.0, 30.0, -30.0, -50.0, 340.0, 10.0, 80.0, 60.0, 30.0, 370.0, 30.0, 0.0, 230.0, 30.0, 260.0, 40.0, 560.0, 20.0, 20.0, 30.0, 10.0, -50.0, 330.0, -100.0, 310.0, 130.0, 210.0, 80.0, 50.0, 70.0, 50.0, 180.0, 40.0, 180.0, 380.0, 100.0, 50.0, 20.0, 410.0, 20.0, 290.0, 310.0, 80.0, 10.0, 60.0, 0.0, 10.0, 40.0, 90.0, 100.0, 120.0, 0.0, 0.0, 0.0, 120.0, 0.0, 50.0, 90.0, 20.0, 10.0, -5.0, 10.0, 10.0, 30.0, 170.0, 20.0, 80.0, 140.0, 50.0, 20.0, 220.0, 30.0, 20.0, 150.0, 20.0, 40.0, 70.0, 30.0, 30.0, 170.0, 20.0, 20.0, 60.0, 40.0, 190.0, 70.0, 380.0, 110.0, 30.0, 40.0, 70.0, 280.0, 70.0, 0.0, 90.0, 10.0, 50.0, 210.0, 30.0, 50.0, -5.0, 10.0, 30.0, 20.0, 110.0, 40.0, 30.0, 90.0, 0.0, 480.0, 80.0, 30.0, 130.0, 360.0, 220.0, 270.0, 0.0, 150.0, 40.0, 70.0, 120.0, -60.0, 170.0, 60.0, 490.0, 140.0, 30.0, -95.0, 120.0, 340.0, 130.0, 10.0, 10.0, 10.0, 20.0, 170.0, 70.0, 60.0, 20.0, 50.0, 60.0, 370.0, 100.0, 10.0, -40.0, 530.0, 70.0, 240.0, 0.0, 30.0, -20.0, 90.0, 40.0, 30.0, 10.0, 40.0, 0.0, 90.0, 0.0, 10.0, 110.0, 20.0, 20.0, 20.0, 40.0, 260.0, 110.0, 0.0, 30.0, 260.0, 140.0, 100.0, 60.0, -110.0, 270.0, 150.0, 10.0, 60.0, 90.0, 60.0, 820.0, 200.0, 0.0, 90.0, 130.0, 120.0, 30.0, 20.0, 20.0, 30.0, 70.0, 10.0, 180.0, 10.0, 0.0, 10.0, 80.0, 50.0, 30.0, 180.0, 20.0, 150.0, 260.0, -20.0, 70.0, 80.0, 0.0, -20.0, 350.0, 100.0, 130.0, 60.0, 40.0, 20.0, 70.0, 40.0, 160.0, 10.0, 40.0, 10.0, -15.0, 30.0, 50.0, 40.0, 10.0, 20.0, 90.0, 10.0, 70.0, 30.0, 90.0, 70.0, 20.0, 100.0, 130.0, 110.0, 160.0, 120.0, 370.0, 140.0, 10.0, 50.0, 170.0, 40.0, 20.0, 30.0, 170.0, 80.0, 260.0, 100.0, 20.0, -40.0, 30.0, 110.0, 100.0, 190.0, 50.0, 200.0, 260.0, 160.0, 50.0, 5.0, -15.0, 40.0, 40.0, 450.0, 10.0, 40.0, -30.0, -20.0, 210.0, 70.0, 30.0, 30.0, -10.0, 40.0, 220.0, 180.0, 250.0, 0.0, 55.0, 50.0, 80.0, 60.0, 110.0, 290.0, -10.0, 30.0, 190.0, 290.0, 50.0, 0.0, 40.0, 630.0, 10.0, 40.0, 340.0, 510.0, 290.0, 20.0, 120.0, 10.0, 0.0, 20.0, 0.0, 50.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, -50.0, 250.0, -10.0, 40.0, 50.0, -30.0, 400.0, -10.0, 120.0, 320.0, 30.0, 110.0, 10.0, 30.0, 220.0, 50.0, 10.0, 20.0, 30.0, 60.0, 200.0, 30.0, 300.0, 190.0, 280.0, 70.0, 0.0, 40.0, 270.0, 50.0, 80.0, 100.0, 40.0, 10.0, 30.0, 180.0, 280.0, 80.0, 210.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 150.0, 50.0, 0.0, 60.0, 30.0, 10.0, 270.0, 260.0, 40.0, 170.0, 40.0, 90.0, -30.0, 485.0, 40.0, 80.0, 170.0, 90.0, 120.0, 110.0, 270.0, 230.0, 50.0, 30.0, -60.0, 180.0, 160.0, 130.0, -80.0, 40.0, 180.0, 1140.0, 80.0, 70.0, 20.0, 30.0, 90.0, 290.0, 200.0, 140.0, 380.0, 30.0, 90.0, 110.0, 280.0, 60.0, 280.0, 100.0, 110.0, 70.0, 60.0, 310.0, 150.0, 210.0, 30.0, 30.0, 10.0, 250.0, 90.0, 50.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 120.0, 140.0, 30.0, -30.0, 110.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 420.0, 20.0, -30.0, 70.0, 40.0, 20.0, 80.0, 60.0, 320.0, 20.0, 20.0, 0.0, 110.0, 240.0, 650.0, 25.0, 0.0, 20.0, 40.0, 140.0, 30.0, 10.0, -30.0, 10.0, 0.0, 30.0, 40.0, 100.0, 0.0, 30.0, 280.0, 40.0, 20.0, 350.0, 120.0, 50.0, 270.0, 200.0, 30.0, 90.0, 80.0, 150.0, 150.0, 20.0, 360.0, 190.0, 30.0, 150.0, 310.0, 280.0, 70.0, 420.0, 90.0, 70.0, 80.0, 50.0, 220.0, 70.0, 20.0, 190.0, 30.0, 100.0, 40.0, 160.0, 20.0, 60.0, 20.0, 90.0, 220.0, 320.0, 40.0, 50.0, 90.0, 70.0, 30.0, 30.0, 100.0, 0.0, 650.0, 180.0, 20.0, 20.0, 20.0, 140.0, 40.0, 330.0, -20.0, 30.0, 250.0, 310.0, 210.0, 80.0, 50.0, 80.0, 140.0, 30.0, -50.0, 10.0, 40.0, 460.0, 30.0, 20.0, 460.0, 240.0, 50.0, 180.0, 120.0, 150.0, 60.0, 70.0, 400.0, 370.0, 10.0, 10.0, 90.0, 0.0, 70.0, 50.0, 270.0, 150.0, 50.0, 40.0, 30.0, 70.0, 380.0, 50.0, 30.0, 65.0, 0.0, 150.0, 200.0, 60.0, 110.0, 80.0, 90.0, 80.0, 140.0, 70.0, 150.0, 70.0, 250.0, 90.0, 0.0, 50.0, 30.0, -20.0, 15.0, 90.0, 190.0, 50.0, 70.0, 150.0, 270.0, -30.0, 150.0, 150.0, 130.0, 40.0, 130.0, 20.0, 70.0, 440.0, 20.0, 70.0, 60.0, 40.0, 80.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 20.0, 150.0, 0.0, 10.0, -10.0, 120.0, -20.0, 10.0, 40.0, 0.0, 390.0, -30.0, 180.0, 20.0, 180.0, -50.0, 160.0, 390.0, -100.0, 160.0, 10.0, -390.0, 80.0, 200.0, 60.0, 30.0, 760.0, -20.0, 30.0, 110.0, 30.0, 160.0, 480.0, 50.0, 350.0, 30.0, -30.0, 150.0, -10.0, 0.0, -65.0, 50.0, 90.0, 0.0, 0.0, 50.0, 170.0, 70.0, 140.0, 330.0, 70.0, 25.0, 20.0, 170.0, 0.0, 40.0, 40.0, 55.0, 90.0, 40.0, -530.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 40.0, 40.0, 10.0, 40.0, -40.0, 0.0, 80.0, 180.0, 130.0, 20.0, 80.0, 60.0, 40.0, 10.0, 40.0, 200.0, 5.0, -5.0, 160.0, 30.0, 10.0, 180.0, 0.0, 40.0, 10.0, 60.0, 40.0, 60.0, 180.0, 180.0, 40.0, 50.0, 0.0, 30.0, -70.0, -20.0, 270.0, 190.0, 90.0, 20.0, 410.0, 20.0, 10.0, 80.0, 340.0, 10.0, 30.0, 90.0, 440.0, 220.0, 120.0, 80.0, 50.0, -20.0, 70.0, 60.0, 40.0, 100.0, 320.0, 150.0, 120.0, 20.0, 180.0, 60.0, 30.0, 30.0, 130.0, 310.0, 180.0, 20.0, 50.0, 330.0, 90.0, -70.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 30.0, 40.0, 0.0, 10.0, 35.0, 40.0, 10.0, 40.0, 160.0, 60.0, 110.0, 30.0, 70.0, 100.0, 310.0, 50.0, 90.0, 150.0, 80.0, 90.0, 170.0, 60.0, 60.0, 60.0, 170.0, 50.0, 80.0, 230.0, 60.0, 100.0, 260.0, 90.0, 90.0, 50.0, 20.0, 80.0, 90.0, 40.0, 140.0, 40.0, 330.0, 20.0, 20.0, 20.0, 20.0, 40.0, 280.0, 40.0, 170.0, 150.0, 40.0, 160.0, 30.0, 60.0, 240.0, 85.0, 200.0, 30.0, 40.0, 60.0, 90.0, 20.0, 110.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.475054071521943, "mean_inference_ms": 1.4226691016609545, "mean_action_processing_ms": 0.4213589168774088, "mean_env_wait_ms": 1.2551424015911339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013546228408813477, "StateBufferConnector_ms": 0.012027740478515625, "ViewRequirementAgentConnector_ms": 0.3874318599700928}, "num_episodes": 23, "episode_return_max": 2000.0, "episode_return_min": -50.0, "episode_return_mean": 941.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.26061520156868, "num_env_steps_trained_throughput_per_sec": 21.26061520156868, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 5760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5760000, "timers": {"training_iteration_time_ms": 186399.545, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186399.491, "sample_time_ms": 2464.232, "learn_time_ms": 183916.222, "learn_throughput": 21.749, "synch_weights_time_ms": 11.325}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "done": false, "training_iteration": 144, "trial_id": "90816_00000", "date": "2024-06-10_07-42-01", "timestamp": 1718019721, "time_this_iter_s": 188.1488118171692, "time_total_s": 26998.131155729294, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b31579d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26998.131155729294, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 24.92781954887218, "ram_util_percent": 79.94060150375938}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5420071579269963, "cur_kl_coeff": 24.02304190982958, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7348004770735965, "policy_loss": -0.0021817765750102025, "vf_loss": 6.734124449698435, "vf_explained_var": 0.0012481478646921274, "kl": 0.00011896097882303239, "entropy": 0.3268588006972505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1356855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "env_runners": {"episode_reward_max": 2000.0, "episode_reward_min": -50.0, "episode_reward_mean": 919.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 91.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.0, 750.0, 580.0, 1010.0, 785.0, 890.0, 1390.0, 1325.0, 480.0, 1290.0, 420.0, 900.0, 1510.0, 710.0, 570.0, 1100.0, 435.0, 440.0, 1230.0, 940.0, 1110.0, 730.0, 865.0, 1140.0, 2000.0, 290.0, 810.0, 830.0, 1440.0, 1060.0, 270.0, 970.0, 1565.0, 1770.0, 1330.0, 1470.0, 910.0, 120.0, 560.0, 1030.0, 1125.0, 330.0, 1390.0, 1530.0, 1370.0, 930.0, 1380.0, 1010.0, 900.0, 1770.0, 1340.0, 865.0, 1130.0, 765.0, 1110.0, 860.0, 130.0, 690.0, 920.0, 890.0, 1115.0, 970.0, -50.0, 260.0, 560.0, 660.0, 650.0, 1000.0, 1360.0, 1120.0, 1100.0, 180.0, 655.0, 1120.0, 1180.0, 800.0, 990.0, 945.0, 510.0, 640.0, 1460.0, 585.0, 450.0, 940.0, 460.0, 1185.0, 1310.0, 780.0, 1410.0, 880.0, 1370.0, 640.0, 660.0, 945.0, 460.0, 760.0, 840.0, 560.0, 1170.0, 1570.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 0.0, 120.0, 0.0, 50.0, 90.0, 20.0, 10.0, -5.0, 10.0, 10.0, 30.0, 170.0, 20.0, 80.0, 140.0, 50.0, 20.0, 220.0, 30.0, 20.0, 150.0, 20.0, 40.0, 70.0, 30.0, 30.0, 170.0, 20.0, 20.0, 60.0, 40.0, 190.0, 70.0, 380.0, 110.0, 30.0, 40.0, 70.0, 280.0, 70.0, 0.0, 90.0, 10.0, 50.0, 210.0, 30.0, 50.0, -5.0, 10.0, 30.0, 20.0, 110.0, 40.0, 30.0, 90.0, 0.0, 480.0, 80.0, 30.0, 130.0, 360.0, 220.0, 270.0, 0.0, 150.0, 40.0, 70.0, 120.0, -60.0, 170.0, 60.0, 490.0, 140.0, 30.0, -95.0, 120.0, 340.0, 130.0, 10.0, 10.0, 10.0, 20.0, 170.0, 70.0, 60.0, 20.0, 50.0, 60.0, 370.0, 100.0, 10.0, -40.0, 530.0, 70.0, 240.0, 0.0, 30.0, -20.0, 90.0, 40.0, 30.0, 10.0, 40.0, 0.0, 90.0, 0.0, 10.0, 110.0, 20.0, 20.0, 20.0, 40.0, 260.0, 110.0, 0.0, 30.0, 260.0, 140.0, 100.0, 60.0, -110.0, 270.0, 150.0, 10.0, 60.0, 90.0, 60.0, 820.0, 200.0, 0.0, 90.0, 130.0, 120.0, 30.0, 20.0, 20.0, 30.0, 70.0, 10.0, 180.0, 10.0, 0.0, 10.0, 80.0, 50.0, 30.0, 180.0, 20.0, 150.0, 260.0, -20.0, 70.0, 80.0, 0.0, -20.0, 350.0, 100.0, 130.0, 60.0, 40.0, 20.0, 70.0, 40.0, 160.0, 10.0, 40.0, 10.0, -15.0, 30.0, 50.0, 40.0, 10.0, 20.0, 90.0, 10.0, 70.0, 30.0, 90.0, 70.0, 20.0, 100.0, 130.0, 110.0, 160.0, 120.0, 370.0, 140.0, 10.0, 50.0, 170.0, 40.0, 20.0, 30.0, 170.0, 80.0, 260.0, 100.0, 20.0, -40.0, 30.0, 110.0, 100.0, 190.0, 50.0, 200.0, 260.0, 160.0, 50.0, 5.0, -15.0, 40.0, 40.0, 450.0, 10.0, 40.0, -30.0, -20.0, 210.0, 70.0, 30.0, 30.0, -10.0, 40.0, 220.0, 180.0, 250.0, 0.0, 55.0, 50.0, 80.0, 60.0, 110.0, 290.0, -10.0, 30.0, 190.0, 290.0, 50.0, 0.0, 40.0, 630.0, 10.0, 40.0, 340.0, 510.0, 290.0, 20.0, 120.0, 10.0, 0.0, 20.0, 0.0, 50.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, -50.0, 250.0, -10.0, 40.0, 50.0, -30.0, 400.0, -10.0, 120.0, 320.0, 30.0, 110.0, 10.0, 30.0, 220.0, 50.0, 10.0, 20.0, 30.0, 60.0, 200.0, 30.0, 300.0, 190.0, 280.0, 70.0, 0.0, 40.0, 270.0, 50.0, 80.0, 100.0, 40.0, 10.0, 30.0, 180.0, 280.0, 80.0, 210.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 150.0, 50.0, 0.0, 60.0, 30.0, 10.0, 270.0, 260.0, 40.0, 170.0, 40.0, 90.0, -30.0, 485.0, 40.0, 80.0, 170.0, 90.0, 120.0, 110.0, 270.0, 230.0, 50.0, 30.0, -60.0, 180.0, 160.0, 130.0, -80.0, 40.0, 180.0, 1140.0, 80.0, 70.0, 20.0, 30.0, 90.0, 290.0, 200.0, 140.0, 380.0, 30.0, 90.0, 110.0, 280.0, 60.0, 280.0, 100.0, 110.0, 70.0, 60.0, 310.0, 150.0, 210.0, 30.0, 30.0, 10.0, 250.0, 90.0, 50.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 120.0, 140.0, 30.0, -30.0, 110.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 420.0, 20.0, -30.0, 70.0, 40.0, 20.0, 80.0, 60.0, 320.0, 20.0, 20.0, 0.0, 110.0, 240.0, 650.0, 25.0, 0.0, 20.0, 40.0, 140.0, 30.0, 10.0, -30.0, 10.0, 0.0, 30.0, 40.0, 100.0, 0.0, 30.0, 280.0, 40.0, 20.0, 350.0, 120.0, 50.0, 270.0, 200.0, 30.0, 90.0, 80.0, 150.0, 150.0, 20.0, 360.0, 190.0, 30.0, 150.0, 310.0, 280.0, 70.0, 420.0, 90.0, 70.0, 80.0, 50.0, 220.0, 70.0, 20.0, 190.0, 30.0, 100.0, 40.0, 160.0, 20.0, 60.0, 20.0, 90.0, 220.0, 320.0, 40.0, 50.0, 90.0, 70.0, 30.0, 30.0, 100.0, 0.0, 650.0, 180.0, 20.0, 20.0, 20.0, 140.0, 40.0, 330.0, -20.0, 30.0, 250.0, 310.0, 210.0, 80.0, 50.0, 80.0, 140.0, 30.0, -50.0, 10.0, 40.0, 460.0, 30.0, 20.0, 460.0, 240.0, 50.0, 180.0, 120.0, 150.0, 60.0, 70.0, 400.0, 370.0, 10.0, 10.0, 90.0, 0.0, 70.0, 50.0, 270.0, 150.0, 50.0, 40.0, 30.0, 70.0, 380.0, 50.0, 30.0, 65.0, 0.0, 150.0, 200.0, 60.0, 110.0, 80.0, 90.0, 80.0, 140.0, 70.0, 150.0, 70.0, 250.0, 90.0, 0.0, 50.0, 30.0, -20.0, 15.0, 90.0, 190.0, 50.0, 70.0, 150.0, 270.0, -30.0, 150.0, 150.0, 130.0, 40.0, 130.0, 20.0, 70.0, 440.0, 20.0, 70.0, 60.0, 40.0, 80.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 20.0, 150.0, 0.0, 10.0, -10.0, 120.0, -20.0, 10.0, 40.0, 0.0, 390.0, -30.0, 180.0, 20.0, 180.0, -50.0, 160.0, 390.0, -100.0, 160.0, 10.0, -390.0, 80.0, 200.0, 60.0, 30.0, 760.0, -20.0, 30.0, 110.0, 30.0, 160.0, 480.0, 50.0, 350.0, 30.0, -30.0, 150.0, -10.0, 0.0, -65.0, 50.0, 90.0, 0.0, 0.0, 50.0, 170.0, 70.0, 140.0, 330.0, 70.0, 25.0, 20.0, 170.0, 0.0, 40.0, 40.0, 55.0, 90.0, 40.0, -530.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 40.0, 40.0, 10.0, 40.0, -40.0, 0.0, 80.0, 180.0, 130.0, 20.0, 80.0, 60.0, 40.0, 10.0, 40.0, 200.0, 5.0, -5.0, 160.0, 30.0, 10.0, 180.0, 0.0, 40.0, 10.0, 60.0, 40.0, 60.0, 180.0, 180.0, 40.0, 50.0, 0.0, 30.0, -70.0, -20.0, 270.0, 190.0, 90.0, 20.0, 410.0, 20.0, 10.0, 80.0, 340.0, 10.0, 30.0, 90.0, 440.0, 220.0, 120.0, 80.0, 50.0, -20.0, 70.0, 60.0, 40.0, 100.0, 320.0, 150.0, 120.0, 20.0, 180.0, 60.0, 30.0, 30.0, 130.0, 310.0, 180.0, 20.0, 50.0, 330.0, 90.0, -70.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 30.0, 40.0, 0.0, 10.0, 35.0, 40.0, 10.0, 40.0, 160.0, 60.0, 110.0, 30.0, 70.0, 100.0, 310.0, 50.0, 90.0, 150.0, 80.0, 90.0, 170.0, 60.0, 60.0, 60.0, 170.0, 50.0, 80.0, 230.0, 60.0, 100.0, 260.0, 90.0, 90.0, 50.0, 20.0, 80.0, 90.0, 40.0, 140.0, 40.0, 330.0, 20.0, 20.0, 20.0, 20.0, 40.0, 280.0, 40.0, 170.0, 150.0, 40.0, 160.0, 30.0, 60.0, 240.0, 85.0, 200.0, 30.0, 40.0, 60.0, 90.0, 20.0, 110.0, 70.0, -20.0, 100.0, 100.0, 110.0, -10.0, -30.0, 90.0, 130.0, -40.0, 80.0, 20.0, 10.0, 200.0, 40.0, 130.0, 60.0, 60.0, 40.0, 70.0, 10.0, 20.0, 50.0, 160.0, 40.0, 90.0, 210.0, 160.0, 240.0, 460.0, 30.0, 60.0, 40.0, 30.0, 10.0, 90.0, 15.0, 40.0, 30.0, 210.0, 60.0, 30.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 170.0, 0.0, 40.0, 200.0, 220.0, 10.0, 80.0, 170.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 20.0, 40.0, 160.0, 90.0, 30.0, 30.0, 20.0, 40.0, 280.0, 10.0, 410.0, 80.0, 40.0, 5.0, 0.0, 220.0, 50.0, 90.0, 60.0, 30.0, 470.0, 10.0, -20.0, 50.0, 10.0, 220.0, 460.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 110.0, 490.0, 50.0, 0.0, 10.0, 110.0, 0.0, 60.0, 380.0, 20.0, 100.0, 130.0, 160.0, 420.0, 30.0, 120.0, 90.0, 40.0, 10.0, 0.0, 60.0, 200.0, 110.0, 180.0, 70.0, 20.0, 510.0, 170.0, 50.0, 30.0, 150.0, 180.0, 40.0, 60.0, 160.0, 80.0, 40.0, 30.0, 170.0, 20.0, 130.0, 10.0, 40.0, 90.0, 30.0, 30.0, 170.0, 50.0, 10.0, 10.0, 120.0, 10.0, 120.0, 60.0, 80.0, 130.0, 160.0, 30.0, 30.0, 90.0, 40.0, 30.0, 15.0, 120.0, 300.0, 0.0, 20.0, 20.0, 20.0, 90.0, 120.0, 0.0, 90.0, 50.0, 50.0, 80.0, 20.0, 10.0, 150.0, 80.0, 270.0, -20.0, 80.0, -90.0, 180.0, 130.0, 270.0, 80.0, 10.0, 90.0, 70.0, 80.0, 220.0, 40.0, -150.0, 30.0, 30.0, 30.0, 170.0, 20.0, 0.0, 20.0, 10.0, 80.0, 170.0, 70.0, 0.0, 60.0, 170.0, 420.0, -120.0, 150.0, 60.0, 90.0, 270.0, 80.0, -20.0, 60.0, 330.0, 190.0, 400.0, 290.0, 60.0, 80.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4754486516784342, "mean_inference_ms": 1.4241580573510737, "mean_action_processing_ms": 0.42237932812485796, "mean_env_wait_ms": 1.2556282434039951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013227701187133789, "StateBufferConnector_ms": 0.0121307373046875, "ViewRequirementAgentConnector_ms": 0.39369845390319824}, "num_episodes": 22, "episode_return_max": 2000.0, "episode_return_min": -50.0, "episode_return_mean": 919.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.376555246530682, "num_env_steps_trained_throughput_per_sec": 21.376555246530682, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 5800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5800000, "timers": {"training_iteration_time_ms": 186612.115, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186612.06, "sample_time_ms": 2458.537, "learn_time_ms": 184134.354, "learn_throughput": 21.723, "synch_weights_time_ms": 11.329}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "done": false, "training_iteration": 145, "trial_id": "90816_00000", "date": "2024-06-10_07-45-08", "timestamp": 1718019908, "time_this_iter_s": 187.13365292549133, "time_total_s": 27185.264808654785, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00459d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27185.264808654785, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 24.979622641509437, "ram_util_percent": 79.71773584905661}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1805990479307304, "cur_kl_coeff": 12.01152095491479, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.709449685191194, "policy_loss": -0.003566402886871197, "vf_loss": 6.709925849902363, "vf_explained_var": -0.00024422317648086303, "kl": 0.000257272889150776, "entropy": 0.3378739292708576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1366245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "env_runners": {"episode_reward_max": 2000.0, "episode_reward_min": -50.0, "episode_reward_mean": 952.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 95.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1230.0, 940.0, 1110.0, 730.0, 865.0, 1140.0, 2000.0, 290.0, 810.0, 830.0, 1440.0, 1060.0, 270.0, 970.0, 1565.0, 1770.0, 1330.0, 1470.0, 910.0, 120.0, 560.0, 1030.0, 1125.0, 330.0, 1390.0, 1530.0, 1370.0, 930.0, 1380.0, 1010.0, 900.0, 1770.0, 1340.0, 865.0, 1130.0, 765.0, 1110.0, 860.0, 130.0, 690.0, 920.0, 890.0, 1115.0, 970.0, -50.0, 260.0, 560.0, 660.0, 650.0, 1000.0, 1360.0, 1120.0, 1100.0, 180.0, 655.0, 1120.0, 1180.0, 800.0, 990.0, 945.0, 510.0, 640.0, 1460.0, 585.0, 450.0, 940.0, 460.0, 1185.0, 1310.0, 780.0, 1410.0, 880.0, 1370.0, 640.0, 660.0, 945.0, 460.0, 760.0, 840.0, 560.0, 1170.0, 1570.0, 830.0, 1220.0, 825.0, 1240.0, 1360.0, 1110.0, 1060.0, 1320.0, 440.0, 1220.0, 550.0, 760.0, 1310.0, 600.0, 1100.0, 660.0, 1340.0, 1205.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 20.0, 100.0, 130.0, 110.0, 160.0, 120.0, 370.0, 140.0, 10.0, 50.0, 170.0, 40.0, 20.0, 30.0, 170.0, 80.0, 260.0, 100.0, 20.0, -40.0, 30.0, 110.0, 100.0, 190.0, 50.0, 200.0, 260.0, 160.0, 50.0, 5.0, -15.0, 40.0, 40.0, 450.0, 10.0, 40.0, -30.0, -20.0, 210.0, 70.0, 30.0, 30.0, -10.0, 40.0, 220.0, 180.0, 250.0, 0.0, 55.0, 50.0, 80.0, 60.0, 110.0, 290.0, -10.0, 30.0, 190.0, 290.0, 50.0, 0.0, 40.0, 630.0, 10.0, 40.0, 340.0, 510.0, 290.0, 20.0, 120.0, 10.0, 0.0, 20.0, 0.0, 50.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, -50.0, 250.0, -10.0, 40.0, 50.0, -30.0, 400.0, -10.0, 120.0, 320.0, 30.0, 110.0, 10.0, 30.0, 220.0, 50.0, 10.0, 20.0, 30.0, 60.0, 200.0, 30.0, 300.0, 190.0, 280.0, 70.0, 0.0, 40.0, 270.0, 50.0, 80.0, 100.0, 40.0, 10.0, 30.0, 180.0, 280.0, 80.0, 210.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 150.0, 50.0, 0.0, 60.0, 30.0, 10.0, 270.0, 260.0, 40.0, 170.0, 40.0, 90.0, -30.0, 485.0, 40.0, 80.0, 170.0, 90.0, 120.0, 110.0, 270.0, 230.0, 50.0, 30.0, -60.0, 180.0, 160.0, 130.0, -80.0, 40.0, 180.0, 1140.0, 80.0, 70.0, 20.0, 30.0, 90.0, 290.0, 200.0, 140.0, 380.0, 30.0, 90.0, 110.0, 280.0, 60.0, 280.0, 100.0, 110.0, 70.0, 60.0, 310.0, 150.0, 210.0, 30.0, 30.0, 10.0, 250.0, 90.0, 50.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 120.0, 140.0, 30.0, -30.0, 110.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 420.0, 20.0, -30.0, 70.0, 40.0, 20.0, 80.0, 60.0, 320.0, 20.0, 20.0, 0.0, 110.0, 240.0, 650.0, 25.0, 0.0, 20.0, 40.0, 140.0, 30.0, 10.0, -30.0, 10.0, 0.0, 30.0, 40.0, 100.0, 0.0, 30.0, 280.0, 40.0, 20.0, 350.0, 120.0, 50.0, 270.0, 200.0, 30.0, 90.0, 80.0, 150.0, 150.0, 20.0, 360.0, 190.0, 30.0, 150.0, 310.0, 280.0, 70.0, 420.0, 90.0, 70.0, 80.0, 50.0, 220.0, 70.0, 20.0, 190.0, 30.0, 100.0, 40.0, 160.0, 20.0, 60.0, 20.0, 90.0, 220.0, 320.0, 40.0, 50.0, 90.0, 70.0, 30.0, 30.0, 100.0, 0.0, 650.0, 180.0, 20.0, 20.0, 20.0, 140.0, 40.0, 330.0, -20.0, 30.0, 250.0, 310.0, 210.0, 80.0, 50.0, 80.0, 140.0, 30.0, -50.0, 10.0, 40.0, 460.0, 30.0, 20.0, 460.0, 240.0, 50.0, 180.0, 120.0, 150.0, 60.0, 70.0, 400.0, 370.0, 10.0, 10.0, 90.0, 0.0, 70.0, 50.0, 270.0, 150.0, 50.0, 40.0, 30.0, 70.0, 380.0, 50.0, 30.0, 65.0, 0.0, 150.0, 200.0, 60.0, 110.0, 80.0, 90.0, 80.0, 140.0, 70.0, 150.0, 70.0, 250.0, 90.0, 0.0, 50.0, 30.0, -20.0, 15.0, 90.0, 190.0, 50.0, 70.0, 150.0, 270.0, -30.0, 150.0, 150.0, 130.0, 40.0, 130.0, 20.0, 70.0, 440.0, 20.0, 70.0, 60.0, 40.0, 80.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 20.0, 150.0, 0.0, 10.0, -10.0, 120.0, -20.0, 10.0, 40.0, 0.0, 390.0, -30.0, 180.0, 20.0, 180.0, -50.0, 160.0, 390.0, -100.0, 160.0, 10.0, -390.0, 80.0, 200.0, 60.0, 30.0, 760.0, -20.0, 30.0, 110.0, 30.0, 160.0, 480.0, 50.0, 350.0, 30.0, -30.0, 150.0, -10.0, 0.0, -65.0, 50.0, 90.0, 0.0, 0.0, 50.0, 170.0, 70.0, 140.0, 330.0, 70.0, 25.0, 20.0, 170.0, 0.0, 40.0, 40.0, 55.0, 90.0, 40.0, -530.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 40.0, 40.0, 10.0, 40.0, -40.0, 0.0, 80.0, 180.0, 130.0, 20.0, 80.0, 60.0, 40.0, 10.0, 40.0, 200.0, 5.0, -5.0, 160.0, 30.0, 10.0, 180.0, 0.0, 40.0, 10.0, 60.0, 40.0, 60.0, 180.0, 180.0, 40.0, 50.0, 0.0, 30.0, -70.0, -20.0, 270.0, 190.0, 90.0, 20.0, 410.0, 20.0, 10.0, 80.0, 340.0, 10.0, 30.0, 90.0, 440.0, 220.0, 120.0, 80.0, 50.0, -20.0, 70.0, 60.0, 40.0, 100.0, 320.0, 150.0, 120.0, 20.0, 180.0, 60.0, 30.0, 30.0, 130.0, 310.0, 180.0, 20.0, 50.0, 330.0, 90.0, -70.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 30.0, 40.0, 0.0, 10.0, 35.0, 40.0, 10.0, 40.0, 160.0, 60.0, 110.0, 30.0, 70.0, 100.0, 310.0, 50.0, 90.0, 150.0, 80.0, 90.0, 170.0, 60.0, 60.0, 60.0, 170.0, 50.0, 80.0, 230.0, 60.0, 100.0, 260.0, 90.0, 90.0, 50.0, 20.0, 80.0, 90.0, 40.0, 140.0, 40.0, 330.0, 20.0, 20.0, 20.0, 20.0, 40.0, 280.0, 40.0, 170.0, 150.0, 40.0, 160.0, 30.0, 60.0, 240.0, 85.0, 200.0, 30.0, 40.0, 60.0, 90.0, 20.0, 110.0, 70.0, -20.0, 100.0, 100.0, 110.0, -10.0, -30.0, 90.0, 130.0, -40.0, 80.0, 20.0, 10.0, 200.0, 40.0, 130.0, 60.0, 60.0, 40.0, 70.0, 10.0, 20.0, 50.0, 160.0, 40.0, 90.0, 210.0, 160.0, 240.0, 460.0, 30.0, 60.0, 40.0, 30.0, 10.0, 90.0, 15.0, 40.0, 30.0, 210.0, 60.0, 30.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 170.0, 0.0, 40.0, 200.0, 220.0, 10.0, 80.0, 170.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 20.0, 40.0, 160.0, 90.0, 30.0, 30.0, 20.0, 40.0, 280.0, 10.0, 410.0, 80.0, 40.0, 5.0, 0.0, 220.0, 50.0, 90.0, 60.0, 30.0, 470.0, 10.0, -20.0, 50.0, 10.0, 220.0, 460.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 110.0, 490.0, 50.0, 0.0, 10.0, 110.0, 0.0, 60.0, 380.0, 20.0, 100.0, 130.0, 160.0, 420.0, 30.0, 120.0, 90.0, 40.0, 10.0, 0.0, 60.0, 200.0, 110.0, 180.0, 70.0, 20.0, 510.0, 170.0, 50.0, 30.0, 150.0, 180.0, 40.0, 60.0, 160.0, 80.0, 40.0, 30.0, 170.0, 20.0, 130.0, 10.0, 40.0, 90.0, 30.0, 30.0, 170.0, 50.0, 10.0, 10.0, 120.0, 10.0, 120.0, 60.0, 80.0, 130.0, 160.0, 30.0, 30.0, 90.0, 40.0, 30.0, 15.0, 120.0, 300.0, 0.0, 20.0, 20.0, 20.0, 90.0, 120.0, 0.0, 90.0, 50.0, 50.0, 80.0, 20.0, 10.0, 150.0, 80.0, 270.0, -20.0, 80.0, -90.0, 180.0, 130.0, 270.0, 80.0, 10.0, 90.0, 70.0, 80.0, 220.0, 40.0, -150.0, 30.0, 30.0, 30.0, 170.0, 20.0, 0.0, 20.0, 10.0, 80.0, 170.0, 70.0, 0.0, 60.0, 170.0, 420.0, -120.0, 150.0, 60.0, 90.0, 270.0, 80.0, -20.0, 60.0, 330.0, 190.0, 400.0, 290.0, 60.0, 80.0, 100.0, 80.0, 10.0, 40.0, 300.0, 180.0, 180.0, 10.0, 0.0, 30.0, 0.0, 70.0, 0.0, 80.0, 500.0, 160.0, 50.0, 0.0, 130.0, 210.0, 20.0, 30.0, 250.0, 330.0, 10.0, 5.0, 0.0, 100.0, 20.0, 50.0, 30.0, 20.0, 240.0, 80.0, 90.0, 150.0, 90.0, 90.0, 110.0, 90.0, 280.0, 80.0, 20.0, 70.0, 180.0, 70.0, 70.0, 80.0, 510.0, 300.0, -20.0, 50.0, 10.0, 280.0, 360.0, 0.0, -10.0, 70.0, 240.0, 0.0, 110.0, 10.0, 70.0, 700.0, 40.0, 70.0, 20.0, -20.0, 80.0, 120.0, -30.0, 250.0, 100.0, 60.0, 70.0, 50.0, 360.0, 250.0, 130.0, -40.0, 90.0, 100.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 30.0, 110.0, 50.0, 40.0, 10.0, -50.0, 140.0, 150.0, 190.0, 290.0, 360.0, 80.0, 10.0, 10.0, 30.0, 80.0, 20.0, 100.0, 60.0, 0.0, 40.0, 50.0, 160.0, 260.0, 40.0, 20.0, 30.0, 200.0, 0.0, 40.0, 80.0, 60.0, 30.0, 310.0, 10.0, 260.0, 60.0, 210.0, 70.0, 70.0, 0.0, 300.0, 20.0, 0.0, 150.0, -20.0, 70.0, 170.0, 70.0, 30.0, 60.0, 70.0, 0.0, 290.0, 160.0, 0.0, 310.0, 100.0, 60.0, 20.0, 90.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 0.0, 220.0, 200.0, 0.0, 30.0, 100.0, 270.0, 10.0, 60.0, -100.0, 120.0, 690.0, 10.0, 30.0, 70.0, 180.0, 0.0, 240.0, 260.0, 100.0, 495.0, 70.0, 50.0, 50.0, 60.0, -120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4732925100499688, "mean_inference_ms": 1.4226979491331448, "mean_action_processing_ms": 0.4228704050088302, "mean_env_wait_ms": 1.2551277995830141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012134552001953125, "StateBufferConnector_ms": 0.011836528778076172, "ViewRequirementAgentConnector_ms": 0.3842048645019531}, "num_episodes": 18, "episode_return_max": 2000.0, "episode_return_min": -50.0, "episode_return_mean": 952.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.351445404311864, "num_env_steps_trained_throughput_per_sec": 21.351445404311864, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 5840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5840000, "timers": {"training_iteration_time_ms": 186906.394, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186906.34, "sample_time_ms": 2462.737, "learn_time_ms": 184423.532, "learn_throughput": 21.689, "synch_weights_time_ms": 11.587}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "done": false, "training_iteration": 146, "trial_id": "90816_00000", "date": "2024-06-10_07-48-16", "timestamp": 1718020096, "time_this_iter_s": 187.34991908073425, "time_total_s": 27372.61472773552, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b310fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27372.61472773552, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 25.93622641509434, "ram_util_percent": 79.42075471698114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.42135865071965, "cur_kl_coeff": 6.005760477457395, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7724901507583795, "policy_loss": -0.003835324153871423, "vf_loss": 6.7736502849001985, "vf_explained_var": 4.06499170520689e-05, "kl": 0.00044543754450927537, "entropy": 0.31477208783546573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1375635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "env_runners": {"episode_reward_max": 1770.0, "episode_reward_min": -50.0, "episode_reward_mean": 919.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 91.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [910.0, 120.0, 560.0, 1030.0, 1125.0, 330.0, 1390.0, 1530.0, 1370.0, 930.0, 1380.0, 1010.0, 900.0, 1770.0, 1340.0, 865.0, 1130.0, 765.0, 1110.0, 860.0, 130.0, 690.0, 920.0, 890.0, 1115.0, 970.0, -50.0, 260.0, 560.0, 660.0, 650.0, 1000.0, 1360.0, 1120.0, 1100.0, 180.0, 655.0, 1120.0, 1180.0, 800.0, 990.0, 945.0, 510.0, 640.0, 1460.0, 585.0, 450.0, 940.0, 460.0, 1185.0, 1310.0, 780.0, 1410.0, 880.0, 1370.0, 640.0, 660.0, 945.0, 460.0, 760.0, 840.0, 560.0, 1170.0, 1570.0, 830.0, 1220.0, 825.0, 1240.0, 1360.0, 1110.0, 1060.0, 1320.0, 440.0, 1220.0, 550.0, 760.0, 1310.0, 600.0, 1100.0, 660.0, 1340.0, 1205.0, 925.0, 910.0, 1000.0, 1180.0, 790.0, 1355.0, 870.0, 465.0, 1230.0, 1000.0, 880.0, 1120.0, 1425.0, 650.0, 1180.0, 690.0, 210.0, 630.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 210.0, 30.0, 30.0, 10.0, 250.0, 90.0, 50.0, 60.0, 30.0, 30.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 120.0, 140.0, 30.0, -30.0, 110.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 420.0, 20.0, -30.0, 70.0, 40.0, 20.0, 80.0, 60.0, 320.0, 20.0, 20.0, 0.0, 110.0, 240.0, 650.0, 25.0, 0.0, 20.0, 40.0, 140.0, 30.0, 10.0, -30.0, 10.0, 0.0, 30.0, 40.0, 100.0, 0.0, 30.0, 280.0, 40.0, 20.0, 350.0, 120.0, 50.0, 270.0, 200.0, 30.0, 90.0, 80.0, 150.0, 150.0, 20.0, 360.0, 190.0, 30.0, 150.0, 310.0, 280.0, 70.0, 420.0, 90.0, 70.0, 80.0, 50.0, 220.0, 70.0, 20.0, 190.0, 30.0, 100.0, 40.0, 160.0, 20.0, 60.0, 20.0, 90.0, 220.0, 320.0, 40.0, 50.0, 90.0, 70.0, 30.0, 30.0, 100.0, 0.0, 650.0, 180.0, 20.0, 20.0, 20.0, 140.0, 40.0, 330.0, -20.0, 30.0, 250.0, 310.0, 210.0, 80.0, 50.0, 80.0, 140.0, 30.0, -50.0, 10.0, 40.0, 460.0, 30.0, 20.0, 460.0, 240.0, 50.0, 180.0, 120.0, 150.0, 60.0, 70.0, 400.0, 370.0, 10.0, 10.0, 90.0, 0.0, 70.0, 50.0, 270.0, 150.0, 50.0, 40.0, 30.0, 70.0, 380.0, 50.0, 30.0, 65.0, 0.0, 150.0, 200.0, 60.0, 110.0, 80.0, 90.0, 80.0, 140.0, 70.0, 150.0, 70.0, 250.0, 90.0, 0.0, 50.0, 30.0, -20.0, 15.0, 90.0, 190.0, 50.0, 70.0, 150.0, 270.0, -30.0, 150.0, 150.0, 130.0, 40.0, 130.0, 20.0, 70.0, 440.0, 20.0, 70.0, 60.0, 40.0, 80.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 20.0, 150.0, 0.0, 10.0, -10.0, 120.0, -20.0, 10.0, 40.0, 0.0, 390.0, -30.0, 180.0, 20.0, 180.0, -50.0, 160.0, 390.0, -100.0, 160.0, 10.0, -390.0, 80.0, 200.0, 60.0, 30.0, 760.0, -20.0, 30.0, 110.0, 30.0, 160.0, 480.0, 50.0, 350.0, 30.0, -30.0, 150.0, -10.0, 0.0, -65.0, 50.0, 90.0, 0.0, 0.0, 50.0, 170.0, 70.0, 140.0, 330.0, 70.0, 25.0, 20.0, 170.0, 0.0, 40.0, 40.0, 55.0, 90.0, 40.0, -530.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 40.0, 40.0, 10.0, 40.0, -40.0, 0.0, 80.0, 180.0, 130.0, 20.0, 80.0, 60.0, 40.0, 10.0, 40.0, 200.0, 5.0, -5.0, 160.0, 30.0, 10.0, 180.0, 0.0, 40.0, 10.0, 60.0, 40.0, 60.0, 180.0, 180.0, 40.0, 50.0, 0.0, 30.0, -70.0, -20.0, 270.0, 190.0, 90.0, 20.0, 410.0, 20.0, 10.0, 80.0, 340.0, 10.0, 30.0, 90.0, 440.0, 220.0, 120.0, 80.0, 50.0, -20.0, 70.0, 60.0, 40.0, 100.0, 320.0, 150.0, 120.0, 20.0, 180.0, 60.0, 30.0, 30.0, 130.0, 310.0, 180.0, 20.0, 50.0, 330.0, 90.0, -70.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 30.0, 40.0, 0.0, 10.0, 35.0, 40.0, 10.0, 40.0, 160.0, 60.0, 110.0, 30.0, 70.0, 100.0, 310.0, 50.0, 90.0, 150.0, 80.0, 90.0, 170.0, 60.0, 60.0, 60.0, 170.0, 50.0, 80.0, 230.0, 60.0, 100.0, 260.0, 90.0, 90.0, 50.0, 20.0, 80.0, 90.0, 40.0, 140.0, 40.0, 330.0, 20.0, 20.0, 20.0, 20.0, 40.0, 280.0, 40.0, 170.0, 150.0, 40.0, 160.0, 30.0, 60.0, 240.0, 85.0, 200.0, 30.0, 40.0, 60.0, 90.0, 20.0, 110.0, 70.0, -20.0, 100.0, 100.0, 110.0, -10.0, -30.0, 90.0, 130.0, -40.0, 80.0, 20.0, 10.0, 200.0, 40.0, 130.0, 60.0, 60.0, 40.0, 70.0, 10.0, 20.0, 50.0, 160.0, 40.0, 90.0, 210.0, 160.0, 240.0, 460.0, 30.0, 60.0, 40.0, 30.0, 10.0, 90.0, 15.0, 40.0, 30.0, 210.0, 60.0, 30.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 170.0, 0.0, 40.0, 200.0, 220.0, 10.0, 80.0, 170.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 20.0, 40.0, 160.0, 90.0, 30.0, 30.0, 20.0, 40.0, 280.0, 10.0, 410.0, 80.0, 40.0, 5.0, 0.0, 220.0, 50.0, 90.0, 60.0, 30.0, 470.0, 10.0, -20.0, 50.0, 10.0, 220.0, 460.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 110.0, 490.0, 50.0, 0.0, 10.0, 110.0, 0.0, 60.0, 380.0, 20.0, 100.0, 130.0, 160.0, 420.0, 30.0, 120.0, 90.0, 40.0, 10.0, 0.0, 60.0, 200.0, 110.0, 180.0, 70.0, 20.0, 510.0, 170.0, 50.0, 30.0, 150.0, 180.0, 40.0, 60.0, 160.0, 80.0, 40.0, 30.0, 170.0, 20.0, 130.0, 10.0, 40.0, 90.0, 30.0, 30.0, 170.0, 50.0, 10.0, 10.0, 120.0, 10.0, 120.0, 60.0, 80.0, 130.0, 160.0, 30.0, 30.0, 90.0, 40.0, 30.0, 15.0, 120.0, 300.0, 0.0, 20.0, 20.0, 20.0, 90.0, 120.0, 0.0, 90.0, 50.0, 50.0, 80.0, 20.0, 10.0, 150.0, 80.0, 270.0, -20.0, 80.0, -90.0, 180.0, 130.0, 270.0, 80.0, 10.0, 90.0, 70.0, 80.0, 220.0, 40.0, -150.0, 30.0, 30.0, 30.0, 170.0, 20.0, 0.0, 20.0, 10.0, 80.0, 170.0, 70.0, 0.0, 60.0, 170.0, 420.0, -120.0, 150.0, 60.0, 90.0, 270.0, 80.0, -20.0, 60.0, 330.0, 190.0, 400.0, 290.0, 60.0, 80.0, 100.0, 80.0, 10.0, 40.0, 300.0, 180.0, 180.0, 10.0, 0.0, 30.0, 0.0, 70.0, 0.0, 80.0, 500.0, 160.0, 50.0, 0.0, 130.0, 210.0, 20.0, 30.0, 250.0, 330.0, 10.0, 5.0, 0.0, 100.0, 20.0, 50.0, 30.0, 20.0, 240.0, 80.0, 90.0, 150.0, 90.0, 90.0, 110.0, 90.0, 280.0, 80.0, 20.0, 70.0, 180.0, 70.0, 70.0, 80.0, 510.0, 300.0, -20.0, 50.0, 10.0, 280.0, 360.0, 0.0, -10.0, 70.0, 240.0, 0.0, 110.0, 10.0, 70.0, 700.0, 40.0, 70.0, 20.0, -20.0, 80.0, 120.0, -30.0, 250.0, 100.0, 60.0, 70.0, 50.0, 360.0, 250.0, 130.0, -40.0, 90.0, 100.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 30.0, 110.0, 50.0, 40.0, 10.0, -50.0, 140.0, 150.0, 190.0, 290.0, 360.0, 80.0, 10.0, 10.0, 30.0, 80.0, 20.0, 100.0, 60.0, 0.0, 40.0, 50.0, 160.0, 260.0, 40.0, 20.0, 30.0, 200.0, 0.0, 40.0, 80.0, 60.0, 30.0, 310.0, 10.0, 260.0, 60.0, 210.0, 70.0, 70.0, 0.0, 300.0, 20.0, 0.0, 150.0, -20.0, 70.0, 170.0, 70.0, 30.0, 60.0, 70.0, 0.0, 290.0, 160.0, 0.0, 310.0, 100.0, 60.0, 20.0, 90.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 0.0, 220.0, 200.0, 0.0, 30.0, 100.0, 270.0, 10.0, 60.0, -100.0, 120.0, 690.0, 10.0, 30.0, 70.0, 180.0, 0.0, 240.0, 260.0, 100.0, 495.0, 70.0, 50.0, 50.0, 60.0, -120.0, 10.0, 20.0, 50.0, 20.0, 210.0, 40.0, 150.0, 40.0, 365.0, 20.0, 310.0, 30.0, 30.0, 20.0, 90.0, 90.0, 160.0, 140.0, 20.0, 20.0, -30.0, 30.0, 120.0, 40.0, 10.0, 340.0, 80.0, 30.0, 70.0, 310.0, 110.0, 180.0, 10.0, 50.0, 40.0, 60.0, 110.0, 20.0, 270.0, 330.0, 320.0, 50.0, 20.0, -50.0, 130.0, 50.0, 150.0, 30.0, 30.0, 60.0, 40.0, 600.0, 110.0, 120.0, 110.0, 80.0, 60.0, 120.0, 30.0, 85.0, 50.0, 330.0, 50.0, 90.0, 0.0, 20.0, 90.0, 130.0, 40.0, 70.0, 35.0, 80.0, 30.0, 100.0, 40.0, 30.0, 0.0, 30.0, 50.0, 70.0, 300.0, 60.0, 20.0, 40.0, 200.0, 90.0, 90.0, 110.0, 60.0, 260.0, -70.0, 10.0, 90.0, 370.0, 270.0, 270.0, -20.0, 30.0, 30.0, 20.0, 110.0, 20.0, 40.0, 150.0, 40.0, 50.0, 50.0, 300.0, 80.0, 40.0, 390.0, 90.0, 0.0, 50.0, 180.0, 40.0, 210.0, 30.0, 40.0, 90.0, 220.0, 130.0, 50.0, 360.0, 20.0, 40.0, 90.0, 410.0, 50.0, 55.0, -50.0, 20.0, 30.0, 20.0, 20.0, 410.0, 100.0, 40.0, 10.0, 50.0, 50.0, 160.0, 100.0, 130.0, 110.0, 60.0, 170.0, 40.0, 300.0, 60.0, 150.0, 30.0, 20.0, 50.0, 20.0, 250.0, 50.0, 80.0, 0.0, 40.0, 10.0, 20.0, 20.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, 50.0, 0.0, 60.0, 190.0, 0.0, 190.0, 0.0, 40.0, 90.0, 0.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4723824036366815, "mean_inference_ms": 1.4226494316000111, "mean_action_processing_ms": 0.42351318145859224, "mean_env_wait_ms": 1.2550998961030913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012451171875, "StateBufferConnector_ms": 0.00994253158569336, "ViewRequirementAgentConnector_ms": 0.3879513740539551}, "num_episodes": 18, "episode_return_max": 1770.0, "episode_return_min": -50.0, "episode_return_mean": 919.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.572653199174667, "num_env_steps_trained_throughput_per_sec": 21.572653199174667, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 5880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5880000, "timers": {"training_iteration_time_ms": 186961.448, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186961.393, "sample_time_ms": 2459.637, "learn_time_ms": 184481.065, "learn_throughput": 21.682, "synch_weights_time_ms": 11.839}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "done": false, "training_iteration": 147, "trial_id": "90816_00000", "date": "2024-06-10_07-51-21", "timestamp": 1718020281, "time_this_iter_s": 185.43099904060364, "time_total_s": 27558.045726776123, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3103430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27558.045726776123, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 24.735496183206106, "ram_util_percent": 79.306106870229}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5969325355510997, "cur_kl_coeff": 3.0028802387286975, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005743854784127028, "vf_loss": 6.427773253021403, "vf_explained_var": 0.00020352574075245883, "kl": Infinity, "entropy": 0.3580363760391871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1385025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "env_runners": {"episode_reward_max": 1570.0, "episode_reward_min": -50.0, "episode_reward_mean": 885.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -530.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 88.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1110.0, 860.0, 130.0, 690.0, 920.0, 890.0, 1115.0, 970.0, -50.0, 260.0, 560.0, 660.0, 650.0, 1000.0, 1360.0, 1120.0, 1100.0, 180.0, 655.0, 1120.0, 1180.0, 800.0, 990.0, 945.0, 510.0, 640.0, 1460.0, 585.0, 450.0, 940.0, 460.0, 1185.0, 1310.0, 780.0, 1410.0, 880.0, 1370.0, 640.0, 660.0, 945.0, 460.0, 760.0, 840.0, 560.0, 1170.0, 1570.0, 830.0, 1220.0, 825.0, 1240.0, 1360.0, 1110.0, 1060.0, 1320.0, 440.0, 1220.0, 550.0, 760.0, 1310.0, 600.0, 1100.0, 660.0, 1340.0, 1205.0, 925.0, 910.0, 1000.0, 1180.0, 790.0, 1355.0, 870.0, 465.0, 1230.0, 1000.0, 880.0, 1120.0, 1425.0, 650.0, 1180.0, 690.0, 210.0, 630.0, 1100.0, 385.0, 920.0, 730.0, 1400.0, 1320.0, 360.0, 900.0, 475.0, 930.0, 1170.0, 1390.0, 810.0, 320.0, 700.0, 1040.0, 670.0, 445.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 70.0, 150.0, 270.0, -30.0, 150.0, 150.0, 130.0, 40.0, 130.0, 20.0, 70.0, 440.0, 20.0, 70.0, 60.0, 40.0, 80.0, 10.0, 50.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 20.0, 150.0, 0.0, 10.0, -10.0, 120.0, -20.0, 10.0, 40.0, 0.0, 390.0, -30.0, 180.0, 20.0, 180.0, -50.0, 160.0, 390.0, -100.0, 160.0, 10.0, -390.0, 80.0, 200.0, 60.0, 30.0, 760.0, -20.0, 30.0, 110.0, 30.0, 160.0, 480.0, 50.0, 350.0, 30.0, -30.0, 150.0, -10.0, 0.0, -65.0, 50.0, 90.0, 0.0, 0.0, 50.0, 170.0, 70.0, 140.0, 330.0, 70.0, 25.0, 20.0, 170.0, 0.0, 40.0, 40.0, 55.0, 90.0, 40.0, -530.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 40.0, 40.0, 10.0, 40.0, -40.0, 0.0, 80.0, 180.0, 130.0, 20.0, 80.0, 60.0, 40.0, 10.0, 40.0, 200.0, 5.0, -5.0, 160.0, 30.0, 10.0, 180.0, 0.0, 40.0, 10.0, 60.0, 40.0, 60.0, 180.0, 180.0, 40.0, 50.0, 0.0, 30.0, -70.0, -20.0, 270.0, 190.0, 90.0, 20.0, 410.0, 20.0, 10.0, 80.0, 340.0, 10.0, 30.0, 90.0, 440.0, 220.0, 120.0, 80.0, 50.0, -20.0, 70.0, 60.0, 40.0, 100.0, 320.0, 150.0, 120.0, 20.0, 180.0, 60.0, 30.0, 30.0, 130.0, 310.0, 180.0, 20.0, 50.0, 330.0, 90.0, -70.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 30.0, 40.0, 0.0, 10.0, 35.0, 40.0, 10.0, 40.0, 160.0, 60.0, 110.0, 30.0, 70.0, 100.0, 310.0, 50.0, 90.0, 150.0, 80.0, 90.0, 170.0, 60.0, 60.0, 60.0, 170.0, 50.0, 80.0, 230.0, 60.0, 100.0, 260.0, 90.0, 90.0, 50.0, 20.0, 80.0, 90.0, 40.0, 140.0, 40.0, 330.0, 20.0, 20.0, 20.0, 20.0, 40.0, 280.0, 40.0, 170.0, 150.0, 40.0, 160.0, 30.0, 60.0, 240.0, 85.0, 200.0, 30.0, 40.0, 60.0, 90.0, 20.0, 110.0, 70.0, -20.0, 100.0, 100.0, 110.0, -10.0, -30.0, 90.0, 130.0, -40.0, 80.0, 20.0, 10.0, 200.0, 40.0, 130.0, 60.0, 60.0, 40.0, 70.0, 10.0, 20.0, 50.0, 160.0, 40.0, 90.0, 210.0, 160.0, 240.0, 460.0, 30.0, 60.0, 40.0, 30.0, 10.0, 90.0, 15.0, 40.0, 30.0, 210.0, 60.0, 30.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 170.0, 0.0, 40.0, 200.0, 220.0, 10.0, 80.0, 170.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 20.0, 40.0, 160.0, 90.0, 30.0, 30.0, 20.0, 40.0, 280.0, 10.0, 410.0, 80.0, 40.0, 5.0, 0.0, 220.0, 50.0, 90.0, 60.0, 30.0, 470.0, 10.0, -20.0, 50.0, 10.0, 220.0, 460.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 110.0, 490.0, 50.0, 0.0, 10.0, 110.0, 0.0, 60.0, 380.0, 20.0, 100.0, 130.0, 160.0, 420.0, 30.0, 120.0, 90.0, 40.0, 10.0, 0.0, 60.0, 200.0, 110.0, 180.0, 70.0, 20.0, 510.0, 170.0, 50.0, 30.0, 150.0, 180.0, 40.0, 60.0, 160.0, 80.0, 40.0, 30.0, 170.0, 20.0, 130.0, 10.0, 40.0, 90.0, 30.0, 30.0, 170.0, 50.0, 10.0, 10.0, 120.0, 10.0, 120.0, 60.0, 80.0, 130.0, 160.0, 30.0, 30.0, 90.0, 40.0, 30.0, 15.0, 120.0, 300.0, 0.0, 20.0, 20.0, 20.0, 90.0, 120.0, 0.0, 90.0, 50.0, 50.0, 80.0, 20.0, 10.0, 150.0, 80.0, 270.0, -20.0, 80.0, -90.0, 180.0, 130.0, 270.0, 80.0, 10.0, 90.0, 70.0, 80.0, 220.0, 40.0, -150.0, 30.0, 30.0, 30.0, 170.0, 20.0, 0.0, 20.0, 10.0, 80.0, 170.0, 70.0, 0.0, 60.0, 170.0, 420.0, -120.0, 150.0, 60.0, 90.0, 270.0, 80.0, -20.0, 60.0, 330.0, 190.0, 400.0, 290.0, 60.0, 80.0, 100.0, 80.0, 10.0, 40.0, 300.0, 180.0, 180.0, 10.0, 0.0, 30.0, 0.0, 70.0, 0.0, 80.0, 500.0, 160.0, 50.0, 0.0, 130.0, 210.0, 20.0, 30.0, 250.0, 330.0, 10.0, 5.0, 0.0, 100.0, 20.0, 50.0, 30.0, 20.0, 240.0, 80.0, 90.0, 150.0, 90.0, 90.0, 110.0, 90.0, 280.0, 80.0, 20.0, 70.0, 180.0, 70.0, 70.0, 80.0, 510.0, 300.0, -20.0, 50.0, 10.0, 280.0, 360.0, 0.0, -10.0, 70.0, 240.0, 0.0, 110.0, 10.0, 70.0, 700.0, 40.0, 70.0, 20.0, -20.0, 80.0, 120.0, -30.0, 250.0, 100.0, 60.0, 70.0, 50.0, 360.0, 250.0, 130.0, -40.0, 90.0, 100.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 30.0, 110.0, 50.0, 40.0, 10.0, -50.0, 140.0, 150.0, 190.0, 290.0, 360.0, 80.0, 10.0, 10.0, 30.0, 80.0, 20.0, 100.0, 60.0, 0.0, 40.0, 50.0, 160.0, 260.0, 40.0, 20.0, 30.0, 200.0, 0.0, 40.0, 80.0, 60.0, 30.0, 310.0, 10.0, 260.0, 60.0, 210.0, 70.0, 70.0, 0.0, 300.0, 20.0, 0.0, 150.0, -20.0, 70.0, 170.0, 70.0, 30.0, 60.0, 70.0, 0.0, 290.0, 160.0, 0.0, 310.0, 100.0, 60.0, 20.0, 90.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 0.0, 220.0, 200.0, 0.0, 30.0, 100.0, 270.0, 10.0, 60.0, -100.0, 120.0, 690.0, 10.0, 30.0, 70.0, 180.0, 0.0, 240.0, 260.0, 100.0, 495.0, 70.0, 50.0, 50.0, 60.0, -120.0, 10.0, 20.0, 50.0, 20.0, 210.0, 40.0, 150.0, 40.0, 365.0, 20.0, 310.0, 30.0, 30.0, 20.0, 90.0, 90.0, 160.0, 140.0, 20.0, 20.0, -30.0, 30.0, 120.0, 40.0, 10.0, 340.0, 80.0, 30.0, 70.0, 310.0, 110.0, 180.0, 10.0, 50.0, 40.0, 60.0, 110.0, 20.0, 270.0, 330.0, 320.0, 50.0, 20.0, -50.0, 130.0, 50.0, 150.0, 30.0, 30.0, 60.0, 40.0, 600.0, 110.0, 120.0, 110.0, 80.0, 60.0, 120.0, 30.0, 85.0, 50.0, 330.0, 50.0, 90.0, 0.0, 20.0, 90.0, 130.0, 40.0, 70.0, 35.0, 80.0, 30.0, 100.0, 40.0, 30.0, 0.0, 30.0, 50.0, 70.0, 300.0, 60.0, 20.0, 40.0, 200.0, 90.0, 90.0, 110.0, 60.0, 260.0, -70.0, 10.0, 90.0, 370.0, 270.0, 270.0, -20.0, 30.0, 30.0, 20.0, 110.0, 20.0, 40.0, 150.0, 40.0, 50.0, 50.0, 300.0, 80.0, 40.0, 390.0, 90.0, 0.0, 50.0, 180.0, 40.0, 210.0, 30.0, 40.0, 90.0, 220.0, 130.0, 50.0, 360.0, 20.0, 40.0, 90.0, 410.0, 50.0, 55.0, -50.0, 20.0, 30.0, 20.0, 20.0, 410.0, 100.0, 40.0, 10.0, 50.0, 50.0, 160.0, 100.0, 130.0, 110.0, 60.0, 170.0, 40.0, 300.0, 60.0, 150.0, 30.0, 20.0, 50.0, 20.0, 250.0, 50.0, 80.0, 0.0, 40.0, 10.0, 20.0, 20.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, 50.0, 0.0, 60.0, 190.0, 0.0, 190.0, 0.0, 40.0, 90.0, 0.0, 60.0, 210.0, 90.0, 340.0, 140.0, -50.0, 20.0, 190.0, 0.0, 110.0, 50.0, -5.0, 0.0, 20.0, 60.0, 280.0, 30.0, 30.0, -40.0, 10.0, 0.0, 130.0, 50.0, 460.0, 50.0, 40.0, 80.0, 20.0, 30.0, 20.0, 40.0, 80.0, 180.0, -5.0, 50.0, 80.0, 100.0, 110.0, 310.0, -105.0, -70.0, 190.0, 50.0, 210.0, 100.0, 60.0, 260.0, 100.0, 10.0, 410.0, 10.0, 70.0, 190.0, 90.0, 340.0, 120.0, 210.0, 160.0, 70.0, 0.0, 70.0, 30.0, 30.0, 90.0, 20.0, 30.0, 70.0, 20.0, 20.0, 60.0, -10.0, 260.0, 40.0, 70.0, 30.0, -40.0, 300.0, 40.0, -70.0, 80.0, 190.0, 50.0, 40.0, 30.0, 10.0, 60.0, 30.0, 130.0, 90.0, 10.0, 25.0, 20.0, 100.0, 300.0, 80.0, 90.0, 90.0, 100.0, 60.0, 40.0, 50.0, 160.0, 30.0, 30.0, 130.0, 260.0, 400.0, 80.0, 0.0, 40.0, 40.0, 60.0, 200.0, 90.0, 60.0, 100.0, 170.0, 50.0, 50.0, 370.0, 240.0, 50.0, 330.0, -130.0, 320.0, 10.0, 40.0, 50.0, 100.0, 40.0, 0.0, 0.0, -55.0, 30.0, -165.0, 260.0, 30.0, 130.0, 40.0, 30.0, 20.0, 80.0, -100.0, 80.0, 70.0, 220.0, 70.0, 210.0, -40.0, 60.0, 50.0, 120.0, 190.0, 70.0, 50.0, 70.0, 50.0, 300.0, 90.0, 100.0, 0.0, 60.0, 170.0, 110.0, 20.0, 30.0, 10.0, 30.0, 0.0, 60.0, 180.0, 0.0, 0.0, 270.0, 0.0, 70.0, 40.0, 15.0, 0.0, 50.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4713703820101585, "mean_inference_ms": 1.422519248532127, "mean_action_processing_ms": 0.42371440991289683, "mean_env_wait_ms": 1.2550459327043297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012377023696899414, "StateBufferConnector_ms": 0.009792804718017578, "ViewRequirementAgentConnector_ms": 0.38567042350769043}, "num_episodes": 18, "episode_return_max": 1570.0, "episode_return_min": -50.0, "episode_return_mean": 885.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.547874770183096, "num_env_steps_trained_throughput_per_sec": 21.547874770183096, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 5920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5920000, "timers": {"training_iteration_time_ms": 186867.846, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186867.79, "sample_time_ms": 2402.941, "learn_time_ms": 184444.305, "learn_throughput": 21.687, "synch_weights_time_ms": 11.689}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "done": false, "training_iteration": 148, "trial_id": "90816_00000", "date": "2024-06-10_07-54-27", "timestamp": 1718020467, "time_this_iter_s": 185.6457052230835, "time_total_s": 27743.691431999207, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b310f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27743.691431999207, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 24.969201520912545, "ram_util_percent": 78.94828897338404}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4866538394309967, "cur_kl_coeff": 4.504320358093047, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004866672209186303, "vf_loss": 6.1056777503670725, "vf_explained_var": 0.00024024684843036947, "kl": Infinity, "entropy": 0.3452665529185083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1394415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "env_runners": {"episode_reward_max": 1570.0, "episode_reward_min": 210.0, "episode_reward_mean": 869.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 86.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [945.0, 510.0, 640.0, 1460.0, 585.0, 450.0, 940.0, 460.0, 1185.0, 1310.0, 780.0, 1410.0, 880.0, 1370.0, 640.0, 660.0, 945.0, 460.0, 760.0, 840.0, 560.0, 1170.0, 1570.0, 830.0, 1220.0, 825.0, 1240.0, 1360.0, 1110.0, 1060.0, 1320.0, 440.0, 1220.0, 550.0, 760.0, 1310.0, 600.0, 1100.0, 660.0, 1340.0, 1205.0, 925.0, 910.0, 1000.0, 1180.0, 790.0, 1355.0, 870.0, 465.0, 1230.0, 1000.0, 880.0, 1120.0, 1425.0, 650.0, 1180.0, 690.0, 210.0, 630.0, 1100.0, 385.0, 920.0, 730.0, 1400.0, 1320.0, 360.0, 900.0, 475.0, 930.0, 1170.0, 1390.0, 810.0, 320.0, 700.0, 1040.0, 670.0, 445.0, 610.0, 860.0, 740.0, 1100.0, 1240.0, 630.0, 390.0, 670.0, 815.0, 355.0, 550.0, 1490.0, 720.0, 260.0, 230.0, 350.0, 580.0, 680.0, 570.0, 600.0, 1420.0, 690.0, 1190.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [240.0, 85.0, 200.0, 30.0, 40.0, 60.0, 90.0, 20.0, 110.0, 70.0, -20.0, 100.0, 100.0, 110.0, -10.0, -30.0, 90.0, 130.0, -40.0, 80.0, 20.0, 10.0, 200.0, 40.0, 130.0, 60.0, 60.0, 40.0, 70.0, 10.0, 20.0, 50.0, 160.0, 40.0, 90.0, 210.0, 160.0, 240.0, 460.0, 30.0, 60.0, 40.0, 30.0, 10.0, 90.0, 15.0, 40.0, 30.0, 210.0, 60.0, 30.0, 50.0, 40.0, 40.0, 30.0, 20.0, 30.0, 170.0, 0.0, 40.0, 200.0, 220.0, 10.0, 80.0, 170.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 20.0, 40.0, 160.0, 90.0, 30.0, 30.0, 20.0, 40.0, 280.0, 10.0, 410.0, 80.0, 40.0, 5.0, 0.0, 220.0, 50.0, 90.0, 60.0, 30.0, 470.0, 10.0, -20.0, 50.0, 10.0, 220.0, 460.0, 20.0, 40.0, 10.0, 20.0, 30.0, 20.0, 110.0, 490.0, 50.0, 0.0, 10.0, 110.0, 0.0, 60.0, 380.0, 20.0, 100.0, 130.0, 160.0, 420.0, 30.0, 120.0, 90.0, 40.0, 10.0, 0.0, 60.0, 200.0, 110.0, 180.0, 70.0, 20.0, 510.0, 170.0, 50.0, 30.0, 150.0, 180.0, 40.0, 60.0, 160.0, 80.0, 40.0, 30.0, 170.0, 20.0, 130.0, 10.0, 40.0, 90.0, 30.0, 30.0, 170.0, 50.0, 10.0, 10.0, 120.0, 10.0, 120.0, 60.0, 80.0, 130.0, 160.0, 30.0, 30.0, 90.0, 40.0, 30.0, 15.0, 120.0, 300.0, 0.0, 20.0, 20.0, 20.0, 90.0, 120.0, 0.0, 90.0, 50.0, 50.0, 80.0, 20.0, 10.0, 150.0, 80.0, 270.0, -20.0, 80.0, -90.0, 180.0, 130.0, 270.0, 80.0, 10.0, 90.0, 70.0, 80.0, 220.0, 40.0, -150.0, 30.0, 30.0, 30.0, 170.0, 20.0, 0.0, 20.0, 10.0, 80.0, 170.0, 70.0, 0.0, 60.0, 170.0, 420.0, -120.0, 150.0, 60.0, 90.0, 270.0, 80.0, -20.0, 60.0, 330.0, 190.0, 400.0, 290.0, 60.0, 80.0, 100.0, 80.0, 10.0, 40.0, 300.0, 180.0, 180.0, 10.0, 0.0, 30.0, 0.0, 70.0, 0.0, 80.0, 500.0, 160.0, 50.0, 0.0, 130.0, 210.0, 20.0, 30.0, 250.0, 330.0, 10.0, 5.0, 0.0, 100.0, 20.0, 50.0, 30.0, 20.0, 240.0, 80.0, 90.0, 150.0, 90.0, 90.0, 110.0, 90.0, 280.0, 80.0, 20.0, 70.0, 180.0, 70.0, 70.0, 80.0, 510.0, 300.0, -20.0, 50.0, 10.0, 280.0, 360.0, 0.0, -10.0, 70.0, 240.0, 0.0, 110.0, 10.0, 70.0, 700.0, 40.0, 70.0, 20.0, -20.0, 80.0, 120.0, -30.0, 250.0, 100.0, 60.0, 70.0, 50.0, 360.0, 250.0, 130.0, -40.0, 90.0, 100.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 30.0, 110.0, 50.0, 40.0, 10.0, -50.0, 140.0, 150.0, 190.0, 290.0, 360.0, 80.0, 10.0, 10.0, 30.0, 80.0, 20.0, 100.0, 60.0, 0.0, 40.0, 50.0, 160.0, 260.0, 40.0, 20.0, 30.0, 200.0, 0.0, 40.0, 80.0, 60.0, 30.0, 310.0, 10.0, 260.0, 60.0, 210.0, 70.0, 70.0, 0.0, 300.0, 20.0, 0.0, 150.0, -20.0, 70.0, 170.0, 70.0, 30.0, 60.0, 70.0, 0.0, 290.0, 160.0, 0.0, 310.0, 100.0, 60.0, 20.0, 90.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 0.0, 220.0, 200.0, 0.0, 30.0, 100.0, 270.0, 10.0, 60.0, -100.0, 120.0, 690.0, 10.0, 30.0, 70.0, 180.0, 0.0, 240.0, 260.0, 100.0, 495.0, 70.0, 50.0, 50.0, 60.0, -120.0, 10.0, 20.0, 50.0, 20.0, 210.0, 40.0, 150.0, 40.0, 365.0, 20.0, 310.0, 30.0, 30.0, 20.0, 90.0, 90.0, 160.0, 140.0, 20.0, 20.0, -30.0, 30.0, 120.0, 40.0, 10.0, 340.0, 80.0, 30.0, 70.0, 310.0, 110.0, 180.0, 10.0, 50.0, 40.0, 60.0, 110.0, 20.0, 270.0, 330.0, 320.0, 50.0, 20.0, -50.0, 130.0, 50.0, 150.0, 30.0, 30.0, 60.0, 40.0, 600.0, 110.0, 120.0, 110.0, 80.0, 60.0, 120.0, 30.0, 85.0, 50.0, 330.0, 50.0, 90.0, 0.0, 20.0, 90.0, 130.0, 40.0, 70.0, 35.0, 80.0, 30.0, 100.0, 40.0, 30.0, 0.0, 30.0, 50.0, 70.0, 300.0, 60.0, 20.0, 40.0, 200.0, 90.0, 90.0, 110.0, 60.0, 260.0, -70.0, 10.0, 90.0, 370.0, 270.0, 270.0, -20.0, 30.0, 30.0, 20.0, 110.0, 20.0, 40.0, 150.0, 40.0, 50.0, 50.0, 300.0, 80.0, 40.0, 390.0, 90.0, 0.0, 50.0, 180.0, 40.0, 210.0, 30.0, 40.0, 90.0, 220.0, 130.0, 50.0, 360.0, 20.0, 40.0, 90.0, 410.0, 50.0, 55.0, -50.0, 20.0, 30.0, 20.0, 20.0, 410.0, 100.0, 40.0, 10.0, 50.0, 50.0, 160.0, 100.0, 130.0, 110.0, 60.0, 170.0, 40.0, 300.0, 60.0, 150.0, 30.0, 20.0, 50.0, 20.0, 250.0, 50.0, 80.0, 0.0, 40.0, 10.0, 20.0, 20.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, 50.0, 0.0, 60.0, 190.0, 0.0, 190.0, 0.0, 40.0, 90.0, 0.0, 60.0, 210.0, 90.0, 340.0, 140.0, -50.0, 20.0, 190.0, 0.0, 110.0, 50.0, -5.0, 0.0, 20.0, 60.0, 280.0, 30.0, 30.0, -40.0, 10.0, 0.0, 130.0, 50.0, 460.0, 50.0, 40.0, 80.0, 20.0, 30.0, 20.0, 40.0, 80.0, 180.0, -5.0, 50.0, 80.0, 100.0, 110.0, 310.0, -105.0, -70.0, 190.0, 50.0, 210.0, 100.0, 60.0, 260.0, 100.0, 10.0, 410.0, 10.0, 70.0, 190.0, 90.0, 340.0, 120.0, 210.0, 160.0, 70.0, 0.0, 70.0, 30.0, 30.0, 90.0, 20.0, 30.0, 70.0, 20.0, 20.0, 60.0, -10.0, 260.0, 40.0, 70.0, 30.0, -40.0, 300.0, 40.0, -70.0, 80.0, 190.0, 50.0, 40.0, 30.0, 10.0, 60.0, 30.0, 130.0, 90.0, 10.0, 25.0, 20.0, 100.0, 300.0, 80.0, 90.0, 90.0, 100.0, 60.0, 40.0, 50.0, 160.0, 30.0, 30.0, 130.0, 260.0, 400.0, 80.0, 0.0, 40.0, 40.0, 60.0, 200.0, 90.0, 60.0, 100.0, 170.0, 50.0, 50.0, 370.0, 240.0, 50.0, 330.0, -130.0, 320.0, 10.0, 40.0, 50.0, 100.0, 40.0, 0.0, 0.0, -55.0, 30.0, -165.0, 260.0, 30.0, 130.0, 40.0, 30.0, 20.0, 80.0, -100.0, 80.0, 70.0, 220.0, 70.0, 210.0, -40.0, 60.0, 50.0, 120.0, 190.0, 70.0, 50.0, 70.0, 50.0, 300.0, 90.0, 100.0, 0.0, 60.0, 170.0, 110.0, 20.0, 30.0, 10.0, 30.0, 0.0, 60.0, 180.0, 0.0, 0.0, 270.0, 0.0, 70.0, 40.0, 15.0, 0.0, 50.0, 0.0, 10.0, 60.0, 80.0, 30.0, 10.0, 170.0, 30.0, 200.0, 20.0, 0.0, 140.0, 50.0, 20.0, 80.0, 170.0, 10.0, 160.0, 50.0, 110.0, 70.0, 80.0, -20.0, 60.0, -30.0, -50.0, 210.0, 160.0, -30.0, 290.0, 70.0, 70.0, 50.0, 200.0, 10.0, 60.0, 80.0, 180.0, 50.0, 40.0, 360.0, 70.0, 280.0, 60.0, 30.0, 410.0, 60.0, -30.0, 30.0, 120.0, 210.0, 80.0, 60.0, 70.0, 10.0, 90.0, 70.0, 40.0, 70.0, 70.0, 70.0, 70.0, 20.0, 0.0, 30.0, 30.0, 0.0, 40.0, 100.0, 60.0, 40.0, 80.0, 100.0, 10.0, 70.0, 120.0, 80.0, 50.0, 100.0, 20.0, 40.0, 130.0, 380.0, -30.0, 30.0, -40.0, 0.0, 20.0, 270.0, -5.0, 60.0, 20.0, 20.0, 0.0, 80.0, 30.0, 100.0, 40.0, 10.0, 40.0, 15.0, 100.0, 50.0, 30.0, 80.0, 40.0, 0.0, 10.0, 10.0, 80.0, 150.0, 190.0, 10.0, 170.0, 70.0, 110.0, 160.0, 20.0, 60.0, 340.0, 360.0, 60.0, -30.0, 0.0, 70.0, 320.0, 10.0, 120.0, 10.0, 30.0, 130.0, 0.0, 10.0, 0.0, 40.0, 130.0, 0.0, 40.0, 30.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 90.0, 10.0, 20.0, 140.0, 20.0, 30.0, 0.0, 40.0, 40.0, 30.0, 20.0, 10.0, 20.0, 90.0, 20.0, 30.0, 0.0, 10.0, 0.0, -70.0, 130.0, 290.0, 80.0, 0.0, 100.0, 30.0, 60.0, 20.0, 30.0, 200.0, 30.0, 60.0, 150.0, 80.0, 30.0, 40.0, 70.0, 90.0, 70.0, 50.0, 200.0, 110.0, -170.0, 40.0, 130.0, 10.0, 40.0, 40.0, 30.0, 130.0, 90.0, 20.0, 70.0, -20.0, 200.0, 60.0, 510.0, 60.0, 90.0, -20.0, 120.0, 260.0, 160.0, 10.0, 150.0, 250.0, 40.0, 60.0, 70.0, 40.0, 50.0, 0.0, 20.0, 440.0, 130.0, 170.0, 130.0, 60.0, 130.0, 0.0, 90.0, -10.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4699284237542418, "mean_inference_ms": 1.422156239145989, "mean_action_processing_ms": 0.4234673411077767, "mean_env_wait_ms": 1.254913625908422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012325286865234375, "StateBufferConnector_ms": 0.009812116622924805, "ViewRequirementAgentConnector_ms": 0.3791229724884033}, "num_episodes": 23, "episode_return_max": 1570.0, "episode_return_min": 210.0, "episode_return_mean": 869.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.480409398656775, "num_env_steps_trained_throughput_per_sec": 21.480409398656775, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 5960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5960000, "timers": {"training_iteration_time_ms": 186934.256, "restore_workers_time_ms": 0.013, "training_step_time_ms": 186934.201, "sample_time_ms": 2396.9, "learn_time_ms": 184516.782, "learn_throughput": 21.678, "synch_weights_time_ms": 11.676}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "done": false, "training_iteration": 149, "trial_id": "90816_00000", "date": "2024-06-10_07-57-33", "timestamp": 1718020653, "time_this_iter_s": 186.22679090499878, "time_total_s": 27929.918222904205, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3103940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27929.918222904205, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 25.217870722433457, "ram_util_percent": 77.82623574144486}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0219354906782936, "cur_kl_coeff": 6.756480537139567, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004396558687645304, "vf_loss": 6.983280876523263, "vf_explained_var": -0.00030748511528689513, "kl": Infinity, "entropy": 0.33255852613998804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1403805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "env_runners": {"episode_reward_max": 1650.0, "episode_reward_min": 210.0, "episode_reward_mean": 902.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 90.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1570.0, 830.0, 1220.0, 825.0, 1240.0, 1360.0, 1110.0, 1060.0, 1320.0, 440.0, 1220.0, 550.0, 760.0, 1310.0, 600.0, 1100.0, 660.0, 1340.0, 1205.0, 925.0, 910.0, 1000.0, 1180.0, 790.0, 1355.0, 870.0, 465.0, 1230.0, 1000.0, 880.0, 1120.0, 1425.0, 650.0, 1180.0, 690.0, 210.0, 630.0, 1100.0, 385.0, 920.0, 730.0, 1400.0, 1320.0, 360.0, 900.0, 475.0, 930.0, 1170.0, 1390.0, 810.0, 320.0, 700.0, 1040.0, 670.0, 445.0, 610.0, 860.0, 740.0, 1100.0, 1240.0, 630.0, 390.0, 670.0, 815.0, 355.0, 550.0, 1490.0, 720.0, 260.0, 230.0, 350.0, 580.0, 680.0, 570.0, 600.0, 1420.0, 690.0, 1190.0, 870.0, 485.0, 1160.0, 695.0, 1305.0, 470.0, 1520.0, 530.0, 520.0, 1090.0, 1230.0, 615.0, 1230.0, 840.0, 1090.0, 1050.0, 570.0, 1380.0, 810.0, 1640.0, 1650.0, 1475.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, -20.0, 60.0, 330.0, 190.0, 400.0, 290.0, 60.0, 80.0, 100.0, 80.0, 10.0, 40.0, 300.0, 180.0, 180.0, 10.0, 0.0, 30.0, 0.0, 70.0, 0.0, 80.0, 500.0, 160.0, 50.0, 0.0, 130.0, 210.0, 20.0, 30.0, 250.0, 330.0, 10.0, 5.0, 0.0, 100.0, 20.0, 50.0, 30.0, 20.0, 240.0, 80.0, 90.0, 150.0, 90.0, 90.0, 110.0, 90.0, 280.0, 80.0, 20.0, 70.0, 180.0, 70.0, 70.0, 80.0, 510.0, 300.0, -20.0, 50.0, 10.0, 280.0, 360.0, 0.0, -10.0, 70.0, 240.0, 0.0, 110.0, 10.0, 70.0, 700.0, 40.0, 70.0, 20.0, -20.0, 80.0, 120.0, -30.0, 250.0, 100.0, 60.0, 70.0, 50.0, 360.0, 250.0, 130.0, -40.0, 90.0, 100.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 30.0, 110.0, 50.0, 40.0, 10.0, -50.0, 140.0, 150.0, 190.0, 290.0, 360.0, 80.0, 10.0, 10.0, 30.0, 80.0, 20.0, 100.0, 60.0, 0.0, 40.0, 50.0, 160.0, 260.0, 40.0, 20.0, 30.0, 200.0, 0.0, 40.0, 80.0, 60.0, 30.0, 310.0, 10.0, 260.0, 60.0, 210.0, 70.0, 70.0, 0.0, 300.0, 20.0, 0.0, 150.0, -20.0, 70.0, 170.0, 70.0, 30.0, 60.0, 70.0, 0.0, 290.0, 160.0, 0.0, 310.0, 100.0, 60.0, 20.0, 90.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 0.0, 220.0, 200.0, 0.0, 30.0, 100.0, 270.0, 10.0, 60.0, -100.0, 120.0, 690.0, 10.0, 30.0, 70.0, 180.0, 0.0, 240.0, 260.0, 100.0, 495.0, 70.0, 50.0, 50.0, 60.0, -120.0, 10.0, 20.0, 50.0, 20.0, 210.0, 40.0, 150.0, 40.0, 365.0, 20.0, 310.0, 30.0, 30.0, 20.0, 90.0, 90.0, 160.0, 140.0, 20.0, 20.0, -30.0, 30.0, 120.0, 40.0, 10.0, 340.0, 80.0, 30.0, 70.0, 310.0, 110.0, 180.0, 10.0, 50.0, 40.0, 60.0, 110.0, 20.0, 270.0, 330.0, 320.0, 50.0, 20.0, -50.0, 130.0, 50.0, 150.0, 30.0, 30.0, 60.0, 40.0, 600.0, 110.0, 120.0, 110.0, 80.0, 60.0, 120.0, 30.0, 85.0, 50.0, 330.0, 50.0, 90.0, 0.0, 20.0, 90.0, 130.0, 40.0, 70.0, 35.0, 80.0, 30.0, 100.0, 40.0, 30.0, 0.0, 30.0, 50.0, 70.0, 300.0, 60.0, 20.0, 40.0, 200.0, 90.0, 90.0, 110.0, 60.0, 260.0, -70.0, 10.0, 90.0, 370.0, 270.0, 270.0, -20.0, 30.0, 30.0, 20.0, 110.0, 20.0, 40.0, 150.0, 40.0, 50.0, 50.0, 300.0, 80.0, 40.0, 390.0, 90.0, 0.0, 50.0, 180.0, 40.0, 210.0, 30.0, 40.0, 90.0, 220.0, 130.0, 50.0, 360.0, 20.0, 40.0, 90.0, 410.0, 50.0, 55.0, -50.0, 20.0, 30.0, 20.0, 20.0, 410.0, 100.0, 40.0, 10.0, 50.0, 50.0, 160.0, 100.0, 130.0, 110.0, 60.0, 170.0, 40.0, 300.0, 60.0, 150.0, 30.0, 20.0, 50.0, 20.0, 250.0, 50.0, 80.0, 0.0, 40.0, 10.0, 20.0, 20.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, 50.0, 0.0, 60.0, 190.0, 0.0, 190.0, 0.0, 40.0, 90.0, 0.0, 60.0, 210.0, 90.0, 340.0, 140.0, -50.0, 20.0, 190.0, 0.0, 110.0, 50.0, -5.0, 0.0, 20.0, 60.0, 280.0, 30.0, 30.0, -40.0, 10.0, 0.0, 130.0, 50.0, 460.0, 50.0, 40.0, 80.0, 20.0, 30.0, 20.0, 40.0, 80.0, 180.0, -5.0, 50.0, 80.0, 100.0, 110.0, 310.0, -105.0, -70.0, 190.0, 50.0, 210.0, 100.0, 60.0, 260.0, 100.0, 10.0, 410.0, 10.0, 70.0, 190.0, 90.0, 340.0, 120.0, 210.0, 160.0, 70.0, 0.0, 70.0, 30.0, 30.0, 90.0, 20.0, 30.0, 70.0, 20.0, 20.0, 60.0, -10.0, 260.0, 40.0, 70.0, 30.0, -40.0, 300.0, 40.0, -70.0, 80.0, 190.0, 50.0, 40.0, 30.0, 10.0, 60.0, 30.0, 130.0, 90.0, 10.0, 25.0, 20.0, 100.0, 300.0, 80.0, 90.0, 90.0, 100.0, 60.0, 40.0, 50.0, 160.0, 30.0, 30.0, 130.0, 260.0, 400.0, 80.0, 0.0, 40.0, 40.0, 60.0, 200.0, 90.0, 60.0, 100.0, 170.0, 50.0, 50.0, 370.0, 240.0, 50.0, 330.0, -130.0, 320.0, 10.0, 40.0, 50.0, 100.0, 40.0, 0.0, 0.0, -55.0, 30.0, -165.0, 260.0, 30.0, 130.0, 40.0, 30.0, 20.0, 80.0, -100.0, 80.0, 70.0, 220.0, 70.0, 210.0, -40.0, 60.0, 50.0, 120.0, 190.0, 70.0, 50.0, 70.0, 50.0, 300.0, 90.0, 100.0, 0.0, 60.0, 170.0, 110.0, 20.0, 30.0, 10.0, 30.0, 0.0, 60.0, 180.0, 0.0, 0.0, 270.0, 0.0, 70.0, 40.0, 15.0, 0.0, 50.0, 0.0, 10.0, 60.0, 80.0, 30.0, 10.0, 170.0, 30.0, 200.0, 20.0, 0.0, 140.0, 50.0, 20.0, 80.0, 170.0, 10.0, 160.0, 50.0, 110.0, 70.0, 80.0, -20.0, 60.0, -30.0, -50.0, 210.0, 160.0, -30.0, 290.0, 70.0, 70.0, 50.0, 200.0, 10.0, 60.0, 80.0, 180.0, 50.0, 40.0, 360.0, 70.0, 280.0, 60.0, 30.0, 410.0, 60.0, -30.0, 30.0, 120.0, 210.0, 80.0, 60.0, 70.0, 10.0, 90.0, 70.0, 40.0, 70.0, 70.0, 70.0, 70.0, 20.0, 0.0, 30.0, 30.0, 0.0, 40.0, 100.0, 60.0, 40.0, 80.0, 100.0, 10.0, 70.0, 120.0, 80.0, 50.0, 100.0, 20.0, 40.0, 130.0, 380.0, -30.0, 30.0, -40.0, 0.0, 20.0, 270.0, -5.0, 60.0, 20.0, 20.0, 0.0, 80.0, 30.0, 100.0, 40.0, 10.0, 40.0, 15.0, 100.0, 50.0, 30.0, 80.0, 40.0, 0.0, 10.0, 10.0, 80.0, 150.0, 190.0, 10.0, 170.0, 70.0, 110.0, 160.0, 20.0, 60.0, 340.0, 360.0, 60.0, -30.0, 0.0, 70.0, 320.0, 10.0, 120.0, 10.0, 30.0, 130.0, 0.0, 10.0, 0.0, 40.0, 130.0, 0.0, 40.0, 30.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 90.0, 10.0, 20.0, 140.0, 20.0, 30.0, 0.0, 40.0, 40.0, 30.0, 20.0, 10.0, 20.0, 90.0, 20.0, 30.0, 0.0, 10.0, 0.0, -70.0, 130.0, 290.0, 80.0, 0.0, 100.0, 30.0, 60.0, 20.0, 30.0, 200.0, 30.0, 60.0, 150.0, 80.0, 30.0, 40.0, 70.0, 90.0, 70.0, 50.0, 200.0, 110.0, -170.0, 40.0, 130.0, 10.0, 40.0, 40.0, 30.0, 130.0, 90.0, 20.0, 70.0, -20.0, 200.0, 60.0, 510.0, 60.0, 90.0, -20.0, 120.0, 260.0, 160.0, 10.0, 150.0, 250.0, 40.0, 60.0, 70.0, 40.0, 50.0, 0.0, 20.0, 440.0, 130.0, 170.0, 130.0, 60.0, 130.0, 0.0, 90.0, -10.0, 50.0, 0.0, 180.0, 40.0, 40.0, 360.0, 50.0, 30.0, 120.0, 40.0, 10.0, 0.0, 30.0, 240.0, 30.0, 60.0, 90.0, 30.0, -145.0, 40.0, 110.0, 70.0, 30.0, 40.0, 90.0, 160.0, 50.0, 420.0, 10.0, 130.0, 160.0, 40.0, 15.0, 50.0, 170.0, 10.0, 80.0, 40.0, 10.0, 250.0, 30.0, 40.0, 10.0, 30.0, 60.0, 120.0, 280.0, 30.0, 355.0, 100.0, 280.0, 40.0, -30.0, 10.0, 270.0, 0.0, 0.0, 10.0, 70.0, 20.0, 80.0, 80.0, 60.0, 300.0, 60.0, 170.0, 210.0, 430.0, 90.0, 50.0, 70.0, 20.0, 0.0, 30.0, 210.0, 200.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 10.0, 40.0, 20.0, 280.0, 20.0, 20.0, 40.0, 30.0, 30.0, 90.0, 80.0, 520.0, 40.0, 10.0, 10.0, 30.0, 260.0, 10.0, 40.0, 70.0, 80.0, 60.0, 80.0, 30.0, 50.0, 30.0, 200.0, 310.0, 320.0, 40.0, 10.0, 45.0, 170.0, 0.0, 80.0, 110.0, 60.0, 0.0, 100.0, 130.0, 40.0, 140.0, 30.0, 560.0, -20.0, 60.0, 10.0, 270.0, 10.0, 300.0, 30.0, 70.0, -150.0, 90.0, 40.0, 60.0, 390.0, 10.0, 0.0, -100.0, 120.0, 20.0, 140.0, 610.0, -20.0, 40.0, 150.0, 70.0, 60.0, 100.0, 50.0, 130.0, 30.0, 20.0, 10.0, 70.0, 500.0, 110.0, 30.0, 60.0, 90.0, -5.0, 20.0, 40.0, 15.0, 20.0, 0.0, 300.0, 30.0, 160.0, 200.0, 70.0, 60.0, 40.0, 500.0, 150.0, 110.0, 50.0, 40.0, 0.0, 20.0, 70.0, 170.0, 40.0, 360.0, 30.0, 0.0, 40.0, 80.0, 190.0, 280.0, 0.0, 80.0, 70.0, -10.0, 50.0, 330.0, 310.0, 340.0, 480.0, 50.0, 90.0, 260.0, 120.0, 0.0, 60.0, 310.0, 190.0, 90.0, -10.0, 150.0, 20.0, 250.0, 110.0, 160.0, 640.0, 40.0, 50.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4685038941974013, "mean_inference_ms": 1.4219259063269327, "mean_action_processing_ms": 0.42318797373506856, "mean_env_wait_ms": 1.2547714570446267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01238870620727539, "StateBufferConnector_ms": 0.009538412094116211, "ViewRequirementAgentConnector_ms": 0.368546724319458}, "num_episodes": 22, "episode_return_max": 1650.0, "episode_return_min": 210.0, "episode_return_mean": 902.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 17.451789296010602, "num_env_steps_trained_throughput_per_sec": 17.451789296010602, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 6000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000000, "timers": {"training_iteration_time_ms": 191103.835, "restore_workers_time_ms": 0.012, "training_step_time_ms": 191103.79, "sample_time_ms": 2380.448, "learn_time_ms": 188701.689, "learn_throughput": 21.197, "synch_weights_time_ms": 12.59}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "done": true, "training_iteration": 150, "trial_id": "90816_00000", "date": "2024-06-10_08-01-22", "timestamp": 1718020882, "time_this_iter_s": 229.2657811641693, "time_total_s": 28159.184004068375, "pid": 49678, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b00aeaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28159.184004068375, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 43.689846153846155, "ram_util_percent": 81.32676923076922}}
